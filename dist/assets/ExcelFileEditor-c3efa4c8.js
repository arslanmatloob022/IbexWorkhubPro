import{_ as e}from"./VIconBox.vue_vue_type_style_index_0_lang-66871fe1.js";import{a as t,f as n,bq as r,C as i,D as o,Z as s,r as a,b as l,o as h,n as u,E as c,F as d,G as p,O as g,K as m,U as f,N as w,m as y,P as v,Q as C,R as S,S as R}from"./index-1e16a679.js";import{_ as E}from"./VField.vue_vue_type_script_setup_true_lang-376f6331.js";import{_ as b}from"./VControl-5c5a0b06.js";import{_ as T}from"./VInput.vue_vue_type_script_setup_true_lang-03fcf16f.js";import{u as N}from"./useAPI-906a15c5.js";import{u as A}from"./useNotyf-a549c2ce.js";import{h as M}from"./moment-1b9a430c.js";var I=function(e){return e&&e.Math===Math&&e},O=I("object"==typeof globalThis&&globalThis)||I("object"==typeof window&&window)||I("object"==typeof self&&self)||I("object"==typeof t&&t)||I("object"==typeof t&&t)||function(){return this}()||Function("return this")(),x={},P=function(e){try{return!!e()}catch(Dm){return!0}},_=!P((function(){return 7!==Object.defineProperty({},1,{get:function(){return 7}})[1]})),L=!P((function(){var e=function(){}.bind();return"function"!=typeof e||e.hasOwnProperty("prototype")})),H=L,k=Function.prototype.call,F=H?k.bind(k):function(){return k.apply(k,arguments)},D={},V={}.propertyIsEnumerable,U=Object.getOwnPropertyDescriptor,B=U&&!V.call({1:2},1);D.f=B?function(e){var t=U(this,e);return!!t&&t.enumerable}:V;var W,j,G=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}},z=L,$=Function.prototype,Y=$.call,K=z&&$.bind.bind(Y,Y),X=z?K:function(e){return function(){return Y.apply(e,arguments)}},q=X,Q=q({}.toString),Z=q("".slice),J=function(e){return Z(Q(e),8,-1)},ee=P,te=J,ne=Object,re=X("".split),ie=ee((function(){return!ne("z").propertyIsEnumerable(0)}))?function(e){return"String"===te(e)?re(e,""):ne(e)}:ne,oe=function(e){return null==e},se=oe,ae=TypeError,le=function(e){if(se(e))throw new ae("Can't call method on "+e);return e},he=ie,ue=le,ce=function(e){return he(ue(e))},de="object"==typeof document&&document.all,pe=void 0===de&&void 0!==de?function(e){return"function"==typeof e||e===de}:function(e){return"function"==typeof e},ge=pe,me=function(e){return"object"==typeof e?null!==e:ge(e)},fe=O,we=pe,ye=function(e,t){return arguments.length<2?(n=fe[e],we(n)?n:void 0):fe[e]&&fe[e][t];var n},ve=X({}.isPrototypeOf),Ce=O.navigator,Se=Ce&&Ce.userAgent,Re=Se?String(Se):"",Ee=O,be=Re,Te=Ee.process,Ne=Ee.Deno,Ae=Te&&Te.versions||Ne&&Ne.version,Me=Ae&&Ae.v8;Me&&(j=(W=Me.split("."))[0]>0&&W[0]<4?1:+(W[0]+W[1])),!j&&be&&(!(W=be.match(/Edge\/(\d+)/))||W[1]>=74)&&(W=be.match(/Chrome\/(\d+)/))&&(j=+W[1]);var Ie=j,Oe=P,xe=O.String,Pe=!!Object.getOwnPropertySymbols&&!Oe((function(){var e=Symbol("symbol detection");return!xe(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&Ie&&Ie<41})),_e=Pe&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,Le=ye,He=pe,ke=ve,Fe=Object,De=_e?function(e){return"symbol"==typeof e}:function(e){var t=Le("Symbol");return He(t)&&ke(t.prototype,Fe(e))},Ve=String,Ue=function(e){try{return Ve(e)}catch(Dm){return"Object"}},Be=pe,We=Ue,je=TypeError,Ge=function(e){if(Be(e))return e;throw new je(We(e)+" is not a function")},ze=Ge,$e=oe,Ye=function(e,t){var n=e[t];return $e(n)?void 0:ze(n)},Ke=F,Xe=pe,qe=me,Qe=TypeError,Ze={exports:{}},Je=O,et=Object.defineProperty,tt=function(e,t){try{et(Je,e,{value:t,configurable:!0,writable:!0})}catch(Dm){Je[e]=t}return t},nt=O,rt=tt,it="__core-js_shared__",ot=Ze.exports=nt[it]||rt(it,{});(ot.versions||(ot.versions=[])).push({version:"3.41.0",mode:"global",copyright:"Â© 2014-2025 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.41.0/LICENSE",source:"https://github.com/zloirock/core-js"});var st=Ze.exports,at=st,lt=function(e,t){return at[e]||(at[e]=t||{})},ht=le,ut=Object,ct=function(e){return ut(ht(e))},dt=ct,pt=X({}.hasOwnProperty),gt=Object.hasOwn||function(e,t){return pt(dt(e),t)},mt=X,ft=0,wt=Math.random(),yt=mt(1..toString),vt=function(e){return"Symbol("+(void 0===e?"":e)+")_"+yt(++ft+wt,36)},Ct=lt,St=gt,Rt=vt,Et=Pe,bt=_e,Tt=O.Symbol,Nt=Ct("wks"),At=bt?Tt.for||Tt:Tt&&Tt.withoutSetter||Rt,Mt=function(e){return St(Nt,e)||(Nt[e]=Et&&St(Tt,e)?Tt[e]:At("Symbol."+e)),Nt[e]},It=F,Ot=me,xt=De,Pt=Ye,_t=function(e,t){var n,r;if("string"===t&&Xe(n=e.toString)&&!qe(r=Ke(n,e)))return r;if(Xe(n=e.valueOf)&&!qe(r=Ke(n,e)))return r;if("string"!==t&&Xe(n=e.toString)&&!qe(r=Ke(n,e)))return r;throw new Qe("Can't convert object to primitive value")},Lt=TypeError,Ht=Mt("toPrimitive"),kt=function(e,t){if(!Ot(e)||xt(e))return e;var n,r=Pt(e,Ht);if(r){if(void 0===t&&(t="default"),n=It(r,e,t),!Ot(n)||xt(n))return n;throw new Lt("Can't convert object to primitive value")}return void 0===t&&(t="number"),_t(e,t)},Ft=De,Dt=function(e){var t=kt(e,"string");return Ft(t)?t:t+""},Vt=me,Ut=O.document,Bt=Vt(Ut)&&Vt(Ut.createElement),Wt=function(e){return Bt?Ut.createElement(e):{}},jt=Wt,Gt=!_&&!P((function(){return 7!==Object.defineProperty(jt("div"),"a",{get:function(){return 7}}).a})),zt=_,$t=F,Yt=D,Kt=G,Xt=ce,qt=Dt,Qt=gt,Zt=Gt,Jt=Object.getOwnPropertyDescriptor;x.f=zt?Jt:function(e,t){if(e=Xt(e),t=qt(t),Zt)try{return Jt(e,t)}catch(Dm){}if(Qt(e,t))return Kt(!$t(Yt.f,e,t),e[t])};var en={},tn=_&&P((function(){return 42!==Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype})),nn=me,rn=String,on=TypeError,sn=function(e){if(nn(e))return e;throw new on(rn(e)+" is not an object")},an=_,ln=Gt,hn=tn,un=sn,cn=Dt,dn=TypeError,pn=Object.defineProperty,gn=Object.getOwnPropertyDescriptor,mn="enumerable",fn="configurable",wn="writable";en.f=an?hn?function(e,t,n){if(un(e),t=cn(t),un(n),"function"==typeof e&&"prototype"===t&&"value"in n&&wn in n&&!n[wn]){var r=gn(e,t);r&&r[wn]&&(e[t]=n.value,n={configurable:fn in n?n[fn]:r[fn],enumerable:mn in n?n[mn]:r[mn],writable:!1})}return pn(e,t,n)}:pn:function(e,t,n){if(un(e),t=cn(t),un(n),ln)try{return pn(e,t,n)}catch(Dm){}if("get"in n||"set"in n)throw new dn("Accessors not supported");return"value"in n&&(e[t]=n.value),e};var yn=en,vn=G,Cn=_?function(e,t,n){return yn.f(e,t,vn(1,n))}:function(e,t,n){return e[t]=n,e},Sn={exports:{}},Rn=_,En=gt,bn=Function.prototype,Tn=Rn&&Object.getOwnPropertyDescriptor,Nn=En(bn,"name"),An={EXISTS:Nn,PROPER:Nn&&"something"===function(){}.name,CONFIGURABLE:Nn&&(!Rn||Rn&&Tn(bn,"name").configurable)},Mn=pe,In=st,On=X(Function.toString);Mn(In.inspectSource)||(In.inspectSource=function(e){return On(e)});var xn,Pn,_n,Ln=In.inspectSource,Hn=pe,kn=O.WeakMap,Fn=Hn(kn)&&/native code/.test(String(kn)),Dn=vt,Vn=lt("keys"),Un=function(e){return Vn[e]||(Vn[e]=Dn(e))},Bn={},Wn=Fn,jn=O,Gn=me,zn=Cn,$n=gt,Yn=st,Kn=Un,Xn=Bn,qn="Object already initialized",Qn=jn.TypeError,Zn=jn.WeakMap;if(Wn||Yn.state){var Jn=Yn.state||(Yn.state=new Zn);Jn.get=Jn.get,Jn.has=Jn.has,Jn.set=Jn.set,xn=function(e,t){if(Jn.has(e))throw new Qn(qn);return t.facade=e,Jn.set(e,t),t},Pn=function(e){return Jn.get(e)||{}},_n=function(e){return Jn.has(e)}}else{var er=Kn("state");Xn[er]=!0,xn=function(e,t){if($n(e,er))throw new Qn(qn);return t.facade=e,zn(e,er,t),t},Pn=function(e){return $n(e,er)?e[er]:{}},_n=function(e){return $n(e,er)}}var tr={set:xn,get:Pn,has:_n,enforce:function(e){return _n(e)?Pn(e):xn(e,{})},getterFor:function(e){return function(t){var n;if(!Gn(t)||(n=Pn(t)).type!==e)throw new Qn("Incompatible receiver, "+e+" required");return n}}},nr=X,rr=P,ir=pe,or=gt,sr=_,ar=An.CONFIGURABLE,lr=Ln,hr=tr.enforce,ur=tr.get,cr=String,dr=Object.defineProperty,pr=nr("".slice),gr=nr("".replace),mr=nr([].join),fr=sr&&!rr((function(){return 8!==dr((function(){}),"length",{value:8}).length})),wr=String(String).split("String"),yr=Sn.exports=function(e,t,n){"Symbol("===pr(cr(t),0,7)&&(t="["+gr(cr(t),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),n&&n.getter&&(t="get "+t),n&&n.setter&&(t="set "+t),(!or(e,"name")||ar&&e.name!==t)&&(sr?dr(e,"name",{value:t,configurable:!0}):e.name=t),fr&&n&&or(n,"arity")&&e.length!==n.arity&&dr(e,"length",{value:n.arity});try{n&&or(n,"constructor")&&n.constructor?sr&&dr(e,"prototype",{writable:!1}):e.prototype&&(e.prototype=void 0)}catch(Dm){}var r=hr(e);return or(r,"source")||(r.source=mr(wr,"string"==typeof t?t:"")),e};Function.prototype.toString=yr((function(){return ir(this)&&ur(this).source||lr(this)}),"toString");var vr=Sn.exports,Cr=pe,Sr=en,Rr=vr,Er=tt,br=function(e,t,n,r){r||(r={});var i=r.enumerable,o=void 0!==r.name?r.name:t;if(Cr(n)&&Rr(n,o,r),r.global)i?e[t]=n:Er(t,n);else{try{r.unsafe?e[t]&&(i=!0):delete e[t]}catch(Dm){}i?e[t]=n:Sr.f(e,t,{value:n,enumerable:!1,configurable:!r.nonConfigurable,writable:!r.nonWritable})}return e},Tr={},Nr=Math.ceil,Ar=Math.floor,Mr=Math.trunc||function(e){var t=+e;return(t>0?Ar:Nr)(t)},Ir=function(e){var t=+e;return t!=t||0===t?0:Mr(t)},Or=Ir,xr=Math.max,Pr=Math.min,_r=Ir,Lr=Math.min,Hr=function(e){var t=_r(e);return t>0?Lr(t,9007199254740991):0},kr=function(e){return Hr(e.length)},Fr=ce,Dr=function(e,t){var n=Or(e);return n<0?xr(n+t,0):Pr(n,t)},Vr=kr,Ur=function(e){return function(t,n,r){var i=Fr(t),o=Vr(i);if(0===o)return!e&&-1;var s,a=Dr(r,o);if(e&&n!=n){for(;o>a;)if((s=i[a++])!=s)return!0}else for(;o>a;a++)if((e||a in i)&&i[a]===n)return e||a||0;return!e&&-1}},Br={includes:Ur(!0),indexOf:Ur(!1)},Wr=gt,jr=ce,Gr=Br.indexOf,zr=Bn,$r=X([].push),Yr=function(e,t){var n,r=jr(e),i=0,o=[];for(n in r)!Wr(zr,n)&&Wr(r,n)&&$r(o,n);for(;t.length>i;)Wr(r,n=t[i++])&&(~Gr(o,n)||$r(o,n));return o},Kr=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],Xr=Yr,qr=Kr.concat("length","prototype");Tr.f=Object.getOwnPropertyNames||function(e){return Xr(e,qr)};var Qr={};Qr.f=Object.getOwnPropertySymbols;var Zr=ye,Jr=Tr,ei=Qr,ti=sn,ni=X([].concat),ri=Zr("Reflect","ownKeys")||function(e){var t=Jr.f(ti(e)),n=ei.f;return n?ni(t,n(e)):t},ii=gt,oi=ri,si=x,ai=en,li=function(e,t,n){for(var r=oi(t),i=ai.f,o=si.f,s=0;s<r.length;s++){var a=r[s];ii(e,a)||n&&ii(n,a)||i(e,a,o(t,a))}},hi=P,ui=pe,ci=/#|\.prototype\./,di=function(e,t){var n=gi[pi(e)];return n===fi||n!==mi&&(ui(t)?hi(t):!!t)},pi=di.normalize=function(e){return String(e).replace(ci,".").toLowerCase()},gi=di.data={},mi=di.NATIVE="N",fi=di.POLYFILL="P",wi=di,yi=O,vi=x.f,Ci=Cn,Si=br,Ri=tt,Ei=li,bi=wi,Ti=function(e,t){var n,r,i,o,s,a=e.target,l=e.global,h=e.stat;if(n=l?yi:h?yi[a]||Ri(a,{}):yi[a]&&yi[a].prototype)for(r in t){if(o=t[r],i=e.dontCallGetSet?(s=vi(n,r))&&s.value:n[r],!bi(l?r:a+(h?".":"#")+r,e.forced)&&void 0!==i){if(typeof o==typeof i)continue;Ei(o,i)}(e.sham||i&&i.sham)&&Ci(o,"sham",!0),Si(n,r,o,e)}},Ni=L,Ai=Function.prototype,Mi=Ai.apply,Ii=Ai.call,Oi="object"==typeof Reflect&&Reflect.apply||(Ni?Ii.bind(Mi):function(){return Ii.apply(Mi,arguments)}),xi=X,Pi=Ge,_i=function(e,t,n){try{return xi(Pi(Object.getOwnPropertyDescriptor(e,t)[n]))}catch(Dm){}},Li=me,Hi=function(e){return Li(e)||null===e},ki=String,Fi=TypeError,Di=_i,Vi=me,Ui=le,Bi=function(e){if(Hi(e))return e;throw new Fi("Can't set "+ki(e)+" as a prototype")},Wi=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,n={};try{(e=Di(Object.prototype,"__proto__","set"))(n,[]),t=n instanceof Array}catch(Dm){}return function(n,r){return Ui(n),Bi(r),Vi(n)?(t?e(n,r):n.__proto__=r,n):n}}():void 0),ji=en.f,Gi=pe,zi=me,$i=Wi,Yi={};Yi[Mt("toStringTag")]="z";var Ki="[object z]"===String(Yi),Xi=pe,qi=J,Qi=Mt("toStringTag"),Zi=Object,Ji="Arguments"===qi(function(){return arguments}()),eo=Ki?qi:function(e){var t,n,r;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=function(e,t){try{return e[t]}catch(Dm){}}(t=Zi(e),Qi))?n:Ji?qi(t):"Object"===(r=qi(t))&&Xi(t.callee)?"Arguments":r},to=eo,no=String,ro=function(e){if("Symbol"===to(e))throw new TypeError("Cannot convert a Symbol value to a string");return no(e)},io=ro,oo=me,so=Cn,ao=Error,lo=X("".replace),ho=String(new ao("zxcasd").stack),uo=/\n\s*at [^:]*:[^\n]*/,co=uo.test(ho),po=G,go=!P((function(){var e=new Error("a");return!("stack"in e)||(Object.defineProperty(e,"stack",po(1,7)),7!==e.stack)})),mo=Cn,fo=function(e,t){if(co&&"string"==typeof e&&!ao.prepareStackTrace)for(;t--;)e=lo(e,uo,"");return e},wo=go,yo=Error.captureStackTrace,vo=ye,Co=gt,So=Cn,Ro=ve,Eo=Wi,bo=li,To=function(e,t,n){n in e||ji(e,n,{configurable:!0,get:function(){return t[n]},set:function(e){t[n]=e}})},No=function(e,t,n){var r,i;return $i&&Gi(r=t.constructor)&&r!==n&&zi(i=r.prototype)&&i!==n.prototype&&$i(e,i),e},Ao=function(e,t){return void 0===e?arguments.length<2?"":t:io(e)},Mo=function(e,t){oo(t)&&"cause"in t&&so(e,"cause",t.cause)},Io=function(e,t,n,r){wo&&(yo?yo(e,t):mo(e,"stack",fo(n,r)))},Oo=_,xo=Ti,Po=Oi,_o=function(e,t,n,r){var i="stackTraceLimit",o=r?2:1,s=e.split("."),a=s[s.length-1],l=vo.apply(null,s);if(l){var h=l.prototype;if(Co(h,"cause")&&delete h.cause,!n)return l;var u=vo("Error"),c=t((function(e,t){var n=Ao(r?t:e,void 0),i=r?new l(e):new l;return void 0!==n&&So(i,"message",n),Io(i,c,i.stack,2),this&&Ro(h,this)&&No(i,this,c),arguments.length>o&&Mo(i,arguments[o]),i}));c.prototype=h,"Error"!==a?Eo?Eo(c,u):bo(c,u,{name:!0}):Oo&&i in l&&(To(c,l,i),To(c,l,"prepareStackTrace")),bo(c,l);try{h.name!==a&&So(h,"name",a),h.constructor=c}catch(Dm){}return c}},Lo="WebAssembly",Ho=O[Lo],ko=7!==new Error("e",{cause:7}).cause,Fo=function(e,t){var n={};n[e]=_o(e,t,ko),xo({global:!0,constructor:!0,arity:1,forced:ko},n)},Do=function(e,t){if(Ho&&Ho[e]){var n={};n[e]=_o(Lo+"."+e,t,ko),xo({target:Lo,stat:!0,constructor:!0,arity:1,forced:ko},n)}};Fo("Error",(function(e){return function(t){return Po(e,this,arguments)}})),Fo("EvalError",(function(e){return function(t){return Po(e,this,arguments)}})),Fo("RangeError",(function(e){return function(t){return Po(e,this,arguments)}})),Fo("ReferenceError",(function(e){return function(t){return Po(e,this,arguments)}})),Fo("SyntaxError",(function(e){return function(t){return Po(e,this,arguments)}})),Fo("TypeError",(function(e){return function(t){return Po(e,this,arguments)}})),Fo("URIError",(function(e){return function(t){return Po(e,this,arguments)}})),Do("CompileError",(function(e){return function(t){return Po(e,this,arguments)}})),Do("LinkError",(function(e){return function(t){return Po(e,this,arguments)}})),Do("RuntimeError",(function(e){return function(t){return Po(e,this,arguments)}}));var Vo=J,Uo=Array.isArray||function(e){return"Array"===Vo(e)},Bo=_,Wo=Uo,jo=TypeError,Go=Object.getOwnPropertyDescriptor,zo=Bo&&!function(){if(void 0!==this)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(Dm){return Dm instanceof TypeError}}(),$o=zo?function(e,t){if(Wo(e)&&!Go(e,"length").writable)throw new jo("Cannot set read only .length");return e.length=t}:function(e,t){return e.length=t},Yo=TypeError,Ko=function(e){if(e>9007199254740991)throw Yo("Maximum allowed index exceeded");return e},Xo=Ti,qo=ct,Qo=kr,Zo=$o,Jo=Ko,es=P((function(){return 4294967297!==[].push.call({length:4294967296},1)}))||!function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(Dm){return Dm instanceof TypeError}}();Xo({target:"Array",proto:!0,arity:1,forced:es},{push:function(e){var t=qo(this),n=Qo(t),r=arguments.length;Jo(n+r);for(var i=0;i<r;i++)t[n]=arguments[i],n++;return Zo(t,n),n}});var ts=X,ns=Set.prototype,rs={Set:Set,add:ts(ns.add),has:ts(ns.has),remove:ts(ns.delete),proto:ns},is=rs.has,os=function(e){return is(e),e},ss=F,as=function(e,t,n){for(var r,i,o=n?e:e.iterator,s=e.next;!(r=ss(s,o)).done;)if(void 0!==(i=t(r.value)))return i},ls=X,hs=as,us=rs.Set,cs=rs.proto,ds=ls(cs.forEach),ps=ls(cs.keys),gs=ps(new us).next,ms=function(e,t,n){return n?hs({iterator:ps(e),next:gs},t):ds(e,t)},fs=ms,ws=rs.Set,ys=rs.add,vs=function(e){var t=new ws;return fs(e,(function(e){ys(t,e)})),t},Cs=_i(rs.proto,"size","get")||function(e){return e.size},Ss=function(e){return{iterator:e,next:e.next,done:!1}},Rs=Ge,Es=sn,bs=F,Ts=Ir,Ns=Ss,As="Invalid size",Ms=RangeError,Is=TypeError,Os=Math.max,xs=function(e,t){this.set=e,this.size=Os(t,0),this.has=Rs(e.has),this.keys=Rs(e.keys)};xs.prototype={getIterator:function(){return Ns(Es(bs(this.keys,this.set)))},includes:function(e){return bs(this.has,this.set,e)}};var Ps=function(e){Es(e);var t=+e.size;if(t!=t)throw new Is(As);var n=Ts(t);if(n<0)throw new Ms(As);return new xs(e,n)},_s=os,Ls=vs,Hs=Cs,ks=Ps,Fs=ms,Ds=as,Vs=rs.has,Us=rs.remove,Bs=ye,Ws=function(e){return{size:e,has:function(){return!1},keys:function(){return{next:function(){return{done:!0}}}}}},js=function(e){return{size:e,has:function(){return!0},keys:function(){throw new Error("e")}}},Gs=function(e,t){var n=Bs("Set");try{(new n)[e](Ws(0));try{return(new n)[e](Ws(-1)),!1}catch(i){if(!t)return!0;try{return(new n)[e](js(-1/0)),!1}catch(Dm){var r=new n;return r.add(1),r.add(2),t(r[e](js(1/0)))}}}catch(Dm){return!1}},zs=function(e){var t=_s(this),n=ks(e),r=Ls(t);return Hs(t)<=n.size?Fs(t,(function(e){n.includes(e)&&Us(r,e)})):Ds(n.getIterator(),(function(e){Vs(t,e)&&Us(r,e)})),r};Ti({target:"Set",proto:!0,real:!0,forced:!Gs("difference",(function(e){return 0===e.size}))},{difference:zs});var $s=os,Ys=Cs,Ks=Ps,Xs=ms,qs=as,Qs=rs.Set,Zs=rs.add,Js=rs.has,ea=P,ta=function(e){var t=$s(this),n=Ks(e),r=new Qs;return Ys(t)>n.size?qs(n.getIterator(),(function(e){Js(t,e)&&Zs(r,e)})):Xs(t,(function(e){n.includes(e)&&Zs(r,e)})),r};Ti({target:"Set",proto:!0,real:!0,forced:!Gs("intersection",(function(e){return 2===e.size&&e.has(1)&&e.has(2)}))||ea((function(){return"3,2"!==String(Array.from(new Set([1,2,3]).intersection(new Set([3,2]))))}))},{intersection:ta});var na=F,ra=sn,ia=Ye,oa=function(e,t,n){var r,i;ra(e);try{if(!(r=ia(e,"return"))){if("throw"===t)throw n;return n}r=na(r,e)}catch(Dm){i=!0,r=Dm}if("throw"===t)throw n;if(i)throw r;return ra(r),n},sa=os,aa=rs.has,la=Cs,ha=Ps,ua=ms,ca=as,da=oa,pa=function(e){var t=sa(this),n=ha(e);if(la(t)<=n.size)return!1!==ua(t,(function(e){if(n.includes(e))return!1}),!0);var r=n.getIterator();return!1!==ca(r,(function(e){if(aa(t,e))return da(r,"normal",!1)}))};Ti({target:"Set",proto:!0,real:!0,forced:!Gs("isDisjointFrom",(function(e){return!e}))},{isDisjointFrom:pa});var ga=os,ma=Cs,fa=ms,wa=Ps,ya=function(e){var t=ga(this),n=wa(e);return!(ma(t)>n.size)&&!1!==fa(t,(function(e){if(!n.includes(e))return!1}),!0)};Ti({target:"Set",proto:!0,real:!0,forced:!Gs("isSubsetOf",(function(e){return e}))},{isSubsetOf:ya});var va=os,Ca=rs.has,Sa=Cs,Ra=Ps,Ea=as,ba=oa,Ta=function(e){var t=va(this),n=Ra(e);if(Sa(t)<n.size)return!1;var r=n.getIterator();return!1!==Ea(r,(function(e){if(!Ca(t,e))return ba(r,"normal",!1)}))};Ti({target:"Set",proto:!0,real:!0,forced:!Gs("isSupersetOf",(function(e){return!e}))},{isSupersetOf:Ta});var Na=os,Aa=vs,Ma=Ps,Ia=as,Oa=rs.add,xa=rs.has,Pa=rs.remove,_a=function(e){var t=Na(this),n=Ma(e).getIterator(),r=Aa(t);return Ia(n,(function(e){xa(t,e)?Pa(r,e):Oa(r,e)})),r};Ti({target:"Set",proto:!0,real:!0,forced:!Gs("symmetricDifference")},{symmetricDifference:_a});var La=os,Ha=rs.add,ka=vs,Fa=Ps,Da=as,Va=function(e){var t=La(this),n=Fa(e).getIterator(),r=ka(t);return Da(n,(function(e){Ha(r,e)})),r};Ti({target:"Set",proto:!0,real:!0,forced:!Gs("union")},{union:Va});var Ua=ve,Ba=TypeError,Wa=!P((function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype})),ja=gt,Ga=pe,za=ct,$a=Wa,Ya=Un("IE_PROTO"),Ka=Object,Xa=Ka.prototype,qa=$a?Ka.getPrototypeOf:function(e){var t=za(e);if(ja(t,Ya))return t[Ya];var n=t.constructor;return Ga(n)&&t instanceof n?n.prototype:t instanceof Ka?Xa:null},Qa=vr,Za=en,Ja=_,el=en,tl=G,nl=function(e,t,n){Ja?el.f(e,t,tl(0,n)):e[t]=n},rl={},il=Yr,ol=Kr,sl=Object.keys||function(e){return il(e,ol)},al=_,ll=tn,hl=en,ul=sn,cl=ce,dl=sl;rl.f=al&&!ll?Object.defineProperties:function(e,t){ul(e);for(var n,r=cl(t),i=dl(t),o=i.length,s=0;o>s;)hl.f(e,n=i[s++],r[n]);return e};var pl,gl=ye("document","documentElement"),ml=sn,fl=rl,wl=Kr,yl=Bn,vl=gl,Cl=Wt,Sl="prototype",Rl="script",El=Un("IE_PROTO"),bl=function(){},Tl=function(e){return"<"+Rl+">"+e+"</"+Rl+">"},Nl=function(e){e.write(Tl("")),e.close();var t=e.parentWindow.Object;return e=null,t},Al=function(){try{pl=new ActiveXObject("htmlfile")}catch(Dm){}var e,t,n;Al="undefined"!=typeof document?document.domain&&pl?Nl(pl):(t=Cl("iframe"),n="java"+Rl+":",t.style.display="none",vl.appendChild(t),t.src=String(n),(e=t.contentWindow.document).open(),e.write(Tl("document.F=Object")),e.close(),e.F):Nl(pl);for(var r=wl.length;r--;)delete Al[Sl][wl[r]];return Al()};yl[El]=!0;var Ml,Il,Ol,xl=Object.create||function(e,t){var n;return null!==e?(bl[Sl]=ml(e),n=new bl,bl[Sl]=null,n[El]=e):n=Al(),void 0===t?n:fl.f(n,t)},Pl=P,_l=pe,Ll=me,Hl=qa,kl=br,Fl=Mt("iterator"),Dl=!1;[].keys&&("next"in(Ol=[].keys())?(Il=Hl(Hl(Ol)))!==Object.prototype&&(Ml=Il):Dl=!0);var Vl=!Ll(Ml)||Pl((function(){var e={};return Ml[Fl].call(e)!==e}));Vl&&(Ml={}),_l(Ml[Fl])||kl(Ml,Fl,(function(){return this}));var Ul={IteratorPrototype:Ml,BUGGY_SAFARI_ITERATORS:Dl},Bl=Ti,Wl=O,jl=function(e,t){if(Ua(t,e))return e;throw new Ba("Incorrect invocation")},Gl=sn,zl=pe,$l=qa,Yl=function(e,t,n){return n.get&&Qa(n.get,t,{getter:!0}),n.set&&Qa(n.set,t,{setter:!0}),Za.f(e,t,n)},Kl=nl,Xl=P,ql=gt,Ql=Ul.IteratorPrototype,Zl=_,Jl="constructor",eh="Iterator",th=Mt("toStringTag"),nh=TypeError,rh=Wl[eh],ih=!zl(rh)||rh.prototype!==Ql||!Xl((function(){rh({})})),oh=function(){if(jl(this,Ql),$l(this)===Ql)throw new nh("Abstract class Iterator not directly constructable")},sh=function(e,t){Zl?Yl(Ql,e,{configurable:!0,get:function(){return t},set:function(t){if(Gl(this),this===Ql)throw new nh("You can't redefine this property");ql(this,e)?this[e]=t:Kl(this,e,t)}}):Ql[e]=t};ql(Ql,th)||sh(th,eh),!ih&&ql(Ql,Jl)&&Ql[Jl]!==Object||sh(Jl,oh),oh.prototype=Ql,Bl({global:!0,constructor:!0,forced:ih},{Iterator:oh});var ah=br,lh=F,hh=xl,uh=Cn,ch=function(e,t,n){for(var r in t)ah(e,r,t[r],n);return e},dh=tr,ph=Ye,gh=Ul.IteratorPrototype,mh=function(e,t){return{value:e,done:t}},fh=oa,wh=Mt("toStringTag"),yh="IteratorHelper",vh="WrapForValidIterator",Ch=dh.set,Sh=function(e){var t=dh.getterFor(e?vh:yh);return ch(hh(gh),{next:function(){var n=t(this);if(e)return n.nextHandler();if(n.done)return mh(void 0,!0);try{var r=n.nextHandler();return n.returnHandlerResult?r:mh(r,n.done)}catch(Dm){throw n.done=!0,Dm}},return:function(){var n=t(this),r=n.iterator;if(n.done=!0,e){var i=ph(r,"return");return i?lh(i,r):mh(void 0,!0)}if(n.inner)try{fh(n.inner.iterator,"normal")}catch(Dm){return fh(r,"throw",Dm)}return r&&fh(r,"normal"),mh(void 0,!0)}})},Rh=Sh(!0),Eh=Sh(!1);uh(Eh,wh,"Iterator Helper");var bh=function(e,t,n){var r=function(r,i){i?(i.iterator=r.iterator,i.next=r.next):i=r,i.type=t?vh:yh,i.returnHandlerResult=!!n,i.nextHandler=e,i.counter=0,i.done=!1,Ch(this,i)};return r.prototype=t?Rh:Eh,r},Th=sn,Nh=oa,Ah=function(e,t,n,r){try{return r?t(Th(n)[0],n[1]):t(n)}catch(Dm){Nh(e,"throw",Dm)}},Mh=Ti,Ih=F,Oh=Ge,xh=sn,Ph=Ss,_h=Ah,Lh=bh((function(){for(var e,t,n=this.iterator,r=this.predicate,i=this.next;;){if(e=xh(Ih(i,n)),this.done=!!e.done)return;if(t=e.value,_h(n,r,[t,this.counter++],!0))return t}}));Mh({target:"Iterator",proto:!0,real:!0,forced:false},{filter:function(e){return xh(this),Oh(e),new Lh(Ph(this),{predicate:e})}});var Hh=J,kh=X,Fh=function(e){if("Function"===Hh(e))return kh(e)},Dh=Ge,Vh=L,Uh=Fh(Fh.bind),Bh=function(e,t){return Dh(e),void 0===t?e:Vh?Uh(e,t):function(){return e.apply(t,arguments)}},Wh={},jh=Wh,Gh=Mt("iterator"),zh=Array.prototype,$h=eo,Yh=Ye,Kh=oe,Xh=Wh,qh=Mt("iterator"),Qh=function(e){if(!Kh(e))return Yh(e,qh)||Yh(e,"@@iterator")||Xh[$h(e)]},Zh=F,Jh=Ge,eu=sn,tu=Ue,nu=Qh,ru=TypeError,iu=Bh,ou=F,su=sn,au=Ue,lu=function(e){return void 0!==e&&(jh.Array===e||zh[Gh]===e)},hu=kr,uu=ve,cu=function(e,t){var n=arguments.length<2?nu(e):t;if(Jh(n))return eu(Zh(n,e));throw new ru(tu(e)+" is not iterable")},du=Qh,pu=oa,gu=TypeError,mu=function(e,t){this.stopped=e,this.result=t},fu=mu.prototype,wu=function(e,t,n){var r,i,o,s,a,l,h,u=n&&n.that,c=!(!n||!n.AS_ENTRIES),d=!(!n||!n.IS_RECORD),p=!(!n||!n.IS_ITERATOR),g=!(!n||!n.INTERRUPTED),m=iu(t,u),f=function(e){return r&&pu(r,"normal",e),new mu(!0,e)},w=function(e){return c?(su(e),g?m(e[0],e[1],f):m(e[0],e[1])):g?m(e,f):m(e)};if(d)r=e.iterator;else if(p)r=e;else{if(!(i=du(e)))throw new gu(au(e)+" is not iterable");if(lu(i)){for(o=0,s=hu(e);s>o;o++)if((a=w(e[o]))&&uu(fu,a))return a;return new mu(!1)}r=cu(e,i)}for(l=d?e.next:r.next;!(h=ou(l,r)).done;){try{a=w(h.value)}catch(Dm){pu(r,"throw",Dm)}if("object"==typeof a&&a&&uu(fu,a))return a}return new mu(!1)},yu=wu,vu=Ge,Cu=sn,Su=Ss;Ti({target:"Iterator",proto:!0,real:!0},{forEach:function(e){Cu(this),vu(e);var t=Su(this),n=0;yu(t,(function(t){e(t,n++)}),{IS_RECORD:!0})}});var Ru=F,Eu=Ge,bu=sn,Tu=Ss,Nu=Ah,Au=bh((function(){var e=this.iterator,t=bu(Ru(this.next,e));if(!(this.done=!!t.done))return Nu(e,this.mapper,[t.value,this.counter++],!0)}));Ti({target:"Iterator",proto:!0,real:!0,forced:false},{map:function(e){return bu(this),Eu(e),new Au(Tu(this),{mapper:e})}});var Mu,Iu,Ou,xu,Pu=X([].slice),_u=TypeError,Lu=function(e,t){if(e<t)throw new _u("Not enough arguments");return e},Hu=/(?:ipad|iphone|ipod).*applewebkit/i.test(Re),ku=O,Fu=Re,Du=J,Vu=function(e){return Fu.slice(0,e.length)===e},Uu=Vu("Bun/")?"BUN":Vu("Cloudflare-Workers")?"CLOUDFLARE":Vu("Deno/")?"DENO":Vu("Node.js/")?"NODE":ku.Bun&&"string"==typeof Bun.version?"BUN":ku.Deno&&"object"==typeof Deno.version?"DENO":"process"===Du(ku.process)?"NODE":ku.window&&ku.document?"BROWSER":"REST",Bu=O,Wu=Oi,ju=Bh,Gu=pe,zu=gt,$u=P,Yu=gl,Ku=Pu,Xu=Wt,qu=Lu,Qu=Hu,Zu="NODE"===Uu,Ju=Bu.setImmediate,ec=Bu.clearImmediate,tc=Bu.process,nc=Bu.Dispatch,rc=Bu.Function,ic=Bu.MessageChannel,oc=Bu.String,sc=0,ac={},lc="onreadystatechange";$u((function(){Mu=Bu.location}));var hc=function(e){if(zu(ac,e)){var t=ac[e];delete ac[e],t()}},uc=function(e){return function(){hc(e)}},cc=function(e){hc(e.data)},dc=function(e){Bu.postMessage(oc(e),Mu.protocol+"//"+Mu.host)};Ju&&ec||(Ju=function(e){qu(arguments.length,1);var t=Gu(e)?e:rc(e),n=Ku(arguments,1);return ac[++sc]=function(){Wu(t,void 0,n)},Iu(sc),sc},ec=function(e){delete ac[e]},Zu?Iu=function(e){tc.nextTick(uc(e))}:nc&&nc.now?Iu=function(e){nc.now(uc(e))}:ic&&!Qu?(xu=(Ou=new ic).port2,Ou.port1.onmessage=cc,Iu=ju(xu.postMessage,xu)):Bu.addEventListener&&Gu(Bu.postMessage)&&!Bu.importScripts&&Mu&&"file:"!==Mu.protocol&&!$u(dc)?(Iu=dc,Bu.addEventListener("message",cc,!1)):Iu=lc in Xu("script")?function(e){Yu.appendChild(Xu("script"))[lc]=function(){Yu.removeChild(this),hc(e)}}:function(e){setTimeout(uc(e),0)});var pc={set:Ju,clear:ec},gc=pc.clear;Ti({global:!0,bind:!0,enumerable:!0,forced:O.clearImmediate!==gc},{clearImmediate:gc});var mc=O,fc=Oi,wc=pe,yc=Uu,vc=Re,Cc=Pu,Sc=Lu,Rc=mc.Function,Ec=/MSIE .\./.test(vc)||"BUN"===yc&&function(){var e=mc.Bun.version.split(".");return e.length<3||"0"===e[0]&&(e[1]<3||"3"===e[1]&&"0"===e[2])}(),bc=Ti,Tc=O,Nc=pc.set,Ac=function(e,t){var n=t?2:1;return Ec?function(r,i){var o=Sc(arguments.length,1)>n,s=wc(r)?r:Rc(r),a=o?Cc(arguments,n):[],l=o?function(){fc(s,this,a)}:s;return t?e(l,i):e(l)}:e},Mc=Tc.setImmediate?Ac(Nc,!1):Nc;bc({global:!0,bind:!0,enumerable:!0,forced:Tc.setImmediate!==Mc},{setImmediate:Mc});
/*! @license DOMPurify 3.2.4 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.2.4/LICENSE */
const{entries:Ic,setPrototypeOf:Oc,isFrozen:xc,getPrototypeOf:Pc,getOwnPropertyDescriptor:_c}=Object;let{freeze:Lc,seal:Hc,create:kc}=Object,{apply:Fc,construct:Dc}="undefined"!=typeof Reflect&&Reflect;Lc||(Lc=function(e){return e}),Hc||(Hc=function(e){return e}),Fc||(Fc=function(e,t,n){return e.apply(t,n)}),Dc||(Dc=function(e,t){return new e(...t)});const Vc=ed(Array.prototype.forEach),Uc=ed(Array.prototype.lastIndexOf),Bc=ed(Array.prototype.pop),Wc=ed(Array.prototype.push),jc=ed(Array.prototype.splice),Gc=ed(String.prototype.toLowerCase),zc=ed(String.prototype.toString),$c=ed(String.prototype.match),Yc=ed(String.prototype.replace),Kc=ed(String.prototype.indexOf),Xc=ed(String.prototype.trim),qc=ed(Object.prototype.hasOwnProperty),Qc=ed(RegExp.prototype.test),Zc=(Jc=TypeError,function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Dc(Jc,t)});var Jc;function ed(e){return function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return Fc(e,t,r)}}function td(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Gc;Oc&&Oc(e,null);let r=t.length;for(;r--;){let i=t[r];if("string"==typeof i){const e=n(i);e!==i&&(xc(t)||(t[r]=e),i=e)}e[i]=!0}return e}function nd(e){for(let t=0;t<e.length;t++){qc(e,t)||(e[t]=null)}return e}function rd(e){const t=kc(null);for(const[n,r]of Ic(e)){qc(e,n)&&(Array.isArray(r)?t[n]=nd(r):r&&"object"==typeof r&&r.constructor===Object?t[n]=rd(r):t[n]=r)}return t}function id(e,t){for(;null!==e;){const n=_c(e,t);if(n){if(n.get)return ed(n.get);if("function"==typeof n.value)return ed(n.value)}e=Pc(e)}return function(){return null}}const od=Lc(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),sd=Lc(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),ad=Lc(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),ld=Lc(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),hd=Lc(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),ud=Lc(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),cd=Lc(["#text"]),dd=Lc(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),pd=Lc(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),gd=Lc(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),md=Lc(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),fd=Hc(/\{\{[\w\W]*|[\w\W]*\}\}/gm),wd=Hc(/<%[\w\W]*|[\w\W]*%>/gm),yd=Hc(/\$\{[\w\W]*/gm),vd=Hc(/^data-[\-\w.\u00B7-\uFFFF]+$/),Cd=Hc(/^aria-[\-\w]+$/),Sd=Hc(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),Rd=Hc(/^(?:\w+script|data):/i),Ed=Hc(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),bd=Hc(/^html$/i),Td=Hc(/^[a-z][.\w]*(-[.\w]+)+$/i);var Nd=Object.freeze({__proto__:null,ARIA_ATTR:Cd,ATTR_WHITESPACE:Ed,CUSTOM_ELEMENT:Td,DATA_ATTR:vd,DOCTYPE_NAME:bd,ERB_EXPR:wd,IS_ALLOWED_URI:Sd,IS_SCRIPT_OR_DATA:Rd,MUSTACHE_EXPR:fd,TMPLIT_EXPR:yd});const Ad=1,Md=3,Id=7,Od=8,xd=9,Pd=function(){return"undefined"==typeof window?null:window};var _d=function e(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Pd();const n=t=>e(t);if(n.version="3.2.4",n.removed=[],!t||!t.document||t.document.nodeType!==xd||!t.Element)return n.isSupported=!1,n;let{document:r}=t;const i=r,o=i.currentScript,{DocumentFragment:s,HTMLTemplateElement:a,Node:l,Element:h,NodeFilter:u,NamedNodeMap:c=t.NamedNodeMap||t.MozNamedAttrMap,HTMLFormElement:d,DOMParser:p,trustedTypes:g}=t,m=h.prototype,f=id(m,"cloneNode"),w=id(m,"remove"),y=id(m,"nextSibling"),v=id(m,"childNodes"),C=id(m,"parentNode");if("function"==typeof a){const e=r.createElement("template");e.content&&e.content.ownerDocument&&(r=e.content.ownerDocument)}let S,R="";const{implementation:E,createNodeIterator:b,createDocumentFragment:T,getElementsByTagName:N}=r,{importNode:A}=i;let M={afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]};n.isSupported="function"==typeof Ic&&"function"==typeof C&&E&&void 0!==E.createHTMLDocument;const{MUSTACHE_EXPR:I,ERB_EXPR:O,TMPLIT_EXPR:x,DATA_ATTR:P,ARIA_ATTR:_,IS_SCRIPT_OR_DATA:L,ATTR_WHITESPACE:H,CUSTOM_ELEMENT:k}=Nd;let{IS_ALLOWED_URI:F}=Nd,D=null;const V=td({},[...od,...sd,...ad,...hd,...cd]);let U=null;const B=td({},[...dd,...pd,...gd,...md]);let W=Object.seal(kc(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),j=null,G=null,z=!0,$=!0,Y=!1,K=!0,X=!1,q=!0,Q=!1,Z=!1,J=!1,ee=!1,te=!1,ne=!1,re=!0,ie=!1,oe=!0,se=!1,ae={},le=null;const he=td({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let ue=null;const ce=td({},["audio","video","img","source","image","track"]);let de=null;const pe=td({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),ge="http://www.w3.org/1998/Math/MathML",me="http://www.w3.org/2000/svg",fe="http://www.w3.org/1999/xhtml";let we=fe,ye=!1,ve=null;const Ce=td({},[ge,me,fe],zc);let Se=td({},["mi","mo","mn","ms","mtext"]),Re=td({},["annotation-xml"]);const Ee=td({},["title","style","font","a","script"]);let be=null;const Te=["application/xhtml+xml","text/html"];let Ne=null,Ae=null;const Me=r.createElement("form"),Ie=function(e){return e instanceof RegExp||e instanceof Function},Oe=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!Ae||Ae!==e){if(e&&"object"==typeof e||(e={}),e=rd(e),be=-1===Te.indexOf(e.PARSER_MEDIA_TYPE)?"text/html":e.PARSER_MEDIA_TYPE,Ne="application/xhtml+xml"===be?zc:Gc,D=qc(e,"ALLOWED_TAGS")?td({},e.ALLOWED_TAGS,Ne):V,U=qc(e,"ALLOWED_ATTR")?td({},e.ALLOWED_ATTR,Ne):B,ve=qc(e,"ALLOWED_NAMESPACES")?td({},e.ALLOWED_NAMESPACES,zc):Ce,de=qc(e,"ADD_URI_SAFE_ATTR")?td(rd(pe),e.ADD_URI_SAFE_ATTR,Ne):pe,ue=qc(e,"ADD_DATA_URI_TAGS")?td(rd(ce),e.ADD_DATA_URI_TAGS,Ne):ce,le=qc(e,"FORBID_CONTENTS")?td({},e.FORBID_CONTENTS,Ne):he,j=qc(e,"FORBID_TAGS")?td({},e.FORBID_TAGS,Ne):{},G=qc(e,"FORBID_ATTR")?td({},e.FORBID_ATTR,Ne):{},ae=!!qc(e,"USE_PROFILES")&&e.USE_PROFILES,z=!1!==e.ALLOW_ARIA_ATTR,$=!1!==e.ALLOW_DATA_ATTR,Y=e.ALLOW_UNKNOWN_PROTOCOLS||!1,K=!1!==e.ALLOW_SELF_CLOSE_IN_ATTR,X=e.SAFE_FOR_TEMPLATES||!1,q=!1!==e.SAFE_FOR_XML,Q=e.WHOLE_DOCUMENT||!1,ee=e.RETURN_DOM||!1,te=e.RETURN_DOM_FRAGMENT||!1,ne=e.RETURN_TRUSTED_TYPE||!1,J=e.FORCE_BODY||!1,re=!1!==e.SANITIZE_DOM,ie=e.SANITIZE_NAMED_PROPS||!1,oe=!1!==e.KEEP_CONTENT,se=e.IN_PLACE||!1,F=e.ALLOWED_URI_REGEXP||Sd,we=e.NAMESPACE||fe,Se=e.MATHML_TEXT_INTEGRATION_POINTS||Se,Re=e.HTML_INTEGRATION_POINTS||Re,W=e.CUSTOM_ELEMENT_HANDLING||{},e.CUSTOM_ELEMENT_HANDLING&&Ie(e.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(W.tagNameCheck=e.CUSTOM_ELEMENT_HANDLING.tagNameCheck),e.CUSTOM_ELEMENT_HANDLING&&Ie(e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(W.attributeNameCheck=e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),e.CUSTOM_ELEMENT_HANDLING&&"boolean"==typeof e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements&&(W.allowCustomizedBuiltInElements=e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),X&&($=!1),te&&(ee=!0),ae&&(D=td({},cd),U=[],!0===ae.html&&(td(D,od),td(U,dd)),!0===ae.svg&&(td(D,sd),td(U,pd),td(U,md)),!0===ae.svgFilters&&(td(D,ad),td(U,pd),td(U,md)),!0===ae.mathMl&&(td(D,hd),td(U,gd),td(U,md))),e.ADD_TAGS&&(D===V&&(D=rd(D)),td(D,e.ADD_TAGS,Ne)),e.ADD_ATTR&&(U===B&&(U=rd(U)),td(U,e.ADD_ATTR,Ne)),e.ADD_URI_SAFE_ATTR&&td(de,e.ADD_URI_SAFE_ATTR,Ne),e.FORBID_CONTENTS&&(le===he&&(le=rd(le)),td(le,e.FORBID_CONTENTS,Ne)),oe&&(D["#text"]=!0),Q&&td(D,["html","head","body"]),D.table&&(td(D,["tbody"]),delete j.tbody),e.TRUSTED_TYPES_POLICY){if("function"!=typeof e.TRUSTED_TYPES_POLICY.createHTML)throw Zc('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if("function"!=typeof e.TRUSTED_TYPES_POLICY.createScriptURL)throw Zc('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');S=e.TRUSTED_TYPES_POLICY,R=S.createHTML("")}else void 0===S&&(S=function(e,t){if("object"!=typeof e||"function"!=typeof e.createPolicy)return null;let n=null;const r="data-tt-policy-suffix";t&&t.hasAttribute(r)&&(n=t.getAttribute(r));const i="dompurify"+(n?"#"+n:"");try{return e.createPolicy(i,{createHTML:e=>e,createScriptURL:e=>e})}catch(o){return console.warn("TrustedTypes policy "+i+" could not be created."),null}}(g,o)),null!==S&&"string"==typeof R&&(R=S.createHTML(""));Lc&&Lc(e),Ae=e}},xe=td({},[...sd,...ad,...ld]),Pe=td({},[...hd,...ud]),_e=function(e){Wc(n.removed,{element:e});try{C(e).removeChild(e)}catch(t){w(e)}},Le=function(e,t){try{Wc(n.removed,{attribute:t.getAttributeNode(e),from:t})}catch(r){Wc(n.removed,{attribute:null,from:t})}if(t.removeAttribute(e),"is"===e)if(ee||te)try{_e(t)}catch(r){}else try{t.setAttribute(e,"")}catch(r){}},He=function(e){let t=null,n=null;if(J)e="<remove></remove>"+e;else{const t=$c(e,/^[\r\n\t ]+/);n=t&&t[0]}"application/xhtml+xml"===be&&we===fe&&(e='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+e+"</body></html>");const i=S?S.createHTML(e):e;if(we===fe)try{t=(new p).parseFromString(i,be)}catch(s){}if(!t||!t.documentElement){t=E.createDocument(we,"template",null);try{t.documentElement.innerHTML=ye?R:i}catch(s){}}const o=t.body||t.documentElement;return e&&n&&o.insertBefore(r.createTextNode(n),o.childNodes[0]||null),we===fe?N.call(t,Q?"html":"body")[0]:Q?t.documentElement:o},ke=function(e){return b.call(e.ownerDocument||e,e,u.SHOW_ELEMENT|u.SHOW_COMMENT|u.SHOW_TEXT|u.SHOW_PROCESSING_INSTRUCTION|u.SHOW_CDATA_SECTION,null)},Fe=function(e){return e instanceof d&&("string"!=typeof e.nodeName||"string"!=typeof e.textContent||"function"!=typeof e.removeChild||!(e.attributes instanceof c)||"function"!=typeof e.removeAttribute||"function"!=typeof e.setAttribute||"string"!=typeof e.namespaceURI||"function"!=typeof e.insertBefore||"function"!=typeof e.hasChildNodes)},De=function(e){return"function"==typeof l&&e instanceof l};function Ve(e,t,r){Vc(e,(e=>{e.call(n,t,r,Ae)}))}const Ue=function(e){let t=null;if(Ve(M.beforeSanitizeElements,e,null),Fe(e))return _e(e),!0;const r=Ne(e.nodeName);if(Ve(M.uponSanitizeElement,e,{tagName:r,allowedTags:D}),e.hasChildNodes()&&!De(e.firstElementChild)&&Qc(/<[/\w]/g,e.innerHTML)&&Qc(/<[/\w]/g,e.textContent))return _e(e),!0;if(e.nodeType===Id)return _e(e),!0;if(q&&e.nodeType===Od&&Qc(/<[/\w]/g,e.data))return _e(e),!0;if(!D[r]||j[r]){if(!j[r]&&We(r)){if(W.tagNameCheck instanceof RegExp&&Qc(W.tagNameCheck,r))return!1;if(W.tagNameCheck instanceof Function&&W.tagNameCheck(r))return!1}if(oe&&!le[r]){const t=C(e)||e.parentNode,n=v(e)||e.childNodes;if(n&&t){for(let r=n.length-1;r>=0;--r){const i=f(n[r],!0);i.__removalCount=(e.__removalCount||0)+1,t.insertBefore(i,y(e))}}}return _e(e),!0}return e instanceof h&&!function(e){let t=C(e);t&&t.tagName||(t={namespaceURI:we,tagName:"template"});const n=Gc(e.tagName),r=Gc(t.tagName);return!!ve[e.namespaceURI]&&(e.namespaceURI===me?t.namespaceURI===fe?"svg"===n:t.namespaceURI===ge?"svg"===n&&("annotation-xml"===r||Se[r]):Boolean(xe[n]):e.namespaceURI===ge?t.namespaceURI===fe?"math"===n:t.namespaceURI===me?"math"===n&&Re[r]:Boolean(Pe[n]):e.namespaceURI===fe?!(t.namespaceURI===me&&!Re[r])&&!(t.namespaceURI===ge&&!Se[r])&&!Pe[n]&&(Ee[n]||!xe[n]):!("application/xhtml+xml"!==be||!ve[e.namespaceURI]))}(e)?(_e(e),!0):"noscript"!==r&&"noembed"!==r&&"noframes"!==r||!Qc(/<\/no(script|embed|frames)/i,e.innerHTML)?(X&&e.nodeType===Md&&(t=e.textContent,Vc([I,O,x],(e=>{t=Yc(t,e," ")})),e.textContent!==t&&(Wc(n.removed,{element:e.cloneNode()}),e.textContent=t)),Ve(M.afterSanitizeElements,e,null),!1):(_e(e),!0)},Be=function(e,t,n){if(re&&("id"===t||"name"===t)&&(n in r||n in Me))return!1;if($&&!G[t]&&Qc(P,t));else if(z&&Qc(_,t));else if(!U[t]||G[t]){if(!(We(e)&&(W.tagNameCheck instanceof RegExp&&Qc(W.tagNameCheck,e)||W.tagNameCheck instanceof Function&&W.tagNameCheck(e))&&(W.attributeNameCheck instanceof RegExp&&Qc(W.attributeNameCheck,t)||W.attributeNameCheck instanceof Function&&W.attributeNameCheck(t))||"is"===t&&W.allowCustomizedBuiltInElements&&(W.tagNameCheck instanceof RegExp&&Qc(W.tagNameCheck,n)||W.tagNameCheck instanceof Function&&W.tagNameCheck(n))))return!1}else if(de[t]);else if(Qc(F,Yc(n,H,"")));else if("src"!==t&&"xlink:href"!==t&&"href"!==t||"script"===e||0!==Kc(n,"data:")||!ue[e]){if(Y&&!Qc(L,Yc(n,H,"")));else if(n)return!1}else;return!0},We=function(e){return"annotation-xml"!==e&&$c(e,k)},je=function(e){Ve(M.beforeSanitizeAttributes,e,null);const{attributes:t}=e;if(!t||Fe(e))return;const r={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:U,forceKeepAttr:void 0};let i=t.length;for(;i--;){const s=t[i],{name:a,namespaceURI:l,value:h}=s,u=Ne(a);let c="value"===a?h:Xc(h);if(r.attrName=u,r.attrValue=c,r.keepAttr=!0,r.forceKeepAttr=void 0,Ve(M.uponSanitizeAttribute,e,r),c=r.attrValue,!ie||"id"!==u&&"name"!==u||(Le(a,e),c="user-content-"+c),q&&Qc(/((--!?|])>)|<\/(style|title)/i,c)){Le(a,e);continue}if(r.forceKeepAttr)continue;if(Le(a,e),!r.keepAttr)continue;if(!K&&Qc(/\/>/i,c)){Le(a,e);continue}X&&Vc([I,O,x],(e=>{c=Yc(c,e," ")}));const d=Ne(e.nodeName);if(Be(d,u,c)){if(S&&"object"==typeof g&&"function"==typeof g.getAttributeType)if(l);else switch(g.getAttributeType(d,u)){case"TrustedHTML":c=S.createHTML(c);break;case"TrustedScriptURL":c=S.createScriptURL(c)}try{l?e.setAttributeNS(l,a,c):e.setAttribute(a,c),Fe(e)?_e(e):Bc(n.removed)}catch(o){}}}Ve(M.afterSanitizeAttributes,e,null)},Ge=function e(t){let n=null;const r=ke(t);for(Ve(M.beforeSanitizeShadowDOM,t,null);n=r.nextNode();)Ve(M.uponSanitizeShadowNode,n,null),Ue(n),je(n),n.content instanceof s&&e(n.content);Ve(M.afterSanitizeShadowDOM,t,null)};return n.sanitize=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=null,o=null,a=null,h=null;if(ye=!e,ye&&(e="\x3c!--\x3e"),"string"!=typeof e&&!De(e)){if("function"!=typeof e.toString)throw Zc("toString is not a function");if("string"!=typeof(e=e.toString()))throw Zc("dirty is not a string, aborting")}if(!n.isSupported)return e;if(Z||Oe(t),n.removed=[],"string"==typeof e&&(se=!1),se){if(e.nodeName){const t=Ne(e.nodeName);if(!D[t]||j[t])throw Zc("root node is forbidden and cannot be sanitized in-place")}}else if(e instanceof l)r=He("\x3c!----\x3e"),o=r.ownerDocument.importNode(e,!0),o.nodeType===Ad&&"BODY"===o.nodeName||"HTML"===o.nodeName?r=o:r.appendChild(o);else{if(!ee&&!X&&!Q&&-1===e.indexOf("<"))return S&&ne?S.createHTML(e):e;if(r=He(e),!r)return ee?null:ne?R:""}r&&J&&_e(r.firstChild);const u=ke(se?e:r);for(;a=u.nextNode();)Ue(a),je(a),a.content instanceof s&&Ge(a.content);if(se)return e;if(ee){if(te)for(h=T.call(r.ownerDocument);r.firstChild;)h.appendChild(r.firstChild);else h=r;return(U.shadowroot||U.shadowrootmode)&&(h=A.call(i,h,!0)),h}let c=Q?r.outerHTML:r.innerHTML;return Q&&D["!doctype"]&&r.ownerDocument&&r.ownerDocument.doctype&&r.ownerDocument.doctype.name&&Qc(bd,r.ownerDocument.doctype.name)&&(c="<!DOCTYPE "+r.ownerDocument.doctype.name+">\n"+c),X&&Vc([I,O,x],(e=>{c=Yc(c,e," ")})),S&&ne?S.createHTML(c):c},n.setConfig=function(){Oe(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),Z=!0},n.clearConfig=function(){Ae=null,Z=!1},n.isValidAttribute=function(e,t,n){Ae||Oe({});const r=Ne(e),i=Ne(t);return Be(r,i,n)},n.addHook=function(e,t){"function"==typeof t&&Wc(M[e],t)},n.removeHook=function(e,t){if(void 0!==t){const n=Uc(M[e],t);return-1===n?void 0:jc(M[e],n,1)[0]}return Bc(M[e])},n.removeHooks=function(e){M[e]=[]},n.removeAllHooks=function(){M={afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}},n}();function Ld(e,t){const n=t.length;let r=0;for(;r<n;)e.push(t[r]),r+=1}function Hd(e){const t=[];if(!e||0===e.length||!e[0]||0===e[0].length)return t;const n=e.length,r=e[0].length;for(let i=0;i<n;i++)for(let n=0;n<r;n++)t[n]||(t[n]=[]),t[n][i]=e[i][n];return t}function kd(e,t,n,r){let i=-1,o=e,s=n;Array.isArray(e)||(o=Array.from(e));const a=o.length;for(r&&a&&(i+=1,s=o[i]),i+=1;i<a;)s=t(s,o[i],i,o),i+=1;return s}function Fd(e,t){let n=0,r=e;Array.isArray(e)||(r=Array.from(e));const i=r.length,o=[];let s=-1;for(;n<i;){const e=r[n];t(e,n,r)&&(s+=1,o[s]=e),n+=1}return o}function Dd(e,t){let n=0,r=e;Array.isArray(e)||(r=Array.from(e));const i=r.length,o=[];let s=-1;for(;n<i;){const e=r[n];s+=1,o[s]=t(e,n,r),n+=1}return o}function Vd(e,t){let n=0,r=e;Array.isArray(e)||(r=Array.from(e));const i=r.length;for(;n<i&&!1!==t(r[n],n,r);)n+=1;return e}function Ud(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const[r,...i]=[...t];let o=r;return Vd(i,(e=>{o=o.filter((t=>!e.includes(t)))})),o}function Bd(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:" ";return e.split(t)}function Wd(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const i=kd(e,((e,t,r)=>e+t.replace(/\r?\n\s*/g,"")+(n[r]?n[r]:"")),"");return i.trim()}function jd(e){let t;switch(typeof e){case"string":case"number":t=`${e}`;break;case"object":t=null===e?"":e.toString();break;case"undefined":t="";break;default:t=e.toString()}return t}function Gd(e){return void 0!==e}function zd(e){return void 0===e}function $d(e){return null===e||""===e||zd(e)}const Yd="length",Kd=e=>parseInt(e,16),Xd=e=>parseInt(e,10),qd=(e,t,n)=>e.substr(t,n),Qd=e=>e.codePointAt(0)-65,Zd=e=>`${e}`.replace(/\-/g,""),Jd=e=>Kd(qd(Zd(e),Kd("12"),Qd("F")))/(Kd(qd(Zd(e),Qd("B"),~~![][Yd]))||9),ep=()=>"undefined"!=typeof location&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host);let tp=!1;const np={invalid:()=>Wd`
    The license key for Handsontable is invalid.\x20
    If you need any help, contact us at support@handsontable.com.`,expired:e=>{let{keyValidityDate:t,hotVersion:n}=e;return Wd`
    The license key for Handsontable expired on ${t}, and is not valid for the installed\x20
    version ${n}. Renew your license key at handsontable.com or downgrade to a version released prior\x20
    to ${t}. If you need any help, contact us at sales@handsontable.com.`},missing:()=>Wd`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\x20
    us at support@handsontable.com.`,non_commercial:()=>""},rp={invalid:()=>Wd`
    The license key for Handsontable is invalid.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,expired:e=>{let{keyValidityDate:t,hotVersion:n}=e;return Wd`
    The license key for Handsontable expired on ${t}, and is not valid for the installed\x20
    version ${n}. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\x20
    license key or downgrade to a version released prior to ${t}. If you need any\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`},missing:()=>Wd`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,non_commercial:()=>""};function ip(e,t){const n=!$d(e),r="string"==typeof e&&"non-commercial-and-evaluation"===e.toLowerCase(),i="15.2.0";let o,s="invalid",a="invalid";const l=function(e){let t=[][Yd],n=t;if(e[Yd]!==Qd("Z"))return!1;for(let r="",i="B<H4P+".split(""),o=Qd(i.shift());o;o=Qd(i.shift()||"A"))--o<""[Yd]?n|=(Xd(`${Xd(Kd(r)+(Kd(qd(e,Math.abs(o),2))+[]).padStart(2,"0"))}`)%97||2)>>1:r=qd(e,o,o?1===i[Yd]?9:8:6);return n===t}(e=Zd(e||""));if(n||r||l)if(l){const t=M("19/03/2025","DD/MM/YYYY"),n=Math.floor(t.toDate().getTime()/864e5),r=Jd(e);o=M(864e5*(r+1),"x").format("MMMM DD, YYYY"),n>r?(s="expired",a="expired"):(s="valid",a="valid")}else r?(s="non_commercial",a="valid"):(s="invalid",a="invalid");else s="missing",a="missing";if(ep()&&(s="valid",a="valid"),!tp&&"valid"!==s){np[s]({keyValidityDate:o,hotVersion:i})&&console["non_commercial"===s?"info":"warn"](np[s]({keyValidityDate:o,hotVersion:i})),tp=!0}if("valid"!==a&&t.parentNode){if(rp[a]({keyValidityDate:o,hotVersion:i})){const e=document.createElement("div");e.className="handsontable hot-display-license-info",e.innerHTML=rp[a]({keyValidityDate:o,hotVersion:i}),t.parentNode.insertBefore(e,t.nextSibling)}}}function op(e){return e[0].toUpperCase()+e.substr(1)}function sp(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+e()+e()}function ap(e){return/^([0-9][0-9]?%$)|(^100%$)/.test(e)}function lp(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return`${e}`.replace(/(?:\\)?\[([^[\]]+)]/g,((e,n)=>"\\"===e.charAt(0)?e.substr(1,e.length-1):void 0===t[n]?"":t[n]))}function hp(e){return up(`${e}`,{ALLOWED_TAGS:[]})}function up(e,t){return _d.sanitize(e,t)}const cp=e=>["tabindex",e],dp=()=>["role","presentation"],pp=()=>["role","checkbox"],gp=e=>["aria-label",e],mp=()=>["aria-hidden","true"],fp=e=>["aria-haspopup",e],wp=e=>["aria-rowcount",e],yp=e=>["aria-colcount",e],vp=e=>["aria-rowindex",e],Cp=e=>["aria-colindex",e],Sp=e=>["aria-expanded",e],Rp=()=>["aria-readonly","true"],Ep=()=>["aria-invalid","true"],bp=e=>["aria-checked",e],Tp=e=>["aria-relevant",e],Np=e=>["aria-posinset",e];function Ap(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=-1,r=null,i=e;for(;null!==i;){if(n===t){r=i;break}i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:(n+=1,i=i.parentNode)}return r}function Mp(e,t){const n=e.closest(".handsontable");return!!n&&(n.parentNode===t||n===t)}function Ip(e){return function(e){return Object.getPrototypeOf(e.parent)&&e.frameElement}(e)&&e.parent}function Op(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;const{ELEMENT_NODE:r,DOCUMENT_FRAGMENT_NODE:i}=Node;let o=e;for(;null!=o&&o!==n;){const{nodeType:e,nodeName:n}=o;if(e===r&&(t.includes(n)||t.includes(o)))return o;const{host:s}=o;o=s&&e===i?s:o.parentNode}return null}function xp(e,t,n){const r=[];let i=e;for(;i&&(i=Op(i,t,n),i&&(!n||n.contains(i)));)r.push(i),i=i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i.host:i.parentNode;const o=r.length;return o?r[o-1]:null}function Pp(e,t){let n=e.parentNode,r=[];for("string"==typeof t?r=e.defaultView?Array.prototype.slice.call(e.querySelectorAll(t),0):Array.prototype.slice.call(e.ownerDocument.querySelectorAll(t),0):r.push(t);null!==n;){if(r.indexOf(n)>-1)return!0;n=n.parentNode}return!1}function _p(e,t,n){const r=n.parentElement.querySelector(`.ht_clone_${e}`);return r?r.contains(t):null}function Lp(e){return e&&e.length?e.filter((e=>!!e)):[]}function Hp(e,t){if(!e||!e.length)return t?{regexFree:[],regexes:[]}:[];const n=[],r=[];return r.push(...e.filter((e=>{const r=e instanceof RegExp;return r&&t&&n.push(e),!r}))),t?{regexFree:r,regexes:n}:r}function kp(e,t){return void 0!==e.classList&&"string"==typeof t&&""!==t&&e.classList.contains(t)}function Fp(e,t){"string"==typeof t&&(t=t.split(" ")),(t=Lp(t)).length>0&&e.classList.add(...t)}function Dp(e,t){"string"==typeof t?t=t.split(" "):t instanceof RegExp&&(t=[t]);let{regexFree:n,regexes:r}=Hp(t,!0);n=Lp(n),n.length>0&&e.classList.remove(...n),r.forEach((t=>{e.classList.forEach((n=>{t.test(n)&&e.classList.remove(n)}))}))}function Vp(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;Array.isArray(t)||(t=[[t,n]]),t.forEach((t=>{Array.isArray(t)&&""!==t[0]&&e.setAttribute(...t)}))}function Up(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];"string"==typeof t?t=t.split(" "):t instanceof RegExp&&(t=[t]);const{regexFree:n,regexes:r}=Hp(t,!0);n.forEach((t=>{""!==t&&e.removeAttribute(t)})),r.forEach((t=>{e.getAttributeNames().forEach((n=>{t.test(n)&&e.removeAttribute(n)}))}))}function Bp(e){if(3===e.nodeType)e.parentNode.removeChild(e);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(e.nodeName)>-1){const t=e.childNodes;for(let e=t.length-1;e>=0;e--)Bp(t[e])}}function Wp(e){let t;for(;t=e.lastChild;)e.removeChild(t)}const jp=/(<(.*)>|&(.*);)/;function Gp(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];jp.test(t)?e.innerHTML=n?up(t):t:zp(e,t)}function zp(e,t){const n=e.firstChild;n&&3===n.nodeType&&null===n.nextSibling?n.textContent=t:(Wp(e),e.appendChild(e.ownerDocument.createTextNode(t)))}function $p(e){const t=e.ownerDocument.documentElement,n=e.ownerDocument.defaultView;let r=e;for(;r!==t;){if(null===r)return!1;if(r.nodeType===Node.DOCUMENT_FRAGMENT_NODE){if(r.host){if(r.host.impl)return $p(r.host.impl);if(r.host)return $p(r.host);throw new Error("Lost in Web Components world")}return!1}if("none"===n.getComputedStyle(r).display)return!1;r=r.parentNode}return!0}function Yp(e){const t=e.ownerDocument,n=t.defaultView,r=t.documentElement;let i,o,s,a=e;for(i=a.offsetLeft,o=a.offsetTop,s=a;(a=a.offsetParent)&&a!==t.body&&"offsetLeft"in a;)i+=a.offsetLeft,o+=a.offsetTop,s=a;return s&&"fixed"===s.style.position&&(i+=n.pageXOffset||r.scrollLeft,o+=n.pageYOffset||r.scrollTop),{left:i,top:o}}function Kp(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:window).scrollY}function Xp(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:window).scrollX}function qp(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;return e===t?Kp(t):e.scrollTop}function Qp(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;return e===t?Xp(t):e.scrollLeft}function Zp(e){let t=e.ownerDocument,n=t?t.defaultView:void 0;t||(t=e.document?e.document:e,n=t.defaultView);const r=["auto","scroll"];let i=e.parentNode;for(;i&&i.style&&t.body!==i;){let{overflow:e,overflowX:t,overflowY:o}=i.style;if([e,t,o].includes("scroll"))return i;if(({overflow:e,overflowX:t,overflowY:o}=n.getComputedStyle(i)),r.includes(e)||r.includes(t)||r.includes(o))return i;if(i.clientHeight<=i.scrollHeight+1&&(r.includes(o)||r.includes(e)))return i;if(i.clientWidth<=i.scrollWidth+1&&(r.includes(t)||r.includes(e)))return i;i=i.parentNode}return n}function Jp(e){const t=e.ownerDocument,n=t.defaultView;let r=e.parentNode;for(;r&&r.style&&t.body!==r;){if("visible"!==r.style.overflow&&""!==r.style.overflow)return r;const e=n.getComputedStyle(r),t=["scroll","hidden","auto"],i=e.getPropertyValue("overflow"),o=e.getPropertyValue("overflow-y"),s=e.getPropertyValue("overflow-x");if(t.includes(i)||t.includes(o)||t.includes(s))return r;r=r.parentNode}return n}function eg(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:window;if(!e)return;if(e===n)return"width"===t?`${n.innerWidth}px`:"height"===t?`${n.innerHeight}px`:void 0;const r=e.style[t];if(""!==r&&void 0!==r)return r;const i=n.getComputedStyle(e);return""!==i[t]&&void 0!==i[t]?i[t]:void 0}function tg(e){return e.offsetWidth}function ng(e){return e.offsetHeight}function rg(e){return e.clientHeight||e.innerHeight}function ig(e){return e.clientWidth||e.innerWidth}function og(e){return e.selectionStart?e.selectionStart:0}function sg(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window;e.getSelection&&(e.getSelection().empty?e.getSelection().empty():e.getSelection().removeAllRanges&&e.getSelection().removeAllRanges())}function ag(e,t,n){if(void 0===n&&(n=t),e.setSelectionRange){e.focus();try{e.setSelectionRange(t,n)}catch(r){const i=e.parentNode,o=i.style.display;i.style.display="block",e.setSelectionRange(t,n),i.style.display=o}}}let lg;function hg(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document;return void 0===lg&&(lg=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document;const t=e.createElement("div");t.style.height="200px",t.style.width="100%";const n=e.createElement("div");n.style.boxSizing="content-box",n.style.height="150px",n.style.left="0px",n.style.overflow="hidden",n.style.position="absolute",n.style.top="0px",n.style.width="200px",n.style.visibility="hidden",n.appendChild(t),(e.body||e.documentElement).appendChild(n);const r=t.offsetWidth;n.style.overflow="scroll";let i=t.offsetWidth;return r===i&&(i=n.clientWidth),(e.body||e.documentElement).removeChild(n),r-i}(e)),lg}function ug(e){return e instanceof Window?e.document.body.scrollHeight>e.innerHeight:e.offsetWidth!==e.clientWidth}function cg(e){return e instanceof Window?e.document.body.scrollWidth>e.innerWidth:e.offsetHeight!==e.clientHeight}function dg(e,t,n){e.style.transform=`translate3d(${t},${n},0)`}function pg(e){e.style.transform&&""!==e.style.transform&&(e.style.transform="")}function gg(e){return e&&(["INPUT","SELECT","TEXTAREA"].indexOf(e.nodeName)>-1||"true"===e.contentEditable)}function mg(e){return gg(e)&&!1===e.hasAttribute("data-hot-input")}function fg(e){return!e.parentNode}function wg(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const r=e.ownerDocument,i=r.createRange(),o=r.defaultView.getSelection();Vp(e,"contenteditable",!0),n&&Vp(e,...mp()),t&&Fp(e,"invisibleSelection"),i.selectNodeContents(e),o.removeAllRanges(),o.addRange(i)}function yg(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const n=e.ownerDocument.defaultView.getSelection();e.hasAttribute("aria-hidden")&&e.removeAttribute("aria-hidden"),n.removeAllRanges(),t&&Dp(e,"invisibleSelection"),e.removeAttribute("contenteditable")}function vg(e){var t;const n=null==e||null===(t=e.ownerDocument)||void 0===t?void 0:t.defaultView.Element;return!!(n&&null!==n&&e instanceof n)}function Cg(e){return"function"==typeof e}function Sg(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,r=null;return function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r&&clearTimeout(r),r=setTimeout((()=>{t=e.apply(this,o)}),n),t}}function Rg(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return e.apply(this,n.concat(r))}}function Eg(e,t,n,r,i,o,s,a){return Gd(a)?e.call(t,n,r,i,o,s,a):Gd(s)?e.call(t,n,r,i,o,s):Gd(o)?e.call(t,n,r,i,o):Gd(i)?e.call(t,n,r,i):Gd(r)?e.call(t,n,r):Gd(n)?e.call(t,n):e.call(t)}var bg=Uo,Tg=pe,Ng=J,Ag=ro,Mg=X([].push),Ig=Ti,Og=ye,xg=Oi,Pg=F,_g=X,Lg=P,Hg=pe,kg=De,Fg=Pu,Dg=function(e){if(Tg(e))return e;if(bg(e)){for(var t=e.length,n=[],r=0;r<t;r++){var i=e[r];"string"==typeof i?Mg(n,i):"number"!=typeof i&&"Number"!==Ng(i)&&"String"!==Ng(i)||Mg(n,Ag(i))}var o=n.length,s=!0;return function(e,t){if(s)return s=!1,t;if(bg(this))return t;for(var r=0;r<o;r++)if(n[r]===e)return t}}},Vg=Pe,Ug=String,Bg=Og("JSON","stringify"),Wg=_g(/./.exec),jg=_g("".charAt),Gg=_g("".charCodeAt),zg=_g("".replace),$g=_g(1..toString),Yg=/[\uD800-\uDFFF]/g,Kg=/^[\uD800-\uDBFF]$/,Xg=/^[\uDC00-\uDFFF]$/,qg=!Vg||Lg((function(){var e=Og("Symbol")("stringify detection");return"[null]"!==Bg([e])||"{}"!==Bg({a:e})||"{}"!==Bg(Object(e))})),Qg=Lg((function(){return'"\\udf06\\ud834"'!==Bg("\udf06\ud834")||'"\\udead"'!==Bg("\udead")})),Zg=function(e,t){var n=Fg(arguments),r=Dg(t);if(Hg(r)||void 0!==e&&!kg(e))return n[1]=function(e,t){if(Hg(r)&&(t=Pg(r,this,Ug(e),t)),!kg(t))return t},xg(Bg,null,n)},Jg=function(e,t,n){var r=jg(n,t-1),i=jg(n,t+1);return Wg(Kg,e)&&!Wg(Xg,i)||Wg(Xg,e)&&!Wg(Kg,r)?"\\u"+$g(Gg(e,0),16):e};function em(e){let t;return Array.isArray(e)?t=e.length?new Array(e.length).fill(null):[]:(t={},hm(e,((e,n)=>{"__children"!==n&&(e&&"object"==typeof e&&!Array.isArray(e)?t[n]=em(e):Array.isArray(e)?e.length&&"object"==typeof e[0]&&!Array.isArray(e[0])?t[n]=[em(e[0])]:t[n]=[]:t[n]=null)}))),t}function tm(e,t,n){const r=Array.isArray(n);return hm(t,((t,i)=>{(!1===r||n.includes(i))&&(e[i]=t)})),e}function nm(e,t){hm(t,((n,r)=>{t[r]&&"object"==typeof t[r]?(e[r]||(Array.isArray(t[r])?e[r]=[]:"[object Date]"===Object.prototype.toString.call(t[r])?e[r]=t[r]:e[r]={}),nm(e[r],t[r])):e[r]=t[r]}))}function rm(e){return"object"==typeof e?JSON.parse(JSON.stringify(e)):e}function im(e){const t={};return hm(e,((e,n)=>{t[n]=e})),t}function om(e){e.MIXINS||(e.MIXINS=[]);for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return Vd(n,(t=>{e.MIXINS.push(t.MIXIN_NAME),hm(t,((t,n)=>{if(void 0!==e.prototype[n])throw new Error(`Mixin conflict. Property '${n}' already exist and cannot be overwritten.`);if("function"==typeof t)e.prototype[n]=t;else{const r=function(e,t){const n=`_${e}`;return function(){return void 0===this[n]&&(this[n]=(e=>{let t=e;return(Array.isArray(t)||am(t))&&(t=rm(t)),t})(t)),this[n]}},i=function(e){const t=`_${e}`;return function(e){this[t]=e}};Object.defineProperty(e.prototype,n,{get:r(n,t),set:i(n),configurable:!0})}}))})),e}function sm(e,t){return JSON.stringify(e)===JSON.stringify(t)}function am(e){return"[object Object]"===Object.prototype.toString.call(e)}function lm(e,t,n,r){r.value=n,r.writable=!1!==r.writable,r.enumerable=!1!==r.enumerable,r.configurable=!1!==r.configurable,Object.defineProperty(e,t,r)}function hm(e,t){for(const n in e)if((!e.hasOwnProperty||e.hasOwnProperty&&Object.prototype.hasOwnProperty.call(e,n))&&!1===t(e[n],n,e))break;return e}function um(e,t,n){const r=t.split(".");let i=e;r.forEach(((e,t)=>{"__proto__"!==e&&"constructor"!==e&&"prototype"!==e&&(t!==r.length-1?(pm(i,e)||(i[e]={}),i=i[e]):i[e]=n)}))}function cm(e){if(!am(e))return 0;const t=function(e){let n=0;return am(e)?hm(e,((e,r)=>{"__children"!==r&&(n+=t(e))})):n+=1,n};return t(e)}function dm(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"value";const n=`_${t}`,r={_touched:!1,[n]:e,isTouched(){return this._touched}};return Object.defineProperty(r,t,{get(){return this[n]},set(e){this._touched=!0,this[n]=e},enumerable:!0,configurable:!0}),r}function pm(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function gm(e){return window.requestAnimationFrame(e)}function mm(e){window.cancelAnimationFrame(e)}function fm(){return"ontouchstart"in window}let wm;Bg&&Ig({target:"JSON",stat:!0,arity:3,forced:qg||Qg},{stringify:function(e,t,n){var r=Fg(arguments),i=xg(qg?Zg:Bg,null,r);return Qg&&"string"==typeof i?zg(i,Yg,Jg):i}});const ym=e=>{const t={value:!1,test:(n,r)=>{t.value=e(n,r)}};return t},vm={chrome:ym(((e,t)=>/Chrome/.test(e)&&/Google/.test(t))),chromeWebKit:ym((e=>/CriOS/.test(e))),edge:ym((e=>/Edge/.test(e))),edgeWebKit:ym((e=>/EdgiOS/.test(e))),firefox:ym((e=>/Firefox/.test(e))),firefoxWebKit:ym((e=>/FxiOS/.test(e))),mobile:ym((e=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(e))),safari:ym(((e,t)=>/Safari/.test(e)&&/Apple Computer/.test(t)))},Cm={mac:ym((e=>/^Mac/.test(e))),win:ym((e=>/^Win/.test(e))),linux:ym((e=>/^Linux/.test(e))),ios:ym((e=>/iPhone|iPad|iPod/i.test(e)))};function Sm(){return vm.chrome.value}function Rm(){return vm.firefox.value}function Em(){return vm.safari.value}function bm(){return vm.mobile.value}function Tm(){return Cm.ios.value}function Nm(){let{maxTouchPoints:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:navigator;return e>2&&Cm.mac.value}function Am(){return Cm.win.value}function Mm(){return Cm.mac.value}"undefined"!=typeof window&&(function(){let{userAgent:e=navigator.userAgent,vendor:t=navigator.vendor}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};hm(vm,(n=>{let{test:r}=n;r(e,t)}))}(),function(){let{platform:e=navigator.platform}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};hm(Cm,(t=>{let{test:n}=t;n(e)}))}());const Im={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:Rm()?182:174,AUDIO_MUTE:Rm()?181:173,AUDIO_UP:Rm()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},Om=[Im.ALT,Im.ARROW_DOWN,Im.ARROW_LEFT,Im.ARROW_RIGHT,Im.ARROW_UP,Im.AUDIO_DOWN,Im.AUDIO_MUTE,Im.AUDIO_UP,Im.BACKSPACE,Im.CAPS_LOCK,Im.DELETE,Im.END,Im.ENTER,Im.ESCAPE,Im.F1,Im.F2,Im.F3,Im.F4,Im.F5,Im.F6,Im.F7,Im.F8,Im.F9,Im.F10,Im.F11,Im.F12,Im.F13,Im.F14,Im.F15,Im.F16,Im.F17,Im.F18,Im.F19,Im.HOME,Im.INSERT,Im.MEDIA_NEXT,Im.MEDIA_PLAY_PAUSE,Im.MEDIA_PREV,Im.MEDIA_STOP,Im.NULL,Im.NUM_LOCK,Im.PAGE_DOWN,Im.PAGE_UP,Im.PAUSE,Im.SCROLL_LOCK,Im.SHIFT,Im.TAB];function xm(e){return Om.includes(e)}function Pm(e,t){const n=t.split("|");let r=!1;return Vd(n,(t=>{if(e===Im[t])return r=!0,!1})),r}function _m(e){e.isImmediatePropagationEnabled=!1,e.cancelBubble=!0}function Lm(e){return!1===e.isImmediatePropagationEnabled}function Hm(e){return 2===e.button}function km(e){return 0===e.button}function Fm(){Gd(console)&&console.warn(...arguments)}function Dm(){Gd(console)&&console.error(...arguments)}const Vm=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","beforeViewportScrollVertically","beforeViewportScrollHorizontally","beforeViewportScroll","afterScrollHorizontally","afterScrollVertically","afterScroll","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSelectionFocusSet","beforeSelectColumns","afterSelectColumns","beforeSelectRows","afterSelectRows","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterSetTheme","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeRowWrap","beforeColumnWrap","beforeSetCellMeta","beforeSelectionFocusSet","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeSelectionHighlightSet","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyFiltersMultiSelectValue","modifyFocusedElement","modifyRowHeader","modifyRowHeight","modifyRowHeightByOverlayName","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","modifyGetCoordsElement","modifyFocusOnTabNavigation","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformFocus","modifyTransformStart","modifyTransformEnd","afterModifyTransformFocus","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","beforeBeginEditing","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],Um=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),Bm=new Map([[]]);var Wm=kr,jm=O,Gm=Mt,zm=xl,$m=en.f,Ym=Gm("unscopables"),Km=Array.prototype;void 0===Km[Ym]&&$m(Km,Ym,{configurable:!0,value:zm(null)});var Xm=function(e){Km[Ym][e]=!0},qm=Ti,Qm=Ge,Zm=ce,Jm=function(e,t,n){for(var r=0,i=arguments.length>2?n:Wm(t),o=new e(i);i>r;)o[r]=t[r++];return o},ef=function(e,t){var n=jm[e],r=n&&n.prototype;return r&&r[t]},tf=Xm,nf=Array,rf=X(ef("Array","sort"));qm({target:"Array",proto:!0},{toSorted:function(e){void 0!==e&&Qm(e);var t=Zm(this),n=Jm(nf,t);return rf(n,e)}}),tf("toSorted");var of=wu,sf=Ge,af=sn,lf=Ss;function hf(e,t,n){uf(e,t),t.set(e,n)}function uf(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function cf(e,t,n){return e.set(pf(e,t),n),n}function df(e,t){return e.get(pf(e,t))}function pf(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}Ti({target:"Iterator",proto:!0,real:!0},{find:function(e){af(this),sf(e);var t=lf(this),n=0;return of(t,(function(t,r){if(e(t,n++))return r(t)}),{IS_RECORD:!0,INTERRUPTED:!0}).result}});var gf=new WeakMap,mf=new WeakMap,ff=new WeakMap,wf=new WeakSet;class yf{constructor(){var e,t;uf(e=this,t=wf),t.add(e),hf(this,gf,new Map),hf(this,mf,new Map),hf(this,ff,new Set),Vm.forEach((e=>pf(wf,this,vf).call(this,e)))}getHooks(e){var t;return null!==(t=df(gf,this).get(e))&&void 0!==t?t:[]}add(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};df(gf,this).has(e)||(pf(wf,this,vf).call(this,e),Vm.push(e));const r=df(gf,this).get(e);if(r.find((e=>e.callback===t)))return;const i=Number.isInteger(n.orderIndex)?n.orderIndex:0,o=!!n.runOnce,s=!!n.initialHook;let a=!1;if(s){const e=r.find((e=>e.initialHook));e&&(e.callback=t,a=!0)}if(!a){r.push({callback:t,orderIndex:i,runOnce:o,initialHook:s,skip:!1});let n=df(ff,this).has(e);n||0===i||(n=!0,df(ff,this).add(e)),n&&r.length>1&&df(gf,this).set(e,r.toSorted(((e,t)=>e.orderIndex-t.orderIndex)))}}has(e){return df(gf,this).has(e)&&df(gf,this).get(e).length>0}remove(e,t){if(!df(gf,this).has(e))return!1;const n=df(gf,this).get(e),r=n.find((e=>e.callback===t));if(r){let t=df(mf,this).get(e);return r.skip=!0,t+=1,t>100&&(df(gf,this).set(e,n.filter((e=>!e.skip))),t=0),df(mf,this).set(e,t),!0}return!1}destroy(){df(gf,this).clear(),df(mf,this).clear(),cf(gf,this,null),cf(mf,this,null)}}function vf(e){df(gf,this).set(e,[]),df(mf,this).set(e,0)}function Cf(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const Sf=Wd`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\x20
  learn about the migration path.`;class Rf{constructor(){Cf(this,"globalBucket",new yf)}static getSingleton(){return Ef}getBucket(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return e?(e.pluginHookBucket||(e.pluginHookBucket=new yf),e.pluginHookBucket):this.globalBucket}add(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3?arguments[3]:void 0;return Array.isArray(t)?Vd(t,(t=>this.add(e,t,n))):(Um.has(e)&&Fm(lp(Sf,{hookName:e,removedInVersion:Um.get(e)})),Bm.has(e)&&Fm(Bm.get(e)),this.getBucket(n).add(e,t,{orderIndex:r,runOnce:!1})),this}once(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3?arguments[3]:void 0;return Array.isArray(t)?Vd(t,(t=>this.once(e,t,n))):this.getBucket(n).add(e,t,{orderIndex:r,runOnce:!0}),this}addAsFixed(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return Array.isArray(t)?Vd(t,(t=>this.addAsFixed(e,t,n))):this.getBucket(n).add(e,t,{initialHook:!0}),this}remove(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return this.getBucket(n).remove(e,t)}has(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this.getBucket(t).has(e)}run(e,t,n,r,i,o,s,a){{const l=this.getBucket().getHooks(t),h=l?l.length:0;let u=0;if(h)for(;u<h;){if(!l[u]||l[u].skip){u+=1;continue}const h=Eg(l[u].callback,e,n,r,i,o,s,a);void 0!==h&&(n=h),l[u]&&l[u].runOnce&&this.remove(t,l[u].callback),u+=1}}{const l=this.getBucket(e).getHooks(t),h=l?l.length:0;let u=0;if(h)for(;u<h;){if(!l[u]||l[u].skip){u+=1;continue}const h=Eg(l[u].callback,e,n,r,i,o,s,a);void 0!==h&&(n=h),l[u]&&l[u].runOnce&&this.remove(t,l[u].callback,e),u+=1}}return n}destroy(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.getBucket(e).destroy()}register(e){this.isRegistered(e)||Vm.push(e)}deregister(e){this.isRegistered(e)&&Vm.splice(Vm.indexOf(e),1)}isDeprecated(e){return Bm.has(e)||Um.has(e)}isRegistered(e){return Vm.indexOf(e)>=0}getRegistered(){return Vm}}const Ef=new Rf;const bf=new Map;function Tf(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"common";bf.has(e)||bf.set(e,new Map);const t=bf.get(e);return{register:function(e,n){t.set(e,n)},getItem:function(e){return t.get(e)},hasItem:function(e){return t.has(e)},getNames:function(){return[...t.keys()]},getValues:function(){return[...t.values()]}}}const Nf=new WeakMap,{register:Af,getItem:Mf,hasItem:If,getNames:Of,getValues:xf}=Tf("editors");function Pf(e){const t={},n=e;this.getConstructor=function(){return e},this.getInstance=function(e){return e.guid in t||(t[e.guid]=new n(e)),t[e.guid]},Rf.getSingleton().add("afterDestroy",(function(){t[this.guid]=null}))}function _f(e,t){let n;if("function"==typeof e)Nf.get(e)||Hf(null,e),n=Nf.get(e);else{if("string"!=typeof e)throw Error('Only strings and functions can be passed as "editor" parameter');n=Mf(e)}if(!n)throw Error(`No editor registered under name "${e}"`);return n.getInstance(t)}function Lf(e){if("function"==typeof e)return e;if(!If(e))throw Error(`No registered editor found under "${e}" name`);return Mf(e).getConstructor()}function Hf(e,t){e&&"string"!=typeof e&&(e=(t=e).EDITOR_TYPE);const n=new Pf(t);"string"==typeof e&&Af(e,n),Nf.set(t,n)}function kf(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const Ff=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;kf(this,"context",void 0),this.context=e||this,this.context.eventListeners||(this.context.eventListeners=[])}addEventListener(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];function i(e){n.call(this,function(e){const t=e.stopImmediatePropagation;return e.stopImmediatePropagation=function(){t.apply(this),_m(this)},e}(e))}return this.context.eventListeners.push({element:e,event:t,callback:n,callbackProxy:i,options:r,eventManager:this}),e.addEventListener(t,i,r),()=>{this.removeEventListener(e,t,n)}}removeEventListener(e,t,n){let r,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=this.context.eventListeners.length;for(;o;)if(o-=1,r=this.context.eventListeners[o],r.event===t&&r.element===e){if(n&&n!==r.callback)continue;if(i&&r.eventManager!==this)continue;this.context.eventListeners.splice(o,1),r.element.removeEventListener(r.event,r.callbackProxy,r.options)}}clearEvents(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.context)return;let t=this.context.eventListeners.length;for(;t;){t-=1;const n=this.context.eventListeners[t];e&&n.eventManager!==this||(this.context.eventListeners.splice(t,1),n.element.removeEventListener(n.event,n.callbackProxy,n.options))}}clear(){this.clearEvents()}destroy(){this.clearEvents(),this.context=null}destroyWithOwnEventsOnly(){this.clearEvents(!0),this.context=null}fireEvent(e,t){let n=e.document,r=e;n||(n=e.ownerDocument?e.ownerDocument:e,r=n.defaultView);const i={bubbles:!0,cancelable:"mousemove"!==t,view:r,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0};let o;n.createEvent?(o=n.createEvent("MouseEvents"),o.initMouseEvent(t,i.bubbles,i.cancelable,i.view,i.detail,i.screenX,i.screenY,i.clientX,i.clientY,i.ctrlKey,i.altKey,i.shiftKey,i.metaKey,i.button,n.body.parentNode)):o=n.createEventObject(),e.dispatchEvent?e.dispatchEvent(o):e.fireEvent(`on${t}`,o)}};function Df(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function Vf(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Uf(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var Bf=new WeakSet;class Wf{constructor(e,t,n){Df(this,Bf),Vf(this,"hot",void 0),Vf(this,"tableMeta",void 0),Vf(this,"selection",void 0),Vf(this,"eventManager",void 0),Vf(this,"destroyed",!1),Vf(this,"activeEditor",void 0),Vf(this,"cellProperties",void 0),this.hot=e,this.tableMeta=t,this.selection=n,this.eventManager=new Ff(e),this.hot.addHook("afterDocumentKeyDown",(e=>Uf(Bf,this,jf).call(this,e))),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"compositionstart",(e=>{!this.destroyed&&this.hot.isListening()&&this.openEditor("",e)})),this.hot.view._wt.update("onCellDblClick",((e,t,n)=>Uf(Bf,this,Gf).call(this,e,t,n)))}getActiveEditor(){return this.activeEditor}prepareEditor(){var e;if(this.activeEditor&&this.activeEditor.isWaiting())return void this.closeEditor(!1,!1,(e=>{e&&this.prepareEditor()}));const t=null===(e=this.hot.getSelectedRangeLast())||void 0===e?void 0:e.highlight;if(!t||t.isHeader())return;const{row:n,col:r}=t,i=this.hot.runHooks("modifyGetCellCoords",n,r,!1,"meta");let o=n,s=r;if(Array.isArray(i)&&([o,s]=i),this.cellProperties=this.hot.getCellMeta(o,s),!this.isCellEditable())return void this.clearActiveEditor();const a=this.hot.getCell(n,r,!0);if(a){const e=this.hot.getCellEditor(this.cellProperties),t=this.hot.colToProp(s),i=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(o),s);this.activeEditor=_f(e,this.hot),this.activeEditor.prepare(n,r,t,a,i,this.cellProperties)}}isEditorOpened(){return this.activeEditor&&this.activeEditor.isOpened()}openEditor(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!this.isCellEditable())return void this.clearActiveEditor();const r=this.hot.getSelectedRangeLast();let i=this.hot.runHooks("beforeBeginEditing",r.highlight.row,r.highlight.col,e,t,n);t instanceof MouseEvent&&"boolean"!=typeof i&&(i=0===this.hot.selection.getLayerLevel()&&r.isSingle()),!1!==i?(this.activeEditor||(this.hot.scrollToFocusedCell(),this.prepareEditor()),this.activeEditor&&(n&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(e,t))):this.clearActiveEditor()}closeEditor(e,t,n){this.activeEditor?this.activeEditor.finishEditing(e,t,n):n&&n(!1)}closeEditorAndSaveChanges(e){this.closeEditor(!1,e)}closeEditorAndRestoreOriginalValue(e){this.closeEditor(!0,e)}clearActiveEditor(){this.activeEditor=void 0}isCellEditable(){const e=this.hot.getSelectedRangeLast();if(!e)return!1;const t=this.hot.getCellEditor(this.cellProperties),{row:n,col:r}=e.highlight,{rowIndexMapper:i,columnIndexMapper:o}=this.hot,s=i.isHidden(this.hot.toPhysicalRow(n))||o.isHidden(this.hot.toPhysicalColumn(r));return!(this.cellProperties.readOnly||!t||s)}moveSelectionAfterEnter(e){const t={..."function"==typeof this.tableMeta.enterMoves?this.tableMeta.enterMoves(e):this.tableMeta.enterMoves};e.shiftKey&&(t.row=-t.row,t.col=-t.col),this.hot.selection.isMultiple()?this.selection.transformFocus(t.row,t.col):this.selection.transformStart(t.row,t.col,!0)}destroy(){this.destroyed=!0,this.eventManager.destroy()}}function jf(e){const t=this.hot.getSelectedRangeLast();if(!this.hot.isListening()||!t||t.highlight.isHeader()||Lm(e))return;const{keyCode:n}=e,r=(e.ctrlKey||e.metaKey)&&!e.altKey;(!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&(xm(n)||function(e){return[Im.CONTROL,Im.COMMAND_LEFT,Im.COMMAND_RIGHT,Im.COMMAND_FIREFOX].includes(e)}(n)||r||this.isEditorOpened()||this.openEditor("",e))}function Gf(e,t){t.isCell()&&this.openEditor(null,e,!0)}const zf=new WeakMap;Wf.getInstance=function(e,t,n){let r=zf.get(e);return r||(r=new Wf(e,t,n),zf.set(e,r)),r};const $f=Wf;function Yf(e,t,n){Kf(e,t),t.set(e,n)}function Kf(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Xf(e,t){return e.get(Qf(e,t))}function qf(e,t,n){return e.set(Qf(e,t),n),n}function Qf(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}const Zf=Object.freeze({CELL:"cell",MIXED:"mixed"});var Jf=new WeakMap,ew=new WeakMap,tw=new WeakMap,nw=new WeakMap,rw=new WeakMap,iw=new WeakSet;class ow{constructor(e){var t,n,r=this;Kf(t=this,n=iw),n.add(t),Yf(this,Jf,void 0),Yf(this,ew,void 0),Yf(this,tw,1),Yf(this,nw,null),Yf(this,rw,new Map);const i=e.getSettings();qf(Jf,this,e),qf(ew,this,i.imeFastEdit?Zf.MIXED:Zf.CELL),Xf(Jf,this).addHook("afterUpdateSettings",(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Qf(iw,r,hw).call(r,...t)})),Xf(Jf,this).addHook("afterSelection",(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Qf(iw,r,aw).call(r,...t)})),Xf(Jf,this).addHook("afterSelectionFocusSet",(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Qf(iw,r,aw).call(r,...t)})),Xf(Jf,this).addHook("afterSelectionEnd",(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Qf(iw,r,lw).call(r,...t)}))}getFocusMode(){return Xf(ew,this)}setFocusMode(e){Object.values(Zf).includes(e)?qf(ew,this,e):Fm(`"${e}" is not a valid focus mode.`)}getRefocusDelay(){return Xf(tw,this)}setRefocusDelay(e){qf(tw,this,e)}setRefocusElementGetter(e){qf(nw,this,e)}getRefocusElement(){var e;return"function"==typeof Xf(nw,this)?Xf(nw,this).call(this):null===(e=Xf(Jf,this).getActiveEditor())||void 0===e?void 0:e.TEXTAREA}focusOnHighlightedCell(e){const t=e=>{var t,n;const r=null===(t=Xf(Jf,this).getSelectedRangeLast())||void 0===t?void 0:t.highlight;if(!r)return;let i=Xf(Jf,this).runHooks("modifyFocusedElement",r.row,r.col,e);vg(i)||(i=e),!i||null!==(n=Xf(Jf,this).getActiveEditor())&&void 0!==n&&n.isOpened()||i.focus({preventScroll:!0})};e?t(e):Qf(iw,this,sw).call(this,(e=>t(e)))}refocusToEditorTextarea(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Xf(tw,this);var n,r;!Xf(Jf,this).getSettings().imeFastEdit||null!==(e=Xf(Jf,this).getActiveEditor())&&void 0!==e&&e.isOpened()||(null===(n=Xf(Jf,this).getActiveEditor())||void 0===n||null===(r=n.refreshValue)||void 0===r||r.call(n),Xf(rw,this).has(t)||Xf(rw,this).set(t,Sg((()=>{var e;null===(e=this.getRefocusElement())||void 0===e||e.select()}),t)),Xf(rw,this).get(t)())}}function sw(e){var t;const n=null===(t=Xf(Jf,this).getSelectedRangeLast())||void 0===t?void 0:t.highlight;if(!n||!Xf(Jf,this).selection.isCellVisible(n))return void e(null);const r=Xf(Jf,this).getCell(n.row,n.col,!0);null===r?Xf(Jf,this).addHookOnce("afterScroll",(()=>{e(Xf(Jf,this).getCell(n.row,n.col,!0))})):e(r)}function aw(){Qf(iw,this,sw).call(this,(e=>{const{activeElement:t}=Xf(Jf,this).rootDocument;t&&mg(t)&&t.blur(),this.focusOnHighlightedCell(e)}))}function lw(){Qf(iw,this,sw).call(this,(e=>{this.getFocusMode()===Zf.MIXED&&"TD"===(null==e?void 0:e.nodeName)&&this.refocusToEditorTextarea()}))}function hw(e){"boolean"==typeof e.imeFastEdit&&this.setFocusMode(e.imeFastEdit?Zf.MIXED:Zf.CELL)}var uw=me,cw=J,dw=Mt("match"),pw=sn,gw=F,mw=gt,fw=ve,ww=function(){var e=pw(this),t="";return e.hasIndices&&(t+="d"),e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.unicodeSets&&(t+="v"),e.sticky&&(t+="y"),t},yw=RegExp.prototype,vw=X,Cw=ct,Sw=Math.floor,Rw=vw("".charAt),Ew=vw("".replace),bw=vw("".slice),Tw=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,Nw=/\$([$&'`]|\d{1,2})/g,Aw=Ti,Mw=F,Iw=X,Ow=le,xw=pe,Pw=oe,_w=function(e){var t;return uw(e)&&(void 0!==(t=e[dw])?!!t:"RegExp"===cw(e))},Lw=ro,Hw=Ye,kw=function(e){var t=e.flags;return void 0!==t||"flags"in yw||mw(e,"flags")||!fw(yw,e)?t:gw(ww,e)},Fw=function(e,t,n,r,i,o){var s=n+e.length,a=r.length,l=Nw;return void 0!==i&&(i=Cw(i),l=Tw),Ew(o,l,(function(o,l){var h;switch(Rw(l,0)){case"$":return"$";case"&":return e;case"`":return bw(t,0,n);case"'":return bw(t,s);case"<":h=i[bw(l,1,-1)];break;default:var u=+l;if(0===u)return o;if(u>a){var c=Sw(u/10);return 0===c?o:c<=a?void 0===r[c-1]?Rw(l,1):r[c-1]+Rw(l,1):o}h=r[u-1]}return void 0===h?"":h}))},Dw=Mt("replace"),Vw=TypeError,Uw=Iw("".indexOf);Iw("".replace);var Bw=Iw("".slice),Ww=Math.max;Aw({target:"String",proto:!0},{replaceAll:function(e,t){var n,r,i,o,s,a,l,h,u,c=Ow(this),d=0,p="";if(!Pw(e)){if(_w(e)&&(n=Lw(Ow(kw(e))),!~Uw(n,"g")))throw new Vw("`.replaceAll` does not allow non-global regexes");if(r=Hw(e,Dw))return Mw(r,e,c,t)}for(i=Lw(c),o=Lw(e),(s=xw(t))||(t=Lw(t)),a=o.length,l=Ww(1,a),h=Uw(i,o);-1!==h;)u=s?Lw(t(o,h,i)):Fw(o,i,h,[],void 0,t),p+=Bw(i,d,h)+u,d=h+a,h=h+l>i.length?-1:Uw(i,o,h+l);return d<i.length&&(p+=Bw(i,d)),p}});var jw=wu,Gw=Ge,zw=sn,$w=Ss,Yw=TypeError;Ti({target:"Iterator",proto:!0,real:!0},{reduce:function(e){zw(this),Gw(e);var t=$w(this),n=arguments.length<2,r=n?void 0:arguments[1],i=0;if(jw(t,(function(t){n?(n=!1,r=t):r=e(r,t,i),i++}),{IS_RECORD:!0}),n)throw new Yw("Reduce of empty iterator with no initial value");return r}});const Kw={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},Xw=new RegExp(Object.keys(Kw).map((e=>`(${e})`)).join("|"),"gi");function qw(e){const t=e.hasColHeaders(),n=e.hasRowHeaders(),r=[t?-1:0,n?-1:0,e.countRows()-1,e.countCols()-1],i=e.getData(...r),o=i.length,s=o>0?i[0].length:0,a=["<table>","</table>"],l=t?["<thead>","</thead>"]:[],h=["<tbody>","</tbody>"],u=n?1:0,c=t?1:0;for(let d=0;d<o;d+=1){const r=t&&0===d,o=[];for(let t=0;t<s;t+=1){const s=!r&&n&&0===t;let a="";if(r)a=`<th>${e.getColHeader(t-u)}</th>`;else if(s)a=`<th>${e.getRowHeader(d-c)}</th>`;else{const n=i[d][t],{hidden:r,rowspan:o,colspan:s}=e.getCellMeta(d-c,t-u);if(!r){const e=[];if(o&&e.push(`rowspan="${o}"`),s&&e.push(`colspan="${s}"`),$d(n))a=`<td ${e.join(" ")}></td>`;else{const t=n.toString().replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,"<br>\r\n").replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");a=`<td ${e.join(" ")}>${t}</td>`}}}o.push(a)}const a=["<tr>",...o,"</tr>"].join("");r?l.splice(1,0,a):h.splice(-1,0,a)}return a.splice(1,0,l.join(""),h.join("")),a.join("")}function Qw(e){const t=e.length,n=["<table>"];for(let r=0;r<t;r+=1){const i=e[r],o=i.length,s=[];0===r&&n.push("<tbody>");for(let e=0;e<o;e+=1){const t=i[e],n=$d(t)?"":t.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,"<br>\r\n").replace(/\x20{2,}/gi,(e=>`<span style="mso-spacerun: yes">${"&nbsp;".repeat(e.length-1)} </span>`)).replace(/\t/gi,"&#9;");s.push(`<td>${n}</td>`)}n.push("<tr>",...s,"</tr>"),r+1===t&&n.push("</tbody>")}return n.push("</table>"),n.join("")}function Zw(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];const n=typeof e;if("number"===n)return!isNaN(e)&&isFinite(e);if("string"===n){if(0===e.length)return!1;if(1===e.length)return/\d/.test(e);const n=Array.from(new Set([".",...t])).map((e=>`\\${e}`)).join("|");return new RegExp(`^[+-]?(((${n})?\\d+((${n})\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$`,"i").test(e.trim())}return"object"===n&&!(!e||"number"!=typeof e.valueOf()||e instanceof Date)}function Jw(e,t,n){let r=-1;for("function"==typeof t?(n=t,t=e):r=e-1;++r<=t&&!1!==n(r););}function ey(e,t,n){let r=e+1;for("function"==typeof t&&(n=t,t=0);--r>=t&&!1!==n(r););}function ty(e,t){return t=parseInt(t.toString().replace("%",""),10),t=isNaN(t)?0:t,parseInt(e*t/100,10)}function ny(e,t,n){return Math.min(e,t)===e?t:Math.max(e,n)===e?n:e}const ry="asc",iy=new Map([[ry,[-1,1]],["desc",[1,-1]]]),oy=e=>`The priority '${e}' is already declared in a map.`,sy=e=>`The priority '${e}' is not a number.`;const ay=e=>`The id '${e}' is already declared in a map.`;function ly(){let{errorIdExists:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=new Map;function n(){return[...t]}function r(e){return t.has(e)}return e=Cg(e)?e:ay,{addItem:function(n,i){if(r(n))throw new Error(e(n));t.set(n,i)},clear:function(){t.clear()},getId:function(e){const[t]=n().find((t=>{let[n,r]=t;return e===r&&n}))||[null];return t},getItem:function(e){return t.get(e)},getItems:n,hasItem:r,removeItem:function(e){return t.delete(e)}}}const hy=e=>`'${e}' value is already declared in a unique set.`;const uy=e=>`There is already registered "${e}" plugin.`,cy=function(){let{errorPriorityExists:e,errorPriorityNaN:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const n=new Map;return e=Cg(e)?e:oy,t=Cg(t)?t:sy,{addItem:function(r,i){if(!Zw(r))throw new Error(t(r));if(n.has(r))throw new Error(e(r));n.set(r,i)},getItems:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ry;const[t,r]=iy.get(e)||iy.get(ry);return[...n].sort(((e,n)=>e[0]<n[0]?t:r)).map((e=>e[1]))}}}({errorPriorityExists:e=>`There is already registered plugin on priority "${e}".`,errorPriorityNaN:e=>`The priority "${e}" is not a number.`}),dy=function(){let{errorItemExists:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=new Set;return e=Cg(e)?e:hy,{addItem:function(n){if(t.has(n))throw new Error(e(n));t.add(n)},clear:function(){t.clear()},getItems:function(){return[...t]}}}({errorItemExists:uy}),py=ly({errorIdExists:uy});function gy(){return[...cy.getItems(),...dy.getItems()]}function my(e){const t=op(e);return py.getItem(t)}function fy(e,t,n){[e,t,n]=function(e,t,n){"function"==typeof e&&(e=(t=e).PLUGIN_KEY,n=t.PLUGIN_PRIORITY);return[e,t,n]}(e,t,n),void 0===my(e)&&function(e,t,n){const r=op(e);if(py.hasItem(r))throw new Error(uy(r));void 0===n?dy.addItem(r):cy.addItem(n,r);py.addItem(r,t)}(e,t,n)}const{register:wy,getItem:yy,hasItem:vy,getNames:Cy,getValues:Sy}=Tf("renderers");function Ry(e){if("function"==typeof e)return e;if(!vy(e))throw Error(`No registered renderer found under "${e}" name`);return yy(e)}function Ey(e,t){"string"!=typeof e&&(e=(t=e).RENDERER_TYPE),wy(e,t)}const{register:by,getItem:Ty,hasItem:Ny,getNames:Ay,getValues:My}=Tf("validators");function Iy(e,t){"string"!=typeof e&&(e=(t=e).VALIDATOR_TYPE),by(e,t)}var Oy=ct,xy=kr,Py=Ir,_y=Xm;Ti({target:"Array",proto:!0},{at:function(e){var t=Oy(this),n=xy(t),r=Py(e),i=r>=0?r:n+r;return i<0||i>=n?void 0:t[i]}}),_y("at");var Ly=Ti,Hy=le,ky=Ir,Fy=ro,Dy=P,Vy=X("".charAt);function Uy(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Ly({target:"String",proto:!0,forced:Dy((function(){return"\ud842"!=="ð ®·".at(-2)}))},{at:function(e){var t=Fy(Hy(this)),n=t.length,r=ky(e),i=r>=0?r:n+r;return i<0||i>=n?void 0:Vy(t,i)}});class By{constructor(){Uy(this,"count",0),Uy(this,"startColumn",null),Uy(this,"endColumn",null),Uy(this,"startPosition",null),Uy(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,t){const{totalCalculatedWidth:n,zeroBasedScrollOffset:r,viewportWidth:i,columnWidth:o}=t;n>=r&&n+o<=r+(r>0?i+1:i)&&(null!==this.startColumn&&void 0!==this.startColumn||(this.startColumn=e),this.endColumn=e)}finalize(e){var t;const{scrollOffset:n,viewportWidth:r,inlineStartOffset:i,zeroBasedScrollOffset:o,totalColumns:s,needReverse:a,startPositions:l,columnWidth:h}=e;if(this.endColumn===s-1&&a)for(this.startColumn=this.endColumn;this.startColumn>0;){const e=l[this.endColumn]+h-l[this.startColumn-1];if(e<=r&&(this.startColumn-=1),e>=r)break}this.startPosition=null!==(t=l[this.startColumn])&&void 0!==t?t:null;const u=n+r-(o>0?r+1:r),c=null===this.startColumn?0:e.getColumnWidth(this.startColumn);u<-1*i||n>l.at(-1)||-1*n-r>-1*c?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,s<this.endColumn&&(this.endColumn=s-1),null!==this.startColumn&&(this.count=this.endColumn-this.startColumn+1)}}function Wy(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class jy{constructor(){Wy(this,"count",0),Wy(this,"startRow",null),Wy(this,"endRow",null),Wy(this,"startPosition",null),Wy(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,t){const{totalCalculatedHeight:n,zeroBasedScrollOffset:r,innerViewportHeight:i,rowHeight:o}=t;n>=r&&n+o<=i&&(null===this.startRow&&(this.startRow=e),this.endRow=e)}finalize(e){var t;const{scrollOffset:n,viewportHeight:r,horizontalScrollbarHeight:i,totalRows:o,needReverse:s,startPositions:a,rowHeight:l}=e;if(this.endRow===o-1&&s)for(this.startRow=this.endRow;this.startRow>0;){const e=a[this.endRow]+l-a[this.startRow-1];if(e<=r-i&&(this.startRow-=1),e>=r-i)break}this.startPosition=null!==(t=a[this.startRow])&&void 0!==t?t:null;n+r-i<(null===this.startRow?0:e.getRowHeight(this.startRow))||n>a.at(-1)?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,o<this.endRow&&(this.endRow=o-1),null!==this.startRow&&(this.count=this.endRow-this.startRow+1)}}function Gy(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class zy{constructor(){Gy(this,"count",0),Gy(this,"startColumn",null),Gy(this,"endColumn",null),Gy(this,"startPosition",null),Gy(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,t){const{totalCalculatedWidth:n,zeroBasedScrollOffset:r,viewportWidth:i}=t;n<=r&&(this.startColumn=e);n>=r&&n<=r+(r>0?i+1:i)&&(null!==this.startColumn&&void 0!==this.startColumn||(this.startColumn=e)),this.endColumn=e}finalize(e){var t;const{scrollOffset:n,viewportWidth:r,inlineStartOffset:i,zeroBasedScrollOffset:o,totalColumns:s,needReverse:a,startPositions:l,columnWidth:h}=e;if(this.endColumn===s-1&&a)for(this.startColumn=this.endColumn;this.startColumn>0;){const e=l[this.endColumn]+h-l[this.startColumn-1];if(this.startColumn-=1,e>r)break}this.startPosition=null!==(t=l[this.startColumn])&&void 0!==t?t:null;n+r-(o>0?r+1:r)<-1*i||n>l.at(-1)+h||-1*n-r>0?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,s<this.endColumn&&(this.endColumn=s-1),null!==this.startColumn&&(this.count=this.endColumn-this.startColumn+1)}}function $y(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Yy{constructor(){$y(this,"count",0),$y(this,"startRow",null),$y(this,"endRow",null),$y(this,"startPosition",null),$y(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,t){const{totalCalculatedHeight:n,zeroBasedScrollOffset:r,innerViewportHeight:i}=t;n<=r&&(this.startRow=e),n>=r&&n<=i&&null===this.startRow&&(this.startRow=e),this.endRow=e}finalize(e){var t;const{scrollOffset:n,viewportHeight:r,horizontalScrollbarHeight:i,totalRows:o,needReverse:s,startPositions:a,rowHeight:l}=e;if(this.endRow===o-1&&s)for(this.startRow=this.endRow;this.startRow>0;){const e=a[this.endRow]+l-a[this.startRow-1];if(this.startRow-=1,e>=r-i)break}this.startPosition=null!==(t=a[this.startRow])&&void 0!==t?t:null;n+r-i<0||n>a.at(-1)+l?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,o<this.endRow&&(this.endRow=o-1),null!==this.startRow&&(this.count=this.endRow-this.startRow+1)}}function Ky(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Xy{constructor(){Ky(this,"count",0),Ky(this,"startColumn",0),Ky(this,"endColumn",0),Ky(this,"startPosition",0),Ky(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalColumns:t}=e;this.count=t,this.endColumn=this.count-1}process(){}finalize(){}}function qy(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Qy{constructor(){qy(this,"count",0),qy(this,"startRow",0),qy(this,"endRow",0),qy(this,"startPosition",0),qy(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalRows:t}=e;this.count=t,this.endRow=this.count-1}process(){}finalize(){}}function Zy(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Jy extends zy{constructor(){super(...arguments),Zy(this,"columnStartOffset",0),Zy(this,"columnEndOffset",0)}finalize(e){var t;super.finalize(e);const{overrideFn:n,totalColumns:r,startPositions:i}=e;if(null!==this.startColumn&&"function"==typeof n){const e=this.startColumn,t=this.endColumn;n(this),this.columnStartOffset=e-this.startColumn,this.columnEndOffset=this.endColumn-t}this.startColumn<0&&(this.startColumn=0),this.startPosition=null!==(t=i[this.startColumn])&&void 0!==t?t:null,r<this.endColumn&&(this.endColumn=r-1),null!==this.startColumn&&(this.count=this.endColumn-this.startColumn+1)}}function ev(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class tv extends Yy{constructor(){super(...arguments),ev(this,"rowStartOffset",0),ev(this,"rowEndOffset",0)}finalize(e){var t;super.finalize(e);const{overrideFn:n,totalRows:r,startPositions:i}=e;if(null!==this.startRow&&"function"==typeof n){const e=this.startRow,t=this.endRow;n(this),this.rowStartOffset=e-this.startRow,this.rowEndOffset=this.endRow-t}this.startRow<0&&(this.startRow=0),this.startPosition=null!==(t=i[this.startRow])&&void 0!==t?t:null,r<this.endRow&&(this.endRow=r-1),null!==this.startRow&&(this.count=this.endRow-this.startRow+1)}}function nv(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class rv{constructor(e){nv(this,"calculationTypes",[]),nv(this,"calculationResults",new Map),this.calculationTypes=e}_initialize(e){this.calculationTypes.forEach((t=>{let[n,r]=t;this.calculationResults.set(n,r),r.initialize(e)}))}_process(e,t){this.calculationTypes.forEach((n=>{let[,r]=n;return r.process(e,t)}))}_finalize(e){this.calculationTypes.forEach((t=>{let[,n]=t;return n.finalize(e)}))}getResultsFor(e){return this.calculationResults.get(e)}}function iv(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const ov=50;class sv extends rv{constructor(e){let{calculationTypes:t,viewportWidth:n,scrollOffset:r,totalColumns:i,columnWidthFn:o,overrideFn:s,inlineStartOffset:a}=e;super(t),iv(this,"viewportWidth",0),iv(this,"scrollOffset",0),iv(this,"zeroBasedScrollOffset",0),iv(this,"totalColumns",0),iv(this,"columnWidthFn",null),iv(this,"columnWidth",0),iv(this,"overrideFn",null),iv(this,"inlineStartOffset",0),iv(this,"totalCalculatedWidth",0),iv(this,"startPositions",[]),iv(this,"needReverse",!0),this.viewportWidth=n,this.scrollOffset=r,this.zeroBasedScrollOffset=Math.max(r,0),this.totalColumns=i,this.columnWidthFn=o,this.overrideFn=s,this.inlineStartOffset=a,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalColumns;e++)if(this.columnWidth=this.getColumnWidth(e),this._process(e,this),this.startPositions.push(this.totalCalculatedWidth),this.totalCalculatedWidth+=this.columnWidth,this.totalCalculatedWidth>=this.zeroBasedScrollOffset+this.viewportWidth){this.needReverse=!1;break}this._finalize(this)}getColumnWidth(e){const t=this.columnWidthFn(e);return isNaN(t)?ov:t}}function av(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class lv extends rv{constructor(e){let{calculationTypes:t,viewportHeight:n,scrollOffset:r,totalRows:i,defaultRowHeight:o,rowHeightFn:s,overrideFn:a,horizontalScrollbarHeight:l}=e;super(t),av(this,"viewportHeight",0),av(this,"scrollOffset",0),av(this,"zeroBasedScrollOffset",0),av(this,"totalRows",0),av(this,"rowHeightFn",null),av(this,"rowHeight",0),av(this,"overrideFn",null),av(this,"horizontalScrollbarHeight",0),av(this,"innerViewportHeight",0),av(this,"totalCalculatedHeight",0),av(this,"startPositions",[]),av(this,"needReverse",!0),this.defaultHeight=o,this.viewportHeight=n,this.scrollOffset=r,this.zeroBasedScrollOffset=Math.max(r,0),this.totalRows=i,this.rowHeightFn=s,this.overrideFn=a,this.horizontalScrollbarHeight=null!=l?l:0,this.innerViewportHeight=this.zeroBasedScrollOffset+this.viewportHeight-this.horizontalScrollbarHeight,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalRows;e++)if(this.rowHeight=this.getRowHeight(e),this._process(e,this),this.startPositions.push(this.totalCalculatedHeight),this.totalCalculatedHeight+=this.rowHeight,this.totalCalculatedHeight>=this.innerViewportHeight){this.needReverse=!1;break}this._finalize(this)}getRowHeight(e){const t=this.rowHeightFn(e);return isNaN(t)?this.defaultHeight:t}}function hv(e,t,n){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,n)}function uv(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function cv(e,t){return e.get(pv(e,t))}function dv(e,t,n){return e.set(pv(e,t),n),n}function pv(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var gv=new WeakMap;class mv{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];uv(this,"row",null),uv(this,"col",null),hv(this,gv,!1),dv(gv,this,n),void 0!==e&&void 0!==t&&(this.row=e,this.col=t)}isValid(e){const{countRows:t,countCols:n,countRowHeaders:r,countColHeaders:i}={countRows:0,countCols:0,countRowHeaders:0,countColHeaders:0,...e};return!(!Number.isInteger(this.row)||!Number.isInteger(this.col))&&(!(this.row<-i||this.col<-r)&&!(this.row>=t||this.col>=n))}isEqual(e){return e===this||this.row===e.row&&this.col===e.col}isHeader(){return!this.isCell()}isCell(){return this.row>=0&&this.col>=0}isRtl(){return cv(gv,this)}isSouthEastOf(e){return this.row>=e.row&&(cv(gv,this)?this.col<=e.col:this.col>=e.col)}isNorthWestOf(e){return this.row<=e.row&&(cv(gv,this)?this.col>=e.col:this.col<=e.col)}isSouthWestOf(e){return this.row>=e.row&&(cv(gv,this)?this.col>=e.col:this.col<=e.col)}isNorthEastOf(e){return this.row<=e.row&&(cv(gv,this)?this.col<=e.col:this.col>=e.col)}normalize(){return this.row=null===this.row?this.row:Math.max(this.row,0),this.col=null===this.col?this.col:Math.max(this.col,0),this}assign(e){return Number.isInteger(null==e?void 0:e.row)&&(this.row=e.row),Number.isInteger(null==e?void 0:e.col)&&(this.col=e.col),e instanceof mv&&dv(gv,this,e.isRtl()),this}clone(){return new mv(this.row,this.col,cv(gv,this))}toObject(){return{row:this.row,col:this.col}}}const fv=mv;function wv(e,t,n){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,n)}function yv(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function vv(e,t){return e.get(Cv(e,t))}function Cv(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var Sv=new WeakMap;class Rv{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];var i,o,s;yv(this,"highlight",null),yv(this,"from",null),yv(this,"to",null),wv(this,Sv,!1),this.highlight=e.clone(),this.from=t.clone(),this.to=n.clone(),o=this,s=r,(i=Sv).set(Cv(i,o),s)}setHighlight(e){return this.highlight=e.clone(),this}setFrom(e){return this.from=e.clone(),this}setTo(e){return this.to=e.clone(),this}isValid(e){return this.from.isValid(e)&&this.to.isValid(e)}isSingle(){return this.isSingleCell()||this.isSingleHeader()}isSingleCell(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}isSingleHeader(){return(this.from.row<0||this.from.col<0)&&this.from.row===this.to.row&&this.from.col===this.to.col}isHeader(){return!(!this.from.isHeader()||!this.to.isHeader())||(this.from.col<0&&this.to.col<0||this.from.row<0&&this.to.row<0)}containsHeaders(){return this.from.isHeader()||this.to.isHeader()}getOuterHeight(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}getOuterWidth(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}getHeight(){if(this.from.row<0&&this.to.row<0)return 0;const e=Math.max(this.from.row,0),t=Math.max(this.to.row,0);return Math.max(e,t)-Math.min(e,t)+1}getWidth(){if(this.from.col<0&&this.to.col<0)return 0;const e=Math.max(this.from.col,0),t=Math.max(this.to.col,0);return Math.max(e,t)-Math.min(e,t)+1}getCellsCount(){return this.getWidth()*this.getHeight()}includes(e){const{row:t,col:n}=e,r=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner();return r.row<=t&&i.row>=t&&r.col<=n&&i.col>=n}includesRange(e){return this.includes(e.getOuterTopStartCorner())&&this.includes(e.getOuterBottomEndCorner())}isEqual(e){return Math.min(this.from.row,this.to.row)===Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(e.from.col,e.to.col)}overlaps(e){return e.isSouthEastOf(this.getOuterTopLeftCorner())&&e.isNorthWestOf(this.getOuterBottomRightCorner())}isSouthEastOf(e){return this.getOuterTopLeftCorner().isSouthEastOf(e)||this.getOuterBottomRightCorner().isSouthEastOf(e)}isNorthWestOf(e){return this.getOuterTopLeftCorner().isNorthWestOf(e)||this.getOuterBottomRightCorner().isNorthWestOf(e)}isOverlappingHorizontally(e){return this.getOuterTopEndCorner().col>=e.getOuterTopStartCorner().col&&this.getOuterTopEndCorner().col<=e.getOuterTopEndCorner().col||this.getOuterTopStartCorner().col<=e.getOuterTopEndCorner().col&&this.getOuterTopStartCorner().col>=e.getOuterTopStartCorner().col}isOverlappingVertically(e){return this.getOuterBottomStartCorner().row>=e.getOuterTopRightCorner().row&&this.getOuterBottomStartCorner().row<=e.getOuterBottomStartCorner().row||this.getOuterTopEndCorner().row<=e.getOuterBottomStartCorner().row&&this.getOuterTopEndCorner().row>=e.getOuterTopRightCorner().row}expand(e){const t=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner();return(e.row<t.row||e.col<t.col||e.row>n.row||e.col>n.col)&&(this.from=this._createCellCoords(Math.min(t.row,e.row),Math.min(t.col,e.col)),this.to=this._createCellCoords(Math.max(n.row,e.row),Math.max(n.col,e.col)),!0)}expandByRange(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.includesRange(e)||!this.overlaps(e))return!1;const n=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner(),i=this.getDirection(),o=e.getOuterTopStartCorner(),s=e.getOuterBottomEndCorner(),a=Math.min(n.row,o.row),l=Math.min(n.col,o.col),h=Math.max(r.row,s.row),u=Math.max(r.col,s.col),c=this._createCellCoords(a,l),d=this._createCellCoords(h,u);return this.from=c,this.to=d,this.setDirection(i),t&&(this.highlight.row===this.getOuterBottomRightCorner().row&&"N-S"===this.getVerticalDirection()&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&"W-E"===this.getHorizontalDirection()&&this.flipDirectionHorizontally()),!0}getDirection(){return this.from.isNorthWestOf(this.to)?"NW-SE":this.from.isNorthEastOf(this.to)?"NE-SW":this.from.isSouthEastOf(this.to)?"SE-NW":this.from.isSouthWestOf(this.to)?"SW-NE":void 0}setDirection(e){switch(e){case"NW-SE":[this.from,this.to]=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];break;case"NE-SW":[this.from,this.to]=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];break;case"SE-NW":[this.from,this.to]=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];break;case"SW-NE":[this.from,this.to]=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()]}}getVerticalDirection(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}getHorizontalDirection(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}flipDirectionVertically(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE")}}flipDirectionHorizontally(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW")}}getTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getTopLeftCorner(){return vv(Sv,this)?this.getTopEndCorner():this.getTopStartCorner()}getBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getBottomRightCorner(){return vv(Sv,this)?this.getBottomStartCorner():this.getBottomEndCorner()}getTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getTopRightCorner(){return vv(Sv,this)?this.getTopStartCorner():this.getTopEndCorner()}getBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getBottomLeftCorner(){return vv(Sv,this)?this.getBottomEndCorner():this.getBottomStartCorner()}getOuterTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterTopLeftCorner(){return vv(Sv,this)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}getOuterBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterBottomRightCorner(){return vv(Sv,this)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}getOuterTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterTopRightCorner(){return vv(Sv,this)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}getOuterBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterBottomLeftCorner(){return vv(Sv,this)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}isCorner(e){return e.isEqual(this.getOuterTopLeftCorner())||e.isEqual(this.getOuterTopRightCorner())||e.isEqual(this.getOuterBottomLeftCorner())||e.isEqual(this.getOuterBottomRightCorner())}getOppositeCorner(e){return e instanceof fv&&(e.isEqual(this.getOuterBottomEndCorner())?this.getOuterTopStartCorner():e.isEqual(this.getOuterTopStartCorner())?this.getOuterBottomEndCorner():e.isEqual(this.getOuterTopEndCorner())?this.getOuterBottomStartCorner():e.isEqual(this.getOuterBottomStartCorner())?this.getOuterTopEndCorner():void 0)}getBordersSharedWith(e){if(!this.includesRange(e))return[];const t=Math.min(this.from.row,this.to.row),n=Math.max(this.from.row,this.to.row),r=Math.min(this.from.col,this.to.col),i=Math.max(this.from.col,this.to.col),o=Math.min(e.from.row,e.to.row),s=Math.max(e.from.row,e.to.row),a=Math.min(e.from.col,e.to.col),l=Math.max(e.from.col,e.to.col),h=[];return t===o&&h.push("top"),i===l&&h.push(vv(Sv,this)?"left":"right"),n===s&&h.push("bottom"),r===a&&h.push(vv(Sv,this)?"right":"left"),h}getInner(){const e=this.getOuterTopStartCorner(),t=this.getOuterBottomEndCorner(),n=[];for(let r=e.row;r<=t.row;r++)for(let i=e.col;i<=t.col;i++)this.from.row===r&&this.from.col===i||this.to.row===r&&this.to.col===i||n.push(this._createCellCoords(r,i));return n}getAll(){const e=this.getOuterTopStartCorner(),t=this.getOuterBottomEndCorner(),n=[];for(let r=e.row;r<=t.row;r++)for(let i=e.col;i<=t.col;i++)e.row===r&&e.col===i?n.push(e):t.row===r&&t.col===i?n.push(t):n.push(this._createCellCoords(r,i));return n}forAll(e){const t=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner();for(let r=t.row;r<=n.row;r++)for(let i=t.col;i<=n.col;i++){if(!1===e(r,i))return}}clone(){return new Rv(this.highlight,this.from,this.to,vv(Sv,this))}toObject(){return{from:this.from.toObject(),to:this.to.toObject()}}_createCellCoords(e,t){return new fv(e,t,vv(Sv,this))}}const Ev=Rv;function bv(e,t,n){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,n)}function Tv(e,t){return e.get(Av(e,t))}function Nv(e,t,n){return e.set(Av(e,t),n),n}function Av(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var Mv=new WeakMap,Iv=new WeakMap,Ov=new WeakMap,xv=new WeakMap,Pv=new WeakMap,_v=new WeakMap,Lv=new WeakMap,Hv=new WeakMap,kv=new WeakMap,Fv=new WeakMap;const Dv=class{constructor(e,t,n,r,i,o){let s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;bv(this,Mv,void 0),bv(this,Iv,void 0),bv(this,Ov,void 0),bv(this,xv,void 0),bv(this,Pv,void 0),bv(this,_v,void 0),bv(this,Lv,void 0),bv(this,Hv,void 0),bv(this,kv,[null,null]),bv(this,Fv,[null,null]),Nv(Mv,this,n),Nv(Iv,this,t),Nv(Ov,this,i),Nv(xv,this,o),Nv(Pv,this,s),Nv(_v,this,r),Nv(Lv,this,e),this.registerEvents()}registerEvents(){Tv(_v,this).addEventListener(Tv(Ov,this).holder,"contextmenu",(e=>this.onContextMenu(e))),Tv(_v,this).addEventListener(Tv(Ov,this).TABLE,"mouseover",(e=>this.onMouseOver(e))),Tv(_v,this).addEventListener(Tv(Ov,this).TABLE,"mouseout",(e=>this.onMouseOut(e)));const e=()=>{Tv(_v,this).addEventListener(Tv(Ov,this).holder,"touchstart",(e=>this.onTouchStart(e))),Tv(_v,this).addEventListener(Tv(Ov,this).holder,"touchend",(e=>this.onTouchEnd(e))),this.momentumScrolling||(this.momentumScrolling={}),Tv(_v,this).addEventListener(Tv(Ov,this).holder,"scroll",(()=>{clearTimeout(this.momentumScrolling._timeout),this.momentumScrolling.ongoing||Tv(Mv,this).getSetting("onBeforeTouchScroll"),this.momentumScrolling.ongoing=!0,this.momentumScrolling._timeout=setTimeout((()=>{this.touchApplied||(this.momentumScrolling.ongoing=!1,Tv(Mv,this).getSetting("onAfterMomentumScroll"))}),200)}))},t=()=>{Tv(_v,this).addEventListener(Tv(Ov,this).holder,"mouseup",(e=>this.onMouseUp(e))),Tv(_v,this).addEventListener(Tv(Ov,this).holder,"mousedown",(e=>this.onMouseDown(e)))};bm()?e():(fm()&&e(),t())}selectedCellWasTouched(e){const t=this.parentCell(e).coords;if(Tv(Hv,this)&&t){const[e,n]=[t.row,Tv(Hv,this).from.row],[r,i]=[t.col,Tv(Hv,this).from.col];return e===n&&r===i}return!1}parentCell(e){const t={},n=xp(e,["TD","TH"],Tv(Ov,this).TABLE);return n?(t.coords=Tv(Ov,this).getCoords(n),t.TD=n):kp(e,"wtBorder")&&kp(e,"current")?(t.coords=Tv(xv,this).getFocusSelection().cellRange.highlight,t.TD=Tv(Ov,this).getCell(t.coords)):kp(e,"wtBorder")&&kp(e,"area")&&Tv(xv,this).getAreaSelection().cellRange&&(t.coords=Tv(xv,this).getAreaSelection().cellRange.to,t.TD=Tv(Ov,this).getCell(t.coords)),t}onMouseDown(e){const t=Tv(Iv,this).rootDocument.activeElement,n=Rg(Ap,e.target),r=e.target;if(!["TD","TH"].includes(t.nodeName)&&(r===t||n(0)===t||n(1)===t))return;const i=this.parentCell(r);kp(r,"corner")?Tv(Mv,this).getSetting("onCellCornerMouseDown",e,r):i.TD&&Tv(Mv,this).has("onCellMouseDown")&&this.callListener("onCellMouseDown",e,i.coords,i.TD),(0===e.button||this.touchApplied)&&i.TD&&(Tv(Fv,this)[0]=i.TD,clearTimeout(Tv(kv,this)[0]),Tv(kv,this)[0]=setTimeout((()=>{Tv(Fv,this)[0]=null}),1e3))}onContextMenu(e){if(Tv(Mv,this).has("onCellContextMenu")){const t=this.parentCell(e.target);t.TD&&this.callListener("onCellContextMenu",e,t.coords,t.TD)}}onMouseOver(e){if(!Tv(Mv,this).has("onCellMouseOver"))return;const t=Tv(Ov,this).TABLE,n=xp(e.target,["TD","TH"],t),r=Tv(Pv,this)||this;n&&n!==r.lastMouseOver&&Pp(n,t)&&(r.lastMouseOver=n,this.callListener("onCellMouseOver",e,Tv(Ov,this).getCoords(n),n))}onMouseOut(e){if(!Tv(Mv,this).has("onCellMouseOut"))return;const t=Tv(Ov,this).TABLE,n=xp(e.target,["TD","TH"],t),r=xp(e.relatedTarget,["TD","TH"],t),i=Tv(Pv,this)||this;n&&n!==r&&Pp(n,t)&&(this.callListener("onCellMouseOut",e,Tv(Ov,this).getCoords(n),n),null===r&&(i.lastMouseOver=null))}onMouseUp(e){const t=this.parentCell(e.target);t.TD&&Tv(Mv,this).has("onCellMouseUp")&&this.callListener("onCellMouseUp",e,t.coords,t.TD),(0===e.button||this.touchApplied)&&(t.TD===Tv(Fv,this)[0]&&t.TD===Tv(Fv,this)[1]?(kp(e.target,"corner")?this.callListener("onCellCornerDblClick",e,t.coords,t.TD):this.callListener("onCellDblClick",e,t.coords,t.TD),Tv(Fv,this)[0]=null,Tv(Fv,this)[1]=null):t.TD===Tv(Fv,this)[0]&&(Tv(Fv,this)[1]=t.TD,clearTimeout(Tv(kv,this)[1]),Tv(kv,this)[1]=setTimeout((()=>{Tv(Fv,this)[1]=null}),500)))}onTouchStart(e){Nv(Hv,this,Tv(xv,this).getFocusSelection().cellRange),this.touchApplied=!0,this.onMouseDown(e)}onTouchEnd(e){var t;const n=e.target,r=null===(t=this.parentCell(n))||void 0===t?void 0:t.coords,i=Gd(r)&&r.row>=0&&r.col>=0;if(e.cancelable&&i&&Tv(Mv,this).getSetting("isDataViewInstance")){const t=["A","BUTTON","INPUT"];Tm()&&(vm.chromeWebKit.value||vm.firefoxWebKit.value)&&this.selectedCellWasTouched(n)&&!t.includes(n.tagName)?e.preventDefault():this.selectedCellWasTouched(n)||e.preventDefault()}this.onMouseUp(e),this.touchApplied=!1}callListener(e,t,n,r){const i=Tv(Mv,this).getSettingPure(e);i&&i(t,n,r,Tv(Lv,this).call(this))}destroy(){clearTimeout(Tv(kv,this)[0]),clearTimeout(Tv(kv,this)[1]),Tv(_v,this).destroy()}};function Vv(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const Uv=class{constructor(e,t,n){Vv(this,"offset",void 0),Vv(this,"total",void 0),Vv(this,"countTH",void 0),this.offset=e,this.total=t,this.countTH=n}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleRowHeadedColumnToSourceColumn(e){return this.renderedToSource(this.offsettedTH(e))}sourceColumnToVisibleRowHeadedColumn(e){return this.unOffsettedTH(this.sourceToRendered(e))}};function Bv(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const Wv=class{constructor(e,t,n){Bv(this,"offset",void 0),Bv(this,"total",void 0),Bv(this,"countTH",void 0),this.offset=e,this.total=t,this.countTH=n}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleColHeadedRowToSourceRow(e){return this.renderedToSource(this.offsettedTH(e))}sourceRowToVisibleColHeadedRow(e){return this.unOffsettedTH(this.sourceToRendered(e))}};function jv(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Gv{constructor(){jv(this,"currentSize",0),jv(this,"nextSize",0),jv(this,"currentOffset",0),jv(this,"nextOffset",0)}setSize(e){this.currentSize=this.nextSize,this.nextSize=e}setOffset(e){this.currentOffset=this.nextOffset,this.nextOffset=e}}function zv(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class $v{constructor(){zv(this,"size",new Gv),zv(this,"workingSpace",0),zv(this,"sharedSize",null)}setSize(e){this.size.setSize(e)}setOffset(e){this.size.setOffset(e)}getViewSize(){return this.size}isShared(){return null!==this.sharedSize}isPlaceOn(e){return this.workingSpace===e}append(e){this.workingSpace=1,e.workingSpace=2,this.sharedSize=e.getViewSize()}prepend(e){this.workingSpace=2,e.workingSpace=1,this.sharedSize=e.getViewSize()}}var Yv=Ue,Kv=TypeError,Xv=Ti,qv=ct,Qv=kr,Zv=$o,Jv=function(e,t){if(!delete e[t])throw new Kv("Cannot delete property "+Yv(t)+" of "+Yv(e))},eC=Ko,tC=1!==[].unshift(0)||!function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(Dm){return Dm instanceof TypeError}}();function nC(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Xv({target:"Array",proto:!0,arity:1,forced:tC},{unshift:function(e){var t=qv(this),n=Qv(t),r=arguments.length;if(r){eC(n+r);for(var i=n;i--;){var o=i+r;i in t?t[o]=t[i]:Jv(t,o)}for(var s=0;s<r;s++)t[s]=arguments[s]}return Zv(t,n+r)}});class rC{constructor(e,t){nC(this,"order",[]),this.order=[...Array(t).keys()].map((t=>e+t))}get length(){return this.order.length}has(e){return this.order.indexOf(e)>-1}get(e){return e<this.order.length?this.order[e]:-1}remove(e){this.order.splice(this.order.indexOf(e),1)}prepend(e){return this.order.unshift(e),this.order.pop()}}function iC(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class oC{constructor(e){iC(this,"sizeSet",void 0),this.sizeSet=e}diff(){const{sizeSet:e}=this,{currentSize:t,nextSize:n}=e.getViewSize();let r=Math.max(n,t);if(0===r)return[];const{currentOffset:i,nextOffset:o}=e.getViewSize(),s=new rC(i,t),a=new rC(o,n),l=[];for(let h=0;h<r;h++){const t=s.get(h),i=a.get(h);if(-1===i)l.push(["remove",t]);else if(-1===t)!e.isShared()||e.isShared()&&e.isPlaceOn(2)?l.push(["append",i]):l.push(["prepend",i]);else if(i>t)s.has(i)&&(s.remove(i),n<=s.length&&(r-=1)),l.push(["replace",i,t]);else if(i<t){const e=s.prepend(i);l.push(["insert_before",i,t,e])}else l.push(["none",i])}return l}}function sC(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class aC{constructor(e,t){sC(this,"rootNode",void 0),sC(this,"nodesPool",void 0),sC(this,"sizeSet",new $v),sC(this,"collectedNodes",[]),sC(this,"viewDiffer",new oC(this.sizeSet)),sC(this,"leads",[]),this.rootNode=e,this.nodesPool=t}setSize(e){return this.sizeSet.setSize(e),this}setOffset(e){return this.sizeSet.setOffset(e),this}isSharedViewSet(){return this.sizeSet.isShared()}getNode(e){return e<this.collectedNodes.length?this.collectedNodes[e]:null}getCurrentNode(){const e=this.collectedNodes.length;return e>0?this.collectedNodes[e-1]:null}applyCommand(e){const{rootNode:t}=this,[n,r,i,o]=e,s=this.nodesPool(r);switch(this.collectedNodes.push(s),n){case"prepend":t.insertBefore(s,t.firstChild);break;case"append":t.appendChild(s);break;case"insert_before":t.insertBefore(s,this.nodesPool(i)),t.removeChild(this.nodesPool(o));break;case"replace":t.replaceChild(s,this.nodesPool(i));break;case"remove":t.removeChild(s)}}start(){this.collectedNodes.length=0,this.leads=this.viewDiffer.diff()}render(){this.leads.length>0&&this.applyCommand(this.leads.shift())}end(){for(;this.leads.length>0;)this.applyCommand(this.leads.shift())}}class lC extends aC{prependView(e){return this.sizeSet.prepend(e.sizeSet),e.sizeSet.append(this.sizeSet),this}appendView(e){return this.sizeSet.append(e.sizeSet),e.sizeSet.prepend(this.sizeSet),this}}function hC(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class uC{constructor(e){hC(this,"nodeType",void 0),hC(this,"pool",new Map),this.nodeType=e.toUpperCase()}setRootDocument(e){this.rootDocument=e}obtain(e,t){const n="number"==typeof t?`${e}x${t}`:e.toString();if(this.pool.has(n))return this.pool.get(n);const r=this.rootDocument.createElement(this.nodeType);return this.pool.set(n,r),r}}function cC(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class dC{constructor(e,t){cC(this,"nodesPool",null),cC(this,"nodeType",void 0),cC(this,"rootNode",void 0),cC(this,"table",null),cC(this,"renderedNodes",0),this.nodesPool="string"==typeof e?new uC(e):null,this.nodeType=e,this.rootNode=t}setTable(e){this.nodesPool&&this.nodesPool.setRootDocument(e.rootDocument),this.table=e}adjust(){}render(){}}function pC(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class gC extends dC{constructor(){super("TH"),pC(this,"orderViews",new WeakMap),pC(this,"sourceRowIndex",0)}obtainOrderView(e){let t;return this.orderViews.has(e)?t=this.orderViews.get(e):(t=new lC(e,(e=>this.nodesPool.obtain(this.sourceRowIndex,e))),this.orderViews.set(e,t)),t}render(){const{rowsToRender:e,rowHeaderFunctions:t,rowHeadersCount:n,rows:r,cells:i}=this.table;for(let o=0;o<e;o++){const e=this.table.renderedRowToSource(o),s=r.getRenderedNode(o);this.sourceRowIndex=e;const a=this.obtainOrderView(s),l=i.obtainOrderView(s);a.appendView(l).setSize(n).setOffset(0).start();for(let r=0;r<n;r++){a.render();const n=a.getCurrentNode();n.className="",n.removeAttribute("style"),Up(n,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&Vp(n,[["role","rowheader"],["scope","row"],Cp(r+1),cp(-1)]),t[r](e,n,r)}a.end()}}}class mC extends dC{constructor(e){super(null,e)}adjust(){const{columnHeadersCount:e,rowHeadersCount:t}=this.table;let n=this.rootNode.firstChild;if(e){const{columnsToRender:r}=this.table,i=r+t;for(let t=0,s=e;t<s;t++){for(n=this.rootNode.childNodes[t],n||(n=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(n)),this.renderedNodes=n.childNodes.length;this.renderedNodes<i;)n.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>i;)n.removeChild(n.lastChild),this.renderedNodes-=1}const o=this.rootNode.childNodes.length;if(o>e)for(let t=e;t<o;t++)this.rootNode.removeChild(this.rootNode.lastChild)}else n&&Wp(n)}render(){const{columnHeadersCount:e}=this.table;this.table.isAriaEnabled()&&Vp(this.rootNode,[["role","rowgroup"]]);for(let t=0;t<e;t+=1){const{columnHeaderFunctions:e,columnsToRender:n,rowHeadersCount:r}=this.table,i=this.rootNode.childNodes[t];this.table.isAriaEnabled()&&Vp(i,[["role","row"],vp(t+1)]);for(let o=-1*r;o<n;o+=1){const n=this.table.renderedColumnToSource(o),s=i.childNodes[o+r];s.className="",s.removeAttribute("style"),Up(s,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&Vp(s,[Cp(o+1+this.table.rowHeadersCount),cp(-1),["role","columnheader"],...o>=0?[["scope","col"]]:[["role","row"]]]),e[t](n,s,t)}}}}let fC=!1;class wC extends dC{constructor(e){super(null,e)}adjust(){const{columnsToRender:e,rowHeadersCount:t}=this.table,n=e+t;for(;this.renderedNodes<n;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>n;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}render(){this.adjust();const{columnsToRender:e,rowHeadersCount:t}=this.table;!fC&&e>1e3&&(fC=!0,Fm(Wd`Performance tip: Handsontable rendered more than 1000 visible columns.\x20
        Consider limiting the number of rendered columns by specifying the table width and/or\x20
        turning off the "renderAllColumns" option.`));for(let r=0;r<t;r++){const e=this.table.renderedColumnToSource(r),t=this.table.columnUtils.getHeaderWidth(e);this.rootNode.childNodes[r].style.width=`${t}px`}for(let r=0;r<e;r++){const e=this.table.renderedColumnToSource(r),n=this.table.columnUtils.getWidth(e);this.rootNode.childNodes[r+t].style.width=`${n}px`}const n=this.rootNode.firstChild;n&&Fp(n,"rowHeader")}}function yC(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const vC="ht__row_even",CC="ht__row_odd";let SC=!1;class RC extends dC{constructor(e){super("TR",e),yC(this,"orderView",void 0),this.orderView=new aC(e,(e=>this.nodesPool.obtain(e)))}getRenderedNode(e){return this.orderView.getNode(e)}hasStaleContent(e){return this.orderView.hasStaleContent(e)}render(){const{rowsToRender:e}=this.table;!SC&&e>1e3&&(SC=!0,Fm(Wd`Performance tip: Handsontable rendered more than 1000 visible rows.\x20
        Consider limiting the number of rendered rows by specifying the table height and/or\x20
        turning off the "renderAllRows" option.`)),this.table.isAriaEnabled()&&Vp(this.rootNode,[["role","rowgroup"]]),this.orderView.setSize(e).setOffset(this.table.renderedRowToSource(0)).start();for(let r=0;r<e;r++){this.orderView.render();const e=this.orderView.getCurrentNode(),i=this.table.renderedRowToSource(r);var t,n;if(this.table.isAriaEnabled())Vp(e,[["role","row"],vp(i+(null!==(t=null===(n=this.table.rowUtils)||void 0===n||null===(n=n.dataAccessObject)||void 0===n?void 0:n.columnHeaders.length)&&void 0!==t?t:0)+1)]);(i+1)%2==0?kp(e,vC)||(Dp(e,CC),Fp(e,vC)):kp(e,CC)||(Dp(e,vC),Fp(e,CC))}this.orderView.end()}}function EC(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class bC extends dC{constructor(){super("TD"),EC(this,"orderViews",new WeakMap),EC(this,"sourceRowIndex",0)}obtainOrderView(e){let t;return this.orderViews.has(e)?t=this.orderViews.get(e):(t=new lC(e,(e=>this.nodesPool.obtain(this.sourceRowIndex,e)),this.nodeType),this.orderViews.set(e,t)),t}render(){const{rowsToRender:e,columnsToRender:t,rows:n,rowHeaders:r}=this.table;for(let s=0;s<e;s++){const e=this.table.renderedRowToSource(s),a=n.getRenderedNode(s);this.sourceRowIndex=e;const l=this.obtainOrderView(a),h=r.obtainOrderView(a);l.prependView(h).setSize(t).setOffset(0).start();for(let n=0;n<t;n++){l.render();const t=this.table.renderedColumnToSource(n),r=l.getCurrentNode();var i,o;if(kp(r,"hide")||(r.className=""),r.removeAttribute("style"),r.removeAttribute("dir"),Up(r,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.cellRenderer(e,t,r),this.table.isAriaEnabled())Vp(r,[...r.hasAttribute("role")?[]:[["role","gridcell"]],cp(-1),Cp(t+(null!==(i=null===(o=this.table.rowUtils)||void 0===o||null===(o=o.dataAccessObject)||void 0===o?void 0:o.rowHeaders.length)&&void 0!==i?i:0)+1)])}l.end()}}}function TC(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class NC{constructor(e){let{cellRenderer:t,stylesHandler:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};TC(this,"rootNode",void 0),TC(this,"rootDocument",void 0),TC(this,"rowHeaders",null),TC(this,"columnHeaders",null),TC(this,"colGroup",null),TC(this,"rows",null),TC(this,"cells",null),TC(this,"rowFilter",null),TC(this,"columnFilter",null),TC(this,"rowUtils",null),TC(this,"columnUtils",null),TC(this,"rowsToRender",0),TC(this,"columnsToRender",0),TC(this,"rowHeaderFunctions",[]),TC(this,"rowHeadersCount",0),TC(this,"columnHeaderFunctions",[]),TC(this,"columnHeadersCount",0),TC(this,"cellRenderer",void 0),TC(this,"activeOverlayName",void 0),TC(this,"stylesHandler",void 0),this.rootNode=e,this.rootDocument=this.rootNode.ownerDocument,this.cellRenderer=t,this.stylesHandler=n}setActiveOverlayName(e){this.activeOverlayName=e}setAxisUtils(e,t){this.rowUtils=e,this.columnUtils=t}setViewportSize(e,t){this.rowsToRender=e,this.columnsToRender=t}setFilters(e,t){this.rowFilter=e,this.columnFilter=t}setHeaderContentRenderers(e,t){this.rowHeaderFunctions=e,this.rowHeadersCount=e.length,this.columnHeaderFunctions=t,this.columnHeadersCount=t.length}setRenderers(){let{rowHeaders:e,columnHeaders:t,colGroup:n,rows:r,cells:i}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.setTable(this),t.setTable(this),n.setTable(this),r.setTable(this),i.setTable(this),this.rowHeaders=e,this.columnHeaders=t,this.colGroup=n,this.rows=r,this.cells=i}renderedRowToSource(e){return this.rowFilter.renderedToSource(e)}renderedColumnToSource(e){return this.columnFilter.renderedToSource(e)}isAriaEnabled(){return this.rowUtils.wtSettings.getSetting("ariaTags")}render(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();const{rowsToRender:e,rows:t}=this;for(let n=0;n<e;n++){const e=t.getRenderedNode(n),r=this.rowUtils;if(e.firstChild){const t=this.renderedRowToSource(n),i=r.getHeightByOverlayName(t,this.activeOverlayName),o=this.stylesHandler.areCellsBorderBox()?0:1;e.firstChild.style.height=i?i-o+"px":""}}}}class AC{constructor(){let{TABLE:e,THEAD:t,COLGROUP:n,TBODY:r,rowUtils:i,columnUtils:o,cellRenderer:s,stylesHandler:a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.renderer=new NC(e,{cellRenderer:s,stylesHandler:a}),this.renderer.setRenderers({rowHeaders:new gC,columnHeaders:new mC(t),colGroup:new wC(n),rows:new RC(r),cells:new bC}),this.renderer.setAxisUtils(i,o)}setActiveOverlayName(e){return this.renderer.setActiveOverlayName(e),this}setFilters(e,t){return this.renderer.setFilters(e,t),this}setViewportSize(e,t){return this.renderer.setViewportSize(e,t),this}setHeaderContentRenderers(e,t){return this.renderer.setHeaderContentRenderers(e,t),this}adjust(){this.renderer.adjust()}render(){this.renderer.render()}}function MC(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class IC{constructor(e,t){MC(this,"dataAccessObject",void 0),MC(this,"wtSettings",void 0),MC(this,"headerWidths",new Map),this.dataAccessObject=e,this.wtSettings=t}getWidth(e){return this.wtSettings.getSetting("columnWidth",e)||this.wtSettings.getSetting("defaultColumnWidth")}getHeaderHeight(e){let t=this.dataAccessObject.stylesHandler.getDefaultRowHeight();const n=this.dataAccessObject.wtViewport.oversizedColumnHeaders[e];return void 0!==n&&(t=t?Math.max(t,n):n),t}getHeaderWidth(e){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(e))}calculateWidths(){const{wtSettings:e}=this;let t=e.getSetting("rowHeaderWidth");if(t=e.getSetting("onModifyRowHeaderWidth",t),null!=t){const n=e.getSetting("rowHeaders").length,r=e.getSetting("defaultColumnWidth");for(let e=0;e<n;e++){let n=Array.isArray(t)?t[e]:t;n=null==n?r:n,this.headerWidths.set(e,n)}}}}function OC(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class xC{constructor(e,t){OC(this,"dataAccessObject",void 0),OC(this,"wtSettings",void 0),this.dataAccessObject=e,this.wtSettings=t}getHeight(e){let t=this.wtSettings.getSetting("rowHeight",e);const n=this.dataAccessObject.wtViewport.oversizedRows[e];return void 0!==n&&(t=void 0===t?n:Math.max(t,n)),t}getHeightByOverlayName(e,t){let n=this.wtSettings.getSetting("rowHeightByOverlayName",e,t);const r=this.dataAccessObject.wtViewport.oversizedRows[e];return void 0!==r&&(n=void 0===n?r:Math.max(n,r)),n}}function PC(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const _C=class{constructor(e,t,n,r,i){PC(this,"wtSettings",null),PC(this,"domBindings",void 0),PC(this,"TBODY",null),PC(this,"THEAD",null),PC(this,"COLGROUP",null),PC(this,"hasTableHeight",!0),PC(this,"hasTableWidth",!0),PC(this,"isTableVisible",!1),PC(this,"tableOffset",0),PC(this,"holderOffset",0),this.domBindings=n,this.isMaster="master"===i,this.name=i,this.dataAccessObject=e,this.facadeGetter=t,this.wtSettings=r,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=n.rootTable,Bp(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;const o=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",(()=>this._modifyRowHeaderWidth(o))),this.rowUtils=new xC(this.dataAccessObject,this.wtSettings),this.columnUtils=new IC(this.dataAccessObject,this.wtSettings),this.tableRenderer=new AC({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer"),stylesHandler:this.dataAccessObject.stylesHandler})}is(e){return this.name===e}fixTableDomTree(){const e=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=e.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=e.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=e.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}createSpreader(e){const t=e.parentNode;let n;return t&&t.nodeType===Node.ELEMENT_NODE&&kp(t,"wtHolder")||(n=this.domBindings.rootDocument.createElement("div"),n.className="wtSpreader",t&&t.insertBefore(n,e),n.appendChild(e)),n.style.position="relative",this.wtSettings.getSetting("ariaTags")&&Vp(n,[dp()]),n}createHider(e){const t=e.parentNode;let n;return t&&t.nodeType===Node.ELEMENT_NODE&&kp(t,"wtHolder")||(n=this.domBindings.rootDocument.createElement("div"),n.className="wtHider",t&&t.insertBefore(n,e),n.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&Vp(n,[dp()]),n}createHolder(e){const t=e.parentNode;let n;return t&&t.nodeType===Node.ELEMENT_NODE&&kp(t,"wtHolder")||(n=this.domBindings.rootDocument.createElement("div"),n.style.position="relative",n.className="wtHolder",Vp(n,[cp(-1)]),t&&t.insertBefore(n,e),this.isMaster&&(n.parentNode.className+="ht_master handsontable",n.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr"),this.wtSettings.getSetting("ariaTags")&&Vp(n.parentNode,[dp()])),n.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&Vp(n,[dp()]),n}draw(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const{wtSettings:t}=this,{wtOverlays:n,wtViewport:r}=this.dataAccessObject,i=t.getSetting("totalRows"),o=t.getSetting("totalColumns"),s=t.getSetting("rowHeaders"),a=s.length,l=t.getSetting("columnHeaders"),h=l.length;let u=e;if(this.isMaster&&(n.beforeDraw(),this.holderOffset=Yp(this.holder),u=r.createCalculators(u),a&&!t.getSetting("fixedColumnsStart"))){const e=n.inlineStartOverlay.getScrollPosition(),t=this.correctHeaderWidth;this.correctHeaderWidth=0!==e,t!==this.correctHeaderWidth&&(u=!1)}if(u)this.isMaster&&n.refresh(!0);else{this.isMaster?this.tableOffset=Yp(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;const e=i>0?this.getFirstRenderedRow():0,t=o>0?this.getFirstRenderedColumn():0;this.rowFilter=new Wv(e,i,h),this.columnFilter=new Uv(t,o,a);let u=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();const e={};this.wtSettings.getSetting("beforeDraw",!0,e),u=!0!==e.skipRender}u&&(this.tableRenderer.setHeaderContentRenderers(s,l),(this.is(BC)||this.is(GC))&&this.tableRenderer.setHeaderContentRenderers(s,[]),this.resetOversizedRows(),this.tableRenderer.setActiveOverlayName(this.name).setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render(),this.isMaster&&this.markOversizedColumnHeaders(),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(BC))&&this.markOversizedRows(),this.isMaster?(this.wtSettings.getSetting("externalRowCalculator")||r.createVisibleCalculators(),n.refresh(!1),n.applyToDOM(),this.wtSettings.getSetting("onDraw",!0)):this.is(BC)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize())}let c=!1;return this.isMaster&&(c=n.topOverlay.resetFixedPosition(),n.bottomOverlay.clone&&(c=n.bottomOverlay.resetFixedPosition()||c),c=n.inlineStartOverlay.resetFixedPosition()||c,n.topInlineStartCornerOverlay&&n.topInlineStartCornerOverlay.resetFixedPosition(),n.bottomInlineStartCornerOverlay&&n.bottomInlineStartCornerOverlay.clone&&n.bottomInlineStartCornerOverlay.resetFixedPosition()),c?(n.refreshAll(),n.adjustElementsSize()):this.dataAccessObject.selectionManager.setActiveOverlay(this.facadeGetter()).render(u),this.isMaster&&n.afterDraw(),this.dataAccessObject.drawn=!0,this}markIfOversizedColumnHeader(e){const t=this.columnFilter.renderedToSource(e);let n=this.wtSettings.getSetting("columnHeaders").length;const r=this.dataAccessObject.stylesHandler.getDefaultRowHeight();let i,o,s;const a=this.wtSettings.getSetting("columnHeaderHeight")||[];for(;n;)n-=1,i=this.getColumnHeaderHeight(n),o=this.getColumnHeader(t,n),o&&(s=rg(o),(!i&&r<s||i<s)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=s),Array.isArray(a)?null!==a[n]&&void 0!==a[n]&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=a[n]):isNaN(a)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=a),this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]<(a[n]||a)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=a[n]||a))}adjustColumnHeaderHeights(){const{wtSettings:e}=this,t=this.THEAD.childNodes,n=this.dataAccessObject.wtViewport.oversizedColumnHeaders;for(let r=0,i=e.getSetting("columnHeaders").length;r<i;r++)if(n[r]){if(!t[r]||0===t[r].childNodes.length)return;t[r].childNodes[0].style.height=`${n[r]}px`}}resetOversizedRows(){const{wtSettings:e}=this,{wtViewport:t}=this.dataAccessObject;if((this.isMaster||this.is(BC))&&!e.getSetting("externalRowCalculator")){const e=this.getRenderedRowsCount();for(let n=0;n<e;n++){const e=this.rowFilter.renderedToSource(n);t.oversizedRows&&t.oversizedRows[e]&&(t.oversizedRows[e]=void 0)}}}getCell(e){let t=e.row,n=e.col;const r=this.wtSettings.getSetting("onModifyGetCellCoords",t,n,!this.isMaster,"render");if(r&&Array.isArray(r)&&([t,n]=r),this.isRowBeforeRenderedRows(t))return-1;if(this.isRowAfterRenderedRows(t))return-2;if(this.isColumnBeforeRenderedColumns(n))return-3;if(this.isColumnAfterRenderedColumns(n))return-4;const i=this.getRow(t);if(!i&&t>=0)throw new Error("TR was expected to be rendered but is not");const o=i.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(n)];if(!o&&n>=0)throw new Error("TD or TH was expected to be rendered but is not");return o}getRow(e){let t=null,n=null;var r,i;e<0?(t=null===(r=this.rowFilter)||void 0===r?void 0:r.sourceRowToVisibleColHeadedRow(e),n=this.THEAD):(t=null===(i=this.rowFilter)||void 0===i?void 0:i.sourceToRendered(e),n=this.TBODY);return void 0!==t&&void 0!==n&&(!(n.childNodes.length<t+1)&&n.childNodes[t])}getColumnHeader(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=this.THEAD.childNodes[t];return null==n?void 0:n.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]}getColumnHeaders(e){const t=[],n=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e);return this.THEAD.childNodes.forEach((e=>{const r=e.childNodes[n];r&&t.push(r)})),t}getRowHeader(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(t>=this.wtSettings.getSetting("rowHeaders").length)return;const n=this.rowFilter.sourceToRendered(e),r=n<0?this.rowFilter.sourceRowToVisibleColHeadedRow(e):n,i=(n<0?this.THEAD:this.TBODY).childNodes[r];return null==i?void 0:i.childNodes[t]}getRowHeaders(e){const t=[],n=this.wtSettings.getSetting("rowHeaders").length;for(let r=0;r<n;r++){const n=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)],i=null==n?void 0:n.childNodes[r];i&&t.push(i)}return t}getCoords(e){let t=e;if("TD"!==t.nodeName&&"TH"!==t.nodeName&&(t=Op(t,["TD","TH"])),null===t)return null;const n=t.parentNode,r=n.parentNode;let i=function(e){let t=0,n=e;if(n.previousSibling)for(;n=n.previousSibling;)t+=1;return t}(n),o=t.cellIndex;if(_p(jC,t,this.wtRootElement)||_p(UC,t,this.wtRootElement))"THEAD"===r.nodeName&&(i-=r.childNodes.length);else if(_p(GC,t,this.wtRootElement)||_p(BC,t,this.wtRootElement)){i=this.wtSettings.getSetting("totalRows")-r.childNodes.length+i}else r===this.THEAD?i=this.rowFilter.visibleColHeadedRowToSourceRow(i):this.rowFilter&&(i=this.rowFilter.renderedToSource(i));_p(jC,t,this.wtRootElement)||_p(WC,t,this.wtRootElement)||_p(GC,t,this.wtRootElement)?o=this.columnFilter.offsettedTH(o):this.columnFilter&&(o=this.columnFilter.visibleRowHeadedColumnToSourceColumn(o));const s=this.wtSettings.getSetting("onModifyGetCoordsElement",i,o);return s&&Array.isArray(s)&&([i,o]=s),this.wot.createCellCoords(i,o)}markOversizedRows(){if(this.wtSettings.getSetting("externalRowCalculator"))return;let e=this.TBODY.childNodes.length;const t=e*this.dataAccessObject.stylesHandler.getDefaultRowHeight(),n=rg(this.TBODY)-1,r=this.wot.stylesHandler.areCellsBorderBox(),i=r?ng:rg,o=r?0:1,s=r?1:0;let a,l,h,u,c;if(t!==n||this.wtSettings.getSetting("fixedRowsBottom"))for(;e;){e-=1,h=this.rowFilter.renderedToSource(e),a=this.getRowHeight(h),u=this.getTrForRow(h),c=u.querySelector("th");const t=0===h?s:0;l=c?i(c):i(u)-o,(!a&&this.dataAccessObject.stylesHandler.getDefaultRowHeight()<l-t||a<l)&&(r||(l+=1),this.dataAccessObject.wtViewport.oversizedRows[h]=l)}}getTrForRow(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]}isColumnHeaderRendered(e){if(e>=0)return!1;const t=this.wtSettings.getSetting("rowHeaders").length;return Math.abs(e)<=t}isRowHeaderRendered(e){if(e>=0)return!1;const t=this.wtSettings.getSetting("columnHeaders").length;return Math.abs(e)<=t}isRowBeforeRenderedRows(e){const t=this.getFirstRenderedRow();return e<0&&t<=0?!this.isRowHeaderRendered(e):e<t}isRowAfterRenderedRows(e){return e>this.getLastRenderedRow()}isColumnBeforeRenderedColumns(e){const t=this.getFirstRenderedColumn();return e<0&&t<=0?!this.isColumnHeaderRendered(e):e<t}isColumnAfterRenderedColumns(e){return this.columnFilter&&e>this.getLastRenderedColumn()}isColumnAfterViewport(e){return this.columnFilter&&e>this.getLastVisibleColumn()}isRowAfterViewport(e){return this.rowFilter&&e>this.getLastVisibleRow()}isColumnBeforeViewport(e){return this.columnFilter&&this.columnFilter.sourceToRendered(e)<0&&e>=0}isLastRowFullyVisible(){return this.getLastVisibleRow()===this.getLastRenderedRow()}isLastColumnFullyVisible(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}allRowsInViewport(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}allColumnsInViewport(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}getRowHeight(e){return this.rowUtils.getHeight(e)}getColumnHeaderHeight(e){return this.columnUtils.getHeaderHeight(e)}getColumnWidth(e){return this.columnUtils.getWidth(e)}hasDefinedSize(){return this.hasTableHeight&&this.hasTableWidth}getWidth(){return tg(this.TABLE)}getHeight(){return ng(this.TABLE)}getTotalWidth(){const e=tg(this.hider);return 0!==e?e:this.getWidth()}getTotalHeight(){const e=ng(this.hider);return 0!==e?e:this.getHeight()}isVisible(){return $p(this.TABLE)}_modifyRowHeaderWidth(e){let t=Cg(e)?e():null;return Array.isArray(t)?(t=[...t],t[t.length-1]=this._correctRowHeaderWidth(t[t.length-1])):t=this._correctRowHeaderWidth(t),t}_correctRowHeaderWidth(e){let t=e;return"number"!=typeof e&&(t=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(t+=1),t}},LC={getFirstRenderedRow(){const e=this.wtSettings.getSetting("totalRows"),t=this.wtSettings.getSetting("fixedRowsBottom"),n=e-t;return 0===e||0===t?-1:n<0?0:n},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){const e=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsBottom"),e)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount:()=>0};lm(LC,"MIXIN_NAME","stickyRowsBottom",{writable:!1,enumerable:!1});const HC=LC,kC={getFirstRenderedColumn(){return 0===this.wtSettings.getSetting("totalColumns")?-1:0},getFirstVisibleColumn(){return this.getFirstRenderedColumn()},getFirstPartiallyVisibleColumn(){return this.getFirstRenderedColumn()},getLastRenderedColumn(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn(){return this.getLastRenderedColumn()},getLastPartiallyVisibleColumn(){return this.getLastRenderedColumn()},getRenderedColumnsCount(){const e=this.wtSettings.getSetting("totalColumns");return Math.min(this.wtSettings.getSetting("fixedColumnsStart"),e)},getVisibleColumnsCount(){return this.getRenderedColumnsCount()},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};lm(kC,"MIXIN_NAME","stickyColumnsStart",{writable:!1,enumerable:!1});const FC=kC;class DC extends _C{constructor(e,t,n,r){super(e,t,n,r,GC)}}om(DC,HC),om(DC,FC);const VC=DC,UC="top",BC="bottom",WC="inline_start",jC="top_inline_start_corner",GC="bottom_inline_start_corner",zC=[UC,BC,WC,jC,GC],$C=new Map([[UC,`ht_clone_${UC}`],[BC,`ht_clone_${BC}`],[WC,`ht_clone_${WC} ht_clone_left`],[jC,`ht_clone_${jC} ht_clone_top_left_corner`],[GC,`ht_clone_${GC} ht_clone_bottom_left_corner`]]);function YC(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function KC(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function XC(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var qC=new WeakSet;function QC(e){const{wtSettings:t,inlineStartOverlay:n,wtTable:r,wtViewport:i,totalColumns:o,rootWindow:s}=this.dataAccessObject;if(n.mainTableScrollableElement===s){let a=null;if(t.getSetting("rtlMode")){const e=r.TABLE.getBoundingClientRect(),t=this.dataAccessObject.rootWindow.document.documentElement.offsetWidth;a=Math.abs(e.right-t)}else{a=Yp(r.wtRootElement).left}const l=Math.abs(Qp(s,s));if(a>l){const t=ig(s);let r=i.getRowHeaderWidth();for(let i=1;i<=o;i++)if(r+=n.sumCellSizes(i-1,i),a+r-l>=t){e=i-2;break}}}return e}function ZC(e){const{topOverlay:t,wtTable:n,wtViewport:r,totalRows:i,rootWindow:o}=this.dataAccessObject;if(t.mainTableScrollableElement===o){const s=Yp(n.wtRootElement),a=qp(o,o);if(s.top>a){const n=rg(o);let l=r.getColumnHeaderHeight();for(let r=1;r<=i;r++)if(l+=t.sumCellSizes(r-1,r),s.top+l-a>=n){e=r-2;break}}}return e}const JC=class{constructor(e){YC(this,qC),KC(this,"dataAccessObject",void 0),this.dataAccessObject=e}scrollViewport(e,t,n){if(e.col<0||e.row<0)return!1;const r=this.scrollViewportHorizontally(e.col,t),i=this.scrollViewportVertically(e.row,n);return r||i}scrollViewportHorizontally(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"auto";const{drawn:n,totalColumns:r}=this.dataAccessObject;if(!n)return!1;const i=dm(t);if(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollHorizontally",e,i),!Number.isInteger(e)||e<0||e>r)return!1;t=i.value;const{fixedColumnsStart:o,inlineStartOverlay:s}=this.dataAccessObject,a="auto"===t;if(a&&e<o)return!1;const l=this.getFirstVisibleColumn(),h=this.getLastVisibleColumn();let u=!1;return(a&&(e<l||e>h)||!a)&&(u=s.scrollTo(e,a?e>=this.getLastPartiallyVisibleColumn():"end"===t)),u}scrollViewportVertically(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"auto";const{drawn:n,totalRows:r}=this.dataAccessObject;if(!n)return!1;const i=dm(t);if(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollVertically",e,i),!Number.isInteger(e)||e<0||e>r)return!1;t=i.value;const{fixedRowsBottom:o,fixedRowsTop:s,topOverlay:a}=this.dataAccessObject,l="auto"===t;if(l&&(e<s||e>r-o-1))return!1;const h=this.getFirstVisibleRow(),u=this.getLastVisibleRow();let c=!1;return(l&&(e<h||e>u)||!l)&&(c=a.scrollTo(e,l?e>=this.getLastPartiallyVisibleRow():"bottom"===t)),c}getFirstVisibleRow(){return this.dataAccessObject.wtTable.getFirstVisibleRow()}getLastVisibleRow(){return XC(qC,this,ZC).call(this,this.dataAccessObject.wtTable.getLastVisibleRow())}getFirstPartiallyVisibleRow(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleRow()}getLastPartiallyVisibleRow(){return XC(qC,this,ZC).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleRow())}getFirstVisibleColumn(){return this.dataAccessObject.wtTable.getFirstVisibleColumn()}getLastVisibleColumn(){return XC(qC,this,QC).call(this,this.dataAccessObject.wtTable.getLastVisibleColumn())}getFirstPartiallyVisibleColumn(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleColumn()}getLastPartiallyVisibleColumn(){return XC(qC,this,QC).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleColumn())}};function eS(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class tS{get eventManager(){return new Ff(this)}constructor(e,t){eS(this,"wtTable",void 0),eS(this,"wtScroll",void 0),eS(this,"wtViewport",void 0),eS(this,"wtOverlays",void 0),eS(this,"selectionManager",void 0),eS(this,"wtEvent",void 0),eS(this,"guid",`wt_${sp()}`),eS(this,"drawInterrupted",!1),eS(this,"drawn",!1),eS(this,"activeOverlayName","master"),eS(this,"domBindings",void 0),eS(this,"wtSettings",void 0),this.domBindings={rootTable:e,rootDocument:e.ownerDocument,rootWindow:e.ownerDocument.defaultView},this.wtSettings=t,this.wtScroll=new JC(this.createScrollDao())}findOriginalHeaders(){const e=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(let t=0,n=this.wtTable.THEAD.childNodes[0].childNodes.length;t<n;t++)e.push(this.wtTable.THEAD.childNodes[0].childNodes[t].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(t,n){zp(n,e[t])}])}}createCellCoords(e,t){return new fv(e,t,this.wtSettings.getSetting("rtlMode"))}createCellRange(e,t,n){return new Ev(e,t,n,this.wtSettings.getSetting("rtlMode"))}draw(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.drawInterrupted=!1,this.wtTable.isVisible()?this.wtTable.draw(e):this.drawInterrupted=!0,this}getCell(e){if(!(arguments.length>1&&void 0!==arguments[1]&&arguments[1]))return this.wtTable.getCell(e);const t=this.wtSettings.getSetting("totalRows"),n=this.wtSettings.getSetting("fixedRowsTop"),r=this.wtSettings.getSetting("fixedRowsBottom"),i=this.wtSettings.getSetting("fixedColumnsStart");if(e.row<n&&e.col<i)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(e);if(e.row<n)return this.wtOverlays.topOverlay.clone.wtTable.getCell(e);if(e.col<i&&e.row>=t-r){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(e)}else{if(e.col<i)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(e);if(e.row<t&&e.row>=t-r&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(e)}return this.wtTable.getCell(e)}scrollViewport(e,t,n){return this.wtScroll.scrollViewport(e,t,n)}scrollViewportHorizontally(e,t){return this.wtScroll.scrollViewportHorizontally(e,t)}scrollViewportVertically(e,t){return this.wtScroll.scrollViewportVertically(e,t)}getViewport(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}destroy(){this.wtOverlays.destroy(),this.wtEvent.destroy()}createScrollDao(){const e=this;return{get drawn(){return e.drawn},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get wtTable(){return e.wtTable},get wtViewport(){return e.wtViewport},get wtSettings(){return e.wtSettings},get rootWindow(){return e.domBindings.rootWindow},get totalRows(){return e.wtSettings.getSetting("totalRows")},get totalColumns(){return e.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return e.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return e.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return e.wtSettings.getSetting("fixedColumnsStart")}}}getTableDao(){const e=this;return{get wot(){return e},get parentTableOffset(){return e.cloneSource.wtTable.tableOffset},get cloneSource(){return e.cloneSource},get workspaceWidth(){return e.wtViewport.getWorkspaceWidth()},get wtViewport(){return e.wtViewport},get wtOverlays(){return e.wtOverlays},get selectionManager(){return e.selectionManager},get stylesHandler(){return e.stylesHandler},get drawn(){return e.drawn},set drawn(t){e.drawn=t},get wtTable(){return e.wtTable},get startColumnRendered(){return e.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return e.wtViewport.columnsVisibleCalculator.startColumn},get startColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.startColumn},get endColumnRendered(){return e.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return e.wtViewport.columnsVisibleCalculator.endColumn},get endColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.endColumn},get countColumnsRendered(){return e.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return e.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return e.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return e.wtViewport.rowsVisibleCalculator.startRow},get startRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.startRow},get endRowRendered(){return e.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return e.wtViewport.rowsVisibleCalculator.endRow},get endRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.endRow},get countRowsRendered(){return e.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return e.wtViewport.rowsVisibleCalculator.count},get columnHeaders(){return e.wtSettings.getSetting("columnHeaders")},get rowHeaders(){return e.wtSettings.getSetting("rowHeaders")}}}}function nS(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class rS extends tS{constructor(e,t,n){super(e,t),nS(this,"cloneSource",void 0),nS(this,"cloneOverlay",void 0);const r=this.wtSettings.getSetting("facade",this);this.cloneSource=n.source,this.cloneOverlay=n.overlay,this.stylesHandler=n.stylesHandler,this.wtTable=this.cloneOverlay.createTable(this.getTableDao(),r,this.domBindings,this.wtSettings),this.wtViewport=n.viewport,this.selectionManager=n.selectionManager,this.wtEvent=new Dv(r,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager,n.event),this.findOriginalHeaders()}}function iS(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class oS{constructor(e,t,n,r,i){iS(this,"wtSettings",null),lm(this,"wot",e,{writable:!1}),this.domBindings=i,this.facadeGetter=t,this.wtSettings=r;const{TABLE:o,hider:s,spreader:a,holder:l,wtRootElement:h}=this.wot.wtTable;this.instance=this.wot,this.type=n,this.mainTableScrollableElement=null,this.TABLE=o,this.hider=s,this.spreader=a,this.holder=l,this.wtRootElement=h,this.trimmingContainer=Jp(this.hider.parentNode.parentNode),this.needFullRender=this.shouldBeRendered(),this.clone=this.makeClone()}hasRenderingStateChanged(){return this.needFullRender!==this.shouldBeRendered()}updateStateOfRendering(e){"before"===e&&this.shouldBeRendered()?this.needFullRender=!0:"after"!==e||this.shouldBeRendered()||(this.needFullRender=!1)}shouldBeRendered(){return!0}updateTrimmingContainer(){this.trimmingContainer=Jp(this.hider.parentNode.parentNode)}updateMainScrollableElement(){const{wtTable:e}=this.wot,{rootWindow:t}=this.domBindings;"hidden"===t.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=Zp(e.TABLE)}getRelativeCellPosition(e,t,n){if(!1===this.clone.wtTable.holder.contains(e))return void Fm(`The provided element is not a child of the ${this.type} overlay`);const r=this.mainTableScrollableElement===this.domBindings.rootWindow,i=n<this.wtSettings.getSetting("fixedColumnsStart"),o=t<this.wtSettings.getSetting("fixedRowsTop"),s=t>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),a=this.clone.wtTable.spreader,l={start:this.getRelativeStartPosition(a),top:a.offsetTop},h={start:this.getRelativeStartPosition(e),top:e.offsetTop};let u=null;return u=r?this.getRelativeCellPositionWithinWindow(o,i,h,l):this.getRelativeCellPositionWithinHolder(o,s,i,h,l),u}getRelativeStartPosition(e){return this.isRtl()?e.offsetParent.offsetWidth-e.offsetLeft-e.offsetWidth:e.offsetLeft}getRelativeCellPositionWithinWindow(e,t,n,r){const i=this.wot.wtTable.wtRootElement.getBoundingClientRect();let o=0,s=0;if(t){let e=i.left;this.isRtl()&&(e=this.domBindings.rootWindow.innerWidth-(i.left+i.width+hg())),o=e<=0?-1*e:0}else o=r.start;if(e){s=this.clone.wtTable.TABLE.getBoundingClientRect().top-i.top}else s=r.top;return{start:n.start+o,top:n.top+s}}getRelativeCellPositionWithinHolder(e,t,n,r,i){const o=this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),s=this.wot.wtOverlays.topOverlay.getScrollPosition();let a=0,l=0;if(n||(a=o-i.start),t){const e=this.wot.wtTable.wtRootElement.getBoundingClientRect();l=-1*this.clone.wtTable.TABLE.getBoundingClientRect().top+e.top}else e||(l=s-i.top);return{start:r.start-a,top:r.top-l}}makeClone(){if(-1===zC.indexOf(this.type))throw new Error(`Clone type "${this.type}" is not supported.`);const{wtTable:e,wtSettings:t}=this.wot,{rootDocument:n,rootWindow:r}=this.domBindings,i=n.createElement("div"),o=n.createElement("table"),s=e.wtRootElement.parentNode;i.className=`${$C.get(this.type)} handsontable`,i.setAttribute("dir",this.isRtl()?"rtl":"ltr"),i.style.position="absolute",i.style.top=0,i.style.overflow="visible",this.isRtl()?i.style.right=0:i.style.left=0,t.getSetting("ariaTags")&&Vp(i,[dp()]),o.className=e.TABLE.className;e.TABLE.getAttribute("role")&&o.setAttribute("role",e.TABLE.getAttribute("role")),i.appendChild(o),s.appendChild(i);const a=this.wtSettings.getSetting("preventOverflow");return!0===a||"horizontal"===a&&this.type===UC||"vertical"===a&&this.type===WC?this.mainTableScrollableElement=r:"hidden"===r.getComputedStyle(s).getPropertyValue("overflow")?this.mainTableScrollableElement=e.holder:this.mainTableScrollableElement=Zp(e.TABLE),new rS(o,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selectionManager:this.wot.selectionManager,stylesHandler:this.wot.stylesHandler})}refresh(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.needFullRender){const t=this.clone.cloneSource;t.activeOverlayName=this.clone.wtTable.name,this.clone.draw(e),t.activeOverlayName="master"}}reset(){const e=this.clone.wtTable.holder,t=this.clone.wtTable.hider;[e.style,t.style,e.parentNode.style].forEach((e=>{e.width="",e.height=""}))}isRtl(){return this.wtSettings.getSetting("rtlMode")}destroy(){this.clone.eventManager.destroy()}}class sS extends oS{constructor(e,t,n,r,i,o){super(e,t,GC,n,r),this.bottomOverlay=i,this.inlineStartOverlay=o}createTable(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new VC(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wot:e}=this;if(this.updateTrimmingContainer(),!e.wtTable.holder.parentNode)return!1;const t=this.clone.wtTable.holder.parentNode;if(t.style.top="",this.trimmingContainer===this.domBindings.rootWindow){const e=this.inlineStartOverlay.getOverlayOffset(),n=this.bottomOverlay.getOverlayOffset();t.style[this.isRtl()?"right":"left"]=`${e}px`,t.style.bottom=`${n}px`}else pg(t),this.repositionOverlay();let n=ng(this.clone.wtTable.TABLE);const r=tg(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(n=0),t.style.height=`${n}px`,t.style.width=`${r}px`,!1}repositionOverlay(){const{wtTable:e,wtViewport:t}=this.wot,{rootDocument:n}=this.domBindings,r=this.clone.wtTable.holder.parentNode;let i=0;t.hasVerticalScroll()||(i+=t.getWorkspaceHeight()-e.getTotalHeight()),t.hasVerticalScroll()&&t.hasHorizontalScroll()&&(i+=hg(n)),r.style.bottom=`${i}px`}}const aS={getFirstRenderedColumn(){const e=this.dataAccessObject.startColumnRendered;return null===e?-1:e},getFirstVisibleColumn(){const e=this.dataAccessObject.startColumnVisible;return null===e?-1:e},getFirstPartiallyVisibleColumn(){const e=this.dataAccessObject.startColumnPartiallyVisible;return null===e?-1:e},getLastRenderedColumn(){const e=this.dataAccessObject.endColumnRendered;return null===e?-1:e},getLastVisibleColumn(){const e=this.dataAccessObject.endColumnVisible;return null===e?-1:e},getLastPartiallyVisibleColumn(){const e=this.dataAccessObject.endColumnPartiallyVisible;return null===e?-1:e},getRenderedColumnsCount(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount(){return this.dataAccessObject.countColumnsVisible},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};lm(aS,"MIXIN_NAME","calculatedColumns",{writable:!1,enumerable:!1});const lS=aS;class hS extends _C{constructor(e,t,n,r){super(e,t,n,r,BC)}}om(hS,HC),om(hS,lS);const uS=hS;function cS(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class dS extends oS{constructor(e,t,n,r){super(e,t,BC,n,r),cS(this,"cachedFixedRowsBottom",-1),this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom")}createTable(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new uS(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const{rootWindow:e}=this.domBindings,t=this.clone.wtTable.holder.parentNode;t.style.top="";let n=0;const r=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer!==e||r&&"vertical"===r?(n=this.getScrollPosition(),this.repositionOverlay()):(n=this.getOverlayOffset(),t.style.bottom=`${n}px`);const i=this.adjustHeaderBordersPosition(n);return this.adjustElementsSize(),i}repositionOverlay(){const{wtTable:e,wtViewport:t}=this.wot,{rootDocument:n}=this.domBindings,r=this.clone.wtTable.holder.parentNode;let i=0;t.hasVerticalScroll()||(i+=t.getWorkspaceHeight()-e.getTotalHeight()),t.hasVerticalScroll()&&t.hasHorizontalScroll()&&(i+=hg(n)),r.style.bottom=`${i}px`}setScrollPosition(e){const{rootWindow:t}=this.domBindings;let n=!1;return this.mainTableScrollableElement===t?(t.scrollTo(Xp(t),e),n=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,n=!0),n}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,t){const{wtTable:n,stylesHandler:r}=this.wot,i=r.getDefaultRowHeight();let o=e,s=0;for(;o<t;){const e=n.getRowHeight(o);s+=void 0===e?i:e,o+=1}return s}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:t}=this.wot,{rootDocument:n,rootWindow:r}=this.domBindings,i=this.clone.wtTable.holder.parentNode.style,o=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==r||"horizontal"===o){let r=t.getWorkspaceWidth();t.hasVerticalScroll()&&(r-=hg(n)),r=Math.min(r,e.wtRootElement.scrollWidth),i.width=`${r}px`}else i.width="";this.clone.wtTable.holder.style.width=i.width;let s=ng(this.clone.wtTable.TABLE);e.hasDefinedSize()||(s=0),i.height=`${s}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=e.parentNode.style.height}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if("number"==typeof this.wot.wtViewport.rowsRenderCalculator.startPosition)this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else{if(0!==e)throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.top="0"}this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:t}=this.clone.wtTable;"number"==typeof this.wot.wtViewport.columnsRenderCalculator.startPosition?t.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:t.style[e]=""}scrollTo(e,t){let n=this.getTableParentOffset();const r=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let i=0;t&&r.offsetHeight!==r.clientHeight&&(i=hg(this.domBindings.rootDocument)),t?(n+=this.sumCellSizes(0,e+1),n-=this.wot.wtViewport.getViewportHeight(),n+=1):n+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),e),n+=i,this.setScrollPosition(n)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return qp(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,t=this.wtSettings.getSetting("preventOverflow");let n=0;if(this.trimmingContainer===e&&(!t||"vertical"!==t)){const e=this.wot.wtTable.getTotalHeight(),t=e-this.clone.wtTable.getTotalHeight(),r=this.domBindings.rootDocument.documentElement.clientHeight;n=Math.max(this.getTableParentOffset()-this.getScrollPosition()-r+e,0),n>t&&(n=0)}return n}adjustHeaderBordersPosition(e){const t=this.wtSettings.getSetting("fixedRowsBottom"),n=this.cachedFixedRowsBottom!==t,r=this.wtSettings.getSetting("columnHeaders");let i=!1;if((n||0===t)&&r.length>0){const t=this.wot.wtTable.holder.parentNode,n=kp(t,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),e||0===this.wtSettings.getSetting("totalRows")?(Fp(t,"innerBorderBottom"),i=!n):(Dp(t,"innerBorderBottom"),i=n)}return i}}const pS={getFirstRenderedRow(){const e=this.dataAccessObject.startRowRendered;return null===e?-1:e},getFirstVisibleRow(){const e=this.dataAccessObject.startRowVisible;return null===e?-1:e},getFirstPartiallyVisibleRow(){const e=this.dataAccessObject.startRowPartiallyVisible;return null===e?-1:e},getLastRenderedRow(){const e=this.dataAccessObject.endRowRendered;return null===e?-1:e},getLastVisibleRow(){const e=this.dataAccessObject.endRowVisible;return null===e?-1:e},getLastPartiallyVisibleRow(){const e=this.dataAccessObject.endRowPartiallyVisible;return null===e?-1:e},getRenderedRowsCount(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount(){return this.dataAccessObject.countRowsVisible},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};lm(pS,"MIXIN_NAME","calculatedRows",{writable:!1,enumerable:!1});const gS=pS;class mS extends _C{constructor(e,t,n,r){super(e,t,n,r,WC)}}om(mS,gS),om(mS,FC);const fS=mS,wS={_localHooks:Object.create(null),addLocalHook(e,t){return this._localHooks[e]||(this._localHooks[e]=[]),this._localHooks[e].push(t),this},runLocalHooks(e,t,n,r,i,o,s){if(this._localHooks[e]){const a=this._localHooks[e].length;for(let l=0;l<a;l++)Eg(this._localHooks[e][l],this,t,n,r,i,o,s)}},clearLocalHooks(){return this._localHooks={},this}};lm(wS,"MIXIN_NAME","localHooks",{writable:!1,enumerable:!1});const yS=wS;let vS=class{constructor(e,t){this.settings=e,this.cellRange=t||null}isEmpty(){return null===this.cellRange}add(e){return this.isEmpty()?this.cellRange=this.settings.createCellRange(e):this.cellRange.expand(e),this}replace(e,t){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=t,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=t,!0}return!1}clear(){return this.cellRange=null,this}getCorners(){const e=this.cellRange.getOuterTopStartCorner(),t=this.cellRange.getOuterBottomEndCorner();return[e.row,e.col,t.row,t.col]}destroy(){this.runLocalHooks("destroy")}};om(vS,yS);const CS=vS,SS="active-header",RS="header",ES="area",bS="focus",TS=e=>{const t=e.stylesHandler;if(t.isClassicTheme())return Object.freeze({width:6,height:6,borderWidth:1,borderStyle:"solid",borderColor:"#FFF"});const n=t.getCSSVariableValue("cell-autofill-size"),r=t.getCSSVariableValue("cell-autofill-border-width"),i=t.getCSSVariableValue("cell-autofill-border-color");return Object.freeze({width:n,height:n,borderWidth:r,borderStyle:"solid",borderColor:i})};function NS(e,t,n){AS(e,t),t.set(e,n)}function AS(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function MS(e,t){return e.get(OS(e,t))}function IS(e,t,n){return e.set(OS(e,t),n),n}function OS(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}Xm("flat");var xS=new WeakMap,PS=new WeakMap,_S=new WeakSet;class LS{constructor(){var e,t;AS(e=this,t=_S),t.add(e),NS(this,xS,void 0),NS(this,PS,void 0)}setActiveOverlay(e){return IS(PS,this,e),this}setActiveSelection(e){return IS(xS,this,e),this}scan(){const e=MS(xS,this).settings.selectionType,t=new Set;return"active-header"===e?(this.scanColumnsInHeadersRange((e=>t.add(e))),this.scanRowsInHeadersRange((e=>t.add(e)))):"area"===e?this.scanCellsRange((e=>t.add(e))):"focus"===e?(this.scanColumnsInHeadersRange((e=>t.add(e))),this.scanRowsInHeadersRange((e=>t.add(e))),this.scanCellsRange((e=>t.add(e)))):"fill"===e?this.scanCellsRange((e=>t.add(e))):"header"===e?(this.scanColumnsInHeadersRange((e=>t.add(e))),this.scanRowsInHeadersRange((e=>t.add(e)))):"row"===e?(this.scanRowsInHeadersRange((e=>t.add(e))),this.scanRowsInCellsRange((e=>t.add(e)))):"column"===e&&(this.scanColumnsInHeadersRange((e=>t.add(e))),this.scanColumnsInCellsRange((e=>t.add(e)))),t}scanColumnsInHeadersRange(e){const[t,n,r,i]=MS(xS,this).getCorners(),{wtTable:o}=MS(PS,this),s=o.getRenderedColumnsCount(),a=o.getColumnHeadersCount();let l=0;for(let h=-o.getRowHeadersCount();h<s;h++){const s=o.columnFilter.renderedToSource(h);if(!(s<n||s>i)){for(let h=-a;h<0;h++){if(h<t||h>r)continue;const u=h+a;let c=o.getColumnHeader(s,u);const d=MS(PS,this).getSetting("onBeforeHighlightingColumnHeader",s,u,{selectionType:MS(xS,this).settings.selectionType,columnCursor:l,selectionWidth:i-n+1});null!==d&&(d!==s&&(c=o.getColumnHeader(d,u)),e(c))}l+=1}}}scanRowsInHeadersRange(e){const[t,n,r,i]=MS(xS,this).getCorners(),{wtTable:o}=MS(PS,this),s=o.getRenderedRowsCount(),a=o.getRowHeadersCount();let l=0;for(let h=-o.getColumnHeadersCount();h<s;h++){const s=o.rowFilter.renderedToSource(h);if(!(s<t||s>r)){for(let h=-a;h<0;h++){if(h<n||h>i)continue;const u=h+a;let c=o.getRowHeader(s,u);const d=MS(PS,this).getSetting("onBeforeHighlightingRowHeader",s,u,{selectionType:MS(xS,this).settings.selectionType,rowCursor:l,selectionHeight:r-t+1});null!==d&&(d!==s&&(c=o.getRowHeader(d,u)),e(c))}l+=1}}}scanCellsRange(e){const{wtTable:t}=MS(PS,this);OS(_S,this,HS).call(this,((n,r)=>{const i=t.getCell(MS(PS,this).createCellCoords(n,r)),o=MS(PS,this).getSetting("onAfterDrawSelection",n,r,MS(xS,this).settings.layerLevel);"string"==typeof o&&Fp(i,o),e(i)}))}scanRowsInCellsRange(e){const[t,,n]=MS(xS,this).getCorners(),{wtTable:r}=MS(PS,this);OS(_S,this,kS).call(this,((i,o)=>{if(i>=t&&i<=n){const t=r.getCell(MS(PS,this).createCellCoords(i,o));e(t)}}))}scanColumnsInCellsRange(e){const[,t,,n]=MS(xS,this).getCorners(),{wtTable:r}=MS(PS,this);OS(_S,this,kS).call(this,((i,o)=>{if(o>=t&&o<=n){const t=r.getCell(MS(PS,this).createCellCoords(i,o));e(t)}}))}}function HS(e){let[t,n,r,i]=MS(xS,this).getCorners();if(t<0&&r<0||n<0&&i<0)return;const{wtTable:o}=MS(PS,this),s=t!==r||n!==i;if(n=Math.max(n,0),i=Math.max(i,0),t=Math.max(t,0),r=Math.max(r,0),s){if(n=Math.max(n,o.getFirstRenderedColumn()),i=Math.min(i,o.getLastRenderedColumn()),t=Math.max(t,o.getFirstRenderedRow()),r=Math.min(r,o.getLastRenderedRow()),i<n||r<t)return}else{if(!vg(o.getCell(MS(PS,this).createCellCoords(t,n))))return}for(let a=t;a<=r;a+=1)for(let t=n;t<=i;t+=1)e(a,t)}function kS(e){const{wtTable:t}=MS(PS,this),n=t.getRenderedRowsCount(),r=t.getRenderedColumnsCount();for(let i=0;i<n;i+=1){const n=t.rowFilter.renderedToSource(i);for(let i=0;i<r;i+=1)e(n,t.columnFilter.renderedToSource(i))}}const FS=class{constructor(e,t){t&&(this.eventManager=e.eventManager,this.instance=e,this.wot=e,this.settings=t,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle=TS(this.instance),this.cornerCenterPointOffset=-Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(t),this.registerListeners())}registerListeners(){const e=this.wot.rootDocument.body;this.eventManager.addEventListener(e,"mousedown",(()=>this.onMouseDown())),this.eventManager.addEventListener(e,"mouseup",(()=>this.onMouseUp()));for(let t=0,n=this.main.childNodes.length;t<n;t++){const e=this.main.childNodes[t];this.eventManager.addEventListener(e,"mouseenter",(e=>this.onMouseEnter(e,this.main.childNodes[t])))}}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onMouseEnter(e,t){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;e.preventDefault(),_m(e);const n=this,r=this.wot.rootDocument.body,i=t.getBoundingClientRect();t.style.display="none",this.eventManager.addEventListener(r,"mousemove",(function e(o){var s;((s=o).clientY<Math.floor(i.top)||s.clientY>Math.ceil(i.top+i.height)||s.clientX<Math.floor(i.left)||s.clientX>Math.ceil(i.left+i.width))&&(n.eventManager.removeEventListener(r,"mousemove",e),t.style.display="block")}))}createBorders(e){const{rootDocument:t}=this.wot;this.main=t.createElement("div");const n=["top","start","bottom","end","corner"];let r=this.main.style;r.position="absolute",r.top=0,r.left=0;for(let s=0;s<5;s++){const i=n[s],o=t.createElement("div");o.className=`wtBorder ${this.settings.className||""}`,this.settings[i]&&this.settings[i].hide&&(o.className+=" hidden"),r=o.style,r.backgroundColor=this.settings[i]&&this.settings[i].color?this.settings[i].color:e.border.color,r.height=this.settings[i]&&this.settings[i].width?`${this.settings[i].width}px`:`${e.border.width}px`,r.width=this.settings[i]&&this.settings[i].width?`${this.settings[i].width}px`:`${e.border.width}px`,this.main.appendChild(o)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=`${this.cornerDefaultStyle.width}px`,this.cornerStyle.height=`${this.cornerDefaultStyle.height}px`,this.cornerStyle.border=[`${this.cornerDefaultStyle.borderWidth}px`,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),bm()&&this.instance.getSetting("isDataViewInstance")&&this.createMultipleSelectorHandles(),this.disappear();const{wtTable:i}=this.wot;let o=i.bordersHolder;o||(o=t.createElement("div"),o.className="htBorders",i.bordersHolder=o,i.spreader.appendChild(o)),o.appendChild(this.main)}createMultipleSelectorHandles(){const{rootDocument:e,stylesHandler:t}=this.wot,n=t.getCSSVariableValue("cell-mobile-handle-size"),r=t.getCSSVariableValue("cell-mobile-handle-border-radius"),i=t.getCSSVariableValue("cell-mobile-handle-background-color"),o=t.getCSSVariableValue("cell-mobile-handle-border-width"),s=t.getCSSVariableValue("cell-mobile-handle-border-color");this.selectionHandles={top:e.createElement("DIV"),topHitArea:e.createElement("DIV"),bottom:e.createElement("DIV"),bottomHitArea:e.createElement("DIV")};this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};hm({position:"absolute",height:"40px",width:"40px","border-radius":`${parseInt(40/1.5,10)}px`},((e,t)=>{this.selectionHandles.styles.bottomHitArea[t]=e,this.selectionHandles.styles.topHitArea[t]=e}));hm(t.isClassicTheme()?{position:"absolute",height:"10px",width:"10px","border-radius":`${parseInt(10/1.5,10)}px`,background:"#F5F5FF",border:"1px solid #4285c8"}:{position:"absolute",height:`${n}px`,width:`${n}px`,"border-radius":`${r}px`,background:`${i}`,border:`${o}px solid ${s}`},((e,t)=>{this.selectionHandles.styles.bottom[t]=e,this.selectionHandles.styles.top[t]=e})),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}isPartRange(e,t){const n=this.wot.selectionManager.getAreaSelection();return!(!n.cellRange||e===n.cellRange.to.row&&t===n.cellRange.to.col)}updateMultipleSelectionHandlesPosition(e,t,n,r,i,o){const s=this.wot.wtSettings.getSetting("rtlMode")?"right":"left",{top:a,topHitArea:l,bottom:h,bottomHitArea:u}=this.selectionHandles.styles,c=parseInt(a.borderWidth,10),d=parseInt(a.width,10),p=parseInt(l.width,10),g=this.wot.wtTable.getWidth(),m=this.wot.wtTable.getHeight();a.top=`${parseInt(n-d-1,10)}px`,a[s]=`${parseInt(r-d-1,10)}px`,l.top=`${parseInt(n-p/4*3,10)}px`,l[s]=`${parseInt(r-p/4*3,10)}px`;const f=Math.min(parseInt(r+i,10),g-d-2*c),w=Math.min(parseInt(r+i-p/4,10),g-p-2*c);h[s]=`${f}px`,u[s]=`${w}px`;const y=Math.min(parseInt(n+o,10),m-d-2*c),v=Math.min(parseInt(n+o-p/4,10),m-p-2*c);h.top=`${y}px`,u.top=`${v}px`,this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(a.display="block",l.display="block",this.isPartRange(e,t)?(h.display="none",u.display="none"):(h.display="block",u.display="block")):(a.display="none",h.display="none",l.display="none",u.display="none"),e===this.wot.wtSettings.getSetting("fixedRowsTop")||t===this.wot.wtSettings.getSetting("fixedColumnsStart")?(a.zIndex="9999",l.zIndex="9999"):(a.zIndex="",l.zIndex="")}appear(e){if(this.disabled)return;let[t,n,r,i]=e;if(t<0&&r<0||n<0&&i<0)return void this.disappear();const{wtTable:o,rootDocument:s,rootWindow:a}=this.wot,l=t!==r||n!==i,h=o.getFirstRenderedRow(),u=o.getLastRenderedRow(),c=o.getFirstRenderedColumn(),d=o.getLastRenderedColumn();let p;if(l){if(n=Math.max(n,c),i=Math.min(i,d),t=Math.max(t,h),r=Math.min(r,u),i<n||r<t)return void this.disappear();p=o.getCell(this.wot.createCellCoords(t,n))}else if(p=o.getCell(this.wot.createCellCoords(t,n)),!vg(p))return void this.disappear();const g=l?o.getCell(this.wot.createCellCoords(r,i)):p,m=Yp(p),f=l?Yp(g):m,w=Yp(o.TABLE),y=m.top,v=m.left,C=this.wot.wtSettings.getSetting("rtlMode");let S=0,R=0;if(C){const e=tg(o.TABLE),t=tg(p),n=a.innerWidth-w.left-e;R=v+t-f.left,S=a.innerWidth-v-t-n-1}else R=f.left+tg(g)-v,S=v-w.left-1;if(this.isEntireColumnSelected(t,r)){const e=t,r=this.getDimensionsFromHeader("columns",n,i,e,w);let o=null;r&&([o,S,R]=r),o&&(p=o)}let E=y-w.top-1,b=f.top+ng(g)-y;if(this.isEntireRowSelected(n,i)){const e=n,i=this.getDimensionsFromHeader("rows",t,r,e,w);let o=null;i&&([o,E,b]=i),o&&(p=o)}const T=a.getComputedStyle(p);parseInt(T.borderTopWidth,10)>0&&(E+=1,b=b>0?b-1:0),parseInt(T[C?"borderRightWidth":"borderLeftWidth"],10)>0&&(S+=1,R=R>0?R-1:0);const N=C?"right":"left";this.topStyle.top=`${E}px`,this.topStyle[N]=`${S}px`,this.topStyle.width=`${R}px`,this.topStyle.display="block",this.startStyle.top=`${E}px`,this.startStyle[N]=`${S}px`,this.startStyle.height=`${b}px`,this.startStyle.display="block";const A=Math.floor(this.settings.border.width/2);this.bottomStyle.top=E+b-A+"px",this.bottomStyle[N]=`${S}px`,this.bottomStyle.width=`${R}px`,this.bottomStyle.display="block",this.endStyle.top=`${E}px`,this.endStyle[N]=S+R-A+"px",this.endStyle.height=`${b+1}px`,this.endStyle.display="block";let M=this.settings.border.cornerVisible;M="function"==typeof M?M(this.settings.layerLevel):M;const I=this.wot.getSetting("onModifyGetCellCoords",r,i,!1,"render");let[O,x]=[r,i];if(I&&Array.isArray(I)&&([,,O,x]=I),bm()||!M||this.isPartRange(O,x))this.cornerStyle.display="none";else{this.cornerStyle.top=E+b+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth+"px",this.cornerStyle[N]=S+R+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth+"px",this.cornerStyle.borderRightWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderLeftWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderBottomWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";let e=Jp(o.TABLE);const t=e===a;t&&(e=s.documentElement);const n=parseInt(this.cornerDefaultStyle.borderWidth,10)-1,l=Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),h=Math.ceil(parseInt(this.cornerDefaultStyle.height,10)/2);if(i===this.wot.getSetting("totalColumns")-1){const r=t?g.getBoundingClientRect().left:g.offsetLeft;let i=!1,o=0;C?(o=r-parseInt(this.cornerDefaultStyle.width,10)/2,i=o<0):(o=r+tg(g)+parseInt(this.cornerDefaultStyle.width,10)/2,i=o>=ig(e)),i&&(this.cornerStyle[N]=`${Math.floor(S+R+this.cornerCenterPointOffset-l-n)}px`,this.cornerStyle[C?"borderLeftWidth":"borderRightWidth"]=0)}if(r===this.wot.getSetting("totalRows")-1){const r=(t?g.getBoundingClientRect().top:g.offsetTop)+ng(g)+parseInt(this.cornerDefaultStyle.height,10)/2>=rg(e),i=this.wot.stylesHandler.isClassicTheme();if(r){const e=Math.floor(E+b+this.cornerCenterPointOffset-h-n);i?(this.cornerStyle.top=`${e}px`,this.cornerStyle.borderBottomWidth=0):this.cornerStyle.top=e-1+"px"}}this.cornerStyle.display="block"}bm()&&this.instance.getSetting("isDataViewInstance")&&this.updateMultipleSelectionHandlesPosition(r,i,E,S,R,b)}isEntireColumnSelected(e,t){return e===this.wot.wtTable.getFirstRenderedRow()&&t===this.wot.wtTable.getLastRenderedRow()}isEntireRowSelected(e,t){return e===this.wot.wtTable.getFirstRenderedColumn()&&t===this.wot.wtTable.getLastRenderedColumn()}getDimensionsFromHeader(e,t,n,r,i){const{wtTable:o}=this.wot,s=o.wtRootElement.parentNode;let a=null,l=null,h=null,u=null,c=null,d=null,p=null,g=null;switch(e){case"rows":a=function(){return o.getRowHeader(...arguments)},l=function(){return ng(...arguments)},h="ht__selection--rows",d="top";break;case"columns":a=function(){return o.getColumnHeader(...arguments)},l=function(){return tg(...arguments)},h="ht__selection--columns",d="left"}if(s.classList.contains(h)){const e=this.wot.getSetting("columnHeaders").length;if(p=a(t,e-r),g=a(n,e-r),!p||!g)return!1;const o=Yp(p),s=Yp(g);return p&&g&&(u=o[d]-i[d]-1,c=s[d]+l(g)-o[d]),[p,u,c]}return!1}changeBorderStyle(e,t){const n=this[e].style,r=t[e];!r||r.hide?Fp(this[e],"hidden"):(kp(this[e],"hidden")&&Dp(this[e],"hidden"),n.backgroundColor=r.color,"top"!==e&&"bottom"!==e||(n.height=`${r.width}px`),"start"!==e&&"end"!==e||(n.width=`${r.width}px`))}changeBorderToDefaultStyle(e){const t=1,n="#000",r=this[e].style;r.backgroundColor=n,r.width=`${t}px`,r.height=`${t}px`}toggleHiddenClass(e,t){this.changeBorderToDefaultStyle(e),t?Fp(this[e],"hidden"):Dp(this[e],"hidden")}disappear(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",bm()&&this.instance.getSetting("isDataViewInstance")&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}destroy(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}};function DS(e,t,n){VS(e,t),t.set(e,n)}function VS(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function US(e,t){return e.get(WS(e,t))}function BS(e,t,n){return e.set(WS(e,t),n),n}function WS(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var jS=new WeakMap,GS=new WeakMap,zS=new WeakMap,$S=new WeakMap,YS=new WeakMap,KS=new WeakMap,XS=new WeakSet;class qS{constructor(e){var t,n;VS(t=this,n=XS),n.add(t),DS(this,jS,void 0),DS(this,GS,void 0),DS(this,zS,new LS),DS(this,$S,new WeakMap),DS(this,YS,new WeakSet),DS(this,KS,new Map),BS(GS,this,e)}setActiveOverlay(e){return BS(jS,this,e),US(zS,this).setActiveOverlay(US(jS,this)),US($S,this).has(US(jS,this))||US($S,this).set(US(jS,this),new Set),this}getFocusSelection(){return null!==US(GS,this)?US(GS,this).getFocus():null}getAreaSelection(){return null!==US(GS,this)?US(GS,this).createLayeredArea():null}getBorderInstance(e){if(!e.settings.border)return null;if(US(KS,this).has(e)){const t=US(KS,this).get(e);if(t.has(US(jS,this)))return t.get(US(jS,this));const n=new FS(US(jS,this),e.settings);return t.set(US(jS,this),n),n}const t=new FS(US(jS,this),e.settings);return US(KS,this).set(e,new Map([[US(jS,this),t]])),t}getBorderInstances(e){var t,n;return Array.from(null!==(t=null===(n=US(KS,this).get(e))||void 0===n?void 0:n.values())&&void 0!==t?t:[])}destroyBorders(e){US(KS,this).get(e).forEach((e=>e.destroy())),US(KS,this).delete(e)}render(e){if(null===US(GS,this))return;e&&WS(XS,this,QS).call(this);const t=Array.from(US(GS,this)),n=new Map,r=new Map;for(let i=0;i<t.length;i++){const e=t[i],{className:o,headerAttributes:s,createLayers:a,selectionType:l}=e.settings;US(YS,this).has(e)||(US(YS,this).add(e),e.addLocalHook("destroy",(()=>this.destroyBorders(e))));const h=this.getBorderInstance(e);if(e.isEmpty()){null==h||h.disappear();continue}if(o){US(zS,this).setActiveSelection(e).scan().forEach((e=>{if(n.has(e)){const t=n.get(e);t.has(o)&&!0===a?t.set(o,t.get(o)+1):t.set(o,1)}else n.set(e,new Map([[o,1]]));s&&(r.has(e)||r.set(e,[]),"TH"===e.nodeName&&r.get(e).push(...s))}))}const u=e.getCorners();US(jS,this).getSetting("onBeforeDrawBorders",u,l),null==h||h.appear(u)}n.forEach(((e,t)=>{var n;const r=Array.from(e).map((e=>{let[t,n]=e;return 1===n?t:[t,...Array.from({length:n-1},((e,n)=>`${t}-${n+1}`))]})).flat();r.forEach((e=>US($S,this).get(US(jS,this)).add(e))),Fp(t,r),"TD"===t.nodeName&&Array.isArray(null===(n=US(GS,this).options)||void 0===n?void 0:n.cellAttributes)&&Vp(t,US(GS,this).options.cellAttributes)})),Array.from(r.keys()).forEach((e=>{Vp(e,[...r.get(e)])}))}}function QS(){const e=US($S,this).get(US(jS,this)),t=US(jS,this).wtSettings.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(t))for(let n=0;n<t.length;n++)e.add(t[n]);e.forEach((e=>{var t,n;const r=US(jS,this).wtTable.TABLE.querySelectorAll(`.${e}`);let i=[];Array.isArray(null===(t=US(GS,this).options)||void 0===t?void 0:t.cellAttributes)&&(i=US(GS,this).options.cellAttributes.map((e=>e[0]))),Array.isArray(null===(n=US(GS,this).options)||void 0===n?void 0:n.headerAttributes)&&(i=[...i,...US(GS,this).options.headerAttributes.map((e=>e[0]))]);for(let o=0,s=r.length;o<s;o++)Dp(r[o],e),Up(r[o],i)})),e.clear()}class ZS extends oS{constructor(e,t,n,r){super(e,t,WC,n,r)}createTable(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new fS(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wtTable:e}=this.wot;if(!this.needFullRender||!this.shouldBeRendered()||!e.holder.parentNode)return!1;const{rootWindow:t}=this.domBindings,n=this.clone.wtTable.holder.parentNode,r=this.wtSettings.getSetting("preventOverflow");let i=0;this.trimmingContainer!==t||r&&"horizontal"===r?(i=this.getScrollPosition(),pg(n)):(i=this.getOverlayOffset()*(this.isRtl()?-1:1),dg(n,`${i}px`,"0px"));const o=this.adjustHeaderBordersPosition(i);return this.adjustElementsSize(),o}setScrollPosition(e){const{rootWindow:t}=this.domBindings;let n=!1;return this.isRtl()&&(e=-e),this.mainTableScrollableElement===t&&t.scrollX!==e?(t.scrollTo(e,Kp(t)),n=!0):this.mainTableScrollableElement.scrollLeft!==e&&(this.mainTableScrollableElement.scrollLeft=e,n=!0),n}onScroll(){this.wtSettings.getSetting("onScrollVertically")}sumCellSizes(e,t){const n=this.wtSettings.getSetting("defaultColumnWidth");let r=e,i=0;for(;r<t;)i+=this.wot.wtTable.getColumnWidth(r)||n,r+=1;return i}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:t}=this.wot,{rootDocument:n,rootWindow:r}=this.domBindings,i=this.clone.wtTable.holder.parentNode.style,o=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==r||"vertical"===o){let r=t.getWorkspaceHeight();t.hasHorizontalScroll()&&(r-=hg(n)),r=Math.min(r,e.wtRootElement.scrollHeight),i.height=`${r}px`}else i.height="";this.clone.wtTable.holder.style.height=i.height;const s=tg(this.clone.wtTable.TABLE);i.width=`${s}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,t=TS(this.wot),n=this.wot.selectionManager.getFocusSelection()?parseInt(t.width,10)/2:0;this.clone.wtTable.hider.style.height=this.hider.style.height,e.style.height=e.parentNode.style.height,e.style.width=`${parseInt(e.parentNode.style.width,10)+n}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalColumns"),t=this.isRtl()?"right":"left";if("number"==typeof this.wot.wtViewport.columnsRenderCalculator.startPosition)this.spreader.style[t]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`;else{if(0!==e)throw new Error("Incorrect value of the columnsRenderCalculator");this.spreader.style[t]="0"}this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){"number"==typeof this.wot.wtViewport.rowsRenderCalculator.startPosition?this.clone.wtTable.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`:this.clone.wtTable.spreader.style.top=""}scrollTo(e,t){const{wtSettings:n}=this,r=n.getSetting("rowHeaders"),i=n.getSetting("fixedColumnsStart"),o=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,s=0===i&&r.length>0&&!kp(o.parentNode,"innerBorderInlineStart")?1:0;let a=this.getTableParentOffset(),l=0;if(t){this.wot.wtTable.getColumnWidth(e)>this.wot.wtViewport.getViewportWidth()&&(t=!1)}var h;return t&&o.offsetWidth!==o.clientWidth&&(l=hg(this.domBindings.rootDocument)),t?(a+=this.sumCellSizes(0,e+1),a-=this.wot.wtViewport.getViewportWidth(),a+=s):a+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),e),a+=l,(h=this.mainTableScrollableElement).scrollWidth-h.clientWidth==a-s&&s>0&&this.wot.wtOverlays.expandHiderHorizontallyBy(s),this.setScrollPosition(a)}getTableParentOffset(){let e=0;return this.wtSettings.getSetting("preventOverflow")||this.trimmingContainer!==this.domBindings.rootWindow||(e=this.wot.wtTable.holderOffset.left),e}getScrollPosition(){return Math.abs(Qp(this.mainTableScrollableElement,this.domBindings.rootWindow))}getOverlayOffset(){const{rootWindow:e}=this.domBindings,t=this.wtSettings.getSetting("preventOverflow");let n=0;if(this.trimmingContainer===e&&(!t||"horizontal"!==t)){n=this.isRtl()?Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);n>this.wot.wtTable.getTotalWidth()-this.clone.wtTable.getTotalWidth()&&(n=0)}return n}adjustHeaderBordersPosition(e){const{wtSettings:t}=this,n=this.wot.wtTable.holder.parentNode,r=t.getSetting("rowHeaders"),i=t.getSetting("fixedColumnsStart"),o=t.getSetting("totalRows"),s="vertical"===t.getSetting("preventOverflow");o?Dp(n,"emptyRows"):Fp(n,"emptyRows");let a=!1;if(!s)if(i&&!r.length)Fp(n,"innerBorderLeft innerBorderInlineStart");else if(!i&&r.length){const t=kp(n,"innerBorderInlineStart");e?(Fp(n,"innerBorderLeft innerBorderInlineStart"),a=!t):(Dp(n,"innerBorderLeft innerBorderInlineStart"),a=t)}return a}}const JS={getFirstRenderedRow(){return 0===this.wtSettings.getSetting("totalRows")?-1:0},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){const e=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsTop"),e)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};lm(JS,"MIXIN_NAME","stickyRowsTop",{writable:!1,enumerable:!1});const eR=JS;class tR extends _C{constructor(e,t,n,r){super(e,t,n,r,jC)}}om(tR,eR),om(tR,FC);const nR=tR;function rR(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class iR extends oS{constructor(e,t,n,r,i,o){super(e,t,jC,n,r),rR(this,"topOverlay",void 0),rR(this,"inlineStartOverlay",void 0),this.topOverlay=i,this.inlineStartOverlay=o}createTable(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new nR(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){dg(e,`${this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1)}px`,`${this.topOverlay.getOverlayOffset()}px`)}else pg(e);let t=ng(this.clone.wtTable.TABLE);const n=tg(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(t=0),e.style.height=`${t}px`,e.style.width=`${n}px`,!1}}class oR extends _C{constructor(e,t,n,r){super(e,t,n,r,UC)}}om(oR,eR),om(oR,lS);const sR=oR;function aR(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class lR extends oS{constructor(e,t,n,r){super(e,t,UC,n,r),aR(this,"cachedFixedRowsTop",-1),this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop")}createTable(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new sR(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode,{rootWindow:t}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let r=0,i=!1;if(this.trimmingContainer!==t||n&&"vertical"===n)r=this.getScrollPosition(),pg(e);else{const{wtTable:t}=this.wot,n=t.hider.getBoundingClientRect();i=Math.ceil(n.bottom)===e.offsetHeight,r=this.getOverlayOffset(),dg(e,"0px",`${r}px`)}const o=this.adjustHeaderBordersPosition(r,i);return this.adjustElementsSize(),o}setScrollPosition(e){const t=this.domBindings.rootWindow;let n=!1;return this.mainTableScrollableElement===t&&t.scrollY!==e?(t.scrollTo(Xp(t),e),n=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,n=!0),n}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,t){const n=this.wot.stylesHandler.getDefaultRowHeight();let r=e,i=0;for(;r<t;){const e=this.wot.wtTable.getRowHeight(r);i+=void 0===e?n:e,r+=1}return i}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:t}=this.wot,{rootDocument:n,rootWindow:r}=this.domBindings,i=this.clone.wtTable.holder.parentNode.style,o=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==r||"horizontal"===o){let r=t.getWorkspaceWidth();t.hasVerticalScroll()&&(r-=hg(n)),r=Math.min(r,e.wtRootElement.scrollWidth),i.width=`${r}px`}else i.width="";this.clone.wtTable.holder.style.width=i.width;let s=ng(this.clone.wtTable.TABLE);e.hasDefinedSize()||(s=0),i.height=`${s}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,t=TS(this.wot),n=this.wot.selectionManager.getFocusSelection()?parseInt(t.height,10)/2:0;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=`${parseInt(e.parentNode.style.height,10)+n}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if("number"==typeof this.wot.wtViewport.rowsRenderCalculator.startPosition)this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else{if(0!==e)throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.top="0"}this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:t}=this.clone.wtTable;"number"==typeof this.wot.wtViewport.columnsRenderCalculator.startPosition?t.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:t.style[e]=""}scrollTo(e,t){const{wot:n,wtSettings:r}=this,i=(n.cloneSource?n.cloneSource:n).wtTable.holder,o=r.getSetting("columnHeaders"),s=0===r.getSetting("fixedRowsTop")&&o.length>0&&!kp(i.parentNode,"innerBorderTop")?1:0;let a=this.getTableParentOffset(),l=0;if(t){this.wot.wtTable.getRowHeight(e)>this.wot.wtViewport.getViewportHeight()&&(t=!1)}if(t&&i.offsetHeight!==i.clientHeight&&(l=hg(this.domBindings.rootDocument)),t){const t=r.getSetting("fixedRowsBottom"),i=r.getSetting("totalRows");a+=this.sumCellSizes(0,e+1),a-=n.wtViewport.getViewportHeight()-this.sumCellSizes(i-t,i),a+=1,a+=s}else a+=this.sumCellSizes(r.getSetting("fixedRowsTop"),e);var h;return a+=l,(h=this.mainTableScrollableElement).scrollHeight-h.clientHeight==a-s&&s>0&&this.wot.wtOverlays.expandHiderVerticallyBy(s),this.setScrollPosition(a)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return qp(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,t=this.wtSettings.getSetting("preventOverflow");let n=0;if(this.trimmingContainer===e&&(!t||"vertical"!==t)){const e=this.wot.wtTable.getTotalHeight()-this.clone.wtTable.getTotalHeight();n=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),n>e&&(n=0)}return n}adjustHeaderBordersPosition(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const{wtSettings:n}=this,r=this.wot.wtTable.holder.parentNode,i=n.getSetting("totalColumns"),o="horizontal"===n.getSetting("preventOverflow");i?Dp(r,"emptyColumns"):Fp(r,"emptyColumns");let s=!1;if(!t&&!o){const t=n.getSetting("fixedRowsTop"),i=this.cachedFixedRowsTop!==t,o=n.getSetting("columnHeaders");if((i||0===t)&&o.length>0){const t=kp(r,"innerBorderTop");this.cachedFixedRowsTop=n.getSetting("fixedRowsTop"),e||0===n.getSetting("totalRows")?(Fp(r,"innerBorderTop"),s=!t):(Dp(r,"innerBorderTop"),s=t)}}return s}}function hR(e,t,n){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,n)}function uR(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function cR(e,t,n){return e.set(pR(e,t),n),n}function dR(e,t){return e.get(pR(e,t))}function pR(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var gR=new WeakMap,mR=new WeakMap,fR=new WeakMap,wR=new WeakMap;const yR=class{constructor(e,t,n,r,i,o){uR(this,"wot",null),hR(this,gR,[]),uR(this,"topOverlay",null),uR(this,"bottomOverlay",null),uR(this,"inlineStartOverlay",null),uR(this,"topInlineStartCornerOverlay",null),uR(this,"bottomInlineStartCornerOverlay",null),uR(this,"browserLineHeight",void 0),uR(this,"wtSettings",null),hR(this,mR,!1),hR(this,fR,0),hR(this,wR,null),uR(this,"resizeObserver",new ResizeObserver((e=>{gm((()=>{Array.isArray(e)&&e.length&&(cR(fR,this,dR(fR,this)+1),100===dR(fR,this)&&(Fm("The ResizeObserver callback was fired too many times in direct succession.\nThis may be due to an infinite loop caused by setting a dynamic height/width (for example, with the `dvh` units) to a Handsontable container's parent. \nThe observer will be disconnected."),this.resizeObserver.disconnect()),null!==dR(wR,this)&&clearTimeout(dR(wR,this)),cR(wR,this,setTimeout((()=>{cR(fR,this,0)}),100)),this.wtSettings.getSetting("onContainerElementResize"))}))}))),this.wot=e,this.wtSettings=r,this.domBindings=n,this.facadeGetter=t,this.wtTable=o;const{rootDocument:s,rootWindow:a}=this.domBindings;this.instance=this.wot,this.eventManager=i,this.scrollbarSize=hg(s);const l="hidden"===a.getComputedStyle(o.wtRootElement.parentNode).getPropertyValue("overflow");this.scrollableElement=l?o.holder:Zp(o.TABLE),this.initOverlays(),this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=a.scrollX,this.lastScrollY=a.scrollY}getOverlays(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t=[...dR(gR,this)];return e&&t.push(this.wtTable),t}initBrowserLineHeight(){const{rootWindow:e,rootDocument:t}=this.domBindings,n=e.getComputedStyle(t.body),r=parseInt(n.lineHeight,10),i=1.2*parseInt(n.fontSize,10);this.browserLineHeight=r||i}initOverlays(){const e=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=new lR(...e),this.bottomOverlay=new dS(...e),this.inlineStartOverlay=new ZS(...e),this.topInlineStartCornerOverlay=new iR(...e,this.topOverlay,this.inlineStartOverlay),this.bottomInlineStartCornerOverlay=new sS(...e,this.bottomOverlay,this.inlineStartOverlay),cR(gR,this,[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay])}beforeDraw(){cR(mR,this,dR(gR,this).reduce(((e,t)=>t.hasRenderingStateChanged()||e),!1)),dR(gR,this).forEach((e=>e.updateStateOfRendering("before")))}afterDraw(){this.syncScrollWithMaster(),dR(gR,this).forEach((e=>{const t=e.hasRenderingStateChanged();e.updateStateOfRendering("after"),t&&!e.needFullRender&&e.reset()}))}refreshAll(){this.wot.drawn&&(this.wtTable.holder.parentNode?(this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1):this.destroy())}registerListeners(){const{rootDocument:e,rootWindow:t}=this.domBindings,{mainTableScrollableElement:n}=this.topOverlay,{mainTableScrollableElement:r}=this.inlineStartOverlay;this.eventManager.addEventListener(e.documentElement,"keydown",(e=>this.onKeyDown(e))),this.eventManager.addEventListener(e.documentElement,"keyup",(()=>this.onKeyUp())),this.eventManager.addEventListener(e,"visibilitychange",(()=>this.onKeyUp())),this.eventManager.addEventListener(n,"scroll",(e=>this.onTableScroll(e)),{passive:!0}),n!==r&&this.eventManager.addEventListener(r,"scroll",(e=>this.onTableScroll(e)),{passive:!0});const i=t.devicePixelRatio&&t.devicePixelRatio>1,o=this.scrollableElement===t,s=this.wtSettings.getSetting("preventWheel"),a={passive:o};(s||i||!Sm())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",(e=>this.onCloneWheel(e,s)),a);let l;[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay].forEach((e=>{this.eventManager.addEventListener(e.clone.wtTable.holder,"wheel",(e=>this.onCloneWheel(e,s)),a)})),this.eventManager.addEventListener(t,"resize",(()=>{gm((()=>{clearTimeout(l),this.wtSettings.getSetting("onWindowResize"),l=setTimeout((()=>{cR(fR,this,0)}),200)}))})),o||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}onTableScroll(e){const t=this.domBindings.rootWindow,n=this.inlineStartOverlay.mainTableScrollableElement,r=this.topOverlay.mainTableScrollableElement,i=e.target;this.keyPressed&&(r!==t&&i!==t&&!e.target.contains(r)||n!==t&&i!==t&&!e.target.contains(n))||this.syncScrollPositions(e)}onCloneWheel(e,t){const{rootWindow:n}=this.domBindings,r=this.inlineStartOverlay.mainTableScrollableElement,i=this.topOverlay.mainTableScrollableElement,o=e.target,s=i!==n&&o!==n&&!o.contains(i),a=r!==n&&o!==n&&!o.contains(r);if(this.keyPressed&&(s||a)||this.scrollableElement===n)return;const l=this.translateMouseWheelToScroll(e);(t||this.scrollableElement!==n&&l)&&e.preventDefault()}onKeyDown(e){this.keyPressed=Pm(e.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}onKeyUp(){this.keyPressed=!1}translateMouseWheelToScroll(e){let t=isNaN(e.deltaY)?-1*e.wheelDeltaY:e.deltaY,n=isNaN(e.deltaX)?-1*e.wheelDeltaX:e.deltaX;1===e.deltaMode&&(n+=n*this.browserLineHeight,t+=t*this.browserLineHeight);const r=this.scrollVertically(t),i=this.scrollHorizontally(n);return r||i}scrollVertically(e){const t=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=e,t!==this.scrollableElement.scrollTop}scrollHorizontally(e){const t=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=e,t!==this.scrollableElement.scrollLeft}syncScrollPositions(){if(this.destroyed)return;const{rootWindow:e}=this.domBindings,t=this.topOverlay.clone.wtTable.holder,n=this.inlineStartOverlay.clone.wtTable.holder,[r,i]=[this.scrollableElement.scrollLeft,this.scrollableElement.scrollTop];if(this.horizontalScrolling=t.scrollLeft!==r||this.lastScrollX!==e.scrollX,this.verticalScrolling=n.scrollTop!==i||this.lastScrollY!==e.scrollY,this.lastScrollX=e.scrollX,this.lastScrollY=e.scrollY,this.horizontalScrolling){t.scrollLeft=r;const e=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;e&&(e.scrollLeft=r)}this.verticalScrolling&&(n.scrollTop=i),this.refreshAll()}syncScrollWithMaster(){if(!dR(mR,this))return;const e=this.topOverlay.mainTableScrollableElement,{scrollLeft:t,scrollTop:n}=e;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=t),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=t),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=n),cR(mR,this,!1)}updateMainScrollableElements(){this.eventManager.clearEvents(!0),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();const{wtTable:e}=this,{rootWindow:t}=this.domBindings;"hidden"===t.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")?this.scrollableElement=e.holder:this.scrollableElement=Zp(e.TABLE),this.registerListeners()}destroy(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}refresh(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.updateLastSpreaderSize()&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(e),this.inlineStartOverlay.refresh(e),this.topOverlay.refresh(e),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(e),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(e)}updateLastSpreaderSize(){const e=this.wtTable.spreader,t=e.clientWidth,n=e.clientHeight,r=t!==this.spreaderLastSize.width||n!==this.spreaderLastSize.height;return r&&(this.spreaderLastSize.width=t,this.spreaderLastSize.height=n),r}adjustElementsSize(){const{wtViewport:e}=this.wot,{wtTable:t}=this,{rootWindow:n}=this.domBindings,r=this.scrollableElement===n,i=this.wtSettings.getSetting("totalColumns"),o=this.wtSettings.getSetting("totalRows"),s=e.getRowHeaderWidth(),a=e.getColumnHeaderHeight()+this.topOverlay.sumCellSizes(0,o)+1,l=s+this.inlineStartOverlay.sumCellSizes(0,i),h=t.hider.style,u=(()=>!r&&this.scrollableElement.scrollTop>Math.max(0,a-t.holder.clientHeight))()?1:0,c=(()=>!r&&this.scrollableElement.scrollLeft>Math.max(0,l-t.holder.clientWidth))()?1:0;h.width=`${l+c}px`,h.height=`${a+u}px`,this.topOverlay.adjustElementsSize(),this.inlineStartOverlay.adjustElementsSize(),this.bottomOverlay.adjustElementsSize()}expandHiderVerticallyBy(e){const{wtTable:t}=this;t.hider.style.height=`${parseInt(t.hider.style.height,10)+e}px`}expandHiderHorizontallyBy(e){const{wtTable:t}=this;t.hider.style.width=`${parseInt(t.hider.style.width,10)+e}px`}applyToDOM(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}getParentOverlay(e){if(!e)return null;const t=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];let n=null;return Vd(t,(t=>{t&&t.clone&&t.clone.wtTable.TABLE.contains(e)&&(n=t.clone)})),n}syncOverlayTableClassNames(){const e=this.wtTable.TABLE;Vd([this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay],(t=>{t&&(t.clone.wtTable.TABLE.className=e.className)}))}};function vR(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class CR{constructor(e){vR(this,"settings",{}),vR(this,"defaults",Object.freeze(this.getDefaults())),hm(this.defaults,((t,n)=>{if(void 0!==e[n])this.settings[n]=e[n];else{if(void 0===t)throw new Error(`A required setting "${n}" was not provided`);this.settings[n]=t}}))}getDefaults(){return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,currentRowClassName:null,currentColumnClassName:null,preventOverflow:()=>!1,preventWheel:!1,data:void 0,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:()=>this.getSetting("fixedColumnsStart")>0||this.getSetting("rowHeaders").length>0,shouldRenderTopOverlay:()=>this.getSetting("fixedRowsTop")>0||this.getSetting("columnHeaders").length>0,shouldRenderBottomOverlay:()=>this.getSetting("fixedRowsBottom")>0,minSpareRows:0,rowHeaders:()=>[],columnHeaders:()=>[],totalRows:void 0,totalColumns:void 0,cellRenderer:(e,t,n)=>{const r=this.getSetting("data",e,t);zp(n,null==r?"":r)},columnWidth(){},rowHeight(){},rowHeightByOverlayName(){},defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,viewportRowRenderingThreshold:null,viewportColumnRenderingThreshold:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onBeforeViewportScrollHorizontally:e=>e,onBeforeViewportScrollVertically:e=>e,onScrollHorizontally:null,onScrollVertically:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onModifyGetCoordsElement:null,onModifyGetCoords:null,onBeforeHighlightingRowHeader:e=>e,onBeforeHighlightingColumnHeader:e=>e,onWindowResize:null,onContainerElementResize:null,renderAllColumns:!1,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1,ariaTags:!0}}update(e,t){return void 0===t?hm(e,((e,t)=>{this.settings[t]=e})):this.settings[e]=t,this}getSetting(e,t,n,r,i){return"function"==typeof this.settings[e]?this.settings[e](t,n,r,i):void 0!==t&&Array.isArray(this.settings[e])?this.settings[e][t]:this.settings[e]}getSettingPure(e){return this.settings[e]}has(e){return!!this.settings[e]}}class SR extends _C{constructor(e,t,n,r){super(e,t,n,r,"master")}alignOverlaysWithTrimmingContainer(){const e=Jp(this.wtRootElement),{rootWindow:t}=this.domBindings;if(e===t){this.wtSettings.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible")}else{const n=e.parentElement,r=eg(e,"height",t),i=eg(e,"overflow",t),o=this.holder.style,{scrollWidth:s,scrollHeight:a}=e;let l=e.offsetWidth,h=e.offsetHeight;if(n&&["auto","hidden","scroll"].includes(i)){const r=e.cloneNode(!1);r.style.overflow="auto",r.style.position="absolute",e.nextElementSibling?n.insertBefore(r,e.nextElementSibling):n.appendChild(r);const i=parseInt(t.getComputedStyle(r).height,10);n.removeChild(r),0===i&&(h=0)}h=Math.min(h,a),o.height="auto"===r?"auto":`${h}px`,l=Math.min(l,s),o.width=`${l}px`,o.overflow="",this.hasTableHeight="auto"===o.height||h>0,this.hasTableWidth=l>0}this.isTableVisible=$p(this.TABLE)}markOversizedColumnHeaders(){const{wtSettings:e}=this,{wtViewport:t}=this.dataAccessObject,n="master",r=e.getSetting("columnHeaders").length;if(r&&!t.hasOversizedColumnHeadersMarked[n]){const i=e.getSetting("rowHeaders").length,o=this.getRenderedColumnsCount();for(let e=0;e<r;e++)for(let t=-1*i;t<o;t++)this.markIfOversizedColumnHeader(t);t.hasOversizedColumnHeadersMarked[n]=!0}}}om(SR,gS),om(SR,lS);const RR=SR;const ER=class{constructor(e,t,n,r,i){this.dataAccessObject=e,this.wot=e.wot,this.instance=this.wot,this.domBindings=t,this.wtSettings=n,this.wtTable=i,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.rowsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllRows")?new Qy:new tv],["fullyVisible",()=>new jy],["partiallyVisible",()=>new Yy]]),this.columnsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllColumns")?new Xy:new Jy],["fullyVisible",()=>new By],["partiallyVisible",()=>new zy]]),this.eventManager=r,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",(()=>{this.clientHeight=this.getWorkspaceHeight()}))}getWorkspaceHeight(){const e=this.domBindings.rootDocument,t=this.dataAccessObject.topOverlayTrimmingContainer;let n=0;if(t===this.domBindings.rootWindow)n=e.documentElement.clientHeight;else{n=ng(t)>0&&t.clientHeight>0?t.clientHeight:1/0}return n}getViewportHeight(){let e=this.getWorkspaceHeight();if(e===1/0)return e;const t=this.getColumnHeaderHeight();return t>0&&(e-=t),e}getWorkspaceWidth(){const{rootDocument:e,rootWindow:t}=this.domBindings,n=this.dataAccessObject.inlineStartOverlayTrimmingContainer;let r;if(n===t){const t=this.wtSettings.getSetting("totalColumns");r=this.wtTable.holder.offsetWidth,this.getRowHeaderWidth()+this.sumColumnWidths(0,t)>r&&(r=e.documentElement.clientWidth)}else r=n.clientWidth;return r}getViewportWidth(){const e=this.getWorkspaceWidth();if(e===1/0)return e;const t=this.getRowHeaderWidth();return t>0?e-t:e}hasVerticalScroll(){if(this.isVerticallyScrollableByWindow()){const e=this.domBindings.rootDocument.documentElement;return e.scrollHeight>e.clientHeight}const{holder:e,hider:t}=this.wtTable,n=e.clientHeight,r=t.offsetHeight;return n<r||r>this.getWorkspaceHeight()}hasHorizontalScroll(){if(this.isVerticallyScrollableByWindow()){const e=this.domBindings.rootDocument.documentElement;return e.scrollWidth>e.clientWidth}const{holder:e,hider:t}=this.wtTable,n=e.clientWidth,r=t.offsetWidth;return n<r||r>this.getWorkspaceWidth()}isVerticallyScrollableByWindow(){return this.dataAccessObject.topOverlayTrimmingContainer===this.domBindings.rootWindow}isHorizontallyScrollableByWindow(){return this.dataAccessObject.inlineStartOverlayTrimmingContainer===this.domBindings.rootWindow}sumColumnWidths(e,t){let n=0,r=e;for(;r<t;)n+=this.wtTable.getColumnWidth(r),r+=1;return n}getWorkspaceOffset(){return Yp(this.wtTable.holder)}getColumnHeaderHeight(){return this.wtSettings.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=ng(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}getRowHeaderWidth(){const e=this.wtSettings.getSetting("rowHeaderWidth"),t=this.wtSettings.getSetting("rowHeaders");if(e){this.rowHeaderWidth=0;for(let n=0,r=t.length;n<r;n++)this.rowHeaderWidth+=e[n]||e}if(isNaN(this.rowHeaderWidth))if(t.length){let e=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(let n=0,r=t.length;n<r;n++)e?(this.rowHeaderWidth+=tg(e),e=e.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}createRowsCalculator(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:t,wtTable:n}=this;let r,i,o=this.getViewportHeight();this.rowHeaderWidth=NaN;let s=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset;const a=t.getSetting("fixedRowsTop"),l=t.getSetting("fixedRowsBottom"),h=t.getSetting("totalRows");return a&&s>=0&&(i=this.dataAccessObject.topOverlay.sumCellSizes(0,a),s+=i,o-=i),l&&this.dataAccessObject.bottomOverlay.clone&&(i=this.dataAccessObject.bottomOverlay.sumCellSizes(h-l,h),o-=i),r=n.holder.clientHeight===n.holder.offsetHeight?0:hg(this.domBindings.rootDocument),new lv({calculationTypes:e.map((e=>[e,this.rowsCalculatorTypes.get(e)()])),viewportHeight:o,scrollOffset:s,totalRows:t.getSetting("totalRows"),defaultRowHeight:this.instance.stylesHandler.getDefaultRowHeight(),rowHeightFn:e=>n.getRowHeight(e),overrideFn:t.getSettingPure("viewportRowCalculatorOverride"),horizontalScrollbarHeight:r})}createColumnsCalculator(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:t,wtTable:n}=this;let r=this.getViewportWidth(),i=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;const o=t.getSetting("fixedColumnsStart");if(o&&i>=0){const e=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,o);i+=e,r-=e}return n.holder.clientWidth!==n.holder.offsetWidth&&(r-=hg(this.domBindings.rootDocument)),new sv({calculationTypes:e.map((e=>[e,this.columnsCalculatorTypes.get(e)()])),viewportWidth:r,scrollOffset:i,totalColumns:t.getSetting("totalColumns"),columnWidthFn:e=>n.getColumnWidth(e),overrideFn:t.getSettingPure("viewportColumnCalculatorOverride"),inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}createCalculators(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const{wtSettings:t}=this,n=this.createRowsCalculator(),r=this.createColumnsCalculator();if(e&&!t.getSetting("renderAllRows")){const t=n.getResultsFor("fullyVisible");e=this.areAllProposedVisibleRowsAlreadyRendered(t)}if(e&&!t.getSetting("renderAllColumns")){const t=r.getResultsFor("fullyVisible");e=this.areAllProposedVisibleColumnsAlreadyRendered(t)}return e||(this.rowsRenderCalculator=n.getResultsFor("rendered"),this.columnsRenderCalculator=r.getResultsFor("rendered")),this.rowsVisibleCalculator=n.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=r.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=n.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=r.getResultsFor("partiallyVisible"),e}createVisibleCalculators(){const e=this.createRowsCalculator(["fullyVisible","partiallyVisible"]),t=this.createColumnsCalculator(["fullyVisible","partiallyVisible"]);this.rowsVisibleCalculator=e.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=t.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=e.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=t.getResultsFor("partiallyVisible")}areAllProposedVisibleRowsAlreadyRendered(e){if(!this.rowsVisibleCalculator)return!1;let{startRow:t,endRow:n}=e;if(null===t&&null===n){if(!e.isVisibleInTrimmingContainer)return!0;t=this.rowsPartiallyVisibleCalculator.startRow,n=this.rowsPartiallyVisibleCalculator.endRow}const{startRow:r,endRow:i,rowStartOffset:o,rowEndOffset:s}=this.rowsRenderCalculator,a=this.wtSettings.getSetting("totalRows")-1,l=this.wtSettings.getSetting("viewportRowRenderingThreshold");return Number.isInteger(l)&&l>0?(t=Math.max(0,t-Math.min(o,l)),n=Math.min(a,n+Math.min(s,l))):"auto"===l&&(t=Math.max(0,t-Math.ceil(o/2)),n=Math.min(a,n+Math.ceil(s/2))),!(t<r||t===r&&t>0)&&!(n>i||n===i&&n<a)}areAllProposedVisibleColumnsAlreadyRendered(e){if(!this.columnsVisibleCalculator)return!1;let{startColumn:t,endColumn:n}=e;if(null===t&&null===n){if(!e.isVisibleInTrimmingContainer)return!0;t=this.columnsPartiallyVisibleCalculator.startColumn,n=this.columnsPartiallyVisibleCalculator.endColumn}const{startColumn:r,endColumn:i,columnStartOffset:o,columnEndOffset:s}=this.columnsRenderCalculator,a=this.wtSettings.getSetting("totalColumns")-1,l=this.wtSettings.getSetting("viewportColumnRenderingThreshold");return Number.isInteger(l)&&l>0?(t=Math.max(0,t-Math.min(o,l)),n=Math.min(a,n+Math.min(s,l))):"auto"===l&&(t=Math.max(0,t-Math.ceil(o/2)),n=Math.min(a,n+Math.ceil(s/2))),!(t<r||t===r&&t>0)&&!(n>i||n===i&&n<a)}resetHasOversizedColumnHeadersMarked(){hm(this.hasOversizedColumnHeadersMarked,((e,t,n)=>{n[t]=void 0}))}};function bR(e,t,n){TR(e,t),t.set(e,n)}function TR(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function NR(e,t){return e.get(MR(e,t))}function AR(e,t,n){return e.set(MR(e,t),n),n}function MR(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var IR=new WeakMap,OR=new WeakMap,xR=new WeakMap,PR=new WeakMap,_R=new WeakMap,LR=new WeakMap,HR=new WeakMap,kR=new WeakSet;class FR{constructor(e){var t,n;TR(t=this,n=kR),n.add(t),bR(this,IR,void 0),bR(this,OR,void 0),bR(this,xR,void 0),bR(this,PR,void 0),bR(this,_R,!0),bR(this,LR,{}),bR(this,HR,{}),AR(OR,this,e.rootTable.parentElement.parentElement),AR(PR,this,e.rootDocument)}isClassicTheme(){return NR(_R,this)}getCSSVariableValue(e){var t;if(NR(_R,this))return null;if(NR(LR,this)[`--ht-${e}`])return NR(LR,this)[`--ht-${e}`];const n=null!==(t=MR(kR,this,WR).call(this,`--ht-${e}`))&&void 0!==t?t:MR(kR,this,jR).call(this,`--ht-${e}`);return null!==n?(NR(LR,this)[`--ht-${e}`]=n,n):void 0}getStyleForTD(e){var t;return null===(t=NR(HR,this))||void 0===t?void 0:t.td[e]}getDefaultRowHeight(){if(NR(_R,this))return 23;const e=MR(kR,this,DR).call(this);return!e&&kp(NR(OR,this),"ht-wrapper")?(Fm(`The "${NR(IR,this)}" theme is enabled, but its stylesheets are missing or not imported correctly. Import the correct CSS files in order to use that theme.`),AR(_R,this,!0),this.useTheme(),23):e}areCellsBorderBox(){return"border-box"===this.getStyleForTD("box-sizing")}useTheme(e){if(!e)return MR(kR,this,UR).call(this),AR(_R,this,!0),void AR(IR,this,e||void 0);e&&e!==NR(IR,this)&&(NR(IR,this)&&MR(kR,this,GR).call(this),AR(IR,this,e),AR(_R,this,!1),MR(kR,this,VR).call(this),MR(kR,this,UR).call(this))}getThemeName(){return NR(IR,this)}removeClassNames(){kp(NR(OR,this),NR(IR,this))&&Dp(NR(OR,this),NR(IR,this))}}function DR(){const e=this.getCSSVariableValue("line-height"),t=this.getCSSVariableValue("cell-vertical-padding"),n=Math.ceil(parseFloat(this.getStyleForTD("border-bottom-width")));return null===e||null===t||isNaN(n)?null:e+2*t+n}function VR(){Dp(NR(OR,this),/ht-theme-.*/g),Fp(NR(OR,this),NR(IR,this))}function UR(){this.isClassicTheme()||AR(xR,this,getComputedStyle(NR(OR,this)));const e=MR(kR,this,BR).call(this,["box-sizing","border-bottom-width"]);NR(HR,this).td={...NR(HR,this).td,"box-sizing":e["box-sizing"],"border-bottom-width":e["border-bottom-width"]}}function BR(e){const t=NR(PR,this),n=NR(OR,this),r=t.createElement("table"),i=t.createElement("tbody"),o=t.createElement("tr"),s=t.createElement("tr"),a=t.createElement("td");s.appendChild(a),i.appendChild(o),i.appendChild(s),r.appendChild(i),n.appendChild(r);const l=getComputedStyle(a),h={};return e.forEach((e=>{h[e]=l.getPropertyValue(e)})),n.removeChild(r),h}function WR(e){const t=Math.ceil(parseFloat(MR(kR,this,jR).call(this,e)));return Number.isNaN(t)?null:t}function jR(e){const t=NR(xR,this).getPropertyValue(e);return""===t?null:t}function GR(){AR(HR,this,{}),AR(LR,this,{}),AR(_R,this,!0)}class zR extends tS{constructor(e,t){super(e,new CR(t)),this.stylesHandler=new FR(this.domBindings);const n=this.wtSettings.getSetting("facade",this);this.wtTable=new RR(this.getTableDao(),n,this.domBindings,this.wtSettings),this.wtViewport=new ER(this.getViewportDao(),this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.selectionManager=new qS(this.wtSettings.getSetting("selections")),this.wtEvent=new Dv(n,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager),this.wtOverlays=new yR(this,n,this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.exportSettingsAsClassNames(),this.findOriginalHeaders()}exportSettingsAsClassNames(){const e=[],t=[];hm({rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},((n,r)=>{this.wtSettings.getSetting(r).length&&t.push(n),e.push(n)})),Dp(this.wtTable.wtRootElement.parentNode,e),Fp(this.wtTable.wtRootElement.parentNode,t)}getOverlayByName(e){var t;if(!zC.includes(e))return null;const n=e.replace(/_([a-z])/g,(e=>e[1].toUpperCase()));return null!==(t=this.wtOverlays[`${n}Overlay`])&&void 0!==t?t:null}getViewportDao(){const e=this;return{get wot(){return e},get topOverlayTrimmingContainer(){return e.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return e.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return e.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return e.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return e.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return e.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get bottomOverlay(){return e.wtOverlays.bottomOverlay}}}}class $R{constructor(e){e instanceof tS?this._wot=e:this._initFromSettings(e)}_initFromSettings(e){e.facade=e=>{const t=new $R(e);return()=>t},this._wot=new zR(e.table,e)}get guid(){return this._wot.guid}get rootDocument(){return this._wot.domBindings.rootDocument}get rootWindow(){return this._wot.domBindings.rootWindow}get wtSettings(){return this._wot.wtSettings}get cloneSource(){return this._wot.cloneSource}get cloneOverlay(){return this._wot.cloneOverlay}get selectionManager(){return this._wot.selectionManager}get wtViewport(){return this._wot.wtViewport}get wtOverlays(){return this._wot.wtOverlays}get wtTable(){return this._wot.wtTable}get wtEvent(){return this._wot.wtEvent}get wtScroll(){return this._wot.wtScroll}get drawn(){return this._wot.drawn}set drawn(e){this._wot.drawn=e}get activeOverlayName(){return this._wot.activeOverlayName}get drawInterrupted(){return this._wot.drawInterrupted}set drawInterrupted(e){this._wot.drawInterrupted=e}get lastMouseOver(){return this._wot.lastMouseOver}set lastMouseOver(e){this._wot.lastMouseOver=e}get momentumScrolling(){return this._wot.momentumScrolling}set momentumScrolling(e){this._wot.momentumScrolling=e}get touchApplied(){return this._wot.touchApplied}set touchApplied(e){this._wot.touchApplied=e}get domBindings(){return this._wot.domBindings}get eventListeners(){return this._wot.eventListeners}set eventListeners(e){this._wot.eventListeners=e}get eventManager(){return this._wot.eventManager}get stylesHandler(){return this._wot.stylesHandler}createCellCoords(e,t){return this._wot.createCellCoords(e,t)}createCellRange(e,t,n){return this._wot.createCellRange(e,t,n)}draw(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this._wot.draw(e),this}getCell(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this._wot.getCell(e,t)}scrollViewport(e,t,n){return this._wot.scrollViewport(e,t,n)}scrollViewportHorizontally(e,t){return this._wot.scrollViewportHorizontally(e,t)}scrollViewportVertically(e,t){return this._wot.scrollViewportVertically(e,t)}getViewport(){return this._wot.getViewport()}getOverlayName(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}getOverlayByName(e){return this._wot.getOverlayByName(e)}exportSettingsAsClassNames(){return this._wot.exportSettingsAsClassNames()}update(e,t){return this._wot.wtSettings.update(e,t),this}getSetting(e,t,n,r,i){return this._wot.wtSettings.getSetting(e,t,n,r,i)}hasSetting(e){return this._wot.wtSettings.hasSetting(e)}destroy(){this._wot.destroy()}}function YR(e){let{isShiftKey:t,isLeftClick:n,isRightClick:r,coords:i,selection:o,controller:s,cellCoordsFactory:a}=e;const l=o.isSelected()?o.getSelectedRange().current():null,h=o.isSelectedByCorner(),u=o.isSelectedByRowHeader();if(o.markSource("mouse"),t&&l)i.row>=0&&i.col>=0&&!s.cell?o.setRangeEnd(i):(h||u)&&i.row>=0&&i.col>=0&&!s.cell?o.setRangeEnd(a(i.row,i.col)):h&&i.row<0&&!s.column?o.setRangeEnd(a(l.to.row,i.col)):u&&i.col<0&&!s.row?o.setRangeEnd(a(i.row,l.to.col)):(!h&&!u&&i.col<0||h&&i.col<0)&&!s.row?o.selectRows(Math.max(l.from.row,0),i.row,i.col):(!h&&!u&&i.row<0||u&&i.row<0)&&!s.column&&o.selectColumns(Math.max(l.from.col,0),i.col,i.row);else{const e=!o.inInSelection(i),t=n||r&&e;i.row<0&&i.col>=0&&!s.column?t&&o.selectColumns(i.col,i.col,i.row):i.col<0&&i.row>=0&&!s.row?t&&o.selectRows(i.row,i.row,i.col):i.col>=0&&i.row>=0&&!s.cell?t&&o.setRangeStart(i):i.col<0&&i.row<0&&o.selectAll(!0,!0,{disableHeadersHighlight:!0,focusPosition:{row:0,col:0}})}o.markEndSource()}const KR=new Map([["mousedown",YR],["mouseover",function(e){let{isLeftClick:t,coords:n,selection:r,controller:i,cellCoordsFactory:o}=e;if(!t)return;const s=r.isSelectedByRowHeader(),a=r.isSelectedByColumnHeader(),l=r.tableProps.countCols(),h=r.tableProps.countRows();r.markSource("mouse"),a&&!i.column?r.setRangeEnd(o(h-1,n.col)):s&&!i.row?r.setRangeEnd(o(n.row,l-1)):i.cell||r.setRangeEnd(n),r.markEndSource()}],["touchstart",YR]]);function XR(e,t){let{coords:n,selection:r,controller:i,cellCoordsFactory:o}=t;KR.get(e.type)({coords:n,selection:r,controller:i,cellCoordsFactory:o,isShiftKey:e.shiftKey,isLeftClick:km(e)||"touchstart"===e.type,isRightClick:Hm(e)})}const qR=new WeakMap,QR=Symbol("rootInstance");function ZR(e){return e===QR}function JR(e){return qR.has(e)}function eE(e,t,n){tE(e,t),t.set(e,n)}function tE(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function nE(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function rE(e,t){return e.get(oE(e,t))}function iE(e,t,n){return e.set(oE(e,t),n),n}function oE(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var sE=new WeakMap,aE=new WeakMap,lE=new WeakMap,hE=new WeakMap,uE=new WeakMap,cE=new WeakMap,dE=new WeakMap,pE=new WeakMap,gE=new WeakSet;function mE(){return parseInt(this.hot.rootElement.getAttribute(yp()[0]),10)}function fE(e){const t=oE(gE,this,mE).call(this)+e;Vp(this.hot.rootElement,...yp(t))}function wE(){const e=this.hot.rootElement;this.hasVerticalScroll()?Fp(e,"htHasScrollY"):Dp(e,"htHasScrollY"),this.hasHorizontalScroll()?Fp(e,"htHasScrollX"):Dp(e,"htHasScrollX")}const yE=class{constructor(e){var t,n;tE(t=this,n=gE),n.add(t),nE(this,"hot",void 0),nE(this,"eventManager",void 0),nE(this,"settings",void 0),nE(this,"THEAD",void 0),nE(this,"TBODY",void 0),nE(this,"_wt",void 0),nE(this,"activeWt",void 0),eE(this,sE,0),eE(this,aE,0),nE(this,"postponedAdjustElementsSize",!1),eE(this,lE,!1),eE(this,hE,void 0),eE(this,uE,void 0),eE(this,cE,0),eE(this,dE,0),eE(this,pE,null),this.hot=e,this.eventManager=new Ff(this.hot),this.settings=this.hot.getSettings(),this.createElements(),this.registerEvents(),this.initializeWalkontable()}render(){this.hot.isRenderSuspended()||(this.hot.runHooks("beforeRender",this.hot.forceFullRender),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize()),this._wt.draw(!this.hot.forceFullRender),oE(gE,this,wE).call(this),this.hot.runHooks("afterRender",this.hot.forceFullRender),this.hot.forceFullRender=!1,this.hot.renderCall=!1)}adjustElementsSize(){this.hot.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize()}getCellAtCoords(e,t){const n=this._wt.getCell(e,t);return n<0?null:n}scrollViewport(e,t,n){return this._wt.scrollViewport(e,t,n)}scrollViewportHorizontally(e,t){return this._wt.scrollViewportHorizontally(e,t)}scrollViewportVertically(e,t){return this._wt.scrollViewportVertically(e,t)}createElements(){const{rootElement:e,rootDocument:t}=this.hot,n=e.getAttribute("style");n&&e.setAttribute("data-originalstyle",n),Fp(e,"handsontable"),iE(uE,this,t.createElement("TABLE")),Fp(rE(uE,this),"htCore"),this.hot.getSettings().tableClassName&&Fp(rE(uE,this),this.hot.getSettings().tableClassName),this.settings.ariaTags&&(Vp(rE(uE,this),[dp()]),Vp(e,[["role","treegrid"],wp(-1),yp(this.hot.countCols()),["aria-multiselectable","true"]])),this.THEAD=t.createElement("THEAD"),rE(uE,this).appendChild(this.THEAD),this.TBODY=t.createElement("TBODY"),rE(uE,this).appendChild(this.TBODY),this.hot.table=rE(uE,this),this.hot.container.insertBefore(rE(uE,this),this.hot.container.firstChild)}registerEvents(){const{rootElement:e,rootDocument:t,selection:n,rootWindow:r}=this.hot,i=t.documentElement;this.eventManager.addEventListener(e,"mousedown",(e=>{iE(lE,this,!0),this.isTextSelectionAllowed(e.target)||(sg(r),e.preventDefault(),r.focus())})),this.eventManager.addEventListener(e,"mouseup",(()=>{iE(lE,this,!1)})),this.eventManager.addEventListener(e,"mousemove",(e=>{rE(lE,this)&&!this.isTextSelectionAllowed(e.target)&&(this.settings.fragmentSelection&&sg(r),e.preventDefault())})),this.eventManager.addEventListener(i,"keyup",(e=>{n.isInProgress()&&!e.shiftKey&&n.finish()})),this.eventManager.addEventListener(i,"mouseup",(r=>{n.isInProgress()&&km(r)&&n.finish(),iE(hE,this,!1);const i=mg(t.activeElement);gg(t.activeElement)&&!i||!i&&(n.isSelected()||n.isSelectedByAnyHeader()||e.contains(r.target)||Hm(r))||this.hot.unlisten()})),this.eventManager.addEventListener(i,"contextmenu",(e=>{n.isInProgress()&&Hm(e)&&(n.finish(),iE(hE,this,!1))})),this.eventManager.addEventListener(i,"touchend",(()=>{n.isInProgress()&&n.finish(),iE(hE,this,!1)})),this.eventManager.addEventListener(i,"mousedown",(n=>{const r=n.target,o=n.x||n.clientX,s=n.y||n.clientY;let a=n.target;if(rE(hE,this)||!e||!this.hot.view)return;const{holder:l}=this._wt.wtTable;if(a===l){const e=hg(t);if(t.elementFromPoint(o+e,s)!==l||t.elementFromPoint(o,s+e)!==l)return}else for(;a!==i;){if(null===a){if(n.isTargetWebComponent)break;return}if(a===e)return;a=a.parentNode}("function"==typeof this.settings.outsideClickDeselects?this.settings.outsideClickDeselects(r):this.settings.outsideClickDeselects)?this.hot.deselectCell():this.hot.destroyEditor(!1,!1)}));let o=Ip(r);for(;null!==o;)this.eventManager.addEventListener(o.document.documentElement,"click",(()=>{this.hot.unlisten()})),o=Ip(o);this.eventManager.addEventListener(rE(uE,this),"selectstart",(e=>{this.settings.fragmentSelection||gg(e.target)||e.preventDefault()}))}translateFromRenderableToVisualCoords(e){let{row:t,col:n}=e;return this.hot._createCellCoords(...this.translateFromRenderableToVisualIndex(t,n))}translateFromRenderableToVisualIndex(e,t){let n=e>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(e):e,r=t>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(t):t;return null===n&&(n=e),null===r&&(r=t),[n,r]}countRenderableIndexes(e,t){const n=Math.min(e.getNotTrimmedIndexesLength(),t),r=e.getNearestNotHiddenIndex(n-1,-1);return null===r?0:e.getRenderableFromVisualIndex(r)+1}countRenderableColumns(){return this.countRenderableIndexes(this.hot.columnIndexMapper,this.settings.maxCols)}countRenderableRows(){return this.countRenderableIndexes(this.hot.rowIndexMapper,this.settings.maxRows)}countNotHiddenRowIndexes(e,t){return this.countNotHiddenIndexes(e,t,this.hot.rowIndexMapper,this.countRenderableRows())}countNotHiddenColumnIndexes(e,t){return this.countNotHiddenIndexes(e,t,this.hot.columnIndexMapper,this.countRenderableColumns())}countNotHiddenIndexes(e,t,n,r){if(isNaN(e)||e<0)return 0;const i=n.getNearestNotHiddenIndex(e,t),o=n.getRenderableFromVisualIndex(i);if(!Number.isInteger(o))return 0;let s=0;return t<0?s=o+1:t>0&&(s=r-o),s}countNotHiddenFixedColumnsStart(){const e=this.hot.countCols(),t=Math.min(parseInt(this.settings.fixedColumnsStart,10),e)-1;return this.countNotHiddenColumnIndexes(t,-1)}countNotHiddenFixedRowsTop(){const e=this.hot.countRows(),t=Math.min(parseInt(this.settings.fixedRowsTop,10),e)-1;return this.countNotHiddenRowIndexes(t,-1)}countNotHiddenFixedRowsBottom(){const e=this.hot.countRows(),t=Math.max(e-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(t,1)}countRenderableColumnsInRange(e,t){let n=0;for(let r=e;r<=t;r++)null!==this.hot.columnIndexMapper.getRenderableFromVisualIndex(r)&&(n+=1);return n}countRenderableRowsInRange(e,t){let n=0;for(let r=e;r<=t;r++)null!==this.hot.rowIndexMapper.getRenderableFromVisualIndex(r)&&(n+=1);return n}getStylesHandler(){return this._wt.stylesHandler}getDefaultRowHeight(){return this._wt.stylesHandler.getDefaultRowHeight()}addClassNameToLicenseElement(e){var t;const n=null===(t=this.hot.rootElement.parentNode)||void 0===t?void 0:t.querySelector(".hot-display-license-info");n&&Fp(n,e)}removeClassNameFromLicenseElement(e){var t;const n=null===(t=this.hot.rootElement.parentNode)||void 0===t?void 0:t.querySelector(".hot-display-license-info");n&&Dp(n,e)}isMainTableNotFullyCoveredByOverlays(){const e=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),t=this.countNotHiddenFixedColumnsStart();return this.hot.countRenderedRows()>e&&this.hot.countRenderedCols()>t}initializeWalkontable(){const e={ariaTags:this.settings.ariaTags,rtlMode:this.hot.isRtl(),externalRowCalculator:this.hot.getPlugin("autoRowSize")&&this.hot.getPlugin("autoRowSize").isEnabled(),table:rE(uE,this),isDataViewInstance:()=>JR(this.hot),preventOverflow:()=>this.settings.preventOverflow,preventWheel:()=>this.settings.preventWheel,viewportColumnRenderingThreshold:()=>this.settings.viewportColumnRenderingThreshold,viewportRowRenderingThreshold:()=>this.settings.viewportRowRenderingThreshold,data:(e,t)=>this.hot.getDataAtCell(...this.translateFromRenderableToVisualIndex(e,t)),totalRows:()=>this.countRenderableRows(),totalColumns:()=>this.countRenderableColumns(),fixedColumnsStart:()=>this.countNotHiddenFixedColumnsStart(),fixedRowsTop:()=>this.countNotHiddenFixedRowsTop(),fixedRowsBottom:()=>this.countNotHiddenFixedRowsBottom(),shouldRenderInlineStartOverlay:()=>this.settings.fixedColumnsStart>0||e.rowHeaders().length>0,shouldRenderTopOverlay:()=>this.settings.fixedRowsTop>0||e.columnHeaders().length>0,shouldRenderBottomOverlay:()=>this.settings.fixedRowsBottom>0,minSpareRows:()=>this.settings.minSpareRows,renderAllRows:this.settings.renderAllRows,renderAllColumns:this.settings.renderAllColumns,rowHeaders:()=>{const e=[];return this.hot.hasRowHeaders()&&e.push(((e,t)=>{const n=e>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(e):e;this.appendRowHeader(n,t)})),this.hot.runHooks("afterGetRowHeaderRenderers",e),iE(aE,this,e.length),this.hot.getSettings().ariaTags&&oE(gE,this,mE).call(this)===this.hot.countCols()&&oE(gE,this,fE).call(this,rE(aE,this)),e},columnHeaders:()=>{const e=[];return this.hot.hasColHeaders()&&e.push(((e,t)=>{const n=e>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(e):e;this.appendColHeader(n,t)})),this.hot.runHooks("afterGetColumnHeaderRenderers",e),iE(sE,this,e.length),e},columnWidth:e=>{const t=this.hot.columnIndexMapper.getVisualFromRenderableIndex(e);return this.hot.getColWidth(null===t?e:t)},rowHeight:e=>{const t=this.hot.rowIndexMapper.getVisualFromRenderableIndex(e);return this.hot.getRowHeight(null===t?e:t)},rowHeightByOverlayName:(e,t)=>{const n=this.hot.rowIndexMapper.getVisualFromRenderableIndex(e),r=null===n?e:n;return this.hot.runHooks("modifyRowHeightByOverlayName",this.hot.getRowHeight(r),r,t)},cellRenderer:(e,t,n)=>{const[r,i]=this.translateFromRenderableToVisualIndex(e,t),o=this.hot.runHooks("modifyGetCellCoords",r,i,!1,"meta");let s=r,a=i;Array.isArray(o)&&([s,a]=o);const l=this.hot.getCellMeta(s,a),h=this.hot.colToProp(a);let u=this.hot.getDataAtRowProp(s,h);this.hot.hasHook("beforeValueRender")&&(u=this.hot.runHooks("beforeValueRender",u,l)),this.hot.runHooks("beforeRenderer",n,r,i,h,u,l),this.hot.getCellRenderer(l)(this.hot,n,r,i,h,u,l),this.hot.runHooks("afterRenderer",n,r,i,h,u,l)},selections:this.hot.selection.highlight,hideBorderOnMouseDownOver:()=>this.settings.fragmentSelection,onWindowResize:()=>{this.hot&&!this.hot.isDestroyed&&this.hot.refreshDimensions()},onContainerElementResize:()=>{this.hot&&!this.hot.isDestroyed&&$p(this.hot.rootElement)&&this.hot.refreshDimensions()},onCellMouseDown:(e,t,n,r)=>{const i=this.translateFromRenderableToVisualCoords(t),o={row:!1,column:!1,cell:!1};this.hot.listen(),this.activeWt=r,iE(hE,this,!0),iE(pE,this,{x:e.clientX,y:e.clientY}),this.hot.runHooks("beforeOnCellMouseDown",e,i,n,o),Lm(e)||(XR(e,{coords:i,selection:this.hot.selection,controller:o,cellCoordsFactory:(e,t)=>this.hot._createCellCoords(e,t)}),this.hot.runHooks("afterOnCellMouseDown",e,i,n),this.activeWt=this._wt)},onCellContextMenu:(e,t,n,r)=>{const i=this.translateFromRenderableToVisualCoords(t);this.activeWt=r,iE(hE,this,!1),this.hot.selection.isInProgress()&&this.hot.selection.finish(),this.hot.runHooks("beforeOnCellContextMenu",e,i,n),Lm(e)||(this.hot.runHooks("afterOnCellContextMenu",e,i,n),this.activeWt=this._wt)},onCellMouseOut:(e,t,n,r)=>{const i=this.translateFromRenderableToVisualCoords(t);this.activeWt=r,this.hot.runHooks("beforeOnCellMouseOut",e,i,n),Lm(e)||(this.hot.runHooks("afterOnCellMouseOut",e,i,n),this.activeWt=this._wt)},onCellMouseOver:(e,t,n,r)=>{const i=this.translateFromRenderableToVisualCoords(t),o={row:!1,column:!1,cell:!1};this.activeWt=r,this.hot.runHooks("beforeOnCellMouseOver",e,i,n,o),Lm(e)||(!rE(hE,this)||rE(pE,this)&&rE(pE,this).x===e.clientX&&rE(pE,this).y===e.clientY||XR(e,{coords:i,selection:this.hot.selection,controller:o,cellCoordsFactory:(e,t)=>this.hot._createCellCoords(e,t)}),this.hot.runHooks("afterOnCellMouseOver",e,i,n),this.activeWt=this._wt,iE(pE,this,null))},onCellMouseUp:(e,t,n,r)=>{const i=this.translateFromRenderableToVisualCoords(t);this.activeWt=r,this.hot.runHooks("beforeOnCellMouseUp",e,i,n),Lm(e)||this.hot.isDestroyed||(this.hot.runHooks("afterOnCellMouseUp",e,i,n),this.activeWt=this._wt)},onCellCornerMouseDown:e=>{e.preventDefault(),this.hot.runHooks("afterOnCellCornerMouseDown",e)},onCellCornerDblClick:e=>{e.preventDefault(),this.hot.runHooks("afterOnCellCornerDblClick",e)},beforeDraw:(e,t)=>this.beforeRender(e,t),onDraw:e=>this.afterRender(e),onBeforeViewportScrollVertically:(e,t)=>{const n=this.hot.rowIndexMapper,r=e<0;let i=e;return r||(i=n.getVisualFromRenderableIndex(e),null!==i)?(i=this.hot.runHooks("beforeViewportScrollVertically",i,t),this.hot.runHooks("beforeViewportScroll"),r?i:n.getRenderableFromVisualIndex(i)):e},onBeforeViewportScrollHorizontally:(e,t)=>{const n=this.hot.columnIndexMapper,r=e<0;let i=e;return r||(i=n.getVisualFromRenderableIndex(e),null!==i)?(i=this.hot.runHooks("beforeViewportScrollHorizontally",i,t),this.hot.runHooks("beforeViewportScroll"),r?i:n.getRenderableFromVisualIndex(i)):e},onScrollVertically:()=>{this.hot.runHooks("afterScrollVertically"),this.hot.runHooks("afterScroll")},onScrollHorizontally:()=>{this.hot.runHooks("afterScrollHorizontally"),this.hot.runHooks("afterScroll")},onBeforeRemoveCellClassNames:()=>this.hot.runHooks("beforeRemoveCellClassNames"),onBeforeHighlightingRowHeader:(e,t,n)=>{const r=this.hot.rowIndexMapper,i=e<0;let o=e;i||(o=r.getVisualFromRenderableIndex(e));const s=this.hot.runHooks("beforeHighlightingRowHeader",o,t,n);return i?s:r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(s,1))},onBeforeHighlightingColumnHeader:(e,t,n)=>{const r=this.hot.columnIndexMapper,i=e<0;let o=e;i||(o=r.getVisualFromRenderableIndex(e));const s=this.hot.runHooks("beforeHighlightingColumnHeader",o,t,n);return i?s:r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(s,1))},onAfterDrawSelection:(e,t,n)=>{let r;const[i,o]=this.translateFromRenderableToVisualIndex(e,t),s=this.hot.selection.getSelectedRange();if(s.size()>0){const e=s.peekByIndex(null!=n?n:0);r=[e.from.row,e.from.col,e.to.row,e.to.col]}return this.hot.runHooks("afterDrawSelection",i,o,r,n)},onBeforeDrawBorders:(e,t)=>{const[n,r,i,o]=e,s=[this.hot.rowIndexMapper.getVisualFromRenderableIndex(n),this.hot.columnIndexMapper.getVisualFromRenderableIndex(r),this.hot.rowIndexMapper.getVisualFromRenderableIndex(i),this.hot.columnIndexMapper.getVisualFromRenderableIndex(o)];return this.hot.runHooks("beforeDrawBorders",s,t)},onBeforeTouchScroll:()=>this.hot.runHooks("beforeTouchScroll"),onAfterMomentumScroll:()=>this.hot.runHooks("afterMomentumScroll"),onModifyRowHeaderWidth:e=>this.hot.runHooks("modifyRowHeaderWidth",e),onModifyGetCellCoords:(e,t,n,r)=>{const i=this.hot.rowIndexMapper,o=this.hot.columnIndexMapper,s=t>=0?o.getVisualFromRenderableIndex(t):t,a=e>=0?i.getVisualFromRenderableIndex(e):e,l=this.hot.runHooks("modifyGetCellCoords",a,s,n,r);if(Array.isArray(l)){const[e,t,n,r]=l;return[e>=0?i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(e,1)):e,t>=0?o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(t,1)):t,n>=0?i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(n,-1)):n,r>=0?o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(r,-1)):r]}},onModifyGetCoordsElement:(e,t)=>{const n=this.hot.rowIndexMapper,r=this.hot.columnIndexMapper,i=t>=0?r.getVisualFromRenderableIndex(t):t,o=e>=0?n.getVisualFromRenderableIndex(e):e,s=this.hot.runHooks("modifyGetCoordsElement",o,i);if(Array.isArray(s)){const[e,t]=s;return[e>=0?n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(e,1)):e,t>=0?r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(t,1)):t]}},viewportRowCalculatorOverride:e=>{let t=this.settings.viewportRowRenderingOffset;if("auto"===t&&this.settings.fixedRowsTop&&(t=10),t>0||"auto"===t){const n=this.countRenderableRows(),r=e.startRow,i=e.endRow;if("number"==typeof t)e.startRow=Math.max(r-t,0),e.endRow=Math.min(i+t,n-1);else if("auto"===t){const t=Math.max(1,Math.ceil(i/n*12));e.startRow=Math.max(r-t,0),e.endRow=Math.min(i+t,n-1)}}this.hot.runHooks("afterViewportRowCalculatorOverride",e)},viewportColumnCalculatorOverride:e=>{let t=this.settings.viewportColumnRenderingOffset;if("auto"===t&&this.settings.fixedColumnsStart&&(t=10),t>0||"auto"===t){const n=this.countRenderableColumns(),r=e.startColumn,i=e.endColumn;if("number"==typeof t&&(e.startColumn=Math.max(r-t,0),e.endColumn=Math.min(i+t,n-1)),"auto"===t){const t=Math.max(1,Math.ceil(i/n*6));e.startColumn=Math.max(r-t,0),e.endColumn=Math.min(i+t,n-1)}}this.hot.runHooks("afterViewportColumnCalculatorOverride",e)},rowHeaderWidth:()=>this.settings.rowHeaderWidth,columnHeaderHeight:()=>{const e=this.hot.runHooks("modifyColumnHeaderHeight");return this.settings.columnHeaderHeight||e}};this.hot.runHooks("beforeInitWalkontable",e),this._wt=new $R(e),this.activeWt=this._wt;const t=this._wt.wtTable.spreader,{width:n,height:r}=this.hot.rootElement.getBoundingClientRect();this.setLastSize(n,r),this.eventManager.addEventListener(t,"mousedown",(e=>{e.target===t&&3===e.which&&e.stopPropagation()})),this.eventManager.addEventListener(t,"contextmenu",(e=>{e.target===t&&3===e.which&&e.stopPropagation()})),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"click",(()=>{this.settings.observeDOMVisibility&&this._wt.drawInterrupted&&(this.hot.forceFullRender=!0,this.render())}))}isTextSelectionAllowed(e){if(gg(e))return!0;const t=Pp(e,this._wt.wtTable.spreader);return!(!0!==this.settings.fragmentSelection||!t)||(!("cell"!==this.settings.fragmentSelection||!this.isSelectedOnlyCell()||!t)||!(this.settings.fragmentSelection||!this.isCellEdited()||!this.isSelectedOnlyCell()))}isMouseDown(){return rE(hE,this)}isSelectedOnlyCell(){var e,t;return null!==(e=null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.isSingleCell())&&void 0!==e&&e}isCellEdited(){const e=this.hot.getActiveEditor();return e&&e.isOpened()}beforeRender(e,t){e&&this.hot.runHooks("beforeViewRender",this.hot.forceFullRender,t)}afterRender(e){e&&this.hot.runHooks("afterViewRender",this.hot.forceFullRender)}appendRowHeader(e,t){if(t.firstChild){const n=t.firstChild;if(!kp(n,"relative"))return Wp(t),void this.appendRowHeader(e,t);this.updateCellHeader(n.querySelector(".rowHeader"),e,this.hot.getRowHeader)}else{const{rootDocument:n,getRowHeader:r}=this.hot,i=n.createElement("div"),o=n.createElement("span");i.className="relative",o.className="rowHeader",this.updateCellHeader(o,e,r),i.appendChild(o),t.appendChild(i)}this.hot.runHooks("afterGetRowHeader",e,t)}appendColHeader(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.hot.getColHeader,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;const i=()=>{const t=e>=0?this.hot.getColumnMeta(e).headerClassName:null;return t?t.split(" "):[]};if(t.firstChild){const o=t.firstChild;kp(o,"relative")?(this.updateCellHeader(o.querySelector(".colHeader"),e,n,r),o.className="",Fp(o,["relative",...i()])):(Wp(t),this.appendColHeader(e,t,n,r))}else{const{rootDocument:o}=this.hot,s=o.createElement("div"),a=o.createElement("span"),l=i();s.classList.add("relative",...l),a.className="colHeader",this.settings.ariaTags&&(Vp(s,...dp()),Vp(a,...dp())),this.updateCellHeader(a,e,n,r),s.appendChild(a),t.appendChild(s)}this.hot.runHooks("afterGetColHeader",e,t,r)}updateCellHeader(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=t;const o=this._wt.wtOverlays.getParentOverlay(e)||this._wt;e.parentNode&&(kp(e,"colHeader")?i=o.wtTable.columnFilter.sourceToRendered(t):kp(e,"rowHeader")&&(i=o.wtTable.rowFilter.sourceToRendered(t))),i>-1?Gp(e,n(t,r)):(zp(e,String.fromCharCode(160)),Fp(e,"cornerHeader"))}maximumVisibleElementWidth(e){const t=this._wt.wtViewport.getWorkspaceWidth()-e;return t>0?t:0}maximumVisibleElementHeight(e){const t=this._wt.wtViewport.getWorkspaceHeight()-e;return t>0?t:0}setLastSize(e,t){iE(cE,this,e),iE(dE,this,t)}getLastSize(){return{width:rE(cE,this),height:rE(dE,this)}}getFirstRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;const e=this.hot.rowIndexMapper,t=e.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedRow());return e.getNearestNotHiddenIndex(null!=t?t:0,1)}getLastRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;const e=this.hot.rowIndexMapper,t=e.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedRow());return e.getNearestNotHiddenIndex(null!=t?t:this.hot.countRows()-1,-1)}getFirstRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;const e=this.hot.columnIndexMapper,t=e.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedColumn());return e.getNearestNotHiddenIndex(null!=t?t:0,1)}getLastRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;const e=this.hot.columnIndexMapper,t=e.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedColumn());return e.getNearestNotHiddenIndex(null!=t?t:this.hot.countCols()-1,-1)}getFirstFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleRow())}getLastFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleRow())}getFirstFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleColumn())}getLastFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleColumn())}getFirstPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleRow())}getLastPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleRow())}getFirstPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleColumn())}getLastPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleColumn())}getColumnHeadersCount(){return rE(sE,this)}getRowHeadersCount(){return rE(aE,this)}getViewportWidth(){return this._wt.wtViewport.getViewportWidth()}getWorkspaceWidth(){return this._wt.wtViewport.getWorkspaceWidth()}getViewportHeight(){return this._wt.wtViewport.getViewportHeight()}getWorkspaceHeight(){return this._wt.wtViewport.getWorkspaceHeight()}getElementOverlayName(e){var t;return(null!==(t=this._wt.wtOverlays.getParentOverlay(e))&&void 0!==t?t:this._wt).wtTable.name}getOverlayByName(e){return this._wt.getOverlayByName(e)}getActiveOverlayName(){return this._wt.activeOverlayName}isVisible(){return this._wt.wtTable.isVisible()}hasVerticalScroll(){return this._wt.wtViewport.hasVerticalScroll()}hasHorizontalScroll(){return this._wt.wtViewport.hasHorizontalScroll()}getTableWidth(){return this._wt.wtTable.getWidth()}getTableHeight(){return this._wt.wtTable.getHeight()}getTableOffset(){return this._wt.wtViewport.getWorkspaceOffset()}getRowHeaderWidth(){return this._wt.wtViewport.getRowHeaderWidth()}getColumnHeaderHeight(){return this._wt.wtViewport.getColumnHeaderHeight()}isVerticallyScrollableByWindow(){return this._wt.wtViewport.isVerticallyScrollableByWindow()}isHorizontallyScrollableByWindow(){return this._wt.wtViewport.isHorizontallyScrollableByWindow()}destroy(){this._wt.destroy(),this.eventManager.destroy()}};var vE=wu,CE=Ge,SE=sn,RE=Ss;Ti({target:"Iterator",proto:!0,real:!0},{every:function(e){SE(this),CE(e);var t=RE(this),n=0;return!vE(t,(function(t,r){if(!e(t,n++))return r()}),{IS_RECORD:!0,INTERRUPTED:!0}).stopped}});const EE=26;function bE(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=e;const r=[];return Array.isArray(e)&&Array.isArray(e[0])||(n=[e]),n.forEach(((e,n)=>{Array.isArray(e)?e.forEach(((e,i)=>{r.push([n+t,i,e])})):Object.keys(e).forEach((i=>{r.push([n+t,i,e[i]])}))})),r}function TE(e){let t=0;return Array.isArray(e)&&(e[0]&&Array.isArray(e[0])?t=e[0].length:e[0]&&am(e[0])&&(t=cm(e[0]))),t}function NE(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const AE=class{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];NE(this,"hot",void 0),NE(this,"data",void 0),NE(this,"dataType","array"),NE(this,"colToProp",(()=>{})),NE(this,"propToCol",(()=>{})),this.hot=e,this.data=t}modifyRowData(e){let t;return this.hot.hasHook("modifyRowData")&&(t=this.hot.runHooks("modifyRowData",e)),void 0===t||Number.isInteger(t)?this.data[e]:t}getData(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.data&&0!==this.data.length?this.getByRange(null,null,e):this.data}setData(e){this.data=e}getAtColumn(e){const t=[];return Vd(this.data,((n,r)=>{const i=this.getAtCell(r,e);t.push(i)})),t}getAtRow(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const i=void 0===t&&void 0===n,{dataDotNotation:o}=this.hot.getSettings();let s=null,a=null;if(s=this.modifyRowData(e),Array.isArray(s))a=[],i?s.forEach(((t,n)=>{a[n]=this.getAtPhysicalCell(e,n,s)})):Jw(t,n,(n=>{a[n-t]=this.getAtPhysicalCell(e,n,s)}));else if(am(s)||Cg(s))if(a=r?[]:{},!i||r){const i=0,l=this.countFirstRowKeys()-1;Jw(i,l,(h=>{const u=this.colToProp(h);if(h>=(t||i)&&h<=(n||l)&&!Number.isInteger(u)){const t=this.getAtPhysicalCell(e,u,s);r?a.push(t):o?um(a,u,t):a[u]=t}}))}else hm(s,((t,n)=>{const r=this.getAtPhysicalCell(e,n,s);o?um(a,n,r):a[n]=r}));return a}setAtCell(e,t,n){if(!(e>=this.countRows()||t>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){const r=dm(n);this.hot.runHooks("modifySourceData",e,t,r,"set"),r.isTouched()&&(n=r.value)}["__proto__","constructor","prototype"].includes(e)||(Number.isInteger(t)?this.data[e][t]=n:um(this.data[e],t,n))}}getAtPhysicalCell(e,t,n){let r=null;if(n)if("string"==typeof t){const{dataDotNotation:e}=this.hot.getSettings();r=e?function(e,t){const n=t.split(".");let r=e;return hm(n,(e=>{if(r=r[e],void 0===r)return r=void 0,!1})),r}(n,t):n[t]}else r="function"==typeof t?t(n):n[t];if(this.hot.hasHook("modifySourceData")){const n=dm(r);this.hot.runHooks("modifySourceData",e,t,n,"get"),n.isTouched()&&(r=n.value)}return r}getAtCell(e,t){const n=this.modifyRowData(e);return this.getAtPhysicalCell(e,this.colToProp(t),n)}getByRange(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=!1,i=null,o=null,s=null,a=null;null===e||null===t?(r=!0,i=0,s=this.countRows()-1):(i=Math.min(e.row,t.row),o=Math.min(e.col,t.col),s=Math.max(e.row,t.row),a=Math.max(e.col,t.col));const l=[];return Jw(i,s,(e=>{l.push(r?this.getAtRow(e,void 0,void 0,n):this.getAtRow(e,o,a,n))})),l}countRows(){if(this.hot.hasHook("modifySourceLength")){const e=this.hot.runHooks("modifySourceLength");if(Number.isInteger(e))return e}return this.data.length}countFirstRowKeys(){return TE(this.data)}destroy(){this.data=null,this.hot=null}};var ME=wu,IE=Ge,OE=sn,xE=Ss;function PE(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Ti({target:"Iterator",proto:!0,real:!0},{some:function(e){OE(this),IE(e);var t=xE(this),n=0;return ME(t,(function(t,r){if(e(t,n++))return r()}),{IS_RECORD:!0,INTERRUPTED:!0}).stopped}});class _E{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;PE(this,"indexedValues",[]),PE(this,"initValueOrFn",void 0),this.initValueOrFn=e}getValues(){return this.indexedValues}getValueAtIndex(e){const t=this.indexedValues;if(e<t.length)return t[e]}setValues(e){this.indexedValues=e.slice(),this.runLocalHooks("change")}setValueAtIndex(e,t){return e<this.indexedValues.length&&(this.indexedValues[e]=t,this.runLocalHooks("change"),!0)}clear(){this.setDefaultValues()}getLength(){return this.getValues().length}setDefaultValues(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,Cg(this.initValueOrFn)?Jw(e-1,(e=>this.indexedValues.push(this.initValueOrFn(e)))):Jw(e-1,(()=>this.indexedValues.push(this.initValueOrFn))),this.runLocalHooks("change")}init(e){return this.setDefaultValues(e),this.runLocalHooks("init"),this}insert(){this.runLocalHooks("change")}remove(){this.runLocalHooks("change")}destroy(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}function LE(e,t,n,r){const i=n.length?n[0]:void 0;return[...e.slice(0,i),...n.map(((e,t)=>Cg(r)?r(e,t):r)),...void 0===i?[]:e.slice(i)]}function HE(e,t){return Fd(e,((e,n)=>!1===t.includes(n)))}om(_E,yS);class kE extends _E{insert(e,t){this.indexedValues=LE(this.indexedValues,0,t,this.initValueOrFn),super.insert(e,t)}remove(e){this.indexedValues=HE(this.indexedValues,e),super.remove(e)}}class FE extends kE{constructor(){super(arguments.length>0&&void 0!==arguments[0]&&arguments[0])}getHiddenIndexes(){return kd(this.getValues(),((e,t,n)=>(t&&e.push(n),e)),[])}}function DE(e,t,n){return[...e.slice(0,t),...n,...e.slice(t)]}function VE(e,t){return Fd(e,(e=>!1===t.includes(e)))}function UE(e,t){return Dd(e,(e=>e-t.filter((t=>t<e)).length))}function BE(e,t){const n=t[0],r=t.length;return Dd(e,(e=>e>=n?e+r:e))}function WE(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class jE extends _E{constructor(){super(...arguments),WE(this,"orderOfIndexes",[])}getValues(){return this.orderOfIndexes.map((e=>this.indexedValues[e]))}setValues(e){this.orderOfIndexes=[...Array(e.length).keys()],super.setValues(e)}setValueAtIndex(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.orderOfIndexes.length;return e<this.indexedValues.length&&(this.indexedValues[e]=t,!1===this.orderOfIndexes.includes(e)&&this.orderOfIndexes.splice(n,0,e),this.runLocalHooks("change"),!0)}clearValue(e){this.orderOfIndexes=VE(this.orderOfIndexes,[e]),Cg(this.initValueOrFn)?super.setValueAtIndex(e,this.initValueOrFn(e)):super.setValueAtIndex(e,this.initValueOrFn)}getLength(){return this.orderOfIndexes.length}setDefaultValues(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,super.setDefaultValues(e)}insert(e,t){this.indexedValues=LE(this.indexedValues,0,t,this.initValueOrFn),this.orderOfIndexes=BE(this.orderOfIndexes,t),super.insert(e,t)}remove(e){this.indexedValues=HE(this.indexedValues,e),this.orderOfIndexes=VE(this.orderOfIndexes,e),this.orderOfIndexes=UE(this.orderOfIndexes,e),super.remove(e)}getEntries(){return this.orderOfIndexes.map((e=>[e,this.getValueAtIndex(e)]))}}class GE extends kE{constructor(){super(arguments.length>0&&void 0!==arguments[0]&&arguments[0])}getTrimmedIndexes(){return kd(this.getValues(),((e,t,n)=>(t&&e.push(n),e)),[])}}const zE=new Map([["indexesSequence",{getListWithInsertedItems:DE,getListWithRemovedItems:VE}],["physicallyIndexed",{getListWithInsertedItems:LE,getListWithRemovedItems:HE}]]),$E=e=>{if(!1===zE.has(e))throw new Error(`Alter strategy with ID '${e}' does not exist.`);return zE.get(e)};class YE extends _E{constructor(){super((e=>e))}insert(e,t){const n=BE(this.indexedValues,t);this.indexedValues=DE(n,e,t),super.insert(e,t)}remove(e){const t=VE(this.indexedValues,e);this.indexedValues=UE(t,e),super.remove(e)}}const KE=new Map([["hiding",FE],["index",_E],["linkedPhysicalIndexToValue",jE],["physicalIndexToValue",kE],["trimming",GE]]);function XE(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class qE{constructor(){XE(this,"collection",new Map)}register(e,t){!1===this.collection.has(e)&&(this.collection.set(e,t),t.addLocalHook("change",(()=>this.runLocalHooks("change",t))))}unregister(e){const t=this.collection.get(e);Gd(t)&&(t.destroy(),this.collection.delete(e),this.runLocalHooks("change",t))}unregisterAll(){this.collection.forEach(((e,t)=>this.unregister(t))),this.collection.clear()}get(e){return zd(e)?Array.from(this.collection.values()):this.collection.get(e)}getLength(){return this.collection.size}removeFromEvery(e){this.collection.forEach((t=>{t.remove(e)}))}insertToEvery(e,t){this.collection.forEach((n=>{n.insert(e,t)}))}initEvery(e){this.collection.forEach((t=>{t.init(e)}))}}function QE(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}om(qE,yS);class ZE extends qE{constructor(e,t){super(),QE(this,"mergedValuesCache",[]),QE(this,"aggregationFunction",void 0),QE(this,"fallbackValue",void 0),this.aggregationFunction=e,this.fallbackValue=t}getMergedValues(){if(!0===(!(arguments.length>0&&void 0!==arguments[0])||arguments[0]))return this.mergedValuesCache;if(0===this.getLength())return[];const e=Dd(this.get(),(e=>e.getValues())),t=[],n=Gd(e[0])&&e[0].length||0;for(let r=0;r<n;r+=1){const n=[];for(let t=0;t<this.getLength();t+=1)n.push(e[t][r]);t.push(n)}return Dd(t,this.aggregationFunction)}getMergedValueAtIndex(e,t){const n=this.getMergedValues(t)[e];return Gd(n)?n:this.fallbackValue}updateCache(){this.mergedValuesCache=this.getMergedValues(!1)}}function JE(e,t,n){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,n)}function eb(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var tb=new WeakMap;class nb{constructor(){JE(this,tb,[])}subscribe(e){var t,n;return this.addLocalHook("change",e),this._write((n=this,(t=tb).get(eb(t,n)))),this}unsubscribe(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}_write(e){return e.length>0&&this.runLocalHooks("change",e),this}_writeInitialChanges(e){var t,n,r;n=this,r=e,(t=tb).set(eb(t,n),r)}}function rb(e,t){const n=[];let r=0,i=0;for(;r<e.length&&i<t.length;r++,i++)e[r]!==t[i]&&n.push({op:"replace",index:i,oldValue:e[r],newValue:t[i]});for(;r<t.length;r++)n.push({op:"insert",index:r,oldValue:void 0,newValue:t[r]});for(;i<e.length;i++)n.push({op:"remove",index:i,oldValue:e[i],newValue:void 0});return n}function ib(e,t,n){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,n)}function ob(e,t){return e.get(ab(e,t))}function sb(e,t,n){return e.set(ab(e,t),n),n}function ab(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}om(nb,yS);var lb=new WeakMap,hb=new WeakMap,ub=new WeakMap,cb=new WeakMap,db=new WeakMap;class pb{constructor(){let{initialIndexValue:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};ib(this,lb,new Set),ib(this,hb,[]),ib(this,ub,[]),ib(this,cb,!1),ib(this,db,!1),sb(db,this,null!=e&&e)}createObserver(){const e=new nb;return ob(lb,this).add(e),e.addLocalHook("unsubscribe",(()=>{ob(lb,this).delete(e)})),e._writeInitialChanges(rb(ob(hb,this),ob(ub,this))),e}emit(e){let t=ob(ub,this);ob(cb,this)&&ob(hb,this).length===e.length||(0===e.length?e=new Array(t.length).fill(ob(db,this)):sb(hb,this,new Array(e.length).fill(ob(db,this))),ob(cb,this)||(sb(cb,this,!0),t=ob(hb,this)));const n=rb(t,e);ob(lb,this).forEach((e=>e._write(n))),sb(ub,this,e)}}function gb(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class mb{constructor(){gb(this,"indexesSequence",new YE),gb(this,"trimmingMapsCollection",new ZE((e=>e.some((e=>!0===e))),!1)),gb(this,"hidingMapsCollection",new ZE((e=>e.some((e=>!0===e))),!1)),gb(this,"variousMapsCollection",new qE),gb(this,"hidingChangesObservable",new pb({initialIndexValue:!1})),gb(this,"notTrimmedIndexesCache",[]),gb(this,"notHiddenIndexesCache",[]),gb(this,"isBatched",!1),gb(this,"indexesSequenceChanged",!1),gb(this,"indexesChangeSource",void 0),gb(this,"trimmedIndexesChanged",!1),gb(this,"hiddenIndexesChanged",!1),gb(this,"renderablePhysicalIndexesCache",[]),gb(this,"fromPhysicalToVisualIndexesCache",new Map),gb(this,"fromVisualToRenderableIndexesCache",new Map),this.indexesSequence.addLocalHook("change",(()=>{this.indexesSequenceChanged=!0,this.updateCache(),this.runLocalHooks("indexesSequenceChange",this.indexesChangeSource),this.runLocalHooks("change",this.indexesSequence,null)})),this.trimmingMapsCollection.addLocalHook("change",(e=>{this.trimmedIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.trimmingMapsCollection)})),this.hidingMapsCollection.addLocalHook("change",(e=>{this.hiddenIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.hidingMapsCollection)})),this.variousMapsCollection.addLocalHook("change",(e=>{this.runLocalHooks("change",e,this.variousMapsCollection)}))}suspendOperations(){this.isBatched=!0}resumeOperations(){this.isBatched=!1,this.updateCache()}createChangesObserver(e){if("hiding"!==e)throw new Error(`Unsupported index map type "${e}".`);return this.hidingChangesObservable.createObserver()}createAndRegisterIndexMap(e,t,n){return this.registerMap(e,function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!KE.has(e))throw new Error(`The provided map type ("${e}") does not exist.`);return new(KE.get(e))(t)}(t,n))}registerMap(e,t){if(this.trimmingMapsCollection.get(e)||this.hidingMapsCollection.get(e)||this.variousMapsCollection.get(e))throw Error(`Map with name "${e}" has been already registered.`);t instanceof GE?this.trimmingMapsCollection.register(e,t):t instanceof FE?this.hidingMapsCollection.register(e,t):this.variousMapsCollection.register(e,t);const n=this.getNumberOfIndexes();return n>0&&t.init(n),t}unregisterMap(e){this.trimmingMapsCollection.unregister(e),this.hidingMapsCollection.unregister(e),this.variousMapsCollection.unregister(e)}unregisterAll(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}getPhysicalFromVisualIndex(e){const t=this.notTrimmedIndexesCache[e];return Gd(t)?t:null}getPhysicalFromRenderableIndex(e){const t=this.renderablePhysicalIndexesCache[e];return Gd(t)?t:null}getVisualFromPhysicalIndex(e){const t=this.fromPhysicalToVisualIndexesCache.get(e);return Gd(t)?t:null}getVisualFromRenderableIndex(e){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(e))}getRenderableFromVisualIndex(e){const t=this.fromVisualToRenderableIndexesCache.get(e);return Gd(t)?t:null}getNearestNotHiddenIndex(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(null===this.getPhysicalFromVisualIndex(e))return null;if(this.fromVisualToRenderableIndexesCache.has(e))return e;const r=Array.from(this.fromVisualToRenderableIndexesCache.keys());let i=-1;return i=t>0?r.findIndex((t=>t>e)):r.reverse().findIndex((t=>t<e)),-1===i?n?this.getNearestNotHiddenIndex(e,-t,!1):null:r[i]}initToLength(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=[...new Array(e).keys()],this.notHiddenIndexesCache=[...new Array(e).keys()],this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(e),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(e),this.variousMapsCollection.initEvery(e),this.resumeOperations(),this.runLocalHooks("init")}fitToLength(e){const t=this.getNumberOfIndexes();if(e<t){const t=[...Array(this.getNumberOfIndexes()-e).keys()].map((t=>t+e));this.removeIndexes(t)}else this.insertIndexes(t,e-t)}getIndexesSequence(){return this.indexesSequence.getValues()}setIndexesSequence(e){void 0===this.indexesChangeSource&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(e),"update"===this.indexesChangeSource&&(this.indexesChangeSource=void 0)}getNotTrimmedIndexes(){if(!0===(!(arguments.length>0&&void 0!==arguments[0])||arguments[0]))return this.notTrimmedIndexesCache;return this.getIndexesSequence().filter((e=>!1===this.isTrimmed(e)))}getNotTrimmedIndexesLength(){return this.getNotTrimmedIndexes().length}getNotHiddenIndexes(){if(!0===(!(arguments.length>0&&void 0!==arguments[0])||arguments[0]))return this.notHiddenIndexesCache;return this.getIndexesSequence().filter((e=>!1===this.isHidden(e)))}getNotHiddenIndexesLength(){return this.getNotHiddenIndexes().length}getRenderableIndexes(){if(!0===(!(arguments.length>0&&void 0!==arguments[0])||arguments[0]))return this.renderablePhysicalIndexesCache;return this.getNotTrimmedIndexes().filter((e=>!1===this.isHidden(e)))}getRenderableIndexesLength(){return this.getRenderableIndexes().length}getNumberOfIndexes(){return this.getIndexesSequence().length}moveIndexes(e,t){"number"==typeof e&&(e=[e]);const n=Dd(e,(e=>this.getPhysicalFromVisualIndex(e))),r=this.getNotTrimmedIndexesLength(),i=e.length,o=VE(this.getIndexesSequence(),n),s=o.filter((e=>!1===this.isTrimmed(e)));let a=o.indexOf(s[s.length-1])+1;if(t+i<r){const e=s[t];a=o.indexOf(e)}this.indexesChangeSource="move",this.setIndexesSequence(DE(o,a,n)),this.indexesChangeSource=void 0}isTrimmed(e){return this.trimmingMapsCollection.getMergedValueAtIndex(e)}isHidden(e){return this.hidingMapsCollection.getMergedValueAtIndex(e)}insertIndexes(e,t){const n=this.getNotTrimmedIndexes()[e],r=Gd(n)?n:this.getNumberOfIndexes(),i=this.getIndexesSequence().includes(n)?this.getIndexesSequence().indexOf(n):this.getNumberOfIndexes(),o=Dd(new Array(t).fill(r),((e,t)=>e+t));this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(i,o),this.indexesChangeSource=void 0,this.trimmingMapsCollection.insertToEvery(i,o),this.hidingMapsCollection.insertToEvery(i,o),this.variousMapsCollection.insertToEvery(i,o),this.resumeOperations()}removeIndexes(e){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(e),this.hidingMapsCollection.removeFromEvery(e),this.variousMapsCollection.removeFromEvery(e),this.resumeOperations()}updateCache(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(!0===e||!1===this.isBatched&&!0===t)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}cacheFromPhysicalToVisualIndexes(){const e=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(let t=0;t<e;t+=1){const e=this.getPhysicalFromVisualIndex(t);this.fromPhysicalToVisualIndexesCache.set(e,t)}}cacheFromVisualToRenderableIndexes(){const e=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(let t=0;t<e;t+=1){const e=this.getPhysicalFromRenderableIndex(t),n=this.getVisualFromPhysicalIndex(e);this.fromVisualToRenderableIndexesCache.set(n,t)}}}function fb(e){const t=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(e);return t?`${t[1].toLowerCase()}-${t[2].toUpperCase()}`:e}function wb(e){Gd(e)&&Dm(Wd`Language with code "${e}" was not found. You should register particular language\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`)}om(mb,yS);const{register:yb,getValues:vb}=Tf("phraseFormatters");yb("pluralize",(function(e,t){return Array.isArray(e)&&Number.isInteger(t)?e[t]:e}));const Cb="ContextMenu:items",Sb=`${Cb}.noItems`,Rb=`${Cb}.insertRowAbove`,Eb=`${Cb}.insertRowBelow`,bb=`${Cb}.insertColumnOnTheLeft`,Tb=`${Cb}.insertColumnOnTheRight`,Nb=`${Cb}.removeRow`,Ab=`${Cb}.removeColumn`,Mb=`${Cb}.undo`,Ib=`${Cb}.redo`,Ob=`${Cb}.readOnly`,xb=`${Cb}.clearColumn`,Pb=`${Cb}.copy`,_b=`${Cb}.copyWithHeaders`,Lb=`${Cb}.copyWithGroupHeaders`,Hb=`${Cb}.copyHeadersOnly`,kb=`${Cb}.cut`,Fb=`${Cb}.freezeColumn`,Db=`${Cb}.unfreezeColumn`,Vb=`${Cb}.mergeCells`,Ub=`${Cb}.unmergeCells`,Bb=`${Cb}.addComment`,Wb=`${Cb}.editComment`,jb=`${Cb}.removeComment`,Gb=`${Cb}.readOnlyComment`,zb=`${Cb}.align`,$b=`${Cb}.align.left`,Yb=`${Cb}.align.center`,Kb=`${Cb}.align.right`,Xb=`${Cb}.align.justify`,qb=`${Cb}.align.top`,Qb=`${Cb}.align.middle`,Zb=`${Cb}.align.bottom`,Jb=`${Cb}.borders`,eT=`${Cb}.borders.top`,tT=`${Cb}.borders.right`,nT=`${Cb}.borders.bottom`,rT=`${Cb}.borders.left`,iT=`${Cb}.borders.remove`,oT=`${Cb}.nestedHeaders.insertChildRow`,sT=`${Cb}.nestedHeaders.detachFromParent`,aT=`${Cb}.hideColumn`,lT=`${Cb}.showColumn`,hT=`${Cb}.hideRow`,uT=`${Cb}.showRow`,cT="Filters:",dT=`${cT}conditions`,pT=`${dT}.none`,gT=`${dT}.isEmpty`,mT=`${dT}.isNotEmpty`,fT=`${dT}.isEqualTo`,wT=`${dT}.isNotEqualTo`,yT=`${dT}.beginsWith`,vT=`${dT}.endsWith`,CT=`${dT}.contains`,ST=`${dT}.doesNotContain`,RT=`${dT}.byValue`,ET=`${dT}.greaterThan`,bT=`${dT}.greaterThanOrEqualTo`,TT=`${dT}.lessThan`,NT=`${dT}.lessThanOrEqualTo`,AT=`${dT}.isBetween`,MT=`${dT}.isNotBetween`,IT=`${dT}.after`,OT=`${dT}.before`,xT=`${dT}.today`,PT=`${dT}.tomorrow`,_T=`${dT}.yesterday`,LT=`${cT}labels.filterByCondition`,HT=`${cT}labels.filterByValue`,kT=`${cT}labels.conjunction`,FT=`${cT}labels.disjunction`,DT=`${cT}values.blankCells`,VT=`${cT}buttons.selectAll`,UT=`${cT}buttons.clear`,BT=`${cT}buttons.ok`,WT=`${cT}buttons.cancel`,jT=`${cT}buttons.placeholder.search`,GT=`${cT}buttons.placeholder.value`,zT=`${cT}buttons.placeholder.secondValue`,$T="CheckboxRenderer:",YT=`${$T}checked`,KT=`${$T}unchecked`,XT=Object.freeze(Object.defineProperty({__proto__:null,CHECKBOX_CHECKED:YT,CHECKBOX_RENDERER_NAMESPACE:$T,CHECKBOX_UNCHECKED:KT,CONTEXTMENU_ITEMS_ADD_COMMENT:Bb,CONTEXTMENU_ITEMS_ALIGNMENT:zb,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:Zb,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:Yb,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:Xb,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:$b,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:Qb,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:Kb,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:qb,CONTEXTMENU_ITEMS_BORDERS:Jb,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:nT,CONTEXTMENU_ITEMS_BORDERS_LEFT:rT,CONTEXTMENU_ITEMS_BORDERS_RIGHT:tT,CONTEXTMENU_ITEMS_BORDERS_TOP:eT,CONTEXTMENU_ITEMS_CLEAR_COLUMN:xb,CONTEXTMENU_ITEMS_COPY:Pb,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:Hb,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:Lb,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:_b,CONTEXTMENU_ITEMS_CUT:kb,CONTEXTMENU_ITEMS_EDIT_COMMENT:Wb,CONTEXTMENU_ITEMS_FREEZE_COLUMN:Fb,CONTEXTMENU_ITEMS_HIDE_COLUMN:aT,CONTEXTMENU_ITEMS_HIDE_ROW:hT,CONTEXTMENU_ITEMS_INSERT_LEFT:bb,CONTEXTMENU_ITEMS_INSERT_RIGHT:Tb,CONTEXTMENU_ITEMS_MERGE_CELLS:Vb,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:sT,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:oT,CONTEXTMENU_ITEMS_NO_ITEMS:Sb,CONTEXTMENU_ITEMS_READ_ONLY:Ob,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:Gb,CONTEXTMENU_ITEMS_REDO:Ib,CONTEXTMENU_ITEMS_REMOVE_BORDERS:iT,CONTEXTMENU_ITEMS_REMOVE_COLUMN:Ab,CONTEXTMENU_ITEMS_REMOVE_COMMENT:jb,CONTEXTMENU_ITEMS_REMOVE_ROW:Nb,CONTEXTMENU_ITEMS_ROW_ABOVE:Rb,CONTEXTMENU_ITEMS_ROW_BELOW:Eb,CONTEXTMENU_ITEMS_SHOW_COLUMN:lT,CONTEXTMENU_ITEMS_SHOW_ROW:uT,CONTEXTMENU_ITEMS_UNDO:Mb,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:Db,CONTEXTMENU_ITEMS_UNMERGE_CELLS:Ub,CONTEXT_MENU_ITEMS_NAMESPACE:Cb,FILTERS_BUTTONS_CANCEL:WT,FILTERS_BUTTONS_CLEAR:UT,FILTERS_BUTTONS_OK:BT,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:jT,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:zT,FILTERS_BUTTONS_PLACEHOLDER_VALUE:GT,FILTERS_BUTTONS_SELECT_ALL:VT,FILTERS_CONDITIONS_AFTER:IT,FILTERS_CONDITIONS_BEFORE:OT,FILTERS_CONDITIONS_BEGINS_WITH:yT,FILTERS_CONDITIONS_BETWEEN:AT,FILTERS_CONDITIONS_BY_VALUE:RT,FILTERS_CONDITIONS_CONTAINS:CT,FILTERS_CONDITIONS_EMPTY:gT,FILTERS_CONDITIONS_ENDS_WITH:vT,FILTERS_CONDITIONS_EQUAL:fT,FILTERS_CONDITIONS_GREATER_THAN:ET,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:bT,FILTERS_CONDITIONS_LESS_THAN:TT,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:NT,FILTERS_CONDITIONS_NAMESPACE:dT,FILTERS_CONDITIONS_NONE:pT,FILTERS_CONDITIONS_NOT_BETWEEN:MT,FILTERS_CONDITIONS_NOT_CONTAIN:ST,FILTERS_CONDITIONS_NOT_EMPTY:mT,FILTERS_CONDITIONS_NOT_EQUAL:wT,FILTERS_CONDITIONS_TODAY:xT,FILTERS_CONDITIONS_TOMORROW:PT,FILTERS_CONDITIONS_YESTERDAY:_T,FILTERS_DIVS_FILTER_BY_CONDITION:LT,FILTERS_DIVS_FILTER_BY_VALUE:HT,FILTERS_LABELS_CONJUNCTION:kT,FILTERS_LABELS_DISJUNCTION:FT,FILTERS_NAMESPACE:cT,FILTERS_VALUES_BLANK_CELLS:DT},Symbol.toStringTag,{value:"Module"})),qT={languageCode:"en-US",[Sb]:"No available options",[Rb]:"Insert row above",[Eb]:"Insert row below",[bb]:"Insert column left",[Tb]:"Insert column right",[Nb]:["Remove row","Remove rows"],[Ab]:["Remove column","Remove columns"],[Mb]:"Undo",[Ib]:"Redo",[Ob]:"Read only",[xb]:"Clear column",[zb]:"Alignment",[$b]:"Left",[Yb]:"Center",[Kb]:"Right",[Xb]:"Justify",[qb]:"Top",[Qb]:"Middle",[Zb]:"Bottom",[Fb]:"Freeze column",[Db]:"Unfreeze column",[Jb]:"Borders",[eT]:"Top",[tT]:"Right",[nT]:"Bottom",[rT]:"Left",[iT]:"Remove border(s)",[Bb]:"Add comment",[Wb]:"Edit comment",[jb]:"Delete comment",[Gb]:"Read-only comment",[Vb]:"Merge cells",[Ub]:"Unmerge cells",[Pb]:"Copy",[_b]:["Copy with header","Copy with headers"],[Lb]:["Copy with group header","Copy with group headers"],[Hb]:["Copy header only","Copy headers only"],[kb]:"Cut",[oT]:"Insert child row",[sT]:"Detach from parent",[aT]:["Hide column","Hide columns"],[lT]:["Show column","Show columns"],[hT]:["Hide row","Hide rows"],[uT]:["Show row","Show rows"],[pT]:"None",[gT]:"Is empty",[mT]:"Is not empty",[fT]:"Is equal to",[wT]:"Is not equal to",[yT]:"Begins with",[vT]:"Ends with",[CT]:"Contains",[ST]:"Does not contain",[ET]:"Greater than",[bT]:"Greater than or equal to",[TT]:"Less than",[NT]:"Less than or equal to",[AT]:"Is between",[MT]:"Is not between",[IT]:"After",[OT]:"Before",[xT]:"Today",[PT]:"Tomorrow",[_T]:"Yesterday",[DT]:"Blank cells",[LT]:"Filter by condition",[HT]:"Filter by value",[kT]:"And",[FT]:"Or",[VT]:"Select all",[UT]:"Clear",[BT]:"OK",[WT]:"Cancel",[jT]:"Search",[GT]:"Value",[zT]:"Second value",[YT]:"Checked",[KT]:"Unchecked"},QT=XT,ZT=qT.languageCode,{register:JT,getItem:eN,hasItem:tN,getValues:nN}=Tf("languagesDictionaries");function rN(e,t){let n=e,r=t;return am(e)&&(r=e,n=r.languageCode),function(e,t){e!==ZT&&(n=t,hm(eN(ZT),((e,t)=>{zd(n[t])&&(n[t]=e)})));var n}(n,r),JT(n,rm(r)),rm(r)}function iN(e){return oN(e)?rm(eN(e)):null}function oN(e){return tN(e)}function sN(e,t,n){const r=iN(e);if(null===r)return null;const i=r[t];if(zd(i))return null;const o=function(e,t){let n=e;return Vd(function(){return vb()}(),(r=>{n=r(e,t)})),n}(i,n);return Array.isArray(o)?o[0]:o}function aN(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}rN(qT);const lN=class extends CS{constructor(e,t){super(e,null),aN(this,"visualCellRange",null),this.visualCellRange=t||null,this.commit()}add(e){return null===this.visualCellRange?this.visualCellRange=this.settings.createCellRange(e):this.visualCellRange.expand(e),this}clear(){return this.visualCellRange=null,super.clear()}trimToVisibleCellsRangeOnly(e){let{from:t,to:n}=e,r=this.getNearestNotHiddenCoords(t,1),i=this.getNearestNotHiddenCoords(n,-1);return null===r||null===i?null:((r.row>i.row||r.col>i.col)&&(r=t,i=n),this.settings.createCellRange(r,r,i))}getNearestNotHiddenCoords(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t;const r=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper,e.row,t);if(null===r)return null;const i=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper,e.col,n);return null===i?null:this.settings.createCellCoords(r,i)}getNearestNotHiddenIndex(e,t,n){return t<0?t:e.getNearestNotHiddenIndex(t,n)}commit(){if(null===this.visualCellRange)return this;const e=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return this.cellRange=null===e?null:this.createRenderableCellRange(e.from,e.to),this}syncWith(e){const t=e.from.clone().normalize(),n="N-S"===e.getVerticalDirection()?1:-1,r="W-E"===e.getHorizontalDirection()?1:-1,i=this.settings.visualToRenderableCoords(this.visualCellRange.highlight);let o=null;if(null!==i&&null!==i.col&&null!==i.row||(o=this.getNearestNotHiddenCoords(t,n,r)),null!==o&&e.overlaps(o)){const t=e.highlight.clone();if(t.row>=0&&(t.row=o.row),t.col>=0&&(t.col=o.col),null===this.cellRange){const e=this.settings.visualToRenderableCoords(t);this.cellRange=this.settings.createCellRange(e)}e.setHighlight(t)}return"focus"===this.settings.selectionType&&null!==i&&null===o&&e.setHighlight(this.visualCellRange.highlight),this}getCorners(){const{from:e,to:t}=this.cellRange;return[Math.min(e.row,t.row),Math.min(e.col,t.col),Math.max(e.row,t.row),Math.max(e.col,t.col)]}getVisualCorners(){const e=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),t=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[e.row,e.col,t.row,t.col]}createRenderableCellRange(e,t){const n=this.settings.visualToRenderableCoords(e),r=this.settings.visualToRenderableCoords(t);return null===n.row||null===n.col||null===r.row||null===r.col?null:this.settings.createCellRange(n,n,r)}};function hN(e){let{activeHeaderClassName:t,...n}=e;return new lN({className:t,...n,selectionType:SS})}function uN(e){let{areaCornerVisible:t,...n}=e;return new lN({className:"area",createLayers:!0,border:{width:1,color:"#4b89ff",cornerVisible:t},...n,selectionType:ES})}function cN(e){let{...t}=e;return new lN({className:"highlight",...t,selectionType:ES})}function dN(e){let{columnClassName:t,...n}=e;return new lN({className:t,...n,selectionType:"column"})}function pN(e){let{headerClassName:t,...n}=e;return new lN({className:t,...n,selectionType:RS})}function gN(e){let{rowClassName:t,...n}=e;return new lN({className:t,...n,selectionType:"row"})}function mN(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function fN(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function wN(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var yN=new WeakSet;class vN{constructor(e){mN(this,yN),fN(this,"options",void 0),fN(this,"layerLevel",0),fN(this,"focus",void 0),fN(this,"fill",void 0),fN(this,"layeredAreas",new Map),fN(this,"areas",new Map),fN(this,"rowHeaders",new Map),fN(this,"columnHeaders",new Map),fN(this,"activeRowHeaders",new Map),fN(this,"activeColumnHeaders",new Map),fN(this,"activeCornerHeaders",new Map),fN(this,"rowHighlights",new Map),fN(this,"columnHighlights",new Map),fN(this,"customSelections",[]),this.options=e,this.focus=function(e){let{cellCornerVisible:t,...n}=e;return new lN({className:"current",headerAttributes:[["aria-selected","true"]],border:{width:2,color:"#4b89ff",cornerVisible:t},...n,selectionType:bS})}(e),this.fill=function(e){let{...t}=e;return new lN({className:"fill",border:{width:1,color:"#ff0000"},...t,selectionType:"fill"})}(e)}isEnabledFor(e,t){let n=e;e===bS&&(n="current");let r=this.options.disabledCellSelection(t.row,t.col);return"string"==typeof r&&(r=[r]),!1===r||Array.isArray(r)&&!r.includes(n)}useLayerLevel(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.layerLevel=e,this}getFocus(){return this.focus}getFill(){return this.fill}createLayeredArea(){return wN(yN,this,CN).call(this,this.layeredAreas,uN)}getLayeredAreas(){return[...this.layeredAreas.values()]}createArea(){return wN(yN,this,CN).call(this,this.areas,cN)}getAreas(){return[...this.areas.values()]}createRowHeader(){return wN(yN,this,CN).call(this,this.rowHeaders,pN)}getRowHeaders(){return[...this.rowHeaders.values()]}createColumnHeader(){return wN(yN,this,CN).call(this,this.columnHeaders,pN)}getColumnHeaders(){return[...this.columnHeaders.values()]}createActiveRowHeader(){return wN(yN,this,CN).call(this,this.activeRowHeaders,hN)}getActiveRowHeaders(){return[...this.activeRowHeaders.values()]}createActiveColumnHeader(){return wN(yN,this,CN).call(this,this.activeColumnHeaders,hN)}getActiveColumnHeaders(){return[...this.activeColumnHeaders.values()]}createActiveCornerHeader(){return wN(yN,this,CN).call(this,this.activeCornerHeaders,hN)}getActiveCornerHeaders(){return[...this.activeCornerHeaders.values()]}createRowHighlight(){return wN(yN,this,CN).call(this,this.rowHighlights,gN)}getRowHighlights(){return[...this.rowHighlights.values()]}createColumnHighlight(){return wN(yN,this,CN).call(this,this.columnHighlights,dN)}getColumnHighlights(){return[...this.columnHighlights.values()]}getCustomSelections(){return[...this.customSelections.values()]}addCustomSelection(e){this.customSelections.push(function(e){let{border:t,visualCellRange:n,...r}=e;return new lN({...t,...r,selectionType:"custom-selection"},n)}({...this.options,...e}))}clear(){this.focus.clear(),this.fill.clear(),Vd(this.areas.values(),(e=>{e.clear()})),Vd(this.layeredAreas.values(),(e=>{e.clear()})),Vd(this.rowHeaders.values(),(e=>{e.clear()})),Vd(this.columnHeaders.values(),(e=>{e.clear()})),Vd(this.activeRowHeaders.values(),(e=>{e.clear()})),Vd(this.activeColumnHeaders.values(),(e=>{e.clear()})),Vd(this.activeCornerHeaders.values(),(e=>{e.clear()})),Vd(this.rowHighlights.values(),(e=>{e.clear()})),Vd(this.columnHighlights.values(),(e=>{e.clear()}))}[Symbol.iterator](){return[this.focus,this.fill,...this.areas.values(),...this.layeredAreas.values(),...this.rowHeaders.values(),...this.columnHeaders.values(),...this.activeRowHeaders.values(),...this.activeColumnHeaders.values(),...this.activeCornerHeaders.values(),...this.rowHighlights.values(),...this.columnHighlights.values(),...this.customSelections][Symbol.iterator]()}}function CN(e,t){const n=this.layerLevel;if(e.has(n))return e.get(n);const r=t({layerLevel:n,...this.options});return e.set(n,r),r}const SN=vN;function RN(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class EN{constructor(e){RN(this,"ranges",[]),RN(this,"createCellRange",void 0),this.createCellRange=e}isEmpty(){return 0===this.size()}set(e){return this.clear(),this.ranges.push(this.createCellRange(e)),this}add(e){return this.ranges.push(this.createCellRange(e)),this}pop(){return this.ranges.pop(),this}current(){return this.peekByIndex(this.size()-1)}previous(){return this.peekByIndex(this.size()-2)}includes(e){return this.ranges.some((t=>t.includes(e)))}clear(){return this.ranges.length=0,this}size(){return this.ranges.length}peekByIndex(){let e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return t>=0&&t<this.size()&&(e=this.ranges[t]),e}[Symbol.iterator](){return this.ranges[Symbol.iterator]()}}const bN=EN;function TN(e,t,n){NN(e,t),t.set(e,n)}function NN(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function AN(e,t){return e.get(IN(e,t))}function MN(e,t,n){return e.set(IN(e,t),n),n}function IN(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var ON=new WeakMap,xN=new WeakMap,PN=new WeakMap,_N=new WeakSet;class LN{constructor(e,t){var n,r;NN(n=this,r=_N),r.add(n),TN(this,ON,void 0),TN(this,xN,void 0),TN(this,PN,{x:0,y:0}),MN(ON,this,e),MN(xN,this,t)}transformStart(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=AN(xN,this).createCellCoords(e,t);let i=AN(ON,this).current().highlight;const o=AN(xN,this).visualToRenderableCoords(i);let s=0,a=0;if(this.runLocalHooks("beforeTransformStart",r),null!==o.row&&null!==o.col){const{width:e,height:t}=IN(_N,this,kN).call(this),{row:o,col:l}=IN(_N,this,VN).call(this,i),h=AN(xN,this).fixedRowsBottom(),u=AN(xN,this).minSpareRows(),c=AN(xN,this).minSpareCols(),d=AN(xN,this).autoWrapRow(),p=AN(xN,this).autoWrapCol(),g=AN(xN,this).createCellCoords(o+r.row,l+r.col);if(g.row>=t){const r=dm(n&&u>0&&0===h),i=g.col+1,o=AN(xN,this).createCellCoords(g.row-t,i>=e?i-e:i);this.runLocalHooks("beforeColumnWrap",r,IN(_N,this,UN).call(this,o),i>=e),r.value?this.runLocalHooks("insertRowRequire",AN(xN,this).countRenderableRows()):p&&g.assign(o)}else if(g.row<0){const n=dm(p),r=g.col-1,i=AN(xN,this).createCellCoords(t+g.row,r<0?e+r:r);this.runLocalHooks("beforeColumnWrap",n,IN(_N,this,UN).call(this,i),r<0),p&&g.assign(i)}if(g.col>=e){const r=dm(n&&c>0),i=g.row+1,o=AN(xN,this).createCellCoords(i>=t?i-t:i,g.col-e);this.runLocalHooks("beforeRowWrap",r,IN(_N,this,UN).call(this,o),i>=t),r.value?this.runLocalHooks("insertColRequire",AN(xN,this).countRenderableColumns()):d&&g.assign(o)}else if(g.col<0){const n=dm(d),r=g.row-1,i=AN(xN,this).createCellCoords(r<0?t+r:r,e+g.col);this.runLocalHooks("beforeRowWrap",n,IN(_N,this,UN).call(this,i),r<0),d&&g.assign(i)}const{rowDir:m,colDir:f}=IN(_N,this,HN).call(this,g);s=m,a=f,i=IN(_N,this,UN).call(this,g)}return this.runLocalHooks("afterTransformStart",i,s,a),i}transformEnd(e,t){const n=AN(xN,this).createCellCoords(e,t),r=AN(ON,this).current(),i=AN(xN,this).visualToRenderableCoords(r.highlight),o=IN(_N,this,FN).call(this,r.to.row,r.from.row),s=IN(_N,this,DN).call(this,r.to.col,r.from.col),a=r.to.clone();let l=0,h=0;if(this.runLocalHooks("beforeTransformEnd",n),null!==i.row&&null!==i.col&&null!==o&&null!==s){const{row:e,col:t}=IN(_N,this,VN).call(this,r.highlight),i=AN(xN,this).createCellCoords(o+n.row,s+n.col),u=r.getTopStartCorner(),c=r.getTopEndCorner(),d=r.getBottomEndCorner();if(n.col<0&&s>=t&&i.col<t){const e=i.col-t;i.col=IN(_N,this,DN).call(this,u.col,c.col)+e}else if(n.col>0&&s<=t&&i.col>t){const e=IN(_N,this,DN).call(this,c.col,u.col),t=Math.max(i.col-e,1);i.col=e+t}if(n.row<0&&o>=e&&i.row<e){const t=i.row-e;i.row=IN(_N,this,FN).call(this,u.row,d.row)+t}else if(n.row>0&&o<=e&&i.row>e){const e=IN(_N,this,FN).call(this,d.row,u.row),t=Math.max(i.row-e,1);i.row=e+t}const{rowDir:p,colDir:g}=IN(_N,this,HN).call(this,i);l=p,h=g;const m=IN(_N,this,UN).call(this,i);0===n.row&&0!==n.col?a.col=m.col:0!==n.row&&0===n.col?a.row=m.row:(a.row=m.row,a.col=m.col)}return this.runLocalHooks("afterTransformEnd",a,l,h),a}setOffsetSize(e){let{x:t,y:n}=e;MN(PN,this,{x:t,y:n})}resetOffsetSize(){MN(PN,this,{x:0,y:0})}}function HN(e){const{width:t,height:n}=IN(_N,this,kN).call(this);let r=0,i=0;return e.row<0?(r=-1,e.row=0):e.row>0&&e.row>=n&&(r=1,e.row=n-1),e.col<0?(i=-1,e.col=0):e.col>0&&e.col>=t&&(i=1,e.col=t-1),{rowDir:r,colDir:i}}function kN(){return{width:AN(PN,this).x+AN(xN,this).countRenderableColumns(),height:AN(PN,this).y+AN(xN,this).countRenderableRows()}}function FN(e,t){const n=AN(xN,this).findFirstNonHiddenRenderableRow(e,t);return null===n?null:AN(PN,this).y+n}function DN(e,t){const n=AN(xN,this).findFirstNonHiddenRenderableColumn(e,t);return null===n?null:AN(PN,this).x+n}function VN(e){const{row:t,col:n}=AN(xN,this).visualToRenderableCoords(e);if(null===t||null===n)throw new Error("Renderable coords are not visible.");return AN(xN,this).createCellCoords(AN(PN,this).y+t,AN(PN,this).x+n)}function UN(e){const t=e.clone();return t.col=e.col-AN(PN,this).x,t.row=e.row-AN(PN,this).y,AN(xN,this).renderableToVisualCoords(t)}om(LN,yS);const BN=LN,WN=0,jN=1,GN=2,zN=3,$N=[zN,GN],YN=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],KN=Symbol("root"),XN=Symbol("child");function qN(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:KN;if(t!==KN&&t!==XN)throw new Error("The second argument is used internally only and cannot be overwritten.");const n=Array.isArray(e),r=t===KN;let i=WN;if(n){const t=e[0];if(0===e.length)i=jN;else if(r&&t instanceof Ev)i=zN;else if(r&&Array.isArray(t))i=qN(t,XN);else if(e.length>=2&&e.length<=4){const t=!e.some(((e,t)=>!YN[t].includes(typeof e)));t&&(i=GN)}}return i}function QN(e){let{createCellCoords:t,createCellRange:n,keepDirection:r=!1,propToCol:i}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!$N.includes(e))throw new Error("Unsupported selection ranges schema type was provided.");return function(o){const s=e===zN;let a=s?o.from.row:o[0],l=s?o.from.col:o[1],h=s?o.to.row:o[2],u=s?o.to.col:o[3];if("function"==typeof i&&("string"==typeof l&&(l=i(l)),"string"==typeof u&&(u=i(u))),zd(h)&&(h=a),zd(u)&&(u=l),!r){const e=a,t=l,n=h,r=u;a=Math.min(e,n),l=Math.min(t,r),h=Math.max(e,n),u=Math.max(t,r)}const c=t(a,l),d=t(h,u);return n(c,c,d)}}function ZN(e,t,n){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,n)}function JN(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function eA(e,t){return e.get(nA(e,t))}function tA(e,t,n){return e.set(nA(e,t),n),n}function nA(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var rA=new WeakMap,iA=new WeakMap,oA=new WeakMap,sA=new WeakMap,aA=new WeakMap,lA=new WeakMap;class hA{constructor(e,t){var n=this;JN(this,"settings",void 0),JN(this,"tableProps",void 0),JN(this,"inProgress",!1),JN(this,"selectedRange",new bN(((e,t,n)=>this.tableProps.createCellRange(e,t,n)))),JN(this,"highlight",void 0),ZN(this,rA,void 0),ZN(this,iA,void 0),JN(this,"selectedByRowHeader",new Set),JN(this,"selectedByColumnHeader",new Set),ZN(this,oA,!1),ZN(this,sA,!1),ZN(this,aA,"unknown"),ZN(this,lA,-1),this.settings=e,this.tableProps=t,this.highlight=new SN({headerClassName:e.currentHeaderClassName,activeHeaderClassName:e.activeHeaderClassName,rowClassName:e.currentRowClassName,columnClassName:e.currentColClassName,cellAttributes:[["aria-selected","true"]],rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,disabledCellSelection:(e,t)=>this.tableProps.isDisabledCellSelection(e,t),cellCornerVisible:function(){return n.isCellCornerVisible(...arguments)},areaCornerVisible:function(){return n.isAreaCornerVisible(...arguments)},visualToRenderableCoords:e=>this.tableProps.visualToRenderableCoords(e),renderableToVisualCoords:e=>this.tableProps.renderableToVisualCoords(e),createCellCoords:(e,t)=>this.tableProps.createCellCoords(e,t),createCellRange:(e,t,n)=>this.tableProps.createCellRange(e,t,n)}),tA(rA,this,new BN(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>this.tableProps.countRenderableRows(),countRenderableColumns:()=>this.tableProps.countRenderableColumns(),visualToRenderableCoords:e=>this.tableProps.visualToRenderableCoords(e),renderableToVisualCoords:e=>this.tableProps.renderableToVisualCoords(e),findFirstNonHiddenRenderableRow:function(){return n.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return n.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(e,t)=>this.tableProps.createCellCoords(e,t),fixedRowsBottom:()=>e.fixedRowsBottom,minSpareRows:()=>e.minSpareRows,minSpareCols:()=>e.minSpareCols,autoWrapRow:()=>e.autoWrapRow,autoWrapCol:()=>e.autoWrapCol})),tA(iA,this,new BN(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>{const e=this.selectedRange.current();return this.tableProps.countRenderableRowsInRange(0,e.getOuterBottomEndCorner().row)},countRenderableColumns:()=>{const e=this.selectedRange.current();return this.tableProps.countRenderableColumnsInRange(0,e.getOuterBottomEndCorner().col)},visualToRenderableCoords:e=>this.tableProps.visualToRenderableCoords(e),renderableToVisualCoords:e=>this.tableProps.renderableToVisualCoords(e),findFirstNonHiddenRenderableRow:function(){return n.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return n.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(e,t)=>this.tableProps.createCellCoords(e,t),fixedRowsBottom:()=>0,minSpareRows:()=>0,minSpareCols:()=>0,autoWrapRow:()=>!0,autoWrapCol:()=>!0})),eA(rA,this).addLocalHook("beforeTransformStart",(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.runLocalHooks("beforeModifyTransformStart",...t)})),eA(rA,this).addLocalHook("afterTransformStart",(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.runLocalHooks("afterModifyTransformStart",...t)})),eA(rA,this).addLocalHook("beforeTransformEnd",(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.runLocalHooks("beforeModifyTransformEnd",...t)})),eA(rA,this).addLocalHook("afterTransformEnd",(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.runLocalHooks("afterModifyTransformEnd",...t)})),eA(rA,this).addLocalHook("insertRowRequire",(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.runLocalHooks("insertRowRequire",...t)})),eA(rA,this).addLocalHook("insertColRequire",(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.runLocalHooks("insertColRequire",...t)})),eA(rA,this).addLocalHook("beforeRowWrap",(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.runLocalHooks("beforeRowWrap",...t)})),eA(rA,this).addLocalHook("beforeColumnWrap",(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.runLocalHooks("beforeColumnWrap",...t)})),eA(iA,this).addLocalHook("beforeTransformStart",(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.runLocalHooks("beforeModifyTransformFocus",...t)})),eA(iA,this).addLocalHook("afterTransformStart",(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.runLocalHooks("afterModifyTransformFocus",...t)}))}getSelectedRange(){return this.selectedRange}markSource(e){tA(aA,this,e)}markEndSource(){tA(aA,this,"unknown")}getSelectionSource(){return eA(aA,this)}setExpectedLayers(e){tA(lA,this,e)}begin(){this.inProgress=!0}finish(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1,tA(lA,this,-1)}isInProgress(){return this.inProgress}setRangeStart(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e;const i="multiple"===this.settings.selectionMode,o=zd(t)?this.tableProps.getShortcutManager().isCtrlPressed():t,s=e.clone();tA(oA,this,!1),this.runLocalHooks("beforeSetRangeStart"+(n?"Only":""),s),(!i||i&&!o&&zd(t))&&this.selectedRange.clear(),this.selectedRange.add(s).current().setHighlight(r.clone()),0===this.getLayerLevel()&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),n||this.setRangeEnd(e)}setRangeStartOnly(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e;this.setRangeStart(e,t,!0,n)}setRangeEnd(e){if(this.selectedRange.isEmpty())return;const t=e.clone(),n=this.tableProps.countRows(),r=this.tableProps.countCols(),i=this.selectedRange.current().clone().setTo(e).isSingleHeader();if((n>0||r>0)&&(0===n&&t.col<0&&!i||0===r&&t.row<0&&!i))return;this.runLocalHooks("beforeSetRangeEnd",t),this.begin();const o=this.selectedRange.current();if(this.settings.navigableHeaders||o.highlight.normalize(),"single"===this.settings.selectionMode)o.setFrom(o.highlight),o.setTo(o.highlight);else{const e=o.getHorizontalDirection(),n=o.getVerticalDirection(),r=this.isMultiple();o.setTo(t),r&&(e!==o.getHorizontalDirection()||1===o.getWidth()&&!o.includes(o.highlight))&&o.from.assign({col:o.highlight.col}),r&&(n!==o.getVerticalDirection()||1===o.getHeight()&&!o.includes(o.highlight))&&o.from.assign({row:o.highlight.row})}n>0&&r>0&&(!this.settings.navigableHeaders||this.settings.navigableHeaders&&!o.isSingleHeader())&&o.to.normalize(),this.runLocalHooks("beforeHighlightSet"),this.setRangeFocus(this.selectedRange.current().highlight),this.applyAndCommit();const s=-1===eA(lA,this)||this.selectedRange.size()===eA(lA,this);this.runLocalHooks("afterSetRangeEnd",e,s)}applyAndCommit(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.selectedRange.current(),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.getLayerLevel();const n=this.tableProps.countRows(),r=this.tableProps.countCols();t<this.highlight.layerLevel&&(Vd(this.highlight.getAreas(),(e=>{e.clear()})),Vd(this.highlight.getLayeredAreas(),(e=>{e.clear()})),Vd(this.highlight.getRowHeaders(),(e=>{e.clear()})),Vd(this.highlight.getColumnHeaders(),(e=>{e.clear()})),Vd(this.highlight.getActiveRowHeaders(),(e=>{e.clear()})),Vd(this.highlight.getActiveColumnHeaders(),(e=>{e.clear()})),Vd(this.highlight.getActiveCornerHeaders(),(e=>{e.clear()})),Vd(this.highlight.getRowHighlights(),(e=>{e.clear()})),Vd(this.highlight.getColumnHighlights(),(e=>{e.clear()}))),this.highlight.useLayerLevel(t);const i=this.highlight.createArea(),o=this.highlight.createLayeredArea(),s=this.highlight.createRowHeader(),a=this.highlight.createColumnHeader(),l=this.highlight.createActiveRowHeader(),h=this.highlight.createActiveColumnHeader(),u=this.highlight.createActiveCornerHeader(),c=this.highlight.createRowHighlight(),d=this.highlight.createColumnHighlight();if(i.clear(),o.clear(),s.clear(),a.clear(),l.clear(),h.clear(),u.clear(),c.clear(),d.clear(),this.highlight.isEnabledFor(ES,e.highlight)&&(this.isMultiple()||t>=1)&&(i.add(e.from).add(e.to).commit(),o.add(e.from).add(e.to).commit(),1===t)){const e=this.selectedRange.previous();this.highlight.useLayerLevel(t-1),this.highlight.createArea().add(e.from).commit().syncWith(e),this.highlight.createLayeredArea().add(e.from).commit().syncWith(e),this.highlight.useLayerLevel(t)}if(this.highlight.isEnabledFor(RS,e.highlight)){if(!e.isSingleHeader()){const t=this.tableProps.createCellCoords(Math.max(e.from.row,0),-1),n=this.tableProps.createCellCoords(e.to.row,-1),r=this.tableProps.createCellCoords(-1,Math.max(e.from.col,0)),i=this.tableProps.createCellCoords(-1,e.to.col);"single"===this.settings.selectionMode?(s.add(t).commit(),a.add(r).commit(),c.add(t).commit(),d.add(r).commit()):(s.add(t).add(n).commit(),a.add(r).add(i).commit(),c.add(t).add(n).commit(),d.add(r).add(i).commit())}const t=!eA(sA,this)&&this.isEntireRowSelected()&&(r>0&&r===e.getWidth()||0===r&&this.isSelectedByRowHeader()),i=!eA(sA,this)&&this.isEntireColumnSelected()&&(n>0&&n===e.getHeight()||0===n&&this.isSelectedByColumnHeader());t&&l.add(this.tableProps.createCellCoords(Math.max(e.from.row,0),Math.min(-this.tableProps.countRowHeaders(),-1))).add(this.tableProps.createCellCoords(Math.max(e.to.row,0),-1)).commit(),i&&h.add(this.tableProps.createCellCoords(Math.min(-this.tableProps.countColHeaders(),-1),Math.max(e.from.col,0))).add(this.tableProps.createCellCoords(-1,Math.max(e.to.col,0))).commit(),t&&i&&u.add(this.tableProps.createCellCoords(-this.tableProps.countColHeaders(),-this.tableProps.countRowHeaders())).add(this.tableProps.createCellCoords(-1,-1)).commit()}}setRangeFocus(e){if(this.selectedRange.isEmpty())return;const t=this.selectedRange.current();this.inProgress||this.runLocalHooks("beforeSetFocus",e);const n=this.highlight.getFocus();n.clear(),t.setHighlight(e),this.inProgress||this.runLocalHooks("beforeHighlightSet"),this.highlight.isEnabledFor(bS,t.highlight)&&n.add(t.highlight).commit().syncWith(t),this.inProgress||(tA(oA,this,!0),this.runLocalHooks("afterSetFocus",t.highlight))}transformStart(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.settings.navigableHeaders?eA(rA,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):eA(rA,this).resetOffsetSize(),this.setRangeStart(eA(rA,this).transformStart(e,t,n))}transformEnd(e,t){this.settings.navigableHeaders?eA(rA,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):eA(rA,this).resetOffsetSize(),this.setRangeEnd(eA(rA,this).transformEnd(e,t))}transformFocus(e,t){const n=this.selectedRange.current(),{row:r,col:i}=n.getOuterTopStartCorner(),o=this.tableProps.countRenderableColumnsInRange(0,i-1),s=this.tableProps.countRenderableRowsInRange(0,r-1);n.highlight.isHeader()?eA(iA,this).setOffsetSize({x:i<0?Math.abs(i):-o,y:r<0?Math.abs(r):-s}):eA(iA,this).setOffsetSize({x:i<0?0:-o,y:r<0?0:-s});const a=eA(iA,this).transformStart(e,t);this.setRangeFocus(a.normalize())}shiftRows(e,t){if(!this.isSelected())return;const n=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByColumnHeader()||n.getOuterTopStartCorner().row>=e){const{from:r,to:i,highlight:o}=n,s=this.tableProps.countRows(),a=this.isSelectedByRowHeader(),l=this.isSelectedByColumnHeader(),h=l?-1:0,u=l?0:t;this.getSelectedRange().pop();const c=this.tableProps.createCellCoords(ny(r.row+u,h,s-1),r.col),d=this.tableProps.createCellCoords(ny(i.row+t,h,s-1),i.col);this.markSource("shift"),o.row>=e?this.setRangeStartOnly(c,!0,this.tableProps.createCellCoords(ny(o.row+t,0,s-1),o.col)):this.setRangeStartOnly(c,!0),a&&this.selectedByRowHeader.add(this.getLayerLevel()),l&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(d),this.markEndSource()}}shiftColumns(e,t){if(!this.isSelected())return;const n=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByRowHeader()||n.getOuterTopStartCorner().col>=e){const{from:r,to:i,highlight:o}=n,s=this.tableProps.countCols(),a=this.isSelectedByRowHeader(),l=this.isSelectedByColumnHeader(),h=a?-1:0,u=a?0:t;this.getSelectedRange().pop();const c=this.tableProps.createCellCoords(r.row,ny(r.col+u,h,s-1)),d=this.tableProps.createCellCoords(i.row,ny(i.col+t,h,s-1));this.markSource("shift"),o.col>=e?this.setRangeStartOnly(c,!0,this.tableProps.createCellCoords(o.row,ny(o.col+t,0,s-1))):this.setRangeStartOnly(c,!0),a&&this.selectedByRowHeader.add(this.getLayerLevel()),l&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(d),this.markEndSource()}}getLayerLevel(){return this.selectedRange.size()-1}isSelected(){return!this.selectedRange.isEmpty()}isMultiple(){if(!this.isSelected())return!1;const e=dm(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",e),e.value}isFocusSelectionChanged(){return this.isSelected()&&eA(oA,this)}isSelectedByRowHeader(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(e)&&(-1===e?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(e))}isEntireRowSelected(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();const t=e=>{const{col:t}=e.getOuterTopStartCorner(),n=this.tableProps.countRowHeaders(),r=this.tableProps.countCols();return(n>0&&t<0||0===n)&&e.getWidth()===r};if(-1===e)return Array.from(this.selectedRange).some((e=>t(e)));const n=this.selectedRange.peekByIndex(e);return!!n&&t(n)}isSelectedByColumnHeader(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&(-1===e?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(e))}isEntireColumnSelected(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();const t=e=>{const{row:t}=e.getOuterTopStartCorner(),n=this.tableProps.countColHeaders(),r=this.tableProps.countRows();return(n>0&&t<0||0===n)&&e.getHeight()===r};if(-1===e)return Array.from(this.selectedRange).some((e=>t(e)));const n=this.selectedRange.peekByIndex(e);return!!n&&t(n)}isSelectedByAnyHeader(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}isSelectedByCorner(){return this.selectedByColumnHeader.has(this.getLayerLevel())&&this.selectedByRowHeader.has(this.getLayerLevel())}inInSelection(e){return this.selectedRange.includes(e)}isCellCornerVisible(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}isCellVisible(e){const t=this.tableProps.visualToRenderableCoords(e);return null!==t.row&&null!==t.col}isAreaCornerVisible(e){return(!Number.isInteger(e)||e===this.getLayerLevel())&&(this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple())}clear(){this.selectedRange.clear(),this.highlight.clear()}deselect(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}selectAll(){var e;let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{focusPosition:!1,disableHeadersHighlight:!1};const i=this.tableProps.countRows(),o=this.tableProps.countCols(),s=this.tableProps.countRowHeaders(),a=this.tableProps.countColHeaders(),l=n?-a:0,h=t?-s:0;if(0===l&&0===h&&(0===i||0===o))return;let u=null===(e=this.getSelectedRange().current())||void 0===e?void 0:e.highlight;const{focusPosition:c,disableHeadersHighlight:d}=r;tA(sA,this,d),c&&Number.isInteger(null==c?void 0:c.row)&&Number.isInteger(null==c?void 0:c.col)&&(u=this.tableProps.createCellCoords(ny(c.row,l,i-1),ny(c.col,h,o-1)));const p=this.tableProps.createCellCoords(l,h),g=this.tableProps.createCellCoords(i-1,o-1);this.clear(),this.setRangeStartOnly(p,void 0,u),h<0&&this.selectedByRowHeader.add(this.getLayerLevel()),l<0&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(g),this.finish(),tA(sA,this,!1)}selectCells(e){var t=this;const n=qN(e);if(n===jN)return!1;if(n===WN)throw new Error(Wd`Unsupported format of the selection ranges was passed. To select cells pass\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`);const r=QN(n,{createCellCoords:function(){return t.tableProps.createCellCoords(...arguments)},createCellRange:function(){return t.tableProps.createCellRange(...arguments)},propToCol:e=>this.tableProps.propToCol(e),keepDirection:!0}),i=this.settings.navigableHeaders,o={countRows:this.tableProps.countRows(),countCols:this.tableProps.countCols(),countRowHeaders:i?this.tableProps.countRowHeaders():0,countColHeaders:i?this.tableProps.countColHeaders():0},s=!e.some((e=>{const t=r(e),n=t.isValid(o);return!(n&&!t.containsHeaders()||n&&t.containsHeaders()&&t.isSingleHeader())}));return s&&(this.clear(),this.setExpectedLayers(e.length),Vd(e,(e=>{const{from:t,to:n}=r(e);this.setRangeStartOnly(t.clone(),!1),this.setRangeEnd(n.clone())})),this.finish()),s}selectColumns(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const r="string"==typeof e?this.tableProps.propToCol(e):e,i="string"==typeof t?this.tableProps.propToCol(t):t,o=this.tableProps.countRows(),s=this.tableProps.countCols(),a=this.tableProps.countColHeaders(),l=0===a?0:-a,h=this.tableProps.createCellCoords(l,r),u=this.tableProps.createCellCoords(o-1,i),c=this.tableProps.createCellRange(h,h,u).isValid({countRows:o,countCols:s,countRowHeaders:0,countColHeaders:a});if(c){let e=0,t=0;Number.isInteger(null==n?void 0:n.row)&&Number.isInteger(null==n?void 0:n.col)?(e=ny(n.row,l,o-1),t=ny(n.col,Math.min(r,i),Math.max(r,i))):(e=ny(n,l,o-1),t=r);const s=this.tableProps.createCellCoords(e,t),h=0===a?0:ny(s.row,l,-1),u=o-1,c=this.tableProps.createCellCoords(h,r),d=this.tableProps.createCellCoords(u,i);this.runLocalHooks("beforeSelectColumns",c,d,s),c.row=h,d.row=u,this.setRangeStartOnly(c,void 0,s),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(d),this.runLocalHooks("afterSelectColumns",c,d,s),this.finish()}return c}selectRows(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const r=this.tableProps.countRows(),i=this.tableProps.countCols(),o=this.tableProps.countRowHeaders(),s=0===o?0:-o,a=this.tableProps.createCellCoords(e,s),l=this.tableProps.createCellCoords(t,i-1),h=this.tableProps.createCellRange(a,a,l).isValid({countRows:r,countCols:i,countRowHeaders:o,countColHeaders:0});if(h){let r=0,a=0;Number.isInteger(null==n?void 0:n.row)&&Number.isInteger(null==n?void 0:n.col)?(r=ny(n.row,Math.min(e,t),Math.max(e,t)),a=ny(n.col,s,i-1)):(r=e,a=ny(n,s,i-1));const l=this.tableProps.createCellCoords(r,a),h=0===o?0:ny(l.col,s,-1),u=i-1,c=this.tableProps.createCellCoords(e,h),d=this.tableProps.createCellCoords(t,u);this.runLocalHooks("beforeSelectRows",c,d,l),c.col=h,d.col=u,this.setRangeStartOnly(c,void 0,l),this.selectedByRowHeader.add(this.getLayerLevel()),this.setRangeEnd(d),this.runLocalHooks("afterSelectRows",c,d,l),this.finish()}return h}refresh(){if(!this.isSelected())return;const e=this.tableProps.countRows(),t=this.tableProps.countCols();if(0===e||0===t)return void this.deselect();const n=this.selectedRange.peekByIndex(this.selectedRange.size()-1),{from:r,to:i,highlight:o}=n;this.clear(),o.assign({row:ny(o.row,-1/0,e-1),col:ny(o.col,-1/0,t-1)}),r.assign({row:ny(r.row,-1/0,e-1),col:ny(r.col,-1/0,t-1)}),i.assign({row:ny(i.row,0,e-1),col:ny(i.col,0,t-1)}),this.selectedRange.ranges.push(n),this.highlight.getFocus().add(o).commit().syncWith(n),this.applyAndCommit(n)}commit(){if(this.highlight.getCustomSelections().forEach((e=>{e.commit()})),!this.isSelected())return;const e=this.getLayerLevel(),t=this.selectedRange.current();this.highlight.isEnabledFor(bS,t.highlight)&&this.highlight.getFocus().commit().syncWith(t);for(let n=0;n<this.selectedRange.size();n+=1){this.highlight.useLayerLevel(n);const e=this.highlight.createArea(),t=this.highlight.createLayeredArea(),r=this.highlight.createRowHeader(),i=this.highlight.createColumnHeader(),o=this.highlight.createActiveRowHeader(),s=this.highlight.createActiveColumnHeader(),a=this.highlight.createActiveCornerHeader(),l=this.highlight.createRowHighlight(),h=this.highlight.createColumnHighlight();e.commit(),t.commit(),r.commit(),i.commit(),o.commit(),s.commit(),a.commit(),l.commit(),h.commit()}this.highlight.useLayerLevel(e)}}om(hA,yS);const uA=hA,cA=/^(\r\n|\n\r|\r|\n)/,dA=/^[^\t\r\n]+/,pA=/^\t/;function gA(e){let t,n,r,i,o,s="";for(t=0,n=e.length;t<n;t+=1){for(i=e[t].length,r=0;r<i;r+=1)r>0&&(s+="\t"),o=e[t][r],"string"==typeof o?o.indexOf("\n")>-1?s+=`"${o.replace(/"/g,'""')}"`:s+=o:s+=null==o?"":o;t!==n-1&&(s+="\n")}return s}function mA(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class fA{static get DESTINATION_RENDERER(){return 1}static get DESTINATION_CLIPBOARD_GENERATOR(){return 2}constructor(e,t,n){mA(this,"hot",void 0),mA(this,"metaManager",void 0),mA(this,"tableMeta",void 0),mA(this,"dataSource",void 0),mA(this,"duckSchema",void 0),mA(this,"colToPropCache",void 0),mA(this,"propToColCache",void 0),this.hot=e,this.metaManager=n,this.tableMeta=n.getTableMeta(),this.dataSource=t,this.refreshDuckSchema(),this.createMap()}createMap(){const e=this.getSchema();if(void 0===e)throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");const t=this.tableMeta.columns;let n;if(this.colToPropCache=[],this.propToColCache=new Map,t){let r=0,i=0,o=!1;if("function"==typeof t){const t=cm(e);r=t>0?t:this.countFirstRowKeys(),o=!0}else{const e=this.tableMeta.maxCols;r=Math.min(e,t.length)}for(n=0;n<r;n++){const e=o?t(n):t[n];if(am(e)){if(void 0!==e.data){const t=o?i:n;this.colToPropCache[t]=e.data,this.propToColCache.set(e.data,t)}i+=1}}}else this.recursiveDuckColumns(e)}countFirstRowKeys(){return TE(this.dataSource)}recursiveDuckColumns(e,t,n){let r,i=t,o=n;return void 0===i&&(i=0,o=""),"object"!=typeof e||Array.isArray(e)||hm(e,((e,t)=>{null===e?(r=o+t,this.colToPropCache.push(r),this.propToColCache.set(r,i),i+=1):i=this.recursiveDuckColumns(e,i,`${t}.`)})),i}colToProp(e){if(!1===Number.isInteger(e))return e;const t=this.hot.toPhysicalColumn(e);return null===t?e:this.colToPropCache&&Gd(this.colToPropCache[t])?this.colToPropCache[t]:t}propToCol(e){const t=this.propToColCache.get(e);if(Gd(t))return this.hot.toVisualColumn(t);const n=this.hot.toVisualColumn(e);return null===n?e:n}getSchema(){const e=this.tableMeta.dataSchema;return e?"function"==typeof e?e():e:this.duckSchema}createDuckSchema(){return this.dataSource&&this.dataSource[0]?em(this.dataSource[0]):{}}refreshDuckSchema(){this.duckSchema=this.createDuckSchema()}createRow(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,{source:n,mode:r="above"}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i=this.hot.countSourceRows();let o=i,s=0,a=e;("number"!=typeof a||a>=i)&&(a=i),a<this.hot.countRows()&&(o=this.hot.toPhysicalRow(a));if(!1===this.hot.runHooks("beforeCreateRow",a,t,n)||null===o)return{delta:0};const l=this.tableMeta.maxRows,h=this.getSchema().length,u=[];for(;s<t&&i+s<l;){let e=null;"array"===this.hot.dataType?this.tableMeta.dataSchema?e=rm(this.getSchema()):(e=[],Jw(h-1,(()=>e.push(null)))):"function"===this.hot.dataType?e=this.tableMeta.dataSchema(a+s):(e={},nm(e,this.getSchema())),u.push(e),s+=1}this.hot.rowIndexMapper.insertIndexes(a,s),"below"===r&&(o=Math.min(o+1,i)),this.spliceData(o,0,u);const c=this.hot.toVisualRow(o);return this.hot.countSourceRows()===u.length&&this.hot.columnIndexMapper.initToLength(this.hot.getInitialColumnCount()),s>0&&(null==e?this.metaManager.createRow(null,s):"auto"!==n&&this.metaManager.createRow(o,t)),this.hot.runHooks("afterCreateRow",c,s,n),this.hot.forceFullRender=!0,{delta:s,startPhysicalIndex:o}}createCol(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,{source:n,mode:r="start"}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!this.hot.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");const i=this.dataSource,o=this.tableMeta.maxCols,s=this.hot.countSourceCols();let a=e;("number"!=typeof a||a>=s)&&(a=s);if(!1===this.hot.runHooks("beforeCreateCol",a,t,n))return{delta:0};let l=s;a<this.hot.countCols()&&(l=this.hot.toPhysicalColumn(a));const h=this.hot.countSourceRows();let u=this.hot.countCols(),c=0,d=l;"end"===r&&(d=Math.min(d+1,s));const p=d;for(;c<t&&u<o;){if("number"!=typeof a||a>=u)if(h>0)for(let e=0;e<h;e+=1)void 0===i[e]&&(i[e]=[]),i[e].push(null);else i.push([null]);else for(let e=0;e<h;e++)i[e].splice(d,0,null);c+=1,d+=1,u+=1}this.hot.columnIndexMapper.insertIndexes(a,c),c>0&&(null==e?this.metaManager.createColumn(null,c):"auto"!==n&&this.metaManager.createColumn(p,t));const g=this.hot.toVisualColumn(p);return this.hot.runHooks("afterCreateCol",g,c,n),this.hot.forceFullRender=!0,this.refreshDuckSchema(),{delta:c,startPhysicalIndex:p}}removeRow(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0,r=Number.isInteger(e)?e:-t;const i=this.visualRowsToPhysical(r,t),o=this.hot.countSourceRows();r=(o+r)%o;if(!1===this.hot.runHooks("beforeRemoveRow",r,i.length,i,n))return!1;const s=i.length;if(this.filterData(r,s,i),r<this.hot.countRows()){this.hot.rowIndexMapper.removeIndexes(i);const e=Gd(this.tableMeta.columns)||Gd(this.tableMeta.dataSchema)||this.tableMeta.colHeaders;0!==this.hot.rowIndexMapper.getNotTrimmedIndexesLength()||e||this.hot.columnIndexMapper.setIndexesSequence([])}return i.slice(0).sort(((e,t)=>t-e)).forEach((e=>{this.metaManager.removeRow(e,1)})),this.hot.runHooks("afterRemoveRow",r,s,i,n),this.hot.forceFullRender=!0,!0}removeCol(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0;if("object"===this.hot.dataType||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");let r="number"!=typeof e?-t:e;r=(this.hot.countCols()+r)%this.hot.countCols();const i=this.visualColumnsToPhysical(r,t),o=i.slice(0).sort(((e,t)=>t-e));if(!1===this.hot.runHooks("beforeRemoveCol",r,t,i,n))return!1;let s=!0;const a=o.length,l=this.dataSource;for(let h=0;h<a;h++)s&&i[0]!==i[h]-h&&(s=!1);if(s)for(let h=0,u=this.hot.countSourceRows();h<u;h++)l[h].splice(i[0],t),0===h&&this.metaManager.removeColumn(i[0],t);else for(let h=0,u=this.hot.countSourceRows();h<u;h++)for(let e=0;e<a;e++)l[h].splice(o[e],1),0===h&&this.metaManager.removeColumn(o[e],1);return r<this.hot.countCols()&&(this.hot.columnIndexMapper.removeIndexes(i),this.tableMeta.rowHeaders||0!==this.hot.columnIndexMapper.getNotTrimmedIndexesLength()||this.hot.rowIndexMapper.setIndexesSequence([])),this.hot.runHooks("afterRemoveCol",r,t,i,n),this.hot.forceFullRender=!0,this.refreshDuckSchema(),!0}spliceCol(e,t,n){const r=this.hot.getDataAtCol(e),i=r.slice(t,t+n),o=r.slice(t+n);for(var s=arguments.length,a=new Array(s>3?s-3:0),l=3;l<s;l++)a[l-3]=arguments[l];Ld(a,o);let h=0;for(;h<n;)a.push(null),h+=1;return function(e){const t=e.length;let n=0;for(;n<t;)e[n]=[e[n]],n+=1}(a),this.hot.populateFromArray(t,e,a,null,null,"spliceCol"),i}spliceRow(e,t,n){const r=this.hot.getSourceDataAtRow(e),i=r.slice(t,t+n),o=r.slice(t+n);for(var s=arguments.length,a=new Array(s>3?s-3:0),l=3;l<s;l++)a[l-3]=arguments[l];Ld(a,o);let h=0;for(;h<n;)a.push(null),h+=1;return this.hot.populateFromArray(e,t,[a],null,null,"spliceRow"),i}spliceData(e,t,n){if(!1!==this.hot.runHooks("beforeDataSplice",e,t,n)){const t=[...this.dataSource.slice(0,e),...n,...this.dataSource.slice(e)];this.dataSource.length=0,t.forEach((e=>this.dataSource.push(e)))}}filterData(e,t,n){let r=this.hot.runHooks("filterData",e,t,n);!1===Array.isArray(r)&&(r=this.dataSource.filter(((e,t)=>-1===n.indexOf(t)))),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,r)}get(e,t){const n=this.hot.toPhysicalRow(e);let r=this.dataSource[n];const i=this.hot.runHooks("modifyRowData",n);r=isNaN(i)?i:r;const{dataDotNotation:o}=this.hot.getSettings();let s=null;if(r&&r.hasOwnProperty&&pm(r,t))s=r[t];else if(o&&"string"==typeof t&&t.indexOf(".")>-1){let e=r;if(!e)return null;const n=t.split(".");for(let t=0,r=n.length;t<r;t++)if(e=e[n[t]],void 0===e)return null;s=e}else"function"==typeof t&&(s=t(this.dataSource.slice(n,n+1)[0]));if(this.hot.hasHook("modifyData")){const e=dm(s);this.hot.runHooks("modifyData",n,this.propToCol(t),e,"get"),e.isTouched()&&(s=e.value)}return s}getCopyable(e,t){return this.hot.getCellMeta(e,this.propToCol(t)).copyable?this.get(e,t):""}set(e,t,n){const r=this.hot.toPhysicalRow(e);let i=n,o=this.dataSource[r];const s=this.hot.runHooks("modifyRowData",r);if(o=isNaN(s)?s:o,this.hot.hasHook("modifyData")){const e=dm(i);this.hot.runHooks("modifyData",r,this.propToCol(t),e,"set"),e.isTouched()&&(i=e.value)}const{dataDotNotation:a}=this.hot.getSettings();if(o&&o.hasOwnProperty&&pm(o,t))o[t]=i;else if(a&&"string"==typeof t&&t.indexOf(".")>-1){let e,n=o,r=0;const s=t.split(".");for(r=0,e=s.length-1;r<e;r++){if("__proto__"===s[r]||"constructor"===s[r]||"prototype"===s[r])return;void 0===n[s[r]]&&(n[s[r]]={}),n=n[s[r]]}n[s[r]]=i}else if("function"==typeof t)t(this.dataSource.slice(r,r+1)[0],i);else{if("__proto__"===t||"constructor"===t||"prototype"===t)return;o[t]=i}}visualRowsToPhysical(e,t){const n=this.hot.countSourceRows(),r=[];let i,o=(n+e)%n,s=t;for(;o<n&&s;)i=this.hot.toPhysicalRow(o),r.push(i),s-=1,o+=1;return r}visualColumnsToPhysical(e,t){const n=this.hot.countCols(),r=[];let i=(n+e)%n,o=t;for(;i<n&&o;){const e=this.hot.toPhysicalColumn(i);r.push(e),o-=1,i+=1}return r}clear(){for(let e=0;e<this.hot.countSourceRows();e++)for(let t=0;t<this.hot.countCols();t++)this.set(e,this.colToProp(t),"")}getLength(){const e=this.tableMeta.maxRows;let t;t=e<0||0===e?0:e||1/0;const n=this.hot.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(n,t)}getAll(){const e={row:0,col:0},t={row:Math.max(this.hot.countRows()-1,0),col:Math.max(this.hot.countCols()-1,0)};return e.row-t.row!=0||this.hot.countSourceRows()?this.getRange(e,t,fA.DESTINATION_RENDERER):[]}countCachedColumns(){return this.colToPropCache.length}getRange(e,t,n){const r=[];let i,o,s;const a=this.tableMeta.maxRows,l=this.tableMeta.maxCols;if(0===a||0===l)return[];const h=n===fA.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,u=Math.min(Math.max(a-1,0),Math.max(e.row,t.row)),c=Math.min(Math.max(l-1,0),Math.max(e.col,t.col));for(i=Math.min(e.row,t.row);i<=u;i++){s=[];const n=i>=0?this.hot.toPhysicalRow(i):i;for(o=Math.min(e.col,t.col);o<=c&&null!==n;o++)s.push(h.call(this,i,this.colToProp(o)));null!==n&&r.push(s)}return r}getText(e,t){return gA(this.getRange(e,t,fA.DESTINATION_RENDERER))}getCopyableText(e,t){return gA(this.getRange(e,t,fA.DESTINATION_CLIPBOARD_GENERATOR))}destroy(){this.hot=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}const wA=fA,{register:yA,getItem:vA,hasItem:CA,getNames:SA,getValues:RA}=Tf("cellTypes");function EA(e,t){"string"!=typeof e&&(e=(t=e).CELL_TYPE);const{editor:n,renderer:r,validator:i}=t;n&&Hf(e,n),r&&Ey(e,r),i&&Iy(e,i),yA(e,t)}function bA(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e;const r="string"==typeof t.type?function(e){if(!CA(e))throw Error(`You declared cell type "${e}" as a string that is not mapped to a known object.\n                 Cell type must be an object or a string mapped to an object registered by\n                 "Handsontable.cellTypes.registerCellType" method`);return vA(e)}(t.type):t.type;if(e._automaticallyAssignedMetaProps&&hm(t,((t,n)=>{e._automaticallyAssignedMetaProps.delete(n)})),!am(r))return;n!==e||e._automaticallyAssignedMetaProps||(e._automaticallyAssignedMetaProps=new Set);const i={};hm(r,((t,r)=>{var o;(function(e,t){var n;return"CELL_TYPE"!==e&&((null===(n=t._automaticallyAssignedMetaProps)||void 0===n?void 0:n.has(e))||!pm(t,e))})(r,n)&&(i[r]=t,null===(o=e._automaticallyAssignedMetaProps)||void 0===o||o.add(r))})),tm(e,i)}function TA(e){return Number.isInteger(e)&&e>=0}function NA(e,t){if(!e())throw new Error(`Assertion failed: ${t}`)}function AA(e){return null==e}const MA=()=>({_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,ariaTags:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataDotNotation:!0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",timeFormat:"h:mm:ss a",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,headerClassName:void 0,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",imeFastEdit:!1,isEmptyCol(e){let t,n,r;for(t=0,n=this.countRows();t<n;t++)if(r=this.getDataAtCell(t,e),!1===$d(r))return!1;return!0},isEmptyRow(e){let t,n,r,i;for(t=0,n=this.countCols();t<n;t++)if(r=this.getDataAtCell(e,t),!1===$d(r))return"object"==typeof r&&(i=this.getCellMeta(e,t),sm(this.getSchema()[i.prop],r));return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,navigableHeaders:!1,tabNavigation:!0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:!1,renderAllColumns:!1,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,themeName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:!0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",viewportColumnRenderingThreshold:0,viewportRowRenderingThreshold:0,visibleRows:10,width:void 0,wordWrap:!0});function IA(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class OA{constructor(e){IA(this,"metaCtor",class{}),IA(this,"meta",void 0),this.meta=this.metaCtor.prototype,tm(this.meta,MA()),this.meta.instance=e}getMetaConstructor(){return this.metaCtor}getMeta(){return this.meta}updateMeta(e){var t;tm(this.meta,e),bA(this.meta,{...e,type:null!==(t=e.type)&&void 0!==t?t:this.meta.type},e)}}function xA(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class PA{constructor(e){xA(this,"meta",void 0);const t=e.getMetaConstructor();this.meta=new t}getMeta(){return this.meta}updateMeta(e){tm(this.meta,e),bA(this.meta,e,e)}}function _A(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class LA{constructor(e){_A(this,"valueFactory",void 0),_A(this,"data",[]),_A(this,"index",[]),_A(this,"holes",new Set),this.valueFactory=e}obtain(e){NA((()=>TA(e)),"Expecting an unsigned number.");const t=this._getStorageIndexByKey(e);let n;if(t>=0)n=this.data[t],void 0===n&&(n=this.valueFactory(e),this.data[t]=n);else if(n=this.valueFactory(e),this.holes.size>0){const t=this.holes.values().next().value;this.holes.delete(t),this.data[t]=n,this.index[e]=t}else this.data.push(n),this.index[e]=this.data.length-1;return n}insert(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;NA((()=>TA(e)||AA(e)),"Expecting an unsigned number or null/undefined argument.");const n=[],r=this.data.length;for(let o=0;o<t;o++)n.push(r+o),this.data.push(void 0);const i=AA(e)?this.index.length:e;this.index=[...this.index.slice(0,i),...n,...this.index.slice(i)]}remove(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;NA((()=>TA(e)||AA(e)),"Expecting an unsigned number or null/undefined argument.");const n=this.index.splice(AA(e)?this.index.length-t:e,t);for(let r=0;r<n.length;r++){const e=n[r];"number"==typeof e&&this.holes.add(e)}}size(){return this.data.length-this.holes.size}values(){return this.data.filter(((e,t)=>void 0!==e&&!this.holes.has(t)))[Symbol.iterator]()}entries(){const e=[];for(let n=0;n<this.data.length;n++){const t=this._getKeyByStorageIndex(n);-1!==t&&void 0!==this.data[n]&&e.push([t,this.data[n]])}let t=0;return{next:()=>{if(t<e.length){const n=e[t];return t+=1,{value:n,done:!1}}return{done:!0}}}}clear(){this.data=[],this.index=[],this.holes.clear()}_getStorageIndexByKey(e){return this.index.length>e?this.index[e]:-1}_getKeyByStorageIndex(e){return this.index.indexOf(e)}[Symbol.iterator](){return this.entries()}}function HA(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const kA=["data","width"];class FA{constructor(e){HA(this,"globalMeta",void 0),HA(this,"metas",new LA((()=>this._createMeta()))),this.globalMeta=e,this.metas=new LA((()=>this._createMeta()))}updateMeta(e,t){const n=this.getMeta(e);tm(n,t),bA(n,t)}createColumn(e,t){this.metas.insert(e,t)}removeColumn(e,t){this.metas.remove(e,t)}getMeta(e){return this.metas.obtain(e)}getMetaConstructor(e){return this.metas.obtain(e).constructor}clearCache(){this.metas.clear()}_createMeta(){return function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];function n(){}var r,i;r=n,(i=e).prototype.constructor=i,r.prototype=new i,r.prototype.constructor=r;for(let o=0;o<t.length;o++)n.prototype[t[o]]=void 0;return n}(this.globalMeta.getMetaConstructor(),kA).prototype}}function DA(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class VA{constructor(e){DA(this,"columnMeta",void 0),DA(this,"metas",new LA((()=>this._createRow()))),this.columnMeta=e}updateMeta(e,t,n){const r=this.getMeta(e,t);tm(r,n),bA(r,n)}createRow(e,t){this.metas.insert(e,t)}createColumn(e,t){for(let n=0;n<this.metas.size();n++)this.metas.obtain(n).insert(e,t)}removeRow(e,t){this.metas.remove(e,t)}removeColumn(e,t){for(let n=0;n<this.metas.size();n++)this.metas.obtain(n).remove(e,t)}getMeta(e,t,n){const r=this.metas.obtain(e).obtain(t);return void 0===n?r:r[n]}setMeta(e,t,n,r){var i;const o=this.metas.obtain(e).obtain(t);null===(i=o._automaticallyAssignedMetaProps)||void 0===i||i.delete(n),o[n]=r}removeMeta(e,t,n){delete this.metas.obtain(e).obtain(t)[n]}getMetas(){const e=[],t=Array.from(this.metas.values());for(let n=0;n<t.length;n++)Gd(t[n])&&e.push(...t[n].values());return e}getMetasAtRow(e){NA((()=>TA(e)),"Expecting an unsigned number.");const t=new Map(this.metas);return t.has(e)?Array.from(t.get(e).values()):[]}clearCache(){this.metas.clear()}_createRow(){return new LA((e=>this._createMeta(e)))}_createMeta(e){return new(this.columnMeta.getMetaConstructor(e))}}class UA{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];this.hot=e,this.globalMeta=new OA(e),this.tableMeta=new PA(this.globalMeta),this.columnMeta=new FA(this.globalMeta),this.cellMeta=new VA(this.columnMeta),n.forEach((e=>new e(this))),this.globalMeta.updateMeta(t)}getGlobalMeta(){return this.globalMeta.getMeta()}updateGlobalMeta(e){this.globalMeta.updateMeta(e)}getTableMeta(){return this.tableMeta.getMeta()}updateTableMeta(e){this.tableMeta.updateMeta(e)}getColumnMeta(e){return this.columnMeta.getMeta(e)}updateColumnMeta(e,t){this.columnMeta.updateMeta(e,t)}getCellMeta(e,t,n){let{visualRow:r,visualColumn:i}=n;const o=this.cellMeta.getMeta(e,t);return o.visualRow=r,o.visualCol=i,o.row=e,o.col=t,this.runLocalHooks("afterGetCellMeta",o),o}getCellMetaKeyValue(e,t,n){if("string"!=typeof n)throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(e,t,n)}setCellMeta(e,t,n,r){this.cellMeta.setMeta(e,t,n,r)}updateCellMeta(e,t,n){this.cellMeta.updateMeta(e,t,n)}removeCellMeta(e,t,n){this.cellMeta.removeMeta(e,t,n)}getCellsMeta(){return this.cellMeta.getMetas()}getCellsMetaAtRow(e){return this.cellMeta.getMetasAtRow(e)}createRow(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.createRow(e,t)}removeRow(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.removeRow(e,t)}createColumn(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.createColumn(e,t),this.columnMeta.createColumn(e,t)}removeColumn(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.removeColumn(e,t),this.columnMeta.removeColumn(e,t)}clearCellsCache(){this.cellMeta.clearCache()}clearCache(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}function BA(e,t,n,r){const{hotInstance:i,dataMap:o,dataSource:s,internalSource:a,source:l,metaManager:h,firstRun:u}=r,c=op(a),d=i.getSettings();Array.isArray(d.dataSchema)?i.dataType="array":Cg(d.dataSchema)?i.dataType="function":i.dataType="object",o&&o.destroy(),e=i.runHooks(`before${c}`,e,u,l);const p=new wA(i,e,h);if(t(p),"object"==typeof e&&null!==e)e.push&&e.splice||(e=[e]);else{if(null!==e)throw new Error(`${a} only accepts array of objects or array of arrays (${typeof e} given)`);{const t=p.getSchema();let n;e=[];let r=0,o=0;for(r=0,o=d.startRows;r<o;r++)if("object"!==i.dataType&&"function"!==i.dataType||!d.dataSchema)if("array"===i.dataType)n=rm(t[0]),e.push(n);else{n=[];for(let e=0,t=d.startCols;e<t;e++)n.push(null);e.push(n)}else n=rm(t),e.push(n)}}Array.isArray(e[0])&&(i.dataType="array"),d.data=e,p.dataSource=e,s.data=e,s.dataType=i.dataType,s.colToProp=p.colToProp.bind(p),s.propToCol=p.propToCol.bind(p),s.countCachedColumns=p.countCachedColumns.bind(p),n(p),i.runHooks(`after${c}`,e,u,l),u||(i.runHooks("afterChange",null,a),i.render()),i.getSettings().ariaTags&&Vp(i.rootElement,[wp(-1),yp(i.countCols()+(i.view?i.countRowHeaders():0))])}function WA(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}om(UA,yS);class jA{constructor(e){WA(this,"metaManager",void 0),WA(this,"metaSyncMemo",new Map),this.metaManager=e,e.addLocalHook("afterGetCellMeta",(e=>this.extendCellMeta(e))),Rf.getSingleton().add("beforeRender",(e=>{e&&this.metaSyncMemo.clear()}),this.metaManager.hot)}extendCellMeta(e){var t;const{row:n,col:r}=e;if(null!==(t=this.metaSyncMemo.get(n))&&void 0!==t&&t.has(r))return;const{visualRow:i,visualCol:o}=e,s=this.metaManager.hot,a=s.colToProp(o);e.prop=a,s.runHooks("beforeGetCellMeta",i,o,e);const l=pm(e,"type")?e.type:null;let h=Cg(e.cells)?e.cells(n,r,a):null;var u;l&&(h?h.type=null!==(u=h.type)&&void 0!==u?u:l:h={type:l});h&&this.metaManager.updateCellMeta(n,r,h),s.runHooks("afterGetCellMeta",i,o,e),this.metaSyncMemo.has(n)||this.metaSyncMemo.set(n,new Set),this.metaSyncMemo.get(n).add(r)}}function GA(e,t,n){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,n)}function zA(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function $A(e,t){return e.get(function(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}(e,t))}var YA=new WeakMap;class KA{constructor(e){zA(this,"metaManager",void 0),zA(this,"usageTracker",new Set),zA(this,"propDescriptors",new Map([["ariaTags",{initOnly:!0}],["fixedColumnsLeft",{target:"fixedColumnsStart",onChange(e){if(this.metaManager.hot.isRtl()&&"fixedColumnsLeft"===e)throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{initOnly:!0}],["renderAllColumns",{initOnly:!0}],["renderAllRows",{initOnly:!0}]])),GA(this,YA,((e,t,n)=>{if(!n)throw new Error(`The \`${e}\` option can not be updated after the Handsontable is initialized.`)})),this.metaManager=e,this.extendMetaProps()}extendMetaProps(){this.propDescriptors.forEach(((e,t)=>{const{initOnly:n,target:r,onChange:i}=e,o="string"==typeof r,s=o?r:t,a=`_${s}`;this.metaManager.globalMeta.meta[a]=this.metaManager.globalMeta.meta[s],i?(this.installPropWatcher(t,a,i),o&&this.installPropWatcher(r,a,i)):n&&(this.installPropWatcher(t,a,$A(YA,this)),this.metaManager.globalMeta.meta._initOnlySettings||(this.metaManager.globalMeta.meta._initOnlySettings=[]),this.metaManager.globalMeta.meta._initOnlySettings.push(t))}))}installPropWatcher(e,t,n){const r=this;Object.defineProperty(this.metaManager.globalMeta.meta,e,{get(){return this[t]},set(i){const o=!r.usageTracker.has(e);r.usageTracker.add(e),n.call(r,e,i,o),this[t]=i},enumerable:!0,configurable:!0})}}const XA="gridDefault",qA="editorManager.handlingEditor",QA={name:"editorCloseAndSave",callback(e){e._getEditorManager().closeEditorAndSaveChanges()}},ZA={_hooksStorage:Object.create(null),addHook(e,t){return this._hooksStorage[e]||(this._hooksStorage[e]=[]),this.hot.addHook(e,t),this._hooksStorage[e].push(t),this},removeHooksByKey(e){Vd(this._hooksStorage[e]||[],(t=>{this.hot.removeHook(e,t)}))},clearHooks(){hm(this._hooksStorage,((e,t)=>this.removeHooksByKey(t))),this._hooksStorage={}}};lm(ZA,"MIXIN_NAME","hooksRefRegisterer",{writable:!1,enumerable:!1});const JA=ZA;function eM(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const tM=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"});class nM{static get EDITOR_TYPE(){return"base"}constructor(e){eM(this,"hot",void 0),eM(this,"state",tM.VIRGIN),eM(this,"_opened",!1),eM(this,"_fullEditMode",!1),eM(this,"_closeCallback",null),eM(this,"TD",null),eM(this,"row",null),eM(this,"col",null),eM(this,"prop",null),eM(this,"originalValue",null),eM(this,"cellProperties",null),this.hot=e,this.init()}_fireCallbacks(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)}init(){}getValue(){throw Error("Editor getValue() method unimplemented")}setValue(){throw Error("Editor setValue() method unimplemented")}open(){throw Error("Editor open() method unimplemented")}close(){throw Error("Editor close() method unimplemented")}prepare(e,t,n,r,i,o){this.TD=r,this.row=e,this.col=t,this.prop=n,this.originalValue=i,this.cellProperties=o,this.state=this.isOpened()?this.state:tM.VIRGIN}extend(){return class extends this.constructor{}}saveValue(e,t){let n,r,i,o;if(t){const e=this.hot.getSelectedLast();n=Math.max(Math.min(e[0],e[2]),0),r=Math.max(Math.min(e[1],e[3]),0),i=Math.max(e[0],e[2]),o=Math.max(e[1],e[3])}else[n,r,i,o]=[this.row,this.col,null,null];const s=this.hot.runHooks("modifyGetCellCoords",n,r,!1,"meta");Array.isArray(s)&&([n,r]=s),this.hot.populateFromArray(n,r,e,i,o,"edit")}beginEditing(e,t){if(this.state!==tM.VIRGIN)return;const n=this.hot,r=n.rowIndexMapper.getRenderableFromVisualIndex(this.row),i=n.columnIndexMapper.getRenderableFromVisualIndex(this.col),o=()=>{if(this.state=tM.EDITING,this.isInFullEditMode()){const t="string"==typeof e?e:jd(this.originalValue);this.setValue(t)}this.open(t),this._opened=!0,this.focus(),n.view.render(),n.runHooks("afterBeginEditing",this.row,this.col)};this.hot.addHookOnce("afterScroll",o);n.view.scrollViewport(n._createCellCoords(r,i))||(this.hot.removeHook("afterScroll",o),o())}finishEditing(e,t,n){let r;if(n){const e=this._closeCallback;this._closeCallback=t=>{e&&e(t),n(t),this.hot.view.render()}}if(!this.isWaiting())if(this.state!==tM.VIRGIN){if(this.state===tM.EDITING){if(e)return this.cancelChanges(),void this.hot.view.render();const n=this.getValue();r=this.cellProperties.trimWhitespace?[["string"==typeof n?String.prototype.trim.call(n||""):n]]:[[n]],this.state=tM.WAITING,this.saveValue(r,t),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",(e=>{this.state=tM.FINISHED,this.discardEditor(e)})):(this.state=tM.FINISHED,this.discardEditor(!0))}}else this.hot._registerTimeout((()=>{this._fireCallbacks(!0)}))}cancelChanges(){this.state=tM.FINISHED,this.discardEditor()}discardEditor(e){if(this.state===tM.FINISHED)if(!1===e&&!0!==this.cellProperties.allowInvalid)this.hot.selectCell(this.row,this.col),this.focus(),this.state=tM.EDITING,this._fireCallbacks(!1);else{this.close(),this._opened=!1,this._fullEditMode=!1,this.state=tM.VIRGIN,this._fireCallbacks(!0);this.hot.getShortcutManager().setActiveContextName("grid")}}enableFullEditMode(){this._fullEditMode=!0}isInFullEditMode(){return this._fullEditMode}isOpened(){return this._opened}isWaiting(){return this.state===tM.WAITING}getEditedCellRect(){var e;const t=this.getEditedCell();if(!t)return;const{wtOverlays:n,wtViewport:r}=this.hot.view._wt,i=this.hot.rootWindow,o=Yp(t),s=tg(t),a=Yp(this.hot.rootElement),l=tg(this.hot.rootElement),h=n.topOverlay.holder,u=n.inlineStartOverlay.holder,c=h!==i?h.scrollTop:0,d=u!==i?u.scrollLeft:0,p=i.innerWidth-a.left-l,{wtTable:g}=null!==(e=n.getParentOverlay(t))&&void 0!==e?e:this.hot.view._wt,m=g.name,f=["master","inline_start"].includes(m)?c:0,w=["master","top","bottom"].includes(m)?d:0,y=o.top===a.top?0:1;let v=o.top-a.top-y-f,C=0;C=this.hot.isRtl()?i.innerWidth-o.left-s-p-1+w:o.left-a.left-1-w,["top","top_inline_start_corner"].includes(m)&&(v+=n.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(m)&&(C+=Math.abs(n.inlineStartOverlay.getOverlayOffset()));const S=this.hot.hasColHeaders(),R=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),E=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),b=this.hot.rowIndexMapper.getRenderableIndexesLength()-this.hot.view._wt.getSetting("fixedRowsBottom");(S&&R<=0||R===b)&&(v+=1),E<=0&&(C+=1);const T=r.rowsRenderCalculator.startPosition,N=r.columnsRenderCalculator.startPosition,A=Math.abs(n.inlineStartOverlay.getScrollPosition()),M=n.topOverlay.getScrollPosition(),I=hg(this.hot.rootDocument);let O=t.offsetTop;if(["inline_start","master"].includes(m)&&(O+=T-M),["bottom","bottom_inline_start_corner"].includes(m)){const{wtViewport:e,wtTable:t}=n.bottomOverlay.clone;O+=e.getWorkspaceHeight()-t.getHeight()-I}let x=t.offsetLeft;this.hot.isRtl()?(x=x>=0?g.getWidth()-t.offsetLeft:Math.abs(x),x+=N-A-s):["top","master","bottom"].includes(m)&&(x+=N-A);const P=i.getComputedStyle(this.TD),_=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",L=parseInt(P[_],10)>0?0:1,H=parseInt(P.borderTopWidth,10)>0?0:1,k=tg(t)+L,F=ng(t)+H,D=ug(h)?I:0,V=cg(u)?I:0,U=this.hot.view.maximumVisibleElementWidth(x)-D+L;return{top:v,start:C,height:F,maxHeight:Math.max(this.hot.view.maximumVisibleElementHeight(O)-V+H,this.hot.view.getDefaultRowHeight()),width:k,maxWidth:U}}getEditedCellsLayerClass(){switch(this.checkEditorSection()){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}getEditedCell(){return this.hot.getCell(this.row,this.col,!0)}checkEditorSection(){const e=this.hot.countRows();let t="";return this.row<this.hot.getSettings().fixedRowsTop?t=this.col<this.hot.getSettings().fixedColumnsStart?"top-inline-start-corner":"top":this.hot.getSettings().fixedRowsBottom&&this.row>=e-this.hot.getSettings().fixedRowsBottom?t=this.col<this.hot.getSettings().fixedColumnsStart?"bottom-inline-start-corner":"bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(t="inline-start"),t}}om(nM,JA);const rM={name:"editorCloseAndSaveByArrowKeys",callback(e,t,n){const r=e._getEditorManager(),i=r.getActiveEditor();i.isInFullEditMode()&&i.state===tM.EDITING||(r.closeEditorAndSaveChanges(),e.getSelected()&&(n.includes("arrowdown")?e.selection.transformStart(1,0):n.includes("arrowup")?e.selection.transformStart(-1,0):n.includes("arrowleft")?e.selection.transformStart(0,-1*e.getDirectionFactor()):n.includes("arrowright")&&e.selection.transformStart(0,e.getDirectionFactor())),t.preventDefault())}},iM={name:"editorOpen",callback(e,t,n){const r=e._getEditorManager(),i=e.getSelectedRangeLast(),{highlight:o}=i;if(e.selection.isMultiple()&&!i.isHeader()&&e.countRenderedCols()>0&&e.countRenderedRows()>0){const r=e.getSettings(),i="function"==typeof r.enterMoves?r.enterMoves(t):r.enterMoves;n.includes("shift")?e.selection.transformFocus(-i.row,-i.col):e.selection.transformFocus(i.row,i.col)}else o.isHeader()||(e.getSettings().enterBeginsEditing?r.cellProperties.readOnly?r.moveSelectionAfterEnter(t):r.openEditor(null,t,!0):r.moveSelectionAfterEnter(t),_m(t))}};const oM=[QA,rM,{name:"editorCloseAndSaveByEnter",callback(e,t){const n=e._getEditorManager();n.closeEditorAndSaveChanges(t.ctrlKey||t.metaKey),n.moveSelectionAfterEnter(t)}},{name:"editorCloseWithoutSaving",callback(e){const t=e._getEditorManager();t.closeEditorAndRestoreOriginalValue(e.getShortcutManager().isCtrlPressed()),t.activeEditor.focus()}},{name:"editorFastOpen",callback(e,t){const{highlight:n}=e.getSelectedRangeLast();n.isHeader()||e._getEditorManager().openEditor(null,t,!0)}},iM,{name:"extendCellsSelectionDown",callback(e){const{highlight:t}=e.getSelectedRangeLast();e.selection.isSelectedByColumnHeader()||e.selection.isSelectedByCorner()||!(t.isCell()||t.isHeader()&&e.selection.isSelectedByRowHeader())||e.selection.transformEnd(1,0)}},{name:"extendCellsSelectionDownByViewportHeight",callback(e){const{to:t}=e.getSelectedRangeLast(),n=Math.min(t.row+e.countVisibleRows(),e.countRows()-1),r=e.rowIndexMapper.getNearestNotHiddenIndex(n,-1);if(null!==r){const n=e._createCellCoords(r,t.col),i=t.row-e.getFirstFullyVisibleRow(),o=Math.min(n.row-i,e.countRows()-1);e.selection.setRangeEnd(n),e.scrollViewportTo({row:o,verticalSnap:"top",horizontalSnap:"start"})}}},{name:"extendCellsSelectionLeft",callback(e){const{highlight:t}=e.getSelectedRangeLast();e.selection.isSelectedByRowHeader()||e.selection.isSelectedByCorner()||!(t.isCell()||t.isHeader()&&e.selection.isSelectedByColumnHeader())||e.selection.transformEnd(0,-1*e.getDirectionFactor())}},{name:"extendCellsSelectionRight",callback(e){const{highlight:t}=e.getSelectedRangeLast();e.selection.isSelectedByRowHeader()||e.selection.isSelectedByCorner()||!(t.isCell()||t.isHeader()&&e.selection.isSelectedByColumnHeader())||e.selection.transformEnd(0,e.getDirectionFactor())}},{name:"extendCellsSelectionToColumns",callback(e){const{highlight:t,from:n,to:r}=e.getSelectedRangeLast();e.selection.isSelectedByRowHeader()?e.selection.selectAll(!0,!0):e.selectColumns(n.col,r.col,t)}},{name:"extendCellsSelectionToMostBottom",callback(e){const{selection:t,rowIndexMapper:n}=e,{highlight:r,from:i,to:o}=e.getSelectedRangeLast(),s=r.isHeader()&&e.selection.isSelectedByRowHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(e.countRows()-1,-1),l=i.clone();l.row=r.row,t.setRangeStart(l,void 0,!1,r.clone()),s&&t.selectedByRowHeader.add(t.getLayerLevel()),t.setRangeEnd(e._createCellCoords(a,o.col))}}},{name:"extendCellsSelectionToMostInlineEnd",callback(e){const{selection:t,columnIndexMapper:n}=e,{highlight:r,from:i,to:o}=e.getSelectedRangeLast();if(!e.selection.isSelectedByRowHeader()&&!e.selection.isSelectedByCorner()&&r.isCell()){const s=n.getNearestNotHiddenIndex(e.countCols()-1,-1),a=i.clone();a.col=r.col,t.setRangeStart(a,void 0,!1,r.clone()),t.setRangeEnd(e._createCellCoords(o.row,s))}}},{name:"extendCellsSelectionToMostInlineStart",callback(e){const{selection:t,columnIndexMapper:n}=e,{highlight:r,from:i,to:o}=e.getSelectedRangeLast();if(!e.selection.isSelectedByRowHeader()&&!e.selection.isSelectedByCorner()&&r.isCell()){const s=parseInt(e.getSettings().fixedColumnsStart,10),a=n.getNearestNotHiddenIndex(s,1),l=i.clone();l.col=r.col,t.setRangeStart(l,void 0,!1,r.clone()),t.setRangeEnd(e._createCellCoords(o.row,a))}}},{name:"extendCellsSelectionToMostLeft",callback(e){const{selection:t,columnIndexMapper:n}=e,{highlight:r,from:i,to:o}=e.getSelectedRangeLast(),s=r.isHeader()&&e.selection.isSelectedByColumnHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(...e.isRtl()?[e.countCols()-1,-1]:[0,1]),l=i.clone();l.col=r.col,t.setRangeStart(l,void 0,!1,r.clone()),s&&t.selectedByColumnHeader.add(t.getLayerLevel()),t.setRangeEnd(e._createCellCoords(o.row,a))}}},{name:"extendCellsSelectionToMostRight",callback(e){const{selection:t,columnIndexMapper:n}=e,{highlight:r,from:i,to:o}=e.getSelectedRangeLast(),s=r.isHeader()&&e.selection.isSelectedByColumnHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(...e.isRtl()?[0,1]:[e.countCols()-1,-1]),l=i.clone();l.col=r.col,t.setRangeStart(l,void 0,!1,r.clone()),s&&t.selectedByColumnHeader.add(t.getLayerLevel()),t.setRangeEnd(e._createCellCoords(o.row,a))}}},{name:"extendCellsSelectionToMostTop",callback(e){const{selection:t,rowIndexMapper:n}=e,{highlight:r,from:i,to:o}=e.getSelectedRangeLast(),s=r.isHeader()&&e.selection.isSelectedByRowHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(0,1),l=i.clone();l.row=r.row,t.setRangeStart(l,void 0,!1,r.clone()),s&&t.selectedByRowHeader.add(t.getLayerLevel()),t.setRangeEnd(e._createCellCoords(a,o.col))}}},{name:"extendCellsSelectionToRows",callback(e){const{highlight:t,from:n,to:r}=e.getSelectedRangeLast();e.selection.isSelectedByColumnHeader()?e.selection.selectAll(!0,!0):e.selectRows(n.row,r.row,t)}},{name:"extendCellsSelectionUp",callback(e){const{highlight:t}=e.getSelectedRangeLast();e.selection.isSelectedByColumnHeader()||e.selection.isSelectedByCorner()||!(t.isCell()||t.isHeader()&&e.selection.isSelectedByRowHeader())||e.selection.transformEnd(-1,0)}},{name:"extendCellsSelectionUpByViewportHeight",callback(e){const{to:t}=e.getSelectedRangeLast(),n=Math.max(t.row-e.countVisibleRows(),0),r=e.rowIndexMapper.getNearestNotHiddenIndex(n,1);if(null!==r){const n=e._createCellCoords(r,t.col),i=t.row-e.getFirstFullyVisibleRow(),o=Math.max(n.row-i,0);e.selection.setRangeEnd(n),e.scrollViewportTo({row:o,verticalSnap:"top",horizontalSnap:"start"})}}},{name:"moveCellSelectionDown",callback(e){let{selection:t}=e;t.transformStart(1,0)}},{name:"moveCellSelectionDownByViewportHeight",callback(e){const{navigableHeaders:t}=e.getSettings(),n=t?e.countColHeaders():0,{row:r}=e.getSelectedRangeLast().highlight;let i=e.countVisibleRows()+n;i=0===i?1:i,r===e.countRows()-1?i=1:r+i>e.countRows()&&(i=e.countRows()-r-1),e.selection.transformStart(i,0),e.getSelectedRangeLast().highlight.row<0&&e.scrollViewportTo({row:0})}},{name:"moveCellSelectionInlineEnd",callback(e,t){const n=e.getSettings(),r=e.getSelectedRangeLast(),i="function"==typeof n.tabMoves?n.tabMoves(t):n.tabMoves;e.selection.isMultiple()&&!r.isHeader()&&e.countRenderedCols()>0&&e.countRenderedRows()>0?e.selection.transformFocus(-i.row,-i.col):e.selection.transformStart(-i.row,-i.col)}},{name:"moveCellSelectionInlineStart",callback(e,t){const n=e.getSettings(),r=e.getSelectedRangeLast(),i="function"==typeof n.tabMoves?n.tabMoves(t):n.tabMoves;e.selection.isMultiple()&&!r.isHeader()&&e.countRenderedCols()>0&&e.countRenderedRows()>0?e.selection.transformFocus(i.row,i.col):e.selection.transformStart(i.row,i.col)}},{name:"moveCellSelectionLeft",callback(e){e.selection.transformStart(0,-1*e.getDirectionFactor())}},{name:"moveCellSelectionRight",callback(e){e.selection.transformStart(0,e.getDirectionFactor())}},{name:"moveCellSelectionToMostBottom",callback(e){const{col:t}=e.getSelectedRangeLast().highlight;let n=e.rowIndexMapper.getNearestNotHiddenIndex(e.countRows()-1,-1);null===n&&(n=-1),e.selection.setRangeStart(e._createCellCoords(n,t))}},{name:"moveCellSelectionToMostBottomInlineEnd",callback(e){const{selection:t,rowIndexMapper:n,columnIndexMapper:r}=e,i=parseInt(e.getSettings().fixedRowsBottom,10),o=n.getNearestNotHiddenIndex(e.countRows()-i-1,-1),s=r.getNearestNotHiddenIndex(e.countCols()-1,-1);t.setRangeStart(e._createCellCoords(o,s))}},{name:"moveCellSelectionToMostInlineEnd",callback(e){const{selection:t,columnIndexMapper:n}=e;t.setRangeStart(e._createCellCoords(e.getSelectedRangeLast().highlight.row,n.getNearestNotHiddenIndex(e.countCols()-1,-1)))}},{name:"moveCellSelectionToMostInlineStart",callback(e){const{selection:t,columnIndexMapper:n}=e,r=parseInt(e.getSettings().fixedColumnsStart,10),i=e.getSelectedRangeLast().highlight.row,o=n.getNearestNotHiddenIndex(r,1);t.setRangeStart(e._createCellCoords(i,o))}},{name:"moveCellSelectionToMostLeft",callback(e){const{selection:t,columnIndexMapper:n}=e,r=e.getSelectedRangeLast().highlight.row;let i=n.getNearestNotHiddenIndex(...e.isRtl()?[e.countCols()-1,-1]:[0,1]);null===i&&(i=e.isRtl()?-1:-e.countRowHeaders()),t.setRangeStart(e._createCellCoords(r,i))}},{name:"moveCellSelectionToMostRight",callback(e){const{selection:t,columnIndexMapper:n}=e,{row:r}=e.getSelectedRangeLast().highlight;let i=n.getNearestNotHiddenIndex(...e.isRtl()?[0,1]:[e.countCols()-1,-1]);null===i&&(i=e.isRtl()?-e.countRowHeaders():-1),t.setRangeStart(e._createCellCoords(r,i))}},{name:"moveCellSelectionToMostTop",callback(e){const{col:t}=e.getSelectedRangeLast().highlight;let n=e.rowIndexMapper.getNearestNotHiddenIndex(0,1);null===n&&(n=-e.countColHeaders()),e.selection.setRangeStart(e._createCellCoords(n,t))}},{name:"moveCellSelectionToMostTopInlineStart",callback(e){const{selection:t,rowIndexMapper:n,columnIndexMapper:r}=e,i=parseInt(e.getSettings().fixedRowsTop,10),o=parseInt(e.getSettings().fixedColumnsStart,10),s=n.getNearestNotHiddenIndex(i,1),a=r.getNearestNotHiddenIndex(o,1);t.setRangeStart(e._createCellCoords(s,a))}},{name:"moveCellSelectionUp",callback(e){let{selection:t}=e;t.transformStart(-1,0)}},{name:"moveCellSelectionUpByViewportHight",callback(e){const{navigableHeaders:t}=e.getSettings(),n=t?e.countColHeaders():0,{row:r}=e.getSelectedRangeLast().highlight;let i=e.countVisibleRows()+n;i=0===i?-1:-i,r===-n?i=-1:r+i<n&&(i=-(r+n)),e.selection.transformStart(i,0),e.getSelectedRangeLast().highlight.row<0&&e.scrollViewportTo({row:0})}},{name:"emptySelectedCells",callback(e){e.emptySelectedCells(),e._getEditorManager().prepareEditor()}},{name:"scrollToFocusedCell",callback(e){const{highlight:t}=e.getSelectedRangeLast(),n=e.getFirstFullyVisibleRow()-1,r=e.getFirstFullyVisibleColumn()-1,i=e.getLastFullyVisibleRow()+1,o=e.getLastFullyVisibleColumn()+1,s=e._createCellCoords(n,r),a=e._createCellCoords(i,o);if(!e._createCellRange(s,s,a).includes(t)&&(t.row>=0||t.col>=0)){const n={};if(t.col>=0){const r=Math.floor(e.countVisibleCols()/2);n.col=Math.max(t.col-r,0)}if(t.row>=0){const r=Math.floor(e.countVisibleRows()/2);n.row=Math.max(t.row-r,0)}e.scrollViewportTo({...n,verticalSnap:"top",horizontalSnap:"start"})}}},{name:"selectAllCells",callback(e){e.selection.selectAll(!0,!0,{disableHeadersHighlight:!0})}},{name:"selectAllCellsAndHeaders",callback(e){e.selection.selectAll(!0,!0,{disableHeadersHighlight:!1})}},{name:"populateSelectedCellsData",callback(e){const t=e.getSelectedRange(),{row:n,col:r}=t[t.length-1].highlight.normalize(),i=e.getDataAtCell(n,r),o=new Map;for(let s=0;s<t.length;s++)t[s].forAll(((t,s)=>{if(t>=0&&s>=0&&(t!==n||s!==r)){const{readOnly:n}=e.getCellMeta(t,s);n||o.set(`${t}x${s}`,[t,s,i])}}));e.setDataAtCell(Array.from(o.values()))}}];function sM(e){const t={};return oM.forEach((n=>{let{name:r,callback:i}=n;t[r]=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return i(e,...n)}})),t}function aM(e){const t=e.getShortcutManager().addContext("editor"),n=sM(e),r={group:qA};t.addShortcuts([{keys:[["Enter"],["Enter","Shift"]],callback:(e,t)=>n.editorCloseAndSaveByEnter(e,t)},{keys:[["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],captureCtrl:!0,callback:(e,t)=>n.editorCloseAndSaveByEnter(e,t)},{keys:[["Tab"],["Tab","Shift"],["PageDown"],["PageUp"]],forwardToContext:e.getShortcutManager().getContext("grid"),callback:(e,t)=>n.editorCloseAndSave(e,t)},{keys:[["ArrowDown"],["ArrowUp"],["ArrowLeft"],["ArrowRight"]],preventDefault:!1,callback:(e,t)=>n.editorCloseAndSaveByArrowKeys(e,t)},{keys:[["Escape"],["Escape","Control/Meta"]],callback:()=>n.editorCloseWithoutSaving()}],r)}function lM(e){const t=e.getShortcutManager().addContext("grid"),n=sM(e),r={runOnlyIf:()=>{const{navigableHeaders:t}=e.getSettings();return Gd(e.getSelected())&&(t||!t&&e.countRenderedRows()>0&&e.countRenderedCols()>0)},group:XA};t.addShortcuts([{keys:[["F2"]],callback:e=>n.editorFastOpen(e)},{keys:[["Enter"],["Enter","Shift"]],callback:(e,t)=>n.editorOpen(e,t)},{keys:[["Backspace"],["Delete"]],callback:()=>n.emptySelectedCells()}],{group:qA,runOnlyIf:()=>Gd(e.getSelected())}),t.addShortcuts([{keys:[["Control/Meta","A"]],callback:()=>n.selectAllCells(),runOnlyIf:()=>{var t;return!(null!==(t=e.getSelectedRangeLast())&&void 0!==t&&t.highlight.isHeader())}},{keys:[["Control/Meta","A"]],callback:()=>{},runOnlyIf:()=>{var t;return null===(t=e.getSelectedRangeLast())||void 0===t?void 0:t.highlight.isHeader()},preventDefault:!0},{keys:[["Control/Meta","Shift","Space"]],callback:()=>n.selectAllCellsAndHeaders()},{keys:[["Control/Meta","Enter"]],callback:()=>n.populateSelectedCellsData(),runOnlyIf:()=>{var t,n;return!(null!==(t=e.getSelectedRangeLast())&&void 0!==t&&t.highlight.isHeader())&&(null===(n=e.getSelectedRangeLast())||void 0===n?void 0:n.getCellsCount())>1}},{keys:[["Control","Space"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToColumns()},{keys:[["Shift","Space"]],stopPropagation:!0,callback:()=>n.extendCellsSelectionToRows()},{keys:[["ArrowUp"]],callback:()=>n.moveCellSelectionUp()},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostTop()},{keys:[["ArrowUp","Shift"]],callback:()=>n.extendCellsSelectionUp()},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostTop(),runOnlyIf:()=>!(e.selection.isSelectedByCorner()||e.selection.isSelectedByColumnHeader())},{keys:[["ArrowDown"]],callback:()=>n.moveCellSelectionDown()},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostBottom()},{keys:[["ArrowDown","Shift"]],callback:()=>n.extendCellsSelectionDown()},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostBottom(),runOnlyIf:()=>!(e.selection.isSelectedByCorner()||e.selection.isSelectedByColumnHeader())},{keys:[["ArrowLeft"]],callback:()=>n.moveCellSelectionLeft()},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostLeft()},{keys:[["ArrowLeft","Shift"]],callback:()=>n.extendCellsSelectionLeft()},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostLeft(),runOnlyIf:()=>!(e.selection.isSelectedByCorner()||e.selection.isSelectedByRowHeader())},{keys:[["ArrowRight"]],callback:()=>n.moveCellSelectionRight()},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostRight()},{keys:[["ArrowRight","Shift"]],callback:()=>n.extendCellsSelectionRight()},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostRight(),runOnlyIf:()=>!(e.selection.isSelectedByCorner()||e.selection.isSelectedByRowHeader())},{keys:[["Home"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostInlineStart(),runOnlyIf:()=>e.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["Home","Shift"]],callback:()=>n.extendCellsSelectionToMostInlineStart()},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostTopInlineStart(),runOnlyIf:()=>e.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostInlineEnd(),runOnlyIf:()=>e.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End","Shift"]],callback:()=>n.extendCellsSelectionToMostInlineEnd()},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostBottomInlineEnd(),runOnlyIf:()=>e.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["PageUp"]],callback:()=>n.moveCellSelectionUpByViewportHight()},{keys:[["PageUp","Shift"]],callback:()=>n.extendCellsSelectionUpByViewportHeight()},{keys:[["PageDown"]],callback:()=>n.moveCellSelectionDownByViewportHeight()},{keys:[["PageDown","Shift"]],callback:()=>n.extendCellsSelectionDownByViewportHeight()},{keys:[["Tab"]],preventDefault:!1,callback:e=>n.moveCellSelectionInlineStart(e)},{keys:[["Shift","Tab"]],preventDefault:!1,callback:e=>n.moveCellSelectionInlineEnd(e)},{keys:[["Control/Meta","Backspace"]],callback:()=>n.scrollToFocusedCell()}],r)}function hM(e){const t=e.rootDocument.createElement("input");return t.type="text",t.name="__htFocusCatcher",t.classList.add("htFocusCatcher"),e.getSettings().ariaTags&&Vp(t,[dp(),mp()]),t}function uM(e){const t=function(e){return t=>{if(!t)return null;const n=cM(e),r=dM(e);return t.col<n.col&&(t.col=n.col),t.col>r.col&&(t.col=r.col),t.row<n.row&&(t.row=n.row),t.row>r.row&&(t.row=r.row),t}}(e);let n;const{activate:r,deactivate:i}=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=e.rootElement,r=hM(e),i=hM(e);return r.addEventListener("focus",(()=>null==t?void 0:t.onFocusFromTop())),i.addEventListener("focus",(()=>null==t?void 0:t.onFocusFromBottom())),n.firstChild.before(r),n.lastChild.after(i),{activate(){e._registerTimeout((()=>{r.tabIndex=0,i.tabIndex=0}),10)},deactivate(){e._registerTimeout((()=>{r.tabIndex=-1,i.tabIndex=-1}),10)}}}(e,{onFocusFromTop(){var r;const i=null!==(r=t(n))&&void 0!==r?r:cM(e);i&&(e.runHooks("modifyFocusOnTabNavigation","from_above",i),e.selectCell(i.row,i.col)),e.listen()},onFocusFromBottom(){var r;const i=null!==(r=t(n))&&void 0!==r?r:dM(e);i&&(e.runHooks("modifyFocusOnTabNavigation","from_below",i),e.selectCell(i.row,i.col)),e.listen()}}),o={wrapped:!1,flipped:!1};let s=!0,a=!1,l=!1;e.addHook("afterListen",(()=>i())),e.addHook("afterUnlisten",(()=>r())),e.addHook("afterSelection",((t,r,i,h,u)=>{var c;(a&&(o.wrapped&&o.flipped||l)&&(l=!1,u.value=!0),s)&&(n=null===(c=e.getSelectedRangeLast())||void 0===c?void 0:c.highlight)})),e.addHook("beforeRowWrap",((e,t,n)=>{o.wrapped=!0,o.flipped=n}));const h={keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:XA,group:"focusCatcher"};e.getShortcutManager().getContext("grid").addShortcuts([{...h,callback:()=>{const{tabNavigation:t}=e.getSettings();a=!0,e.getSelectedRangeLast()&&!t&&(s=!1),t||(l=!0)},position:"before"},{...h,callback:t=>{const{tabNavigation:r,autoWrapRow:i}=e.getSettings();if(a=!1,s=!0,!r||!e.selection.isSelected()||i&&o.wrapped&&o.flipped||!i&&o.wrapped)return i&&o.wrapped&&o.flipped&&(n=t.shiftKey?cM(e):dM(e)),o.wrapped=!1,o.flipped=!1,e.deselectCell(),e.unlisten(),!1;t.preventDefault()},position:"after"}])}function cM(e){const{rowIndexMapper:t,columnIndexMapper:n}=e,{navigableHeaders:r}=e.getSettings();let i=r&&e.countColHeaders()>0?-e.countColHeaders():0,o=r&&e.countRowHeaders()>0?-e.countRowHeaders():0;return 0===i&&(i=t.getVisualFromRenderableIndex(i)),0===o&&(o=n.getVisualFromRenderableIndex(o)),null===i||null===o?null:e._createCellCoords(i,o)}function dM(e){var t,n;const{rowIndexMapper:r,columnIndexMapper:i}=e,{navigableHeaders:o}=e.getSettings();let s=r.getRenderableIndexesLength()-1,a=i.getRenderableIndexesLength()-1;if(s<0){if(!o||0===e.countColHeaders())return null;s=-1}if(a<0){if(!o||0===e.countColHeaders())return null;a=-1}return e._createCellCoords(null!==(t=r.getVisualFromRenderableIndex(s))&&void 0!==t?t:s,null!==(n=i.getVisualFromRenderableIndex(a))&&void 0!==n?n:a)}const pM=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),gM=e=>e.map((e=>{const t=e.toLowerCase();return pM.has(t)?pM.get(t):t})).sort().join("+"),mM=new Map([[96,"numpad0"],[97,"numpad1"],[98,"numpad2"],[99,"numpad3"],[100,"numpad4"],[101,"numpad5"],[102,"numpad6"],[103,"numpad7"],[104,"numpad8"],[105,"numpad9"],[106,"multiply"],[107,"add"],[108,"decimal"],[109,"subtract"],[110,"decimal"],[111,"divide"],[112,"f1"],[113,"f2"],[114,"f3"],[115,"f4"],[116,"f5"],[117,"f6"],[118,"f7"],[119,"f8"],[120,"f9"],[121,"f10"],[122,"f11"],[123,"f12"],[186,"semicolon"],[187,"equal"],[188,"comma"],[189,"minus"],[190,"period"],[191,"slash"],[192,"backquote"],[219,"bracketleft"],[220,"backslash"],[221,"bracketright"],[222,"quote"]]),fM=e=>{let{which:t,key:n}=e;if(mM.has(t))return mM.get(t);const r=String.fromCharCode(t).toLowerCase();return/^[a-z0-9]$/.test(r)?r:n.toLowerCase()},wM=Symbol("shortcut-context");function yM(e){return am(e)&&e.__kindOf===wM}const vM=["meta","alt","shift","control"],CM=function(){const e=new Set;return{press(t){e.add(t)},release(t){e.delete(t)},releaseAll(){e.clear()},isPressed:t=>e.has(t)}}(),SM=[];let RM=0;const EM=e=>{let{ownerWindow:t,handleEvent:n,beforeKeyDown:r,afterKeyDown:i}=e;const o=ly({errorIdExists:e=>`The "${e}" context name is already registered.`});let s="grid";const a=()=>s,l=e=>o.getItem(e);let h=!1;const u=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:a();const r=yM(n)?n:l(n);let i=!1;if(!r.hasShortcut(t))return i;const o=r.getShortcuts(t);for(let s=0;s<o.length;s++){const{callback:n,runOnlyIf:r,preventDefault:a,stopPropagation:l,captureCtrl:c,forwardToContext:d}=o[s];if(!0===r(e)){if(h=c,i=!1===n(e,t),h=!1,a&&e.preventDefault(),l&&(_m(e),e.stopPropagation()),i)break;d&&u(e,t,d)}}return i},c=function(e,t,n,r,i){const o=e=>vM.includes(e),s=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=[];return e.altKey&&n.push("alt"),t&&(e.ctrlKey||e.metaKey)?n.push("control/meta"):(e.ctrlKey&&n.push("control"),e.metaKey&&n.push("meta")),e.shiftKey&&n.push("shift"),n},a=e=>{if(!1===t(e))return;if(!1===n(e)||229===e.keyCode||"string"!=typeof e.key||Lm(e))return;const a=fM(e);let l=[];o(a)||(l=s(e));const h=[a].concat(l);!i(e,h)&&(Mm()&&l.includes("meta")||!Mm()&&l.includes("control"))&&i(e,[a].concat(s(e,!0))),r(e)},l=e=>{if("string"==typeof e.key){const t=fM(e);o(t)&&CM.press(t)}},h=e=>{if("string"==typeof e.key){const t=fM(e);o(t)&&CM.release(t)}},u=()=>{CM.releaseAll()};return{mount:()=>{let t=e;for(RM+=1;t;)1===RM&&(t.document.documentElement.addEventListener("keydown",l),SM.push({event:"keydown",listener:l}),t.document.documentElement.addEventListener("keyup",h),SM.push({event:"keyup",listener:h})),t.document.documentElement.addEventListener("keydown",a),t.document.documentElement.addEventListener("blur",u),t=Ip(t)},unmount:()=>{let t=e;for(RM-=1;t;){if(0===RM){for(let e=0;e<SM.length;e++){const{event:n,listener:r}=SM[e];t.document.documentElement.removeEventListener(n,r)}SM.length=0}t.document.documentElement.removeEventListener("keydown",a),t.document.documentElement.removeEventListener("blur",u),t=Ip(t)}},isPressed:e=>CM.isPressed(e),releasePressedKeys:()=>CM.releaseAll()}}(t,n,r,i,u);return c.mount(),{addContext:e=>{const t=(e=>{const t=ly({errorIdExists:t=>`The "${t}" shortcut is already registered in the "${e}" context.`}),n=function(){let{keys:e,callback:n,group:r,runOnlyIf:i=(()=>!0),captureCtrl:o=!1,preventDefault:s=!0,stopPropagation:a=!1,relativeToGroup:l,position:h,forwardToContext:u}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(zd(r))throw new Error("You need to define the shortcut's group.");if(!1===Cg(n))throw new Error("The shortcut's callback needs to be a function.");if(!1===Array.isArray(e))throw new Error(Wd`Pass the shortcut\'s keys as an array of arrays,\x20
      using the KeyboardEvent.key properties:\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`);const c={callback:n,group:r,runOnlyIf:i,captureCtrl:o,preventDefault:s,stopPropagation:a};Gd(l)&&(c.relativeToGroup=l,c.position=h),yM(u)&&(c.forwardToContext=u),e.forEach((e=>{const n=gM(e);if(t.hasItem(n)){const e=t.getItem(n);let r=e.findIndex((e=>e.group===l));-1!==r?"before"===h?r-=1:r+=1:r=e.length,e.splice(r,0,c)}else t.addItem(n,[c])}))},r=e=>{const n=gM(e);t.removeItem(n)};return{__kindOf:wM,addShortcut:n,addShortcuts:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e.forEach((e=>{hm(t,((n,r)=>{!1===Object.prototype.hasOwnProperty.call(e,r)&&(e[r]=t[r])})),n(e)}))},getShortcuts:e=>{const n=gM(e),r=t.getItem(n);return Gd(r)?r.slice():[]},hasShortcut:e=>{const n=gM(e);return t.hasItem(n)},removeShortcutsByKeys:r,removeShortcutsByGroup:e=>{t.getItems().forEach((t=>{let[n,i]=t;const o=i.filter((t=>t.group!==e));0===o.length?r((e=>e.split("+"))(n)):(i.length=0,i.push(...o))}))}}})(e);return o.addItem(e,t),t},getActiveContextName:a,getContext:l,setActiveContextName:e=>{if(!o.hasItem(e))throw new Error(Wd`You've tried to activate the "${e}" shortcut context\x20
        that does not exist. Before activation, register the context using the "addContext" method.`);s=e},isCtrlPressed:()=>!h&&(c.isPressed("control")||c.isPressed("meta")),releasePressedKeys:()=>c.releasePressedKeys(),destroy:()=>c.unmount()}};function bM(e){const{classNames:t}=function(e,t){const n={element:void 0,classNames:[]};let r=e;for(;null!==r&&r!==e.ownerDocument.documentElement&&!n.element;){if("string"==typeof t&&r.classList.contains(t))n.element=r,n.classNames.push(t);else if(t instanceof RegExp){const e=Array.from(r.classList).filter((e=>t.test(e)));e.length&&(n.element=r,n.classNames.push(...e))}r=r.parentElement}return n}(e,/ht-theme-[a-zA-Z0-9_-]+/);return t.pop()}let TM=null;const NM=new Map;function AM(e,t){var n,r=this;let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=this;const s=new Ff(o);let a,l,h,u,c,d,p=!0;var g;ZR(i)&&(g=this,qR.set(g,!0)),this.rootElement=e,this.rootDocument=e.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;const m=null!==(n=null==t?void 0:t.layoutDirection)&&void 0!==n?n:"inherit",f=["rtl","ltr"].includes(m)?m:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",f),this.isRtl=function(){return"rtl"===f},this.isLtr=function(){return!o.isRtl()},this.getDirectionFactor=function(){return o.isLtr()?1:-1},t.language=function(e){let t=fb(e);return oN(t)||(t=ZT,wb(e)),t}(t.language);const w=new UA(o,t,[jA,KA]),y=w.getTableMeta(),v=w.getGlobalMeta(),C=ly();this.container=this.rootDocument.createElement("div"),this.renderCall=!1,e.insertBefore(this.container,e.firstChild),JR(this)&&(ip(t.licenseKey,e),Fp(e,"ht-wrapper")),this.guid=`ht_${sp()}`,NM.set(this.guid,this),this.columnIndexMapper=new mb,this.rowIndexMapper=new mb,this.columnIndexMapper.addLocalHook("indexesSequenceChange",(e=>{o.runHooks("afterColumnSequenceChange",e)})),this.rowIndexMapper.addLocalHook("indexesSequenceChange",(e=>{o.runHooks("afterRowSequenceChange",e)})),l=new AE(o),this.rootElement.id&&"ht_"!==this.rootElement.id.substring(0,3)||(this.rootElement.id=this.guid);let S=new uA(y,{rowIndexMapper:o.rowIndexMapper,columnIndexMapper:o.columnIndexMapper,countCols:()=>o.countCols(),countRows:()=>o.countRows(),propToCol:e=>a.propToCol(e),isEditorOpened:()=>!!o.getActiveEditor()&&o.getActiveEditor().isOpened(),countRenderableColumns:()=>this.view.countRenderableColumns(),countRenderableRows:()=>this.view.countRenderableRows(),countRowHeaders:()=>this.countRowHeaders(),countColHeaders:()=>this.countColHeaders(),countRenderableRowsInRange:function(){return r.view.countRenderableRowsInRange(...arguments)},countRenderableColumnsInRange:function(){return r.view.countRenderableColumnsInRange(...arguments)},getShortcutManager:()=>o.getShortcutManager(),createCellCoords:(e,t)=>o._createCellCoords(e,t),createCellRange:(e,t,n)=>o._createCellRange(e,t,n),visualToRenderableCoords:e=>{const{row:t,col:n}=e;return o._createCellCoords(t>=0?o.rowIndexMapper.getRenderableFromVisualIndex(t):t,n>=0?o.columnIndexMapper.getRenderableFromVisualIndex(n):n)},renderableToVisualCoords:e=>{const{row:t,col:n}=e;return o._createCellCoords(t>=0?o.rowIndexMapper.getVisualFromRenderableIndex(t):t,n>=0?o.columnIndexMapper.getVisualFromRenderableIndex(n):n)},findFirstNonHiddenRenderableRow:(e,t)=>{const n=t>e?1:-1,r=Math.min(e,t),i=Math.max(e,t),s=o.rowIndexMapper.getNearestNotHiddenIndex(e,n);return null===s||1===n&&s>i||-1===n&&s<r?null:s>=0?o.rowIndexMapper.getRenderableFromVisualIndex(s):s},findFirstNonHiddenRenderableColumn:(e,t)=>{const n=t>e?1:-1,r=Math.min(e,t),i=Math.max(e,t),s=o.columnIndexMapper.getNearestNotHiddenIndex(e,n);return null===s||1===n&&s>i||-1===n&&s<r?null:s>=0?o.columnIndexMapper.getRenderableFromVisualIndex(s):s},isDisabledCellSelection:(e,t)=>e<0||t<0?o.getSettings().disableVisualSelection:o.getCellMeta(e,t).disableVisualSelection});this.selection=S;const R=e=>{let{hiddenIndexesChanged:t}=e;t&&this.selection.commit()};function E(e){const t=fb(e);oN(t)?(o.runHooks("beforeLanguageChange",t),v.language=t,o.runHooks("afterLanguageChange",t)):wb(e)}function b(e,t){const n="className"===e?o.rootElement:o.table;if(p)Fp(n,t);else{let r=[],i=[];v[e]&&(r=Array.isArray(v[e])?v[e]:Bd(v[e])),t&&(i=Array.isArray(t)?t:Bd(t));const o=Ud(r,i),s=Ud(i,r);o.length&&Dp(n,o),s.length&&Fp(n,s)}v[e]=t}function T(){let e=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue(){this.validatorsInQueue+=1,e=!1},removeValidatorFormQueue(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty(){},checkIfQueueIsEmpty(){0===this.validatorsInQueue&&!1===e&&(e=!0,this.onQueueEmpty(this.valid))}}}function N(e){const t=e.replace(",",".");return!1===isNaN(parseFloat(t))?parseFloat(t):e}function A(e,t,n){if(!e.length)return void n();const r=o.getActiveEditor(),i=new T;let s=!0;i.onQueueEmpty=()=>{r&&s&&r.cancelChanges(),n()};for(let l=e.length-1;l>=0;l--){const[n,r]=e[l],h=a.propToCol(r);let u;u=Number.isInteger(h)?o.getCellMeta(n,h):{...Object.getPrototypeOf(y),...y},o.getCellValidator(u)&&(i.addValidatorToQueue(),o.validateCell(e[l][3],u,function(t,n){return function(r){if("boolean"!=typeof r)throw new Error("Validation error: result is not boolean");!1===r&&!1===n.allowInvalid&&(s=!1,e.splice(t,1),n.valid=!0),i.removeValidatorFormQueue()}}(l,u),t))}i.checkIfQueueIsEmpty()}function M(e,t){for(let r=e.length-1;r>=0;r--){let t=!1;if(null!==e[r]){if(null!==e[r][2]&&void 0!==e[r][2]||null!==e[r][3]&&void 0!==e[r][3]){if(y.allowInsertRow)for(;e[r][0]>o.countRows()-1;){const{delta:e}=a.createRow(void 0,void 0,{source:"auto"});if(0===e){t=!0;break}}if("array"===o.dataType&&(!y.columns||0===y.columns.length)&&y.allowInsertColumn)for(;a.propToCol(e[r][1])>o.countCols()-1;){const{delta:e}=a.createCol(void 0,void 0,{source:"auto"});if(0===e){t=!0;break}}t||a.set(e[r][0],e[r][1],e[r][3])}}else e.splice(r,1)}const n=e.length>0;if(o.forceFullRender=!0,n){h.adjustRowsAndCols(),o.runHooks("beforeChangeRender",e,t),u.closeEditor(),o.view.render(),u.prepareEditor(),o.view.adjustElementsSize(),o.runHooks("afterChange",e,t||"edit");const n=o.getActiveEditor();n&&Gd(n.refreshValue)&&n.refreshValue()}else o.view.render()}function I(e,t,n){return Array.isArray(e)?e:[[e,t,n]]}function O(e,t){const n=o.runHooks("beforeChange",e,t||"edit"),r=e.filter((e=>null!==e));var i;if(!1===n||0===r.length)return null===(i=o.getActiveEditor())||void 0===i||i.cancelChanges(),[];for(let s=r.length-1;s>=0;s--){const[e,t,,n]=r[s],i=a.propToCol(t);let l;l=Number.isInteger(i)?o.getCellMeta(e,i):{...Object.getPrototypeOf(y),...y},"numeric"===l.type&&"string"==typeof n&&Zw(n,[","])&&(r[s][3]=N(n))}return r}this.columnIndexMapper.addLocalHook("cacheUpdated",R),this.rowIndexMapper.addLocalHook("cacheUpdated",R),this.selection.addLocalHook("afterSetRangeEnd",((e,t)=>{const n=dm(!1),r=this.selection.getSelectedRange(),{from:i,to:s}=r.current(),a=r.size()-1;this.runHooks("afterSelection",i.row,i.col,s.row,s.col,n,a),this.runHooks("afterSelectionByProp",i.row,o.colToProp(i.col),s.row,o.colToProp(s.col),n,a),t&&(!n.isTouched()||n.isTouched()&&!n.value)&&d.scrollTo(e);const l=S.isSelectedByRowHeader(),h=S.isSelectedByColumnHeader();l&&h?Fp(this.rootElement,["ht__selection--rows","ht__selection--columns"]):l?(Dp(this.rootElement,"ht__selection--columns"),Fp(this.rootElement,"ht__selection--rows")):h?(Dp(this.rootElement,"ht__selection--rows"),Fp(this.rootElement,"ht__selection--columns")):Dp(this.rootElement,["ht__selection--rows","ht__selection--columns"]),"shift"!==S.getSelectionSource()&&u.closeEditor(null),o.view.render(),u.prepareEditor()})),this.selection.addLocalHook("beforeSetFocus",(e=>{this.runHooks("beforeSelectionFocusSet",e.row,e.col)})),this.selection.addLocalHook("afterSetFocus",(e=>{const t=dm(!1);this.runHooks("afterSelectionFocusSet",e.row,e.col,t),(!t.isTouched()||t.isTouched()&&!t.value)&&d.scrollTo(e),u.closeEditor(),o.view.render(),u.prepareEditor()})),this.selection.addLocalHook("afterSelectionFinished",(e=>{const t=e.length-1,{from:n,to:r}=e[t];this.runHooks("afterSelectionEnd",n.row,n.col,r.row,r.col,t),this.runHooks("afterSelectionEndByProp",n.row,o.colToProp(n.col),r.row,o.colToProp(r.col),t)})),this.selection.addLocalHook("afterIsMultipleSelection",(e=>{const t=this.runHooks("afterIsMultipleSelection",e.value);e.value&&(e.value=t)})),this.selection.addLocalHook("afterDeselect",(()=>{u.closeEditor(),o.view.render(),Dp(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this.runHooks("afterDeselect")})),this.selection.addLocalHook("beforeHighlightSet",(()=>this.runHooks("beforeSelectionHighlightSet"))).addLocalHook("beforeSetRangeStart",(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.runHooks("beforeSetRangeStart",...t)})).addLocalHook("beforeSetRangeStartOnly",(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.runHooks("beforeSetRangeStartOnly",...t)})).addLocalHook("beforeSetRangeEnd",(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.runHooks("beforeSetRangeEnd",...t)})).addLocalHook("beforeSelectColumns",(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.runHooks("beforeSelectColumns",...t)})).addLocalHook("afterSelectColumns",(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.runHooks("afterSelectColumns",...t)})).addLocalHook("beforeSelectRows",(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.runHooks("beforeSelectRows",...t)})).addLocalHook("afterSelectRows",(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.runHooks("afterSelectRows",...t)})).addLocalHook("beforeModifyTransformStart",(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.runHooks("modifyTransformStart",...t)})).addLocalHook("afterModifyTransformStart",(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.runHooks("afterModifyTransformStart",...t)})).addLocalHook("beforeModifyTransformFocus",(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.runHooks("modifyTransformFocus",...t)})).addLocalHook("afterModifyTransformFocus",(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.runHooks("afterModifyTransformFocus",...t)})).addLocalHook("beforeModifyTransformEnd",(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.runHooks("modifyTransformEnd",...t)})).addLocalHook("afterModifyTransformEnd",(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.runHooks("afterModifyTransformEnd",...t)})).addLocalHook("beforeRowWrap",(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.runHooks("beforeRowWrap",...t)})).addLocalHook("beforeColumnWrap",(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.runHooks("beforeColumnWrap",...t)})).addLocalHook("insertRowRequire",(e=>this.alter("insert_row_above",e,1,"auto"))).addLocalHook("insertColRequire",(e=>this.alter("insert_col_start",e,1,"auto"))),h={alter(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0;const s=e=>{if(0===e.length)return[];const t=[...e];t.sort(((e,t)=>{let[n]=e,[r]=t;return n===r?0:n>r?1:-1}));return kd(t,((e,t)=>{let[n,r]=t;const i=e[e.length-1],[o,s]=i,a=o+s;if(n<=a){const e=Math.max(r-(a-n),0);i[1]+=e}else e.push([n,r]);return e}),[t[0]])};switch(e){case"insert_row_below":case"insert_row_above":const i=o.countSourceRows();if(y.maxRows===i)return;const l="insert_row_below"===e?"below":"above";t=null!=t?t:"below"===l?i:0;const{delta:h,startPhysicalIndex:c}=a.createRow(t,n,{source:r,mode:l});S.shiftRows(o.toVisualRow(c),h);break;case"insert_col_start":case"insert_col_end":const d="insert_col_end"===e?"end":"start";t=null!=t?t:"end"===d?o.countSourceCols():0;const{delta:p,startPhysicalIndex:g}=a.createCol(t,n,{source:r,mode:d});if(p){if(Array.isArray(y.colHeaders)){const e=[o.toVisualColumn(g),0];e.length+=p,Array.prototype.splice.apply(y.colHeaders,e)}S.shiftColumns(o.toVisualColumn(g),p)}break;case"remove_row":const m=e=>{let t=0;Vd(e,(e=>{let[n,i]=e;const s=$d(n)?o.countRows()-1:Math.max(n-t,0);Number.isInteger(n)&&(n=Math.max(n-t,0));if(!a.removeRow(n,i,r))return;if(S.isSelected()){const{row:e}=o.getSelectedRangeLast().highlight;e>=n&&e<=n+i-1&&u.closeEditor(!0)}const l=o.countRows();0===l?S.deselect():"ContextMenu.removeRow"===r?S.refresh():S.shiftRows(n,-i);const h=y.fixedRowsTop;h>=s+1&&(y.fixedRowsTop-=Math.min(i,h-s));const c=y.fixedRowsBottom;c&&s>=l-c&&(y.fixedRowsBottom-=Math.min(i,c)),t+=i}))};Array.isArray(t)?m(s(t)):m([[t,n]]);break;case"remove_col":const f=e=>{let t=0;Vd(e,(e=>{let[n,i]=e;const s=$d(n)?o.countCols()-1:Math.max(n-t,0);let l=o.toPhysicalColumn(s);Number.isInteger(n)&&(n=Math.max(n-t,0));if(!a.removeCol(n,i,r))return;if(S.isSelected()){const{col:e}=o.getSelectedRangeLast().highlight;e>=n&&e<=n+i-1&&u.closeEditor(!0)}0===o.countCols()?S.deselect():"ContextMenu.removeColumn"===r?S.refresh():S.shiftColumns(n,-i);const h=y.fixedColumnsStart;h>=s+1&&(y.fixedColumnsStart-=Math.min(i,h-s)),Array.isArray(y.colHeaders)&&(void 0===l&&(l=-1),y.colHeaders.splice(l,i)),t+=i}))};Array.isArray(t)?f(s(t)):f([[t,n]]);break;default:throw new Error(`There is no such action "${e}"`)}i||h.adjustRowsAndCols(),o.view.render(),o.view.adjustElementsSize()},adjustRowsAndCols(){const e=y.minRows,t=y.minSpareRows,n=y.minCols,r=y.minSpareCols;if(e){const t=o.countRows();t<e&&a.createRow(t,e-t,{source:"auto"})}if(t){const e=o.countEmptyRows(!0);if(e<t){const n=t-e,r=Math.min(n,y.maxRows-o.countSourceRows());a.createRow(o.countRows(),r,{source:"auto"})}}{let e;(n||r)&&(e=o.countEmptyCols(!0));let t=o.countCols();if(n&&!y.columns&&t<n){const r=n-t;e+=r,a.createCol(t,r,{source:"auto"})}if(r&&!y.columns&&"array"===o.dataType&&e<r){t=o.countCols();const n=r-e,i=Math.min(n,y.maxCols-t);a.createCol(t,i,{source:"auto"})}}},populateFromArray(e,t,n,r,i){let s,a,l,h;const u=[],c={},d=[],p=e.row,g=e.col;if(a=t.length,0===a)return!1;let m=0,f=0;switch(am(n)&&(m=n.col-g+1,f=n.row-p+1),i){case"shift_down":const i=Hd(t),w=i.length,v=Math.max(w,m),C=o.getData().slice(p),S=Hd(C).slice(g,g+v);for(l=0;l<v;l+=1)if(l<w){for(s=0,a=i[l].length;s<f-a;s+=1)i[l].push(i[l][s%a]);l<S.length?d.push(i[l].concat(S[l])):d.push(i[l].concat(new Array(C.length).fill(null)))}else d.push(i[l%w].concat(S[l]));o.populateFromArray(p,g,Hd(d));break;case"shift_right":const R=t.length,E=Math.max(R,f),b=o.getData().slice(p).map((e=>e.slice(g)));for(s=0;s<E;s+=1)if(s<R){for(l=0,h=t[s].length;l<m-h;l+=1)t[s].push(t[s][l%h]);if(s<b.length)for(let e=0;e<b[s].length;e+=1)t[s].push(b[s][e]);else t[s].push(...new Array(b[0].length).fill(null))}else t.push(t[s%a].slice(0,E).concat(b[s]));o.populateFromArray(p,g,t);break;default:c.row=e.row,c.col=e.col;let T,N=0,A=0,M=!0;const I=function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const r=t[e%t.length];return null!==n?r[n%r.length]:r},O=t.length,x=n?n.row-e.row+1:0;for(a=n?x:Math.max(O,x),s=0;s<a&&!(n&&c.row>n.row&&x>O||!y.allowInsertRow&&c.row>o.countRows()-1||c.row>=y.maxRows);s++){const t=s-N,i=I(t).length,d=n?n.col-e.col+1:0;if(h=n?d:Math.max(i,d),c.col=e.col,T=o.getCellMeta(c.row,c.col),"CopyPaste.paste"!==r&&"Autofill.fill"!==r||!T.skipRowOnPaste){for(A=0,l=0;l<h&&!(n&&c.col>n.col&&d>i||!y.allowInsertColumn&&c.col>o.countCols()-1||c.col>=y.maxCols);l++){if(T=o.getCellMeta(c.row,c.col),("CopyPaste.paste"===r||"Autofill.fill"===r)&&T.skipColumnOnPaste){A+=1,c.col+=1,h+=1;continue}if(T.readOnly&&"UndoRedo.undo"!==r){c.col+=1;continue}let e=I(t,l-A),n=o.getDataAtCell(c.row,c.col);if(null!==e&&"object"==typeof e)if(Array.isArray(e)&&null===n&&(n=[]),null===n||"object"!=typeof n)M=!1;else{const t=em(Array.isArray(n)?n:n[0]||n),r=em(Array.isArray(e)?e:e[0]||e);sm(t,r)||Array.isArray(t)&&Array.isArray(r)?e=rm(e):M=!1}else null!==n&&"object"==typeof n&&(M=!1);M&&u.push([c.row,c.col,e]),M=!0,c.col+=1}c.row+=1}else N+=1,c.row+=1,a+=1}o.setDataAtCell(u,null,null,r||"populateFromArray")}}},this.init=function(){l.setData(y.data),o.runHooks("beforeInit"),(bm()||Nm())&&Fp(o.rootElement,"mobile"),this.updateSettings(y,!0),this.view=new yE(this);const e=y.themeName||bM(o.rootElement);o.useTheme(e),o.view.addClassNameToLicenseElement(o.getCurrentThemeName()),u=$f.getInstance(o,y,S),d=function(e){const{selection:t}=e;let n=!1,r=!1;return{resume(){r=!1},suspend(){r=!0},skipNextScrollCycle(){n=!0},scrollTo(i){var o;if(n||r)return void(n=!1);let s;t.isFocusSelectionChanged()?s=function(e){return t=>{e.scrollViewportTo(t.toObject())}}(e):t.isSelectedByCorner()?s=()=>{}:t.isSelectedByRowHeader()?s=function(e){return t=>{let{row:n}=t;e.scrollViewportTo({row:n})}}(e):t.isSelectedByColumnHeader()?s=function(e){return t=>{let{col:n}=t;e.scrollViewportTo({col:n})}}(e):1===t.getSelectedRange().size()&&t.isMultiple()?s=function(e){return t=>{e.scrollViewportTo(t.toObject())}}(e):1!==t.getSelectedRange().size()||t.isMultiple()?t.getSelectedRange().size()>1&&(s=function(e){return t=>{e.scrollViewportTo(t.toObject())}}(e)):s=function(e){return t=>{const n=e.selection.getSelectionSource(),{row:r,col:i}=t;if(r<0&&i>=0)e.scrollViewportTo({col:i});else if(i<0&&r>=0)e.scrollViewportTo({row:r});else{if("mouse"===n&&(i===e.view.getLastPartiallyVisibleColumn()||r===e.view.getLastPartiallyVisibleRow()))return;e.scrollViewportTo({row:r,col:i})}}}(e),null===(o=s)||void 0===o||o(i)}}}(o),c=new ow(o),JR(this)&&uM(o),o.runHooks("init"),this.forceFullRender=!0,this.view.render(),p&&null===o.rootElement.offsetParent&&function(e,t){const n=new IntersectionObserver(((n,r)=>{n.forEach((n=>{n.isIntersecting&&null!==e.offsetParent&&(t(),r.unobserve(e))}))}),{root:e.ownerDocument.body});n.observe(e)}(o.rootElement,(()=>{o.view._wt.wtOverlays.updateLastSpreaderSize(),o.render(),o.view.adjustElementsSize()})),"object"==typeof p&&(o.runHooks("afterChange",p[0],p[1]),p=!1),o.runHooks("afterInit")},this._createCellCoords=function(e,t){return o.view._wt.createCellCoords(e,t)},this._createCellRange=function(e,t,n){return o.view._wt.createCellRange(e,t,n)},this.validateCell=function(e,t,n,r){let i=o.getCellValidator(t);function s(e){if(!(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])||!0===t.hidden)return void n(e);const r=t.visualCol,i=t.visualRow,s=o.getCell(i,r,!0);if(s&&"TH"!==s.nodeName){const e=o.rowIndexMapper.getRenderableFromVisualIndex(i),t=o.columnIndexMapper.getRenderableFromVisualIndex(r);o.view._wt.getSetting("cellRenderer",e,t,s)}n(e)}var a,l;l=i,"[object RegExp]"===Object.prototype.toString.call(l)&&(a=i,i=function(e,t){t(a.test(e))}),Cg(i)?(e=o.runHooks("beforeValidate",e,t.visualRow,t.prop,r),o._registerImmediate((()=>{i.call(t,e,(n=>{o&&(n=o.runHooks("afterValidate",n,e,t.visualRow,t.prop,r),t.valid=n,s(n),o.runHooks("postAfterValidate",n,e,t.visualRow,t.prop,r))}))}))):o._registerImmediate((()=>{t.valid=!0,s(t.valid,!1)}))},this.setDataAtCell=function(e,t,n,r){const i=I(e,t,n),s=[];let h,u,c,d=r;for(h=0,u=i.length;h<u;h++){if("object"!=typeof i[h])throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if("number"!=typeof i[h][1])throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");c=i[h][1]>=this.countCols()?i[h][1]:a.colToProp(i[h][1]),s.push([i[h][0],c,l.getAtCell(this.toPhysicalRow(i[h][0]),i[h][1]),i[h][2]])}d||"object"!=typeof e||(d=t);const p=O(s,d);o.runHooks("afterSetDataAtCell",p,d),A(p,d,(()=>{M(p,d)}))},this.setDataAtRowProp=function(e,t,n,r){const i=I(e,t,n),s=[];let a,h,u=r;for(a=0,h=i.length;a<h;a++)s.push([i[a][0],i[a][1],l.getAtCell(this.toPhysicalRow(i[a][0]),i[a][1]),i[a][2]]);u||"object"!=typeof e||(u=t);const c=O(s,r);o.runHooks("afterSetDataAtRowProp",c,u),A(c,u,(()=>{M(c,u)}))},this.listen=function(){o&&!o.isListening()&&(NM.forEach((e=>{o!==e&&e.unlisten()})),TM=o.guid,o.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(TM=null,o.runHooks("afterUnlisten"))},this.isListening=function(){return TM===o.guid},this.destroyEditor=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];u.closeEditor(e),o.view.render(),t&&S.isSelected()&&u.prepareEditor()},this.populateFromArray=function(e,t,n,r,i,s,a){if("object"!=typeof n||"object"!=typeof n[0])throw new Error("populateFromArray parameter `input` must be an array of arrays");const l="number"==typeof r?o._createCellCoords(r,i):null;return h.populateFromArray(o._createCellCoords(e,t),n,l,s,a)},this.spliceCol=function(e,t,n){for(var r=arguments.length,i=new Array(r>3?r-3:0),o=3;o<r;o++)i[o-3]=arguments[o];return a.spliceCol(e,t,n,...i)},this.spliceRow=function(e,t,n){for(var r=arguments.length,i=new Array(r>3?r-3:0),o=3;o<r;o++)i[o-3]=arguments[o];return a.spliceRow(e,t,n,...i)},this.getSelected=function(){if(S.isSelected())return Dd(S.getSelectedRange(),(e=>{let{from:t,to:n}=e;return[t.row,t.col,n.row,n.col]}))},this.getSelectedLast=function(){const e=this.getSelected();let t;return e&&e.length>0&&(t=e[e.length-1]),t},this.getSelectedRange=function(){if(S.isSelected())return Array.from(S.getSelectedRange())},this.getSelectedRangeLast=function(){const e=this.getSelectedRange();let t;return e&&e.length>0&&(t=e[e.length-1]),t},this.emptySelectedCells=function(e){if(!S.isSelected()||0===this.countRows()||0===this.countCols())return;const t=[];Vd(S.getSelectedRange(),(e=>{if(e.isSingleHeader())return;const n=e.getTopStartCorner(),r=e.getBottomEndCorner();Jw(n.row,r.row,(e=>{Jw(n.col,r.col,(n=>{this.getCellMeta(e,n).readOnly||t.push([e,n,null])}))}))})),t.length>0&&this.setDataAtCell(t,e)},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){const e=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(e,0),this.isRenderSuspended()||e!==this.renderSuspendedCounter||(this.renderCall?this.render():o.view.render())},this.render=function(){this.view&&(this.renderCall=!0,this.forceFullRender=!0,this.isRenderSuspended()||o.view.render())},this.batchRender=function(e){this.suspendRender();const t=e();return this.resumeRender(),t},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(t,0),(!this.isExecutionSuspended()&&t===this.executionSuspendedCounter||e)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.suspendExecution();const n=e();return this.resumeExecution(t),n},this.batch=function(e){this.suspendRender(),this.suspendExecution();const t=e();return this.resumeExecution(),this.resumeRender(),t},this.refreshDimensions=function(){if(!o.view)return;const e=o.view,{width:t,height:n}=e.getLastSize(),{width:r,height:i}=o.rootElement.getBoundingClientRect(),s=r!==t||i!==n;!1===o.runHooks("beforeRefreshDimensions",{width:t,height:n},{width:r,height:i},s)||((s||e._wt.wtOverlays.scrollableElement===o.rootWindow)&&(e.setLastSize(r,i),o.render(),e.adjustElementsSize()),o.runHooks("afterRefreshDimensions",{width:t,height:n},{width:r,height:i},s))},this.updateData=function(e,t){BA(e,(e=>{a=e}),(e=>{a=e,o.columnIndexMapper.fitToLength(this.getInitialColumnCount()),o.rowIndexMapper.fitToLength(this.countSourceRows()),h.adjustRowsAndCols(),S.refresh()}),{hotInstance:o,dataMap:a,dataSource:l,internalSource:"updateData",source:t,metaManager:w,firstRun:p})},this.loadData=function(e,t){BA(e,(e=>{a=e}),(()=>{w.clearCellsCache(),o.initIndexMappers(),h.adjustRowsAndCols(),S.refresh(),p&&(p=[null,"loadData"])}),{hotInstance:o,dataMap:a,dataSource:l,internalSource:"loadData",source:t,metaManager:w,firstRun:p})},this.getInitialColumnCount=function(){const e=y.columns;let t=0;if(Array.isArray(e))t=e.length;else if(Cg(e))if("array"===o.dataType){const n=this.countSourceCols();for(let r=0;r<n;r+=1)e(r)&&(t+=1)}else"object"!==o.dataType&&"function"!==o.dataType||(t=a.colToPropCache.length);else if(Gd(y.dataSchema)){const e=a.getSchema();t=Array.isArray(e)?e.length:cm(e)}else t=this.countSourceCols();return t},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(e,t,n,r){return zd(e)?a.getAll():a.getRange(o._createCellCoords(e,t),o._createCellCoords(n,r),a.DESTINATION_RENDERER)},this.getCopyableText=function(e,t,n,r){return a.getCopyableText(o._createCellCoords(e,t),o._createCellCoords(n,r))},this.getCopyableData=function(e,t){return a.getCopyable(e,a.colToProp(t))},this.getSchema=function(){return a.getSchema()},this.updateSettings=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=(p?o.loadData:o.updateData).bind(this);let r,i,s=!1;if(Gd(e.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(Gd(e.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(Gd(e.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');for(r in e)"data"===r||("language"===r?E(e.language):"className"===r?b("className",e.className):"tableClassName"===r&&o.table?(b("tableClassName",e.tableClassName),o.view._wt.wtOverlays.syncOverlayTableClassNames()):Rf.getSingleton().isRegistered(r)||Rf.getSingleton().isDeprecated(r)?Cg(e[r])?Rf.getSingleton().addAsFixed(r,e[r],o):Array.isArray(e[r])&&Rf.getSingleton().add(r,e[r],o):!t&&pm(e,r)&&(v[r]=e[r]));void 0===e.data&&void 0===y.data?n(null,"updateSettings"):void 0!==e.data?n(e.data,"updateSettings"):void 0!==e.columns&&(a.createMap(),o.initIndexMappers());const l=o.countCols(),u=y.columns;if(u&&Cg(u)&&(s=!0),void 0===e.cell&&void 0===e.cells&&void 0===e.columns||w.clearCache(),l>0)for(r=0,i=0;r<l;r++){if(u){const e=s?u(r):u[i];e&&w.updateColumnMeta(i,e)}i+=1}Gd(e.cell)&&hm(e.cell,(e=>{o.setCellMetaObject(e.row,e.col,e)})),o.runHooks("afterCellMetaReset");let c=o.rootElement.style.height;""!==c&&(c=parseInt(o.rootElement.style.height,10));let d=e.height;if(Cg(d)&&(d=d()),t){o.rootElement.getAttribute("style")&&o.rootElement.setAttribute("data-initialstyle",o.rootElement.getAttribute("style"))}if(null===d){const e=o.rootElement.getAttribute("data-initialstyle");e&&(e.indexOf("height")>-1||e.indexOf("overflow")>-1)?o.rootElement.setAttribute("style",e):(o.rootElement.style.height="",o.rootElement.style.overflow="")}else void 0!==d&&(o.rootElement.style.height=isNaN(d)?`${d}`:`${d}px`,o.rootElement.style.overflow="hidden");if(void 0!==e.width){let t=e.width;Cg(t)&&(t=t()),o.rootElement.style.width=isNaN(t)?`${t}`:`${t}px`}if(!t){if(o.view){o.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),o.view._wt.exportSettingsAsClassNames();const t=o.getCurrentThemeName(),n=pm(e,"themeName");t&&n&&t!==e.themeName&&(o.view.getStylesHandler().removeClassNames(),o.view.removeClassNameFromLicenseElement(t));const r=n&&e.themeName||bM(o.rootElement);o.useTheme(r),o.view.addClassNameToLicenseElement(o.getCurrentThemeName())}o.runHooks("afterUpdateSettings",e)}h.adjustRowsAndCols(),o.view&&!p&&(o.forceFullRender=!0,o.view.render(),o.view._wt.wtOverlays.adjustElementsSize()),t||!o.view||""!==c&&""!==d&&void 0!==d||c===d||o.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){const e=o.getSelectedLast();if(y.getValue){if(Cg(y.getValue))return y.getValue.call(o);if(e)return o.getData()[e[0][0]][y.getValue]}else if(e)return o.getDataAtCell(e[0],e[1])},this.getSettings=function(){return y},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(e,t,n,r,i){h.alter(e,t,n,r,i)},this.getCell=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=t,i=e;if(t>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(t)))return null;r=this.columnIndexMapper.getRenderableFromVisualIndex(t)}if(e>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(e)))return null;i=this.rowIndexMapper.getRenderableFromVisualIndex(e)}return null===i||null===r||void 0===i||void 0===r?null:o.view.getCellAtCoords(o._createCellCoords(i,r),n)},this.getCoords=function(e){const t=this.view._wt.wtTable.getCoords(e);if(null===t)return null;const{row:n,col:r}=t;let i=n,s=r;return n>=0&&(i=this.rowIndexMapper.getVisualFromRenderableIndex(n)),r>=0&&(s=this.columnIndexMapper.getVisualFromRenderableIndex(r)),o._createCellCoords(i,s)},this.colToProp=function(e){return a.colToProp(e)},this.propToCol=function(e){return a.propToCol(e)},this.toVisualRow=e=>this.rowIndexMapper.getVisualFromPhysicalIndex(e),this.toVisualColumn=e=>this.columnIndexMapper.getVisualFromPhysicalIndex(e),this.toPhysicalRow=e=>this.rowIndexMapper.getPhysicalFromVisualIndex(e),this.toPhysicalColumn=e=>this.columnIndexMapper.getPhysicalFromVisualIndex(e),this.getDataAtCell=function(e,t){return a.get(e,a.colToProp(t))},this.getDataAtRowProp=function(e,t){return a.get(e,t)},this.getDataAtCol=function(e){const t=[],n=a.getRange(o._createCellCoords(0,e),o._createCellCoords(y.data.length-1,e),a.DESTINATION_RENDERER);for(let r=0;r<n.length;r+=1)for(let e=0;e<n[r].length;e+=1)t.push(n[r][e]);return t},this.getDataAtProp=function(e){const t=[],n=a.getRange(o._createCellCoords(0,a.propToCol(e)),o._createCellCoords(y.data.length-1,a.propToCol(e)),a.DESTINATION_RENDERER);for(let r=0;r<n.length;r+=1)for(let e=0;e<n[r].length;e+=1)t.push(n[r][e]);return t},this.getSourceData=function(e,t,n,r){let i;return i=void 0===e?l.getData():l.getByRange(o._createCellCoords(e,t),o._createCellCoords(n,r)),i},this.getSourceDataArray=function(e,t,n,r){let i;return i=void 0===e?l.getData(!0):l.getByRange(o._createCellCoords(e,t),o._createCellCoords(n,r),!0),i},this.getSourceDataAtCol=function(e){return l.getAtColumn(e)},this.setSourceDataAtCell=function(e,t,n,r){const i=I(e,t,n),s=this.hasHook("afterSetSourceDataAtCell"),a=[];s&&Vd(i,(e=>{let[t,n,r]=e;a.push([t,n,l.getAtCell(t,n),r])})),Vd(i,(e=>{let[t,n,r]=e;l.setAtCell(t,n,r)})),s&&this.runHooks("afterSetSourceDataAtCell",a,r),this.render();const h=o.getActiveEditor();h&&Gd(h.refreshValue)&&h.refreshValue()},this.getSourceDataAtRow=function(e){return l.getAtRow(e)},this.getSourceDataAtCell=function(e,t){return l.getAtCell(e,t)},this.getDataAtRow=function(e){return a.getRange(o._createCellCoords(e,0),o._createCellCoords(e,this.countCols()-1),a.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(e,t,n,r){const i=void 0===e?[0,0,this.countRows(),this.countCols()]:[e,t,n,r],[o,s]=i;let[,,a,l]=i,h=null,u=null;void 0===a&&(a=o),void 0===l&&(l=s);let c="mixed";return Jw(Math.max(Math.min(o,a),0),Math.max(o,a),(e=>{let t=!0;return Jw(Math.max(Math.min(s,l),0),Math.max(s,l),(n=>{const r=this.getCellMeta(e,n);return u=r.type,h?t=h===u:h=u,t})),c=t?u:"mixed",t})),c},this.removeCellMeta=function(e,t,n){const[r,i]=[this.toPhysicalRow(e),this.toPhysicalColumn(t)];let s=w.getCellMetaKeyValue(r,i,n);!1!==o.runHooks("beforeRemoveCellMeta",e,t,n,s)&&(w.removeCellMeta(r,i,n),o.runHooks("afterRemoveCellMeta",e,t,n,s)),s=null},this.spliceCellsMeta=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if(r.length>0&&!Array.isArray(r[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");t>0&&w.removeRow(this.toPhysicalRow(e),t),r.length>0&&Vd(r.reverse(),(t=>{w.createRow(this.toPhysicalRow(e)),Vd(t,((t,n)=>this.setCellMetaObject(e,n,t)))})),o.render()},this.setCellMetaObject=function(e,t,n){"object"==typeof n&&hm(n,((n,r)=>{this.setCellMeta(e,t,r,n)}))},this.setCellMeta=function(e,t,n,r){if(!1===o.runHooks("beforeSetCellMeta",e,t,n,r))return;let i=e,s=t;e<this.countRows()&&(i=this.toPhysicalRow(e)),t<this.countCols()&&(s=this.toPhysicalColumn(t)),w.setCellMeta(i,s,n,r),o.runHooks("afterSetCellMeta",e,t,n,r)},this.getCellsMeta=function(){return w.getCellsMeta()},this.getCellMeta=function(e,t){let n=this.toPhysicalRow(e),r=this.toPhysicalColumn(t);return null===n&&(n=e),null===r&&(r=t),w.getCellMeta(n,r,{visualRow:e,visualColumn:t})},this.getColumnMeta=function(e){return w.getColumnMeta(this.toPhysicalColumn(e))},this.getCellMetaAtRow=function(e){return w.getCellsMetaAtRow(e)},this.isColumnModificationAllowed=function(){return!("object"===o.dataType||y.columns)},this.getCellRenderer=function(e,t){const n="number"==typeof e?o.getCellMeta(e,t).renderer:e.renderer;return"string"==typeof n?Ry(n):zd(n)?Ry("text"):n},this.getCellEditor=function(e,t){const n="number"==typeof e?o.getCellMeta(e,t).editor:e.editor;return"string"==typeof n?Lf(n):zd(n)?Lf("text"):n},this.getCellValidator=function(e,t){const n="number"==typeof e?o.getCellMeta(e,t).validator:e.validator;return"string"==typeof n?function(e){if("function"==typeof e)return e;if(!Ny(e))throw Error(`No registered validator found under "${e}" name`);return Ty(e)}(n):n},this.validateCells=function(e){this._validateCells(e)},this.validateRows=function(e,t){if(!Array.isArray(e))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(t,e)},this.validateColumns=function(e,t){if(!Array.isArray(e))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(t,void 0,e)},this._validateCells=function(e,t,n){const r=new T;e&&(r.onQueueEmpty=e);let i=o.countRows()-1;for(;i>=0;){if(void 0!==t&&-1===t.indexOf(i)){i-=1;continue}let e=o.countCols()-1;for(;e>=0;)void 0===n||-1!==n.indexOf(e)?(r.addValidatorToQueue(),o.validateCell(o.getDataAtCell(i,e),o.getCellMeta(i,e),(e=>{if("boolean"!=typeof e)throw new Error("Validation error: result is not boolean");!1===e&&(r.valid=!1),r.removeValidatorFormQueue()}),"validateCells"),e-=1):e-=1;i-=1}r.checkIfQueueIsEmpty()},this.getRowHeader=function(e){let t=y.rowHeaders,n=e;return void 0!==n&&(n=o.runHooks("modifyRowHeader",n)),void 0===n?(t=[],Jw(o.countRows()-1,(e=>{t.push(o.getRowHeader(e))}))):Array.isArray(t)&&void 0!==t[n]?t=t[n]:Cg(t)?t=t(n):t&&"string"!=typeof t&&"number"!=typeof t&&(t=n+1),t},this.hasRowHeaders=function(){return!!y.rowHeaders},this.hasColHeaders=function(){if(void 0!==y.colHeaders&&null!==y.colHeaders)return!!y.colHeaders;for(let e=0,t=o.countCols();e<t;e++)if(o.getColHeader(e))return!0;return!1},this.getColHeader=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;const n=o.runHooks("modifyColHeader",e);if(void 0===n){const e=[],t=o.countCols();for(let n=0;n<t;n++)e.push(o.getColHeader(n));return e}let r=y.colHeaders;const i=o.toPhysicalColumn(n),s=function(e){const t=[],n=o.countCols();let r=0;for(;r<n;r++)Cg(y.columns)&&y.columns(r)&&t.push(r);return t[e]}(i);return!1===y.colHeaders?r=null:y.columns&&Cg(y.columns)&&y.columns(s)&&y.columns(s).title?r=y.columns(s).title:y.columns&&y.columns[i]&&y.columns[i].title?r=y.columns[i].title:Array.isArray(y.colHeaders)&&void 0!==y.colHeaders[i]?r=y.colHeaders[i]:Cg(y.colHeaders)?r=y.colHeaders(i):y.colHeaders&&"string"!=typeof y.colHeaders&&"number"!=typeof y.colHeaders&&(r=function(e){let t,n=e+1,r="";for(;n>0;)t=(n-1)%EE,r=String.fromCharCode(65+t)+r,n=parseInt((n-t)/EE,10);return r}(n)),r=o.runHooks("modifyColumnHeaderValue",r,e,t),r},this._getColWidthFromSettings=function(e){let t;if(e>=0){t=o.getCellMeta(0,e).width}if(void 0!==t&&t!==y.width||(t=y.colWidths),null!=t){switch(typeof t){case"object":t=t[e];break;case"function":t=t(e)}"string"==typeof t&&(t=parseInt(t,10))}return t},this.getColWidth=function(e,t){let n=o._getColWidthFromSettings(e);return n=o.runHooks("modifyColWidth",n,e,t),void 0===n&&(n=ov),n},this._getRowHeightFromSettings=function(e){const t=this.view.getDefaultRowHeight();let n=y.rowHeights;if(null!=n){switch(typeof n){case"object":n=n[e];break;case"function":n=n(e)}"string"==typeof n&&(n=parseInt(n,10))}return null!=n&&n<t?t:n},this.getRowHeight=function(e,t){let n=o._getRowHeightFromSettings(e);return n=o.runHooks("modifyRowHeight",n,e,t),n},this.countSourceRows=function(){return l.countRows()},this.countSourceCols=function(){return l.countFirstRowKeys()},this.countRows=function(){return a.getLength()},this.countCols=function(){const e=y.maxCols,t=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(e,t)},this.countRenderedRows=function(){return o.view._wt.drawn?o.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return o.view._wt.drawn?o.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return o.view._wt.drawn?o.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return o.view._wt.drawn?o.view._wt.wtTable.getVisibleColumnsCount():-1},this.countRowHeaders=function(){return this.view.getRowHeadersCount()},this.countColHeaders=function(){return this.view.getColumnHeadersCount()},this.countEmptyRows=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=0;return ey(o.countRows()-1,(n=>{if(o.isEmptyRow(n))t+=1;else if(!0===e)return!1})),t},this.countEmptyCols=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=0;return ey(o.countCols()-1,(n=>{if(o.isEmptyCol(n))t+=1;else if(!0===e)return!1})),t},this.isEmptyRow=function(e){return y.isEmptyRow.call(o,e)},this.isEmptyCol=function(e){return y.isEmptyCol.call(o,e)},this.selectCell=function(e,t,n,r){let i=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],o=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];return!zd(e)&&!zd(t)&&this.selectCells([[e,t,n,r]],i,o)},this.selectCells=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[[]],t=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];!1===(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&d.suspend();const n=S.selectCells(e);return n&&t&&o.listen(),d.resume(),n},this.selectColumns=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,n=arguments.length>2?arguments[2]:void 0;return S.selectColumns(e,t,n)},this.selectRows=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,n=arguments.length>2?arguments[2]:void 0;return S.selectRows(e,t,n)},this.deselectCell=function(){S.deselect()},this.selectAll=function(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,n=arguments.length>2?arguments[2]:void 0;d.skipNextScrollCycle(),S.selectAll(e,t,n)};const x=(e,t)=>e.getNearestNotHiddenIndex(t,1,!0);this.scrollViewportTo=function(e){var t;"number"==typeof e&&(e={row:arguments[0],col:arguments[1],verticalSnap:arguments[2]?"bottom":"top",horizontalSnap:arguments[3]?"end":"start",considerHiddenIndexes:null===(t=arguments[4])||void 0===t||t});const{row:n,col:r,considerHiddenIndexes:i}=null!=e?e:{};let s=n,a=r;if(void 0===i||i){const e=Number.isInteger(n)&&n>=0,t=Number.isInteger(r)&&r>=0,i=e?x(this.rowIndexMapper,n):void 0,l=t?x(this.columnIndexMapper,r):void 0;if(null===i||null===l)return!1;s=e?o.rowIndexMapper.getRenderableFromVisualIndex(i):n,a=t?o.columnIndexMapper.getRenderableFromVisualIndex(l):r}const l=Number.isInteger(s),h=Number.isInteger(a);return l&&s>=0&&h&&a>=0?o.view.scrollViewport(o._createCellCoords(s,a),e.horizontalSnap,e.verticalSnap):l&&s>=0&&(h&&a<0||!h)?o.view.scrollViewportVertically(s,e.verticalSnap):!!(h&&a>=0&&(l&&s<0||!l))&&o.view.scrollViewportHorizontally(a,e.horizontalSnap)},this.scrollToFocusedCell=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:()=>{};if(!this.selection.isSelected())return;this.addHookOnce("afterScroll",e);const{highlight:t}=this.getSelectedRangeLast();this.scrollViewportTo(t.toObject())?this.view.render():(this.removeHook("afterScroll",e),this._registerImmediate((()=>e())))},this.destroy=function(){if(o._clearTimeouts(),o._clearImmediates(),o.view&&o.view.destroy(),l&&l.destroy(),l=null,this.getShortcutManager().destroy(),w.clearCache(),NM.delete(this.guid),JR(o)){const e=this.rootDocument.querySelector(".hot-display-license-info");e&&e.parentNode.removeChild(e)}Wp(o.rootElement),s.destroy(),u&&u.destroy(),o.batchExecution((()=>{o.rowIndexMapper.unregisterAll(),o.columnIndexMapper.unregisterAll(),C.getItems().forEach((e=>{let[,t]=e;t.destroy()})),C.clear(),o.runHooks("afterDestroy")}),!0),Rf.getSingleton().destroy(o),hm(o,((e,t,n)=>{var r;Cg(e)?n[t]=(r=t,()=>{throw new Error(`The "${r}" method cannot be called because this Handsontable instance has been destroyed`)}):"guid"!==t&&(n[t]=null)})),o.isDestroyed=!0,a&&a.destroy(),a=null,h=null,S=null,u=null,o=null},this.getActiveEditor=function(){return u.getActiveEditor()},this.getFirstRenderedVisibleRow=function(){return o.view.getFirstRenderedVisibleRow()},this.getLastRenderedVisibleRow=function(){return o.view.getLastRenderedVisibleRow()},this.getFirstRenderedVisibleColumn=function(){return o.view.getFirstRenderedVisibleColumn()},this.getLastRenderedVisibleColumn=function(){return o.view.getLastRenderedVisibleColumn()},this.getFirstFullyVisibleRow=function(){return o.view.getFirstFullyVisibleRow()},this.getLastFullyVisibleRow=function(){return o.view.getLastFullyVisibleRow()},this.getFirstFullyVisibleColumn=function(){return o.view.getFirstFullyVisibleColumn()},this.getLastFullyVisibleColumn=function(){return o.view.getLastFullyVisibleColumn()},this.getFirstPartiallyVisibleRow=function(){return o.view.getFirstPartiallyVisibleRow()},this.getLastPartiallyVisibleRow=function(){return o.view.getLastPartiallyVisibleRow()},this.getFirstPartiallyVisibleColumn=function(){return o.view.getFirstPartiallyVisibleColumn()},this.getLastPartiallyVisibleColumn=function(){return o.view.getLastPartiallyVisibleColumn()},this.getPlugin=function(e){return C.getItem(op(e))},this.getPluginName=function(e){return e===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:C.getId(e)},this.getInstance=function(){return o},this.addHook=function(e,t,n){Rf.getSingleton().add(e,t,o,n)},this.hasHook=function(e){return Rf.getSingleton().has(e,o)||Rf.getSingleton().has(e)},this.addHookOnce=function(e,t,n){Rf.getSingleton().once(e,t,o,n)},this.removeHook=function(e,t){Rf.getSingleton().remove(e,t,o)},this.runHooks=function(e,t,n,r,i,s,a){return Rf.getSingleton().run(o,e,t,n,r,i,s,a)},this.getTranslatedPhrase=function(e,t){return sN(y.language,e,t)},this.toHTML=()=>qw(this),this.toTableElement=()=>{const e=this.rootDocument.createElement("div");return e.insertAdjacentHTML("afterbegin",qw(this)),e.firstElementChild},this.timeouts=[],this.useTheme=e=>{this.view.getStylesHandler().useTheme(e),this.runHooks("afterSetTheme",e,!!p)},this.getCurrentThemeName=()=>this.view.getStylesHandler().getThemeName(),this._registerTimeout=function(e){let t=e;"function"==typeof t&&(t=setTimeout(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0)),this.timeouts.push(t)},this._clearTimeouts=function(){Vd(this.timeouts,(e=>{clearTimeout(e)}))},this.immediates=[],this._registerImmediate=function(e){this.immediates.push(setImmediate(e))},this._clearImmediates=function(){Vd(this.immediates,(e=>{clearImmediate(e)}))},this._getEditorManager=function(){return u};const P=EM({handleEvent:()=>o.isListening(),beforeKeyDown:e=>this.runHooks("beforeKeyDown",e),afterKeyDown:e=>{this.isDestroyed||o.runHooks("afterDocumentKeyDown",e)},ownerWindow:this.rootWindow});var _;this.addHook("beforeOnCellMouseDown",(e=>{!1===e.ctrlKey&&!1===e.metaKey&&P.releasePressedKeys()})),this.getShortcutManager=function(){return P},this.getFocusManager=function(){return c},gy().forEach((e=>{const t=my(e);C.addItem(e,new t(this))})),_=o,[lM,aM].forEach((e=>e(_))),P.setActiveContextName("grid"),Rf.getSingleton().run(o,"construct")}function MM(e,t,n){e.addEventListener(t,n,!1)}function IM(e,t,n){e.removeEventListener(t,n,!1)}function OM(e){return e.ownerDocument.defaultView.getComputedStyle(e)}function xM(e){const t={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300,textContent:e=>e.value,...arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}},n=e.body,r=e.createTextNode(""),i=e.createElement("span");let o;function s(){var e,s;r.textContent=t.textContent(o),i.style.position="absolute",i.style.fontSize=OM(o).fontSize,i.style.fontFamily=OM(o).fontFamily,i.style.whiteSpace="pre",n.appendChild(i);const a=parseInt((null===(e=OM(o))||void 0===e?void 0:e.paddingInlineStart)||0,10),l=parseInt((null===(s=OM(o))||void 0===s?void 0:s.paddingInlineEnd)||0,10),h=i.clientWidth+a+l+1;n.removeChild(i);const u=o.style;u.height=`${t.minHeight}px`,t.minWidth>h?u.width=`${t.minWidth}px`:h>t.maxWidth?u.width=`${t.maxWidth}px`:u.width=`${h}px`;const c=o.scrollHeight?o.scrollHeight-1:0;t.minHeight>c?u.height=`${t.minHeight}px`:t.maxHeight<c?(u.height=`${t.maxHeight}px`,u.overflowY="visible"):u.height=`${c}px`}function a(){e.defaultView.setTimeout(s,0)}return{init:function(e,n){let l=arguments.length>2&&void 0!==arguments[2]&&arguments[2];o=e,function(e){if(e&&e.minHeight)if("inherit"===e.minHeight)t.minHeight=o.clientHeight;else{const n=parseInt(e.minHeight,10);isNaN(n)||(t.minHeight=n)}if(e&&e.maxHeight)if("inherit"===e.maxHeight)t.maxHeight=o.clientHeight;else{const n=parseInt(e.maxHeight,10);isNaN(n)||(t.maxHeight=n)}if(e&&e.minWidth)if("inherit"===e.minWidth)t.minWidth=o.clientWidth;else{const n=parseInt(e.minWidth,10);isNaN(n)||(t.minWidth=n)}if(e&&e.maxWidth)if("inherit"===e.maxWidth)t.maxWidth=o.clientWidth;else{const n=parseInt(e.maxWidth,10);isNaN(n)||(t.maxWidth=n)}i.firstChild||(i.className="autoResize",i.style.display="inline-block",i.appendChild(r))}(n),"TEXTAREA"===o.nodeName&&(o.style.resize="none",o.style.height=`${t.minHeight}px`,o.style.minWidth=`${t.minWidth}px`,o.style.maxWidth=`${t.maxWidth}px`,o.style.overflowY="hidden"),l&&(MM(o,"input",s),MM(o,"keydown",a)),s()},resize:s,unObserve(){IM(o,"input",s),IM(o,"keydown",a)}}}function PM(e,t){const n=og(t),r=t.value.split("\n");let i=n,o=0;for(let s=0;s<r.length;s++){const t=r[s];0!==s&&(o+=r[s-1].length+1);const a=o+t.length;if("home"===e?i=o:"end"===e&&(i=a),n<=a)break}ag(t,i)}function _M(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const LM="ht_editor_hidden",HM="textEditor";class kM extends nM{static get EDITOR_TYPE(){return"text"}constructor(e){super(e),_M(this,"eventManager",new Ff(this)),_M(this,"autoResize",xM(this.hot.rootDocument)),_M(this,"TEXTAREA",void 0),_M(this,"textareaStyle",void 0),_M(this,"TEXTAREA_PARENT",void 0),_M(this,"textareaParentStyle",void 0),_M(this,"layerClass",void 0),this.eventManager=new Ff(this),this.createElements(),this.bindEvents(),this.hot.addHookOnce("afterDestroy",(()=>this.destroy()))}getValue(){return this.TEXTAREA.value}setValue(e){this.TEXTAREA.value=e}open(){this.refreshDimensions(),this.showEditableElement(),this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this.autoResize.unObserve(),Mp(this.hot.rootDocument.activeElement,this.hot.rootElement)&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts()}prepare(e,t,n,r,i,o){const s=this.state;if(super.prepare(e,t,n,r,i,o),!o.readOnly){this.refreshDimensions(!0);const{allowInvalid:e}=o;e&&!this.isOpened()&&(this.TEXTAREA.value=""),s===tM.FINISHED||this.isOpened()||this.hideEditableElement()}}beginEditing(e,t){this.state===tM.VIRGIN&&(this.TEXTAREA.value="",super.beginEditing(e,t))}focus(){this.TEXTAREA.select(),ag(this.TEXTAREA,this.TEXTAREA.value.length)}createElements(){const{rootDocument:e}=this.hot;this.TEXTAREA=e.createElement("TEXTAREA"),Vp(this.TEXTAREA,[["data-hot-input",""],cp(-1)]),Fp(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=e.createElement("DIV"),Fp(this.TEXTAREA_PARENT,"handsontableInputHolder"),kp(this.TEXTAREA_PARENT,this.layerClass)&&Dp(this.TEXTAREA_PARENT,this.layerClass),Fp(this.TEXTAREA_PARENT,LM),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}hideEditableElement(){vm.edge.value&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",Dp(this.TEXTAREA_PARENT,this.layerClass),Fp(this.TEXTAREA_PARENT,LM)}showEditableElement(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="";const e=this.TEXTAREA_PARENT.childNodes;let t=!1;Jw(e.length-1,(n=>{if(kp(e[n],"handsontableEditor"))return t=!0,!1})),kp(this.TEXTAREA_PARENT,LM)&&Dp(this.TEXTAREA_PARENT,LM),t?(this.layerClass="ht_editor_visible",Fp(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),Fp(this.TEXTAREA_PARENT,this.layerClass))}refreshValue(){const e=this.hot.toPhysicalRow(this.row),t=this.hot.getSourceDataAtCell(e,this.col);this.originalValue=t,this.setValue(t),this.refreshDimensions()}refreshDimensions(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.state!==tM.EDITING&&!e)return;if(this.TD=this.getEditedCell(),!this.TD)return void(e||this.close());const{top:t,start:n,width:r,maxWidth:i,height:o,maxHeight:s}=this.getEditedCellRect();this.textareaParentStyle.top=`${t}px`,this.textareaParentStyle[this.hot.isRtl()?"right":"left"]=`${n}px`,this.showEditableElement();const a=this.hot.rootWindow.getComputedStyle(this.TD);this.TEXTAREA.style.fontSize=a.fontSize,this.TEXTAREA.style.fontFamily=a.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor,this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(r,i),minHeight:Math.min(o,s),maxWidth:i,maxHeight:s},!0)}bindEvents(){Tm()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",(()=>this.finishEditing(!1))),this.addHook("afterScrollHorizontally",(()=>this.refreshDimensions())),this.addHook("afterScrollVertically",(()=>this.refreshDimensions())),this.addHook("afterColumnResize",(()=>{this.refreshDimensions(),this.state===tM.EDITING&&this.focus()})),this.addHook("afterRowResize",(()=>{this.refreshDimensions(),this.state===tM.EDITING&&this.focus()}))}allowKeyEventPropagation(){}destroy(){this.eventManager.destroy(),this.clearHooks()}registerShortcuts(){const e=this.hot.getShortcutManager().getContext("editor"),t={runOnlyIf:()=>Gd(this.hot.getSelected()),group:HM},n=()=>{this.hot.rootDocument.execCommand("insertText",!1,"\n")};e.addShortcuts([{keys:[["Control","Enter"]],callback:()=>(n(),!1),runOnlyIf:e=>!this.hot.selection.isMultiple()&&!e.altKey},{keys:[["Meta","Enter"]],callback:()=>(n(),!1),runOnlyIf:()=>!this.hot.selection.isMultiple()},{keys:[["Alt","Enter"]],callback:()=>(n(),!1)},{keys:[["Home"]],callback:(e,t)=>{let[n]=t;PM(n,this.TEXTAREA)}},{keys:[["End"]],callback:(e,t)=>{let[n]=t;PM(n,this.TEXTAREA)}}],t)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(HM)}}function FM(e,t,n,r,i,o,s){const a=s.ariaTags,l=[],h=[],u=[],c=[];s.className&&Fp(t,s.className),s.readOnly?(l.push(s.readOnlyCellClassName),a&&c.push(Rp())):a&&u.push(Rp()[0]),!1===s.valid&&s.invalidCellClassName?(l.push(s.invalidCellClassName),a&&c.push(Ep())):(h.push(s.invalidCellClassName),a&&u.push(Ep()[0])),!1===s.wordWrap&&s.noWordWrapClassName&&l.push(s.noWordWrapClassName),!o&&s.placeholder&&l.push(s.placeholderCellClassName),Dp(t,h),Fp(t,l),Up(t,u),Vp(t,c)}FM.RENDERER_TYPE="base";function DM(e,t,n,r,i,o,s){FM.apply(this,[e,t,n,r,i,o,s]);let a=o;!a&&s.placeholder&&(a=s.placeholder),a=jd(a),s.trimWhitespace&&(a=a.trim()),zp(t,a)}DM.RENDERER_TYPE="text";const VM={CELL_TYPE:"text",editor:kM,renderer:DM};function UM(e,t){const n=new AM(e,t||{},QR);return n.init(),n}function BM(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t);if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function WM(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function jM(e){return jM="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},jM(e)}EA(VM),UM.editors={BaseEditor:nM},UM.Core=function(e){return new AM(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},QR)},UM.DefaultSettings=MA(),UM.hooks=Rf.getSingleton(),UM.CellCoords=fv,UM.CellRange=Ev,UM.packageName="handsontable",UM.buildDate="19/03/2025 09:41:52",UM.version="15.2.0",UM.languages={dictionaryKeys:QT,getLanguageDictionary:iN,getLanguagesDictionaries:function(){return nN()},registerLanguageDictionary:rN,getTranslatedPhrase:sN};var GM=Symbol("unassigned");function zM(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function $M(e){var t=UM.hooks.getRegistered(),n={};for(var r in Object.assign(n,UM.DefaultSettings),n)n[r]={default:GM};for(var i=0;i<t.length;i++)n[t[i]]={default:GM};return n.settings={default:GM},"HotTable"===e&&(n.id={type:String,default:"hot-".concat(Math.random().toString(36).substring(5))}),n}function YM(e){var t={},n=e.settings;if(n!==GM)for(var r in n)zM(n,r)&&n[r]!==GM&&(t[r]=n[r]);for(var i in e)zM(e,i)&&"settings"!==i&&e[i]!==GM&&(t[i]=e[i]);return t}function KM(e,t){var n=YM(e),r=e.settings?e.settings:n,i=e.settings?n:null,o={};for(var s in r)!zM(r,s)||void 0===r[s]||t&&"data"!==s&&XM(t[s],r[s])||(o[s]=r[s]);for(var a in i)!zM(i,a)||"id"===a||"settings"===a||void 0===i[a]||t&&"data"!==a&&XM(t[a],i[a])||(o[a]=i[a]);return o}function XM(e,t){var n=function(e){var t,n=(t=new WeakSet,function(e,n){if("object"===jM(n)&&null!==n){if(t.has(n))return;t.add(n)}return n});return JSON.stringify(e,n)};return"function"==typeof e&&"function"==typeof t?e.toString()===t.toString():jM(e)===jM(t)&&n(e)===n(t)}var qM=n({name:"HotTable",props:$M("HotTable"),provide:function(){return{columnsCache:this.columnsCache}},watch:{$props:{handler:function(e){var t=KM(e,this.hotInstance?this.hotInstance.getSettings():void 0);this.hotInstance&&void 0!==t&&(t.data&&(this.hotInstance.isColumnModificationAllowed()||!this.hotInstance.isColumnModificationAllowed()&&this.hotInstance.countSourceCols()===this.miscCache.currentSourceColumns)&&(this.matchHotMappersSize(),delete t.data),Object.keys(t).length?this.hotInstance.updateSettings(t):this.hotInstance.render(),this.miscCache.currentSourceColumns=this.hotInstance.countSourceCols())},deep:!0,immediate:!0}},data:function(){return{__hotInstance:null,miscCache:{currentSourceColumns:null},columnSettings:null,columnsCache:new Map,get hotInstance(){return!this.__hotInstance||this.__hotInstance&&!this.__hotInstance.isDestroyed?this.__hotInstance:(console.warn("The Handsontable instance bound to this component was destroyed and cannot be used properly."),null)},set hotInstance(e){this.__hotInstance=e}}},methods:{hotInit:function(){var e=KM(this.$props);e.columns=this.columnSettings?this.columnSettings:e.columns,this.hotInstance=r(new UM.Core(this.$el,e)),this.hotInstance.init(),this.miscCache.currentSourceColumns=this.hotInstance.countSourceCols()},matchHotMappersSize:function(){var e=this;if(this.hotInstance){var t,n=this.hotInstance.getSourceData(),r=[],i=[],o=this.hotInstance.rowIndexMapper.getNumberOfIndexes(),s=this.hotInstance.isColumnModificationAllowed(),a=0;if(n&&n.length!==o&&n.length<o)for(var l=n.length;l<o;l++)r.push(l);if(s)if(a=this.hotInstance.columnIndexMapper.getNumberOfIndexes(),n&&n[0]&&(null===(t=n[0])||void 0===t?void 0:t.length)!==a&&n[0].length<a)for(var h=n[0].length;h<a;h++)i.push(h);this.hotInstance.batch((function(){r.length>0?e.hotInstance.rowIndexMapper.removeIndexes(r):e.hotInstance.rowIndexMapper.insertIndexes(o-1,n.length-o),s&&0!==n.length&&(i.length>0?e.hotInstance.columnIndexMapper.removeIndexes(i):e.hotInstance.columnIndexMapper.insertIndexes(a-1,n[0].length-a))}))}},getColumnSettings:function(){var e=Array.from(this.columnsCache.values());return e.length?e:void 0}},mounted:function(){this.columnSettings=this.getColumnSettings(),this.hotInit()},beforeUnmount:function(){this.hotInstance&&this.hotInstance.destroy()},version:"15.2.0"}),QM=["id"];qM.render=function(e,t,n,r,a,l){return i(),o("div",{id:e.id},[s(e.$slots,"default")],8,QM)},qM.__file="src/HotTable.vue",n({name:"HotColumn",props:$M("HotColumn"),inject:["columnsCache"],methods:{createColumnSettings:function(){var e=YM(this.$props),t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?WM(Object(n),!0).forEach((function(t){BM(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):WM(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e);e.renderer&&(t.renderer=e.renderer),e.editor&&(t.editor=e.editor),this.columnsCache.set(this,t)}},mounted:function(){this.createColumnSettings()},unmounted:function(){this.columnsCache.delete(this)},render:function(){return null}}).__file="src/HotColumn.vue";const ZM="handsontableEditor";class JM extends kM{static get EDITOR_TYPE(){return"handsontable"}open(){super.open();const e=this.htContainer.style;this.htEditor&&(this.htEditor.destroy(),e.width="",e.height="",e.overflow=""),"none"===e.display&&(e.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),ag(this.TEXTAREA,0,this.TEXTAREA.value.length),this.htEditor.updateSettings({width:this.getWidth(),height:this.getHeight()}),this.refreshDimensions()}close(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),super.close()}prepare(e,t,n,r,i,o){super.prepare(e,t,n,r,i,o);const s=this,a={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,ariaTags:!1,themeName:this.hot.getCurrentThemeName(),afterOnCellMouseDown(e,t){const n=this.getSourceData(t.row,t.col);void 0!==n&&s.setValue(n),s.hot.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&tm(a,o.handsontable),this.htOptions=a}beginEditing(e,t){const n=this.hot.getSettings().onBeginEditing;n&&!1===n()||super.beginEditing(e,t)}createElements(){super.createElements();const e=this.hot.rootDocument.createElement("DIV");e.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(e),this.htContainer=e,this.assignHooks()}finishEditing(e,t,n){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){const e=this.htEditor.getValue();void 0!==e&&this.setValue(e)}super.finishEditing(e,t,n)}getHeight(){return this.htEditor.view.getTableHeight()+1}getWidth(){return this.htEditor.view.getTableWidth()}assignHooks(){this.hot.addHook("afterDestroy",(()=>{var e;null===(e=this.htEditor)||void 0===e||e.destroy()})),this.hot.addHook("afterSetTheme",((e,t)=>{var n;t||(null===(n=this.htEditor)||void 0===n||n.useTheme(e))}))}registerShortcuts(){const e=this.hot.getShortcutManager().getContext("editor");super.registerShortcuts();const t={group:ZM,relativeToGroup:qA,position:"before"},n=(e,t)=>{const n=this.htEditor;if(void 0!==e&&(e<0||n.flipped&&e>n.countRows()-1?n.deselectCell():n.selectCell(e,0),n.getData().length))return t.preventDefault(),_m(t),this.hot.listen(),this.TEXTAREA.focus(),!1};e.addShortcuts([{keys:[["ArrowUp"]],callback:e=>{const t=this.htEditor;let r,i;return!t.getSelectedLast()&&t.flipped?r=t.countRows()-1:t.getSelectedLast()&&(t.flipped?(i=t.getSelectedLast()[0],r=Math.max(0,i-1)):(i=t.getSelectedLast()[0],r=i-1)),n(r,e)},preventDefault:!1},{keys:[["ArrowDown"]],callback:e=>{const t=this.htEditor;let r,i;if(t.getSelectedLast()||t.flipped){if(t.getSelectedLast())if(t.flipped)r=t.getSelectedLast()[0]+1;else if(!t.flipped){const e=t.countRows()-1;i=t.getSelectedLast()[0],r=Math.min(e,i+1)}}else r=0;return n(r,e)},preventDefault:!1}],t)}unregisterShortcuts(){super.unregisterShortcuts();this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(ZM)}}function eI(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function tI(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function nI(e,t){return e.get(rI(e,t))}function rI(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var iI=new WeakMap,oI=new WeakSet;class sI extends JM{constructor(){var e,t;super(...arguments),eI(e=this,t=oI),t.add(e),tI(this,"query",null),tI(this,"strippedChoices",[]),tI(this,"rawChoices",[]),function(e,t,n){eI(e,t),t.set(e,n)}(this,iI,this.hot.guid.slice(0,9)),tI(this,"sortByRelevance",(function(e,t,n){const r=[],i=[],o=e.length;let s,a,l,h,u=t.length;if(0===o){for(l=0;l<u;l++)i.push(l);return i}for(l=0;l<u;l++){if(a=hp(jd(t[l])),n)h=a.indexOf(e);else{const t=this.cellProperties.locale;h=a.toLocaleLowerCase(t).indexOf(e.toLocaleLowerCase(t))}-1!==h&&(s=a.length-h-o,r.push({baseIndex:l,index:h,charsLeft:s,value:a}))}for(r.sort(((e,t)=>{if(-1===t.index)return-1;if(-1===e.index)return 1;if(e.index<t.index)return-1;if(t.index<e.index)return 1;if(e.index===t.index){if(e.charsLeft<t.charsLeft)return-1;if(e.charsLeft>t.charsLeft)return 1}return 0})),l=0,u=r.length;l<u;l++)i.push(r[l].baseIndex);return i}))}static get EDITOR_TYPE(){return"autocomplete"}getValue(){const e=this.rawChoices.find((e=>this.stripValueIfNeeded(e)===this.TEXTAREA.value));return Gd(e)?e:this.TEXTAREA.value}createElements(){super.createElements(),Fp(this.htContainer,"autocompleteEditor"),Fp(this.htContainer,-1===this.hot.rootWindow.navigator.platform.indexOf("Mac")?"":"htMacScroll"),this.hot.getSettings().ariaTags&&Vp(this.TEXTAREA,[["type","text"],["role","combobox"],fp("listbox"),["aria-autocomplete","list"]])}prepare(e,t,n,r,i,o){var s;super.prepare(e,t,n,r,i,o),this.hot.getSettings().ariaTags&&Vp(this.TEXTAREA,[Sp("false"),(s=`${nI(iI,this)}-listbox-${e}-${t}`,["aria-controls",s])])}open(){super.open();const e=void 0===this.cellProperties.trimDropdown||this.cellProperties.trimDropdown,t=this.hot.getSettings().ariaTags,n=Array.isArray(this.cellProperties.source)?this.cellProperties.source:null,r=null==n?void 0:n.length,{row:i,col:o}=this;var s;this.showEditableElement(),this.focus(),this.addHook("beforeKeyDown",(e=>this.onBeforeKeyDown(e))),this.htEditor.updateSettings({colWidths:e?[tg(this.TEXTAREA)-2]:void 0,autoColumnSize:!0,autoRowSize:!0,renderer:(e,i,o,s,a,l,h)=>{DM(e,i,o,s,a,l,h);const{filteringCaseSensitive:u,allowHtml:c,locale:d}=this.cellProperties,p=this.query;let g,m,f=jd(l);var w;f&&!c&&(g=!0===u?f.indexOf(p):f.toLocaleLowerCase(d).indexOf(p.toLocaleLowerCase(d)),-1!==g&&(m=f.substr(g,p.length),f=f.replace(m,`<strong>${m}</strong>`))),t&&Vp(i,[["role","option"],...n?[(w=r,["aria-setsize",w])]:[],...n?[Np(n.indexOf(l)+1)]:[],["id",`${this.htEditor.rootElement.id}_${o}-${s}`]]),i.innerHTML=f},afterSelectionEnd:(e,n)=>{if(t){const t=this.htEditor.getCell(e,n,!0);Vp(t,[["aria-selected","true"]]),Vp(this.TEXTAREA,...(r=t.id,["aria-activedescendant",r]))}var r}}),t&&(Vp(this.htEditor.view._wt.wtOverlays.wtTable.TABLE,...dp()),Vp(this.htEditor.rootElement,[["role","listbox"],(s="polite",["aria-live",s]),Tp("text"),["id",`${nI(iI,this)}-listbox-${i}-${o}`]]),Vp(this.TEXTAREA,...Sp("true"))),this.hot._registerTimeout((()=>{this.queryChoices(this.TEXTAREA.value)}))}close(){this.removeHooksByKey("beforeKeyDown"),super.close(),this.hot.getSettings().ariaTags&&Vp(this.TEXTAREA,[Sp("false")])}discardEditor(e){super.discardEditor(e),this.hot.view.render()}queryChoices(e){const t=this.cellProperties.source;this.query=e,"function"==typeof t?t.call(this.cellProperties,e,(e=>{this.rawChoices=e,this.updateChoicesList(this.stripValuesIfNeeded(e))})):Array.isArray(t)?(this.rawChoices=t,this.updateChoicesList(this.stripValuesIfNeeded(t))):this.updateChoicesList([])}updateChoicesList(e){const t=og(this.TEXTAREA),n=(r=this.TEXTAREA).selectionEnd?r.selectionEnd:0;var r;const i=this.cellProperties.sortByRelevance,o=this.cellProperties.filter;let s=null,a=null,l=e;i&&(s=this.sortByRelevance(this.stripValueIfNeeded(this.getValue()),l,this.cellProperties.filteringCaseSensitive));const h=Array.isArray(s)?s.length:0;if(!1===o)a=h>0?s[0]:0;else{const e=[];for(let t=0,n=l.length;t<n&&!(i&&h<=t);t++)h?e.push(l[s[t]]):e.push(l[t]);a=0,l=e}this.strippedChoices=l,0===l.length?this.htEditor.rootElement.style.display="none":this.htEditor.rootElement.style.display="",this.htEditor.loadData(Hd([l])),l.length>0&&(this.updateDropdownDimensions(),this.flipDropdownIfNeeded(),!0===this.cellProperties.strict&&this.highlightBestMatchingChoice(a)),this.hot.listen(),ag(this.TEXTAREA,t,t===n?void 0:n)}flipDropdownIfNeeded(){const e=this.getEditedCellRect(),t=e.height;let n=e.top;if(this.hot.view.isVerticallyScrollableByWindow()){const e=this.hot.view.getTableOffset().top-this.hot.rootWindow.scrollY;n=Math.max(n+e,0)}const r=this.getHeight(),i=this.hot.view.getWorkspaceHeight()-n-t,o=r>i&&n>i+t;return o?this.flipDropdown(r):this.unflipDropdown(),this.limitDropdownIfNeeded(o?n:i,r),o}limitDropdownIfNeeded(e,t){if(t>e){let n=0,r=0,i=0,o=null;do{i=this.htEditor.getRowHeight(r)||this.htEditor.view.getDefaultRowHeight(),n+=i,r+=1}while(n<e);o=n-i,this.htEditor.flipped&&(this.htEditor.rootElement.style.top=parseInt(this.htEditor.rootElement.style.top,10)+t-o+"px"),this.setDropdownHeight(n-i)}}flipDropdown(e){const t=this.htEditor.rootElement.style;t.position="absolute",t.top=-e+"px",this.htEditor.flipped=!0}unflipDropdown(){const e=this.htEditor.rootElement.style;e.position="absolute",e.top="",this.htEditor.flipped=void 0}updateDropdownDimensions(){this.htEditor.updateSettings({width:this.getWidth(),height:this.getHeight()}),rI(oI,this,aI).call(this),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}setDropdownHeight(e){this.htEditor.updateSettings({height:e}),rI(oI,this,aI).call(this),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}highlightBestMatchingChoice(e){"number"==typeof e?this.htEditor.selectCell(e,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}getHeight(){const e=this.hot.rootWindow.getComputedStyle(this.htContainer.querySelector(".htCore")),t=parseInt(e.borderTopWidth,10)+parseInt(e.borderBottomWidth,10),n=Math.min(this.cellProperties.visibleRows,this.strippedChoices.length),r=Array.from({length:n},((e,t)=>t)).reduce(((e,t)=>e+this.htEditor.getRowHeight(t)),0);return r+t+1}getWidth(){const e=this.hot.rootWindow.getComputedStyle(this.htContainer.querySelector(".htCore")),t=parseInt(e.borderInlineStartWidth,10)+parseInt(e.borderInlineEndWidth,10);return this.htEditor.getColWidth(0)+t}stripValueIfNeeded(e){return this.stripValuesIfNeeded([e])[0]}stripValuesIfNeeded(e){const{allowHtml:t}=this.cellProperties,n=Dd(e,(e=>jd(e)));return Dd(n,(e=>t?e:hp(e)))}allowKeyEventPropagation(e){const t=this.htEditor.getSelectedRangeLast(),n=t?t.from.row:-1;let r=!1;return e===Im.ARROW_DOWN&&n>0&&n<this.htEditor.countRows()-1&&(r=!0),e===Im.ARROW_UP&&n>-1&&(r=!0),r}onBeforeKeyDown(e){if(32===(t=e.keyCode)||t>=48&&t<=57||t>=96&&t<=111||t>=186&&t<=192||t>=219&&t<=222||t>=226||t>=65&&t<=90||e.keyCode===Im.BACKSPACE||e.keyCode===Im.DELETE||e.keyCode===Im.INSERT){let t=10;if(e.keyCode===Im.C&&(e.ctrlKey||e.metaKey))return;this.isOpened()||(t+=10),this.htEditor&&this.hot._registerTimeout((()=>{this.queryChoices(this.TEXTAREA.value)}),t)}var t}}function aI(){this.htEditor.view.hasVerticalScroll()&&this.htEditor.updateSettings({width:this.htEditor.getSettings().width+hg(this.hot.rootDocument)})}class lI extends nM{static get EDITOR_TYPE(){return"checkbox"}beginEditing(e,t){if(t&&"mouseup"===t.type&&"TD"===t.target.nodeName){const e=this.TD.querySelector('input[type="checkbox"]');kp(e,"htBadValue")||e.click()}}finishEditing(){}init(){}open(){}close(){}getValue(){}setValue(){}focus(){}}
/*!
 * Pikaday
 *
 * Copyright Â© 2014 David Bushell | BSD & MIT license | https://github.com/Pikaday/Pikaday
 */const hI=()=>window,uI=()=>window.document,cI=(e,t)=>window.setTimeout(e,t),dI=function(e,t,n,r){e.addEventListener(t,n,!!r)},pI=function(e,t,n,r){e.removeEventListener(t,n,!!r)},gI=function(e,t){return-1!==(" "+e.className+" ").indexOf(" "+t+" ")},mI=function(e,t){gI(e,t)||(e.className=""===e.className?t:e.className+" "+t)},fI=function(e,t){var n;e.className=(n=(" "+e.className+" ").replace(" "+t+" "," ")).trim?n.trim():n.replace(/^\s+|\s+$/g,"")},wI=function(e){return/Array/.test(Object.prototype.toString.call(e))},yI=function(e){return/Date/.test(Object.prototype.toString.call(e))&&!isNaN(e.getTime())},vI=function(e){let t=e.getDay();return 0===t||6===t},CI=function(e){return e%4==0&&e%100!=0||e%400==0},SI=function(e,t){return[31,CI(e)?29:28,31,30,31,30,31,31,30,31,30,31][t]},RI=function(e){yI(e)&&e.setHours(0,0,0,0)},EI=function(e,t){return e.getTime()===t.getTime()},bI=function(e,t,n){let r,i;for(r in t)i=void 0!==e[r],i&&"object"==typeof t[r]&&null!==t[r]&&void 0===t[r].nodeName?yI(t[r])?n&&(e[r]=new Date(t[r].getTime())):wI(t[r])?n&&(e[r]=t[r].slice(0)):e[r]=bI({},t[r],n):!n&&i||(e[r]=t[r]);return e},TI=function(e,t,n){let r=uI().createEvent("HTMLEvents");r.initEvent(t,!0,!1),r=bI(r,n),e.dispatchEvent(r)},NI=function(e){return e.month<0&&(e.year-=Math.ceil(Math.abs(e.month)/12),e.month+=12),e.month>11&&(e.year+=Math.floor(Math.abs(e.month)/12),e.month-=12),e},AI={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,firstWeekOfYearMinDays:4,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},MI=function(e,t,n){for(t+=e.firstDay;t>=7;)t-=7;return n?e.i18n.weekdaysShort[t]:e.i18n.weekdays[t]},II=function(e){let t=[],n="false";if(e.isEmpty){if(!e.showDaysInNextAndPreviousMonths)return'<td class="is-empty"></td>';t.push("is-outside-current-month"),e.enableSelectionDaysInNextAndPreviousMonths||t.push("is-selection-disabled")}return e.isDisabled&&t.push("is-disabled"),e.isToday&&t.push("is-today"),e.isSelected&&(t.push("is-selected"),n="true"),e.hasEvent&&t.push("has-event"),e.isInRange&&t.push("is-inrange"),e.isStartRange&&t.push("is-startrange"),e.isEndRange&&t.push("is-endrange"),'<td data-day="'+e.day+'" class="'+t.join(" ")+'" aria-selected="'+n+'"><button class="pika-button pika-day" type="button" data-pika-year="'+e.year+'" data-pika-month="'+e.month+'" data-pika-day="'+e.day+'">'+e.day+"</button></td>"},OI=function(e,t,n,r,i){let o=new Date(r,n,t),s=e.hasMoment?e.moment(o).isoWeek():function(e,t){e.setHours(0,0,0,0);let n=e.getDate(),r=e.getDay(),i=t,o=i-1,s=function(e){return(e+7-1)%7};e.setDate(n+o-s(r));let a=new Date(e.getFullYear(),0,i),l=(e.getTime()-a.getTime())/864e5;return 1+Math.round((l-o+s(a.getDay()))/7)}(o,i);return'<td class="pika-week">'+s+"</td>"},xI=function(e,t,n,r){return'<tr class="pika-row'+(n?" pick-whole-week":"")+(r?" is-selected":"")+'">'+(t?e.reverse():e).join("")+"</tr>"},PI=function(e,t,n,r,i,o){let s,a,l,h,u,c=e._o,d=n===c.minYear,p=n===c.maxYear,g='<div id="'+o+'" class="pika-title" role="heading" aria-live="polite">',m=!0,f=!0;for(l=[],s=0;s<12;s++)l.push('<option value="'+(n===i?s-t:12+s-t)+'"'+(s===r?' selected="selected"':"")+(d&&s<c.minMonth||p&&s>c.maxMonth?' disabled="disabled"':"")+">"+c.i18n.months[s]+"</option>");for(h='<div class="pika-label">'+c.i18n.months[r]+'<select class="pika-select pika-select-month" tabindex="-1">'+l.join("")+"</select></div>",wI(c.yearRange)?(s=c.yearRange[0],a=c.yearRange[1]+1):(s=n-c.yearRange,a=1+n+c.yearRange),l=[];s<a&&s<=c.maxYear;s++)s>=c.minYear&&l.push('<option value="'+s+'"'+(s===n?' selected="selected"':"")+">"+s+"</option>");return u='<div class="pika-label">'+n+c.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+l.join("")+"</select></div>",c.showMonthAfterYear?g+=u+h:g+=h+u,d&&(0===r||c.minMonth>=r)&&(m=!1),p&&(11===r||c.maxMonth<=r)&&(f=!1),0===t&&(g+='<button class="pika-prev'+(m?"":" is-disabled")+'" type="button">'+c.i18n.previousMonth+"</button>"),t===e._o.numberOfMonths-1&&(g+='<button class="pika-next'+(f?"":" is-disabled")+'" type="button">'+c.i18n.nextMonth+"</button>"),g+"</div>"},_I=function(e,t,n){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+n+'">'+function(e){let t,n=[];for(e.showWeekNumber&&n.push("<th></th>"),t=0;t<7;t++)n.push('<th scope="col"><abbr title="'+MI(e,t)+'">'+MI(e,t,!0)+"</abbr></th>");return"<thead><tr>"+(e.isRTL?n.reverse():n).join("")+"</tr></thead>"}(e)+("<tbody>"+t.join("")+"</tbody></table>")};function LI(e){let t=this,n=t.config(e);t._onMouseDown=function(e){if(!t._v)return;let r=(e=e||hI().event).target||e.srcElement;if(r)if(gI(r,"is-disabled")||(!gI(r,"pika-button")||gI(r,"is-empty")||gI(r.parentNode,"is-disabled")?gI(r,"pika-prev")?t.prevMonth():gI(r,"pika-next")&&t.nextMonth():(t.setDate(new Date(r.getAttribute("data-pika-year"),r.getAttribute("data-pika-month"),r.getAttribute("data-pika-day"))),n.bound&&cI((function(){t.hide(),n.blurFieldOnSelect&&n.field&&n.field.blur()}),100))),gI(r,"pika-select"))t._c=!0;else{if(!e.preventDefault)return e.returnValue=!1,!1;e.preventDefault()}},t._onChange=function(e){let n=(e=e||hI().event).target||e.srcElement;n&&(gI(n,"pika-select-month")?t.gotoMonth(n.value):gI(n,"pika-select-year")&&t.gotoYear(n.value))},t._onKeyChange=function(e){if(e=e||hI().event,t.isVisible())switch(e.keyCode){case 13:case 27:n.field&&n.field.blur();break;case 37:t.adjustDate("subtract",1);break;case 38:t.adjustDate("subtract",7);break;case 39:t.adjustDate("add",1);break;case 40:t.adjustDate("add",7);break;case 8:case 46:t.setDate(null)}},t._parseFieldValue=function(){if(n.parse)return n.parse(n.field.value,n.format);if(this.hasMoment){let e=this.moment(n.field.value,n.format,n.formatStrict);return e&&e.isValid()?e.toDate():null}return new Date(Date.parse(n.field.value))},t._onInputChange=function(e){let n;e.firedBy!==t&&(n=t._parseFieldValue(),yI(n)&&t.setDate(n),t._v||t.show())},t._onInputFocus=function(){t.show()},t._onInputClick=function(){t.show()},t._onInputBlur=function(){let e=uI().activeElement;do{if(gI(e,"pika-single"))return}while(e=e.parentNode);t._c||(t._b=cI((function(){t.hide()}),50)),t._c=!1},t._onClick=function(e){let r=(e=e||hI().event).target||e.srcElement,i=r;if(r){!hasEventListeners&&gI(r,"pika-select")&&(r.onchange||(r.setAttribute("onchange","return;"),dI(r,"change",t._onChange)));do{if(gI(i,"pika-single")||i===n.trigger)return}while(i=i.parentNode);t._v&&r!==n.trigger&&i!==n.trigger&&t.hide()}},t.el=uI().createElement("div"),t.el.className="pika-single"+(n.isRTL?" is-rtl":"")+(n.theme?" "+n.theme:""),dI(t.el,"mousedown",t._onMouseDown,!0),dI(t.el,"touchend",t._onMouseDown,!0),dI(t.el,"change",t._onChange),n.keyboardInput&&dI(uI(),"keydown",t._onKeyChange),n.field&&(n.container?n.container.appendChild(t.el):n.bound?uI().body.appendChild(t.el):n.field.parentNode.insertBefore(t.el,n.field.nextSibling),dI(n.field,"change",t._onInputChange),n.defaultDate||(n.defaultDate=t._parseFieldValue(),n.setDefaultDate=!0));let r=n.defaultDate;yI(r)?n.setDefaultDate?t.setDate(r,!0):t.gotoDate(r):t.gotoDate(new Date),n.bound?(this.hide(),t.el.className+=" is-bound",dI(n.trigger,"click",t._onInputClick),dI(n.trigger,"focus",t._onInputFocus),dI(n.trigger,"blur",t._onInputBlur)):this.show()}function HI(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function kI(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function FI(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}LI.prototype={config:function(e){this._o||(this._o=bI({},AI,!0));let t=bI(this._o,e,!0);t.isRTL=!!t.isRTL,t.field=t.field&&t.field.nodeName?t.field:null,t.theme="string"==typeof t.theme&&t.theme?t.theme:null,t.bound=!!(void 0!==t.bound?t.field&&t.bound:t.field),t.trigger=t.trigger&&t.trigger.nodeName?t.trigger:t.field,t.disableWeekends=!!t.disableWeekends,t.disableDayFn="function"==typeof t.disableDayFn?t.disableDayFn:null;let n=parseInt(t.numberOfMonths,10)||1;if(t.numberOfMonths=n>4?4:n,yI(t.minDate)||(t.minDate=!1),yI(t.maxDate)||(t.maxDate=!1),t.minDate&&t.maxDate&&t.maxDate<t.minDate&&(t.maxDate=t.minDate=!1),t.minDate&&this.setMinDate(t.minDate),t.maxDate&&this.setMaxDate(t.maxDate),wI(t.yearRange)){let e=(new Date).getFullYear()-10;t.yearRange[0]=parseInt(t.yearRange[0],10)||e,t.yearRange[1]=parseInt(t.yearRange[1],10)||e}else t.yearRange=Math.abs(parseInt(t.yearRange,10))||AI.yearRange,t.yearRange>100&&(t.yearRange=100);return t},toString:function(e){return e=e||this._o.format,yI(this._d)?this._o.toString?this._o.toString(this._d,e):this.hasMoment?this.moment(this._d).format(e):this._d.toDateString():""},getMoment:function(){return this.hasMoment?this.moment(this._d):null},setMoment:function(e,t){this.hasMoment&&this.moment.isMoment(e)&&this.setDate(e.toDate(),t)},useMoment:function(e){this.hasMoment=!0,this.moment=e},getDate:function(){return yI(this._d)?new Date(this._d.getTime()):null},setDate:function(e,t){if(!e)return this._d=null,this._o.field&&(this._o.field.value="",TI(this._o.field,"change",{firedBy:this})),this.draw();if("string"==typeof e&&(e=new Date(Date.parse(e))),!yI(e))return;let n=this._o.minDate,r=this._o.maxDate;yI(n)&&e<n?e=n:yI(r)&&e>r&&(e=r),this._d=new Date(e.getTime()),RI(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),TI(this._o.field,"change",{firedBy:this})),t||"function"!=typeof this._o.onSelect||this._o.onSelect.call(this,this.getDate())},clear:function(){this.setDate(null)},gotoDate:function(e){let t=!0;if(yI(e)){if(this.calendars){let n=new Date(this.calendars[0].year,this.calendars[0].month,1),r=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),i=e.getTime();r.setMonth(r.getMonth()+1),r.setDate(r.getDate()-1),t=i<n.getTime()||r.getTime()<i}t&&(this.calendars=[{month:e.getMonth(),year:e.getFullYear()}],"right"===this._o.mainCalendar&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(e,t){let n,r=this.getDate()||new Date,i=24*parseInt(t)*60*60*1e3;"add"===e?n=new Date(r.valueOf()+i):"subtract"===e&&(n=new Date(r.valueOf()-i)),this.setDate(n)},adjustCalendars:function(){this.calendars[0]=NI(this.calendars[0]);for(let e=1;e<this._o.numberOfMonths;e++)this.calendars[e]=NI({month:this.calendars[0].month+e,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(e){isNaN(e)||(this.calendars[0].month=parseInt(e,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(e){isNaN(e)||(this.calendars[0].year=parseInt(e,10),this.adjustCalendars())},setMinDate:function(e){e instanceof Date?(RI(e),this._o.minDate=e,this._o.minYear=e.getFullYear(),this._o.minMonth=e.getMonth()):(this._o.minDate=AI.minDate,this._o.minYear=AI.minYear,this._o.minMonth=AI.minMonth,this._o.startRange=AI.startRange),this.draw()},setMaxDate:function(e){e instanceof Date?(RI(e),this._o.maxDate=e,this._o.maxYear=e.getFullYear(),this._o.maxMonth=e.getMonth()):(this._o.maxDate=AI.maxDate,this._o.maxYear=AI.maxYear,this._o.maxMonth=AI.maxMonth,this._o.endRange=AI.endRange),this.draw()},setStartRange:function(e){this._o.startRange=e},setEndRange:function(e){this._o.endRange=e},draw:function(e){if(!this._v&&!e)return;let t,n=this._o,r=n.minYear,i=n.maxYear,o=n.minMonth,s=n.maxMonth,a="";this._y<=r&&(this._y=r,!isNaN(o)&&this._m<o&&(this._m=o)),this._y>=i&&(this._y=i,!isNaN(s)&&this._m>s&&(this._m=s));for(let l=0;l<n.numberOfMonths;l++)t="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),a+='<div class="pika-lendar">'+PI(this,l,this.calendars[l].year,this.calendars[l].month,this.calendars[0].year,t)+this.render(this.calendars[l].year,this.calendars[l].month,t)+"</div>";this.el.innerHTML=a,n.bound&&"hidden"!==n.field.type&&cI((function(){n.trigger.focus()}),1),"function"==typeof this._o.onDraw&&this._o.onDraw(this),n.bound&&n.field.setAttribute("aria-label",n.ariaLabel)},adjustPosition:function(){let e,t,n,r,i,o,s,a,l,h,u;this._o.container||(this.el.style.position="absolute",e=this._o.trigger,t=this.el.offsetWidth,n=this.el.offsetHeight,r=hI().innerWidth||uI().documentElement.clientWidth,i=hI().innerHeight||uI().documentElement.clientHeight,o=uI().body.scrollTop||uI().documentElement.scrollTop,h=!0,u=!0,l=e.getBoundingClientRect(),s=l.left+hI().pageXOffset,a=l.bottom+hI().pageYOffset,(this._o.reposition&&s+t>r||this._o.position.indexOf("right")>-1&&s-t+e.offsetWidth>0)&&(s=s-t+e.offsetWidth,h=!1),(this._o.reposition&&a+n>i+o||this._o.position.indexOf("top")>-1&&a-n-e.offsetHeight>0)&&(a=a-n-e.offsetHeight,u=!1),s<0&&(s=0),a<0&&(a=0),this.el.style.left=s+"px",this.el.style.top=a+"px",mI(this.el,h?"left-aligned":"right-aligned"),mI(this.el,u?"bottom-aligned":"top-aligned"),fI(this.el,h?"right-aligned":"left-aligned"),fI(this.el,u?"top-aligned":"bottom-aligned"))},render:function(e,t,n){let r=this._o,i=new Date,o=SI(e,t),s=new Date(e,t,1).getDay(),a=[],l=[];RI(i),r.firstDay>0&&(s-=r.firstDay,s<0&&(s+=7));let h=0===t?11:t-1,u=11===t?0:t+1,c=0===t?e-1:e,d=11===t?e+1:e,p=SI(c,h),g=o+s,m=g;for(;m>7;)m-=7;g+=7-m;let f=!1;for(let w=0,y=0;w<g;w++){let n=new Date(e,t,w-s+1),g=!!yI(this._d)&&EI(n,this._d),m=EI(n,i),v=-1!==r.events.indexOf(n.toDateString()),C=w<s||w>=o+s,S=w-s+1,R=t,E=e,b=r.startRange&&EI(r.startRange,n),T=r.endRange&&EI(r.endRange,n),N=r.startRange&&r.endRange&&r.startRange<n&&n<r.endRange;C&&(w<s?(S=p+S,R=h,E=c):(S-=o,R=u,E=d));let A={day:S,month:R,year:E,hasEvent:v,isSelected:g,isToday:m,isDisabled:r.minDate&&n<r.minDate||r.maxDate&&n>r.maxDate||r.disableWeekends&&vI(n)||r.disableDayFn&&r.disableDayFn(n),isEmpty:C,isStartRange:b,isEndRange:T,isInRange:N,showDaysInNextAndPreviousMonths:r.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:r.enableSelectionDaysInNextAndPreviousMonths};r.pickWholeWeek&&g&&(f=!0),l.push(II(A)),7==++y&&(r.showWeekNumber&&l.unshift(OI(this,w-s,t,e,r.firstWeekOfYearMinDays)),a.push(xI(l,r.isRTL,r.pickWholeWeek,f)),l=[],y=0,f=!1)}return _I(r,a,n)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),fI(this.el,"is-hidden"),this._o.bound&&(dI(uI(),"click",this._onClick),this.adjustPosition()),"function"==typeof this._o.onOpen&&this._o.onOpen.call(this))},hide:function(){let e=this._v;!1!==e&&(this._o.bound&&pI(uI(),"click",this._onClick),this._o.container||(this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto"),mI(this.el,"is-hidden"),this._v=!1,void 0!==e&&"function"==typeof this._o.onClose&&this._o.onClose.call(this))},destroy:function(){let e=this._o;this.hide(),pI(this.el,"mousedown",this._onMouseDown,!0),pI(this.el,"touchend",this._onMouseDown,!0),pI(this.el,"change",this._onChange),e.keyboardInput&&pI(uI(),"keydown",this._onKeyChange),e.field&&(pI(e.field,"change",this._onInputChange),e.bound&&(pI(e.trigger,"click",this._onInputClick),pI(e.trigger,"focus",this._onInputFocus),pI(e.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}};const DI="date",VI="dateEditor";var UI=new WeakSet;class BI extends kM{constructor(){super(...arguments),HI(this,UI),kI(this,"parentDestroyed",!1),kI(this,"$datePicker",null)}static get EDITOR_TYPE(){return DI}init(){if("function"!=typeof M)throw new Error("You need to include moment.js to your project.");super.init(),this.hot.addHook("afterDestroy",(()=>{this.parentDestroyed=!0,this.destroyElements()})),this.hot.addHook("afterSetTheme",((e,t)=>{t||(Dp(this.datePicker,/ht-theme-.*/g),Fp(this.datePicker,e))}))}createElements(){super.createElements(),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),Fp(this.datePicker,"htDatepickerHolder");const e=this.hot.getCurrentThemeName();Dp(this.datePicker,/ht-theme-.*/g),Fp(this.datePicker,e),this.hot.rootDocument.body.appendChild(this.datePicker),this.eventManager.addEventListener(this.datePicker,"mousedown",(e=>{kp(e.target,"pika-day")&&this.hideDatepicker(),e.stopPropagation()}))}destroyElements(){const e=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),e&&e.removeChild(this.datePicker)}prepare(e,t,n,r,i,o){super.prepare(e,t,n,r,i,o)}open(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;const t=this.hot.getShortcutManager().getContext("editor");this.showDatepicker(e),super.open(),t.addShortcuts([{keys:[["ArrowLeft"]],callback:()=>{this.$datePicker.adjustDate("subtract",1)}},{keys:[["ArrowRight"]],callback:()=>{this.$datePicker.adjustDate("add",1)}},{keys:[["ArrowUp"]],callback:()=>{this.$datePicker.adjustDate("subtract",7)}},{keys:[["ArrowDown"]],callback:()=>{this.$datePicker.adjustDate("add",7)}}],{group:VI})}close(){var e;this._opened=!1,null!==(e=this.$datePicker)&&void 0!==e&&e.destroy&&this.$datePicker.destroy(),this.hot._registerTimeout((()=>{const e=this.hot._getEditorManager();e.closeEditor(),this.hot.view.render(),e.prepareEditor()}));this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(VI),super.close()}finishEditing(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];super.finishEditing(e,t)}showDatepicker(e){const t=FI(UI,this,WI).call(this),n=this.hot.view.isMouseDown(),r=!!e&&xm(e.keyCode);let i;this.datePicker.style.display="block",this.$datePicker=new LI(this.getDatePickerConfig()),"function"==typeof this.$datePicker.useMoment&&this.$datePicker.useMoment(M),this.$datePicker._onInputFocus=function(){},this.originalValue?(i=this.originalValue,M(i,t,!0).isValid()&&this.$datePicker.setMoment(M(i,t),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),r||n||this.setValue("")):this.cellProperties.defaultDate?(i=this.cellProperties.defaultDate,M(i,t,!0).isValid()&&this.$datePicker.setMoment(M(i,t),!0),r||n||this.setValue("")):this.$datePicker.gotoToday()}hideDatepicker(){this.datePickerStyle.display="none",this.$datePicker.hide()}getDatePickerConfig(){var e;const t=this.TEXTAREA,n={};this.cellProperties&&this.cellProperties.datePickerConfig&&nm(n,this.cellProperties.datePickerConfig);const r=n.onSelect,i=n.onClose;return n.field=t,n.trigger=t,n.container=this.datePicker,n.bound=!1,n.keyboardInput=!1,n.format=null!==(e=n.format)&&void 0!==e?e:FI(UI,this,WI).call(this),n.reposition=n.reposition||!1,n.isRTL=!1,n.onSelect=e=>{let t=e;isNaN(t.getTime())||(t=M(t).format(FI(UI,this,WI).call(this))),this.setValue(t),r&&r(),bm()&&this.hideDatepicker()},n.onClose=()=>{this.parentDestroyed||this.finishEditing(!1),i&&i()},n}refreshDimensions(e){var t;if(super.refreshDimensions(e),this.state!==tM.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD)return void this.hideDatepicker();const{rowIndexMapper:n,columnIndexMapper:r}=this.hot,{wtOverlays:i}=this.hot.view._wt,{wtTable:o}=null!==(t=i.getParentOverlay(this.TD))&&void 0!==t?t:this.hot.view._wt,s=n.getVisualFromRenderableIndex(o.getFirstPartiallyVisibleRow()),a=n.getVisualFromRenderableIndex(o.getLastPartiallyVisibleRow()),l=r.getVisualFromRenderableIndex(o.getFirstPartiallyVisibleColumn()),h=r.getVisualFromRenderableIndex(o.getLastPartiallyVisibleColumn());if(this.row>=s&&this.row<=a&&this.col>=l&&this.col<=h){const e=this.TD.getBoundingClientRect();this.datePickerStyle.top=`${this.hot.rootWindow.pageYOffset+e.top+ng(this.TD)}px`;let t=this.hot.rootWindow.pageXOffset;this.hot.isRtl()?t+=e.right-tg(this.datePicker):t+=e.left,this.datePickerStyle.left=`${t}px`}else this.hideDatepicker()}}function WI(){var e;return null!==(e=this.cellProperties.dateFormat)&&void 0!==e?e:"DD/MM/YYYY"}class jI extends sI{static get EDITOR_TYPE(){return"dropdown"}prepare(e,t,n,r,i,o){o.filter=!1,o.strict=!0,super.prepare(e,t,n,r,i,o)}}class GI extends kM{static get EDITOR_TYPE(){return"numeric"}}function zI(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class $I extends kM{constructor(){super(...arguments),zI(this,"autoResize",xM(this.hot.rootDocument,{textContent:e=>"â¢".repeat(e.value.length)}))}static get EDITOR_TYPE(){return"password"}createElements(){super.createElements(),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,Wp(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}const YI="ht_editor_visible",KI="selectEditor";class XI extends nM{static get EDITOR_TYPE(){return"select"}init(){this.selectWrapper=this.hot.rootDocument.createElement("div"),this.select=this.hot.rootDocument.createElement("select"),this.select.setAttribute("data-hot-input","true"),this.selectWrapper.style.display="none";const e=this.hot.rootDocument.createElement("DIV"),t=this.hot.getSettings().ariaTags;e.className="htAutocompleteArrow",t&&e.setAttribute(...mp()),e.appendChild(this.hot.rootDocument.createTextNode(String.fromCharCode(9660))),Fp(this.selectWrapper,"htSelectEditor"),this.selectWrapper.appendChild(this.select),this.selectWrapper.insertBefore(e,this.selectWrapper.firstChild),this.hot.rootElement.appendChild(this.selectWrapper),this.registerHooks()}getValue(){return this.select.value}setValue(e){this.select.value=e}open(){this._opened=!0,this.refreshDimensions(),this.selectWrapper.style.display="";this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.selectWrapper.style.display="none",kp(this.selectWrapper,YI)&&Dp(this.selectWrapper,YI),this.unregisterShortcuts(),this.clearHooks()}focus(){this.select.focus()}registerHooks(){this.addHook("afterScrollHorizontally",(()=>this.refreshDimensions())),this.addHook("afterScrollVertically",(()=>this.refreshDimensions())),this.addHook("afterColumnResize",(()=>this.refreshDimensions())),this.addHook("afterRowResize",(()=>this.refreshDimensions()))}prepare(e,t,n,r,i,o){super.prepare(e,t,n,r,i,o);const s=this.cellProperties.selectOptions;let a;a="function"==typeof s?this.prepareOptions(s(this.row,this.col,this.prop)):this.prepareOptions(s),Wp(this.select),hm(a,((e,t)=>{const n=this.hot.rootDocument.createElement("OPTION");n.value=t,Gp(n,e),this.select.appendChild(n)}))}prepareOptions(e){let t={};if(Array.isArray(e))for(let n=0,r=e.length;n<r;n++)t[e[n]]=e[n];else"object"==typeof e&&(t=e);return t}refreshValue(){const e=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=e,this.setValue(e),this.refreshDimensions()}refreshDimensions(){if(this.state!==tM.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD)return void this.close();const{top:e,start:t,width:n,height:r}=this.getEditedCellRect(),i=this.selectWrapper.style;i.height=`${r}px`,i.width=`${n}px`,i.top=`${e}px`,i[this.hot.isRtl()?"right":"left"]=`${t}px`,i.margin="0px",Fp(this.selectWrapper,YI)}registerShortcuts(){const e=this.hot.getShortcutManager().getContext("editor"),t={group:KI};this.isInFullEditMode()&&e.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{const e=this.select.selectedIndex-1;e>=0&&(this.select[e].selected=!0)}},{keys:[["ArrowDown"]],callback:()=>{const e=this.select.selectedIndex+1;e<=this.select.length-1&&(this.select[e].selected=!0)}}],t)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(KI)}}class qI extends kM{static get EDITOR_TYPE(){return"time"}prepare(e,t,n,r,i,o){super.prepare(e,t,n,r,i,o),this.TEXTAREA.dir="ltr"}}function QI(e,t,n,r,i,o,s){FM.apply(this,[e,t,n,r,i,o,s]),Gp(t,null==o?"":o,!1)}QI.RENDERER_TYPE="html";function ZI(e,t,n,r,i,o,s){const{rootDocument:a}=e,l=s.allowHtml?QI:DM,h=a.createElement("DIV"),u=e.getSettings().ariaTags;if(h.className="htAutocompleteArrow",u&&h.setAttribute(...mp()),h.appendChild(a.createTextNode(String.fromCharCode(9660))),l.apply(this,[e,t,n,r,i,o,s]),t.firstChild||t.appendChild(a.createTextNode(String.fromCharCode(160))),t.insertBefore(h,t.firstChild),Fp(t,"htAutocomplete"),!e.acArrowListener){const i=new Ff(e);e.acArrowListener=function(i){kp(i.target,"htAutocompleteArrow")&&e.view._wt.getSetting("onCellDblClick",null,e._createCellCoords(n,r),t)},i.addEventListener(e.rootElement,"mousedown",e.acArrowListener),e.addHookOnce("afterDestroy",(()=>{i.destroy()}))}}ZI.RENDERER_TYPE="autocomplete";function JI(e,t,n,r,i,o,s){ZI.apply(this,[e,t,n,r,i,o,s])}JI.RENDERER_TYPE="dropdown";const eO=new WeakMap,tO=new WeakMap,nO="htBadValue",rO="data-row",iO="data-col",oO="checkboxRenderer",sO="checkbox";function aO(e,t,n,r,i,o,s){const{rootDocument:a}=e,l=e.getSettings().ariaTags;FM.apply(this,[e,t,n,r,i,o,s]),function(e){let t=tO.get(e);if(!t){const{rootElement:n}=e;t=new Ff(e),t.addEventListener(n,"click",(t=>function(e,t){const{target:n}=e;if(!lO(n))return;if(!n.hasAttribute(rO)||!n.hasAttribute(iO))return;const r=parseInt(n.getAttribute(rO),10),i=parseInt(n.getAttribute(iO),10),o=t.getCellMeta(r,i);o.readOnly&&e.preventDefault()}(t,e))),t.addEventListener(n,"mouseup",(t=>function(e,t){const{target:n}=e;if(!lO(n))return;if(!n.hasAttribute(rO)||!n.hasAttribute(iO))return;setTimeout(t.listen,10)}(t,e))),t.addEventListener(n,"change",(t=>function(e,t){const{target:n}=e;if(!lO(n))return;if(!n.hasAttribute(rO)||!n.hasAttribute(iO))return;const r=parseInt(n.getAttribute(rO),10),i=parseInt(n.getAttribute(iO),10),o=t.getCellMeta(r,i);if(!o.readOnly){let n=null;n=e.target.checked?void 0===o.uncheckedTemplate||o.checkedTemplate:void 0!==o.uncheckedTemplate&&o.uncheckedTemplate,t.setDataAtCell(r,i,n)}}(t,e))),tO.set(e,t)}}(e);let h=function(e){const t=e.createElement("input");return t.className="htCheckboxRendererInput",t.type="checkbox",t.setAttribute("tabindex","-1"),t.cloneNode(!1)}(a);const u=s.label;let c=!1;if(void 0===s.checkedTemplate&&(s.checkedTemplate=!0),void 0===s.uncheckedTemplate&&(s.uncheckedTemplate=!1),Wp(t),o===s.checkedTemplate||jd(o).toLocaleLowerCase(s.locale)===jd(s.checkedTemplate).toLocaleLowerCase(s.locale)?h.checked=!0:o===s.uncheckedTemplate||jd(o).toLocaleLowerCase(s.locale)===jd(s.uncheckedTemplate).toLocaleLowerCase(s.locale)?h.checked=!1:$d(o)?Fp(h,"noValue"):(h.style.display="none",Fp(h,nO),c=!0),Vp(h,[[rO,n],[iO,r]]),l&&Vp(h,[gp(h.checked?e.getTranslatedPhrase(YT):e.getTranslatedPhrase(KT)),bp(h.checked),pp()]),!c&&u){let s="";if(u.value)s="function"==typeof u.value?u.value.call(this,n,r,i,o):u.value;else if(u.property){const t=e.getDataAtRowProp(n,u.property);s=null!==t?t:""}const l=function(e,t,n){const r=e.createElement("label");r.className="htCheckboxRendererLabel "+(n?"fullWidth":"");const i=e.createTextNode(t);if(n){const t=e.createElement("span");t.appendChild(i),r.appendChild(t)}else r.appendChild(i);return r.cloneNode(!0)}(a,s,!0!==u.separated);"before"===u.position?u.separated?(t.appendChild(l),t.appendChild(h)):(l.appendChild(h),h=l):u.position&&"after"!==u.position||(u.separated?(t.appendChild(h),t.appendChild(l)):(l.insertBefore(h,l.firstChild),h=l))}function d(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const n=e.getSelectedRange(),r=[],i=new Map;let o=[],s=0;if(n){for(let a=0;a<n.length;a++){const{row:l,col:h}=n[a].getTopStartCorner(),{row:u,col:c}=n[a].getBottomEndCorner();for(let n=l;n<=u;n+=1)for(let a=h;a<=c;a+=1){const l=e.getCellMeta(n,a);if(l.hidden)continue;const h={checkedTemplate:l.checkedTemplate,uncheckedTemplate:l.uncheckedTemplate};if("checkbox"!==l.type){!0!==t||l.readOnly||(i.has(r.length)?i.set(r.length,[...i.get(r.length),[n,a,null]]):i.set(r.length,[[n,a,null]]));continue}if(!0===l.readOnly)continue;void 0===l.checkedTemplate&&(l.checkedTemplate=!0),void 0===l.uncheckedTemplate&&(l.uncheckedTemplate=!1);const u=e.getDataAtCell(n,a);!1===t?[l.checkedTemplate,l.checkedTemplate.toString()].includes(u)?o.push([n,a,l.uncheckedTemplate,h]):[l.uncheckedTemplate,l.uncheckedTemplate.toString(),null,void 0].includes(u)&&o.push([n,a,l.checkedTemplate,h]):o.push([n,a,l.uncheckedTemplate,h]),s+=1}r.push(s),s=0}o=o.every((e=>{let[,,t]=e;return t===o[0][2]}))?o.map((e=>{let[t,n,r]=e;return[t,n,r]})):o.map((e=>{let[t,n,,r]=e;return[t,n,r.checkedTemplate]})),o.length>0&&r.forEach(((t,n)=>{let r=o.splice(0,t);i.size&&i.has(n)&&(r=[...r,...i.get(n)]),e.setDataAtCell(r)}))}}function p(){const t=e.getSelectedRange();if(t){for(let n=0;n<t.length;n++){const r=t[n].getTopStartCorner(),i=t[n].getBottomEndCorner();for(let t=r.row;t<=i.row;t++)for(let n=r.col;n<=i.col;n++){if(e.getCellMeta(t,n).readOnly)continue;const r=e.getCell(t,n);if(vg(r)){if(r.querySelectorAll("input[type=checkbox]").length>0)return!0}}}return!1}}(!u||u&&!u.separated)&&t.appendChild(h),c&&t.appendChild(a.createTextNode("#bad-value#")),eO.has(e)||(eO.set(e,!0),function(){const t=e.getShortcutManager().getContext("grid"),n={group:oO,relativeToGroup:qA,position:"before"};t.addShortcuts([{keys:[["space"]],callback:()=>(d(),!p()),runOnlyIf:()=>{var t;return null===(t=e.getSelectedRangeLast())||void 0===t?void 0:t.highlight.isCell()}},{keys:[["enter"]],callback:()=>(d(),!p()),runOnlyIf:()=>{const t=e.getSelectedRangeLast();return e.getSettings().enterBeginsEditing&&(null==t?void 0:t.highlight.isCell())&&!e.selection.isMultiple()}},{keys:[["delete"],["backspace"]],callback:()=>(d(!0),!p()),runOnlyIf:()=>{var t;return null===(t=e.getSelectedRangeLast())||void 0===t?void 0:t.highlight.isCell()}}],n)}())}function lO(e){return"INPUT"===e.tagName&&"checkbox"===e.getAttribute("type")}Rf.getSingleton().add("modifyAutoColumnSizeSeed",(function(e,t,n){const{label:r,type:i,row:o,column:s,prop:a}=t;if(i===sO){if(r){const{value:t,property:i}=r;let l=n;if(t)l="function"==typeof t?t(o,s,a,n):t;else if(i){const e=this.getDataAtRowProp(o,i);l=null!==e?e:n}e=l}return e}})),aO.RENDERER_TYPE=sO;function hO(e,t,n,r,i,o,s){ZI.apply(this,[e,t,n,r,i,o,s])}hO.RENDERER_TYPE="handsontable";var uO,cO,dO,pO,gO,mO,fO="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function wO(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}
/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */function yO(){return cO?uO:(cO=1,uO={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(e){let t=e%10;return 1==~~(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th"},bytes:{binarySuffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],decimalSuffixes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"]},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0,spaceSeparatedCurrency:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}})}
/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */function vO(){if(pO)return dO;pO=1;const e=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function t(e){return e.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function n(r,i,o,s,a,l,h){if(!isNaN(+r))return+r;let u="",c=r.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(c!==r)return-1*n(c,i,o,s,a,l);for(let t=0;t<e.length;t++){let h=e[t];if(u=r.replace(RegExp(`([0-9 ])(${h.key})$`),"$1"),u!==r)return n(u,i,o,s,a,l)*h.factor}if(u=r.replace("%",""),u!==r)return n(u,i,o,s,a,l)/100;let d=parseFloat(r);if(isNaN(d))return;let p=s(d);if(p&&"."!==p&&(u=r.replace(new RegExp(`${t(p)}$`),""),u!==r))return n(u,i,o,s,a,l);let g={};Object.keys(l).forEach((e=>{g[l[e]]=e}));let m=Object.keys(g).sort().reverse(),f=m.length;for(let e=0;e<f;e++){let t=m[e],h=g[t];if(u=r.replace(t,""),u!==r){let e;switch(h){case"thousand":e=Math.pow(10,3);break;case"million":e=Math.pow(10,6);break;case"billion":e=Math.pow(10,9);break;case"trillion":e=Math.pow(10,12)}return n(u,i,o,s,a,l)*e}}}function r(e,r,i="",o,s,a,l){if(""===e)return;if(e===s)return 0;let h=function(e,n,r){let i=e.replace(r,"");return i=i.replace(new RegExp(`([0-9])${t(n.thousands)}([0-9])`,"g"),"$1$2"),i=i.replace(n.decimal,"."),i}(e,r,i);return n(h,r,i,o,s,a)}return dO={unformat:function(e,t){const n=bO();let i,o=n.currentDelimiters(),s=n.currentCurrency().symbol,a=n.currentOrdinal(),l=n.getZeroFormat(),h=n.currentAbbreviations();if("string"==typeof e)i=function(e,t){if(!e.indexOf(":")||":"===t.thousands)return!1;let n=e.split(":");if(3!==n.length)return!1;let r=+n[0],i=+n[1],o=+n[2];return!isNaN(r)&&!isNaN(i)&&!isNaN(o)}(e,o)?function(e){let t=e.split(":"),n=+t[0],r=+t[1];return+t[2]+60*r+3600*n}(e):r(e,o,s,a,l,h);else{if("number"!=typeof e)return;i=e}if(void 0!==i)return i}},dO}
/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */function CO(){if(mO)return gO;mO=1;let e=vO();const t=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,n={output:{type:"string",validValues:["currency","percent","byte","time","ordinal","number"]},base:{type:"string",validValues:["decimal","binary","general"],restriction:(e,t)=>"byte"===t.output,message:"`base` must be provided only when the output is `byte`",mandatory:e=>"byte"===e.output},characteristic:{type:"number",restriction:e=>e>=0,message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:["trillion","billion","million","thousand"]},average:"boolean",lowPrecision:{type:"boolean",restriction:(e,t)=>!0===t.average,message:"`lowPrecision` must be provided only when the option `average` is set"},currencyPosition:{type:"string",validValues:["prefix","infix","postfix"]},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:e=>e>=0,message:"value must be positive"},{restriction:(e,t)=>!t.exponential,message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:e=>e>=0,message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",roundingFunction:"function",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",spaceSeparatedCurrency:"boolean",spaceSeparatedAbbreviation:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:["sign","parenthesis"]},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:(e,t)=>"percent"===t.output,message:"`prefixSymbol` can be provided only when the output is `percent`"}},r={languageTag:{type:"string",mandatory:!0,restriction:e=>e.match(t),message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:{type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},spaceSeparated:"boolean",spaceSeparatedCurrency:"boolean",ordinal:{type:"function",mandatory:!0},bytes:{type:"object",children:{binarySuffixes:"object",decimalSuffixes:"object"}},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function i(t){return void 0!==e.unformat(t)}function o(e,t,r,i=!1){let s=Object.keys(e).map((i=>{if(!t[i])return console.error(`${r} Invalid key: ${i}`),!1;let s=e[i],a=t[i];if("string"==typeof a&&(a={type:a}),"format"===a.type){if(!o(s,n,`[Validate ${i}]`,!0))return!1}else if(typeof s!==a.type)return console.error(`${r} ${i} type mismatched: "${a.type}" expected, "${typeof s}" provided`),!1;if(a.restrictions&&a.restrictions.length){let t=a.restrictions.length;for(let n=0;n<t;n++){let{restriction:t,message:o}=a.restrictions[n];if(!t(s,e))return console.error(`${r} ${i} invalid value: ${o}`),!1}}if(a.restriction&&!a.restriction(s,e))return console.error(`${r} ${i} invalid value: ${a.message}`),!1;if(a.validValues&&-1===a.validValues.indexOf(s))return console.error(`${r} ${i} invalid value: must be among ${JSON.stringify(a.validValues)}, "${s}" provided`),!1;if(a.children){if(!o(s,a.children,`[Validate ${i}]`))return!1}return!0}));return i||s.push(...Object.keys(t).map((n=>{let i=t[n];if("string"==typeof i&&(i={type:i}),i.mandatory){let t=i.mandatory;if("function"==typeof t&&(t=t(e)),t&&void 0===e[n])return console.error(`${r} Missing mandatory key "${n}"`),!1}return!0}))),s.reduce(((e,t)=>e&&t),!0)}function s(e){return o(e,n,"[Validate format]")}return gO={validate:function(e,t){let n=i(e),r=s(t);return n&&r},validateFormat:s,validateInput:i,validateLanguage:function(e){return o(e,r,"[Validate language]")}},gO}
/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var SO,RO,EO={parseFormat:function(e,t={}){return"string"!=typeof e?e:(e=function(e,t){let n=e.match(/^{([^}]*)}/);return n?(t.prefix=n[1],e.slice(n[0].length)):e}(e,t),e=function(e,t){let n=e.match(/{([^}]*)}$/);return n?(t.postfix=n[1],e.slice(0,-n[0].length)):e}(e,t),function(e,t){if(-1===e.indexOf("$")){if(-1===e.indexOf("%"))return-1!==e.indexOf("bd")?(t.output="byte",void(t.base="general")):-1!==e.indexOf("b")?(t.output="byte",void(t.base="binary")):-1!==e.indexOf("d")?(t.output="byte",void(t.base="decimal")):void(-1===e.indexOf(":")?-1!==e.indexOf("o")&&(t.output="ordinal"):t.output="time");t.output="percent"}else t.output="currency"}(e,t),function(e,t){let n=e.match(/[1-9]+[0-9]*/);n&&(t.totalLength=+n[0])}(e,t),function(e,t){let n=e.split(".")[0].match(/0+/);n&&(t.characteristic=n[0].length)}(e,t),function(e,t){if(-1!==e.indexOf(".")){let n=e.split(".")[0];t.optionalCharacteristic=-1===n.indexOf("0")}}(e,t),function(e,t){-1!==e.indexOf("a")&&(t.average=!0)}(e,t),function(e,t){-1!==e.indexOf("K")?t.forceAverage="thousand":-1!==e.indexOf("M")?t.forceAverage="million":-1!==e.indexOf("B")?t.forceAverage="billion":-1!==e.indexOf("T")&&(t.forceAverage="trillion")}(e,t),function(e,t){let n=e.split(".")[1];if(n){let e=n.match(/0+/);e&&(t.mantissa=e[0].length)}}(e,t),function(e,t){e.match(/\[\.]/)?t.optionalMantissa=!0:e.match(/\./)&&(t.optionalMantissa=!1)}(e,t),function(e,t){const n=e.split(".")[1];n&&(t.trimMantissa=-1!==n.indexOf("["))}(e,t),function(e,t){-1!==e.indexOf(",")&&(t.thousandSeparated=!0)}(e,t),function(e,t){-1!==e.indexOf(" ")&&(t.spaceSeparated=!0,t.spaceSeparatedCurrency=!0,(t.average||t.forceAverage)&&(t.spaceSeparatedAbbreviation=!0))}(e,t),function(e,t){e.match(/^\+?\([^)]*\)$/)&&(t.negative="parenthesis"),e.match(/^\+?-/)&&(t.negative="sign")}(e,t),function(e,t){e.match(/^\+/)&&(t.forceSign=!0)}(e,t),t)}};
/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */function bO(){if(RO)return SO;RO=1;const e=yO(),t=CO(),n=EO;let r,i={},o={},s=null,a={};function l(e){r=e}function h(){return o[r]}return i.languages=()=>Object.assign({},o),i.currentLanguage=()=>r,i.currentBytes=()=>h().bytes||{},i.currentCurrency=()=>h().currency,i.currentAbbreviations=()=>h().abbreviations,i.currentDelimiters=()=>h().delimiters,i.currentOrdinal=()=>h().ordinal,i.currentDefaults=()=>Object.assign({},h().defaults,a),i.currentOrdinalDefaultFormat=()=>Object.assign({},i.currentDefaults(),h().ordinalFormat),i.currentByteDefaultFormat=()=>Object.assign({},i.currentDefaults(),h().byteFormat),i.currentPercentageDefaultFormat=()=>Object.assign({},i.currentDefaults(),h().percentageFormat),i.currentCurrencyDefaultFormat=()=>Object.assign({},i.currentDefaults(),h().currencyFormat),i.currentTimeDefaultFormat=()=>Object.assign({},i.currentDefaults(),h().timeFormat),i.setDefaults=e=>{e=n.parseFormat(e),t.validateFormat(e)&&(a=e)},i.getZeroFormat=()=>s,i.setZeroFormat=e=>s="string"==typeof e?e:null,i.hasZeroFormat=()=>null!==s,i.languageData=e=>{if(e){if(o[e])return o[e];throw new Error(`Unknown tag "${e}"`)}return h()},i.registerLanguage=(e,n=!1)=>{if(!t.validateLanguage(e))throw new Error("Invalid language data");o[e.languageTag]=e,n&&l(e.languageTag)},i.setLanguage=(t,n=e.languageTag)=>{if(!o[t]){let e=t.split("-")[0],r=Object.keys(o).find((t=>t.split("-")[0]===e));return o[r]?void l(r):void l(n)}l(t)},i.registerLanguage(e),r=e.languageTag,SO=i}
/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */
function TO(e,t){e.forEach((e=>{let n;try{n=function(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}(`../languages/${e}`)}catch(r){console.error(`Unable to load "${e}". No matching language file found.`)}n&&t.registerLanguage(n)}))}var NO,AO={exports:{}};NO=AO,function(e){var t,n=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,r=Math.ceil,i=Math.floor,o="[BigNumber Error] ",s=o+"Number primitive has more than 15 significant digits: ",a=1e14,l=14,h=9007199254740991,u=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],c=1e7,d=1e9;function p(e){var t=0|e;return e>0||e===t?t:t-1}function g(e){for(var t,n,r=1,i=e.length,o=e[0]+"";r<i;){for(t=e[r++]+"",n=l-t.length;n--;t="0"+t);o+=t}for(i=o.length;48===o.charCodeAt(--i););return o.slice(0,i+1||1)}function m(e,t){var n,r,i=e.c,o=t.c,s=e.s,a=t.s,l=e.e,h=t.e;if(!s||!a)return null;if(n=i&&!i[0],r=o&&!o[0],n||r)return n?r?0:-a:s;if(s!=a)return s;if(n=s<0,r=l==h,!i||!o)return r?0:!i^n?1:-1;if(!r)return l>h^n?1:-1;for(a=(l=i.length)<(h=o.length)?l:h,s=0;s<a;s++)if(i[s]!=o[s])return i[s]>o[s]^n?1:-1;return l==h?0:l>h^n?1:-1}function f(e,t,n,r){if(e<t||e>n||e!==i(e))throw Error(o+(r||"Argument")+("number"==typeof e?e<t||e>n?" out of range: ":" not an integer: ":" not a primitive number: ")+String(e))}function w(e){var t=e.c.length-1;return p(e.e/l)==t&&e.c[t]%2!=0}function y(e,t){return(e.length>1?e.charAt(0)+"."+e.slice(1):e)+(t<0?"e":"e+")+t}function v(e,t,n){var r,i;if(t<0){for(i=n+".";++t;i+=n);e=i+e}else if(++t>(r=e.length)){for(i=n,t-=r;--t;i+=n);e+=i}else t<r&&(e=e.slice(0,t)+"."+e.slice(t));return e}t=function e(t){var C,S,R,E,b,T,N,A,M,I,O=G.prototype={constructor:G,toString:null,valueOf:null},x=new G(1),P=20,_=4,L=-7,H=21,k=-1e7,F=1e7,D=!1,V=1,U=0,B={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"Â ",suffix:""},W="0123456789abcdefghijklmnopqrstuvwxyz",j=!0;function G(e,t){var r,o,a,u,c,d,p,g,m=this;if(!(m instanceof G))return new G(e,t);if(null==t){if(e&&!0===e._isBigNumber)return m.s=e.s,void(!e.c||e.e>F?m.c=m.e=null:e.e<k?m.c=[m.e=0]:(m.e=e.e,m.c=e.c.slice()));if((d="number"==typeof e)&&0*e==0){if(m.s=1/e<0?(e=-e,-1):1,e===~~e){for(u=0,c=e;c>=10;c/=10,u++);return void(u>F?m.c=m.e=null:(m.e=u,m.c=[e]))}g=String(e)}else{if(!n.test(g=String(e)))return R(m,g,d);m.s=45==g.charCodeAt(0)?(g=g.slice(1),-1):1}(u=g.indexOf("."))>-1&&(g=g.replace(".","")),(c=g.search(/e/i))>0?(u<0&&(u=c),u+=+g.slice(c+1),g=g.substring(0,c)):u<0&&(u=g.length)}else{if(f(t,2,W.length,"Base"),10==t&&j)return K(m=new G(e),P+m.e+1,_);if(g=String(e),d="number"==typeof e){if(0*e!=0)return R(m,g,d,t);if(m.s=1/e<0?(g=g.slice(1),-1):1,G.DEBUG&&g.replace(/^0\.0*|\./,"").length>15)throw Error(s+e)}else m.s=45===g.charCodeAt(0)?(g=g.slice(1),-1):1;for(r=W.slice(0,t),u=c=0,p=g.length;c<p;c++)if(r.indexOf(o=g.charAt(c))<0){if("."==o){if(c>u){u=p;continue}}else if(!a&&(g==g.toUpperCase()&&(g=g.toLowerCase())||g==g.toLowerCase()&&(g=g.toUpperCase()))){a=!0,c=-1,u=0;continue}return R(m,String(e),d,t)}d=!1,(u=(g=S(g,t,10,m.s)).indexOf("."))>-1?g=g.replace(".",""):u=g.length}for(c=0;48===g.charCodeAt(c);c++);for(p=g.length;48===g.charCodeAt(--p););if(g=g.slice(c,++p)){if(p-=c,d&&G.DEBUG&&p>15&&(e>h||e!==i(e)))throw Error(s+m.s*e);if((u=u-c-1)>F)m.c=m.e=null;else if(u<k)m.c=[m.e=0];else{if(m.e=u,m.c=[],c=(u+1)%l,u<0&&(c+=l),c<p){for(c&&m.c.push(+g.slice(0,c)),p-=l;c<p;)m.c.push(+g.slice(c,c+=l));c=l-(g=g.slice(c)).length}else c-=p;for(;c--;g+="0");m.c.push(+g)}}else m.c=[m.e=0]}function z(e,t,n,r){var i,o,s,a,l;if(null==n?n=_:f(n,0,8),!e.c)return e.toString();if(i=e.c[0],s=e.e,null==t)l=g(e.c),l=1==r||2==r&&(s<=L||s>=H)?y(l,s):v(l,s,"0");else if(o=(e=K(new G(e),t,n)).e,a=(l=g(e.c)).length,1==r||2==r&&(t<=o||o<=L)){for(;a<t;l+="0",a++);l=y(l,o)}else if(t-=s,l=v(l,o,"0"),o+1>a){if(--t>0)for(l+=".";t--;l+="0");}else if((t+=o-a)>0)for(o+1==a&&(l+=".");t--;l+="0");return e.s<0&&i?"-"+l:l}function $(e,t){for(var n,r,i=1,o=new G(e[0]);i<e.length;i++)(!(r=new G(e[i])).s||(n=m(o,r))===t||0===n&&o.s===t)&&(o=r);return o}function Y(e,t,n){for(var r=1,i=t.length;!t[--i];t.pop());for(i=t[0];i>=10;i/=10,r++);return(n=r+n*l-1)>F?e.c=e.e=null:n<k?e.c=[e.e=0]:(e.e=n,e.c=t),e}function K(e,t,n,o){var s,h,c,d,p,g,m,f=e.c,w=u;if(f){e:{for(s=1,d=f[0];d>=10;d/=10,s++);if((h=t-s)<0)h+=l,c=t,p=f[g=0],m=i(p/w[s-c-1]%10);else if((g=r((h+1)/l))>=f.length){if(!o)break e;for(;f.length<=g;f.push(0));p=m=0,s=1,c=(h%=l)-l+1}else{for(p=d=f[g],s=1;d>=10;d/=10,s++);m=(c=(h%=l)-l+s)<0?0:i(p/w[s-c-1]%10)}if(o=o||t<0||null!=f[g+1]||(c<0?p:p%w[s-c-1]),o=n<4?(m||o)&&(0==n||n==(e.s<0?3:2)):m>5||5==m&&(4==n||o||6==n&&(h>0?c>0?p/w[s-c]:0:f[g-1])%10&1||n==(e.s<0?8:7)),t<1||!f[0])return f.length=0,o?(t-=e.e+1,f[0]=w[(l-t%l)%l],e.e=-t||0):f[0]=e.e=0,e;if(0==h?(f.length=g,d=1,g--):(f.length=g+1,d=w[l-h],f[g]=c>0?i(p/w[s-c]%w[c])*d:0),o)for(;;){if(0==g){for(h=1,c=f[0];c>=10;c/=10,h++);for(c=f[0]+=d,d=1;c>=10;c/=10,d++);h!=d&&(e.e++,f[0]==a&&(f[0]=1));break}if(f[g]+=d,f[g]!=a)break;f[g--]=0,d=1}for(h=f.length;0===f[--h];f.pop());}e.e>F?e.c=e.e=null:e.e<k&&(e.c=[e.e=0])}return e}function X(e){var t,n=e.e;return null===n?e.toString():(t=g(e.c),t=n<=L||n>=H?y(t,n):v(t,n,"0"),e.s<0?"-"+t:t)}return G.clone=e,G.ROUND_UP=0,G.ROUND_DOWN=1,G.ROUND_CEIL=2,G.ROUND_FLOOR=3,G.ROUND_HALF_UP=4,G.ROUND_HALF_DOWN=5,G.ROUND_HALF_EVEN=6,G.ROUND_HALF_CEIL=7,G.ROUND_HALF_FLOOR=8,G.EUCLID=9,G.config=G.set=function(e){var t,n;if(null!=e){if("object"!=typeof e)throw Error(o+"Object expected: "+e);if(e.hasOwnProperty(t="DECIMAL_PLACES")&&(f(n=e[t],0,d,t),P=n),e.hasOwnProperty(t="ROUNDING_MODE")&&(f(n=e[t],0,8,t),_=n),e.hasOwnProperty(t="EXPONENTIAL_AT")&&((n=e[t])&&n.pop?(f(n[0],-d,0,t),f(n[1],0,d,t),L=n[0],H=n[1]):(f(n,-d,d,t),L=-(H=n<0?-n:n))),e.hasOwnProperty(t="RANGE"))if((n=e[t])&&n.pop)f(n[0],-d,-1,t),f(n[1],1,d,t),k=n[0],F=n[1];else{if(f(n,-d,d,t),!n)throw Error(o+t+" cannot be zero: "+n);k=-(F=n<0?-n:n)}if(e.hasOwnProperty(t="CRYPTO")){if((n=e[t])!==!!n)throw Error(o+t+" not true or false: "+n);if(n){if("undefined"==typeof crypto||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw D=!n,Error(o+"crypto unavailable");D=n}else D=n}if(e.hasOwnProperty(t="MODULO_MODE")&&(f(n=e[t],0,9,t),V=n),e.hasOwnProperty(t="POW_PRECISION")&&(f(n=e[t],0,d,t),U=n),e.hasOwnProperty(t="FORMAT")){if("object"!=typeof(n=e[t]))throw Error(o+t+" not an object: "+n);B=n}if(e.hasOwnProperty(t="ALPHABET")){if("string"!=typeof(n=e[t])||/^.?$|[+\-.\s]|(.).*\1/.test(n))throw Error(o+t+" invalid: "+n);j="0123456789"==n.slice(0,10),W=n}}return{DECIMAL_PLACES:P,ROUNDING_MODE:_,EXPONENTIAL_AT:[L,H],RANGE:[k,F],CRYPTO:D,MODULO_MODE:V,POW_PRECISION:U,FORMAT:B,ALPHABET:W}},G.isBigNumber=function(e){if(!e||!0!==e._isBigNumber)return!1;if(!G.DEBUG)return!0;var t,n,r=e.c,s=e.e,h=e.s;e:if("[object Array]"=={}.toString.call(r)){if((1===h||-1===h)&&s>=-d&&s<=d&&s===i(s)){if(0===r[0]){if(0===s&&1===r.length)return!0;break e}if((t=(s+1)%l)<1&&(t+=l),String(r[0]).length==t){for(t=0;t<r.length;t++)if((n=r[t])<0||n>=a||n!==i(n))break e;if(0!==n)return!0}}}else if(null===r&&null===s&&(null===h||1===h||-1===h))return!0;throw Error(o+"Invalid BigNumber: "+e)},G.maximum=G.max=function(){return $(arguments,-1)},G.minimum=G.min=function(){return $(arguments,1)},G.random=(E=9007199254740992,b=Math.random()*E&2097151?function(){return i(Math.random()*E)}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)},function(e){var t,n,s,a,h,c=0,p=[],g=new G(x);if(null==e?e=P:f(e,0,d),a=r(e/l),D)if(crypto.getRandomValues){for(t=crypto.getRandomValues(new Uint32Array(a*=2));c<a;)(h=131072*t[c]+(t[c+1]>>>11))>=9e15?(n=crypto.getRandomValues(new Uint32Array(2)),t[c]=n[0],t[c+1]=n[1]):(p.push(h%1e14),c+=2);c=a/2}else{if(!crypto.randomBytes)throw D=!1,Error(o+"crypto unavailable");for(t=crypto.randomBytes(a*=7);c<a;)(h=281474976710656*(31&t[c])+1099511627776*t[c+1]+4294967296*t[c+2]+16777216*t[c+3]+(t[c+4]<<16)+(t[c+5]<<8)+t[c+6])>=9e15?crypto.randomBytes(7).copy(t,c):(p.push(h%1e14),c+=7);c=a/7}if(!D)for(;c<a;)(h=b())<9e15&&(p[c++]=h%1e14);for(a=p[--c],e%=l,a&&e&&(h=u[l-e],p[c]=i(a/h)*h);0===p[c];p.pop(),c--);if(c<0)p=[s=0];else{for(s=-1;0===p[0];p.splice(0,1),s-=l);for(c=1,h=p[0];h>=10;h/=10,c++);c<l&&(s-=l-c)}return g.e=s,g.c=p,g}),G.sum=function(){for(var e=1,t=arguments,n=new G(t[0]);e<t.length;)n=n.plus(t[e++]);return n},S=function(){var e="0123456789";function t(e,t,n,r){for(var i,o,s=[0],a=0,l=e.length;a<l;){for(o=s.length;o--;s[o]*=t);for(s[0]+=r.indexOf(e.charAt(a++)),i=0;i<s.length;i++)s[i]>n-1&&(null==s[i+1]&&(s[i+1]=0),s[i+1]+=s[i]/n|0,s[i]%=n)}return s.reverse()}return function(n,r,i,o,s){var a,l,h,u,c,d,p,m,f=n.indexOf("."),w=P,y=_;for(f>=0&&(u=U,U=0,n=n.replace(".",""),d=(m=new G(r)).pow(n.length-f),U=u,m.c=t(v(g(d.c),d.e,"0"),10,i,e),m.e=m.c.length),h=u=(p=t(n,r,i,s?(a=W,e):(a=e,W))).length;0==p[--u];p.pop());if(!p[0])return a.charAt(0);if(f<0?--h:(d.c=p,d.e=h,d.s=o,p=(d=C(d,m,w,y,i)).c,c=d.r,h=d.e),f=p[l=h+w+1],u=i/2,c=c||l<0||null!=p[l+1],c=y<4?(null!=f||c)&&(0==y||y==(d.s<0?3:2)):f>u||f==u&&(4==y||c||6==y&&1&p[l-1]||y==(d.s<0?8:7)),l<1||!p[0])n=c?v(a.charAt(1),-w,a.charAt(0)):a.charAt(0);else{if(p.length=l,c)for(--i;++p[--l]>i;)p[l]=0,l||(++h,p=[1].concat(p));for(u=p.length;!p[--u];);for(f=0,n="";f<=u;n+=a.charAt(p[f++]));n=v(n,h,a.charAt(0))}return n}}(),C=function(){function e(e,t,n){var r,i,o,s,a=0,l=e.length,h=t%c,u=t/c|0;for(e=e.slice();l--;)a=((i=h*(o=e[l]%c)+(r=u*o+(s=e[l]/c|0)*h)%c*c+a)/n|0)+(r/c|0)+u*s,e[l]=i%n;return a&&(e=[a].concat(e)),e}function t(e,t,n,r){var i,o;if(n!=r)o=n>r?1:-1;else for(i=o=0;i<n;i++)if(e[i]!=t[i]){o=e[i]>t[i]?1:-1;break}return o}function n(e,t,n,r){for(var i=0;n--;)e[n]-=i,i=e[n]<t[n]?1:0,e[n]=i*r+e[n]-t[n];for(;!e[0]&&e.length>1;e.splice(0,1));}return function(r,o,s,h,u){var c,d,g,m,f,w,y,v,C,S,R,E,b,T,N,A,M,I=r.s==o.s?1:-1,O=r.c,x=o.c;if(!(O&&O[0]&&x&&x[0]))return new G(r.s&&o.s&&(O?!x||O[0]!=x[0]:x)?O&&0==O[0]||!x?0*I:I/0:NaN);for(C=(v=new G(I)).c=[],I=s+(d=r.e-o.e)+1,u||(u=a,d=p(r.e/l)-p(o.e/l),I=I/l|0),g=0;x[g]==(O[g]||0);g++);if(x[g]>(O[g]||0)&&d--,I<0)C.push(1),m=!0;else{for(T=O.length,A=x.length,g=0,I+=2,(f=i(u/(x[0]+1)))>1&&(x=e(x,f,u),O=e(O,f,u),A=x.length,T=O.length),b=A,R=(S=O.slice(0,A)).length;R<A;S[R++]=0);M=x.slice(),M=[0].concat(M),N=x[0],x[1]>=u/2&&N++;do{if(f=0,(c=t(x,S,A,R))<0){if(E=S[0],A!=R&&(E=E*u+(S[1]||0)),(f=i(E/N))>1)for(f>=u&&(f=u-1),y=(w=e(x,f,u)).length,R=S.length;1==t(w,S,y,R);)f--,n(w,A<y?M:x,y,u),y=w.length,c=1;else 0==f&&(c=f=1),y=(w=x.slice()).length;if(y<R&&(w=[0].concat(w)),n(S,w,R,u),R=S.length,-1==c)for(;t(x,S,A,R)<1;)f++,n(S,A<R?M:x,R,u),R=S.length}else 0===c&&(f++,S=[0]);C[g++]=f,S[0]?S[R++]=O[b]||0:(S=[O[b]],R=1)}while((b++<T||null!=S[0])&&I--);m=null!=S[0],C[0]||C.splice(0,1)}if(u==a){for(g=1,I=C[0];I>=10;I/=10,g++);K(v,s+(v.e=g+d*l-1)+1,h,m)}else v.e=d,v.r=+m;return v}}(),T=/^(-?)0([xbo])(?=\w[\w.]*$)/i,N=/^([^.]+)\.$/,A=/^\.([^.]+)$/,M=/^-?(Infinity|NaN)$/,I=/^\s*\+(?=[\w.])|^\s+|\s+$/g,R=function(e,t,n,r){var i,s=n?t:t.replace(I,"");if(M.test(s))e.s=isNaN(s)?null:s<0?-1:1;else{if(!n&&(s=s.replace(T,(function(e,t,n){return i="x"==(n=n.toLowerCase())?16:"b"==n?2:8,r&&r!=i?e:t})),r&&(i=r,s=s.replace(N,"$1").replace(A,"0.$1")),t!=s))return new G(s,i);if(G.DEBUG)throw Error(o+"Not a"+(r?" base "+r:"")+" number: "+t);e.s=null}e.c=e.e=null},O.absoluteValue=O.abs=function(){var e=new G(this);return e.s<0&&(e.s=1),e},O.comparedTo=function(e,t){return m(this,new G(e,t))},O.decimalPlaces=O.dp=function(e,t){var n,r,i,o=this;if(null!=e)return f(e,0,d),null==t?t=_:f(t,0,8),K(new G(o),e+o.e+1,t);if(!(n=o.c))return null;if(r=((i=n.length-1)-p(this.e/l))*l,i=n[i])for(;i%10==0;i/=10,r--);return r<0&&(r=0),r},O.dividedBy=O.div=function(e,t){return C(this,new G(e,t),P,_)},O.dividedToIntegerBy=O.idiv=function(e,t){return C(this,new G(e,t),0,1)},O.exponentiatedBy=O.pow=function(e,t){var n,s,a,h,u,c,d,p,g=this;if((e=new G(e)).c&&!e.isInteger())throw Error(o+"Exponent not an integer: "+X(e));if(null!=t&&(t=new G(t)),u=e.e>14,!g.c||!g.c[0]||1==g.c[0]&&!g.e&&1==g.c.length||!e.c||!e.c[0])return p=new G(Math.pow(+X(g),u?e.s*(2-w(e)):+X(e))),t?p.mod(t):p;if(c=e.s<0,t){if(t.c?!t.c[0]:!t.s)return new G(NaN);(s=!c&&g.isInteger()&&t.isInteger())&&(g=g.mod(t))}else{if(e.e>9&&(g.e>0||g.e<-1||(0==g.e?g.c[0]>1||u&&g.c[1]>=24e7:g.c[0]<8e13||u&&g.c[0]<=9999975e7)))return h=g.s<0&&w(e)?-0:0,g.e>-1&&(h=1/h),new G(c?1/h:h);U&&(h=r(U/l+2))}for(u?(n=new G(.5),c&&(e.s=1),d=w(e)):d=(a=Math.abs(+X(e)))%2,p=new G(x);;){if(d){if(!(p=p.times(g)).c)break;h?p.c.length>h&&(p.c.length=h):s&&(p=p.mod(t))}if(a){if(0===(a=i(a/2)))break;d=a%2}else if(K(e=e.times(n),e.e+1,1),e.e>14)d=w(e);else{if(0==(a=+X(e)))break;d=a%2}g=g.times(g),h?g.c&&g.c.length>h&&(g.c.length=h):s&&(g=g.mod(t))}return s?p:(c&&(p=x.div(p)),t?p.mod(t):h?K(p,U,_,void 0):p)},O.integerValue=function(e){var t=new G(this);return null==e?e=_:f(e,0,8),K(t,t.e+1,e)},O.isEqualTo=O.eq=function(e,t){return 0===m(this,new G(e,t))},O.isFinite=function(){return!!this.c},O.isGreaterThan=O.gt=function(e,t){return m(this,new G(e,t))>0},O.isGreaterThanOrEqualTo=O.gte=function(e,t){return 1===(t=m(this,new G(e,t)))||0===t},O.isInteger=function(){return!!this.c&&p(this.e/l)>this.c.length-2},O.isLessThan=O.lt=function(e,t){return m(this,new G(e,t))<0},O.isLessThanOrEqualTo=O.lte=function(e,t){return-1===(t=m(this,new G(e,t)))||0===t},O.isNaN=function(){return!this.s},O.isNegative=function(){return this.s<0},O.isPositive=function(){return this.s>0},O.isZero=function(){return!!this.c&&0==this.c[0]},O.minus=function(e,t){var n,r,i,o,s=this,h=s.s;if(t=(e=new G(e,t)).s,!h||!t)return new G(NaN);if(h!=t)return e.s=-t,s.plus(e);var u=s.e/l,c=e.e/l,d=s.c,g=e.c;if(!u||!c){if(!d||!g)return d?(e.s=-t,e):new G(g?s:NaN);if(!d[0]||!g[0])return g[0]?(e.s=-t,e):new G(d[0]?s:3==_?-0:0)}if(u=p(u),c=p(c),d=d.slice(),h=u-c){for((o=h<0)?(h=-h,i=d):(c=u,i=g),i.reverse(),t=h;t--;i.push(0));i.reverse()}else for(r=(o=(h=d.length)<(t=g.length))?h:t,h=t=0;t<r;t++)if(d[t]!=g[t]){o=d[t]<g[t];break}if(o&&(i=d,d=g,g=i,e.s=-e.s),(t=(r=g.length)-(n=d.length))>0)for(;t--;d[n++]=0);for(t=a-1;r>h;){if(d[--r]<g[r]){for(n=r;n&&!d[--n];d[n]=t);--d[n],d[r]+=a}d[r]-=g[r]}for(;0==d[0];d.splice(0,1),--c);return d[0]?Y(e,d,c):(e.s=3==_?-1:1,e.c=[e.e=0],e)},O.modulo=O.mod=function(e,t){var n,r,i=this;return e=new G(e,t),!i.c||!e.s||e.c&&!e.c[0]?new G(NaN):!e.c||i.c&&!i.c[0]?new G(i):(9==V?(r=e.s,e.s=1,n=C(i,e,0,3),e.s=r,n.s*=r):n=C(i,e,0,V),(e=i.minus(n.times(e))).c[0]||1!=V||(e.s=i.s),e)},O.multipliedBy=O.times=function(e,t){var n,r,i,o,s,h,u,d,g,m,f,w,y,v,C,S=this,R=S.c,E=(e=new G(e,t)).c;if(!(R&&E&&R[0]&&E[0]))return!S.s||!e.s||R&&!R[0]&&!E||E&&!E[0]&&!R?e.c=e.e=e.s=null:(e.s*=S.s,R&&E?(e.c=[0],e.e=0):e.c=e.e=null),e;for(r=p(S.e/l)+p(e.e/l),e.s*=S.s,(u=R.length)<(m=E.length)&&(y=R,R=E,E=y,i=u,u=m,m=i),i=u+m,y=[];i--;y.push(0));for(v=a,C=c,i=m;--i>=0;){for(n=0,f=E[i]%C,w=E[i]/C|0,o=i+(s=u);o>i;)n=((d=f*(d=R[--s]%C)+(h=w*d+(g=R[s]/C|0)*f)%C*C+y[o]+n)/v|0)+(h/C|0)+w*g,y[o--]=d%v;y[o]=n}return n?++r:y.splice(0,1),Y(e,y,r)},O.negated=function(){var e=new G(this);return e.s=-e.s||null,e},O.plus=function(e,t){var n,r=this,i=r.s;if(t=(e=new G(e,t)).s,!i||!t)return new G(NaN);if(i!=t)return e.s=-t,r.minus(e);var o=r.e/l,s=e.e/l,h=r.c,u=e.c;if(!o||!s){if(!h||!u)return new G(i/0);if(!h[0]||!u[0])return u[0]?e:new G(h[0]?r:0*i)}if(o=p(o),s=p(s),h=h.slice(),i=o-s){for(i>0?(s=o,n=u):(i=-i,n=h),n.reverse();i--;n.push(0));n.reverse()}for((i=h.length)-(t=u.length)<0&&(n=u,u=h,h=n,t=i),i=0;t;)i=(h[--t]=h[t]+u[t]+i)/a|0,h[t]=a===h[t]?0:h[t]%a;return i&&(h=[i].concat(h),++s),Y(e,h,s)},O.precision=O.sd=function(e,t){var n,r,i,o=this;if(null!=e&&e!==!!e)return f(e,1,d),null==t?t=_:f(t,0,8),K(new G(o),e,t);if(!(n=o.c))return null;if(r=(i=n.length-1)*l+1,i=n[i]){for(;i%10==0;i/=10,r--);for(i=n[0];i>=10;i/=10,r++);}return e&&o.e+1>r&&(r=o.e+1),r},O.shiftedBy=function(e){return f(e,-9007199254740991,h),this.times("1e"+e)},O.squareRoot=O.sqrt=function(){var e,t,n,r,i,o=this,s=o.c,a=o.s,l=o.e,h=P+4,u=new G("0.5");if(1!==a||!s||!s[0])return new G(!a||a<0&&(!s||s[0])?NaN:s?o:1/0);if(0==(a=Math.sqrt(+X(o)))||a==1/0?(((t=g(s)).length+l)%2==0&&(t+="0"),a=Math.sqrt(+t),l=p((l+1)/2)-(l<0||l%2),n=new G(t=a==1/0?"5e"+l:(t=a.toExponential()).slice(0,t.indexOf("e")+1)+l)):n=new G(a+""),n.c[0])for((a=(l=n.e)+h)<3&&(a=0);;)if(i=n,n=u.times(i.plus(C(o,i,h,1))),g(i.c).slice(0,a)===(t=g(n.c)).slice(0,a)){if(n.e<l&&--a,"9999"!=(t=t.slice(a-3,a+1))&&(r||"4999"!=t)){+t&&(+t.slice(1)||"5"!=t.charAt(0))||(K(n,n.e+P+2,1),e=!n.times(n).eq(o));break}if(!r&&(K(i,i.e+P+2,0),i.times(i).eq(o))){n=i;break}h+=4,a+=4,r=1}return K(n,n.e+P+1,_,e)},O.toExponential=function(e,t){return null!=e&&(f(e,0,d),e++),z(this,e,t,1)},O.toFixed=function(e,t){return null!=e&&(f(e,0,d),e=e+this.e+1),z(this,e,t)},O.toFormat=function(e,t,n){var r,i=this;if(null==n)null!=e&&t&&"object"==typeof t?(n=t,t=null):e&&"object"==typeof e?(n=e,e=t=null):n=B;else if("object"!=typeof n)throw Error(o+"Argument not an object: "+n);if(r=i.toFixed(e,t),i.c){var s,a=r.split("."),l=+n.groupSize,h=+n.secondaryGroupSize,u=n.groupSeparator||"",c=a[0],d=a[1],p=i.s<0,g=p?c.slice(1):c,m=g.length;if(h&&(s=l,l=h,h=s,m-=s),l>0&&m>0){for(s=m%l||l,c=g.substr(0,s);s<m;s+=l)c+=u+g.substr(s,l);h>0&&(c+=u+g.slice(s)),p&&(c="-"+c)}r=d?c+(n.decimalSeparator||"")+((h=+n.fractionGroupSize)?d.replace(new RegExp("\\d{"+h+"}\\B","g"),"$&"+(n.fractionGroupSeparator||"")):d):c}return(n.prefix||"")+r+(n.suffix||"")},O.toFraction=function(e){var t,n,r,i,s,a,h,c,d,p,m,f,w=this,y=w.c;if(null!=e&&(!(h=new G(e)).isInteger()&&(h.c||1!==h.s)||h.lt(x)))throw Error(o+"Argument "+(h.isInteger()?"out of range: ":"not an integer: ")+X(h));if(!y)return new G(w);for(t=new G(x),d=n=new G(x),r=c=new G(x),f=g(y),s=t.e=f.length-w.e-1,t.c[0]=u[(a=s%l)<0?l+a:a],e=!e||h.comparedTo(t)>0?s>0?t:d:h,a=F,F=1/0,h=new G(f),c.c[0]=0;p=C(h,t,0,1),1!=(i=n.plus(p.times(r))).comparedTo(e);)n=r,r=i,d=c.plus(p.times(i=d)),c=i,t=h.minus(p.times(i=t)),h=i;return i=C(e.minus(n),r,0,1),c=c.plus(i.times(d)),n=n.plus(i.times(r)),c.s=d.s=w.s,m=C(d,r,s*=2,_).minus(w).abs().comparedTo(C(c,n,s,_).minus(w).abs())<1?[d,r]:[c,n],F=a,m},O.toNumber=function(){return+X(this)},O.toPrecision=function(e,t){return null!=e&&f(e,1,d),z(this,e,t,2)},O.toString=function(e){var t,n=this,r=n.s,i=n.e;return null===i?r?(t="Infinity",r<0&&(t="-"+t)):t="NaN":(null==e?t=i<=L||i>=H?y(g(n.c),i):v(g(n.c),i,"0"):10===e&&j?t=v(g((n=K(new G(n),P+i+1,_)).c),n.e,"0"):(f(e,2,W.length,"Base"),t=S(v(g(n.c),i,"0"),10,e,r,!0)),r<0&&n.c[0]&&(t="-"+t)),t},O.valueOf=O.toJSON=function(){return X(this)},O._isBigNumber=!0,null!=t&&G.set(t),G}(),t.default=t.BigNumber=t,NO.exports?NO.exports=t:(e||(e="undefined"!=typeof self&&self?self:window),e.BigNumber=t)}(fO);var MO=AO.exports;
/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const IO=bO(),OO=CO(),xO=EO,PO=MO,_O={trillion:Math.pow(10,12),billion:Math.pow(10,9),million:Math.pow(10,6),thousand:Math.pow(10,3)},LO={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1,roundingFunction:Math.round,spaceSeparatedAbbreviation:!1},{binarySuffixes:HO,decimalSuffixes:kO}=IO.currentBytes(),FO={general:{scale:1024,suffixes:kO,marker:"bd"},binary:{scale:1024,suffixes:HO,marker:"b"},decimal:{scale:1e3,suffixes:kO,marker:"d"}};function DO(e,t={},n){if("string"==typeof t&&(t=xO.parseFormat(t)),!OO.validateFormat(t))return"ERROR: invalid format";let r=t.prefix||"",i=t.postfix||"",o=function(e,t,n){switch(t.output){case"currency":return function(e,t,n){const r=n.currentCurrency();let i,o=Object.assign({},t),s=Object.assign({},LO,o),a="",l=!!s.totalLength||!!s.forceAverage||s.average,h=o.currencyPosition||r.position,u=o.currencySymbol||r.symbol;const c=void 0!==s.spaceSeparatedCurrency?s.spaceSeparatedCurrency:s.spaceSeparated;void 0===o.lowPrecision&&(o.lowPrecision=!1);c&&(a=" ");"infix"===h&&(i=a+u+a);let d=WO({instance:e,providedFormat:o,state:n,decimalSeparator:i});"prefix"===h&&(d=e._value<0&&"sign"===s.negative?`-${a}${u}${d.slice(1)}`:e._value>0&&s.forceSign?`+${a}${u}${d.slice(1)}`:u+a+d);h&&"postfix"!==h||(a=!s.spaceSeparatedAbbreviation&&l?"":a,d=d+a+u);return d}(e,t=jO(t,IO.currentCurrencyDefaultFormat()),IO);case"percent":return function(e,t,n,r){let i=t.prefixSymbol,o=WO({instance:r(100*e._value),providedFormat:t,state:n}),s=Object.assign({},LO,t);if(i)return`%${s.spaceSeparated?" ":""}${o}`;return`${o}${s.spaceSeparated?" ":""}%`}(e,t=jO(t,IO.currentPercentageDefaultFormat()),IO,n);case"byte":return function(e,t,n,r){let i=t.base||"binary",o=Object.assign({},LO,t);const{binarySuffixes:s,decimalSuffixes:a}=n.currentBytes();let l={general:{scale:1024,suffixes:a||kO,marker:"bd"},binary:{scale:1024,suffixes:s||HO,marker:"b"},decimal:{scale:1e3,suffixes:a||kO,marker:"d"}}[i],{value:h,suffix:u}=VO(e._value,l.suffixes,l.scale),c=WO({instance:r(h),providedFormat:t,state:n,defaults:n.currentByteDefaultFormat()});return`${c}${o.spaceSeparated?" ":""}${u}`}(e,t=jO(t,IO.currentByteDefaultFormat()),IO,n);case"time":return t=jO(t,IO.currentTimeDefaultFormat()),function(e){let t=Math.floor(e._value/60/60),n=Math.floor((e._value-60*t*60)/60),r=Math.round(e._value-60*t*60-60*n);return`${t}:${n<10?"0":""}${n}:${r<10?"0":""}${r}`}(e);case"ordinal":return function(e,t,n){let r=n.currentOrdinal(),i=Object.assign({},LO,t),o=WO({instance:e,providedFormat:t,state:n}),s=r(e._value);return`${o}${i.spaceSeparated?" ":""}${s}`}(e,t=jO(t,IO.currentOrdinalDefaultFormat()),IO);default:return WO({instance:e,providedFormat:t,numbro:n})}}(e,t,n);return o=function(e,t){return t+e}(o,r),o=function(e,t){return e+t}(o,i),o}function VO(e,t,n){let r=t[0],i=Math.abs(e);if(i>=n){for(let o=1;o<t.length;++o){let s=Math.pow(n,o),a=Math.pow(n,o+1);if(i>=s&&i<a){r=t[o],e/=s;break}}r===t[0]&&(e/=Math.pow(n,t.length-1),r=t[t.length-1])}return{value:e,suffix:r}}function UO(e){let t="";for(let n=0;n<e;n++)t+="0";return t}function BO(e,t,n=Math.round){if(-1!==e.toString().indexOf("e"))return function(e,t){let n=e.toString(),[r,i]=n.split("e"),[o,s=""]=r.split(".");if(+i>0)n=o+s+UO(i-s.length);else{let e=".";e=+o<0?`-0${e}`:`0${e}`;let r=(UO(-i-1)+Math.abs(o)+s).substr(0,t);r.length<t&&(r+=UO(t-r.length)),n=e+r}return+i>0&&t>0&&(n+=`.${UO(t)}`),n}(e,t);return new PO(n(+`${e}e+${t}`)/Math.pow(10,t)).toFixed(t)}function WO({instance:e,providedFormat:t,state:n=IO,decimalSeparator:r,defaults:i=n.currentDefaults()}){let o=e._value;if(0===o&&n.hasZeroFormat())return n.getZeroFormat();if(!isFinite(o))return o.toString();let s=Object.assign({},LO,i,t),a=s.totalLength,l=a?0:s.characteristic,h=s.optionalCharacteristic,u=s.forceAverage,c=s.lowPrecision,d=!!a||!!u||s.average,p=a?-1:d&&void 0===t.mantissa?0:s.mantissa,g=!a&&(void 0===t.optionalMantissa?-1===p:s.optionalMantissa),m=s.trimMantissa,f=s.thousandSeparated,w=s.spaceSeparated,y=s.negative,v=s.forceSign,C=s.exponential,S=s.roundingFunction,R="";if(d){let e=function({value:e,forceAverage:t,lowPrecision:n=!0,abbreviations:r,spaceSeparated:i=!1,totalLength:o=0,roundingFunction:s=Math.round}){let a="",l=Math.abs(e),h=-1;if(t&&r[t]&&_O[t]?(a=r[t],e/=_O[t]):l>=_O.trillion||n&&1===s(l/_O.trillion)?(a=r.trillion,e/=_O.trillion):l<_O.trillion&&l>=_O.billion||n&&1===s(l/_O.billion)?(a=r.billion,e/=_O.billion):l<_O.billion&&l>=_O.million||n&&1===s(l/_O.million)?(a=r.million,e/=_O.million):(l<_O.million&&l>=_O.thousand||n&&1===s(l/_O.thousand))&&(a=r.thousand,e/=_O.thousand),a&&(a=(i?" ":"")+a),o){let t=e<0,n=e.toString().split(".")[0],r=t?n.length-1:n.length;h=Math.max(o-r,0)}return{value:e,abbreviation:a,mantissaPrecision:h}}({value:o,forceAverage:u,lowPrecision:c,abbreviations:n.currentAbbreviations(),spaceSeparated:w,roundingFunction:S,totalLength:a});o=e.value,R+=e.abbreviation,a&&(p=e.mantissaPrecision)}if(C){let e=function({value:e,characteristicPrecision:t}){let[n,r]=e.toExponential().split("e"),i=+n;return t?(1<t&&(i*=Math.pow(10,t-1),r=+r-(t-1),r=r>=0?`+${r}`:r),{value:i,abbreviation:`e${r}`}):{value:i,abbreviation:`e${r}`}}({value:o,characteristicPrecision:l});o=e.value,R=e.abbreviation+R}let E=function(e,t,n,r,i,o){if(-1===r)return e;let s=BO(t,r,o),[a,l=""]=s.toString().split(".");if(l.match(/^0+$/)&&(n||i))return a;let h=l.match(/0+$/);return i&&h?`${a}.${l.toString().slice(0,h.index)}`:s.toString()}(o.toString(),o,g,p,m,S);return E=function(e,t,n,r){let i=e,[o,s]=i.toString().split(".");if(o.match(/^-?0$/)&&n)return s?`${o.replace("0","")}.${s}`:o.replace("0","");const a=t<0&&0===o.indexOf("-");if(a&&(o=o.slice(1),i=i.slice(1)),o.length<r){let e=r-o.length;for(let t=0;t<e;t++)i=`0${i}`}return a&&(i=`-${i}`),i.toString()}(E,o,h,l),E=function(e,t,n,r,i){let o=r.currentDelimiters(),s=o.thousands;i=i||o.decimal;let a=o.thousandsSize||3,l=e.toString(),h=l.split(".")[0],u=l.split(".")[1];const c=t<0&&0===h.indexOf("-");if(n){c&&(h=h.slice(1));let e=function(e,t){let n=[],r=0;for(let i=e;i>0;i--)r===t&&(n.unshift(i),r=0),r++;return n}(h.length,a);e.forEach(((e,t)=>{h=h.slice(0,e+t)+s+h.slice(e+t)})),c&&(h=`-${h}`)}return l=u?h+i+u:h,l}(E,o,f,n,r),(d||C)&&(E=function(e,t){return e+t}(E,R)),(v||o<0)&&(E=function(e,t,n){return 0===t?e:0==+e?e.replace("-",""):t>0?`+${e}`:"sign"===n?e:`(${e.replace("-","")})`}(E,o,y)),E}function jO(e,t){if(!e)return t;let n=Object.keys(e);return 1===n.length&&"output"===n[0]?t:e}
/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */
const GO=MO;function zO(e,t,n){let r=new GO(e._value),i=t;return n.isNumbro(t)&&(i=t._value),i=new GO(i),e._value=r.minus(i).toNumber(),e}
/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */
const $O=bO(),YO=CO(),KO=(e=>({loadLanguagesInNode:t=>TO(t,e)}))(tx),XO=vO();let qO=(e=>({format:(...t)=>DO(...t,e),getByteUnit:(...t)=>function(e){let t=FO.general;return VO(e._value,t.suffixes,t.scale).suffix}(...t,e),getBinaryByteUnit:(...t)=>function(e){let t=FO.binary;return VO(e._value,t.suffixes,t.scale).suffix}(...t,e),getDecimalByteUnit:(...t)=>function(e){let t=FO.decimal;return VO(e._value,t.suffixes,t.scale).suffix}(...t,e),formatOrDefault:jO}))(tx),QO=(e=>({add:(t,n)=>function(e,t,n){let r=new GO(e._value),i=t;return n.isNumbro(t)&&(i=t._value),i=new GO(i),e._value=r.plus(i).toNumber(),e}(t,n,e),subtract:(t,n)=>zO(t,n,e),multiply:(t,n)=>function(e,t,n){let r=new GO(e._value),i=t;return n.isNumbro(t)&&(i=t._value),i=new GO(i),e._value=r.times(i).toNumber(),e}(t,n,e),divide:(t,n)=>function(e,t,n){let r=new GO(e._value),i=t;return n.isNumbro(t)&&(i=t._value),i=new GO(i),e._value=r.dividedBy(i).toNumber(),e}(t,n,e),set:(t,n)=>function(e,t,n){let r=t;return n.isNumbro(t)&&(r=t._value),e._value=r,e}(t,n,e),difference:(t,n)=>function(e,t,n){let r=n(e._value);return zO(r,t,n),Math.abs(r._value)}(t,n,e),BigNumber:GO}))(tx);const ZO=EO;class JO{constructor(e){this._value=e}clone(){return tx(this._value)}format(e={}){return qO.format(this,e)}formatCurrency(e){return"string"==typeof e&&(e=ZO.parseFormat(e)),(e=qO.formatOrDefault(e,$O.currentCurrencyDefaultFormat())).output="currency",qO.format(this,e)}formatTime(e={}){return e.output="time",qO.format(this,e)}binaryByteUnits(){return qO.getBinaryByteUnit(this)}decimalByteUnits(){return qO.getDecimalByteUnit(this)}byteUnits(){return qO.getByteUnit(this)}difference(e){return QO.difference(this,e)}add(e){return QO.add(this,e)}subtract(e){return QO.subtract(this,e)}multiply(e){return QO.multiply(this,e)}divide(e){return QO.divide(this,e)}set(e){return QO.set(this,ex(e))}value(){return this._value}valueOf(){return this._value}}function ex(e){let t=e;return tx.isNumbro(e)?t=e._value:"string"==typeof e?t=tx.unformat(e):isNaN(e)&&(t=NaN),t}function tx(e){return new JO(ex(e))}tx.version="2.5.0",tx.isNumbro=function(e){return e instanceof JO},tx.language=$O.currentLanguage,tx.registerLanguage=$O.registerLanguage,tx.setLanguage=$O.setLanguage,tx.languages=$O.languages,tx.languageData=$O.languageData,tx.zeroFormat=$O.setZeroFormat,tx.defaultFormat=$O.currentDefaults,tx.setDefaults=$O.setDefaults,tx.defaultCurrencyFormat=$O.currentCurrencyDefaultFormat,tx.validate=YO.validate,tx.loadLanguagesInNode=KO.loadLanguagesInNode,tx.unformat=XO.unformat,tx.BigNumber=QO.BigNumber;var nx=wO(tx);function rx(e,t){if(Zw(e)){const n=t.numericFormat,r=n&&n.culture||"-",i=n&&n.pattern;if(void 0!==r&&!nx.languages()[r]){const e=r.replace("-",""),t=nx.allLanguages?nx.allLanguages[r]:nx[e];t&&nx.registerLanguage(t)}nx.setLanguage(r),e=nx(e).format(i||"0")}return e}function ix(e,t,n,r,i,o,s){let a=o;if(Zw(a)){let e=[];if(Array.isArray(s.className))e=s.className;else{var l;const t=null!==(l=s.className)&&void 0!==l?l:"";t.length&&(e=t.split(" "))}a=rx(a,s),e.indexOf("htLeft")<0&&e.indexOf("htCenter")<0&&e.indexOf("htRight")<0&&e.indexOf("htJustify")<0&&e.push("htRight"),e.indexOf("htNumeric")<0&&e.push("htNumeric"),s.className=e.join(" "),t.dir="ltr"}DM(e,t,n,r,i,a,s)}ix.RENDERER_TYPE="numeric";function ox(e,t,n,r,i,o,s){DM.apply(this,[e,t,n,r,i,o,s]);const a=s.hashLength||t.innerHTML.length,l=s.hashSymbol||"*";let h="";Jw(a-1,(()=>{h+=l})),Gp(t,h)}ox.RENDERER_TYPE="password";function sx(e,t,n,r,i,o,s){DM.apply(this,[e,t,n,r,i,o,s])}sx.RENDERER_TYPE="select";function ax(e,t,n,r,i,o,s){DM.apply(this,[e,t,n,r,i,o,s]),t.dir="ltr"}ax.RENDERER_TYPE="time";function lx(e,t){let n=e;null==n&&(n=""),this.allowEmpty&&""===n?t(!0):this.strict&&this.source?"function"==typeof this.source?this.source(n,hx(n,t)):hx(n,t)(this.source):t(!0)}function hx(e,t){const n=e;return function(e){let r=!1;for(let t=0,i=e.length;t<i;t++)if(n===e[t]){r=!0;break}t(r)}}lx.VALIDATOR_TYPE="autocomplete";function ux(e,t){const n=_f(DI,this.instance);let r=e,i=!0;null==r&&(r="");let o=M(r,this.dateFormat||n.defaultDateFormat,!0).isValid(),s=M(new Date(r)).isValid()||o;if(this.allowEmpty&&""===r&&(s=!0,o=!0),s||(i=!1),!s&&o&&(i=!0),s&&!o)if(!0===this.correctFormat){const e=function(e,t){const n=M(function(e){const t=new Date(e);return isNaN(new Date(`${e}T00:00`).getDate())?t:new Date(t.getTime()+6e4*t.getTimezoneOffset())}(e)),r=M(e,t),i=e.search(/[A-Za-z]/g)>-1;let o;o=n.isValid()&&n.format("x")===r.format("x")||!r.isValid()||i?n:r;return o.format(t)}(r,this.dateFormat);this.instance.setDataAtCell(this.visualRow,this.visualCol,e,"dateValidator"),i=!0}else i=!1;t(i)}ux.VALIDATOR_TYPE="date";function cx(e,t){lx.apply(this,[e,t])}cx.VALIDATOR_TYPE="dropdown";function dx(e,t){let n=e;null==n&&(n=""),this.allowEmpty&&""===n?t(!0):t(""!==n&&Zw(e))}dx.VALIDATOR_TYPE="numeric";const px=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"];function gx(e,t){const n=this.timeFormat||"h:mm:ss a";let r=!0,i=e;null===i&&(i=""),i=/^\d{3,}$/.test(i)?parseInt(i,10):i;const o=/^\d{1,2}$/.test(i);o&&(i+=":00");const s=M(i,px,!0).isValid()?M(i):M(i,n);let a=s.isValid(),l=M(i,n,!0).isValid()&&!o;if(this.allowEmpty&&""===i&&(a=!0,l=!0),a||(r=!1),!a&&l&&(r=!0),a&&!l)if(!0===this.correctFormat){const e=s.format(n);this.instance.setDataAtCell(this.visualRow,this.visualCol,e,"timeValidator"),r=!0}else r=!1;t(r)}gx.VALIDATOR_TYPE="time";const mx={CELL_TYPE:"autocomplete",editor:sI,renderer:ZI,validator:lx},fx={CELL_TYPE:"checkbox",editor:lI,renderer:aO};function wx(e,t,n,r,i,o,s){ZI.apply(this,[e,t,n,r,i,o,s])}wx.RENDERER_TYPE="date";const yx={CELL_TYPE:"date",editor:BI,renderer:wx,validator:ux},vx={CELL_TYPE:"dropdown",editor:jI,renderer:JI,validator:cx,filter:!1,strict:!0},Cx={CELL_TYPE:"handsontable",editor:JM,renderer:hO},Sx={CELL_TYPE:"numeric",editor:GI,renderer:ix,validator:dx,dataType:"number"},Rx={CELL_TYPE:"password",editor:$I,renderer:ox,copyable:!1},Ex={CELL_TYPE:"select",editor:XI,renderer:sx},bx={CELL_TYPE:"time",editor:qI,renderer:ax,validator:gx};function Tx(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Nx(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ax(e,t){return e.get(Mx(e,t))}function Mx(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}const Ix=new Map([["plugin",function(e){return!!my(e)}],["cell-type",CA],["editor",If],["renderer",vy],["validator",Ny]]),Ox=Symbol("mainSetting"),xx=[];let Px=null;var _x=new WeakMap,Lx=new WeakSet;class Hx{static get PLUGIN_KEY(){return"base"}static get SETTING_KEYS(){return[this.PLUGIN_KEY]}static get DEFAULT_SETTINGS(){return{}}constructor(e){var t,n;Tx(t=this,n=Lx),n.add(t),Nx(this,"eventManager",new Ff(this)),Nx(this,"pluginName",null),Nx(this,"pluginsInitializedCallbacks",[]),Nx(this,"isPluginsReady",!1),Nx(this,"enabled",!1),Nx(this,"initialized",!1),function(e,t,n){Tx(e,t),t.set(e,n)}(this,_x,{}),lm(this,"hot",e,{writable:!1}),Px=null,this.hot.addHook("afterPluginsInitialized",(()=>this.onAfterPluginsInitialized())),this.hot.addHook("afterUpdateSettings",(e=>this.onUpdateSettings(e))),this.hot.addHook("beforeInit",(()=>this.init()))}init(){this.pluginName=this.hot.getPluginName(this);const e=this.constructor.PLUGIN_DEPS,t=Array.isArray(e)?e:[];if(t.length>0){const e=[];if(t.forEach((t=>{const[n,r]=t.split(":");if(!Ix.has(n))throw new Error(`Unknown plugin dependency type "${n}" was found.`);Ix.get(n)(r)||e.push(` - ${r} (${n})`)})),e.length>0){const t=[`The ${this.pluginName} plugin requires the following modules:\n`,`${e.join("\n")}\n`].join("");xx.push(t)}}Px||(Px=gy()),Px.indexOf(this.pluginName)>=0&&Px.splice(Px.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",(()=>{this.isEnabled&&this.isEnabled()&&this.enablePlugin()}));if(0===Px.length){if(xx.length>0){const e=[`${xx.join("\n")}\n`,"You have to import and register them manually."].join("");throw xx.length=0,new Error(e)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}enablePlugin(){this.enabled=!0}disablePlugin(){var e;null===(e=this.eventManager)||void 0===e||e.clear(),this.clearHooks(),this.enabled=!1}getSetting(e){const t=this.hot.getSettings()[this.constructor.PLUGIN_KEY];if(void 0===e)return t;const n=this.constructor.DEFAULT_SETTINGS;var r,i;return(Array.isArray(t)||am(t))&&n[Ox]===e?Array.isArray(t)?t:null!==(r=t[e])&&void 0!==r?r:n[e]:am(t)&&null!==(i=t[e])&&void 0!==i?i:n[e]}addHook(e,t,n){Ax(_x,this)[e]=Ax(_x,this)[e]||[];const r=Ax(_x,this)[e];this.hot.addHook(e,t,n),r.push(t),Ax(_x,this)[e]=r}removeHooks(e){Vd(Ax(_x,this)[e]||[],(t=>{this.hot.removeHook(e,t)}))}clearHooks(){const e=Ax(_x,this);hm(e,((e,t)=>this.removeHooks(t))),e.length=0}callOnPluginsReady(e){this.isPluginsReady?e():this.pluginsInitializedCallbacks.push(e)}onAfterPluginsInitialized(){Vd(this.pluginsInitializedCallbacks,(e=>e())),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}onUpdateSettings(e){const t=Mx(Lx,this,kx).call(this,e);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&t&&this.updatePlugin(e))}updatePlugin(){}destroy(){var e;null===(e=this.eventManager)||void 0===e||e.destroy(),this.clearHooks(),hm(this,((e,t)=>{"hot"!==t&&(this[t]=null)})),delete this.t,delete this.hot}}function kx(e){if(!e)return!1;const t=this.constructor.SETTING_KEYS;if("boolean"==typeof t)return t;for(let n=0;n<t.length;n++)if(void 0!==e[t[n]])return!0;return!1}function Fx(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const Dx=class{constructor(e){Fx(this,"hot",null),Fx(this,"container",null),Fx(this,"injected",!1),Fx(this,"rows",[]),Fx(this,"columns",[]),Fx(this,"samples",null),Fx(this,"settings",{useHeaders:!0}),this.hot=e}addRow(e,t){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));const n={row:e};this.rows.push(n),this.samples=t,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol(e)),this.table.tr.appendChild(this.createRow(e)),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}addColumnHeadersRow(e){const t=this.hot.getColHeader(0);if(null!=t){const t={row:-1};this.rows.push(t),this.container=this.createContainer(this.hot.rootElement.className),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),t.table=this.table.table}}addColumn(e,t){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));const n={col:e};this.columns.push(n),this.samples=t,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&null!==this.hot.getColHeader(e)&&this.hot.view.appendColHeader(e,this.table.th,void 0,-1),this.table.tBody.appendChild(this.createCol(e)),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}getHeights(e){this.injected||this.injectTable(),Vd(this.rows,(t=>{const{height:n}=t.table.getBoundingClientRect();e(t.row,Math.ceil(n))}))}getWidths(e){this.injected||this.injectTable(),Vd(this.columns,(t=>{const{width:n}=t.table.getBoundingClientRect();e(t.col,Math.ceil(n))}))}setSettings(e){this.settings=e}setSetting(e,t){this.settings||(this.settings={}),this.settings[e]=t}getSettings(){return this.settings}getSetting(e){return this.settings?this.settings[e]:null}createColGroupsCol(e){const t=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&t.appendChild(this.createColElement(-1,-1)),this.samples.forEach((n=>{Vd(n.strings,(n=>{t.appendChild(this.createColElement(n.col,e))}))})),t}createRow(e){const{rootDocument:t}=this.hot,n=t.createDocumentFragment(),r=t.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(e,r),n.appendChild(r)),this.samples.forEach((r=>{Vd(r.strings,(r=>{const i=r.col,o=this.hot.getCellMeta(e,i),s=this.hot.getCellRenderer(o),a=t.createElement("td");a.setAttribute("ghost-table",1),s(this.hot,a,e,i,this.hot.colToProp(i),r.value,o),n.appendChild(a)}))})),n}appendColumnHeadersRow(){const{rootDocument:e}=this.hot,t=e.createDocumentFragment(),n=[];if(this.hot.hasRowHeaders()){const r=e.createElement("th");n.push([-1,r]),t.appendChild(r)}this.samples.forEach((r=>{Vd(r.strings,(r=>{const i=r.col,o=e.createElement("th");n.push([i,o]),t.appendChild(o)}))})),this.table.tHead.appendChild(t),Vd(n,(e=>{const[t,n]=e;this.hot.view.appendColHeader(t,n)}))}createCol(e){const{rootDocument:t}=this.hot,n=t.createDocumentFragment();return this.samples.forEach((r=>{Vd(r.strings,(r=>{const i=r.row,o=this.hot.getCellMeta(i,e),s=this.hot.getCellRenderer(o),a=t.createElement("td"),l=t.createElement("tr");a.setAttribute("ghost-table",1),s(this.hot,a,i,e,this.hot.colToProp(e),r.value,o),l.appendChild(a),n.appendChild(l)}))})),n}clean(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}injectTable(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.injected||((e||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}removeTable(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}createColElement(e,t){const n=this.hot.rootDocument.createElement("col");let r=0;t>=0&&e>=0&&(r=this.hot.getCellMeta(t,e).colspan);let i=this.hot.getColWidth(e);if(r>1)for(let o=e+1;o<e+r;o++)i+=this.hot.getColWidth(o);return n.style.width=`${i}px`,n}createTable(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";const{rootDocument:t}=this.hot,n=t.createDocumentFragment(),r=t.createElement("table"),i=t.createElement("thead"),o=t.createElement("tbody"),s=t.createElement("colgroup"),a=t.createElement("tr"),l=t.createElement("th");return this.isVertical()&&r.appendChild(s),this.isHorizontal()&&(a.appendChild(l),i.appendChild(a),r.style.tableLayout="auto",r.style.width="auto"),r.appendChild(i),this.isVertical()&&o.appendChild(a),r.appendChild(o),Fp(r,e),n.appendChild(r),{fragment:n,table:r,tHead:i,tBody:o,colGroup:s,tr:a,th:l}}createContainer(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";const{rootDocument:t}=this.hot,n=t.createDocumentFragment(),r=t.createElement("div");return Fp(r,`htGhostTable htAutoSize ${e.trim()}`),n.appendChild(r),{fragment:n,container:r}}isVertical(){return!(!this.rows.length||this.columns.length)}isHorizontal(){return!(!this.columns.length||this.rows.length)}};function Vx(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Ux{static get SAMPLE_COUNT(){return 3}constructor(e){Vx(this,"samples",null),Vx(this,"dataFactory",null),Vx(this,"customSampleCount",null),Vx(this,"allowDuplicates",!1),this.dataFactory=e}getSampleCount(){return this.customSampleCount?this.customSampleCount:Ux.SAMPLE_COUNT}setSampleCount(e){this.customSampleCount=e}setAllowDuplicates(e){this.allowDuplicates=e}generateRowSamples(e,t){return this.generateSamples("row",t,e)}generateColumnSamples(e,t){return this.generateSamples("col",t,e)}generateSamples(e,t,n){const r=new Map,{from:i,to:o}="number"==typeof n?{from:n,to:n}:n;return Jw(i,o,(n=>{const i=this.generateSample(e,t,n);r.set(n,i)})),r}generateSample(e,t,n){if("row"!==e&&"col"!==e)throw new Error("Unsupported sample type");const r=new Map,i="row"===e?"col":"row",o=[];return Jw(t.from,t.to,(t=>{const s="row"===e?this.dataFactory(n,t):this.dataFactory(t,n);if(!1===s)return;const{value:a,bundleSeed:l}=s,h="string"==typeof l&&l.length>0;let u;u=h?l:am(a)?`${Object.keys(a).length}`:Array.isArray(a)?`${a.length}`:`${jd(a).length}`,r.has(u)||r.set(u,{needed:this.getSampleCount(),strings:[]});const c=r.get(u);if(c.needed){(!(o.indexOf(a)>-1)||this.allowDuplicates||h)&&(c.strings.push({value:a,[i]:t}),o.push(a),c.needed-=1)}})),r}}const Bx=Ux;function Wx(e,t,n){jx(e,t),t.set(e,n)}function jx(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Gx(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function zx(e,t){return e.get(Yx(e,t))}function $x(e,t,n){return e.set(Yx(e,t),n),n}function Yx(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}Rf.getSingleton().register("modifyAutoColumnSizeSeed");const Kx="autoColumnSize";var Xx=new WeakMap,qx=new WeakMap,Qx=new WeakSet;class Zx extends Hx{static get PLUGIN_KEY(){return Kx}static get PLUGIN_PRIORITY(){return 10}static get SETTING_KEYS(){return!0}static get DEFAULT_SETTINGS(){return{useHeaders:!0,samplingRatio:null,allowSampleDuplicates:!1}}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 50}constructor(e){var t,n;super(e),jx(t=this,n=Qx),n.add(t),Gx(this,"ghostTable",new Dx(this.hot)),Gx(this,"samplesGenerator",new Bx(((e,t)=>{const n=this.hot.toPhysicalRow(e),r=this.hot.toPhysicalColumn(t);if(this.hot.rowIndexMapper.isHidden(n)||this.hot.columnIndexMapper.isHidden(r))return!1;const i=this.hot.getCellMeta(e,t);let o="";i.spanned||(o=this.hot.getDataAtCell(e,t));let s="";return this.hot.hasHook("modifyAutoColumnSizeSeed")&&(s=this.hot.runHooks("modifyAutoColumnSizeSeed",s,i,o)),{value:o,bundleSeed:s}}))),Gx(this,"inProgress",!1),Gx(this,"measuredColumns",0),Gx(this,"columnWidthsMap",new kE),Wx(this,Xx,[]),Wx(this,qx,[]),this.hot.columnIndexMapper.registerMap("autoColumnSize",this.columnWidthsMap),this.addHook("beforeColumnResize",((e,t,n)=>Yx(Qx,this,rP).call(this,e,t,n)))}isEnabled(){return!1!==this.hot.getSettings()[Kx]&&!this.hot.getSettings().colWidths}enablePlugin(){var e=this;if(this.enabled)return;this.ghostTable.setSetting("useHeaders",this.getSetting("useHeaders")),this.samplesGenerator.setAllowDuplicates(this.getSetting("allowSampleDuplicates"));const t=this.getSetting("samplingRatio");t&&!isNaN(t)&&this.samplesGenerator.setSampleCount(parseInt(t,10)),this.addHook("afterLoadData",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return Yx(Qx,e,tP).call(e,...n)})),this.addHook("beforeChangeRender",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return Yx(Qx,e,nP).call(e,...n)})),this.addHook("afterFormulasValuesUpdate",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return Yx(Qx,e,oP).call(e,...n)})),this.addHook("beforeRender",(()=>Yx(Qx,this,eP).call(this))),this.addHook("modifyColWidth",((e,t)=>this.getColumnWidth(t,e))),this.addHook("init",(()=>Yx(Qx,this,iP).call(this))),super.enablePlugin()}updatePlugin(){$x(qx,this,this.findColumnsWhereHeaderWasChanged()),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.addHook("beforeColumnResize",((e,t,n)=>Yx(Qx,this,rP).call(this,e,t,n)))}calculateVisibleColumnsWidth(){if(!this.hot.countRows())return;const e=this.getFirstVisibleColumn(),t=this.getLastVisibleColumn();if(-1===e||-1===t)return;const n=this.hot.renderCall;this.calculateColumnsWidth({from:e,to:t},void 0,n)}calculateColumnsWidth(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countCols()-1},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{from:0,to:this.hot.countRows()-1},n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r="number"==typeof e?{from:e,to:e}:e,i="number"==typeof t?{from:t,to:t}:t;Jw(r.from,r.to,(e=>{let t=this.hot.toPhysicalColumn(e);if(null===t&&(t=e),n||null===this.columnWidthsMap.getValueAtIndex(t)&&!this.hot._getColWidthFromSettings(t)){this.samplesGenerator.generateColumnSamples(e,i).forEach(((e,t)=>this.ghostTable.addColumn(t,e)))}})),this.ghostTable.columns.length&&(this.hot.batchExecution((()=>{this.ghostTable.getWidths(((e,t)=>{const n=this.hot.toPhysicalColumn(e);this.columnWidthsMap.setValueAtIndex(n,t)}))}),!0),this.measuredColumns=r.to+1,this.ghostTable.clean())}calculateAllColumnsWidth(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countRows()-1},t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=0;const r=this.hot.countCols()-1;let i=null;this.inProgress=!0;const o=()=>{if(!this.hot)return mm(i),void(this.inProgress=!1);this.calculateColumnsWidth({from:n,to:Math.min(n+Zx.CALCULATION_STEP,r)},e,t),n=n+Zx.CALCULATION_STEP+1,n<r?i=gm(o):(mm(i),this.inProgress=!1,this.hot.view.adjustElementsSize())},s=this.getSyncCalculationLimit();s>=0&&(this.calculateColumnsWidth({from:0,to:s},e,t),n=s+1),n<r?o():this.inProgress=!1}recalculateAllColumnsWidth(){this.hot.view.isVisible()&&this.calculateAllColumnsWidth({from:0,to:this.hot.countRows()-1},!0)}getSyncCalculationLimit(){const e=this.hot.getSettings()[Kx];let t=Zx.SYNC_CALCULATION_LIMIT;const n=this.hot.countCols()-1;return am(e)&&(t=e.syncLimit,ap(t)?t=ty(n,t):t>>=0),Math.min(t,n)}getColumnWidth(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=t;return void 0===r&&(r=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e)),n&&"number"==typeof r&&(r=Math.max(r,ov))),r}getFirstVisibleColumn(){var e;return null!==(e=this.hot.getFirstRenderedVisibleColumn())&&void 0!==e?e:-1}getLastVisibleColumn(){var e;return null!==(e=this.hot.getLastRenderedVisibleColumn())&&void 0!==e?e:-1}findColumnsWhereHeaderWasChanged(){return this.hot.getColHeader().reduce(((e,t,n)=>{const r=zx(Xx,this).length;return(r-1<n||zx(Xx,this)[n]!==t)&&e.push(this.hot.toVisualColumn(n)),r-1<n?zx(Xx,this).push(t):zx(Xx,this)[n]=t,e}),[])}clearCache(e){Array.isArray(e)?this.hot.batchExecution((()=>{e.forEach((e=>{this.columnWidthsMap.setValueAtIndex(e,null)}))}),!0):this.columnWidthsMap.clear()}isNeedRecalculate(){return!!this.columnWidthsMap.getValues().slice(0,this.measuredColumns).filter((e=>null===e)).length}destroy(){this.ghostTable.clean(),super.destroy()}}function Jx(e){const t={from:0,to:this.hot.countRows()-1};e.forEach((e=>{const n=this.hot.toPhysicalColumn(e);if(null!==n&&!this.hot._getColWidthFromSettings(n)){this.samplesGenerator.generateColumnSamples(e,t).forEach(((e,t)=>this.ghostTable.addColumn(t,e)))}})),this.ghostTable.columns.length&&(this.hot.batchExecution((()=>{this.ghostTable.getWidths(((e,t)=>{const n=this.hot.toPhysicalColumn(e);this.columnWidthsMap.setValueAtIndex(n,t)}))}),!0),this.ghostTable.clean())}function eP(){this.calculateVisibleColumnsWidth(),this.inProgress||(Yx(Qx,this,Jx).call(this,zx(qx,this)),$x(qx,this,[]))}function tP(e,t){t||this.recalculateAllColumnsWidth()}function nP(e){const t=e.reduce(((e,t)=>{let[,n]=t;const r=this.hot.propToCol(n);return Number.isInteger(r)&&-1===e.indexOf(r)&&e.push(r),e}),[]);zx(qx,this).push(...t)}function rP(e,t,n){let r=e;return n&&(this.calculateColumnsWidth(t,void 0,!0),r=this.getColumnWidth(t,void 0,!1)),r}function iP(){$x(Xx,this,this.hot.getColHeader()),this.recalculateAllColumnsWidth()}function oP(e){const t=e.reduce(((e,t)=>{var n;const r=null===(n=t.address)||void 0===n?void 0:n.col;if(Number.isInteger(r)){const t=this.hot.toVisualColumn(r);-1===e.indexOf(t)&&e.push(t)}return e}),[]);zx(qx,this).push(...t)}const sP={horizontal:"horizontal",vertical:"vertical"};function aP(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function lP(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function hP(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}Rf.getSingleton().register("modifyAutofillRange"),Rf.getSingleton().register("beforeAutofill"),Rf.getSingleton().register("afterAutofill");const uP="autofill",cP=["fillHandle"];var dP=new WeakSet;class pP extends Hx{constructor(){super(...arguments),aP(this,dP),lP(this,"addingStarted",!1),lP(this,"mouseDownOnCellCorner",!1),lP(this,"mouseDragOutside",!1),lP(this,"handleDraggedCells",0),lP(this,"directions",[]),lP(this,"autoInsertRow",!1)}static get PLUGIN_KEY(){return uP}static get PLUGIN_PRIORITY(){return 20}static get SETTING_KEYS(){return[uP,...cP]}isEnabled(){return this.hot.getSettings().fillHandle}enablePlugin(){this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",(e=>hP(dP,this,mP).call(this,e))),this.addHook("afterOnCellCornerDblClick",(e=>hP(dP,this,gP).call(this,e))),this.addHook("beforeOnCellMouseOver",((e,t)=>hP(dP,this,fP).call(this,t))),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.clearMappedSettings(),super.disablePlugin()}getSelectionData(){const e=this.hot.getSelectedRangeLast(),{row:t,col:n}=e.getTopStartCorner(),{row:r,col:i}=e.getBottomEndCorner(),o=this.hot.runHooks("modifyCopyableRange",[{startRow:t,startCol:n,endRow:r,endCol:i}]),s=[],a=[],l=[];return Vd(o,(e=>{for(let t=e.startRow;t<=e.endRow;t+=1)-1===s.indexOf(t)&&s.push(t);for(let t=e.startCol;t<=e.endCol;t+=1)-1===a.indexOf(t)&&a.push(t)})),Vd(s,(e=>{const t=[];Vd(a,(n=>{t.push(this.hot.getCopyableData(e,n))})),l.push(t)})),l}fillIn(){if(this.hot.selection.highlight.getFill().isEmpty())return!1;const[e,t,n,r]=this.hot.selection.highlight.getFill().getVisualCorners(),i=this.hot.getSelectedRangeLast(),o=i.getTopStartCorner(),s=i.getBottomEndCorner();this.resetSelectionOfDraggedArea();const a=[o.row,o.col,s.row,s.col],l=this.hot.runHooks("modifyAutofillRange",[Math.min(o.row,e),Math.min(o.col,t),Math.max(s.row,n),Math.max(s.col,r)],a),{directionOfDrag:h,startOfDragCoords:u,endOfDragCoords:c}=function(e,t,n){let r,i,o;return t[0]===e[0]&&t[1]<e[1]?(o="left",r=n(t[0],t[1]),i=n(t[2],e[1]-1)):t[2]===e[2]&&t[0]===e[0]&&t[3]>e[3]?(o="right",r=n(t[0],e[3]+1),i=n(t[2],t[3])):t[0]<e[0]&&t[1]===e[1]?(o="up",r=n(t[0],t[1]),i=n(e[0]-1,t[3])):t[2]>e[2]&&t[1]===e[1]&&(o="down",r=n(e[2]+1,t[1]),i=n(t[2],t[3])),r&&r.normalize(),i&&i.normalize(),{directionOfDrag:o,startOfDragCoords:r,endOfDragCoords:i}}(a,l,((e,t)=>this.hot._createCellCoords(e,t)));if(u&&u.row>-1&&u.col>-1){const e=this.getSelectionData(),t=i.clone(),n=this.hot._createCellRange(u,u,c),r=this.hot.runHooks("beforeAutofill",e,t,n,h);if(!1===r)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;let o=r;const s=r;if(["up","left"].indexOf(h)>-1&&(1!==s.length||0!==s[0].length))if(o=[],"up"===h){const e=c.row-u.row+1,t=e%s.length;for(let n=0;n<e;n++)o.push(s[(n+(s.length-t))%s.length])}else{const e=c.col-u.col+1,t=e%s[0].length;for(let n=0;n<s.length;n++){o.push([]);for(let r=0;r<e;r++)o[n].push(s[n][(r+(s[n].length-t))%s[n].length])}}this.hot.populateFromArray(u.row,u.col,o,c.row,c.col,`${this.pluginName}.fill`,null),this.setSelection(l),this.hot.runHooks("afterAutofill",o,t,n,h),this.hot.render()}else this.hot.view.render();return!0}reduceSelectionAreaIfNeeded(e){return e.row<0&&(e.row=0),e.col<0&&(e.col=0),e}getCoordsOfDragAndDropBorders(e){const t=this.hot.getSelectedRangeLast(),n=t.getBottomEndCorner();let r=e;if(this.directions.includes(sP.vertical)&&this.directions.includes(sP.horizontal)){const i=t.getTopStartCorner();(n.col<=e.col||i.col>=e.col)&&(r=this.hot._createCellCoords(n.row,e.col)),(n.row<e.row||i.row>e.row)&&(r=this.hot._createCellCoords(e.row,n.col))}else if(this.directions.includes(sP.vertical))r=this.hot._createCellCoords(e.row,n.col);else{if(!this.directions.includes(sP.horizontal))return;r=this.hot._createCellCoords(n.row,e.col)}return this.reduceSelectionAreaIfNeeded(r)}showBorder(e){const t=this.getCoordsOfDragAndDropBorders(e);t&&this.redrawBorders(t)}addRow(){this.hot._registerTimeout((()=>{this.hot.alter("insert_row_below",void 0,1,`${this.pluginName}.fill`),this.addingStarted=!1}),200)}addNewRowIfNeeded(){if(!this.hot.selection.highlight.getFill().isEmpty()&&!1===this.addingStarted&&this.autoInsertRow){const e=this.hot.getSelectedLast(),t=this.hot.selection.highlight.getFill().getVisualCorners(),n=this.hot.countRows();e[2]<n-1&&t[2]===n-1&&(this.addingStarted=!0,this.addRow())}}getIndexOfLastAdjacentFilledInRow(e){const t=this.hot.getData(),n=this.hot.countRows();let r;for(let i=e[2]+1;i<n;i++){for(let r=e[1];r<=e[3];r++){if(!$d(t[i][r]))return-1}const n=t[i][e[1]-1],o=t[i][e[3]+1];$d(n)&&$d(o)||(r=i)}return r}addSelectionFromStartAreaToSpecificRowIndex(e,t){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(e[0],e[1])).add(this.hot._createCellCoords(t,e[3])).commit()}setSelection(e){this.hot.selectCell(...Dd(e,(e=>Math.max(e,0))),!1,!1)}selectAdjacent(){const e=this.hot.getSelectedLast(),t=this.getIndexOfLastAdjacentFilledInRow(e);return-1!==t&&void 0!==t&&(this.addSelectionFromStartAreaToSpecificRowIndex(e,t),!0)}resetSelectionOfDraggedArea(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}redrawBorders(e){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(e).commit(),this.hot.view.render()}getIfMouseWasDraggedOutside(e){const{documentElement:t}=this.hot.rootDocument,n=Yp(this.hot.table).top-(this.hot.rootWindow.pageYOffset||t.scrollTop)+ng(this.hot.table),r=Yp(this.hot.table).left-(this.hot.rootWindow.pageXOffset||t.scrollLeft)+tg(this.hot.table);return e.clientY>n&&e.clientX<=r}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mouseup",(()=>hP(dP,this,wP).call(this))),this.eventManager.addEventListener(e,"mousemove",(e=>hP(dP,this,yP).call(this,e)))}clearMappedSettings(){this.directions.length=0,this.autoInsertRow=!1}mapSettings(){const e=function(e){const t={};return!0===e?(t.directions=Object.keys(sP),t.autoInsertRow=!0):am(e)?(Gd(e.autoInsertRow)?e.direction===sP.horizontal?t.autoInsertRow=!1:t.autoInsertRow=e.autoInsertRow:t.autoInsertRow=!1,Gd(e.direction)?t.directions=[e.direction]:t.directions=Object.keys(sP)):"string"==typeof e?(t.directions=[e],t.autoInsertRow=!0):(t.directions=[],t.autoInsertRow=!1),t}(this.hot.getSettings().fillHandle);this.directions=e.directions,this.autoInsertRow=e.autoInsertRow}destroy(){super.destroy()}}function gP(){this.selectAdjacent()&&this.fillIn()}function mP(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}function fP(e){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(e),this.addNewRowIfNeeded())}function wP(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}function yP(e){const t=this.getIfMouseWasDraggedOutside(e);!1===this.addingStarted&&this.handleDraggedCells>0&&t?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}function vP(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function CP(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function SP(e,t){return e.get(RP(e,t))}function RP(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}const EP="autoRowSize";var bP=new WeakMap,TP=new WeakSet;class NP extends Hx{static get PLUGIN_KEY(){return EP}static get PLUGIN_PRIORITY(){return 40}static get SETTING_KEYS(){return!0}static get DEFAULT_SETTINGS(){return{useHeaders:!0,samplingRatio:null,allowSampleDuplicates:!1}}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 500}constructor(e){var t,n;super(e),vP(t=this,n=TP),n.add(t),CP(this,"headerHeight",null),CP(this,"ghostTable",new Dx(this.hot)),CP(this,"samplesGenerator",new Bx(((e,t)=>{const n=this.hot.toPhysicalRow(e),r=this.hot.toPhysicalColumn(t);if(this.hot.rowIndexMapper.isHidden(n)||this.hot.columnIndexMapper.isHidden(r))return!1;if(e>=0&&t>=0){if(this.hot.getCellMeta(e,t).hidden)return!1}let i;return e>=0?i=this.hot.getDataAtCell(e,t):-1===e&&(i=this.hot.getColHeader(t)),{value:i}}))),CP(this,"inProgress",!1),CP(this,"measuredRows",0),CP(this,"rowHeightsMap",new kE),function(e,t,n){vP(e,t),t.set(e,n)}(this,bP,[]),this.hot.rowIndexMapper.registerMap("autoRowSize",this.rowHeightsMap),this.addHook("beforeRowResize",((e,t,n)=>RP(TP,this,IP).call(this,e,t,n)))}isEnabled(){const e=this.hot.getSettings()[EP];return!0===e||am(e)}enablePlugin(){var e=this;if(this.enabled)return;this.samplesGenerator.setAllowDuplicates(this.getSetting("allowSampleDuplicates"));const t=this.getSetting("samplingRatio");t&&!isNaN(t)&&this.samplesGenerator.setSampleCount(parseInt(t,10)),this.addHook("afterLoadData",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return RP(TP,e,OP).call(e,...n)})),this.addHook("beforeChangeRender",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return RP(TP,e,xP).call(e,...n)})),this.addHook("beforeColumnResize",(()=>this.recalculateAllRowsHeight())),this.addHook("afterFormulasValuesUpdate",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return RP(TP,e,_P).call(e,...n)})),this.addHook("beforeRender",(()=>RP(TP,this,MP).call(this))),this.addHook("modifyRowHeight",((e,t)=>this.getRowHeight(t,e))),this.addHook("init",(()=>RP(TP,this,PP).call(this))),this.addHook("modifyColumnHeaderHeight",(()=>this.getColumnHeaderHeight())),super.enablePlugin()}disablePlugin(){this.headerHeight=null,super.disablePlugin(),this.addHook("beforeRowResize",((e,t,n)=>RP(TP,this,IP).call(this,e,t,n)))}calculateVisibleRowsHeight(){if(!this.hot.countCols())return;const e=this.getFirstVisibleRow(),t=this.getLastVisibleRow();if(-1===e||-1===t)return;const n=this.hot.renderCall;this.calculateRowsHeight({from:e,to:t},void 0,n)}calculateRowsHeight(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countRows()-1},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{from:0,to:this.hot.countCols()-1},n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r="number"==typeof e?{from:e,to:e}:e,i="number"==typeof t?{from:t,to:t}:t;if(null!==this.hot.getColHeader(0)){const e=this.samplesGenerator.generateRowSamples(-1,i);this.ghostTable.addColumnHeadersRow(e.get(-1))}Jw(r.from,r.to,(e=>{let t=this.hot.toPhysicalRow(e);if(null===t&&(t=e),n||null===this.rowHeightsMap.getValueAtIndex(t)){this.samplesGenerator.generateRowSamples(e,i).forEach(((e,t)=>this.ghostTable.addRow(t,e)))}})),this.ghostTable.rows.length&&(this.hot.batchExecution((()=>{this.ghostTable.getHeights(((e,t)=>{e<0?this.headerHeight=t:this.rowHeightsMap.setValueAtIndex(this.hot.toPhysicalRow(e),t)}))}),!0),this.measuredRows=r.to+1,this.ghostTable.clean())}calculateAllRowsHeight(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countCols()-1},t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=0;const r=this.hot.countRows()-1;let i=null;this.inProgress=!0;const o=()=>{if(!this.hot)return mm(i),void(this.inProgress=!1);this.calculateRowsHeight({from:n,to:Math.min(n+NP.CALCULATION_STEP,r)},e,t),n=n+NP.CALCULATION_STEP+1,n<r?i=gm(o):(mm(i),this.inProgress=!1,this.hot.view.adjustElementsSize(),this.hot.view._wt.wtOverlays.inlineStartOverlay.needFullRender&&this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.draw())},s=this.getSyncCalculationLimit();s>=0&&(this.calculateRowsHeight({from:0,to:s},e,t),n=s+1),n<r?o():(this.inProgress=!1,this.hot.view.adjustElementsSize())}recalculateAllRowsHeight(){this.hot.view.isVisible()&&this.calculateAllRowsHeight({from:0,to:this.hot.countCols()-1},!0)}getSyncCalculationLimit(){const e=this.hot.getSettings()[EP];let t=NP.SYNC_CALCULATION_LIMIT;const n=this.hot.countRows()-1;return am(e)&&(t=e.syncLimit,ap(t)?t=ty(n,t):t>>=0),Math.min(t,n)}getRowHeight(e,t){const n=e<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(e));let r=t;return null!==n&&n>(t||0)&&(r=n),r}getColumnHeaderHeight(){return this.headerHeight}getFirstVisibleRow(){var e;return null!==(e=this.hot.getFirstRenderedVisibleRow())&&void 0!==e?e:-1}getLastVisibleRow(){var e;return null!==(e=this.hot.getLastRenderedVisibleRow())&&void 0!==e?e:-1}clearCache(e){this.headerHeight=null,Array.isArray(e)?this.hot.batchExecution((()=>{e.forEach((e=>{this.rowHeightsMap.setValueAtIndex(e,null)}))}),!0):this.rowHeightsMap.clear()}clearCacheByRange(e){const{from:t,to:n}="number"==typeof e?{from:e,to:e}:e;this.hot.batchExecution((()=>{Jw(Math.min(t,n),Math.max(t,n),(e=>{this.rowHeightsMap.setValueAtIndex(e,null)}))}),!0)}isNeedRecalculate(){return!!this.rowHeightsMap.getValues().slice(0,this.measuredRows).filter((e=>null===e)).length}destroy(){this.ghostTable.clean(),super.destroy()}}function AP(e){const t={from:0,to:this.hot.countCols()-1};e.forEach((e=>{this.samplesGenerator.generateRowSamples(e,t).forEach(((e,t)=>this.ghostTable.addRow(t,e)))})),this.ghostTable.rows.length&&(this.hot.batchExecution((()=>{this.ghostTable.getHeights(((e,t)=>{const n=this.hot.toPhysicalRow(e);this.rowHeightsMap.setValueAtIndex(n,t)}))}),!0),this.ghostTable.clean())}function MP(){var e,t,n;this.calculateVisibleRowsHeight(),this.inProgress||(RP(TP,this,AP).call(this,SP(bP,this)),t=this,n=[],(e=bP).set(RP(e,t),n))}function IP(e,t,n){let r=e;return n&&(this.calculateRowsHeight(t,void 0,!0),r=this.getRowHeight(t)),r}function OP(e,t){t||this.recalculateAllRowsHeight()}function xP(e){const t=e.reduce(((e,t)=>{let[n]=t;return-1===e.indexOf(n)&&e.push(n),e}),[]);SP(bP,this).push(...t)}function PP(){this.recalculateAllRowsHeight()}function _P(e){const t=e.reduce(((e,t)=>{var n;const r=null===(n=t.address)||void 0===n?void 0:n.row;if(Number.isInteger(r)){const t=this.hot.toVisualRow(r);-1===e.indexOf(t)&&e.push(t)}return e}),[]);SP(bP,this).push(...t)}const{getListWithInsertedItems:LP,getListWithRemovedItems:HP}=$E("physicallyIndexed");const kP=class extends _E{constructor(){super((e=>e))}insert(e,t){const n=BE(this.indexedValues,t);this.indexedValues=LP(n,e,t,this.initValueOrFn),super.insert(e,t)}remove(e){const t=HP(this.indexedValues,e);this.indexedValues=UE(t,e),super.remove(e)}},{getListWithInsertedItems:FP,getListWithRemovedItems:DP}=$E("physicallyIndexed");const VP=class extends _E{constructor(){super((e=>e))}insert(e,t){this.indexedValues=FP(this.indexedValues,e,t,((e,t)=>this.getNextValue(t))),super.insert(e,t)}remove(e){this.indexedValues=DP(this.indexedValues,e),super.remove(e)}getNextValue(e){return Math.max(...this.getValues())+1+e}};function UP(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function BP(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const WP="bindRowsWithHeaders",jP=new Map([["loose",kP],["strict",VP]]);var GP=new WeakSet;class zP extends Hx{constructor(){super(...arguments),UP(this,GP),BP(this,"headerIndexes",null)}static get PLUGIN_KEY(){return WP}static get PLUGIN_PRIORITY(){return 210}isEnabled(){return!!this.hot.getSettings()[WP]}enablePlugin(){var e;if(this.enabled)return;const t=null!==(e=jP.get(this.getSetting()))&&void 0!==e?e:jP.get("loose");this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new t),this.addHook("modifyRowHeader",(e=>function(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}(GP,this,$P).call(this,e))),super.enablePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),super.disablePlugin()}destroy(){super.destroy()}}function $P(e){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(e))}function YP(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function KP(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function XP(e,t){return e.get(QP(e,t))}function qP(e,t,n){return e.set(QP(e,t),n),n}function QP(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}const ZP="collapsibleColumns",JP=["nestedHeaders"],e_="collapsibleIndicator",t_=ZP,n_=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]);var r_=new WeakMap,i_=new WeakSet;class o_ extends Hx{constructor(){var e,t;super(...arguments),YP(e=this,t=i_),t.add(e),KP(this,"nestedHeadersPlugin",null),KP(this,"headerStateManager",null),function(e,t,n){YP(e,t),t.set(e,n)}(this,r_,null)}static get PLUGIN_KEY(){return ZP}static get PLUGIN_PRIORITY(){return 290}static get PLUGIN_DEPS(){return["plugin:NestedHeaders"]}static get SETTING_KEYS(){return[ZP,...JP]}isEnabled(){return!!this.hot.getSettings()[ZP]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:t}=this.hot.getSettings();t||Fm("You need to configure the Nested Headers plugin in order to use collapsible headers."),qP(r_,this,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",(()=>QP(i_,this,l_).call(this))),this.addHook("afterLoadData",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return QP(i_,e,h_).call(e,...n)})),this.addHook("afterGetColHeader",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return QP(i_,e,s_).call(e,...n)})),this.addHook("beforeOnCellMouseDown",((e,t,n)=>QP(i_,this,a_).call(this,e,t,n))),this.registerShortcuts(),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){const{collapsibleColumns:e}=this.hot.getSettings();"boolean"==typeof e?this.headerStateManager.mapState((e=>({collapsible:e.origColspan>1}))):Array.isArray(e)&&(this.headerStateManager.mapState((()=>({collapsible:!1}))),this.headerStateManager.mergeStateWith(e))}super.updatePlugin()}}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),qP(r_,this,null),this.nestedHeadersPlugin=null,this.unregisterShortcuts(),this.clearButtons(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{var e;const{row:t,col:n}=this.hot.getSelectedRangeLast().highlight,{collapsible:r,isCollapsed:i,columnIndex:o}=null!==(e=this.headerStateManager.getHeaderTreeNodeData(t,n))&&void 0!==e?e:{};if(r)return i?this.expandSection({row:t,col:o}):this.collapseSection({row:t,col:o}),!1},runOnlyIf:()=>{var e,t;return(null===(e=this.hot.getSelectedRangeLast())||void 0===e?void 0:e.isSingle())&&(null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight.isHeader())},group:t_,relativeToGroup:qA,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(t_)}clearButtons(){if(!this.hot.view)return;const e=this.hot.view._wt.getSetting("columnHeaders").length,t=this.hot.view._wt.wtTable.THEAD,n=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,r=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,i=function(e){e&&e.parentNode.removeChild(e)};Jw(0,e-1,(e=>{const o=t.childNodes[e],s=n.childNodes[e],a=r?r.childNodes[e]:null;Jw(0,o.childNodes.length-1,(e=>{let t=o.childNodes[e].querySelector(`.${e_}`);i(t),s&&s.childNodes[e]&&(t=s.childNodes[e].querySelector(`.${e_}`),i(t)),r&&a&&a.childNodes[e]&&(t=a.childNodes[e].querySelector(`.${e_}`),i(t))}))}))}expandSection(e){this.toggleCollapsibleSection([e],"expand")}collapseSection(e){this.toggleCollapsibleSection([e],"collapse")}toggleAllCollapsibleSections(e){const t=this.headerStateManager.mapNodes((t=>{const{collapsible:n,origColspan:r,headerLevel:i,columnIndex:o,isCollapsed:s}=t;if(!0===n&&r>1&&(s&&"expand"===e||!s&&"collapse"===e))return{row:this.headerStateManager.levelToRowCoords(i),col:o}}));this.toggleCollapsibleSection(t,e)}collapseAll(){this.toggleAllCollapsibleSections("collapse")}expandAll(){this.toggleAllCollapsibleSections("expand")}toggleCollapsibleSection(e,t){if(!n_.has(t))throw new Error(`Unsupported action is passed (${t}).`);if(!Array.isArray(e))return;const n=Fd(e,(e=>{let{row:t}=e;return t<0}));let r=n.length>0;Vd(n,(e=>{var n;let{row:i,col:o}=e;const{collapsible:s,isCollapsed:a}=null!==(n=this.headerStateManager.getHeaderSettings(i,o))&&void 0!==n?n:{};if(!s||a&&"collapse"===t||!a&&"expand"===t)return r=!1,!1}));const i=[],o=[];r&&Vd(n,(e=>{let{row:n,col:r}=e;const{colspanCompensation:s,affectedColumns:a,rollbackModification:l}=this.headerStateManager.triggerNodeModification(t,n,r);s>0&&(o.push(...a),i.push(l))}));const s=this.getCollapsedColumns();let a=[];"collapse"===t?a=function(e){const t=[];return Vd(e,(e=>{-1===t.indexOf(e)&&t.push(e)})),t}([...s,...o]):"expand"===t&&(a=Fd(s,(e=>!o.includes(e))));const l=n_.get(t);if(!1===this.hot.runHooks(l.beforeHook,s,a,r))return void Vd(i,(e=>{e()}));this.hot.batchExecution((()=>{Vd(o,(e=>{XP(r_,this).setValueAtIndex(this.hot.toPhysicalColumn(e),l.hideColumn)}))}),!0);const h=this.getCollapsedColumns().length!==s.length,u=this.hot.getSelectedRangeLast();if("collapse"===t&&h&&u){const{row:e,col:t}=u.highlight;if((this.hot.rowIndexMapper.isHidden(e)||this.hot.columnIndexMapper.isHidden(t))&&o.includes(t)){const n=e>=0?this.hot.rowIndexMapper.getNearestNotHiddenIndex(e,1,!0):e,r=t>=0?this.hot.columnIndexMapper.getNearestNotHiddenIndex(t,1,!0):t;null!==n&&null!==r&&this.hot.selectCell(n,r)}}this.hot.runHooks(l.afterHook,s,a,r,h),this.hot.render(),this.hot.view.adjustElementsSize()}getCollapsedColumns(){return XP(r_,this).getHiddenIndexes()}destroy(){qP(r_,this,null),super.destroy()}}function s_(e,t,n){var r;const{collapsible:i,origColspan:o,isCollapsed:s}=null!==(r=this.headerStateManager.getHeaderSettings(n,e))&&void 0!==r?r:{},a=i&&o>1&&e>=this.hot.getSettings().fixedColumnsStart,l=this.hot.getSettings().ariaTags;let h=t.querySelector(`.${e_}`);var u;(Up(t,[Sp("")[0]]),a)?(h||(h=this.hot.rootDocument.createElement("div"),Fp(h,e_),t.querySelector("div:first-child").appendChild(h)),Dp(h,["collapsed","expanded"]),s?(Fp(h,"collapsed"),zp(h,"+"),l&&Vp(t,...Sp(!1))):(Fp(h,"expanded"),zp(h,"-"),l&&Vp(t,...Sp(!0))),l&&Vp(h,...mp())):null===(u=h)||void 0===u||u.remove()}function a_(e,t){kp(e.target,e_)&&(kp(e.target,"expanded")?(this.eventManager.fireEvent(e.target,"mouseup"),this.toggleCollapsibleSection([t],"collapse")):kp(e.target,"collapsed")&&(this.eventManager.fireEvent(e.target,"mouseup"),this.toggleCollapsibleSection([t],"expand")),_m(e))}function l_(){this.updatePlugin()}function h_(e,t){t||this.updatePlugin()}function u_(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const c_=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"];class d_{constructor(e,t){u_(this,"hot",void 0),u_(this,"sortingStates",new jE),u_(this,"sortEmptyCells",false),u_(this,"indicator",true),u_(this,"headerAction",true),u_(this,"compareFunctionFactory",void 0),u_(this,"mapName",void 0),this.hot=e,this.mapName=t,this.hot.columnIndexMapper.registerMap(t,this.sortingStates)}updateAllColumnsProperties(e){am(e)&&hm(e,((e,t)=>{c_.includes(t)&&(this[t]=e)}))}getAllColumnsProperties(){const e={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return"function"==typeof this.compareFunctionFactory&&(e.compareFunctionFactory=this.compareFunctionFactory),e}getSortOrderOfColumn(e){var t;return null===(t=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))||void 0===t?void 0:t.sortOrder}getIndexOfColumnInSortQueue(e){return e=this.hot.toPhysicalColumn(e),this.sortingStates.getEntries().findIndex((t=>{let[n]=t;return n===e}))}getNumberOfSortedColumns(){return this.sortingStates.getLength()}isListOfSortedColumnsEmpty(){return 0===this.getNumberOfSortedColumns()}isColumnSorted(e){return am(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))}getSortStates(){if(null===this.sortingStates)return[];return this.sortingStates.getEntries().map((e=>{let[t,n]=e;return{column:this.hot.toVisualColumn(t),...n}}))}getColumnSortState(e){const t=this.getSortOrderOfColumn(e);if(Gd(t))return{column:e,sortOrder:t}}setSortStates(e){this.sortingStates.clear();for(let t=0;t<e.length;t+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(e[t].column),{sortOrder:e[t].sortOrder})}destroy(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}function p_(e,t,n){const r=t.locale;return function(t,i){const{sortEmptyCells:o}=n;return"string"==typeof t&&(t=t.toLocaleLowerCase(r)),"string"==typeof i&&(i=i.toLocaleLowerCase(r)),t===i?S_:$d(t)?$d(i)?S_:o&&"asc"===e?R_:E_:$d(i)?o&&"asc"===e?E_:R_:isNaN(t)&&!isNaN(i)?"asc"===e?E_:R_:!isNaN(t)&&isNaN(i)?"asc"===e?R_:E_:(isNaN(t)||isNaN(i)||(t=parseFloat(t),i=parseFloat(i)),t<i?"asc"===e?R_:E_:t>i?"asc"===e?E_:R_:S_)}}const g_="default";const{register:m_,getItem:f_,hasItem:w_}=Tf("sorting.compareFunctionFactory"),{register:y_,getItem:v_}=Tf("sorting.mainSortComparator");function C_(e){return w_(e)?f_(e):f_(g_)}m_("checkbox",(function(e,t,n){const r=t.checkedTemplate,i=t.uncheckedTemplate,{sortEmptyCells:o}=n;return function(s,a){const l=$d(s),h=$d(a),u=l?i:s,c=h?i:a,d=u===i||u===r,p=c===i||c===r;if(!1===o){if(l&&!1===h)return E_;if(!1===l&&h)return R_}return!1===d&&p?"asc"===e?R_:E_:d&&!1===p?"asc"===e?E_:R_:!1===d&&!1===p?p_(e,t,n)(s,a):u===i&&c===r?"asc"===e?R_:E_:u===r&&c===i?"asc"===e?E_:R_:S_}})),m_("date",(function(e,t,n){return P_(e,t.dateFormat,n)})),m_(g_,p_),m_("numeric",(function(e,t,n){return function(t,r){const i=parseFloat(t),o=parseFloat(r),{sortEmptyCells:s}=n;if(i===o||isNaN(i)&&isNaN(o))return S_;if(s){if($d(t))return"asc"===e?R_:E_;if($d(r))return"asc"===e?E_:R_}return isNaN(i)?E_:isNaN(o)?R_:i<o?"asc"===e?R_:E_:i>o?"asc"===e?E_:R_:S_}})),m_("time",(function(e,t,n){return P_(e,t.timeFormat,n)}));const S_=0,R_=-1,E_=1;const b_="asc",T_="desc",N_="colHeader";function A_(e){if(e.some((e=>!1===function(e){if(!1===am(e))return!1;const{column:t,sortOrder:n}=e;return Number.isInteger(t)&&[b_,T_].includes(n)}(e))))return!1;const t=e.map((e=>{let{column:t}=e;return t}));return new Set(t).size===t.length}function M_(e){if(e!==T_)return e===b_?T_:b_}function I_(e){return e.querySelector(`.${N_}`)}function O_(e,t){if(e<0||!t.parentNode)return!1;const n=t.parentNode.parentNode.childNodes;return-1===Array.from(n).indexOf(t.parentNode)-n.length}function x_(e,t,n){return-1===e&&t>=0&&!1===Hm(n)}function P_(e,t,n){return function(r,i){const{sortEmptyCells:o}=n;if(r===i)return S_;if($d(r))return $d(i)?S_:o&&"asc"===e?R_:E_;if($d(i))return o&&"asc"===e?E_:R_;const s=M(r,t),a=M(i,t);return s.isValid()?a.isValid()?a.isAfter(s)?"asc"===e?R_:E_:a.isBefore(s)?"asc"===e?E_:R_:S_:R_:E_}}const __="indicatorDisabled",L_="columnSorting",H_="sortAction",k_=new Map([[b_,"ascending"],[T_,"descending"]]);function F_(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function D_(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function V_(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}const U_="columnSorting",B_="append",W_=U_;y_(U_,(function(e,t){return function(n,r){const[,...i]=n,[,...o]=r;return function(n){const r=e[n],s=t[n],a=i[n],l=o[n],h=s.columnSorting;return(h.compareFunctionFactory?h.compareFunctionFactory:C_(s.type))(r,s,h)(a,l)}(0)}})),Rf.getSingleton().register("beforeColumnSort"),Rf.getSingleton().register("afterColumnSort");const j_=new WeakMap;var G_=new WeakSet;class z_ extends Hx{constructor(){super(...arguments),F_(this,G_),D_(this,"columnStatesManager",null),D_(this,"columnMetaCache",null),D_(this,"pluginKey",U_),D_(this,"indexesSequenceCache",null)}static get PLUGIN_KEY(){return U_}static get PLUGIN_PRIORITY(){return 50}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){var e,t,n=this;if(j_.has(this.hot)&&j_.get(this.hot)!==this.pluginKey)return this.hot.updateSettings({[this.pluginKey]:!1}),e=j_.get(this.hot),t=this.pluginKey,void Fm(Wd`Plugins \`columnSorting\` and \`multiColumnSorting\` should not be enabled simultaneously.\x20
    Only \`${e}\` will work. The \`${t}\` plugin will remain disabled.`);this.enabled||(j_.set(this.hot,this.pluginKey),this.columnStatesManager=new d_(this.hot,`${this.pluginKey}.sortingStates`),this.columnMetaCache=new kE((e=>{let t=this.hot.toVisualColumn(e);return null===t&&(t=e),this.getMergedPluginSettings(t)})),this.hot.columnIndexMapper.registerMap(`${this.pluginKey}.columnMeta`,this.columnMetaCache),this.addHook("afterGetColHeader",((e,t)=>V_(G_,this,Y_).call(this,e,t))),this.addHook("beforeOnCellMouseDown",(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return V_(G_,n,X_).call(n,...t)})),this.addHook("afterOnCellMouseDown",((e,t)=>this.onAfterOnCellMouseDown(e,t))),this.addHook("afterInit",(()=>V_(G_,this,$_).call(this))),this.addHook("afterLoadData",(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return V_(G_,n,K_).call(n,...t)})),this.hot.view&&V_(G_,this,$_).call(this),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){const e=(e,t)=>{const n=I_(t);!1!==O_(e,t)&&null!==n&&this.updateHeaderClasses(n)};j_.delete(this.hot),this.hot.addHook("afterGetColHeader",e),this.hot.addHookOnce("afterViewRender",(()=>{this.hot.removeHook("afterGetColHeader",e)})),this.hot.batchExecution((()=>{null!==this.indexesSequenceCache&&(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginKey),this.indexesSequenceCache=null)}),!0),this.hot.columnIndexMapper.unregisterMap(`${this.pluginKey}.columnMeta`),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();return this.sort(this.getColumnNextConfig(e.col)),!1},runOnlyIf:()=>{var e,t;const n=null===(e=this.hot.getSelectedRangeLast())||void 0===e?void 0:e.highlight;return n&&(null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.isSingle())&&this.hot.selection.isCellVisible(n)&&-1===n.row&&n.col>=0},relativeToGroup:qA,position:"before",group:W_})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(W_)}sort(e){const t=this.getSortConfig(),n=this.getNormalizedSortConfigs(e),r=this.areValidSortConfigs(n);!1!==this.hot.runHooks("beforeColumnSort",t,n,r)&&(0===t.length&&null===this.indexesSequenceCache&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new YE),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),r&&(this.columnStatesManager.setSortStates(n),this.sortByPresetSortStates(n),this.saveAllSortSettings(n)),this.hot.runHooks("afterColumnSort",t,r?n:t,r),r&&(this.hot.render(),this.hot.forceFullRender=!1,this.hot.view.render()))}clearSort(){this.sort([])}isSorted(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}getSortConfig(e){return Gd(e)?this.columnStatesManager.getColumnSortState(e):this.columnStatesManager.getSortStates()}setSortConfig(e){const t=this.getNormalizedSortConfigs(e);this.areValidSortConfigs(t)&&this.columnStatesManager.setSortStates(t)}getNormalizedSortConfigs(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Array.isArray(e)?e.slice(0,1):[e]}areValidSortConfigs(e){const t=this.hot.countCols();return A_(e)&&e.every((e=>{let{column:n}=e;return n<=t&&n>=0}))}saveAllSortSettings(e){const t=this.columnStatesManager.getAllColumnsProperties();t.initialConfig=Dd(e,(e=>{let{column:t,...n}=e;return{column:this.hot.toPhysicalColumn(t),...n}})),this.hot.runHooks("persistentStateSave","columnSorting",t)}getAllSavedSortSettings(){const e={};this.hot.runHooks("persistentStateLoad","columnSorting",e);const t=e.value,n=e=>{let{column:t,...n}=e;return{column:this.hot.toVisualColumn(t),...n}};return Gd(t)&&Array.isArray(t.initialConfig)&&(t.initialConfig=Dd(t.initialConfig,n)),t}getColumnNextConfig(e){const t=this.columnStatesManager.getSortOrderOfColumn(e);if(Gd(t)){const n=M_(t);return Gd(n)?{column:e,sortOrder:n}:void 0}const n=this.hot.countCols();if(Number.isInteger(e)&&e>=0&&e<n)return{column:e,sortOrder:M_()}}getNextSortConfig(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:B_;const n=this.columnStatesManager.getIndexOfColumnInSortQueue(e),r=-1!==n,i=this.getSortConfig(),o=this.getColumnNextConfig(e);if(r){if(zd(o))return[...i.slice(0,n),...i.slice(n+1)];if(t===B_)return[...i.slice(0,n),...i.slice(n+1),o];if("replace"===t)return[...i.slice(0,n),o,...i.slice(n+1)]}return Gd(o)?i.concat(o):i}getPluginColumnConfig(e){if(am(e)){const t=e[this.pluginKey];if(am(t))return t}return{}}getMergedPluginSettings(e){const t=this.hot.getSettings()[this.pluginKey],n=this.columnStatesManager.getAllColumnsProperties(),r=this.hot.getCellMeta(0,e),i=Object.getPrototypeOf(r);return Array.isArray(i.columns)?Object.assign(n,t,this.getPluginColumnConfig(i.columns[e])):Cg(i.columns)?Object.assign(n,t,this.getPluginColumnConfig(i.columns(e))):Object.assign(n,t)}getFirstCellSettings(e){const t=this.hot.getCellMeta(0,e),n=Object.create(t);return n[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(e)),n}getNumberOfRowsToSort(e){const t=this.hot.getSettings();return t.maxRows<=e?t.maxRows:e-t.minSpareRows}sortByPresetSortStates(e){if(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),0===e.length)return;const t=[],n=this.hot.countRows(),r=t=>Dd(e,(e=>this.hot.getDataAtCell(t,e.column)));for(let l=0;l<this.getNumberOfRowsToSort(n);l+=1)t.push([this.hot.toPhysicalRow(l)].concat(r(l)));const i=Dd(t,(e=>e[0]));!function(e,t){const n=v_(t);for(var r=arguments.length,i=new Array(r>2?r-2:0),o=2;o<r;o++)i[o-2]=arguments[o];e.sort(n(...i))}(t,this.pluginKey,Dd(e,(e=>e.sortOrder)),Dd(e,(e=>this.getFirstCellSettings(e.column))));for(let l=t.length;l<n;l+=1)t.push([l].concat(r(l)));const o=Dd(t,(e=>e[0])),s=new Map(Dd(i,((e,t)=>[e,o[t]]))),a=Dd(this.hot.rowIndexMapper.getIndexesSequence(),(e=>s.has(e)?s.get(e):e));this.hot.rowIndexMapper.setIndexesSequence(a)}sortBySettings(e){if(am(e)){this.columnStatesManager.updateAllColumnsProperties(e);const t=e.initialConfig;(Array.isArray(t)||am(t))&&this.sort(t)}else this.hot.render()}updateHeaderClasses(e){if(Dp(e,Array.from(k_.values()).concat(H_,__,L_)),!1!==this.enabled){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];Fp(e,function(e,t,n,r){const i=[L_];if(r&&i.push(H_),!1===n)return i.push(__),i;const o=e.getSortOrderOfColumn(t);return Gd(o)&&i.push(k_.get(o)),i}(...n))}}onUpdateSettings(e){super.onUpdateSettings(e),null!==this.columnMetaCache&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),Gd(e[this.pluginKey])&&this.sortBySettings(e[this.pluginKey])}wasClickableHeaderClicked(e,t){return this.getFirstCellSettings(t)[this.pluginKey].headerAction&&kp(e.target,N_)}onAfterOnCellMouseDown(e,t){if(!1!==x_(t.row,t.col,e)&&this.wasClickableHeaderClicked(e,t.col)){this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(t.col));const e=this.hot.getActiveEditor(),n=this.getColumnNextConfig(t.col);null!=e&&e.isOpened()&&this.hot.getCellValidator(e.row,e.col)?this.hot.addHookOnce("postAfterValidate",(()=>{this.sort(n)})):this.sort(n)}}destroy(){var e;null===(e=this.columnStatesManager)||void 0===e||e.destroy(),super.destroy()}}function $_(){const e=this.getAllSavedSortSettings();if(am(e))this.sortBySettings(e);else{const e=this.hot.getSettings()[this.pluginKey];this.sortBySettings(e)}}function Y_(e,t){const n=I_(t);if(!1===O_(e,t)||null===n)return;const r=this.getFirstCellSettings(e)[this.pluginKey],i=r.indicator,o=r.headerAction;if(this.updateHeaderClasses(n,this.columnStatesManager,e,i,o),this.hot.getSettings().ariaTags){const n=this.columnStatesManager.getSortOrderOfColumn(e);Vp(t,...(s=n?`${n}ending`:"none",["aria-sort",s]))}var s}function K_(e){!0===e&&this.hot.view&&V_(G_,this,$_).call(this)}function X_(e,t,n,r){!1!==x_(t.row,t.col,e)&&this.wasClickableHeaderClicked(e,t.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(r.column=!0)}function q_(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const Q_=class{constructor(e,t){q_(this,"plugin",void 0),q_(this,"hot",void 0),q_(this,"endpoints",[]),q_(this,"settings",void 0),q_(this,"settingsType","array"),q_(this,"currentEndpoint",null),q_(this,"cellsToSetCache",[]),this.plugin=e,this.hot=this.plugin.hot,this.settings=t}initEndpoints(){this.endpoints=this.parseSettings(),this.refreshAllEndpoints()}getEndpoint(e){return"function"===this.settingsType?this.fillMissingEndpointData(this.settings)[e]:this.endpoints[e]}getAllEndpoints(){return"function"===this.settingsType?this.fillMissingEndpointData(this.settings):this.endpoints}fillMissingEndpointData(e){return this.parseSettings(e.call(this))}parseSettings(e){const t=[];let n=e;if(n||"function"!=typeof this.settings)return n||(n=this.settings),Vd(n,(e=>{const n={};this.assignSetting(e,n,"ranges",[[0,this.hot.countRows()-1]]),this.assignSetting(e,n,"reversedRowCoords",!1),this.assignSetting(e,n,"destinationRow",new Error("\n        You must provide a destination row for the Column Summary plugin in order to work properly!\n      ")),this.assignSetting(e,n,"destinationColumn",new Error("\n        You must provide a destination column for the Column Summary plugin in order to work properly!\n      ")),this.assignSetting(e,n,"sourceColumn",e.destinationColumn),this.assignSetting(e,n,"type","sum"),this.assignSetting(e,n,"forceNumeric",!1),this.assignSetting(e,n,"suppressDataTypeErrors",!0),this.assignSetting(e,n,"customFunction",null),this.assignSetting(e,n,"readOnly",!0),this.assignSetting(e,n,"roundFloat",!1),t.push(n)})),t;this.settingsType="function"}assignSetting(e,t,n,r){if("ranges"!==n||void 0!==e[n]){if("ranges"!==n||0!==e[n].length)if(void 0===e[n]){if(r instanceof Error)throw r;t[n]=r}else"destinationRow"===n&&t.reversedRowCoords?t[n]=this.hot.countRows()-e[n]-1:t[n]=e[n]}else t[n]=r}resetSetupBeforeStructureAlteration(e,t,n){if("function"!==this.settingsType)return;const r=e.indexOf("row")>-1?"row":"col",i=this.getAllEndpoints();Vd(i,(i=>{"row"===r&&i.destinationRow>=t&&("insert_row"===e?i.alterRowOffset=n:"remove_row"===e&&(i.alterRowOffset=-1*n)),"col"===r&&i.destinationColumn>=t&&("insert_col"===e?i.alterColumnOffset=n:"remove_col"===e&&(i.alterColumnOffset=-1*n))})),this.resetAllEndpoints(i,!1)}resetSetupAfterStructureAlteration(e,t,n,r,i){let o=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];if("function"===this.settingsType){const e=()=>(this.hot.removeHook("beforeViewRender",e),this.refreshAllEndpoints());return void this.hot.addHookOnce("beforeViewRender",e)}const s=e.indexOf("row")>-1?"row":"col",a=e.indexOf("remove")>-1?-1:1,l=this.getAllEndpoints(),h=0===e.indexOf("move_row"),u=t;Vd(l,(e=>{"row"===s&&e.destinationRow>=u&&(e.alterRowOffset=a*n),"col"===s&&e.destinationColumn>=u&&(e.alterColumnOffset=a*n)})),this.resetAllEndpoints(l,!h),Vd(l,h?e=>{this.extendEndpointRanges(e,u,r[0],r.length),this.recreatePhysicalRanges(e),this.clearOffsetInformation(e)}:e=>{this.shiftEndpointCoordinates(e,u)}),o&&this.refreshAllEndpoints()}clearOffsetInformation(e){e.alterRowOffset=void 0,e.alterColumnOffset=void 0}extendEndpointRanges(e,t,n,r){Vd(e.ranges,(e=>{e[1]&&(t>=e[0]&&t<=e[1]?n>e[1]?e[1]+=r:n<e[0]&&(e[0]-=r):n>=e[0]&&n<=e[1]&&(e[1]-=r,t<=e[0]&&(e[0]+=1,e[1]+=1)))}))}recreatePhysicalRanges(e){const t=e.ranges,n=[],r=[];Vd(t,(e=>{const t=[];if(e[1])for(let n=e[0];n<=e[1];n++)t.push(this.hot.toPhysicalRow(n));else t.push(this.hot.toPhysicalRow(e[0]));r.push(t)})),Vd(r,(e=>{let t=[];Vd(e,((r,i)=>{0===i?t.push(r):e[i]!==e[i-1]+1&&(t.push(e[i-1]),n.push(t),t=[],t.push(r)),i===e.length-1&&(t.push(r),n.push(t))}))})),e.ranges=n}shiftEndpointCoordinates(e,t){e.alterRowOffset&&0!==e.alterRowOffset?(e.destinationRow+=e.alterRowOffset||0,Vd(e.ranges,(n=>{Vd(n,((r,i)=>{r>=t&&(n[i]+=e.alterRowOffset||0)}))}))):e.alterColumnOffset&&0!==e.alterColumnOffset&&(e.destinationColumn+=e.alterColumnOffset||0,e.sourceColumn+=e.alterColumnOffset||0)}resetAllEndpoints(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getAllEndpoints(),t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];e.some((e=>{const t=e.alterRowOffset||0,n=e.alterColumnOffset||0;return e.destinationRow+t>=this.hot.countRows()||e.destinationColumn+n>=this.hot.countCols()}))||(this.cellsToSetCache=[],Vd(e,(e=>{this.resetEndpointValue(e,t)})),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}refreshAllEndpoints(){this.cellsToSetCache=[],Vd(this.getAllEndpoints(),(e=>{this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e,"init")})),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshChangedEndpoints(e){const t=[];this.cellsToSetCache=[],Vd(e,((e,n,r)=>{`${e[2]||""}`!=`${e[3]}`&&Vd(this.getAllEndpoints(),((e,i)=>{this.hot.propToCol(r[n][1])===e.sourceColumn&&-1===t.indexOf(i)&&t.push(i)}))})),Vd(t,(e=>{this.refreshEndpoint(this.getEndpoint(e))})),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshCellMetas(){this.endpoints.forEach((e=>{const t=this.hot.toVisualRow(e.destinationRow);if(null!==t){const n=this.hot.getCellMeta(t,e.destinationColumn);n.readOnly=e.readOnly,n.className="columnSummaryResult"}}))}refreshEndpoint(e){this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e),this.currentEndpoint=null}resetEndpointValue(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const n=e.alterRowOffset||0,r=e.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(e.destinationRow+(t?n:0)),this.hot.toVisualColumn(e.destinationColumn+(t?r:0)),""])}setEndpointValue(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=this.hot.toVisualRow(e.destinationRow);if(e.destinationRow>=this.hot.countRows()||e.destinationColumn>=this.hot.countCols())return void this.throwOutOfBoundsWarning();const i=this.hot.toVisualRow(e.destinationRow);if(null!==i){const n=this.hot.getCellMeta(i,e.destinationColumn);"init"!==t&&n.readOnly===e.readOnly||(n.readOnly=e.readOnly,n.className="columnSummaryResult")}if((!0===e.roundFloat||Number.isInteger(e.roundFloat))&&!isNaN(e.result)){const t=e.roundFloat;let n=0;Number.isInteger(t)&&(n=Math.min(Math.max(0,t),100)),e.result=e.result.toFixed(n)}n?this.hot.setDataAtCell(r,e.destinationColumn,e.result,"ColumnSummary.set"):this.cellsToSetCache.push([r,e.destinationColumn,e.result]),e.alterRowOffset=void 0,e.alterColumnOffset=void 0}throwOutOfBoundsWarning(){Fm("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}};function Z_(e){return null==e||isNaN(e)}function J_(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function eL(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function tL(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}const nL="columnSummary";var rL=new WeakSet;class iL extends Hx{constructor(){super(...arguments),J_(this,rL),eL(this,"endpoints",null)}static get PLUGIN_KEY(){return nL}static get PLUGIN_PRIORITY(){return 220}isEnabled(){return!!this.hot.getSettings()[nL]}enablePlugin(){var e=this;this.enabled||(this.settings=this.hot.getSettings()[nL],this.endpoints=new Q_(this,this.settings),this.addHook("afterInit",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return tL(rL,e,oL).call(e,...n)})),this.addHook("afterChange",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return tL(rL,e,aL).call(e,...n)})),this.addHook("afterUpdateSettings",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return tL(rL,e,sL).call(e,...n)})),this.addHook("beforeCreateRow",((e,t,n)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_row",e,t,null,n))),this.addHook("beforeCreateCol",((e,t,n)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_col",e,t,null,n))),this.addHook("beforeRemoveRow",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.endpoints.resetSetupBeforeStructureAlteration("remove_row",...n)})),this.addHook("beforeRemoveCol",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.endpoints.resetSetupBeforeStructureAlteration("remove_col",...n)})),this.addHook("afterCreateRow",((e,t,n)=>this.endpoints.resetSetupAfterStructureAlteration("insert_row",e,t,null,n))),this.addHook("afterCreateCol",((e,t,n)=>this.endpoints.resetSetupAfterStructureAlteration("insert_col",e,t,null,n))),this.addHook("afterRemoveRow",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.endpoints.resetSetupAfterStructureAlteration("remove_row",...n)})),this.addHook("afterRemoveCol",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.endpoints.resetSetupAfterStructureAlteration("remove_col",...n)})),this.addHook("afterRowMove",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return tL(rL,e,lL).call(e,...n)})),super.enablePlugin())}disablePlugin(){this.endpoints=null,this.settings=null,this.currentEndpoint=null,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.endpoints.initEndpoints(),super.updatePlugin()}calculate(e){switch(e.type.toLowerCase()){case"sum":e.result=this.calculateSum(e);break;case"min":case"max":e.result=this.calculateMinMax(e,e.type);break;case"count":e.result=this.countEntries(e);break;case"average":e.result=this.calculateAverage(e);break;case"custom":e.result=e.customFunction.call(this,e)}}calculateSum(e){let t=0;return hm(e.ranges,(n=>{t+=this.getPartialSum(n,e.sourceColumn)})),t}getPartialSum(e,t){let n=0,r=e[1]||e[0],i=null,o=0;do{if(i=this.getCellValue(r,t),i=Z_(i)?null:i,null!==i){const e=(`${i}`.split(".")[1]||[]).length||1;e>o&&(o=e)}n+=i||0,r-=1}while(r>=e[0]);return Math.round(n*10**o)/10**o}calculateMinMax(e,t){let n=null;return hm(e.ranges,(r=>{const i=this.getPartialMinMax(r,e.sourceColumn,t);if(null===n&&null!==i&&(n=i),null!==i)switch(t){case"min":n=Math.min(n,i);break;case"max":n=Math.max(n,i)}})),null===n?"Not enough data":n}getPartialMinMax(e,t,n){let r,i=null,o=e[1]||e[0];do{if(r=this.getCellValue(o,t),r=Z_(r)?null:r,null===i)i=r;else if(null!==r)switch(n){case"min":i=Math.min(i,r);break;case"max":i=Math.max(i,r)}o-=1}while(o>=e[0]);return i}countEmpty(e,t){let n,r=0,i=e[1]||e[0];do{n=this.getCellValue(i,t),n=Z_(n)?null:n,null===n&&(r+=1),i-=1}while(i>=e[0]);return r}countEntries(e){let t=0;return hm(e.ranges,(n=>{const r=void 0===n[1]?1:n[1]-n[0]+1,i=this.countEmpty(n,e.sourceColumn);t+=r,t-=i})),t}calculateAverage(e){return this.calculateSum(e)/this.countEntries(e)}getCellValue(e,t){const n=this.hot.toVisualRow(e),r=this.hot.toVisualColumn(t);let i=this.hot.getSourceDataAtCell(e,t),o="";if(null!==n&&null!==r&&(o=this.hot.getCellMeta(n,r).className||""),o.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&("string"==typeof i&&(i=i.replace(/,/,".")),i=parseFloat(i)),isNaN(i)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error(Wd`ColumnSummary plugin: cell at (${e}, ${t}) is not in a\x20
          numeric format. Cannot do the calculation.`);return i}}function oL(){this.endpoints.initEndpoints()}function sL(e){void 0!==e.columns&&this.endpoints.refreshCellMetas()}function aL(e,t){e&&"ColumnSummary.reset"!==t&&"ColumnSummary.set"!==t&&"loadData"!==t&&this.endpoints.refreshChangedEndpoints(e)}function lL(e,t){this.endpoints.resetSetupBeforeStructureAlteration("move_row",e[0],e.length,e,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",t,e.length,e,this.pluginName)}function hL(e,t,n){uL(e,t),t.set(e,n)}function uL(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function cL(e,t){return e.get(pL(e,t))}function dL(e,t,n){return e.set(pL(e,t),n),n}function pL(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var gL=new WeakMap,mL=new WeakMap,fL=new WeakMap,wL=new WeakSet;class yL{constructor(){var e,t;uL(e=this,t=wL),t.add(e),hL(this,gL,!0),hL(this,mL,null),hL(this,fL,new ResizeObserver((e=>pL(wL,this,vL).call(this,e))))}setObservedElement(e){dL(mL,this,e)}unobserve(){cL(fL,this).unobserve(cL(mL,this))}observe(){dL(gL,this,!0),cL(fL,this).observe(cL(mL,this))}destroy(){cL(fL,this).disconnect()}}function vL(e){!cL(gL,this)&&Array.isArray(e)&&e.length?e.forEach((e=>{let{borderBoxSize:t}=e;const{inlineSize:n,blockSize:r}=t[0];this.runLocalHooks("resize",n,r)})):dL(gL,this,!1)}function CL(e,t,n){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,n)}function SL(e,t){return e.get(EL(e,t))}function RL(e,t,n){return e.set(EL(e,t),n),n}function EL(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}om(yL,yS);var bL=new WeakMap,TL=new WeakMap,NL=new WeakMap,AL=new WeakMap,ML=new WeakMap,IL=new WeakMap,OL=new WeakMap;class xL{static get CLASS_EDITOR_CONTAINER(){return"htCommentsContainer"}static get CLASS_EDITOR(){return"htComments"}static get CLASS_INPUT(){return"htCommentTextArea"}static get CLASS_CELL(){return"htCommentCell"}constructor(e,t){var n=this;CL(this,bL,void 0),CL(this,TL,!1),CL(this,NL,null),CL(this,AL,void 0),CL(this,ML,void 0),CL(this,IL,!0),CL(this,OL,new yL),RL(bL,this,e),RL(TL,this,t),RL(AL,this,this.createEditor()),RL(ML,this,SL(AL,this).style),SL(OL,this).setObservedElement(this.getInputElement()),SL(OL,this).addLocalHook("resize",(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.runLocalHooks("resize",...t)})),this.hide()}setPosition(e,t){SL(ML,this).left=`${e}px`,SL(ML,this).top=`${t}px`}setSize(e,t){if(e&&t){const n=this.getInputElement();n.style.width=`${e}px`,n.style.height=`${t}px`}}getSize(){return{width:tg(this.getInputElement()),height:ng(this.getInputElement())}}observeSize(){SL(OL,this).observe()}resetSize(){const e=this.getInputElement();e.style.width="",e.style.height=""}setReadOnlyState(e){this.getInputElement().readOnly=e}show(){SL(ML,this).display="block",RL(IL,this,!1)}hide(){SL(OL,this).unobserve(),SL(IL,this)||(SL(ML,this).display="none"),RL(IL,this,!0)}isVisible(){return"block"===SL(ML,this).display}setValue(){const e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"")||"";this.getInputElement().value=e}getValue(){return this.getInputElement().value}isFocused(){return SL(bL,this).activeElement===this.getInputElement()}focus(){this.getInputElement().focus()}createEditor(){const e=SL(bL,this).createElement("div"),t=SL(bL,this).createElement("textarea");return e.style.display="none",RL(NL,this,SL(bL,this).createElement("div")),SL(NL,this).setAttribute("dir",SL(TL,this)?"rtl":"ltr"),Fp(SL(NL,this),xL.CLASS_EDITOR_CONTAINER),SL(bL,this).body.appendChild(SL(NL,this)),Fp(e,xL.CLASS_EDITOR),Fp(t,xL.CLASS_INPUT),t.setAttribute("data-hot-input",!0),e.appendChild(t),SL(NL,this).appendChild(e),e}getInputElement(){return SL(AL,this).querySelector(`.${xL.CLASS_INPUT}`)}getEditorElement(){return SL(AL,this)}destroy(){const e=SL(NL,this)?SL(NL,this).parentNode:null;SL(AL,this).parentNode.removeChild(SL(AL,this)),RL(AL,this,null),RL(ML,this,null),SL(OL,this).destroy(),e&&e.removeChild(SL(NL,this))}}om(xL,yS);const PL=xL;function _L(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class LL{constructor(e){_L(this,"wasLastActionShow",!0),_L(this,"showDebounced",null),_L(this,"hidingTimer",null),this.updateDelay(e)}hide(){this.wasLastActionShow=!1,this.hidingTimer=setTimeout((()=>{!1===this.wasLastActionShow&&this.runLocalHooks("hide")}),250)}show(e){this.wasLastActionShow=!0,this.showDebounced(e)}cancelHiding(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}updateDelay(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:250;this.showDebounced=Sg((e=>{this.wasLastActionShow&&this.runLocalHooks("show",e.from.row,e.from.col)}),e)}destroy(){this.clearLocalHooks()}}om(LL,yS);const HL=LL;function kL(e,t){const n={};return Vd(e,(e=>{e.forAll(((e,r)=>{e>=0&&r>=0&&(n[e]||(n[e]=[]),n[e][r]=t(e,r))}))})),n}function FL(e,t,n,r,i){Vd(e,(e=>{e.forAll(((e,o)=>{e>=0&&o>=0&&function(e,t,n,r,i,o){const s=i(e,t);let a=r;s.className&&(a="vertical"===n?function(e,t){return-1!==e.indexOf(t)?e:`${e.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","")} ${t}`}(s.className,r):function(e,t){return-1!==e.indexOf(t)?e:`${e.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","")} ${t}`}(s.className,r));o(e,t,"className",a)}(e,o,t,n,r,i)}))}))}function DL(e){return`<span class="selected">${String.fromCharCode(10003)}</span>${e}`}function VL(e,t){let n=!1;return Array.isArray(e)&&Vd(e,(e=>(e.forAll(((e,r)=>{if(e>=0&&r>=0&&t(e,r))return n=!0,!1})),n))),n}function UL(e,t){const n={top:0,left:0};if(t!==e.ownerDocument){const{frameElement:e}=t.defaultView,{top:r,left:i}=e.getBoundingClientRect();n.top=r,n.left=i}return n}const BL="---------";const WL="alignment";const jL="clear_column";const GL="col_left";const zL="col_right";const $L="make_read_only";const YL="redo";const KL="remove_col";const XL="remove_row";const qL="row_above";const QL="row_below";const ZL="no_items";const JL="undo";const eH=[qL,QL,GL,zL,jL,XL,KL,JL,YL,$L,WL,BL,ZL],tH={[BL]:function(){return{name:BL}},[ZL]:function(){return{key:ZL,name(){return this.getTranslatedPhrase(Sb)},disabled:!0,isCommand:!1}},[qL]:function(){return{key:qL,name(){return this.getTranslatedPhrase(Rb)},callback(){const e=this.getSelectedRangeLast().getTopLeftCorner();this.alter("insert_row_above",e.row,1,"ContextMenu.rowAbove")},disabled(){const e=this.getSelectedRangeLast();return!!(!e||this.selection.isSelectedByColumnHeader()||e.isSingleHeader()&&e.highlight.row<0||this.countSourceRows()>=this.getSettings().maxRows)||!!this.selection.isSelectedByCorner()&&0===this.countRows()},hidden(){return!this.getSettings().allowInsertRow}}},[QL]:function(){return{key:QL,name(){return this.getTranslatedPhrase(Eb)},callback(){const e=this.getSelectedRangeLast().getBottomRightCorner();this.alter("insert_row_below",e.row,1,"ContextMenu.rowBelow")},disabled(){const e=this.getSelectedRangeLast();return!!(!e||this.selection.isSelectedByColumnHeader()||e.isSingleHeader()&&e.highlight.row<0||this.countSourceRows()>=this.getSettings().maxRows)},hidden(){return!this.getSettings().allowInsertRow}}},[GL]:function(){return{key:GL,name(){return this.getTranslatedPhrase(bb)},callback(){const e=this.getSelectedRangeLast().getTopLeftCorner(),t=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(t,e.col,1,"ContextMenu.columnLeft")},disabled(){if(!this.isColumnModificationAllowed())return!0;const e=this.getSelectedRangeLast();return!!(!e||this.selection.isSelectedByRowHeader()||e.isSingleHeader()&&e.highlight.col<0||this.countSourceCols()>=this.getSettings().maxCols)||!!this.selection.isSelectedByCorner()&&0===this.countCols()},hidden(){return!this.getSettings().allowInsertColumn}}},[zL]:function(){return{key:zL,name(){return this.getTranslatedPhrase(Tb)},callback(){const e=this.getSelectedRangeLast().getTopRightCorner(),t=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(t,e.col,1,"ContextMenu.columnRight")},disabled(){if(!this.isColumnModificationAllowed())return!0;const e=this.getSelectedRangeLast();return!!(!e||this.selection.isSelectedByRowHeader()||e.isSingleHeader()&&e.highlight.col<0||this.countSourceCols()>=this.getSettings().maxCols)},hidden(){return!this.getSettings().allowInsertColumn}}},[jL]:function(){return{key:jL,name(){return this.getTranslatedPhrase(xb)},callback(e,t){const n=t[0].start.col,r=t[0].end.col;this.countRows()&&this.populateFromArray(0,n,[[null]],Math.max(t[0].start.row,t[0].end.row),r,"ContextMenu.clearColumn")},disabled(){const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader()&&e.highlight.col<0||!this.selection.isSelectedByColumnHeader())return!0;let t=!1;return e.forAll(((e,n)=>{if(e<0||n<0)return!0;const{readOnly:r}=this.getCellMeta(e,n);return!!r||(t=!0,!1)})),!t}}},[XL]:function(){return{key:XL,name(){const e=this.getSelected();let t=0;if(e)if(e.length>1)t=1;else{const[n,,r]=e[0];n-r!=0&&(t=1)}return this.getTranslatedPhrase(Nb,t)},callback(){this.alter("remove_row",function(e){const t=qN(e.getSelected());if(t===WN||t===jN)return[];const n=QN(t,{createCellCoords:e._createCellCoords.bind(e),createCellRange:e._createCellRange.bind(e)}),r=new Set;Vd(e.getSelected(),(e=>{const{from:t,to:i}=n(e),o=Math.max(t.row,0),s=i.row-o+1;Vd(Array.from(new Array(s),((e,t)=>o+t)),(e=>{r.has(e)||r.add(e)}))}));const i=kd(Array.from(r).sort(((e,t)=>e-t)),((e,t,n,r)=>(0!==n&&t===r[n-1]+1?e[e.length-1][1]+=1:e.push([t,1]),e)),[]);return i}(this),1,"ContextMenu.removeRow")},disabled(){const e=this.getSelectedRangeLast();if(!e)return!0;if(e.isSingleHeader()&&e.highlight.row<0)return!0;const t=this.countRows();return this.selection.isSelectedByCorner()?0===t:this.selection.isSelectedByColumnHeader()||0===t},hidden(){return!this.getSettings().allowRemoveRow}}},[KL]:function(){return{key:KL,name(){const e=this.getSelected();let t=0;if(e)if(e.length>1)t=1;else{const[,n,,r]=e[0];n-r!=0&&(t=1)}return this.getTranslatedPhrase(Ab,t)},callback(){this.alter("remove_col",function(e){const t=qN(e.getSelected());if(t===WN||t===jN)return[];const n=QN(t,{createCellCoords:e._createCellCoords.bind(e),createCellRange:e._createCellRange.bind(e)}),r=new Set;Vd(e.getSelected(),(e=>{const{from:t,to:i}=n(e),o=Math.max(t.col,0),s=i.col-o+1;Vd(Array.from(new Array(s),((e,t)=>o+t)),(e=>{r.has(e)||r.add(e)}))}));const i=kd(Array.from(r).sort(((e,t)=>e-t)),((e,t,n,r)=>(0!==n&&t===r[n-1]+1?e[e.length-1][1]+=1:e.push([t,1]),e)),[]);return i}(this),null,"ContextMenu.removeColumn")},disabled(){if(!this.isColumnModificationAllowed())return!0;const e=this.getSelectedRangeLast();if(!e)return!0;if(e.isSingleHeader()&&e.highlight.col<0)return!0;const t=this.countCols();return this.selection.isSelectedByCorner()?0===t:this.selection.isSelectedByRowHeader()||0===t},hidden(){return!this.getSettings().allowRemoveColumn}}},[JL]:function(){return{key:JL,name(){return this.getTranslatedPhrase(Mb)},callback(){this.undo()},hidden(){const e=this.getPlugin("undoRedo");return!e||!e.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isUndoAvailable()}}},[YL]:function(){return{key:YL,name(){return this.getTranslatedPhrase(Ib)},callback(){this.redo()},hidden(){const e=this.getPlugin("undoRedo");return!e||!e.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isRedoAvailable()}}},[$L]:function(){return{key:$L,checkable:!0,ariaChecked(){return VL(this.getSelectedRange(),((e,t)=>this.getCellMeta(e,t).readOnly))},ariaLabel(){return this.getTranslatedPhrase(Ob)},name(){let e=this.getTranslatedPhrase(Ob);return VL(this.getSelectedRange(),((e,t)=>this.getCellMeta(e,t).readOnly))&&(e=DL(e)),e},callback(){const e=this.getSelectedRange(),t=VL(e,((e,t)=>this.getCellMeta(e,t).readOnly));Vd(e,(e=>{e.forAll(((e,n)=>{e>=0&&n>=0&&this.setCellMeta(e,n,"readOnly",!t)}))})),this.render()},disabled(){const e=this.getSelectedRangeLast();return!e||(!!e.isSingleHeader()||(!!this.selection.isSelectedByCorner()||(0===this.countRows()||0===this.countCols()||(!this.getSelectedRange()||0===this.getSelectedRange().length))))}}},[WL]:function(){return{key:WL,name(){return this.getTranslatedPhrase(zb)},disabled(){if(0===this.countRows()||0===this.countCols())return!0;const e=this.getSelectedRangeLast();return!e||(!!e.isSingleHeader()||!(this.getSelectedRange()&&!this.selection.isSelectedByCorner()))},submenu:{items:[{key:`${WL}:left`,name(){return this.getTranslatedPhrase($b)},callback(){const e=this.getSelectedRange(),t=kL(e,((e,t)=>this.getCellMeta(e,t).className)),n="horizontal",r="htLeft";this.runHooks("beforeCellAlignment",t,e,n,r),FL(e,n,r,((e,t)=>this.getCellMeta(e,t)),((e,t,n,r)=>this.setCellMeta(e,t,n,r))),this.render()},disabled:!1},{key:`${WL}:center`,name(){return this.getTranslatedPhrase(Yb)},callback(){const e=this.getSelectedRange(),t=kL(e,((e,t)=>this.getCellMeta(e,t).className)),n="horizontal",r="htCenter";this.runHooks("beforeCellAlignment",t,e,n,r),FL(e,n,r,((e,t)=>this.getCellMeta(e,t)),((e,t,n,r)=>this.setCellMeta(e,t,n,r))),this.render()},disabled:!1},{key:`${WL}:right`,name(){return this.getTranslatedPhrase(Kb)},callback(){const e=this.getSelectedRange(),t=kL(e,((e,t)=>this.getCellMeta(e,t).className)),n="horizontal",r="htRight";this.runHooks("beforeCellAlignment",t,e,n,r),FL(e,n,r,((e,t)=>this.getCellMeta(e,t)),((e,t,n,r)=>this.setCellMeta(e,t,n,r))),this.render()},disabled:!1},{key:`${WL}:justify`,name(){return this.getTranslatedPhrase(Xb)},callback(){const e=this.getSelectedRange(),t=kL(e,((e,t)=>this.getCellMeta(e,t).className)),n="horizontal",r="htJustify";this.runHooks("beforeCellAlignment",t,e,n,r),FL(e,n,r,((e,t)=>this.getCellMeta(e,t)),((e,t,n,r)=>this.setCellMeta(e,t,n,r))),this.render()},disabled:!1},{name:BL},{key:`${WL}:top`,name(){return this.getTranslatedPhrase(qb)},callback(){const e=this.getSelectedRange(),t=kL(e,((e,t)=>this.getCellMeta(e,t).className)),n="vertical",r="htTop";this.runHooks("beforeCellAlignment",t,e,n,r),FL(e,n,r,((e,t)=>this.getCellMeta(e,t)),((e,t,n,r)=>this.setCellMeta(e,t,n,r))),this.render()},disabled:!1},{key:`${WL}:middle`,name(){return this.getTranslatedPhrase(Qb)},callback(){const e=this.getSelectedRange(),t=kL(e,((e,t)=>this.getCellMeta(e,t).className)),n="vertical",r="htMiddle";this.runHooks("beforeCellAlignment",t,e,n,r),FL(e,n,r,((e,t)=>this.getCellMeta(e,t)),((e,t,n,r)=>this.setCellMeta(e,t,n,r))),this.render()},disabled:!1},{key:`${WL}:bottom`,name(){return this.getTranslatedPhrase(Zb)},callback(){const e=this.getSelectedRange(),t=kL(e,((e,t)=>this.getCellMeta(e,t).className)),n="vertical",r="htBottom";this.runHooks("beforeCellAlignment",t,e,n,r),FL(e,n,r,((e,t)=>this.getCellMeta(e,t)),((e,t,n,r)=>this.setCellMeta(e,t,n,r))),this.render()},disabled:!1}]}}}};function nH(){const e={};return hm(tH,((t,n)=>{e[n]=t()})),e}function rH(e,t,n){iH(e,t),t.set(e,n)}function iH(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function oH(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function sH(e,t,n){return e.set(lH(e,t),n),n}function aH(e,t){return e.get(lH(e,t))}function lH(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}const hH="comments",uH="comment",cH="value",dH="style",pH="readOnly",gH=hH,mH=`plugin:${hH}`;var fH=new WeakMap,wH=new WeakMap,yH=new WeakMap,vH=new WeakMap,CH=new WeakMap,SH=new WeakMap,RH=new WeakSet;class EH extends Hx{constructor(){var e,t;super(...arguments),iH(e=this,t=RH),t.add(e),oH(this,"range",{}),rH(this,fH,null),rH(this,wH,null),rH(this,yH,!1),rH(this,vH,!1),rH(this,CH,null),rH(this,SH,"")}static get PLUGIN_KEY(){return hH}static get PLUGIN_PRIORITY(){return 60}static get DEFAULT_SETTINGS(){return{displayDelay:250}}isEnabled(){return!!this.hot.getSettings()[hH]}enablePlugin(){var e=this;this.enabled||(aH(fH,this)||(sH(fH,this,new PL(this.hot.rootDocument,this.hot.isRtl())),aH(fH,this).addLocalHook("resize",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return lH(RH,e,xH).call(e,...n)}))),aH(wH,this)||sH(wH,this,new HL(this.getSetting("displayDelay"))),this.addHook("afterContextMenuDefaultOptions",(e=>this.addToContextMenu(e))),this.addHook("afterRenderer",((e,t,n,r,i,o)=>lH(RH,this,MH).call(this,e,o))),this.addHook("afterScroll",(()=>lH(RH,this,_H).call(this))),this.addHook("afterBeginEditing",(()=>this.hide())),this.addHook("afterDocumentKeyDown",(e=>lH(RH,this,PH).call(this,e))),this.addHook("afterSetTheme",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return lH(RH,e,LH).call(e,...n)})),aH(wH,this).addLocalHook("hide",(()=>this.hide())),aH(wH,this).addLocalHook("show",((e,t)=>this.showAtCell(e,t))),this.registerShortcuts(),this.registerListeners(),super.enablePlugin())}updatePlugin(){aH(wH,this).updateDelay(this.getSetting("displayDelay")),super.updatePlugin()}disablePlugin(){this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager(),t=e.getContext("grid"),n=e.addContext(mH);t.addShortcut({keys:[["Control","Alt","M"]],callback:()=>{const t=this.hot.getSelectedRangeLast();sH(vH,this,!0),this.hot.scrollToFocusedCell((()=>{this.setRange(t),this.show(),this.focusEditor(),e.setActiveContextName(mH),this.hot._registerTimeout((()=>{sH(vH,this,!1)}))}))},stopPropagation:!0,runOnlyIf:()=>{var e;return null===(e=this.hot.getSelectedRangeLast())||void 0===e?void 0:e.highlight.isCell()},group:gH}),n.addShortcut({keys:[["Escape"]],callback:()=>{aH(fH,this).setValue(aH(SH,this)),this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>aH(fH,this).isVisible()&&aH(fH,this).isFocused(),group:gH}),n.addShortcut({keys:[["Control/Meta","Enter"]],callback:()=>{this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>aH(fH,this).isVisible()&&aH(fH,this).isFocused(),group:gH}),n.addShortcut({keys:[["Shift","Tab"],["Tab"]],forwardToContext:e.getContext("grid"),callback:()=>{aH(fH,this).setValue(aH(fH,this).getValue()),this.hide(),e.setActiveContextName("grid")},group:gH})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(gH)}registerListeners(){const{rootDocument:e}=this.hot,t=this.getEditorInputElement();this.eventManager.addEventListener(e,"mouseover",(e=>lH(RH,this,NH).call(this,e))),this.eventManager.addEventListener(e,"mousedown",(e=>lH(RH,this,bH).call(this,e))),this.eventManager.addEventListener(e,"mouseup",(()=>lH(RH,this,AH).call(this))),this.eventManager.addEventListener(t,"focus",(()=>lH(RH,this,OH).call(this))),this.eventManager.addEventListener(t,"blur",(()=>lH(RH,this,IH).call(this))),this.eventManager.addEventListener(this.getEditorInputElement(),"mousedown",(e=>lH(RH,this,TH).call(this,e)))}setRange(e){this.range=e}clearRange(){this.range={}}targetIsCellWithComment(e){const t=Op(e.target,"TD","TBODY");return!!(t&&kp(t,"htCommentCell")&&Op(t,[this.hot.rootElement]))}targetIsCommentTextArea(e){return this.getEditorInputElement()===e.target}setComment(e){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const t=aH(fH,this).getValue();let n="";null!=e?n=e:null!=t&&(n=t);const r=this.range.from.row,i=this.range.from.col;this.updateCommentMeta(r,i,{[cH]:n}),this.hot.render()}setCommentAtCell(e,t,n){this.setRange({from:this.hot._createCellCoords(e,t)}),this.setComment(n)}removeComment(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,uH),e&&this.hot.render(),this.hide()}removeCommentAtCell(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.setRange({from:this.hot._createCellCoords(e,t)}),this.removeComment(n)}getComment(){const e=this.range.from.row,t=this.range.from.col;return this.getCommentMeta(e,t,cH)}getCommentAtCell(e,t){return this.getCommentMeta(e,t,cH)}show(){var e;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const{from:{row:t,col:n}}=this.range;if(t<0||t>this.hot.countSourceRows()-1||n<0||n>this.hot.countSourceCols()-1)return!1;const r=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return aH(wH,this).cancelHiding(),aH(fH,this).setValue(null!==(e=r[uH]?r[uH][cH]:null)&&void 0!==e?e:""),aH(fH,this).show(),this.refreshEditor(!0),!0}showAtCell(e,t){return this.setRange({from:this.hot._createCellCoords(e,t)}),this.show()}hide(){aH(fH,this).hide()}refreshEditor(){if(!(arguments.length>0&&void 0!==arguments[0]&&arguments[0]||this.range.from&&aH(fH,this).isVisible()))return;const{rowIndexMapper:e,columnIndexMapper:t}=this.hot,{row:n,col:r}=this.range.from;let i=e.getRenderableFromVisualIndex(n),o=t.getRenderableFromVisualIndex(r);const s=null===i;aH(fH,this).setPosition(0,0),null===i&&(i=e.getRenderableFromVisualIndex(e.getNearestNotHiddenIndex(n,-1))),null===o&&(o=t.getRenderableFromVisualIndex(t.getNearestNotHiddenIndex(r,-1)));const a=null===i,l=null===o;i=null!=i?i:0,o=null!=o?o:0;const{rootWindow:h,view:{_wt:u}}=this.hot,{wtTable:c}=u,d=u.getCell({row:i,col:o},!0),p=this.getCommentMeta(n,r,dH);p?aH(fH,this).setSize(p.width,p.height):aH(fH,this).resetSize();const g=l?0:c.getColumnWidth(o),m=s&&!a?ng(d):0,{left:f,top:w,width:y,height:v}=d.getBoundingClientRect(),{width:C,height:S}=aH(fH,this).getSize(),{innerWidth:R,innerHeight:E}=this.hot.rootWindow,b=this.hot.rootDocument.documentElement,T=hg(this.hot.rootDocument),N=ug(this.hot.rootWindow)?T:0,A=cg(this.hot.rootWindow)?T:0;let M=f+h.scrollX+g,I=w+h.scrollY+m;this.hot.isRtl()&&(M-=C+g),this.hot.isLtr()&&f+y+C>R-N?M=f+h.scrollX-C-1:this.hot.isRtl()&&M<-(b.scrollWidth-b.clientWidth)&&(M=f+h.scrollX+g+1),w+S>E-A&&(I-=S-v+1),aH(fH,this).setPosition(M,I),aH(fH,this).setReadOnlyState(this.getCommentMeta(n,r,pH)),aH(fH,this).observeSize()}focusEditor(){aH(fH,this).focus()}updateCommentMeta(e,t,n){const r=this.hot.getCellMeta(e,t)[uH];let i;r?(i=rm(r),nm(i,n)):i=n,this.hot.setCellMeta(e,t,uH,i)}getCommentMeta(e,t,n){const r=this.hot.getCellMeta(e,t);if(r[uH])return r[uH][n]}addToContextMenu(e){var t;e.items.push({name:BL},(t=this,{key:"commentsAddEdit",name(){var e;const n=null===(e=this.getSelectedRangeLast())||void 0===e?void 0:e.highlight;return null!=n&&n.isCell()&&t.getCommentAtCell(n.row,n.col)?this.getTranslatedPhrase(Wb):this.getTranslatedPhrase(Bb)},callback(){const e=this.getSelectedRangeLast();t.setRange(e),t.show(),t.focusEditor()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||0===this.countRenderedRows()||0===this.countRenderedCols())}}),function(e){return{key:"commentsRemove",name(){return this.getTranslatedPhrase(jb)},callback(){this.getSelectedRangeLast().forAll(((t,n)=>{t>=0&&n>=0&&e.removeCommentAtCell(t,n,!1)})),this.render()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||0===this.countRenderedRows()||0===this.countRenderedCols())}}}(this),function(e){return{key:"commentsReadOnly",name(){const t=this.getTranslatedPhrase(Gb);return VL(this.getSelectedRange(),((t,n)=>e.getCommentMeta(t,n,pH)))?DL(t):t},callback(){this.getSelectedRangeLast().forAll(((t,n)=>{if(t>=0&&n>=0){const r=!!e.getCommentMeta(t,n,pH);e.updateCommentMeta(t,n,{[pH]:!r})}}))},disabled(){const t=this.getSelectedRangeLast();return!!(!t||t.highlight.isHeader()||!e.getCommentAtCell(t.highlight.row,t.highlight.col)||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||0===this.countRenderedRows()||0===this.countRenderedCols())}}}(this))}getEditorInputElement(){return aH(fH,this).getInputElement()}destroy(){var e,t;null===(e=aH(fH,this))||void 0===e||e.destroy(),null===(t=aH(wH,this))||void 0===t||t.destroy(),super.destroy()}}function bH(e){if(this.hot.view&&this.hot.view._wt&&!aH(yH,this)&&!this.targetIsCommentTextArea(e)){const t=Op(e.target,"TD","TBODY");let n=null;t&&(n=this.hot.getCoords(t)),(!t||this.range.from&&n&&(this.range.from.row!==n.row||this.range.from.col!==n.col))&&this.hide()}}function TH(e){e.stopPropagation()}function NH(e){const{rootDocument:t}=this.hot;if(!(aH(yH,this)||aH(fH,this).isFocused()||kp(e.target,"wtBorder")||aH(CH,this)===e.target)&&aH(fH,this))if(sH(CH,this,t.elementFromPoint(e.clientX,e.clientY)),this.targetIsCellWithComment(e)){const t=this.hot._createCellRange(this.hot.getCoords(e.target));aH(wH,this).show(t)}else Pp(e.target,t)&&!this.targetIsCommentTextArea(e)&&aH(wH,this).hide()}function AH(){sH(yH,this,!1)}function MH(e,t){t[uH]&&t[uH][cH]&&Fp(e,t.commentedCellClassName)}function IH(){sH(SH,this,""),this.hot.getShortcutManager().setActiveContextName("grid"),this.setComment()}function OH(){sH(SH,this,this.getComment()),this.hot.listen(),this.hot.getShortcutManager().setActiveContextName(mH)}function xH(e,t){this.updateCommentMeta(this.range.from.row,this.range.from.col,{[dH]:{width:e,height:t}})}function PH(e){aH(fH,this).isFocused()&&_m(e)}function _H(){aH(vH,this)||this.hide()}function LH(){const e=aH(fH,this).getEditorElement();Dp(e,/ht-theme-.*/g),Fp(e,this.hot.getCurrentThemeName())}function HH(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class kH{constructor(e){HH(this,"hot",void 0),HH(this,"commands",{}),HH(this,"commonCallback",null),this.hot=e}registerCommand(e,t){this.commands[e]=t}setCommonCallback(e){this.commonCallback=e}execute(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const i=e.split(":"),o=i[0],s=2===i.length?i[1]:null;let a=this.commands[o];if(!a)throw new Error(`Menu command '${o}' not exists.`);if(s&&a.submenu&&(a=function(e,t){let n;return Vd(t,(t=>{const r=t.key?t.key.split(":"):null;if(Array.isArray(r)&&r[1]===e)return n=t,!1})),n}(s,a.submenu.items)),!0===a.disabled)return;if("function"==typeof a.disabled&&!0===a.disabled.call(this.hot))return;if(pm(a,"submenu"))return;const l=[];"function"==typeof a.callback&&l.push(a.callback),"function"==typeof this.commonCallback&&l.push(this.commonCallback),n.unshift(i.join(":")),Vd(l,(e=>e.apply(this.hot,n)))}}function FH(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class DH{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;FH(this,"hot",void 0),FH(this,"predefinedItems",nH()),FH(this,"defaultOrderPattern",void 0),this.hot=e,this.defaultOrderPattern=t}setPredefinedItems(e){const t={};this.defaultOrderPattern.length=0,hm(e,((e,n)=>{let r="";e.name===BL?(t[BL]=e,r=BL):isNaN(parseInt(n,10))?(e.key=void 0===e.key?n:e.key,t[n]=e,r=e.key):(t[e.key]=e,r=e.key),this.defaultOrderPattern.push(r)})),this.predefinedItems=t}getItems(){return function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=[];let i=e;i&&i.items?i=i.items:Array.isArray(i)||(i=t);am(i)?hm(i,((e,t)=>{let i=n["string"==typeof e?e:t];i||(i=e),am(e)?tm(i,e):"string"==typeof i&&(i={name:i}),void 0===i.key&&(i.key=t),r.push(i)})):Vd(i,((e,t)=>{let i=n[e];!i&&eH.indexOf(e)>=0||(i||(i={name:e,key:`${t}`}),am(e)&&tm(i,e),void 0===i.key&&(i.key=t),r.push(i))}));return r}(arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,this.defaultOrderPattern,this.predefinedItems)}}function VH(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class UH{constructor(e,t){VH(this,"top",void 0),VH(this,"topRelative",void 0),VH(this,"left",void 0),VH(this,"leftRelative",void 0),VH(this,"scrollTop",void 0),VH(this,"scrollLeft",void 0),VH(this,"cellHeight",void 0),VH(this,"cellWidth",void 0);const n=t.scrollY,r=t.scrollX;let i,o,s,a,l,h;this.rootWindow=t,this.type=this.getSourceType(e),"literal"===this.type?(i=parseInt(e.top,10),s=parseInt(e.left,10),l=e.height||0,h=e.width||0,o=i,a=s,i+=n,s+=r):"event"===this.type&&(i=parseInt(e.pageY,10),s=parseInt(e.pageX,10),l=e.target.clientHeight,h=e.target.clientWidth,o=i-n,a=s-r),this.top=i,this.topRelative=o,this.left=s,this.leftRelative=a,this.scrollTop=n,this.scrollLeft=r,this.cellHeight=l,this.cellWidth=h}getSourceType(e){let t="literal";return e instanceof Event&&(t="event"),t}fitsAbove(e){return this.topRelative>=e.offsetHeight}fitsBelow(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+e.offsetHeight<=t}fitsOnRight(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+e.offsetWidth<=t}fitsOnLeft(e){return this.leftRelative>=e.offsetWidth}}function BH(e,t,n){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,n)}function WH(e,t){return e.get(GH(e,t))}function jH(e,t,n){return e.set(GH(e,t),n),n}function GH(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var zH=new WeakMap,$H=new WeakMap,YH=new WeakMap,KH=new WeakMap,XH=new WeakMap;class qH{constructor(e){BH(this,zH,void 0),BH(this,$H,void 0),BH(this,YH,void 0),BH(this,KH,!1),BH(this,XH,{above:0,below:0,left:0,right:0}),jH(KH,this,e)}setOffset(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return WH(XH,this)[e]=t,this}setElement(e){return jH(zH,this,e),this}setParentElement(e){return jH($H,this,e),this}updatePosition(e){jH(YH,this,new UH(e,WH(zH,this).ownerDocument.defaultView)),WH(KH,this)?(WH(YH,this).fitsBelow(WH(zH,this))?this.setPositionBelowCursor():WH(YH,this).fitsAbove(WH(zH,this))?this.setPositionAboveCursor():this.setPositionBelowCursor(),this.updateHorizontalPosition()):(this.setPositionBelowCursor(),this.setPositionOnRightOfCursor())}updateHorizontalPosition(){"rtl"===WH(zH,this).dir?WH(YH,this).fitsOnLeft(WH(zH,this))?this.setPositionOnLeftOfCursor():this.setPositionOnRightOfCursor():WH(YH,this).fitsOnRight(WH(zH,this))?this.setPositionOnRightOfCursor():this.setPositionOnLeftOfCursor()}setPositionAboveCursor(){let e=WH(XH,this).above+WH(YH,this).top-WH(zH,this).offsetHeight;WH($H,this)&&(e=WH(YH,this).top+WH(YH,this).cellHeight-WH(zH,this).offsetHeight+3),WH(zH,this).style.top=`${e}px`}setPositionBelowCursor(){let e=WH(XH,this).below+WH(YH,this).top+1;WH($H,this)&&(e=WH(YH,this).top-1),WH(zH,this).style.top=`${e}px`}setPositionOnRightOfCursor(){let e=WH(YH,this).left;if(WH($H,this)){const t=WH($H,this).ownerDocument.defaultView,n=Number.parseInt(t.getComputedStyle(WH($H,this).querySelector(".htCore")).borderRightWidth,10);e+=WH(YH,this).cellWidth+n}else e+=WH(XH,this).right;WH(zH,this).style.left=`${e}px`}setPositionOnLeftOfCursor(){let e=WH(XH,this).left+WH(YH,this).left-WH(zH,this).offsetWidth;if(WH($H,this)){const t=WH($H,this).ownerDocument.defaultView;e-=Number.parseInt(t.getComputedStyle(WH($H,this).querySelector(".htCore")).borderLeftWidth,10)}WH(zH,this).style.left=`${e}px`}}function QH(e){let{initialPage:t=-1,size:n=(()=>0),onItemSelect:r=(()=>{}),onClear:i=(()=>{})}=e;const o=new Set;let s=ny(t,-1,l()-1);function a(e,t){const n=l()-1;if(e<0&&(e=n),e>n&&(e=0),o.has(e))return-1;o.add(e);return!1===r(e,!1)&&(e=a(1===t?++e:--e,t)),e}function l(){return Math.max(n(),0)}return{setCurrentPage:function(e){e>-1&&e<l()&&!1!==r(e,!0)&&(s=e)},getCurrentPage:function(){return s},toFirstItem:function(){l()>0&&(o.clear(),s=a(0,1))},toLastItem:function(){l()>0&&(o.clear(),s=a(l()-1,-1))},toNextItem:function(){l()>0&&(o.clear(),s=a(++s,1))},toPreviousItem:function(){l()>0&&(o.clear(),s=a(--s,-1))},getSize:l,clear:function(){o.clear(),s=t,i()}}}function ZH(e){return pm(e,"submenu")}function JH(e){return new RegExp(BL,"i").test(e.name)}function ek(e,t){return!0===e.disabled||"function"==typeof e.disabled&&!0===e.disabled.call(t)}function tk(e){return pm(e,"disableSelection")}function nk(e,t){const n=e.slice(0);for(let r=0;r<n.length&&n[r].name===t;)n.shift();return n}function rk(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:BL,n=e.slice(0);return n=nk(n,t),n=function(e,t){let n=e.slice(0);return n.reverse(),n=nk(n,t),n.reverse(),n}(n,t),n=function(e){const t=[];return Vd(e,((e,n)=>{n>0?t[t.length-1].name!==e.name&&t.push(e):t.push(e)})),t}(n),n}function ik(e){return QH({size:()=>e.countRows(),onItemSelect(t,n){const r=e.getCell(t,0);if(!r||function(e){return kp(e,"htSeparator")}(r)||function(e){return kp(e,"htDisabled")}(r)||function(e){return kp(e,"htSelectionDisabled")}(r))return!1;e.selectCell(t,0,...n?[t,0,!1,!1]:[])},onClear(){e.deselectCell()}})}const ok="menu",sk=ok;function ak(e,t,n){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,n)}function lk(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function hk(e,t,n){return e.set(ck(e,t),n),n}function uk(e,t){return e.get(ck(e,t))}function ck(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var dk=new WeakMap,pk=new WeakMap,gk=new WeakMap;class mk{get tableBorderWidth(){return void 0===uk(gk,this)&&this.hotMenu&&hk(gk,this,parseInt(this.hotMenu.rootWindow.getComputedStyle(this.hotMenu.view._wt.wtTable.TABLE).borderWidth,10)),uk(gk,this)}constructor(e,t){var n=this;lk(this,"hot",void 0),lk(this,"options",void 0),lk(this,"eventManager",new Ff(this)),lk(this,"container",void 0),lk(this,"positioner",void 0),lk(this,"hotMenu",null),lk(this,"hotSubMenus",{}),lk(this,"parentMenu",void 0),lk(this,"menuItems",null),lk(this,"origOutsideClickDeselects",null),ak(this,dk,void 0),ak(this,pk,void 0),ak(this,gk,void 0),this.hot=e,this.options=t||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:215,container:this.hot.rootDocument.documentElement},this.container=this.createContainer(this.options.name),this.positioner=new qH(this.options.keepInViewport),this.parentMenu=this.options.parent||null,this.registerEvents(),this.isSubMenu()&&this.addLocalHook("afterSelectionChange",(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.parentMenu.runLocalHooks("afterSelectionChange",...t)})),this.hot.addHook("afterSetTheme",((e,t)=>{var n;t||(null===(n=this.hotMenu)||void 0===n||n.useTheme(e))}))}registerEvents(){let e=this.hot.rootWindow;for(;e;)this.eventManager.addEventListener(e.document,"mousedown",(e=>this.onDocumentMouseDown(e))),this.eventManager.addEventListener(e.document,"touchstart",(e=>this.onDocumentMouseDown(e))),this.eventManager.addEventListener(e.document,"contextmenu",(e=>this.onDocumentContextMenu(e))),e=Ip(e)}setMenuItems(e){this.menuItems=e}getNavigator(){return uk(dk,this)}getKeyboardShortcutsCtrl(){return uk(pk,this)}getSelectedItem(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}hasSelectedItem(){return Array.isArray(this.hotMenu.getSelectedLast())}isSubMenu(){return null!==this.parentMenu}open(){this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";const e=Sg((e=>this.openSubMenu(e)),300),t=this.options.minWidth||215;let n=!1,r=Fd(this.menuItems,(e=>(e.key===ZL&&(n=!0),function(e,t){return!e.hidden||!("function"==typeof e.hidden&&e.hidden.call(t))}(e,this.hot))));if(r.length<1&&!n)r.push(nH()[ZL]);else if(0===r.length)return;r=rk(r,BL);let i=!1;const o={data:r,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth:e=>Gd(e)&&e<t?t:e,autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,hiddenRows:!0,maxCols:1,columns:[{data:"name",renderer:(s=this.hot,(e,t,n,r,i,o)=>{const a=e.getSourceDataAtRow(n),l=s.rootDocument.createElement("div"),h="function"==typeof o?o.call(s):o,u="function"==typeof a.ariaLabel?a.ariaLabel.call(s):a.ariaLabel,c="function"==typeof a.ariaChecked?a.ariaChecked.call(s):a.ariaChecked;if(Wp(t),Fp(l,"htItemWrapper"),s.getSettings().ariaTags){const e=!ek(a,s)&&!tk(a)&&!JH(a);Vp(t,[...(d=a,!0===d.checkable?[["role","menuitemcheckbox"],gp(u),bp(c)]:[["role","menuitem"],gp(h)]),...e?[cp(-1)]:[],...ek(a,s)?[["aria-disabled","true"]]:[],...ZH(a)?[Sp(!1)]:[]])}var d;t.className="",t.appendChild(l),JH(a)?Fp(t,"htSeparator"):"function"==typeof a.renderer?(Fp(t,"htCustomMenuRenderer"),t.appendChild(a.renderer(e,l,n,r,i,h))):Gp(l,h),ek(a,s)?Fp(t,"htDisabled"):tk(a)?Fp(t,"htSelectionDisabled"):ZH(a)&&Fp(t,"htSubmenu")})}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",ariaTags:!1,themeName:this.hot.getCurrentThemeName(),beforeOnCellMouseOver:(e,t)=>{uk(dk,this).setCurrentPage(t.row)},afterOnCellMouseOver:(t,n)=>{this.isAllSubMenusClosed()?e(n.row):this.openSubMenu(n.row)},afterOnCellContextMenu:e=>{e.preventDefault(),Am()&&i&&this.hasSelectedItem()&&this.close(!0)},afterSelection:(e,t,n,r,i)=>{this.hotMenu.view.isMouseDown()&&(i.value=!0),this.runLocalHooks("afterSelectionChange",this.getSelectedItem())},beforeOnCellMouseUp:e=>{this.hasSelectedItem()&&(i=!this.isCommandPassive(this.getSelectedItem()),this.executeCommand(e))},afterOnCellMouseUp:e=>{Am()&&Hm(e)||!i||!this.hasSelectedItem()||(bm()||Nm()?this.hot._registerTimeout((()=>this.close(!0)),325):this.close(!0))},afterUnlisten:()=>{!this.hasSelectedItem()&&this.isOpened()&&this.hotMenu.listen()}};var s;this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new this.hot.constructor(this.container,o),this.hotMenu.addHook("afterInit",(()=>this.onAfterInit())),this.hotMenu.init(),hk(dk,this,ik(this.hotMenu)),hk(pk,this,function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];const n=[];function r(e,t){s(t).addShortcuts(e,{group:ok})}function i(e,t){const i=s(t);e.forEach((e=>{let{keys:t}=e;t.forEach((e=>i.removeShortcutsByKeys(e)))})),n.push({shortcuts:e,contextName:t}),r(e,t)}function o(e){return e?`${sk}:${e}`:sk}function s(t){var n;const r=e.hotMenu.getShortcutManager(),i=o(t);return null!==(n=r.getContext(i))&&void 0!==n?n:r.addContext(i)}return r(function(e){const{hot:t,hotMenu:n}=e;return[{keys:[["Control/Meta","A"]],forwardToContext:t.getShortcutManager().getContext("grid"),callback:()=>e.close(!0)},{keys:[["Tab"],["Shift","Tab"]],callback:(n,r)=>{const i=t.getSettings(),o="function"==typeof i.tabMoves?i.tabMoves(n):i.tabMoves;r.includes("shift")?t.selection.transformStart(-o.row,-o.col):t.selection.transformStart(o.row,o.col),e.close(!0)}},{keys:[["Escape"]],callback:()=>e.close()},{keys:[["ArrowDown"]],callback:()=>e.getNavigator().toNextItem()},{keys:[["ArrowUp"]],callback:()=>e.getNavigator().toPreviousItem()},{keys:[["ArrowRight"]],callback:()=>{const t=n.getSelectedLast();if(t){const n=e.openSubMenu(t[0]);n&&n.getNavigator().toFirstItem()}}},{keys:[["ArrowLeft"]],callback:()=>{n.getSelectedLast()&&e.isSubMenu()&&(e.close(),e.isSubMenu()&&e.parentMenu.hotMenu.listen())}},{keys:[["Control/Meta","ArrowUp"],["Home"]],callback:()=>e.getNavigator().toFirstItem()},{keys:[["Control/Meta","ArrowDown"],["End"]],callback:()=>e.getNavigator().toLastItem()},{keys:[["Enter"],["Space"]],callback:t=>{const r=n.getSelectedLast();r&&(n.getSourceDataAtRow(r[0]).submenu?e.openSubMenu(r[0]).getNavigator().toFirstItem():(e.executeCommand(t),e.close(!0)))}},{keys:[["PageUp"]],callback:()=>{n.getSelectedLast()?n.selection.transformStart(-n.countVisibleRows(),0):e.getNavigator().toFirstItem()}},{keys:[["PageDown"]],callback:()=>{n.getSelectedLast()?n.selection.transformStart(n.countVisibleRows(),0):e.getNavigator().toLastItem()}}]}(e)),t.forEach((e=>{let{shortcuts:t,contextName:n}=e;i(t,n)})),{addCustomShortcuts:i,getCustomShortcuts:function(){return[...n]},getContext:s,listen:function(t){e.hotMenu.getShortcutManager().setActiveContextName(o(t))}}}(this)),uk(pk,this).listen(),this.focus(),this.isSubMenu()&&this.addLocalHook("afterOpen",(()=>this.parentMenu.runLocalHooks("afterSubmenuOpen",this))),this.runLocalHooks("afterOpen",this)}close(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.isOpened())if(e&&this.isSubMenu())this.parentMenu.close();else if(uk(dk,this).clear(),this.closeAllSubMenus(),this.container.style.display="none",this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.isSubMenu()){if(this.hot.getSettings().ariaTags){const e=this.parentMenu.hotMenu.getSelectedLast();if(e){Vp(this.parentMenu.hotMenu.getCell(e[0],0),[Sp(!1)])}}this.parentMenu.hotMenu.listen()}}openSubMenu(e){if(!this.hotMenu)return!1;const t=this.hotMenu.getCell(e,0);if(this.closeAllSubMenus(),!t||!function(e){return kp(e,"htSubmenu")}(t))return!1;const n=this.hotMenu.getSourceDataAtRow(e),r=new mk(this.hot,{parent:this,name:n.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return r.setMenuItems(n.submenu.items),r.open(),r.setPosition(t.getBoundingClientRect()),this.hotSubMenus[n.key]=r,this.hot.getSettings().ariaTags&&Vp(t,[Sp(!0)]),r}closeSubMenu(e){const t=this.hotMenu.getSourceDataAtRow(e),n=this.hotSubMenus[t.key];if(n){n.destroy(),delete this.hotSubMenus[t.key];const r=this.hotMenu.getCell(e,0);this.hot.getSettings().ariaTags&&Vp(r,[Sp(!1)])}}closeAllSubMenus(){Vd(this.hotMenu.getData(),((e,t)=>this.closeSubMenu(t)))}isAllSubMenusClosed(){return 0===Object.keys(this.hotSubMenus).length}focus(){this.isOpened()&&(this.hotMenu.rootElement.focus({preventScroll:!0}),this.getKeyboardShortcutsCtrl().listen(),this.hotMenu.listen())}destroy(){const e=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),e&&e.removeChild(this.container)}isOpened(){return null!==this.hotMenu}executeCommand(e){if(!this.isOpened()||!this.hasSelectedItem())return;const t=this.getSelectedItem();if(this.runLocalHooks("select",t,e),this.isCommandPassive(t))return;const n=this.hot.getSelectedRange(),r=n?function(e){return Dd(e,(e=>({start:e.getTopStartCorner(),end:e.getBottomEndCorner()})))}(n):[];this.runLocalHooks("executeCommand",t.key,r,e),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",t.key,r,e)}isCommandPassive(e){return!1===e.isCommand||JH(e)||ek(e,this.hot)||ZH(e)}setOffset(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.positioner.setOffset(e,t)}setPosition(e){this.isSubMenu()&&this.positioner.setParentElement(this.parentMenu.container),this.positioner.setElement(this.container).updatePosition(e)}updateMenuDimensions(){const e=this.hotMenu.view.getStylesHandler(),{wtTable:t}=this.hotMenu.view._wt,n=this.hotMenu.getSettings().data,r=t.hider.style,i=t.holder.style,o=parseInt(r.width,10),s=kd(n,((e,t,n)=>{const r=this.hotMenu.getCell(n,0)?ng(this.hotMenu.getCell(n,0)):0;return e+(t.name===BL?1:r)}),0);e.isClassicTheme()?(i.width=`${o+3}px`,i.height=`${s+3}px`):(i.width=`${o}px`,i.height=`${s}px`),r.height=i.height}createContainer(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;const t=this.options.container.ownerDocument;let n,r=e;return r&&(Cg(r)&&(r=r.call(this.hot),r=null===r||zd(r)?"":r.toString()),r=r.replace(/[^A-Za-z0-9]/g,"_"),r=`${this.options.className}Sub_${r}`,n=t.querySelector(`.${this.options.className}.${r}`)),n||(n=t.createElement("div"),Fp(n,`htMenu handsontable ${this.options.className}`),r&&Fp(n,r),this.options.container.appendChild(n)),n}onAfterInit(){this.updateMenuDimensions(),this.hot.getSettings().ariaTags&&Vp(this.hotMenu.rootElement,[["role","menu"],cp(-1)])}onDocumentMouseDown(e){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!Pp(e.target,this.hotMenu.rootElement)?this.close(!0):!this.isAllSubMenusClosed()&&!this.isSubMenu()||Pp(e.target,".htMenu")||this.close(!0))}onDocumentContextMenu(e){this.isOpened()&&kp(e.target,"htCore")&&Pp(e.target,this.hotMenu.rootElement)&&e.preventDefault()}}function fk(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function wk(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function yk(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}om(mk,yS);const vk="contextMenu",Ck=vk;Rf.getSingleton().register("afterContextMenuDefaultOptions"),Rf.getSingleton().register("beforeContextMenuShow"),Rf.getSingleton().register("afterContextMenuShow"),Rf.getSingleton().register("afterContextMenuHide"),Rf.getSingleton().register("afterContextMenuExecute");var Sk=new WeakSet;class Rk extends Hx{constructor(){super(...arguments),fk(this,Sk),wk(this,"commandExecutor",new kH(this.hot)),wk(this,"itemsFactory",null),wk(this,"menu",null)}static get PLUGIN_KEY(){return vk}static get PLUGIN_PRIORITY(){return 70}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[qL,QL,BL,GL,zL,BL,XL,KL,BL,JL,YL,BL,$L,BL,WL]}isEnabled(){return!!this.hot.getSettings()[vk]}enablePlugin(){var e=this;if(this.enabled)return;const t=this.hot.getSettings()[vk];"function"==typeof t.callback&&this.commandExecutor.setCommonCallback(t.callback),this.menu=new mk(this.hot,{className:"htContextMenu",keepInViewport:!0,container:t.uiContainer||this.hot.rootDocument.body}),this.menu.addLocalHook("beforeOpen",(()=>yk(Sk,this,bk).call(this))),this.menu.addLocalHook("afterOpen",(()=>yk(Sk,this,Tk).call(this))),this.menu.addLocalHook("afterClose",(()=>yk(Sk,this,Nk).call(this))),this.menu.addLocalHook("executeCommand",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.executeCommand.call(e,...n)})),this.addHook("afterOnCellContextMenu",(e=>yk(Sk,this,Ek).call(this,e))),this.registerShortcuts(),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control/Meta","Shift","Backslash"],["Shift","F10"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();this.hot.scrollToFocusedCell();const t=this.hot.getCell(e.row,e.col,!0).getBoundingClientRect(),n=UL(this.menu.container,this.hot.rootDocument);this.open({left:t.left+n.left,top:t.top+n.top-1+t.height},{left:t.width,above:-t.height}),this.menu.getNavigator().toFirstItem()},runOnlyIf:()=>{var e;const t=null===(e=this.hot.getSelectedRangeLast())||void 0===e?void 0:e.highlight;return t&&this.hot.selection.isCellVisible(t)&&!this.menu.isOpened()},group:Ck})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(Ck)}open(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{above:0,below:0,left:0,right:0};if(null!==(t=this.menu)&&void 0!==t&&t.isOpened())return;this.prepareMenuItems(),this.menu.open();const r=this.menu.tableBorderWidth>0;hm(n,((e,t)=>{const n=["below","right"].includes(t)?e+1:e-1;this.menu.setOffset(t,r?e:n)})),this.menu.setPosition(e)}close(){var e;null===(e=this.menu)||void 0===e||e.close(),this.itemsFactory=null}executeCommand(e){null===this.itemsFactory&&this.prepareMenuItems();for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];this.commandExecutor.execute(e,...n)}prepareMenuItems(){this.itemsFactory=new DH(this.hot,Rk.DEFAULT_ITEMS);const e=this.hot.getSettings()[vk],t={items:this.itemsFactory.getItems(e)};this.hot.runHooks("afterContextMenuDefaultOptions",t),this.itemsFactory.setPredefinedItems(t.items);const n=this.itemsFactory.getItems(e);this.hot.runHooks("beforeContextMenuSetItems",n),this.menu.setMenuItems(n),Vd(n,(e=>this.commandExecutor.registerCommand(e.key,e)))}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function Ek(e){const t=this.hot.getSettings(),n=t.rowHeaders,r=t.colHeaders;const i=e.target;if(this.close(),kp(i,"handsontableInput"))return;if(e.preventDefault(),e.stopPropagation(),!n&&!r&&!(function(e){return"TD"===e.nodeName||"TD"===e.parentNode.nodeName}(i)||kp(i,"current")&&kp(i,"wtBorder")))return;const o=UL(this.menu.container,this.hot.rootDocument);this.open({top:e.clientY+o.top,left:e.clientX+o.left})}function bk(){this.hot.runHooks("beforeContextMenuShow",this)}function Tk(){this.hot.runHooks("afterContextMenuShow",this)}function Nk(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}Rk.SEPARATOR={name:BL};class Ak{constructor(){this.data={}}setData(e,t){this.data[e]=t}getData(e){return this.data[e]||void 0}}class Mk{constructor(){this.clipboardData=new Ak}preventDefault(){}}function Ik(e,t,n){Ok(e,t),t.set(e,n)}function Ok(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xk(e,t){return e.get(_k(e,t))}function Pk(e,t,n){return e.set(_k(e,t),n),n}function _k(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var Lk=new WeakMap,Hk=new WeakMap,kk=new WeakMap,Fk=new WeakMap,Dk=new WeakMap,Vk=new WeakMap,Uk=new WeakSet;class Bk{constructor(e){let{countRows:t,countColumns:n,rowsLimit:r,columnsLimit:i,countColumnHeaders:o}=e;var s,a;Ok(s=this,a=Uk),a.add(s),Ik(this,Lk,void 0),Ik(this,Hk,void 0),Ik(this,kk,void 0),Ik(this,Fk,void 0),Ik(this,Dk,void 0),Ik(this,Vk,void 0),Pk(Hk,this,t),Pk(kk,this,n),Pk(Fk,this,r),Pk(Dk,this,i),Pk(Vk,this,o)}setSelectedRange(e){Pk(Lk,this,e)}getCellsRange(){if(0===xk(Hk,this).call(this)||0===xk(kk,this).call(this))return null;const{row:e,col:t}=xk(Lk,this).getTopStartCorner(),{row:n,col:r}=xk(Lk,this).getBottomEndCorner(),i=_k(Uk,this,jk).call(this,e,n),o=_k(Uk,this,Wk).call(this,t,r);return{isRangeTrimmed:n!==i||r!==o,startRow:e,startCol:t,endRow:i,endCol:o}}getMostBottomColumnHeadersRange(){if(0===xk(kk,this).call(this)||0===xk(Vk,this).call(this))return null;const{col:e}=xk(Lk,this).getTopStartCorner(),{col:t}=xk(Lk,this).getBottomEndCorner(),n=_k(Uk,this,Wk).call(this,e,t);return{isRangeTrimmed:t!==n,startRow:-1,startCol:e,endRow:-1,endCol:n}}getAllColumnHeadersRange(){if(0===xk(kk,this).call(this)||0===xk(Vk,this).call(this))return null;const{col:e}=xk(Lk,this).getTopStartCorner(),{col:t}=xk(Lk,this).getBottomEndCorner(),n=_k(Uk,this,Wk).call(this,e,t);return{isRangeTrimmed:t!==n,startRow:-xk(Vk,this).call(this),startCol:e,endRow:-1,endCol:n}}}function Wk(e,t){return Math.min(t,Math.max(e+xk(Dk,this).call(this)-1,e))}function jk(e,t){return Math.min(t,Math.max(e+xk(Fk,this).call(this)-1,e))}function Gk(e){const t=[],n=[];return Vd(e,(e=>{Jw(Math.min(e.startRow,e.endRow),Math.max(e.startRow,e.endRow),(e=>{-1===t.indexOf(e)&&t.push(e)}));Jw(Math.min(e.startCol,e.endCol),Math.max(e.startCol,e.endCol),(e=>{-1===n.indexOf(e)&&n.push(e)}))})),{rows:t,columns:n}}function zk(e,t,n){$k(e,t),t.set(e,n)}function $k(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Yk(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Kk(e,t){return e.get(qk(e,t))}function Xk(e,t,n){return e.set(qk(e,t),n),n}function qk(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}Rf.getSingleton().register("afterCopyLimit"),Rf.getSingleton().register("modifyCopyableRange"),Rf.getSingleton().register("beforeCut"),Rf.getSingleton().register("afterCut"),Rf.getSingleton().register("beforePaste"),Rf.getSingleton().register("afterPaste"),Rf.getSingleton().register("beforeCopy"),Rf.getSingleton().register("afterCopy");const Qk="copyPaste",Zk=["fragmentSelection"],Jk=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join("");var eF=new WeakMap,tF=new WeakMap,nF=new WeakMap,rF=new WeakMap,iF=new WeakMap,oF=new WeakMap,sF=new WeakMap,aF=new WeakMap,lF=new WeakSet;class hF extends Hx{constructor(){var e,t;super(...arguments),$k(e=this,t=lF),t.add(e),Yk(this,"columnsLimit",1/0),Yk(this,"rowsLimit",1/0),Yk(this,"pasteMode","overwrite"),Yk(this,"uiContainer",this.hot.rootDocument.body),zk(this,eF,!1),zk(this,tF,!1),zk(this,nF,!1),zk(this,rF,"cells-only"),zk(this,iF,!1),zk(this,oF,!1),zk(this,sF,new Bk({countRows:()=>this.hot.countRows(),countColumns:()=>this.hot.countCols(),rowsLimit:()=>this.rowsLimit,columnsLimit:()=>this.columnsLimit,countColumnHeaders:()=>this.hot.view.getColumnHeadersCount()})),zk(this,aF,!1),Yk(this,"copyableRanges",[])}static get PLUGIN_KEY(){return Qk}static get SETTING_KEYS(){return[Qk,...Zk]}static get PLUGIN_PRIORITY(){return 80}static get DEFAULT_SETTINGS(){return{pasteMode:"overwrite",rowsLimit:1/0,columnsLimit:1/0,copyColumnHeaders:!1,copyColumnGroupHeaders:!1,copyColumnHeadersOnly:!1}}isEnabled(){return!!this.hot.getSettings()[Qk]}enablePlugin(){var e,t,n=this;this.enabled||(this.pasteMode=null!==(e=this.getSetting("pasteMode"))&&void 0!==e?e:this.pasteMode,this.rowsLimit=isNaN(this.getSetting("rowsLimit"))?this.rowsLimit:this.getSetting("rowsLimit"),this.columnsLimit=isNaN(this.getSetting("columnsLimit"))?this.columnsLimit:this.getSetting("columnsLimit"),Xk(eF,this,this.getSetting("copyColumnHeaders")),Xk(tF,this,this.getSetting("copyColumnGroupHeaders")),Xk(nF,this,this.getSetting("copyColumnHeadersOnly")),this.uiContainer=null!==(t=this.getSetting("uiContainer"))&&void 0!==t?t:this.uiContainer,this.addHook("afterContextMenuDefaultOptions",(e=>qk(lF,this,gF).call(this,e))),this.addHook("afterSelection",(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return qk(lF,n,mF).call(n,...t)})),this.addHook("afterSelectionEnd",(()=>qk(lF,this,fF).call(this))),this.eventManager.addEventListener(this.hot.rootDocument,"copy",(function(){return n.onCopy(...arguments)})),this.eventManager.addEventListener(this.hot.rootDocument,"cut",(function(){return n.onCut(...arguments)})),this.eventManager.addEventListener(this.hot.rootDocument,"paste",(function(){return n.onPaste(...arguments)})),Em()&&(this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseenter",(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return qk(lF,n,wF).call(n,...t)})),this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseleave",(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return qk(lF,n,yF).call(n,...t)})),this.addHook("afterSelection",(()=>qk(lF,this,vF).call(this)))),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin()}copy(){Xk(rF,this,arguments.length>0&&void 0!==arguments[0]?arguments[0]:"cells-only"),Xk(iF,this,!0),qk(lF,this,uF).call(this,"copy")}copyCellsOnly(){this.copy("cells-only")}copyColumnHeadersOnly(){this.copy("column-headers-only")}copyWithAllColumnHeaders(){this.copy("with-column-group-headers")}copyWithColumnHeaders(){this.copy("with-column-headers")}cut(){Xk(oF,this,!0),qk(lF,this,uF).call(this,"cut")}getRangedCopyableData(e){return gA(this.getRangedData(e))}getRangedData(e){const t=[],{rows:n,columns:r}=Gk(e);return Vd(n,(e=>{const n=[];Vd(r,(t=>{e<0?n.push(this.hot.getColHeader(t,e)):n.push(this.hot.getCopyableData(e,t))})),t.push(n)})),t}paste(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;if(!e&&!t)return;const n=new Mk;e&&n.clipboardData.setData("text/plain",e),t&&n.clipboardData.setData("text/html",t),this.onPaste(n)}setCopyableText(){const e=this.hot.getSelectedRangeLast();if(!e)return;if(e.isSingleHeader())return void(this.copyableRanges=[]);Kk(sF,this).setSelectedRange(e);const t=new Map([["headers",null],["cells",null]]);"column-headers-only"===Kk(rF,this)?t.set("headers",Kk(sF,this).getMostBottomColumnHeadersRange()):("with-column-headers"===Kk(rF,this)?t.set("headers",Kk(sF,this).getMostBottomColumnHeadersRange()):"with-column-group-headers"===Kk(rF,this)&&t.set("headers",Kk(sF,this).getAllColumnHeadersRange()),t.set("cells",Kk(sF,this).getCellsRange())),this.copyableRanges=Array.from(t.values()).filter((e=>null!==e)).map((e=>{let{startRow:t,startCol:n,endRow:r,endCol:i}=e;return{startRow:t,startCol:n,endRow:r,endCol:i}})),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);const n=t.get("cells");if(null!==n&&n.isRangeTrimmed){const{startRow:e,startCol:t,endRow:r,endCol:i}=n;this.hot.runHooks("afterCopyLimit",r-e+1,i-t+1,this.rowsLimit,this.columnsLimit)}}isEditorOpened(){var e;return null===(e=this.hot.getActiveEditor())||void 0===e?void 0:e.isOpened()}populateValues(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.hot.getSelectedRangeLast();if(!e.length)return;const n=e.length,r=e[0].length,i=[],{row:o,col:s}=t.getTopStartCorner(),{row:a,col:l}=t.getBottomEndCorner();let h=o,u=s,c=o,d=s;for(;i.length<n||h<=a;){const{skipRowOnPaste:t,visualRow:a}=this.hot.getCellMeta(h,s);if(h=a+1,!0===t)continue;c=a,u=s;const p=[],g=i.length%n;for(;p.length<r||u<=l;){const{skipColumnOnPaste:t,visualCol:n}=this.hot.getCellMeta(o,u);if(u=n+1,!0===t)continue;d=n;const i=p.length%r;p.push(e[g][i])}i.push(p)}return Xk(aF,this,!0),this.hot.populateFromArray(o,s,i,void 0,void 0,"CopyPaste.paste",this.pasteMode),[o,s,c,d]}onCopy(e){var t;const n=this.hot.getFocusManager().getRefocusElement(),r=null===(t=e.target)||void 0===t?void 0:t.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!Kk(iF,this)||this.isEditorOpened()||vg(e.target)&&(r&&e.target!==n||!r&&e.target!==this.hot.rootDocument.body&&!Mp(e.target,this.hot.rootElement)))return;e.preventDefault(),this.setCopyableText(),Xk(iF,this,!1);const i=this.getRangedData(this.copyableRanges),o=qk(lF,this,cF).call(this,this.copyableRanges);if(!!this.hot.runHooks("beforeCopy",i,this.copyableRanges,o)){const t=gA(i);if(e&&e.clipboardData){const n=Qw(i,this.hot.rootDocument);e.clipboardData.setData("text/plain",t),e.clipboardData.setData("text/html",[Jk,n].join(""))}else"undefined"==typeof ClipboardEvent&&this.hot.rootWindow.clipboardData.setData("Text",t);this.hot.runHooks("afterCopy",i,this.copyableRanges,o)}Xk(rF,this,"cells-only")}onCut(e){var t;const n=this.hot.getFocusManager().getRefocusElement(),r=null===(t=e.target)||void 0===t?void 0:t.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!Kk(oF,this)||this.isEditorOpened()||vg(e.target)&&(r&&e.target!==n||!r&&e.target!==this.hot.rootDocument.body&&!Mp(e.target,this.hot.rootElement)))return;e.preventDefault(),this.setCopyableText(),Xk(oF,this,!1);const i=this.getRangedData(this.copyableRanges);if(!!this.hot.runHooks("beforeCut",i,this.copyableRanges)){const t=gA(i);if(e&&e.clipboardData){const n=Qw(i,this.hot.rootDocument);e.clipboardData.setData("text/plain",t),e.clipboardData.setData("text/html",[Jk,n].join(""))}else"undefined"==typeof ClipboardEvent&&this.hot.rootWindow.clipboardData.setData("Text",t);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",i,this.copyableRanges)}}onPaste(e){var t;const n=this.hot.getFocusManager().getRefocusElement(),r=null===(t=e.target)||void 0===t?void 0:t.hasAttribute("data-hot-input");if(!this.hot.isListening()||this.isEditorOpened()||!this.hot.getSelected()||vg(e.target)&&(r&&e.target!==n||!r&&e.target!==this.hot.rootDocument.body&&!Mp(e.target,this.hot.rootElement)))return;let i;if(e.preventDefault(),e&&void 0!==e.clipboardData){const t=up(e.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});if(t&&/(<table)|(<TABLE)/g.test(t)){const e=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document;const n={},r=t.createDocumentFragment(),i=t.createElement("div");r.appendChild(i);let o=e;if("string"==typeof o){const e=o.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,(e=>{const t=e.match(/<td\b[^>]*?>/g)[0];return`${t}${e.substring(t.length,e.lastIndexOf("<")).trim().replaceAll(/\n\s+/g," ").replaceAll(/<p.*?>/g,"\n").replace("\n","").replaceAll(/<\/(.*)>\s+$/gm,"</$1>").replace(/(<(?!br)([^>]+)>)/gi,"").replaceAll(/^&nbsp;$/gm,"")}</td>`}));i.insertAdjacentHTML("afterbegin",`${e}`),o=i.querySelector("table")}if(!o||!function(e){return"TABLE"===(e&&e.nodeName||"")}(o))return;const s=i.querySelector('meta[name$="enerator"]'),a=null!==o.querySelector("tbody th"),l=o.querySelector("tr"),h=l?Array.from(l.cells).reduce(((e,t)=>e+t.colSpan),0)-(a?1:0):0,u=o.tFoot&&Array.from(o.tFoot.rows)||[],c=[];let d=!1,p=0,g=0;if(o.tHead){const e=Array.from(o.tHead.rows).filter((e=>{const t=null!==e.querySelector("td");return t&&c.push(e),!t}));p=e.length,d=p>0,p>1?n.nestedHeaders=Array.from(e).reduce(((e,t)=>{const n=Array.from(t.cells).reduce(((e,t,n)=>{if(a&&0===n)return e;const{colSpan:r,innerHTML:i}=t,o=r>1?{label:i,colspan:r}:i;return e.push(o),e}),[]);return e.push(n),e}),[]):d&&(n.colHeaders=Array.from(e[0].children).reduce(((e,t,n)=>(a&&0===n||e.push(t.innerHTML),e)),[]))}c.length&&(n.fixedRowsTop=c.length),u.length&&(n.fixedRowsBottom=u.length);const m=[...c,...Array.from(o.tBodies).reduce(((e,t)=>(e.push(...Array.from(t.rows)),e)),[]),...u];g=m.length;const f=new Array(g);for(let v=0;v<g;v++)f[v]=new Array(h);const w=[],y=[];for(let v=0;v<g;v++){const e=m[v],t=Array.from(e.cells),n=t.length;for(let r=0;r<n;r++){const e=t[r],{nodeName:n,innerHTML:i,rowSpan:o,colSpan:a}=e,l=f[v].findIndex((e=>void 0===e));if("TD"===n){if(o>1||a>1){for(let e=v;e<v+o;e++)if(e<g)for(let t=l;t<l+a;t++)f[e][t]=null;const t=e.getAttribute("style");t&&t.includes("mso-ignore:colspan")||w.push({col:l,row:v,rowspan:o,colspan:a})}let t="";t=s&&/excel/gi.test(s.content)?i.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,"\r\n"):i.replace(/<br(\s*|\/)>[\r\n]?/gim,"\r\n"),f[v][l]=t.replace(Xw,(e=>Kw[e]))}else y.push(i)}}return w.length&&(n.mergeCells=w),y.length&&(n.rowHeaders=y),f.length&&(n.data=f),n}(t,this.hot.rootDocument);i=e.data}else i=e.clipboardData.getData("text/plain")}else"undefined"==typeof ClipboardEvent&&void 0!==this.hot.rootWindow.clipboardData&&(i=this.hot.rootWindow.clipboardData.getData("Text"));if("string"==typeof i&&(i=function(e){const t=[[""]];if(0===e.length)return t;let n,r=0,i=0;for(;e.length>0&&n!==e.length;)if(n=e.length,e.match(pA))e=e.replace(pA,""),r+=1,t[i][r]="";else if(e.match(cA))e=e.replace(cA,""),r=0,i+=1,t[i]=[""];else{let n="";if(e.startsWith('"')){let t=0,r=!0;for(;r;){const i=e.slice(0,1);'"'===i&&(t+=1),n+=i,(0===(e=e.slice(1)).length||e.match(/^[\t\r\n]/)&&t%2==0)&&(r=!1)}n=n.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,(e=>new Array(Math.floor(e.length/2)).fill('"').join("")))}else{const t=e.match(dA);n=t?t[0]:"",e=e.slice(n.length)}t[i][r]=n}return t}(i)),void 0===i||i&&0===i.length)return;if(!1===this.hot.runHooks("beforePaste",i,this.copyableRanges))return;const[o,s,a,l]=this.populateValues(i);this.hot.selectCell(o,s,Math.min(this.hot.countRows()-1,a),Math.min(this.hot.countCols()-1,l)),this.hot.runHooks("afterPaste",i,this.copyableRanges)}destroy(){super.destroy()}}function uF(e){if(Em()){const t=this.hot.getSelectedRangeLast();if(t){const{row:n,col:r}=t.highlight,i=this.hot.getCell(n,r,!0);i&&function(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];wg(e,n),t(),yg(e,n)}(i,(()=>{this.hot.rootDocument.execCommand(e)}))}}else this.hot.rootDocument.execCommand(e)}function cF(e){const{rows:t}=Gk(e);let n=0;for(let r=0;r<t.length&&!(t[r]>=0);r++)n+=1;return{columnHeadersCount:n}}function dF(){if(this.hot.isListening()){const e=this.hot.getSelectedRangeLast();if(e){const{row:t,col:n}=e.highlight,r=this.hot.getCell(t,n,!0);r&&wg(r)}}}function pF(){if(this.hot.isListening()){const e=this.hot.getSelectedRangeLast();if(e){const{row:t,col:n}=e.highlight,r=this.hot.getCell(t,n,!0);null!=r&&r.hasAttribute("contenteditable")&&yg(r)}}}function gF(e){var t;e.items.push({name:"---------"},(t=this,{key:"copy",name(){return this.getTranslatedPhrase(Pb)},callback(){t.copyCellsOnly()},disabled(){if(0===this.countRows()||0===this.countCols())return!0;const e=this.getSelectedRangeLast();if(!e)return!0;if(e.isSingleHeader())return!0;const t=this.getSelected();return!t||t.length>1},hidden:!1})),Kk(eF,this)&&e.items.push(function(e){return{key:"copy_with_column_headers",name(){const e=this.getSelectedRangeLast(),t=e?ny(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(_b,t)},callback(){e.copyWithColumnHeaders()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e)return!0;if(e.isSingleHeader())return!0;const t=this.getSelected();return!t||t.length>1},hidden:!1}}(this)),Kk(tF,this)&&e.items.push(function(e){return{key:"copy_with_column_group_headers",name(){const e=this.getSelectedRangeLast(),t=e?ny(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(Lb,t)},callback(){e.copyWithAllColumnHeaders()},disabled(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;const e=this.getSelectedRangeLast();if(!e)return!0;if(e.isSingleHeader())return!0;const t=this.getSelected();return!t||t.length>1},hidden:!1}}(this)),Kk(nF,this)&&e.items.push(function(e){return{key:"copy_column_headers_only",name(){const e=this.getSelectedRangeLast(),t=e?ny(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(Hb,t)},callback(){e.copyColumnHeadersOnly()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e)return!0;if(e.isSingleHeader())return!0;const t=this.getSelected();return!t||t.length>1},hidden:!1}}(this)),e.items.push(function(e){return{key:"cut",name(){return this.getTranslatedPhrase(kb)},callback(){e.cut()},disabled(){if(0===this.countRows()||0===this.countCols())return!0;const e=this.getSelectedRangeLast();if(!e)return!0;if(e.isSingleHeader())return!0;const t=this.getSelected();return!t||t.length>1},hidden:!1}}(this))}function mF(e,t,n,r,i){Kk(aF,this)&&(i.value=!0),Xk(aF,this,!1)}function fF(){this.isEditorOpened()||this.hot.getSettings().fragmentSelection||this.setCopyableText()}function wF(){qk(lF,this,pF).call(this)}function yF(){qk(lF,this,dF).call(this)}function vF(){qk(lF,this,pF).call(this)}function CF(e,t){return`border_row${e}col${t}`}function SF(e){var t,n;(Gd(e.start)||Gd(e.left))&&(e.start=null!==(t=e.start)&&void 0!==t?t:e.left);(Gd(e.end)||Gd(e.right))&&(e.end=null!==(n=e.end)&&void 0!==n?n:e.right);return delete e.left,delete e.right,e}function RF(e){return Gd(e.start)&&(e.left=e.start),Gd(e.end)&&(e.right=e.end),e}function EF(e,t){return{id:CF(e,t),border:{width:1,color:"#000",cornerVisible:!1},row:e,col:t,top:{hide:!0},bottom:{hide:!0},start:{hide:!0},end:{hide:!0}}}function bF(e,t){let n=!1;return Vd(e.getSelectedRange(),(r=>{r.forAll(((r,i)=>{if(r<0||i<0)return;const o=e.getCellMeta(r,i).borders;if(o){if(!t)return n=!0,!1;if(!pm(o[t],"hide")||!1===o[t].hide)return n=!0,!1}}))})),n}function TF(e){return`<span class="selected">${String.fromCharCode(10003)}</span>${e}`}const NF=new Map([["left","start"],["right","end"]]);function AF(e){return{key:"borders:bottom",name(){let e=this.getTranslatedPhrase(nT);return bF(this,"bottom")&&(e=TF(e)),e},callback(t,n){const r=bF(this,"bottom");e.prepareBorder(n,"bottom",r)}}}function MF(e){const t=e.hot.isRtl()?"end":"start";return{key:"borders:left",name(){let e=this.getTranslatedPhrase(rT);return bF(this,t)&&(e=TF(e)),e},callback(n,r){const i=bF(this,t);e.prepareBorder(r,t,i)}}}function IF(e){return{key:"borders:no_borders",name(){return this.getTranslatedPhrase(iT)},callback(t,n){e.prepareBorder(n,"noBorders")},disabled(){return!bF(this)}}}function OF(e){const t=e.hot.isRtl()?"start":"end";return{key:"borders:right",name(){let e=this.getTranslatedPhrase(tT);return bF(this,t)&&(e=TF(e)),e},callback(n,r){const i=bF(this,t);e.prepareBorder(r,t,i)}}}function xF(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function PF(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _F(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}const LF="customBorders";var HF=new WeakSet;class kF extends Hx{constructor(){super(...arguments),xF(this,HF),PF(this,"savedBorders",[])}static get PLUGIN_KEY(){return LF}static get PLUGIN_PRIORITY(){return 90}isEnabled(){return!!this.hot.getSettings()[LF]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",(e=>_F(HF,this,FF).call(this,e))),this.addHook("init",(()=>_F(HF,this,DF).call(this))),super.enablePlugin())}disablePlugin(){this.hideBorders(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),super.updatePlugin()}setBorders(e,t){let n=["top","bottom","start","end"],r=null;t&&(this.checkSettingsCohesion([t]),n=Object.keys(t),r=SF(t));const i=QN(qN(e),{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)});Vd(e,(e=>{i(e).forAll(((e,t)=>{Vd(n,(n=>{var i,o;this.prepareBorderFromCustomAdded(e,t,r,(i=n,null!==(o=NF.get(i))&&void 0!==o?o:i))}))}))})),this.hot.view.render()}getBorders(e){if(!Array.isArray(e))return this.savedBorders;const t=QN(qN(e),{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)}),n=[];return Vd(e,(e=>{t(e).forAll(((e,t)=>{Vd(this.savedBorders,(r=>{r.row===e&&r.col===t&&n.push(RF(r))}))}))})),n}clearBorders(e){e?this.setBorders(e):(Vd(this.savedBorders,(e=>{this.clearBordersFromSelectionSettings(e.id),this.clearNullCellRange(),this.hot.removeCellMeta(e.row,e.col,"borders")})),this.savedBorders.length=0)}insertBorderIntoSettings(e,t){this.checkSavedBorders(e)||this.savedBorders.push(e);const n=this.hot._createCellRange(this.hot._createCellCoords(e.row,e.col));this.checkCustomSelections(e,n,t)||this.hot.selection.highlight.addCustomSelection({border:e,visualCellRange:n})}prepareBorderFromCustomAdded(e,t,n,r){const i=this.hot.countRows(),o=this.hot.countCols();if(e>=i||t>=o)return;let s=EF(e,t);var a,l;n&&(a=s,pm(l=n,"border")&&l.border&&(a.border=l.border),pm(l,"top")&&Gd(l.top)&&(l.top?(am(l.top)||(l.top={width:1,color:"#000"}),a.top=l.top):(l.top={hide:!0},a.top=l.top)),pm(l,"bottom")&&Gd(l.bottom)&&(l.bottom?(am(l.bottom)||(l.bottom={width:1,color:"#000"}),a.bottom=l.bottom):(l.bottom={hide:!0},a.bottom=l.bottom)),pm(l,"start")&&Gd(l.start)&&(l.start?(am(l.start)||(l.start={width:1,color:"#000"}),a.start=l.start):(l.start={hide:!0},a.start=l.start)),pm(l,"end")&&Gd(l.end)&&(l.end?(am(l.end)||(l.end={width:1,color:"#000"}),a.end=l.end):(l.end={hide:!0},a.end=l.end)),s=a,Vd(this.hot.selection.highlight.customSelections,(e=>{if(s.id===e.settings.id)return Object.assign(e.settings,n),s.id=e.settings.id,s.top=e.settings.top,s.bottom=e.settings.bottom,s.start=e.settings.start,s.end=e.settings.end,!1}))),this.hot.setCellMeta(e,t,"borders",RF(s)),this.insertBorderIntoSettings(s,r)}prepareBorderFromCustomAddedRange(e,t){const n=Math.min(e.to.row,this.hot.countRows()-1),r=Math.min(e.to.col,this.hot.countCols()-1);Jw(e.from.row,n,(n=>{Jw(e.from.col,r,(r=>{const i=EF(n,r);let o=0;n===e.from.row&&pm(t,"top")&&(o+=1,i.top=t.top),n===e.to.row&&pm(t,"bottom")&&(o+=1,i.bottom=t.bottom),r===e.from.col&&pm(t,"start")&&(o+=1,i.start=t.start),r===e.to.col&&pm(t,"end")&&(o+=1,i.end=t.end),o>0&&(this.hot.setCellMeta(n,r,"borders",RF(i)),this.insertBorderIntoSettings(i))}))}))}removeAllBorders(e,t){const n=CF(e,t);this.spliceBorder(n),this.clearBordersFromSelectionSettings(n),this.clearNullCellRange(),this.hot.removeCellMeta(e,t,"borders")}setBorder(e,t,n,r){let i=this.hot.getCellMeta(e,t).borders;if(i=i&&void 0!==i.border?SF(i):EF(e,t),r){i[n]={hide:!0};if(4===this.countHide(i))this.removeAllBorders(e,t);else{this.checkCustomSelectionsFromContextMenu(i,n,r)||this.insertBorderIntoSettings(i),this.hot.setCellMeta(e,t,"borders",RF(i))}}else{i[n]={width:1,color:"#000"};this.checkCustomSelectionsFromContextMenu(i,n,r)||this.insertBorderIntoSettings(i),this.hot.setCellMeta(e,t,"borders",RF(i))}}prepareBorder(e,t,n){Vd(e,(e=>{let{start:r,end:i}=e;if(r.row===i.row&&r.col===i.col)"noBorders"===t?this.removeAllBorders(r.row,r.col):this.setBorder(r.row,r.col,t,n);else switch(t){case"noBorders":Jw(r.col,i.col,(e=>{Jw(r.row,i.row,(t=>{this.removeAllBorders(t,e)}))}));break;case"top":Jw(r.col,i.col,(e=>{this.setBorder(r.row,e,t,n)}));break;case"bottom":Jw(r.col,i.col,(e=>{this.setBorder(i.row,e,t,n)}));break;case"start":Jw(r.row,i.row,(e=>{this.setBorder(e,r.col,t,n)}));break;case"end":Jw(r.row,i.row,(e=>{this.setBorder(e,i.col,t,n)}))}}))}createCustomBorders(e){Vd(e,(e=>{const t=SF(e);e.range?this.prepareBorderFromCustomAddedRange(e.range,t):this.prepareBorderFromCustomAdded(e.row,e.col,t)}))}countHide(e){const{top:t,bottom:n,start:r,end:i}=e;return kd([t,n,r,i],((e,t)=>{let n=e;return t&&t.hide&&(n+=1),n}),0)}clearBordersFromSelectionSettings(e){const t=Dd(this.hot.selection.highlight.customSelections,(e=>e.settings.id)).indexOf(e);t>-1&&this.hot.selection.highlight.customSelections[t].clear()}clearNullCellRange(){Vd(this.hot.selection.highlight.customSelections,((e,t)=>{if(null===e.cellRange)return this.hot.selection.highlight.customSelections[t].destroy(),this.hot.selection.highlight.customSelections.splice(t,1),!1}))}hideBorders(){Vd(this.savedBorders,(e=>{this.clearBordersFromSelectionSettings(e.id),this.clearNullCellRange()}))}spliceBorder(e){const t=Dd(this.savedBorders,(e=>e.id)).indexOf(e);t>-1&&this.savedBorders.splice(t,1)}checkSavedBorders(e){let t=!1;return 4===this.countHide(e)?(this.spliceBorder(e.id),t=!0):Vd(this.savedBorders,((n,r)=>{if(e.id===n.id)return this.savedBorders[r]=e,t=!0,!1})),t}checkCustomSelectionsFromContextMenu(e,t,n){let r=!1;return Vd(this.hot.selection.highlight.customSelections,(i=>{if(e.id===i.settings.id){return Vd(this.hot.view._wt.selectionManager.getBorderInstances(i),(e=>{e.toggleHiddenClass(t,n)})),r=!0,!1}})),r}checkCustomSelections(e,t,n){const r=this.countHide(e);let i=!1;return 4===r?(this.removeAllBorders(e.row,e.col),i=!0):Vd(this.hot.selection.highlight.customSelections,(r=>{if(e.id===r.settings.id){if(r.visualCellRange=t,r.commit(),n){Vd(this.hot.view._wt.selectionManager.getBorderInstances(r),(t=>{t.changeBorderStyle(n,e)}))}return i=!0,!1}})),i}changeBorderSettings(){const e=this.hot.getSettings()[LF];if(Array.isArray(e)){const t=rm(e);this.checkSettingsCohesion(t),t.length||(this.savedBorders=t),this.createCustomBorders(t)}else void 0!==e&&this.createCustomBorders(this.savedBorders)}checkSettingsCohesion(e){const t=e.some((e=>Gd(e.left)||Gd(e.right)));const n=function(e){return e.some((e=>Gd(e.start)||Gd(e.end)))}(e);if(t&&n)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&t)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".')}destroy(){super.destroy()}}function FF(e){var t;this.hot.getSettings()[LF]&&e.items.push({name:"---------"},{key:"borders",name(){return this.getTranslatedPhrase(Jb)},disabled(){const e=this.getSelectedRangeLast();return!e||(!!e.isSingleHeader()||this.selection.isSelectedByCorner())},submenu:{items:[(t=this,{key:"borders:top",name(){let e=this.getTranslatedPhrase(eT);return bF(this,"top")&&(e=TF(e)),e},callback(e,n){const r=bF(this,"top");t.prepareBorder(n,"top",r)}}),OF(this),AF(this),MF(this),IF(this)]}})}function DF(){this.changeBorderSettings()}function VF(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function UF(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function BF(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}const WF="dragToScroll";var jF=new WeakSet;class GF extends Hx{constructor(){super(...arguments),VF(this,jF),UF(this,"boundaries",null),UF(this,"callback",null),UF(this,"listening",!1)}static get PLUGIN_KEY(){return WF}static get PLUGIN_PRIORITY(){return 100}isEnabled(){return!!this.hot.getSettings()[WF]}enablePlugin(){this.enabled||(this.addHook("afterOnCellMouseDown",(e=>BF(jF,this,zF).call(this,e))),this.addHook("afterOnCellCornerMouseDown",(e=>BF(jF,this,zF).call(this,e))),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.unregisterEvents(),super.disablePlugin()}setBoundaries(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{left:0,right:this.hot.rootWindow.innerWidth,top:0,bottom:this.hot.rootWindow.innerHeight};this.boundaries=e}setCallback(e){this.callback=e}check(e,t){let n=0,r=0;t<this.boundaries.top?r=t-this.boundaries.top:t>this.boundaries.bottom&&(r=t-this.boundaries.bottom),e<this.boundaries.left?n=e-this.boundaries.left:e>this.boundaries.right&&(n=e-this.boundaries.right),this.callback(n,r)}listen(){this.listening=!0}unlisten(){this.listening=!1}isListening(){return this.listening}registerEvents(){const{rootWindow:e}=this.hot;let t=e;for(;t;)this.eventManager.addEventListener(t.document,"contextmenu",(()=>this.unlisten())),this.eventManager.addEventListener(t.document,"mouseup",(()=>this.unlisten())),this.eventManager.addEventListener(t.document,"mousemove",(e=>this.onMouseMove(e))),t=Ip(t)}unregisterEvents(){this.eventManager.clear()}onMouseMove(e){this.isListening()&&this.check(e.clientX,e.clientY)}destroy(){super.destroy()}}function zF(e){if(Hm(e))return;const t=this.hot.view._wt.wtOverlays.topOverlay.mainTableScrollableElement;this.setBoundaries(t!==this.hot.rootWindow?t.getBoundingClientRect():void 0),this.setCallback(((e,n)=>{var r,i;const o=null!==(r=t.scrollLeft)&&void 0!==r?r:t.scrollX,s=null!==(i=t.scrollTop)&&void 0!==i?i:t.scrollY;t.scroll(o+50*Math.sign(e),s+20*Math.sign(n))})),this.listen()}function $F(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function YF(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function KF(e,t,n){return e.set(XF(e,t),n),n}function XF(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}Rf.getSingleton().register("afterDropdownMenuDefaultOptions"),Rf.getSingleton().register("beforeDropdownMenuShow"),Rf.getSingleton().register("afterDropdownMenuShow"),Rf.getSingleton().register("afterDropdownMenuHide"),Rf.getSingleton().register("afterDropdownMenuExecute");const qF="dropdownMenu",QF="changeType",ZF=qF;var JF=new WeakMap,eD=new WeakSet;class tD extends Hx{static get PLUGIN_KEY(){return qF}static get PLUGIN_PRIORITY(){return 230}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[GL,zL,BL,KL,BL,jL,BL,$L,BL,WL]}constructor(e){var t,n;super(e),$F(t=this,n=eD),n.add(t),YF(this,"commandExecutor",new kH(this.hot)),YF(this,"itemsFactory",null),YF(this,"menu",null),function(e,t,n){$F(e,t),t.set(e,n)}(this,JF,!1),this.hot.addHook("afterGetColHeader",((e,t)=>XF(eD,this,iD).call(this,e,t)))}isEnabled(){return this.hot.getSettings()[qF]}enablePlugin(){var e=this;if(this.enabled)return;this.itemsFactory=new DH(this.hot,tD.DEFAULT_ITEMS),this.addHook("beforeOnCellMouseDown",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return XF(eD,e,uD).call(e,...n)})),this.addHook("beforeViewportScrollHorizontally",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return XF(eD,e,hD).call(e,...n)}));const t=this.hot.getSettings()[qF],n={items:this.itemsFactory.getItems(t)};this.registerEvents(),"function"==typeof t.callback&&this.commandExecutor.setCommonCallback(t.callback),this.registerShortcuts(),super.enablePlugin(),this.callOnPluginsReady((()=>{this.hot.runHooks("afterDropdownMenuDefaultOptions",n),this.itemsFactory.setPredefinedItems(n.items);const r=this.itemsFactory.getItems(t);this.menu&&this.menu.destroy(),this.menu=new mk(this.hot,{className:"htDropdownMenu",keepInViewport:!0,container:t.uiContainer||this.hot.rootDocument.body}),this.hot.runHooks("beforeDropdownMenuSetItems",r),this.menu.setMenuItems(r),this.menu.addLocalHook("beforeOpen",(()=>XF(eD,this,oD).call(this))),this.menu.addLocalHook("afterOpen",(()=>XF(eD,this,sD).call(this))),this.menu.addLocalHook("afterSubmenuOpen",(e=>XF(eD,this,aD).call(this,e))),this.menu.addLocalHook("afterClose",(()=>XF(eD,this,lD).call(this))),this.menu.addLocalHook("executeCommand",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.executeCommand.call(e,...n)})),Vd(r,(e=>this.commandExecutor.registerCommand(e.key,e)))}))}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&this.menu.destroy(),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=()=>{const{highlight:e}=this.hot.getSelectedRangeLast();if((e.isHeader()&&-1===e.row||e.isCell())&&e.col>=0){this.hot.selectColumns(e.col,e.col,-1);const{from:t}=this.hot.getSelectedRangeLast(),n=UL(this.menu.container,this.hot.rootDocument),r=this.hot.getCell(-1,t.col,!0).querySelector(`.${QF}`),i=r.getBoundingClientRect();this.open({left:i.left+n.left,top:i.top+r.offsetHeight+n.top},{left:i.width,right:0,above:0,below:3}),this.menu.getNavigator().toFirstItem()}};this.hot.getShortcutManager().getContext("grid").addShortcuts([{keys:[["Shift","Alt","ArrowDown"],["Control/Meta","Enter"]],callback:e,runOnlyIf:()=>{var e;const t=null===(e=this.hot.getSelectedRangeLast())||void 0===e?void 0:e.highlight;return t&&this.hot.selection.isCellVisible(t)&&t.isHeader()&&!this.menu.isOpened()},captureCtrl:!0,group:ZF},{keys:[["Shift","Alt","ArrowDown"]],callback:e,runOnlyIf:()=>{var e;const t=null===(e=this.hot.getSelectedRangeLast())||void 0===e?void 0:e.highlight;return t&&this.hot.selection.isCellVisible(t)&&t.isCell()&&!this.menu.isOpened()},group:ZF}])}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(ZF)}registerEvents(){this.eventManager.addEventListener(this.hot.rootElement,"click",(e=>XF(eD,this,rD).call(this,e)))}open(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{above:0,below:0,left:0,right:0};null!==(t=this.menu)&&void 0!==t&&t.isOpened()||(this.menu.open(),hm(n,((e,t)=>{this.menu.setOffset(t,e)})),this.menu.setPosition(e))}close(){var e;null===(e=this.menu)||void 0===e||e.close()}executeCommand(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];this.commandExecutor.execute(e,...n)}setListening(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.menu.isOpened()&&(e?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function nD(e){e.getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Control/Meta","A"]],callback:()=>!1}])}function rD(e){if(kp(e.target,QF)){const t=UL(this.menu.container,this.hot.rootDocument),n=e.target.getBoundingClientRect();e.stopPropagation(),KF(JF,this,!1),this.open({left:n.left+t.left,top:n.top+e.target.offsetHeight+t.top},{left:n.width,right:0,above:0,below:3})}}function iD(e,t){const n=t.parentNode;if(!n)return;const r=n.parentNode.childNodes,i=Array.prototype.indexOf.call(r,n);if(e<0||i!==r.length-1)return;const o=t.querySelector(`.${QF}`);if(this.enabled&&o)return;if(!this.enabled)return void(o&&o.parentNode.removeChild(o));const s=this.hot.rootDocument.createElement("button");s.className=QF,s.type="button",s.tabIndex=-1,this.hot.getSettings().ariaTags&&(Vp(s,[mp(),gp(" ")]),Vp(t,[fp("menu")])),s.onclick=function(){return!1},t.firstChild.insertBefore(s,t.firstChild.firstChild)}function oD(){this.hot.runHooks("beforeDropdownMenuShow",this)}function sD(){this.hot.runHooks("afterDropdownMenuShow",this),XF(eD,this,nD).call(this,this.menu)}function aD(e){XF(eD,this,nD).call(this,e)}function lD(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}function hD(e){return n=this,(t=JF).get(XF(t,n))?null:e;var t,n}function uD(e){kp(e.target,QF)&&KF(JF,this,!0)}function cD(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}tD.SEPARATOR={name:BL};const dD=class{constructor(e){cD(this,"hot",void 0),cD(this,"options",{}),this.hot=e}setOptions(e){this.options=e}getData(){const{startRow:e,startCol:t,endRow:n,endCol:r}=this._getDataRange(),i=this.options,o=[];return Jw(e,n,(e=>{const n=[];!i.exportHiddenRows&&this._isHiddenRow(e)||(Jw(t,r,(t=>{!i.exportHiddenColumns&&this._isHiddenColumn(t)||n.push(this.hot.getDataAtCell(e,t))})),o.push(n))})),o}getRowHeaders(){const e=[];if(this.options.rowHeaders){const{startRow:t,endRow:n}=this._getDataRange(),r=this.hot.getRowHeader();Jw(t,n,(t=>{!this.options.exportHiddenRows&&this._isHiddenRow(t)||e.push(r[t])}))}return e}getColumnHeaders(){const e=[];if(this.options.columnHeaders){const{startCol:t,endCol:n}=this._getDataRange(),r=this.hot.getColHeader();Jw(t,n,(t=>{!this.options.exportHiddenColumns&&this._isHiddenColumn(t)||e.push(r[t])}))}return e}_getDataRange(){const e=this.hot.countCols()-1,t=this.hot.countRows()-1;let[n=0,r=0,i=t,o=e]=this.options.range;return n=Math.max(n,0),r=Math.max(r,0),i=Math.min(i,t),o=Math.min(o,e),{startRow:n,startCol:r,endRow:i,endCol:o}}_isHiddenRow(e){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(e))}_isHiddenColumn(e){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(e))}};function pD(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class gD{static get DEFAULT_OPTIONS(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}constructor(e,t){pD(this,"dataProvider",void 0),pD(this,"options",void 0),this.dataProvider=e,this.options=this._mergeOptions(t),this.dataProvider.setOptions(this.options)}_mergeOptions(e){let t=im(this.constructor.DEFAULT_OPTIONS);const n=new Date;return t=tm(im(gD.DEFAULT_OPTIONS),t),t=tm(t,e),t.filename=lp(t.filename,{YYYY:n.getFullYear(),MM:`${n.getMonth()+1}`.padStart(2,"0"),DD:`${n.getDate()}`.padStart(2,"0")}),t}}const mD=gD,fD=String.fromCharCode(13),wD=String.fromCharCode(34),yD=String.fromCharCode(10);const vD=class extends mD{static get DEFAULT_OPTIONS(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:"\r\n"}}export(){const e=this.options,t=this.dataProvider.getData();let n=this.dataProvider.getColumnHeaders();const r=n.length>0,i=this.dataProvider.getRowHeaders(),o=i.length>0;let s=e.bom?String.fromCharCode(65279):"";return r&&(n=Dd(n,(e=>this._escapeCell(e,!0))),o&&(s+=e.columnDelimiter),s+=n.join(e.columnDelimiter),s+=e.rowDelimiter),Vd(t,((t,n)=>{n>0&&(s+=e.rowDelimiter),o&&(s+=this._escapeCell(i[n])+e.columnDelimiter),s+=t.map((e=>this._escapeCell(e))).join(e.columnDelimiter)})),s}_escapeCell(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=jd(e);return""!==n&&(t||n.indexOf(fD)>=0||n.indexOf(wD)>=0||n.indexOf(yD)>=0||n.indexOf(this.options.columnDelimiter)>=0)&&(n=n.replace(new RegExp('"',"g"),'""'),n=`"${n}"`),n}},CD={csv:vD};class SD extends Hx{static get PLUGIN_KEY(){return"exportFile"}static get PLUGIN_PRIORITY(){return 240}isEnabled(){return!0}exportAsString(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._createTypeFormatter(e,t).export()}exportAsBlob(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._createBlob(this._createTypeFormatter(e,t))}downloadFile(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{rootDocument:n,rootWindow:r}=this.hot,i=this._createTypeFormatter(e,t),o=this._createBlob(i),s=r.URL||r.webkitURL,a=n.createElement("a"),l=`${i.options.filename}.${i.options.fileExtension}`;if(void 0!==a.download){const e=s.createObjectURL(o);a.style.display="none",a.setAttribute("href",e),a.setAttribute("download",l),n.body.appendChild(a),a.dispatchEvent(new MouseEvent("click")),n.body.removeChild(a),setTimeout((()=>{s.revokeObjectURL(e)}),100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(o,l)}_createTypeFormatter(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!CD[e])throw new Error(`Export format type "${e}" is not supported.`);return function(e,t,n){return"function"==typeof CD[e]?new CD[e](t,n):null}(e,new dD(this.hot),t)}_createBlob(e){let t=null;return"undefined"!=typeof Blob&&(t=new Blob([e.export()],{type:`${e.options.mimeType};charset=${e.options.encoding}`})),t}}function RD(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class ED{constructor(e,t){let{id:n,stateless:r=!0}=t;RD(this,"hot",void 0),RD(this,"id",void 0),RD(this,"elements",[]),RD(this,"hidden",!1),RD(this,"stateId",""),RD(this,"state",void 0),this.hot=e,this.id=n,this.stateId=`Filters.component.${this.id}`,this.state=r?null:this.hot.columnIndexMapper.registerMap(this.stateId,new jE)}getElements(){return this.elements}reset(){Vd(this.elements,(e=>e.reset()))}hide(){this.hidden=!0}show(){this.hidden=!1}isHidden(){return null===this.hot||this.hidden}restoreState(e){this.state&&this.setState(this.state.getValueAtIndex(e))}setState(){throw new Error("The state setting logic is not implemented")}saveState(e){this.state&&this.state.setValueAtIndex(e,this.getState())}getState(){throw new Error("The state gathering logic is not implemented")}destroy(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),Vd(this.elements,(e=>e.destroy())),this.state=null,this.elements=null,this.hot=null}}om(ED,yS);const bD={};function TD(e,t){if(!bD[e])throw Error(`Filter condition "${e}" does not exist.`);const{condition:n,descriptor:r}=bD[e];let i=t;return r.inputValuesDecorator&&(i=r.inputValuesDecorator(i)),function(e){return n.apply(e.meta.instance,[].concat([e],[i]))}}function ND(e){if(!bD[e])throw Error(`Filter condition "${e}" does not exist.`);return bD[e].descriptor}function AD(e,t,n){n.key=e,bD[e]={condition:t,descriptor:n}}const MD="none";AD(MD,(function(){return!0}),{name:pT,inputsCount:0,showOperators:!1});const ID="empty";AD(ID,(function(e){return $d(e.value)}),{name:gT,inputsCount:0,showOperators:!0});const OD="not_empty";AD(OD,(function(e,t){return!TD(ID,t)(e)}),{name:mT,inputsCount:0,showOperators:!0});const xD="eq";AD(xD,(function(e,t){let[n]=t;return jd(e.value).toLocaleLowerCase(e.meta.locale)===jd(n)}),{name:fT,inputsCount:1,showOperators:!0});const PD="neq";AD(PD,(function(e,t){return!TD(xD,t)(e)}),{name:wT,inputsCount:1,showOperators:!0});AD("gt",(function(e,t){let[n]=t,r=n;return"numeric"===e.meta.type&&(r=parseFloat(r,10)),e.value>r}),{name:ET,inputsCount:1,showOperators:!0});AD("gte",(function(e,t){let[n]=t,r=n;return"numeric"===e.meta.type&&(r=parseFloat(r,10)),e.value>=r}),{name:bT,inputsCount:1,showOperators:!0});AD("lt",(function(e,t){let[n]=t,r=n;return"numeric"===e.meta.type&&(r=parseFloat(r,10)),e.value<r}),{name:TT,inputsCount:1,showOperators:!0});AD("lte",(function(e,t){let[n]=t,r=n;return"numeric"===e.meta.type&&(r=parseFloat(r,10)),e.value<=r}),{name:NT,inputsCount:1,showOperators:!0});const _D="date_after";AD(_D,(function(e,t){let[n]=t;const r=M(e.value,e.meta.dateFormat),i=M(n,e.meta.dateFormat);return!(!r.isValid()||!i.isValid())&&r.diff(i)>=0}),{name:IT,inputsCount:1,showOperators:!0});const LD="date_before";AD(LD,(function(e,t){let[n]=t;const r=M(e.value,e.meta.dateFormat),i=M(n,e.meta.dateFormat);return!(!r.isValid()||!i.isValid())&&r.diff(i)<=0}),{name:OT,inputsCount:1,showOperators:!0});const HD="between";AD(HD,(function(e,t){let[n,r]=t,i=n,o=r;if("numeric"===e.meta.type){const e=parseFloat(i,10),t=parseFloat(o,10);i=Math.min(e,t),o=Math.max(e,t)}else if("date"===e.meta.type){const t=TD(LD,[o]),n=TD(_D,[i]);return t(e)&&n(e)}return e.value>=i&&e.value<=o}),{name:AT,inputsCount:2,showOperators:!0});const kD="not_between";AD(kD,(function(e,t){return!TD(HD,t)(e)}),{name:MT,inputsCount:2,showOperators:!0});const FD="begins_with";AD(FD,(function(e,t){let[n]=t;return jd(e.value).toLocaleLowerCase(e.meta.locale).startsWith(jd(n))}),{name:yT,inputsCount:1,showOperators:!0});const DD="ends_with";AD(DD,(function(e,t){let[n]=t;return jd(e.value).toLocaleLowerCase(e.meta.locale).endsWith(jd(n))}),{name:vT,inputsCount:1,showOperators:!0});const VD="contains";AD(VD,(function(e,t){let[n]=t;return jd(e.value).toLocaleLowerCase(e.meta.locale).indexOf(jd(n))>=0}),{name:CT,inputsCount:1,showOperators:!0});const UD="not_contains";AD(UD,(function(e,t){return!TD(VD,t)(e)}),{name:ST,inputsCount:1,showOperators:!0});const BD="date_tomorrow";AD(BD,(function(e){const t=M(e.value,e.meta.dateFormat);return!!t.isValid()&&t.isSame(M().subtract(-1,"days").startOf("day"),"d")}),{name:PT,inputsCount:0});const WD="date_today";AD(WD,(function(e){const t=M(e.value,e.meta.dateFormat);return!!t.isValid()&&t.isSame(M().startOf("day"),"d")}),{name:xT,inputsCount:0});const jD="date_yesterday";function GD(e,t){let n=e;return""===n&&(n=`(${t})`),n}function zD(e){const t=new Set(e);return function(e){return t.has(e)}}function $D(e){return null==e?"":e}function YD(e){return Array.from(new Set(e)).map((e=>$D(e))).sort(((e,t)=>"number"==typeof e&&"number"==typeof t?e-t:e===t?0:e>t?1:-1))}function KD(e,t,n,r){const i=[],o=e===t;let s;return o||(s=zD(t)),e.forEach((e=>{let t=!1;(o||s(e))&&(t=!0);const a={checked:t,value:e,visualValue:GD(e,n)};r&&r(a),i.push(a)})),i}AD(jD,(function(e){const t=M(e.value,e.meta.dateFormat);return!!t.isValid()&&t.isSame(M().subtract(1,"days").startOf("day"),"d")}),{name:_T,inputsCount:0}),function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};wm||(wm="object"==typeof Intl?new Intl.Collator(e,t).compare:"function"==typeof String.prototype.localeCompare?(e,t)=>`${e}`.localeCompare(t):(e,t)=>e===t?0:e>t?-1:1)}();const XD="by_value";AD(XD,(function(e,t){let[n]=t;return n(e.value)}),{name:"By value",inputsCount:0,inputValuesDecorator(e){let[t]=e;return[zD(t)]},showOperators:!1});const qD={};function QD(e){return qD[e].name}function ZD(e,t,n){qD[e]={name:t,func:n}}const JD="conjunction";ZD(JD,kT,(function(e,t){return e.every((e=>e.func(t)))}));const eV="disjunction";ZD(eV,FT,(function(e,t){return e.some((e=>e.func(t)))}));const tV="disjunctionWithExtraCondition";ZD(tV,FT,(function(e,t){if(e.length<3)throw Error("Operation doesn't work on less then three conditions.");return e.slice(0,e.length-1).some((e=>e.func(t)))&&e[e.length-1].func(t)}));const nV="text",rV={numeric:[MD,BL,ID,OD,BL,xD,PD,BL,"gt","gte","lt","lte",HD,kD],[nV]:[MD,BL,ID,OD,BL,xD,PD,BL,FD,DD,BL,VD,UD],date:[MD,BL,ID,OD,BL,xD,PD,BL,LD,_D,HD,BL,BD,WD,jD]};function iV(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const oV="built",sV="building",aV=["click","input","keydown","keypress","keyup","focus","blur","change"];let lV=class e{static get DEFAULTS(){return im({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}constructor(t,n){iV(this,"hot",void 0),iV(this,"eventManager",new Ff(this)),iV(this,"options",void 0),iV(this,"_element",void 0),iV(this,"buildState",void 0),this.hot=t,this.options=tm(e.DEFAULTS,n),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName)}setValue(e){this.options.value=e,this.update()}getValue(){return this.options.value}get element(){return this.buildState===sV?this._element:this.buildState===oV?(this.update(),this._element):(this.buildState=sV,this.build(),this.buildState=oV,this._element)}isBuilt(){return this.buildState===oV}translateIfPossible(e){return"string"==typeof e&&e.startsWith(cT)?this.hot.getTranslatedPhrase(e):e}build(){const e=(e,t)=>{this.eventManager.addEventListener(e,t,(e=>this.runLocalHooks(t,e,this)))};if(this.buildState||(this.buildState=sV),this._element.setAttribute("data-hot-input",!0),void 0!==this.options.tabIndex&&this._element.setAttribute("tabindex",this.options.tabIndex),void 0!==this.options.role&&this._element.setAttribute("role",this.options.role),this.options.className&&Fp(this._element,this.options.className),this.options.children.length)Vd(this.options.children,(e=>this._element.appendChild(e.element)));else if(this.options.wrapIt){const t=this.hot.rootDocument.createElement(this.options.tagName);t.setAttribute("data-hot-input",!0),hm(this.options,((e,n)=>{void 0!==t[n]&&"className"!==n&&"tagName"!==n&&"children"!==n&&(t[n]=this.translateIfPossible(e))})),this._element.appendChild(t),Vd(aV,(n=>e(t,n)))}else Vd(aV,(t=>e(this._element,t)))}update(){}reset(){this.options.value="",this.update()}show(){this.element.style.display=""}hide(){this.element.style.display="none"}focus(){}destroy(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}};function hV(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function uV(e,t){return e.get(cV(e,t))}function cV(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}om(lV,yS);var dV=new WeakMap,pV=new WeakSet;class gV extends lV{static get DEFAULTS(){return im({placeholder:"",type:"text",tagName:"input",tabIndex:-1})}constructor(e,t){var n,r;super(e,tm(gV.DEFAULTS,t)),hV(n=this,r=pV),r.add(n),function(e,t,n){hV(e,t),t.set(e,n)}(this,dV,void 0),this.registerHooks()}registerHooks(){this.addLocalHook("keyup",(e=>cV(pV,this,mV).call(this,e)))}build(){super.build();const e=this.hot.rootDocument.createElement("div");var t,n,r;t=dV,n=this,r=this._element.firstChild,t.set(cV(t,n),r),Fp(this._element,"htUIInput"),Fp(e,"htUIInputIcon"),this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(uV(dV,this).type=this.options.type,uV(dV,this).placeholder=this.translateIfPossible(this.options.placeholder),uV(dV,this).value=this.translateIfPossible(this.options.value))}focus(){this.isBuilt()&&uV(dV,this).focus()}}function mV(e){this.options.value=e.target.value}function fV(e,t,n){wV(e,t),t.set(e,n)}function wV(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function yV(e,t,n){return e.set(CV(e,t),n),n}function vV(e,t){return e.get(CV(e,t))}function CV(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var SV=new WeakMap,RV=new WeakMap,EV=new WeakMap,bV=new WeakMap,TV=new WeakMap,NV=new WeakSet;class AV extends lV{static get DEFAULTS(){return im({className:"htUISelect",wrapIt:!1,tabIndex:-1})}constructor(e,t){var n,r;super(e,tm(AV.DEFAULTS,t)),wV(n=this,r=NV),r.add(n),fV(this,SV,null),fV(this,RV,[]),fV(this,EV,void 0),fV(this,bV,void 0),fV(this,TV,void 0),this.registerHooks()}getMenu(){return vV(SV,this)}registerHooks(){this.addLocalHook("click",(()=>CV(NV,this,OV).call(this)))}setItems(e){yV(RV,this,this.translateNames(e)),vV(SV,this)&&vV(SV,this).setMenuItems(vV(RV,this))}translateNames(e){return Vd(e,(e=>{e.name=this.translateIfPossible(e.name)})),e}build(){super.build(),yV(SV,this,new mk(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer})),vV(SV,this).setMenuItems(vV(RV,this));const e=new lV(this.hot,{className:"htUISelectCaption"}),t=new lV(this.hot,{className:"htUISelectDropdown"});yV(EV,this,e),yV(bV,this,e.element),yV(TV,this,t),this.hot.getSettings().ariaTags&&(Vp(t.element,[mp()]),Vp(this._element,[["role","listbox"]])),Vd([e,t],(e=>this._element.appendChild(e.element))),vV(SV,this).addLocalHook("select",(e=>CV(NV,this,MV).call(this,e))),vV(SV,this).addLocalHook("afterClose",(()=>CV(NV,this,IV).call(this))),this.update()}update(){if(!this.isBuilt())return;let e;e=this.options.value?this.options.value.name:vV(SV,this).hot.getTranslatedPhrase(pT),vV(bV,this).textContent=e,super.update()}openOptions(){const e=this.element.getBoundingClientRect();vV(SV,this)&&(vV(SV,this).open(),vV(SV,this).setPosition({left:this.hot.isLtr()?e.left-5:e.left-31,top:e.top-1,width:e.width,height:e.height}),vV(SV,this).getNavigator().toFirstItem(),vV(SV,this).getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:e=>{this.closeOptions(),this.runLocalHooks("tabKeydown",e)}},{keys:[["Control/Meta","A"]],callback:()=>!1}]))}closeOptions(){vV(SV,this)&&vV(SV,this).close()}focus(){this.isBuilt()&&this.element.focus()}destroy(){vV(SV,this)&&(vV(SV,this).destroy(),yV(SV,this,null)),vV(EV,this)&&vV(EV,this).destroy(),vV(TV,this)&&vV(TV,this).destroy(),super.destroy()}}function MV(e){e.name!==BL&&(this.options.value=e,this.update(),this.runLocalHooks("select",this.options.value))}function IV(){this.runLocalHooks("afterClose")}function OV(){this.openOptions()}function xV(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function PV(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _V(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var LV=new WeakSet;class HV extends ED{constructor(e,t){super(e,{id:t.id,stateless:!1}),xV(this,LV),PV(this,"name",""),PV(this,"addSeparator",!1),this.name=t.name,this.addSeparator=t.addSeparator,this.elements.push(new AV(this.hot,{menuContainer:t.menuContainer})),this.elements.push(new gV(this.hot,{placeholder:GT})),this.elements.push(new gV(this.hot,{placeholder:zT})),this.registerHooks()}registerHooks(){this.getSelectElement().addLocalHook("select",(e=>_V(LV,this,kV).call(this,e))).addLocalHook("afterClose",(()=>this.runLocalHooks("afterClose"))).addLocalHook("tabKeydown",(e=>this.runLocalHooks("selectTabKeydown",e))),Vd(this.getInputElements(),(e=>{e.addLocalHook("keydown",(e=>_V(LV,this,FV).call(this,e)))}))}setState(e){if(this.reset(),!e)return;const t=im(e.command);t.name.startsWith(dT)&&(t.name=this.hot.getTranslatedPhrase(t.name)),this.getSelectElement().setValue(t),Vd(e.args,((e,n)=>{if(n>t.inputsCount-1)return!1;const r=this.getInputElement(n);r.setValue(e),r[t.inputsCount>n?"show":"hide"](),n||this.hot._registerTimeout((()=>r.focus()),10)}))}getState(){const e=this.getSelectElement().getValue()||ND(MD),t=[];return Vd(this.getInputElements(),((n,r)=>{e.inputsCount>r&&t.push(n.getValue())})),{command:e,args:t}}updateState(e,t){const n=ND(e?e.name:MD);this.state.setValueAtIndex(t,{command:n,args:e?e.args:[]}),e||Vd(this.getInputElements(),(e=>e.setValue(null)))}getSelectElement(){return this.elements.filter((e=>e instanceof AV))[0]}getInputElement(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.getInputElements()[e]}getInputElements(){return this.elements.filter((e=>e instanceof gV))}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,t,n,r,i,o)=>{Fp(t.parentNode,"htFiltersMenuCondition"),this.addSeparator&&Fp(t.parentNode,"border");const s=this.hot.rootDocument.createElement("div");return Fp(s,"htFiltersMenuLabel"),s.textContent=o,t.appendChild(s),t.parentElement.hasAttribute("ghost-table")||Vd(this.elements,(e=>t.appendChild(e.element))),t}}}reset(){const e=this.hot.getPlugin("filters").getSelectedColumn();let t=[ND(MD)];if(null!==e){const{visualIndex:n}=e;t=function(e){const t=[];let n=e;return rV[n]||(n=nV),Vd(rV[n],(e=>{let n;n=e===BL?{name:BL}:im(ND(e)),t.push(n)})),t}(this.hot.getDataType(0,n,this.hot.countRows(),n))}Vd(this.getInputElements(),(e=>e.hide())),this.getSelectElement().setItems(t),super.reset(),this.getSelectElement().setValue(t[0])}}function kV(e){Vd(this.getInputElements(),((t,n)=>{t[e.inputsCount>n?"show":"hide"](),0===n&&this.hot._registerTimeout((()=>t.focus()),10)})),this.runLocalHooks("change",e)}function FV(e){Pm(e.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),_m(e))}function DV(e,t,n){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,n)}function VV(e,t){return e.get(BV(e,t))}function UV(e,t,n){return e.set(BV(e,t),n),n}function BV(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var WV=new WeakMap,jV=new WeakMap;class GV extends lV{static get DEFAULTS(){return im({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}constructor(e,t){super(e,tm(GV.DEFAULTS,t)),DV(this,WV,void 0),DV(this,jV,void 0)}build(){super.build();const e=this.hot.rootDocument.createElement("label");e.textContent=this.translateIfPossible(this.options.label.textContent),e.htmlFor=this.translateIfPossible(this.options.label.htmlFor),UV(jV,this,e),UV(WV,this,this._element.firstChild),VV(WV,this).checked=this.options.checked,this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(VV(jV,this).textContent=this.translateIfPossible(this.options.label.textContent))}isChecked(){return!!this.isBuilt()&&VV(WV,this).checked}setChecked(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.isBuilt()&&(VV(WV,this).checked=e)}focus(){this.isBuilt()&&VV(WV,this).focus()}}function zV(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function $V(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var YV=new WeakSet;class KV extends ED{constructor(e,t){super(e,{id:t.id,stateless:!1}),zV(this,YV),$V(this,"name",""),this.name=t.name,this.buildOperatorsElement()}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,t)=>(Fp(t.parentNode,"htFiltersMenuOperators"),Vd(this.elements,(e=>t.appendChild(e.element))),t)}}buildOperatorsElement(){const e=[JD,eV];Vd(e,(t=>{const n=new GV(this.hot,{name:"operator",label:{htmlFor:t,textContent:QD(t)},value:t,checked:t===e[0],id:t});n.addLocalHook("change",(e=>function(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}(YV,this,XV).call(this,e))),this.elements.push(n)}))}setChecked(e){if(this.elements.length<e)throw Error(Wd`Radio button with index ${e} doesn't exist.`);Vd(this.elements,((t,n)=>{t.setChecked(n===e)}))}getActiveOperationId(){const e=this.elements.find((e=>e instanceof GV&&e.isChecked()));return e?e.getValue():JD}getState(){return this.getActiveOperationId()}setState(e){this.reset(),e&&this.getActiveOperationId()!==e&&Vd(this.elements,(t=>{t.setChecked(t.getValue()===e)}))}updateState(){let e=arguments.length>1?arguments[1]:void 0,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:JD;t===tV&&(t=eV),this.state.setValueAtIndex(e,t)}reset(){this.setChecked(0)}}function XV(e){this.setState(e.target.value)}function qV(e,t,n){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,n)}function QV(e,t){return e.get(ZV(e,t))}function ZV(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var JV=new WeakMap;class eU extends lV{static get DEFAULTS(){return im({href:"#",tagName:"a",tabIndex:-1,role:"button"})}constructor(e,t){super(e,tm(eU.DEFAULTS,t)),qV(this,JV,void 0)}build(){var e,t,n;super.build(),e=JV,t=this,n=this._element.firstChild,e.set(ZV(e,t),n)}update(){this.isBuilt()&&(QV(JV,this).textContent=this.translateIfPossible(this.options.textContent))}focus(){this.isBuilt()&&QV(JV,this).focus()}activate(){QV(JV,this).click()}}function tU(e,t,n){nU(e,t),t.set(e,n)}function nU(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function rU(e,t){return e.get(oU(e,t))}function iU(e,t,n){return e.set(oU(e,t),n),n}function oU(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}const sU="multipleSelect.itemBox";var aU=new WeakMap,lU=new WeakMap,hU=new WeakMap,uU=new WeakMap,cU=new WeakMap,dU=new WeakMap,pU=new WeakSet;class gU extends lV{static get DEFAULTS(){return im({className:"htUIMultipleSelect",value:[]})}constructor(e,t){var n,r;super(e,tm(gU.DEFAULTS,t)),nU(n=this,r=pU),r.add(n),tU(this,aU,[]),tU(this,lU,void 0),tU(this,hU,void 0),tU(this,uU,void 0),tU(this,cU,void 0),tU(this,dU,void 0),iU(uU,this,new gV(this.hot,{placeholder:jT,className:"htUIMultipleSelectSearch"})),iU(cU,this,new eU(this.hot,{textContent:VT,className:"htUISelectAll"})),iU(dU,this,new eU(this.hot,{textContent:UT,className:"htUIClearAll"})),this.registerHooks()}getItemsBox(){return rU(lU,this)}registerHooks(){rU(uU,this).addLocalHook("keydown",(e=>oU(pU,this,fU).call(this,e))),rU(uU,this).addLocalHook("input",(e=>oU(pU,this,mU).call(this,e))),rU(cU,this).addLocalHook("click",(e=>oU(pU,this,wU).call(this,e))),rU(dU,this).addLocalHook("click",(e=>oU(pU,this,yU).call(this,e)))}setItems(e){var t;iU(aU,this,e),null===(t=rU(lU,this))||void 0===t||t.loadData(rU(aU,this))}setLocale(e){iU(hU,this,e)}getLocale(){return rU(hU,this)}getItems(){return[...rU(aU,this)]}getValue(){return function(e){const t=[];return e.forEach((e=>{e.checked&&t.push(e.value)})),t}(rU(aU,this))}getSearchInputElement(){return rU(uU,this)}getSelectAllElement(){return rU(cU,this)}getClearAllElement(){return rU(dU,this)}isSelectedAllValues(){return rU(aU,this).length===this.getValue().length}build(){super.build();const{rootDocument:e}=this.hot,t=e.createElement("div"),n=new lV(this.hot,{className:"htUISelectionControls",children:[rU(cU,this),rU(dU,this)]});this._element.appendChild(rU(uU,this).element),this._element.appendChild(n.element),this._element.appendChild(t);const r=t=>{var n;if(!this._element)return;null===(n=rU(lU,this))||void 0===n||n.destroy(),Fp(t,"htUIMultipleSelectHot"),iU(lU,this,new this.hot.constructor(t,{data:rU(aU,this),columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:(e,t,n,r,i,o)=>{e.title=o.instance.getDataAtRowProp(t,o.label.property)},afterListen:()=>{this.runLocalHooks("focus",this)},beforeOnCellMouseUp:()=>{rU(lU,this).listen()},colWidths:()=>rU(lU,this).container.scrollWidth-hg(e),maxCols:1,autoWrapCol:!0,height:110,copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},themeName:this.hot.getCurrentThemeName(),layoutDirection:this.hot.isRtl()?"rtl":"ltr"})),rU(lU,this).init(),this.hot.addHook("afterSetTheme",((e,t)=>{t||rU(lU,this).useTheme(e)}));const r=rU(lU,this).getShortcutManager().getContext("grid");r.removeShortcutsByKeys(["Tab"]),r.removeShortcutsByKeys(["Shift","Tab"]),r.addShortcut({keys:[["Escape"]],callback:e=>{this.runLocalHooks("keydown",e,this)},group:sU}),r.addShortcut({keys:[["Tab"],["Shift","Tab"]],callback:e=>{rU(lU,this).deselectCell(),this.runLocalHooks("keydown",e,this),this.runLocalHooks("listTabKeydown",e,this)},group:sU})};r(t),this.hot._registerTimeout((()=>r(t)),100)}focus(){this.isBuilt()&&rU(lU,this).listen()}reset(){rU(uU,this).reset(),rU(cU,this).reset(),rU(dU,this).reset()}update(){this.isBuilt()&&(rU(lU,this).loadData(function(e,t){const n=zD(t);return e.map((e=>(e.checked=n(e.value),e)))}(rU(aU,this),this.options.value)),super.update())}destroy(){var e;null===(e=rU(lU,this))||void 0===e||e.destroy(),rU(uU,this).destroy(),rU(dU,this).destroy(),rU(cU,this).destroy(),iU(uU,this,null),iU(dU,this,null),iU(cU,this,null),iU(lU,this,null),iU(aU,this,null),super.destroy()}}function mU(e){const t=e.target.value.toLocaleLowerCase(this.getLocale());let n;n=""===t?[...rU(aU,this)]:rU(aU,this).filter((e=>`${e.value}`.toLocaleLowerCase(this.getLocale()).indexOf(t)>=0)),rU(lU,this).loadData(n)}function fU(e){this.runLocalHooks("keydown",e,this);Rg(Pm,e.keyCode)("ARROW_DOWN")&&(e.preventDefault(),_m(e),rU(lU,this).listen(),rU(lU,this).selectCell(0,0))}function wU(e){const t=[];e.preventDefault(),rU(lU,this).getSourceData().forEach(((e,n)=>{e.checked=!0,t.push(bE(e,n)[0])})),rU(lU,this).setSourceDataAtCell(t)}function yU(e){const t=[];e.preventDefault(),rU(lU,this).getSourceData().forEach(((e,n)=>{e.checked=!1,t.push(bE(e,n)[0])})),rU(lU,this).setSourceDataAtCell(t)}function vU(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function CU(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function SU(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var RU,EU=new WeakSet;class bU extends ED{constructor(e,t){super(e,{id:t.id,stateless:!1}),vU(this,EU),CU(this,"name",""),this.name=t.name,this.elements.push(new gU(this.hot)),this.registerHooks()}registerHooks(){this.getMultipleSelectElement().addLocalHook("keydown",(e=>SU(EU,this,TU).call(this,e))).addLocalHook("listTabKeydown",(e=>this.runLocalHooks("listTabKeydown",e))),this.hot.addHook("modifyFiltersMultiSelectValue",((e,t)=>SU(EU,this,AU).call(this,e,t)))}getElements(){const e=this.getMultipleSelectElement();return[e.getSearchInputElement(),e.getSelectAllElement(),e.getClearAllElement(),this.getMultipleSelectElement()]}setState(e){if(this.reset(),e&&e.command.key===XD){const t=this.getMultipleSelectElement();t.setItems(e.itemsSnapshot),t.setValue(e.args[0]),t.setLocale(e.locale)}}getState(){const e=this.getMultipleSelectElement(),t=e.getItems();return{command:{key:e.isSelectedAllValues()||!t.length?MD:XD},args:[e.getValue()],itemsSnapshot:t}}updateState(e){const t=(t,n,r,i,o)=>{const[s]=Fd(n,(e=>e.name===XD)),a={},l=this.hot.getTranslatedPhrase(DT);if(s){const n=i(t,o),h=Dd(n,(e=>e.value)),u=new Map(n.map((e=>[e.value,this.hot.getCellMeta(e.meta.visualRow,e.meta.visualCol)]))),c=YD(h);r&&(s.args[0]=r);const d=[],p=KD(c,s.args[0],l,(e=>{e.checked&&d.push(e.value),SU(EU,this,NU).call(this,e,u)})),g=e.editedConditionStack.column;a.locale=this.hot.getCellMeta(0,g).locale,a.args=[d],a.command=ND(XD),a.itemsSnapshot=p}else a.args=[],a.command=ND(MD);this.state.setValueAtIndex(t,a)};t(e.editedConditionStack.column,e.editedConditionStack.conditions,e.conditionArgsChange,e.filteredRowsFactory),e.dependentConditionStacks.length&&t(e.dependentConditionStacks[0].column,e.dependentConditionStacks[0].conditions,e.conditionArgsChange,e.filteredRowsFactory,e.editedConditionStack)}getMultipleSelectElement(){return this.elements.filter((e=>e instanceof gU))[0]}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,t,n,r,i,o)=>{Fp(t.parentNode,"htFiltersMenuValue");const s=this.hot.rootDocument.createElement("div");return Fp(s,"htFiltersMenuLabel"),s.textContent=o,t.appendChild(s),t.parentElement.hasAttribute("ghost-table")||Vd(this.elements,(e=>t.appendChild(e.element))),t}}}reset(){const e=this.hot.getTranslatedPhrase(DT),t=this._getColumnVisibleValues(),n=t.map((e=>e.value)),r=new Map(t.map((e=>[e.value,e.meta]))),i=YD(n),o=KD(i,i,e,(e=>{SU(EU,this,NU).call(this,e,r)}));this.getMultipleSelectElement().setItems(o),super.reset(),this.getMultipleSelectElement().setValue(i);const s=this.hot.getPlugin("filters").getSelectedColumn();null!==s&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,s.visualIndex).locale)}_getColumnVisibleValues(){const e=this.hot.getPlugin("filters").getSelectedColumn();return null===e?[]:Dd(this.hot.getDataAtCol(e.visualIndex),((t,n)=>({value:$D(t),meta:this.hot.getCellMeta(n,e.visualIndex)})))}}function TU(e){Pm(e.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),_m(e))}function NU(e,t){this.hot.hasHook("modifyFiltersMultiSelectValue")&&(e.visualValue=this.hot.runHooks("modifyFiltersMultiSelectValue",e.visualValue,t.get(e.value)))}function AU(e,t){return"numeric"===t.type?rx(e,t):e}function MU(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function IU(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var OU=new WeakSet;class xU extends ED{static get BUTTON_OK(){return"ok"}static get BUTTON_CANCEL(){return"cancel"}constructor(e,t){super(e,{id:t.id,stateless:!0}),MU(this,OU),IU(this,"name",""),this.name=t.name,this.elements.push(new gV(this.hot,{type:"button",value:BT,className:"htUIButton htUIButtonOK",identifier:xU.BUTTON_OK})),this.elements.push(new gV(this.hot,{type:"button",value:WT,className:"htUIButton htUIButtonCancel",identifier:xU.BUTTON_CANCEL})),this.registerHooks()}registerHooks(){Vd(this.elements,(e=>{e.addLocalHook("click",((e,t)=>function(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}(OU,this,PU).call(this,e,t)))}))}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,t)=>(Fp(t.parentNode,"htFiltersMenuActionBar"),Vd(this.elements,(e=>t.appendChild(e.element))),t)}}accept(){this.runLocalHooks("accept")}cancel(){this.runLocalHooks("cancel")}}function PU(e,t){t.options.identifier===RU.BUTTON_OK?this.accept():this.cancel()}function _U(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}RU=xU;const LU="ConditionCollection.filteringStates";class HU{constructor(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];_U(this,"hot",void 0),_U(this,"isMapRegistrable",void 0),_U(this,"filteringStates",new jE),this.hot=e,this.isMapRegistrable=t,!0===this.isMapRegistrable?this.hot.columnIndexMapper.registerMap(LU,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}isEmpty(){return 0===this.getFilteredColumns().length}isMatch(e,t){var n;const r=this.filteringStates.getValueAtIndex(t),i=null!==(n=null==r?void 0:r.conditions)&&void 0!==n?n:[],o=null==r?void 0:r.operation;return this.isMatchInConditions(i,e,o)}isMatchInConditions(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:JD;return!e.length||function(e){if(!qD[e])throw Error(`Operation with id "${e}" does not exist.`);const t=qD[e].func;return function(e,n){return t(e,n)}}(n)(e,t)}addCondition(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:JD,r=arguments.length>3?arguments[3]:void 0;const i=this.hot.getCellMeta(0,e).locale,o=t.args.map((e=>"string"==typeof e?e.toLocaleLowerCase(i):e)),s=t.name||t.command.key;this.runLocalHooks("beforeAdd",e);const a=this.getOperation(e);if(a){if(a!==n)throw Error(Wd`The column of index ${e} has been already applied with a \`${a}\`\x20
        filter operation. Use \`removeConditions\` to clear the current conditions and then add new ones.\x20
        Mind that you cannot mix different types of operations (for instance, if you use \`conjunction\`,\x20
        use it consequently for a particular column).`)}else if(zd(qD[n]))throw new Error(Wd`Unexpected operation named \`${n}\`. Possible ones are\x20
        \`disjunction\` and \`conjunction\`.`);const l=this.getConditions(e);0===l.length?this.filteringStates.setValueAtIndex(e,{operation:n,conditions:[{name:s,args:o,func:TD(s,o)}]},r):l.push({name:s,args:o,func:TD(s,o)}),this.runLocalHooks("afterAdd",e)}getConditions(e){var t,n;return null!==(t=null===(n=this.filteringStates.getValueAtIndex(e))||void 0===n?void 0:n.conditions)&&void 0!==t?t:[]}getOperation(e){var t;return null===(t=this.filteringStates.getValueAtIndex(e))||void 0===t?void 0:t.operation}getFilteredColumns(){return this.filteringStates.getEntries().map((e=>{let[t]=e;return t}))}getColumnStackPosition(e){return this.getFilteredColumns().indexOf(e)}exportAllConditions(){return this.filteringStates.getEntries().reduce(((e,t)=>{let[n,{operation:r,conditions:i}]=t;return e.push({column:n,operation:r,conditions:i.map((e=>{let{name:t,args:n}=e;return{name:t,args:[...n]}}))}),e}),[])}importAllConditions(e){this.clean(),e.forEach((e=>{e.conditions.forEach((t=>this.addCondition(e.column,t)))}))}removeConditions(e){this.runLocalHooks("beforeRemove",e),this.filteringStates.clearValue(e),this.runLocalHooks("afterRemove",e)}clean(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}hasConditions(e,t){const n=this.getConditions(e);return t?n.some((e=>e.name===t)):n.length>0}destroy(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(LU),this.filteringStates=null,this.clearLocalHooks()}}om(HU,yS);const kU=HU;function FU(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const DU=class{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:()=>[];FU(this,"conditionCollection",void 0),FU(this,"columnDataFactory",void 0),this.conditionCollection=e,this.columnDataFactory=t}filter(){let e=[];return Vd(this.conditionCollection.getFilteredColumns(),((t,n)=>{let r=this.columnDataFactory(t);n&&(r=this._getIntersectData(r,e)),e=this.filterByColumn(t,r)})),e}filterByColumn(e){const t=[];return Vd(arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],(n=>{void 0!==n&&this.conditionCollection.isMatch(n,e)&&t.push(n)})),t}_getIntersectData(e,t){const n=[];return Vd(t,(t=>{const r=t.meta.visualRow;void 0!==e[r]&&(n[r]=e[r])})),n}};function VU(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function UU(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function BU(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var WU=new WeakSet;class jU{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>[];VU(this,WU),UU(this,"hot",void 0),UU(this,"conditionCollection",void 0),UU(this,"columnDataFactory",void 0),UU(this,"changes",[]),UU(this,"grouping",!1),UU(this,"latestEditedColumnPosition",-1),UU(this,"latestOrderStack",[]),this.hot=e,this.conditionCollection=t,this.columnDataFactory=n,this.conditionCollection.addLocalHook("beforeRemove",(e=>BU(WU,this,GU).call(this,e))),this.conditionCollection.addLocalHook("afterRemove",(e=>this.updateStatesAtColumn(e))),this.conditionCollection.addLocalHook("afterAdd",(e=>this.updateStatesAtColumn(e))),this.conditionCollection.addLocalHook("beforeClean",(()=>BU(WU,this,zU).call(this))),this.conditionCollection.addLocalHook("afterClean",(()=>BU(WU,this,$U).call(this)))}groupChanges(){this.grouping=!0}flush(){this.grouping=!1,Vd(this.changes,(e=>{this.updateStatesAtColumn(e)})),this.changes.length=0}updateStatesAtColumn(e,t){var n=this;if(this.grouping)return void(-1===this.changes.indexOf(e)&&this.changes.push(e));const r=this.conditionCollection.exportAllConditions();let i=this.conditionCollection.getColumnStackPosition(e);-1===i&&(i=this.latestEditedColumnPosition);const o=r.slice(0,i),s=r.slice(i);s.length&&s[0].column===e&&s.shift();const a=function(e){const t=e.length;return function n(r){return function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];const a=r.concat(o);let l;return l=a.length>=t?e.apply(this,a):n(a),l}}([])}((function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];const i=new kU(n.hot,!1),o=[].concat(e,r);i.importAllConditions(o);const s=n.columnDataFactory(t);let a;a=i.isEmpty()?s:new DU(i,(e=>n.columnDataFactory(e))).filter(),a=Dd(a,(e=>e.meta.visualRow));const l=zD(a);return i.destroy(),Fd(s,(e=>l(e.meta.visualRow)))}))(o),l=[].concat(this.conditionCollection.getConditions(e));this.runLocalHooks("update",{editedConditionStack:{column:e,conditions:l},dependentConditionStacks:s,filteredRowsFactory:a,conditionArgsChange:t})}destroy(){this.clearLocalHooks(),hm(this,((e,t)=>{this[t]=null}))}}function GU(e){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(e)}function zU(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}function $U(){Vd(this.latestOrderStack,(e=>{this.updateStatesAtColumn(e)}))}om(jU,yS);const YU=jU;const KU="filters";function XU(e,t){let n,r=-1;const i=(o=t,QH({initialPage:0,size:()=>o.length,onItemSelect:(e,t)=>{const n=o[e];return n instanceof gU?t:!(n.element&&!$p(n.element))&&void n.focus()}}));var o;const s=e=>()=>{n.isOpened()&&n.getKeyboardShortcutsCtrl().listen(KU),i.setCurrentPage(t.indexOf(e))};function a(e){const o=n.getKeyboardShortcutsCtrl(),s=e.getKeyboardShortcutsCtrl();i.clear(),s.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],forwardToContext:o.getContext(KU),callback:()=>{e.isSubMenu()&&e.close(),o.listen(KU)}}]),e.isSubMenu()||o.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:e=>{const t=n.getNavigator();t.getCurrentPage()>-1&&(r=t.getCurrentPage()),t.clear(),e.shiftKey?i.toPreviousItem():i.toNextItem()}},{keys:[["Escape"]],callback:()=>{n.close()}},{keys:[["Enter"],["Space"]],preventDefault:!1,callback:e=>{const n=t[i.getCurrentPage()];n instanceof AV&&(n.openOptions(),e.preventDefault()),n instanceof eU&&(n.activate(),e.preventDefault()),n instanceof lV||e.preventDefault()}}],KU)}function l(e){e.addLocalHook("afterSelectionChange",(e=>{e.key.startsWith("filter_")||i.clear()})),e.addLocalHook("afterSubmenuOpen",a),e.addLocalHook("afterOpen",a),n=e}return t.forEach((e=>{e instanceof lV&&(e.addLocalHook("click",s(e)),e.addLocalHook("focus",s(e)),e.addLocalHook("afterClose",s(e)))})),l(e),{...i,listen:function(){n.focus(),n.getKeyboardShortcutsCtrl().listen(KU)},setMenu:l,getMenu:function(){return n},getLastMenuPage:function(){return r}}}function qU(e,t,n){QU(e,t),t.set(e,n)}function QU(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ZU(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function JU(e,t,n){return e.set(tB(e,t),n),n}function eB(e,t){return e.get(tB(e,t))}function tB(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}const nB="filters",rB=nB;var iB=new WeakMap,oB=new WeakMap,sB=new WeakMap,aB=new WeakSet;class lB extends Hx{static get PLUGIN_KEY(){return nB}static get PLUGIN_PRIORITY(){return 250}static get PLUGIN_DEPS(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}constructor(e){var t,n,r;super(e),t=this,QU(n=this,r=aB),r.add(n),ZU(this,"dropdownMenuPlugin",null),ZU(this,"conditionCollection",null),ZU(this,"conditionUpdateObserver",null),ZU(this,"components",new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]])),ZU(this,"filtersRowsMap",null),qU(this,iB,void 0),qU(this,oB,new WeakSet),qU(this,sB,[]),this.hot.addHook("afterGetColHeader",(function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return tB(aB,t,wB).call(t,...n)}))}isEnabled(){return!!this.hot.getSettings()[nB]}enablePlugin(){var e=this;if(this.enabled)return;this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new GE),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");const t=this.hot.getSettings().dropdownMenu,n=t&&t.uiContainer||this.hot.rootDocument.body,r=e=>(e.addLocalHook("accept",(()=>tB(aB,this,gB).call(this,"accept"))),e.addLocalHook("cancel",(()=>tB(aB,this,gB).call(this,"cancel"))),e.addLocalHook("change",(t=>tB(aB,this,mB).call(this,e,t))),e),i=()=>`${this.hot.getTranslatedPhrase(LT)}:`,o=()=>`${this.hot.getTranslatedPhrase(HT)}:`;if(!this.components.get("filter_by_condition")){const e=new HV(this.hot,{id:"filter_by_condition",name:i,addSeparator:!1,menuContainer:n});e.addLocalHook("afterClose",(()=>tB(aB,this,fB).call(this))),this.components.set("filter_by_condition",r(e))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new KV(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){const e=new HV(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:n});e.addLocalHook("afterClose",(()=>tB(aB,this,fB).call(this))),this.components.set("filter_by_condition2",r(e))}if(this.components.get("filter_by_value")||this.components.set("filter_by_value",r(new bU(this.hot,{id:"filter_by_value",name:o}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",r(new xU(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new kU(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new YU(this.hot,this.conditionCollection,(e=>this.getDataMapAtColumn(e))),this.conditionUpdateObserver.addLocalHook("update",(e=>tB(aB,this,yB).call(this,e)))),this.components.forEach((e=>e.show())),this.addHook("afterDropdownMenuDefaultOptions",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return tB(aB,e,pB).call(e,...n)})),this.addHook("beforeDropdownMenuShow",(()=>tB(aB,this,dB).call(this))),this.addHook("afterDropdownMenuShow",(()=>tB(aB,this,uB).call(this))),this.addHook("afterDropdownMenuHide",(()=>tB(aB,this,cB).call(this))),this.addHook("afterChange",(e=>tB(aB,this,hB).call(this,e))),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),!eB(iB,this)&&this.dropdownMenuPlugin.enabled){const e=[{focus:()=>{const e=eB(iB,this).getMenu(),t=e.getNavigator(),n=eB(iB,this).getLastMenuPage();e.focus(),n>0?t.setCurrentPage(n):t.toFirstItem()}},...Array.from(this.components).map((e=>{let[,t]=e;return t.getElements()})).flat()];JU(iB,this,XU(this.dropdownMenuPlugin.menu,e));const t=e=>{eB(iB,this).listen(),e.preventDefault(),Pm(e.keyCode,"TAB")&&(e.shiftKey?eB(iB,this).toPreviousItem():eB(iB,this).toNextItem())};this.components.get("filter_by_value").addLocalHook("listTabKeydown",t),this.components.get("filter_by_condition").addLocalHook("selectTabKeydown",t)}this.registerShortcuts(),super.enablePlugin()}disablePlugin(){var e;this.enabled&&(null!==(e=this.dropdownMenuPlugin)&&void 0!==e&&e.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach(((e,t)=>{e.destroy(),this.components.set(t,null)})),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName));this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Alt","A"]],stopPropagation:!0,callback:()=>{const e=this.hot.getSelected();this.clearConditions(),this.filter(),e&&this.hot.selectCells(e)},group:rB})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(rB)}addCondition(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:JD;const i=this.hot.toPhysicalColumn(e);this.conditionCollection.addCondition(i,{command:{key:t},args:n},r)}removeConditions(e){const t=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(t)}clearConditions(e){if(void 0===e)this.conditionCollection.clean();else{const t=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(t)}}importConditions(e){this.conditionCollection.importAllConditions(e)}exportConditions(){return this.conditionCollection.exportAllConditions()}filter(){const{navigableHeaders:e}=this.hot.getSettings(),t=this._createDataFilter(),n=!this.conditionCollection.isEmpty();let r=[];const i=this.exportConditions();if(!1!==this.hot.runHooks("beforeFilter",i,eB(sB,this))){if(n){const n=[];this.hot.batchExecution((()=>{this.filtersRowsMap.clear(),r=Dd(t.filter(),(e=>e.meta.visualRow));const e=zD(r);Jw(this.hot.countSourceRows()-1,(t=>{e(t)||n.push(t)})),Vd(n,(e=>{this.filtersRowsMap.setValueAtIndex(e,!0)}))}),!0),e||r.length||this.hot.deselectCell()}else this.filtersRowsMap.clear();JU(sB,this,this.exportConditions()),this.hot.runHooks("afterFilter",i),this.hot.view.adjustElementsSize(),this.hot.render()}else this.importConditions(eB(sB,this));this.hot.selection.isSelected()&&this.hot.selectCell(e?-1:0,this.hot.getSelectedRangeLast().highlight.col)}getSelectedColumn(){var e;const t=null===(e=this.hot.getSelectedRangeLast())||void 0===e?void 0:e.highlight;return t?{visualIndex:t.col,physicalIndex:this.hot.toPhysicalColumn(t.col)}:null}getDataMapAtColumn(e){const t=this.hot.toVisualColumn(e),n=[];return Vd(this.hot.getSourceDataAtCol(t),((e,r)=>{var i;const{row:o,col:s,visualCol:a,visualRow:l,type:h,instance:u,dateFormat:c,locale:d}=this.hot.getCellMeta(r,t),p=null!==(i=this.hot.getDataAtCell(this.hot.toVisualRow(r),t))&&void 0!==i?i:e;n.push({meta:{row:o,col:s,visualCol:a,visualRow:l,type:h,instance:u,dateFormat:c,locale:d},value:$D(p)})})),n}updateValueComponentCondition(e){const t=YD(this.hot.getDataAtCol(e));this.conditionUpdateObserver.updateStatesAtColumn(e,t)}restoreComponents(e){var t;const n=null===(t=this.getSelectedColumn())||void 0===t?void 0:t.physicalIndex;e.forEach((e=>{e.isHidden()||e.restoreState(n)})),this.updateDependentComponentsVisibility()}getOperationBasedOnArguments(e,t,n,r){let i=e;return i===eV&&t.command.key!==MD&&n.command.key!==MD&&r.command.key!==MD?i=tV:r.command.key!==MD&&(t.command.key!==MD&&n.command.key!==MD||(i=JD)),i}setListeningDropdownMenu(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}updateDependentComponentsVisibility(){const e=this.components.get("filter_by_condition"),{command:t}=e.getState(),n=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];t.showOperators?this.showComponents(...n):this.hideComponents(...n)}_createDataFilter(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.conditionCollection;return new DU(e,(e=>this.getDataMapAtColumn(e)))}getIndexesOfComponents(){const e=[];if(!this.dropdownMenuPlugin)return e;const t=this.dropdownMenuPlugin.menu;for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Vd(r,(n=>{Vd(t.menuItems,((t,r)=>{t.key===n.getMenuItemDescriptor().key&&e.push(r)}))})),e}changeComponentsVisibility(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!this.dropdownMenuPlugin)return;const t=this.dropdownMenuPlugin.menu.hotMenu,n=t.getPlugin("hiddenRows");for(var r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];const s=this.getIndexesOfComponents(...i);e?n.showRows(s):n.hideRows(s),t.render()}hideComponents(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.changeComponentsVisibility(!1,...t)}showComponents(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.changeComponentsVisibility(!0,...t)}destroy(){this.enabled&&(this.components.forEach(((e,t)=>{null!==e&&(e.destroy(),this.components.set(t,null))})),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),super.destroy()}}function hB(e){e&&Vd(e,(e=>{const[,t]=e,n=this.hot.propToCol(t);this.conditionCollection.hasConditions(n)&&this.updateValueComponentCondition(n)}))}function uB(){const e=this.dropdownMenuPlugin.menu;this.restoreComponents(Array.from(this.components.values())),e.updateMenuDimensions()}function cB(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}function dB(){const e=this.dropdownMenuPlugin.menu;eB(oB,this).has(e)||eB(iB,this).setMenu(e),eB(oB,this).add(e)}function pB(e){e.items.push({name:BL}),this.components.forEach((t=>{e.items.push(t.getMenuItemDescriptor())}))}function gB(e){var t;if("accept"===e){const e=this.getSelectedColumn();var n;if(null===e)return void(null===(n=this.dropdownMenuPlugin)||void 0===n||n.close());const{physicalIndex:t}=e,r=this.components.get("filter_by_condition").getState(),i=this.components.get("filter_by_condition2").getState(),o=this.components.get("filter_by_value").getState(),s=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),r,i,o);this.conditionUpdateObserver.groupChanges();let a=this.conditionCollection.getColumnStackPosition(t);-1===a&&(a=void 0),this.conditionCollection.removeConditions(t),r.command.key!==MD&&(this.conditionCollection.addCondition(t,r,s,a),i.command.key!==MD&&this.conditionCollection.addCondition(t,i,s,a)),o.command.key!==MD&&this.conditionCollection.addCondition(t,o,s,a),this.conditionUpdateObserver.flush(),this.components.forEach((e=>e.saveState(t))),this.filter()}null===(t=this.dropdownMenuPlugin)||void 0===t||t.close()}function mB(e,t){const n=this.dropdownMenuPlugin.menu;this.updateDependentComponentsVisibility(),e.constructor!==HV||t.inputsCount||this.setListeningDropdownMenu(),n.updateMenuDimensions()}function fB(){this.setListeningDropdownMenu()}function wB(e,t,n){const r=this.hot.toPhysicalColumn(e);this.enabled&&this.conditionCollection.hasConditions(r)&&n===this.hot.view.getColumnHeadersCount()-1?Fp(t,"htFiltersActive"):Dp(t,"htFiltersActive")}function yB(e){var t;if(null===(t=this.dropdownMenuPlugin)||void 0===t||!t.enabled)return;const{editedConditionStack:{conditions:n,column:r},conditionArgsChange:i}=e;Array.isArray(i)&&JU(sB,this,eB(sB,this).map((e=>(e.column===r&&n.length>0&&e.conditions.forEach((e=>{"by_value"===e.name&&(e.args=[[...i]])})),e))));const o=n.filter((e=>e.name===XD)),s=n.filter((e=>e.name!==XD));if(o.length>=2||s.length>=3)Fm(Wd`The filter conditions have been applied properly, but couldnât be displayed visually.\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\x20
        For more details see the documentation.`);else{const t=this.conditionCollection.getOperation(r);this.components.get("filter_by_condition").updateState(s[0],r),this.components.get("filter_by_condition2").updateState(s[1],r),this.components.get("filter_operators").updateState(t,r),this.components.get("filter_by_value").updateState(e)}}const vB="internal-use-in-handsontable",CB={licenseKey:vB,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!1,nullDate:{year:1899,month:12,day:30},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function SB(e){var t;return{maxColumns:e.maxColumns,maxRows:e.maxRows,language:null===(t=e[cW])||void 0===t||null===(t=t.language)||void 0===t?void 0:t.langCode}}function RB(e){return Object.keys(e).reduce(((t,n)=>("hyperformula"!==n&&(t[n]=e[n]),t)),{})}function EB(){const e="engine_relationship",t=Tf(cW);return t.hasItem(e)||t.register(e,new Map),t.getItem(e)}function bB(){const e="shared_engine_usage",t=Tf(cW);return t.hasItem(e)||t.register(e,new Map),t.getItem(e)}function TB(e){const t=e.getSettings(),n=t[cW],r=null==n?void 0:n.engine;if(!0===n)return null;if(zd(r))return null;var i;if("function"==typeof r.hyperformula||"function"==typeof r)return function(e,t,n){const r=t[cW],i=function(e){var t;const n=e[cW],r=RB(null!=n&&null!==(t=n.engine)&&void 0!==t&&t.hyperformula?n.engine:{}),i=SB(e);return{...CB,...r,...i}}(t),o=EB(),s=bB();(function(e,t){t&&t.forEach((t=>{const{name:n,plugin:r,translations:i}=t;try{e.registerFunction(n,r,i)}catch(o){Fm(o.message)}}))})(e,r.functions),function(e,t){if(t){const{langCode:r}=t;try{e.registerLanguage(r,t)}catch(n){Fm(n.message)}}}(e,r.language);const a=e.buildEmpty(i);return o.set(a,[n]),s.set(a,[n.guid]),function(e,t){t&&(e.suspendEvaluation(),t.forEach((t=>{const{name:n,expression:r,scope:i,options:o}=t;try{e.addNamedExpression(n,r,i,o)}catch(s){Fm(s.message)}})),e.resumeEvaluation())}(a,r.namedExpressions),a.on("sheetAdded",(()=>{a.rebuildAndRecalculate()})),a.on("sheetRemoved",(()=>{a.rebuildAndRecalculate()})),a}(null!==(i=r.hyperformula)&&void 0!==i?i:r,t,e);if("object"==typeof r&&zd(r.hyperformula)){const t=EB(),n=bB().get(r);return t.has(r)||t.set(r,[]),t.get(r).push(e),n&&n.push(e.guid),r.getConfig().licenseKey||r.updateConfig({licenseKey:vB}),r.getConfig().leapYear1900===CB.leapYear1900&&!1!==sm(r.getConfig().nullDate,CB.nullDate)||Fm(Wd`If you use HyperFormula with Handsontable, keep the default \`leapYear1900\` and \`nullDate\` 
      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates.`),r}return null}function NB(e){var t;const n=EB(),r=0===n.size?[]:Array.from(null!==(t=n.get(e))&&void 0!==t?t:[]);return new Map(r.map((e=>[e.getPlugin("formulas").sheetId,e])))}function AB(e,t){if(e){const n=EB(),r=n.get(e),i=bB(),o=i.get(e);r&&r.includes(t)&&(r.splice(r.indexOf(t),1),0===r.length&&n.delete(e)),o&&o.includes(t.guid)&&(o.splice(o.indexOf(t.guid),1),0===o.length&&(i.delete(e),e.destroy()))}}const MB="DD/MM/YYYY";function IB(e){return"string"==typeof e&&"'"===e.charAt(0)&&"="===e.charAt(1)}function OB(e,t){return"string"==typeof e&&"date"===t}function xB(e,t){return M(e,t,!0).isValid()}function PB(e,t){return M(e,t,!0).format(MB)}function _B(e,t){const n=new Date(Date.UTC(0,0,e+-1));return M(n).format(t)}function LB(e,t,n){const r=function(e,t){const n=[];return e.forEach((e=>{const r={from:e,to:t};n.forEach((e=>{const t=e.from>e.to,n=e.to<=r.from;e.from>r.from&&n&&t&&(r.from+=1)})),r.from>=t&&(t+=1),n.push(r)})),n}(e,function(e,t,n){const r=Array.from(Array(n).keys()).filter((t=>!1===e.includes(t)));var i;return 0===t?null!==(i=r[t])&&void 0!==i?i:0:r[t-1]+1}(e,t,n));return function(e){return e.forEach(((t,n)=>{e.slice(n+1).forEach((e=>{const n=e.from<e.to;e.from>t.from&&n&&(e.from-=1)}))})),e}(r)}function HB(e,t,n){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,n)}function kB(e,t){return e.get(DB(e,t))}function FB(e,t,n){return e.set(DB(e,t),n),n}function DB(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var VB=new WeakMap,UB=new WeakMap,BB=new WeakMap,WB=new WeakMap,jB=new WeakMap,GB=new WeakMap,zB=new WeakMap;const $B=class{constructor(e,t,n){HB(this,VB,void 0),HB(this,UB,void 0),HB(this,BB,void 0),HB(this,WB,[]),HB(this,jB,[]),HB(this,GB,void 0),HB(this,zB,[]),FB(VB,this,e),FB(UB,this,t),FB(BB,this,n)}setRemovedHfIndexes(e){return FB(zB,this,e.map((e=>{const t=kB(UB,this).getVisualFromPhysicalIndex(e);return this.getHfIndexFromVisualIndex(t)}))),kB(zB,this)}getRemovedHfIndexes(){return kB(zB,this)}getHfIndexFromVisualIndex(e){const t=kB(UB,this).getIndexesSequence(),n=kB(UB,this).getNotTrimmedIndexes();return t.indexOf(n[e])}syncMoves(e){const t=`move${op(kB(VB,this))}s`;kB(BB,this).getEngine().batch((()=>{e.forEach((e=>{const n=e.from!==e.to,r=e.from+1!==e.to;n&&r&&kB(BB,this).getEngine()[t](kB(BB,this).getSheetId(),e.from,1,e.to)}))}))}storeMovesInformation(e,t,n){!1!==n&&(FB(jB,this,e.map((e=>this.getHfIndexFromVisualIndex(e)))),FB(GB,this,this.getHfIndexFromVisualIndex(t)))}calculateAndSyncMoves(e,t){if(kB(BB,this).isPerformingUndoRedo())return;if(!1===e||!1===t)return;const n=LB(kB(jB,this),kB(GB,this),kB(UB,this).getNumberOfIndexes());null===kB(BB,this).getSheetId()?kB(BB,this).getPostponeAction((()=>this.syncMoves(n))):this.syncMoves(n)}getIndexesChangeSyncMethod(){const e=`set${op(kB(VB,this))}Order`;return t=>{if(kB(BB,this).isPerformingUndoRedo())return;const n=kB(UB,this).getIndexesSequence();if("update"===t&&n.length>0){const t=kB(WB,this).map((e=>n.indexOf(e))),r=kB(BB,this).getEngine().getSheetDimensions(kB(BB,this).getSheetId());let i;i="row"===kB(VB,this)?r.height:r.width;for(let e=t.length;e<i;e+=1)t.push(e);kB(BB,this).getEngine()[e](kB(BB,this).getSheetId(),t)}FB(WB,this,n)}}init(){FB(WB,this,kB(UB,this).getIndexesSequence())}};function YB(e,t,n){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,n)}function KB(e,t){return e.get(qB(e,t))}function XB(e,t,n){return e.set(qB(e,t),n),n}function qB(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var QB=new WeakMap,ZB=new WeakMap,JB=new WeakMap,eW=new WeakMap,tW=new WeakMap,nW=new WeakMap,rW=new WeakMap;const iW=class{constructor(e,t,n){YB(this,QB,void 0),YB(this,ZB,void 0),YB(this,JB,void 0),YB(this,eW,!1),YB(this,tW,!1),YB(this,nW,null),YB(this,rW,null),XB(QB,this,new $B("row",e,this)),XB(ZB,this,new $B("column",t,this)),XB(JB,this,n)}getForAxis(e){return KB("row"===e?QB:ZB,this)}setPerformUndo(e){XB(eW,this,e)}setPerformRedo(e){XB(tW,this,e)}isPerformingUndoRedo(){return KB(eW,this)||KB(tW,this)}getSheetId(){return KB(rW,this)}getEngine(){return KB(nW,this)}getPostponeAction(){return KB(JB,this)}setupSyncEndpoint(e,t){XB(nW,this,e),XB(rW,this,t),KB(QB,this).init(),KB(ZB,this).init()}};function oW(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function sW(e,t,n){aW(e,t),t.set(e,n)}function aW(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function lW(e,t,n){return e.set(uW(e,t),n),n}function hW(e,t){return e.get(uW(e,t))}function uW(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}const cW="formulas",dW=["maxRows","maxColumns","language"];Rf.getSingleton().register("afterNamedExpressionAdded"),Rf.getSingleton().register("afterNamedExpressionRemoved"),Rf.getSingleton().register("afterSheetAdded"),Rf.getSingleton().register("afterSheetRemoved"),Rf.getSingleton().register("afterSheetRenamed"),Rf.getSingleton().register("afterFormulasValuesUpdate");const pW=e=>"UndoRedo.undo"===e||"UndoRedo.redo"===e||"auto"===e;var gW=new WeakMap,mW=new WeakMap,fW=new WeakMap,wW=new WeakSet;class yW extends Hx{constructor(){var e,t,n;super(...arguments),e=this,aW(t=this,n=wW),n.add(t),sW(this,gW,!1),sW(this,mW,!1),sW(this,fW,[["valuesUpdated",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return uW(wW,e,FW).call(e,...n)}],["namedExpressionAdded",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return uW(wW,e,DW).call(e,...n)}],["namedExpressionRemoved",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return uW(wW,e,VW).call(e,...n)}],["sheetAdded",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return uW(wW,e,UW).call(e,...n)}],["sheetRenamed",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return uW(wW,e,BW).call(e,...n)}],["sheetRemoved",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return uW(wW,e,WW).call(e,...n)}]]),oW(this,"staticRegister",Tf("formulas")),oW(this,"engine",null),oW(this,"sheetName",null),oW(this,"indexSyncer",null),oW(this,"rowAxisSyncer",null),oW(this,"columnAxisSyncer",null)}static get PLUGIN_KEY(){return cW}static get PLUGIN_PRIORITY(){return 260}static get SETTING_KEYS(){return[cW,...dW]}get sheetId(){return null===this.sheetName?null:this.engine.getSheetId(this.sheetName)}isEnabled(){return!!this.hot.getSettings()[cW]}enablePlugin(){var e,t=this;if(!this.enabled)if(this.engine=null!==(e=TB(this.hot))&&void 0!==e?e:this.engine,this.engine){if(null!==this.sheetName&&!this.engine.doesSheetExist(this.sheetName)){const e=this.addSheet(this.sheetName,this.hot.getSourceDataArray());!1!==e&&(this.sheetName=e)}this.addHook("beforeLoadData",(function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return uW(wW,t,SW).call(t,...n)})),this.addHook("afterLoadData",(function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return uW(wW,t,EW).call(t,...n)})),this.addHook("beforeUpdateData",(function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return uW(wW,t,SW).call(t,...n)})),this.addHook("afterUpdateData",(function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return uW(wW,t,EW).call(t,...n)})),this.addHook("modifyData",(function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return uW(wW,t,bW).call(t,...n)})),this.addHook("modifySourceData",(function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return uW(wW,t,TW).call(t,...n)})),this.addHook("beforeValidate",(function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return uW(wW,t,vW).call(t,...n)})),this.addHook("afterSetSourceDataAtCell",(function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return uW(wW,t,AW).call(t,...n)})),this.addHook("afterSetDataAtCell",(function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return uW(wW,t,NW).call(t,...n)})),this.addHook("afterSetDataAtRowProp",(function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return uW(wW,t,NW).call(t,...n)})),this.addHook("beforeCreateRow",(function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return uW(wW,t,MW).call(t,...n)})),this.addHook("beforeCreateCol",(function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return uW(wW,t,IW).call(t,...n)})),this.addHook("afterCreateRow",(function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return uW(wW,t,PW).call(t,...n)})),this.addHook("afterCreateCol",(function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return uW(wW,t,_W).call(t,...n)})),this.addHook("beforeRemoveRow",(function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return uW(wW,t,OW).call(t,...n)})),this.addHook("beforeRemoveCol",(function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return uW(wW,t,xW).call(t,...n)})),this.addHook("afterRemoveRow",(function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return uW(wW,t,LW).call(t,...n)})),this.addHook("afterRemoveCol",(function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return uW(wW,t,HW).call(t,...n)})),this.indexSyncer=new iW(this.hot.rowIndexMapper,this.hot.columnIndexMapper,(e=>{this.hot.addHookOnce("init",(()=>{e()}))})),this.rowAxisSyncer=this.indexSyncer.getForAxis("row"),this.columnAxisSyncer=this.indexSyncer.getForAxis("column"),this.hot.addHook("afterRowSequenceChange",this.rowAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("afterColumnSequenceChange",this.columnAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("beforeRowMove",((e,t,n,r)=>{this.rowAxisSyncer.storeMovesInformation(e,t,r)})),this.hot.addHook("beforeColumnMove",((e,t,n,r)=>{this.columnAxisSyncer.storeMovesInformation(e,t,r)})),this.hot.addHook("afterRowMove",((e,t,n,r,i)=>{this.rowAxisSyncer.calculateAndSyncMoves(r,i)})),this.hot.addHook("afterColumnMove",((e,t,n,r,i)=>{this.columnAxisSyncer.calculateAndSyncMoves(r,i)})),this.hot.addHook("beforeColumnFreeze",((e,t)=>{this.columnAxisSyncer.storeMovesInformation([e],this.hot.getSettings().fixedColumnsStart,t)})),this.hot.addHook("afterColumnFreeze",((e,t)=>{this.columnAxisSyncer.calculateAndSyncMoves(t,t)})),this.hot.addHook("beforeColumnUnfreeze",((e,t)=>{this.columnAxisSyncer.storeMovesInformation([e],this.hot.getSettings().fixedColumnsStart-1,t)})),this.hot.addHook("afterColumnUnfreeze",((e,t)=>{this.columnAxisSyncer.calculateAndSyncMoves(t,t)})),this.addHook("afterCellMetaReset",(function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return uW(wW,t,RW).call(t,...n)})),this.addHook("beforeUndo",(()=>{this.indexSyncer.setPerformUndo(!0),this.engine.undo()})),this.addHook("beforeRedo",(()=>{this.indexSyncer.setPerformRedo(!0),this.engine.redo()})),this.addHook("afterUndo",(()=>{this.indexSyncer.setPerformUndo(!1)})),this.addHook("afterUndo",(()=>{this.indexSyncer.setPerformRedo(!1)})),this.addHook("afterDetachChild",(function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return uW(wW,t,kW).call(t,...n)})),this.addHook("beforeAutofill",(function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return uW(wW,t,CW).call(t,...n)})),hW(fW,this).forEach((e=>{let[t,n]=e;return this.engine.on(t,n)})),super.enablePlugin()}else Fm("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.")}disablePlugin(){hW(fW,this).forEach((e=>{let[t,n]=e;return this.engine.off(t,n)})),AB(this.engine,this.hot),this.engine=null,super.disablePlugin()}updatePlugin(e){const t=function(e){var t;const n=e[cW];return{...RB(null!=n&&null!==(t=n.engine)&&void 0!==t&&t.hyperformula?n.engine:{}),...SB(e)}}(this.hot.getSettings());(function(e,t){return Object.keys(t).some((n=>void 0!==t[n]&&t[n]!==e[n]))})(this.engine.getConfig(),t)&&this.engine.updateConfig(t);const n=this.hot.getSettings()[cW];if(Gd(n)&&Gd(n.sheetName)&&n.sheetName!==this.sheetName&&this.switchSheet(n.sheetName),!e.data&&null===this.sheetName){const e=this.hot.getSettings()[cW].sheetName;e&&this.engine.doesSheetExist(e)?this.switchSheet(this.sheetName):this.sheetName=this.addSheet(null!=e?e:void 0,this.hot.getSourceDataArray())}super.updatePlugin(e)}destroy(){hW(fW,this).forEach((e=>{var t;let[n,r]=e;return null===(t=this.engine)||void 0===t?void 0:t.off(n,r)})),lW(fW,this,null),AB(this.engine,this.hot),this.engine=null,super.destroy()}addSheet(e,t){if(Gd(t)&&!function(e){return!!(Array.isArray(e)&&e.length&&e.every((e=>Array.isArray(e))))}(t))return Fm("The provided data should be an array of arrays."),!1;if(null!=e&&this.engine.doesSheetExist(e))return Fm("Sheet with the provided name already exists."),!1;try{const n=this.engine.addSheet(null!=e?e:void 0);return t&&this.engine.setSheetContent(this.engine.getSheetId(n),t),n}catch(n){return Fm(n.message),!1}}switchSheet(e){if(!this.engine.doesSheetExist(e))return void Dm(`The sheet named \`${e}\` does not exist, switch aborted.`);this.sheetName=e;const t=this.engine.getSheetSerialized(this.sheetId);t.length>0&&this.hot.loadData(t,`${op(cW)}.switchSheet`)}getCellType(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.sheetId;const r=this.hot.toPhysicalRow(e),i=this.hot.toPhysicalColumn(t);return null!==r&&null!==i?this.engine.getCellType({sheet:n,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(t)}):"EMPTY"}isFormulaCellType(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.sheetId;return this.engine.doesCellHaveFormula({sheet:n,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(t)})}renderDependentSheets(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=new Set;e.forEach((e=>{var t;const r=null==e||null===(t=e.address)||void 0===t?void 0:t.sheet;void 0!==r&&(n.has(r)||n.add(r))})),NB(this.engine).forEach(((e,r)=>{var i;(t||r!==this.sheetId)&&n.has(r)&&(e.render(),null===(i=e.view)||void 0===i||i.adjustElementsSize())}))}validateDependentCells(e){const t=e=>{var t;const{row:n,col:r,sheet:i}=null!==(t=null==e?void 0:e.address)&&void 0!==t?t:{};return Gd(i)?`${i}:${n}x${r}`:""},n=new Set((arguments.length>1&&void 0!==arguments[1]?arguments[1]:[]).map((e=>t(e))));e.forEach((e=>{var r,i;const{row:o,col:s}=null!==(r=e.address)&&void 0!==r?r:{};if(!1===Gd(o)||!1===Gd(s)||o>=this.hot.countRows()||s>=this.hot.countCols())return;const a=null==e||null===(i=e.address)||void 0===i?void 0:i.sheet,l=t(e);if(void 0!==a&&!n.has(l)){const e=NB(this.engine).get(a);if(!e)return;e.validateCell(e.getDataAtCell(o,s),e.getCellMeta(o,s),(()=>{}))}}))}syncChangeWithEngine(e,t,n){const r={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(t),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(r))return void Fm(`Not possible to set cell data at ${JSON.stringify(r)}`);const i=this.hot.getCellMeta(e,t);var o;return OB(n,i.type)&&(xB(n,i.dateFormat)?n=PB(n,i.dateFormat):!1===("string"==typeof(o=n)&&o.startsWith("="))&&(n=`'${n}`)),this.engine.setCellContents(r,n)}}function vW(e,t,n){const r=this.hot.propToCol(n);if(this.isFormulaCellType(t,r)){const e={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(t),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(r),sheet:this.sheetId},n=this.hot.getCellMeta(t,r);let i=this.engine.getCellValue(e);return"date"===n.type&&Zw(i)&&(i=_B(i,n.dateFormat)),"object"==typeof i&&null!==i?i.value:i}return e}function CW(e,t,n){const{row:r,col:i}=t.getTopStartCorner(),{row:o,col:s}=t.getBottomEndCorner(),{row:a,col:l}=n.getTopStartCorner(),{row:h,col:u}=n.getBottomEndCorner(),c={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(r),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(s),sheet:this.sheetId}},d={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(a),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(h),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(u),sheet:this.sheetId}};if(!1===this.engine.isItPossibleToSetCellContents(d))return!1;const p=this.engine.getFillRangeData(c,d),{row:g,col:m}=c.start,{row:f,col:w}=c.end,y=f-g+1,v=w-m+1;for(let R=0;R<p.length;R+=1)for(let e=0;e<p[R].length;e+=1){const t=p[R][e],n=g+R%y,r=m+e%v,i=this.hot.getCellMeta(n,r);OB(t,i.type)&&(t.startsWith("'")?p[R][e]=t.slice(1):!1===this.isFormulaCellType(n,r,this.sheetId)&&(p[R][e]=(C=t,S=i.dateFormat,M(C,MB,!0).format(S))))}var C,S;return p}function SW(e,t){(arguments.length>2&&void 0!==arguments[2]?arguments[2]:"").includes(op(cW))||lW(mW,this,zd(this.hot.getSettings().data))}function RW(){const e=this.hot.getSourceDataArray();let t=!1;e.forEach(((n,r)=>{n.forEach(((n,i)=>{const o=this.hot.getCellMeta(r,i),s=o.dateFormat;OB(n,o.type)&&(t=!0,xB(n,s)?e[r][i]=PB(n,s):!1===this.isFormulaCellType(r,i)&&(e[r][i]=`'${n}`))}))})),!0===t&&(lW(gW,this,!0),this.engine.setSheetContent(this.sheetId,e),lW(gW,this,!1))}function EW(e,t){var n,r;if(!(arguments.length>2&&void 0!==arguments[2]?arguments[2]:"").includes(op(cW)))if(this.sheetName=(n=this.engine,!zd(r=this.hot.getSettings()[cW].sheetName)&&n.doesSheetExist(r)||(r=n.addSheet(r)),r),hW(mW,this))this.switchSheet(this.sheetName);else{const e=this.hot.getSourceDataArray();if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,e)){lW(gW,this,!0);const t=this.engine.setSheetContent(this.sheetId,e);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(t),lW(gW,this,!1)}}}function bW(e,t,n,r){if("get"!==r||hW(gW,this)||null===this.sheetName||!this.engine.doesSheetExist(this.sheetName))return;const i=this.hot.toVisualRow(e);if(null===i||null===t)return;if(!this.isFormulaCellType(i,t)){if("ARRAY"!==this.getCellType(i,t))return void(IB(n.value)&&(n.value=IB(o=n.value)?o.substr(1):o))}var o;const s={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(t),sheet:this.sheetId};let a=this.engine.getCellValue(s),l=this.hot.getCellsMeta().find((e=>e.visualRow===i&&e.visualCol===t));void 0===l&&(l={}),"date"===l.type&&Zw(a)&&(a=_B(a,l.dateFormat));const h="object"==typeof a&&null!==a?a.value:a;n.value=h}function TW(e,t,n,r){if("get"!==r||hW(gW,this)||null===this.sheetName||!this.engine.doesSheetExist(this.sheetName))return;const i=this.hot.toVisualRow(e),o=this.hot.propToCol(t);if(null===i||null===o)return;if(!this.isFormulaCellType(i,o)){if("ARRAY"!==this.getCellType(i,o))return}const s=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(0===s.width&&0===s.height)return;const a={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(o),sheet:this.sheetId};n.value=this.engine.getCellSerialized(a)}function NW(e,t){if(pW(t))return;const n=[],r=[],i=this.engine.batch((()=>{e.forEach((e=>{let[t,i,,o]=e;const s=this.hot.propToCol(i),a=this.hot.toPhysicalRow(t),l=this.hot.toPhysicalColumn(s),h={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(t),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(s),sheet:this.sheetId};null!==a&&null!==l?this.syncChangeWithEngine(t,s,o):n.push([t,s,o]),r.push({address:h})}))}));n.length&&this.hot.addHookOnce("afterChange",(()=>{const e=this.engine.batch((()=>{n.forEach((e=>{let[t,n,r]=e;this.syncChangeWithEngine(t,n,r)}))}));this.renderDependentSheets(e,!0)})),this.renderDependentSheets(i),this.validateDependentCells(i,r)}function AW(e,t){if(pW(t))return;const n=[],r=[];e.forEach((e=>{let[t,i,,o]=e;const s=this.hot.propToCol(i);if(!Zw(s))return;const a={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(t),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(s),sheet:this.sheetId};this.engine.isItPossibleToSetCellContents(a)?(r.push({address:a}),n.push(...this.engine.setCellContents(a,o))):Fm(`Not possible to set source cell data at ${JSON.stringify(a)}`)})),this.renderDependentSheets(n),this.validateDependentCells(n,r)}function MW(e,t){let n=this.rowAxisSyncer.getHfIndexFromVisualIndex(e);if(e>=this.hot.countRows()&&(n=e),null===this.sheetId||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[n,t]))return!1}function IW(e,t){let n=this.columnAxisSyncer.getHfIndexFromVisualIndex(e);if(e>=this.hot.countCols()&&(n=e),null===this.sheetId||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[n,t]))return!1}function OW(e,t,n){return!1!==this.rowAxisSyncer.setRemovedHfIndexes(n).every((e=>this.engine.isItPossibleToRemoveRows(this.sheetId,[e,1])))&&void 0}function xW(e,t,n){return!1!==this.columnAxisSyncer.setRemovedHfIndexes(n).every((e=>this.engine.isItPossibleToRemoveColumns(this.sheetId,[e,1])))&&void 0}function PW(e,t,n){if(pW(n))return;const r=this.engine.addRows(this.sheetId,[this.rowAxisSyncer.getHfIndexFromVisualIndex(e),t]);this.renderDependentSheets(r)}function _W(e,t,n){if(pW(n))return;const r=this.engine.addColumns(this.sheetId,[this.columnAxisSyncer.getHfIndexFromVisualIndex(e),t]);this.renderDependentSheets(r)}function LW(e,t,n,r){if(pW(r))return;const i=this.rowAxisSyncer.getRemovedHfIndexes().sort(((e,t)=>t-e)),o=this.engine.batch((()=>{i.forEach((e=>{this.engine.removeRows(this.sheetId,[e,1])}))}));this.renderDependentSheets(o)}function HW(e,t,n,r){if(pW(r))return;const i=this.columnAxisSyncer.getRemovedHfIndexes().sort(((e,t)=>t-e)),o=this.engine.batch((()=>{i.forEach((e=>{this.engine.removeColumns(this.sheetId,[e,1])}))}));this.renderDependentSheets(o)}function kW(e,t,n){var r;lW(gW,this,!0);const i=this.hot.getSourceDataArray(n,0,n+((null===(r=t.__children)||void 0===r?void 0:r.length)||0),this.hot.countSourceCols());lW(gW,this,!1),i.forEach(((e,t)=>{e.forEach(((e,r)=>{this.engine.setCellContents({col:r,row:n+t,sheet:this.sheetId},[[e]])}))}))}function FW(e){this.hot.runHooks("afterFormulasValuesUpdate",e)}function DW(e,t){this.hot.runHooks("afterNamedExpressionAdded",e,t)}function VW(e,t){this.hot.runHooks("afterNamedExpressionRemoved",e,t)}function UW(e){this.hot.runHooks("afterSheetAdded",e)}function BW(e,t){this.sheetName=t,this.hot.runHooks("afterSheetRenamed",e,t)}function WW(e,t){this.hot.runHooks("afterSheetRemoved",e,t)}function jW(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function GW(e,t){return e.get($W(e,t))}function zW(e,t,n){return e.set($W(e,t),n),n}function $W(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}Rf.getSingleton().register("beforeHideColumns"),Rf.getSingleton().register("afterHideColumns"),Rf.getSingleton().register("beforeUnhideColumns"),Rf.getSingleton().register("afterUnhideColumns");const YW="hiddenColumns";var KW=new WeakMap,XW=new WeakSet;class qW extends Hx{constructor(){var e,t;super(...arguments),jW(e=this,t=XW),t.add(e),function(e,t,n){jW(e,t),t.set(e,n)}(this,KW,null)}static get PLUGIN_KEY(){return YW}static get PLUGIN_PRIORITY(){return 310}static get DEFAULT_SETTINGS(){return{copyPasteEnabled:!0,indicators:!1,columns:[]}}isEnabled(){return!!this.hot.getSettings()[YW]}enablePlugin(){var e=this;this.enabled||(zW(KW,this,new FE),GW(KW,this).addLocalHook("init",(()=>$W(XW,this,nj).call(this))),this.hot.columnIndexMapper.registerMap(this.pluginName,GW(KW,this)),this.addHook("afterContextMenuDefaultOptions",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return $W(XW,e,tj).call(e,...n)})),this.addHook("afterGetCellMeta",((e,t,n)=>$W(XW,this,ZW).call(this,e,t,n))),this.addHook("modifyColWidth",((e,t)=>$W(XW,this,QW).call(this,e,t)),2),this.addHook("afterGetColHeader",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return $W(XW,e,ej).call(e,...n)})),this.addHook("modifyCopyableRange",(e=>$W(XW,this,JW).call(this,e))),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),super.disablePlugin(),this.resetCellsMeta()}showColumns(e){const t=this.getHiddenColumns(),n=this.isValidConfig(e);let r=t;const i=GW(KW,this).getValues().slice(),o=e.length>0;if(n&&o){Vd(e.map((e=>this.hot.toPhysicalColumn(e))),(e=>{i[e]=!1})),r=kd(i,((e,t,n)=>(t&&e.push(this.hot.toVisualColumn(n)),e)),[])}!1!==this.hot.runHooks("beforeUnhideColumns",t,r,n&&o)&&(n&&o&&GW(KW,this).setValues(i),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",t,r,n&&o,n&&r.length<t.length))}showColumn(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.showColumns(t)}hideColumns(e){const t=this.getHiddenColumns(),n=this.isValidConfig(e);let r=t;n&&(r=Array.from(new Set(t.concat(e))));!1!==this.hot.runHooks("beforeHideColumns",t,r,n)&&(n&&this.hot.batchExecution((()=>{Vd(e,(e=>{GW(KW,this).setValueAtIndex(this.hot.toPhysicalColumn(e),!0)}))}),!0),this.hot.runHooks("afterHideColumns",t,r,n,n&&r.length>t.length))}hideColumn(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.hideColumns(t)}getHiddenColumns(){return Dd(GW(KW,this).getHiddenIndexes(),(e=>this.hot.toVisualColumn(e)))}isHidden(e){return GW(KW,this).getValueAtIndex(this.hot.toPhysicalColumn(e))||!1}isValidConfig(e){const t=this.hot.countCols();return!!(Array.isArray(e)&&e.length>0)&&e.every((e=>Number.isInteger(e)&&e>=0&&e<t))}resetCellsMeta(){Vd(this.hot.getCellsMeta(),(e=>{e.skipColumnOnPaste=!1}))}destroy(){zW(KW,this,null),super.destroy()}}function QW(e,t){return this.isHidden(t)?0:this.getSetting("indicators")&&(this.isHidden(t+1)||this.isHidden(t-1))&&"number"==typeof e&&this.hot.hasColHeaders()?e+15:void 0}function ZW(e,t,n){if(!1===this.getSetting("copyPasteEnabled")&&this.isHidden(t)&&(n.skipColumnOnPaste=!0),this.isHidden(t-1))n.className=n.className||"",-1===n.className.indexOf("afterHiddenColumn")&&(n.className+=" afterHiddenColumn");else if(n.className){const e=n.className.split(" ");if(e.length>0){const t=e.indexOf("afterHiddenColumn");t>-1&&e.splice(t,1),n.className=e.join(" ")}}}function JW(e){if(this.getSetting("copyPasteEnabled"))return e;const t=[],n=(e,n,r,i)=>{t.push({startRow:e,endRow:n,startCol:r,endCol:i})};return Vd(e,(e=>{let t=!0,r=0;Jw(e.startCol,e.endCol,(i=>{this.isHidden(i)?(t||n(e.startRow,e.endRow,r,i-1),t=!0):(t&&(r=i),i===e.endCol&&n(e.startRow,e.endRow,r,i),t=!1)}))})),t}function ej(e,t){if(!this.getSetting("indicators")||e<0)return;const n=[];e>=1&&this.isHidden(e-1)&&n.push("afterHiddenColumn"),e<this.hot.countCols()-1&&this.isHidden(e+1)&&n.push("beforeHiddenColumn"),Fp(t,n)}function tj(e){var t;e.items.push({name:BL},(t=this,{key:"hidden_columns_hide",name(){const e=this.getSelectedLast();let t=0;if(Array.isArray(e)){const[,n,,r]=e;n-r!=0&&(t=1)}return this.getTranslatedPhrase(aT,t)},callback(){const{from:e,to:n}=this.getSelectedRangeLast(),r=Math.max(Math.min(e.col,n.col),0),i=Math.max(e.col,n.col),o=[];for(let t=r;t<=i;t+=1)o.push(t);t.hideColumns(o);const s=o[o.length-1],a=this.columnIndexMapper.getNearestNotHiddenIndex(s,1,!0);Number.isInteger(a)&&a>=0?this.selectColumns(a):this.deselectCell(),this.render(),this.view.adjustElementsSize()},disabled:!1,hidden(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}),function(e){const t=[];return{key:"hidden_columns_show",name(){const e=t.length>1?1:0;return this.getTranslatedPhrase(lT,e)},callback(){var n,r;if(0===t.length)return;let i=t[0],o=t[t.length-1];i=null!==(n=this.columnIndexMapper.getNearestNotHiddenIndex(i-1,-1))&&void 0!==n?n:0,o=null!==(r=this.columnIndexMapper.getNearestNotHiddenIndex(o+1,1))&&void 0!==r?r:this.countCols()-1,e.showColumns(t),this.render(),this.view.adjustElementsSize(),o-i+1===this.countCols()||this.selectColumns(i,o)},disabled:!1,hidden(){const n=Dd(e.getHiddenColumns(),(e=>this.toPhysicalColumn(e)));if(!this.selection.isSelectedByColumnHeader()&&!this.selection.isSelectedByCorner()||n.length<1)return!0;t.length=0;const r=this.getSelectedRangeLast(),i=r.getTopStartCorner().col,o=r.getBottomEndCorner().col,s=this.columnIndexMapper,a=s.getRenderableFromVisualIndex(i),l=s.getRenderableFromVisualIndex(o),h=s.getNotTrimmedIndexes(),u=[];if(i!==o){if(o-i+1>l-a+1){const e=h.slice(i,o+1);u.push(...e.filter((e=>n.includes(e))))}}else if(0===a&&a<i)u.push(...h.slice(0,i));else if(null===a)u.push(...h.slice(0,this.countCols()));else{const e=this.countCols()-1;l===s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(e,-1))&&e>o&&u.push(...h.slice(o+1))}return Vd(u,(e=>{t.push(this.toVisualColumn(e))})),0===t.length}}}(this))}function nj(){const e=this.getSetting("columns");Array.isArray(e)&&this.hideColumns(e)}function rj(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ij(e,t){return e.get(sj(e,t))}function oj(e,t,n){return e.set(sj(e,t),n),n}function sj(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}Rf.getSingleton().register("beforeHideRows"),Rf.getSingleton().register("afterHideRows"),Rf.getSingleton().register("beforeUnhideRows"),Rf.getSingleton().register("afterUnhideRows");const aj="hiddenRows";var lj=new WeakMap,hj=new WeakSet;class uj extends Hx{constructor(){var e,t;super(...arguments),rj(e=this,t=hj),t.add(e),function(e,t,n){rj(e,t),t.set(e,n)}(this,lj,null)}static get PLUGIN_KEY(){return aj}static get PLUGIN_PRIORITY(){return 320}static get DEFAULT_SETTINGS(){return{copyPasteEnabled:!0,indicators:!1,rows:[]}}isEnabled(){return!!this.hot.getSettings()[aj]}enablePlugin(){var e=this;this.enabled||(oj(lj,this,new FE),ij(lj,this).addLocalHook("init",(()=>sj(hj,this,fj).call(this))),this.hot.rowIndexMapper.registerMap(this.pluginName,ij(lj,this)),this.addHook("afterContextMenuDefaultOptions",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return sj(hj,e,mj).call(e,...n)})),this.addHook("afterGetCellMeta",((e,t,n)=>sj(hj,this,dj).call(this,e,t,n))),this.addHook("modifyRowHeight",((e,t)=>sj(hj,this,cj).call(this,e,t))),this.addHook("afterGetRowHeader",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return sj(hj,e,gj).call(e,...n)})),this.addHook("modifyCopyableRange",(e=>sj(hj,this,pj).call(this,e))),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap(this.pluginName),super.disablePlugin(),this.resetCellsMeta()}showRows(e){const t=this.getHiddenRows(),n=this.isValidConfig(e);let r=t;const i=ij(lj,this).getValues().slice(),o=e.length>0;if(n&&o){Vd(e.map((e=>this.hot.toPhysicalRow(e))),(e=>{i[e]=!1})),r=kd(i,((e,t,n)=>(t&&e.push(this.hot.toVisualRow(n)),e)),[])}!1!==this.hot.runHooks("beforeUnhideRows",t,r,n&&o)&&(n&&o&&ij(lj,this).setValues(i),this.hot.runHooks("afterUnhideRows",t,r,n&&o,n&&r.length<t.length))}showRow(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.showRows(t)}hideRows(e){const t=this.getHiddenRows(),n=this.isValidConfig(e);let r=t;n&&(r=Array.from(new Set(t.concat(e))));!1!==this.hot.runHooks("beforeHideRows",t,r,n)&&(n&&this.hot.batchExecution((()=>{Vd(e,(e=>{ij(lj,this).setValueAtIndex(this.hot.toPhysicalRow(e),!0)}))}),!0),this.hot.runHooks("afterHideRows",t,r,n,n&&r.length>t.length))}hideRow(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.hideRows(t)}getHiddenRows(){return Dd(ij(lj,this).getHiddenIndexes(),(e=>this.hot.toVisualRow(e)))}isHidden(e){return ij(lj,this).getValueAtIndex(this.hot.toPhysicalRow(e))||!1}isValidConfig(e){const t=this.hot.countRows();return!!(Array.isArray(e)&&e.length>0)&&e.every((e=>Number.isInteger(e)&&e>=0&&e<t))}resetCellsMeta(){Vd(this.hot.getCellsMeta(),(e=>{e.skipRowOnPaste=!1}))}destroy(){oj(lj,this,null),super.destroy()}}function cj(e,t){return this.isHidden(t)?0:e}function dj(e,t,n){if(!1===this.getSetting("copyPasteEnabled")&&this.isHidden(e)&&(n.skipRowOnPaste=!0),this.isHidden(e-1))n.className=n.className||"",-1===n.className.indexOf("afterHiddenRow")&&(n.className+=" afterHiddenRow");else if(n.className){const e=n.className.split(" ");if(e.length>0){const t=e.indexOf("afterHiddenRow");t>-1&&e.splice(t,1),n.className=e.join(" ")}}}function pj(e){if(this.getSetting("copyPasteEnabled"))return e;const t=[],n=(e,n,r,i)=>{t.push({startRow:e,endRow:n,startCol:r,endCol:i})};return Vd(e,(e=>{let t=!0,r=0;Jw(e.startRow,e.endRow,(i=>{this.isHidden(i)?(t||n(r,i-1,e.startCol,e.endCol),t=!0):(t&&(r=i),i===e.endRow&&n(r,i,e.startCol,e.endCol),t=!1)}))})),t}function gj(e,t){if(!this.getSetting("indicators")||e<0)return;const n=[];e>=1&&this.isHidden(e-1)&&n.push("afterHiddenRow"),e<this.hot.countRows()-1&&this.isHidden(e+1)&&n.push("beforeHiddenRow"),Fp(t,n)}function mj(e){var t;e.items.push({name:BL},(t=this,{key:"hidden_rows_hide",name(){const e=this.getSelectedLast();let t=0;if(Array.isArray(e)){const[n,,r]=e;n-r!=0&&(t=1)}return this.getTranslatedPhrase(hT,t)},callback(){const{from:e,to:n}=this.getSelectedRangeLast(),r=Math.max(Math.min(e.row,n.row),0),i=Math.max(e.row,n.row),o=[];for(let t=r;t<=i;t+=1)o.push(t);t.hideRows(o);const s=o[o.length-1],a=this.rowIndexMapper.getNearestNotHiddenIndex(s,1,!0);Number.isInteger(a)&&a>=0?this.selectRows(a):this.deselectCell(),this.render(),this.view.adjustElementsSize()},disabled:!1,hidden(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}),function(e){const t=[];return{key:"hidden_rows_show",name(){const e=t.length>1?1:0;return this.getTranslatedPhrase(uT,e)},callback(){var n,r;if(0===t.length)return;let i=t[0],o=t[t.length-1];i=null!==(n=this.rowIndexMapper.getNearestNotHiddenIndex(i-1,-1))&&void 0!==n?n:0,o=null!==(r=this.rowIndexMapper.getNearestNotHiddenIndex(o+1,1))&&void 0!==r?r:this.countRows()-1,e.showRows(t),this.render(),this.view.adjustElementsSize(),o-i+1===this.countRows()||this.selectRows(i,o)},disabled:!1,hidden(){const n=Dd(e.getHiddenRows(),(e=>this.toPhysicalRow(e)));if(!this.selection.isSelectedByRowHeader()&&!this.selection.isSelectedByCorner()||n.length<1)return!0;t.length=0;const r=this.getSelectedRangeLast(),i=r.getTopStartCorner().row,o=r.getBottomEndCorner().row,s=this.rowIndexMapper,a=s.getRenderableFromVisualIndex(i),l=s.getRenderableFromVisualIndex(o),h=s.getNotTrimmedIndexes(),u=[];if(i!==o){if(o-i+1>l-a+1){const e=h.slice(i,o+1);u.push(...e.filter((e=>n.includes(e))))}}else if(0===a&&a<i)u.push(...h.slice(0,i));else if(null===a)u.push(...h.slice(0,this.countRows()));else{const e=this.countRows()-1;l===s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(e,-1))&&e>o&&u.push(...h.slice(o+1))}return Vd(u,(e=>{t.push(this.toVisualRow(e))})),0===t.length}}}(this))}function fj(){const e=this.getSetting("rows");Array.isArray(e)&&this.hideRows(e)}function wj(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function yj(e,t){return e.get(Cj(e,t))}function vj(e,t,n){return e.set(Cj(e,t),n),n}function Cj(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}Rf.getSingleton().register("beforeColumnFreeze"),Rf.getSingleton().register("afterColumnFreeze"),Rf.getSingleton().register("beforeColumnUnfreeze"),Rf.getSingleton().register("afterColumnUnfreeze");const Sj="manualColumnFreeze";var Rj=new WeakMap,Ej=new WeakSet;class bj extends Hx{constructor(){var e,t;super(...arguments),wj(e=this,t=Ej),t.add(e),function(e,t,n){wj(e,t),t.set(e,n)}(this,Rj,!1)}static get PLUGIN_KEY(){return Sj}static get PLUGIN_PRIORITY(){return 110}isEnabled(){return!!this.hot.getSettings()[Sj]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",(e=>Cj(Ej,this,Tj).call(this,e))),this.addHook("beforeColumnMove",((e,t)=>Cj(Ej,this,Nj).call(this,e,t))),super.enablePlugin())}disablePlugin(){vj(Rj,this,!1),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}freezeColumn(e){const t=this.hot.getSettings(),n=t.fixedColumnsStart<this.hot.countCols()&&e>t.fixedColumnsStart-1;yj(Rj,this)||vj(Rj,this,!0);!1!==this.hot.runHooks("beforeColumnFreeze",e,n)&&(n&&(this.hot.columnIndexMapper.moveIndexes(e,t.fixedColumnsStart),t._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",e,n))}unfreezeColumn(e){const t=this.hot.getSettings(),n=t.fixedColumnsStart>0&&e<=t.fixedColumnsStart-1;yj(Rj,this)||vj(Rj,this,!0);!1!==this.hot.runHooks("beforeColumnUnfreeze",e,n)&&(n&&(t._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(e,t.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",e,n))}}function Tj(e){var t;e.items.push({name:"---------"},(t=this,{key:"freeze_column",name(){return this.getTranslatedPhrase(Fb)},callback(e,n){const[{start:{col:r}}]=n;t.freezeColumn(r),this.render(),this.view.adjustElementsSize()},hidden(){const e=this.getSelectedRange();let t=!1;return(void 0===e||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(t=!0),t}}),function(e){return{key:"unfreeze_column",name(){return this.getTranslatedPhrase(Db)},callback(t,n){const[{start:{col:r}}]=n;e.unfreezeColumn(r),this.render(),this.view.adjustElementsSize()},hidden(){const e=this.getSelectedRange();let t=!1;return(void 0===e||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col>=this.getSettings().fixedColumnsStart)&&(t=!0),t}}}(this))}function Nj(e,t){if(yj(Rj,this)){const n=this.hot.getSettings().fixedColumnsStart;if(t<n)return!1;if(e.some((e=>e<n)))return!1}}function Aj(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const Mj="px";const Ij=class{constructor(e){Aj(this,"hot",void 0),Aj(this,"_element",null),Aj(this,"state",0),Aj(this,"inlineProperty",void 0),this.hot=e,this.inlineProperty=e.isRtl()?"right":"left"}appendTo(e){e.appendChild(this._element),this.state=2}build(){0===this.state&&(this._element=this.hot.rootDocument.createElement("div"),this.state=1)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=0}isAppended(){return 2===this.state}isBuilt(){return this.state>=1}setPosition(e,t){Zw(e)&&(this._element.style.top=e+Mj),Zw(t)&&(this._element.style[this.inlineProperty]=t+Mj)}getPosition(){const e=this._element.style;return{top:e.top?parseInt(e.top,10):0,start:e[this.inlineProperty]?parseInt(e[this.inlineProperty],10):0}}setSize(e,t){Zw(e)&&(this._element.style.width=e+Mj),Zw(t)&&(this._element.style.height=t+Mj)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,t){Zw(e)&&(this._element.style.marginTop=e+Mj),Zw(t)&&(this._element.style[`margin${op(this.inlineProperty)}`]=t+Mj)}getOffset(){const e=this._element.style,t=`margin${op(this.inlineProperty)}`;return{top:e.marginTop?parseInt(e.marginTop,10):0,start:e[t]?parseInt(e[t],10):0}}};const Oj=class extends Ij{build(){super.build(),Fp(this._element,"ht__manualColumnMove--backlight")}};const xj=class extends Ij{build(){super.build(),Fp(this._element,"ht__manualColumnMove--guideline")}};function Pj(e,t,n){_j(e,t),t.set(e,n)}function _j(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Lj(e,t,n){return e.set(kj(e,t),n),n}function Hj(e,t){return e.get(kj(e,t))}function kj(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}Rf.getSingleton().register("beforeColumnMove"),Rf.getSingleton().register("afterColumnMove");const Fj="manualColumnMove",Dj="ht__manualColumnMove",Vj="show-ui",Uj="on-moving--columns",Bj="after-selection--columns";var Wj=new WeakMap,jj=new WeakMap,Gj=new WeakMap,zj=new WeakMap,$j=new WeakMap,Yj=new WeakMap,Kj=new WeakMap,Xj=new WeakMap,qj=new WeakMap,Qj=new WeakMap,Zj=new WeakMap,Jj=new WeakSet;class eG extends Hx{constructor(){var e,t;super(...arguments),_j(e=this,t=Jj),t.add(e),Pj(this,Wj,new Oj(this.hot)),Pj(this,jj,new xj(this.hot)),Pj(this,Gj,[]),Pj(this,zj,0),Pj(this,$j,!1),Pj(this,Yj,{}),Pj(this,Kj,void 0),Pj(this,Xj,void 0),Pj(this,qj,void 0),Pj(this,Qj,void 0),Pj(this,Zj,void 0)}static get PLUGIN_KEY(){return Fj}static get PLUGIN_PRIORITY(){return 120}isEnabled(){return!!this.hot.getSettings()[Fj]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return kj(Jj,e,tG).call(e,...n)})),this.addHook("beforeOnCellMouseOver",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return kj(Jj,e,rG).call(e,...n)})),this.addHook("afterScrollVertically",(()=>kj(Jj,this,oG).call(this))),this.addHook("afterLoadData",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return kj(Jj,e,sG).call(e,...n)})),this.buildPluginUI(),this.registerEvents(),Fp(this.hot.rootElement,Dj),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){Dp(this.hot.rootElement,Dj),this.unregisterEvents(),Hj(Wj,this).destroy(),Hj(jj,this).destroy(),super.disablePlugin()}moveColumn(e,t){return this.moveColumns([e],t)}moveColumns(e,t){const n=Hj(Kj,this),r=this.isMovePossible(e,t),i=this.hot.runHooks("beforeColumnMove",e,t,n,r);if(Lj(Kj,this,void 0),!1===i)return;r&&this.hot.columnIndexMapper.moveIndexes(e,t);const o=r&&this.isColumnOrderChanged(e,t);return this.hot.runHooks("afterColumnMove",e,t,n,r,o),o}dragColumn(e,t){return this.dragColumns([e],t)}dragColumns(e,t){const n=this.countFinalIndex(e,t);return Lj(Kj,this,t),this.moveColumns(e,n)}isMovePossible(e,t){const n=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),r=e.length+t>n,i=t<0,o=e.some((e=>e<0)),s=e.some((e=>e>=n));return!(r||i||o||s)}isColumnOrderChanged(e,t){return e.some(((e,n)=>e-n!==t))}countFinalIndex(e,t){const n=kd(e,((e,n)=>(n<t&&(e+=1),e)),0);return t-n}getColumnsWidth(e,t){const n=this.hot.columnIndexMapper;let r=0;for(let i=e;i<=t;i+=1){const e=n.getRenderableFromVisualIndex(i);i<0?r+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:null!==e&&(r+=this.hot.view._wt.wtTable.getColumnWidth(e)||0)}return r}moveBySettingsOrLoad(){const e=this.hot.getSettings()[Fj];if(Array.isArray(e))this.moveColumns(e,0);else if(void 0!==e){const e=this.persistentStateLoad();e.length&&this.moveColumns(e,0)}}isFixedColumnsStart(e){return e<this.hot.getSettings().fixedColumnsStart}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",e),e.value?e.value:[]}prepareColumnsToMoving(e,t){const n=[];return Jw(e,t,(e=>{n.push(e)})),n}refreshPositions(){const e=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(Hj(Xj,this))&&e>0&&this.hot.scrollViewportTo({col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(e-1,-1)});const t=this.hot.view._wt.wtTable,n=this.hot.view._wt.wtOverlays.scrollableElement,r="number"==typeof n.scrollX?n.scrollX:n.scrollLeft;let i=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,Hj(Xj,this)-1);const o=t.hider.offsetWidth,s=t.TBODY.offsetLeft,a=Hj(Wj,this).getOffset().start,l=Hj(Wj,this).getSize().width;let h=0,u=0;if(this.hot.isRtl()){const e=this.hot.rootWindow,t=tg(this.hot.rootElement),i=e.innerWidth-Hj(qj,this)-t;u=e.innerWidth-Hj(Yj,this).eventPageX-i-(void 0===n.scrollX?r:0)}else u=Hj(Yj,this).eventPageX-(Hj(qj,this)-(void 0===n.scrollX?r:0));if(Hj(Qj,this)&&(h=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(Hj(Xj,this))&&(i+=r),i+=h,Hj(Xj,this)<0)Hj(Zj,this)>0?Hj(Yj,this).col=0:Hj(Yj,this).col=e>0?e-1:e;else if(Hj(Yj,this).TD.offsetWidth/2+i<=u){const e=Hj(Xj,this)>=Hj(zj,this)?Hj(zj,this)-1:Hj(Xj,this);Hj(Yj,this).col=e+1,i+=Hj(Yj,this).TD.offsetWidth}else Hj(Yj,this).col=Hj(Xj,this);let c=u,d=i;u+l+a>=o?c=o-l-a:u+a<s+h&&(c=s+h+Math.abs(a)),i>=o-1?d=o-1:0===d?d=1:void 0!==n.scrollX&&Hj(Xj,this)<Hj(Zj,this)&&(d-=Hj(qj,this)<=n.scrollX?Hj(qj,this):0),Hj(Wj,this).setPosition(null,c),Hj(jj,this).setPosition(null,d)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",(e=>kj(Jj,this,nG).call(this,e))),this.eventManager.addEventListener(e,"mouseup",(()=>kj(Jj,this,iG).call(this)))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){Hj(Wj,this).build(),Hj(jj,this).build()}destroy(){Hj(Wj,this).destroy(),Hj(jj,this).destroy(),super.destroy()}}function tG(e,t,n,r){const i=this.hot.view._wt.wtTable,o=this.hot.selection.isSelectedByColumnHeader(),s=this.hot.getSelectedRangeLast(),a=kp(e.target,"sortAction");if(!s||!o||Hj($j,this)||0!==e.button||a)return Lj($j,this,!1),Hj(Gj,this).length=0,void Dp(this.hot.rootElement,[Uj,Vj]);const l=Hj(jj,this).isBuilt()&&!Hj(jj,this).isAppended(),h=Hj(Wj,this).isBuilt()&&!Hj(Wj,this).isAppended();l&&h&&(Hj(jj,this).appendTo(i.hider),Hj(Wj,this).appendTo(i.hider));const{from:u,to:c}=s,d=Math.min(u.col,c.col),p=Math.max(u.col,c.col);if(t.row<0&&t.col>=d&&t.col<=p){r.column=!0,Lj($j,this,!0);const o=n.firstChild?function(e,t){const n={x:e.offsetX,y:e.offsetY};let r=e.target;if(!vg(t)||r!==t&&r.contains(t))return n;for(;r!==t;)n.x+=r.offsetLeft,n.y+=r.offsetTop,r=r.offsetParent;return n}(e,n.firstChild).x:e.offsetX;Hj(Yj,this).eventPageX=e.pageX,Lj(Xj,this,t.col),Hj(Yj,this).TD=n,Hj(Yj,this).col=t.col,Lj(Gj,this,this.prepareColumnsToMoving(d,p)),Lj(Qj,this,!!this.hot.getSettings().rowHeaders),Lj(zj,this,this.hot.countCols()),Lj(Zj,this,this.hot.getSettings().fixedColumnsStart),Lj(qj,this,Yp(this.hot.rootElement).left);const s=Hj(Qj,this)?-1:0,a=i.holder.scrollTop+i.getColumnHeaderHeight(0)+1,l=t.col<Hj(Zj,this),h=this.hot.view._wt.wtOverlays.inlineStartOverlay.getOverlayOffset(),u=Math.abs(o-(this.hot.isRtl()?n.offsetWidth:0)),c=this.getColumnsWidth(d,t.col-1)+u,g=this.getColumnsWidth(s,d-1)+(l?h:0)+c;Hj(Wj,this).setPosition(a,g),Hj(Wj,this).setSize(this.getColumnsWidth(d,p),i.hider.offsetHeight-a),Hj(Wj,this).setOffset(null,-c),Fp(this.hot.rootElement,Uj)}else Dp(this.hot.rootElement,Bj),Lj($j,this,!1),Hj(Gj,this).length=0}function nG(e){Hj($j,this)&&(Hj(Yj,this).eventPageX=e.pageX,this.refreshPositions())}function rG(e,t,n,r){this.hot.getSelectedRangeLast()&&Hj($j,this)&&(Hj(Gj,this).indexOf(t.col)>-1?Dp(this.hot.rootElement,Vj):Fp(this.hot.rootElement,Vj),r.row=!0,r.column=!0,r.cell=!0,Lj(Xj,this,t.col),Hj(Yj,this).TD=n)}function iG(){const e=Hj(Yj,this).col,t=Hj(Gj,this).length;if(Lj(Xj,this,void 0),Lj($j,this,!1),Dp(this.hot.rootElement,[Uj,Vj,Bj]),this.hot.selection.isSelectedByColumnHeader()&&Fp(this.hot.rootElement,Bj),t<1||void 0===e)return;const n=Hj(Gj,this)[0],r=this.hot.toPhysicalColumn(n),i=this.dragColumns(Hj(Gj,this),e);if(Hj(Gj,this).length=0,!0===i){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize();const e=this.hot.toVisualColumn(r),n=e+t-1;this.hot.selectColumns(e,n)}}function oG(){const e=this.hot.view._wt.wtTable,t=e.getColumnHeaderHeight(0)+1+e.holder.scrollTop;Hj(Wj,this).setPosition(t),Hj(Wj,this).setSize(null,e.hider.offsetHeight-t)}function sG(){this.moveBySettingsOrLoad()}function aG(e,t,n){lG(e,t),t.set(e,n)}function lG(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function hG(e,t,n){return e.set(cG(e,t),n),n}function uG(e,t){return e.get(cG(e,t))}function cG(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}const dG="manualColumnResize",pG="manualColumnWidths";var gG=new WeakMap,mG=new WeakMap,fG=new WeakMap,wG=new WeakMap,yG=new WeakMap,vG=new WeakMap,CG=new WeakMap,SG=new WeakMap,RG=new WeakMap,EG=new WeakMap,bG=new WeakMap,TG=new WeakMap,NG=new WeakMap,AG=new WeakMap,MG=new WeakMap,IG=new WeakMap,OG=new WeakSet;class xG extends Hx{static get PLUGIN_KEY(){return dG}static get PLUGIN_PRIORITY(){return 130}constructor(e){var t,n;super(e),lG(t=this,n=OG),n.add(t),aG(this,gG,null),aG(this,mG,null),aG(this,fG,[]),aG(this,wG,null),aG(this,yG,null),aG(this,vG,null),aG(this,CG,null),aG(this,SG,null),aG(this,RG,this.hot.rootDocument.createElement("DIV")),aG(this,EG,this.hot.rootDocument.createElement("DIV")),aG(this,bG,null),aG(this,TG,!1),aG(this,NG,0),aG(this,AG,null),aG(this,MG,void 0),aG(this,IG,void 0),Fp(uG(RG,this),"manualColumnResizer"),Fp(uG(EG,this),"manualColumnResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[dG]}enablePlugin(){var e=this;this.enabled||(hG(MG,this,new kE),uG(MG,this).addLocalHook("init",(()=>cG(OG,this,PG).call(this))),this.hot.columnIndexMapper.registerMap(this.pluginName,uG(MG,this)),this.addHook("modifyColWidth",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return cG(OG,e,DG).call(e,...n)}),1),this.addHook("beforeStretchingColumnWidth",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return cG(OG,e,VG).call(e,...n)}),1),this.addHook("beforeColumnResize",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return cG(OG,e,UG).call(e,...n)})),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){hG(IG,this,uG(MG,this).getValues()),this.hot.columnIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualColumnWidths(){this.hot.runHooks("persistentStateSave",pG,uG(MG,this).getValues())}loadManualColumnWidths(){const e={};return this.hot.runHooks("persistentStateLoad",pG,e),e.value}setManualSize(e,t){const n=Math.max(t,20),r=this.hot.toPhysicalColumn(e);return uG(MG,this).setValueAtIndex(r,n),n}clearManualSize(e){const t=this.hot.toPhysicalColumn(e);uG(MG,this).setValueAtIndex(t,null)}setupHandlePosition(e){if(!e.parentNode)return;hG(gG,this,e);const{_wt:t}=this.hot.view,n=t.wtTable.getCoords(uG(gG,this)),r=n.col;if(r<0)return;const i=ng(uG(gG,this)),o=uG(gG,this).getBoundingClientRect();let s;r<t.getSetting("fixedColumnsStart")&&(s=t.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(uG(gG,this),n.row,n.col)),s||(s=t.wtOverlays.topOverlay.getRelativeCellPosition(uG(gG,this),n.row,n.col)),hG(mG,this,this.hot.columnIndexMapper.getVisualFromRenderableIndex(r)),hG(fG,this,[]);const a=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&a){Vd(this.hot.getSelectedRange(),(e=>{Jw(e.getTopStartCorner().col,e.getBottomEndCorner().col,(e=>{uG(fG,this).includes(e)||uG(fG,this).push(e)}))}))}uG(fG,this).includes(uG(mG,this))||hG(fG,this,[uG(mG,this)]),hG(SG,this,s.start-6),hG(CG,this,parseInt(o.width,10)),uG(RG,this).style.top=`${s.top}px`,uG(RG,this).style[this.inlineDir]=`${uG(SG,this)+uG(CG,this)}px`,uG(RG,this).style.height=`${i}px`,this.hot.rootElement.appendChild(uG(RG,this))}refreshHandlePosition(){uG(RG,this).style[this.inlineDir]=`${uG(SG,this)+uG(wG,this)}px`}setupGuidePosition(){const e=parseInt(ng(uG(RG,this)),10),t=parseInt(uG(RG,this).style.top,10)+e,n=parseInt(this.hot.view.maximumVisibleElementHeight(0),10);Fp(uG(RG,this),"active"),Fp(uG(EG,this),"active"),uG(EG,this).style.top=`${t}px`,this.refreshGuidePosition(),uG(EG,this).style.height=n-e+"px",this.hot.rootElement.appendChild(uG(EG,this))}refreshGuidePosition(){uG(EG,this).style[this.inlineDir]=uG(RG,this).style[this.inlineDir]}hideHandleAndGuide(){Dp(uG(RG,this),"active"),Dp(uG(EG,this),"active")}checkIfColumnHeader(e){const t=Op(e,["THEAD"],this.hot.rootElement),{topOverlay:n,topInlineStartCornerOverlay:r}=this.hot.view._wt.wtOverlays;return[n.clone.wtTable.THEAD,r.clone.wtTable.THEAD].includes(t)}getClosestTHParent(e){return"TABLE"!==e.tagName?"TH"===e.tagName?e:this.getClosestTHParent(e.parentNode):null}afterMouseDownTimeout(){const e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize()},t=(t,n)=>{const r=this.hot.runHooks("beforeColumnResize",uG(yG,this),t,!0);void 0!==r&&hG(yG,this,r),this.setManualSize(t,uG(yG,this)),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",uG(yG,this),t,!0),n&&e()};if(uG(NG,this)>=2){uG(fG,this).length>1?(Vd(uG(fG,this),(e=>{t(e)})),e()):Vd(uG(fG,this),(e=>{t(e,!0)}))}hG(NG,this,0),hG(AG,this,null)}bindEvents(){const{rootWindow:e,rootElement:t}=this.hot;this.eventManager.addEventListener(t,"mouseover",(e=>cG(OG,this,_G).call(this,e))),this.eventManager.addEventListener(t,"mousedown",(e=>cG(OG,this,LG).call(this,e))),this.eventManager.addEventListener(e,"mousemove",(e=>cG(OG,this,HG).call(this,e))),this.eventManager.addEventListener(e,"mouseup",(()=>cG(OG,this,kG).call(this))),this.eventManager.addEventListener(uG(RG,this),"contextmenu",(()=>cG(OG,this,FG).call(this)))}destroy(){super.destroy()}}function PG(){const e=this.hot.getSettings()[dG],t=this.loadManualColumnWidths();void 0!==t?this.hot.batchExecution((()=>{t.forEach(((e,t)=>{uG(MG,this).setValueAtIndex(t,e)}))}),!0):Array.isArray(e)?(this.hot.batchExecution((()=>{e.forEach(((e,t)=>{uG(MG,this).setValueAtIndex(t,e)}))}),!0),hG(IG,this,e)):!0===e&&Array.isArray(uG(IG,this))&&this.hot.batchExecution((()=>{uG(IG,this).forEach(((e,t)=>{uG(MG,this).setValueAtIndex(t,e)}))}),!0)}function _G(e){if(!fg(e.target)&&!0!==uG(TG,this)&&this.checkIfColumnHeader(e.target)){const t=this.getClosestTHParent(e.target);if(!t)return;const n=t.getAttribute("colspan");!t||null!==n&&"1"!==n||uG(bG,this)||this.setupHandlePosition(t)}}function LG(e){e.target.parentNode===this.hot.rootElement&&kp(e.target,"manualColumnResizer")&&(this.setupHandlePosition(uG(gG,this)),this.setupGuidePosition(),hG(bG,this,!0),null===uG(AG,this)&&(hG(AG,this,setTimeout((()=>this.afterMouseDownTimeout()),500)),this.hot._registerTimeout(uG(AG,this))),hG(NG,this,uG(NG,this)+1),this.startX=e.pageX,hG(yG,this,uG(CG,this)))}function HG(e){if(uG(bG,this)){const t=(e.pageX-this.startX)*this.hot.getDirectionFactor();hG(wG,this,uG(CG,this)+t),Vd(uG(fG,this),(e=>{hG(yG,this,this.setManualSize(e,uG(wG,this)))})),this.refreshHandlePosition(),this.refreshGuidePosition()}}function kG(){const e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize()},t=(t,n)=>{this.hot.runHooks("beforeColumnResize",uG(yG,this),t,!1),n&&e(),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",uG(yG,this),t,!1)};if(uG(bG,this)){if(this.hideHandleAndGuide(),hG(bG,this,!1),uG(yG,this)!==uG(CG,this)){uG(fG,this).length>1?(Vd(uG(fG,this),(e=>{t(e)})),e()):Vd(uG(fG,this),(e=>{t(e,!0)}))}this.setupHandlePosition(uG(gG,this))}}function FG(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(uG(RG,this)),this.hot.rootElement.removeChild(uG(EG,this)),hG(bG,this,!1),hG(TG,this,!0),this.hot._registerImmediate((()=>{hG(TG,this,!1)}))}function DG(e,t){let n=e;if(this.enabled){const e=this.hot.toPhysicalColumn(t),r=uG(MG,this).getValueAtIndex(e);this.hot.getSettings()[dG]&&r&&(n=r)}return n}function VG(e,t){const n=uG(MG,this).getValueAtIndex(this.hot.toPhysicalColumn(t));return"number"==typeof n?n:e}function UG(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}function BG(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const WG="px";const jG=class{constructor(e){BG(this,"hot",void 0),BG(this,"_element",null),BG(this,"state",0),this.hot=e}appendTo(e){e.appendChild(this._element),this.state=2}build(){0===this.state&&(this._element=this.hot.rootDocument.createElement("div"),this.state=1)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=0}isAppended(){return 2===this.state}isBuilt(){return this.state>=1}setPosition(e,t){void 0!==e&&(this._element.style.top=e+WG),void 0!==t&&(this._element.style.left=t+WG)}getPosition(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}setSize(e,t){e&&(this._element.style.width=e+WG),t&&(this._element.style.height=t+WG)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,t){e&&(this._element.style.marginTop=e+WG),t&&(this._element.style.marginLeft=t+WG)}getOffset(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}};const GG=class extends jG{build(){super.build(),Fp(this._element,"ht__manualRowMove--backlight")}};const zG=class extends jG{build(){super.build(),Fp(this._element,"ht__manualRowMove--guideline")}};function $G(e,t,n){YG(e,t),t.set(e,n)}function YG(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function KG(e,t,n){return e.set(qG(e,t),n),n}function XG(e,t){return e.get(qG(e,t))}function qG(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}Rf.getSingleton().register("beforeRowMove"),Rf.getSingleton().register("afterRowMove");const QG="manualRowMove",ZG="ht__manualRowMove",JG="show-ui",ez="on-moving--rows",tz="after-selection--rows";var nz=new WeakMap,rz=new WeakMap,iz=new WeakMap,oz=new WeakMap,sz=new WeakMap,az=new WeakMap,lz=new WeakSet;class hz extends Hx{constructor(){var e,t;super(...arguments),YG(e=this,t=lz),t.add(e),$G(this,nz,new GG(this.hot)),$G(this,rz,new zG(this.hot)),$G(this,iz,[]),$G(this,oz,void 0),$G(this,sz,{}),$G(this,az,void 0)}static get PLUGIN_KEY(){return QG}static get PLUGIN_PRIORITY(){return 140}isEnabled(){return!!this.hot.getSettings()[QG]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return qG(lz,e,uz).call(e,...n)})),this.addHook("beforeOnCellMouseOver",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return qG(lz,e,dz).call(e,...n)})),this.addHook("afterScrollHorizontally",(()=>qG(lz,this,gz).call(this))),this.addHook("afterLoadData",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return qG(lz,e,mz).call(e,...n)})),this.buildPluginUI(),this.registerEvents(),Fp(this.hot.rootElement,ZG),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){Dp(this.hot.rootElement,ZG),this.unregisterEvents(),XG(nz,this).destroy(),XG(rz,this).destroy(),super.disablePlugin()}moveRow(e,t){return this.moveRows([e],t)}moveRows(e,t){const n=XG(az,this),r=this.isMovePossible(e,t),i=this.hot.runHooks("beforeRowMove",e,t,n,r);if(KG(az,this,void 0),!1===i)return;r&&this.hot.rowIndexMapper.moveIndexes(e,t);const o=r&&this.isRowOrderChanged(e,t);return this.hot.runHooks("afterRowMove",e,t,n,r,o),o}dragRow(e,t){return this.dragRows([e],t)}dragRows(e,t){const n=this.countFinalIndex(e,t);return KG(az,this,t),this.moveRows(e,n)}isMovePossible(e,t){const n=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),r=e.length+t>n,i=t<0,o=e.some((e=>e<0)),s=e.some((e=>e>=n));return!(r||i||o||s)}isRowOrderChanged(e,t){return e.some(((e,n)=>e-n!==t))}countFinalIndex(e,t){const n=kd(e,((e,n)=>(n<t&&(e+=1),e)),0);return t-n}getRowsHeight(e,t){const n=this.hot.rowIndexMapper;let r=0;for(let i=e;i<=t;i++){const e=n.getRenderableFromVisualIndex(i);null!==e&&(r+=this.hot.view._wt.wtTable.getRowHeight(e)||this.hot.view.getDefaultRowHeight())}return r}moveBySettingsOrLoad(){const e=this.hot.getSettings()[QG];if(Array.isArray(e))this.moveRows(e,0);else if(void 0!==e){const e=this.persistentStateLoad();e.length&&this.moveRows(e,0)}}isFixedRowTop(e){return e<this.hot.getSettings().fixedRowsTop}isFixedRowBottom(e){return e>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualRowMove",e),e.value?e.value:[]}prepareRowsToMoving(){const e=this.hot.getSelectedRangeLast(),t=[];if(!e)return t;const{from:n,to:r}=e;return Jw(Math.min(n.row,r.row),Math.max(n.row,r.row),(e=>{t.push(e)})),t}refreshPositions(){const e=XG(sz,this).coords,t=this.hot.getFirstFullyVisibleRow(),n=this.hot.getLastFullyVisibleRow(),r=this.hot.countRows();this.isFixedRowTop(e.row)&&t>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(t-1,-1)),this.isFixedRowBottom(e.row)&&n<r&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(n+1,1),void 0,!0);const i=this.hot.view._wt.wtTable,o=XG(sz,this).TD,s=this.hot.rootElement,a=Yp(s),l=Jp(s),h=i.holder.scrollTop,u=this.hot.rootWindow!==l?l.scrollTop:0,c=a.top-u,d=XG(sz,this).eventPageY-c+h,p=i.hider.offsetHeight,g=i.TBODY.offsetTop,m=XG(nz,this).getOffset().top,f=XG(nz,this).getSize().height,w=o.offsetHeight/2,y=o.offsetHeight;let v=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,e.row-1);const C=d>=v+w;this.isFixedRowTop(e.row)&&(v+=this.hot.view._wt.wtOverlays.topOverlay.getOverlayOffset()),e.row<0?XG(sz,this).row=t>0?t-1:t:C?(XG(sz,this).row=e.row+1,v+=0===e.row?y-1:y):XG(sz,this).row=e.row;let S=d,R=v;d+f+m>=p?S=p-f-m:d+m<g&&(S=g+Math.abs(m)),v>=p-1&&(R=p-1),XG(nz,this).setPosition(S),XG(rz,this).setPosition(R)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",(e=>qG(lz,this,cz).call(this,e))),this.eventManager.addEventListener(e,"mouseup",(()=>qG(lz,this,pz).call(this)))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){XG(nz,this).build(),XG(rz,this).build()}destroy(){XG(nz,this).destroy(),XG(rz,this).destroy(),super.destroy()}}function uz(e,t,n,r){const{wtTable:i,wtViewport:o}=this.hot.view._wt,s=this.hot.selection.isSelectedByRowHeader(),a=this.hot.getSelectedRangeLast();if(!a||!s||XG(oz,this)||0!==e.button)return KG(oz,this,!1),XG(iz,this).length=0,void Dp(this.hot.rootElement,[ez,JG]);const l=XG(rz,this).isBuilt()&&!XG(rz,this).isAppended(),h=XG(nz,this).isBuilt()&&!XG(nz,this).isAppended();l&&h&&(XG(rz,this).appendTo(i.hider),XG(nz,this).appendTo(i.hider));const{from:u,to:c}=a,d=Math.min(u.row,c.row),p=Math.max(u.row,c.row);if(t.col<0&&t.row>=d&&t.row<=p){r.row=!0,KG(oz,this,!0),XG(sz,this).eventPageY=e.pageY,XG(sz,this).coords=t,XG(sz,this).TD=n,KG(iz,this,this.prepareRowsToMoving());const s=i.holder.scrollLeft+o.getRowHeaderWidth(),a=this.getRowsHeight(d,t.row-1)+(e.clientY-n.getBoundingClientRect().top);XG(nz,this).setPosition(null,s),XG(nz,this).setSize(i.hider.offsetWidth-s,this.getRowsHeight(d,p)),XG(nz,this).setOffset(-a,null),Fp(this.hot.rootElement,ez),this.refreshPositions()}else Dp(this.hot.rootElement,tz),KG(oz,this,!1),XG(iz,this).length=0}function cz(e){XG(oz,this)&&(XG(sz,this).eventPageY=e.pageY,this.refreshPositions())}function dz(e,t,n,r){this.hot.getSelectedRangeLast()&&XG(oz,this)&&(XG(iz,this).indexOf(t.row)>-1?Dp(this.hot.rootElement,JG):Fp(this.hot.rootElement,JG),r.row=!0,r.column=!0,r.cell=!0,XG(sz,this).coords=t,XG(sz,this).TD=n)}function pz(){const e=XG(sz,this).row,t=XG(iz,this).length;if(KG(oz,this,!1),Dp(this.hot.rootElement,[ez,JG,tz]),this.hot.selection.isSelectedByRowHeader()&&Fp(this.hot.rootElement,tz),t<1||void 0===e)return;const n=XG(iz,this)[0],r=this.hot.toPhysicalRow(n),i=this.dragRows(XG(iz,this),e);if(XG(iz,this).length=0,!0===i){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize();const e=this.hot.toVisualRow(r),n=e+t-1;this.hot.selectRows(e,n)}}function gz(){const e=this.hot.view._wt.wtTable,t=this.hot.view._wt.wtViewport.getRowHeaderWidth()+e.holder.scrollLeft;XG(nz,this).setPosition(null,t),XG(nz,this).setSize(e.hider.offsetWidth-t)}function mz(){this.moveBySettingsOrLoad()}function fz(e,t,n){wz(e,t),t.set(e,n)}function wz(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function yz(e,t,n){return e.set(Cz(e,t),n),n}function vz(e,t){return e.get(Cz(e,t))}function Cz(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}const Sz="manualRowResize",Rz="manualRowHeights";var Ez=new WeakMap,bz=new WeakMap,Tz=new WeakMap,Nz=new WeakMap,Az=new WeakMap,Mz=new WeakMap,Iz=new WeakMap,Oz=new WeakMap,xz=new WeakMap,Pz=new WeakMap,_z=new WeakMap,Lz=new WeakMap,Hz=new WeakMap,kz=new WeakMap,Fz=new WeakMap,Dz=new WeakMap,Vz=new WeakSet;class Uz extends Hx{static get PLUGIN_KEY(){return Sz}static get PLUGIN_PRIORITY(){return 30}constructor(e){var t,n;super(e),wz(t=this,n=Vz),n.add(t),fz(this,Ez,null),fz(this,bz,null),fz(this,Tz,[]),fz(this,Nz,null),fz(this,Az,null),fz(this,Mz,null),fz(this,Iz,null),fz(this,Oz,null),fz(this,xz,this.hot.rootDocument.createElement("DIV")),fz(this,Pz,this.hot.rootDocument.createElement("DIV")),fz(this,_z,!1),fz(this,Lz,!1),fz(this,Hz,0),fz(this,kz,null),fz(this,Fz,void 0),fz(this,Dz,void 0),Fp(vz(xz,this),"manualRowResizer"),Fp(vz(Pz,this),"manualRowResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[Sz]}enablePlugin(){this.enabled||(yz(Fz,this,new kE),vz(Fz,this).addLocalHook("init",(()=>Cz(Vz,this,Yz).call(this))),this.hot.rowIndexMapper.registerMap(this.pluginName,vz(Fz,this)),this.addHook("modifyRowHeight",((e,t)=>Cz(Vz,this,$z).call(this,e,t))),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){yz(Dz,this,vz(Fz,this).getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualRowHeights(){this.hot.runHooks("persistentStateSave",Rz,vz(Fz,this).getValues())}loadManualRowHeights(){const e={};return this.hot.runHooks("persistentStateLoad",Rz,e),e.value}setManualSize(e,t){const n=this.hot.toPhysicalRow(e),r=Math.max(t,this.hot.view.getDefaultRowHeight());return vz(Fz,this).setValueAtIndex(n,r),r}getLastDesiredRowHeight(){return vz(Nz,this)}setupHandlePosition(e){yz(Ez,this,e);const{view:t}=this.hot,{_wt:n}=t,r=n.wtTable.getCoords(vz(Ez,this)),i=r.row;if(i<0)return;const o=tg(vz(Ez,this)),s=vz(Ez,this).getBoundingClientRect(),a=i<n.getSetting("fixedRowsTop"),l=i>=t.countNotHiddenRowIndexes(0,1)-n.getSetting("fixedRowsBottom");let h;a?h=n.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(vz(Ez,this),r.row,r.col):l&&(h=n.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(vz(Ez,this),r.row,r.col)),h||(h=n.wtOverlays.inlineStartOverlay.getRelativeCellPosition(vz(Ez,this),r.row,r.col)),yz(bz,this,this.hot.rowIndexMapper.getVisualFromRenderableIndex(i)),yz(Tz,this,[]);const u=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&u){Vd(this.hot.getSelectedRange(),(e=>{Jw(e.getTopStartCorner().row,e.getBottomStartCorner().row,(e=>{vz(Tz,this).includes(e)||vz(Tz,this).push(e)}))}))}vz(Tz,this).includes(vz(bz,this))||yz(Tz,this,[vz(bz,this)]),yz(Oz,this,h.top-6),yz(Iz,this,parseInt(s.height,10)),vz(xz,this).style.top=`${vz(Oz,this)+vz(Iz,this)}px`,vz(xz,this).style[this.inlineDir]=`${h.start}px`,vz(xz,this).style.width=`${o}px`,this.hot.rootElement.appendChild(vz(xz,this))}refreshHandlePosition(){vz(xz,this).style.top=`${vz(Oz,this)+vz(Nz,this)}px`}setupGuidePosition(){const e=parseInt(tg(vz(xz,this)),10),t=parseInt(vz(xz,this).style[this.inlineDir],10)+e,n=parseInt(this.hot.view.maximumVisibleElementWidth(0),10);Fp(vz(xz,this),"active"),Fp(vz(Pz,this),"active"),vz(Pz,this).style.top=vz(xz,this).style.top,vz(Pz,this).style[this.inlineDir]=`${t}px`,vz(Pz,this).style.width=n-e+"px",this.hot.rootElement.appendChild(vz(Pz,this))}refreshGuidePosition(){vz(Pz,this).style.top=vz(xz,this).style.top}hideHandleAndGuide(){Dp(vz(xz,this),"active"),Dp(vz(Pz,this),"active")}checkIfRowHeader(e){const t=Op(e,["TBODY"],this.hot.rootElement),{inlineStartOverlay:n,topInlineStartCornerOverlay:r,bottomInlineStartCornerOverlay:i}=this.hot.view._wt.wtOverlays;return[n.clone.wtTable.TBODY,r.clone.wtTable.TBODY,i.clone.wtTable.TBODY].includes(t)}getClosestTHParent(e){return"TABLE"!==e.tagName?"TH"===e.tagName?e:this.getClosestTHParent(e.parentNode):null}getActualRowHeight(e){const t=this.hot.view._wt.wtTable.getRowHeight(e);return void 0!==t&&vz(Az,this)<t?t:vz(Az,this)}afterMouseDownTimeout(){const e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize()},t=(t,n)=>{const r=this.hot.runHooks("beforeRowResize",this.getActualRowHeight(t),t,!0);void 0!==r&&yz(Az,this,r),this.setManualSize(t,vz(Az,this)),this.hot.runHooks("afterRowResize",this.getActualRowHeight(t),t,!0),n&&e()};if(vz(Hz,this)>=2){vz(Tz,this).length>1?(Vd(vz(Tz,this),(e=>{t(e)})),e()):Vd(vz(Tz,this),(e=>{t(e,!0)}))}yz(Hz,this,0),yz(kz,this,null)}bindEvents(){const{rootElement:e,rootWindow:t}=this.hot;this.eventManager.addEventListener(e,"mouseover",(e=>Cz(Vz,this,Bz).call(this,e))),this.eventManager.addEventListener(e,"mousedown",(e=>Cz(Vz,this,Wz).call(this,e))),this.eventManager.addEventListener(t,"mousemove",(e=>Cz(Vz,this,jz).call(this,e))),this.eventManager.addEventListener(t,"mouseup",(()=>Cz(Vz,this,Gz).call(this))),this.eventManager.addEventListener(vz(xz,this),"contextmenu",(()=>Cz(Vz,this,zz).call(this)))}destroy(){super.destroy()}}function Bz(e){if(!fg(e.target)&&!0!==vz(Lz,this)&&this.checkIfRowHeader(e.target)){const t=this.getClosestTHParent(e.target);t&&(vz(_z,this)||this.setupHandlePosition(t))}}function Wz(e){kp(e.target,"manualRowResizer")&&(this.setupHandlePosition(vz(Ez,this)),this.setupGuidePosition(),yz(_z,this,!0),null===vz(kz,this)&&(yz(kz,this,setTimeout((()=>this.afterMouseDownTimeout()),500)),this.hot._registerTimeout(vz(kz,this))),yz(Hz,this,vz(Hz,this)+1),yz(Mz,this,e.pageY),yz(Az,this,vz(Iz,this)))}function jz(e){vz(_z,this)&&(yz(Nz,this,vz(Iz,this)+(e.pageY-vz(Mz,this))),Vd(vz(Tz,this),(e=>{yz(Az,this,this.setManualSize(e,vz(Nz,this)))})),this.refreshHandlePosition(),this.refreshGuidePosition())}function Gz(){const e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize()},t=(t,n)=>{this.hot.runHooks("beforeRowResize",this.getActualRowHeight(t),t,!1),n&&e(),this.saveManualRowHeights(),this.hot.runHooks("afterRowResize",this.getActualRowHeight(t),t,!1)};if(vz(_z,this)){if(this.hideHandleAndGuide(),yz(_z,this,!1),vz(Az,this)!==vz(Iz,this)){vz(Tz,this).length>1?(Vd(vz(Tz,this),(e=>{t(e)})),e()):Vd(vz(Tz,this),(e=>{t(e,!0)}))}this.setupHandlePosition(vz(Ez,this))}}function zz(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(vz(xz,this)),this.hot.rootElement.removeChild(vz(Pz,this)),yz(_z,this,!1),yz(Lz,this,!0),this.hot._registerImmediate((()=>{yz(Lz,this,!1)}))}function $z(e,t){let n=e;if(this.enabled){const e=this.hot.toPhysicalRow(t),r=vz(Fz,this).getValueAtIndex(e);this.hot.getSettings()[Sz]&&r&&(n=r)}return n}function Yz(){const e=this.hot.getSettings()[Sz],t=this.loadManualRowHeights();this.hot.batchExecution((()=>{void 0!==t?t.forEach(((e,t)=>{vz(Fz,this).setValueAtIndex(t,e)})):Array.isArray(e)?(e.forEach(((e,t)=>{vz(Fz,this).setValueAtIndex(t,e)})),yz(Dz,this,e)):!0===e&&Array.isArray(vz(Dz,this))&&vz(Dz,this).forEach(((e,t)=>{vz(Fz,this).setValueAtIndex(t,e)}))}),!0)}Xm("flatMap");var Kz=F,Xz=sn,qz=Ss,Qz=Qh,Zz=Ti,Jz=F,e$=Ge,t$=sn,n$=Ss,r$=function(e,t){t&&"string"==typeof e||Xz(e);var n=Qz(e);return qz(Xz(void 0!==n?Kz(n,e):e))},i$=oa,o$=bh((function(){for(var e,t,n=this.iterator,r=this.mapper;;){if(t=this.inner)try{if(!(e=t$(Jz(t.next,t.iterator))).done)return e.value;this.inner=null}catch(Dm){i$(n,"throw",Dm)}if(e=t$(Jz(this.next,n)),this.done=!!e.done)return;try{this.inner=r$(r(e.value,this.counter++),!1)}catch(Dm){i$(n,"throw",Dm)}}}));function s$(e,t,n){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,n)}function a$(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l$(e,t){return e.get(u$(e,t))}function h$(e,t,n){return e.set(u$(e,t),n),n}function u$(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}Zz({target:"Iterator",proto:!0,real:!0,forced:false},{flatMap:function(e){return t$(this),e$(e),new o$(n$(this),{mapper:e,inner:null})}});var c$=new WeakMap;const d$=class{constructor(e,t,n,r,i,o){a$(this,"row",void 0),a$(this,"col",void 0),a$(this,"rowspan",void 0),a$(this,"colspan",void 0),a$(this,"removed",!1),a$(this,"cellCoordsFactory",void 0),a$(this,"cellRangeFactory",void 0),s$(this,c$,null),this.row=e,this.col=t,this.rowspan=n,this.colspan=r,this.cellCoordsFactory=i,this.cellRangeFactory=o}static NEGATIVE_VALUES_WARNING(e){let{row:t,col:n,rowspan:r,colspan:i}=e;return Wd`The merged cell declared with {row: ${t}, col: ${n},\x20
      rowspan: ${r}, colspan: ${i}} contains negative values, which is\x20
      not supported. It will not be added to the collection.`}static IS_OUT_OF_BOUNDS_WARNING(e){let{row:t,col:n}=e;return Wd`The merged cell declared at [${t}, ${n}] is positioned\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`}static IS_SINGLE_CELL(e){let{row:t,col:n}=e;return Wd`The merged cell declared at [${t}, ${n}] has both "rowspan"\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`}static ZERO_SPAN_WARNING(e){let{row:t,col:n}=e;return Wd`The merged cell declared at [${t}, ${n}] has "rowspan"\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`}static containsNegativeValues(e){let{row:t,col:n,rowspan:r,colspan:i}=e;return t<0||n<0||r<0||i<0}static isSingleCell(e){let{rowspan:t,colspan:n}=e;return 1===n&&1===t}static containsZeroSpan(e){let{rowspan:t,colspan:n}=e;return 0===n||0===t}static isOutOfBounds(e,t,n){return e.row<0||e.col<0||e.row>=t||e.row+e.rowspan-1>=t||e.col>=n||e.col+e.colspan-1>=n}normalize(e){const t=e.countRows(),n=e.countCols();this.row<0?this.row=0:this.row>t-1&&(this.row=t-1),this.col<0?this.col=0:this.col>n-1&&(this.col=n-1),this.row+this.rowspan>t-1&&(this.rowspan=t-this.row),this.col+this.colspan>n-1&&(this.colspan=n-this.col),h$(c$,this,null)}includes(e,t){return this.row<=e&&this.col<=t&&this.row+this.rowspan-1>=e&&this.col+this.colspan-1>=t}includesHorizontally(e){return this.col<=e&&this.col+this.colspan-1>=e}includesVertically(e){return this.row<=e&&this.row+this.rowspan-1>=e}shift(e,t){const n=e[0]||e[1],r=t+Math.abs(e[0]||e[1])-1,i=e[0]?"colspan":"rowspan",o=e[0]?"col":"row",s=Math.min(t,r),a=Math.max(t,r),l=this[o],h=this[o]+this[i]-1;if(l>=t&&(this[o]+=n),n>0)t<=h&&t>l&&(this[i]+=n);else if(n<0){if(s<=l&&a>=h)return this.removed=!0,h$(c$,this,null),!1;if(l>=s&&l<=a){const e=a-l+1,t=Math.abs(n)-e;this[o]-=t+n,this[i]-=e}else if(l<=s&&h>=a)this[i]+=n;else if(l<=s&&h>=s&&h<a){const e=h-s+1;this[i]-=e}}return h$(c$,this,null),!0}isFarther(e,t){return!e||("down"===t?e.row+e.rowspan-1<this.row+this.rowspan-1:"up"===t?e.row>this.row:"right"===t?e.col+e.colspan-1<this.col+this.colspan-1:"left"===t?e.col>this.col:null)}getLastRow(){return this.row+this.rowspan-1}getLastColumn(){return this.col+this.colspan-1}getRange(){return l$(c$,this)||h$(c$,this,this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))),l$(c$,this)}};function p$(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function g$(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function m$(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var f$=new WeakSet;class w${constructor(e){p$(this,f$),g$(this,"plugin",void 0),g$(this,"mergedCells",[]),g$(this,"mergedCellsMatrix",new Map),g$(this,"hot",void 0),this.plugin=e,this.hot=e.hot}static IS_OVERLAPPING_WARNING(e){let{row:t,col:n}=e;return Wd`The merged cell declared at [${t}, ${n}], overlaps\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\x20
      fix your setup.`}get(e,t){var n;return!!this.mergedCellsMatrix.has(e)&&(null!==(n=this.mergedCellsMatrix.get(e).get(t))&&void 0!==n&&n)}getByRange(e){const{row:t,col:n}=e.getTopStartCorner(),{row:r,col:i}=e.getBottomEndCorner(),o=this.mergedCells.length;let s=!1;for(let a=0;a<o;a++){const e=this.mergedCells[a],{row:o,col:l,rowspan:h,colspan:u}=e;if(o>=t&&o+h-1<=r&&l>=n&&l+u-1<=i){s=e;break}}return s}filterOverlappingMergeCells(e){const t=new Set;this.mergedCells.forEach((e=>{const{row:n,col:r,colspan:i,rowspan:o}=e;for(let s=n;s<n+o;s++)for(let e=r;e<r+i;e++)t.add(`r${s},c${e}`)}));return e.filter((e=>{const{row:n,col:r,colspan:i,rowspan:o}=e,s=new Set;let a=!1;for(let l=n;l<n+o;l++){for(let n=r;n<r+i;n++){const r=`r${l},c${n}`;if(t.has(r)){Fm(w$.IS_OVERLAPPING_WARNING(e)),a=!0;break}s.add(r)}if(a)break}return a||t.add(...s),!a}))}getWithinRange(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const{row:n,col:r}=e.getTopStartCorner(),{row:i,col:o}=e.getBottomEndCorner(),s=[];for(let a=n;a<=i;a++)for(let e=r;e<=o;e++){const n=this.get(a,e);n&&(t||!t&&n.row===a&&n.col===e)&&s.push(n)}return s}add(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=e.row,r=e.col,i=e.rowspan,o=e.colspan,s=new d$(n,r,i,o,this.hot._createCellCoords,this.hot._createCellRange),a=this.get(n,r),l=!t&&this.isOverlapping(s);return a||l?(l&&Fm(w$.IS_OVERLAPPING_WARNING(s)),!1):(this.hot&&s.normalize(this.hot),this.mergedCells.push(s),m$(f$,this,v$).call(this,s),s)}remove(e,t){const n=this.get(e,t),r=n?this.mergedCells.indexOf(n):-1;return!(!n||-1===r)&&(this.mergedCells.splice(r,1),m$(f$,this,C$).call(this,n),n)}clear(){Vd(this.mergedCells,(e=>{let{row:t,col:n,rowspan:r,colspan:i}=e;Jw(t,t+r,(e=>{Jw(n,n+i,(t=>{const n=this.hot.getCell(e,t);n&&(n.removeAttribute("rowspan"),n.removeAttribute("colspan"),n.style.display="")}))}))})),this.mergedCells.length=0,this.mergedCellsMatrix=new Map}isOverlapping(e){const t=e.getRange();for(let n=0;n<this.mergedCells.length;n++){if(this.mergedCells[n].getRange().overlaps(t))return!0}return!1}isFirstRenderableMergedCell(e,t){const n=this.get(e,t);if(!n)return!1;const{row:r,col:i,rowspan:o,colspan:s}=n,a=this.hot.view.getActiveOverlayName(),l=["top","top_inline_start_corner"].includes(a)?0:this.hot.getFirstRenderedVisibleRow(),h=["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(a)?0:this.hot.getFirstRenderedVisibleColumn(),u=ny(l,r,r+o-1),c=ny(h,i,i+s-1);return this.hot.rowIndexMapper.getNearestNotHiddenIndex(u,1)===e&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(c,1)===t}getFirstRenderableCoords(e,t){const n=this.get(e,t);if(!n||this.isFirstRenderableMergedCell(e,t))return this.hot._createCellCoords(e,t);const r=this.hot.rowIndexMapper.getNearestNotHiddenIndex(n.row,1),i=this.hot.columnIndexMapper.getNearestNotHiddenIndex(n.col,1);return this.hot._createCellCoords(r,i)}getStartMostColumnIndex(e,t){const n=m$(f$,this,y$).call(this,e,"col",-1);let r=t;for(let i=0;i<n.length;i++)if(n[i]<=t){r=n[i];break}return r}getEndMostColumnIndex(e,t){const n=m$(f$,this,y$).call(this,e,"col",1);let r=t;for(let i=0;i<n.length;i++)if(n[i]>=t){r=n[i];break}return r}getTopMostRowIndex(e,t){const n=m$(f$,this,y$).call(this,e,"row",-1);let r=t;for(let i=0;i<n.length;i++)if(n[i]<=t){r=n[i];break}return r}getBottomMostRowIndex(e,t){const n=m$(f$,this,y$).call(this,e,"row",1);let r=t;for(let i=0;i<n.length;i++)if(n[i]>=t){r=n[i];break}return r}shiftCollections(e,t,n){const r=[0,0];switch(e){case"right":r[0]+=n;break;case"left":r[0]-=n;break;case"down":r[1]+=n;break;case"up":r[1]-=n}const i=[];this.mergedCells.forEach((e=>{e.shift(r,t),e.removed&&i.push(e)})),i.forEach((e=>{this.mergedCells.splice(this.mergedCells.indexOf(e),1)})),this.mergedCellsMatrix.clear(),this.mergedCells.forEach((e=>{m$(f$,this,v$).call(this,e)}))}}function y$(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;const r=new Map,i=1===n?e.getTopStartCorner():e.getBottomEndCorner(),o=1===n?e.getBottomEndCorner():e.getTopStartCorner();for(let s=i.row;1===n?s<=o.row:s>=o.row;s+=n)for(let e=i.col;1===n?e<=o.col:e>=o.col;e+=n){const i="row"===t?s:e,o=this.get(s,e);let a=i;o&&(a=1===n?o[t]+o[`${t}span`]-1:o[t]),r.has(i)||r.set(i,new Set),r.get(i).add(a)}return Array.from(new Set(Array.from(r.entries()).filter((e=>{let[,t]=e;return 1===t.size})).flatMap((e=>{let[,t]=e;return Array.from(t)}))))}function v$(e){for(let t=e.row;t<e.row+e.rowspan;t++)for(let n=e.col;n<e.col+e.colspan;n++)this.mergedCellsMatrix.has(t)||this.mergedCellsMatrix.set(t,new Map),this.mergedCellsMatrix.get(t).set(n,e)}function C$(e){for(let t=e.row;t<e.row+e.rowspan;t++)for(let n=e.col;n<e.col+e.colspan;n++)this.mergedCellsMatrix.get(t).delete(n)}const S$=w$;function R$(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const E$=class{constructor(e){R$(this,"plugin",void 0),R$(this,"mergedCellsCollection",void 0),R$(this,"currentFillData",null),this.plugin=e,this.mergedCellsCollection=this.plugin.mergedCellsCollection}getDirection(e,t){let n=null;return n=t[0]===e[0]&&t[1]===e[1]&&t[3]===e[3]?"down":t[2]===e[2]&&t[1]===e[1]&&t[3]===e[3]?"up":t[1]===e[1]&&t[2]===e[2]?"right":"left",n}snapDragArea(e,t,n,r){const i=t.slice(0),o=this.getAutofillSize(e,t,n),[s,a,l,h]=e,u=["up","down"].indexOf(n)>-1?l-s+1:h-a+1,c=o-Math.floor(o/u)*u,d=this.getFarthestCollection(e,t,n,r);if(d)if("down"===n){const e=d.row+d.rowspan-s-c;i[2]+e>=this.plugin.hot.countRows()?i[2]-=c:i[2]+=c?e:0}else if("right"===n){const e=d.col+d.colspan-a-c;i[3]+e>=this.plugin.hot.countCols()?i[3]-=c:i[3]+=c?e:0}else if("up"===n){const e=l-c-d.row+1;i[0]+e<0?i[0]+=c:i[0]-=c?e:0}else if("left"===n){const e=h-c-d.col+1;i[1]+e<0?i[1]+=c:i[1]-=c?e:0}return this.updateCurrentFillCache({baseArea:e,dragDirection:n,foundMergedCells:r,fillSize:o,dragArea:i,cycleLength:u}),i}updateCurrentFillCache(e){this.currentFillData||(this.currentFillData={}),tm(this.currentFillData,e)}getAutofillSize(e,t,n){const[r,i,o,s]=e,[a,l,h,u]=t;switch(n){case"up":return r-a;case"down":return h-o;case"left":return i-l;case"right":return u-s;default:return null}}getDragArea(e,t,n){const[r,i,o,s]=e,[a,l,h,u]=t;switch(n){case"up":return[a,l,r-1,s];case"down":{const e=this.mergedCellsCollection.get(h,s);return[o+1,i,h+(e?e.rowspan-1:0),s]}case"left":return[a,l,o,i-1];case"right":{const e=this.mergedCellsCollection.get(h,s);return[r,s+(e?e.colspan-1:0),h,u]}default:return null}}getFarthestCollection(e,t,n,r){const[i,o,s,a]=e,l=["up","down"].indexOf(n)>-1,h=l?s:a,u=l?i:o,c=this.getAutofillSize(e,t,n),d=l?s-i+1:a-o+1,p=c-Math.floor(c/d)*d;let g=null,m=null,f=null;switch(n){case"up":g="includesVertically",f=h-p+1;break;case"left":g="includesHorizontally",f=h-p+1;break;case"down":g="includesVertically",f=u+p-1;break;case"right":g="includesHorizontally",f=u+p-1}return Vd(r,(e=>{e[g](f)&&e.isFarther(m,n)&&(m=e)})),m}recreateAfterDataPopulation(e){if(!this.currentFillData)return;const t=this.getRangeFromChanges(e),n=this.currentFillData.foundMergedCells,r=this.currentFillData.dragDirection,i=(e,n)=>{switch(r){case"up":return e.row-n>=t.from.row;case"down":return e.row+e.rowspan-1+n<=t.to.row;case"left":return e.col-n>=t.from.column;case"right":return e.col+e.colspan-1+n<=t.to.column;default:return null}};let o=0,s=null,a=1;do{for(let e=0;e<n.length;e+=1){if(s=n[e],o=a*this.currentFillData.cycleLength,i(s,o))switch(r){case"up":this.plugin.mergedCellsCollection.add({row:s.row-o,rowspan:s.rowspan,col:s.col,colspan:s.colspan},!0);break;case"down":this.plugin.mergedCellsCollection.add({row:s.row+o,rowspan:s.rowspan,col:s.col,colspan:s.colspan},!0);break;case"left":this.plugin.mergedCellsCollection.add({row:s.row,rowspan:s.rowspan,col:s.col-o,colspan:s.colspan},!0);break;case"right":this.plugin.mergedCellsCollection.add({row:s.row,rowspan:s.rowspan,col:s.col+o,colspan:s.colspan},!0)}e===n.length-1&&(a+=1)}}while(i(s,o));this.currentFillData=null,this.plugin.hot.render(),n.length>0&&this.plugin.ifChromeForceRepaint()}getRangeFromChanges(e){const t={min:null,max:null},n={min:null,max:null};return Vd(e,(e=>{const r=e[0],i=this.plugin.hot.propToCol(e[1]);(null===t.min||r<t.min)&&(t.min=r),(null===t.max||r>t.max)&&(t.max=r),(null===n.min||i<n.min)&&(n.min=i),(null===n.max||i>n.max)&&(n.max=i)})),{from:{row:t.min,column:n.min},to:{row:t.max,column:n.max}}}dragAreaOverlapsCollections(e,t,n){const r=this.getDragArea(e,t,n),[i,o,s,a]=r,l=this.plugin.hot._createCellCoords(i,o),h=this.plugin.hot._createCellCoords(s,a),u=this.plugin.hot._createCellRange(l,l,h);if(0===this.mergedCellsCollection.getWithinRange(u,!0).length)return!1;const c=this.mergedCellsCollection.getWithinRange(u,!1);return 0===c.length||("up"===n||"down"===n?!c.every((e=>{let{colspan:t}=e;return t===u.getWidth()})):!c.every((e=>{let{rowspan:t}=e;return t===u.getHeight()})))}};function b$(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const T$=class{constructor(e){b$(this,"plugin",void 0),b$(this,"hot",void 0),b$(this,"fullySelectedMergedCellClassName","fullySelectedMergedCell"),this.plugin=e,this.hot=e.hot}getSelectedMergedCellClassName(e,t,n,r){const i=Math.min(n[0],n[2]),o=Math.min(n[1],n[3]),s=Math.max(n[0],n[2]),a=Math.max(n[1],n[3]);if(void 0===r)return;if(!this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(e,t))return;const l=this.plugin.mergedCellsCollection.get(e,t);if(!l)return;const h=l.getLastRow(),u=l.getLastColumn();return i<=l.row&&o<=l.col&&s>=h&&a>=u?`${this.fullySelectedMergedCellClassName}-${r}`:this.isMergeCellFullySelected(l,this.plugin.hot.getSelectedRange())?`${this.fullySelectedMergedCellClassName}-multiple`:void 0}isMergeCellFullySelected(e,t){const n=[];if(!t||!e)return!1;for(let r=0;r<e.rowspan;r+=1)for(let t=0;t<e.colspan;t+=1)n.push(this.hot._createCellCoords(e.row+r,e.col+t));for(let r=0;r<n.length;r+=1){const e=[];for(let i=0;i<t.length;i+=1)e[i]=t[i].includes(n[r]);if(!e.includes(!0))return!1}return!0}getSelectedMergedCellClassNameToRemove(){const e=[];for(let t=0;t<=7;t+=1)e.push(`${this.fullySelectedMergedCellClassName}-${t}`);return e.push(`${this.fullySelectedMergedCellClassName}-multiple`),e}};function N$(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class A${constructor(e){N$(this,"data",void 0),N$(this,"next",null),N$(this,"prev",null),this.data=e}}const M$=class{constructor(){N$(this,"first",null),N$(this,"last",null)}push(e){const t=new A$(e);if(null===this.first)this.first=t,this.last=t;else{const e=this.last;this.last=t,t.prev=e,e.next=t}return t}unshift(e){const t=new A$(e);if(null===this.first)this.first=t,this.last=t;else{const e=this.first;this.first=t,t.next=e,e.prev=t}}inorder(e){let t=this.first;for(;t;){const n=e(t);if(t===this.last||!0===n)break;t=t.next}}remove(e){if(null===this.first)return!1;let t,n,r=this.first;for(;r;){if(r.data===e)return t=r.next,n=r.prev,t&&(t.prev=n),n&&(n.next=t),r===this.first&&(this.first=t),r===this.last&&(this.last=n),!0;r=r.next}return!1}hasCycle(){let e=this.first,t=this.first;for(;;){if(null===e)return!1;if(e=e.next,null===e)return!1;if(e=e.next,t=t.next,e===t)return!0}}pop(){if(null===this.last)return null;const e=this.last;return this.last=this.last.prev,e}shift(){if(null===this.first)return null;const e=this.first;return this.first=this.first.next,e}recursiveReverse(){if(!this.first)return;!function e(t,n){n&&(e(n,n.next),n.next=t)}(this.first,this.first.next),this.first.next=null;const e=this.first;this.first=this.last,this.last=e}reverse(){if(!this.first||!this.first.next)return;let e,t=this.first.next,n=this.first;for(;t;)e=t.next,t.next=n,n.prev=t,n=t,t=e;this.first.next=null,this.last.prev=null,e=this.first,this.first=n,this.last=e}};function I$(e,t,n){O$(e,t),t.set(e,n)}function O$(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function x$(e,t){return e.get(_$(e,t))}function P$(e,t,n){return e.set(_$(e,t),n),n}function _$(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var L$=new WeakMap,H$=new WeakMap,k$=new WeakMap,F$=new WeakMap,D$=new WeakMap,V$=new WeakMap,U$=new WeakMap,B$=new WeakSet;class W${constructor(e){let{mergedCellsGetter:t,rowIndexMapper:n,columnIndexMapper:r}=e;var i,o;O$(i=this,o=B$),o.add(i),I$(this,L$,new M$),I$(this,H$,new M$),I$(this,k$,null),I$(this,F$,null),I$(this,D$,null),I$(this,V$,null),I$(this,U$,null),P$(D$,this,t),P$(V$,this,n),P$(U$,this,r)}getCurrentVerticalNode(){return x$(F$,this).data}getFirstVerticalNode(){return x$(H$,this).first.data}getNextVerticalNode(){return x$(F$,this).next.data}getPrevVerticalNode(){return x$(F$,this).prev.data}getCurrentHorizontalNode(){return x$(k$,this).data}getFirstHorizontalNode(){return x$(L$,this).first.data}getNextHorizontalNode(){return x$(k$,this).next.data}getPrevHorizontalNode(){return x$(k$,this).prev.data}setPrevNodeAsActive(){P$(F$,this,x$(F$,this).prev),P$(k$,this,x$(k$,this).prev)}setNextNodeAsActive(){P$(F$,this,x$(F$,this).next),P$(k$,this,x$(k$,this).next)}buildFocusOrder(e){const t=e.getTopStartCorner(),n=e.getBottomEndCorner(),r=new WeakSet;P$(L$,this,new M$);for(let o=t.row;o<=n.row;o++)if(!x$(V$,this).isHidden(o))for(let i=t.col;i<=n.col;i++){if(x$(U$,this).isHidden(i))continue;const t=_$(B$,this,j$).call(this,e,x$(L$,this),r,o,i);t&&P$(k$,this,t)}x$(L$,this).first&&(x$(L$,this).first.prev=x$(L$,this).last,x$(L$,this).last.next=x$(L$,this).first);const i=new WeakSet;P$(H$,this,new M$);for(let o=t.col;o<=n.col;o++)if(!x$(U$,this).isHidden(o))for(let r=t.row;r<=n.row;r++){if(x$(V$,this).isHidden(r))continue;const t=_$(B$,this,j$).call(this,e,x$(H$,this),i,r,o);t&&P$(F$,this,t)}x$(H$,this).first&&(x$(H$,this).first.prev=x$(H$,this).last,x$(H$,this).last.next=x$(H$,this).first)}setActiveNode(e,t){return x$(L$,this).inorder((n=>{const{rowStart:r,rowEnd:i,colStart:o,colEnd:s}=n.data;if(e>=r&&e<=i&&t>=o&&t<=s)return P$(k$,this,n),!1})),x$(H$,this).inorder((n=>{const{rowStart:r,rowEnd:i,colStart:o,colEnd:s}=n.data;if(e>=r&&e<=i&&t>=o&&t<=s)return P$(F$,this,n),!1})),this}}function j$(e,t,n,r,i){const o=e.getTopStartCorner(),s=e.getBottomEndCorner(),a=e.highlight.clone().normalize(),l=x$(D$,this).call(this,r,i);if(l&&n.has(l))return null;const h={colStart:i,colEnd:i,rowStart:r,rowEnd:r};if(l){if(n.add(l),l.row<o.row||l.row+l.rowspan-1>s.row||l.col<o.col||l.col+l.colspan-1>s.col)return null;h.colStart=l.col,h.colEnd=l.col+l.colspan-1,h.rowStart=l.row,h.rowEnd=l.row+l.rowspan-1}const u=t.push(h);return r===a.row&&i===a.col||l&&a.row>=l.row&&a.row<=l.row+l.rowspan-1&&a.col>=l.col&&a.col<=l.col+l.colspan-1?u:null}function G$(e,t,n){z$(e,t),t.set(e,n)}function z$(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $$(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Y$(e,t,n){return e.set(X$(e,t),n),n}function K$(e,t){return e.get(X$(e,t))}function X$(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}Rf.getSingleton().register("beforeMergeCells"),Rf.getSingleton().register("afterMergeCells"),Rf.getSingleton().register("beforeUnmergeCells"),Rf.getSingleton().register("afterUnmergeCells");const q$="mergeCells",Q$=q$;var Z$=new WeakMap,J$=new WeakMap,eY=new WeakMap,tY=new WeakMap,nY=new WeakSet;class rY extends Hx{constructor(){var e,t;super(...arguments),z$(e=this,t=nY),t.add(e),$$(this,"mergedCellsCollection",null),$$(this,"autofillCalculations",null),$$(this,"selectionCalculations",null),G$(this,Z$,null),G$(this,J$,{row:0,col:0}),G$(this,eY,new W$({mergedCellsGetter:(e,t)=>this.mergedCellsCollection.get(e,t),rowIndexMapper:this.hot.rowIndexMapper,columnIndexMapper:this.hot.columnIndexMapper})),G$(this,tY,function(e){const{hot:t}=e,{rowIndexMapper:n,columnIndexMapper:r}=t;return{before:function(){},after:function(i,o,s){const a=e.mergedCellsCollection.get(o,s);if(!am(a))return i.removeAttribute("rowspan"),i.removeAttribute("colspan"),void(i.style.display="");const{row:l,col:h,colspan:u,rowspan:c}=a,[d,p]=e.translateMergedCellToRenderable(l,c,h,u),g=e.getSetting("virtualized"),m=d-n.getRenderableFromVisualIndex(o)+1,f=p-r.getRenderableFromVisualIndex(s)+1;let w=n.getNearestNotHiddenIndex(l,1),y=r.getNearestNotHiddenIndex(h,1);if(g){const e=t.view.getActiveOverlayName();["top","top_inline_start_corner"].includes(e)||(w=Math.max(w,t.getFirstRenderedVisibleRow())),["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(e)||(y=Math.max(y,t.getFirstRenderedVisibleColumn()))}const v=Math.min(c,m),C=Math.min(u,f);w===o&&y===s?(i.setAttribute("rowspan",v),i.setAttribute("colspan",C)):(i.removeAttribute("rowspan"),i.removeAttribute("colspan"),i.style.display="none")}}}(this))}static get PLUGIN_KEY(){return q$}static get PLUGIN_PRIORITY(){return 150}static get DEFAULT_SETTINGS(){return{[Ox]:"cells",virtualized:!1,cells:[]}}isEnabled(){return!!this.hot.getSettings()[q$]}enablePlugin(){var e=this;this.enabled||(this.mergedCellsCollection=new S$(this),this.autofillCalculations=new E$(this),this.selectionCalculations=new T$(this),this.addHook("afterInit",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return X$(nY,e,iY).call(e,...n)})),this.addHook("modifyTransformFocus",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return X$(nY,e,sY).call(e,...n)})),this.addHook("modifyTransformStart",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return X$(nY,e,aY).call(e,...n)})),this.addHook("modifyTransformEnd",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return X$(nY,e,lY).call(e,...n)})),this.addHook("beforeSelectionHighlightSet",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return X$(nY,e,hY).call(e,...n)})),this.addHook("beforeSetRangeStart",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return X$(nY,e,dY).call(e,...n)})),this.addHook("beforeSetRangeStartOnly",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return X$(nY,e,dY).call(e,...n)})),this.addHook("beforeSelectionFocusSet",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return X$(nY,e,pY).call(e,...n)})),this.addHook("afterSelectionFocusSet",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return X$(nY,e,gY).call(e,...n)})),this.addHook("afterSelectionEnd",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return X$(nY,e,mY).call(e,...n)})),this.addHook("modifyGetCellCoords",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return X$(nY,e,uY).call(e,...n)})),this.addHook("modifyGetCoordsElement",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return X$(nY,e,uY).call(e,...n)})),this.addHook("afterIsMultipleSelection",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return X$(nY,e,oY).call(e,...n)})),this.addHook("afterRenderer",(function(){return K$(tY,e).after(...arguments)})),this.addHook("afterContextMenuDefaultOptions",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return X$(nY,e,cY).call(e,...n)})),this.addHook("afterGetCellMeta",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return X$(nY,e,fY).call(e,...n)})),this.addHook("afterViewportRowCalculatorOverride",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return X$(nY,e,wY).call(e,...n)})),this.addHook("afterViewportColumnCalculatorOverride",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return X$(nY,e,yY).call(e,...n)})),this.addHook("modifyAutofillRange",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return X$(nY,e,vY).call(e,...n)})),this.addHook("afterCreateCol",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return X$(nY,e,CY).call(e,...n)})),this.addHook("afterRemoveCol",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return X$(nY,e,SY).call(e,...n)})),this.addHook("afterCreateRow",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return X$(nY,e,RY).call(e,...n)})),this.addHook("afterRemoveRow",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return X$(nY,e,EY).call(e,...n)})),this.addHook("afterChange",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return X$(nY,e,bY).call(e,...n)})),this.addHook("beforeDrawBorders",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return X$(nY,e,TY).call(e,...n)})),this.addHook("afterDrawSelection",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return X$(nY,e,NY).call(e,...n)})),this.addHook("beforeRemoveCellClassNames",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return X$(nY,e,AY).call(e,...n)})),this.addHook("beforeBeginEditing",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return X$(nY,e,MY).call(e,...n)})),this.addHook("modifyRowHeightByOverlayName",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return X$(nY,e,IY).call(e,...n)})),this.addHook("beforeUndoStackChange",((e,t)=>{if("MergeCells"===t)return!1})),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(),super.updatePlugin()}ifChromeForceRepaint(){if(!Sm())return;const e=[];let t=[];this.mergedCellsCollection.mergedCells.forEach((e=>{const{row:n,rowspan:r}=e;for(let i=n+1;i<n+r;i++)t.push(i)})),t=[...new Set(t)],t.forEach((t=>{const n=this.hot.rowIndexMapper.getRenderableFromVisualIndex(t);this.hot.view._wt.wtOverlays.getOverlays(!0).map((e=>"master"===(null==e?void 0:e.name)?e:e.clone.wtTable)).forEach((t=>{const r=t.getRow(n);r&&(r.style.background=eg(r,"backgroundColor").replace(")",", 0.99)"),e.push(r))}))})),this.hot._registerTimeout((()=>{e.forEach((e=>{e.style.background=eg(e,"backgroundColor").replace(", 0.99)",")")}))}),1)}validateSetting(e){return!!e&&(d$.containsNegativeValues(e)?(Fm(d$.NEGATIVE_VALUES_WARNING(e)),!1):d$.isOutOfBounds(e,this.hot.countRows(),this.hot.countCols())?(Fm(d$.IS_OUT_OF_BOUNDS_WARNING(e)),!1):d$.isSingleCell(e)?(Fm(d$.IS_SINGLE_CELL(e)),!1):!d$.containsZeroSpan(e)||(Fm(d$.ZERO_SPAN_WARNING(e)),!1))}generateFromSettings(){const e=this.getSetting("cells").filter((e=>this.validateSetting(e))),t=this.mergedCellsCollection.filterOverlappingMergeCells(e),n=[];t.forEach((e=>{const{row:t,col:r,rowspan:i,colspan:o}=e,s=this.hot._createCellCoords(t,r),a=this.hot._createCellCoords(t+i-1,r+o-1),l=this.hot._createCellRange(s,s,a);this.mergeRange(l,!0,!0);for(let h=t;h<t+i;h++)for(let e=r;e<r+o;e++)h===t&&e===r||n.push([h,e,null])})),0!==n.length&&this.hot.setDataAtCell(n,void 0,void 0,this.pluginName)}clearCollections(){this.mergedCellsCollection.clear()}canMergeRange(e){return!!(arguments.length>1&&void 0!==arguments[1]&&arguments[1])||this.validateSetting(e)}mergeSelection(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;e.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");const{from:t,to:n}=e;this.unmergeRange(e,!0),this.mergeRange(e),this.hot.selectCell(t.row,t.col,n.row,n.col,!1)}unmergeSelection(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;const{from:t,to:n}=e;this.unmergeRange(e,!0),this.hot.selectCell(t.row,t.col,n.row,n.col,!1)}mergeRange(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=e.getTopStartCorner(),i=e.getBottomEndCorner(),o={row:r.row,col:r.col,rowspan:i.row-r.row+1,colspan:i.col-r.col+1},s=[];let a=null;if(!this.canMergeRange(o,t))return!1;this.hot.runHooks("beforeMergeCells",e,t),Jw(0,o.rowspan-1,(e=>{Jw(0,o.colspan-1,(t=>{let n=null;s[e]||(s[e]=[]),0===e&&0===t?n=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(o.row),this.hot.toPhysicalColumn(o.col)):this.hot.setCellMeta(o.row+e,o.col+t,"hidden",!0),s[e][t]=n}))})),this.hot.setCellMeta(o.row,o.col,"spanned",!0);return!this.mergedCellsCollection.add(o,t)||(n?a=[o.row,o.col,s]:this.hot.populateFromArray(o.row,o.col,s,void 0,void 0,this.pluginName),t||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",e,o,t),a)}unmergeRange(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=this.mergedCellsCollection.getWithinRange(e);0!==n.length&&(this.hot.runHooks("beforeUnmergeCells",e,t),Vd(n,(e=>{this.mergedCellsCollection.remove(e.row,e.col),Jw(0,e.rowspan-1,(t=>{Jw(0,e.colspan-1,(n=>{this.hot.removeCellMeta(e.row+t,e.col+n,"hidden"),this.hot.removeCellMeta(e.row+t,e.col+n,"copyable")}))})),this.hot.removeCellMeta(e.row,e.col,"spanned")})),this.hot.runHooks("afterUnmergeCells",e,t),this.hot.render())}toggleMerge(e){const t=this.mergedCellsCollection.get(e.from.row,e.from.col);t.row===e.from.row&&t.col===e.from.col&&t.row+t.rowspan-1===e.to.row&&t.col+t.colspan-1===e.to.col?this.unmergeRange(e):this.mergeSelection(e)}merge(e,t,n,r){const i=this.hot._createCellCoords(e,t),o=this.hot._createCellCoords(n,r);this.mergeRange(this.hot._createCellRange(i,i,o))}unmerge(e,t,n,r){const i=this.hot._createCellCoords(e,t),o=this.hot._createCellCoords(n,r);this.unmergeRange(this.hot._createCellRange(i,i,o))}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control","m"]],callback:()=>{const e=this.hot.getSelectedRangeLast();e&&!e.isSingleHeader()&&(this.toggleMerge(e),this.hot.render())},runOnlyIf:e=>!e.altKey,group:Q$})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(Q$)}modifyViewportRowStart(e,t){const n=this.hot.rowIndexMapper,r=n.getVisualFromRenderableIndex(e.startRow);for(let i=0;i<t;i+=1){const o=this.mergedCellsCollection.get(r,i);if(am(o)){const r=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(o.row,1));if(r<e.startRow)return e.startRow=r,void this.modifyViewportRowStart(e,t)}}}modifyViewportRowEnd(e,t){const n=this.hot.rowIndexMapper,r=n.getVisualFromRenderableIndex(e.endRow);for(let i=0;i<t;i+=1){const o=this.mergedCellsCollection.get(r,i);if(am(o)){const r=o.row+o.rowspan-1,i=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(r,-1));if(i>e.endRow)return e.endRow=i,void this.modifyViewportRowEnd(e,t)}}}modifyViewportColumnStart(e,t){const n=this.hot.columnIndexMapper,r=n.getVisualFromRenderableIndex(e.startColumn);for(let i=0;i<t;i+=1){const o=this.mergedCellsCollection.get(i,r);if(am(o)){const r=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(o.col,1));if(r<e.startColumn)return e.startColumn=r,void this.modifyViewportColumnStart(e,t)}}}modifyViewportColumnEnd(e,t){const n=this.hot.columnIndexMapper,r=n.getVisualFromRenderableIndex(e.endColumn);for(let i=0;i<t;i+=1){const o=this.mergedCellsCollection.get(i,r);if(am(o)){const r=o.col+o.colspan-1,i=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(r,-1));if(i>e.endColumn)return e.endColumn=i,void this.modifyViewportColumnEnd(e,t)}}}translateMergedCellToRenderable(e,t,n,r){const{rowIndexMapper:i,columnIndexMapper:o}=this.hot;let s,a;s=0===t?i.getNearestNotHiddenIndex(e,1):i.getNearestNotHiddenIndex(e+t-1,-1),a=0===r?o.getNearestNotHiddenIndex(n,1):o.getNearestNotHiddenIndex(n+r-1,-1);return[e>=0?i.getRenderableFromVisualIndex(s):e,n>=0?o.getRenderableFromVisualIndex(a):n]}}function iY(){this.generateFromSettings(),this.hot.render()}function oY(e){if(e){const e=this.mergedCellsCollection.mergedCells,t=this.hot.getSelectedRangeLast(),n=t.getTopStartCorner(),r=t.getBottomEndCorner();for(let i=0;i<e.length;i+=1)if(n.row===e[i].row&&n.col===e[i].col&&r.row===e[i].row+e[i].rowspan-1&&r.col===e[i].col+e[i].colspan-1)return!1}return e}function sY(e){K$(J$,this).row=e.row,K$(J$,this).col=e.col}function aY(e){const t=this.hot.getSelectedRangeLast(),{highlight:n}=t,{columnIndexMapper:r,rowIndexMapper:i}=this.hot;K$(Z$,this)&&(null!==i.getRenderableFromVisualIndex(K$(Z$,this).row)&&(n.row=K$(Z$,this).row),null!==r.getRenderableFromVisualIndex(K$(Z$,this).col)&&(n.col=K$(Z$,this).col),Y$(Z$,this,null));const o=this.mergedCellsCollection.get(n.row,n.col);if(!o)return;const s=o.col,a=o.col+o.colspan-1;if(e.col<0){const t=n.col>=s&&n.col<=a?s-1:a,i=r.getNearestNotHiddenIndex(t,-1);e.col=null===i?-this.hot.view.countRenderableColumnsInRange(0,n.col):-Math.max(this.hot.view.countRenderableColumnsInRange(i,n.col)-1,1)}else if(e.col>0){const t=n.col>=s&&n.col<=a?a+1:s,i=r.getNearestNotHiddenIndex(t,1);e.col=null===i?this.hot.view.countRenderableColumnsInRange(n.col,this.hot.countCols()):Math.max(this.hot.view.countRenderableColumnsInRange(n.col,i)-1,1)}const l=o.row,h=o.row+o.rowspan-1;if(e.row<0){const t=n.row>=l&&n.row<=h?l-1:h,r=i.getNearestNotHiddenIndex(t,-1);e.row=null===r?-this.hot.view.countRenderableRowsInRange(0,n.row):-Math.max(this.hot.view.countRenderableRowsInRange(r,n.row)-1,1)}else if(e.row>0){const t=n.row>=l&&n.row<=h?h+1:l,r=i.getNearestNotHiddenIndex(t,1);e.row=null===r?this.hot.view.countRenderableRowsInRange(n.row,this.hot.countRows()):Math.max(this.hot.view.countRenderableRowsInRange(n.row,r)-1,1)}}function lY(e){const t=this.hot.getSelectedRangeLast(),n=t.clone(),{to:r}=t,{columnIndexMapper:i,rowIndexMapper:o}=this.hot,s=(e,t)=>{n.expand(this.hot._createCellCoords(e,t));for(let r=0;r<this.mergedCellsCollection.mergedCells.length;r+=1)n.expandByRange(this.mergedCellsCollection.mergedCells[r].getRange())};if(e.col<0){let o=this.mergedCellsCollection.getStartMostColumnIndex(t,r.col)+e.col;s(r.row,o),"E-W"===t.getHorizontalDirection()&&"E-W"===n.getHorizontalDirection()&&(o=n.getTopStartCorner().col);const a=i.getNearestNotHiddenIndex(o,1);null!==a&&(e.col=-Math.max(this.hot.view.countRenderableColumnsInRange(a,r.col)-1,1))}else if(e.col>0){let o=this.mergedCellsCollection.getEndMostColumnIndex(t,r.col)+e.col;s(r.row,o),"W-E"===t.getHorizontalDirection()&&"W-E"===n.getHorizontalDirection()&&(o=n.getBottomEndCorner().col);const a=i.getNearestNotHiddenIndex(o,-1);null!==a&&(e.col=Math.max(this.hot.view.countRenderableColumnsInRange(r.col,a)-1,1))}if(e.row<0){let i=this.mergedCellsCollection.getTopMostRowIndex(t,r.row)+e.row;s(i,r.col),"S-N"===t.getVerticalDirection()&&"S-N"===n.getVerticalDirection()&&(i=n.getTopStartCorner().row);const a=o.getNearestNotHiddenIndex(i,1);null!==a&&(e.row=-Math.max(this.hot.view.countRenderableRowsInRange(a,r.row)-1,1))}else if(e.row>0){let i=this.mergedCellsCollection.getBottomMostRowIndex(t,r.row)+e.row;s(i,r.col),"N-S"===t.getVerticalDirection()&&"N-S"===n.getVerticalDirection()&&(i=n.getBottomStartCorner().row);const a=o.getNearestNotHiddenIndex(i,-1);null!==a&&(e.row=Math.max(this.hot.view.countRenderableRowsInRange(r.row,a)-1,1))}}function hY(){const e=this.hot.getSelectedRangeLast(),{highlight:t}=e;if(this.hot.selection.isSelectedByColumnHeader()||this.hot.selection.isSelectedByRowHeader())return void Y$(Z$,this,t.clone());for(let r=0;r<this.mergedCellsCollection.mergedCells.length;r+=1)e.expandByRange(this.mergedCellsCollection.mergedCells[r].getRange(),!1);for(let r=0;r<this.mergedCellsCollection.mergedCells.length;r+=1)e.expandByRange(this.mergedCellsCollection.mergedCells[r].getRange(),!1);const n=this.mergedCellsCollection.get(t.row,t.col);Y$(Z$,this,t.clone()),n&&t.assign(n)}function uY(e,t,n,r){if(e<0||t<0)return;const i=this.mergedCellsCollection.get(e,t);if(!i)return;const{row:o,col:s,colspan:a,rowspan:l}=i,h=o,u=s,c=o+l-1,d=s+a-1;if("render"===r&&this.getSetting("virtualized")){const e=this.hot.view.getActiveOverlayName(),t=["top","top_inline_start_corner"].includes(e)?0:this.hot.getFirstRenderedVisibleRow(),n=["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(e)?0:this.hot.getFirstRenderedVisibleColumn();return[ny(t,h,c),ny(n,u,d),ny(this.hot.getLastRenderedVisibleRow(),h,c),ny(this.hot.getLastRenderedVisibleColumn(),u,d)]}return[h,u,c,d]}function cY(e){var t;e.items.push({name:"---------"},(t=this,{key:"mergeCells",name(){const e=this.getSelectedLast();if(e){const n=t.mergedCellsCollection.get(e[0],e[1]);if(n.row===e[0]&&n.col===e[1]&&n.row+n.rowspan-1===e[2]&&n.col+n.colspan-1===e[3])return this.getTranslatedPhrase(Ub)}return this.getTranslatedPhrase(Vb)},callback(){const e=this.getSelectedRangeLast();if(!e)return;e.setDirection(this.isRtl()?"NE-SW":"NW-SE");const{from:n,to:r}=e;t.toggleMerge(e),this.selectCell(n.row,n.col,r.row,r.col,!1)},disabled(){const e=this.getSelectedLast();return!e||d$.isSingleCell({row:e[0],col:e[1],rowspan:e[2]-e[0]+1,colspan:e[3]-e[1]+1})||this.selection.isSelectedByCorner()},hidden:!1}))}function dY(){Y$(Z$,this,null)}function pY(){if(K$(Z$,this).isCell())return;const e=this.hot.getSelectedRangeLast(),t=e.getVerticalDirection(),n=e.getHorizontalDirection(),r=K$(Z$,this).clone().normalize();K$(eY,this).setActiveNode(r.row,r.col),K$(J$,this).row>0||K$(J$,this).col>0?K$(eY,this).setPrevNodeAsActive():("E-W"===n&&K$(J$,this).col<0||"S-N"===t&&K$(J$,this).row<0)&&K$(eY,this).setNextNodeAsActive()}function gY(e,t){const n=this.hot.getSelectedRangeLast(),{columnIndexMapper:r,rowIndexMapper:i}=this.hot;let o=null,s=null;if(K$(J$,this).col<0){const{rowEnd:e,colEnd:t}=K$(eY,this).getPrevHorizontalNode();s=r.getNearestNotHiddenIndex(t,-1),o=i.getNearestNotHiddenIndex(e,-1)}else if(K$(J$,this).col>0){const{rowStart:e,colStart:t}=K$(eY,this).getNextHorizontalNode();s=r.getNearestNotHiddenIndex(t,1),o=i.getNearestNotHiddenIndex(e,1)}else if(K$(J$,this).row<0){const{rowEnd:e,colEnd:t}=K$(eY,this).getPrevVerticalNode();s=r.getNearestNotHiddenIndex(t,-1),o=i.getNearestNotHiddenIndex(e,-1)}else if(K$(J$,this).row>0){const{rowStart:e,colStart:t}=K$(eY,this).getNextVerticalNode();s=r.getNearestNotHiddenIndex(t,1),o=i.getNearestNotHiddenIndex(e,1)}if(null!==o||null!==s){const r=this.hot._createCellCoords(o,s),i=this.mergedCellsCollection.get(r.row,r.col),a=this.hot.selection.highlight.getFocus();e=r.row,t=r.col,i?n.highlight.assign({row:this.hot.rowIndexMapper.getNearestNotHiddenIndex(i.row,1),col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(i.col,1)}):n.highlight.assign(r),a.clear(),a.add(r).commit()}K$(eY,this).setActiveNode(e,t),Y$(J$,this,{row:0,col:0})}function mY(){this.hot.getSelectedRangeLast().isHeader()||K$(eY,this).buildFocusOrder(this.hot.getSelectedRangeLast())}function fY(e,t,n){const r=this.mergedCellsCollection.get(e,t);r&&(r.row!==e||r.col!==t?n.copyable=!1:(n.rowspan=r.rowspan,n.colspan=r.colspan))}function wY(e){if(this.getSetting("virtualized"))return;const t=this.hot.countCols();this.modifyViewportRowStart(e,t),this.modifyViewportRowEnd(e,t)}function yY(e){if(this.getSetting("virtualized"))return;const t=this.hot.countRows();this.modifyViewportColumnStart(e,t),this.modifyViewportColumnEnd(e,t)}function vY(e,t){const n=this.autofillCalculations.getDirection(t,e);if(this.autofillCalculations.dragAreaOverlapsCollections(t,e,n))return t;const r=this.hot._createCellCoords(t[0],t[1]),i=this.hot._createCellCoords(t[2],t[3]),o=this.hot._createCellRange(r,r,i),s=this.mergedCellsCollection.getWithinRange(o);return 0===s.length?e:this.autofillCalculations.snapDragArea(t,e,n,s)}function CY(e,t){this.mergedCellsCollection.shiftCollections("right",e,t)}function SY(e,t){this.mergedCellsCollection.shiftCollections("left",e,t)}function RY(e,t,n){"auto"!==n&&this.mergedCellsCollection.shiftCollections("down",e,t)}function EY(e,t){this.mergedCellsCollection.shiftCollections("up",e,t)}function bY(e,t){"Autofill.fill"===t&&this.autofillCalculations.recreateAfterDataPopulation(e)}function TY(e,t){if(t&&"area"===t){const t=this.hot.getSelectedRangeLast();Vd(this.mergedCellsCollection.getWithinRange(t),(n=>{t.getBottomEndCorner().row===n.getLastRow()&&t.getBottomEndCorner().col===n.getLastColumn()&&(e[2]=n.row,e[3]=n.col)}))}}function NY(e,t,n,r){if(n)return this.selectionCalculations.getSelectedMergedCellClassName(e,t,n,r)}function AY(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}function MY(e,t,n,r){if(!(r instanceof MouseEvent))return;const i=this.hot.getSelectedRangeLast(),o=this.mergedCellsCollection.getByRange(i);if(!o)return;const s=this.hot._createCellCoords(o.row,o.col),a=this.hot._createCellCoords(o.row+o.rowspan-1,o.col+o.colspan-1);return 0===this.hot.selection.getLayerLevel()&&i.isEqual(this.hot._createCellRange(s,s,a))}function IY(e,t,n){if(this.hot.getSettings().rowHeaders||"bottom"===n||"bottom_inline_start_corner"===n)return e;let r,i;if("master"===n)r=this.hot.getFirstRenderedVisibleColumn(),i=this.hot.getLastRenderedVisibleColumn();else{const e=this.hot.view.getOverlayByName(n);r=this.hot.columnIndexMapper.getVisualFromRenderableIndex(e.clone.wtTable.getFirstRenderedColumn()),i=this.hot.columnIndexMapper.getVisualFromRenderableIndex(e.clone.wtTable.getLastRenderedColumn())}if(!this.mergedCellsCollection.get(t,r))return e;const o=this.hot._createCellCoords(t,r),s=this.hot._createCellCoords(t,i),a=this.hot._createCellRange(o,o,s),l=this.mergedCellsCollection.getWithinRange(a,!0),h=l.reduce(((e,t)=>{let{rowspan:n}=t;return Math.max(e,n)}),1);let u=0;return l.length>1&&l[0].rowspan<h&&(u=h-l[0].rowspan),l.forEach((r=>{let{rowspan:i}=r,o=0;o="top"===n||"top_inline_start_corner"===n?Math.min(h,this.hot.view.countNotHiddenFixedRowsTop()-t):i-u,e=Math.max(null!=e?e:0,X$(nY,this,OY).call(this,t,o))})),e}function OY(e,t){const{view:n,rowIndexMapper:r}=this.hot,i=n.getStylesHandler(),o=n.getDefaultRowHeight();let s=0;for(let l=e;l<e+t;l++){var a;if(!r.isHidden(l))s+=null!==(a=this.hot.getRowHeight(l))&&void 0!==a?a:o,0!==l||i.isClassicTheme()||(s+=1)}return s}const xY="sort";function PY(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const _Y="multiColumnSorting",LY=_Y;y_(_Y,(function(e,t){return function(n,r){const[,...i]=n,[,...o]=r;return function n(r){const s=e[r],a=t[r],l=i[r],h=o[r],u=a.multiColumnSorting,c=(u.compareFunctionFactory?u.compareFunctionFactory:C_(a.type))(s,a,u)(l,h);if(c===S_){const e=r+1;if(void 0!==t[e])return n(e)}return c}(0)}}));class HY extends z_{constructor(){super(...arguments),PY(this,"pluginKey",_Y)}static get PLUGIN_KEY(){return _Y}static get PLUGIN_PRIORITY(){return 170}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){super.enablePlugin()}disablePlugin(){super.disablePlugin()}registerShortcuts(){super.registerShortcuts(),this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Shift","Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();return-1===e.row&&e.col>=0&&this.sort(this.getNextSortConfig(e.col,B_)),!1},runOnlyIf:()=>{var e,t;const n=null===(e=this.hot.getSelectedRangeLast())||void 0===e?void 0:e.highlight;return n&&(null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.isSingle())&&this.hot.selection.isCellVisible(n)&&n.isHeader()},relativeToGroup:qA,position:"before",group:LY})}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(LY)}sort(e){super.sort(e)}clearSort(){super.clearSort()}isSorted(){return super.isSorted()}getSortConfig(e){return super.getSortConfig(e)}setSortConfig(e){super.setSortConfig(e)}getNormalizedSortConfigs(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Array.isArray(e)?e:[e]}updateHeaderClasses(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];super.updateHeaderClasses(e,...n),Dp(e,function(e){const t=e.className.split(" "),n=new RegExp(`^${xY}-[0-9]{1,2}$`);return t.filter((e=>n.test(e)))}(e)),!1!==this.enabled&&Fp(e,function(e,t,n){const r=[];return!1===n||e.isColumnSorted(t)&&e.getNumberOfSortedColumns()>1&&r.push(`${xY}-${e.getIndexOfColumnInSortQueue(t)+1}`),r}(...n))}onAfterOnCellMouseDown(e,t){!1!==x_(t.row,t.col,e)&&this.wasClickableHeaderClicked(e,t.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(t.col),this.sort(this.getNextSortConfig(t.col,B_))):this.sort(this.getColumnNextConfig(t.col)))}}function kY(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class FY extends Hx{constructor(){super(...arguments),kY(this,"dragged",[]),kY(this,"lastSetCell",null)}static get PLUGIN_KEY(){return"multipleSelectionHandles"}static get PLUGIN_PRIORITY(){return 160}isEnabled(){return bm()}enablePlugin(){this.enabled||(this.registerListeners(),super.enablePlugin())}registerListeners(){const e=this,{rootElement:t}=this.hot;function n(t){if(1===e.dragged.length)return e.dragged.splice(0,e.dragged.length),!0;const n=e.dragged.indexOf(t);if(-1===n)return!1;0===n?e.dragged=e.dragged.slice(0,1):1===n&&(e.dragged=e.dragged.slice(-1))}this.eventManager.addEventListener(t,"touchstart",(t=>{let n;return kp(t.target,"topSelectionHandle-HitArea")?(n=e.hot.getSelectedRangeLast(),e.dragged.push("top"),e.touchStartRange={width:n.getWidth(),height:n.getHeight(),direction:n.getDirection()},t.preventDefault(),!1):kp(t.target,"bottomSelectionHandle-HitArea")?(n=e.hot.getSelectedRangeLast(),e.dragged.push("bottom"),e.touchStartRange={width:n.getWidth(),height:n.getHeight(),direction:n.getDirection()},t.preventDefault(),!1):void 0})),this.eventManager.addEventListener(t,"touchend",(t=>kp(t.target,"topSelectionHandle-HitArea")?(n.call(e,"top"),e.touchStartRange=void 0,t.preventDefault(),!1):kp(t.target,"bottomSelectionHandle-HitArea")?(n.call(e,"bottom"),e.touchStartRange=void 0,t.preventDefault(),!1):void 0)),this.eventManager.addEventListener(t,"touchmove",(t=>{const{rootDocument:n}=this.hot;let r,i,o,s,a,l;if(0===e.dragged.length)return;const h=n.elementFromPoint(t.touches[0].clientX,t.touches[0].clientY);h&&h!==e.lastSetCell&&("TD"!==h.nodeName&&"TH"!==h.nodeName||(r=e.hot.getCoords(h),-1===r.col&&(r.col=0),i=e.hot.getSelectedRangeLast(),o=i.getWidth(),s=i.getHeight(),a=i.getDirection(),1===o&&1===s&&e.hot.selection.setRangeEnd(r),l=e.getCurrentRangeCoords(i,r,e.touchStartRange.direction,a,e.dragged[0]),null!==l.start&&e.hot.selection.setRangeStart(l.start),e.hot.selection.setRangeEnd(l.end),e.lastSetCell=h),t.preventDefault())}))}getCurrentRangeCoords(e,t,n,r,i){const o=e.getTopStartCorner(),s=e.getBottomEndCorner(),a=e.getBottomStartCorner(),l=e.getTopEndCorner();let h={start:null,end:null};switch(n){case"NE-SW":switch(r){case"NE-SW":case"NW-SE":h="top"===i?{start:this.hot._createCellCoords(t.row,e.highlight.col),end:this.hot._createCellCoords(a.row,t.col)}:{start:this.hot._createCellCoords(e.highlight.row,t.col),end:this.hot._createCellCoords(t.row,o.col)};break;case"SE-NW":"bottom"===i&&(h={start:this.hot._createCellCoords(s.row,t.col),end:this.hot._createCellCoords(t.row,o.col)})}break;case"NW-SE":switch(r){case"NE-SW":"top"===i?h={start:t,end:a}:h.end=t;break;case"NW-SE":"top"===i?h={start:t,end:s}:h.end=t;break;case"SE-NW":"top"===i?h={start:t,end:o}:h.end=t;break;case"SW-NE":"top"===i?h={start:t,end:l}:h.end=t}break;case"SW-NE":switch(r){case"NW-SE":h="bottom"===i?{start:this.hot._createCellCoords(t.row,o.col),end:this.hot._createCellCoords(a.row,t.col)}:{start:this.hot._createCellCoords(o.row,t.col),end:this.hot._createCellCoords(t.row,s.col)};break;case"SW-NE":h="top"===i?{start:this.hot._createCellCoords(e.highlight.row,t.col),end:this.hot._createCellCoords(t.row,s.col)}:{start:this.hot._createCellCoords(t.row,o.col),end:this.hot._createCellCoords(o.row,t.col)};break;case"SE-NW":"bottom"===i?h={start:this.hot._createCellCoords(t.row,l.col),end:this.hot._createCellCoords(o.row,t.col)}:"top"===i&&(h={start:a,end:t})}break;case"SE-NW":switch(r){case"NW-SE":case"NE-SW":case"SW-NE":"top"===i&&(h.end=t);break;case"SE-NW":"top"===i?h.end=t:h={start:t,end:o}}}return h}isDragged(){return this.dragged.length>0}}function DY(){let{label:e="",colspan:t=1,origColspan:n=1,collapsible:r=!1,crossHiddenColumns:i=[],isCollapsed:o=!1,isHidden:s=!1,isRoot:a=!1,isPlaceholder:l=!1,headerClassNames:h=[]}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{label:e,colspan:t,origColspan:n,collapsible:r,isCollapsed:o,crossHiddenColumns:i,isHidden:s,isRoot:a,isPlaceholder:l,headerClassNames:h}}function VY(e,t,n){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,n)}function UY(e,t){return e.get(WY(e,t))}function BY(e,t,n){return e.set(WY(e,t),n),n}function WY(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}const jY=["label","collapsible"];var GY=new WeakMap,zY=new WeakMap,$Y=new WeakMap;class YY{constructor(){VY(this,GY,[]),VY(this,zY,0),VY(this,$Y,1/0)}setColumnsLimit(e){BY($Y,this,e)}setData(){BY(GY,this,function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0;const n=[];if(0===t)return n;Vd(e,(e=>{const r=[];let i=0;n.push(r),Vd(e,(e=>{const n=DY();if(am(e)){const{label:t,colspan:r,headerClassName:i}=e;n.label=jd(t),"number"==typeof r&&r>1&&(n.colspan=r,n.origColspan=r),"string"==typeof i&&(n.headerClassNames=[...i.split(" ")])}else n.label=jd(e);i+=n.origColspan;let o=!1;if(i>=t&&(n.colspan=n.origColspan-(i-t),n.origColspan=n.colspan,o=!0),r.push(n),n.colspan>1)for(let t=0;t<n.colspan-1;t++)r.push({label:"",isPlaceholder:!0});return!o}))}));const r=Math.max(...Dd(n,(e=>e.length)));return Vd(n,(e=>{if(e.length<r){const t=Dd(new Array(r-e.length),(()=>DY()));e.splice(e.length,0,...t)}})),n}(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],UY($Y,this))),BY(zY,this,UY(GY,this).length)}getData(){return UY(GY,this)}mergeWith(e){Vd(e,(e=>{let{row:t,col:n,...r}=e;const i=this.getHeaderSettings(t,n);null!==i&&tm(i,r,jY)}))}map(e){Vd(UY(GY,this),(t=>{Vd(t,(t=>{const n=e({...t});am(n)&&tm(t,n,jY)}))}))}getHeaderSettings(e,t){var n;if(e>=UY(zY,this)||e<0)return null;const r=UY(GY,this)[e];return!1===Array.isArray(r)||t>=r.length?null:null!==(n=r[t])&&void 0!==n?n:null}getHeadersSettings(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;const r=[];if(e>=UY(zY,this)||e<0)return r;const i=UY(GY,this)[e];let o=0;for(let s=t;s<i.length;s++){const e=i[s];if(e.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(o+=e.colspan,r.push(e),e.colspan>1&&(s+=e.colspan-1),o===n)break;if(o>n)throw new Error("The last column settings cannot overlap the other header layers")}return r}getLayersCount(){return UY(zY,this)}getColumnsCount(){return UY(zY,this)>0?UY(GY,this)[0].length:0}clear(){BY(GY,this,[]),BY(zY,this,0)}}function KY(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const XY="DF-pre-order";const qY=new Map([[XY,function e(t,n){let r=t.call(n,this);for(let i=0;i<this.childs.length;i++){if(!1===r)return!1;r=e.call(this.childs[i],t,n)}return r}],["DF-post-order",function e(t,n){for(let r=0;r<this.childs.length;r++){if(!1===e.call(this.childs[r],t,n))return!1}return t.call(n,this)}],["BF",function(e,t){const n=[this];!function r(){if(0===n.length)return;const i=n.shift();n.push(...i.childs),!1!==e.call(t,i)&&r()}()}]]);class QY{constructor(e){KY(this,"data",{}),KY(this,"parent",null),KY(this,"childs",[]),this.data=e}addChild(e){e.parent=this,this.childs.push(e)}cloneTree(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this;const t=new QY({...e.data});for(let n=0;n<e.childs.length;n++)t.addChild(this.cloneTree(e.childs[n]));return t}replaceTreeWith(e){this.data={...e.data},this.childs=[];for(let t=0;t<e.childs.length;t++)this.addChild(e.childs[t])}walkDown(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"BF";if(!qY.has(t))throw new Error(`Traversal strategy "${t}" does not exist`);qY.get(t).call(this,e,this)}walkUp(e){const t=this,n=r=>{!1!==e.call(t,r)&&null!==r.parent&&n(r.parent)};n(this)}}function ZY(e,t,n){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,n)}function JY(e,t){return e.get(eK(e,t))}function eK(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var tK=new WeakMap,nK=new WeakMap,rK=new WeakMap;class iK{constructor(e){var t,n,r;ZY(this,tK,new Map),ZY(this,nK,new Map),ZY(this,rK,null),n=this,r=e,(t=rK).set(eK(t,n),r)}getRoots(){return Array.from(JY(tK,this).values())}getRootByColumn(e){let t;return JY(nK,this).has(e)&&(t=JY(tK,this).get(JY(nK,this).get(e))),t}getNode(e,t){const n=this.getRootByColumn(t);if(!n)return;const r=t-JY(nK,this).get(t);let i,o=0;return n.walkDown((n=>{const{data:{origColspan:s,headerLevel:a}}=n;if(e===a){if(r>=o&&r<=o+s-1)return i=n,i.data.isRoot=t===i.data.columnIndex,!1;o+=s}})),i}rebuildTreeIndex(){let e=0;JY(nK,this).clear(),Vd(JY(tK,this),(t=>{let[,{data:{colspan:n}}]=t;for(let r=e;r<e+n;r++)JY(nK,this).set(r,e);e+=n}))}buildTree(){this.clear();const e=JY(rK,this).getColumnsCount();let t=0;for(;t<e;){const e=JY(rK,this).getHeaderSettings(0,t),n=new QY;JY(tK,this).set(t,n),this.buildLeaves(n,t,0,e.origColspan),t+=e.origColspan}this.rebuildTreeIndex()}buildLeaves(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;const i=JY(rK,this).getHeadersSettings(n,t,r);n+=1,Vd(i,(r=>{const i={...r,headerLevel:n-1,columnIndex:t};let o;1===n?(e.data=i,o=e):(o=new QY(i),e.addChild(o)),n<JY(rK,this).getLayersCount()&&this.buildLeaves(o,t,n,r.origColspan),t+=r.origColspan}))}clear(){JY(tK,this).clear(),JY(nK,this).clear()}}function oK(e,t){e.walkDown((e=>{let{data:n,childs:r}=e;if(!n.isHidden&&(t(n.columnIndex),0===r.length))for(let i=1;i<n.colspan;i++)t(n.columnIndex+i)}))}function sK(e,t){let{childs:n}=e;if(0!==n.length)return n[0].data[t]}function aK(e){return sK(e,"origColspan")===e.data.origColspan}function lK(e){const{data:t,childs:n}=e;if(!t.isCollapsed||t.isHidden||t.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(aK(e))return lK(n[0]);t.isCollapsed=!1;const r=n.slice(1),i=new Set;let o=0;if(r.length>0)Vd(r,(e=>{e.replaceTreeWith(e.data.clonedTree),e.data.clonedTree=null;const t=e.data;o+=t.colspan,oK(e,(e=>{i.add(e)}))}));else{const{colspan:e,origColspan:n,columnIndex:r}=t;o=n-e;for(let t=1;t<n;t++)i.add(r+t)}return e.walkUp((e=>{const{data:t}=e;t.colspan+=o,t.colspan>=t.origColspan?(t.colspan=t.origColspan,t.isCollapsed=!1):aK(e)&&(t.isCollapsed=sK(e,"isCollapsed"))})),{rollbackModification:()=>hK(e),affectedColumns:Array.from(i),colspanCompensation:o}}function hK(e){var t;const{data:n,childs:r}=e;if(n.isCollapsed||n.isHidden||n.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(aK(e))return hK(r[0]);n.isCollapsed=!0;const i=r.slice(1),o=new Set;if(i.length>0)Vd(i,(e=>{oK(e,(e=>{o.add(e)})),e.data.clonedTree=e.cloneTree(),e.walkDown((e=>{let{data:t}=e;t.isHidden=!0}))}));else{const{origColspan:e,columnIndex:t}=n;for(let n=1;n<e;n++){const e=t+n;o.add(e)}}const s=n.colspan-(null!==(t=sK(e,"colspan"))&&void 0!==t?t:1);return e.walkUp((e=>{const{data:t}=e;t.colspan-=s,t.colspan<=1?(t.colspan=1,t.isCollapsed=!0):aK(e)&&(t.isCollapsed=sK(e,"isCollapsed"))})),{rollbackModification:()=>lK(e),affectedColumns:Array.from(o),colspanCompensation:s}}const uK=new Map([["collapse",hK],["expand",lK],["hide-column",function(e,t){if(!Number.isInteger(t))throw new Error("The passed gridColumnIndex argument has invalid type.");if(e.childs.length>0)throw new Error(Wd`The passed node is not the last node on the tree. Only for\x20
the last node, the hide column modification can be applied.`);const{crossHiddenColumns:n}=e.data;if(n.includes(t))return;let r=!1;e.walkUp((e=>{const{data:{collapsible:t}}=e;if(t)return r=!0,!1})),r||e.walkUp((e=>{const{data:n}=e;n.crossHiddenColumns.push(t),n.colspan>1?n.colspan-=1:n.isHidden=!0}))}],["show-column",function(e,t){if(!Number.isInteger(t))throw new Error("The passed gridColumnIndex argument has invalid type.");if(e.childs.length>0)throw new Error(Wd`The passed node is not the last node on the tree. Only for\x20
the last node, the show column modification can be applied.`);const{crossHiddenColumns:n}=e.data;if(!n.includes(t))return;let r=!1;e.walkUp((e=>{const{data:{collapsible:t}}=e;if(t)return r=!0,!1})),r||e.walkUp((e=>{const{data:n}=e;n.crossHiddenColumns.splice(n.crossHiddenColumns.indexOf(t),1),!n.isHidden&&n.colspan<n.origColspan&&(n.colspan+=1),n.isHidden=!1}))}]]);function cK(e){const t=[];return Vd(e,(e=>{e.walkDown((e=>{const n=e.data,{origColspan:r,columnIndex:i,headerLevel:o,crossHiddenColumns:s}=n,a=function(e,t){let n;Array.isArray(e[t])?n=e[t]:(n=[],e[t]=n);return n}(t,o);let l=!1;for(let t=i;t<i+r;t++){if(s.includes(t)||l)a.push({label:"",isPlaceholder:!0});else{const e=dK(n);e.isRoot=!0,a.push(e),l=!0}}}))})),t}function dK(e){const{crossHiddenColumns:t,...n}=DY(e);return n}function pK(e,t,n){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,n)}function gK(e,t,n){return e.set(fK(e,t),n),n}function mK(e,t){return e.get(fK(e,t))}function fK(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var wK=new WeakMap,yK=new WeakMap,vK=new WeakMap;class CK{constructor(){pK(this,wK,new YY),pK(this,yK,new iK(mK(wK,this))),pK(this,vK,[[]])}setState(e){mK(wK,this).setData(e);let t=!1;try{mK(yK,this).buildTree()}catch(n){mK(yK,this).clear(),mK(wK,this).clear(),t=!0}return gK(vK,this,cK(mK(yK,this).getRoots())),t}setColumnsLimit(e){mK(wK,this).setColumnsLimit(e)}mergeStateWith(e){const t=Dd(e,(e=>{let{row:t,...n}=e;return{row:t<0?this.rowCoordsToLevel(t):t,...n}}));mK(wK,this).mergeWith(t),mK(yK,this).buildTree(),gK(vK,this,cK(mK(yK,this).getRoots()))}mapState(e){mK(wK,this).map(e),mK(yK,this).buildTree(),gK(vK,this,cK(mK(yK,this).getRoots()))}mapNodes(e){return kd(mK(yK,this).getRoots(),((t,n)=>(n.walkDown((n=>{const r=e(n.data);void 0!==r&&t.push(r)})),t)),[])}triggerNodeModification(e,t,n){t<0&&(t=this.rowCoordsToLevel(t));const r=mK(yK,this).getNode(t,n);let i;return r&&(i=function(e,t,n){if(!uK.has(e))throw new Error(`The node modifier action ("${e}") does not exist.`);return uK.get(e)(t,n)}(e,r,n),gK(vK,this,cK(mK(yK,this).getRoots()))),i}triggerColumnModification(e,t){return this.triggerNodeModification(e,-1,t)}rowCoordsToLevel(e){if(e>=0)return null;const t=e+Math.max(this.getLayersCount(),1);return t<0?null:t}levelToRowCoords(e){if(e<0)return null;const t=e-Math.max(this.getLayersCount(),1);return t>=0?null:t}getHeaderSettings(e,t){var n,r;return e<0&&(e=this.rowCoordsToLevel(e)),null===e||e>=this.getLayersCount()?null:null!==(n=null===(r=mK(vK,this)[e])||void 0===r?void 0:r[t])&&void 0!==n?n:null}getHeaderTreeNodeData(e,t){const n=this.getHeaderTreeNode(e,t);return n?{...n.data}:null}getHeaderTreeNode(e,t){if(e<0&&(e=this.rowCoordsToLevel(e)),null===e||e>=this.getLayersCount())return null;const n=mK(yK,this).getNode(e,t);return n||null}findTopMostEntireHeaderLevel(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;const n=t-e+1;let r=!1,i=null;for(let o=e;o<=t;o++){const s=mK(yK,this).getRootByColumn(o);if(!s)break;r=!0,s.walkDown((r=>{const{columnIndex:o,headerLevel:s,origColspan:a,isHidden:l}=r.data;l||a<=n&&o>=e&&o+a-1<=t&&(null===i||s<i)&&(i=s)}),XY)}return r&&null===i?-1:this.levelToRowCoords(null!=i?i:0)}findLeftMostColumnIndex(e,t){var n;const{isRoot:r}=null!==(n=this.getHeaderSettings(e,t))&&void 0!==n?n:{isRoot:!0};if(r)return t;let i=t-1;for(;i>=0;){var o;const{isRoot:t}=null!==(o=this.getHeaderSettings(e,i))&&void 0!==o?o:{isRoot:!0};if(t)break;i-=1}return i}findRightMostColumnIndex(e,t){var n;const{isRoot:r,origColspan:i}=null!==(n=this.getHeaderSettings(e,t))&&void 0!==n?n:{isRoot:!0,origColspan:1};if(r)return t+i-1;let o=t+1;for(;o<this.getColumnsCount();){var s;const{isRoot:t}=null!==(s=this.getHeaderSettings(e,o))&&void 0!==s?s:{isRoot:!0};if(t)break;o+=1}return o-1}getLayersCount(){return mK(wK,this).getLayersCount()}getColumnsCount(){return mK(wK,this).getColumnsCount()}clear(){gK(vK,this,[]),mK(wK,this).clear(),mK(yK,this).clear()}}function SK(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const RK=class{constructor(e,t){SK(this,"hot",void 0),SK(this,"nestedHeaderSettingsGetter",void 0),SK(this,"layersCount",0),SK(this,"container",void 0),SK(this,"widthsMap",void 0),this.hot=e,this.nestedHeaderSettingsGetter=t,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}setLayersCount(e){return this.layersCount=e,this}getWidth(e){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e))}buildWidthsMap(){const e=this.hot.getCurrentThemeName();this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),e&&this.container.classList.add(e),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);const t=this.container.querySelectorAll("tr:last-of-type th"),n=t.length;this.widthsMap.clear();for(let r=0;r<n;r++){const e=this.hot.columnIndexMapper.getVisualFromRenderableIndex(r),n=this.hot.toPhysicalColumn(e);this.widthsMap.setValueAtIndex(n,t[r].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}_buildGhostTable(e){const{rootDocument:t,columnIndexMapper:n}=this.hot,r=t.createDocumentFragment(),i=t.createElement("table"),o=!!this.hot.getSettings().dropdownMenu,s=n.getRenderableIndexesLength();for(let a=0;a<this.layersCount;a++){const e=t.createElement("tr");for(let r=0;r<s;r++){let i=n.getVisualFromRenderableIndex(r);null===i&&(i=r);const s=t.createElement("th"),l=this.nestedHeaderSettingsGetter(a,i);if(l&&(!l.isPlaceholder||l.isHidden)){let t=l.label;o&&(t+='<button class="changeType"></button>'),Gp(s,t),s.colSpan=l.colspan,e.appendChild(s)}}i.appendChild(e)}r.appendChild(i),e.appendChild(r)}clear(){this.widthsMap.clear(),this.container=null}};function EK(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function bK(e,t,n){TK(e,t),t.set(e,n)}function TK(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function NK(e,t,n){return e.set(MK(e,t),n),n}function AK(e,t){return e.get(MK(e,t))}function MK(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}const IK="nestedHeaders";var OK=new WeakMap,xK=new WeakMap,PK=new WeakMap,_K=new WeakMap,LK=new WeakMap,HK=new WeakSet;class kK extends Hx{constructor(){var e,t;super(...arguments),TK(e=this,t=HK),t.add(e),bK(this,OK,new CK),bK(this,xK,null),bK(this,PK,null),bK(this,_K,!1),bK(this,LK,null),EK(this,"ghostTable",new RK(this.hot,((e,t)=>this.getHeaderSettings(e,t)))),EK(this,"detectedOverlappedHeaders",!1)}static get PLUGIN_KEY(){return IK}static get PLUGIN_PRIORITY(){return 280}isEnabled(){return!!this.hot.getSettings()[IK]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:t}=this.hot.getSettings();Array.isArray(t)&&Array.isArray(t[0])||Fm(Wd`Your Nested Headers plugin configuration is invalid. The settings has to be\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`),this.addHook("init",(()=>MK(HK,this,JK).call(this))),this.addHook("afterLoadData",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return MK(HK,e,eX).call(e,...n)})),this.addHook("beforeOnCellMouseDown",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return MK(HK,e,BK).call(e,...n)})),this.addHook("afterOnCellMouseDown",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return MK(HK,e,WK).call(e,...n)})),this.addHook("beforeOnCellMouseOver",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return MK(HK,e,jK).call(e,...n)})),this.addHook("beforeOnCellMouseUp",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return MK(HK,e,GK).call(e,...n)})),this.addHook("beforeSelectionHighlightSet",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return MK(HK,e,zK).call(e,...n)})),this.addHook("modifyTransformStart",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return MK(HK,e,$K).call(e,...n)})),this.addHook("afterSelection",(()=>MK(HK,this,FK).call(this))),this.addHook("afterSelectionFocusSet",(()=>MK(HK,this,FK).call(this))),this.addHook("beforeViewportScrollHorizontally",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return MK(HK,e,DK).call(e,...n)})),this.addHook("afterGetColumnHeaderRenderers",(e=>MK(HK,this,KK).call(this,e))),this.addHook("modifyColWidth",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return MK(HK,e,qK).call(e,...n)})),this.addHook("modifyColumnHeaderValue",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return MK(HK,e,QK).call(e,...n)})),this.addHook("beforeHighlightingColumnHeader",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return MK(HK,e,VK).call(e,...n)})),this.addHook("beforeCopy",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return MK(HK,e,UK).call(e,...n)})),this.addHook("beforeSelectColumns",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return MK(HK,e,YK).call(e,...n)})),this.addHook("afterViewportColumnCalculatorOverride",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return MK(HK,e,XK).call(e,...n)})),this.addHook("modifyFocusedElement",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return MK(HK,e,ZK).call(e,...n)})),this.hot.columnIndexMapper.addLocalHook("cacheUpdated",(()=>MK(HK,this,FK).call(this))),this.hot.rowIndexMapper.addLocalHook("cacheUpdated",(()=>MK(HK,this,FK).call(this))),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(!this.hot.view)return;const{nestedHeaders:e}=this.hot.getSettings();AK(OK,this).setColumnsLimit(this.hot.countCols()),Array.isArray(e)&&(this.detectedOverlappedHeaders=AK(OK,this).setState(e)),this.detectedOverlappedHeaders&&Fm(Wd`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\x20
                        is currently not supported.`),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach(((e,t)=>{const n=!0===e?"hide-column":"show-column";AK(OK,this).triggerColumnModification(n,t)})),!AK(xK,this)&&this.enabled&&NK(xK,this,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe((e=>{e.forEach((e=>{let{op:t,index:n,newValue:r}=e;if("replace"===t){const e=!0===r?"hide-column":"show-column";AK(OK,this).triggerColumnModification(e,n)}})),this.ghostTable.buildWidthsMap()}))),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),super.updatePlugin()}disablePlugin(){this.clearColspans(),AK(OK,this).clear(),AK(xK,this).unsubscribe(),NK(xK,this,null),this.ghostTable.clear(),super.disablePlugin()}getStateManager(){return AK(OK,this)}getLayersCount(){return AK(OK,this).getLayersCount()}getHeaderSettings(e,t){return AK(OK,this).getHeaderSettings(e,t)}clearColspans(){if(!this.hot.view)return;const{_wt:e}=this.hot.view,t=e.getSetting("columnHeaders").length,n=e.wtTable.THEAD,r=e.wtOverlays.topOverlay.clone.wtTable.THEAD,i=e.wtOverlays.topInlineStartCornerOverlay?e.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null;for(let o=0;o<t;o++){const e=n.childNodes[o];if(!e)break;const t=r.childNodes[o],s=i?i.childNodes[o]:null;for(let n=0,r=e.childNodes.length;n<r;n++)e.childNodes[n].removeAttribute("colspan"),Dp(e.childNodes[n],"hiddenHeader"),t&&t.childNodes[n]&&(t.childNodes[n].removeAttribute("colspan"),Dp(t.childNodes[n],"hiddenHeader")),i&&s&&s.childNodes[n]&&(s.childNodes[n].removeAttribute("colspan"),Dp(s.childNodes[n],"hiddenHeader"))}}headerRendererFactory(e){var t=this;const n=this.hot.view._wt.getSetting("fixedColumnsStart");return(r,i)=>{var o;const{columnIndexMapper:s,view:a}=this.hot;let l=s.getVisualFromRenderableIndex(r);null===l&&(l=r),i.removeAttribute("colspan"),Dp(i,"hiddenHeader"),Dp(i,"hiddenHeaderText");const{colspan:h,isHidden:u,isPlaceholder:c,headerClassNames:d}=null!==(o=AK(OK,this).getHeaderSettings(e,l))&&void 0!==o?o:{label:""};if(c||u)Fp(i,"hiddenHeader");else if(h>1){var p,g,m;const{wtOverlays:e}=a._wt,t=null===(p=e.topInlineStartCornerOverlay)||void 0===p?void 0:p.clone.wtTable.THEAD.contains(i),o=null===(g=e.inlineStartOverlay)||void 0===g?void 0:g.clone.wtTable.THEAD.contains(i);(null===(m=e.topOverlay)||void 0===m?void 0:m.clone.wtTable.THEAD.contains(i))&&l<n&&Fp(i,"hiddenHeaderText");const s=t||o?Math.min(h,n-r):h;s>1&&i.setAttribute("colspan",s)}if(this.hot.view.appendColHeader(l,i,(function(){return t.getColumnHeaderValue(...arguments)}),e),!c&&!u){const e=i.querySelector("div.relative");e&&d&&d.length>0&&(Dp(e,this.hot.getColumnMeta(l).headerClassName),Fp(e,d))}}}getColumnHeaderValue(e,t){var n;const{isHidden:r,isPlaceholder:i}=null!==(n=AK(OK,this).getHeaderSettings(t,e))&&void 0!==n?n:{};return i||r?"":this.hot.getColHeader(e,t)}destroy(){NK(OK,this,null),null!==AK(xK,this)&&(AK(xK,this).unsubscribe(),NK(xK,this,null)),super.destroy()}_getHeaderTreeNodeDataByCoords(e){if(!(e.row>=0||e.col<0))return AK(OK,this).getHeaderTreeNodeData(e.row,e.col)}}function FK(){var e;const t=null===(e=this.hot)||void 0===e?void 0:e.getSelectedRangeLast();if(!t)return;const{highlight:n}=t;if(n.isHeader()&&n.col>=0){const e=AK(OK,this).findLeftMostColumnIndex(n.row,n.col),t=this.hot.selection.highlight.getFocus();t.visualCellRange.highlight.col=e,t.visualCellRange.from.col=e,t.visualCellRange.to.col=e,t.commit()}}function DK(e,t){var n;const r=this.hot.getSelectedRangeLast();if(!r)return e;const{highlight:i}=r,{navigableHeaders:o}=this.hot.getSettings(),s=this.hot.selection.isSelectedByColumnHeader(),a=o?i.row:null===(n=AK(LK,this))||void 0===n?void 0:n.row,l=s?e:i.col,h=a<0&&l>=0;if(NK(LK,this,null),!h)return e;const u=this.hot.getFirstFullyVisibleColumn(),c=this.hot.getLastFullyVisibleColumn(),d=c-u+1,p=AK(OK,this).findLeftMostColumnIndex(a,l),g=AK(OK,this).findRightMostColumnIndex(a,l),m=g-p+1;if(p<u&&g>c)return p;if(s){let e=null;return p>=u&&g>c?m>d?(t.value="start",e=p):(t.value="end",e=g):p<u&&g<=c&&(m>d?(t.value="end",e=g):(t.value="start",e=p)),e}return p<=u?p:g}function VK(e,t,n){const r=AK(OK,this).getHeaderTreeNodeData(t,e);if(!r)return e;const{columnCursor:i,selectionType:o,selectionWidth:s}=n,{isRoot:a,colspan:l}=AK(OK,this).getHeaderSettings(t,e);if(o===RS){if(!a)return r.columnIndex}else if(o===SS&&(l>s-i||!a))return null;return e}function UK(e,t,n){let{columnHeadersCount:r}=n;if(0!==r)for(let o=0;o<t.length;o++){const{startRow:n,startCol:r,endRow:s,endCol:a}=t[o],l=s-n+1;if(n>=0||1===r-a+1)break;for(let t=r;t<=a;t++)for(let o=n;o<=s;o++){var i;const n=l+o,s=t-r;if(0===s)continue;!1===(null===(i=AK(OK,this).getHeaderTreeNodeData(o,t))||void 0===i?void 0:i.isRoot)&&(e[n][s]="")}}}function BK(e,t,n,r){this._getHeaderTreeNodeDataByCoords(t)&&(r.column=!0)}function WK(e,t){const n=this._getHeaderTreeNodeDataByCoords(t);if(!n)return;NK(PK,this,t.clone()),NK(_K,this,!0);const{selection:r}=this.hot,i=r.isSelected()?r.getSelectedRange().current():null,o=[],{columnIndex:s,origColspan:a}=n,l=!r.inInSelection(t);e.shiftKey&&i?t.col<i.from.col?o.push(i.getTopEndCorner().col,s,t.row):t.col>i.from.col?o.push(i.getTopStartCorner().col,s+a-1,t.row):o.push(s,s+a-1,t.row):(km(e)||Hm(e)&&l||function(e){return e instanceof TouchEvent}(e))&&o.push(s,s+a-1,t.row),r.selectColumns(...o)}function jK(e,t,n,r){if(!this.hot.view.isMouseDown()||r.column)return;const i=this._getHeaderTreeNodeDataByCoords(t);if(!i)return;const{columnIndex:o,origColspan:s}=i,a=this.hot.getSelectedRangeLast(),l=a.getTopStartCorner(),h=a.getBottomEndCorner(),{from:u}=a;r.column=!0,r.cell=!0;const c=[],d=ny(t.row,-1/0,-1);t.col<u.col?c.push(h.col,o,d):t.col>u.col?c.push(l.col,o+s-1,d):c.push(o,o+s-1,d),this.hot.selection.selectColumns(...c)}function GK(){NK(_K,this,!1)}function zK(){const{navigableHeaders:e}=this.hot.getSettings();if(!this.hot.view.isMouseDown()||!AK(_K,this)||!e)return;const t=this.hot.getSelectedRangeLast(),n=t.getTopStartCorner().col,r=t.getBottomEndCorner().col,{columnIndex:i,origColspan:o}=AK(OK,this).getHeaderTreeNodeData(AK(PK,this).row,AK(PK,this).col);if(t.setHighlight(AK(PK,this)),o>t.getWidth()||i<n||i+o-1>r){const e=AK(OK,this).findTopMostEntireHeaderLevel(ny(n,i,i+o-1),ny(r,i,i+o-1));t.highlight.row=e,t.highlight.col=t.from.col}}function $K(e){const{highlight:t}=this.hot.getSelectedRangeLast(),n=this.hot._createCellCoords(t.row+e.row,t.col+e.col);if(!(n.isHeader()&&n.col>=0))return;const r=AK(OK,this).findLeftMostColumnIndex(n.row,n.col),i=AK(OK,this).findRightMostColumnIndex(n.row,n.col);if(e.col<0){const n=t.col>=r&&t.col<=i?r-1:i,o=this.hot.columnIndexMapper.getNearestNotHiddenIndex(n,-1);e.col=null===o?-this.hot.view.countRenderableColumnsInRange(0,t.col):-Math.max(this.hot.view.countRenderableColumnsInRange(o,t.col)-1,1)}else if(e.col>0){const n=t.col>=r&&t.col<=i?i+1:r,o=this.hot.columnIndexMapper.getNearestNotHiddenIndex(n,1);e.col=null===o?this.hot.view.countRenderableColumnsInRange(t.col,this.hot.countCols()):Math.max(this.hot.view.countRenderableColumnsInRange(t.col,o)-1,1)}}function YK(e,t,n){const r=e.row,i=this._getHeaderTreeNodeDataByCoords({row:r,col:e.col}),o=this._getHeaderTreeNodeDataByCoords({row:r,col:t.col});NK(LK,this,n.clone()),t.col<e.col?(i&&(e.col=i.columnIndex+i.origColspan-1),o&&(t.col=o.columnIndex)):t.col>=e.col&&(i&&(e.col=i.columnIndex),o&&(t.col=o.columnIndex+o.origColspan-1))}function KK(e){if(AK(OK,this).getLayersCount()>0){e.length=0;for(let t=0;t<AK(OK,this).getLayersCount();t++)e.push(this.headerRendererFactory(t))}}function XK(e){const t=AK(OK,this).getLayersCount();let n=e.startColumn,r=!!t;for(let i=0;i<t;i++){const t=AK(OK,this).findLeftMostColumnIndex(i,e.startColumn),o=this.hot.columnIndexMapper.getRenderableFromVisualIndex(t);if(t>=0&&(r=!1),Zw(o)&&o<e.startColumn){n=o;break}}e.startColumn=r?AK(OK,this).getHeaderTreeNodeData(0,n).columnIndex:n}function qK(e,t){const n=this.ghostTable.getWidth(t);return e>n?e:n}function QK(e,t,n){var r;const{label:i}=null!==(r=AK(OK,this).getHeaderTreeNodeData(n,t))&&void 0!==r?r:{label:""};return i}function ZK(e,t){if(e<0)return this.hot.getCell(e,AK(OK,this).findLeftMostColumnIndex(e,t),!0)}function JK(){this.updatePlugin()}function eX(e,t){t||this.updatePlugin()}function tX(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const nX=class{constructor(e,t){tX(this,"hot",void 0),tX(this,"data",null),tX(this,"plugin",void 0),tX(this,"parentReference",new WeakMap),tX(this,"cache",{levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}),this.hot=t,this.plugin=e}setData(e){this.data=e}getData(){return this.data}getRawSourceData(){let e=null;return this.plugin.disableCoreAPIModifiers(),e=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),e}updateWithData(e){this.setData(e),this.rewriteCache()}rewriteCache(){this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},Jw(0,this.data.length-1,(e=>{this.cacheNode(this.data[e],0,null)}))}cacheNode(e,t,n){this.cache.levels[t]||(this.cache.levels[t]=[],this.cache.levelCount+=1),this.cache.levels[t].push(e),this.cache.rows.push(e),this.cache.nodeInfo.set(e,{parent:n,row:this.cache.rows.length-1,level:t}),this.hasChildren(e)&&Vd(e.__children,(n=>{this.cacheNode(n,t+1,e)}))}getDataObject(e){return null==e?null:this.cache.rows[e]}readTreeNodes(e,t,n,r){let i=!1,o=t;if(isNaN(o)&&o.end)return o;let s=e;return s||(s={__children:this.data},i=!0,o-=1),null!=n&&o===n?{result:s,end:!0}:null!=r&&s===r?{result:o,end:!0}:(o+=1,s.__children&&Vd(s.__children,(e=>{if(this.parentReference.set(e,i?null:s),o=this.readTreeNodes(e,o,n,r),isNaN(o)&&o.end)return!1})),o)}mockParent(){const e=this.mockNode();return e.__children=this.data,e}mockNode(){const e={};return hm(this.data[0],((t,n)=>{e[n]=null})),e}getRowIndex(e){return null==e?null:this.cache.nodeInfo.get(e).row}getRowIndexWithinParent(e){let t=null;t=isNaN(e)?e:this.getDataObject(e);const n=this.getRowParent(e);return null==n?this.data.indexOf(t):n.__children.indexOf(t)}countAllRows(){const e={__children:this.data};return this.countChildren(e)}countChildren(e){let t=0,n=e;return isNaN(n)||(n=this.getDataObject(n)),n&&n.__children?(Vd(n.__children,(e=>{t+=1,e.__children&&(t+=this.countChildren(e))})),t):0}getRowParent(e){let t;return t=isNaN(e)?e:this.getDataObject(e),this.getRowObjectParent(t)}getRowObjectParent(e){return e&&"object"==typeof e?this.cache.nodeInfo.get(e).parent:null}getRowLevel(e){let t=null;return t=isNaN(e)?e:this.getDataObject(e),t?this.getRowObjectLevel(t):null}getRowObjectLevel(e){return null==e?null:this.cache.nodeInfo.get(e).level}hasChildren(e){let t=e;return isNaN(t)||(t=this.getDataObject(t)),!(!t.__children||!t.__children.length)}isChild(e){return null!==this.getRowParent(e)}getChild(e,t){var n;return(null===(n=e.__children)||void 0===n?void 0:n[t])||null}isRowHighestLevel(e){return!this.isChild(e)}isParent(e){var t;let n=e;return isNaN(n)||(n=this.getDataObject(n)),n&&!!n.__children&&0!==(null===(t=n.__children)||void 0===t?void 0:t.length)}addChild(e,t){let n=t;this.hot.runHooks("beforeAddChild",e,n);let r=null;e&&(r=this.getRowIndex(e)),this.hot.runHooks("beforeCreateRow",r+this.countChildren(e)+1,1);let i=e;e||(i=this.mockParent()),i.__children||(i.__children=[]),n||(n=this.mockNode()),i.__children.push(n),this.rewriteCache();const o=this.getRowIndex(n);this.hot.rowIndexMapper.insertIndexes(o,1),this.hot.runHooks("afterCreateRow",o,1),this.hot.runHooks("afterAddChild",e,n)}addChildAtIndex(e,t,n){let r,i=n;if(i||(i=this.mockNode()),this.hot.runHooks("beforeAddChild",e,i,t),e){const n=this.getRowIndex(e)+t+1;this.hot.runHooks("beforeCreateRow",n,1),e.__children.splice(t,null,i),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(e),"__children",e.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(n,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",n,1),r=n}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",t,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),r=this.getRowIndex(this.data[t]);i=this.getDataObject(r),this.hot.runHooks("afterAddChild",e,i,t)}addSibling(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"below";const n=this.translateTrimmedRow(e),r=this.getRowParent(n),i=this.getRowIndexWithinParent(n);switch(t){case"below":this.addChildAtIndex(r,i+1,null);break;case"above":this.addChildAtIndex(r,i,null)}}detachFromParent(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=null;const r=[];Array.isArray(e)?(Jw(e[0],e[2],(e=>{const t=this.translateTrimmedRow(e);r.push(this.getDataObject(t))})),Jw(0,r.length-2,(e=>{this.detachFromParent(r[e],!1)})),n=r[r.length-1]):n=e;const i=this.getRowIndex(n),o=this.countChildren(n),s=this.getRowIndexWithinParent(n),a=this.getRowParent(n),l=this.getRowParent(a),h=this.getRowIndex(l);let u=null;if(this.hot.runHooks("beforeDetachChild",a,n),null!=s){const e=Array.from(new Array(i+o+1).keys()).splice(-1*(o+1));if(this.hot.runHooks("beforeRemoveRow",i,o+1,e,this.plugin.pluginName),a.__children.splice(s,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",i,o+1,e,this.plugin.pluginName),l){u=h+this.countChildren(l);const e=this.getChild(l,this.countChildren(l)-1),t=this.getRowIndex(e);this.hot.runHooks("beforeCreateRow",t+1,o+1,this.plugin.pluginName),l.__children.push(n)}else u=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",u-2,o+1,this.plugin.pluginName),this.data.push(n)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",u-2,o+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",a,n,this.getRowIndex(n)),t&&this.hot.render()}filterData(e,t,n){const r=[];Vd(n,(e=>{r.push(this.getDataObject(e))})),Vd(r,(e=>{const t=this.getRowIndexWithinParent(e),n=this.getRowParent(e);null===n?this.data.splice(t,1):n.__children.splice(t,1)})),this.rewriteCache()}spliceData(e,t,n){const r=this.getDataObject(e-1);let i=null,o=e;r&&r.__children&&0===r.__children.length?(i=r,o=0):e<this.countAllRows()&&(i=this.getRowParent(e),o=this.getRowIndexWithinParent(e)),i?n?i.__children.splice(o,t,...n):i.__children.splice(o,t):n?this.data.splice(o,t,...n):this.data.splice(o,t),this.rewriteCache()}syncRowWithRawSource(e){let t=e,n=null;do{n=this.getRowParent(n),null!==n&&(t=n)}while(null!==n);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndex(t),"__children",t.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}moveRow(e,t,n,r){const i=t===this.hot.countRows(),o=this.getRowParent(e),s=this.getRowIndexWithinParent(e),a=o.__children.slice(s,s+1),l=e>t;let h=i?this.getRowParent(t-1):this.getRowParent(t);null==h&&(h=this.getRowParent(t-1)),null==h&&(h=this.getDataObject(t-1)),h?h.__children||(h.__children=[]):(h=this.getDataObject(t),h.__children=[]);const u=i||n||r?h.__children.length:this.getRowIndexWithinParent(t),c=o===h;h.__children.splice(u,0,a[0]),o.__children.splice(s+(l&&c?1:0),1),this.syncRowWithRawSource(o),c||this.syncRowWithRawSource(h)}translateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(e):e}untranslateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(e):e}};function rX(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const iX=class{constructor(e,t){rX(this,"hot",void 0),rX(this,"plugin",void 0),this.hot=t,this.plugin=e}};class oX extends iX{static get CSS_CLASSES(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}constructor(e,t){super(e,t),this.dataManager=this.plugin.dataManager,this.collapsingUI=this.plugin.collapsingUI,this.rowHeaderWidthCache=null}appendLevelIndicators(e,t){const n=this.hot.toPhysicalRow(e),r=this.dataManager.getRowLevel(n),i=this.dataManager.getDataObject(n),o=t.getElementsByTagName("DIV")[0],s=o.querySelector("span.rowHeader"),a=o.querySelectorAll('[class^="ht_nesting"]'),l=this.hot.getSettings().ariaTags;if(Vd(a,(e=>{e&&o.removeChild(e)})),Fp(t,oX.CSS_CLASSES.indicatorContainer),r){const{rootDocument:e}=this.hot,t=s.cloneNode(!0);o.innerHTML="",Jw(0,r-1,(()=>{const t=e.createElement("SPAN");Fp(t,oX.CSS_CLASSES.emptyIndicator),o.appendChild(t)})),o.appendChild(t)}if(this.dataManager.hasChildren(i)){const e=this.hot.rootDocument.createElement("DIV");l&&Vp(e,[mp()]),Fp(t,oX.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(n)?(Fp(e,`${oX.CSS_CLASSES.button} ${oX.CSS_CLASSES.expandButton}`),l&&Vp(t,[Sp(!1)])):(Fp(e,`${oX.CSS_CLASSES.button} ${oX.CSS_CLASSES.collapseButton}`),l&&Vp(t,[Sp(!0)])),o.appendChild(e)}}updateRowHeaderWidth(e){let t=e;t||(t=this.dataManager.cache.levelCount);const n=this.hot.view.getStylesHandler();let r=11;if(!n.isClassicTheme()){r=2*n.getCSSVariableValue("cell-horizontal-padding")}this.rowHeaderWidthCache=Math.max(50,r+10*t+25),this.hot.render()}}const sX=oX;const aX=class extends iX{constructor(e,t){var n;super(e,t),n=this,this.dataManager=this.plugin.dataManager,this.collapsedRows=[],this.collapsedRowsStash={stash:function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];n.lastCollapsedRows=n.collapsedRows.slice(0),n.expandMultipleChildren(n.lastCollapsedRows,e)},shiftStash:function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;null==t&&(t=1/0),Vd(n.lastCollapsedRows,((i,o)=>{i>=e&&i<t&&(n.lastCollapsedRows[o]=i+r)}))},applyStash:function(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];n.collapseMultipleChildren(n.lastCollapsedRows,e),n.lastCollapsedRows=void 0},trimStash:(e,t)=>{Jw(e,e+t-1,(e=>{const t=this.lastCollapsedRows.indexOf(e);t>-1&&this.lastCollapsedRows.splice(t,1)}))}}}collapseChildren(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const r=[];let i=null,o=null,s=null;return isNaN(e)?(i=e,o=this.dataManager.getRowIndex(i)):(i=this.dataManager.getDataObject(e),o=e),this.dataManager.hasChildren(i)&&Vd(i.__children,(e=>{r.push(this.dataManager.getRowIndex(e))})),s=this.collapseRows(r,!0,!1),n&&this.trimRows(s),t&&this.renderAndAdjust(),-1===this.collapsedRows.indexOf(o)&&this.collapsedRows.push(o),s}collapseMultipleChildren(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const r=[];Vd(e,(e=>{r.push(...this.collapseChildren(e,!1,!1))})),n&&this.trimRows(r),t&&this.renderAndAdjust()}collapseRow(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.collapseRows([e],t)}collapseRows(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=[];return Vd(e,(e=>{r.push(e),t&&this.collapseChildRows(e,r)})),n&&this.trimRows(r),r}collapseChildRows(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(this.dataManager.hasChildren(e)){Vd(this.dataManager.getDataObject(e).__children,(e=>{const n=this.dataManager.getRowIndex(e);t.push(n),this.collapseChildRows(n,t)}))}n&&this.trimRows(t)}expandRow(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.expandRows([e],t)}expandRows(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=[];return Vd(e,(e=>{r.push(e),t&&this.expandChildRows(e,r)})),n&&this.untrimRows(r),r}expandChildRows(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(this.dataManager.hasChildren(e)){Vd(this.dataManager.getDataObject(e).__children,(e=>{if(!this.isAnyParentCollapsed(e)){const n=this.dataManager.getRowIndex(e);t.push(n),this.expandChildRows(n,t)}}))}n&&this.untrimRows(t)}expandChildren(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const r=[];let i=null,o=null,s=null;return isNaN(e)?(i=e,o=this.dataManager.getRowIndex(e)):(i=this.dataManager.getDataObject(e),o=e),this.collapsedRows.splice(this.collapsedRows.indexOf(o),1),this.dataManager.hasChildren(i)&&Vd(i.__children,(e=>{const t=this.dataManager.getRowIndex(e);r.push(t)})),s=this.expandRows(r,!0,!1),n&&this.untrimRows(s),t&&this.renderAndAdjust(),s}expandMultipleChildren(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const r=[];Vd(e,(e=>{r.push(...this.expandChildren(e,!1,!1))})),n&&this.untrimRows(r),t&&this.renderAndAdjust()}collapseAll(){const e=this.dataManager.getData(),t=[];Vd(e,(e=>{this.dataManager.hasChildren(e)&&t.push(e)})),this.collapseMultipleChildren(t),this.renderAndAdjust()}expandAll(){const e=this.dataManager.getData(),t=[];Vd(e,(e=>{this.dataManager.hasChildren(e)&&t.push(e)})),this.expandMultipleChildren(t),this.renderAndAdjust()}trimRows(e){this.hot.batchExecution((()=>{Vd(e,(e=>{this.plugin.collapsedRowsMap.setValueAtIndex(e,!0)}))}),!0)}untrimRows(e){this.hot.batchExecution((()=>{Vd(e,(e=>{this.plugin.collapsedRowsMap.setValueAtIndex(e,!1)}))}),!0)}areChildrenCollapsed(e){let t=isNaN(e)?e:this.dataManager.getDataObject(e),n=!0;return null===t&&(t={__children:this.dataManager.data}),this.dataManager.hasChildren(t)&&Vd(t.__children,(e=>{const t=this.dataManager.getRowIndex(e);if(!this.plugin.collapsedRowsMap.getValueAtIndex(t))return n=!1,!1})),n}isAnyParentCollapsed(e){let t=e;for(;null!==t;){t=this.dataManager.getRowParent(t);const e=this.dataManager.getRowIndex(t);if(this.collapsedRows.indexOf(e)>-1)return!0}return!1}toggleState(e,t){if(t.col>=0)return;const n=this.translateTrimmedRow(t.row);kp(e.target,sX.CSS_CLASSES.button)&&(this.areChildrenCollapsed(n)?this.expandChildren(n):this.collapseChildren(n),_m(e))}translateTrimmedRow(e){return this.hot.toPhysicalRow(e)}untranslateTrimmedRow(e){return this.hot.toVisualRow(e)}renderAndAdjust(){this.hot.render(),this.hot.view.adjustElementsSize()}};function lX(e,t,n){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,n)}function hX(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function uX(e,t){return e.get(function(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}(e,t))}var cX=new WeakMap;const dX=class extends iX{constructor(){super(...arguments),hX(this,"dataManager",this.plugin.dataManager),lX(this,cX,{row_above:(e,t)=>{const n=t[t.length-1];this.dataManager.addSibling(n.start.row,"above")},row_below:(e,t)=>{const n=t[t.length-1];this.dataManager.addSibling(n.start.row,"below")}})}appendOptions(e){const t=[{key:"add_child",name(){return this.getTranslatedPhrase(oT)},callback:()=>{const e=this.dataManager.translateTrimmedRow(this.hot.getSelectedLast()[0]),t=this.dataManager.getDataObject(e);this.dataManager.addChild(t)},disabled:()=>{const e=this.hot.getSelectedLast();return!e||e[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{key:"detach_from_parent",name(){return this.getTranslatedPhrase(sT)},callback:()=>{this.dataManager.detachFromParent(this.hot.getSelectedLast())},disabled:()=>{const e=this.hot.getSelectedLast(),t=this.dataManager.translateTrimmedRow(e[0]);return!this.dataManager.getRowParent(t)||!e||e[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{name:"---------"}];return Jw(0,e.items.length-1,(n=>{if(0===n)return Vd(t,((t,r)=>{e.items.splice(n+r,0,t)})),!1})),this.modifyRowInsertingOptions(e)}modifyRowInsertingOptions(e){return Jw(0,e.items.length-1,(t=>{const n=uX(cX,this)[e.items[t].key];null!=n&&(e.items[t].callback=n)})),e}};function pX(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class gX{constructor(e){pX(this,"plugin",void 0),pX(this,"hot",void 0),pX(this,"dataManager",void 0),pX(this,"collapsingUI",void 0),this.plugin=e,this.hot=e.hot,this.dataManager=e.dataManager,this.collapsingUI=e.collapsingUI}onBeforeRowMove(e,t,n,r){if(this.displayAPICompatibilityWarning({rows:e,finalIndex:t,dropIndex:n,movePossible:r}))return!1;this.movedToCollapsed=!1;const i=n===this.hot.countRows(),o=i?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(n);let s=!0;const a=e.map((e=>{if(!s)return!1;const t=this.dataManager.translateTrimmedRow(e);return s=this.shouldAllowMoving(t,o),t})),l=-1===a.indexOf(o);if(!s||!l)return!1;const h=this.getBaseParent(a),u=this.getTargetParent(i,o),c=h===u;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(u),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(a,o,c),this.moveRows(a,o,u),this.dataManager.rewriteCache(),this.moveCellsMeta(a,o),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",e,t,n,r,r&&this.isRowOrderChanged(e,t)),this.hot.render(),this.selectCells(e,n),!1}displayAPICompatibilityWarning(e){const{rows:t,finalIndex:n,dropIndex:r,movePossible:i}=e;let o=!1;return zd(r)&&(Fm(Wd`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`),this.hot.runHooks("afterRowMove",t,n,r,i,!1),o=!0),o}shouldAllowMoving(e,t){return!(this.dataManager.isParent(e)||this.dataManager.isRowHighestLevel(e)||e===t||0===t)}getBaseParent(e){return this.dataManager.getRowParent(e[0])}getTargetParent(e,t){let n=this.dataManager.getRowParent(e?t-1:t);return null==n&&(n=this.dataManager.getRowParent(t-1)),n}shiftCollapsibleParentsLocations(e,t,n){n||(Math.max(...e)<=t?this.collapsingUI.collapsedRowsStash.shiftStash(e[0],t,-1*e.length):this.collapsingUI.collapsedRowsStash.shiftStash(t,e[0],e.length))}moveRows(e,t,n){const r=t===this.dataManager.getRowIndex(n)+this.dataManager.countChildren(n)+1;this.hot.batchRender((()=>{e.forEach((e=>{this.dataManager.moveRow(e,t,this.movedToCollapsed,r)}))}))}moveCellsMeta(e,t){const n=[],r=Math.max(...e)<t;e.forEach((e=>{n.push(this.hot.getCellMetaAtRow(e))})),this.hot.spliceCellsMeta(e[0],e.length),this.hot.spliceCellsMeta(t-(r?n.length:0),0,...n)}selectCells(e,t){const n=e.length;let r=0,i=0;if(this.movedToCollapsed){let o=null;o=e[n-1]<t?this.dataManager.translateTrimmedRow(t-n):this.dataManager.translateTrimmedRow(t);const s=this.dataManager.getRowParent(null===o?this.hot.countSourceRows()-1:o-1),a=this.dataManager.getRowIndex(s);r=this.dataManager.untranslateTrimmedRow(a),i=r}else e[n-1]<t?(i=t-1,r=i-n+1):(r=t,i=r+n-1);this.hot.selectCells([[r,0,i,this.hot.countCols()-1]],!1)}isRowOrderChanged(e,t){return e.some(((e,n)=>e-n!==t))}}function mX(e,t,n){fX(e,t),t.set(e,n)}function fX(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function wX(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function yX(e,t){return e.get(CX(e,t))}function vX(e,t,n){return e.set(CX(e,t),n),n}function CX(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}const SX="nestedRows",RX=SX;var EX=new WeakMap,bX=new WeakMap,TX=new WeakSet;class NX extends Hx{constructor(){var e,t;super(...arguments),fX(e=this,t=TX),t.add(e),wX(this,"dataManager",null),wX(this,"headersUI",null),wX(this,"collapsedRowsMap",null),mX(this,EX,!1),mX(this,bX,!1)}static get PLUGIN_KEY(){return SX}static get PLUGIN_PRIORITY(){return 300}isEnabled(){return!!this.hot.getSettings()[SX]}enablePlugin(){var e=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new GE),this.dataManager=new nX(this,this.hot),this.collapsingUI=new aX(this,this.hot),this.headersUI=new sX(this,this.hot),this.contextMenuUI=new dX(this,this.hot),this.rowMoveController=new gX(this),this.addHook("afterInit",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return CX(TX,e,UX).call(e,...n)})),this.addHook("beforeViewRender",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return CX(TX,e,BX).call(e,...n)})),this.addHook("modifyRowData",(function(){return e.onModifyRowData(...arguments)})),this.addHook("modifySourceLength",(function(){return e.onModifySourceLength(...arguments)})),this.addHook("beforeDataSplice",(function(){return e.onBeforeDataSplice(...arguments)})),this.addHook("filterData",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return CX(TX,e,IX).call(e,...n)})),this.addHook("afterContextMenuDefaultOptions",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return CX(TX,e,OX).call(e,...n)})),this.addHook("afterGetRowHeader",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return CX(TX,e,xX).call(e,...n)})),this.addHook("beforeOnCellMouseDown",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return CX(TX,e,MX).call(e,...n)})),this.addHook("beforeRemoveRow",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return CX(TX,e,LX).call(e,...n)})),this.addHook("afterRemoveRow",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return CX(TX,e,_X).call(e,...n)})),this.addHook("beforeAddChild",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return CX(TX,e,HX).call(e,...n)})),this.addHook("afterAddChild",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return CX(TX,e,kX).call(e,...n)})),this.addHook("beforeDetachChild",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return CX(TX,e,FX).call(e,...n)})),this.addHook("afterDetachChild",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return CX(TX,e,DX).call(e,...n)})),this.addHook("modifyRowHeaderWidth",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return CX(TX,e,PX).call(e,...n)})),this.addHook("afterCreateRow",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return CX(TX,e,VX).call(e,...n)})),this.addHook("beforeRowMove",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return CX(TX,e,AX).call(e,...n)})),this.addHook("beforeLoadData",(e=>CX(TX,this,WX).call(this,e))),this.addHook("beforeUpdateData",(e=>CX(TX,this,WX).call(this,e))),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),this.unregisterShortcuts(),super.disablePlugin()}updatePlugin(){this.disablePlugin();const e=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(e),super.updatePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast(),t=this.collapsingUI.translateTrimmedRow(e.row);return this.collapsingUI.areChildrenCollapsed(t)?this.collapsingUI.expandChildren(t):this.collapsingUI.collapseChildren(t),!1},runOnlyIf:()=>{var e,t;const n=null===(e=this.hot.getSelectedRangeLast())||void 0===e?void 0:e.highlight;return n&&(null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.isSingle())&&this.hot.selection.isCellVisible(n)&&-1===n.col&&n.row>=0},group:RX,relativeToGroup:qA,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(RX)}disableCoreAPIModifiers(){vX(bX,this,!0)}enableCoreAPIModifiers(){vX(bX,this,!1)}onModifyRowData(e){if(!yX(bX,this))return this.dataManager.getDataObject(e)}onModifySourceLength(){if(!yX(bX,this))return this.dataManager.countAllRows()}onBeforeDataSplice(e,t,n){return!(!yX(bX,this)&&!this.dataManager.isRowHighestLevel(e))||(this.dataManager.spliceData(e,t,n),!1)}destroy(){super.destroy()}}function AX(e,t,n,r){return this.rowMoveController.onBeforeRowMove(e,t,n,r)}function MX(e,t,n){this.collapsingUI.toggleState(e,t,n)}function IX(e,t,n){return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(n[0],t),this.collapsingUI.collapsedRowsStash.shiftStash(n[0],null,-1*t),this.dataManager.filterData(e,t,n),vX(EX,this,!0),this.dataManager.getData().slice()}function OX(e){return this.contextMenuUI.appendOptions(e)}function xX(e,t){this.headersUI.appendLevelIndicators(e,t)}function PX(e){return Math.max(this.headersUI.rowHeaderWidthCache,e)}function _X(e,t,n,r){r!==this.pluginName&&this.hot._registerTimeout((()=>{vX(EX,this,!1),this.headersUI.updateRowHeaderWidth(),this.collapsingUI.collapsedRowsStash.applyStash()}))}function LX(e,t,n){const r=Array.from(n.reduce(((e,t)=>{if(this.dataManager.isParent(t)){const n=this.dataManager.getDataObject(t).__children;return e.add(t),Array.isArray(n)&&n.forEach((t=>e.add(this.dataManager.getRowIndex(t)))),e}return e.add(t)}),new Set));n.length=0,n.push(...r)}function HX(){this.collapsingUI.collapsedRowsStash.stash()}function kX(e,t){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(t)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function FX(){this.collapsingUI.collapsedRowsStash.stash()}function DX(e,t,n){this.collapsingUI.collapsedRowsStash.shiftStash(n,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function VX(){this.dataManager.rewriteCache()}function UX(){this.headersUI.updateRowHeaderWidth()}function BX(e,t){yX(EX,this)&&(t.skipRender=!0)}function WX(e){if(!function(e){return!!(Array.isArray(e)&&e.length&&e.every((e=>"object"==typeof e&&!Array.isArray(e)&&null!==e)))}(e))return Dm("The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled."),this.hot.getSettings()[SX]=!1,void this.disablePlugin();this.dataManager.setData(e),this.dataManager.rewriteCache()}function jX(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const GX=class{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;jX(this,"rootWindow",void 0),jX(this,"prefix",void 0),jX(this,"savedKeys",[]),this.rootWindow=t,this.prefix=e,this.loadSavedKeys()}saveValue(e,t){this.rootWindow.localStorage.setItem(`${this.prefix}_${e}`,JSON.stringify(t)),-1===this.savedKeys.indexOf(e)&&(this.savedKeys.push(e),this.saveSavedKeys())}loadValue(e,t){const n=void 0===e?t:e,r=this.rootWindow.localStorage.getItem(`${this.prefix}_${n}`);return null===r?void 0:JSON.parse(r)}reset(e){this.rootWindow.localStorage.removeItem(`${this.prefix}_${e}`)}resetAll(){Vd(this.savedKeys,((e,t)=>{this.rootWindow.localStorage.removeItem(`${this.prefix}_${this.savedKeys[t]}`)})),this.clearSavedKeys()}loadSavedKeys(){const e=this.rootWindow.localStorage.getItem(`${this.prefix}__persistentStateKeys`),t="string"==typeof e?JSON.parse(e):void 0;this.savedKeys=t||[]}saveSavedKeys(){this.rootWindow.localStorage.setItem(`${this.prefix}__persistentStateKeys`,JSON.stringify(this.savedKeys))}clearSavedKeys(){this.savedKeys.length=0,this.saveSavedKeys()}};function zX(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Rf.getSingleton().register("persistentStateSave"),Rf.getSingleton().register("persistentStateLoad"),Rf.getSingleton().register("persistentStateReset");const $X="persistentState";class YX extends Hx{constructor(){super(...arguments),zX(this,"storage",void 0)}static get PLUGIN_KEY(){return $X}static get PLUGIN_PRIORITY(){return 0}isEnabled(){return!!this.hot.getSettings()[$X]}enablePlugin(){this.enabled||(this.storage||(this.storage=new GX(this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",((e,t)=>this.saveValue(e,t))),this.addHook("persistentStateLoad",((e,t)=>this.loadValue(e,t))),this.addHook("persistentStateReset",(()=>this.resetValue())),super.enablePlugin())}disablePlugin(){this.storage=void 0,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}loadValue(e,t){t.value=this.storage.loadValue(e)}saveValue(e,t){this.storage.saveValue(e,t)}resetValue(e){void 0===e?this.storage.resetAll():this.storage.reset(e)}destroy(){super.destroy()}}function KX(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function XX(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function qX(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}const QX="search",ZX=function(e,t,n,r,i){e.getCellMeta(t,n).isSearchResult=i},JX=function(e,t,n){return!(zd(e)||null===e||!e.toLocaleLowerCase||0===e.length)&&(!zd(t)&&null!==t&&-1!==t.toString().toLocaleLowerCase(n.locale).indexOf(e.toLocaleLowerCase(n.locale)))};var eq=new WeakSet;class tq extends Hx{constructor(){super(...arguments),KX(this,eq),XX(this,"callback",ZX),XX(this,"queryMethod",JX),XX(this,"searchResultClass","htSearchResult")}static get PLUGIN_KEY(){return QX}static get PLUGIN_PRIORITY(){return 190}isEnabled(){return this.hot.getSettings()[QX]}enablePlugin(){var e=this;if(this.enabled)return;const t=this.hot.getSettings()[QX];this.updatePluginSettings(t),this.addHook("beforeRenderer",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return qX(eq,e,nq).call(e,...n)})),super.enablePlugin()}disablePlugin(){var e=this;const t=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return qX(eq,e,nq).call(e,...n)};this.hot.addHook("beforeRenderer",t),this.hot.addHookOnce("afterViewRender",(()=>{this.hot.removeHook("beforeRenderer",t)})),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}query(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.getCallback(),n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.getQueryMethod();const r=this.hot.countRows(),i=this.hot.countCols(),o=[],s=this.hot;return Jw(0,r-1,(r=>{Jw(0,i-1,(i=>{const a=this.hot.getDataAtCell(r,i),l=this.hot.getCellMeta(r,i),h=l.search.callback||t,u=(l.search.queryMethod||n)(e,a,l);if(u){const e={row:r,col:i,data:a};o.push(e)}h&&h(s,r,i,a,u)}))})),o}getCallback(){return this.callback}setCallback(e){this.callback=e}getQueryMethod(){return this.queryMethod}setQueryMethod(e){this.queryMethod=e}getSearchResultClass(){return this.searchResultClass}setSearchResultClass(e){this.searchResultClass=e}updatePluginSettings(e){am(e)&&(e.searchResultClass&&this.setSearchResultClass(e.searchResultClass),e.queryMethod&&this.setQueryMethod(e.queryMethod),e.callback&&this.setCallback(e.callback))}destroy(){super.destroy()}}function nq(e,t,n,r,i,o){const s=o.className||[];let a=[];"string"==typeof s?a=s.split(" "):a.push(...s),this.isEnabled()&&o.isSearchResult?a.includes(this.searchResultClass)||a.push(`${this.searchResultClass}`):a.includes(this.searchResultClass)&&a.splice(a.indexOf(this.searchResultClass),1),o.className=a.join(" ")}function rq(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class iq{constructor(e){rq(this,"viewportWidth",void 0),rq(this,"overwriteColumnWidthFn",void 0),rq(this,"baseWidths",new Map),rq(this,"stretchedWidths",new Map),this.overwriteColumnWidthFn=e}prepare(e){let{viewportWidth:t}=e;this.viewportWidth=t,this.baseWidths.clear(),this.stretchedWidths.clear()}setColumnBaseWidth(e,t){this.baseWidths.set(e,t)}calculate(){}getWidths(){return Array.from(this.stretchedWidths)}}class oq extends iq{calculate(){const e=Array.from(this.baseWidths).reduce(((e,t)=>{let[,n]=t;return e+n}),0);if(this.viewportWidth-e<0)return void this.stretchedWidths.clear();const t=this.viewportWidth/e,n=[],r=[];let i=this.viewportWidth,o=0;if(this.baseWidths.forEach(((e,s)=>{const a=Math.round(e*t),l=this.overwriteColumnWidthFn(a,s);a===l&&a>=ov?(n.push([s,l]),o+=l):a!==l&&(n.push([s,l]),r.push(s),i-=l)})),i<=ov)return void this.stretchedWidths.clear();const s=i/o;let a=-1,l=0;n.forEach(((e,t)=>{let[i,o]=e,h=o;r.includes(i)||(h=Math.round(o*s)),this.stretchedWidths.set(i,h),a=i,t<n.length-1&&(l+=h)})),this.stretchedWidths.size>1&&this.stretchedWidths.set(a,Math.round(this.viewportWidth-l))}}function sq(e,t,n){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,n)}function aq(e,t){return e.get(hq(e,t))}function lq(e,t,n){return e.set(hq(e,t),n),n}function hq(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var uq=new WeakMap,cq=new WeakMap;class dq extends iq{constructor(){super(...arguments),sq(this,uq,0),sq(this,cq,-1)}prepare(e){super.prepare(e),lq(uq,this,0),lq(cq,this,-1)}setColumnBaseWidth(e,t){super.setColumnBaseWidth(e,t),lq(cq,this,e),lq(uq,this,t)}calculate(){if(-1===aq(cq,this))return;const e=Array.from(this.baseWidths).reduce(((e,t)=>{let[,n]=t;return e+n}),0),t=Math.max(this.viewportWidth-e+aq(uq,this),0);this.stretchedWidths.set(aq(cq,this),t)}}function pq(e,t,n){gq(e,t),t.set(e,n)}function gq(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function mq(e,t){return e.get(wq(e,t))}function fq(e,t,n){return e.set(wq(e,t),n),n}function wq(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var yq=new WeakMap,vq=new WeakMap,Cq=new WeakMap,Sq=new WeakMap,Rq=new WeakSet;class Eq{constructor(e){var t,n;gq(t=this,n=Rq),n.add(t),pq(this,yq,void 0),pq(this,vq,void 0),pq(this,Cq,new Map([["all",new oq(wq(Rq,this,Nq).bind(this))],["last",new dq(wq(Rq,this,Nq).bind(this))]])),pq(this,Sq,"none"),fq(yq,this,e),fq(vq,this,mq(yq,this).columnIndexMapper.createAndRegisterIndexMap("stretchColumns","physicalIndexToValue"))}useStrategy(e){fq(Sq,this,mq(Cq,this).has(e)?e:"none")}refreshStretching(){"none"!==mq(Sq,this)?mq(yq,this).batchExecution((()=>{mq(vq,this).clear();const e=mq(Cq,this).get(mq(Sq,this));let t=mq(yq,this).view.getViewportWidth();wq(Rq,this,bq).call(this)&&(t-=hg(mq(yq,this).rootDocument)),e.prepare({viewportWidth:t});for(let n=0;n<mq(yq,this).countCols();n++)mq(yq,this).columnIndexMapper.isHidden(mq(yq,this).toPhysicalColumn(n))||e.setColumnBaseWidth(n,wq(Rq,this,Tq).call(this,n));e.calculate(),e.getWidths().forEach((e=>{let[t,n]=e;mq(vq,this).setValueAtIndex(mq(yq,this).toPhysicalColumn(t),n)}))}),!0):mq(vq,this).clear()}getStretchedWidth(e){return mq(vq,this).getValueAtIndex(mq(yq,this).toPhysicalColumn(e))}}function bq(){const{view:e}=mq(yq,this);if(e.isVerticallyScrollableByWindow())return!1;const t=e.getViewportHeight(),n=mq(yq,this).countRows(),r=e.getStylesHandler().getDefaultRowHeight();let i=0,o=!1;for(let a=0;a<n;a++){var s;if(i+=(null!==(s=mq(yq,this).getRowHeight(a))&&void 0!==s?s:r)+(0===a?1:0),i>t){o=!0;break}}return o}function Tq(e){var t;return null!==(t=mq(yq,this).getColWidth(e,"StretchColumns"))&&void 0!==t?t:ov}function Nq(e,t){return mq(yq,this).runHooks("beforeStretchingColumnWidth",e,t)}function Aq(e,t,n){Mq(e,t),t.set(e,n)}function Mq(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Iq(e,t,n){return e.set(xq(e,t),n),n}function Oq(e,t){return e.get(xq(e,t))}function xq(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var Pq=new WeakMap,_q=new WeakMap,Lq=new WeakMap,Hq=new WeakSet;class kq extends Hx{constructor(){var e,t;super(...arguments),Mq(e=this,t=Hq),t.add(e),Aq(this,Pq,new Eq(this.hot)),Aq(this,_q,null),Aq(this,Lq,new ResizeObserver((e=>{requestAnimationFrame((()=>{var t;null!==(t=this.hot)&&void 0!==t&&t.view.isHorizontallyScrollableByWindow()&&e.forEach((e=>{let{contentRect:t}=e;null!==Oq(_q,this)&&Oq(_q,this)!==t.width&&(this.hot.refreshDimensions(),this.hot.view.adjustElementsSize()),Iq(_q,this,t.width)}))}))})))}static get PLUGIN_KEY(){return"stretchColumns"}static get PLUGIN_PRIORITY(){return 155}static get SETTING_KEYS(){return!0}isEnabled(){return["all","last"].includes(this.hot.getSettings().stretchH)}enablePlugin(){var e=this;this.enabled||(Oq(Pq,this).useStrategy(this.hot.getSettings().stretchH),Oq(Lq,this).observe(this.hot.rootElement),this.addHook("beforeRender",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return xq(Hq,e,Dq).call(e,...n)})),this.addHook("modifyColWidth",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return xq(Hq,e,Fq).call(e,...n)}),10),super.enablePlugin())}updatePlugin(){Oq(Pq,this).useStrategy(this.hot.getSettings().stretchH),super.updatePlugin()}disablePlugin(){super.disablePlugin(),Oq(Lq,this).unobserve(this.hot.rootElement)}getColumnWidth(e){return Oq(Pq,this).getStretchedWidth(e)}destroy(){Oq(Lq,this).disconnect(),Iq(Lq,this,null),Iq(Pq,this,null),super.destroy()}}function Fq(e,t,n){if(n===this.pluginName)return;const r=this.getColumnWidth(t);return"number"==typeof r?r:e}function Dq(e){e&&Oq(Pq,this).refreshStretching()}function Vq(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function Uq(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Bq(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var Wq=new WeakSet;class jq extends Hx{constructor(){super(...arguments),Vq(this,Wq),Uq(this,"scrollbars",[]),Uq(this,"clones",[]),Uq(this,"lockedCollection",!1),Uq(this,"freezeOverlays",!1)}static get PLUGIN_KEY(){return"touchScroll"}static get PLUGIN_PRIORITY(){return 200}static get SETTING_KEYS(){return!0}isEnabled(){return fm()}enablePlugin(){this.enabled||(this.addHook("afterViewRender",(()=>Bq(Wq,this,Gq).call(this))),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.lockedCollection=!1,super.updatePlugin()}disablePlugin(){super.disablePlugin()}registerEvents(){this.addHook("beforeTouchScroll",(()=>Bq(Wq,this,zq).call(this))),this.addHook("afterMomentumScroll",(()=>Bq(Wq,this,$q).call(this)))}}function Gq(){if(this.lockedCollection)return;const{topOverlay:e,bottomOverlay:t,inlineStartOverlay:n,topInlineStartCornerOverlay:r,bottomInlineStartCornerOverlay:i}=this.hot.view._wt.wtOverlays;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(e),t.clone&&this.scrollbars.push(t),this.scrollbars.push(n),r&&this.scrollbars.push(r),i&&i.clone&&this.scrollbars.push(i),this.clones=[],e.needFullRender&&this.clones.push(e.clone.wtTable.holder.parentNode),t.needFullRender&&this.clones.push(t.clone.wtTable.holder.parentNode),n.needFullRender&&this.clones.push(n.clone.wtTable.holder.parentNode),r&&this.clones.push(r.clone.wtTable.holder.parentNode),i&&i.clone&&this.clones.push(i.clone.wtTable.holder.parentNode)}function zq(){this.freezeOverlays=!0,Vd(this.clones,(e=>{Fp(e,"hide-tween")}))}function $q(){this.freezeOverlays=!1,Vd(this.clones,(e=>{Dp(e,"hide-tween"),Fp(e,"show-tween")})),this.hot._registerTimeout((()=>{Vd(this.clones,(e=>{Dp(e,"show-tween")}))}),400),Vd(this.scrollbars,(e=>{e.refresh(),e.resetFixedPosition()})),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}function Yq(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function Kq(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const Xq="trimRows";var qq=new WeakSet;class Qq extends Hx{constructor(){super(...arguments),Yq(this,qq),Kq(this,"trimmedRowsMap",null)}static get PLUGIN_KEY(){return Xq}static get PLUGIN_PRIORITY(){return 330}isEnabled(){return!!this.hot.getSettings()[Xq]}enablePlugin(){this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new GE),this.trimmedRowsMap.addLocalHook("init",(()=>function(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}(qq,this,Zq).call(this))),super.enablePlugin())}updatePlugin(){const e=this.hot.getSettings()[Xq];Array.isArray(e)&&this.hot.batchExecution((()=>{this.trimmedRowsMap.clear(),Vd(e,(e=>{this.trimmedRowsMap.setValueAtIndex(e,!0)}))}),!0),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("trimRows"),super.disablePlugin()}getTrimmedRows(){return this.trimmedRowsMap.getTrimmedIndexes()}trimRows(e){const t=this.getTrimmedRows(),n=this.isValidConfig(e);let r=t;n&&(r=Array.from(new Set(t.concat(e))));!1!==this.hot.runHooks("beforeTrimRow",t,r,n)&&(n&&this.hot.batchExecution((()=>{Vd(e,(e=>{this.trimmedRowsMap.setValueAtIndex(e,!0)}))}),!0),this.hot.runHooks("afterTrimRow",t,r,n,n&&r.length>t.length))}trimRow(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.trimRows(t)}untrimRows(e){const t=this.getTrimmedRows(),n=this.isValidConfig(e);let r=t;const i=this.trimmedRowsMap.getValues().slice(),o=e.length>0;n&&o&&(Vd(e,(e=>{i[e]=!1})),r=kd(i,((e,t,n)=>(t&&e.push(n),e)),[]));!1!==this.hot.runHooks("beforeUntrimRow",t,r,n&&o)&&(n&&o&&this.trimmedRowsMap.setValues(i),this.hot.runHooks("afterUntrimRow",t,r,n&&o,n&&r.length<t.length))}untrimRow(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.untrimRows(t)}isTrimmed(e){return this.trimmedRowsMap.getValueAtIndex(e)||!1}untrimAll(){this.untrimRows(this.getTrimmedRows())}isValidConfig(e){const t=this.hot.countSourceRows();return e.every((e=>Number.isInteger(e)&&e>=0&&e<t))}destroy(){super.destroy()}}function Zq(){const e=this.hot.getSettings()[Xq];Array.isArray(e)&&this.hot.batchExecution((()=>{Vd(e,(e=>{this.trimmedRowsMap.setValueAtIndex(e,!0)}))}),!0)}function Jq(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class eQ{constructor(e){Jq(this,"actionType",""),this.actionType=e}undo(){throw new Error("Not implemented")}redo(){throw new Error("Not implemented")}}function tQ(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class nQ extends eQ{constructor(e){let{stateBefore:t,range:n,type:r,alignment:i}=e;super("cell_alignment"),tQ(this,"stateBefore",void 0),tQ(this,"range",void 0),tQ(this,"type",void 0),tQ(this,"alignment",void 0),this.stateBefore=t,this.range=n,this.type=r,this.alignment=i}static startRegisteringEvents(e,t){e.addHook("beforeCellAlignment",((e,n,r,i)=>{t.done((()=>new nQ({stateBefore:e,range:n,type:r,alignment:i})))}))}undo(e,t){Vd(this.range,(t=>{t.forAll(((t,n)=>{t>=0&&n>=0&&e.setCellMeta(t,n,"className",this.stateBefore[t][n]||" htLeft")}))})),e.addHookOnce("afterViewRender",t),e.render()}redo(e,t){FL(this.range,this.type,this.alignment,((t,n)=>e.getCellMeta(t,n)),((t,n,r,i)=>e.setCellMeta(t,n,r,i))),e.addHookOnce("afterViewRender",t),e.render()}}function rQ(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class iQ extends eQ{constructor(e){let{columns:t,finalIndex:n}=e;super("col_move"),rQ(this,"columns",void 0),rQ(this,"finalColumnIndex",void 0),this.columns=t.slice(),this.finalColumnIndex=n}static startRegisteringEvents(e,t){e.addHook("beforeColumnMove",((e,n)=>{!1!==e&&t.done((()=>new iQ({columns:e,finalIndex:n})))}))}undo(e,t){const n=e.getPlugin("manualColumnMove");e.addHookOnce("afterViewRender",t);LB(this.columns,this.finalColumnIndex,e.columnIndexMapper.getNumberOfIndexes()).reverse().forEach((e=>{let{from:t,to:r}=e;t<r&&(r-=1),n.moveColumn(r,t)})),e.render(),e.deselectCell(),e.selectColumns(this.columns[0],this.columns[0]+this.columns.length-1)}redo(e,t){const n=e.getPlugin("manualColumnMove");e.addHookOnce("afterViewRender",t),n.moveColumns(this.columns.slice(),this.finalColumnIndex),e.render(),e.deselectCell(),e.selectColumns(this.finalColumnIndex,this.finalColumnIndex+this.columns.length-1)}}function oQ(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class sQ extends eQ{constructor(e){let{currentSortState:t,newSortState:n}=e;super("col_sort"),oQ(this,"previousSortState",void 0),oQ(this,"nextSortState",void 0),this.previousSortState=t,this.nextSortState=n}static startRegisteringEvents(e,t){e.addHook("beforeColumnSort",((e,n,r)=>{r&&t.done((()=>new sQ({currentSortState:e,newSortState:n})))}))}undo(e,t){const n=e.getPlugin("columnSorting"),r=e.getPlugin("multiColumnSorting"),i=r.isEnabled()?r:n;this.previousSortState.length?i.sort(this.previousSortState):i.clearSort(),t()}redo(e,t){const n=e.getPlugin("columnSorting"),r=e.getPlugin("multiColumnSorting");(r.isEnabled()?r:n).sort(this.nextSortState),t()}}function aQ(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class lQ extends eQ{constructor(e){let{index:t,amount:n}=e;super("insert_col"),aQ(this,"index",void 0),aQ(this,"amount",void 0),this.index=t,this.amount=n}static startRegisteringEvents(e,t){e.addHook("afterCreateCol",((e,n,r)=>{t.done((()=>new lQ({index:e,amount:n})),r)}))}undo(e,t){e.addHookOnce("afterRemoveCol",t),e.alter("remove_col",this.index,this.amount,"UndoRedo.undo")}redo(e,t){e.addHookOnce("afterCreateCol",t),e.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")}}function hQ(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class uQ extends eQ{constructor(e){let{index:t,amount:n}=e;super("insert_row"),hQ(this,"index",void 0),hQ(this,"amount",void 0),this.index=t,this.amount=n}static startRegisteringEvents(e,t){e.addHook("afterCreateRow",((e,n,r)=>{t.done((()=>new uQ({index:e,amount:n})),r)}))}undo(e,t){const n=e.countRows(),r=e.getSettings().minSpareRows;this.index>=n&&this.index-r<n&&(this.index-=r),e.addHookOnce("afterRemoveRow",t),e.alter("remove_row",this.index,this.amount,"UndoRedo.undo")}redo(e,t){e.addHookOnce("afterCreateRow",t),e.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")}}function cQ(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class dQ extends eQ{constructor(e){let{changes:t,selected:n,countCols:r,countRows:i}=e;super("change"),cQ(this,"changes",void 0),cQ(this,"selected",void 0),cQ(this,"countCols",void 0),cQ(this,"countRows",void 0),this.changes=t,this.selected=n,this.countCols=r,this.countRows=i}static startRegisteringEvents(e,t){e.addHook("beforeChange",(function(n,r){const i=n&&n.length;if(!i)return;if(!n.find((e=>{const[,,t,n]=e;return t!==n})))return;t.done((()=>{const t=n.reduce(((e,t)=>(e.push([...t]),e)),[]);t.forEach((t=>{t[1]=e.propToCol(t[1])}));const r=i>1?this.getSelected():[[t[0][0],t[0][1]]];return new dQ({changes:t,selected:r,countCols:e.countCols(),countRows:e.countRows()})}),r)}))}undo(e,t){const n=rm(this.changes);for(let o=0,s=n.length;o<s;o++)n[o].splice(3,1);e.addHookOnce("afterChange",t),e.setDataAtCell(n,null,null,"UndoRedo.undo");const r=e.countRows()-this.countRows;r>0&&e.alter("remove_row",null,r,"UndoRedo.undo");const i=e.countCols()-this.countCols;i>0&&e.isColumnModificationAllowed()&&e.alter("remove_col",null,i,"UndoRedo.undo"),e.scrollToFocusedCell(),e.selectCells(this.selected,!1,!1)}redo(e,t){const n=rm(this.changes);for(let r=0,i=n.length;r<i;r++)n[r].splice(2,1);e.addHookOnce("afterChange",t),e.setDataAtCell(n,null,null,"UndoRedo.redo"),this.selected&&e.selectCells(this.selected,!1,!1)}}function pQ(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class gQ extends eQ{constructor(e){let{conditionsStack:t,previousConditionsStack:n}=e;super("filter"),pQ(this,"conditionsStack",void 0),pQ(this,"previousConditionsStack",void 0),this.conditionsStack=t,this.previousConditionsStack=n}static startRegisteringEvents(e,t){e.addHook("beforeFilter",((e,n)=>{t.done((()=>new gQ({conditionsStack:e,previousConditionsStack:n})))}))}undo(e,t){const n=e.getPlugin("filters");e.addHookOnce("afterViewRender",t),n.importConditions(this.previousConditionsStack),n.filter()}redo(e,t){const n=e.getPlugin("filters");e.addHookOnce("afterViewRender",t),n.importConditions(this.conditionsStack),n.filter()}}function mQ(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class fQ extends eQ{constructor(e){let{data:t,cellRange:n}=e;super("merge_cells"),mQ(this,"cellRange",void 0),this.cellRange=n,this.data=t}static startRegisteringEvents(e,t){e.addHook("beforeMergeCells",((n,r)=>{if(r)return;const i=n.getTopStartCorner(),o=n.getBottomEndCorner(),s=e.getData(i.row,i.col,o.row,o.col);t.done((()=>new fQ({data:s,cellRange:n})))}))}undo(e,t){const n=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",t),n.unmergeRange(this.cellRange,!0);const r=this.cellRange.getTopStartCorner();e.populateFromArray(r.row,r.col,this.data,void 0,void 0,"MergeCells")}redo(e,t){const n=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",t),n.mergeRange(this.cellRange)}}var wQ=wu,yQ=nl;function vQ(e,t,n,r,i){const o=["visualRow","visualCol","row","col","prop"],s=o.length,a=[];return Jw(r,i,(r=>{Jw(t,n,(t=>{const n=e.getCellMeta(t,r);if(Object.keys(n).length!==s){const e=Object.fromEntries(Object.entries(n).filter((e=>{let[t]=e;return!1===o.includes(t)})));a.push([n.visualRow,n.visualCol,e])}}))})),a}function CQ(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Ti({target:"Object",stat:!0},{fromEntries:function(e){var t={};return wQ(e,(function(e,n){yQ(t,e,n)}),{AS_ENTRIES:!0}),t}});class SQ extends eQ{constructor(e){let{index:t,indexes:n,data:r,amount:i,headers:o,columnPositions:s,rowPositions:a,fixedColumnsStart:l,removedCellMetas:h}=e;super("remove_col"),CQ(this,"index",void 0),CQ(this,"indexes",void 0),CQ(this,"data",void 0),CQ(this,"amount",void 0),CQ(this,"headers",void 0),CQ(this,"columnPositions",void 0),CQ(this,"rowPositions",void 0),CQ(this,"fixedColumnsStart",void 0),CQ(this,"removedCellMetas",void 0),this.index=t,this.indexes=n,this.data=r,this.amount=i,this.headers=o,this.columnPositions=s.slice(0),this.rowPositions=a.slice(0),this.fixedColumnsStart=l,this.removedCellMetas=h}static startRegisteringEvents(e,t){e.addHook("beforeRemoveCol",((n,r,i,o)=>{t.done((()=>{const t=e.getSourceDataArray(),i=(e.countCols()+n)%e.countCols(),o=i+r-1,s=[],a=[],l=[];Jw(t.length-1,(n=>{const r=[],a=t[n];Jw(i,o,(t=>{r.push(a[e.toPhysicalColumn(t)])})),s.push(r)})),Jw(r-1,(t=>{l.push(e.toPhysicalColumn(i+t))})),Array.isArray(e.getSettings().colHeaders)&&Jw(r-1,(t=>{a.push(e.getSettings().colHeaders[e.toPhysicalColumn(i+t)]||null)}));const h=e.columnIndexMapper.getIndexesSequence(),u=e.rowIndexMapper.getIndexesSequence();return new SQ({index:i,indexes:l,data:s,amount:r,headers:a,columnPositions:h,rowPositions:u,fixedColumnsStart:e.getSettings().fixedColumnsStart,removedCellMetas:vQ(e,0,e.countRows(),i,o)})}),o)}))}undo(e,t){e.getSettings().fixedColumnsStart=this.fixedColumnsStart;const n=this.indexes.slice(0).sort(),r=(e,t,r)=>r[this.indexes.indexOf(n[t])],i=this.data.length,o=[];for(let l=0;l<i;l++)o.push(Dd(this.data[l],r));const s=Dd(this.headers,r),a=[];e.alter("insert_col_start",this.indexes[0],this.indexes.length,"UndoRedo.undo"),Vd(e.getSourceDataArray(),((e,t)=>{Vd(n,((n,r)=>{e[n]=o[t][r],a.push([t,n,e[n]])}))})),e.setSourceDataAtCell(a,void 0,void 0,"UndoRedo.undo"),void 0!==this.headers&&Vd(s,((t,r)=>{e.getSettings().colHeaders[n[r]]=t})),this.removedCellMetas.forEach((t=>{let[n,r,i]=t;e.setCellMetaObject(n,r,i)})),e.batchExecution((()=>{e.rowIndexMapper.setIndexesSequence(this.rowPositions),e.columnIndexMapper.setIndexesSequence(this.columnPositions)}),!0),e.addHookOnce("afterViewRender",t),e.render()}redo(e,t){e.addHookOnce("afterRemoveCol",t),e.alter("remove_col",this.index,this.amount,"UndoRedo.redo")}}function RQ(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class EQ extends eQ{constructor(e){let{index:t,data:n,fixedRowsBottom:r,fixedRowsTop:i,rowIndexesSequence:o,removedCellMetas:s}=e;super("remove_row"),RQ(this,"index",void 0),RQ(this,"data",void 0),RQ(this,"fixedRowsBottom",void 0),RQ(this,"fixedRowsTop",void 0),RQ(this,"rowIndexesSequence",void 0),RQ(this,"removedCellMetas",void 0),this.index=t,this.data=n,this.fixedRowsBottom=r,this.fixedRowsTop=i,this.rowIndexesSequence=o,this.removedCellMetas=s}static startRegisteringEvents(e,t){e.addHook("beforeRemoveRow",((n,r,i,o)=>{t.done((()=>{const t=e.toPhysicalRow(n),i=t+r-1,o=rm(e.getSourceData(t,0,t+r-1,e.countSourceCols()-1));return new EQ({index:t,data:o,fixedRowsBottom:e.getSettings().fixedRowsBottom,fixedRowsTop:e.getSettings().fixedRowsTop,rowIndexesSequence:e.rowIndexMapper.getIndexesSequence(),removedCellMetas:vQ(e,t,i,0,e.countCols()-1)})}),o)}))}undo(e,t){const n=e.getSettings(),r=[];n.fixedRowsBottom=this.fixedRowsBottom,n.fixedRowsTop=this.fixedRowsTop,this.data.forEach(((e,t)=>{Object.keys(e).forEach((n=>{const i=parseInt(n,10);r.push([this.index+t,isNaN(i)?n:i,e[n]])}))})),e.alter("insert_row_above",this.index,this.data.length,"UndoRedo.undo"),this.removedCellMetas.forEach((t=>{let[n,r,i]=t;e.setCellMetaObject(n,r,i)})),e.addHookOnce("afterViewRender",t),e.setSourceDataAtCell(r,null,null,"UndoRedo.undo"),e.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence)}redo(e,t){e.addHookOnce("afterRemoveRow",t),e.alter("remove_row",this.index,this.data.length,"UndoRedo.redo")}}function bQ(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class TQ extends eQ{constructor(e){let{rows:t,finalIndex:n}=e;super("row_move"),bQ(this,"rows",void 0),bQ(this,"finalRowIndex",void 0),this.rows=t.slice(),this.finalRowIndex=n}static startRegisteringEvents(e,t){e.addHook("beforeRowMove",((e,n)=>{!1!==e&&t.done((()=>new TQ({rows:e,finalIndex:n})))}))}undo(e,t){const n=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",t);LB(this.rows,this.finalRowIndex,e.rowIndexMapper.getNumberOfIndexes()).reverse().forEach((e=>{let{from:t,to:r}=e;t<r&&(r-=1),n.moveRow(r,t)})),e.render(),e.deselectCell(),e.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)}redo(e,t){const n=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",t),n.moveRows(this.rows.slice(),this.finalRowIndex),e.render(),e.deselectCell(),e.selectRows(this.finalRowIndex,this.finalRowIndex+this.rows.length-1)}}function NQ(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class AQ extends eQ{constructor(e){let{cellRange:t}=e;super("unmerge_cells"),NQ(this,"cellRange",void 0),this.cellRange=t}static startRegisteringEvents(e,t){e.addHook("afterUnmergeCells",((e,n)=>{n||t.done((()=>new AQ({cellRange:e})))}))}undo(e,t){const n=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",t),n.mergeRange(this.cellRange,!0)}redo(e,t){const n=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",t),n.unmergeRange(this.cellRange,!0),e.render()}}function MQ(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function IQ(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function OQ(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}const xQ="undoRedo";Rf.getSingleton().register("beforeUndo"),Rf.getSingleton().register("afterUndo"),Rf.getSingleton().register("beforeRedo"),Rf.getSingleton().register("afterRedo");const PQ=new Set;var _Q=new WeakSet;let LQ=class extends Hx{static get PLUGIN_KEY(){return"undoRedo"}static get PLUGIN_PRIORITY(){return 1e3}static get SETTING_KEYS(){return!0}constructor(e){var t,n;super(e),MQ(this,_Q),IQ(this,"doneActions",[]),IQ(this,"undoneActions",[]),IQ(this,"ignoreNewActions",!1),t=e,n=this,[nQ,iQ,sQ,lQ,uQ,dQ,gQ,fQ,SQ,EQ,TQ,AQ].forEach((e=>e.startRegisteringEvents(t,n)))}isEnabled(){return!!this.hot.getSettings().undo}enablePlugin(){var e=this;this.enabled||(this.addHook("afterChange",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return OQ(_Q,e,HQ).call(e,...n)})),this.registerShortcuts(),OQ(_Q,this,kQ).call(this),super.enablePlugin())}disablePlugin(){super.disablePlugin(),this.clear(),this.unregisterShortcuts(),OQ(_Q,this,FQ).call(this)}registerShortcuts(){const e=this.hot.getShortcutManager().getContext("grid"),t={runOnlyIf:e=>!e.altKey,group:xQ};e.addShortcuts([{keys:[["Control/Meta","z"]],callback:()=>{this.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:()=>{this.redo()}}],t)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(xQ)}done(e,t){if(this.ignoreNewActions)return;if("UndoRedo.undo"===t||"UndoRedo.redo"===t||"auto"===t)return;const n=this.doneActions.slice();if(!1===this.hot.runHooks("beforeUndoStackChange",n,t))return;const r=e(),i=this.undoneActions.slice();this.doneActions.push(r),this.hot.runHooks("afterUndoStackChange",n,this.doneActions.slice()),this.hot.runHooks("beforeRedoStackChange",i),this.undoneActions.length=0,this.hot.runHooks("afterRedoStackChange",i,this.undoneActions.slice())}undo(){if(!this.isUndoAvailable())return;const e=this.doneActions.slice();this.hot.runHooks("beforeUndoStackChange",e);const t=this.doneActions.pop();this.hot.runHooks("afterUndoStackChange",e,this.doneActions.slice());const n=rm(t);if(!1===this.hot.runHooks("beforeUndo",n))return;this.ignoreNewActions=!0;const r=this.undoneActions.slice();this.hot.runHooks("beforeRedoStackChange",r),t.undo(this.hot,(()=>{this.ignoreNewActions=!1,this.undoneActions.push(t)})),this.hot.runHooks("afterRedoStackChange",r,this.undoneActions.slice()),this.hot.runHooks("afterUndo",n)}redo(){if(!this.isRedoAvailable())return;const e=this.undoneActions.slice();this.hot.runHooks("beforeRedoStackChange",e);const t=this.undoneActions.pop();this.hot.runHooks("afterRedoStackChange",e,this.undoneActions.slice());const n=rm(t);if(!1===this.hot.runHooks("beforeRedo",n))return;this.ignoreNewActions=!0;const r=this.doneActions.slice();this.hot.runHooks("beforeUndoStackChange",r),t.redo(this.hot,(()=>{this.ignoreNewActions=!1,this.doneActions.push(t)})),this.hot.runHooks("afterUndoStackChange",r,this.doneActions.slice()),this.hot.runHooks("afterRedo",n)}isUndoAvailable(){return this.doneActions.length>0}isRedoAvailable(){return this.undoneActions.length>0}clear(){this.doneActions.length=0,this.undoneActions.length=0}destroy(){this.clear(),this.doneActions=null,this.undoneActions=null,super.destroy()}};function HQ(e,t){"loadData"===t&&this.clear()}function kQ(){const e=e=>{PQ.has(e)||(Fm(Wd`The "${e}" method is deprecated and it will be removed\x20
          from the Core API in the future. Please use the method from the UndoRedo plugin\x20
          (e.g. \`hotInstance.getPlugin("undoRedo").${e}()\`).`),PQ.add(e))};this.hot.undo=()=>{e("undo"),this.undo()},this.hot.redo=()=>{e("redo"),this.redo()},this.hot.isUndoAvailable=()=>(e("isUndoAvailable"),this.isUndoAvailable()),this.hot.isRedoAvailable=()=>(e("isRedoAvailable"),this.isRedoAvailable()),this.hot.clearUndo=()=>{e("clear"),this.clear()},this.hot.undoRedo=this}function FQ(){delete this.hot.undo,delete this.hot.redo,delete this.hot.isUndoAvailable,delete this.hot.isRedoAvailable,delete this.hot.clearUndo,delete this.hot.undoRedo}function DQ(){Hf(nM),Hf(sI),Hf(lI),Hf(BI),Hf(jI),Hf(JM),Hf(GI),Hf($I),Hf(XI),Hf(kM),Hf(qI),Ey(ZI),Ey(FM),Ey(aO),Ey(JI),Ey(hO),Ey(QI),Ey(ix),Ey(ox),Ey(sx),Ey(DM),Ey(ax),Iy(lx),Iy(cx),Iy(ux),Iy(dx),Iy(gx),EA(mx),EA(fx),EA(yx),EA(vx),EA(Cx),EA(Sx),EA(Rx),EA(Ex),EA(VM),EA(bx),fy(Zx),fy(pP),fy(NP),fy(zP),fy(o_),fy(z_),fy(iL),fy(EH),fy(Rk),fy(hF),fy(kF),fy(GF),fy(tD),fy(SD),fy(lB),fy(yW),fy(qW),fy(uj),fy(bj),fy(eG),fy(xG),fy(hz),fy(Uz),fy(rY),fy(HY),fy(FY),fy(kK),fy(NX),fy(YX),fy(tq),fy(kq),fy(jq),fy(Qq),fy(LQ)}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */var VQ,UQ;!function(e){e.RELATIVE="RELATIVE",e.ABSOLUTE="ABSOLUTE"}(VQ||(VQ={}));class BQ{constructor(e,t,n){this.type=e,this.col=t,this.sheet=n}static absolute(e,t){return new BQ(VQ.ABSOLUTE,e,t)}static relative(e,t){return new BQ(VQ.RELATIVE,e,t)}static compareByAbsoluteAddress(e){return(t,n)=>t.toSimpleColumnAddress(e).col-n.toSimpleColumnAddress(e).col}isColumnAbsolute(){return this.type===VQ.ABSOLUTE}isColumnRelative(){return this.type===VQ.RELATIVE}isAbsolute(){return this.type===VQ.ABSOLUTE&&void 0!==this.sheet}moved(e,t,n){const r=void 0===this.sheet?void 0:e;return new BQ(this.type,this.col+t,r)}shiftedByColumns(e){return new BQ(this.type,this.col+e,this.sheet)}toSimpleColumnAddress(e){const t=O4(this,e);let n=this.col;return this.isColumnRelative()&&(n=e.col+this.col),E4(t,n)}shiftRelativeDimensions(e,t){const n=this.isColumnRelative()?this.col+e:this.col;return new BQ(this.type,n,this.sheet)}shiftAbsoluteDimensions(e,t){const n=this.isColumnAbsolute()?this.col+e:this.col;return new BQ(this.type,n,this.sheet)}withSheet(e){return new BQ(this.type,this.col,e)}isInvalid(e){return this.toSimpleColumnAddress(e).col<0}hash(e){const t=e&&void 0!==this.sheet?`#${this.sheet}`:"";switch(this.type){case VQ.RELATIVE:return`${t}#COLR${this.col}`;case VQ.ABSOLUTE:return`${t}#COLA${this.col}`}}unparse(e){const t=this.toSimpleColumnAddress(e);if(b4(t))return;const n=gZ(t.col);return`${this.type===VQ.ABSOLUTE?"$":""}${n}`}exceedsSheetSizeLimits(e){return this.col>=e}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class WQ{constructor(e,t,n){this.type=e,this.row=t,this.sheet=n}static absolute(e,t){return new WQ(VQ.ABSOLUTE,e,t)}static relative(e,t){return new WQ(VQ.RELATIVE,e,t)}static compareByAbsoluteAddress(e){return(t,n)=>t.toSimpleRowAddress(e).row-n.toSimpleRowAddress(e).row}isRowAbsolute(){return this.type===VQ.ABSOLUTE}isRowRelative(){return this.type===VQ.RELATIVE}isAbsolute(){return this.type===VQ.ABSOLUTE&&void 0!==this.sheet}moved(e,t,n){const r=void 0===this.sheet?void 0:e;return new WQ(this.type,this.row+n,r)}shiftedByRows(e){return new WQ(this.type,this.row+e,this.sheet)}toSimpleRowAddress(e){const t=O4(this,e);let n=this.row;return this.isRowRelative()&&(n=e.row+this.row),S4(t,n)}shiftRelativeDimensions(e,t){const n=this.isRowRelative()?this.row+t:this.row;return new WQ(this.type,n,this.sheet)}shiftAbsoluteDimensions(e,t){const n=this.isRowAbsolute()?this.row+t:this.row;return new WQ(this.type,n,this.sheet)}withSheet(e){return new WQ(this.type,this.row,e)}isInvalid(e){return this.toSimpleRowAddress(e).row<0}hash(e){const t=e&&void 0!==this.sheet?`#${this.sheet}`:"";switch(this.type){case VQ.RELATIVE:return`${t}#ROWR${this.row}`;case VQ.ABSOLUTE:return`${t}#ROWA${this.row}`}}unparse(e){const t=this.toSimpleRowAddress(e);if(R4(t))return;return`${this.type===VQ.ABSOLUTE?"$":""}${t.row+1}`}exceedsSheetSizeLimits(e){return this.row>=e}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */!function(e){e.CELL_REFERENCE_RELATIVE="CELL_REFERENCE",e.CELL_REFERENCE_ABSOLUTE="CELL_REFERENCE_ABSOLUTE",e.CELL_REFERENCE_ABSOLUTE_COL="CELL_REFERENCE_ABSOLUTE_COL",e.CELL_REFERENCE_ABSOLUTE_ROW="CELL_REFERENCE_ABSOLUTE_ROW"}(UQ||(UQ={}));class jQ{constructor(e,t,n,r){this.col=e,this.row=t,this.type=n,this.sheet=r}static fromColAndRow(e,t,n){return(e.isColumnAbsolute()&&t.isRowAbsolute()?jQ.absolute.bind(this):e.isColumnAbsolute()?jQ.absoluteCol.bind(this):t.isRowAbsolute()?jQ.absoluteRow.bind(this):jQ.relative.bind(this))(e.col,t.row,n)}static relative(e,t,n){return new jQ(e,t,UQ.CELL_REFERENCE_RELATIVE,n)}static absolute(e,t,n){return new jQ(e,t,UQ.CELL_REFERENCE_ABSOLUTE,n)}static absoluteCol(e,t,n){return new jQ(e,t,UQ.CELL_REFERENCE_ABSOLUTE_COL,n)}static absoluteRow(e,t,n){return new jQ(e,t,UQ.CELL_REFERENCE_ABSOLUTE_ROW,n)}toSimpleCellAddress(e){const t=O4(this,e);return this.type===UQ.CELL_REFERENCE_ABSOLUTE?T4(t,this.col,this.row):this.type===UQ.CELL_REFERENCE_ABSOLUTE_ROW?T4(t,e.col+this.col,this.row):this.type===UQ.CELL_REFERENCE_ABSOLUTE_COL?T4(t,this.col,e.row+this.row):T4(t,e.col+this.col,e.row+this.row)}toColumnAddress(){const e=this.isColumnRelative()?VQ.RELATIVE:VQ.ABSOLUTE;return new BQ(e,this.col,this.sheet)}toRowAddress(){const e=this.isRowRelative()?VQ.RELATIVE:VQ.ABSOLUTE;return new WQ(e,this.row,this.sheet)}toSimpleColumnAddress(e){const t=O4(this,e);let n=this.col;return this.isColumnRelative()&&(n+=e.col),E4(t,n)}toSimpleRowAddress(e){const t=O4(this,e);let n=this.row;return this.isRowRelative()&&(n+=e.row),S4(t,n)}isRowAbsolute(){return this.type===UQ.CELL_REFERENCE_ABSOLUTE||this.type===UQ.CELL_REFERENCE_ABSOLUTE_ROW}isColumnAbsolute(){return this.type===UQ.CELL_REFERENCE_ABSOLUTE||this.type===UQ.CELL_REFERENCE_ABSOLUTE_COL}isColumnRelative(){return this.type===UQ.CELL_REFERENCE_RELATIVE||this.type===UQ.CELL_REFERENCE_ABSOLUTE_ROW}isRowRelative(){return this.type===UQ.CELL_REFERENCE_RELATIVE||this.type===UQ.CELL_REFERENCE_ABSOLUTE_COL}isAbsolute(){return this.type===UQ.CELL_REFERENCE_ABSOLUTE&&void 0!==this.sheet}shiftedByRows(e){return new jQ(this.col,this.row+e,this.type,this.sheet)}shiftedByColumns(e){return new jQ(this.col+e,this.row,this.type,this.sheet)}moved(e,t,n){const r=void 0===this.sheet?void 0:e;return new jQ(this.col+t,this.row+n,this.type,r)}withSheet(e){return new jQ(this.col,this.row,this.type,e)}isInvalid(e){return N4(this.toSimpleCellAddress(e))}shiftRelativeDimensions(e,t){const n=this.isColumnAbsolute()?this.col:this.col+e,r=this.isRowAbsolute()?this.row:this.row+t;return new jQ(n,r,this.type,this.sheet)}shiftAbsoluteDimensions(e,t){const n=this.isColumnRelative()?this.col:this.col+e,r=this.isRowRelative()?this.row:this.row+t;return new jQ(n,r,this.type,this.sheet)}hash(e){const t=e&&void 0!==this.sheet?`#${this.sheet}`:"";switch(this.type){case UQ.CELL_REFERENCE_RELATIVE:return`${t}#${this.row}R${this.col}`;case UQ.CELL_REFERENCE_ABSOLUTE:return`${t}#${this.row}A${this.col}`;case UQ.CELL_REFERENCE_ABSOLUTE_COL:return`${t}#${this.row}AC${this.col}`;case UQ.CELL_REFERENCE_ABSOLUTE_ROW:return`${t}#${this.row}AR${this.col}`}}unparse(e){const t=this.toSimpleCellAddress(e);if(N4(t))return;const n=gZ(t.col),r=this.type===UQ.CELL_REFERENCE_ABSOLUTE||this.type===UQ.CELL_REFERENCE_ABSOLUTE_ROW?"$":"";return`${this.type===UQ.CELL_REFERENCE_ABSOLUTE||this.type===UQ.CELL_REFERENCE_ABSOLUTE_COL?"$":""}${n}${r}${t.row+1}`}exceedsSheetSizeLimits(e,t){return this.row>=t||this.col>=e}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */const GQ=":",zQ="$",$Q="A-Za-zÃ-Ê¯",YQ=`${$Q}0-9_.`,KQ=`[${$Q}0-9_]+`,XQ=`(${KQ}|'(((?!').|'')*)')!`,qQ=`(${XQ})?\\${zQ}?[A-Za-z]+\\${zQ}?[0-9]+`,QQ=`(${XQ})?\\${zQ}?[A-Za-z]+`,ZQ=`(${XQ})?\\${zQ}?[0-9]+`,JQ="[rR][0-9]*[cC][0-9]*",eZ=`(${qQ})[^${YQ}]`,tZ=`[${$Q}_][${YQ}]*`,nZ=["0","1","2","3","4","5","6","7","8","9"],rZ=[...Array.from(Array(26)).map(((e,t)=>t+"A".charCodeAt(0))),...Array.from(Array(26)).map(((e,t)=>t+"a".charCodeAt(0))),...Array.from(Array(496)).map(((e,t)=>t+192))].map((e=>String.fromCharCode(e))),iZ=new RegExp(`^(${XQ})?(\\${zQ}?)([A-Za-z]+)(\\${zQ}?)([0-9]+)$`),oZ=new RegExp(`^(${XQ})?(\\${zQ}?)([A-Za-z]+)$`),sZ=new RegExp(`^(${XQ})?(\\${zQ}?)([0-9]+)$`),aZ=new RegExp(`^${KQ}$`),lZ=(e,t,n)=>{const r=iZ.exec(t),i=pZ(r[6]);let o=fZ(r,e);if(void 0===o)return;null===o&&(o=void 0);const s=Number(r[8])-1;return r[5]===zQ&&r[7]===zQ?jQ.absolute(i,s,o):r[5]===zQ?jQ.absoluteCol(i,s-n.row,o):r[7]===zQ?jQ.absoluteRow(i-n.col,s,o):jQ.relative(i-n.col,s-n.row,o)},hZ=(e,t,n)=>{const r=oZ.exec(t);let i=fZ(r,e);if(void 0===i)return;null===i&&(i=void 0);const o=pZ(r[6]);return r[5]===zQ?BQ.absolute(o,i):BQ.relative(o-n.col,i)},uZ=(e,t,n)=>{const r=sZ.exec(t);let i=fZ(r,e);if(void 0===i)return;null===i&&(i=void 0);const o=Number(r[6])-1;return r[5]===zQ?WQ.absolute(o,i):WQ.relative(o-n.row,i)},cZ=(e,t,n)=>{const r=iZ.exec(t);if(!r)return;const i=pZ(r[6]);let o=fZ(r,e);if(void 0===o)return;null===o&&(o=n);const s=Number(r[8])-1;return T4(o,i,s)},dZ=(e,t,n)=>{const r=gZ(t.col),i=mZ(t.sheet,e);if(void 0!==i)return n!==t.sheet?`${i}!${r}${t.row+1}`:`${r}${t.row+1}`};function pZ(e){return 1===e.length?e.toUpperCase().charCodeAt(0)-65:e.split("").reduce(((e,t)=>26*e+(t.toUpperCase().charCodeAt(0)-64)),0)-1}function gZ(e){let t="";for(;e>=0;)t=String.fromCharCode(e%26+97)+t,e=Math.floor(e/26)-1;return t.toUpperCase()}function mZ(e,t){let n=t(e);if(void 0!==n)return aZ.test(n)?n:(n=n.replace(/'/g,"''"),`'${n}'`)}function fZ(e,t){var n;let r=null!==(n=e[3])&&void 0!==n?n:e[2];return r?(r=r.replace(/''/g,"'"),t(r)):null}function wZ(e){return e&&0===e.length}function yZ(e){return null==e?[]:Object.keys(e)}function vZ(e){for(var t=[],n=Object.keys(e),r=0;r<n.length;r++)t.push(e[n[r]]);return t}function CZ(e,t){for(var n=[],r=0;r<e.length;r++)n.push(t.call(null,e[r],r));return n}function SZ(e){for(var t=[],n=0;n<e.length;n++){var r=e[n];Array.isArray(r)?t=t.concat(SZ(r)):t.push(r)}return t}function RZ(e){return wZ(e)?void 0:e[0]}function EZ(e){var t=e&&e.length;return t?e[t-1]:void 0}function bZ(e,t){if(Array.isArray(e))for(var n=0;n<e.length;n++)t.call(null,e[n],n);else{if(!jZ(e))throw Error("non exhaustive match");var r=yZ(e);for(n=0;n<r.length;n++){var i=r[n],o=e[i];t.call(null,o,i)}}}function TZ(e){return"string"==typeof e}function NZ(e){return void 0===e}function AZ(e){return e instanceof Function}function MZ(e,t){return void 0===t&&(t=1),e.slice(t,e.length)}function IZ(e,t){return void 0===t&&(t=1),e.slice(0,e.length-t)}function OZ(e,t){var n=[];if(Array.isArray(e))for(var r=0;r<e.length;r++){var i=e[r];t.call(null,i)&&n.push(i)}return n}function xZ(e,t){return OZ(e,(function(e){return!t(e)}))}function PZ(e,t){for(var n=Object.keys(e),r={},i=0;i<n.length;i++){var o=n[i],s=e[o];t(s)&&(r[o]=s)}return r}function _Z(e,t){return!!jZ(e)&&e.hasOwnProperty(t)}function LZ(e,t){return void 0!==FZ(e,(function(e){return e===t}))}function HZ(e){for(var t=[],n=0;n<e.length;n++)t.push(e[n]);return t}function kZ(e){var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}function FZ(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(t.call(null,r))return r}}function DZ(e,t,n){for(var r=Array.isArray(e),i=r?e:vZ(e),o=r?[]:yZ(e),s=n,a=0;a<i.length;a++)s=t.call(null,s,i[a],r?a:o[a]);return s}function VZ(e){return xZ(e,(function(e){return null==e}))}function UZ(e,t){void 0===t&&(t=function(e){return e});var n=[];return DZ(e,(function(e,r){var i=t(r);return LZ(n,i)?e:(n.push(i),e.concat(r))}),[])}function BZ(e){return Array.isArray(e)}function WZ(e){return e instanceof RegExp}function jZ(e){return e instanceof Object}function GZ(e,t){for(var n=0;n<e.length;n++)if(!t(e[n],n))return!1;return!0}function zZ(e,t){return xZ(e,(function(e){return LZ(t,e)}))}function $Z(e,t){for(var n=0;n<e.length;n++)if(t(e[n]))return!0;return!1}function YZ(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var r=0;r<t.length;r++)for(var i=t[r],o=yZ(i),s=0;s<o.length;s++){var a=o[s];e[a]=i[a]}return e}function KZ(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var r=0;r<t.length;r++){var i=t[r];if(!NZ(i))for(var o=yZ(i),s=0;s<o.length;s++){var a=o[s];_Z(e,a)||(e[a]=i[a])}}return e}function XZ(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return KZ.apply(null,[{}].concat(e))}function qZ(e,t){var n={};return bZ(e,(function(e){var r=t(e),i=n[r];i?i.push(e):n[r]=[e]})),n}function QZ(e,t){for(var n=kZ(e),r=yZ(t),i=0;i<r.length;i++){var o=r[i],s=t[o];n[o]=s}return n}function ZZ(){}function JZ(e){return e}function eJ(e){console&&console.error&&console.error("Error: "+e)}function tJ(e){console&&console.warn&&console.warn("Warning: "+e)}function nJ(){return"function"==typeof Map}function rJ(e){function t(){}t.prototype=e;var n=new t;function r(){return typeof n.bar}return r(),r(),e}function iJ(e){return e[e.length-1]}function oJ(e){var t=(new Date).getTime(),n=e();return{time:(new Date).getTime()-t,value:n}}var sJ={exports:{}};!function(e){var n,r;n="undefined"!=typeof self?self:t,r=function(){function e(){}e.prototype.saveState=function(){return{idx:this.idx,input:this.input,groupIdx:this.groupIdx}},e.prototype.restoreState=function(e){this.idx=e.idx,this.input=e.input,this.groupIdx=e.groupIdx},e.prototype.pattern=function(e){this.idx=0,this.input=e,this.groupIdx=0,this.consumeChar("/");var t=this.disjunction();this.consumeChar("/");for(var n={type:"Flags",global:!1,ignoreCase:!1,multiLine:!1,unicode:!1,sticky:!1};this.isRegExpFlag();)switch(this.popChar()){case"g":a(n,"global");break;case"i":a(n,"ignoreCase");break;case"m":a(n,"multiLine");break;case"u":a(n,"unicode");break;case"y":a(n,"sticky")}if(this.idx!==this.input.length)throw Error("Redundant input: "+this.input.substring(this.idx));return{type:"Pattern",flags:n,value:t}},e.prototype.disjunction=function(){var e=[];for(e.push(this.alternative());"|"===this.peekChar();)this.consumeChar("|"),e.push(this.alternative());return{type:"Disjunction",value:e}},e.prototype.alternative=function(){for(var e=[];this.isTerm();)e.push(this.term());return{type:"Alternative",value:e}},e.prototype.term=function(){return this.isAssertion()?this.assertion():this.atom()},e.prototype.assertion=function(){switch(this.popChar()){case"^":return{type:"StartAnchor"};case"$":return{type:"EndAnchor"};case"\\":switch(this.popChar()){case"b":return{type:"WordBoundary"};case"B":return{type:"NonWordBoundary"}}throw Error("Invalid Assertion Escape");case"(":var e;switch(this.consumeChar("?"),this.popChar()){case"=":e="Lookahead";break;case"!":e="NegativeLookahead"}l(e);var t=this.disjunction();return this.consumeChar(")"),{type:e,value:t}}!function(){throw Error("Internal Error - Should never get here!")}()},e.prototype.quantifier=function(e){var t;switch(this.popChar()){case"*":t={atLeast:0,atMost:1/0};break;case"+":t={atLeast:1,atMost:1/0};break;case"?":t={atLeast:0,atMost:1};break;case"{":var n=this.integerIncludingZero();switch(this.popChar()){case"}":t={atLeast:n,atMost:n};break;case",":t=this.isDigit()?{atLeast:n,atMost:this.integerIncludingZero()}:{atLeast:n,atMost:1/0},this.consumeChar("}")}if(!0===e&&void 0===t)return;l(t)}if(!0!==e||void 0!==t)return l(t),"?"===this.peekChar(0)?(this.consumeChar("?"),t.greedy=!1):t.greedy=!0,t.type="Quantifier",t},e.prototype.atom=function(){var e;switch(this.peekChar()){case".":e=this.dotAll();break;case"\\":e=this.atomEscape();break;case"[":e=this.characterClass();break;case"(":e=this.group()}return void 0===e&&this.isPatternCharacter()&&(e=this.patternCharacter()),l(e),this.isQuantifier()&&(e.quantifier=this.quantifier()),e},e.prototype.dotAll=function(){return this.consumeChar("."),{type:"Set",complement:!0,value:[o("\n"),o("\r"),o("\u2028"),o("\u2029")]}},e.prototype.atomEscape=function(){switch(this.consumeChar("\\"),this.peekChar()){case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":return this.decimalEscapeAtom();case"d":case"D":case"s":case"S":case"w":case"W":return this.characterClassEscape();case"f":case"n":case"r":case"t":case"v":return this.controlEscapeAtom();case"c":return this.controlLetterEscapeAtom();case"0":return this.nulCharacterAtom();case"x":return this.hexEscapeSequenceAtom();case"u":return this.regExpUnicodeEscapeSequenceAtom();default:return this.identityEscapeAtom()}},e.prototype.decimalEscapeAtom=function(){return{type:"GroupBackReference",value:this.positiveInteger()}},e.prototype.characterClassEscape=function(){var e,t=!1;switch(this.popChar()){case"d":e=h;break;case"D":e=h,t=!0;break;case"s":e=c;break;case"S":e=c,t=!0;break;case"w":e=u;break;case"W":e=u,t=!0}return l(e),{type:"Set",value:e,complement:t}},e.prototype.controlEscapeAtom=function(){var e;switch(this.popChar()){case"f":e=o("\f");break;case"n":e=o("\n");break;case"r":e=o("\r");break;case"t":e=o("\t");break;case"v":e=o("\v")}return l(e),{type:"Character",value:e}},e.prototype.controlLetterEscapeAtom=function(){this.consumeChar("c");var e=this.popChar();if(!1===/[a-zA-Z]/.test(e))throw Error("Invalid ");return{type:"Character",value:e.toUpperCase().charCodeAt(0)-64}},e.prototype.nulCharacterAtom=function(){return this.consumeChar("0"),{type:"Character",value:o("\0")}},e.prototype.hexEscapeSequenceAtom=function(){return this.consumeChar("x"),this.parseHexDigits(2)},e.prototype.regExpUnicodeEscapeSequenceAtom=function(){return this.consumeChar("u"),this.parseHexDigits(4)},e.prototype.identityEscapeAtom=function(){return{type:"Character",value:o(this.popChar())}},e.prototype.classPatternCharacterAtom=function(){switch(this.peekChar()){case"\n":case"\r":case"\u2028":case"\u2029":case"\\":case"]":throw Error("TBD");default:return{type:"Character",value:o(this.popChar())}}},e.prototype.characterClass=function(){var e=[],t=!1;for(this.consumeChar("["),"^"===this.peekChar(0)&&(this.consumeChar("^"),t=!0);this.isClassAtom();){var n=this.classAtom();if("Character"===n.type&&this.isRangeDash()){this.consumeChar("-");var r=this.classAtom();if("Character"===r.type){if(r.value<n.value)throw Error("Range out of order in character class");e.push({from:n.value,to:r.value})}else s(n.value,e),e.push(o("-")),s(r.value,e)}else s(n.value,e)}return this.consumeChar("]"),{type:"Set",complement:t,value:e}},e.prototype.classAtom=function(){switch(this.peekChar()){case"]":case"\n":case"\r":case"\u2028":case"\u2029":throw Error("TBD");case"\\":return this.classEscape();default:return this.classPatternCharacterAtom()}},e.prototype.classEscape=function(){switch(this.consumeChar("\\"),this.peekChar()){case"b":return this.consumeChar("b"),{type:"Character",value:o("\b")};case"d":case"D":case"s":case"S":case"w":case"W":return this.characterClassEscape();case"f":case"n":case"r":case"t":case"v":return this.controlEscapeAtom();case"c":return this.controlLetterEscapeAtom();case"0":return this.nulCharacterAtom();case"x":return this.hexEscapeSequenceAtom();case"u":return this.regExpUnicodeEscapeSequenceAtom();default:return this.identityEscapeAtom()}},e.prototype.group=function(){var e=!0;this.consumeChar("("),"?"===this.peekChar(0)?(this.consumeChar("?"),this.consumeChar(":"),e=!1):this.groupIdx++;var t=this.disjunction();this.consumeChar(")");var n={type:"Group",capturing:e,value:t};return e&&(n.idx=this.groupIdx),n},e.prototype.positiveInteger=function(){var e=this.popChar();if(!1===i.test(e))throw Error("Expecting a positive integer");for(;r.test(this.peekChar(0));)e+=this.popChar();return parseInt(e,10)},e.prototype.integerIncludingZero=function(){var e=this.popChar();if(!1===r.test(e))throw Error("Expecting an integer");for(;r.test(this.peekChar(0));)e+=this.popChar();return parseInt(e,10)},e.prototype.patternCharacter=function(){var e=this.popChar();switch(e){case"\n":case"\r":case"\u2028":case"\u2029":case"^":case"$":case"\\":case".":case"*":case"+":case"?":case"(":case")":case"[":case"|":throw Error("TBD");default:return{type:"Character",value:o(e)}}},e.prototype.isRegExpFlag=function(){switch(this.peekChar(0)){case"g":case"i":case"m":case"u":case"y":return!0;default:return!1}},e.prototype.isRangeDash=function(){return"-"===this.peekChar()&&this.isClassAtom(1)},e.prototype.isDigit=function(){return r.test(this.peekChar(0))},e.prototype.isClassAtom=function(e){switch(void 0===e&&(e=0),this.peekChar(e)){case"]":case"\n":case"\r":case"\u2028":case"\u2029":return!1;default:return!0}},e.prototype.isTerm=function(){return this.isAtom()||this.isAssertion()},e.prototype.isAtom=function(){if(this.isPatternCharacter())return!0;switch(this.peekChar(0)){case".":case"\\":case"[":case"(":return!0;default:return!1}},e.prototype.isAssertion=function(){switch(this.peekChar(0)){case"^":case"$":return!0;case"\\":switch(this.peekChar(1)){case"b":case"B":return!0;default:return!1}case"(":return"?"===this.peekChar(1)&&("="===this.peekChar(2)||"!"===this.peekChar(2));default:return!1}},e.prototype.isQuantifier=function(){var e=this.saveState();try{return void 0!==this.quantifier(!0)}catch(t){return!1}finally{this.restoreState(e)}},e.prototype.isPatternCharacter=function(){switch(this.peekChar()){case"^":case"$":case"\\":case".":case"*":case"+":case"?":case"(":case")":case"[":case"|":case"/":case"\n":case"\r":case"\u2028":case"\u2029":return!1;default:return!0}},e.prototype.parseHexDigits=function(e){for(var t="",r=0;r<e;r++){var i=this.popChar();if(!1===n.test(i))throw Error("Expecting a HexDecimal digits");t+=i}return{type:"Character",value:parseInt(t,16)}},e.prototype.peekChar=function(e){return void 0===e&&(e=0),this.input[this.idx+e]},e.prototype.popChar=function(){var e=this.peekChar(0);return this.consumeChar(),e},e.prototype.consumeChar=function(e){if(void 0!==e&&this.input[this.idx]!==e)throw Error("Expected: '"+e+"' but found: '"+this.input[this.idx]+"' at offset: "+this.idx);if(this.idx>=this.input.length)throw Error("Unexpected end of input");this.idx++};var t,n=/[0-9a-fA-F]/,r=/[0-9]/,i=/[1-9]/;function o(e){return e.charCodeAt(0)}function s(e,t){void 0!==e.length?e.forEach((function(e){t.push(e)})):t.push(e)}function a(e,t){if(!0===e[t])throw"duplicate flag "+t;e[t]=!0}function l(e){if(void 0===e)throw Error("Internal Error - Should never get here!")}var h=[];for(t=o("0");t<=o("9");t++)h.push(t);var u=[o("_")].concat(h);for(t=o("a");t<=o("z");t++)u.push(t);for(t=o("A");t<=o("Z");t++)u.push(t);var c=[o(" "),o("\f"),o("\n"),o("\r"),o("\t"),o("\v"),o("\t"),o("Â "),o("á"),o("â"),o("â"),o("â"),o("â"),o("â"),o("â"),o("â"),o("â"),o("â"),o("â"),o("â"),o("\u2028"),o("\u2029"),o("â¯"),o("â"),o("ã"),o("\ufeff")];function d(){}return d.prototype.visitChildren=function(e){for(var t in e){var n=e[t];e.hasOwnProperty(t)&&(void 0!==n.type?this.visit(n):Array.isArray(n)&&n.forEach((function(e){this.visit(e)}),this))}},d.prototype.visit=function(e){switch(e.type){case"Pattern":this.visitPattern(e);break;case"Flags":this.visitFlags(e);break;case"Disjunction":this.visitDisjunction(e);break;case"Alternative":this.visitAlternative(e);break;case"StartAnchor":this.visitStartAnchor(e);break;case"EndAnchor":this.visitEndAnchor(e);break;case"WordBoundary":this.visitWordBoundary(e);break;case"NonWordBoundary":this.visitNonWordBoundary(e);break;case"Lookahead":this.visitLookahead(e);break;case"NegativeLookahead":this.visitNegativeLookahead(e);break;case"Character":this.visitCharacter(e);break;case"Set":this.visitSet(e);break;case"Group":this.visitGroup(e);break;case"GroupBackReference":this.visitGroupBackReference(e);break;case"Quantifier":this.visitQuantifier(e)}this.visitChildren(e)},d.prototype.visitPattern=function(e){},d.prototype.visitFlags=function(e){},d.prototype.visitDisjunction=function(e){},d.prototype.visitAlternative=function(e){},d.prototype.visitStartAnchor=function(e){},d.prototype.visitEndAnchor=function(e){},d.prototype.visitWordBoundary=function(e){},d.prototype.visitNonWordBoundary=function(e){},d.prototype.visitLookahead=function(e){},d.prototype.visitNegativeLookahead=function(e){},d.prototype.visitCharacter=function(e){},d.prototype.visitSet=function(e){},d.prototype.visitGroup=function(e){},d.prototype.visitGroupBackReference=function(e){},d.prototype.visitQuantifier=function(e){},{RegExpParser:e,BaseRegExpVisitor:d,VERSION:"0.4.0"}},e.exports?e.exports=r():n.regexpToAst=r()}(sJ);var aJ=sJ.exports,lJ={},hJ=new aJ.RegExpParser;function uJ(e){var t=e.toString();if(lJ.hasOwnProperty(t))return lJ[t];var n=hJ.pattern(t);return lJ[t]=n,n}var cJ,dJ=(cJ=function(e,t){return cJ=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},cJ(e,t)},function(e,t){function n(){this.constructor=e}cJ(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),pJ="Complement Sets are not supported for first char optimization",gJ='Unable to use "first char" lexer optimizations:\n';function mJ(e,t){void 0===t&&(t=!1);try{var n=uJ(e);return fJ(n.value,{},n.flags.ignoreCase)}catch(i){if(i.message===pJ)t&&tJ(gJ+"\tUnable to optimize: < "+e.toString()+" >\n\tComplement Sets cannot be automatically optimized.\n\tThis will disable the lexer's first char optimizations.\n\tSee: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#COMPLEMENT for details.");else{var r="";t&&(r="\n\tThis will disable the lexer's first char optimizations.\n\tSee: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#REGEXP_PARSING for details."),eJ(gJ+"\n\tFailed parsing: < "+e.toString()+" >\n\tUsing the regexp-to-ast library version: "+aJ.VERSION+"\n\tPlease open an issue at: https://github.com/bd82/regexp-to-ast/issues"+r)}}return[]}function fJ(e,t,n){switch(e.type){case"Disjunction":for(var r=0;r<e.value.length;r++)fJ(e.value[r],t,n);break;case"Alternative":var i=e.value;for(r=0;r<i.length;r++){var o=i[r];switch(o.type){case"EndAnchor":case"GroupBackReference":case"Lookahead":case"NegativeLookahead":case"StartAnchor":case"WordBoundary":case"NonWordBoundary":continue}var s=o;switch(s.type){case"Character":wJ(s.value,t,n);break;case"Set":if(!0===s.complement)throw Error(pJ);bZ(s.value,(function(e){if("number"==typeof e)wJ(e,t,n);else{var r=e;if(!0===n)for(var i=r.from;i<=r.to;i++)wJ(i,t,n);else{for(i=r.from;i<=r.to&&i<UJ;i++)wJ(i,t,n);if(r.to>=UJ)for(var o=r.from>=UJ?r.from:UJ,s=r.to,a=BJ(o),l=BJ(s),h=a;h<=l;h++)t[h]=h}}}));break;case"Group":fJ(s.value,t,n);break;default:throw Error("Non Exhaustive Match")}var a=void 0!==s.quantifier&&0===s.quantifier.atLeast;if("Group"===s.type&&!1===vJ(s)||"Group"!==s.type&&!1===a)break}break;default:throw Error("non exhaustive match!")}return vZ(t)}function wJ(e,t,n){var r=BJ(e);t[r]=r,!0===n&&function(e,t){var n=String.fromCharCode(e),r=n.toUpperCase();if(r!==n){t[i=BJ(r.charCodeAt(0))]=i}else{var i,o=n.toLowerCase();if(o!==n)t[i=BJ(o.charCodeAt(0))]=i}}(e,t)}function yJ(e,t){return FZ(e.value,(function(e){if("number"==typeof e)return LZ(t,e);var n=e;return void 0!==FZ(t,(function(e){return n.from<=e&&e<=n.to}))}))}function vJ(e){return!(!e.quantifier||0!==e.quantifier.atLeast)||!!e.value&&(BZ(e.value)?GZ(e.value,vJ):vJ(e.value))}var CJ=function(e){function t(t){var n=e.call(this)||this;return n.targetCharCodes=t,n.found=!1,n}return dJ(t,e),t.prototype.visitChildren=function(t){if(!0!==this.found){switch(t.type){case"Lookahead":return void this.visitLookahead(t);case"NegativeLookahead":return void this.visitNegativeLookahead(t)}e.prototype.visitChildren.call(this,t)}},t.prototype.visitCharacter=function(e){LZ(this.targetCharCodes,e.value)&&(this.found=!0)},t.prototype.visitSet=function(e){e.complement?void 0===yJ(e,this.targetCharCodes)&&(this.found=!0):void 0!==yJ(e,this.targetCharCodes)&&(this.found=!0)},t}(aJ.BaseRegExpVisitor);function SJ(e,t){if(t instanceof RegExp){var n=uJ(t),r=new CJ(e);return r.visit(n),r.found}return void 0!==FZ(t,(function(t){return LZ(e,t.charCodeAt(0))}))}var RJ=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),EJ="PATTERN",bJ="defaultMode",TJ="modes",NJ="boolean"==typeof new RegExp("(?:)").sticky;function AJ(e,t){var n,r=(t=XZ(t,{useSticky:NJ,debug:!1,safeMode:!1,positionTracking:"full",lineTerminatorCharacters:["\r","\n"],tracer:function(e,t){return t()}})).tracer;r("initCharCodeToOptimizedIndexMap",(function(){!function(){if(wZ(WJ)){WJ=new Array(65536);for(var e=0;e<65536;e++)WJ[e]=e>255?255+~~(e/255):e}}()})),r("Reject Lexer.NA",(function(){n=xZ(e,(function(e){return e[EJ]===e0.NA}))}));var i,o,s,a,l,h,u,c,d,p,g,m=!1;r("Transform Patterns",(function(){m=!1,i=CZ(n,(function(e){var n=e[EJ];if(WZ(n)){var r=n.source;return 1===r.length&&"^"!==r&&"$"!==r&&"."!==r?r:2!==r.length||"\\"!==r[0]||LZ(["d","D","s","S","t","r","n","t","0","c","b","B","f","v","w","W"],r[1])?t.useSticky?PJ(n):xJ(n):r[1]}if(AZ(n))return m=!0,{exec:n};if(_Z(n,"exec"))return m=!0,n;if("string"==typeof n){if(1===n.length)return n;var i=n.replace(/[\\^$.*+?()[\]{}|]/g,"\\$&"),o=new RegExp(i);return t.useSticky?PJ(o):xJ(o)}throw Error("non exhaustive match")}))})),r("misc mapping",(function(){o=CZ(n,(function(e){return e.tokenTypeIdx})),s=CZ(n,(function(e){var t=e.GROUP;if(t!==e0.SKIPPED){if(TZ(t))return t;if(NZ(t))return!1;throw Error("non exhaustive match")}})),a=CZ(n,(function(e){var t=e.LONGER_ALT;if(t)return function(e,t){for(var n=0;n<e.length;n++)if(e[n]===t)return n;return-1}(n,t)})),l=CZ(n,(function(e){return e.PUSH_MODE})),h=CZ(n,(function(e){return _Z(e,"POP_MODE")}))})),r("Line Terminator Handling",(function(){var e=DJ(t.lineTerminatorCharacters);u=CZ(n,(function(e){return!1})),"onlyOffset"!==t.positionTracking&&(u=CZ(n,(function(t){return _Z(t,"LINE_BREAKS")?t.LINE_BREAKS:!1===FJ(t,e)?SJ(e,t.PATTERN):void 0})))})),r("Misc Mapping #2",(function(){c=CZ(n,LJ),d=CZ(i,HJ),p=DZ(n,(function(e,t){var n=t.GROUP;return TZ(n)&&n!==e0.SKIPPED&&(e[n]=[]),e}),{}),g=CZ(i,(function(e,t){return{pattern:i[t],longerAlt:a[t],canLineTerminator:u[t],isCustom:c[t],short:d[t],group:s[t],push:l[t],pop:h[t],tokenTypeIdx:o[t],tokenType:n[t]}}))}));var f=!0,w=[];return t.safeMode||r("First Char Optimization",(function(){w=DZ(n,(function(e,n,r){if("string"==typeof n.PATTERN){var i=BJ(n.PATTERN.charCodeAt(0));VJ(e,i,g[r])}else if(BZ(n.START_CHARS_HINT)){var o;bZ(n.START_CHARS_HINT,(function(t){var n=BJ("string"==typeof t?t.charCodeAt(0):t);o!==n&&(o=n,VJ(e,n,g[r]))}))}else if(WZ(n.PATTERN))if(n.PATTERN.unicode)f=!1,t.ensureOptimizations&&eJ(gJ+"\tUnable to analyze < "+n.PATTERN.toString()+" > pattern.\n\tThe regexp unicode flag is not currently supported by the regexp-to-ast library.\n\tThis will disable the lexer's first char optimizations.\n\tFor details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#UNICODE_OPTIMIZE");else{var s=mJ(n.PATTERN,t.ensureOptimizations);wZ(s)&&(f=!1),bZ(s,(function(t){VJ(e,t,g[r])}))}else t.ensureOptimizations&&eJ(gJ+"\tTokenType: <"+n.name+"> is using a custom token pattern without providing <start_chars_hint> parameter.\n\tThis will disable the lexer's first char optimizations.\n\tFor details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#CUSTOM_OPTIMIZE"),f=!1;return e}),[])})),r("ArrayPacking",(function(){w=function(e){for(var t=[],n=0;n<e.length;n++){var r=e[n];t.push(void 0!==r?r:void 0)}return t}(w)})),{emptyGroups:p,patternIdxToConfig:g,charCodeToPatternIdxToConfig:w,hasCustom:m,canBeOptimized:f}}function MJ(e,t){var n=[],r=function(e){var t=OZ(e,(function(e){return!_Z(e,EJ)})),n=CZ(t,(function(e){return{message:"Token Type: ->"+e.name+"<- missing static 'PATTERN' property",type:ZJ.MISSING_PATTERN,tokenTypes:[e]}})),r=zZ(e,t);return{errors:n,valid:r}}(e);n=n.concat(r.errors);var i=function(e){var t=OZ(e,(function(e){var t=e[EJ];return!(WZ(t)||AZ(t)||_Z(t,"exec")||TZ(t))})),n=CZ(t,(function(e){return{message:"Token Type: ->"+e.name+"<- static 'PATTERN' can only be a RegExp, a Function matching the {CustomPatternMatcherFunc} type or an Object matching the {ICustomPattern} interface.",type:ZJ.INVALID_PATTERN,tokenTypes:[e]}})),r=zZ(e,t);return{errors:n,valid:r}}(r.valid),o=i.valid;return n=(n=n.concat(i.errors)).concat(function(e){var t=[],n=OZ(e,(function(e){return WZ(e[EJ])}));return t=t.concat(function(e){var t=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.found=!1,t}return RJ(t,e),t.prototype.visitEndAnchor=function(e){this.found=!0},t}(aJ.BaseRegExpVisitor),n=OZ(e,(function(e){var n=e[EJ];try{var r=uJ(n),i=new t;return i.visit(r),i.found}catch(o){return IJ.test(n.source)}})),r=CZ(n,(function(e){return{message:"Unexpected RegExp Anchor Error:\n\tToken Type: ->"+e.name+"<- static 'PATTERN' cannot contain end of input anchor '$'\n\tSee sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#ANCHORS\tfor details.",type:ZJ.EOI_ANCHOR_FOUND,tokenTypes:[e]}}));return r}(n)),t=t.concat(function(e){var t=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.found=!1,t}return RJ(t,e),t.prototype.visitStartAnchor=function(e){this.found=!0},t}(aJ.BaseRegExpVisitor),n=OZ(e,(function(e){var n=e[EJ];try{var r=uJ(n),i=new t;return i.visit(r),i.found}catch(o){return OJ.test(n.source)}})),r=CZ(n,(function(e){return{message:"Unexpected RegExp Anchor Error:\n\tToken Type: ->"+e.name+"<- static 'PATTERN' cannot contain start of input anchor '^'\n\tSee https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#ANCHORS\tfor details.",type:ZJ.SOI_ANCHOR_FOUND,tokenTypes:[e]}}));return r}(n)),t=t.concat(function(e){var t=OZ(e,(function(e){var t=e[EJ];return t instanceof RegExp&&(t.multiline||t.global)})),n=CZ(t,(function(e){return{message:"Token Type: ->"+e.name+"<- static 'PATTERN' may NOT contain global('g') or multiline('m')",type:ZJ.UNSUPPORTED_FLAGS_FOUND,tokenTypes:[e]}}));return n}(n)),t=t.concat(function(e){var t=[],n=CZ(e,(function(n){return DZ(e,(function(e,r){return n.PATTERN.source!==r.PATTERN.source||LZ(t,r)||r.PATTERN===e0.NA||(t.push(r),e.push(r)),e}),[])})),r=CZ(OZ(n=VZ(n),(function(e){return e.length>1})),(function(e){var t=CZ(e,(function(e){return e.name}));return{message:"The same RegExp pattern ->"+RZ(e).PATTERN+"<-has been used in all of the following Token Types: "+t.join(", ")+" <-",type:ZJ.DUPLICATE_PATTERNS_FOUND,tokenTypes:e}}));return r}(n)),t=t.concat(function(e){var t=OZ(e,(function(e){return e[EJ].test("")})),n=CZ(t,(function(e){return{message:"Token Type: ->"+e.name+"<- static 'PATTERN' must not match an empty string",type:ZJ.EMPTY_MATCH_PATTERN,tokenTypes:[e]}}));return n}(n)),t}(o)),n=n.concat(function(e){var t=OZ(e,(function(e){if(!_Z(e,"GROUP"))return!1;var t=e.GROUP;return t!==e0.SKIPPED&&t!==e0.NA&&!TZ(t)})),n=CZ(t,(function(e){return{message:"Token Type: ->"+e.name+"<- static 'GROUP' can only be Lexer.SKIPPED/Lexer.NA/A String",type:ZJ.INVALID_GROUP_TYPE_FOUND,tokenTypes:[e]}}));return n}(o)),n=n.concat(function(e,t){var n=OZ(e,(function(e){return void 0!==e.PUSH_MODE&&!LZ(t,e.PUSH_MODE)})),r=CZ(n,(function(e){return{message:"Token Type: ->"+e.name+"<- static 'PUSH_MODE' value cannot refer to a Lexer Mode ->"+e.PUSH_MODE+"<-which does not exist",type:ZJ.PUSH_MODE_DOES_NOT_EXIST,tokenTypes:[e]}}));return r}(o,t)),n=n.concat(function(e){var t=[],n=DZ(e,(function(e,t,n){var r,i=t.PATTERN;return i===e0.NA||(TZ(i)?e.push({str:i,idx:n,tokenType:t}):WZ(i)&&(r=i,void 0===FZ([".","\\","[","]","|","^","$","(",")","?","*","+","{"],(function(e){return-1!==r.source.indexOf(e)})))&&e.push({str:i.source,idx:n,tokenType:t})),e}),[]);return bZ(e,(function(e,r){bZ(n,(function(n){var i=n.str,o=n.idx,s=n.tokenType;if(r<o&&function(e,t){if(WZ(t)){var n=t.exec(e);return null!==n&&0===n.index}if(AZ(t))return t(e,0,[],{});if(_Z(t,"exec"))return t.exec(e,0,[],{});if("string"==typeof t)return t===e;throw Error("non exhaustive match")}(i,e.PATTERN)){var a="Token: ->"+s.name+"<- can never be matched.\nBecause it appears AFTER the Token Type ->"+e.name+"<-in the lexer's definition.\nSee https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#UNREACHABLE";t.push({message:a,type:ZJ.UNREACHABLE_PATTERN,tokenTypes:[e,s]})}}))})),t}(o)),n}var IJ=/[^\\][\$]/;var OJ=/[^\\[][\^]|^\^/;function xJ(e){var t=e.ignoreCase?"i":"";return new RegExp("^(?:"+e.source+")",t)}function PJ(e){var t=e.ignoreCase?"iy":"y";return new RegExp(""+e.source,t)}function _J(e,t,n){var r=[],i=!1,o=xZ(VZ(SZ(function(e,t){for(var n=[],r=yZ(e),i=0;i<r.length;i++){var o=r[i];n.push(t.call(null,e[o],o))}return n}(e.modes,(function(e){return e})))),(function(e){return e[EJ]===e0.NA})),s=DJ(n);return t&&bZ(o,(function(e){var t=FJ(e,s);if(!1!==t){var n=function(e,t){if(t.issue===ZJ.IDENTIFY_TERMINATOR)return"Warning: unable to identify line terminator usage in pattern.\n\tThe problem is in the <"+e.name+"> Token Type\n\t Root cause: "+t.errMsg+".\n\tFor details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#IDENTIFY_TERMINATOR";if(t.issue===ZJ.CUSTOM_LINE_BREAK)return"Warning: A Custom Token Pattern should specify the <line_breaks> option.\n\tThe problem is in the <"+e.name+"> Token Type\n\tFor details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#CUSTOM_LINE_BREAK";throw Error("non exhaustive match")}(e,t),o={message:n,type:t.issue,tokenType:e};r.push(o)}else _Z(e,"LINE_BREAKS")?!0===e.LINE_BREAKS&&(i=!0):SJ(s,e.PATTERN)&&(i=!0)})),t&&!i&&r.push({message:"Warning: No LINE_BREAKS Found.\n\tThis Lexer has been defined to track line and column information,\n\tBut none of the Token Types can be identified as matching a line terminator.\n\tSee https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#LINE_BREAKS \n\tfor details.",type:ZJ.NO_LINE_BREAKS_FLAGS}),r}function LJ(e){var t=e.PATTERN;if(WZ(t))return!1;if(AZ(t))return!0;if(_Z(t,"exec"))return!0;if(TZ(t))return!1;throw Error("non exhaustive match")}function HJ(e){return!(!TZ(e)||1!==e.length)&&e.charCodeAt(0)}var kJ={test:function(e){for(var t=e.length,n=this.lastIndex;n<t;n++){var r=e.charCodeAt(n);if(10===r)return this.lastIndex=n+1,!0;if(13===r)return 10===e.charCodeAt(n+1)?this.lastIndex=n+2:this.lastIndex=n+1,!0}return!1},lastIndex:0};function FJ(e,t){if(_Z(e,"LINE_BREAKS"))return!1;if(WZ(e.PATTERN)){try{SJ(t,e.PATTERN)}catch(n){return{issue:ZJ.IDENTIFY_TERMINATOR,errMsg:n.message}}return!1}if(TZ(e.PATTERN))return!1;if(LJ(e))return{issue:ZJ.CUSTOM_LINE_BREAK};throw Error("non exhaustive match")}function DJ(e){return CZ(e,(function(e){return TZ(e)&&e.length>0?e.charCodeAt(0):e}))}function VJ(e,t,n){void 0===e[t]?e[t]=[n]:e[t].push(n)}var UJ=256;function BJ(e){return e<UJ?e:WJ[e]}var WJ=[];function jJ(e,t){var n=e.tokenTypeIdx;return n===t.tokenTypeIdx||!0===t.isParent&&!0===t.categoryMatchesMap[n]}function GJ(e,t){return e.tokenTypeIdx===t.tokenTypeIdx}var zJ=1,$J={};function YJ(e){var t=function(e){var t=HZ(e),n=e,r=!0;for(;r;){var i=zZ(n=VZ(SZ(CZ(n,(function(e){return e.CATEGORIES})))),t);t=t.concat(i),wZ(i)?r=!1:n=i}return t}(e);!function(e){bZ(e,(function(e){XJ(e)||($J[zJ]=e,e.tokenTypeIdx=zJ++),qJ(e)&&!BZ(e.CATEGORIES)&&(e.CATEGORIES=[e.CATEGORIES]),qJ(e)||(e.CATEGORIES=[]),_Z(e,"categoryMatches")||(e.categoryMatches=[]),function(e){return _Z(e,"categoryMatchesMap")}(e)||(e.categoryMatchesMap={})}))}(t),function(e){bZ(e,(function(e){KJ([],e)}))}(t),function(e){bZ(e,(function(e){e.categoryMatches=[],bZ(e.categoryMatchesMap,(function(t,n){e.categoryMatches.push($J[n].tokenTypeIdx)}))}))}(t),bZ(t,(function(e){e.isParent=e.categoryMatches.length>0}))}function KJ(e,t){bZ(e,(function(e){t.categoryMatchesMap[e.tokenTypeIdx]=!0})),bZ(t.CATEGORIES,(function(n){var r=e.concat(t);LZ(r,n)||KJ(r,n)}))}function XJ(e){return _Z(e,"tokenTypeIdx")}function qJ(e){return _Z(e,"CATEGORIES")}function QJ(e){return _Z(e,"tokenTypeIdx")}var ZJ;!function(e){e[e.MISSING_PATTERN=0]="MISSING_PATTERN",e[e.INVALID_PATTERN=1]="INVALID_PATTERN",e[e.EOI_ANCHOR_FOUND=2]="EOI_ANCHOR_FOUND",e[e.UNSUPPORTED_FLAGS_FOUND=3]="UNSUPPORTED_FLAGS_FOUND",e[e.DUPLICATE_PATTERNS_FOUND=4]="DUPLICATE_PATTERNS_FOUND",e[e.INVALID_GROUP_TYPE_FOUND=5]="INVALID_GROUP_TYPE_FOUND",e[e.PUSH_MODE_DOES_NOT_EXIST=6]="PUSH_MODE_DOES_NOT_EXIST",e[e.MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE=7]="MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE",e[e.MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY=8]="MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY",e[e.MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST=9]="MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST",e[e.LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED=10]="LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED",e[e.SOI_ANCHOR_FOUND=11]="SOI_ANCHOR_FOUND",e[e.EMPTY_MATCH_PATTERN=12]="EMPTY_MATCH_PATTERN",e[e.NO_LINE_BREAKS_FLAGS=13]="NO_LINE_BREAKS_FLAGS",e[e.UNREACHABLE_PATTERN=14]="UNREACHABLE_PATTERN",e[e.IDENTIFY_TERMINATOR=15]="IDENTIFY_TERMINATOR",e[e.CUSTOM_LINE_BREAK=16]="CUSTOM_LINE_BREAK"}(ZJ||(ZJ={}));var JJ={deferDefinitionErrorsHandling:!1,positionTracking:"full",lineTerminatorsPattern:/\n|\r\n?/g,lineTerminatorCharacters:["\n","\r"],ensureOptimizations:!1,safeMode:!1,errorMessageProvider:{buildUnableToPopLexerModeMessage:function(e){return"Unable to pop Lexer Mode after encountering Token ->"+e.image+"<- The Mode Stack is empty"},buildUnexpectedCharactersMessage:function(e,t,n,r,i){return"unexpected character: ->"+e.charAt(t)+"<- at offset: "+t+", skipped "+n+" characters."}},traceInitPerf:!1,skipValidations:!1};Object.freeze(JJ);var e0=function(){function e(e,t){var n=this;if(void 0===t&&(t=JJ),this.lexerDefinition=e,this.lexerDefinitionErrors=[],this.lexerDefinitionWarning=[],this.patternIdxToConfig={},this.charCodeToPatternIdxToConfig={},this.modes=[],this.emptyGroups={},this.config=void 0,this.trackStartLines=!0,this.trackEndLines=!0,this.hasCustom=!1,this.canModeBeOptimized={},"boolean"==typeof t)throw Error("The second argument to the Lexer constructor is now an ILexerConfig Object.\na boolean 2nd argument is no longer supported");this.config=QZ(JJ,t);var r=this.config.traceInitPerf;!0===r?(this.traceInitMaxIdent=1/0,this.traceInitPerf=!0):"number"==typeof r&&(this.traceInitMaxIdent=r,this.traceInitPerf=!0),this.traceInitIndent=-1,this.TRACE_INIT("Lexer Constructor",(function(){var r,i=!0;n.TRACE_INIT("Lexer Config handling",(function(){if(n.config.lineTerminatorsPattern===JJ.lineTerminatorsPattern)n.config.lineTerminatorsPattern=kJ;else if(n.config.lineTerminatorCharacters===JJ.lineTerminatorCharacters)throw Error("Error: Missing <lineTerminatorCharacters> property on the Lexer config.\n\tFor details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#MISSING_LINE_TERM_CHARS");if(t.safeMode&&t.ensureOptimizations)throw Error('"safeMode" and "ensureOptimizations" flags are mutually exclusive.');n.trackStartLines=/full|onlyStart/i.test(n.config.positionTracking),n.trackEndLines=/full/i.test(n.config.positionTracking),BZ(e)?((r={modes:{}}).modes[bJ]=HZ(e),r[bJ]=bJ):(i=!1,r=kZ(e))})),!1===n.config.skipValidations&&(n.TRACE_INIT("performRuntimeChecks",(function(){n.lexerDefinitionErrors=n.lexerDefinitionErrors.concat(function(e,t,n){var r=[];return _Z(e,bJ)||r.push({message:"A MultiMode Lexer cannot be initialized without a <"+bJ+"> property in its definition\n",type:ZJ.MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE}),_Z(e,TJ)||r.push({message:"A MultiMode Lexer cannot be initialized without a <modes> property in its definition\n",type:ZJ.MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY}),_Z(e,TJ)&&_Z(e,bJ)&&!_Z(e.modes,e.defaultMode)&&r.push({message:"A MultiMode Lexer cannot be initialized with a "+bJ+": <"+e.defaultMode+">which does not exist\n",type:ZJ.MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST}),_Z(e,TJ)&&bZ(e.modes,(function(e,t){bZ(e,(function(e,n){NZ(e)&&r.push({message:"A Lexer cannot be initialized using an undefined Token Type. Mode:<"+t+"> at index: <"+n+">\n",type:ZJ.LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED})}))})),r}(r,n.trackStartLines,n.config.lineTerminatorCharacters))})),n.TRACE_INIT("performWarningRuntimeChecks",(function(){n.lexerDefinitionWarning=n.lexerDefinitionWarning.concat(_J(r,n.trackStartLines,n.config.lineTerminatorCharacters))}))),r.modes=r.modes?r.modes:{},bZ(r.modes,(function(e,t){r.modes[t]=xZ(e,(function(e){return NZ(e)}))}));var o=yZ(r.modes);if(bZ(r.modes,(function(e,r){n.TRACE_INIT("Mode: <"+r+"> processing",(function(){var i;(n.modes.push(r),!1===n.config.skipValidations&&n.TRACE_INIT("validatePatterns",(function(){n.lexerDefinitionErrors=n.lexerDefinitionErrors.concat(MJ(e,o))})),wZ(n.lexerDefinitionErrors))&&(YJ(e),n.TRACE_INIT("analyzeTokenTypes",(function(){i=AJ(e,{lineTerminatorCharacters:n.config.lineTerminatorCharacters,positionTracking:t.positionTracking,ensureOptimizations:t.ensureOptimizations,safeMode:t.safeMode,tracer:n.TRACE_INIT.bind(n)})})),n.patternIdxToConfig[r]=i.patternIdxToConfig,n.charCodeToPatternIdxToConfig[r]=i.charCodeToPatternIdxToConfig,n.emptyGroups=QZ(n.emptyGroups,i.emptyGroups),n.hasCustom=i.hasCustom||n.hasCustom,n.canModeBeOptimized[r]=i.canBeOptimized)}))})),n.defaultMode=r.defaultMode,!wZ(n.lexerDefinitionErrors)&&!n.config.deferDefinitionErrorsHandling){var s=CZ(n.lexerDefinitionErrors,(function(e){return e.message})),a=s.join("-----------------------\n");throw new Error("Errors detected in definition of Lexer:\n"+a)}bZ(n.lexerDefinitionWarning,(function(e){tJ(e.message)})),n.TRACE_INIT("Choosing sub-methods implementations",(function(){if(NJ?(n.chopInput=JZ,n.match=n.matchWithTest):(n.updateLastIndex=ZZ,n.match=n.matchWithExec),i&&(n.handleModes=ZZ),!1===n.trackStartLines&&(n.computeNewColumn=JZ),!1===n.trackEndLines&&(n.updateTokenEndLineColumnLocation=ZZ),/full/i.test(n.config.positionTracking))n.createTokenInstance=n.createFullToken;else if(/onlyStart/i.test(n.config.positionTracking))n.createTokenInstance=n.createStartOnlyToken;else{if(!/onlyOffset/i.test(n.config.positionTracking))throw Error('Invalid <positionTracking> config option: "'+n.config.positionTracking+'"');n.createTokenInstance=n.createOffsetOnlyToken}n.hasCustom?(n.addToken=n.addTokenUsingPush,n.handlePayload=n.handlePayloadWithCustom):(n.addToken=n.addTokenUsingMemberAccess,n.handlePayload=n.handlePayloadNoCustom)})),n.TRACE_INIT("Failed Optimization Warnings",(function(){var e=DZ(n.canModeBeOptimized,(function(e,t,n){return!1===t&&e.push(n),e}),[]);if(t.ensureOptimizations&&!wZ(e))throw Error("Lexer Modes: < "+e.join(", ")+' > cannot be optimized.\n\t Disable the "ensureOptimizations" lexer config flag to silently ignore this and run the lexer in an un-optimized mode.\n\t Or inspect the console log for details on how to resolve these issues.')})),n.TRACE_INIT("clearRegExpParserCache",(function(){lJ={}})),n.TRACE_INIT("toFastProperties",(function(){rJ(n)}))}))}return e.prototype.tokenize=function(e,t){if(void 0===t&&(t=this.defaultMode),!wZ(this.lexerDefinitionErrors)){var n=CZ(this.lexerDefinitionErrors,(function(e){return e.message})),r=n.join("-----------------------\n");throw new Error("Unable to Tokenize because Errors detected in definition of Lexer:\n"+r)}return this.tokenizeInternal(e,t)},e.prototype.tokenizeInternal=function(e,t){var n,r,i,o,s,a,l,h,u,c,d,p,g,m,f,w,y=this,v=e,C=v.length,S=0,R=0,E=this.hasCustom?0:Math.floor(e.length/10),b=new Array(E),T=[],N=this.trackStartLines?1:void 0,A=this.trackStartLines?1:void 0,M=(f=this.emptyGroups,w={},bZ(yZ(f),(function(e){if(!BZ(f[e]))throw Error("non exhaustive match");w[e]=[]})),w),I=this.trackStartLines,O=this.config.lineTerminatorsPattern,x=0,P=[],_=[],L=[],H=[];Object.freeze(H);var k=void 0;function F(){return P}function D(e){var t=BJ(e),n=_[t];return void 0===n?H:n}var V,U=function(e){if(1===L.length&&void 0===e.tokenType.PUSH_MODE){var t=y.config.errorMessageProvider.buildUnableToPopLexerModeMessage(e);T.push({offset:e.startOffset,line:void 0!==e.startLine?e.startLine:void 0,column:void 0!==e.startColumn?e.startColumn:void 0,length:e.image.length,message:t})}else{L.pop();var n=EZ(L);P=y.patternIdxToConfig[n],_=y.charCodeToPatternIdxToConfig[n],x=P.length;var r=y.canModeBeOptimized[n]&&!1===y.config.safeMode;k=_&&r?D:F}};function B(e){L.push(e),_=this.charCodeToPatternIdxToConfig[e],P=this.patternIdxToConfig[e],x=P.length,x=P.length;var t=this.canModeBeOptimized[e]&&!1===this.config.safeMode;k=_&&t?D:F}for(B.call(this,t);S<C;){s=null;var W=v.charCodeAt(S),j=k(W),G=j.length;for(n=0;n<G;n++){var z=(V=j[n]).pattern;if(a=null,!1!==(te=V.short)?W===te&&(s=z):!0===V.isCustom?null!==(m=z.exec(v,S,b,M))?(s=m[0],void 0!==m.payload&&(a=m.payload)):s=null:(this.updateLastIndex(z,S),s=this.match(z,e,S)),null!==s){if(void 0!==(o=V.longerAlt)){var $=P[o],Y=$.pattern;l=null,!0===$.isCustom?null!==(m=Y.exec(v,S,b,M))?(i=m[0],void 0!==m.payload&&(l=m.payload)):i=null:(this.updateLastIndex(Y,S),i=this.match(Y,e,S)),i&&i.length>s.length&&(s=i,a=l,V=$)}break}}if(null!==s){if(h=s.length,void 0!==(u=V.group)&&(c=V.tokenTypeIdx,d=this.createTokenInstance(s,S,c,V.tokenType,N,A,h),this.handlePayload(d,a),!1===u?R=this.addToken(b,R,d):M[u].push(d)),e=this.chopInput(e,h),S+=h,A=this.computeNewColumn(A,h),!0===I&&!0===V.canLineTerminator){var K=0,X=void 0,q=void 0;O.lastIndex=0;do{!0===(X=O.test(s))&&(q=O.lastIndex-1,K++)}while(!0===X);0!==K&&(N+=K,A=h-q,this.updateTokenEndLineColumnLocation(d,u,q,K,N,A,h))}this.handleModes(V,U,B,d)}else{for(var Q=S,Z=N,J=A,ee=!1;!ee&&S<C;)for(v.charCodeAt(S),e=this.chopInput(e,1),S++,r=0;r<x;r++){var te,ne=P[r];z=ne.pattern;if(!1!==(te=ne.short)?v.charCodeAt(S)===te&&(ee=!0):!0===ne.isCustom?ee=null!==z.exec(v,S,b,M):(this.updateLastIndex(z,S),ee=null!==z.exec(e)),!0===ee)break}p=S-Q,g=this.config.errorMessageProvider.buildUnexpectedCharactersMessage(v,Q,p,Z,J),T.push({offset:Q,line:Z,column:J,length:p,message:g})}}return this.hasCustom||(b.length=R),{tokens:b,groups:M,errors:T}},e.prototype.handleModes=function(e,t,n,r){if(!0===e.pop){var i=e.push;t(r),void 0!==i&&n.call(this,i)}else void 0!==e.push&&n.call(this,e.push)},e.prototype.chopInput=function(e,t){return e.substring(t)},e.prototype.updateLastIndex=function(e,t){e.lastIndex=t},e.prototype.updateTokenEndLineColumnLocation=function(e,t,n,r,i,o,s){var a,l;void 0!==t&&(l=(a=n===s-1)?-1:0,1===r&&!0===a||(e.endLine=i+l,e.endColumn=o-1-l))},e.prototype.computeNewColumn=function(e,t){return e+t},e.prototype.createTokenInstance=function(){return null},e.prototype.createOffsetOnlyToken=function(e,t,n,r){return{image:e,startOffset:t,tokenTypeIdx:n,tokenType:r}},e.prototype.createStartOnlyToken=function(e,t,n,r,i,o){return{image:e,startOffset:t,startLine:i,startColumn:o,tokenTypeIdx:n,tokenType:r}},e.prototype.createFullToken=function(e,t,n,r,i,o,s){return{image:e,startOffset:t,endOffset:t+s-1,startLine:i,endLine:i,startColumn:o,endColumn:o+s-1,tokenTypeIdx:n,tokenType:r}},e.prototype.addToken=function(e,t,n){return 666},e.prototype.addTokenUsingPush=function(e,t,n){return e.push(n),t},e.prototype.addTokenUsingMemberAccess=function(e,t,n){return e[t]=n,++t},e.prototype.handlePayload=function(e,t){},e.prototype.handlePayloadNoCustom=function(e,t){},e.prototype.handlePayloadWithCustom=function(e,t){null!==t&&(e.payload=t)},e.prototype.match=function(e,t,n){return null},e.prototype.matchWithTest=function(e,t,n){return!0===e.test(t)?t.substring(n,e.lastIndex):null},e.prototype.matchWithExec=function(e,t){var n=e.exec(t);return null!==n?n[0]:n},e.prototype.TRACE_INIT=function(e,t){if(!0===this.traceInitPerf){this.traceInitIndent++;var n=new Array(this.traceInitIndent+1).join("\t");this.traceInitIndent<this.traceInitMaxIdent&&console.log(n+"--\x3e <"+e+">");var r=oJ(t),i=r.time,o=r.value,s=i>10?console.warn:console.log;return this.traceInitIndent<this.traceInitMaxIdent&&s(n+"<-- <"+e+"> time: "+i+"ms"),this.traceInitIndent--,o}return t()},e.SKIPPED="This marks a skipped Token pattern, this means each token identified by it willbe consumed and then thrown into oblivion, this can be used to for example to completely ignore whitespace.",e.NA=/NOT_APPLICABLE/,e}();function t0(e){return n0(e)?e.LABEL:e.name}function n0(e){return TZ(e.LABEL)&&""!==e.LABEL}var r0="parent",i0="categories",o0="label",s0="group",a0="push_mode",l0="pop_mode",h0="longer_alt",u0="line_breaks",c0="start_chars_hint";function d0(e){return function(e){var t=e.pattern,n={};n.name=e.name,NZ(t)||(n.PATTERN=t);if(_Z(e,r0))throw"The parent property is no longer supported.\nSee: https://github.com/SAP/chevrotain/issues/564#issuecomment-349062346 for details.";_Z(e,i0)&&(n.CATEGORIES=e[i0]);YJ([n]),_Z(e,o0)&&(n.LABEL=e[o0]);_Z(e,s0)&&(n.GROUP=e[s0]);_Z(e,l0)&&(n.POP_MODE=e[l0]);_Z(e,a0)&&(n.PUSH_MODE=e[a0]);_Z(e,h0)&&(n.LONGER_ALT=e[h0]);_Z(e,u0)&&(n.LINE_BREAKS=e[u0]);_Z(e,c0)&&(n.START_CHARS_HINT=e[c0]);return n}(e)}var p0=d0({name:"EOF",pattern:e0.NA});function g0(e,t,n,r,i,o,s,a){return{image:t,startOffset:n,endOffset:r,startLine:i,endLine:o,startColumn:s,endColumn:a,tokenTypeIdx:e.tokenTypeIdx,tokenType:e}}function m0(e,t){return jJ(e,t)}YJ([p0]);var f0=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),w0=function(){function e(e){this.definition=e}return e.prototype.accept=function(e){e.visit(this),bZ(this.definition,(function(t){t.accept(e)}))},e}(),y0=function(e){function t(t){var n=e.call(this,[])||this;return n.idx=1,YZ(n,PZ(t,(function(e){return void 0!==e}))),n}return f0(t,e),Object.defineProperty(t.prototype,"definition",{get:function(){return void 0!==this.referencedRule?this.referencedRule.definition:[]},set:function(e){},enumerable:!0,configurable:!0}),t.prototype.accept=function(e){e.visit(this)},t}(w0),v0=function(e){function t(t){var n=e.call(this,t.definition)||this;return n.orgText="",YZ(n,PZ(t,(function(e){return void 0!==e}))),n}return f0(t,e),t}(w0),C0=function(e){function t(t){var n=e.call(this,t.definition)||this;return n.ignoreAmbiguities=!1,YZ(n,PZ(t,(function(e){return void 0!==e}))),n}return f0(t,e),t}(w0),S0=function(e){function t(t){var n=e.call(this,t.definition)||this;return n.idx=1,YZ(n,PZ(t,(function(e){return void 0!==e}))),n}return f0(t,e),t}(w0),R0=function(e){function t(t){var n=e.call(this,t.definition)||this;return n.idx=1,YZ(n,PZ(t,(function(e){return void 0!==e}))),n}return f0(t,e),t}(w0),E0=function(e){function t(t){var n=e.call(this,t.definition)||this;return n.idx=1,YZ(n,PZ(t,(function(e){return void 0!==e}))),n}return f0(t,e),t}(w0),b0=function(e){function t(t){var n=e.call(this,t.definition)||this;return n.idx=1,YZ(n,PZ(t,(function(e){return void 0!==e}))),n}return f0(t,e),t}(w0),T0=function(e){function t(t){var n=e.call(this,t.definition)||this;return n.idx=1,YZ(n,PZ(t,(function(e){return void 0!==e}))),n}return f0(t,e),t}(w0),N0=function(e){function t(t){var n=e.call(this,t.definition)||this;return n.idx=1,n.ignoreAmbiguities=!1,n.hasPredicates=!1,YZ(n,PZ(t,(function(e){return void 0!==e}))),n}return f0(t,e),t}(w0),A0=function(){function e(e){this.idx=1,YZ(this,PZ(e,(function(e){return void 0!==e})))}return e.prototype.accept=function(e){e.visit(this)},e}();function M0(e){function t(e){return CZ(e,M0)}if(e instanceof y0)return{type:"NonTerminal",name:e.nonTerminalName,idx:e.idx};if(e instanceof C0)return{type:"Flat",definition:t(e.definition)};if(e instanceof S0)return{type:"Option",idx:e.idx,definition:t(e.definition)};if(e instanceof R0)return{type:"RepetitionMandatory",name:e.name,idx:e.idx,definition:t(e.definition)};if(e instanceof E0)return{type:"RepetitionMandatoryWithSeparator",name:e.name,idx:e.idx,separator:M0(new A0({terminalType:e.separator})),definition:t(e.definition)};if(e instanceof T0)return{type:"RepetitionWithSeparator",name:e.name,idx:e.idx,separator:M0(new A0({terminalType:e.separator})),definition:t(e.definition)};if(e instanceof b0)return{type:"Repetition",name:e.name,idx:e.idx,definition:t(e.definition)};if(e instanceof N0)return{type:"Alternation",name:e.name,idx:e.idx,definition:t(e.definition)};if(e instanceof A0){var n={type:"Terminal",name:e.terminalType.name,label:t0(e.terminalType),idx:e.idx},r=e.terminalType.PATTERN;return e.terminalType.PATTERN&&(n.pattern=WZ(r)?r.source:r),n}if(e instanceof v0)return{type:"Rule",name:e.name,orgText:e.orgText,definition:t(e.definition)};throw Error("non exhaustive match")}var I0=function(){function e(){}return e.prototype.walk=function(e,t){var n=this;void 0===t&&(t=[]),bZ(e.definition,(function(r,i){var o=MZ(e.definition,i+1);if(r instanceof y0)n.walkProdRef(r,o,t);else if(r instanceof A0)n.walkTerminal(r,o,t);else if(r instanceof C0)n.walkFlat(r,o,t);else if(r instanceof S0)n.walkOption(r,o,t);else if(r instanceof R0)n.walkAtLeastOne(r,o,t);else if(r instanceof E0)n.walkAtLeastOneSep(r,o,t);else if(r instanceof T0)n.walkManySep(r,o,t);else if(r instanceof b0)n.walkMany(r,o,t);else{if(!(r instanceof N0))throw Error("non exhaustive match");n.walkOr(r,o,t)}}))},e.prototype.walkTerminal=function(e,t,n){},e.prototype.walkProdRef=function(e,t,n){},e.prototype.walkFlat=function(e,t,n){var r=t.concat(n);this.walk(e,r)},e.prototype.walkOption=function(e,t,n){var r=t.concat(n);this.walk(e,r)},e.prototype.walkAtLeastOne=function(e,t,n){var r=[new S0({definition:e.definition})].concat(t,n);this.walk(e,r)},e.prototype.walkAtLeastOneSep=function(e,t,n){var r=O0(e,t,n);this.walk(e,r)},e.prototype.walkMany=function(e,t,n){var r=[new S0({definition:e.definition})].concat(t,n);this.walk(e,r)},e.prototype.walkManySep=function(e,t,n){var r=O0(e,t,n);this.walk(e,r)},e.prototype.walkOr=function(e,t,n){var r=this,i=t.concat(n);bZ(e.definition,(function(e){var t=new C0({definition:[e]});r.walk(t,i)}))},e}();function O0(e,t,n){return[new S0({definition:[new A0({terminalType:e.separator})].concat(e.definition)})].concat(t,n)}var x0=function(){function e(){}return e.prototype.visit=function(e){var t=e;switch(t.constructor){case y0:return this.visitNonTerminal(t);case C0:return this.visitFlat(t);case S0:return this.visitOption(t);case R0:return this.visitRepetitionMandatory(t);case E0:return this.visitRepetitionMandatoryWithSeparator(t);case T0:return this.visitRepetitionWithSeparator(t);case b0:return this.visitRepetition(t);case N0:return this.visitAlternation(t);case A0:return this.visitTerminal(t);case v0:return this.visitRule(t);default:throw Error("non exhaustive match")}},e.prototype.visitNonTerminal=function(e){},e.prototype.visitFlat=function(e){},e.prototype.visitOption=function(e){},e.prototype.visitRepetition=function(e){},e.prototype.visitRepetitionMandatory=function(e){},e.prototype.visitRepetitionMandatoryWithSeparator=function(e){},e.prototype.visitRepetitionWithSeparator=function(e){},e.prototype.visitAlternation=function(e){},e.prototype.visitTerminal=function(e){},e.prototype.visitRule=function(e){},e}(),P0=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();function _0(e,t){return void 0===t&&(t=[]),!!(e instanceof S0||e instanceof b0||e instanceof T0)||(e instanceof N0?$Z(e.definition,(function(e){return _0(e,t)})):!(e instanceof y0&&LZ(t,e))&&(e instanceof w0&&(e instanceof y0&&t.push(e),GZ(e.definition,(function(e){return _0(e,t)})))))}function L0(e){if(e instanceof y0)return"SUBRULE";if(e instanceof S0)return"OPTION";if(e instanceof N0)return"OR";if(e instanceof R0)return"AT_LEAST_ONE";if(e instanceof E0)return"AT_LEAST_ONE_SEP";if(e instanceof T0)return"MANY_SEP";if(e instanceof b0)return"MANY";if(e instanceof A0)return"CONSUME";throw Error("non exhaustive match")}var H0=new(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.separator="-",t.dslMethods={option:[],alternation:[],repetition:[],repetitionWithSeparator:[],repetitionMandatory:[],repetitionMandatoryWithSeparator:[]},t}return P0(t,e),t.prototype.reset=function(){this.dslMethods={option:[],alternation:[],repetition:[],repetitionWithSeparator:[],repetitionMandatory:[],repetitionMandatoryWithSeparator:[]}},t.prototype.visitTerminal=function(e){var t=e.terminalType.name+this.separator+"Terminal";_Z(this.dslMethods,t)||(this.dslMethods[t]=[]),this.dslMethods[t].push(e)},t.prototype.visitNonTerminal=function(e){var t=e.nonTerminalName+this.separator+"Terminal";_Z(this.dslMethods,t)||(this.dslMethods[t]=[]),this.dslMethods[t].push(e)},t.prototype.visitOption=function(e){this.dslMethods.option.push(e)},t.prototype.visitRepetitionWithSeparator=function(e){this.dslMethods.repetitionWithSeparator.push(e)},t.prototype.visitRepetitionMandatory=function(e){this.dslMethods.repetitionMandatory.push(e)},t.prototype.visitRepetitionMandatoryWithSeparator=function(e){this.dslMethods.repetitionMandatoryWithSeparator.push(e)},t.prototype.visitRepetition=function(e){this.dslMethods.repetition.push(e)},t.prototype.visitAlternation=function(e){this.dslMethods.alternation.push(e)},t}(x0));function k0(e){if(e instanceof y0)return k0(e.referencedRule);if(e instanceof A0)return[e.terminalType];if(function(e){return e instanceof C0||e instanceof S0||e instanceof b0||e instanceof R0||e instanceof E0||e instanceof T0||e instanceof A0||e instanceof v0}(e))return function(e){var t,n=[],r=e.definition,i=0,o=r.length>i,s=!0;for(;o&&s;)s=_0(t=r[i]),n=n.concat(k0(t)),i+=1,o=r.length>i;return UZ(n)}(e);if(function(e){return e instanceof N0}(e))return function(e){var t=CZ(e.definition,(function(e){return k0(e)}));return UZ(SZ(t))}(e);throw Error("non exhaustive match")}var F0="_~IN~_",D0=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),V0=function(e){function t(t){var n=e.call(this)||this;return n.topProd=t,n.follows={},n}return D0(t,e),t.prototype.startWalking=function(){return this.walk(this.topProd),this.follows},t.prototype.walkTerminal=function(e,t,n){},t.prototype.walkProdRef=function(e,t,n){var r,i,o=(r=e.referencedRule,i=e.idx,r.name+i+F0+this.topProd.name),s=t.concat(n),a=k0(new C0({definition:s}));this.follows[o]=a},t}(I0);var U0=256,B0=512,W0=768,j0=1024,G0=1280,z0=1536;function $0(e,t,n){return n|t|e}function Y0(e,t,n,r){var i=r+1<<24;return $0(e,t,n)|i}var K0=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();function X0(e,t){!0===isNaN(e.startOffset)?(e.startOffset=t.startOffset,e.endOffset=t.endOffset):e.endOffset<t.endOffset==!0&&(e.endOffset=t.endOffset)}function q0(e,t){!0===isNaN(e.startOffset)?(e.startOffset=t.startOffset,e.startColumn=t.startColumn,e.startLine=t.startLine,e.endOffset=t.endOffset,e.endColumn=t.endColumn,e.endLine=t.endLine):e.endOffset<t.endOffset==!0&&(e.endOffset=t.endOffset,e.endColumn=t.endColumn,e.endLine=t.endLine)}function Q0(e,t,n){void 0===e.children[t]?e.children[t]=[n]:e.children[t].push(n)}var Z0=function(e){function t(t){var n=e.call(this)||this;return n.result=[],n.ruleIdx=t,n}return K0(t,e),t.prototype.collectNamedDSLMethod=function(e,t,n){if(!NZ(e.name)){var r=void 0;if(e instanceof S0||e instanceof b0||e instanceof R0||e instanceof N0)r=new t({definition:e.definition,idx:e.idx});else{if(!(e instanceof E0||e instanceof T0))throw Error("non exhaustive match");r=new t({definition:e.definition,idx:e.idx,separator:e.separator})}var i=[r],o=$0(this.ruleIdx,n,e.idx);this.result.push({def:i,key:o,name:e.name,orgProd:e})}},t.prototype.visitOption=function(e){this.collectNamedDSLMethod(e,S0,B0)},t.prototype.visitRepetition=function(e){this.collectNamedDSLMethod(e,b0,W0)},t.prototype.visitRepetitionMandatory=function(e){this.collectNamedDSLMethod(e,R0,j0)},t.prototype.visitRepetitionMandatoryWithSeparator=function(e){this.collectNamedDSLMethod(e,E0,z0)},t.prototype.visitRepetitionWithSeparator=function(e){this.collectNamedDSLMethod(e,T0,G0)},t.prototype.visitAlternation=function(e){var t=this;this.collectNamedDSLMethod(e,N0,U0);var n=e.definition.length>1;bZ(e.definition,(function(r,i){if(!NZ(r.name)){var o=r.definition;o=n?[new S0({definition:r.definition})]:r.definition;var s=Y0(t.ruleIdx,U0,e.idx,i);t.result.push({def:o,key:s,name:r.name,orgProd:r})}}))},t}(x0);var J0=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),e1=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.path=n,r.nextTerminalName="",r.nextTerminalOccurrence=0,r.nextTerminalName=r.path.lastTok.name,r.nextTerminalOccurrence=r.path.lastTokOccurrence,r}return J0(t,e),t.prototype.walkTerminal=function(e,t,n){if(this.isAtEndOfPath&&e.terminalType.name===this.nextTerminalName&&e.idx===this.nextTerminalOccurrence&&!this.found){var r=t.concat(n),i=new C0({definition:r});this.possibleTokTypes=k0(i),this.found=!0}},t}(function(e){function t(t,n){var r=e.call(this)||this;return r.topProd=t,r.path=n,r.possibleTokTypes=[],r.nextProductionName="",r.nextProductionOccurrence=0,r.found=!1,r.isAtEndOfPath=!1,r}return J0(t,e),t.prototype.startWalking=function(){if(this.found=!1,this.path.ruleStack[0]!==this.topProd.name)throw Error("The path does not start with the walker's top Rule!");return this.ruleStack=HZ(this.path.ruleStack).reverse(),this.occurrenceStack=HZ(this.path.occurrenceStack).reverse(),this.ruleStack.pop(),this.occurrenceStack.pop(),this.updateExpectedNext(),this.walk(this.topProd),this.possibleTokTypes},t.prototype.walk=function(t,n){void 0===n&&(n=[]),this.found||e.prototype.walk.call(this,t,n)},t.prototype.walkProdRef=function(e,t,n){if(e.referencedRule.name===this.nextProductionName&&e.idx===this.nextProductionOccurrence){var r=t.concat(n);this.updateExpectedNext(),this.walk(e.referencedRule,r)}},t.prototype.updateExpectedNext=function(){wZ(this.ruleStack)?(this.nextProductionName="",this.nextProductionOccurrence=0,this.isAtEndOfPath=!0):(this.nextProductionName=this.ruleStack.pop(),this.nextProductionOccurrence=this.occurrenceStack.pop())},t}(I0)),t1=function(e){function t(t,n){var r=e.call(this)||this;return r.topRule=t,r.occurrence=n,r.result={token:void 0,occurrence:void 0,isEndOfRule:void 0},r}return J0(t,e),t.prototype.startWalking=function(){return this.walk(this.topRule),this.result},t}(I0),n1=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return J0(t,e),t.prototype.walkMany=function(t,n,r){if(t.idx===this.occurrence){var i=RZ(n.concat(r));this.result.isEndOfRule=void 0===i,i instanceof A0&&(this.result.token=i.terminalType,this.result.occurrence=i.idx)}else e.prototype.walkMany.call(this,t,n,r)},t}(t1),r1=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return J0(t,e),t.prototype.walkManySep=function(t,n,r){if(t.idx===this.occurrence){var i=RZ(n.concat(r));this.result.isEndOfRule=void 0===i,i instanceof A0&&(this.result.token=i.terminalType,this.result.occurrence=i.idx)}else e.prototype.walkManySep.call(this,t,n,r)},t}(t1),i1=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return J0(t,e),t.prototype.walkAtLeastOne=function(t,n,r){if(t.idx===this.occurrence){var i=RZ(n.concat(r));this.result.isEndOfRule=void 0===i,i instanceof A0&&(this.result.token=i.terminalType,this.result.occurrence=i.idx)}else e.prototype.walkAtLeastOne.call(this,t,n,r)},t}(t1),o1=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return J0(t,e),t.prototype.walkAtLeastOneSep=function(t,n,r){if(t.idx===this.occurrence){var i=RZ(n.concat(r));this.result.isEndOfRule=void 0===i,i instanceof A0&&(this.result.token=i.terminalType,this.result.occurrence=i.idx)}else e.prototype.walkAtLeastOneSep.call(this,t,n,r)},t}(t1);function s1(e,t,n){void 0===n&&(n=[]),n=HZ(n);var r=[],i=0;function o(o){var s=s1(o.concat(MZ(e,i+1)),t,n);return r.concat(s)}for(;n.length<t&&i<e.length;){var s=e[i];if(s instanceof C0)return o(s.definition);if(s instanceof y0)return o(s.definition);if(s instanceof S0)r=o(s.definition);else{if(s instanceof R0)return o(a=s.definition.concat([new b0({definition:s.definition})]));if(s instanceof E0)return o(a=[new C0({definition:s.definition}),new b0({definition:[new A0({terminalType:s.separator})].concat(s.definition)})]);if(s instanceof T0){var a=s.definition.concat([new b0({definition:[new A0({terminalType:s.separator})].concat(s.definition)})]);r=o(a)}else if(s instanceof b0){a=s.definition.concat([new b0({definition:s.definition})]);r=o(a)}else{if(s instanceof N0)return bZ(s.definition,(function(e){r=o(e.definition)})),r;if(!(s instanceof A0))throw Error("non exhaustive match");n.push(s.terminalType)}}i++}return r.push({partialPath:n,suffixDef:MZ(e,i)}),r}function a1(e,t,n,r){var i="EXIT_NONE_TERMINAL",o=[i],s="EXIT_ALTERNATIVE",a=!1,l=t.length,h=l-r-1,u=[],c=[];for(c.push({idx:-1,def:e,ruleStack:[],occurrenceStack:[]});!wZ(c);){var d=c.pop();if(d!==s){var p=d.def,g=d.idx,m=d.ruleStack,f=d.occurrenceStack;if(!wZ(p)){var w=p[0];if(w===i){var y={idx:g,def:MZ(p),ruleStack:IZ(m),occurrenceStack:IZ(f)};c.push(y)}else if(w instanceof A0)if(g<l-1){var v=g+1;if(n(t[v],w.terminalType)){y={idx:v,def:MZ(p),ruleStack:m,occurrenceStack:f};c.push(y)}}else{if(g!==l-1)throw Error("non exhaustive match");u.push({nextTokenType:w.terminalType,nextTokenOccurrence:w.idx,ruleStack:m,occurrenceStack:f}),a=!0}else if(w instanceof y0){var C=HZ(m);C.push(w.nonTerminalName);var S=HZ(f);S.push(w.idx);y={idx:g,def:w.definition.concat(o,MZ(p)),ruleStack:C,occurrenceStack:S};c.push(y)}else if(w instanceof S0){var R={idx:g,def:MZ(p),ruleStack:m,occurrenceStack:f};c.push(R),c.push(s);var E={idx:g,def:w.definition.concat(MZ(p)),ruleStack:m,occurrenceStack:f};c.push(E)}else if(w instanceof R0){var b=new b0({definition:w.definition,idx:w.idx});y={idx:g,def:w.definition.concat([b],MZ(p)),ruleStack:m,occurrenceStack:f};c.push(y)}else if(w instanceof E0){var T=new A0({terminalType:w.separator});b=new b0({definition:[T].concat(w.definition),idx:w.idx}),y={idx:g,def:w.definition.concat([b],MZ(p)),ruleStack:m,occurrenceStack:f};c.push(y)}else if(w instanceof T0){R={idx:g,def:MZ(p),ruleStack:m,occurrenceStack:f};c.push(R),c.push(s);T=new A0({terminalType:w.separator});var N=new b0({definition:[T].concat(w.definition),idx:w.idx});E={idx:g,def:w.definition.concat([N],MZ(p)),ruleStack:m,occurrenceStack:f};c.push(E)}else if(w instanceof b0){R={idx:g,def:MZ(p),ruleStack:m,occurrenceStack:f};c.push(R),c.push(s);N=new b0({definition:w.definition,idx:w.idx}),E={idx:g,def:w.definition.concat([N],MZ(p)),ruleStack:m,occurrenceStack:f};c.push(E)}else if(w instanceof N0)for(var A=w.definition.length-1;A>=0;A--){var M={idx:g,def:w.definition[A].definition.concat(MZ(p)),ruleStack:m,occurrenceStack:f};c.push(M),c.push(s)}else if(w instanceof C0)c.push({idx:g,def:w.definition.concat(MZ(p)),ruleStack:m,occurrenceStack:f});else{if(!(w instanceof v0))throw Error("non exhaustive match");c.push(l1(w,g,m,f))}}}else a&&EZ(c).idx<=h&&c.pop()}return u}function l1(e,t,n,r){var i=HZ(n);i.push(e.name);var o=HZ(r);return o.push(1),{idx:t,def:e.definition,ruleStack:i,occurrenceStack:o}}var h1,u1=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();!function(e){e[e.OPTION=0]="OPTION",e[e.REPETITION=1]="REPETITION",e[e.REPETITION_MANDATORY=2]="REPETITION_MANDATORY",e[e.REPETITION_MANDATORY_WITH_SEPARATOR=3]="REPETITION_MANDATORY_WITH_SEPARATOR",e[e.REPETITION_WITH_SEPARATOR=4]="REPETITION_WITH_SEPARATOR",e[e.ALTERNATION=5]="ALTERNATION"}(h1||(h1={}));var c1=function(e){function t(t,n,r){var i=e.call(this)||this;return i.topProd=t,i.targetOccurrence=n,i.targetProdType=r,i}return u1(t,e),t.prototype.startWalking=function(){return this.walk(this.topProd),this.restDef},t.prototype.checkIsTarget=function(e,t,n,r){return e.idx===this.targetOccurrence&&this.targetProdType===t&&(this.restDef=n.concat(r),!0)},t.prototype.walkOption=function(t,n,r){this.checkIsTarget(t,h1.OPTION,n,r)||e.prototype.walkOption.call(this,t,n,r)},t.prototype.walkAtLeastOne=function(t,n,r){this.checkIsTarget(t,h1.REPETITION_MANDATORY,n,r)||e.prototype.walkOption.call(this,t,n,r)},t.prototype.walkAtLeastOneSep=function(t,n,r){this.checkIsTarget(t,h1.REPETITION_MANDATORY_WITH_SEPARATOR,n,r)||e.prototype.walkOption.call(this,t,n,r)},t.prototype.walkMany=function(t,n,r){this.checkIsTarget(t,h1.REPETITION,n,r)||e.prototype.walkOption.call(this,t,n,r)},t.prototype.walkManySep=function(t,n,r){this.checkIsTarget(t,h1.REPETITION_WITH_SEPARATOR,n,r)||e.prototype.walkOption.call(this,t,n,r)},t}(I0),d1=function(e){function t(t,n,r){var i=e.call(this)||this;return i.targetOccurrence=t,i.targetProdType=n,i.targetRef=r,i.result=[],i}return u1(t,e),t.prototype.checkIsTarget=function(e,t){e.idx!==this.targetOccurrence||this.targetProdType!==t||void 0!==this.targetRef&&e!==this.targetRef||(this.result=e.definition)},t.prototype.visitOption=function(e){this.checkIsTarget(e,h1.OPTION)},t.prototype.visitRepetition=function(e){this.checkIsTarget(e,h1.REPETITION)},t.prototype.visitRepetitionMandatory=function(e){this.checkIsTarget(e,h1.REPETITION_MANDATORY)},t.prototype.visitRepetitionMandatoryWithSeparator=function(e){this.checkIsTarget(e,h1.REPETITION_MANDATORY_WITH_SEPARATOR)},t.prototype.visitRepetitionWithSeparator=function(e){this.checkIsTarget(e,h1.REPETITION_WITH_SEPARATOR)},t.prototype.visitAlternation=function(e){this.checkIsTarget(e,h1.ALTERNATION)},t}(x0);function p1(e){for(var t=new Array(e),n=0;n<e;n++)t[n]=[];return t}function g1(e){for(var t=[""],n=0;n<e.length;n++){for(var r=e[n],i=[],o=0;o<t.length;o++){var s=t[o];i.push(s+"_"+r.tokenTypeIdx);for(var a=0;a<r.categoryMatches.length;a++){var l="_"+r.categoryMatches[a];i.push(s+l)}}t=i}return t}function m1(e,t,n){for(var r=0;r<e.length;r++)if(r!==n)for(var i=e[r],o=0;o<t.length;o++){if(!0===i[t[o]])return!1}return!0}function f1(e,t){for(var n=CZ(e,(function(e){return s1([e],1)})),r=p1(n.length),i=CZ(n,(function(e){var t={};return bZ(e,(function(e){bZ(g1(e.partialPath),(function(e){t[e]=!0}))})),t})),o=n,s=1;s<=t;s++){var a=o;o=p1(a.length);for(var l=function(e){for(var n=a[e],l=0;l<n.length;l++){var h=n[l].partialPath,u=n[l].suffixDef,c=g1(h);if(m1(i,c,e)||wZ(u)||h.length===t){var d=r[e];if(!1===v1(d,h)){d.push(h);for(var p=0;p<c.length;p++){var g=c[p];i[e][g]=!0}}}else{var m=s1(u,s+1,h);o[e]=o[e].concat(m),bZ(m,(function(t){bZ(g1(t.partialPath),(function(t){i[e][t]=!0}))}))}}},h=0;h<a.length;h++)l(h)}return r}function w1(e,t,n,r){var i=new d1(e,h1.ALTERNATION,r);return t.accept(i),f1(i.result,n)}function y1(e,t,n,r){var i=new d1(e,n);t.accept(i);var o=i.result,s=new c1(t,e,n).startWalking();return f1([new C0({definition:o}),new C0({definition:s})],r)}function v1(e,t){e:for(var n=0;n<e.length;n++){var r=e[n];if(r.length===t.length){for(var i=0;i<r.length;i++){var o=t[i],s=r[i];if(!1===(o===s||void 0!==s.categoryMatchesMap[o.tokenTypeIdx]))continue e}return!0}}return!1}function C1(e){return GZ(e,(function(e){return GZ(e,(function(e){return GZ(e,(function(e){return wZ(e.categoryMatches)}))}))}))}var S1=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();function R1(e,t,n,r,i,o){var s=CZ(e,(function(e){return function(e,t){var n=new T1;e.accept(n);var r=n.allProductions,i=CZ(vZ(PZ(qZ(r,E1),(function(e){return e.length>1}))),(function(n){var r=RZ(n),i=t.buildDuplicateFoundError(e,n),o=L0(r),s={message:i,type:A2.DUPLICATE_PRODUCTIONS,ruleName:e.name,dslName:o,occurrence:r.idx},a=b1(r);return a&&(s.parameter=a),s}));return i}(e,i)})),a=CZ(e,(function(e){return M1(e,e,i)})),l=[],h=[],u=[];GZ(a,wZ)&&(l=CZ(e,(function(e){return function(e,t){var n=new O1;e.accept(n);var r=DZ(n.alternations,(function(n,r){var i=CZ(IZ(r.definition),(function(n,i){return wZ(a1([n],[],null,1))?{message:t.buildEmptyAlternationError({topLevelRule:e,alternation:r,emptyChoiceIdx:i}),type:A2.NONE_LAST_EMPTY_ALT,ruleName:e.name,occurrence:r.idx,alternative:i+1}:null}));return n.concat(VZ(i))}),[]);return r}(e,i)})),h=CZ(e,(function(e){return function(e,t,n,r){var i=new O1;e.accept(i);var o=i.alternations,s=n[e.name];s&&(o=xZ(o,(function(e){return s[L0(e)+(0===e.idx?"":e.idx)]})));var a=DZ(o=xZ(o,(function(e){return!0===e.ignoreAmbiguities})),(function(n,i){var o=i.idx,s=i.maxLookahead||t,a=w1(o,e,s,i),l=function(e,t,n,r){var i=[],o=DZ(e,(function(n,r,o){return!0===t.definition[o].ignoreAmbiguities||bZ(r,(function(r){var s=[o];bZ(e,(function(e,n){o!==n&&v1(e,r)&&!0!==t.definition[n].ignoreAmbiguities&&s.push(n)})),s.length>1&&!v1(i,r)&&(i.push(r),n.push({alts:s,path:r}))})),n}),[]),s=CZ(o,(function(e){var i=CZ(e.alts,(function(e){return e+1}));return{message:r.buildAlternationAmbiguityError({topLevelRule:n,alternation:t,ambiguityIndices:i,prefixPath:e.path}),type:A2.AMBIGUOUS_ALTS,ruleName:n.name,occurrence:t.idx,alternatives:[e.alts]}}));return s}(a,i,e,r),h=function(e,t,n,r){var i=[],o=DZ(e,(function(e,t,n){var r=CZ(t,(function(e){return{idx:n,path:e}}));return e.concat(r)}),[]);return bZ(o,(function(e){if(!0!==t.definition[e.idx].ignoreAmbiguities){var s=e.idx,a=e.path,l=CZ(function(e,t){for(var n=[],r=0;r<e.length;r++){var i=e[r];t.call(null,i)&&n.push(i)}return n}(o,(function(e){return!0!==t.definition[e.idx].ignoreAmbiguities&&e.idx<s&&(n=e.path,r=a,n.length<r.length&&GZ(n,(function(e,t){var n=r[t];return e===n||n.categoryMatchesMap[e.tokenTypeIdx]})));var n,r})),(function(e){var i=[e.idx+1,s+1],o=0===t.idx?"":t.idx;return{message:r.buildAlternationPrefixAmbiguityError({topLevelRule:n,alternation:t,ambiguityIndices:i,prefixPath:e.path}),type:A2.AMBIGUOUS_PREFIX_ALTS,ruleName:n.name,occurrence:o,alternatives:i}}));i=i.concat(l)}})),i}(a,i,e,r);return n.concat(l,h)}),[]);return a}(e,t,r,i)})),u=function(e,t,n){var r=[];return bZ(e,(function(e){var i=new x1;e.accept(i),bZ(i.allProductions,(function(i){var o=function(e){if(e instanceof S0)return h1.OPTION;if(e instanceof b0)return h1.REPETITION;if(e instanceof R0)return h1.REPETITION_MANDATORY;if(e instanceof E0)return h1.REPETITION_MANDATORY_WITH_SEPARATOR;if(e instanceof T0)return h1.REPETITION_WITH_SEPARATOR;if(e instanceof N0)return h1.ALTERNATION;throw Error("non exhaustive match")}(i),s=i.maxLookahead||t;if(wZ(SZ(y1(i.idx,e,o,s)[0]))){var a=n.buildEmptyRepetitionError({topLevelRule:e,repetition:i});r.push({message:a,type:A2.NO_NON_EMPTY_LOOKAHEAD,ruleName:e.name})}}))})),r}(e,t,i));var c=function(e,t,n){var r=[],i=CZ(t,(function(e){return e.name}));return bZ(e,(function(e){var t=e.name;if(LZ(i,t)){var o=n.buildNamespaceConflictError(e);r.push({message:o,type:A2.CONFLICT_TOKENS_RULES_NAMESPACE,ruleName:t})}})),r}(e,n,i),d=CZ(n,(function(e){return function(e,t){var n=[];e.name.match(N1)||n.push({message:t.buildTokenNameError({tokenType:e,expectedPattern:N1}),type:A2.INVALID_TOKEN_NAME});return n}(e,i)})),p=function(e,t){var n=[];return bZ(e,(function(e){var r=new Z0("");e.accept(r);var i=CZ(r.result,(function(e){return e.orgProd}));n.push(CZ(i,(function(n){return function(e,t,n){var r,i=[];t.name.match(A1)||(r=n.buildInvalidNestedRuleNameError(e,t),i.push({message:r,type:A2.INVALID_NESTED_RULE_NAME,ruleName:e.name}));return i}(e,n,t)})))})),SZ(n)}(e,i),g=function(e,t){var n=[];return bZ(e,(function(e){var r=new Z0("");e.accept(r),bZ(vZ(PZ(qZ(r.result,(function(e){return e.name})),(function(e){return e.length>1}))),(function(r){var i=CZ(r,(function(e){return e.orgProd})),o=t.buildDuplicateNestedRuleNameError(e,i);n.push({message:o,type:A2.DUPLICATE_NESTED_NAME,ruleName:e.name})}))})),n}(e,i),m=CZ(e,(function(e){return function(e,t){var n=new O1;e.accept(n);var r=DZ(n.alternations,(function(n,r){return r.definition.length>255&&n.push({message:t.buildTooManyAlternativesError({topLevelRule:e,alternation:r}),type:A2.TOO_MANY_ALTS,ruleName:e.name,occurrence:r.idx}),n}),[]);return r}(e,i)})),f=CZ(e,(function(e){return function(e,t){var n=[],r=e.name;r.match(N1)||n.push({message:t.buildInvalidRuleNameError({topLevelRule:e,expectedPattern:N1}),type:A2.INVALID_RULE_NAME,ruleName:r});return n}(e,i)})),w=CZ(e,(function(t){return function(e,t,n,r){var i=[],o=DZ(t,(function(t,n){return n.name===e.name?t+1:t}),0);if(o>1){var s=r.buildDuplicateRuleNameError({topLevelRule:e,grammarName:n});i.push({message:s,type:A2.DUPLICATE_RULE_NAME,ruleName:e.name})}return i}(t,e,o,i)}));return SZ(s.concat(d,p,g,u,a,l,h,c,m,f,w))}function E1(e){return L0(e)+"_#_"+e.idx+"_#_"+b1(e)}function b1(e){return e instanceof A0?e.terminalType.name:e instanceof y0?e.nonTerminalName:""}var T1=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.allProductions=[],t}return S1(t,e),t.prototype.visitNonTerminal=function(e){this.allProductions.push(e)},t.prototype.visitOption=function(e){this.allProductions.push(e)},t.prototype.visitRepetitionWithSeparator=function(e){this.allProductions.push(e)},t.prototype.visitRepetitionMandatory=function(e){this.allProductions.push(e)},t.prototype.visitRepetitionMandatoryWithSeparator=function(e){this.allProductions.push(e)},t.prototype.visitRepetition=function(e){this.allProductions.push(e)},t.prototype.visitAlternation=function(e){this.allProductions.push(e)},t.prototype.visitTerminal=function(e){this.allProductions.push(e)},t}(x0),N1=/^[a-zA-Z_]\w*$/,A1=new RegExp(N1.source.replace("^","^\\$"));function M1(e,t,n,r){void 0===r&&(r=[]);var i=[],o=I1(t.definition);if(wZ(o))return[];var s=e.name;LZ(o,e)&&i.push({message:n.buildLeftRecursionError({topLevelRule:e,leftRecursionPath:r}),type:A2.LEFT_RECURSION,ruleName:s});var a=CZ(zZ(o,r.concat([e])),(function(t){var i=HZ(r);return i.push(t),M1(e,t,n,i)}));return i.concat(SZ(a))}function I1(e){var t=[];if(wZ(e))return t;var n=RZ(e);if(n instanceof y0)t.push(n.referencedRule);else if(n instanceof C0||n instanceof S0||n instanceof R0||n instanceof E0||n instanceof T0||n instanceof b0)t=t.concat(I1(n.definition));else if(n instanceof N0)t=SZ(CZ(n.definition,(function(e){return I1(e.definition)})));else if(!(n instanceof A0))throw Error("non exhaustive match");var r=_0(n),i=e.length>1;if(r&&i){var o=MZ(e);return t.concat(I1(o))}return t}var O1=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.alternations=[],t}return S1(t,e),t.prototype.visitAlternation=function(e){this.alternations.push(e)},t}(x0);var x1=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.allProductions=[],t}return S1(t,e),t.prototype.visitRepetitionWithSeparator=function(e){this.allProductions.push(e)},t.prototype.visitRepetitionMandatory=function(e){this.allProductions.push(e)},t.prototype.visitRepetitionMandatoryWithSeparator=function(e){this.allProductions.push(e)},t.prototype.visitRepetition=function(e){this.allProductions.push(e)},t}(x0);var P1={buildMismatchTokenMessage:function(e){var t=e.expected,n=e.actual;return e.previous,e.ruleName,"Expecting "+(n0(t)?"--\x3e "+t0(t)+" <--":"token of type --\x3e "+t.name+" <--")+" but found --\x3e '"+n.image+"' <--"},buildNotAllInputParsedMessage:function(e){var t=e.firstRedundant;return e.ruleName,"Redundant input, expecting EOF but found: "+t.image},buildNoViableAltMessage:function(e){var t=e.expectedPathsPerAlt,n=e.actual;e.previous;var r=e.customUserDescription;e.ruleName;var i="Expecting: ",o="\nbut found: '"+RZ(n).image+"'";if(r)return i+r+o;var s=CZ(DZ(t,(function(e,t){return e.concat(t)}),[]),(function(e){return"["+CZ(e,(function(e){return t0(e)})).join(", ")+"]"}));return i+("one of these possible Token sequences:\n"+CZ(s,(function(e,t){return"  "+(t+1)+". "+e})).join("\n"))+o},buildEarlyExitMessage:function(e){var t=e.expectedIterationPaths,n=e.actual,r=e.customUserDescription;e.ruleName;var i="Expecting: ",o="\nbut found: '"+RZ(n).image+"'";return r?i+r+o:i+("expecting at least one iteration which starts with one of these possible Token sequences::\n  <"+CZ(t,(function(e){return"["+CZ(e,(function(e){return t0(e)})).join(",")+"]"})).join(" ,")+">")+o}};Object.freeze(P1);var _1={buildRuleNotFoundError:function(e,t){return"Invalid grammar, reference to a rule which is not defined: ->"+t.nonTerminalName+"<-\ninside top level rule: ->"+e.name+"<-"}},L1={buildDuplicateFoundError:function(e,t){var n,r=e.name,i=RZ(t),o=i.idx,s=L0(i),a=(n=i)instanceof A0?n.terminalType.name:n instanceof y0?n.nonTerminalName:"",l="->"+s+(o>0?o:"")+"<- "+(a?"with argument: ->"+a+"<-":"")+"\n                  appears more than once ("+t.length+" times) in the top level rule: ->"+r+"<-.                  \n                  For further details see: https://sap.github.io/chevrotain/docs/FAQ.html#NUMERICAL_SUFFIXES \n                  ";return l=(l=l.replace(/[ \t]+/g," ")).replace(/\s\s+/g,"\n")},buildInvalidNestedRuleNameError:function(e,t){return"Invalid nested rule name: ->"+t.name+"<- inside rule: ->"+e.name+"<-\nit must match the pattern: ->"+A1.toString()+"<-.\nNote that this means a nested rule name must start with the '$'(dollar) sign."},buildDuplicateNestedRuleNameError:function(e,t){return"Duplicate nested rule name: ->"+RZ(t).name+"<- inside rule: ->"+e.name+"<-\nA nested name must be unique in the scope of a top level grammar rule."},buildNamespaceConflictError:function(e){return"Namespace conflict found in grammar.\nThe grammar has both a Terminal(Token) and a Non-Terminal(Rule) named: <"+e.name+">.\nTo resolve this make sure each Terminal and Non-Terminal names are unique\nThis is easy to accomplish by using the convention that Terminal names start with an uppercase letter\nand Non-Terminal names start with a lower case letter."},buildAlternationPrefixAmbiguityError:function(e){var t=CZ(e.prefixPath,(function(e){return t0(e)})).join(", "),n=0===e.alternation.idx?"":e.alternation.idx;return"Ambiguous alternatives: <"+e.ambiguityIndices.join(" ,")+"> due to common lookahead prefix\nin <OR"+n+"> inside <"+e.topLevelRule.name+"> Rule,\n<"+t+"> may appears as a prefix path in all these alternatives.\nSee: https://sap.github.io/chevrotain/docs/guide/resolving_grammar_errors.html#COMMON_PREFIX\nFor Further details."},buildAlternationAmbiguityError:function(e){var t=CZ(e.prefixPath,(function(e){return t0(e)})).join(", "),n=0===e.alternation.idx?"":e.alternation.idx,r="Ambiguous Alternatives Detected: <"+e.ambiguityIndices.join(" ,")+"> in <OR"+n+"> inside <"+e.topLevelRule.name+"> Rule,\n<"+t+"> may appears as a prefix path in all these alternatives.\n";return r+="See: https://sap.github.io/chevrotain/docs/guide/resolving_grammar_errors.html#AMBIGUOUS_ALTERNATIVES\nFor Further details."},buildEmptyRepetitionError:function(e){var t=L0(e.repetition);return 0!==e.repetition.idx&&(t+=e.repetition.idx),"The repetition <"+t+"> within Rule <"+e.topLevelRule.name+"> can never consume any tokens.\nThis could lead to an infinite loop."},buildTokenNameError:function(e){return"Invalid Grammar Token name: ->"+e.tokenType.name+"<- it must match the pattern: ->"+e.expectedPattern.toString()+"<-"},buildEmptyAlternationError:function(e){return"Ambiguous empty alternative: <"+(e.emptyChoiceIdx+1)+"> in <OR"+e.alternation.idx+"> inside <"+e.topLevelRule.name+"> Rule.\nOnly the last alternative may be an empty alternative."},buildTooManyAlternativesError:function(e){return"An Alternation cannot have more than 256 alternatives:\n<OR"+e.alternation.idx+"> inside <"+e.topLevelRule.name+"> Rule.\n has "+(e.alternation.definition.length+1)+" alternatives."},buildLeftRecursionError:function(e){var t=e.topLevelRule.name;return"Left Recursion found in grammar.\nrule: <"+t+"> can be invoked from itself (directly or indirectly)\nwithout consuming any Tokens. The grammar path that causes this is: \n "+(t+" --\x3e "+CZ(e.leftRecursionPath,(function(e){return e.name})).concat([t]).join(" --\x3e "))+"\n To fix this refactor your grammar to remove the left recursion.\nsee: https://en.wikipedia.org/wiki/LL_parser#Left_Factoring."},buildInvalidRuleNameError:function(e){return"Invalid grammar rule name: ->"+e.topLevelRule.name+"<- it must match the pattern: ->"+e.expectedPattern.toString()+"<-"},buildDuplicateRuleNameError:function(e){return"Duplicate definition, rule: ->"+(e.topLevelRule instanceof v0?e.topLevelRule.name:e.topLevelRule)+"<- is already defined in the grammar: ->"+e.grammarName+"<-"}},H1=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();var k1=function(e){function t(t,n){var r=e.call(this)||this;return r.nameToTopRule=t,r.errMsgProvider=n,r.errors=[],r}return H1(t,e),t.prototype.resolveRefs=function(){var e=this;bZ(vZ(this.nameToTopRule),(function(t){e.currTopLevel=t,t.accept(e)}))},t.prototype.visitNonTerminal=function(e){var t=this.nameToTopRule[e.nonTerminalName];if(t)e.referencedRule=t;else{var n=this.errMsgProvider.buildRuleNotFoundError(this.currTopLevel,e);this.errors.push({message:n,type:A2.UNRESOLVED_SUBRULE_REF,ruleName:this.currTopLevel.name,unresolvedRefName:e.nonTerminalName})}},t}(x0);function F1(e){e=XZ(e,{errMsgProvider:_1});var t,n,r,i={};return bZ(e.rules,(function(e){i[e.name]=e})),t=i,n=e.errMsgProvider,(r=new k1(t,n)).resolveRefs(),r.errors}var D1="MismatchedTokenException",V1="NoViableAltException",U1="EarlyExitException",B1="NotAllInputParsedException",W1=[D1,V1,U1,B1];function j1(e){return LZ(W1,e.name)}function G1(e,t,n){this.name=D1,this.message=e,this.token=t,this.previousToken=n,this.resyncedTokens=[]}function z1(e,t,n){this.name=V1,this.message=e,this.token=t,this.previousToken=n,this.resyncedTokens=[]}function $1(e,t){this.name=B1,this.message=e,this.token=t,this.resyncedTokens=[]}function Y1(e,t,n){this.name=U1,this.message=e,this.token=t,this.previousToken=n,this.resyncedTokens=[]}Object.freeze(W1),G1.prototype=Error.prototype,z1.prototype=Error.prototype,$1.prototype=Error.prototype,Y1.prototype=Error.prototype;var K1={},X1="InRuleRecoveryException";function q1(e){this.name=X1,this.message=e}q1.prototype=Error.prototype;var Q1=function(){function e(){}return e.prototype.initRecoverable=function(e){this.firstAfterRepMap={},this.resyncFollows={},this.recoveryEnabled=_Z(e,"recoveryEnabled")?e.recoveryEnabled:M2.recoveryEnabled,this.recoveryEnabled&&(this.attemptInRepetitionRecovery=Z1)},e.prototype.getTokenToInsert=function(e){var t=g0(e,"",NaN,NaN,NaN,NaN,NaN,NaN);return t.isInsertedInRecovery=!0,t},e.prototype.canTokenTypeBeInsertedInRecovery=function(e){return!0},e.prototype.tryInRepetitionRecovery=function(e,t,n,r){for(var i=this,o=this.findReSyncTokenType(),s=this.exportLexerState(),a=[],l=!1,h=this.LA(1),u=this.LA(1),c=function(){var e=i.LA(0),t=new G1(i.errorMessageProvider.buildMismatchTokenMessage({expected:r,actual:h,previous:e,ruleName:i.getCurrRuleFullName()}),h,i.LA(0));t.resyncedTokens=IZ(a),i.SAVE_ERROR(t)};!l;){if(this.tokenMatcher(u,r))return void c();if(n.call(this))return c(),void e.apply(this,t);this.tokenMatcher(u,o)?l=!0:(u=this.SKIP_TOKEN(),this.addToResyncTokens(u,a))}this.importLexerState(s)},e.prototype.shouldInRepetitionRecoveryBeTried=function(e,t,n){return!1!==n&&(void 0!==e&&void 0!==t&&(!this.tokenMatcher(this.LA(1),e)&&(!this.isBackTracking()&&!this.canPerformInRuleRecovery(e,this.getFollowsForInRuleRecovery(e,t)))))},e.prototype.getFollowsForInRuleRecovery=function(e,t){var n=this.getCurrentGrammarPath(e,t);return this.getNextPossibleTokenTypes(n)},e.prototype.tryInRuleRecovery=function(e,t){if(this.canRecoverWithSingleTokenInsertion(e,t))return this.getTokenToInsert(e);if(this.canRecoverWithSingleTokenDeletion(e)){var n=this.SKIP_TOKEN();return this.consumeToken(),n}throw new q1("sad sad panda")},e.prototype.canPerformInRuleRecovery=function(e,t){return this.canRecoverWithSingleTokenInsertion(e,t)||this.canRecoverWithSingleTokenDeletion(e)},e.prototype.canRecoverWithSingleTokenInsertion=function(e,t){var n=this;if(!this.canTokenTypeBeInsertedInRecovery(e))return!1;if(wZ(t))return!1;var r=this.LA(1);return void 0!==FZ(t,(function(e){return n.tokenMatcher(r,e)}))},e.prototype.canRecoverWithSingleTokenDeletion=function(e){return this.tokenMatcher(this.LA(2),e)},e.prototype.isInCurrentRuleReSyncSet=function(e){var t=this.getCurrFollowKey();return LZ(this.getFollowSetFromFollowKey(t),e)},e.prototype.findReSyncTokenType=function(){for(var e=this.flattenFollowSet(),t=this.LA(1),n=2;;){var r=t.tokenType;if(LZ(e,r))return r;t=this.LA(n),n++}},e.prototype.getCurrFollowKey=function(){if(1===this.RULE_STACK.length)return K1;var e=this.getLastExplicitRuleShortName(),t=this.getLastExplicitRuleOccurrenceIndex(),n=this.getPreviousExplicitRuleShortName();return{ruleName:this.shortRuleNameToFullName(e),idxInCallingRule:t,inRule:this.shortRuleNameToFullName(n)}},e.prototype.buildFullFollowKeyStack=function(){var e=this,t=this.RULE_STACK,n=this.RULE_OCCURRENCE_STACK;return wZ(this.LAST_EXPLICIT_RULE_STACK)||(t=CZ(this.LAST_EXPLICIT_RULE_STACK,(function(t){return e.RULE_STACK[t]})),n=CZ(this.LAST_EXPLICIT_RULE_STACK,(function(t){return e.RULE_OCCURRENCE_STACK[t]}))),CZ(t,(function(r,i){return 0===i?K1:{ruleName:e.shortRuleNameToFullName(r),idxInCallingRule:n[i],inRule:e.shortRuleNameToFullName(t[i-1])}}))},e.prototype.flattenFollowSet=function(){var e=this;return SZ(CZ(this.buildFullFollowKeyStack(),(function(t){return e.getFollowSetFromFollowKey(t)})))},e.prototype.getFollowSetFromFollowKey=function(e){if(e===K1)return[p0];var t=e.ruleName+e.idxInCallingRule+F0+e.inRule;return this.resyncFollows[t]},e.prototype.addToResyncTokens=function(e,t){return this.tokenMatcher(e,p0)||t.push(e),t},e.prototype.reSyncTo=function(e){for(var t=[],n=this.LA(1);!1===this.tokenMatcher(n,e);)n=this.SKIP_TOKEN(),this.addToResyncTokens(n,t);return IZ(t)},e.prototype.attemptInRepetitionRecovery=function(e,t,n,r,i,o,s){},e.prototype.getCurrentGrammarPath=function(e,t){return{ruleStack:this.getHumanReadableRuleStack(),occurrenceStack:HZ(this.RULE_OCCURRENCE_STACK),lastTok:e,lastTokOccurrence:t}},e.prototype.getHumanReadableRuleStack=function(){var e=this;return wZ(this.LAST_EXPLICIT_RULE_STACK)?CZ(this.RULE_STACK,(function(t){return e.shortRuleNameToFullName(t)})):CZ(this.LAST_EXPLICIT_RULE_STACK,(function(t){return e.shortRuleNameToFullName(e.RULE_STACK[t])}))},e}();function Z1(e,t,n,r,i,o,s){var a=this.getKeyForAutomaticLookahead(r,i),l=this.firstAfterRepMap[a];if(void 0===l){var h=this.getCurrRuleFullName();l=new o(this.getGAstProductions()[h],i).startWalking(),this.firstAfterRepMap[a]=l}var u=l.token,c=l.occurrence,d=l.isEndOfRule;1===this.RULE_STACK.length&&d&&void 0===u&&(u=p0,c=1),this.shouldInRepetitionRecoveryBeTried(u,c,s)&&this.tryInRepetitionRecovery(e,t,n,u)}var J1=function(){function e(){}return e.prototype.initLooksAhead=function(e){this.dynamicTokensEnabled=_Z(e,"dynamicTokensEnabled")?e.dynamicTokensEnabled:M2.dynamicTokensEnabled,this.maxLookahead=_Z(e,"maxLookahead")?e.maxLookahead:M2.maxLookahead,this.lookAheadFuncsCache=nJ()?new Map:[],nJ()?(this.getLaFuncFromCache=this.getLaFuncFromMap,this.setLaFuncCache=this.setLaFuncCacheUsingMap):(this.getLaFuncFromCache=this.getLaFuncFromObj,this.setLaFuncCache=this.setLaFuncUsingObj)},e.prototype.preComputeLookaheadFunctions=function(e){var t=this;bZ(e,(function(e){t.TRACE_INIT(e.name+" Rule Lookahead",(function(){var n=function(e){H0.reset(),e.accept(H0);var t=H0.dslMethods;return H0.reset(),t}(e),r=n.alternation,i=n.repetition,o=n.option,s=n.repetitionMandatory,a=n.repetitionMandatoryWithSeparator,l=n.repetitionWithSeparator;bZ(r,(function(n){var r=0===n.idx?"":n.idx;t.TRACE_INIT(""+L0(n)+r,(function(){var r,i,o,s,a,l,h,u=(r=n.idx,i=e,o=n.maxLookahead||t.maxLookahead,s=n.hasPredicates,a=t.dynamicTokensEnabled,l=t.lookAheadBuilderForAlternatives,h=w1(r,i,o),l(h,s,C1(h)?GJ:jJ,a)),c=$0(t.fullRuleNameToShort[e.name],U0,n.idx);t.setLaFuncCache(c,u)}))})),bZ(i,(function(n){t.computeLookaheadFunc(e,n.idx,W0,h1.REPETITION,n.maxLookahead,L0(n))})),bZ(o,(function(n){t.computeLookaheadFunc(e,n.idx,B0,h1.OPTION,n.maxLookahead,L0(n))})),bZ(s,(function(n){t.computeLookaheadFunc(e,n.idx,j0,h1.REPETITION_MANDATORY,n.maxLookahead,L0(n))})),bZ(a,(function(n){t.computeLookaheadFunc(e,n.idx,z0,h1.REPETITION_MANDATORY_WITH_SEPARATOR,n.maxLookahead,L0(n))})),bZ(l,(function(n){t.computeLookaheadFunc(e,n.idx,G0,h1.REPETITION_WITH_SEPARATOR,n.maxLookahead,L0(n))}))}))}))},e.prototype.computeLookaheadFunc=function(e,t,n,r,i,o){var s=this;this.TRACE_INIT(""+o+(0===t?"":t),(function(){var o=function(e,t,n,r,i,o){var s=y1(e,t,i,n),a=C1(s)?GJ:jJ;return o(s[0],a,r)}(t,e,i||s.maxLookahead,s.dynamicTokensEnabled,r,s.lookAheadBuilderForOptional),a=$0(s.fullRuleNameToShort[e.name],n,t);s.setLaFuncCache(a,o)}))},e.prototype.lookAheadBuilderForOptional=function(e,t,n){return function(e,t,n){var r=GZ(e,(function(e){return 1===e.length})),i=e.length;if(r&&!n){var o=SZ(e);if(1===o.length&&wZ(o[0].categoryMatches)){var s=o[0].tokenTypeIdx;return function(){return this.LA(1).tokenTypeIdx===s}}var a=DZ(o,(function(e,t,n){return e[t.tokenTypeIdx]=!0,bZ(t.categoryMatches,(function(t){e[t]=!0})),e}),[]);return function(){var e=this.LA(1);return!0===a[e.tokenTypeIdx]}}return function(){e:for(var n=0;n<i;n++){for(var r=e[n],o=r.length,s=0;s<o;s++){var a=this.LA(s+1);if(!1===t(a,r[s]))continue e}return!0}return!1}}(e,t,n)},e.prototype.lookAheadBuilderForAlternatives=function(e,t,n,r){return function(e,t,n,r){var i=e.length,o=GZ(e,(function(e){return GZ(e,(function(e){return 1===e.length}))}));if(t)return function(t){for(var r=CZ(t,(function(e){return e.GATE})),o=0;o<i;o++){var s=e[o],a=s.length,l=r[o];if(void 0===l||!1!==l.call(this))e:for(var h=0;h<a;h++){for(var u=s[h],c=u.length,d=0;d<c;d++){var p=this.LA(d+1);if(!1===n(p,u[d]))continue e}return o}}};if(o&&!r){var s=DZ(CZ(e,(function(e){return SZ(e)})),(function(e,t,n){return bZ(t,(function(t){_Z(e,t.tokenTypeIdx)||(e[t.tokenTypeIdx]=n),bZ(t.categoryMatches,(function(t){_Z(e,t)||(e[t]=n)}))})),e}),[]);return function(){var e=this.LA(1);return s[e.tokenTypeIdx]}}return function(){for(var t=0;t<i;t++){var r=e[t],o=r.length;e:for(var s=0;s<o;s++){for(var a=r[s],l=a.length,h=0;h<l;h++){var u=this.LA(h+1);if(!1===n(u,a[h]))continue e}return t}}}}(e,t,n,r)},e.prototype.getKeyForAutomaticLookahead=function(e,t){return $0(this.getLastExplicitRuleShortName(),e,t)},e.prototype.getLaFuncFromCache=function(e){},e.prototype.getLaFuncFromMap=function(e){return this.lookAheadFuncsCache.get(e)},e.prototype.getLaFuncFromObj=function(e){return this.lookAheadFuncsCache[e]},e.prototype.setLaFuncCache=function(e,t){},e.prototype.setLaFuncCacheUsingMap=function(e,t){this.lookAheadFuncsCache.set(e,t)},e.prototype.setLaFuncUsingObj=function(e,t){this.lookAheadFuncsCache[e]=t},e}();var e2,t2=/^\s*function\s*(\S*)\s*\(/,n2="name";function r2(e){var t=e.name;return t||e.toString().match(t2)[1]}function i2(e,t){var n=Object.getOwnPropertyDescriptor(e,n2);return!(!NZ(n)&&!n.configurable)&&(Object.defineProperty(e,n2,{enumerable:!1,configurable:!0,writable:!1,value:t}),!0)}function o2(e,t){for(var n=yZ(e),r=n.length,i=0;i<r;i++)for(var o=e[n[i]],s=o.length,a=0;a<s;a++){var l=o[a];void 0===l.tokenTypeIdx&&(void 0!==l.fullName?this[l.fullName](l.children,t):this[l.name](l.children,t))}}function s2(e,t){var n=function(){};i2(n,e+"BaseSemantics");var r={visit:function(e,t){if(BZ(e)&&(e=e[0]),!NZ(e))return void 0!==e.fullName?this[e.fullName](e.children,t):this[e.name](e.children,t)},validateVisitor:function(){var e=function(e,t){var n=function(e,t){var n=CZ(t,(function(t){if(!AZ(e[t]))return{msg:"Missing visitor method: <"+t+"> on "+r2(e.constructor)+" CST Visitor.",type:e2.MISSING_METHOD,methodName:t}}));return VZ(n)}(e,t),r=function(e,t){var n=[];for(var r in e)N1.test(r)&&AZ(e[r])&&!LZ(a2,r)&&!LZ(t,r)&&n.push({msg:"Redundant visitor method: <"+r+"> on "+r2(e.constructor)+" CST Visitor\nThere is no Grammar Rule corresponding to this method's name.\nFor utility methods on visitor classes use methods names that do not match /"+N1.source+"/.",type:e2.REDUNDANT_METHOD,methodName:r});return n}(e,t);return n.concat(r)}(this,t);if(!wZ(e)){var n=CZ(e,(function(e){return e.msg}));throw Error("Errors Detected in CST Visitor <"+r2(this.constructor)+">:\n\t"+n.join("\n\n").replace(/\n/g,"\n\t"))}}};return(n.prototype=r).constructor=n,n._RULE_NAMES=t,n}!function(e){e[e.REDUNDANT_METHOD=0]="REDUNDANT_METHOD",e[e.MISSING_METHOD=1]="MISSING_METHOD"}(e2||(e2={}));var a2=["constructor","visit","validateVisitor"];var l2=function(){function e(){}return e.prototype.initTreeBuilder=function(e){if(this.LAST_EXPLICIT_RULE_STACK=[],this.CST_STACK=[],this.outputCst=_Z(e,"outputCst")?e.outputCst:M2.outputCst,this.nodeLocationTracking=_Z(e,"nodeLocationTracking")?e.nodeLocationTracking:M2.nodeLocationTracking,this.outputCst)if(/full/i.test(this.nodeLocationTracking))this.recoveryEnabled?(this.setNodeLocationFromToken=q0,this.setNodeLocationFromNode=q0,this.cstPostRule=ZZ,this.setInitialNodeLocation=this.setInitialNodeLocationFullRecovery):(this.setNodeLocationFromToken=ZZ,this.setNodeLocationFromNode=ZZ,this.cstPostRule=this.cstPostRuleFull,this.setInitialNodeLocation=this.setInitialNodeLocationFullRegular);else if(/onlyOffset/i.test(this.nodeLocationTracking))this.recoveryEnabled?(this.setNodeLocationFromToken=X0,this.setNodeLocationFromNode=X0,this.cstPostRule=ZZ,this.setInitialNodeLocation=this.setInitialNodeLocationOnlyOffsetRecovery):(this.setNodeLocationFromToken=ZZ,this.setNodeLocationFromNode=ZZ,this.cstPostRule=this.cstPostRuleOnlyOffset,this.setInitialNodeLocation=this.setInitialNodeLocationOnlyOffsetRegular);else{if(!/none/i.test(this.nodeLocationTracking))throw Error('Invalid <nodeLocationTracking> config option: "'+e.nodeLocationTracking+'"');this.setNodeLocationFromToken=ZZ,this.setNodeLocationFromNode=ZZ,this.cstPostRule=ZZ,this.setInitialNodeLocation=ZZ}else this.cstInvocationStateUpdate=ZZ,this.cstFinallyStateUpdate=ZZ,this.cstPostTerminal=ZZ,this.cstPostNonTerminal=ZZ,this.cstPostRule=ZZ,this.getLastExplicitRuleShortName=this.getLastExplicitRuleShortNameNoCst,this.getPreviousExplicitRuleShortName=this.getPreviousExplicitRuleShortNameNoCst,this.getLastExplicitRuleOccurrenceIndex=this.getLastExplicitRuleOccurrenceIndexNoCst,this.manyInternal=this.manyInternalNoCst,this.orInternal=this.orInternalNoCst,this.optionInternal=this.optionInternalNoCst,this.atLeastOneInternal=this.atLeastOneInternalNoCst,this.manySepFirstInternal=this.manySepFirstInternalNoCst,this.atLeastOneSepFirstInternal=this.atLeastOneSepFirstInternalNoCst},e.prototype.setInitialNodeLocationOnlyOffsetRecovery=function(e){e.location={startOffset:NaN,endOffset:NaN}},e.prototype.setInitialNodeLocationOnlyOffsetRegular=function(e){e.location={startOffset:this.LA(1).startOffset,endOffset:NaN}},e.prototype.setInitialNodeLocationFullRecovery=function(e){e.location={startOffset:NaN,startLine:NaN,startColumn:NaN,endOffset:NaN,endLine:NaN,endColumn:NaN}},e.prototype.setInitialNodeLocationFullRegular=function(e){var t=this.LA(1);e.location={startOffset:t.startOffset,startLine:t.startLine,startColumn:t.startColumn,endOffset:NaN,endLine:NaN,endColumn:NaN}},e.prototype.cstNestedInvocationStateUpdate=function(e,t){var n={name:e,fullName:this.shortRuleNameToFull[this.getLastExplicitRuleShortName()]+e,children:{}};this.setInitialNodeLocation(n),this.CST_STACK.push(n)},e.prototype.cstInvocationStateUpdate=function(e,t){this.LAST_EXPLICIT_RULE_STACK.push(this.RULE_STACK.length-1);var n={name:e,children:{}};this.setInitialNodeLocation(n),this.CST_STACK.push(n)},e.prototype.cstFinallyStateUpdate=function(){this.LAST_EXPLICIT_RULE_STACK.pop(),this.CST_STACK.pop()},e.prototype.cstNestedFinallyStateUpdate=function(){var e=this.CST_STACK.pop();this.cstPostRule(e)},e.prototype.cstPostRuleFull=function(e){var t=this.LA(0),n=e.location;n.startOffset<=t.startOffset==!0?(n.endOffset=t.endOffset,n.endLine=t.endLine,n.endColumn=t.endColumn):(n.startOffset=NaN,n.startLine=NaN,n.startColumn=NaN)},e.prototype.cstPostRuleOnlyOffset=function(e){var t=this.LA(0),n=e.location;n.startOffset<=t.startOffset==!0?n.endOffset=t.endOffset:n.startOffset=NaN},e.prototype.cstPostTerminal=function(e,t){var n,r,i,o=this.CST_STACK[this.CST_STACK.length-1];r=t,i=e,void 0===(n=o).children[i]?n.children[i]=[r]:n.children[i].push(r),this.setNodeLocationFromToken(o.location,t)},e.prototype.cstPostNonTerminal=function(e,t){if(!0!==this.isBackTracking()){var n=this.CST_STACK[this.CST_STACK.length-1];Q0(n,t,e),this.setNodeLocationFromNode(n.location,e.location)}},e.prototype.getBaseCstVisitorConstructor=function(){if(NZ(this.baseCstVisitorConstructor)){var e=s2(this.className,this.allRuleNames);return this.baseCstVisitorConstructor=e,e}return this.baseCstVisitorConstructor},e.prototype.getBaseCstVisitorConstructorWithDefaults=function(){if(NZ(this.baseCstVisitorWithDefaultsConstructor)){var e=function(e,t,n){var r=function(){};i2(r,e+"BaseSemanticsWithDefaults");var i=Object.create(n.prototype);return bZ(t,(function(e){i[e]=o2})),(r.prototype=i).constructor=r,r}(this.className,this.allRuleNames,this.getBaseCstVisitorConstructor());return this.baseCstVisitorWithDefaultsConstructor=e,e}return this.baseCstVisitorWithDefaultsConstructor},e.prototype.nestedRuleBeforeClause=function(e,t){var n;return void 0!==e.NAME?(n=e.NAME,this.nestedRuleInvocationStateUpdate(n,t),n):void 0},e.prototype.nestedAltBeforeClause=function(e,t,n,r){var i,o=Y0(this.getLastExplicitRuleShortName(),n,t,r);return void 0!==e.NAME?(i=e.NAME,this.nestedRuleInvocationStateUpdate(i,o),{shortName:o,nestedName:i}):void 0},e.prototype.nestedRuleFinallyClause=function(e,t){var n=this.CST_STACK,r=n[n.length-1];this.nestedRuleFinallyStateUpdate();var i=n[n.length-1];Q0(i,t,r),this.setNodeLocationFromNode(i.location,r.location)},e.prototype.getLastExplicitRuleShortName=function(){var e=this.LAST_EXPLICIT_RULE_STACK[this.LAST_EXPLICIT_RULE_STACK.length-1];return this.RULE_STACK[e]},e.prototype.getLastExplicitRuleShortNameNoCst=function(){var e=this.RULE_STACK;return e[e.length-1]},e.prototype.getPreviousExplicitRuleShortName=function(){var e=this.LAST_EXPLICIT_RULE_STACK[this.LAST_EXPLICIT_RULE_STACK.length-2];return this.RULE_STACK[e]},e.prototype.getPreviousExplicitRuleShortNameNoCst=function(){var e=this.RULE_STACK;return e[e.length-2]},e.prototype.getLastExplicitRuleOccurrenceIndex=function(){var e=this.LAST_EXPLICIT_RULE_STACK[this.LAST_EXPLICIT_RULE_STACK.length-1];return this.RULE_OCCURRENCE_STACK[e]},e.prototype.getLastExplicitRuleOccurrenceIndexNoCst=function(){var e=this.RULE_OCCURRENCE_STACK;return e[e.length-1]},e.prototype.nestedRuleInvocationStateUpdate=function(e,t){this.RULE_OCCURRENCE_STACK.push(1),this.RULE_STACK.push(t),this.cstNestedInvocationStateUpdate(e,t)},e.prototype.nestedRuleFinallyStateUpdate=function(){this.RULE_STACK.pop(),this.RULE_OCCURRENCE_STACK.pop(),this.cstNestedFinallyStateUpdate()},e}(),h2=function(){function e(){}return e.prototype.initLexerAdapter=function(){this.tokVector=[],this.tokVectorLength=0,this.currIdx=-1},Object.defineProperty(e.prototype,"input",{get:function(){return this.tokVector},set:function(e){if(!0!==this.selfAnalysisDone)throw Error("Missing <performSelfAnalysis> invocation at the end of the Parser's constructor.");this.reset(),this.tokVector=e,this.tokVectorLength=e.length},enumerable:!0,configurable:!0}),e.prototype.SKIP_TOKEN=function(){return this.currIdx<=this.tokVector.length-2?(this.consumeToken(),this.LA(1)):N2},e.prototype.LA=function(e){var t=this.currIdx+e;return t<0||this.tokVectorLength<=t?N2:this.tokVector[t]},e.prototype.consumeToken=function(){this.currIdx++},e.prototype.exportLexerState=function(){return this.currIdx},e.prototype.importLexerState=function(e){this.currIdx=e},e.prototype.resetLexerState=function(){this.currIdx=-1},e.prototype.moveToTerminatedState=function(){this.currIdx=this.tokVector.length-1},e.prototype.getLexerPosition=function(){return this.exportLexerState()},e}(),u2=function(){function e(){}return e.prototype.ACTION=function(e){return e.call(this)},e.prototype.consume=function(e,t,n){return this.consumeInternal(t,e,n)},e.prototype.subrule=function(e,t,n){return this.subruleInternal(t,e,n)},e.prototype.option=function(e,t){return this.optionInternal(t,e)},e.prototype.or=function(e,t){return this.orInternal(t,e)},e.prototype.many=function(e,t){return this.manyInternal(e,t)},e.prototype.atLeastOne=function(e,t){return this.atLeastOneInternal(e,t)},e.prototype.CONSUME=function(e,t){return this.consumeInternal(e,0,t)},e.prototype.CONSUME1=function(e,t){return this.consumeInternal(e,1,t)},e.prototype.CONSUME2=function(e,t){return this.consumeInternal(e,2,t)},e.prototype.CONSUME3=function(e,t){return this.consumeInternal(e,3,t)},e.prototype.CONSUME4=function(e,t){return this.consumeInternal(e,4,t)},e.prototype.CONSUME5=function(e,t){return this.consumeInternal(e,5,t)},e.prototype.CONSUME6=function(e,t){return this.consumeInternal(e,6,t)},e.prototype.CONSUME7=function(e,t){return this.consumeInternal(e,7,t)},e.prototype.CONSUME8=function(e,t){return this.consumeInternal(e,8,t)},e.prototype.CONSUME9=function(e,t){return this.consumeInternal(e,9,t)},e.prototype.SUBRULE=function(e,t){return this.subruleInternal(e,0,t)},e.prototype.SUBRULE1=function(e,t){return this.subruleInternal(e,1,t)},e.prototype.SUBRULE2=function(e,t){return this.subruleInternal(e,2,t)},e.prototype.SUBRULE3=function(e,t){return this.subruleInternal(e,3,t)},e.prototype.SUBRULE4=function(e,t){return this.subruleInternal(e,4,t)},e.prototype.SUBRULE5=function(e,t){return this.subruleInternal(e,5,t)},e.prototype.SUBRULE6=function(e,t){return this.subruleInternal(e,6,t)},e.prototype.SUBRULE7=function(e,t){return this.subruleInternal(e,7,t)},e.prototype.SUBRULE8=function(e,t){return this.subruleInternal(e,8,t)},e.prototype.SUBRULE9=function(e,t){return this.subruleInternal(e,9,t)},e.prototype.OPTION=function(e){return this.optionInternal(e,0)},e.prototype.OPTION1=function(e){return this.optionInternal(e,1)},e.prototype.OPTION2=function(e){return this.optionInternal(e,2)},e.prototype.OPTION3=function(e){return this.optionInternal(e,3)},e.prototype.OPTION4=function(e){return this.optionInternal(e,4)},e.prototype.OPTION5=function(e){return this.optionInternal(e,5)},e.prototype.OPTION6=function(e){return this.optionInternal(e,6)},e.prototype.OPTION7=function(e){return this.optionInternal(e,7)},e.prototype.OPTION8=function(e){return this.optionInternal(e,8)},e.prototype.OPTION9=function(e){return this.optionInternal(e,9)},e.prototype.OR=function(e){return this.orInternal(e,0)},e.prototype.OR1=function(e){return this.orInternal(e,1)},e.prototype.OR2=function(e){return this.orInternal(e,2)},e.prototype.OR3=function(e){return this.orInternal(e,3)},e.prototype.OR4=function(e){return this.orInternal(e,4)},e.prototype.OR5=function(e){return this.orInternal(e,5)},e.prototype.OR6=function(e){return this.orInternal(e,6)},e.prototype.OR7=function(e){return this.orInternal(e,7)},e.prototype.OR8=function(e){return this.orInternal(e,8)},e.prototype.OR9=function(e){return this.orInternal(e,9)},e.prototype.MANY=function(e){this.manyInternal(0,e)},e.prototype.MANY1=function(e){this.manyInternal(1,e)},e.prototype.MANY2=function(e){this.manyInternal(2,e)},e.prototype.MANY3=function(e){this.manyInternal(3,e)},e.prototype.MANY4=function(e){this.manyInternal(4,e)},e.prototype.MANY5=function(e){this.manyInternal(5,e)},e.prototype.MANY6=function(e){this.manyInternal(6,e)},e.prototype.MANY7=function(e){this.manyInternal(7,e)},e.prototype.MANY8=function(e){this.manyInternal(8,e)},e.prototype.MANY9=function(e){this.manyInternal(9,e)},e.prototype.MANY_SEP=function(e){this.manySepFirstInternal(0,e)},e.prototype.MANY_SEP1=function(e){this.manySepFirstInternal(1,e)},e.prototype.MANY_SEP2=function(e){this.manySepFirstInternal(2,e)},e.prototype.MANY_SEP3=function(e){this.manySepFirstInternal(3,e)},e.prototype.MANY_SEP4=function(e){this.manySepFirstInternal(4,e)},e.prototype.MANY_SEP5=function(e){this.manySepFirstInternal(5,e)},e.prototype.MANY_SEP6=function(e){this.manySepFirstInternal(6,e)},e.prototype.MANY_SEP7=function(e){this.manySepFirstInternal(7,e)},e.prototype.MANY_SEP8=function(e){this.manySepFirstInternal(8,e)},e.prototype.MANY_SEP9=function(e){this.manySepFirstInternal(9,e)},e.prototype.AT_LEAST_ONE=function(e){this.atLeastOneInternal(0,e)},e.prototype.AT_LEAST_ONE1=function(e){return this.atLeastOneInternal(1,e)},e.prototype.AT_LEAST_ONE2=function(e){this.atLeastOneInternal(2,e)},e.prototype.AT_LEAST_ONE3=function(e){this.atLeastOneInternal(3,e)},e.prototype.AT_LEAST_ONE4=function(e){this.atLeastOneInternal(4,e)},e.prototype.AT_LEAST_ONE5=function(e){this.atLeastOneInternal(5,e)},e.prototype.AT_LEAST_ONE6=function(e){this.atLeastOneInternal(6,e)},e.prototype.AT_LEAST_ONE7=function(e){this.atLeastOneInternal(7,e)},e.prototype.AT_LEAST_ONE8=function(e){this.atLeastOneInternal(8,e)},e.prototype.AT_LEAST_ONE9=function(e){this.atLeastOneInternal(9,e)},e.prototype.AT_LEAST_ONE_SEP=function(e){this.atLeastOneSepFirstInternal(0,e)},e.prototype.AT_LEAST_ONE_SEP1=function(e){this.atLeastOneSepFirstInternal(1,e)},e.prototype.AT_LEAST_ONE_SEP2=function(e){this.atLeastOneSepFirstInternal(2,e)},e.prototype.AT_LEAST_ONE_SEP3=function(e){this.atLeastOneSepFirstInternal(3,e)},e.prototype.AT_LEAST_ONE_SEP4=function(e){this.atLeastOneSepFirstInternal(4,e)},e.prototype.AT_LEAST_ONE_SEP5=function(e){this.atLeastOneSepFirstInternal(5,e)},e.prototype.AT_LEAST_ONE_SEP6=function(e){this.atLeastOneSepFirstInternal(6,e)},e.prototype.AT_LEAST_ONE_SEP7=function(e){this.atLeastOneSepFirstInternal(7,e)},e.prototype.AT_LEAST_ONE_SEP8=function(e){this.atLeastOneSepFirstInternal(8,e)},e.prototype.AT_LEAST_ONE_SEP9=function(e){this.atLeastOneSepFirstInternal(9,e)},e.prototype.RULE=function(e,t,n){if(void 0===n&&(n=I2),LZ(this.definedRulesNames,e)){var r={message:L1.buildDuplicateRuleNameError({topLevelRule:e,grammarName:this.className}),type:A2.DUPLICATE_RULE_NAME,ruleName:e};this.definitionErrors.push(r)}this.definedRulesNames.push(e);var i=this.defineRule(e,t,n);return this[e]=i,i},e.prototype.OVERRIDE_RULE=function(e,t,n){void 0===n&&(n=I2);var r,i,o,s,a,l=[];l=l.concat((r=e,i=this.definedRulesNames,o=this.className,a=[],LZ(i,r)||(s="Invalid rule override, rule: ->"+r+"<- cannot be overridden in the grammar: ->"+o+"<-as it is not defined in any of the super grammars ",a.push({message:s,type:A2.INVALID_RULE_OVERRIDE,ruleName:r})),a)),this.definitionErrors.push.apply(this.definitionErrors,l);var h=this.defineRule(e,t,n);return this[e]=h,h},e.prototype.BACKTRACK=function(e,t){return function(){this.isBackTrackingStack.push(1);var n=this.saveRecogState();try{return e.apply(this,t),!0}catch(r){if(j1(r))return!1;throw r}finally{this.reloadRecogState(n),this.isBackTrackingStack.pop()}}},e.prototype.getGAstProductions=function(){return this.gastProductionsCache},e.prototype.getSerializedGastProductions=function(){return CZ(vZ(this.gastProductionsCache),M0)},e}(),c2=function(){function e(){}return e.prototype.initRecognizerEngine=function(e,t){if(this.className=r2(this.constructor),this.shortRuleNameToFull={},this.fullRuleNameToShort={},this.ruleShortNameIdx=256,this.tokenMatcher=GJ,this.definedRulesNames=[],this.tokensMap={},this.allRuleNames=[],this.isBackTrackingStack=[],this.RULE_STACK=[],this.RULE_OCCURRENCE_STACK=[],this.gastProductionsCache={},_Z(t,"serializedGrammar"))throw Error("The Parser's configuration can no longer contain a <serializedGrammar> property.\n\tSee: https://sap.github.io/chevrotain/docs/changes/BREAKING_CHANGES.html#_6-0-0\n\tFor Further details.");if(BZ(e)){if(wZ(e))throw Error("A Token Vocabulary cannot be empty.\n\tNote that the first argument for the parser constructor\n\tis no longer a Token vector (since v4.0).");if("number"==typeof e[0].startOffset)throw Error("The Parser constructor no longer accepts a token vector as the first argument.\n\tSee: https://sap.github.io/chevrotain/docs/changes/BREAKING_CHANGES.html#_4-0-0\n\tFor Further details.")}if(BZ(e))this.tokensMap=DZ(e,(function(e,t){return e[t.name]=t,e}),{});else if(_Z(e,"modes")&&GZ(SZ(vZ(e.modes)),QJ)){var n=UZ(SZ(vZ(e.modes)));this.tokensMap=DZ(n,(function(e,t){return e[t.name]=t,e}),{})}else{if(!jZ(e))throw new Error("<tokensDictionary> argument must be An Array of Token constructors, A dictionary of Token constructors or an IMultiModeLexerDefinition");this.tokensMap=kZ(e)}this.tokensMap.EOF=p0;var r=GZ(vZ(e),(function(e){return wZ(e.categoryMatches)}));this.tokenMatcher=r?GJ:jJ,YJ(vZ(this.tokensMap))},e.prototype.defineRule=function(e,t,n){if(this.selfAnalysisDone)throw Error("Grammar rule <"+e+"> may not be defined after the 'performSelfAnalysis' method has been called'\nMake sure that all grammar rule definitions are done before 'performSelfAnalysis' is called.");var r,i=_Z(n,"resyncEnabled")?n.resyncEnabled:I2.resyncEnabled,o=_Z(n,"recoveryValueFunc")?n.recoveryValueFunc:I2.recoveryValueFunc,s=this.ruleShortNameIdx<<12;function a(e){try{if(!0===this.outputCst){t.apply(this,e);var n=this.CST_STACK[this.CST_STACK.length-1];return this.cstPostRule(n),n}return t.apply(this,e)}catch(r){return this.invokeRuleCatch(r,i,o)}finally{this.ruleFinallyStateUpdate()}}this.ruleShortNameIdx++,this.shortRuleNameToFull[s]=e,this.fullRuleNameToShort[e]=s;return(r=function(t,n){return void 0===t&&(t=0),this.ruleInvocationStateUpdate(s,e,t),a.call(this,n)}).ruleName=e,r.originalGrammarAction=t,r},e.prototype.invokeRuleCatch=function(e,t,n){var r=1===this.RULE_STACK.length,i=t&&!this.isBackTracking()&&this.recoveryEnabled;if(j1(e)){var o=e;if(i){var s,a=this.findReSyncTokenType();if(this.isInCurrentRuleReSyncSet(a))return o.resyncedTokens=this.reSyncTo(a),this.outputCst?((s=this.CST_STACK[this.CST_STACK.length-1]).recoveredNode=!0,s):n();throw this.outputCst&&((s=this.CST_STACK[this.CST_STACK.length-1]).recoveredNode=!0,o.partialCstResult=s),o}if(r)return this.moveToTerminatedState(),n();throw o}throw e},e.prototype.optionInternal=function(e,t){var n=this.getKeyForAutomaticLookahead(B0,t),r=this.nestedRuleBeforeClause(e,n);try{return this.optionInternalLogic(e,t,n)}finally{void 0!==r&&this.nestedRuleFinallyClause(n,r)}},e.prototype.optionInternalNoCst=function(e,t){var n=this.getKeyForAutomaticLookahead(B0,t);return this.optionInternalLogic(e,t,n)},e.prototype.optionInternalLogic=function(e,t,n){var r,i,o=this,s=this.getLaFuncFromCache(n);if(void 0!==e.DEF){if(r=e.DEF,void 0!==(i=e.GATE)){var a=s;s=function(){return i.call(o)&&a.call(o)}}}else r=e;if(!0===s.call(this))return r.call(this)},e.prototype.atLeastOneInternal=function(e,t){var n=this.getKeyForAutomaticLookahead(j0,e),r=this.nestedRuleBeforeClause(t,n);try{return this.atLeastOneInternalLogic(e,t,n)}finally{void 0!==r&&this.nestedRuleFinallyClause(n,r)}},e.prototype.atLeastOneInternalNoCst=function(e,t){var n=this.getKeyForAutomaticLookahead(j0,e);this.atLeastOneInternalLogic(e,t,n)},e.prototype.atLeastOneInternalLogic=function(e,t,n){var r,i,o=this,s=this.getLaFuncFromCache(n);if(void 0!==t.DEF){if(r=t.DEF,void 0!==(i=t.GATE)){var a=s;s=function(){return i.call(o)&&a.call(o)}}}else r=t;if(!0!==s.call(this))throw this.raiseEarlyExitException(e,h1.REPETITION_MANDATORY,t.ERR_MSG);for(var l=this.doSingleRepetition(r);!0===s.call(this)&&!0===l;)l=this.doSingleRepetition(r);this.attemptInRepetitionRecovery(this.atLeastOneInternal,[e,t],s,j0,e,i1)},e.prototype.atLeastOneSepFirstInternal=function(e,t){var n=this.getKeyForAutomaticLookahead(z0,e),r=this.nestedRuleBeforeClause(t,n);try{this.atLeastOneSepFirstInternalLogic(e,t,n)}finally{void 0!==r&&this.nestedRuleFinallyClause(n,r)}},e.prototype.atLeastOneSepFirstInternalNoCst=function(e,t){var n=this.getKeyForAutomaticLookahead(z0,e);this.atLeastOneSepFirstInternalLogic(e,t,n)},e.prototype.atLeastOneSepFirstInternalLogic=function(e,t,n){var r=this,i=t.DEF,o=t.SEP;if(!0!==this.getLaFuncFromCache(n).call(this))throw this.raiseEarlyExitException(e,h1.REPETITION_MANDATORY_WITH_SEPARATOR,t.ERR_MSG);i.call(this);for(var s=function(){return r.tokenMatcher(r.LA(1),o)};!0===this.tokenMatcher(this.LA(1),o);)this.CONSUME(o),i.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,o,s,i,o1],s,z0,e,o1)},e.prototype.manyInternal=function(e,t){var n=this.getKeyForAutomaticLookahead(W0,e),r=this.nestedRuleBeforeClause(t,n);try{return this.manyInternalLogic(e,t,n)}finally{void 0!==r&&this.nestedRuleFinallyClause(n,r)}},e.prototype.manyInternalNoCst=function(e,t){var n=this.getKeyForAutomaticLookahead(W0,e);return this.manyInternalLogic(e,t,n)},e.prototype.manyInternalLogic=function(e,t,n){var r,i,o=this,s=this.getLaFuncFromCache(n);if(void 0!==t.DEF){if(r=t.DEF,void 0!==(i=t.GATE)){var a=s;s=function(){return i.call(o)&&a.call(o)}}}else r=t;for(var l=!0;!0===s.call(this)&&!0===l;)l=this.doSingleRepetition(r);this.attemptInRepetitionRecovery(this.manyInternal,[e,t],s,W0,e,n1,l)},e.prototype.manySepFirstInternal=function(e,t){var n=this.getKeyForAutomaticLookahead(G0,e),r=this.nestedRuleBeforeClause(t,n);try{this.manySepFirstInternalLogic(e,t,n)}finally{void 0!==r&&this.nestedRuleFinallyClause(n,r)}},e.prototype.manySepFirstInternalNoCst=function(e,t){var n=this.getKeyForAutomaticLookahead(G0,e);this.manySepFirstInternalLogic(e,t,n)},e.prototype.manySepFirstInternalLogic=function(e,t,n){var r=this,i=t.DEF,o=t.SEP;if(!0===this.getLaFuncFromCache(n).call(this)){i.call(this);for(var s=function(){return r.tokenMatcher(r.LA(1),o)};!0===this.tokenMatcher(this.LA(1),o);)this.CONSUME(o),i.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,o,s,i,r1],s,G0,e,r1)}},e.prototype.repetitionSepSecondInternal=function(e,t,n,r,i){for(;n();)this.CONSUME(t),r.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,t,n,r,i],n,z0,e,i)},e.prototype.doSingleRepetition=function(e){var t=this.getLexerPosition();return e.call(this),this.getLexerPosition()>t},e.prototype.orInternalNoCst=function(e,t){var n=BZ(e)?e:e.DEF,r=this.getKeyForAutomaticLookahead(U0,t),i=this.getLaFuncFromCache(r).call(this,n);if(void 0!==i)return n[i].ALT.call(this);this.raiseNoAltException(t,e.ERR_MSG)},e.prototype.orInternal=function(e,t){var n=this.getKeyForAutomaticLookahead(U0,t),r=this.nestedRuleBeforeClause(e,n);try{var i=BZ(e)?e:e.DEF,o=this.getLaFuncFromCache(n).call(this,i);if(void 0!==o){var s=i[o],a=this.nestedAltBeforeClause(s,t,U0,o);try{return s.ALT.call(this)}finally{void 0!==a&&this.nestedRuleFinallyClause(a.shortName,a.nestedName)}}this.raiseNoAltException(t,e.ERR_MSG)}finally{void 0!==r&&this.nestedRuleFinallyClause(n,r)}},e.prototype.ruleFinallyStateUpdate=function(){if(this.RULE_STACK.pop(),this.RULE_OCCURRENCE_STACK.pop(),this.cstFinallyStateUpdate(),0===this.RULE_STACK.length&&!1===this.isAtEndOfInput()){var e=this.LA(1),t=this.errorMessageProvider.buildNotAllInputParsedMessage({firstRedundant:e,ruleName:this.getCurrRuleFullName()});this.SAVE_ERROR(new $1(t,e))}},e.prototype.subruleInternal=function(e,t,n){var r;try{var i=void 0!==n?n.ARGS:void 0;return r=e.call(this,t,i),this.cstPostNonTerminal(r,void 0!==n&&void 0!==n.LABEL?n.LABEL:e.ruleName),r}catch(o){this.subruleInternalError(o,n,e.ruleName)}},e.prototype.subruleInternalError=function(e,t,n){throw j1(e)&&void 0!==e.partialCstResult&&(this.cstPostNonTerminal(e.partialCstResult,void 0!==t&&void 0!==t.LABEL?t.LABEL:n),delete e.partialCstResult),e},e.prototype.consumeInternal=function(e,t,n){var r;try{var i=this.LA(1);!0===this.tokenMatcher(i,e)?(this.consumeToken(),r=i):this.consumeInternalError(e,i,n)}catch(o){r=this.consumeInternalRecovery(e,t,o)}return this.cstPostTerminal(void 0!==n&&void 0!==n.LABEL?n.LABEL:e.name,r),r},e.prototype.consumeInternalError=function(e,t,n){var r,i=this.LA(0);throw r=void 0!==n&&n.ERR_MSG?n.ERR_MSG:this.errorMessageProvider.buildMismatchTokenMessage({expected:e,actual:t,previous:i,ruleName:this.getCurrRuleFullName()}),this.SAVE_ERROR(new G1(r,t,i))},e.prototype.consumeInternalRecovery=function(e,t,n){if(!this.recoveryEnabled||"MismatchedTokenException"!==n.name||this.isBackTracking())throw n;var r=this.getFollowsForInRuleRecovery(e,t);try{return this.tryInRuleRecovery(e,r)}catch(i){throw i.name===X1?n:i}},e.prototype.saveRecogState=function(){var e=this.errors,t=HZ(this.RULE_STACK);return{errors:e,lexerState:this.exportLexerState(),RULE_STACK:t,CST_STACK:this.CST_STACK,LAST_EXPLICIT_RULE_STACK:this.LAST_EXPLICIT_RULE_STACK}},e.prototype.reloadRecogState=function(e){this.errors=e.errors,this.importLexerState(e.lexerState),this.RULE_STACK=e.RULE_STACK},e.prototype.ruleInvocationStateUpdate=function(e,t,n){this.RULE_OCCURRENCE_STACK.push(n),this.RULE_STACK.push(e),this.cstInvocationStateUpdate(t,e)},e.prototype.isBackTracking=function(){return 0!==this.isBackTrackingStack.length},e.prototype.getCurrRuleFullName=function(){var e=this.getLastExplicitRuleShortName();return this.shortRuleNameToFull[e]},e.prototype.shortRuleNameToFullName=function(e){return this.shortRuleNameToFull[e]},e.prototype.isAtEndOfInput=function(){return this.tokenMatcher(this.LA(1),p0)},e.prototype.reset=function(){this.resetLexerState(),this.isBackTrackingStack=[],this.errors=[],this.RULE_STACK=[],this.LAST_EXPLICIT_RULE_STACK=[],this.CST_STACK=[],this.RULE_OCCURRENCE_STACK=[]},e}(),d2=function(){function e(){}return e.prototype.initErrorHandler=function(e){this._errors=[],this.errorMessageProvider=XZ(e.errorMessageProvider,M2.errorMessageProvider)},e.prototype.SAVE_ERROR=function(e){if(j1(e))return e.context={ruleStack:this.getHumanReadableRuleStack(),ruleOccurrenceStack:HZ(this.RULE_OCCURRENCE_STACK)},this._errors.push(e),e;throw Error("Trying to save an Error which is not a RecognitionException")},Object.defineProperty(e.prototype,"errors",{get:function(){return HZ(this._errors)},set:function(e){this._errors=e},enumerable:!0,configurable:!0}),e.prototype.raiseEarlyExitException=function(e,t,n){for(var r=this.getCurrRuleFullName(),i=y1(e,this.getGAstProductions()[r],t,this.maxLookahead)[0],o=[],s=1;s<=this.maxLookahead;s++)o.push(this.LA(s));var a=this.errorMessageProvider.buildEarlyExitMessage({expectedIterationPaths:i,actual:o,previous:this.LA(0),customUserDescription:n,ruleName:r});throw this.SAVE_ERROR(new Y1(a,this.LA(1),this.LA(0)))},e.prototype.raiseNoAltException=function(e,t){for(var n=this.getCurrRuleFullName(),r=w1(e,this.getGAstProductions()[n],this.maxLookahead),i=[],o=1;o<=this.maxLookahead;o++)i.push(this.LA(o));var s=this.LA(0),a=this.errorMessageProvider.buildNoViableAltMessage({expectedPathsPerAlt:r,actual:i,previous:s,customUserDescription:t,ruleName:this.getCurrRuleFullName()});throw this.SAVE_ERROR(new z1(a,this.LA(1),s))},e}(),p2=function(){function e(){}return e.prototype.initContentAssist=function(){},e.prototype.computeContentAssist=function(e,t){var n=this.gastProductionsCache[e];if(NZ(n))throw Error("Rule ->"+e+"<- does not exist in this grammar.");return a1([n],t,this.tokenMatcher,this.maxLookahead)},e.prototype.getNextPossibleTokenTypes=function(e){var t=RZ(e.ruleStack),n=this.getGAstProductions()[t];return new e1(n,e).startWalking()},e}(),g2={description:"This Object indicates the Parser is during Recording Phase"};Object.freeze(g2);var m2=Math.pow(2,8)-1,f2=d0({name:"RECORDING_PHASE_TOKEN",pattern:e0.NA});YJ([f2]);var w2=g0(f2,"This IToken indicates the Parser is in Recording Phase\n\tSee: https://sap.github.io/chevrotain/docs/guide/internals.html#grammar-recording for details",-1,-1,-1,-1,-1,-1);Object.freeze(w2);var y2={name:"This CSTNode indicates the Parser is in Recording Phase\n\tSee: https://sap.github.io/chevrotain/docs/guide/internals.html#grammar-recording for details",children:{}},v2=function(){function e(){}return e.prototype.initGastRecorder=function(e){this.recordingProdStack=[],this.RECORDING_PHASE=!1},e.prototype.enableRecording=function(){var e=this;this.RECORDING_PHASE=!0,this.TRACE_INIT("Enable Recording",(function(){for(var t=function(t){var n=t>0?t:"";e["CONSUME"+n]=function(e,n){return this.consumeInternalRecord(e,t,n)},e["SUBRULE"+n]=function(e,n){return this.subruleInternalRecord(e,t,n)},e["OPTION"+n]=function(e){return this.optionInternalRecord(e,t)},e["OR"+n]=function(e){return this.orInternalRecord(e,t)},e["MANY"+n]=function(e){this.manyInternalRecord(t,e)},e["MANY_SEP"+n]=function(e){this.manySepFirstInternalRecord(t,e)},e["AT_LEAST_ONE"+n]=function(e){this.atLeastOneInternalRecord(t,e)},e["AT_LEAST_ONE_SEP"+n]=function(e){this.atLeastOneSepFirstInternalRecord(t,e)}},n=0;n<10;n++)t(n);e.consume=function(e,t,n){return this.consumeInternalRecord(t,e,n)},e.subrule=function(e,t,n){return this.subruleInternalRecord(t,e,n)},e.option=function(e,t){return this.optionInternalRecord(t,e)},e.or=function(e,t){return this.orInternalRecord(t,e)},e.many=function(e,t){this.manyInternalRecord(e,t)},e.atLeastOne=function(e,t){this.atLeastOneInternalRecord(e,t)},e.ACTION=e.ACTION_RECORD,e.BACKTRACK=e.BACKTRACK_RECORD,e.LA=e.LA_RECORD}))},e.prototype.disableRecording=function(){var e=this;this.RECORDING_PHASE=!1,this.TRACE_INIT("Deleting Recording methods",(function(){for(var t=0;t<10;t++){var n=t>0?t:"";delete e["CONSUME"+n],delete e["SUBRULE"+n],delete e["OPTION"+n],delete e["OR"+n],delete e["MANY"+n],delete e["MANY_SEP"+n],delete e["AT_LEAST_ONE"+n],delete e["AT_LEAST_ONE_SEP"+n]}delete e.consume,delete e.subrule,delete e.option,delete e.or,delete e.many,delete e.atLeastOne,delete e.ACTION,delete e.BACKTRACK,delete e.LA}))},e.prototype.ACTION_RECORD=function(e){},e.prototype.BACKTRACK_RECORD=function(e,t){return function(){return!0}},e.prototype.LA_RECORD=function(e){return N2},e.prototype.topLevelRuleRecord=function(e,t){try{var n=new v0({definition:[],name:e});return n.name=e,this.recordingProdStack.push(n),t.call(this),this.recordingProdStack.pop(),n}catch(r){if(!0!==r.KNOWN_RECORDER_ERROR)try{r.message=r.message+'\n\t This error was thrown during the "grammar recording phase" For more info see:\n\thttps://sap.github.io/chevrotain/docs/guide/internals.html#grammar-recording'}catch(i){throw r}throw r}},e.prototype.optionInternalRecord=function(e,t){return C2.call(this,S0,e,t)},e.prototype.atLeastOneInternalRecord=function(e,t){C2.call(this,R0,t,e)},e.prototype.atLeastOneSepFirstInternalRecord=function(e,t){C2.call(this,E0,t,e,true)},e.prototype.manyInternalRecord=function(e,t){C2.call(this,b0,t,e)},e.prototype.manySepFirstInternalRecord=function(e,t){C2.call(this,T0,t,e,true)},e.prototype.orInternalRecord=function(e,t){return S2.call(this,e,t)},e.prototype.subruleInternalRecord=function(e,t,n){if(E2(t),!e||!1===_Z(e,"ruleName")){var r=new Error("<SUBRULE"+R2(t)+"> argument is invalid expecting a Parser method reference but got: <"+JSON.stringify(e)+">\n inside top level rule: <"+this.recordingProdStack[0].name+">");throw r.KNOWN_RECORDER_ERROR=!0,r}var i=iJ(this.recordingProdStack),o=e.ruleName,s=new y0({idx:t,nonTerminalName:o,referencedRule:void 0});return i.definition.push(s),this.outputCst?y2:g2},e.prototype.consumeInternalRecord=function(e,t,n){if(E2(t),!XJ(e)){var r=new Error("<CONSUME"+R2(t)+"> argument is invalid expecting a TokenType reference but got: <"+JSON.stringify(e)+">\n inside top level rule: <"+this.recordingProdStack[0].name+">");throw r.KNOWN_RECORDER_ERROR=!0,r}var i=iJ(this.recordingProdStack),o=new A0({idx:t,terminalType:e});return i.definition.push(o),w2},e}();function C2(e,t,n,r){void 0===r&&(r=!1),E2(n);var i=iJ(this.recordingProdStack),o=AZ(t)?t:t.DEF,s=new e({definition:[],idx:n});return _Z(t,"NAME")&&(s.name=t.NAME),r&&(s.separator=t.SEP),_Z(t,"MAX_LOOKAHEAD")&&(s.maxLookahead=t.MAX_LOOKAHEAD),this.recordingProdStack.push(s),o.call(this),i.definition.push(s),this.recordingProdStack.pop(),g2}function S2(e,t){var n=this;E2(t);var r=iJ(this.recordingProdStack),i=!1===BZ(e),o=!1===i?e:e.DEF,s=new N0({definition:[],idx:t,ignoreAmbiguities:i&&!0===e.IGNORE_AMBIGUITIES});_Z(e,"NAME")&&(s.name=e.NAME),_Z(e,"MAX_LOOKAHEAD")&&(s.maxLookahead=e.MAX_LOOKAHEAD);var a=$Z(o,(function(e){return AZ(e.GATE)}));return s.hasPredicates=a,r.definition.push(s),bZ(o,(function(e){var t=new C0({definition:[]});s.definition.push(t),_Z(e,"NAME")&&(t.name=e.NAME),_Z(e,"IGNORE_AMBIGUITIES")?t.ignoreAmbiguities=e.IGNORE_AMBIGUITIES:_Z(e,"GATE")&&(t.ignoreAmbiguities=!0),n.recordingProdStack.push(t),e.ALT.call(n),n.recordingProdStack.pop()})),g2}function R2(e){return 0===e?"":""+e}function E2(e){if(e<0||e>m2){var t=new Error("Invalid DSL Method idx value: <"+e+">\n\tIdx value must be a none negative value smaller than "+(m2+1));throw t.KNOWN_RECORDER_ERROR=!0,t}}var b2=function(){function e(){}return e.prototype.initPerformanceTracer=function(e){if(_Z(e,"traceInitPerf")){var t=e.traceInitPerf,n="number"==typeof t;this.traceInitMaxIdent=n?t:1/0,this.traceInitPerf=n?t>0:t}else this.traceInitMaxIdent=0,this.traceInitPerf=M2.traceInitPerf;this.traceInitIndent=-1},e.prototype.TRACE_INIT=function(e,t){if(!0===this.traceInitPerf){this.traceInitIndent++;var n=new Array(this.traceInitIndent+1).join("\t");this.traceInitIndent<this.traceInitMaxIdent&&console.log(n+"--\x3e <"+e+">");var r=oJ(t),i=r.time,o=r.value,s=i>10?console.warn:console.log;return this.traceInitIndent<this.traceInitMaxIdent&&s(n+"<-- <"+e+"> time: "+i+"ms"),this.traceInitIndent--,o}return t()},e}(),T2=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),N2=g0(p0,"",NaN,NaN,NaN,NaN,NaN,NaN);Object.freeze(N2);var A2,M2=Object.freeze({recoveryEnabled:!1,maxLookahead:4,ignoredIssues:{},dynamicTokensEnabled:!1,outputCst:!0,errorMessageProvider:P1,nodeLocationTracking:"none",traceInitPerf:!1,skipValidations:!1}),I2=Object.freeze({recoveryValueFunc:function(){},resyncEnabled:!0});!function(e){e[e.INVALID_RULE_NAME=0]="INVALID_RULE_NAME",e[e.DUPLICATE_RULE_NAME=1]="DUPLICATE_RULE_NAME",e[e.INVALID_RULE_OVERRIDE=2]="INVALID_RULE_OVERRIDE",e[e.DUPLICATE_PRODUCTIONS=3]="DUPLICATE_PRODUCTIONS",e[e.UNRESOLVED_SUBRULE_REF=4]="UNRESOLVED_SUBRULE_REF",e[e.LEFT_RECURSION=5]="LEFT_RECURSION",e[e.NONE_LAST_EMPTY_ALT=6]="NONE_LAST_EMPTY_ALT",e[e.AMBIGUOUS_ALTS=7]="AMBIGUOUS_ALTS",e[e.CONFLICT_TOKENS_RULES_NAMESPACE=8]="CONFLICT_TOKENS_RULES_NAMESPACE",e[e.INVALID_TOKEN_NAME=9]="INVALID_TOKEN_NAME",e[e.INVALID_NESTED_RULE_NAME=10]="INVALID_NESTED_RULE_NAME",e[e.DUPLICATE_NESTED_NAME=11]="DUPLICATE_NESTED_NAME",e[e.NO_NON_EMPTY_LOOKAHEAD=12]="NO_NON_EMPTY_LOOKAHEAD",e[e.AMBIGUOUS_PREFIX_ALTS=13]="AMBIGUOUS_PREFIX_ALTS",e[e.TOO_MANY_ALTS=14]="TOO_MANY_ALTS"}(A2||(A2={}));var O2,x2=function(){function e(e,t){void 0===t&&(t=M2),this.ignoredIssues=M2.ignoredIssues,this.definitionErrors=[],this.selfAnalysisDone=!1;var n=this;n.initErrorHandler(t),n.initLexerAdapter(),n.initLooksAhead(t),n.initRecognizerEngine(e,t),n.initRecoverable(t),n.initTreeBuilder(t),n.initContentAssist(),n.initGastRecorder(t),n.initPerformanceTracer(t),_Z(t,"ignoredIssues")&&t.ignoredIssues!==M2.ignoredIssues&&tJ("The <ignoredIssues> IParserConfig property is soft-deprecated and will be removed in future versions.\n\tPlease use the <IGNORE_AMBIGUITIES> flag on the relevant DSL method instead."),this.ignoredIssues=_Z(t,"ignoredIssues")?t.ignoredIssues:M2.ignoredIssues,this.skipValidations=_Z(t,"skipValidations")?t.skipValidations:M2.skipValidations}return e.performSelfAnalysis=function(e){e.performSelfAnalysis()},e.prototype.performSelfAnalysis=function(){var t=this;this.TRACE_INIT("performSelfAnalysis",(function(){var n;t.selfAnalysisDone=!0;var r=t.className;t.TRACE_INIT("toFastProps",(function(){rJ(t)})),t.TRACE_INIT("Grammar Recording",(function(){try{t.enableRecording(),bZ(t.definedRulesNames,(function(e){var n=t[e].originalGrammarAction,r=void 0;t.TRACE_INIT(e+" Rule",(function(){r=t.topLevelRuleRecord(e,n)})),t.gastProductionsCache[e]=r}))}finally{t.disableRecording()}}));var i=[];if(t.TRACE_INIT("Grammar Resolving",(function(){i=F1({rules:vZ(t.gastProductionsCache)}),t.definitionErrors.push.apply(t.definitionErrors,i)})),t.TRACE_INIT("Grammar Validations",(function(){if(wZ(i)&&!1===t.skipValidations){var e=R1((n=XZ(n={rules:vZ(t.gastProductionsCache),maxLookahead:t.maxLookahead,tokenTypes:vZ(t.tokensMap),ignoredIssues:t.ignoredIssues,errMsgProvider:L1,grammarName:r},{errMsgProvider:L1,ignoredIssues:{}})).rules,n.maxLookahead,n.tokenTypes,n.ignoredIssues,n.errMsgProvider,n.grammarName);t.definitionErrors.push.apply(t.definitionErrors,e)}var n})),wZ(t.definitionErrors)&&(t.recoveryEnabled&&t.TRACE_INIT("computeAllProdsFollows",(function(){var e,n,r=(e=vZ(t.gastProductionsCache),n={},bZ(e,(function(e){var t=new V0(e).startWalking();YZ(n,t)})),n);t.resyncFollows=r})),t.TRACE_INIT("ComputeLookaheadFunctions",(function(){t.preComputeLookaheadFunctions(vZ(t.gastProductionsCache))}))),t.TRACE_INIT("expandAllNestedRuleNames",(function(){var e,n,r,i=(e=vZ(t.gastProductionsCache),n=t.fullRuleNameToShort,r={allRuleNames:[]},bZ(e,(function(e){var t=n[e.name];r.allRuleNames.push(e.name);var i=new Z0(t);e.accept(i),bZ(i.result,(function(t){t.def,t.key;var n=t.name;r.allRuleNames.push(e.name+n)}))})),r);t.allRuleNames=i.allRuleNames})),!e.DEFER_DEFINITION_ERRORS_HANDLING&&!wZ(t.definitionErrors))throw n=CZ(t.definitionErrors,(function(e){return e.message})),new Error("Parser Definition Errors detected:\n "+n.join("\n-------------------------------\n"))}))},e.DEFER_DEFINITION_ERRORS_HANDLING=!1,e}();O2=x2,[Q1,J1,l2,h2,c2,u2,d2,p2,v2,b2].forEach((function(e){var t=e.prototype;Object.getOwnPropertyNames(t).forEach((function(n){if("constructor"!==n){var r=Object.getOwnPropertyDescriptor(t,n);r&&(r.get||r.set)?Object.defineProperty(O2.prototype,n,r):O2.prototype[n]=e.prototype[n]}}))})),function(e){function t(t,n){void 0===n&&(n=M2);var r=kZ(n);return r.outputCst=!0,e.call(this,t,r)||this}T2(t,e)}(x2);var P2=function(e){function t(t,n){void 0===n&&(n=M2);var r=kZ(n);return r.outputCst=!1,e.call(this,t,r)||this}return T2(t,e),t}(x2);
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */const _2=(e,t)=>({type:e,message:t});var L2,H2,k2;!function(e){e.LexingError="LexingError",e.ParserError="ParsingError",e.StaticOffsetError="StaticOffsetError",e.StaticOffsetOutOfRangeError="StaticOffsetOutOfRangeError",e.RangeOffsetNotAllowed="RangeOffsetNotAllowed",e.InvalidRangeSize="InvalidRangeSize"}(L2||(L2={})),function(e){e.EMPTY="EMPTY",e.NUMBER="NUMBER",e.STRING="STRING",e.MINUS_UNARY_OP="MINUS_UNARY_OP",e.PLUS_UNARY_OP="PLUS_UNARY_OP",e.PERCENT_OP="PERCENT_OP",e.CONCATENATE_OP="CONCATENATE_OP",e.EQUALS_OP="EQUALS_OP",e.NOT_EQUAL_OP="NOT_EQUAL_OP",e.GREATER_THAN_OP="GREATER_THAN_OP",e.LESS_THAN_OP="LESS_THAN_OP",e.GREATER_THAN_OR_EQUAL_OP="GREATER_THAN_OR_EQUAL_OP",e.LESS_THAN_OR_EQUAL_OP="LESS_THAN_OR_EQUAL_OP",e.PLUS_OP="PLUS_OP",e.MINUS_OP="MINUS_OP",e.TIMES_OP="TIMES_OP",e.DIV_OP="DIV_OP",e.POWER_OP="POWER_OP",e.FUNCTION_CALL="FUNCTION_CALL",e.NAMED_EXPRESSION="NAMED_EXPRESSION",e.PARENTHESIS="PARENTHESES",e.CELL_REFERENCE="CELL_REFERENCE",e.CELL_RANGE="CELL_RANGE",e.COLUMN_RANGE="COLUMN_RANGE",e.ROW_RANGE="ROW_RANGE",e.ERROR="ERROR",e.ERROR_WITH_RAW_INPUT="ERROR_WITH_RAW_INPUT",e.ARRAY="ARRAY"}(H2||(H2={})),function(e){e[e.RELATIVE=0]="RELATIVE",e[e.START_ABSOLUTE=1]="START_ABSOLUTE",e[e.BOTH_ABSOLUTE=2]="BOTH_ABSOLUTE"}(k2||(k2={}));const F2=(e,t)=>({type:H2.CELL_REFERENCE,reference:e,leadingWhitespace:null==t?void 0:t.image}),D2=(e,t,n,r)=>(j2(e,t,n),{type:H2.CELL_RANGE,start:e,end:t,sheetReferenceType:n,leadingWhitespace:r}),V2=(e,t,n)=>({type:H2.ARRAY,args:e,leadingWhitespace:null==t?void 0:t.image,internalWhitespace:null==n?void 0:n.image}),U2=(e,t)=>({type:H2.ERROR,error:e,leadingWhitespace:null==t?void 0:t.image}),B2=(e,t,n)=>({type:H2.ERROR_WITH_RAW_INPUT,error:t,rawInput:e,leadingWhitespace:null==n?void 0:n.image}),W2=()=>({type:H2.ERROR,error:C4.parsingError()});function j2(e,t,n){if(void 0!==e.sheet&&void 0===t.sheet||void 0===e.sheet&&void 0!==t.sheet)throw new Error("Start address inconsistent with end address");if(void 0===e.sheet&&n!==k2.RELATIVE||void 0!==e.sheet&&n===k2.RELATIVE)throw new Error("Sheet address inconsistent with sheet reference type")}function G2(e,t){return(null!=t?t:"")+e}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */const z2={[H2.PLUS_OP]:"+",[H2.MINUS_OP]:"-",[H2.TIMES_OP]:"*",[H2.DIV_OP]:"/",[H2.CONCATENATE_OP]:"&",[H2.POWER_OP]:"^",[H2.EQUALS_OP]:"=",[H2.NOT_EQUAL_OP]:"<>",[H2.GREATER_THAN_OP]:">",[H2.GREATER_THAN_OR_EQUAL_OP]:">=",[H2.LESS_THAN_OP]:"<",[H2.LESS_THAN_OR_EQUAL_OP]:"<="};
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class $2{constructor(e){this.functionRegistry=e,this.cache=new Map}set(e,t){const n=((e,t,n,r)=>({ast:e,relativeDependencies:t,hasVolatileFunction:n,hasStructuralChangeFunction:r}))(t,P3(t,this.functionRegistry),Y2(t,this.functionRegistry.isFunctionVolatile),Y2(t,this.functionRegistry.isFunctionDependentOnSheetStructureChange));return this.cache.set(e,n),n}get(e){return this.cache.get(e)}maybeSetAndThenGet(e,t){const n=this.cache.get(e);return void 0!==n?n.ast:(this.set(e,t),t)}}const Y2=(e,t)=>{switch(e.type){case H2.EMPTY:case H2.NUMBER:case H2.STRING:case H2.ERROR:case H2.ERROR_WITH_RAW_INPUT:case H2.CELL_REFERENCE:case H2.CELL_RANGE:case H2.COLUMN_RANGE:case H2.ROW_RANGE:case H2.NAMED_EXPRESSION:return!1;case H2.PERCENT_OP:case H2.PLUS_UNARY_OP:case H2.MINUS_UNARY_OP:return Y2(e.value,t);case H2.CONCATENATE_OP:case H2.EQUALS_OP:case H2.NOT_EQUAL_OP:case H2.LESS_THAN_OP:case H2.GREATER_THAN_OP:case H2.LESS_THAN_OR_EQUAL_OP:case H2.GREATER_THAN_OR_EQUAL_OP:case H2.MINUS_OP:case H2.PLUS_OP:case H2.TIMES_OP:case H2.DIV_OP:case H2.POWER_OP:return Y2(e.left,t)||Y2(e.right,t);case H2.PARENTHESIS:return Y2(e.expression,t);case H2.FUNCTION_CALL:return!!t(e.procedureName)||e.args.some((e=>Y2(e,t)));case H2.ARRAY:return e.args.some((e=>e.some((e=>Y2(e,t)))))}};
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class K2{}K2.DistinctSigns="Distinct signs.",K2.WrongArgNumber="Wrong number of arguments.",K2.EmptyArg="Empty function argument.",K2.EmptyArray="Empty array not allowed.",K2.ArrayDimensions="Array dimensions are not compatible.",K2.NoSpaceForArrayResult="No space for array result.",K2.ValueSmall="Value too small.",K2.ValueLarge="Value too large.",K2.BadCriterion="Incorrect criterion.",K2.RangeManySheets="Range spans more than one sheet.",K2.CellRangeExpected="Cell range expected.",K2.WrongDimension="Wrong range dimension.",K2.ScalarExpected="Cell range not allowed.",K2.NumberCoercion="Value cannot be coerced to number.",K2.NumberExpected="Number argument expected.",K2.IntegerExpected="Value needs to be an integer.",K2.BadMode="Mode not recognized.",K2.DateBounds="Date outside of bounds.",K2.OutOfSheet="Resulting reference is out of the sheet.",K2.WrongType="Wrong type of argument.",K2.NaN="NaN or infinite value encountered.",K2.EqualLength="Ranges need to be of equal length.",K2.Negative="Value cannot be negative.",K2.NotBinary="String does not represent a binary number.",K2.NotOctal="String does not represent an octal number.",K2.NotHex="String does not represent a hexadecimal number.",K2.EndStartPeriod="End period needs to be at least start period.",K2.CellRefExpected="Cell reference expected.",K2.EmptyRange="Empty range not allowed.",K2.BadRef="Address is not correct.",K2.NumberRange="Number-only range expected.",K2.ValueNotFound="Value not found.",K2.ValueBaseLarge="Value in base too large.",K2.ValueBaseSmall="Value in base too small.",K2.ValueBaseLong="Value in base too long.",K2.NegativeLength="Length cannot be negative.",K2.PatternNotFound="Pattern not found.",K2.OneValue="Needs at least one value.",K2.TwoValues="Range needs to contain at least two elements.",K2.ThreeValues="Range needs to contain at least three elements.",K2.IndexBounds="Index out of bounds.",K2.IndexLarge="Index too large.",K2.Formula="Expected formula.",K2.NegativeCount="Count cannot be negative.",K2.ParseError="Parsing error.",K2.SheetRef="Sheet does not exist.",K2.PeriodLong="Period number cannot exceed life length.",K2.InvalidDate="Invalid date.",K2.BitshiftLong="Result of bitshift is too long.",K2.EmptyString="Empty-string argument not allowed.",K2.LengthBounds="Length out of bounds.",K2.NegativeTime="Time cannot be negative.",K2.NoDefault="No default option.",K2.NoConditionMet="None of the conditions were met.",K2.Selector="Selector cannot exceed the number of arguments.",K2.StartEndDate="Start date needs to be earlier than end date.",K2.IncorrectDateTime="String does not represent correct DateTime.",K2.CharacterCodeBounds="Character code out of bounds.",K2.NonZero="Argument cannot be 0.",K2.LessThanOne="Argument cannot be less than 1.",K2.WeekendString="Incorrect weekend bitmask string.",K2.InvalidRoman="Invalid roman numeral.",K2.WrongOrder="Wrong order of values.",K2.ComplexNumberExpected="Complex number expected.",K2.ShouldBeIorJ="Should be 'i' or 'j'.",K2.SizeMismatch="Array dimensions mismatched.",K2.FunctionName=e=>`Function name ${e} not recognized.`,K2.NamedExpressionName=e=>`Named expression ${e} not recognized.`,K2.LicenseKey=e=>`License key is ${e}.`
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */;
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
const X2=d0({name:"AdditionOp",pattern:e0.NA}),q2=d0({name:"PlusOp",pattern:/\+/,categories:X2}),Q2=d0({name:"MinusOp",pattern:/-/,categories:X2}),Z2=d0({name:"MultiplicationOp",pattern:e0.NA}),J2=d0({name:"TimesOp",pattern:/\*/,categories:Z2}),e3=d0({name:"DivOp",pattern:/\//,categories:Z2}),t3=d0({name:"PowerOp",pattern:/\^/}),n3=d0({name:"PercentOp",pattern:/%/}),r3=d0({name:"BooleanOp",pattern:e0.NA}),i3=d0({name:"EqualsOp",pattern:/=/,categories:r3}),o3=d0({name:"NotEqualOp",pattern:/<>/,categories:r3}),s3=d0({name:"GreaterThanOp",pattern:/>/,categories:r3}),a3=d0({name:"LessThanOp",pattern:/</,categories:r3}),l3=d0({name:"GreaterThanOrEqualOp",pattern:/>=/,categories:r3}),h3=d0({name:"LessThanOrEqualOp",pattern:/<=/,categories:r3}),u3=d0({name:"ConcatenateOp",pattern:/&/}),c3=d0({name:"LParen",pattern:/\(/}),d3=d0({name:"RParen",pattern:/\)/}),p3=d0({name:"ArrayLParen",pattern:/{/}),g3=d0({name:"ArrayRParen",pattern:/}/}),m3=d0({name:"StringLiteral",pattern:/"([^"\\]*(\\.[^"\\]*)*)"/}),f3=d0({name:"ErrorLiteral",pattern:/#[A-Za-z0-9\/]+[?!]?/}),w3=d0({name:"RangeSeparator",pattern:new RegExp(GQ)}),y3=d0({name:"ColumnRange",pattern:new RegExp(`${QQ}${GQ}${QQ}`)}),v3=d0({name:"RowRange",pattern:new RegExp(`${ZQ}${GQ}${ZQ}`)}),C3=d0({name:"ProcedureName",pattern:new RegExp(`([${$Q}][${YQ}]*)\\(`)}),S3=new class{constructor(){this.POSSIBLE_START_CHARACTERS=[...rZ,...nZ,zQ,"'","_"],this.cellReferenceRegexp=new RegExp(eZ,"y")}match(e,t){this.cellReferenceRegexp.lastIndex=t;const n=this.cellReferenceRegexp.exec(e+"@");return null==n||null==n[1]?null:(n[0]=n[1],n)}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */,R3=d0({name:"CellReference",pattern:S3.match.bind(S3),start_chars_hint:S3.POSSIBLE_START_CHARACTERS,line_breaks:!1}),E3=new class{constructor(){this.POSSIBLE_START_CHARACTERS=[...rZ,"_"],this.namedExpressionRegexp=new RegExp(tZ,"y"),this.r1c1CellRefRegexp=new RegExp(`^${JQ}$`)}match(e,t){this.namedExpressionRegexp.lastIndex=t;const n=this.namedExpressionRegexp.exec(e);return null==n||null==n[0]||this.r1c1CellRefRegexp.test(n[0])?null:n}},b3=d0({name:"NamedExpression",pattern:E3.match.bind(E3),start_chars_hint:E3.POSSIBLE_START_CHARACTERS,line_breaks:!1}),T3=e=>{const t=e.translationPackage.getFunctionTranslation("OFFSET"),n=e.errorMapping,r=e.translationPackage.buildFunctionMapping(),i=d0({name:"WhiteSpace",pattern:new RegExp("standard"===e.ignoreWhiteSpace?"[ \\t\\n\\r]+":"\\s+")}),o=d0({name:"ArrayRowSep",pattern:e.arrayRowSeparator}),s=d0({name:"ArrayColSep",pattern:e.arrayColumnSeparator}),a=d0({name:"NumberLiteral",pattern:new RegExp(`(([${e.decimalSeparator}]\\d+)|(\\d+([${e.decimalSeparator}]\\d*)?))(e[+-]?\\d+)?`)}),l=d0({name:"OffsetProcedureName",pattern:new RegExp(t,"i")});let h,u;e.functionArgSeparator===e.arrayColumnSeparator?(h=s,u=[]):e.functionArgSeparator===e.arrayRowSeparator?(h=o,u=[]):(h=d0({name:"ArgSeparator",pattern:e.functionArgSeparator}),u=[h]);return{ArgSeparator:h,NumberLiteral:a,OffsetProcedureName:l,ArrayRowSeparator:o,ArrayColSeparator:s,WhiteSpace:i,allTokens:[i,q2,Q2,J2,e3,t3,i3,o3,n3,l3,h3,s3,a3,c3,d3,p3,g3,l,C3,w3,...u,y3,v3,a,m3,f3,u3,r3,X2,Z2,R3,b3,o,s],errorMapping:n,functionMapping:r,decimalSeparator:e.decimalSeparator,maxColumns:e.maxColumns,maxRows:e.maxRows}};
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
class N3 extends P2{constructor(e,t){super(e.allTokens,{outputCst:!1,maxLookahead:7}),this.booleanExpressionOrEmpty=this.RULE("booleanExpressionOrEmpty",(()=>{return this.OR([{ALT:()=>this.SUBRULE(this.booleanExpression)},{ALT:(e={type:H2.EMPTY,leadingWhitespace:null==t?void 0:t.image},void 0===e&&(e=void 0),function(){return e})}]);var e,t})),this.procedureExpression=this.RULE("procedureExpression",(()=>{var e;const t=this.CONSUME(C3),n=t.image.toUpperCase().slice(0,-1),r=null!==(e=this.lexerConfig.functionMapping[n])&&void 0!==e?e:n,i=[];let o=this.SUBRULE(this.booleanExpressionOrEmpty);this.MANY((()=>{var e;const t=this.CONSUME(this.lexerConfig.ArgSeparator);o.type===H2.EMPTY&&(o.leadingWhitespace=null===(e=t.leadingWhitespace)||void 0===e?void 0:e.image),i.push(o),o=this.SUBRULE2(this.booleanExpressionOrEmpty)})),i.push(o),1===i.length&&i[0].type===H2.EMPTY&&(i.length=0);const s=this.CONSUME(d3);return((e,t,n,r,i)=>({type:H2.FUNCTION_CALL,procedureName:e,args:t,leadingWhitespace:null==n?void 0:n.image,internalWhitespace:null==r?void 0:r.image,hyperlink:i}))(r,i,t.leadingWhitespace,s.leadingWhitespace)})),this.namedExpressionExpression=this.RULE("namedExpressionExpression",(()=>{const e=this.CONSUME(b3);return t=e.image,n=e.leadingWhitespace,{type:H2.NAMED_EXPRESSION,expressionName:t,leadingWhitespace:null==n?void 0:n.image};var t,n})),this.offsetProcedureExpression=this.RULE("offsetProcedureExpression",(()=>{const e=[];return this.CONSUME(this.lexerConfig.OffsetProcedureName),this.CONSUME(c3),this.MANY_SEP({SEP:this.lexerConfig.ArgSeparator,DEF:()=>{e.push(this.SUBRULE(this.booleanExpression))}}),this.CONSUME(d3),this.handleOffsetHeuristic(e)})),this.columnRangeExpression=this.RULE("columnRangeExpression",(()=>{const e=this.CONSUME(y3),[t,n]=e.image.split(":"),r=this.ACTION((()=>hZ(this.sheetMapping,t,this.formulaAddress))),i=this.ACTION((()=>hZ(this.sheetMapping,n,this.formulaAddress)));if(void 0===r||void 0===i)return U2(new C4(t4.REF));if(r.exceedsSheetSizeLimits(this.lexerConfig.maxColumns)||i.exceedsSheetSizeLimits(this.lexerConfig.maxColumns))return B2(e.image,new C4(t4.NAME),e.leadingWhitespace);if(void 0===r.sheet&&void 0!==i.sheet)return this.parsingError(L2.ParserError,"Malformed range expression");const{firstEnd:o,secondEnd:s,sheetRefType:a}=N3.fixSheetIdsForRangeEnds(r,i);return l=o,h=s,u=a,c=e.leadingWhitespace,j2(l,h,u),{type:H2.COLUMN_RANGE,start:l,end:h,sheetReferenceType:u,leadingWhitespace:null==c?void 0:c.image};var l,h,u,c})),this.rowRangeExpression=this.RULE("rowRangeExpression",(()=>{const e=this.CONSUME(v3),[t,n]=e.image.split(":"),r=this.ACTION((()=>uZ(this.sheetMapping,t,this.formulaAddress))),i=this.ACTION((()=>uZ(this.sheetMapping,n,this.formulaAddress)));if(void 0===r||void 0===i)return U2(new C4(t4.REF));if(r.exceedsSheetSizeLimits(this.lexerConfig.maxRows)||i.exceedsSheetSizeLimits(this.lexerConfig.maxRows))return B2(e.image,new C4(t4.NAME),e.leadingWhitespace);if(void 0===r.sheet&&void 0!==i.sheet)return this.parsingError(L2.ParserError,"Malformed range expression");const{firstEnd:o,secondEnd:s,sheetRefType:a}=N3.fixSheetIdsForRangeEnds(r,i);return l=o,h=s,u=a,c=e.leadingWhitespace,j2(l,h,u),{type:H2.ROW_RANGE,start:l,end:h,sheetReferenceType:u,leadingWhitespace:null==c?void 0:c.image};var l,h,u,c})),this.cellReference=this.RULE("cellReference",(()=>{const e=this.CONSUME(R3),t=this.ACTION((()=>lZ(this.sheetMapping,e.image,this.formulaAddress)));return void 0===t?B2(e.image,new C4(t4.REF),e.leadingWhitespace):t.exceedsSheetSizeLimits(this.lexerConfig.maxColumns,this.lexerConfig.maxRows)?B2(e.image,new C4(t4.NAME),e.leadingWhitespace):F2(t,e.leadingWhitespace)})),this.endRangeReference=this.RULE("endRangeReference",(e=>{var t;const n=this.CONSUME(R3),r=this.ACTION((()=>lZ(this.sheetMapping,e.image,this.formulaAddress))),i=this.ACTION((()=>lZ(this.sheetMapping,n.image,this.formulaAddress)));return void 0===r||void 0===i?this.ACTION((()=>B2(`${e.image}:${n.image}`,new C4(t4.REF),e.leadingWhitespace))):r.exceedsSheetSizeLimits(this.lexerConfig.maxColumns,this.lexerConfig.maxRows)||i.exceedsSheetSizeLimits(this.lexerConfig.maxColumns,this.lexerConfig.maxRows)?this.ACTION((()=>B2(`${e.image}:${n.image}`,new C4(t4.NAME),e.leadingWhitespace))):this.buildCellRange(r,i,null===(t=e.leadingWhitespace)||void 0===t?void 0:t.image)})),this.endOfRangeExpression=this.RULE("endOfRangeExpression",(e=>this.OR([{ALT:()=>this.SUBRULE(this.endRangeReference,{ARGS:[e]})},{ALT:()=>{var t;const n=this.SUBRULE(this.offsetProcedureExpression),r=this.ACTION((()=>lZ(this.sheetMapping,e.image,this.formulaAddress)));return void 0===r?U2(new C4(t4.REF)):n.type===H2.CELL_REFERENCE?this.buildCellRange(r,n.reference,null===(t=e.leadingWhitespace)||void 0===t?void 0:t.image):this.parsingError(L2.RangeOffsetNotAllowed,"Range offset not allowed here")}}]))),this.cellRangeExpression=this.RULE("cellRangeExpression",(()=>{const e=this.CONSUME(R3);return this.CONSUME2(w3),this.SUBRULE(this.endOfRangeExpression,{ARGS:[e]})})),this.endRangeWithOffsetStartReference=this.RULE("endRangeWithOffsetStartReference",(e=>{const t=this.CONSUME(R3),n=this.ACTION((()=>lZ(this.sheetMapping,t.image,this.formulaAddress)));return void 0===n?this.ACTION((()=>U2(new C4(t4.REF)))):this.buildCellRange(e.reference,n,e.leadingWhitespace)})),this.endOfRangeWithOffsetStartExpression=this.RULE("endOfRangeWithOffsetStartExpression",(e=>this.OR([{ALT:()=>this.SUBRULE(this.endRangeWithOffsetStartReference,{ARGS:[e]})},{ALT:()=>{const t=this.SUBRULE(this.offsetProcedureExpression);return t.type===H2.CELL_REFERENCE?this.buildCellRange(e.reference,t.reference,e.leadingWhitespace):this.parsingError(L2.RangeOffsetNotAllowed,"Range offset not allowed here")}}]))),this.offsetExpression=this.RULE("offsetExpression",(()=>{const e=this.SUBRULE(this.offsetProcedureExpression);let t;return this.OPTION((()=>{this.CONSUME(w3),t=e.type===H2.CELL_RANGE?this.parsingError(L2.RangeOffsetNotAllowed,"Range offset not allowed here"):this.SUBRULE(this.endOfRangeWithOffsetStartExpression,{ARGS:[e]})})),void 0!==t?t:e})),this.insideArrayExpression=this.RULE("insideArrayExpression",(()=>{const e=[[]];return e[e.length-1].push(this.SUBRULE(this.booleanExpression)),this.MANY((()=>{this.OR([{ALT:()=>{this.CONSUME(this.lexerConfig.ArrayColSeparator),e[e.length-1].push(this.SUBRULE2(this.booleanExpression))}},{ALT:()=>{this.CONSUME(this.lexerConfig.ArrayRowSeparator),e.push([]),e[e.length-1].push(this.SUBRULE3(this.booleanExpression))}}])})),V2(e)})),this.parenthesisExpression=this.RULE("parenthesisExpression",(()=>{const e=this.CONSUME(c3),t=this.SUBRULE(this.booleanExpression),n=this.CONSUME(d3);return((e,t,n)=>({type:H2.PARENTHESIS,expression:e,leadingWhitespace:null==t?void 0:t.image,internalWhitespace:null==n?void 0:n.image}))(t,e.leadingWhitespace,n.leadingWhitespace)})),this.arrayExpression=this.RULE("arrayExpression",(()=>this.OR([{ALT:()=>{const e=this.CONSUME(p3),t=this.SUBRULE(this.insideArrayExpression),n=this.CONSUME(g3);return V2(t.args,e.leadingWhitespace,n.leadingWhitespace)}},{ALT:()=>this.SUBRULE(this.parenthesisExpression)}]))),this.numericStringToNumber=e=>{const t=e.replace(this.lexerConfig.decimalSeparator,".");return Number(t)},this.positiveAtomicExpression=this.RULE("positiveAtomicExpression",(()=>{var e;return this.OR(null!==(e=this.atomicExpCache)&&void 0!==e?e:this.atomicExpCache=[{ALT:()=>this.SUBRULE(this.arrayExpression)},{ALT:()=>this.SUBRULE(this.cellRangeExpression)},{ALT:()=>this.SUBRULE(this.columnRangeExpression)},{ALT:()=>this.SUBRULE(this.rowRangeExpression)},{ALT:()=>this.SUBRULE(this.offsetExpression)},{ALT:()=>this.SUBRULE(this.cellReference)},{ALT:()=>this.SUBRULE(this.procedureExpression)},{ALT:()=>this.SUBRULE(this.namedExpressionExpression)},{ALT:()=>{const e=this.CONSUME(this.lexerConfig.NumberLiteral);return t=this.numericStringToNumber(e.image),n=e.leadingWhitespace,{type:H2.NUMBER,value:t,leadingWhitespace:null==n?void 0:n.image};var t,n}},{ALT:()=>(e=>{var t;return{type:H2.STRING,value:e.image.slice(1,-1),leadingWhitespace:null===(t=e.leadingWhitespace)||void 0===t?void 0:t.image}})(this.CONSUME(m3))},{ALT:()=>{const e=this.CONSUME(f3),t=e.image.toUpperCase(),n=this.lexerConfig.errorMapping[t];return n?U2(new C4(n),e.leadingWhitespace):this.parsingError(L2.ParserError,"Unknown error literal")}}])})),this.rightUnaryOpAtomicExpression=this.RULE("rightUnaryOpAtomicExpression",(()=>{const e=this.SUBRULE(this.positiveAtomicExpression),t=this.OPTION((()=>this.CONSUME(n3)));return t?(n=e,r=t.leadingWhitespace,{type:H2.PERCENT_OP,value:n,leadingWhitespace:null==r?void 0:r.image}):e;var n,r})),this.atomicExpression=this.RULE("atomicExpression",(()=>this.OR([{ALT:()=>{const e=this.CONSUME(X2),t=this.SUBRULE(this.atomicExpression);return m0(e,q2)?((e,t)=>({type:H2.PLUS_UNARY_OP,value:e,leadingWhitespace:null==t?void 0:t.image}))(t,e.leadingWhitespace):m0(e,Q2)?((e,t)=>({type:H2.MINUS_UNARY_OP,value:e,leadingWhitespace:null==t?void 0:t.image}))(t,e.leadingWhitespace):(this.customParsingError=_2(L2.ParserError,"Mismatched token type"),this.customParsingError)}},{ALT:()=>this.SUBRULE2(this.rightUnaryOpAtomicExpression)}]))),this.powerExpression=this.RULE("powerExpression",(()=>{let e=this.SUBRULE(this.atomicExpression);return this.MANY((()=>{const t=this.CONSUME(t3),n=this.SUBRULE2(this.atomicExpression);m0(t,t3)?e=((e,t,n)=>({type:H2.POWER_OP,left:e,right:t,leadingWhitespace:null==n?void 0:n.image}))(e,n,t.leadingWhitespace):this.ACTION((()=>{throw Error("Operator not supported")}))})),e})),this.multiplicationExpression=this.RULE("multiplicationExpression",(()=>{let e=this.SUBRULE(this.powerExpression);return this.MANY((()=>{const t=this.CONSUME(Z2),n=this.SUBRULE2(this.powerExpression);m0(t,J2)?e=((e,t,n)=>({type:H2.TIMES_OP,left:e,right:t,leadingWhitespace:null==n?void 0:n.image}))(e,n,t.leadingWhitespace):m0(t,e3)?e=((e,t,n)=>({type:H2.DIV_OP,left:e,right:t,leadingWhitespace:null==n?void 0:n.image}))(e,n,t.leadingWhitespace):this.ACTION((()=>{throw Error("Operator not supported")}))})),e})),this.additionExpression=this.RULE("additionExpression",(()=>{let e=this.SUBRULE(this.multiplicationExpression);return this.MANY((()=>{const t=this.CONSUME(X2),n=this.SUBRULE2(this.multiplicationExpression);m0(t,q2)?e=((e,t,n)=>({type:H2.PLUS_OP,left:e,right:t,leadingWhitespace:null==n?void 0:n.image}))(e,n,t.leadingWhitespace):m0(t,Q2)?e=((e,t,n)=>({type:H2.MINUS_OP,left:e,right:t,leadingWhitespace:null==n?void 0:n.image}))(e,n,t.leadingWhitespace):this.ACTION((()=>{throw Error("Operator not supported")}))})),e})),this.concatenateExpression=this.RULE("concatenateExpression",(()=>{let e=this.SUBRULE(this.additionExpression);return this.MANY((()=>{const t=this.CONSUME(u3),n=this.SUBRULE2(this.additionExpression);e=((e,t,n)=>({type:H2.CONCATENATE_OP,left:e,right:t,leadingWhitespace:null==n?void 0:n.image}))(e,n,t.leadingWhitespace)})),e})),this.booleanExpression=this.RULE("booleanExpression",(()=>{let e=this.SUBRULE(this.concatenateExpression);return this.MANY((()=>{const t=this.CONSUME(r3),n=this.SUBRULE2(this.concatenateExpression);m0(t,i3)?e=((e,t,n)=>({type:H2.EQUALS_OP,left:e,right:t,leadingWhitespace:null==n?void 0:n.image}))(e,n,t.leadingWhitespace):m0(t,o3)?e=((e,t,n)=>({type:H2.NOT_EQUAL_OP,left:e,right:t,leadingWhitespace:null==n?void 0:n.image}))(e,n,t.leadingWhitespace):m0(t,s3)?e=((e,t,n)=>({type:H2.GREATER_THAN_OP,left:e,right:t,leadingWhitespace:null==n?void 0:n.image}))(e,n,t.leadingWhitespace):m0(t,a3)?e=((e,t,n)=>({type:H2.LESS_THAN_OP,left:e,right:t,leadingWhitespace:null==n?void 0:n.image}))(e,n,t.leadingWhitespace):m0(t,l3)?e=((e,t,n)=>({type:H2.GREATER_THAN_OR_EQUAL_OP,left:e,right:t,leadingWhitespace:null==n?void 0:n.image}))(e,n,t.leadingWhitespace):m0(t,h3)?e=((e,t,n)=>({type:H2.LESS_THAN_OR_EQUAL_OP,left:e,right:t,leadingWhitespace:null==n?void 0:n.image}))(e,n,t.leadingWhitespace):this.ACTION((()=>{throw Error("Operator not supported")}))})),e})),this.formula=this.RULE("formula",(()=>(this.CONSUME(i3),this.SUBRULE(this.booleanExpression)))),this.lexerConfig=e,this.sheetMapping=t,this.formulaAddress=T4(0,0,0),this.performSelfAnalysis()}parseFromTokens(e,t){this.input=e;let n=this.formulaWithContext(t),r=[];return this.customParsingError&&r.push(this.customParsingError),r=r.concat(this.errors.map((e=>({type:L2.ParserError,message:e.message})))),r.length>0&&(n=W2()),{ast:n,errors:r}}reset(){super.reset(),this.customParsingError=void 0}formulaWithContext(e){return this.formulaAddress=e,this.formula()}buildCellRange(e,t,n){if(void 0===e.sheet&&void 0!==t.sheet)return this.parsingError(L2.ParserError,"Malformed range expression");const{firstEnd:r,secondEnd:i,sheetRefType:o}=N3.fixSheetIdsForRangeEnds(e,t);return D2(r,i,o,n)}static fixSheetIdsForRangeEnds(e,t){const n=N3.rangeSheetReferenceType(e.sheet,t.sheet);return{firstEnd:e,secondEnd:void 0!==e.sheet&&void 0===t.sheet?t.withSheet(e.sheet):t,sheetRefType:n}}handleOffsetHeuristic(e){const t=e[0];if(t.type!==H2.CELL_REFERENCE)return this.parsingError(L2.StaticOffsetError,"First argument to OFFSET is not a reference");const n=e[1];let r;if(n.type===H2.NUMBER&&Number.isInteger(n.value))r=n.value;else if(n.type===H2.PLUS_UNARY_OP&&n.value.type===H2.NUMBER&&Number.isInteger(n.value.value))r=n.value.value;else{if(n.type!==H2.MINUS_UNARY_OP||n.value.type!==H2.NUMBER||!Number.isInteger(n.value.value))return this.parsingError(L2.StaticOffsetError,"Second argument to OFFSET is not a static number");r=-n.value.value}const i=e[2];let o;if(i.type===H2.NUMBER&&Number.isInteger(i.value))o=i.value;else if(i.type===H2.PLUS_UNARY_OP&&i.value.type===H2.NUMBER&&Number.isInteger(i.value.value))o=i.value.value;else{if(i.type!==H2.MINUS_UNARY_OP||i.value.type!==H2.NUMBER||!Number.isInteger(i.value.value))return this.parsingError(L2.StaticOffsetError,"Third argument to OFFSET is not a static number");o=-i.value.value}const s=e[3];let a;if(void 0===s)a=1;else{if(s.type!==H2.NUMBER)return this.parsingError(L2.StaticOffsetError,"Fourth argument to OFFSET is not a static number");if(a=s.value,a<1)return this.parsingError(L2.StaticOffsetError,"Fourth argument to OFFSET is too small number");if(!Number.isInteger(a))return this.parsingError(L2.StaticOffsetError,"Fourth argument to OFFSET is not integer")}const l=e[4];let h;if(void 0===l)h=1;else{if(l.type!==H2.NUMBER)return this.parsingError(L2.StaticOffsetError,"Fifth argument to OFFSET is not a static number");if(h=l.value,h<1)return this.parsingError(L2.StaticOffsetError,"Fifth argument to OFFSET is too small number");if(!Number.isInteger(h))return this.parsingError(L2.StaticOffsetError,"Fifth argument to OFFSET is not integer")}const u=new jQ(t.reference.col+o,t.reference.row+r,t.reference.type);let c=u.col,d=u.row;if(t.reference.type!==UQ.CELL_REFERENCE_RELATIVE&&t.reference.type!==UQ.CELL_REFERENCE_ABSOLUTE_COL||(d+=this.formulaAddress.row),t.reference.type!==UQ.CELL_REFERENCE_RELATIVE&&t.reference.type!==UQ.CELL_REFERENCE_ABSOLUTE_ROW||(c+=this.formulaAddress.col),c<0||d<0)return U2(new C4(t4.REF,K2.OutOfSheet));if(1===h&&1===a)return F2(u);{const e=new jQ(u.col+h-1,u.row+a-1,u.type);return D2(u,e,k2.RELATIVE)}}parsingError(e,t){return this.customParsingError=_2(e,t),W2()}static rangeSheetReferenceType(e,t){return void 0===e?k2.RELATIVE:void 0===t?k2.START_ABSOLUTE:k2.BOTH_ABSOLUTE}}class A3{constructor(e){this.lexerConfig=e,this.lexer=new e0(e.allTokens,{ensureOptimizations:!0})}tokenizeFormula(e){const t=this.lexer.tokenize(e);let n=t.tokens;return n=this.trimTrailingWhitespaces(n),n=this.skipWhitespacesInsideRanges(n),n=this.skipWhitespacesBeforeArgSeparators(n),t.tokens=n,t}skipWhitespacesInsideRanges(e){return A3.filterTokensByNeighbors(e,((e,t,n)=>(m0(e,R3)||m0(e,w3))&&m0(t,this.lexerConfig.WhiteSpace)&&(m0(n,R3)||m0(n,w3))))}skipWhitespacesBeforeArgSeparators(e){return A3.filterTokensByNeighbors(e,((e,t,n)=>!m0(e,this.lexerConfig.ArgSeparator)&&m0(t,this.lexerConfig.WhiteSpace)&&m0(n,this.lexerConfig.ArgSeparator)))}static filterTokensByNeighbors(e,t){if(e.length<3)return e;let n=0;const r=[e[n++]];for(;n<e.length-1;)t(e[n-1],e[n],e[n+1])||r.push(e[n]),++n;return r.push(e[n]),r}trimTrailingWhitespaces(e){return e.length>0&&m0(e[e.length-1],this.lexerConfig.WhiteSpace)&&e.pop(),e}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class M3{constructor(e,t,n,r){this.config=e,this.lexerConfig=t,this.sheetMappingFn=n,this.namedExpressions=r}unparse(e,t){return"="+this.unparseAst(e,t)}unparseAst(e,t){var n,r;switch(e.type){case H2.EMPTY:return G2("",e.leadingWhitespace);case H2.NUMBER:return G2(I3(e.value,this.config.decimalSeparator),e.leadingWhitespace);case H2.STRING:return G2('"'+e.value+'"',e.leadingWhitespace);case H2.FUNCTION_CALL:{const n=e.args.map((e=>void 0!==e?this.unparseAst(e,t):"")).join(this.config.functionArgSeparator),r=(this.config.translationPackage.isFunctionTranslated(e.procedureName)?this.config.translationPackage.getFunctionTranslation(e.procedureName):e.procedureName)+"("+n+G2(")",e.internalWhitespace);return G2(r,e.leadingWhitespace)}case H2.NAMED_EXPRESSION:return G2((null===(n=this.namedExpressions.nearestNamedExpression(e.expressionName,t.sheet))||void 0===n?void 0:n.displayName)||e.expressionName,e.leadingWhitespace);case H2.CELL_REFERENCE:{let n;return n=void 0!==e.reference.sheet?this.unparseSheetName(e.reference.sheet)+"!":"",n+=null!==(r=e.reference.unparse(t))&&void 0!==r?r:this.config.translationPackage.getErrorTranslation(t4.REF),G2(n,e.leadingWhitespace)}case H2.COLUMN_RANGE:case H2.ROW_RANGE:case H2.CELL_RANGE:return G2(this.formatRange(e,t),e.leadingWhitespace);case H2.PLUS_UNARY_OP:{const n=this.unparseAst(e.value,t);return G2("+",e.leadingWhitespace)+n}case H2.MINUS_UNARY_OP:{const n=this.unparseAst(e.value,t);return G2("-",e.leadingWhitespace)+n}case H2.PERCENT_OP:return this.unparseAst(e.value,t)+G2("%",e.leadingWhitespace);case H2.ERROR:return G2(this.config.translationPackage.getErrorTranslation(e.error?e.error.type:t4.ERROR),e.leadingWhitespace);case H2.ERROR_WITH_RAW_INPUT:return G2(e.rawInput,e.leadingWhitespace);case H2.PARENTHESIS:{const n="("+this.unparseAst(e.expression,t)+G2(")",e.internalWhitespace);return G2(n,e.leadingWhitespace)}case H2.ARRAY:{const n="{"+e.args.map((e=>e.map((e=>this.unparseAst(e,t))).join(this.config.arrayColumnSeparator))).join(this.config.arrayRowSeparator)+G2("}",e.internalWhitespace);return G2(n,e.leadingWhitespace)}default:{const n=this.unparseAst(e.left,t),r=this.unparseAst(e.right,t);return n+G2(z2[e.type],e.leadingWhitespace)+r}}}unparseSheetName(e){const t=mZ(e,this.sheetMappingFn);if(void 0===t)throw new i9(e);return t}formatRange(e,t){let n="",r="";void 0!==e.start.sheet&&e.sheetReferenceType!==k2.RELATIVE&&(n=this.unparseSheetName(e.start.sheet)+"!"),void 0!==e.end.sheet&&e.sheetReferenceType===k2.BOTH_ABSOLUTE&&(r=this.unparseSheetName(e.end.sheet)+"!");const i=e.start.unparse(t),o=e.end.unparse(t);return void 0===i||void 0===o?this.config.translationPackage.getErrorTranslation(t4.REF):`${n}${i}:${r}${o}`}}function I3(e,t){return e.toString().replace(".",t)}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class O3{constructor(e,t,n){this.config=e,this.functionRegistry=t,this.sheetMapping=n,this.statsCacheUsed=0,this.lexerConfig=T3(e),this.lexer=new A3(this.lexerConfig),this.formulaParser=new N3(this.lexerConfig,this.sheetMapping),this.cache=new $2(this.functionRegistry)}parse(e,t){this.formulaAddress=t;const n=this.tokenizeFormula(e);if(n.errors.length>0){const e=n.errors.map((e=>({type:L2.LexingError,message:e.message})));return{ast:W2(),errors:e,hasVolatileFunction:!1,hasStructuralChangeFunction:!1,dependencies:[]}}const r=this.computeHashFromTokens(n.tokens,t);let i=this.cache.get(r);if(void 0!==i)++this.statsCacheUsed;else{const e=this.bindWhitespacesToTokens(n.tokens),o=this.formulaParser.parseFromTokens(e,t);if(o.errors.length>0)return Object.assign(Object.assign({},o),{hasVolatileFunction:!1,hasStructuralChangeFunction:!1,dependencies:[]});i=this.cache.set(r,o.ast)}const{ast:o,hasVolatileFunction:s,hasStructuralChangeFunction:a}=i,l=this.convertReversedRangesToRegularRanges(o);return{ast:l,errors:[],hasVolatileFunction:s,hasStructuralChangeFunction:a,dependencies:P3(l,this.functionRegistry)}}convertReversedRangesToRegularRanges(e){switch(e.type){case H2.EMPTY:case H2.NUMBER:case H2.STRING:case H2.ERROR:case H2.ERROR_WITH_RAW_INPUT:case H2.CELL_REFERENCE:case H2.NAMED_EXPRESSION:return e;case H2.CELL_RANGE:{const{start:t,end:n}=e,r=this.orderCellRangeEnds(t,n);return Object.assign(Object.assign({},e),{start:r.start,end:r.end})}case H2.COLUMN_RANGE:{const{start:t,end:n}=e,r=this.orderColumnRangeEnds(t,n);return Object.assign(Object.assign({},e),{start:r.start,end:r.end})}case H2.ROW_RANGE:{const{start:t,end:n}=e,r=this.orderRowRangeEnds(t,n);return Object.assign(Object.assign({},e),{start:r.start,end:r.end})}case H2.PERCENT_OP:case H2.PLUS_UNARY_OP:case H2.MINUS_UNARY_OP:{const t=this.convertReversedRangesToRegularRanges(e.value);return Object.assign(Object.assign({},e),{value:t})}case H2.CONCATENATE_OP:case H2.EQUALS_OP:case H2.NOT_EQUAL_OP:case H2.LESS_THAN_OP:case H2.GREATER_THAN_OP:case H2.LESS_THAN_OR_EQUAL_OP:case H2.GREATER_THAN_OR_EQUAL_OP:case H2.MINUS_OP:case H2.PLUS_OP:case H2.TIMES_OP:case H2.DIV_OP:case H2.POWER_OP:{const t=this.convertReversedRangesToRegularRanges(e.left),n=this.convertReversedRangesToRegularRanges(e.right);return Object.assign(Object.assign({},e),{left:t,right:n})}case H2.PARENTHESIS:{const t=this.convertReversedRangesToRegularRanges(e.expression);return Object.assign(Object.assign({},e),{expression:t})}case H2.FUNCTION_CALL:{const t=e.args.map((e=>this.convertReversedRangesToRegularRanges(e)));return Object.assign(Object.assign({},e),{args:t})}case H2.ARRAY:{const t=e.args.map((e=>e.map((e=>this.convertReversedRangesToRegularRanges(e)))));return Object.assign(Object.assign({},e),{args:t})}}}orderCellRangeEnds(e,t){const n=[e,t],[r,i]=n.map((e=>e.toColumnAddress())).sort(BQ.compareByAbsoluteAddress(this.formulaAddress)),[o,s]=n.map((e=>e.toRowAddress())).sort(WQ.compareByAbsoluteAddress(this.formulaAddress)),[a,l]=n.map((e=>e.sheet)).sort(O3.compareSheetIds.bind(this));return{start:jQ.fromColAndRow(r,o,a),end:jQ.fromColAndRow(i,s,l)}}orderColumnRangeEnds(e,t){const n=[e,t],[r,i]=n.sort(BQ.compareByAbsoluteAddress(this.formulaAddress)),[o,s]=n.map((e=>e.sheet)).sort(O3.compareSheetIds.bind(this));return{start:new BQ(r.type,r.col,o),end:new BQ(i.type,i.col,s)}}orderRowRangeEnds(e,t){const n=[e,t],[r,i]=n.sort(WQ.compareByAbsoluteAddress(this.formulaAddress)),[o,s]=n.map((e=>e.sheet)).sort(O3.compareSheetIds.bind(this));return{start:new WQ(r.type,r.row,o),end:new WQ(i.type,i.row,s)}}static compareSheetIds(e,t){return(e=null!=e?e:1/0)-(t=null!=t?t:1/0)}fetchCachedResultForAst(e){const t=this.computeHashFromAst(e);return this.fetchCachedResult(t)}fetchCachedResult(e){const t=this.cache.get(e);if(void 0===t)throw new Error("There is no AST with such key in the cache");{const{ast:e,hasVolatileFunction:n,hasStructuralChangeFunction:r,relativeDependencies:i}=t;return{ast:e,errors:[],hasVolatileFunction:n,hasStructuralChangeFunction:r,dependencies:i}}}computeHashFromTokens(e,t){var n;let r="",i=0;for(;i<e.length;){const o=e[i];if(m0(o,R3)){const e=lZ(this.sheetMapping,o.image,t);r=void 0===e?r.concat(o.image):r.concat(e.hash(!0))}else if(m0(o,C3)){const e=o.image.toUpperCase().slice(0,-1),t=null!==(n=this.lexerConfig.functionMapping[e])&&void 0!==n?n:e;r=r.concat(t,"(")}else if(m0(o,y3)){const[e,n]=o.image.split(":"),i=hZ(this.sheetMapping,e,t),s=hZ(this.sheetMapping,n,t);r=void 0===i||void 0===s?r.concat("!REF"):r.concat(i.hash(!0),":",s.hash(!0))}else if(m0(o,v3)){const[e,n]=o.image.split(":"),i=uZ(this.sheetMapping,e,t),s=uZ(this.sheetMapping,n,t);r=void 0===i||void 0===s?r.concat("!REF"):r.concat(i.hash(!0),":",s.hash(!0))}else r=r.concat(o.image);i++}return r}rememberNewAst(e){const t=this.computeHashFromAst(e);return this.cache.maybeSetAndThenGet(t,e)}computeHashFromAst(e){return"="+this.computeHashOfAstNode(e)}computeHashOfAstNode(e){switch(e.type){case H2.EMPTY:return e.leadingWhitespace||"";case H2.NUMBER:return G2(I3(e.value,this.config.decimalSeparator),e.leadingWhitespace);case H2.STRING:return G2('"'+e.value+'"',e.leadingWhitespace);case H2.NAMED_EXPRESSION:return G2(e.expressionName,e.leadingWhitespace);case H2.FUNCTION_CALL:{const t=e.args.map((e=>this.computeHashOfAstNode(e))).join(this.config.functionArgSeparator),n=e.procedureName+"("+t+G2(")",e.internalWhitespace);return G2(n,e.leadingWhitespace)}case H2.CELL_REFERENCE:return G2(e.reference.hash(!0),e.leadingWhitespace);case H2.COLUMN_RANGE:case H2.ROW_RANGE:case H2.CELL_RANGE:return G2(e.start.hash(e.sheetReferenceType!==k2.RELATIVE)+":"+e.end.hash(e.sheetReferenceType===k2.BOTH_ABSOLUTE),e.leadingWhitespace);case H2.MINUS_UNARY_OP:return G2("-"+this.computeHashOfAstNode(e.value),e.leadingWhitespace);case H2.PLUS_UNARY_OP:return G2("+"+this.computeHashOfAstNode(e.value),e.leadingWhitespace);case H2.PERCENT_OP:return this.computeHashOfAstNode(e.value)+G2("%",e.leadingWhitespace);case H2.ERROR:return G2(this.config.translationPackage.getErrorTranslation(e.error?e.error.type:t4.ERROR),e.leadingWhitespace);case H2.ERROR_WITH_RAW_INPUT:return G2(e.rawInput,e.leadingWhitespace);case H2.ARRAY:return G2("{"+e.args.map((e=>e.map((e=>this.computeHashOfAstNode(e))).join(","))).join(";")+G2("}",e.internalWhitespace),e.leadingWhitespace);case H2.PARENTHESIS:{const t="("+this.computeHashOfAstNode(e.expression)+G2(")",e.internalWhitespace);return G2(t,e.leadingWhitespace)}default:return this.computeHashOfAstNode(e.left)+G2(z2[e.type],e.leadingWhitespace)+this.computeHashOfAstNode(e.right)}}bindWhitespacesToTokens(e){const t=[],n=e[0];m0(n,this.lexerConfig.WhiteSpace)||t.push(n);for(let r=1;r<e.length;++r){const n=e[r];if(m0(n,this.lexerConfig.WhiteSpace))continue;const i=e[r-1];m0(i,this.lexerConfig.WhiteSpace)&&(n.leadingWhitespace=i),t.push(n)}return t}tokenizeFormula(e){return this.lexer.tokenizeFormula(e)}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */const x3=(e,t,n,r)=>{switch(e.type){case H2.EMPTY:case H2.NUMBER:case H2.STRING:case H2.ERROR:return;case H2.NAMED_EXPRESSION:return void(r&&n.push(new F3(e.expressionName)));case H2.CELL_REFERENCE:return void(r&&n.push(new _3(e.reference)));case H2.CELL_RANGE:return void(r&&e.start.sheet===e.end.sheet&&n.push(new L3(e.start,e.end)));case H2.COLUMN_RANGE:return void(r&&e.start.sheet===e.end.sheet&&n.push(new H3(e.start,e.end)));case H2.ROW_RANGE:return void(r&&e.start.sheet===e.end.sheet&&n.push(new k3(e.start,e.end)));case H2.PERCENT_OP:case H2.PLUS_UNARY_OP:case H2.MINUS_UNARY_OP:return void x3(e.value,t,n,!0);case H2.CONCATENATE_OP:case H2.EQUALS_OP:case H2.NOT_EQUAL_OP:case H2.LESS_THAN_OP:case H2.GREATER_THAN_OP:case H2.LESS_THAN_OR_EQUAL_OP:case H2.GREATER_THAN_OR_EQUAL_OP:case H2.MINUS_OP:case H2.PLUS_OP:case H2.TIMES_OP:case H2.DIV_OP:case H2.POWER_OP:return x3(e.left,t,n,!0),void x3(e.right,t,n,!0);case H2.PARENTHESIS:return void x3(e.expression,t,n,r);case H2.FUNCTION_CALL:{const r=!t.doesFunctionNeedArgumentToBeComputed(e.procedureName);return void e.args.forEach((e=>x3(e,t,n,r)))}}},P3=(e,t)=>{const n=new Array;return x3(e,t,n,!0),n};
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
class _3{constructor(e){this.dependency=e}absolutize(e){return this.dependency.toSimpleCellAddress(e)}}class L3{constructor(e,t){this.start=e,this.end=t}absolutize(e){return new L4(this.start.toSimpleCellAddress(e),this.end.toSimpleCellAddress(e))}}class H3{constructor(e,t){this.start=e,this.end=t}absolutize(e){const t=this.start.toSimpleColumnAddress(e),n=this.end.toSimpleColumnAddress(e);return new H4(t.sheet,t.col,n.col)}}class k3{constructor(e,t){this.start=e,this.end=t}absolutize(e){const t=this.start.toSimpleRowAddress(e),n=this.end.toSimpleRowAddress(e);return new k4(t.sheet,t.row,n.row)}}class F3{constructor(e){this.name=e}absolutize(e){return this}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */const D3=(e,t)=>e.map((e=>e.absolutize(t))),V3=Symbol("Empty value");function U3(e){return e instanceof B3?e.val:e}class B3{constructor(e,t){this.val=e,this.format=t}fromNumber(e){return new this.constructor(e)}}function W3(e,t){if("number"==typeof e)return t;{const n=e.fromNumber(t);return n.format=e.format,n}}class j3 extends B3{getDetailedType(){return X3.NUMBER_DATE}}class G3 extends B3{getDetailedType(){return X3.NUMBER_CURRENCY}}class z3 extends B3{getDetailedType(){return X3.NUMBER_TIME}}class $3 extends B3{getDetailedType(){return X3.NUMBER_DATETIME}}class Y3 extends B3{getDetailedType(){return X3.NUMBER_PERCENT}}function K3(e){return"number"==typeof e||e instanceof B3}var X3,q3;function Q3(e){return e instanceof B3?{type:e.getDetailedType(),format:e.format}:{type:X3.NUMBER_RAW}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */!function(e){e.NUMBER_RAW="NUMBER_RAW",e.NUMBER_DATE="NUMBER_DATE",e.NUMBER_TIME="NUMBER_TIME",e.NUMBER_DATETIME="NUMBER_DATETIME",e.NUMBER_CURRENCY="NUMBER_CURRENCY",e.NUMBER_PERCENT="NUMBER_PERCENT"}(X3||(X3={}));class Z3{constructor(e,t,n,r){this._data=e,this.range=t,this.dependencyGraph=n,this._hasOnlyNumbers=r,this.size=void 0===e?new s5(t.effectiveWidth(n),t.effectiveHeight(n)):new s5(e[0].length,e.length)}get data(){return this.ensureThatComputed(),this._data}static fromRange(e,t,n){return new Z3(e,t,n,!0)}static onlyNumbers(e){return new Z3(e,void 0,void 0,!0)}static onlyValues(e){return new Z3(e,void 0,void 0,void 0)}static onlyRange(e,t){return new Z3(void 0,e,t,void 0)}static fromScalar(e){return new Z3([[e]],void 0,void 0,void 0)}isAdHoc(){return void 0===this.range}width(){return this.size.width}height(){return this.size.height}valuesFromTopLeftCorner(){this.ensureThatComputed();const e=[];for(let t=0;t<this._data.length;t++)for(let n=0;n<this._data[0].length;n++)e.push(this._data[t][n]);return e}*effectiveAddressesFromData(e){for(let t=0;t<this.data.length;++t){const n=this.data[t];for(let r=0;r<n.length;++r)yield T4(e.sheet,e.col+r,e.row+t)}}*entriesFromTopLeftCorner(e){this.ensureThatComputed();for(let t=0;t<this.size.height;++t)for(let n=0;n<this.size.width;++n)yield[this._data[t][n],T4(e.sheet,e.col+n,e.row+t)]}*iterateValuesFromTopLeftCorner(){yield*this.valuesFromTopLeftCorner()}numberOfElements(){return this.size.width*this.size.height}hasOnlyNumbers(){if(void 0===this._hasOnlyNumbers){this._hasOnlyNumbers=!0;for(const e of this.data)for(const t of e)if("number"!=typeof t)return this._hasOnlyNumbers=!1,!1}return this._hasOnlyNumbers}rawNumbers(){return this._data}rawData(){var e;return this.ensureThatComputed(),null!==(e=this._data)&&void 0!==e?e:[]}sameDimensionsAs(e){return this.width()===e.width()&&this.height()===e.height()}ensureThatComputed(){void 0===this._data&&(this._hasOnlyNumbers=!0,this._data=this.range.addressesArrayMap(this.dependencyGraph,(e=>{const t=this.dependencyGraph.getCellValue(e);return t instanceof Z3?(this._hasOnlyNumbers=!1,new C4(t4.VALUE,K2.ScalarExpected)):(K3(t)||(this._hasOnlyNumbers=!1),t)})))}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class J3{constructor(){this.changes=new Map}static empty(){return new J3}addAll(e){for(const t of e.changes.values())this.add(t.address,t);return this}addChange(e,t,n){this.addInterpreterValue(e,t,n)}exportChanges(e){let t=[];return this.changes.forEach((n=>{const r=e.exportChange(n);Array.isArray(r)?t=t.concat(r):t.push(r)})),t}getChanges(){return Array.from(this.changes.values())}isEmpty(){return 0===this.changes.size}add(e,t){const n=t.value;if(n instanceof Z3)for(const r of n.effectiveAddressesFromData(e))this.changes.delete(M4(r));this.changes.set(M4(e),t)}addInterpreterValue(e,t,n){this.add(t,{address:t,value:e,oldValue:n})}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class e9{constructor(e,t,n){if(this.sheet=e,this.rowStart=t,this.rowEnd=n,t<0)throw Error("Starting row cant be less than 0");if(n<t)throw Error("Row span cant end before start")}get numberOfRows(){return this.rowEnd-this.rowStart+1}get start(){return this.rowStart}get end(){return this.rowEnd}static fromNumberOfRows(e,t,n){return new e9(e,t,t+n-1)}static fromRowStartAndEnd(e,t,n){return new e9(e,t,n)}*rows(){for(let e=this.rowStart;e<=this.rowEnd;++e)yield e}intersect(e){if(this.sheet!==e.sheet)throw Error("Can't intersect spans from different sheets");const t=Math.max(this.rowStart,e.rowStart),n=Math.min(this.rowEnd,e.rowEnd);return t>n?null:new e9(this.sheet,t,n)}firstRow(){return new e9(this.sheet,this.rowStart,this.rowStart)}}class t9{constructor(e,t,n){if(this.sheet=e,this.columnStart=t,this.columnEnd=n,t<0)throw Error("Starting column cant be less than 0");if(n<t)throw Error("Column span cant end before start")}get numberOfColumns(){return this.columnEnd-this.columnStart+1}get start(){return this.columnStart}get end(){return this.columnEnd}static fromNumberOfColumns(e,t,n){return new t9(e,t,t+n-1)}static fromColumnStartAndEnd(e,t,n){return new t9(e,t,n)}*columns(){for(let e=this.columnStart;e<=this.columnEnd;++e)yield e}intersect(e){if(this.sheet!==e.sheet)throw Error("Can't intersect spans from different sheets");const t=Math.max(this.columnStart,e.columnStart),n=Math.min(this.columnEnd,e.columnEnd);return t>n?null:new t9(this.sheet,t,n)}firstColumn(){return new t9(this.sheet,this.columnStart,this.columnStart)}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */!function(e){e.BUILD_ENGINE_TOTAL="BUILD_ENGINE_TOTAL",e.PARSER="PARSER",e.GRAPH_BUILD="GRAPH_BUILD",e.COLLECT_DEPENDENCIES="COLLECT_DEPENDENCIES",e.PROCESS_DEPENDENCIES="PROCESS_DEPENDENCIES",e.TOP_SORT="TOP_SORT",e.BUILD_COLUMN_INDEX="BUILD_COLUMN_INDEX",e.EVALUATION="EVALUATION",e.VLOOKUP="VLOOKUP",e.TRANSFORM_ASTS="TRANSFORM_ASTS",e.TRANSFORM_ASTS_POSTPONED="TRANSFORM_ASTS_POSTPONED",e.ADJUSTING_ADDRESS_MAPPING="ADJUSTING_ADDRESS_MAPPING",e.ADJUSTING_ARRAY_MAPPING="ADJUSTING_ARRAY_MAPPING",e.ADJUSTING_RANGES="ADJUSTING_RANGES",e.ADJUSTING_GRAPH="ADJUSTING_GRAPH",e.CRITERION_FUNCTION_FULL_CACHE_USED="CRITERION_FUNCTION_FULL_CACHE_USED",e.CRITERION_FUNCTION_PARTIAL_CACHE_USED="CRITERION_FUNCTION_PARTIAL_CACHE_USED"}(q3||(q3={}));
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
class n9{constructor(){this.stats=new Map([[q3.CRITERION_FUNCTION_FULL_CACHE_USED,0],[q3.CRITERION_FUNCTION_PARTIAL_CACHE_USED,0]]),this.startTimes=new Map}incrementCriterionFunctionFullCacheUsed(){var e;const t=(null!==(e=this.stats.get(q3.CRITERION_FUNCTION_FULL_CACHE_USED))&&void 0!==e?e:0)+1;this.stats.set(q3.CRITERION_FUNCTION_FULL_CACHE_USED,t)}incrementCriterionFunctionPartialCacheUsed(){var e;const t=(null!==(e=this.stats.get(q3.CRITERION_FUNCTION_PARTIAL_CACHE_USED))&&void 0!==e?e:0)+1;this.stats.set(q3.CRITERION_FUNCTION_PARTIAL_CACHE_USED,t)}reset(){this.stats.clear(),this.startTimes.clear(),this.stats.set(q3.CRITERION_FUNCTION_FULL_CACHE_USED,0),this.stats.set(q3.CRITERION_FUNCTION_PARTIAL_CACHE_USED,0)}start(e){if(this.startTimes.get(e))throw Error(`Statistics ${e} already started`);this.startTimes.set(e,Date.now())}end(e){var t;const n=Date.now(),r=this.startTimes.get(e);if(!r)throw Error(`Statistics ${e} not started`);{let i=null!==(t=this.stats.get(e))&&void 0!==t?t:0;i+=n-r,this.stats.set(e,i),this.startTimes.delete(e)}}measure(e,t){this.start(e);const n=t();return this.end(e),n}snapshot(){return new Map(this.stats)}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class r9 extends n9{incrementCriterionFunctionFullCacheUsed(){}incrementCriterionFunctionPartialCacheUsed(){}start(e){}end(e){}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class i9 extends Error{constructor(e){super(`There's no sheet with id = ${e}`)}}class o9 extends Error{constructor(e){super(`There's no sheet with name '${e}'`)}}class s9 extends Error{constructor(e){super(`Sheet with name ${e} already exists`)}}class a9 extends Error{constructor(){super("Sheet size limit exceeded")}}class l9 extends Error{constructor(){super("This is not a formula")}}class h9 extends Error{constructor(e){super(`Address (row = ${e.row}, col = ${e.col}) is invalid`)}}class u9 extends Error{constructor(e){super(`Invalid arguments, expected ${e}`)}}class c9 extends Error{constructor(e,t){super(`Sheets ${e} and ${t} are not equal.`)}}class d9 extends Error{constructor(e){super(`Name of Named Expression '${e}' is already present`)}}class p9 extends Error{constructor(e){super(`Name of Named Expression '${e}' is invalid`)}}class g9 extends Error{constructor(e){super(`Named Expression '${e}' does not exist`)}}class m9 extends Error{constructor(){super("There is no operation to undo")}}class f9 extends Error{constructor(){super("There is no operation to redo")}}class w9 extends Error{constructor(){super("There is nothing to paste")}}function y9(e,t){switch(typeof t){case"function":case"symbol":return t.toString();case"bigint":return"BigInt("+t.toString()+")";default:return t instanceof RegExp?"RegExp("+t.toString()+")":t}}class v9 extends Error{constructor(e){super(`Unable to parse value: ${JSON.stringify(e,y9,4)}`)}}class C9 extends Error{constructor(e,t){super(`Expected value of type: ${e} for config parameter: ${t}`)}}class S9 extends Error{constructor(e){super(`Config parameter ${e} cannot be empty.`)}}class R9 extends Error{constructor(e,t){super(`Config parameter ${e} should be at least ${t}`)}}class E9 extends Error{constructor(e,t){super(`Config parameter ${e} should be at most ${t}`)}}class b9 extends Error{constructor(e,t){super(`Expected one of ${e} for config parameter: ${t}`)}}class T9 extends Error{constructor(){super("Computations are suspended")}}class N9 extends Error{constructor(e){super(`Translation for ${e} is missing in the translation package you're using.`)}}class A9 extends Error{constructor(e){super(`Cannot register translation for function with id: ${e}`)}}class M9 extends Error{constructor(){super("Language not registered.")}}class I9 extends Error{constructor(){super("Language already registered.")}}class O9 extends Error{static functionNotDeclaredInPlugin(e,t){return new O9(`Function with id ${e} not declared in plugin ${t}`)}static functionMethodNotFound(e,t){return new O9(`Function method ${e} not found in plugin ${t}`)}}class x9 extends Error{static cannotRegisterFunctionWithId(e){return new x9(`Cannot register function with id ${e}`)}static cannotUnregisterFunctionWithId(e){return new x9(`Cannot unregister function with id ${e}`)}static cannotUnregisterProtectedPlugin(){return new x9("Cannot unregister protected plugin")}}class P9 extends Error{constructor(){super("Cannot perform this operation, source location has an array inside.")}}class _9 extends Error{constructor(){super("Cannot perform this operation, target location has an array inside.")}}class L9 extends Error{constructor(){super("Relative addresses not allowed in named expressions.")}}class H9 extends Error{constructor(e,t){super(`Alias id ${e} in plugin ${t} already defined as a function or alias.`)}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class k9{constructor(e){this.policy=e,this.mapping=new Map}getCell(e){const t=this.mapping.get(e.sheet);if(void 0===t)throw new i9(e.sheet);return t.getCell(e)}fetchCell(e){const t=this.mapping.get(e.sheet);if(void 0===t)throw new i9(e.sheet);const n=t.getCell(e);if(!n)throw Error("Vertex for address missing in AddressMapping");return n}strategyFor(e){const t=this.mapping.get(e);if(void 0===t)throw new i9(e);return t}addSheet(e,t){if(this.mapping.has(e))throw Error("Sheet already added");this.mapping.set(e,t)}autoAddSheet(e,t){const{height:n,width:r,fill:i}=t,o=this.policy.call(i);this.addSheet(e,new o(r,n))}getCellValue(e){const t=this.getCell(e);return void 0===t?V3:t instanceof W9?t.getArrayCellValue(e):t.getCellValue()}getRawValue(e){const t=this.getCell(e);return t instanceof l4?t.getValues().rawValue:t instanceof W9?t.getArrayCellRawValue(e):null}setCell(e,t){const n=this.mapping.get(e.sheet);if(!n)throw Error("Sheet not initialized");n.setCell(e,t)}moveCell(e,t){const n=this.mapping.get(e.sheet);if(!n)throw Error("Sheet not initialized.");if(e.sheet!==t.sheet)throw Error("Cannot move cells between sheets.");if(n.has(t))throw new Error("Cannot move cell. Destination already occupied.");const r=n.getCell(e);if(void 0===r)throw new Error("Cannot move cell. No cell with such address.");this.setCell(t,r),this.removeCell(e)}removeCell(e){const t=this.mapping.get(e.sheet);if(!t)throw Error("Sheet not initialized");t.removeCell(e)}has(e){const t=this.mapping.get(e.sheet);return void 0!==t&&t.has(e)}getHeight(e){const t=this.mapping.get(e);if(void 0===t)throw new i9(e);return t.getHeight()}getWidth(e){const t=this.mapping.get(e);if(!t)throw new i9(e);return t.getWidth()}addRows(e,t,n){const r=this.mapping.get(e);if(void 0===r)throw new i9(e);r.addRows(t,n)}removeRows(e){const t=this.mapping.get(e.sheet);if(void 0===t)throw new i9(e.sheet);t.removeRows(e)}removeSheet(e){this.mapping.delete(e)}addColumns(e,t,n){const r=this.mapping.get(e);if(void 0===r)throw new i9(e);r.addColumns(t,n)}removeColumns(e){const t=this.mapping.get(e.sheet);if(void 0===t)throw new i9(e.sheet);t.removeColumns(e)}*verticesFromRowsSpan(e){yield*this.mapping.get(e.sheet).verticesFromRowsSpan(e)}*verticesFromColumnsSpan(e){yield*this.mapping.get(e.sheet).verticesFromColumnsSpan(e)}*entriesFromRowsSpan(e){yield*this.mapping.get(e.sheet).entriesFromRowsSpan(e)}*entriesFromColumnsSpan(e){yield*this.mapping.get(e.sheet).entriesFromColumnsSpan(e)}*entries(){for(const[e,t]of this.mapping.entries())yield*t.getEntries(e)}*sheetEntries(e){const t=this.mapping.get(e);if(void 0===t)throw new i9(e);yield*t.getEntries(e)}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class F9{constructor(){this.arrayMapping=new Map}getArray(e){const t=this.getArrayByCorner(e.start);if(null==t?void 0:t.getRange().sameAs(e))return t}getArrayByCorner(e){return this.arrayMapping.get(M4(e))}setArray(e,t){this.arrayMapping.set(M4(e.start),t)}removeArray(e){"string"==typeof e?this.arrayMapping.delete(e):this.arrayMapping.delete(M4(e.start))}count(){return this.arrayMapping.size}*arraysInRows(e){for(const[t,n]of this.arrayMapping.entries())n.spansThroughSheetRows(e.sheet,e.rowStart,e.rowEnd)&&(yield[t,n])}*arraysInCols(e){for(const[t,n]of this.arrayMapping.entries())n.spansThroughSheetColumn(e.sheet,e.columnStart,e.columnEnd)&&(yield[t,n])}isFormulaArrayInRow(e,t){for(const n of this.arrayMapping.values())if(n.spansThroughSheetRows(e,t))return!0;return!1}isFormulaArrayInAllRows(e){let t=!0;for(const n of e.rows())this.isFormulaArrayInRow(e.sheet,n)||(t=!1);return t}isFormulaArrayInColumn(e,t){for(const n of this.arrayMapping.values())if(n.spansThroughSheetColumn(e,t))return!0;return!1}isFormulaArrayInAllColumns(e){let t=!0;for(const n of e.columns())this.isFormulaArrayInColumn(e.sheet,n)||(t=!1);return t}isFormulaArrayInRange(e){for(const t of this.arrayMapping.values())if(t.getRange().doesOverlap(e))return!0;return!1}isFormulaArrayAtAddress(e){for(const t of this.arrayMapping.values())if(t.getRange().addressInRange(e))return!0;return!1}moveArrayVerticesAfterRowByRows(e,t,n){this.updateArrayVerticesInSheet(e,((e,r)=>{const i=r.getRange();return t<=i.start.row?[i.shifted(0,n),r]:void 0}))}moveArrayVerticesAfterColumnByColumns(e,t,n){this.updateArrayVerticesInSheet(e,((e,r)=>{const i=r.getRange();return t<=i.start.col?[i.shifted(n,0),r]:void 0}))}updateArrayVerticesInSheet(e,t){const n=Array();for(const[r,i]of this.arrayMapping.entries()){if(i.sheet!==e)continue;const o=t(r,i);void 0!==o&&(this.removeArray(r),n.push(o))}n.forEach((([e,t])=>{this.setArray(e,t)}))}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class D9{constructor(e){this.size=e}width(){return this.size.width}height(){return this.size.height}get(e,t){throw Error("Array not computed yet.")}simpleRangeValue(){throw Error("Array not computed yet.")}}class V9{constructor(e){if(this.size=new s5(e.length>0?e[0].length:0,e.length),this.array=e,this.size.width<=0||this.size.height<=0)throw Error("Incorrect array size")}static fromInterpreterValue(e){return new V9(e instanceof Z3?e.data:[[e]])}simpleRangeValue(){return Z3.onlyValues(this.array)}addRows(e,t){this.array.splice(e,0,...this.nullArrays(t,this.width())),this.size.height+=t}addColumns(e,t){for(let n=0;n<this.height();n++)this.array[n].splice(e,0,...new Array(t).fill(V3));this.size.width+=t}removeRows(e,t){if(this.outOfBound(0,e)||this.outOfBound(0,t))throw Error("Array index out of bound");const n=t-e+1;this.array.splice(e,n),this.size.height-=n}removeColumns(e,t){if(this.outOfBound(e,0)||this.outOfBound(t,0))throw Error("Array index out of bound");const n=t-e+1;for(const r of this.array)r.splice(e,n);this.size.width-=n}nullArrays(e,t){const n=[];for(let r=0;r<e;++r)n.push(new Array(t).fill(V3));return n}get(e,t){if(this.outOfBound(e,t))throw Error("Array index out of bound");return this.array[t][e]}set(e,t,n){if(this.outOfBound(e,t))throw Error("Array index out of bound");this.array[t][e]=n}width(){return this.size.width}height(){return this.size.height}raw(){return this.array}resize(e){if(this.height()<e.height&&isFinite(e.height)&&this.addRows(this.height(),e.height-this.height()),this.height()>e.height)throw Error("Resizing to smaller array");if(this.width()<e.width&&isFinite(e.width)&&this.addColumns(this.width(),e.width-this.width()),this.width()>e.width)throw Error("Resizing to smaller array")}outOfBound(e,t){return e<0||t<0||t>this.size.height-1||e>this.size.width-1}}class U9{constructor(e,t){this.error=e,this.size=t}get(e,t){return this.error}width(){return this.size.width}height(){return this.size.height}simpleRangeValue(){return this.error}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class B9{constructor(e,t,n){this.formula=e,this.cellAddress=t,this.version=n}get width(){return 1}get height(){return 1}static fromAst(e,t,n,r){return n.isScalar()?new j9(e,t,r):new W9(e,t,n,r)}getFormula(e){return this.ensureRecentData(e),this.formula}ensureRecentData(e){if(this.version!=e.version()){const[t,n,r]=e.applyTransformations(this.formula,this.cellAddress,this.version);this.formula=t,this.cellAddress=n,this.version=r}}getAddress(e){return this.ensureRecentData(e),this.cellAddress}}class W9 extends B9{constructor(e,t,n,r=0){super(e,t,r),n.isRef?this.array=new U9(new C4(t4.REF,K2.NoSpaceForArrayResult),s5.error()):this.array=new D9(n)}get width(){return this.array.width()}get height(){return this.array.height()}get sheet(){return this.cellAddress.sheet}get leftCorner(){return this.cellAddress}setCellValue(e){if(e instanceof C4)return this.setErrorValue(e),e;const t=V9.fromInterpreterValue(e);return t.resize(this.array.size),this.array=t,e}getCellValue(){if(this.array instanceof D9)throw Error("Array not computed yet.");return this.array.simpleRangeValue()}valueOrUndef(){if(!(this.array instanceof D9))return this.array.simpleRangeValue()}getArrayCellValue(e){const t=e.col-this.cellAddress.col,n=e.row-this.cellAddress.row;try{return this.array.get(t,n)}catch(r){return new C4(t4.REF)}}getArrayCellRawValue(e){const t=this.getArrayCellValue(e);return t instanceof C4||t===V3?void 0:U3(t)}setArrayCellValue(e,t){const n=e.col-this.cellAddress.col,r=e.row-this.cellAddress.row;this.array instanceof V9&&this.array.set(n,r,t)}setNoSpace(){return this.array=new U9(new C4(t4.SPILL,K2.NoSpaceForArrayResult),s5.error()),this.getCellValue()}getRange(){return L4.spanFrom(this.cellAddress,this.width,this.height)}getRangeOrUndef(){return L4.spanFromOrUndef(this.cellAddress,this.width,this.height)}setAddress(e){this.cellAddress=e}setFormula(e){this.formula=e}spansThroughSheetRows(e,t,n=t){return this.cellAddress.sheet===e&&this.cellAddress.row<=n&&t<this.cellAddress.row+this.height}spansThroughSheetColumn(e,t,n=t){return this.cellAddress.sheet===e&&this.cellAddress.col<=n&&t<this.cellAddress.col+this.width}isComputed(){return!(this.array instanceof D9)}columnsFromArray(){return t9.fromNumberOfColumns(this.cellAddress.sheet,this.cellAddress.col,this.width)}rowsFromArray(){return e9.fromNumberOfRows(this.cellAddress.sheet,this.cellAddress.row,this.height)}ensureRecentData(e){}isLeftCorner(e){return x4(this.cellAddress,e)}setErrorValue(e){this.array=new U9(e,this.array.size)}}class j9 extends B9{constructor(e,t,n){super(e,t,n)}valueOrUndef(){return this.cachedCellValue}setCellValue(e){return this.cachedCellValue=e,this.cachedCellValue}getCellValue(){if(void 0!==this.cachedCellValue)return this.cachedCellValue;throw Error("Value of the formula cell is not computed.")}isComputed(){return void 0!==this.cachedCellValue}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class G9{constructor(e){this.range=e,this.functionCache=new Map,this.criterionFunctionCache=new Map,this.dependentCacheRanges=new Set,this.bruteForce=!1}get start(){return this.range.start}get end(){return this.range.end}get sheet(){return this.range.start.sheet}getFunctionValue(e){return this.functionCache.get(e)}setFunctionValue(e,t){this.functionCache.set(e,t)}getCriterionFunctionValue(e,t){var n;return null===(n=this.getCriterionFunctionValues(e).get(t))||void 0===n?void 0:n[0]}getCriterionFunctionValues(e){var t;return null!==(t=this.criterionFunctionCache.get(e))&&void 0!==t?t:new Map}setCriterionFunctionValues(e,t){this.criterionFunctionCache.set(e,t)}addDependentCacheRange(e){e!==this&&this.dependentCacheRanges.add(e)}clearCache(){this.functionCache.clear(),this.criterionFunctionCache.clear(),this.dependentCacheRanges.forEach((e=>e.criterionFunctionCache.clear())),this.dependentCacheRanges.clear()}getStart(){return this.start}getEnd(){return this.end}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */const z9=(e,t,n,r,i)=>{if(t instanceof G9){const e=t.range.intersectionWith(n);return void 0!==e?Array.from(e.addresses(i)):[]}let o,s;return t instanceof B9?(o=t.getFormula(r),s=t.getAddress(r),P3(o,e).filter((e=>e instanceof _3)).map((e=>e.dependency.toSimpleCellAddress(s))).filter((e=>n.addressInRange(e)))):[]};
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */var $9;!function(e){e[e.ON_STACK=0]="ON_STACK",e[e.PROCESSED=1]="PROCESSED",e[e.POPPED=2]="POPPED"}($9||($9={}));class Y9{constructor(e=[],t=[]){this.nodesSparseArray=e,this.edgesSparseArray=t,this.entranceTime=[],this.low=[],this.parent=[],this.inSCC=[],this.nodeStatus=[],this.order=[],this.sccNonSingletons=[],this.timeCounter=0}getTopSortedWithSccSubgraphFrom(e,t,n){const r=e.reverse();return r.forEach((e=>this.runDFS(e))),this.postprocess(r,n,t)}getAdjacentNodeIds(e){return this.edgesSparseArray[e].filter((e=>void 0!==e&&this.nodesSparseArray[e]))}runDFS(e){if(void 0!==this.nodeStatus[e])return;this.nodeStatus[e]=$9.ON_STACK;const t=[e],n=[];for(;t.length>0;){const e=t[t.length-1];switch(this.nodeStatus[e]){case $9.ON_STACK:this.handleOnStack(e,n,t);break;case $9.PROCESSED:this.handleProcessed(e,n,t);break;case $9.POPPED:t.pop()}}}handleOnStack(e,t,n){this.entranceTime[e]=this.timeCounter,this.low[e]=this.timeCounter,this.timeCounter++,t.push(e),this.getAdjacentNodeIds(e).forEach((t=>{void 0===this.entranceTime[t]&&(n.push(t),this.parent[t]=e,this.nodeStatus[t]=$9.ON_STACK)})),this.nodeStatus[e]=$9.PROCESSED}handleProcessed(e,t,n){let r=this.entranceTime[e];if(this.getAdjacentNodeIds(e).forEach((t=>{this.inSCC[t]||(r=this.parent[t]===e?Math.min(r,this.low[t]):Math.min(r,this.entranceTime[t]))})),this.low[e]=r,r===this.entranceTime[e]){const n=[];do{n.push(t[t.length-1]),t.pop()}while(n[n.length-1]!==e);n.forEach((e=>{this.inSCC[e]=!0})),this.order.push(...n),n.length>1&&n.forEach((e=>{this.sccNonSingletons[e]=!0}))}n.pop(),this.nodeStatus[e]=$9.POPPED}postprocess(e,t,n){const r=[];e.forEach((e=>{r[e]=!0}));const i=[],o=[];return this.order.reverse(),this.order.forEach((e=>{const s=this.getAdjacentNodeIds(e);this.sccNonSingletons[e]||s.includes(e)?(o.push(this.nodesSparseArray[e]),t(this.nodesSparseArray[e]),s.forEach((e=>r[e]=!0))):(i.push(this.nodesSparseArray[e]),r[e]&&n(this.nodesSparseArray[e])&&s.forEach((e=>r[e]=!0)))})),{sorted:i,cycled:o}}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class K9{constructor(e,t){this.rawValue=e,this.processFn=t,this.processedValue=null}getProcessedValue(){return null===this.processedValue&&(this.processedValue=this.processFn(this.rawValue)),this.processedValue}markAsModified(){this.processedValue=null}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class X9{constructor(e){this.dependencyQuery=e,this.nodesSparseArray=[],this.edgesSparseArray=[],this.nodesIds=new Map,this.dirtyAndVolatileNodeIds=new K9({dirty:[],volatile:[]},(e=>this.processDirtyAndVolatileNodeIds(e))),this.infiniteRangeIds=new Set,this.changingWithStructureNodeIds=[],this.nextId=0}getNodes(){return this.nodesSparseArray.filter((e=>void 0!==e))}hasNode(e){return this.nodesIds.has(e)}existsEdge(e,t){const n=this.getNodeId(e),r=this.getNodeId(t);return void 0!==n&&void 0!==r&&this.edgesSparseArray[n].includes(r)}adjacentNodes(e){const t=this.getNodeId(e);if(void 0===t)throw this.missingNodeError(e);return new Set(this.edgesSparseArray[t].filter((e=>void 0!==e)).map((e=>this.nodesSparseArray[e])))}adjacentNodesCount(e){const t=this.getNodeId(e);if(void 0===t)throw this.missingNodeError(e);return this.fixEdgesArrayForNode(t).length}addNodeAndReturnId(e){const t=this.nodesIds.get(e);if(void 0!==t)return t;const n=this.nextId;return this.nextId++,this.nodesSparseArray[n]=e,this.edgesSparseArray[n]=[],this.nodesIds.set(e,n),n}addEdge(e,t){const n=this.getNodeIdIfNotNumber(e),r=this.getNodeIdIfNotNumber(t);if(void 0===n)throw this.missingNodeError(e);if(void 0===r)throw this.missingNodeError(t);this.edgesSparseArray[n].includes(r)||this.edgesSparseArray[n].push(r)}removeNode(e){const t=this.getNodeId(e);if(void 0===t)throw this.missingNodeError(e);this.edgesSparseArray[t].length>0&&(this.edgesSparseArray[t].forEach((e=>this.dirtyAndVolatileNodeIds.rawValue.dirty.push(e))),this.dirtyAndVolatileNodeIds.markAsModified());const n=this.removeDependencies(e);return delete this.nodesSparseArray[t],delete this.edgesSparseArray[t],this.infiniteRangeIds.delete(t),this.nodesIds.delete(e),n}removeEdge(e,t){const n=this.getNodeIdIfNotNumber(e),r=this.getNodeIdIfNotNumber(t);if(void 0===n)throw this.missingNodeError(e);if(void 0===r)throw this.missingNodeError(t);const i=this.edgesSparseArray[n].indexOf(r);if(-1===i)throw new Error("Edge does not exist");delete this.edgesSparseArray[n][i]}removeEdgeIfExists(e,t){const n=this.getNodeId(e),r=this.getNodeId(t);if(void 0===n)return;if(void 0===r)return;const i=this.edgesSparseArray[n].indexOf(r);-1!==i&&delete this.edgesSparseArray[n][i]}topSortWithScc(){return this.getTopSortedWithSccSubgraphFrom(this.getNodes(),(()=>!0),(()=>{}))}getTopSortedWithSccSubgraphFrom(e,t,n){const r=new Y9(this.nodesSparseArray,this.edgesSparseArray),i=e.map((e=>this.getNodeId(e))).filter((e=>void 0!==e));return r.getTopSortedWithSccSubgraphFrom(i,t,n)}markNodeAsVolatile(e){const t=this.getNodeId(e);void 0!==t&&(this.dirtyAndVolatileNodeIds.rawValue.volatile.push(t),this.dirtyAndVolatileNodeIds.markAsModified())}markNodeAsDirty(e){const t=this.getNodeId(e);void 0!==t&&(this.dirtyAndVolatileNodeIds.rawValue.dirty.push(t),this.dirtyAndVolatileNodeIds.markAsModified())}getDirtyAndVolatileNodes(){return this.dirtyAndVolatileNodeIds.getProcessedValue()}clearDirtyNodes(){this.dirtyAndVolatileNodeIds.rawValue.dirty=[],this.dirtyAndVolatileNodeIds.markAsModified()}markNodeAsChangingWithStructure(e){const t=this.getNodeId(e);void 0!==t&&this.changingWithStructureNodeIds.push(t)}markChangingWithStructureNodesAsDirty(){this.changingWithStructureNodeIds.length<=0||(this.dirtyAndVolatileNodeIds.rawValue.dirty=[...this.dirtyAndVolatileNodeIds.rawValue.dirty,...this.changingWithStructureNodeIds],this.dirtyAndVolatileNodeIds.markAsModified())}markNodeAsInfiniteRange(e){const t=this.getNodeIdIfNotNumber(e);void 0!==t&&this.infiniteRangeIds.add(t)}getInfiniteRanges(){return[...this.infiniteRangeIds].map((e=>({node:this.nodesSparseArray[e],id:e})))}getNodeId(e){return this.nodesIds.get(e)}getNodeIdIfNotNumber(e){return"number"==typeof e?e:this.nodesIds.get(e)}fixEdgesArrayForNode(e){const t=this.edgesSparseArray[e];return this.edgesSparseArray[e]=t.filter((e=>void 0!==e&&this.nodesSparseArray[e])),this.edgesSparseArray[e]}removeDependencies(e){const t=this.dependencyQuery(e);return t.forEach((([t,n])=>{this.removeEdgeIfExists(n,e)})),t}processDirtyAndVolatileNodeIds({dirty:e,volatile:t}){return[...new Set([...e,...t])].map((e=>this.nodesSparseArray[e])).filter((e=>void 0!==e))}missingNodeError(e){return new Error(`Unknown node ${e}`)}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class q9{constructor(){this.rangeMapping=new Map}getMappingSize(e){var t,n;return null!==(n=null===(t=this.rangeMapping.get(e))||void 0===t?void 0:t.size)&&void 0!==n?n:0}setRange(e){let t=this.rangeMapping.get(e.getStart().sheet);void 0===t&&(t=new Map,this.rangeMapping.set(e.getStart().sheet,t));const n=Q9(e.getStart(),e.getEnd());t.set(n,e)}removeRange(e){const t=e.getStart().sheet,n=this.rangeMapping.get(t);if(void 0===n)return;const r=Q9(e.getStart(),e.getEnd());n.delete(r),0===n.size&&this.rangeMapping.delete(t)}getRange(e,t){const n=this.rangeMapping.get(e.sheet),r=Q9(e,t);return null==n?void 0:n.get(r)}fetchRange(e,t){const n=this.getRange(e,t);if(!n)throw Error("Range does not exist");return n}truncateRanges(e,t){const n=Array(),r=Array(),i=Array(),o=e.sheet;for(const[l,h]of this.entriesFromSheet(e.sheet)){const s=h.range;e.start<=t(h.range.end)&&(s.removeSpan(e),s.shouldBeRemoved()?(this.removeByKey(o,l),n.push(h)):r.push([l,h]),i.push(h))}const s=[];r.sort(((e,n)=>Z9(e[1],n[1],t)));for(const[l,h]of r){const e=Q9((a=h.range).start,a.end);if(e===l)continue;const t=this.getByKey(o,e);this.removeByKey(o,l),void 0!==t&&h!=t?s.push([t,h]):this.setRange(h)}var a;return{verticesToRemove:n,verticesToMerge:s,verticesWithChangedSize:i}}moveAllRangesInSheetAfterRowByRows(e,t,n){return this.updateVerticesFromSheet(e,((e,r)=>t<=r.start.row?(r.range.shiftByRows(n),{changedSize:!1,vertex:r}):t>r.start.row&&t<=r.end.row?(r.range.expandByRows(n),{changedSize:!0,vertex:r}):void 0))}moveAllRangesInSheetAfterColumnByColumns(e,t,n){return this.updateVerticesFromSheet(e,((e,r)=>t<=r.start.col?(r.range.shiftByColumns(n),{changedSize:!1,vertex:r}):t>r.start.col&&t<=r.end.col?(r.range.expandByColumns(n),{changedSize:!0,vertex:r}):void 0))}moveRangesInsideSourceRange(e,t,n,r){this.updateVerticesFromSheet(e.sheet,((i,o)=>e.containsRange(o.range)?(o.range.shiftByColumns(t),o.range.shiftByRows(n),o.range.moveToSheet(r),{changedSize:!1,vertex:o}):void 0))}removeRangesInSheet(e){if(this.rangeMapping.has(e)){const t=this.rangeMapping.get(e).values();return this.rangeMapping.delete(e),t}return[][Symbol.iterator]()}*rangesInSheet(e){const t=this.rangeMapping.get(e);t&&(yield*t.values())}*rangeVerticesContainedInRange(e){for(const t of this.rangesInSheet(e.sheet))e.containsRange(t.range)&&(yield t)}findSmallerRange(e){if(e.height()>1&&Number.isFinite(e.height())){const t=T4(e.end.sheet,e.end.col,e.end.row-1),n=this.getRange(e.start,t);if(void 0!==n){return{smallerRangeVertex:n,restRange:L4.fromSimpleCellAddresses(T4(e.start.sheet,e.start.col,e.end.row),e.end)}}}return{restRange:e}}*entriesFromSheet(e){const t=this.rangeMapping.get(e);t&&(yield*t.entries())}removeByKey(e,t){this.rangeMapping.get(e).delete(t)}getByKey(e,t){var n;return null===(n=this.rangeMapping.get(e))||void 0===n?void 0:n.get(t)}updateVerticesFromSheet(e,t){const n=Array();for(const[r,i]of this.entriesFromSheet(e)){const o=t(r,i);void 0!==o&&(this.removeByKey(e,r),n.push(o))}return n.forEach((e=>{this.setRange(e.vertex)})),{verticesWithChangedSize:n.filter((e=>e.changedSize)).map((e=>e.vertex))}}}function Q9(e,t){return`${e.col},${e.row},${t.col},${t.row}`}const Z9=(e,t,n)=>{const r=n(e.range.start),i=n(e.range.start);if(r===i){return n(e.range.end)-n(t.range.end)}return r-i};
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class J9{constructor(e,t,n){this.functions=e,this.errors=t,this.ui=n,this._protectedTranslations={VERSION:"VERSION"},this.checkUI(),this.checkErrors(),this.checkFunctionTranslations(this.functions),Object.assign(this.functions,this._protectedTranslations)}extendFunctions(e){this.checkFunctionTranslations(e),Object.assign(this.functions,e)}buildFunctionMapping(){return Object.keys(this.functions).reduce(((e,t)=>(e[this.functions[t]]=t,e)),{})}buildErrorMapping(){return Object.keys(this.errors).reduce(((e,t)=>(e[this.errors[t]]=t,e)),{})}isFunctionTranslated(e){return void 0!==this.functions[e]}getFunctionTranslations(e){const t=[];for(const n of e)this.isFunctionTranslated(n)&&t.push(this.functions[n]);return t}getFunctionTranslation(e){const t=this.functions[e];if(void 0===t)throw new N9(`functions.${e}`);return t}getMaybeFunctionTranslation(e){return this.functions[e]}getErrorTranslation(e){if(e===t4.LIC)return`#${t4.LIC}!`;const t=this.errors[e];if(void 0===t)throw new N9(`errors.${e}`);return t}getUITranslation(e){const t=this.ui[e];if(void 0===t)throw new N9(`ui.${e}`);return t}checkUI(){for(const e of Object.values(e4))if(!(e in this.ui))throw new N9(`ui.${e}`)}checkErrors(){for(const e of Object.values(t4))if(!(e in this.errors)&&e!==t4.LIC)throw new N9(`errors.${e}`)}checkFunctionTranslations(e){const t=new Set(Object.getOwnPropertyNames(e));for(const n of Object.getOwnPropertyNames(this._protectedTranslations))if(t.has(n))throw new A9(n)}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
var e4,t4,n4;
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
function r4(e){return e.toLowerCase()}!function(e){e.NEW_SHEET_PREFIX="NEW_SHEET_PREFIX"}(e4||(e4={}));class i4{constructor(e,t){this.id=e,this.displayName=t}get canonicalName(){return r4(this.displayName)}}class o4{constructor(e){this.languages=e,this.mappingFromCanonicalName=new Map,this.mappingFromId=new Map,this.lastSheetId=-1,this.fetch=e=>{const t=this.mappingFromCanonicalName.get(r4(e));if(void 0===t)throw new o9(e);return t.id},this.get=e=>{var t;return null===(t=this.mappingFromCanonicalName.get(r4(e)))||void 0===t?void 0:t.id},this.fetchDisplayName=e=>this.fetchSheetById(e).displayName,this.sheetNamePrefix=e.getUITranslation(e4.NEW_SHEET_PREFIX)}addSheet(e=`${this.sheetNamePrefix}${this.lastSheetId+2}`){const t=r4(e);if(this.mappingFromCanonicalName.has(t))throw new s9(e);this.lastSheetId++;const n=new i4(this.lastSheetId,e);return this.store(n),n.id}removeSheet(e){const t=this.fetchSheetById(e);e==this.lastSheetId&&--this.lastSheetId,this.mappingFromCanonicalName.delete(t.canonicalName),this.mappingFromId.delete(t.id)}getDisplayName(e){var t;return null===(t=this.mappingFromId.get(e))||void 0===t?void 0:t.displayName}*displayNames(){for(const e of this.mappingFromCanonicalName.values())yield e.displayName}numberOfSheets(){return this.mappingFromCanonicalName.size}hasSheetWithId(e){return this.mappingFromId.has(e)}hasSheetWithName(e){return this.mappingFromCanonicalName.has(r4(e))}renameSheet(e,t){const n=this.fetchSheetById(e),r=n.displayName;if(r===t)return;const i=this.mappingFromCanonicalName.get(r4(t));if(void 0!==i&&i.id!==n.id)throw new s9(t);const o=n.canonicalName;return this.mappingFromCanonicalName.delete(o),n.displayName=t,this.store(n),r}sheetNames(){return Array.from(this.mappingFromId.values()).map((e=>e.displayName))}store(e){this.mappingFromId.set(e.id,e),this.mappingFromCanonicalName.set(e.canonicalName,e)}fetchSheetById(e){const t=this.mappingFromId.get(e);if(void 0===t)throw new i9(e);return t}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class s4{constructor(e,t,n,r,i,o,s,a){this.addressMapping=e,this.rangeMapping=t,this.sheetMapping=n,this.arrayMapping=r,this.stats=i,this.lazilyTransformingAstService=o,this.functionRegistry=s,this.namedExpressions=a,this.changes=J3.empty(),this.dependencyQueryAddresses=e=>{if(e instanceof G9)return this.rangeDependencyQuery(e).map((([e,t])=>e));{const t=this.formulaDependencyQuery(e);if(void 0!==t){const[e,n]=t;return n.map((t=>t instanceof F3?this.namedExpressions.namedExpressionOrPlaceholder(t.name,e.sheet).address:I4(t)?t:_4(t.start,t.end)))}return[]}},this.dependencyQueryVertices=e=>{if(e instanceof G9)return this.rangeDependencyQuery(e);{const t=this.formulaDependencyQuery(e);if(void 0!==t){const[e,n]=t;return n.map((t=>{if(t instanceof L4)return[t.start,this.rangeMapping.fetchRange(t.start,t.end)];if(t instanceof F3){const n=this.namedExpressions.namedExpressionOrPlaceholder(t.name,e.sheet);return[n.address,this.addressMapping.fetchCell(n.address)]}return[t,this.addressMapping.fetchCell(t)]}))}return[]}},this.rangeDependencyQuery=e=>{const t=[],{smallerRangeVertex:n,restRange:r}=this.rangeMapping.findSmallerRange(e.range);let i;void 0!==n&&this.graph.adjacentNodes(n).has(e)?(i=r,t.push([new L4(n.start,n.end),n])):i=e.range;for(const o of i.addresses(this)){const e=this.addressMapping.getCell(o);void 0!==e&&t.push([o,e])}return t},this.formulaDependencyQuery=e=>{let t,n;if(!(e instanceof B9))return;n=e.getAddress(this.lazilyTransformingAstService),t=e.getFormula(this.lazilyTransformingAstService);const r=P3(t,this.functionRegistry);return[n,D3(r,n)]},this.graph=new X9(this.dependencyQueryVertices)}static buildEmpty(e,t,n,r,i){return new s4(new k9(t.chooseAddressMappingPolicy),new q9,new o4(t.translationPackage),new F9,i,e,n,r)}setFormulaToCell(e,t,n,r,i,o){const s=B9.fromAst(t,e,r,this.lazilyTransformingAstService.version());return this.exchangeOrAddFormulaVertex(s),this.processCellDependencies(n,s),this.graph.markNodeAsDirty(s),i&&this.markAsVolatile(s),o&&this.markAsDependentOnStructureChange(s),this.correctInfiniteRangesDependency(e),this.getAndClearContentChanges()}setParsingErrorToCell(e,t){const n=this.shrinkPossibleArrayAndGetCell(e);return this.exchangeOrAddGraphNode(n,t),this.addressMapping.setCell(e,t),this.graph.markNodeAsDirty(t),this.correctInfiniteRangesDependency(e),this.getAndClearContentChanges()}setValueToCell(e,t){const n=this.shrinkPossibleArrayAndGetCell(e);if(n instanceof W9&&this.arrayMapping.removeArray(n.getRange()),n instanceof l4){n.getValues().rawValue!==t.rawValue&&(n.setValues(t),this.graph.markNodeAsDirty(n))}else{const r=new l4(t.parsedValue,t.rawValue);this.exchangeOrAddGraphNode(n,r),this.addressMapping.setCell(e,r),this.graph.markNodeAsDirty(r)}return this.correctInfiniteRangesDependency(e),this.getAndClearContentChanges()}setCellEmpty(e){const t=this.shrinkPossibleArrayAndGetCell(e);if(void 0===t)return J3.empty();if(this.graph.adjacentNodes(t).size>0){const n=new a4;this.exchangeGraphNode(t,n),0===this.graph.adjacentNodesCount(n)?(this.removeVertex(n),this.addressMapping.removeCell(e)):(this.graph.markNodeAsDirty(n),this.addressMapping.setCell(e,n))}else this.removeVertex(t),this.addressMapping.removeCell(e);return this.getAndClearContentChanges()}clearDirtyVertices(){this.graph.clearDirtyNodes()}verticesToRecompute(){return this.graph.getDirtyAndVolatileNodes()}processCellDependencies(e,t){const n=this.graph.getNodeId(t);e.forEach((e=>{if(e instanceof L4){const t=e;let r=this.getRange(t.start,t.end);void 0===r&&(r=new G9(t),this.rangeMapping.setRange(r)),this.graph.addNodeAndReturnId(r);const i=this.graph.getNodeId(r);t.isFinite()||this.graph.markNodeAsInfiniteRange(i);const{smallerRangeVertex:o,restRange:s}=this.rangeMapping.findSmallerRange(t);if(void 0!==o){if(this.graph.addEdge(o,i),r.bruteForce){r.bruteForce=!1;for(const e of t.addresses(this))this.graph.removeEdge(this.fetchCell(e),i)}}else r.bruteForce=!0;const a=this.arrayMapping.getArray(s);if(void 0!==a)this.graph.addEdge(a,i);else for(const e of s.addresses(this)){const{vertex:t,id:n}=this.fetchCellOrCreateEmpty(e);this.graph.addEdge(null!=n?n:t,i)}this.graph.addEdge(i,n),t.isFinite()&&this.correctInfiniteRangesDependenciesByRangeVertex(r)}else if(e instanceof F3){const r=t.getAddress(this.lazilyTransformingAstService).sheet,{vertex:i,id:o}=this.fetchNamedExpressionVertex(e.name,r);this.graph.addEdge(null!=o?o:i,n)}else{const{vertex:t,id:r}=this.fetchCellOrCreateEmpty(e);this.graph.addEdge(null!=r?r:t,n)}}))}fetchNamedExpressionVertex(e,t){const n=this.namedExpressions.namedExpressionOrPlaceholder(e,t);return this.fetchCellOrCreateEmpty(n.address)}exchangeNode(e,t){const n=this.fetchCellOrCreateEmpty(e).vertex,r=this.fetchCellOrCreateEmpty(t).vertex;this.addressMapping.removeCell(e),this.exchangeGraphNode(n,r)}fetchCellOrCreateEmpty(e){const t=this.addressMapping.getCell(e);if(void 0!==t)return{vertex:t,id:void 0};const n=new a4,r=this.graph.addNodeAndReturnId(n);return this.addressMapping.setCell(e,n),{vertex:n,id:r}}removeRows(e){this.stats.measure(q3.ADJUSTING_GRAPH,(()=>{for(const[t,n]of this.addressMapping.entriesFromRowsSpan(e)){for(const e of this.graph.adjacentNodes(n))this.graph.markNodeAsDirty(e);if(n instanceof W9){if(!n.isLeftCorner(t))continue;this.shrinkArrayToCorner(n),this.arrayMapping.removeArray(n.getRange())}this.removeVertex(n)}})),this.stats.measure(q3.ADJUSTING_ADDRESS_MAPPING,(()=>{this.addressMapping.removeRows(e)}));const t=this.stats.measure(q3.ADJUSTING_RANGES,(()=>{const t=this.truncateRanges(e,(e=>e.row));return this.getArrayVerticesRelatedToRanges(t)}));return this.stats.measure(q3.ADJUSTING_ARRAY_MAPPING,(()=>{this.fixArraysAfterRemovingRows(e.sheet,e.rowStart,e.numberOfRows)})),this.addStructuralNodesToChangeSet(),{affectedArrays:t,contentChanges:this.getAndClearContentChanges()}}removeSheet(e){this.clearSheet(e);for(const[t,n]of this.addressMapping.sheetEntries(e)){for(const e of this.graph.adjacentNodes(n))this.graph.markNodeAsDirty(e);this.removeVertex(n),this.addressMapping.removeCell(t)}this.stats.measure(q3.ADJUSTING_RANGES,(()=>{const t=this.rangeMapping.removeRangesInSheet(e);for(const e of t)this.removeVertex(e);this.stats.measure(q3.ADJUSTING_ADDRESS_MAPPING,(()=>{this.addressMapping.removeSheet(e)}))}))}clearSheet(e){const t=new Set;for(const[n,r]of this.addressMapping.sheetEntries(e))r instanceof W9?t.add(r):this.setCellEmpty(n);for(const n of t.values())this.setArrayEmpty(n);this.addStructuralNodesToChangeSet()}removeColumns(e){this.stats.measure(q3.ADJUSTING_GRAPH,(()=>{for(const[t,n]of this.addressMapping.entriesFromColumnsSpan(e)){for(const e of this.graph.adjacentNodes(n))this.graph.markNodeAsDirty(e);if(n instanceof W9){if(!n.isLeftCorner(t))continue;this.shrinkArrayToCorner(n),this.arrayMapping.removeArray(n.getRange())}this.removeVertex(n)}})),this.stats.measure(q3.ADJUSTING_ADDRESS_MAPPING,(()=>{this.addressMapping.removeColumns(e)}));const t=this.stats.measure(q3.ADJUSTING_RANGES,(()=>{const t=this.truncateRanges(e,(e=>e.col));return this.getArrayVerticesRelatedToRanges(t)}));return this.stats.measure(q3.ADJUSTING_ARRAY_MAPPING,(()=>this.fixArraysAfterRemovingColumns(e.sheet,e.columnStart,e.numberOfColumns))),this.addStructuralNodesToChangeSet(),{affectedArrays:t,contentChanges:this.getAndClearContentChanges()}}addRows(e){this.stats.measure(q3.ADJUSTING_ADDRESS_MAPPING,(()=>{this.addressMapping.addRows(e.sheet,e.rowStart,e.numberOfRows)}));const t=this.stats.measure(q3.ADJUSTING_RANGES,(()=>{const t=this.rangeMapping.moveAllRangesInSheetAfterRowByRows(e.sheet,e.rowStart,e.numberOfRows);return this.fixRangesWhenAddingRows(e.sheet,e.rowStart,e.numberOfRows),this.getArrayVerticesRelatedToRanges(t.verticesWithChangedSize)}));this.stats.measure(q3.ADJUSTING_ARRAY_MAPPING,(()=>{this.fixArraysAfterAddingRow(e.sheet,e.rowStart,e.numberOfRows)}));for(const n of this.addressMapping.verticesFromRowsSpan(e))this.graph.markNodeAsDirty(n);return this.addStructuralNodesToChangeSet(),{affectedArrays:t}}addColumns(e){this.stats.measure(q3.ADJUSTING_ADDRESS_MAPPING,(()=>{this.addressMapping.addColumns(e.sheet,e.columnStart,e.numberOfColumns)}));const t=this.stats.measure(q3.ADJUSTING_RANGES,(()=>{const t=this.rangeMapping.moveAllRangesInSheetAfterColumnByColumns(e.sheet,e.columnStart,e.numberOfColumns);return this.fixRangesWhenAddingColumns(e.sheet,e.columnStart,e.numberOfColumns),this.getArrayVerticesRelatedToRanges(t.verticesWithChangedSize)}));this.stats.measure(q3.ADJUSTING_ARRAY_MAPPING,(()=>this.fixArraysAfterAddingColumn(e.sheet,e.columnStart,e.numberOfColumns)));for(const n of this.addressMapping.verticesFromColumnsSpan(e))this.graph.markNodeAsDirty(n);return this.addStructuralNodesToChangeSet(),{affectedArrays:t,contentChanges:this.getAndClearContentChanges()}}isThereSpaceForArray(e){const t=e.getRangeOrUndef();if(void 0===t)return!1;for(const n of t.addresses(this)){const t=this.addressMapping.getCell(n);if(void 0!==t&&!(t instanceof a4)&&t!==e)return!1}return!0}moveCells(e,t,n,r){for(const i of e.addressesWithDirection(t,n,this)){const o=T4(r,i.col+t,i.row+n);let s=this.addressMapping.getCell(i);const a=this.addressMapping.getCell(o);if(this.addressMapping.removeCell(i),void 0!==s){let t;this.graph.markNodeAsDirty(s),this.addressMapping.setCell(o,s);for(const n of this.graph.adjacentNodes(s))n instanceof G9&&!e.containsRange(n.range)&&(t=null!=t?t:this.fetchCellOrCreateEmpty(i).vertex,this.graph.addEdge(t,n),this.graph.removeEdge(s,n));t&&(this.graph.markNodeAsDirty(t),this.addressMapping.setCell(i,t))}if(void 0!==a){void 0===s&&this.addressMapping.removeCell(o);for(const e of this.graph.adjacentNodes(a))s=null!=s?s:this.fetchCellOrCreateEmpty(o).vertex,this.graph.addEdge(s,e),this.graph.markNodeAsDirty(s);this.removeVertex(a)}}for(const i of this.rangeMapping.rangeVerticesContainedInRange(e))for(const t of this.graph.adjacentNodes(i))if(t instanceof G9&&!e.containsRange(t.range)){this.graph.removeEdge(i,t);for(const e of i.range.addresses(this)){const{vertex:n,id:r}=this.fetchCellOrCreateEmpty(e);this.graph.addEdge(null!=r?r:n,t),this.addressMapping.setCell(e,n),this.graph.markNodeAsDirty(n)}}this.rangeMapping.moveRangesInsideSourceRange(e,t,n,r)}setArrayEmpty(e){const t=L4.spanFrom(e.getAddress(this.lazilyTransformingAstService),e.width,e.height),n=this.graph.adjacentNodes(e);for(const r of t.addresses(this))this.addressMapping.removeCell(r);for(const r of n.values()){const t=z9(this.functionRegistry,r,e.getRange(),this.lazilyTransformingAstService,this);for(const e of t){const{vertex:t,id:n}=this.fetchCellOrCreateEmpty(e);this.graph.addEdge(null!=n?n:t,r)}t.length>0&&this.graph.markNodeAsDirty(r)}this.removeVertex(e),this.arrayMapping.removeArray(e.getRange())}addVertex(e,t){this.graph.addNodeAndReturnId(t),this.addressMapping.setCell(e,t)}addArrayVertex(e,t){this.graph.addNodeAndReturnId(t),this.setAddressMappingForArrayVertex(t,e)}*arrayFormulaNodes(){for(const e of this.graph.getNodes())e instanceof W9&&(yield e)}*entriesFromRowsSpan(e){yield*this.addressMapping.entriesFromRowsSpan(e)}*entriesFromColumnsSpan(e){yield*this.addressMapping.entriesFromColumnsSpan(e)}fetchCell(e){return this.addressMapping.fetchCell(e)}getCell(e){return this.addressMapping.getCell(e)}getCellValue(e){return this.addressMapping.getCellValue(e)}getRawValue(e){return this.addressMapping.getRawValue(e)}getScalarValue(e){const t=this.addressMapping.getCellValue(e);return t instanceof Z3?new C4(t4.VALUE,K2.ScalarExpected):t}existsEdge(e,t){return this.graph.existsEdge(e,t)}getSheetId(e){return this.sheetMapping.fetch(e)}getSheetHeight(e){return this.addressMapping.getHeight(e)}getSheetWidth(e){return this.addressMapping.getWidth(e)}getArray(e){return this.arrayMapping.getArray(e)}getRange(e,t){return this.rangeMapping.getRange(e,t)}topSortWithScc(){return this.graph.topSortWithScc()}markAsVolatile(e){this.graph.markNodeAsVolatile(e)}markAsDependentOnStructureChange(e){this.graph.markNodeAsChangingWithStructure(e)}forceApplyPostponedTransformations(){for(const e of this.graph.getNodes())e instanceof j9&&e.ensureRecentData(this.lazilyTransformingAstService)}*rawValuesFromRange(e){for(const t of e.addresses(this)){const e=this.getScalarValue(t);e!==V3&&(yield[U3(e),t])}}computeListOfValuesInRange(e){const t=[];for(const n of e.addresses(this)){const e=this.getScalarValue(n);t.push(e)}return t}shrinkArrayToCorner(e){this.cleanAddressMappingUnderArray(e);for(const t of this.adjacentArrayVertices(e)){let n;n=t instanceof B9?this.formulaDirectDependenciesToArray(t,e):this.rangeDirectDependenciesToArray(t,e);let r=!1;for(const[i,o]of n)e.isLeftCorner(i)&&(r=!0),this.graph.addEdge(o,t),this.graph.markNodeAsDirty(o);r||this.graph.removeEdge(e,t)}this.graph.markNodeAsDirty(e)}isArrayInternalCell(e){const t=this.getCell(e);return t instanceof W9&&!t.isLeftCorner(e)}getAndClearContentChanges(){const e=this.changes;return this.changes=J3.empty(),e}getAdjacentNodesAddresses(e){const t=this.graph.adjacentNodes(e),n=[];return t.forEach((e=>{const t=e;t instanceof G9?n.push(_4(t.start,t.end)):n.push(t.getAddress(this.lazilyTransformingAstService))})),n}exchangeGraphNode(e,t){this.graph.addNodeAndReturnId(t);const n=this.graph.adjacentNodes(e);this.removeVertex(e),n.forEach((e=>{this.graph.hasNode(e)&&this.graph.addEdge(t,e)}))}setArray(e,t){this.arrayMapping.setArray(e,t)}correctInfiniteRangesDependency(e){const t=this.graph.getInfiniteRanges().filter((({node:t})=>t.range.addressInRange(e)));if(t.length<=0)return;const{vertex:n,id:r}=this.fetchCellOrCreateEmpty(e),i=null!=r?r:this.graph.getNodeId(n);t.forEach((({id:e})=>{this.graph.addEdge(i,e)}))}exchangeOrAddGraphNode(e,t){e?this.exchangeGraphNode(e,t):this.graph.addNodeAndReturnId(t)}getArrayVerticesRelatedToRanges(e){const t=new Set;return e.forEach((e=>{this.graph.hasNode(e)&&this.graph.adjacentNodes(e).forEach((e=>{e instanceof W9&&t.add(e)}))})),t}correctInfiniteRangesDependenciesByRangeVertex(e){this.graph.getInfiniteRanges().forEach((({id:t,node:n})=>{const r=e.range.intersectionWith(n.range);void 0!==r&&r.addresses(this).forEach((e=>{const{vertex:n,id:r}=this.fetchCellOrCreateEmpty(e);this.graph.addEdge(null!=r?r:n,t)}))}))}cleanAddressMappingUnderArray(e){const t=e.getRange();for(const n of t.addresses(this)){const t=e.getArrayCellValue(n);this.getCell(n)===e?e.isLeftCorner(n)?this.changes.addChange(new C4(t4.REF),n,t):(this.addressMapping.removeCell(n),this.changes.addChange(V3,n,t)):this.changes.addChange(V3,n,t)}}*formulaDirectDependenciesToArray(e,t){var n;const[,r]=null!==(n=this.formulaDependencyQuery(e))&&void 0!==n?n:[];if(void 0!==r)for(const i of r)if(!(i instanceof F3||i instanceof L4)&&t.getRange().addressInRange(i)){const e=this.fetchCellOrCreateEmpty(i).vertex;yield[i,e]}}*rangeDirectDependenciesToArray(e,t){const{restRange:n}=this.rangeMapping.findSmallerRange(e.range);for(const r of n.addresses(this))if(t.getRange().addressInRange(r)){const e=this.fetchCellOrCreateEmpty(r).vertex;yield[r,e]}}*adjacentArrayVertices(e){const t=this.graph.adjacentNodes(e);for(const n of t)(n instanceof B9||n instanceof G9)&&(yield n)}addStructuralNodesToChangeSet(){this.graph.markChangingWithStructureNodesAsDirty()}fixRangesWhenAddingRows(e,t,n){const r=Array.from(this.rangeMapping.rangesInSheet(e));for(const i of r)if(i.range.includesRow(t+n))if(i.bruteForce){const e=i.range.rangeWithSameWidth(t,n);for(const t of e.addresses(this)){const{vertex:e,id:n}=this.fetchCellOrCreateEmpty(t);this.graph.addEdge(null!=n?n:e,i)}}else{let e=i,t=this.rangeMapping.findSmallerRange(e.range);if(void 0!==t.smallerRangeVertex)continue;for(;void 0===t.smallerRangeVertex;){const n=new G9(L4.spanFrom(e.range.start,e.range.width(),e.range.height()-1));this.rangeMapping.setRange(n),this.graph.addNodeAndReturnId(n);const r=new L4(T4(e.range.start.sheet,e.range.start.col,e.range.end.row),e.range.end);this.addAllFromRange(r,e),this.graph.addEdge(n,e),e=n,t=this.rangeMapping.findSmallerRange(e.range)}this.graph.addEdge(t.smallerRangeVertex,e),this.addAllFromRange(t.restRange,e),this.graph.removeEdge(t.smallerRangeVertex,i)}}addAllFromRange(e,t){for(const n of e.addresses(this)){const{vertex:e,id:r}=this.fetchCellOrCreateEmpty(n);this.graph.addEdge(null!=r?r:e,t)}}fixRangesWhenAddingColumns(e,t,n){for(const r of this.rangeMapping.rangesInSheet(e))if(r.range.includesColumn(t+n)){let i;i=r.bruteForce?r.range.rangeWithSameHeight(t,n):L4.spanFrom(T4(e,t,r.range.end.row),n,1);for(const e of i.addresses(this)){const{vertex:t,id:n}=this.fetchCellOrCreateEmpty(e);this.graph.addEdge(null!=n?n:t,r)}}}exchangeOrAddFormulaVertex(e){const t=e.getAddress(this.lazilyTransformingAstService),n=L4.spanFrom(t,e.width,e.height),r=this.shrinkPossibleArrayAndGetCell(t);if(e instanceof W9&&this.setArray(n,e),this.exchangeOrAddGraphNode(r,e),this.addressMapping.setCell(t,e),e instanceof W9){if(!this.isThereSpaceForArray(e))return;for(const t of n.addresses(this)){if(e.isLeftCorner(t))continue;const n=this.getCell(t);this.exchangeOrAddGraphNode(n,e)}}for(const i of n.addresses(this))this.addressMapping.setCell(i,e)}setAddressMappingForArrayVertex(e,t){if(this.addressMapping.setCell(t,e),!(e instanceof W9))return;const n=L4.spanFromOrUndef(t,e.width,e.height);if(void 0!==n&&(this.setArray(n,e),this.isThereSpaceForArray(e)))for(const r of n.addresses(this))this.addressMapping.setCell(r,e)}truncateRanges(e,t){const{verticesToRemove:n,verticesToMerge:r,verticesWithChangedSize:i}=this.rangeMapping.truncateRanges(e,t);for(const[o,s]of r)this.mergeRangeVertices(o,s);for(const o of n)this.removeVertexAndCleanupDependencies(o);return i}fixArraysAfterAddingRow(e,t,n){if(this.arrayMapping.moveArrayVerticesAfterRowByRows(e,t,n),!(t<=0))for(const[,r]of this.arrayMapping.arraysInRows(e9.fromRowStartAndEnd(e,t-1,t-1))){const i=r.getRange();for(let o=i.start.col;o<=i.end.col;++o)for(let s=t;s<=i.end.row;++s){const t=T4(e,o,s),i=T4(e,o,s+n),a=r.getArrayCellValue(t);this.addressMapping.moveCell(i,t),this.changes.addChange(V3,i,a)}}}fixArraysAfterRemovingRows(e,t,n){if(this.arrayMapping.moveArrayVerticesAfterRowByRows(e,t,-n),!(t<=0))for(const[,r]of this.arrayMapping.arraysInRows(e9.fromRowStartAndEnd(e,t-1,t-1)))if(this.isThereSpaceForArray(r))for(const e of r.getRange().addresses(this))this.addressMapping.setCell(e,r);else this.setNoSpaceIfArray(r)}fixArraysAfterAddingColumn(e,t,n){if(this.arrayMapping.moveArrayVerticesAfterColumnByColumns(e,t,n),!(t<=0))for(const[,r]of this.arrayMapping.arraysInCols(t9.fromColumnStartAndEnd(e,t-1,t-1))){const i=r.getRange();for(let o=i.start.row;o<=i.end.row;++o)for(let s=t;s<=i.end.col;++s){const t=T4(e,s,o),i=T4(e,s+n,o),a=r.getArrayCellValue(t);this.addressMapping.moveCell(i,t),this.changes.addChange(V3,i,a)}}}fixArraysAfterRemovingColumns(e,t,n){if(this.arrayMapping.moveArrayVerticesAfterColumnByColumns(e,t,-n),!(t<=0))for(const[,r]of this.arrayMapping.arraysInCols(t9.fromColumnStartAndEnd(e,t-1,t-1)))if(this.isThereSpaceForArray(r))for(const e of r.getRange().addresses(this))this.addressMapping.setCell(e,r);else this.setNoSpaceIfArray(r)}shrinkPossibleArrayAndGetCell(e){const t=this.getCell(e);return t instanceof W9?(this.setNoSpaceIfArray(t),this.getCell(e)):t}setNoSpaceIfArray(e){e instanceof W9&&(this.shrinkArrayToCorner(e),e.setNoSpace())}removeVertex(e){this.removeVertexAndCleanupDependencies(e),e instanceof G9&&this.rangeMapping.removeRange(e)}mergeRangeVertices(e,t){const n=this.graph.adjacentNodes(t);this.removeVertexAndCleanupDependencies(t),this.graph.removeEdgeIfExists(e,t),n.forEach((t=>{this.graph.hasNode(t)&&this.graph.addEdge(e,t)}))}removeVertexAndCleanupDependencies(e){const t=new Set(this.graph.removeNode(e));for(;t.size>0;){const e=t.values().next().value;t.delete(e);const[n,r]=e;this.graph.hasNode(r)&&0===this.graph.adjacentNodesCount(r)&&((r instanceof G9||r instanceof a4)&&this.graph.removeNode(r).forEach((e=>t.add(e))),r instanceof G9?this.rangeMapping.removeRange(r):r instanceof a4&&this.addressMapping.removeCell(n))}}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class a4{constructor(){}getCellValue(){return V3}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class l4{constructor(e,t){this.parsedValue=e,this.rawValue=t}getValues(){return{parsedValue:this.parsedValue,rawValue:this.rawValue}}setValues(e){this.parsedValue=e.parsedValue,this.rawValue=e.rawValue}getCellValue(){return this.parsedValue}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class h4{constructor(e,t){this.errors=e,this.rawInput=t}getCellValue(){const e=this.errors.map((e=>e.message)).find((e=>e));return C4.parsingError(e)}getFormula(){return this.rawInput}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class u4{constructor(e,t){this.width=e,this.height=t,this.mapping=new Map}getCell(e){var t;return null===(t=this.mapping.get(e.col))||void 0===t?void 0:t.get(e.row)}setCell(e,t){this.width=Math.max(this.width,e.col+1),this.height=Math.max(this.height,e.row+1);let n=this.mapping.get(e.col);n||(n=new Map,this.mapping.set(e.col,n)),n.set(e.row,t)}has(e){var t;return!!(null===(t=this.mapping.get(e.col))||void 0===t?void 0:t.get(e.row))}getHeight(){return this.height}getWidth(){return this.width}removeCell(e){var t;null===(t=this.mapping.get(e.col))||void 0===t||t.delete(e.row)}addRows(e,t){this.mapping.forEach((n=>{const r=new Map;n.forEach(((i,o)=>{o>=e&&(r.set(o+t,i),n.delete(o))})),r.forEach(((e,t)=>{n.set(t,e)}))})),this.height+=t}addColumns(e,t){const n=new Map;this.mapping.forEach(((r,i)=>{i>=e&&(n.set(i+t,r),this.mapping.delete(i))})),n.forEach(((e,t)=>{this.mapping.set(t,e)})),this.width+=t}removeRows(e){this.mapping.forEach((t=>{const n=new Map;t.forEach(((r,i)=>{i>=e.rowStart&&(t.delete(i),i>e.rowEnd&&n.set(i-e.numberOfRows,r))})),n.forEach(((e,n)=>{t.set(n,e)}))}));const t=Math.min(this.height-1,e.rowEnd),n=Math.max(0,t-e.rowStart+1);this.height=Math.max(0,this.height-n)}removeColumns(e){const t=new Map;this.mapping.forEach(((n,r)=>{r>=e.columnStart&&(this.mapping.delete(r),r>e.columnEnd&&t.set(r-e.numberOfColumns,n))})),t.forEach(((e,t)=>{this.mapping.set(t,e)}));const n=Math.min(this.width-1,e.columnEnd),r=Math.max(0,n-e.columnStart+1);this.width=Math.max(0,this.width-r)}*getEntries(e){for(const[t,n]of this.mapping)for(const[r,i]of n)yield[T4(e,t,r),i]}*verticesFromColumn(e){const t=this.mapping.get(e);if(void 0!==t)for(const[n,r]of t)yield r}*verticesFromRow(e){for(const t of this.mapping.values()){const n=t.get(e);void 0!==n&&(yield n)}}*verticesFromColumnsSpan(e){for(const t of e.columns()){const e=this.mapping.get(t);if(void 0!==e)for(const[t,n]of e)yield n}}*verticesFromRowsSpan(e){for(const t of this.mapping.values())for(const n of e.rows()){const e=t.get(n);void 0!==e&&(yield e)}}*entriesFromRowsSpan(e){for(const[t,n]of this.mapping.entries())for(const r of e.rows()){const i=n.get(r);void 0!==i&&(yield[T4(e.sheet,t,r),i])}}*entriesFromColumnsSpan(e){for(const t of e.columns()){const n=this.mapping.get(t);if(void 0!==n)for(const[r,i]of n.entries())yield[T4(e.sheet,t,r),i]}}*vertices(){for(const[e,t]of this.mapping)for(const[n,r]of t)void 0!==r&&(yield r)}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class c4{constructor(e,t){this.width=e,this.height=t,this.mapping=new Array(t);for(let n=0;n<t;n++)this.mapping[n]=new Array(e)}getCell(e){return this.getCellVertex(e.col,e.row)}setCell(e,t){this.width=Math.max(this.width,e.col+1),this.height=Math.max(this.height,e.row+1);this.mapping[e.row]||(this.mapping[e.row]=new Array(this.width)),this.mapping[e.row][e.col]=t}has(e){const t=this.mapping[e.row];return!!t&&!!t[e.col]}getHeight(){return this.height}getWidth(){return this.width}removeCell(e){void 0!==this.mapping[e.row]&&delete this.mapping[e.row][e.col]}addRows(e,t){const n=[];for(let r=0;r<t;r++)n.push(new Array(this.width));this.mapping.splice(e,0,...n),this.height+=t}addColumns(e,t){for(let n=0;n<this.height;n++)void 0!==this.mapping[n]&&this.mapping[n].splice(e,0,...new Array(t));this.width+=t}removeRows(e){this.mapping.splice(e.rowStart,e.numberOfRows);const t=Math.min(this.height-1,e.rowEnd),n=Math.max(0,t-e.rowStart+1);this.height=Math.max(0,this.height-n)}removeColumns(e){for(let r=0;r<this.height;r++)void 0!==this.mapping[r]&&this.mapping[r].splice(e.columnStart,e.numberOfColumns);const t=Math.min(this.width-1,e.columnEnd),n=Math.max(0,t-e.columnStart+1);this.width=Math.max(0,this.width-n)}*getEntries(e){for(let t=0;t<this.height;++t)for(let n=0;n<this.width;++n){const r=this.getCellVertex(n,t);r&&(yield[T4(e,n,t),r])}}*verticesFromColumn(e){for(let t=0;t<this.height;++t){const n=this.getCellVertex(e,t);n&&(yield n)}}*verticesFromRow(e){for(let t=0;t<this.width;++t){const n=this.getCellVertex(t,e);n&&(yield n)}}*verticesFromColumnsSpan(e){for(let t=e.columnStart;t<=e.columnEnd;++t)for(let e=0;e<this.height;++e){const n=this.getCellVertex(t,e);n&&(yield n)}}*verticesFromRowsSpan(e){for(let t=0;t<this.width;++t)for(let n=e.rowStart;n<=e.rowEnd;++n){const e=this.getCellVertex(t,n);e&&(yield e)}}*entriesFromRowsSpan(e){for(let t=0;t<this.width;++t)for(let n=e.rowStart;n<=e.rowEnd;++n){const r=this.getCellVertex(t,n);r&&(yield[T4(e.sheet,t,n),r])}}*entriesFromColumnsSpan(e){for(let t=e.columnStart;t<=e.columnEnd;++t)for(let n=0;n<this.height;++n){const r=this.getCellVertex(t,n);r&&(yield[T4(e.sheet,t,n),r])}}*vertices(){for(let e=0;e<this.height;++e)for(let t=0;t<this.width;++t){const n=this.getCellVertex(t,e);n&&(yield n)}}getCellVertex(e,t){var n;return null===(n=this.mapping[t])||void 0===n?void 0:n[e]}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */!function(e){e.DIV_BY_ZERO="DIV_BY_ZERO",e.NAME="NAME",e.VALUE="VALUE",e.NUM="NUM",e.NA="NA",e.CYCLE="CYCLE",e.REF="REF",e.SPILL="SPILL",e.LIC="LIC",e.ERROR="ERROR"}(t4||(t4={})),function(e){e.FORMULA="FORMULA",e.VALUE="VALUE",e.ARRAY="ARRAY",e.EMPTY="EMPTY",e.ARRAYFORMULA="ARRAYFORMULA"}(n4||(n4={}));var d4,p4;!function(e){e.EMPTY="EMPTY",e.NUMBER="NUMBER",e.STRING="STRING",e.BOOLEAN="BOOLEAN",e.ERROR="ERROR"}(d4||(d4={})),function(e){e.NUMBER="NUMBER"}(p4||(p4={}));const g4=Object.assign(Object.assign({},d4),p4),m4=Object.assign(Object.assign({},d4),X3),f4=e=>{switch(e){case g4.EMPTY:return 0;case g4.NUMBER:return 1;case g4.STRING:return 2;case g4.BOOLEAN:return 3;case g4.ERROR:return 4}throw new Error("Cell value not computed")},w4=e=>{if(e===V3)return g4.EMPTY;if(e instanceof C4||e instanceof Z3)return g4.ERROR;if("string"==typeof e)return g4.STRING;if(K3(e))return g4.NUMBER;if("boolean"==typeof e)return g4.BOOLEAN;throw new Error("Cell value not computed")},y4=e=>{return K3(e)?(t=e)instanceof B3?t.getDetailedType():X3.NUMBER_RAW:w4(e);var t},v4=e=>{return K3(e)&&(t=e)instanceof B3?t.format:void 0;var t};class C4{constructor(e,t,n){this.type=e,this.message=t,this.root=n}static parsingError(e){return new C4(t4.ERROR,`${K2.ParseError}${e?" "+e:""}`)}attachRootVertex(e){return void 0===this.root?new C4(this.type,this.message,e):this}}const S4=(e,t)=>({sheet:e,row:t}),R4=e=>e.row<0,E4=(e,t)=>({sheet:e,col:t}),b4=e=>e.col<0,T4=(e,t,n)=>({sheet:e,col:t,row:n}),N4=e=>e.col<0||e.row<0,A4=(e,t,n,r)=>T4(t,e.col+n,e.row+r),M4=e=>`${e.sheet},${e.row},${e.col}`;function I4(e){var t,n,r;return e&&("object"==typeof e||"function"==typeof e)&&"number"==typeof(null===(t=e)||void 0===t?void 0:t.sheet)&&"number"==typeof(null===(n=e)||void 0===n?void 0:n.col)&&"number"==typeof(null===(r=e)||void 0===r?void 0:r.row)}const O4=(e,t)=>{var n;return null!==(n=e.sheet)&&void 0!==n?n:t.sheet},x4=(e,t)=>e.sheet===t.sheet&&e.col===t.col&&e.row===t.row;function P4(e){return!(!e||"object"!=typeof e&&"function"!=typeof e)&&("start"in e&&I4(e.start)&&"end"in e&&I4(e.end))}const _4=(e,t)=>({start:e,end:t});class L4{constructor(e,t){if(e.sheet!==t.sheet)throw new c9(e.sheet,t.sheet);this.start=T4(e.sheet,e.col,e.row),this.end=T4(t.sheet,t.col,t.row)}get sheet(){return this.start.sheet}static fromSimpleCellAddresses(e,t){if(e.sheet!==t.sheet)throw new c9(e.sheet,t.sheet);const n=t.col-e.col,r=t.row-e.row;return Number.isFinite(r)&&Number.isFinite(n)?new L4(e,t):Number.isFinite(r)?new k4(e.sheet,e.row,t.row):new H4(e.sheet,e.col,t.col)}static fromAst(e,t){return e.type===H2.CELL_RANGE?L4.fromCellRange(e,t):e.type===H2.COLUMN_RANGE?H4.fromColumnRange(e,t):k4.fromRowRangeAst(e,t)}static fromAstOrUndef(e,t){try{return L4.fromAst(e,t)}catch(n){return}}static fromCellRange(e,t){return new L4(e.start.toSimpleCellAddress(t),e.end.toSimpleCellAddress(t))}static spanFrom(e,t,n){const r=L4.spanFromOrUndef(e,t,n);if(void 0===r)throw new Error("AbsoluteCellRange: Wrong range size");return r}static spanFromOrUndef(e,t,n){if(!Number.isFinite(t)&&Number.isFinite(n)){if(0!==e.col)return;return new k4(e.sheet,e.row,e.row+n-1)}if(!Number.isFinite(n)&&Number.isFinite(t)){if(0!==e.row)return;return new H4(e.sheet,e.col,e.col+t-1)}if(Number.isFinite(n)&&Number.isFinite(t))return new L4(e,T4(e.sheet,e.col+t-1,e.row+n-1))}static fromCoordinates(e,t,n,r,i){return new L4(T4(e,t,n),T4(e,r,i))}isFinite(){return Number.isFinite(this.size())}doesOverlap(e){return this.start.sheet==e.start.sheet&&(!(this.end.row<e.start.row||this.start.row>e.end.row)&&!(this.end.col<e.start.col||this.start.col>e.end.col))}addressInRange(e){return this.sheet===e.sheet&&(this.start.row<=e.row&&this.end.row>=e.row&&this.start.col<=e.col&&this.end.col>=e.col)}columnInRange(e){return this.sheet===e.sheet&&(this.start.col<=e.col&&this.end.col>=e.col)}rowInRange(e){return this.sheet===e.sheet&&(this.start.row<=e.row&&this.end.row>=e.row)}containsRange(e){return this.addressInRange(e.start)&&this.addressInRange(e.end)}intersectionWith(e){if(this.sheet!==e.start.sheet)return;const t=Math.max(this.start.row,e.start.row),n=Math.min(this.end.row,e.end.row),r=Math.max(this.start.col,e.start.col),i=Math.min(this.end.col,e.end.col);return t>n||r>i?void 0:new L4(T4(this.sheet,r,t),T4(this.sheet,i,n))}includesRow(e){return this.start.row<e&&this.end.row>=e}includesColumn(e){return this.start.col<e&&this.end.col>=e}shiftByRows(e){this.start.row+=e,this.end.row+=e}expandByRows(e){this.end.row+=e}shiftByColumns(e){this.start.col+=e,this.end.col+=e}shifted(e,t){return L4.spanFrom(T4(this.sheet,this.start.col+e,this.start.row+t),this.width(),this.height())}expandByColumns(e){this.end.col+=e}moveToSheet(e){this.start.sheet=e,this.end.sheet=e}removeSpan(e){e instanceof e9?this.removeRows(e.start,e.end):this.removeColumns(e.start,e.end)}shouldBeRemoved(){return this.width()<=0||this.height()<=0}rangeWithSameWidth(e,t){return L4.spanFrom(T4(this.sheet,this.start.col,e),this.width(),t)}rangeWithSameHeight(e,t){return L4.spanFrom(T4(this.sheet,e,this.start.row),t,this.height())}toString(){return`${this.start.sheet},${this.start.col},${this.start.row},${this.end.col},${this.end.row}`}width(){return this.end.col-this.start.col+1}height(){return this.end.row-this.start.row+1}size(){return this.height()*this.width()}arrayOfAddressesInRange(){const e=[];for(let t=0;t<this.height();++t){e[t]=[];for(let n=0;n<this.width();++n){const r=T4(this.sheet,this.start.col+n,this.start.row+t);e[t].push(r)}}return e}withStart(e){return new L4(e,this.end)}sameDimensionsAs(e){return this.width()===e.width()&&this.height()===e.height()}sameAs(e){return x4(this.start,e.start)&&x4(this.end,e.end)}addressesArrayMap(e,t){const n=[];let r=this.start.row;for(;r<=this.effectiveEndRow(e);){let i=this.start.col;const o=[];for(;i<=this.effectiveEndColumn(e);)o.push(t(T4(this.start.sheet,i,r))),i++;n.push(o),r++}return n}addresses(e){const t=[];let n=this.start.row;const r=this.effectiveEndRow(e),i=this.effectiveEndColumn(e);for(;n<=r;){let e=this.start.col;for(;e<=i;)t.push(T4(this.start.sheet,e,n)),e++;n++}return t}*addressesWithDirection(e,t,n){if(e>0)if(t>0){let e=this.effectiveEndRow(n);for(;e>=this.start.row;){let t=this.effectiveEndColumn(n);for(;t>=this.start.col;)yield T4(this.start.sheet,t,e),t-=1;e-=1}}else{let e=this.start.row;for(;e<=this.effectiveEndRow(n);){let t=this.effectiveEndColumn(n);for(;t>=this.start.col;)yield T4(this.start.sheet,t,e),t-=1;e+=1}}else if(t>0){let e=this.effectiveEndRow(n);for(;e>=this.start.row;){let t=this.start.col;for(;t<=this.effectiveEndColumn(n);)yield T4(this.start.sheet,t,e),t+=1;e-=1}}else{let e=this.start.row;for(;e<=this.effectiveEndRow(n);){let t=this.start.col;for(;t<=this.effectiveEndColumn(n);)yield T4(this.start.sheet,t,e),t+=1;e+=1}}}getAddress(e,t){if(e<0||t<0||t>this.height()-1||e>this.width()-1)throw Error("Index out of bound");return T4(this.start.sheet,this.start.col+e,this.start.row+t)}exceedsSheetSizeLimits(e,t){return this.end.col>=e||this.end.row>=t}effectiveEndColumn(e){return this.end.col}effectiveEndRow(e){return this.end.row}effectiveWidth(e){return this.width()}effectiveHeight(e){return this.height()}removeRows(e,t){if(!(e>this.end.row)){if(t<this.start.row){const n=t-e+1;return this.shiftByRows(-n)}e<=this.start.row&&(this.start.row=e),this.end.row-=Math.min(t,this.end.row)-e+1}}removeColumns(e,t){if(!(e>this.end.col)){if(t<this.start.col){const n=t-e+1;return this.shiftByColumns(-n)}e<=this.start.col&&(this.start.col=e),this.end.col-=Math.min(t,this.end.col)-e+1}}}class H4 extends L4{constructor(e,t,n){super(T4(e,t,0),T4(e,n,Number.POSITIVE_INFINITY))}static fromColumnRange(e,t){const n=e.start.toSimpleColumnAddress(t),r=e.end.toSimpleColumnAddress(t);if(n.sheet!==r.sheet)throw new c9(n.sheet,r.sheet);return new H4(n.sheet,n.col,r.col)}shouldBeRemoved(){return this.width()<=0}shiftByRows(e){}expandByRows(e){}shifted(e,t){return new H4(this.sheet,this.start.col+e,this.end.col+e)}rangeWithSameHeight(e,t){return new H4(this.sheet,e,e+t-1)}exceedsSheetSizeLimits(e,t){return this.end.col>=e}effectiveEndRow(e){return this.effectiveHeight(e)-1}effectiveHeight(e){return e.getSheetHeight(this.sheet)}removeRows(e,t){}}class k4 extends L4{constructor(e,t,n){super(T4(e,0,t),T4(e,Number.POSITIVE_INFINITY,n))}static fromRowRangeAst(e,t){const n=e.start.toSimpleRowAddress(t),r=e.end.toSimpleRowAddress(t);if(n.sheet!==r.sheet)throw new c9(n.sheet,r.sheet);return new k4(n.sheet,n.row,r.row)}shouldBeRemoved(){return this.height()<=0}shiftByColumns(e){}expandByColumns(e){}shifted(e,t){return new k4(this.sheet,this.start.row+t,this.end.row+t)}rangeWithSameWidth(e,t){return new k4(this.sheet,e,e+t-1)}exceedsSheetSizeLimits(e,t){return this.end.row>=t}effectiveEndColumn(e){return this.effectiveWidth(e)-1}effectiveWidth(e){return e.getSheetWidth(this.sheet)}removeColumns(e,t){}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class F4{constructor(e,t,n){this.formulaAddress=e,this.arraysFlag=t,this.formulaVertex=n}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
const D4=/^\s*([+-]?)\s*(([\d\.,]+(e[+-]?\d+)?)\s*([ij]?)|([ij]))\s*(([+-])\s*([+-]?)\s*(([\d\.,]+(e[+-]?\d+)?)\s*([ij]?)|([ij])))?$/;class V4{constructor(e,t,n){this.config=e,this.dateTimeHelper=t,this.numberLiteralsHelper=n,this.lt=(e,t)=>this.compare(e,t)<0,this.leq=(e,t)=>this.compare(e,t)<=0,this.gt=(e,t)=>this.compare(e,t)>0,this.geq=(e,t)=>this.compare(e,t)>=0,this.eq=(e,t)=>0===this.compare(e,t),this.neq=(e,t)=>0!==this.compare(e,t),this.pow=(e,t)=>Math.pow(U3(e),U3(t)),this.addWithEpsilonRaw=(e,t)=>{const n=e+t;return Math.abs(n)<this.actualEps*Math.abs(e)?0:n},this.addWithEpsilon=(e,t)=>{const n=J4(e,t);return this.ExtendedNumberFactory(this.addWithEpsilonRaw(U3(e),U3(t)),n)},this.unaryMinus=e=>W3(e,-U3(e)),this.unaryPlus=e=>e,this.unaryPercent=e=>new Y3(U3(e)/100),this.concat=(e,t)=>e.concat(t),this.nonstrictadd=(e,t)=>e instanceof C4?e:t instanceof C4?t:"number"==typeof e?"number"==typeof t?this.addWithEpsilonRaw(e,t):e:"number"==typeof t?t:0,this.subtract=(e,t)=>{const n=J4(e,t),r=U3(e);let i=r-U3(t);return Math.abs(i)<this.actualEps*Math.abs(r)&&(i=0),this.ExtendedNumberFactory(i,n)},this.divide=(e,t)=>{const n=U3(e),r=U3(t);if(0===r)return new C4(t4.DIV_BY_ZERO);{const i=e5(e,t);return this.ExtendedNumberFactory(n/r,i)}},this.multiply=(e,t)=>{const n=e5(e,t);return this.ExtendedNumberFactory(U3(e)*U3(t),n)},this.manyToExactComplex=e=>{const t=[];for(const n of e){if(n instanceof C4)return n;if(K3(n)||"string"==typeof n){const e=this.coerceScalarToComplex(n);e instanceof C4||t.push(e)}}return t},this.coerceNumbersExactRanges=e=>this.manyToNumbers(e,this.manyToExactNumbers),this.coerceNumbersCoerceRangesDropNulls=e=>this.manyToNumbers(e,this.manyToCoercedNumbersDropNulls),this.manyToExactNumbers=e=>{const t=[];for(const n of e){if(n instanceof C4)return n;K3(n)&&t.push(U3(n))}return t},this.manyToOnlyNumbersDropNulls=e=>{const t=[];for(const n of e){if(n instanceof C4)return n;if(K3(n))t.push(U3(n));else if(n!==V3)return new C4(t4.VALUE,K2.NumberExpected)}return t},this.manyToCoercedNumbersDropNulls=e=>{const t=[];for(const n of e){if(n instanceof C4)return n;if(n===V3)continue;const e=this.coerceScalarToNumberOrError(n);K3(e)&&t.push(U3(e))}return t},this.collator=function(e){const t=e.caseSensitive?e.accentSensitive?"variant":"case":e.accentSensitive?"accent":"base",n=e.caseFirst,r=e.ignorePunctuation;return new Intl.Collator(e.localeLang,{sensitivity:t,caseFirst:n,ignorePunctuation:r})}(e),this.actualEps=e.smartRounding?e.precisionEpsilon:0}eqMatcherFunction(e){const t=this.buildRegex(e);return e=>"string"==typeof e&&t.test(this.normalizeString(e))}neqMatcherFunction(e){const t=this.buildRegex(e);return e=>!("string"==typeof e&&t.test(this.normalizeString(e)))}searchString(e,t){var n;const r=this.buildRegex(e,!1).exec(t);return null!==(n=null==r?void 0:r.index)&&void 0!==n?n:-1}requiresRegex(e){if(!this.config.useRegularExpressions&&!this.config.useWildcards)return!this.config.matchWholeCell;for(let t=0;t<e.length;t++){const n=e.charAt(t);if(q4(n)||this.config.useRegularExpressions&&Z4(n))return!0}return!1}floatCmp(e,t){const n=U3(e),r=U3(t),i=1+this.actualEps;return r>=0&&n*i>=r&&n<=r*i||r<=0&&n*i<=r&&n>=r*i?0:n>r?1:-1}coerceScalarToNumberOrError(e){var t;return e instanceof C4?e:null!==(t=this.coerceToMaybeNumber(e))&&void 0!==t?t:new C4(t4.VALUE,K2.NumberCoercion)}coerceToMaybeNumber(e){var t;return null!==(t=this.coerceNonDateScalarToMaybeNumber(e))&&void 0!==t?t:"string"==typeof e?this.dateTimeHelper.dateStringToDateNumber(e):void 0}coerceNonDateScalarToMaybeNumber(e){if(e===V3)return 0;if("string"==typeof e){if(""===e)return 0;const t=this.coerceStringToMaybePercentNumber(e);if(void 0!==t)return t;const n=this.coerceStringToMaybeCurrencyNumber(e);return void 0!==n?n:this.numberLiteralsHelper.numericStringToMaybeNumber(e.trim())}return K3(e)?e:"boolean"==typeof e?Number(e):void 0}coerceStringToMaybePercentNumber(e){const t=e.trim();if(t.endsWith("%")){const e=t.slice(0,t.length-1).trim(),n=this.numberLiteralsHelper.numericStringToMaybeNumber(e);if(void 0!==n)return new Y3(n/100)}}coerceStringToMaybeCurrencyNumber(e){const t=this.currencyMatcher(e.trim());if(void 0!==t){const[e,n]=t,r=this.numberLiteralsHelper.numericStringToMaybeNumber(n);if(void 0!==r)return new G3(r,e)}}currencyMatcher(e){for(const t of this.config.currencySymbol){if(e.startsWith(t))return[t,e.slice(t.length).trim()];if(e.endsWith(t))return[t,e.slice(0,e.length-t.length).trim()]}}coerceComplexExactRanges(e){const t=[];for(const r of e)if(r instanceof Z3)t.push(r);else if(r!==V3){const e=this.coerceScalarToComplex(r);if(e instanceof C4)return e;t.push(e)}const n=[];for(const r of t)if(r instanceof Z3){const e=this.manyToExactComplex(r.valuesFromTopLeftCorner());if(e instanceof C4)return e;n.push(...e)}else n.push(r);return n}coerceScalarToComplex(e){return e instanceof C4?e:e===V3?[0,0]:K3(e)?[U3(e),0]:"string"==typeof e?this.coerceStringToComplex(e):new C4(t4.NUM,K2.ComplexNumberExpected)}ExtendedNumberFactory(e,t){const{type:n,format:r}=t;switch(n){case X3.NUMBER_RAW:return e;case X3.NUMBER_CURRENCY:return new G3(e,null!=r?r:this.config.currencySymbol[0]);case X3.NUMBER_DATE:return new j3(e,r);case X3.NUMBER_DATETIME:return new $3(e,r);case X3.NUMBER_TIME:return new z3(e,r);case X3.NUMBER_PERCENT:return new Y3(e,r)}}buildRegex(e,t=!0){let n;e=this.normalizeString(e);let r=this.config.useWildcards,i=this.config.useRegularExpressions;if(i)try{RegExp(e)}catch(o){i=!1,r=!1}return n=i?function(e,t){let n="";for(let r=0;r<e.length;r++){const i=e.charAt(r);q4(i)||Z4(i)?n+=i:n+=t?i:i.toLowerCase()}return n}(e,this.config.caseSensitive):r?function(e,t){let n="";for(let r=0;r<e.length;r++){const i=e.charAt(r);if("~"===i){if(r==e.length-1){n+="~";continue}const t=e.charAt(r+1);q4(t)||Z4(t)?(n+="\\"+t,r++):(n+=t,r++)}else q4(i)?n+="."+i:Z4(i)?n+="\\"+i:n+=t?i:i.toLowerCase()}return n}(e,this.config.caseSensitive):function(e,t){let n="";for(let r=0;r<e.length;r++){const i=e.charAt(r);q4(i)||Z4(i)?n+="\\"+i:n+=t?i:i.toLowerCase()}return n}(e,this.config.caseSensitive),this.config.matchWholeCell&&t?RegExp("^("+n+")$"):RegExp(n)}normalizeString(e){return this.config.caseSensitive||(e=e.toLowerCase()),this.config.accentSensitive||(e=r5(e,"nfd").replace(/[\u0300-\u036f]/g,"")),e}compare(e,t){if("string"==typeof e||"string"==typeof t){const n="string"==typeof e?this.dateTimeHelper.dateStringToDateNumber(e):e,r="string"==typeof t?this.dateTimeHelper.dateStringToDateNumber(t):t;if(K3(n)&&K3(r))return this.floatCmp(n,r)}return e===V3?e=j4(t):t===V3&&(t=j4(e)),"string"==typeof e&&"string"==typeof t?this.stringCmp(e,t):"boolean"==typeof e&&"boolean"==typeof t?Y4(W4(e),W4(t)):K3(e)&&K3(t)?this.floatCmp(e,t):e===V3&&t===V3?0:Y4(f4(w4(e)),f4(w4(t)))}stringCmp(e,t){return this.collator.compare(e,t)}manyToNumbers(e,t){const n=[];for(const i of e)if(i instanceof Z3)n.push(i);else{const e=U3(this.coerceScalarToNumberOrError(i));if(e instanceof C4)return e;n.push(e)}const r=[];for(const i of n)if(i instanceof Z3){const e=t(i.valuesFromTopLeftCorner());if(e instanceof C4)return e;r.push(...e)}else r.push(i);return r}coerceStringToComplex(e){const t=D4.exec(e);if(null===t)return new C4(t4.NUM,K2.ComplexNumberExpected);let n,r;return n=void 0!==t[6]?"-"===t[1]?[0,-1]:[0,1]:this.parseComplexToken(t[1]+t[3],t[5]),n instanceof C4||void 0===t[8]?n:(r=void 0!==t[14]?"-"===t[9]?[0,-1]:[0,1]:this.parseComplexToken(t[9]+t[11],t[13]),r instanceof C4?r:""!==t[5]||""===t[13]?new C4(t4.NUM,K2.ComplexNumberExpected):"+"===t[8]?[n[0]+r[0],n[1]+r[1]]:[n[0]-r[0],n[1]-r[1]])}parseComplexToken(e,t){const n=U3(this.coerceNonDateScalarToMaybeNumber(e));return void 0===n?new C4(t4.NUM,K2.ComplexNumberExpected):""===t?[n,0]:[0,n]}}function U4([e,t],n){if(!isFinite(e)||!isFinite(t))return new C4(t4.NUM,K2.NaN);if(n=null!=n?n:"i",0===t)return`${e}`;const r=`${-1===t||1===t?"":Math.abs(t)}${n}`;return 0===e?`${t<0?"-":""}${r}`:`${e}${t<0?"-":"+"}${r}`}function B4(e){return e instanceof Z3?e:Z3.fromScalar(e)}function W4(e){return Number(e)}function j4(e){return"string"==typeof e?"":K3(e)?0:"boolean"!=typeof e&&V3}function G4(e){if(e instanceof C4||"boolean"==typeof e)return e;if(e===V3)return!1;if(K3(e))return 0!==U3(e);{const t=e.toUpperCase();return"TRUE"===t||"FALSE"!==t&&(""!==t&&void 0)}}function z4(e){return e instanceof C4||"string"==typeof e?e:e===V3?"":K3(e)?U3(e).toString():e?"TRUE":"FALSE"}function $4(e){return e===V3?0:e}function Y4(e,t){const n=U3(e),r=U3(t);return n>r?1:n<r?-1:0}function K4(e){return isNaN(e)||e===1/0||e===-1/0}function X4(e){return 0===e?0:e}function q4(e){return["*","?"].includes(e)}const Q4=["{","}","[","]","(",")","<",">","=",".","+","-",",","\\","$","^","!"];function Z4(e){return Q4.includes(e)}function J4(e,t){const{type:n,format:r}=Q3(e),{type:i,format:o}=Q3(t);if(n===X3.NUMBER_RAW)return{type:i,format:o};if(i===X3.NUMBER_RAW)return{type:n,format:r};if(!(n!==X3.NUMBER_DATETIME&&n!==X3.NUMBER_DATE||i!==X3.NUMBER_DATETIME&&i!==X3.NUMBER_DATE))return{type:X3.NUMBER_RAW};if(n===X3.NUMBER_TIME){if(i===X3.NUMBER_DATE)return{type:X3.NUMBER_DATETIME,format:`${o} ${r}`};if(i===X3.NUMBER_DATETIME)return{type:X3.NUMBER_DATETIME,format:o}}if(i===X3.NUMBER_TIME){if(n===X3.NUMBER_DATE)return{type:X3.NUMBER_DATETIME,format:`${r} ${o}`};if(n===X3.NUMBER_DATETIME)return{type:X3.NUMBER_DATETIME,format:r}}return{type:n,format:r}}function e5(e,t){let{type:n,format:r}=Q3(e),{type:i,format:o}=Q3(t);return n===X3.NUMBER_PERCENT&&(n=X3.NUMBER_RAW,r=void 0),i===X3.NUMBER_PERCENT&&(i=X3.NUMBER_RAW,o=void 0),n===X3.NUMBER_RAW?{type:i,format:o}:i===X3.NUMBER_RAW?{type:n,format:r}:{type:X3.NUMBER_RAW}}function t5(e){return r5(e.toLowerCase(),"nfd").replace(/[\u0300-\u036f]/g,"")}function n5(e,t){var n;if(e.isAdHoc())return null===(n=e.data[0])||void 0===n?void 0:n[0];const r=e.range;if(t.formulaAddress.sheet===r.sheet)if(1===r.width()){const n=t.formulaAddress.row-r.start.row;if(n>=0&&n<r.height())return e.data[n][0]}else if(1===r.height()){const n=t.formulaAddress.col-r.start.col;if(n>=0&&n<r.width())return e.data[0][n]}}function r5(e,t){return e.normalize(t.toUpperCase())}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */var i5;!function(e){e.STRING="STRING",e.NUMBER="NUMBER",e.BOOLEAN="BOOLEAN",e.SCALAR="SCALAR",e.NOERROR="NOERROR",e.RANGE="RANGE",e.INTEGER="INTEGER",e.COMPLEX="COMPLEX",e.ANY="ANY"}(i5||(i5={}));class o5{constructor(e){this.coerceScalarToNumberOrError=e=>this.arithmeticHelper.coerceScalarToNumberOrError(e),this.runFunction=(e,t,n,r)=>{const i=this.evaluateArguments(e,t,n),o=i.map((([e,t])=>e)),s=i.map((([e,t])=>t)),a=this.buildMetadataForEachArgumentValue(o.length,n),l=t.arraysFlag&&!n.vectorizationForbidden;if(!this.isNumberOfArgumentValuesValid(a,o.length))return new C4(t4.NA,K2.WrongArgNumber);const[h,u]=l?this.calculateSizeOfVectorizedResultArray(o,a):[1,1];if(1===h&&1===u){const e=this.vectorizeAndBroadcastArgumentsIfNecessary(l,o,a,0,0);return this.calculateSingleCellOfResultArray(t,e,a,s,r,n.returnNumberType)}const c=[...Array(h).keys()].map((e=>[...Array(u).keys()].map((i=>{const h=this.vectorizeAndBroadcastArgumentsIfNecessary(l,o,a,e,i),u=this.calculateSingleCellOfResultArray(t,h,a,s,r,n.returnNumberType);if(u instanceof Z3)throw new Error("Function returning array cannot be vectorized.");return u}))));return Z3.onlyValues(c)},this.runFunctionWithReferenceArgument=(e,t,n,r,i,o=(()=>new C4(t4.NA,K2.CellRefExpected)))=>{if(0===e.length)return this.returnNumberWrapper(r(),n.returnNumberType);if(e.length>1)return new C4(t4.NA,K2.WrongArgNumber);let s,a=e[0];for(;a.type===H2.PARENTHESIS;)a=a.expression;if(a.type===H2.CELL_REFERENCE)s=a.reference.toSimpleCellAddress(t.formulaAddress);else if(a.type===H2.CELL_RANGE||a.type===H2.COLUMN_RANGE||a.type===H2.ROW_RANGE)try{s=L4.fromAst(a,t.formulaAddress).start}catch(l){return new C4(t4.REF,K2.CellRefExpected)}return void 0!==s?this.returnNumberWrapper(i(s),n.returnNumberType):this.runFunction(e,t,n,o)},this.interpreter=e,this.dependencyGraph=e.dependencyGraph,this.columnSearch=e.columnSearch,this.config=e.config,this.serialization=e.serialization,this.arraySizePredictor=e.arraySizePredictor,this.dateTimeHelper=e.dateTimeHelper,this.arithmeticHelper=e.arithmeticHelper}evaluateAst(e,t){return this.interpreter.evaluateAst(e,t)}arraySizeForAst(e,t){return this.arraySizePredictor.checkArraySizeForAst(e,t)}listOfScalarValues(e,t){const n=[];for(const r of e){const e=this.evaluateAst(r,t);if(e instanceof Z3)for(const t of e.valuesFromTopLeftCorner())n.push([t,!0]);else n.push([e,!1])}return n}coerceToType(e,t,n){let r;if(e instanceof Z3)switch(t.argumentType){case i5.RANGE:case i5.ANY:r=e;break;default:{const t=n5(e,n);if(void 0===t)return;e=t}}if(!(e instanceof Z3))switch(t.argumentType){case i5.INTEGER:case i5.NUMBER:const n=this.coerceScalarToNumberOrError(e);if(!K3(n)){r=n;break}const i=U3(n);if(void 0!==t.maxValue&&i>t.maxValue)return new C4(t4.NUM,K2.ValueLarge);if(void 0!==t.minValue&&i<t.minValue)return new C4(t4.NUM,K2.ValueSmall);if(void 0!==t.lessThan&&i>=t.lessThan)return new C4(t4.NUM,K2.ValueLarge);if(void 0!==t.greaterThan&&i<=t.greaterThan)return new C4(t4.NUM,K2.ValueSmall);if(t.argumentType===i5.INTEGER&&!Number.isInteger(i))return new C4(t4.NUM,K2.IntegerExpected);r=n;break;case i5.STRING:r=z4(e);break;case i5.BOOLEAN:r=G4(e);break;case i5.SCALAR:case i5.NOERROR:case i5.ANY:r=e;break;case i5.RANGE:if(e instanceof C4)return e;r=B4(e);break;case i5.COMPLEX:return this.arithmeticHelper.coerceScalarToComplex(U3(e))}return t.passSubtype||void 0===r?r:U3(r)}calculateSingleCellOfResultArray(e,t,n,r,i,o){const s=this.coerceArgumentsToRequiredTypes(e,t,n,r);if(s instanceof C4)return s;const a=i(...s);return this.returnNumberWrapper(a,o)}coerceArgumentsToRequiredTypes(e,t,n,r){const i=[];for(let o=0;o<n.length;o++){const s=n[o],a=void 0!==t[o]?t[o]:null==s?void 0:s.defaultValue;if(void 0===a){i.push(void 0);continue}const l=this.coerceToType(a,s,e);if(void 0===l&&!r[o])return new C4(t4.VALUE,K2.WrongType);if(l instanceof C4&&s.argumentType!==i5.SCALAR)return l;i.push(l)}return i}vectorizeAndBroadcastArgumentsIfNecessary(e,t,n,r,i){return t.map(((t,o)=>e&&this.isRangePassedAsAScalarArgument(t,n[o])?this.vectorizeAndBroadcastRangeArgument(t,r,i):t))}vectorizeAndBroadcastRangeArgument(e,t,n){var r;const i=1===e.height()?0:t,o=1===e.width()?0:n;return null===(r=e.data[i])||void 0===r?void 0:r[o]}evaluateArguments(e,t,n){return n.expandRanges?this.listOfScalarValues(e,t):e.map((e=>[this.evaluateAst(e,t),!1]))}buildMetadataForEachArgumentValue(e,t){const n=t.parameters?[...t.parameters]:[];if(void 0!==t.repeatLastArgs&&Number.isInteger(t.repeatLastArgs)&&t.repeatLastArgs>0)for(;e>n.length;)n.push(...n.slice(n.length-t.repeatLastArgs));return n}isNumberOfArgumentValuesValid(e,t){if(t>e.length)return!1;if(t<e.length){return e.slice(t).every((e=>(null==e?void 0:e.optionalArg)||void 0!==(null==e?void 0:e.defaultValue)))}return!0}calculateSizeOfVectorizedResultArray(e,t){const n=e.filter(((e,n)=>this.isRangePassedAsAScalarArgument(e,t[n])));return[Math.max(1,...n.map((e=>e.height()))),Math.max(1,...n.map((e=>e.width())))]}isRangePassedAsAScalarArgument(e,t){return null!=e&&null!=t&&(e instanceof Z3&&![i5.RANGE,i5.ANY].includes(t.argumentType))}metadata(e){const t=this.constructor.implementedFunctions[e];if(void 0!==t)return t;throw new Error(`No metadata for function ${e}.`)}returnNumberWrapper(e,t,n){return void 0!==t&&K3(e)?this.arithmeticHelper.ExtendedNumberFactory(U3(e),{type:t,format:n}):e}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class s5{constructor(e,t,n=!1){this.width=e,this.height=t,this.isRef=n}static error(){return new s5(1,1,!0)}static scalar(){return new s5(1,1,!1)}isScalar(){return 1===this.width&&1===this.height||this.isRef}}class a5{constructor(e,t){this.config=e,this.functionRegistry=t}checkArraySize(e,t){return this.checkArraySizeForAst(e,{formulaAddress:t,arraysFlag:this.config.useArrayArithmetic})}checkArraySizeForAst(e,t){switch(e.type){case H2.FUNCTION_CALL:return this.checkArraySizeForFunction(e,t);case H2.COLUMN_RANGE:case H2.ROW_RANGE:case H2.CELL_RANGE:{const n=L4.fromAstOrUndef(e,t.formulaAddress);return void 0===n?s5.error():new s5(n.width(),n.height(),!0)}case H2.ARRAY:{const n=[],r=[];for(const s of e.args){const e=s.map((e=>this.checkArraySizeForAst(e,t))),i=Math.min(...e.map((e=>e.height))),o=e.reduce(((e,t)=>e+t.width),0);n.push(i),r.push(o)}const i=n.reduce(((e,t)=>e+t),0),o=Math.min(...r);return new s5(o,i)}case H2.STRING:case H2.NUMBER:return s5.scalar();case H2.CELL_REFERENCE:return new s5(1,1,!0);case H2.DIV_OP:case H2.CONCATENATE_OP:case H2.EQUALS_OP:case H2.GREATER_THAN_OP:case H2.GREATER_THAN_OR_EQUAL_OP:case H2.LESS_THAN_OP:case H2.LESS_THAN_OR_EQUAL_OP:case H2.MINUS_OP:case H2.NOT_EQUAL_OP:case H2.PLUS_OP:case H2.POWER_OP:case H2.TIMES_OP:{const n=this.checkArraySizeForAst(e.left,t),o=this.checkArraySizeForAst(e.right,t);return!t.arraysFlag&&(n.height>1||n.width>1||o.height>1||o.width>1)?s5.error():(r=n,i=o,new s5(Math.max(r.width,i.width),Math.max(r.height,i.height)))}case H2.MINUS_UNARY_OP:case H2.PLUS_UNARY_OP:case H2.PERCENT_OP:{const r=this.checkArraySizeForAst(e.value,t);return!t.arraysFlag&&(r.height>1||r.width>1)?s5.error():new s5((n=r).width,n.height)}case H2.PARENTHESIS:return this.checkArraySizeForAst(e.expression,t);case H2.EMPTY:default:return s5.error()}var n,r,i}checkArraySizeForFunction(e,t){const n=this.functionRegistry.getArraySizeFunction(e.procedureName);if(void 0!==n)return n(e,t);const r=this.functionRegistry.getMetadata(e.procedureName);if(void 0===r||r.expandRanges||!t.arraysFlag||r.vectorizationForbidden||void 0===r.parameters)return new s5(1,1);const i=e.args.map((e=>{var n;return this.checkArraySizeForAst(e,new F4(t.formulaAddress,t.arraysFlag||null!==(n=null==r?void 0:r.arrayFunction)&&void 0!==n&&n))})),o=[...r.parameters];if(void 0!==r.repeatLastArgs&&o.length<i.length&&(i.length-o.length)%r.repeatLastArgs!=0)return s5.error();for(;o.length<i.length;){if(void 0===r.repeatLastArgs)return s5.error();o.push(...o.slice(o.length-r.repeatLastArgs))}let s=1,a=1;for(let l=0;l<i.length;l++)o[l].argumentType!==i5.RANGE&&o[l].argumentType!==i5.ANY&&(a=Math.max(a,i[l].height),s=Math.max(s,i[l].width));return new s5(s,a)}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class l5{constructor(e,t,n){var r;this.value=t,this.address=n,this.type=e.type,this.message=null!==(r=e.message)&&void 0!==r?r:""}toString(){return this.value}valueOf(){return this.value}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */function h5(e,t,n){if(void 0===e)return z8.defaultConfig[n];if("string"==typeof t){if(typeof e===t)return e;throw new C9(t,n)}if(t.includes(e))return e;throw new b9(t.map((e=>`'${e}'`)).join(" "),n)}function u5(e,t,n){if(e<n)throw new R9(t,n)}function c5(e,t,n,r){if(t(e))return e;if(void 0===e)return z8.defaultConfig[r];throw new C9(n,r)}function d5(...e){const t=new Map;e.forEach((e=>{const n=t.get(e.value)||[];n.push(e.name),t.set(e.value,n)}));const n=[];for(const r of t.values())r.length>1&&n.push(r);if(n.length>0){n.forEach((e=>e.sort()));const e=n.map((e=>`[${e}]`)).join("; ");throw new Error(`Config initialization failed. Parameters in conflict: ${e}`)}}function p5(e,t,n){if(typeof e!==t)throw new C9(t,n)}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */const g5=new RegExp("^ss(\\.(s+|0+))?$"),m5=new RegExp("^[0-9/.\\-: ]+[ap]?m?$"),f5=new RegExp("\\s+"),w5=new RegExp("[ /.-]"),y5=1e3,v5=E5((function(e){const t=e.toLowerCase().trim(),n=(t.endsWith("am/pm")?t.substring(0,t.length-5):t.endsWith("a/p")?t.substring(0,e.length-3):t).trim().split(":");return{itemsCount:n.length,hourItem:n.indexOf("hh"),minuteItem:n.indexOf("mm"),secondItem:n.findIndex((e=>g5.test(e)))}})),C5=E5((function(e){const t=e.toLowerCase().trim().split(w5);return{itemsCount:t.length,dayItem:t.indexOf("dd"),monthItem:t.indexOf("mm"),shortYearItem:t.indexOf("yy"),longYearItem:t.indexOf("yyyy")}}));function S5(e,t){var n,r,i;if(void 0===t)return;const{itemsCount:o,hourItem:s,minuteItem:a,secondItem:l}=v5(t);let h;if("am"===e[e.length-1]||"a"===e[e.length-1]?(h=!1,e.pop()):"pm"!==e[e.length-1]&&"p"!==e[e.length-1]||(h=!0,e.pop()),e.length!==o)return;const u=Number(null!==(n=e[l])&&void 0!==n?n:"0");if(!Number.isFinite(u))return;const c=Math.round(u*y5)/y5,d=Number(null!==(r=e[a])&&void 0!==r?r:"0");if(!Number.isFinite(d)||!Number.isInteger(d))return;const p=Number(null!==(i=e[s])&&void 0!==i?i:"0");if(!Number.isFinite(p)||!Number.isInteger(p))return;if(void 0!==h&&(p<0||p>12))return;return{hours:void 0!==h?p%12+(h?12:0):p,minutes:d,seconds:c}}function R5(e,t){var n;if(void 0===t)return;const{itemsCount:r,dayItem:i,monthItem:o,shortYearItem:s,longYearItem:a}=C5(t);if(e.length!==r)return;const l=Number(e[i]);if(!Number.isFinite(l)||!Number.isInteger(l))return;const h=Number(e[o]);if(!Number.isFinite(h)||!Number.isInteger(h))return;if(e[a]&&e[s])return;const u=Number(null!==(n=e[a])&&void 0!==n?n:e[s]);return Number.isFinite(u)&&Number.isInteger(u)&&!(e[a]&&(u<1e3||u>9999)||e[s]&&(u<0||u>99))?{year:u,month:h,day:l}:void 0}function E5(e){const t={};return n=>{const r=t[n];if(void 0!==r)return r;const i=e(n);return t[n]=i,i}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */const b5=[31,28,31,30,31,30,31,31,30,31,30,31],T5=[0,31,59,90,120,151,181,212,243,273,304,334],N5=60,A5=60,M5=24;function I5(e){return!(!e||"object"!=typeof e&&"function"!=typeof e)&&("year"in e&&"number"==typeof e.year&&"month"in e&&"number"==typeof e.month&&"day"in e&&"number"==typeof e.day)}function O5(e){return!(!e||"object"!=typeof e&&"function"!=typeof e)&&("hours"in e&&"number"==typeof e.hours&&"minutes"in e&&"number"==typeof e.minutes&&"seconds"in e&&"number"==typeof e.seconds)}const x5={year:9999,month:12,day:31};class P5{constructor(e){this.config=e,this.minDateAbsoluteValue=this.dateToNumberFromZero(e.nullDate),this.maxDateValue=this.dateToNumber(x5),this.leapYear1900=e.leapYear1900,!this.leapYear1900&&0<=this.dateToNumber({year:1900,month:2,day:28})?this.epochYearZero=this.numberToSimpleDate(2).year:this.epochYearZero=this.numberToSimpleDate(1).year,this.parseDateTime=e.parseDateTime}getWithinBounds(e){return e<=this.maxDateValue&&e>=0?e:void 0}dateStringToDateNumber(e){const{dateTime:t,dateFormat:n="",timeFormat:r=""}=this.parseDateTimeFromConfigFormats(e);if(void 0!==t)return O5(t)?I5(t)?new $3(k5(t)+this.dateToNumber(t),n+" "+r):new z3(k5(t),r):I5(t)?new j3(this.dateToNumber(t),n):0}parseDateTimeFromConfigFormats(e){return this.parseDateTimeFromFormats(e,this.config.dateFormats,this.config.timeFormats)}getNullYear(){return this.config.nullYear}getEpochYearZero(){return this.epochYearZero}isValidDate(e){return!(isNaN(e.year)||isNaN(e.month)||isNaN(e.day))&&(e.day===Math.round(e.day)&&e.month===Math.round(e.month)&&e.year===Math.round(e.year)&&(!(e.year<1582)&&(!(e.month<1||e.month>12)&&(!(e.day<1)&&(this.isLeapYear(e.year)&&2===e.month?e.day<=29:e.day<=b5[e.month-1])))))}dateToNumber(e){return this.dateToNumberFromZero(e)-this.minDateAbsoluteValue}relativeNumberToAbsoluteNumber(e){return e+this.minDateAbsoluteValue-(this.leapYear1900?1:0)}numberToSimpleDate(e){const t=Math.floor(e)+this.minDateAbsoluteValue;let n=Math.floor(t/365.2425);this.dateToNumberFromZero({year:n+1,month:1,day:1})<=t?n++:this.dateToNumberFromZero({year:n-1,month:1,day:1})>t&&n--;const r=t-this.dateToNumberFromZero({year:n,month:1,day:1}),i=function(e){let t=0;T5[t+6]<=e&&(t+=6);T5[t+3]<=e&&(t+=3);T5[t+2]<=e?t+=2:T5[t+1]<=e&&(t+=1);return t}(r-(this.isLeapYear(n)&&r>=59?1:0));return{year:n,month:i+1,day:r-T5[i]-(this.isLeapYear(n)&&i>1?1:0)+1}}numberToSimpleDateTime(e){const t=H5(e%1),n=Math.floor(t.hours/M5);t.hours=t.hours%M5;const r=this.numberToSimpleDate(Math.floor(e)+n);return Object.assign(Object.assign({},r),t)}leapYearsCount(e){return Math.floor(e/4)-Math.floor(e/100)+Math.floor(e/400)+(this.config.leapYear1900&&e>=1900?1:0)}daysInMonth(e,t){return this.isLeapYear(e)&&2===t?29:b5[t-1]}endOfMonth(e){return{year:e.year,month:e.month,day:this.daysInMonth(e.year,e.month)}}toBasisUS(e,t){return 31===e.day&&(e.day=30),30===e.day&&31===t.day&&(t.day=30),2===e.month&&e.day===this.daysInMonth(e.year,e.month)&&(e.day=30,2===t.month&&t.day===this.daysInMonth(t.year,t.month)&&(t.day=30)),[e,t]}yearLengthForBasis(e,t){return e.year!==t.year?e.year+1!==t.year||e.month<t.month||e.month===t.month&&e.day<t.day?(this.leapYearsCount(t.year)-this.leapYearsCount(e.year-1))/(t.year-e.year+1)+365:this.countLeapDays(t)!==this.countLeapDays({year:e.year,month:e.month,day:e.day-1})?366:365:this.isLeapYear(e.year)?366:365}parseSingleFormat(e,t,n){const r=this.parseDateTime(e,t,n);if(!I5(r)||(r.year>=0&&r.year<100&&(r.year<this.getNullYear()?r.year+=2e3:r.year+=1900),this.isValidDate(r)))return r}parseDateTimeFromFormats(e,t,n){const r=0===t.length?[void 0]:t,i=0===n.length?[void 0]:n;for(const o of r)for(const t of i){const n=this.parseSingleFormat(e,o,t);if(void 0!==n)return{dateTime:n,timeFormat:t,dateFormat:o}}return{}}countLeapDays(e){return e.month>2||2===e.month&&e.day>=29?this.leapYearsCount(e.year):this.leapYearsCount(e.year-1)}dateToNumberFromZero(e){return 365*e.year+T5[e.month-1]+e.day-1+(e.month<=2?this.leapYearsCount(e.year-1):this.leapYearsCount(e.year))}isLeapYear(e){return!(e%4)&&(!!(e%100)||(!(e%400)||1900===e&&this.config.leapYear1900))}}function _5(e,t){const n=12*e.year+e.month-1+t;return{year:Math.floor(n/12),month:n%12+1,day:e.day}}function L5(e){return Math.round(3600*e*24)/86400}function H5(e){const t=e*M5*A5*N5,n=function(e,t=1){return Math.round(e*t)/t}(t%N5,1e5)%N5,r=(t-n)/N5,i=Math.round(r%A5)%A5,o=(r-i)/A5;return{hours:Math.round(o),minutes:i,seconds:n}}function k5(e){return((e.seconds/60+e.minutes)/60+e.hours)/24}function F5(e){return{year:e.year,month:e.month,day:Math.min(30,e.day)}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
const D5=/(\\.|dd|DD|d|D|mm|MM|m|M|YYYY|YY|yyyy|yy|HH|hh|H|h|ss(\.(0+|s+))?|s|AM\/PM|am\/pm|A\/P|a\/p|\[mm]|\[MM]|\[hh]|\[HH])/g,V5=/(\\.|[#0]+(\.[#0]*)?)/g;var U5,B5;function W5(e,t){return{type:e,value:t}}function j5(e,t){const n=[];let r=0;for(let o=0;o<e.length;++o){const i=e[o];if(i.index!==r){const e=t.substr(r,i.index-r);n.push(W5(U5.FREE_TEXT,e))}i[0].startsWith("\\")?n.push(W5(U5.FREE_TEXT,i[0])):n.push(W5(U5.FORMAT,i[0])),r=i.index+i[0].length}const i=e[e.length-1];if(i.index+i[0].length<t.length){const e=t.substr(i.index+i[0].length,t.length);n.push(W5(U5.FREE_TEXT,e))}return n}function G5(e){const t=function(e){D5.lastIndex=0;const t=[];let n;do{n=D5.exec(e),null!==n&&t.push(n)}while(n);return t}(e);return t.every((e=>$5(e)))?void 0:{type:B5.DATE,tokens:j5(t,e)}}function z5(e){const t=function(e){V5.lastIndex=0;const t=V5.exec(e);return null!==t?[t]:[]}(e);return t.every((e=>$5(e)))?void 0:{type:B5.NUMBER,tokens:j5(t,e)}}function $5(e){return e[0].startsWith("\\")}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */function Y5(e,t,n,r){const i=n.stringifyDateTime(r.numberToSimpleDateTime(e),t);if(void 0!==i)return i;const o=n.stringifyDuration(H5(e),t);if(void 0!==o)return o;const s=z5(t);return void 0!==s?function(e,t){let n="";for(let r=0;r<e.length;++r){const i=e[r];if(i.type===U5.FREE_TEXT){n+=i.value;continue}const o=i.value.split("."),s=o[0],a=o[1]||"",l=o[1]?".":"",h=Number(t.toFixed(a.length)).toString().split(".");let u=h[0]||"",c=h[1]||"";if(s.length>u.length){u=K5(u,q5(s.substr(0,s.length-u.length),"0")+u.length)}c=X5(c,q5(a.substr(c.length,a.length-c.length),"0")+c.length),n+=u+l+c}return n}(s.tokens,e):t}function K5(e,t){let n=`${e}`;for(;n.length<t;)n="0"+n;return n}function X5(e,t){let n=`${e}`;for(;n.length<t;)n+="0";return n}function q5(e,t){return e.split(t).length-1}!function(e){e.FORMAT="FORMAT",e.FREE_TEXT="FREE_TEXT"}(U5||(U5={})),function(e){e.DATE="DATE",e.NUMBER="NUMBER",e.STRING="STRING"}(B5||(B5={}));
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
const Q5="length",Z5=e=>parseInt(e,16),J5=e=>parseInt(e,10),e6=e=>(e+"").replace(/\-/g,""),t6=(e,t,n)=>e.substr(t,n),n6=e=>e.codePointAt(0)-65;
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
const r6={invalid:()=>"The license key for HyperFormula is invalid.",expired:({keyValidityDate:e})=>`The license key for HyperFormula expired on ${e}, and is not valid for the installed version.`,missing:()=>"The license key for HyperFormula is missing."};let i6=!1;function o6(e){const t={template:"missing",vars:{}};if("gpl-v3"===e||"internal-use-in-handsontable"===e)t.template="valid";else if("string"==typeof e&&function(e){if((e=(e+"").replace(/\-/g,""))[Q5]!==n6("Z"))return!1;let t=0;return[[0,n6("G")+1],[n6("H"),n6("H")-1],[n6("G")+n6("H"),n6("G")]].reduce(((n,[r,i],o)=>(n|=(J5(`${J5(Z5(t6(e,t+r-(0===o?0:2),i+(o?2:0)))+(Z5(t6(e,t+r+i,2))+[]).padStart(2,"0"))}`)%97||2)>>1,t+=2,n)),n6("A"))===[]+1>>1}(e)){const[r,i,o]="14/01/2025".split("/"),s=Math.floor(new Date(`${i}/${r}/${o}`).getTime()/864e5),a=25===e6(n=e)[Q5]?Z5(t6(e6(n),Z5("12"),n6("F")))/(Z5(t6(e6(n),n6("C"),n6("Y")>>4))||1+(~~![][Q5]<<3)):0;t.vars.keyValidityDate=function(e){const t=["January","February","March","April","May","June","July","August","September","October","November","December"][e.getMonth()],n=e.getDate(),r=e.getFullYear();return`${t} ${n}, ${r}`}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */(new Date(864e5*(a+1))),t.template=s>a?"expired":"valid"}else""!==e&&(t.template="invalid");var n;return i6||"valid"===t.template||(console.warn(r6[t.template](t.vars)),i6=!0),t.template}var s6,a6,l6;!function(e){e.Number=class{constructor(e){this.value=e,this.value=W3(this.value,X4(U3(this.value)))}};e.String=class{constructor(e){this.value=e}};e.Boolean=class{constructor(e){this.value=e}};class t{static getSingletonInstance(){return t.instance||(t.instance=new t),t.instance}}e.Empty=t;e.Formula=class{constructor(e){this.formula=e}};e.Error=class{constructor(e,t){this.value=new C4(e,t)}}}(s6||(s6={}));class h6{constructor(e,t,n){this.config=e,this.dateHelper=t,this.numberLiteralsHelper=n}parse(e){if(null==e)return s6.Empty.getSingletonInstance();if("number"==typeof e)return K4(e)?new s6.Error(t4.NUM,K2.ValueLarge):new s6.Number(e);if("boolean"==typeof e)return new s6.Boolean(e);if(e instanceof Date){const t=this.dateHelper.dateToNumber({day:e.getDate(),month:e.getMonth()+1,year:e.getFullYear()})+k5({hours:e.getHours(),minutes:e.getMinutes(),seconds:e.getSeconds()+e.getMilliseconds()/1e3});return t<0?new s6.Error(t4.NUM,K2.DateBounds):t%1==0?new s6.Number(new j3(t,"Date()")):t<1?new s6.Number(new z3(t,"Date()")):new s6.Number(new $3(t,"Date()"))}if("string"==typeof e){if(function(e){const t=e.toLowerCase();return"true"===t||"false"===t}(e))return new s6.Boolean("true"===e.toLowerCase());if(function(e){return e.startsWith("=")}(e))return new s6.Formula(e);if(function(e,t){const n=e.toUpperCase();return/#[A-Za-z0-9\/]+[?!]?/.test(n)&&Object.prototype.hasOwnProperty.call(t,n)}(e,this.config.errorMapping))return new s6.Error(this.config.errorMapping[e.toUpperCase()]);{let t,n=e.trim(),r=0;if(n.endsWith("%"))r=1,n=n.slice(0,n.length-1);else{const e=this.currencyMatcher(n);void 0!==e&&(r=2,[t,n]=e)}const i=this.numberLiteralsHelper.numericStringToMaybeNumber(n);if(void 0!==i){let e;return e=1===r?new Y3(i/100):2===r?new G3(i,t):i,new s6.Number(e)}const o=this.dateHelper.dateStringToDateNumber(n);return void 0!==o?new s6.Number(o):new s6.String(e.startsWith("'")?e.slice(1):e)}}throw new v9(e)}currencyMatcher(e){for(const t of this.config.currencySymbol){if(e.startsWith(t))return[t,e.slice(t.length)];if(e.endsWith(t))return[t,e.slice(0,e.length-t.length)]}}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */!function(e){e[e.COPY=0]="COPY",e[e.CUT=1]="CUT"}(a6||(a6={})),function(e){e[e.VALUE=0]="VALUE",e[e.EMPTY=1]="EMPTY",e[e.FORMULA=2]="FORMULA",e[e.PARSING_ERROR=3]="PARSING_ERROR"}(l6||(l6={}));class u6{constructor(e,t,n,r,i){this.sourceLeftCorner=e,this.width=t,this.height=n,this.type=r,this.content=i}*getContent(e){if(void 0!==this.content)for(let t=0;t<this.height;++t)for(let n=0;n<this.width;++n)yield[T4(e.sheet,e.col+n,e.row+t),this.content[t][n]]}}class c6{constructor(e,t,n){this.dependencyGraph=t,this.operations=n,this.maxRows=e.maxRows,this.maxColumns=e.maxColumns}cut(e,t,n){this.clipboard=new u6(e,t,n,a6.CUT)}copy(e,t,n){const r=[];for(let i=0;i<n;++i){r[i]=[];for(let n=0;n<t;++n){const t=this.operations.getClipboardCell(T4(e.sheet,e.col+n,e.row+i));r[i].push(t)}}this.clipboard=new u6(e,t,n,a6.COPY,r)}abortCut(){this.clipboard&&this.clipboard.type===a6.CUT&&this.clear()}clear(){this.clipboard=void 0}ensureItIsPossibleToCopyPaste(e){if(void 0===this.clipboard)return;if(N4(e)||!this.dependencyGraph.sheetMapping.hasSheetWithId(e.sheet))throw new u9("a valid target address.");const t=L4.spanFrom(e,this.clipboard.width,this.clipboard.height);if(t.exceedsSheetSizeLimits(this.maxColumns,this.maxRows))throw new a9;if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(t))throw new Error("It is not possible to paste onto an array")}isCutClipboard(){return void 0!==this.clipboard&&this.clipboard.type===a6.CUT}isCopyClipboard(){return void 0!==this.clipboard&&this.clipboard.type===a6.COPY}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class d6{constructor(e,t,n,r){this.displayName=e,this.address=t,this.added=n,this.options=r}normalizeExpressionName(){return this.displayName.toLowerCase()}copy(){return new d6(this.displayName,this.address,this.added,this.options)}}class p6{constructor(){this.mapping=new Map}has(e){return this.mapping.has(this.normalizeExpressionName(e))}isNameAvailable(e){const t=this.normalizeExpressionName(e),n=this.mapping.get(t);return!(n&&n.added)}add(e){this.mapping.set(e.normalizeExpressionName(),e)}get(e){return this.mapping.get(this.normalizeExpressionName(e))}getExisting(e){const t=this.mapping.get(this.normalizeExpressionName(e));return t&&t.added?t:void 0}remove(e){const t=this.normalizeExpressionName(e),n=this.mapping.get(t);n&&(n.added=!1)}getAllNamedExpressions(){return Array.from(this.mapping.values()).filter((e=>e.added))}normalizeExpressionName(e){return e.toLowerCase()}}class g6{constructor(){this.mapping=new Map}add(e){this.mapping.set(this.normalizeExpressionName(e.displayName),e)}get(e){return this.mapping.get(this.normalizeExpressionName(e))}has(e){return this.mapping.has(this.normalizeExpressionName(e))}getAllNamedExpressions(){return Array.from(this.mapping.values()).filter((e=>e.added))}isNameAvailable(e){const t=this.normalizeExpressionName(e);return!this.mapping.has(t)}remove(e){const t=this.normalizeExpressionName(e);this.mapping.get(t)&&this.mapping.delete(t)}normalizeExpressionName(e){return e.toLowerCase()}}class m6{constructor(){this.nextNamedExpressionRow=0,this.workbookStore=new p6,this.worksheetStores=new Map,this.addressCache=new Map}isNameAvailable(e,t){var n,r;return void 0===t?this.workbookStore.isNameAvailable(e):null===(r=null===(n=this.worksheetStore(t))||void 0===n?void 0:n.isNameAvailable(e))||void 0===r||r}namedExpressionInAddress(e){const t=this.addressCache.get(e);return t&&t.added?t:void 0}namedExpressionForScope(e,t){var n;return void 0===t?this.workbookStore.getExisting(e):null===(n=this.worksheetStore(t))||void 0===n?void 0:n.get(e)}nearestNamedExpression(e,t){var n,r;return null!==(r=null===(n=this.worksheetStore(t))||void 0===n?void 0:n.get(e))&&void 0!==r?r:this.workbookStore.getExisting(e)}isExpressionInScope(e,t){var n,r;return null!==(r=null===(n=this.worksheetStore(t))||void 0===n?void 0:n.has(e))&&void 0!==r&&r}isNameValid(e){const t=new RegExp(`^${qQ}$`),n=new RegExp(`^${JQ}$`),r=new RegExp(`^${tZ}$`);return!t.test(e)&&!n.test(e)&&r.test(e)}addNamedExpression(e,t,n){const r=void 0===t?this.workbookStore:this.worksheetStoreOrCreate(t);let i=r.get(e);return void 0!==i?(i.added=!0,i.displayName=e,i.options=n):(i=new d6(e,this.nextAddress(),!0,n),r.add(i)),this.addressCache.set(i.address.row,i),i}restoreNamedExpression(e,t){const n=void 0===t?this.workbookStore:this.worksheetStoreOrCreate(t);return e.added=!0,n.add(e),this.addressCache.set(e.address.row,e),e}namedExpressionOrPlaceholder(e,t){var n;return null!==(n=this.worksheetStoreOrCreate(t).get(e))&&void 0!==n?n:this.workbookNamedExpressionOrPlaceholder(e)}workbookNamedExpressionOrPlaceholder(e){let t=this.workbookStore.get(e);return void 0===t&&(t=new d6(e,this.nextAddress(),!1),this.workbookStore.add(t)),t}remove(e,t){let n;n=void 0===t?this.workbookStore:this.worksheetStore(t);const r=null==n?void 0:n.get(e);if(void 0===n||void 0===r||!r.added)throw Error("Named expression does not exist");n.remove(e),n instanceof g6&&0===n.mapping.size&&this.worksheetStores.delete(t),this.addressCache.delete(r.address.row)}getAllNamedExpressionsNamesInScope(e){return this.getAllNamedExpressions().filter((({scope:t})=>t===e)).map((e=>e.expression.displayName))}getAllNamedExpressionsNames(){return this.getAllNamedExpressions().map((e=>e.expression.displayName))}getAllNamedExpressions(){const e=[];return this.workbookStore.getAllNamedExpressions().forEach((t=>{e.push({expression:t,scope:void 0})})),this.worksheetStores.forEach(((t,n)=>{t.getAllNamedExpressions().forEach((t=>{e.push({expression:t,scope:n})}))})),e}getAllNamedExpressionsForScope(e){var t,n;return void 0===e?this.workbookStore.getAllNamedExpressions():null!==(n=null===(t=this.worksheetStores.get(e))||void 0===t?void 0:t.getAllNamedExpressions())&&void 0!==n?n:[]}worksheetStoreOrCreate(e){let t=this.worksheetStores.get(e);return t||(t=new g6,this.worksheetStores.set(e,t)),t}worksheetStore(e){return this.worksheetStores.get(e)}nextAddress(){return T4(m6.SHEET_FOR_WORKBOOK_EXPRESSIONS,0,this.nextNamedExpressionRow++)}}m6.SHEET_FOR_WORKBOOK_EXPRESSIONS=-1;const f6=e=>{switch(e.type){case H2.EMPTY:case H2.NUMBER:case H2.STRING:case H2.ERROR:case H2.ERROR_WITH_RAW_INPUT:return!1;case H2.CELL_REFERENCE:return!e.reference.isAbsolute();case H2.CELL_RANGE:case H2.COLUMN_RANGE:case H2.ROW_RANGE:return!e.start.isAbsolute();case H2.NAMED_EXPRESSION:return!1;case H2.PERCENT_OP:case H2.PLUS_UNARY_OP:case H2.MINUS_UNARY_OP:return f6(e.value);case H2.CONCATENATE_OP:case H2.EQUALS_OP:case H2.NOT_EQUAL_OP:case H2.LESS_THAN_OP:case H2.GREATER_THAN_OP:case H2.LESS_THAN_OR_EQUAL_OP:case H2.GREATER_THAN_OR_EQUAL_OP:case H2.MINUS_OP:case H2.PLUS_OP:case H2.TIMES_OP:case H2.DIV_OP:case H2.POWER_OP:return f6(e.left)||f6(e.right);case H2.PARENTHESIS:return f6(e.expression);case H2.FUNCTION_CALL:return e.args.some((e=>f6(e)));case H2.ARRAY:return e.args.some((e=>e.some((e=>f6(e)))))}};
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class w6{performEagerTransformations(e,t){for(const n of e.arrayFormulaNodes()){const[r,i]=this.transformSingleAst(n.getFormula(e.lazilyTransformingAstService),n.getAddress(e.lazilyTransformingAstService)),o=t.rememberNewAst(r);n.setFormula(o),n.setAddress(i)}}transformSingleAst(e,t){return[this.transformAst(e,t),this.fixNodeAddress(t)]}transformAst(e,t){switch(e.type){case H2.CELL_REFERENCE:return this.transformCellReferenceAst(e,t);case H2.CELL_RANGE:return this.transformCellRangeAst(e,t);case H2.COLUMN_RANGE:return this.transformColumnRangeAst(e,t);case H2.ROW_RANGE:return this.transformRowRangeAst(e,t);case H2.EMPTY:case H2.ERROR:case H2.NUMBER:case H2.NAMED_EXPRESSION:case H2.ERROR_WITH_RAW_INPUT:case H2.STRING:return e;case H2.PERCENT_OP:case H2.MINUS_UNARY_OP:case H2.PLUS_UNARY_OP:return Object.assign(Object.assign({},e),{value:this.transformAst(e.value,t)});case H2.FUNCTION_CALL:return Object.assign(Object.assign({},e),{procedureName:e.procedureName,args:e.args.map((e=>this.transformAst(e,t)))});case H2.PARENTHESIS:return Object.assign(Object.assign({},e),{expression:this.transformAst(e.expression,t)});case H2.ARRAY:return Object.assign(Object.assign({},e),{args:e.args.map((e=>e.map((e=>this.transformAst(e,t)))))});default:return Object.assign(Object.assign({},e),{left:this.transformAst(e.left,t),right:this.transformAst(e.right,t)})}}transformCellReferenceAst(e,t){const n=this.transformCellAddress(e.reference,t);return n instanceof jQ?Object.assign(Object.assign({},e),{reference:n}):n===t4.REF?U2(new C4(t4.REF)):e}transformCellRangeAst(e,t){const n=this.transformCellRange(e.start,e.end,t);return Array.isArray(n)?Object.assign(Object.assign({},e),{start:n[0],end:n[1]}):n===t4.REF?U2(new C4(t4.REF)):e}transformColumnRangeAst(e,t){const n=this.transformColumnRange(e.start,e.end,t);return Array.isArray(n)?Object.assign(Object.assign({},e),{start:n[0],end:n[1]}):n===t4.REF?U2(new C4(t4.REF)):e}transformRowRangeAst(e,t){const n=this.transformRowRange(e.start,e.end,t);return Array.isArray(n)?Object.assign(Object.assign({},e),{start:n[0],end:n[1]}):n===t4.REF?U2(new C4(t4.REF)):e}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class y6 extends w6{constructor(e){super(),this.columnsSpan=e}get sheet(){return this.columnsSpan.sheet}isIrreversible(){return!1}transformRowRangeAst(e,t){return e}transformCellRange(e,t,n){return this.transformRange(e,t,n)}transformRowRange(e,t,n){throw Error("Not implemented")}transformColumnRange(e,t,n){return this.transformRange(e,t,n)}transformCellAddress(e,t){const n=O4(e,t);if(n!==this.columnsSpan.sheet&&t.sheet!==this.columnsSpan.sheet)return!1;const r=e.toSimpleColumnAddress(t);if(n===this.columnsSpan.sheet&&t.sheet!==this.columnsSpan.sheet)return this.columnsSpan.columnStart<=r.col&&e.shiftedByColumns(this.columnsSpan.numberOfColumns);if(t.sheet===this.columnsSpan.sheet&&n!==this.columnsSpan.sheet)return!e.isColumnAbsolute()&&(!(t.col<this.columnsSpan.columnStart)&&e.shiftedByColumns(-this.columnsSpan.numberOfColumns));if(e.isColumnAbsolute())return!(e.col<this.columnsSpan.columnStart)&&e.shiftedByColumns(this.columnsSpan.numberOfColumns);return e.toSimpleColumnAddress(t).col<this.columnsSpan.columnStart?!(t.col<this.columnsSpan.columnStart)&&e.shiftedByColumns(-this.columnsSpan.numberOfColumns):t.col<this.columnsSpan.columnStart&&e.shiftedByColumns(this.columnsSpan.numberOfColumns)}fixNodeAddress(e){return this.columnsSpan.sheet===e.sheet&&this.columnsSpan.columnStart<=e.col?Object.assign(Object.assign({},e),{col:e.col+this.columnsSpan.numberOfColumns}):e}transformRange(e,t,n){const r=this.transformCellAddress(e,n),i=this.transformCellAddress(t,n);return r===t4.REF||i===t4.REF?t4.REF:!(!r&&!i)&&[r||e,i||t]}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class v6 extends w6{constructor(e){super(),this.rowsSpan=e}get sheet(){return this.rowsSpan.sheet}isIrreversible(){return!1}transformColumnRangeAst(e,t){return e}transformCellRange(e,t,n){return this.transformRange(e,t,n)}transformRowRange(e,t,n){return this.transformRange(e,t,n)}transformColumnRange(e,t,n){throw Error("Not implemented")}transformCellAddress(e,t){const n=O4(e,t);if(n!==this.rowsSpan.sheet&&t.sheet!==this.rowsSpan.sheet)return!1;const r=e.toSimpleRowAddress(t);return n===this.rowsSpan.sheet&&t.sheet!==this.rowsSpan.sheet?this.rowsSpan.rowStart<=r.row&&e.shiftedByRows(this.rowsSpan.numberOfRows):t.sheet===this.rowsSpan.sheet&&n!==this.rowsSpan.sheet?!e.isRowAbsolute()&&(!(t.row<this.rowsSpan.rowStart)&&e.shiftedByRows(-this.rowsSpan.numberOfRows)):e.isRowAbsolute()?!(e.row<this.rowsSpan.rowStart)&&e.shiftedByRows(this.rowsSpan.numberOfRows):r.row<this.rowsSpan.rowStart?!(t.row<this.rowsSpan.rowStart)&&e.shiftedByRows(-this.rowsSpan.numberOfRows):t.row<this.rowsSpan.rowStart&&e.shiftedByRows(this.rowsSpan.numberOfRows)}fixNodeAddress(e){return this.rowsSpan.sheet===e.sheet&&this.rowsSpan.rowStart<=e.row?Object.assign(Object.assign({},e),{row:e.row+this.rowsSpan.numberOfRows}):e}transformRange(e,t,n){const r=this.transformCellAddress(e,n),i=this.transformCellAddress(t,n);return r===t4.REF||i===t4.REF?t4.REF:!(!r&&!i)&&[r||e,i||t]}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class C6 extends w6{constructor(e){super(),this.sheet=e}isIrreversible(){return!0}fixNodeAddress(e){return e}transformCellAddress(e,t){return!!e.isInvalid(t)&&t4.REF}transformCellRange(e,t,n){return!(!e.isInvalid(n)&&!t.isInvalid(n))&&t4.REF}transformColumnRange(e,t,n){return!(!e.isInvalid(n)&&!t.isInvalid(n))&&t4.REF}transformRowRange(e,t,n){return!(!e.isInvalid(n)&&!t.isInvalid(n))&&t4.REF}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class S6 extends w6{constructor(e,t,n,r){super(),this.sourceRange=e,this.toRight=t,this.toBottom=n,this.toSheet=r,this.dependentFormulaTransformer=new R6(e,t,n,r)}get sheet(){return this.sourceRange.sheet}isIrreversible(){return!0}transformSingleAst(e,t){if(this.sourceRange.addressInRange(t)){return[this.transformAst(e,t),this.fixNodeAddress(t)]}return this.dependentFormulaTransformer.transformSingleAst(e,t)}fixNodeAddress(e){return T4(this.toSheet,e.col+this.toRight,e.row+this.toBottom)}transformCellAddress(e,t){return this.transformAddress(e,t)}transformCellRange(e,t,n){return this.transformRange(e,t,n)}transformColumnRange(e,t,n){return this.transformRange(e,t,n)}transformRowRange(e,t,n){return this.transformRange(e,t,n)}transformAddress(e,t){const n=this.sourceRange;if(e instanceof jQ){const r=e.toSimpleCellAddress(t);if(n.addressInRange(r))return e.shiftAbsoluteDimensions(this.toRight,this.toBottom)}return e.shiftRelativeDimensions(-this.toRight,-this.toBottom)}transformRange(e,t,n){const r=this.sourceRange;if(e instanceof jQ&&t instanceof jQ){const i=e.toSimpleCellAddress(n),o=t.toSimpleCellAddress(n);if(r.addressInRange(i)&&r.addressInRange(o))return[e.shiftAbsoluteDimensions(this.toRight,this.toBottom),t.shiftAbsoluteDimensions(this.toRight,this.toBottom)]}return[e.shiftRelativeDimensions(-this.toRight,-this.toBottom),t.shiftRelativeDimensions(-this.toRight,-this.toBottom)]}}class R6 extends w6{constructor(e,t,n,r){super(),this.sourceRange=e,this.toRight=t,this.toBottom=n,this.toSheet=r}get sheet(){return this.sourceRange.sheet}isIrreversible(){return!0}fixNodeAddress(e){return e}transformCellAddress(e,t){return!!this.shouldMove(e,t)&&e.moved(this.toSheet,this.toRight,this.toBottom)}transformCellRange(e,t,n){return this.transformRange(e,t,n)}transformColumnRange(e,t,n){return this.transformRange(e,t,n)}transformRowRange(e,t,n){return this.transformRange(e,t,n)}shouldMove(e,t){return e instanceof jQ?this.sourceRange.addressInRange(e.toSimpleCellAddress(t)):e instanceof WQ?this.sourceRange.rowInRange(e.toSimpleRowAddress(t))&&!this.sourceRange.isFinite():this.sourceRange.columnInRange(e.toSimpleColumnAddress(t))&&!this.sourceRange.isFinite()}transformRange(e,t,n){const r=this.transformCellAddress(e,n),i=this.transformCellAddress(t,n);return!(!r||!i)&&[r,i]}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class E6 extends w6{constructor(e){super(),this.columnsSpan=e}get sheet(){return this.columnsSpan.sheet}isIrreversible(){return!0}transformRowRangeAst(e,t){return e}transformCellRange(e,t,n){return this.transformRange(e,t,n)}transformRowRange(e,t,n){throw Error("Not implemented")}transformColumnRange(e,t,n){return this.transformRange(e,t,n)}transformCellAddress(e,t){const n=O4(e,t);if(this.columnsSpan.sheet!==t.sheet&&this.columnsSpan.sheet!==n)return!1;if(this.columnsSpan.sheet!==t.sheet&&this.columnsSpan.sheet===n){const n=e.toSimpleColumnAddress(t);if(n.col<this.columnsSpan.columnStart)return!1;if(n.col>this.columnsSpan.columnEnd)return e.shiftedByColumns(-this.columnsSpan.numberOfColumns)}if(this.columnsSpan.sheet===t.sheet&&this.columnsSpan.sheet!==n){if(e.isColumnAbsolute())return!1;if(t.col<this.columnsSpan.columnStart)return!1;if(t.col>this.columnsSpan.columnEnd)return e.shiftedByColumns(this.columnsSpan.numberOfColumns)}if(this.columnsSpan.sheet===t.sheet&&this.columnsSpan.sheet===n)if(e.isColumnAbsolute()){if(e.col<this.columnsSpan.columnStart)return!1;if(e.col>this.columnsSpan.columnEnd)return e.shiftedByColumns(-this.columnsSpan.numberOfColumns)}else{const n=e.toSimpleColumnAddress(t);if(n.col<this.columnsSpan.columnStart){if(t.col<this.columnsSpan.columnStart)return!1;if(t.col>this.columnsSpan.columnEnd)return e.shiftedByColumns(this.columnsSpan.numberOfColumns)}else if(n.col>this.columnsSpan.columnEnd){if(t.col<this.columnsSpan.columnStart)return e.shiftedByColumns(-this.columnsSpan.numberOfColumns);if(t.col>this.columnsSpan.columnEnd)return!1}}return t4.REF}fixNodeAddress(e){return this.columnsSpan.sheet===e.sheet&&this.columnsSpan.columnStart<=e.col?Object.assign(Object.assign({},e),{col:e.col-this.columnsSpan.numberOfColumns}):e}transformRange(e,t,n){const r=O4(e,n);let i=e,o=t;if(this.columnsSpan.sheet===r){const r=e.toSimpleColumnAddress(n),s=t.toSimpleColumnAddress(n);if(this.columnsSpan.columnStart<=r.col&&this.columnsSpan.columnEnd>=s.col)return t4.REF;r.col>=this.columnsSpan.columnStart&&r.col<=this.columnsSpan.columnEnd&&(i=e.shiftedByColumns(this.columnsSpan.columnEnd-r.col+1)),s.col>=this.columnsSpan.columnStart&&s.col<=this.columnsSpan.columnEnd&&(o=t.shiftedByColumns(-(s.col-this.columnsSpan.columnStart+1)))}const s=this.transformCellAddress(i,n),a=this.transformCellAddress(o,n);if(!1===s&&!1===a)return[i,o];if(s===t4.REF||a===t4.REF)throw Error("Cannot happen");return[s||i,a||o]}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class b6 extends w6{constructor(e){super(),this.rowsSpan=e}get sheet(){return this.rowsSpan.sheet}isIrreversible(){return!0}transformColumnRangeAst(e,t){return e}transformCellAddress(e,t){const n=O4(e,t);if(this.rowsSpan.sheet!==t.sheet&&this.rowsSpan.sheet!==n)return!1;if(this.rowsSpan.sheet!==t.sheet&&this.rowsSpan.sheet===n){const n=e.toSimpleRowAddress(t);if(n.row<this.rowsSpan.rowStart)return!1;if(n.row>this.rowsSpan.rowEnd)return e.shiftedByRows(-this.rowsSpan.numberOfRows)}if(this.rowsSpan.sheet===t.sheet&&this.rowsSpan.sheet!==n){if(e.isRowAbsolute())return!1;if(t.row<this.rowsSpan.rowStart)return!1;if(t.row>this.rowsSpan.rowEnd)return e.shiftedByRows(this.rowsSpan.numberOfRows)}if(this.rowsSpan.sheet===t.sheet&&this.rowsSpan.sheet===n)if(e.isRowAbsolute()){if(e.row<this.rowsSpan.rowStart)return!1;if(e.row>this.rowsSpan.rowEnd)return e.shiftedByRows(-this.rowsSpan.numberOfRows)}else{const n=e.toSimpleRowAddress(t);if(n.row<this.rowsSpan.rowStart){if(t.row<this.rowsSpan.rowStart)return!1;if(t.row>this.rowsSpan.rowEnd)return e.shiftedByRows(this.rowsSpan.numberOfRows)}else if(n.row>this.rowsSpan.rowEnd){if(t.row<this.rowsSpan.rowStart)return e.shiftedByRows(-this.rowsSpan.numberOfRows);if(t.row>this.rowsSpan.rowEnd)return!1}}return t4.REF}transformCellRange(e,t,n){return this.transformRange(e,t,n)}transformRowRange(e,t,n){return this.transformRange(e,t,n)}transformColumnRange(e,t,n){throw Error("Not implemented")}fixNodeAddress(e){return this.rowsSpan.sheet===e.sheet&&this.rowsSpan.rowStart<=e.row?Object.assign(Object.assign({},e),{row:e.row-this.rowsSpan.numberOfRows}):e}transformRange(e,t,n){const r=O4(e,n);let i=e,o=t;if(this.rowsSpan.sheet===r){const r=e.toSimpleRowAddress(n),s=t.toSimpleRowAddress(n);if(this.rowsSpan.rowStart<=r.row&&this.rowsSpan.rowEnd>=s.row)return t4.REF;r.row>=this.rowsSpan.rowStart&&r.row<=this.rowsSpan.rowEnd&&(i=e.shiftedByRows(this.rowsSpan.rowEnd-r.row+1)),s.row>=this.rowsSpan.rowStart&&s.row<=this.rowsSpan.rowEnd&&(o=t.shiftedByRows(-(s.row-this.rowsSpan.rowStart+1)))}const s=this.transformCellAddress(i,n),a=this.transformCellAddress(o,n);return!1===s&&!1===a?[i,o]:s===t4.REF||a===t4.REF?t4.REF:[s||i,a||o]}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class T6 extends w6{constructor(e){super(),this.sheet=e}isIrreversible(){return!0}performEagerTransformations(e,t){for(const n of e.arrayFormulaNodes()){const[t]=this.transformSingleAst(n.getFormula(e.lazilyTransformingAstService),n.getAddress(e.lazilyTransformingAstService));n.setFormula(t)}}fixNodeAddress(e){return e}transformCellAddress(e,t){return this.transformAddress(e)}transformCellRange(e,t,n){return this.transformAddress(e)}transformColumnRange(e,t,n){return this.transformAddress(e)}transformRowRange(e,t,n){return this.transformAddress(e)}transformAddress(e){return e.sheet===this.sheet&&t4.REF}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */function N6(e){if(!Array.isArray(e))throw new u9("an array of arrays.");for(let t=0;t<e.length;t++)if(!Array.isArray(e[t]))throw new u9("an array of arrays.")}function A6(e){let t=0,n=0,r=0;for(let o=0;o<e.length;o++){let i=0;for(let t=0;t<e[o].length;t++){const n=e[o][t];null!=n&&(i=t+1,++r)}t=Math.max(t,i),i>0&&(n=o+1)}const i=t*n;return{height:n,width:t,fill:0===i?0:r/i}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class M6{constructor(e,t){this.sheet=e,this.indexes=t}normalizedIndexes(){return _6(this.indexes)}rowsSpans(){return this.normalizedIndexes().map((e=>e9.fromNumberOfRows(this.sheet,e[0],e[1])))}}class I6{constructor(e,t){this.sheet=e,this.indexes=t}normalizedIndexes(){return L6(this.indexes)}rowsSpans(){return this.normalizedIndexes().map((e=>e9.fromNumberOfRows(this.sheet,e[0],e[1])))}}class O6{constructor(e,t){this.sheet=e,this.indexes=t}normalizedIndexes(){return L6(this.indexes)}columnsSpans(){return this.normalizedIndexes().map((e=>t9.fromNumberOfColumns(this.sheet,e[0],e[1])))}}class x6{constructor(e,t){this.sheet=e,this.indexes=t}normalizedIndexes(){return _6(this.indexes)}columnsSpans(){return this.normalizedIndexes().map((e=>t9.fromNumberOfColumns(this.sheet,e[0],e[1])))}}class P6{constructor(e,t,n,r,i,o,s,a,l){this.dependencyGraph=t,this.columnSearch=n,this.cellContentParser=r,this.parser=i,this.stats=o,this.lazilyTransformingAstService=s,this.namedExpressions=a,this.arraySizePredictor=l,this.changes=J3.empty(),this.allocateNamedExpressionAddressSpace(),this.maxColumns=e.maxColumns,this.maxRows=e.maxRows}get sheetMapping(){return this.dependencyGraph.sheetMapping}get addressMapping(){return this.dependencyGraph.addressMapping}removeRows(e){const t=[];for(const n of e.rowsSpans()){const e=this.doRemoveRows(n);e&&t.push(e)}return t}addRows(e){for(const t of e.rowsSpans())this.doAddRows(t)}addColumns(e){for(const t of e.columnsSpans())this.doAddColumns(t)}removeColumns(e){const t=[];for(const n of e.columnsSpans()){const e=this.doRemoveColumns(n);e&&t.push(e)}return t}removeSheet(e){this.dependencyGraph.removeSheet(e);let t=0;this.stats.measure(q3.TRANSFORM_ASTS,(()=>{const n=new T6(e);n.performEagerTransformations(this.dependencyGraph,this.parser),t=this.lazilyTransformingAstService.addTransformation(n)})),this.sheetMapping.removeSheet(e),this.columnSearch.removeSheet(e);const n=this.namedExpressions.getAllNamedExpressionsForScope(e).map((t=>this.removeNamedExpression(t.normalizeExpressionName(),e)));return{version:t,scopedNamedExpressions:n}}removeSheetByName(e){const t=this.sheetMapping.fetch(e);return this.removeSheet(t)}clearSheet(e){this.dependencyGraph.clearSheet(e),this.columnSearch.removeSheet(e)}addSheet(e){const t=this.sheetMapping.addSheet(e);return this.dependencyGraph.addressMapping.autoAddSheet(t,A6([])),this.sheetMapping.fetchDisplayName(t)}renameSheet(e,t){return this.sheetMapping.renameSheet(e,t)}moveRows(e,t,n,r){const i=e9.fromNumberOfRows(e,r,n);this.lazilyTransformingAstService.beginCombinedMode(e),this.doAddRows(i),r<t&&(t+=n);const o=T4(e,0,t),s=T4(e,0,r);this.moveCells(o,Number.POSITIVE_INFINITY,n,s);const a=e9.fromNumberOfRows(e,t,n);return this.doRemoveRows(a),this.lazilyTransformingAstService.commitCombinedMode()}moveColumns(e,t,n,r){const i=t9.fromNumberOfColumns(e,r,n);this.lazilyTransformingAstService.beginCombinedMode(e),this.doAddColumns(i),r<t&&(t+=n);const o=T4(e,t,0),s=T4(e,r,0);this.moveCells(o,n,Number.POSITIVE_INFINITY,s);const a=t9.fromNumberOfColumns(e,t,n);return this.doRemoveColumns(a),this.lazilyTransformingAstService.commitCombinedMode()}moveCells(e,t,n,r){this.ensureItIsPossibleToMoveCells(e,t,n,r);const i=L4.spanFrom(e,t,n),o=L4.spanFrom(r,t,n),s=r.col-e.col,a=r.row-e.row,l=r.sheet,h=this.getRangeClipboardCells(o),u=this.dependencyGraph.rawValuesFromRange(o);this.columnSearch.removeValues(u);const c=this.dependencyGraph.rawValuesFromRange(i);this.columnSearch.moveValues(c,s,a,l);let d=0;this.stats.measure(q3.TRANSFORM_ASTS,(()=>{const e=new S6(i,s,a,l);e.performEagerTransformations(this.dependencyGraph,this.parser),d=this.lazilyTransformingAstService.addTransformation(e)})),this.dependencyGraph.moveCells(i,s,a,l);const p=this.updateNamedExpressionsForMovedCells(e,t,n,r);return{version:d,overwrittenCellsData:h,addedGlobalNamedExpressions:p}}setRowOrder(e,t){const n=[];let r=[];for(const[i,o]of t)if(i!==o){const t=L4.spanFrom({sheet:e,col:0,row:i},1/0,1),s=this.getRangeClipboardCells(t);r=r.concat(s),n.push(s.map((([{sheet:e,col:t},n])=>[{sheet:e,col:t,row:o},n])))}return n.forEach((t=>this.restoreClipboardCells(e,t.values()))),r}setColumnOrder(e,t){const n=[];let r=[];for(const[i,o]of t)if(i!==o){const t=L4.spanFrom({sheet:e,col:i,row:0},1,1/0),s=this.getRangeClipboardCells(t);r=r.concat(s),n.push(s.map((([{sheet:e,col:t,row:n},r])=>[{sheet:e,col:o,row:n},r])))}return n.forEach((t=>this.restoreClipboardCells(e,t.values()))),r}addNamedExpression(e,t,n,r){const i=this.namedExpressions.addNamedExpression(e,n,r);this.storeNamedExpressionInCell(i.address,t),this.adjustNamedExpressionEdges(i,e,n)}restoreNamedExpression(e,t,n){const r=e.displayName;this.restoreCell(e.address,t);const i=this.namedExpressions.restoreNamedExpression(e,n);this.adjustNamedExpressionEdges(i,r,n)}changeNamedExpressionExpression(e,t,n,r){const i=this.namedExpressions.namedExpressionForScope(e,n);if(!i)throw new g9(e);const o=i.copy();i.options=r;const s=this.getClipboardCell(i.address);return this.storeNamedExpressionInCell(i.address,t),[o,s]}removeNamedExpression(e,t){const n=this.namedExpressions.namedExpressionForScope(e,t);if(!n)throw new g9(e);this.namedExpressions.remove(n.displayName,t);const r=this.getClipboardCell(n.address);if(void 0!==t){const t=this.namedExpressions.workbookNamedExpressionOrPlaceholder(e);this.dependencyGraph.exchangeNode(n.address,t.address)}else this.dependencyGraph.setCellEmpty(n.address);return[n,r]}ensureItIsPossibleToMoveCells(e,t,n,r){if(N4(e)||!(H6(t)&&H6(n)||function(e,t,n){return 0===e.row&&H6(t)&&n===Number.POSITIVE_INFINITY||0===e.col&&H6(n)&&t===Number.POSITIVE_INFINITY}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */(e,t,n))||N4(r)||!this.sheetMapping.hasSheetWithId(e.sheet)||!this.sheetMapping.hasSheetWithId(r.sheet))throw new u9("a valid range of cells to move.");const i=L4.spanFrom(e,t,n),o=L4.spanFrom(r,t,n);if(o.exceedsSheetSizeLimits(this.maxColumns,this.maxRows))throw new a9;if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(i))throw new P9;if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(o))throw new _9}restoreClipboardCells(e,t){const n=[];for(const[r,i]of t)if(this.restoreCell(r,i),i.type===l6.FORMULA){const{dependencies:t}=this.parser.fetchCachedResult(i.hash);n.push(...this.updateNamedExpressionsForTargetAddress(e,r,t))}return n}restoreCell(e,t){switch(t.type){case l6.VALUE:this.setValueToCell(t,e);break;case l6.FORMULA:this.setFormulaToCellFromCache(t.hash,e);break;case l6.EMPTY:this.setCellEmpty(e);break;case l6.PARSING_ERROR:this.setParsingErrorToCell(t.rawInput,t.errors,e)}}getOldContent(e){const t=this.dependencyGraph.getCell(e);if(void 0===t||t instanceof a4)return[e,{type:l6.EMPTY}];if(t instanceof l4)return[e,Object.assign({type:l6.VALUE},t.getValues())];if(t instanceof B9)return[t.getAddress(this.lazilyTransformingAstService),{type:l6.FORMULA,hash:this.parser.computeHashFromAst(t.getFormula(this.lazilyTransformingAstService))}];if(t instanceof h4)return[e,{type:l6.PARSING_ERROR,rawInput:t.rawInput,errors:t.errors}];throw Error("Trying to copy unsupported type")}getClipboardCell(e){const t=this.dependencyGraph.getCell(e);if(void 0===t||t instanceof a4)return{type:l6.EMPTY};if(t instanceof l4)return Object.assign({type:l6.VALUE},t.getValues());if(t instanceof W9){const n=t.getArrayCellValue(e);return n===V3?{type:l6.EMPTY}:{type:l6.VALUE,parsedValue:n,rawValue:t.getArrayCellRawValue(e)}}if(t instanceof j9)return{type:l6.FORMULA,hash:this.parser.computeHashFromAst(t.getFormula(this.lazilyTransformingAstService))};if(t instanceof h4)return{type:l6.PARSING_ERROR,rawInput:t.rawInput,errors:t.errors};throw Error("Trying to copy unsupported type")}getSheetClipboardCells(e){const t=this.dependencyGraph.getSheetHeight(e),n=this.dependencyGraph.getSheetWidth(e),r=new Array(t);for(let i=0;i<t;i++){r[i]=new Array(n);for(let t=0;t<n;t++){const n=T4(e,t,i);r[i][t]=this.getClipboardCell(n)}}return r}getRangeClipboardCells(e){const t=[];for(const n of e.addresses(this.dependencyGraph))t.push([n,this.getClipboardCell(n)]);return t}setCellContent(e,t){const n=this.cellContentParser.parse(t),r=this.getOldContent(e);if(n instanceof s6.Formula){const t=this.parser.parse(n.formula,e),{ast:r,errors:i}=t;if(i.length>0)this.setParsingErrorToCell(n.formula,i,e);else try{const n=this.arraySizePredictor.checkArraySize(r,e);if(n.width<=0||n.height<=0)throw Error("Incorrect array size");this.setFormulaToCell(e,n,t)}catch(Dm){if(!Dm.message)throw Dm;const r={type:L2.InvalidRangeSize,message:"Invalid range size."};this.setParsingErrorToCell(n.formula,[r],e)}}else n instanceof s6.Empty?this.setCellEmpty(e):this.setValueToCell({parsedValue:n.value,rawValue:t},e);return r}setSheetContent(e,t){this.clearSheet(e);for(let n=0;n<t.length;n++)for(let r=0;r<t[n].length;r++){const i=T4(e,r,n);this.setCellContent(i,t[n][r])}}setParsingErrorToCell(e,t,n){const r=this.dependencyGraph.getCellValue(n),i=new h4(t,e),o=this.dependencyGraph.setParsingErrorToCell(n,i);this.columnSearch.remove(U3(r),n),this.columnSearch.applyChanges(o.getChanges()),this.changes.addAll(o),this.changes.addChange(i.getCellValue(),n)}setFormulaToCell(e,t,{ast:n,hasVolatileFunction:r,hasStructuralChangeFunction:i,dependencies:o}){const s=this.dependencyGraph.getCellValue(e),a=this.dependencyGraph.setFormulaToCell(e,n,D3(o,e),t,r,i);this.columnSearch.remove(U3(s),e),this.columnSearch.applyChanges(a.getChanges()),this.changes.addAll(a)}setValueToCell(e,t){const n=this.dependencyGraph.getCellValue(t),r=this.dependencyGraph.setValueToCell(t,e);this.columnSearch.change(U3(n),U3(e.parsedValue),t),this.columnSearch.applyChanges(r.getChanges().filter((e=>!x4(e.address,t)))),this.changes.addAll(r),this.changes.addChange(e.parsedValue,t)}setCellEmpty(e){if(this.dependencyGraph.isArrayInternalCell(e))return;const t=this.dependencyGraph.getCellValue(e),n=this.dependencyGraph.setCellEmpty(e);this.columnSearch.remove(U3(t),e),this.columnSearch.applyChanges(n.getChanges()),this.changes.addAll(n),this.changes.addChange(V3,e)}setFormulaToCellFromCache(e,t){const{ast:n,hasVolatileFunction:r,hasStructuralChangeFunction:i,dependencies:o}=this.parser.fetchCachedResult(e),s=D3(o,t),[a]=new C6(t.sheet).transformSingleAst(n,t);this.parser.rememberNewAst(a);const l=s.filter((e=>e instanceof F3||(e instanceof L4?!(N4(e.start)||N4(e.end)):!N4(e))));const h=this.arraySizePredictor.checkArraySize(n,t);this.dependencyGraph.setFormulaToCell(t,a,l,h,r,i)}rowEffectivelyNotInSheet(e,t){return e>=this.dependencyGraph.addressMapping.getHeight(t)}getAndClearContentChanges(){const e=this.changes;return this.changes=J3.empty(),e}forceApplyPostponedTransformations(){this.dependencyGraph.forceApplyPostponedTransformations()}doRemoveRows(e){if(this.rowEffectivelyNotInSheet(e.rowStart,e.sheet))return;const t=[];for(const[o]of this.dependencyGraph.entriesFromRowsSpan(e))t.push({address:o,cellType:this.getClipboardCell(o)});const{affectedArrays:n,contentChanges:r}=this.dependencyGraph.removeRows(e);this.columnSearch.applyChanges(r.getChanges());let i=0;return this.stats.measure(q3.TRANSFORM_ASTS,(()=>{const t=new b6(e);t.performEagerTransformations(this.dependencyGraph,this.parser),i=this.lazilyTransformingAstService.addTransformation(t)})),this.rewriteAffectedArrays(n),{version:i,removedCells:t,rowFrom:e.rowStart,rowCount:e.numberOfRows}}doRemoveColumns(e){if(this.columnEffectivelyNotInSheet(e.columnStart,e.sheet))return;const t=[];for(const[o]of this.dependencyGraph.entriesFromColumnsSpan(e))t.push({address:o,cellType:this.getClipboardCell(o)});const{affectedArrays:n,contentChanges:r}=this.dependencyGraph.removeColumns(e);this.columnSearch.applyChanges(r.getChanges()),this.columnSearch.removeColumns(e);let i=0;return this.stats.measure(q3.TRANSFORM_ASTS,(()=>{const t=new E6(e);t.performEagerTransformations(this.dependencyGraph,this.parser),i=this.lazilyTransformingAstService.addTransformation(t)})),this.rewriteAffectedArrays(n),{version:i,removedCells:t,columnFrom:e.columnStart,columnCount:e.numberOfColumns}}doAddRows(e){if(this.rowEffectivelyNotInSheet(e.rowStart,e.sheet))return;const{affectedArrays:t}=this.dependencyGraph.addRows(e);this.stats.measure(q3.TRANSFORM_ASTS,(()=>{const t=new v6(e);t.performEagerTransformations(this.dependencyGraph,this.parser),this.lazilyTransformingAstService.addTransformation(t)})),this.rewriteAffectedArrays(t)}rewriteAffectedArrays(e){for(const t of e.values()){if(t.array.size.isRef)continue;const e=t.getFormula(this.lazilyTransformingAstService),n=t.getAddress(this.lazilyTransformingAstService),r=this.parser.computeHashFromAst(e);this.setFormulaToCellFromCache(r,n)}}doAddColumns(e){if(this.columnEffectivelyNotInSheet(e.columnStart,e.sheet))return;const{affectedArrays:t,contentChanges:n}=this.dependencyGraph.addColumns(e);this.columnSearch.addColumns(e),this.columnSearch.applyChanges(n.getChanges()),this.stats.measure(q3.TRANSFORM_ASTS,(()=>{const t=new y6(e);t.performEagerTransformations(this.dependencyGraph,this.parser),this.lazilyTransformingAstService.addTransformation(t)})),this.rewriteAffectedArrays(t)}columnEffectivelyNotInSheet(e,t){return e>=this.dependencyGraph.addressMapping.getWidth(t)}adjustNamedExpressionEdges(e,t,n){if(void 0===n)return;const{vertex:r,id:i}=this.dependencyGraph.fetchCellOrCreateEmpty(e.address),o=null!=i?i:this.dependencyGraph.graph.getNodeId(r),s=this.namedExpressions.workbookNamedExpressionOrPlaceholder(t),{vertex:a,id:l}=this.dependencyGraph.fetchCellOrCreateEmpty(s.address),h=null!=l?l:this.dependencyGraph.graph.getNodeId(a);for(const u of this.dependencyGraph.graph.adjacentNodes(a))if(u instanceof j9&&u.getAddress(this.lazilyTransformingAstService).sheet===n){const t=u.getFormula(this.lazilyTransformingAstService),n=u.getAddress(this.lazilyTransformingAstService),{dependencies:r}=this.parser.fetchCachedResultForAst(t);for(const i of D3(r,n))i instanceof F3&&i.name.toLowerCase()===e.displayName.toLowerCase()&&(this.dependencyGraph.graph.removeEdge(h,u),this.dependencyGraph.graph.addEdge(o,u))}}storeNamedExpressionInCell(e,t){const n=this.cellContentParser.parse(t);if(n instanceof s6.Formula){const t=this.parser.parse(n.formula,T4(-1,0,0));if(f6(t.ast))throw new L9;const{ast:r,hasVolatileFunction:i,hasStructuralChangeFunction:o,dependencies:s}=t;this.dependencyGraph.setFormulaToCell(e,r,D3(s,e),s5.scalar(),i,o)}else n instanceof s6.Empty?this.setCellEmpty(e):this.setValueToCell({parsedValue:n.value,rawValue:t},e)}updateNamedExpressionsForMovedCells(e,t,n,r){if(e.sheet===r.sheet)return[];const i=[],o=L4.spanFrom(r,t,n);for(const s of o.addresses(this.dependencyGraph)){const t=this.addressMapping.fetchCell(s);if(t instanceof j9&&s.sheet!==e.sheet){const n=t.getFormula(this.lazilyTransformingAstService),{dependencies:r}=this.parser.fetchCachedResultForAst(n);i.push(...this.updateNamedExpressionsForTargetAddress(e.sheet,s,r))}}return i}updateNamedExpressionsForTargetAddress(e,t,n){if(e===t.sheet)return[];const r=[],i=this.addressMapping.fetchCell(t);for(const o of D3(n,t)){if(!(o instanceof F3))continue;const n=o.name,s=this.dependencyGraph.fetchNamedExpressionVertex(n,e).vertex,a=this.namedExpressions.isExpressionInScope(n,t.sheet)?this.dependencyGraph.fetchNamedExpressionVertex(n,t.sheet).vertex:this.copyOrFetchGlobalNamedExpressionVertex(n,s,r);a!==s&&(this.dependencyGraph.graph.removeEdgeIfExists(s,i),this.dependencyGraph.graph.addEdge(a,i))}return r}allocateNamedExpressionAddressSpace(){this.dependencyGraph.addressMapping.addSheet(m6.SHEET_FOR_WORKBOOK_EXPRESSIONS,new u4(0,0))}copyOrFetchGlobalNamedExpressionVertex(e,t,n){let r=this.namedExpressions.namedExpressionForScope(e);if(void 0===r)if(r=this.namedExpressions.addNamedExpression(e),n.push(r.normalizeExpressionName()),t instanceof j9){const e=this.parser.fetchCachedResultForAst(t.getFormula(this.lazilyTransformingAstService)),{ast:n,hasVolatileFunction:i,hasStructuralChangeFunction:o,dependencies:s}=e;this.dependencyGraph.setFormulaToCell(r.address,n,D3(s,r.address),s5.scalar(),i,o)}else t instanceof a4?this.setCellEmpty(r.address):t instanceof l4&&this.setValueToCell(t.getValues(),r.address);return this.dependencyGraph.fetchCellOrCreateEmpty(r.address).vertex}}function _6(e){if(e.length<=1)return e;const t=[...e].sort((([e],[t])=>e-t)),n=t.reduce(((e,[t,n])=>{const r=e[e.length-1],i=r[0]+r[1];return t<=i?r[1]+=Math.max(0,n-(i-t)):e.push([t,n]),e}),[t[0]]);let r=0;for(let i=0;i<n.length;++i)n[i][0]-=r,r+=n[i][1];return n}function L6(e){if(e.length<=1)return e;const t=[...e].sort((([e],[t])=>e-t)),n=t.reduce(((e,[t,n])=>{const r=e[e.length-1];return t===r[0]?r[1]=Math.max(r[1],n):e.push([t,n]),e}),[t[0]]);let r=0;for(let i=0;i<n.length;++i)n[i][0]+=r,r+=n[i][1];return n}function H6(e){return Number.isInteger(e)&&e>0}class k6{}class F6 extends k6{constructor(e,t){super(),this.command=e,this.rowsRemovals=t}doUndo(e){e.undoRemoveRows(this)}doRedo(e){e.redoRemoveRows(this)}}class D6 extends k6{constructor(e,t,n,r,i,o,s){super(),this.sourceLeftCorner=e,this.width=t,this.height=n,this.destinationLeftCorner=r,this.overwrittenCellsData=i,this.addedGlobalNamedExpressions=o,this.version=s}doUndo(e){e.undoMoveCells(this)}doRedo(e){e.redoMoveCells(this)}}class V6 extends k6{constructor(e){super(),this.command=e}doUndo(e){e.undoAddRows(this)}doRedo(e){e.redoAddRows(this)}}class U6 extends k6{constructor(e,t,n){super(),this.sheetId=e,this.rowMapping=t,this.oldContent=n}doUndo(e){e.undoSetRowOrder(this)}doRedo(e){e.redoSetRowOrder(this)}}class B6 extends k6{constructor(e,t,n){super(),this.sheetId=e,this.columnMapping=t,this.oldContent=n}doUndo(e){e.undoSetColumnOrder(this)}doRedo(e){e.redoSetColumnOrder(this)}}class W6 extends k6{constructor(e,t,n){super(),this.sheetId=e,this.oldSheetContent=t,this.newSheetContent=n}doUndo(e){e.undoSetSheetContent(this)}doRedo(e){e.redoSetSheetContent(this)}}class j6 extends k6{constructor(e,t,n,r,i){super(),this.sheet=e,this.startRow=t,this.numberOfRows=n,this.targetRow=r,this.version=i,this.undoStart=this.startRow<this.targetRow?this.targetRow-this.numberOfRows:this.targetRow,this.undoEnd=this.startRow>this.targetRow?this.startRow+this.numberOfRows:this.startRow}doUndo(e){e.undoMoveRows(this)}doRedo(e){e.redoMoveRows(this)}}class G6 extends k6{constructor(e,t,n,r,i){super(),this.sheet=e,this.startColumn=t,this.numberOfColumns=n,this.targetColumn=r,this.version=i,this.undoStart=this.startColumn<this.targetColumn?this.targetColumn-this.numberOfColumns:this.targetColumn,this.undoEnd=this.startColumn>this.targetColumn?this.startColumn+this.numberOfColumns:this.startColumn}doUndo(e){e.undoMoveColumns(this)}doRedo(e){e.redoMoveColumns(this)}}class z6 extends k6{constructor(e){super(),this.command=e}doUndo(e){e.undoAddColumns(this)}doRedo(e){e.redoAddColumns(this)}}class $6 extends k6{constructor(e,t){super(),this.command=e,this.columnsRemovals=t}doUndo(e){e.undoRemoveColumns(this)}doRedo(e){e.redoRemoveColumns(this)}}class Y6 extends k6{constructor(e){super(),this.sheetName=e}doUndo(e){e.undoAddSheet(this)}doRedo(e){e.redoAddSheet(this)}}class K6 extends k6{constructor(e,t,n,r,i){super(),this.sheetName=e,this.sheetId=t,this.oldSheetContent=n,this.scopedNamedExpressions=r,this.version=i}doUndo(e){e.undoRemoveSheet(this)}doRedo(e){e.redoRemoveSheet(this)}}class X6 extends k6{constructor(e,t,n){super(),this.sheetId=e,this.oldName=t,this.newName=n}doUndo(e){e.undoRenameSheet(this)}doRedo(e){e.redoRenameSheet(this)}}class q6 extends k6{constructor(e,t){super(),this.sheetId=e,this.oldSheetContent=t}doUndo(e){e.undoClearSheet(this)}doRedo(e){e.redoClearSheet(this)}}class Q6 extends k6{constructor(e){super(),this.cellContents=e}doUndo(e){e.undoSetCellContents(this)}doRedo(e){e.redoSetCellContents(this)}}class Z6 extends k6{constructor(e,t,n,r){super(),this.targetLeftCorner=e,this.oldContent=t,this.newContent=n,this.addedGlobalNamedExpressions=r}doUndo(e){e.undoPaste(this)}doRedo(e){e.redoPaste(this)}}class J6 extends k6{constructor(e,t,n,r){super(),this.name=e,this.newContent=t,this.scope=n,this.options=r}doUndo(e){e.undoAddNamedExpression(this)}doRedo(e){e.redoAddNamedExpression(this)}}class e8 extends k6{constructor(e,t,n){super(),this.namedExpression=e,this.content=t,this.scope=n}doUndo(e){e.undoRemoveNamedExpression(this)}doRedo(e){e.redoRemoveNamedExpression(this)}}class t8 extends k6{constructor(e,t,n,r,i){super(),this.namedExpression=e,this.newContent=t,this.oldContent=n,this.scope=r,this.options=i}doUndo(e){e.undoChangeNamedExpression(this)}doRedo(e){e.redoChangeNamedExpression(this)}}class n8 extends k6{constructor(){super(...arguments),this.operations=[]}add(e){this.operations.push(e)}*reversedOperations(){for(let e=this.operations.length-1;e>=0;e--)yield this.operations[e]}doUndo(e){e.undoBatch(this)}doRedo(e){e.redoBatch(this)}}class r8{constructor(e,t){this.operations=t,this.oldData=new Map,this.undoStack=[],this.redoStack=[],this.undoLimit=e.undoLimit}saveOperation(e){void 0!==this.batchUndoEntry?this.batchUndoEntry.add(e):this.addUndoEntry(e)}beginBatchMode(){this.batchUndoEntry=new n8}commitBatchMode(){if(void 0===this.batchUndoEntry)throw Error("Batch mode wasn't started");this.addUndoEntry(this.batchUndoEntry),this.batchUndoEntry=void 0}storeDataForVersion(e,t,n){this.oldData.has(e)||this.oldData.set(e,[]);this.oldData.get(e).push([t,n])}clearRedoStack(){this.redoStack=[]}clearUndoStack(){this.undoStack=[]}isUndoStackEmpty(){return 0===this.undoStack.length}isRedoStackEmpty(){return 0===this.redoStack.length}undo(){const e=this.undoStack.pop();if(!e)throw Error("Attempted to undo without operation on stack");this.undoEntry(e),this.redoStack.push(e)}undoBatch(e){for(const t of e.reversedOperations())this.undoEntry(t)}undoRemoveRows(e){this.operations.forceApplyPostponedTransformations();const{command:{sheet:t},rowsRemovals:n}=e;for(let r=n.length-1;r>=0;--r){const e=n[r];this.operations.addRows(new I6(t,[[e.rowFrom,e.rowCount]]));for(const{address:t,cellType:n}of e.removedCells)this.operations.restoreCell(t,n);this.restoreOldDataFromVersion(e.version-1)}}undoRemoveColumns(e){this.operations.forceApplyPostponedTransformations();const{command:{sheet:t},columnsRemovals:n}=e;for(let r=n.length-1;r>=0;--r){const e=n[r];this.operations.addColumns(new O6(t,[[e.columnFrom,e.columnCount]]));for(const{address:t,cellType:n}of e.removedCells)this.operations.restoreCell(t,n);this.restoreOldDataFromVersion(e.version-1)}}undoAddRows(e){const t=e.command.rowsSpans();for(let n=t.length-1;n>=0;--n){const r=t[n];this.operations.removeRows(new M6(e.command.sheet,[[r.rowStart,r.numberOfRows]]))}}undoAddColumns(e){const t=e.command.columnsSpans();for(let n=t.length-1;n>=0;--n){const r=t[n];this.operations.removeColumns(new x6(e.command.sheet,[[r.columnStart,r.numberOfColumns]]))}}undoSetCellContents(e){for(const t of e.cellContents){const e=t.address,[n,r]=t.oldContent;x4(e,n)||this.operations.setCellEmpty(e),this.operations.restoreCell(n,r)}}undoPaste(e){this.restoreOperationOldContent(e.oldContent);for(const t of e.addedGlobalNamedExpressions)this.operations.removeNamedExpression(t)}undoMoveRows(e){const{sheet:t}=e;this.operations.moveRows(t,e.undoStart,e.numberOfRows,e.undoEnd),this.restoreOldDataFromVersion(e.version-1)}undoMoveColumns(e){const{sheet:t}=e;this.operations.moveColumns(t,e.undoStart,e.numberOfColumns,e.undoEnd),this.restoreOldDataFromVersion(e.version-1)}undoMoveCells(e){this.operations.forceApplyPostponedTransformations(),this.operations.moveCells(e.destinationLeftCorner,e.width,e.height,e.sourceLeftCorner),this.restoreOperationOldContent(e.overwrittenCellsData),this.restoreOldDataFromVersion(e.version-1);for(const t of e.addedGlobalNamedExpressions)this.operations.removeNamedExpression(t)}undoAddSheet(e){const{sheetName:t}=e;this.operations.removeSheetByName(t)}undoRemoveSheet(e){this.operations.forceApplyPostponedTransformations();const{oldSheetContent:t,sheetId:n}=e;this.operations.addSheet(e.sheetName);for(let r=0;r<t.length;r++){const e=t[r];for(let t=0;t<e.length;t++){const i=e[t],o=T4(n,t,r);this.operations.restoreCell(o,i)}}for(const[r,i]of e.scopedNamedExpressions)this.operations.restoreNamedExpression(r,i,n);this.restoreOldDataFromVersion(e.version-1)}undoRenameSheet(e){this.operations.renameSheet(e.sheetId,e.oldName)}undoClearSheet(e){const{oldSheetContent:t,sheetId:n}=e;for(let r=0;r<t.length;r++){const e=t[r];for(let t=0;t<e.length;t++){const i=e[t],o=T4(n,t,r);this.operations.restoreCell(o,i)}}}undoSetSheetContent(e){const{oldSheetContent:t,sheetId:n}=e;this.operations.clearSheet(n);for(let r=0;r<t.length;r++){const e=t[r];for(let t=0;t<e.length;t++){const i=e[t],o=T4(n,t,r);this.operations.restoreCell(o,i)}}}undoAddNamedExpression(e){this.operations.removeNamedExpression(e.name,e.scope)}undoRemoveNamedExpression(e){this.operations.restoreNamedExpression(e.namedExpression,e.content,e.scope)}undoChangeNamedExpression(e){this.operations.restoreNamedExpression(e.namedExpression,e.oldContent,e.scope)}undoSetRowOrder(e){this.restoreOperationOldContent(e.oldContent)}undoSetColumnOrder(e){this.restoreOperationOldContent(e.oldContent)}redo(){const e=this.redoStack.pop();if(!e)throw Error("Attempted to redo without operation on stack");this.redoEntry(e),this.undoStack.push(e)}redoBatch(e){for(const t of e.operations)this.redoEntry(t)}redoRemoveRows(e){this.operations.removeRows(e.command)}redoMoveCells(e){this.operations.moveCells(e.sourceLeftCorner,e.width,e.height,e.destinationLeftCorner)}redoRemoveColumns(e){this.operations.removeColumns(e.command)}redoPaste(e){const{targetLeftCorner:t,newContent:n}=e,r=n.length,i=n[0].length;for(let o=0;o<r;++o)for(let e=0;e<i;++e){const r=T4(t.sheet,t.col+e,t.row+o);this.operations.restoreCell(r,n[o][e])}}redoSetCellContents(e){for(const t of e.cellContents)this.operations.setCellContent(t.address,t.newContent)}redoAddRows(e){this.operations.addRows(e.command)}redoAddColumns(e){this.operations.addColumns(e.command)}redoRemoveSheet(e){this.operations.removeSheetByName(e.sheetName)}redoAddSheet(e){this.operations.addSheet(e.sheetName)}redoRenameSheet(e){this.operations.renameSheet(e.sheetId,e.newName)}redoMoveRows(e){this.operations.moveRows(e.sheet,e.startRow,e.numberOfRows,e.targetRow)}redoMoveColumns(e){this.operations.moveColumns(e.sheet,e.startColumn,e.numberOfColumns,e.targetColumn)}redoClearSheet(e){this.operations.clearSheet(e.sheetId)}redoSetSheetContent(e){const{sheetId:t,newSheetContent:n}=e;this.operations.setSheetContent(t,n)}redoAddNamedExpression(e){this.operations.addNamedExpression(e.name,e.newContent,e.scope,e.options)}redoRemoveNamedExpression(e){this.operations.removeNamedExpression(e.namedExpression.displayName,e.scope)}redoChangeNamedExpression(e){this.operations.changeNamedExpressionExpression(e.namedExpression.displayName,e.newContent,e.scope,e.options)}redoSetRowOrder(e){this.operations.setRowOrder(e.sheetId,e.rowMapping)}redoSetColumnOrder(e){this.operations.setColumnOrder(e.sheetId,e.columnMapping)}addUndoEntry(e){this.undoStack.push(e),this.undoStack.splice(0,Math.max(0,this.undoStack.length-this.undoLimit))}undoEntry(e){e.doUndo(this)}restoreOperationOldContent(e){for(const[t,n]of e)this.operations.restoreCell(t,n)}redoEntry(e){e.doRedo(this)}restoreOldDataFromVersion(e){const t=this.oldData.get(e)||[];for(const n of t){const[e,t]=n;this.operations.setFormulaToCellFromCache(t,e)}}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class i8{constructor(e,t,n,r,i,o,s,a,l,h){this.operations=t,this.undoRedo=n,this.clipboardOperations=r,this.dependencyGraph=i,this.columnSearch=o,this.parser=s,this.cellContentParser=a,this.lazilyTransformingAstService=l,this.namedExpressions=h,this.maxRows=e.maxRows,this.maxColumns=e.maxColumns}get sheetMapping(){return this.dependencyGraph.sheetMapping}addRows(e,...t){const n=new I6(e,t);this.ensureItIsPossibleToAddRows(e,...t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.operations.addRows(n),this.undoRedo.saveOperation(new V6(n))}removeRows(e,...t){const n=new M6(e,t);this.ensureItIsPossibleToRemoveRows(e,...t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const r=this.operations.removeRows(n);this.undoRedo.saveOperation(new F6(n,r))}addColumns(e,...t){const n=new O6(e,t);this.ensureItIsPossibleToAddColumns(e,...t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.operations.addColumns(n),this.undoRedo.saveOperation(new z6(n))}removeColumns(e,...t){const n=new x6(e,t);this.ensureItIsPossibleToRemoveColumns(e,...t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const r=this.operations.removeColumns(n);this.undoRedo.saveOperation(new $6(n,r))}moveCells(e,t,n,r){this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const{version:i,overwrittenCellsData:o,addedGlobalNamedExpressions:s}=this.operations.moveCells(e,t,n,r);this.undoRedo.saveOperation(new D6(e,t,n,r,o,s,i))}moveRows(e,t,n,r){this.ensureItIsPossibleToMoveRows(e,t,n,r),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const i=this.operations.moveRows(e,t,n,r);this.undoRedo.saveOperation(new j6(e,t,n,r,i))}moveColumns(e,t,n,r){this.ensureItIsPossibleToMoveColumns(e,t,n,r),this.undoRedo.clearRedoStack();const i=this.operations.moveColumns(e,t,n,r);this.undoRedo.saveOperation(new G6(e,t,n,r,i))}cut(e,t,n){this.clipboardOperations.cut(e,t,n)}ensureItIsPossibleToCopy(e,t,n){if(!o8(t))throw new u9("width to be positive integer.");if(!o8(n))throw new u9("height to be positive integer.")}copy(e,t,n){this.ensureItIsPossibleToCopy(e,t,n),this.clipboardOperations.copy(e,t,n)}paste(e){const t=this.clipboardOperations.clipboard;if(void 0===t)throw new w9;if(this.clipboardOperations.isCutClipboard())this.moveCells(t.sourceLeftCorner,t.width,t.height,e);else if(this.clipboardOperations.isCopyClipboard()){this.clipboardOperations.ensureItIsPossibleToCopyPaste(e);const n=L4.spanFrom(e,t.width,t.height),r=this.operations.getRangeClipboardCells(n);this.undoRedo.clearRedoStack();const i=this.operations.restoreClipboardCells(t.sourceLeftCorner.sheet,t.getContent(e));this.undoRedo.saveOperation(new Z6(e,r,t.content,i))}}beginUndoRedoBatchMode(){this.undoRedo.beginBatchMode()}commitUndoRedoBatchMode(){this.undoRedo.commitBatchMode()}isClipboardEmpty(){return void 0===this.clipboardOperations.clipboard}clearClipboard(){this.clipboardOperations.clear()}addSheet(e){void 0!==e&&this.ensureItIsPossibleToAddSheet(e),this.undoRedo.clearRedoStack();const t=this.operations.addSheet(e);return this.undoRedo.saveOperation(new Y6(t)),t}removeSheet(e){this.ensureScopeIdIsValid(e),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const t=this.sheetMapping.fetchDisplayName(e),n=this.operations.getSheetClipboardCells(e),{version:r,scopedNamedExpressions:i}=this.operations.removeSheet(e);this.undoRedo.saveOperation(new K6(t,e,n,i,r))}renameSheet(e,t){this.ensureItIsPossibleToRenameSheet(e,t);const n=this.operations.renameSheet(e,t);return void 0!==n&&(this.undoRedo.clearRedoStack(),this.undoRedo.saveOperation(new X6(e,n,t))),n}clearSheet(e){this.ensureScopeIdIsValid(e),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const t=this.operations.getSheetClipboardCells(e);this.operations.clearSheet(e),this.undoRedo.saveOperation(new q6(e,t))}setCellContents(e,t){if(t instanceof Array){for(let r=0;r<t.length;r++)if(!(t[r]instanceof Array))throw new u9("an array of arrays or a raw cell value.")}else t=[[t]];this.ensureItIsPossibleToChangeCellContents(e,t),this.undoRedo.clearRedoStack();const n=[];for(let r=0;r<t.length;r++)for(let i=0;i<t[r].length;i++){const o={sheet:e.sheet,row:e.row+r,col:e.col+i},s=t[r][i];this.clipboardOperations.abortCut();const a=this.operations.setCellContent(o,s);n.push({address:o,newContent:s,oldContent:a})}this.undoRedo.saveOperation(new Q6(n))}setSheetContent(e,t){this.ensureScopeIdIsValid(e),this.ensureItIsPossibleToChangeSheetContents(e,t),N6(t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const n=this.operations.getSheetClipboardCells(e);this.operations.setSheetContent(e,t),this.undoRedo.saveOperation(new W6(e,n,t))}setRowOrder(e,t){this.validateSwapRowIndexes(e,t),this.testRowOrderForArrays(e,t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const n=this.operations.setRowOrder(e,t);this.undoRedo.saveOperation(new U6(e,t,n))}validateSwapRowIndexes(e,t){if(!this.sheetMapping.hasSheetWithId(e))throw new i9(e);this.validateRowOrColumnMapping(e,t,"row")}testColumnOrderForArrays(e,t){for(const[n,r]of t)if(n!==r){const t=L4.spanFrom({sheet:e,col:n,row:0},1,1/0);if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(t))throw new P9}}setColumnOrder(e,t){this.validateSwapColumnIndexes(e,t),this.testColumnOrderForArrays(e,t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const n=this.operations.setColumnOrder(e,t);this.undoRedo.saveOperation(new B6(e,t,n))}validateSwapColumnIndexes(e,t){if(!this.sheetMapping.hasSheetWithId(e))throw new i9(e);this.validateRowOrColumnMapping(e,t,"column")}testRowOrderForArrays(e,t){for(const[n,r]of t)if(n!==r){const t=L4.spanFrom({sheet:e,col:0,row:n},1/0,1);if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(t))throw new P9}}mappingFromOrder(e,t,n){if(!this.sheetMapping.hasSheetWithId(e))throw new i9(e);const r="row"===n?this.dependencyGraph.getSheetHeight(e):this.dependencyGraph.getSheetWidth(e);if(t.length!==r)throw new u9(`number of ${n}s provided to be sheet ${"row"===n?"height":"width"}.`);const i=[];for(let o=0;o<r;o++)t[o]!==o&&i.push([o,t[o]]);return i}undo(){if(this.undoRedo.isUndoStackEmpty())throw new m9;this.clipboardOperations.abortCut(),this.undoRedo.undo()}redo(){if(this.undoRedo.isRedoStackEmpty())throw new f9;this.clipboardOperations.abortCut(),this.undoRedo.redo()}addNamedExpression(e,t,n,r){this.ensureItIsPossibleToAddNamedExpression(e,t,n),this.operations.addNamedExpression(e,t,n,r),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.undoRedo.saveOperation(new J6(e,t,n,r))}changeNamedExpressionExpression(e,t,n,r){this.ensureItIsPossibleToChangeNamedExpression(e,n,t);const[i,o]=this.operations.changeNamedExpressionExpression(e,n,t,r);this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.undoRedo.saveOperation(new t8(i,n,o,t,r))}removeNamedExpression(e,t){this.ensureScopeIdIsValid(t);const[n,r]=this.operations.removeNamedExpression(e,t);return this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.undoRedo.saveOperation(new e8(n,r,t)),n}ensureItIsPossibleToAddNamedExpression(e,t,n){this.ensureScopeIdIsValid(n),this.ensureNamedExpressionNameIsValid(e,n),this.ensureNamedExpressionIsValid(t)}ensureItIsPossibleToChangeNamedExpression(e,t,n){if(this.ensureScopeIdIsValid(n),void 0===this.namedExpressions.namedExpressionForScope(e,n))throw new g9(e);this.ensureNamedExpressionIsValid(t)}isItPossibleToRemoveNamedExpression(e,t){if(this.ensureScopeIdIsValid(t),void 0===this.namedExpressions.namedExpressionForScope(e,t))throw new g9(e)}ensureItIsPossibleToAddRows(e,...t){if(!this.sheetMapping.hasSheetWithId(e))throw new i9(e);const n=this.dependencyGraph.getSheetHeight(e),r=t.map((e=>e[1])).reduce(((e,t)=>e+t),0);if(n+r>this.maxRows)throw new a9;for(const[i,o]of t)if(!s8(i)||!o8(o))throw new u9("row number to be nonnegative and number of rows to add to be positive.")}ensureItIsPossibleToRemoveRows(e,...t){for(const[n,r]of t){const t=n+r-1;if(!s8(n)||!s8(t))throw new u9("starting and ending row to be nonnegative.");if(t<n)throw new u9("starting row to be smaller than the ending row.");if(!this.sheetMapping.hasSheetWithId(e))throw new i9(e)}}ensureItIsPossibleToAddColumns(e,...t){if(!this.sheetMapping.hasSheetWithId(e))throw new i9(e);const n=this.dependencyGraph.getSheetWidth(e),r=t.map((e=>e[1])).reduce(((e,t)=>e+t),0);if(n+r>this.maxColumns)throw new a9;for(const[i,o]of t)if(!s8(i)||!o8(o))throw new u9("column number to be nonnegative and number of columns to add to be positive.")}ensureItIsPossibleToRemoveColumns(e,...t){for(const[n,r]of t){const t=n+r-1;if(!s8(n)||!s8(t))throw new u9("starting and ending column to be nonnegative.");if(t<n)throw new u9("starting column to be smaller than the ending column.");if(!this.sheetMapping.hasSheetWithId(e))throw new i9(e)}}ensureItIsPossibleToMoveRows(e,t,n,r){this.ensureItIsPossibleToAddRows(e,[r,n]);const i=T4(e,0,t),o=T4(e,0,r);if(!this.sheetMapping.hasSheetWithId(e)||N4(i)||N4(o)||!o8(n)||r<=t+n&&r>=t)throw new u9("a valid range of rows to move.");const s=this.dependencyGraph.getSheetWidth(e),a=L4.spanFrom(i,s,n);if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(a))throw new P9;if(r>0&&this.dependencyGraph.arrayMapping.isFormulaArrayInAllRows(e9.fromNumberOfRows(e,r-1,2)))throw new _9}ensureItIsPossibleToMoveColumns(e,t,n,r){this.ensureItIsPossibleToAddColumns(e,[r,n]);const i=T4(e,t,0),o=T4(e,r,0);if(!this.sheetMapping.hasSheetWithId(e)||N4(i)||N4(o)||!o8(n)||r<=t+n&&r>=t)throw new u9("a valid range of columns to move.");const s=this.dependencyGraph.getSheetHeight(e),a=L4.spanFrom(i,n,s);if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(a))throw new P9;if(r>0&&this.dependencyGraph.arrayMapping.isFormulaArrayInAllColumns(t9.fromNumberOfColumns(e,r-1,2)))throw new _9}ensureItIsPossibleToAddSheet(e){if(this.sheetMapping.hasSheetWithName(e))throw new s9(e)}ensureItIsPossibleToRenameSheet(e,t){if(!this.sheetMapping.hasSheetWithId(e))throw new i9(e);const n=this.sheetMapping.get(t);if(void 0!==n&&n!==e)throw new s9(t)}ensureItIsPossibleToChangeContent(e){if(N4(e))throw new h9(e);if(!this.sheetMapping.hasSheetWithId(e.sheet))throw new i9(e.sheet)}ensureItIsPossibleToChangeCellContents(e,t){const n=A6(t),r=L4.spanFrom(e,n.width,n.height);this.ensureRangeInSizeLimits(r);for(const i of r.addresses(this.dependencyGraph))this.ensureItIsPossibleToChangeContent(i)}ensureItIsPossibleToChangeSheetContents(e,t){const n=A6(t),r=L4.spanFrom(T4(e,0,0),n.width,n.height);this.ensureRangeInSizeLimits(r)}ensureRangeInSizeLimits(e){if(e.exceedsSheetSizeLimits(this.maxColumns,this.maxRows))throw new a9}isThereSomethingToUndo(){return!this.undoRedo.isUndoStackEmpty()}isThereSomethingToRedo(){return!this.undoRedo.isRedoStackEmpty()}getAndClearContentChanges(){return this.operations.getAndClearContentChanges()}ensureScopeIdIsValid(e){if(void 0!==e&&!this.sheetMapping.hasSheetWithId(e))throw new i9(e)}validateRowOrColumnMapping(e,t,n){const r="row"===n?this.dependencyGraph.getSheetHeight(e):this.dependencyGraph.getSheetWidth(e),i=t.map((([e,t])=>e)).sort(((e,t)=>e-t)),o=t.map((([e,t])=>t)).sort(((e,t)=>e-t));for(let s=0;s<i.length;s++){if(!s8(i[s])||i[s]>=r)throw new u9(`${n} numbers to be nonnegative integers and less than sheet ${"row"===n?"height":"width"}.`);if(i[s]===i[s+1])throw new u9(`source ${n} numbers to be unique.`);if(i[s]!==o[s])throw new u9(`target ${n} numbers to be permutation of source ${n} numbers.`)}}ensureNamedExpressionNameIsValid(e,t){if(!this.namedExpressions.isNameValid(e))throw new p9(e);if(!this.namedExpressions.isNameAvailable(e,t))throw new d9(e)}ensureNamedExpressionIsValid(e){const t=this.cellContentParser.parse(e);if(t instanceof s6.Formula){const e=this.parser.parse(t.formula,T4(-1,0,0));if(f6(e.ast))throw new L9}}}function o8(e){return Number.isInteger(e)&&e>0}function s8(e){return Number.isInteger(e)&&e>=0}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class a8{constructor(e,t,n,r,i,o){this.config=e,this.stats=t,this.interpreter=n,this.lazilyTransformingAstService=r,this.dependencyGraph=i,this.columnSearch=o}run(){this.stats.start(q3.TOP_SORT);const{sorted:e,cycled:t}=this.dependencyGraph.topSortWithScc();this.stats.end(q3.TOP_SORT),this.stats.measure(q3.EVALUATION,(()=>{this.recomputeFormulas(t,e)}))}partialRun(e){const t=J3.empty();return this.stats.measure(q3.EVALUATION,(()=>{this.dependencyGraph.graph.getTopSortedWithSccSubgraphFrom(e,(e=>{if(e instanceof B9){const n=e.isComputed()?e.getCellValue():void 0,r=this.recomputeFormulaVertexValue(e);if(r!==n){const i=e.getAddress(this.lazilyTransformingAstService);return t.addChange(r,i),this.columnSearch.change(U3(n),U3(r),i),!0}return!1}return!(e instanceof G9)||(e.clearCache(),!0)}),(e=>{if(e instanceof G9)e.clearCache();else if(e instanceof B9){const n=e.getAddress(this.lazilyTransformingAstService);this.columnSearch.remove(U3(e.valueOrUndef()),n);const r=new C4(t4.CYCLE,void 0,e);e.setCellValue(r),t.addChange(r,n)}}))})),t}runAndForget(e,t,n){const r=[];for(const o of D3(n,t))if(o instanceof L4){const e=o;if(void 0===this.dependencyGraph.getRange(e.start,e.end)){const t=new G9(e);this.dependencyGraph.rangeMapping.setRange(t),r.push(t)}}const i=this.evaluateAstToCellValue(e,new F4(t,this.config.useArrayArithmetic));return r.forEach((e=>{this.dependencyGraph.rangeMapping.removeRange(e)})),i}recomputeFormulas(e,t){e.forEach((e=>{e instanceof B9&&e.setCellValue(new C4(t4.CYCLE,void 0,e))})),t.forEach((e=>{if(e instanceof B9){const t=this.recomputeFormulaVertexValue(e),n=e.getAddress(this.lazilyTransformingAstService);this.columnSearch.add(U3(t),n)}else e instanceof G9&&e.clearCache()}))}recomputeFormulaVertexValue(e){const t=e.getAddress(this.lazilyTransformingAstService);if(e instanceof W9&&(e.array.size.isRef||!this.dependencyGraph.isThereSpaceForArray(e)))return e.setNoSpace();{const n=e.getFormula(this.lazilyTransformingAstService),r=this.evaluateAstToCellValue(n,new F4(t,this.config.useArrayArithmetic,e));return e.setCellValue(r)}}evaluateAstToCellValue(e,t){const n=this.interpreter.evaluateAst(e,t);return n instanceof Z3?n:n===V3&&this.config.evaluateNullToZero?0:n}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class l8{constructor(e,t){this.address=e,this.newValue=t}get col(){return this.address.col}get row(){return this.address.row}get sheet(){return this.address.sheet}get value(){return this.newValue}}class h8{constructor(e,t){this.name=e,this.newValue=t}}class u8{constructor(e,t,n,r){this.config=e,this.namedExpressions=t,this.sheetIndexMapping=n,this.lazilyTransformingService=r}exportChange(e){const t=e.value,n=e.address;if(n.sheet===m6.SHEET_FOR_WORKBOOK_EXPRESSIONS){const e=this.namedExpressions.namedExpressionInAddress(n.row);if(!e)throw new Error("Missing named expression");return new h8(e.displayName,this.exportScalarOrRange(t))}if(t instanceof Z3){const e=[];for(const[r,i]of t.entriesFromTopLeftCorner(n))e.push(new l8(i,this.exportValue(r)));return e}return new l8(n,this.exportValue(t))}exportValue(e){return e instanceof Z3?this.detailedError(new C4(t4.VALUE,K2.ScalarExpected)):this.config.smartRounding&&K3(e)?this.cellValueRounding(U3(e)):e instanceof C4?this.detailedError(e):e===V3?null:U3(e)}exportScalarOrRange(e){return e instanceof Z3?e.rawData().map((e=>e.map((e=>this.exportValue(e))))):this.exportValue(e)}detailedError(e){var t,n;let r;const i=null===(t=e.root)||void 0===t?void 0:t.getAddress(this.lazilyTransformingService);return void 0!==i&&(r=i.sheet===m6.SHEET_FOR_WORKBOOK_EXPRESSIONS?null===(n=this.namedExpressions.namedExpressionInAddress(i.row))||void 0===n?void 0:n.displayName:dZ(this.sheetIndexMapping,i,-1)),new l5(e,this.config.translationPackage.getErrorTranslation(e.type),r)}cellValueRounding(e){if(0===e)return e;const t=Math.floor(Math.log10(Math.abs(e))),n=Math.pow(10,this.config.precisionRounding-t);return e<0?-Math.round(-e*n)/n:Math.round(e*n)/n}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class c8{constructor(e,t,n,r,i,o){this.dependencyGraph=e,this.columnSearch=t,this.parser=n,this.cellContentParser=r,this.stats=i,this.arraySizePredictor=o,this.buildStrategy=new d8(e,t,n,i,r,o)}buildGraph(e,t){const n=t.measure(q3.COLLECT_DEPENDENCIES,(()=>this.buildStrategy.run(e)));this.dependencyGraph.getAndClearContentChanges(),t.measure(q3.PROCESS_DEPENDENCIES,(()=>this.processDependencies(n)))}processDependencies(e){e.forEach(((e,t)=>{this.dependencyGraph.processCellDependencies(e,t)}))}}class d8{constructor(e,t,n,r,i,o){this.dependencyGraph=e,this.columnIndex=t,this.parser=n,this.stats=r,this.cellContentParser=i,this.arraySizePredictor=o}run(e){const t=new Map;for(const n in e){const r=this.dependencyGraph.getSheetId(n),i=e[n];for(let e=0;e<i.length;++e){const n=i[e];for(let i=0;i<n.length;++i){const o=n[i],s=T4(r,i,e),a=this.cellContentParser.parse(o);if(a instanceof s6.Formula){const e=this.stats.measure(q3.PARSER,(()=>this.parser.parse(a.formula,s)));if(e.errors.length>0){this.shrinkArrayIfNeeded(s);const t=new h4(e.errors,a.formula);this.dependencyGraph.addVertex(s,t)}else{this.shrinkArrayIfNeeded(s);const n=this.arraySizePredictor.checkArraySize(e.ast,s);if(n.isScalar()){const n=new j9(e.ast,s,0);t.set(n,D3(e.dependencies,s)),this.dependencyGraph.addVertex(s,n),e.hasVolatileFunction&&this.dependencyGraph.markAsVolatile(n),e.hasStructuralChangeFunction&&this.dependencyGraph.markAsDependentOnStructureChange(n)}else{const r=new W9(e.ast,s,new s5(n.width,n.height));t.set(r,D3(e.dependencies,s)),this.dependencyGraph.addArrayVertex(s,r)}}}else if(a instanceof s6.Empty);else{this.shrinkArrayIfNeeded(s);const e=new l4(a.value,o);this.columnIndex.add(U3(a.value),s),this.dependencyGraph.addVertex(s,e)}}}}return t}shrinkArrayIfNeeded(e){const t=this.dependencyGraph.getCell(e);t instanceof W9&&this.dependencyGraph.shrinkArrayToCorner(t)}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */const p8=new Map([["gpl-v3",1],["missing",2],["invalid",3],["expired",4]]);class g8 extends o5{version(e,t){return this.runFunction(e.args,t,this.metadata("VERSION"),(()=>{const{licenseKeyValidityState:e,licenseKey:t}=this.config;let n;return p8.has(t)?n=p8.get(t):p8.has(e)?n=p8.get(e):"valid"===e&&(n=t.slice(-5)),`HyperFormula v${j8.version}, ${n}`}))}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
function m8(e,t){var n;let r=t.implementedFunctions[e];const i=null===(n=t.aliases)||void 0===n?void 0:n[e];if(void 0!==i){if(void 0!==r)throw new H9(e,t.name);r=t.implementedFunctions[i]}if(void 0===r)throw O9.functionNotDeclaredInPlugin(e,t.name);return r}g8.implementedFunctions={VERSION:{method:"version",parameters:[]}};class f8{constructor(e){if(this.config=e,this.functions=new Map,this.arraySizeFunctions=new Map,this.volatileFunctions=new Set,this.arrayFunctions=new Set,this.structuralChangeFunctions=new Set,this.functionsWhichDoesNotNeedArgumentsToBeComputed=new Set,this.functionsMetadata=new Map,this.doesFunctionNeedArgumentToBeComputed=e=>this.functionsWhichDoesNotNeedArgumentsToBeComputed.has(e),this.isFunctionVolatile=e=>this.volatileFunctions.has(e),this.isArrayFunction=e=>this.arrayFunctions.has(e),this.isFunctionDependentOnSheetStructureChange=e=>this.structuralChangeFunctions.has(e),e.functionPlugins.length>0){this.instancePlugins=new Map;for(const t of e.functionPlugins)f8.loadPluginFunctions(t,this.instancePlugins)}else this.instancePlugins=new Map(f8.plugins);for(const[t,n]of f8.protectedFunctions())f8.loadFunctionUnprotected(n,t,this.instancePlugins);for(const[t,n]of this.instancePlugins.entries())this.categorizeFunction(t,m8(t,n))}static registerFunctionPlugin(e,t){this.loadPluginFunctions(e,this.plugins),void 0!==t&&this.loadTranslations(t)}static registerFunction(e,t,n){this.loadPluginFunction(t,e,this.plugins),void 0!==n&&this.loadTranslations(n)}static unregisterFunction(e){if(this.functionIsProtected(e))throw x9.cannotUnregisterFunctionWithId(e);this.plugins.delete(e)}static unregisterFunctionPlugin(e){for(const t of this.protectedPlugins())if(t===e)throw x9.cannotUnregisterProtectedPlugin();for(const[t,n]of this.plugins.entries())n===e&&this.plugins.delete(t)}static unregisterAll(){this.plugins.clear()}static getRegisteredFunctionIds(){return[...Array.from(this.plugins.keys()),...Array.from(this._protectedPlugins.keys())]}static getPlugins(){return Array.from(new Set(this.plugins.values()).values())}static getFunctionPlugin(e){return this.functionIsProtected(e)?void 0:this.plugins.get(e)}static functionIsProtected(e){return this._protectedPlugins.has(e)}static loadTranslations(e){const t=new Set(j8.getRegisteredLanguagesCodes());Object.keys(e).forEach((n=>{t.has(n)&&j8.getLanguage(n).extendFunctions(e[n])}))}static loadPluginFunctions(e,t){Object.keys(e.implementedFunctions).forEach((n=>{this.loadPluginFunction(e,n,t)})),void 0!==e.aliases&&Object.keys(e.aliases).forEach((n=>{this.loadPluginFunction(e,n,t)}))}static loadPluginFunction(e,t,n){if(this.functionIsProtected(t))throw x9.cannotRegisterFunctionWithId(t);this.loadFunctionUnprotected(e,t,n)}static loadFunctionUnprotected(e,t,n){const r=m8(t,e).method;if(!Object.prototype.hasOwnProperty.call(e.prototype,r))throw O9.functionMethodNotFound(r,e.name);n.set(t,e)}static*protectedFunctions(){for(const[e,t]of this._protectedPlugins)void 0!==t&&(yield[e,t])}static*protectedPlugins(){for(const[,e]of this._protectedPlugins)void 0!==e&&(yield e)}initializePlugins(e){const t=[];for(const[n,r]of this.instancePlugins.entries()){let i=t.find((e=>e instanceof r));void 0===i&&(i=new r(e),t.push(i));const o=m8(n,r),s=o.method;this.functions.set(n,[s,i]);const a=o.arraySizeMethod;void 0!==a&&this.arraySizeFunctions.set(n,[a,i])}}getFunctionPlugin(e){if(!f8.functionIsProtected(e))return this.instancePlugins.get(e)}getFunction(e){const t=this.functions.get(e);if(void 0!==t&&this.config.translationPackage.isFunctionTranslated(e)){const[e,n]=t;return(t,r)=>n[e](t,r)}}getArraySizeFunction(e){const t=this.arraySizeFunctions.get(e);if(void 0!==t&&this.config.translationPackage.isFunctionTranslated(e)){const[e,n]=t;return(t,r)=>n[e](t,r)}}getMetadata(e){return this.functionsMetadata.get(e)}getPlugins(){const e=new Set;for(const[t,n]of this.instancePlugins)f8.functionIsProtected(t)||e.add(n);return Array.from(e)}getRegisteredFunctionIds(){return Array.from(this.functions.keys())}categorizeFunction(e,t){t.isVolatile&&this.volatileFunctions.add(e),t.arrayFunction&&this.arrayFunctions.add(e),t.doesNotNeedArgumentsToBeComputed&&this.functionsWhichDoesNotNeedArgumentsToBeComputed.add(e),t.isDependentOnSheetStructureChange&&this.structuralChangeFunctions.add(e),this.functionsMetadata.set(e,t)}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
var w8;f8.plugins=new Map,f8._protectedPlugins=new Map([["VERSION",g8],["OFFSET",void 0]]),function(e){e.GREATER_THAN="GREATER_THAN",e.GREATER_THAN_OR_EQUAL="GREATER_THAN_OR_EQUAL",e.LESS_THAN="LESS_THAN",e.LESS_THAN_OR_EQUAL="LESS_THAN_OR_EQUAL",e.NOT_EQUAL="NOT_EQUAL",e.EQUAL="EQUAL"}(w8||(w8={}));const y8=(e,t)=>({operator:e,value:t});class v8{constructor(e){var t,n,r,i;this.trueString=null!==(n=null===(t=e.translationPackage.getMaybeFunctionTranslation("TRUE"))||void 0===t?void 0:t.toLowerCase())&&void 0!==n?n:"true",this.falseString=null!==(i=null===(r=e.translationPackage.getMaybeFunctionTranslation("FALSE"))||void 0===r?void 0:r.toLowerCase())&&void 0!==i?i:"false"}fromCellValue(e,t){if("string"!=typeof e&&"boolean"!=typeof e&&"number"!=typeof e)return;const n=this.parseCriterion(e,t);return void 0!==n?{raw:e,lambda:S8(n,t)}:void 0}parseCriterion(e,t){if("number"==typeof e||"boolean"==typeof e)return y8(w8.EQUAL,e);if("string"==typeof e){const n=C8.exec(e);let r,i;n?(i=function(e){switch(e){case">":return w8.GREATER_THAN;case">=":return w8.GREATER_THAN_OR_EQUAL;case"<":return w8.LESS_THAN;case"<=":return w8.LESS_THAN_OR_EQUAL;case"<>":return w8.NOT_EQUAL;case"=":return w8.EQUAL;default:return}}(n[1]),r=n[2]):(i=w8.EQUAL,r=e);const o=t.coerceToMaybeNumber(r),s=r.toLowerCase()===this.trueString||r.toLowerCase()!==this.falseString&&void 0;if(void 0===i)return;if(""===r)return y8(i,null);if(void 0!==o)return y8(i,U3(o));if(i===w8.EQUAL||i===w8.NOT_EQUAL)return y8(i,null!=s?s:r)}}}const C8=/([<>=]+)(.*)/;const S8=(e,t)=>{switch(e.operator){case w8.GREATER_THAN:return"number"==typeof e.value?n=>"number"==typeof n&&t.floatCmp(n,e.value)>0:e=>!1;case w8.GREATER_THAN_OR_EQUAL:return"number"==typeof e.value?n=>"number"==typeof n&&t.floatCmp(n,e.value)>=0:e=>!1;case w8.LESS_THAN:return"number"==typeof e.value?n=>"number"==typeof n&&t.floatCmp(n,e.value)<0:e=>!1;case w8.LESS_THAN_OR_EQUAL:return"number"==typeof e.value?n=>"number"==typeof n&&t.floatCmp(n,e.value)<=0:e=>!1;case w8.EQUAL:return"number"==typeof e.value?n=>{if("number"==typeof n)return 0===t.floatCmp(n,e.value);if("string"==typeof n){if(""===n)return!1;const r=t.coerceToMaybeNumber(n);return void 0!==r&&0===t.floatCmp(r,e.value)}return!1}:"string"==typeof e.value?t.eqMatcherFunction(e.value):"boolean"==typeof e.value?t=>"boolean"==typeof t&&t===e.value:e=>e===V3;case w8.NOT_EQUAL:return"number"==typeof e.value?n=>{if("number"==typeof n)return 0!==t.floatCmp(n,e.value);if("string"==typeof n){if(""===n)return!0;const r=t.coerceToMaybeNumber(n);return void 0===r||0!==t.floatCmp(r,e.value)}return!0}:"string"==typeof e.value?t.neqMatcherFunction(e.value):"boolean"==typeof e.value?t=>"boolean"!=typeof t||t!==e.value:e=>e!==V3}};
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class R8{constructor(e,t,n,r,i,o,s,a,l,h){this.config=e,this.dependencyGraph=t,this.columnSearch=n,this.stats=r,this.arithmeticHelper=i,this.functionRegistry=o,this.namedExpressions=s,this.serialization=a,this.arraySizePredictor=l,this.dateTimeHelper=h,this.equalOp=(e,t)=>b8(this.arithmeticHelper.eq,e,t),this.notEqualOp=(e,t)=>b8(this.arithmeticHelper.neq,e,t),this.greaterThanOp=(e,t)=>b8(this.arithmeticHelper.gt,e,t),this.lessThanOp=(e,t)=>b8(this.arithmeticHelper.lt,e,t),this.greaterThanOrEqualOp=(e,t)=>b8(this.arithmeticHelper.geq,e,t),this.lessThanOrEqualOp=(e,t)=>b8(this.arithmeticHelper.leq,e,t),this.concatOp=(e,t)=>b8(this.arithmeticHelper.concat,z4(e),z4(t)),this.plusOp=(e,t)=>b8(this.arithmeticHelper.addWithEpsilon,this.arithmeticHelper.coerceScalarToNumberOrError(e),this.arithmeticHelper.coerceScalarToNumberOrError(t)),this.minusOp=(e,t)=>b8(this.arithmeticHelper.subtract,this.arithmeticHelper.coerceScalarToNumberOrError(e),this.arithmeticHelper.coerceScalarToNumberOrError(t)),this.timesOp=(e,t)=>b8(this.arithmeticHelper.multiply,this.arithmeticHelper.coerceScalarToNumberOrError(e),this.arithmeticHelper.coerceScalarToNumberOrError(t)),this.powerOp=(e,t)=>b8(this.arithmeticHelper.pow,this.arithmeticHelper.coerceScalarToNumberOrError(e),this.arithmeticHelper.coerceScalarToNumberOrError(t)),this.divOp=(e,t)=>b8(this.arithmeticHelper.divide,this.arithmeticHelper.coerceScalarToNumberOrError(e),this.arithmeticHelper.coerceScalarToNumberOrError(t)),this.unaryMinusOp=e=>E8(this.arithmeticHelper.unaryMinus,this.arithmeticHelper.coerceScalarToNumberOrError(e)),this.percentOp=e=>E8(this.arithmeticHelper.unaryPercent,this.arithmeticHelper.coerceScalarToNumberOrError(e)),this.unaryPlusOp=e=>this.arithmeticHelper.unaryPlus(e),this.functionRegistry.initializePlugins(this),this.criterionBuilder=new v8(e)}evaluateAst(e,t){let n=this.evaluateAstWithoutPostprocessing(e,t);if(K3(n)){if(K4(U3(n)))return new C4(t4.NUM,K2.NaN);n=W3(n,X4(U3(n)))}return n instanceof Z3&&1===n.height()&&1===n.width()&&([[n]]=n.data),function(e,t){if(e instanceof C4&&void 0!==t)return e.attachRootVertex(t);return e}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */(n,t.formulaVertex)}evaluateAstWithoutPostprocessing(e,t){switch(e.type){case H2.EMPTY:return V3;case H2.CELL_REFERENCE:{const n=e.reference.toSimpleCellAddress(t.formulaAddress);return N4(n)?new C4(t4.REF,K2.BadRef):this.dependencyGraph.getCellValue(n)}case H2.NUMBER:case H2.STRING:return e.value;case H2.CONCATENATE_OP:{const n=this.evaluateAst(e.left,t),r=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.concatOp,n,r,t)}case H2.EQUALS_OP:{const n=this.evaluateAst(e.left,t),r=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.equalOp,n,r,t)}case H2.NOT_EQUAL_OP:{const n=this.evaluateAst(e.left,t),r=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.notEqualOp,n,r,t)}case H2.GREATER_THAN_OP:{const n=this.evaluateAst(e.left,t),r=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.greaterThanOp,n,r,t)}case H2.LESS_THAN_OP:{const n=this.evaluateAst(e.left,t),r=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.lessThanOp,n,r,t)}case H2.GREATER_THAN_OR_EQUAL_OP:{const n=this.evaluateAst(e.left,t),r=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.greaterThanOrEqualOp,n,r,t)}case H2.LESS_THAN_OR_EQUAL_OP:{const n=this.evaluateAst(e.left,t),r=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.lessThanOrEqualOp,n,r,t)}case H2.PLUS_OP:{const n=this.evaluateAst(e.left,t),r=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.plusOp,n,r,t)}case H2.MINUS_OP:{const n=this.evaluateAst(e.left,t),r=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.minusOp,n,r,t)}case H2.TIMES_OP:{const n=this.evaluateAst(e.left,t),r=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.timesOp,n,r,t)}case H2.POWER_OP:{const n=this.evaluateAst(e.left,t),r=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.powerOp,n,r,t)}case H2.DIV_OP:{const n=this.evaluateAst(e.left,t),r=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.divOp,n,r,t)}case H2.PLUS_UNARY_OP:{const n=this.evaluateAst(e.value,t);return this.unaryRangeWrapper(this.unaryPlusOp,n,t)}case H2.MINUS_UNARY_OP:{const n=this.evaluateAst(e.value,t);return this.unaryRangeWrapper(this.unaryMinusOp,n,t)}case H2.PERCENT_OP:{const n=this.evaluateAst(e.value,t);return this.unaryRangeWrapper(this.percentOp,n,t)}case H2.FUNCTION_CALL:{if("valid"!==this.config.licenseKeyValidityState&&!f8.functionIsProtected(e.procedureName))return new C4(t4.LIC,K2.LicenseKey(this.config.licenseKeyValidityState));const n=this.functionRegistry.getFunction(e.procedureName);return void 0!==n?n(e,new F4(t.formulaAddress,t.arraysFlag||this.functionRegistry.isArrayFunction(e.procedureName),t.formulaVertex)):new C4(t4.NAME,K2.FunctionName(e.procedureName))}case H2.NAMED_EXPRESSION:{const n=this.namedExpressions.nearestNamedExpression(e.expressionName,t.formulaAddress.sheet);return n?this.dependencyGraph.getCellValue(n.address):new C4(t4.NAME,K2.NamedExpressionName(e.expressionName))}case H2.CELL_RANGE:{if(!this.rangeSpansOneSheet(e))return new C4(t4.REF,K2.RangeManySheets);const n=L4.fromCellRange(e,t.formulaAddress),r=this.dependencyGraph.getArray(n);if(r){const e=r.array;if(e instanceof D9)throw new Error("Array should be already computed");if(e instanceof C4)return e;if(e instanceof V9)return Z3.fromRange(e.raw(),n,this.dependencyGraph);throw new Error("Unknown array")}return Z3.onlyRange(n,this.dependencyGraph)}case H2.COLUMN_RANGE:{if(!this.rangeSpansOneSheet(e))return new C4(t4.REF,K2.RangeManySheets);const n=H4.fromColumnRange(e,t.formulaAddress);return Z3.onlyRange(n,this.dependencyGraph)}case H2.ROW_RANGE:{if(!this.rangeSpansOneSheet(e))return new C4(t4.REF,K2.RangeManySheets);const n=k4.fromRowRangeAst(e,t.formulaAddress);return Z3.onlyRange(n,this.dependencyGraph)}case H2.PARENTHESIS:return this.evaluateAst(e.expression,t);case H2.ARRAY:{let n;const r=[];for(const i of e.args){let e;const o=[];for(const n of i){const r=B4(this.evaluateAst(n,t)),i=r.height();if(void 0===e)e=i,o.push(...r.data);else{if(e!==i)return new C4(t4.REF,K2.SizeMismatch);for(let e=0;e<i;e++)o[e].push(...r.data[e])}}const s=o[0].length;if(void 0===n)n=s,r.push(...o);else{if(n!==s)return new C4(t4.REF,K2.SizeMismatch);r.push(...o)}}return Z3.onlyValues(r)}case H2.ERROR_WITH_RAW_INPUT:case H2.ERROR:return e.error}}rangeSpansOneSheet(e){return e.start.sheet===e.end.sheet}unaryRangeWrapper(e,t,n){var r;if(t instanceof Z3&&!n.arraysFlag&&(t=null!==(r=n5(t,n))&&void 0!==r?r:new C4(t4.VALUE,K2.ScalarExpected)),t instanceof C4)return t;if(t instanceof Z3){const n=t.data.map((t=>t.map(e)));return Z3.onlyValues(n)}return e(t)}binaryRangeWrapper(e,t,n,r){var i,o;if(t instanceof Z3&&!r.arraysFlag&&(t=null!==(i=n5(t,r))&&void 0!==i?i:new C4(t4.VALUE,K2.ScalarExpected)),t instanceof C4)return t;if(n instanceof Z3&&!r.arraysFlag&&(n=null!==(o=n5(n,r))&&void 0!==o?o:new C4(t4.VALUE,K2.ScalarExpected)),n instanceof C4)return n;if(t instanceof Z3||n instanceof Z3){if(!(t instanceof Z3)){if(n.isAdHoc()){const r=n.data;for(let n=0;n<r.length;n++)for(let i=0;i<r[0].length;i++)r[n][i]=e(t,r[n][i]);return Z3.onlyValues(r)}t=Z3.fromScalar(t)}if(!(n instanceof Z3)){if(t.isAdHoc()){const r=t.data;for(let t=0;t<r.length;t++)for(let i=0;i<r[0].length;i++)r[t][i]=e(r[t][i],n);return Z3.onlyValues(r)}n=Z3.fromScalar(n)}if(t.width()===n.width()&&t.height()===n.height()){if(t.isAdHoc()){const r=t.data,i=n.data;for(let t=0;t<r.length;t++)for(let n=0;n<r[0].length;n++)r[t][n]=e(r[t][n],i[t][n]);return Z3.onlyValues(r)}if(n.isAdHoc()){const r=t.data,i=n.data;for(let t=0;t<r.length;t++)for(let n=0;n<r[0].length;n++)i[t][n]=e(r[t][n],i[t][n]);return Z3.onlyValues(i)}}const r=Math.max(t.width(),n.width()),i=Math.max(t.height(),n.height()),o=Array(i);for(let e=0;e<i;e++)o[e]=Array(r);for(let s=0;s<i;s++){const i=1!==t.height()?s:0,a=1!==n.height()?s:0;for(let l=0;l<r;l++){const r=1!==t.width()?l:0,h=1!==n.width()?l:0;i<t.height()&&a<n.height()&&r<t.width()&&h<n.width()?o[s][l]=e(t.data[i][r],n.data[a][h]):o[s][l]=new C4(t4.NA)}}return Z3.onlyValues(o)}return e(t,n)}}function E8(e,t){return t instanceof C4?t:e(t)}function b8(e,t,n){return t instanceof C4?t:n instanceof C4?n:e(t,n)}class T8{constructor(e){this.sheet=e,this.transformations=[]}add(e){this.transformations.push(e)}performEagerTransformations(e,t){this.transformations.forEach((n=>n.performEagerTransformations(e,t)))}transformSingleAst(e,t){let[n,r]=[e,t];return this.transformations.forEach((e=>{[n,r]=e.transformSingleAst(n,r)})),[n,r]}isIrreversible(){return!0}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class N8{constructor(e){this.stats=e,this.transformations=[]}version(){return this.transformations.length}addTransformation(e){return void 0!==this.combinedTransformer?this.combinedTransformer.add(e):this.transformations.push(e),this.version()}beginCombinedMode(e){this.combinedTransformer=new T8(e)}commitCombinedMode(){if(void 0===this.combinedTransformer)throw Error("Combined mode wasn't started");return this.transformations.push(this.combinedTransformer),this.combinedTransformer=void 0,this.version()}applyTransformations(e,t,n){this.stats.start(q3.TRANSFORM_ASTS_POSTPONED);for(let i=n;i<this.transformations.length;i++){const n=this.transformations[i];n.isIrreversible()&&(this.undoRedo.storeDataForVersion(i,t,this.parser.computeHashFromAst(e)),this.parser.rememberNewAst(e));const[r,o]=n.transformSingleAst(e,t);e=r,t=o}const r=this.parser.rememberNewAst(e);return this.stats.end(q3.TRANSFORM_ASTS_POSTPONED),[r,t,this.transformations.length]}*getTransformationsFrom(e,t){for(let n=e;n<this.transformations.length;n++){const e=this.transformations[n];t&&!t(e)||(yield e)}}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */const A8=-1;function M8(e,t,{searchCoordinate:n,orderingDirection:r,ifNoMatch:i},o){const s=t.start[n],a="col"===n?t.effectiveEndColumn(o):t.effectiveEndRow(o),l="col"===n?e=>U3(o.getCellValue(T4(t.sheet,e,t.start.row))):e=>U3(o.getCellValue(T4(t.sheet,t.start.col,e))),h="asc"===r?(e,t)=>I8(e,t):(e,t)=>-I8(e,t),u=function(e,t,n){let r=t,i=n;for(;r<i;){const t=Math.ceil((r+i)/2);e(t)?r=t:i=t-1}if(r===i&&e(r))return r;return A8}((t=>h(e,l(t))>=0),s,a),c=l(u);if(c===e)return u-s;if("returnLowerBound"===i){if(u===A8)return"asc"===r?A8:0;if(typeof c!=typeof e)return A8;if("asc"===r)return u-s;const t=u+1;return t<=a?t-s:A8}if("returnUpperBound"===i){if(u===A8)return"asc"===r?0:A8;if(typeof c!=typeof e)return A8;if("desc"===r)return u-s;const t=u+1;return t<=a?t-s:A8}return A8}function I8(e,t){return typeof e==typeof t?e===V3?0:e<t?-1:e>t?1:0:e===V3?-1:t===V3?1:t instanceof C4||"number"==typeof e&&"string"==typeof t||"number"==typeof e&&"boolean"==typeof t?-1:"string"==typeof e&&"number"==typeof t?1:"string"==typeof e&&"boolean"==typeof t?-1:1}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class O8{constructor(e){this.dependencyGraph=e}advancedFind(e,t,{returnOccurrence:n}={returnOccurrence:"first"}){const r=t.range,i=void 0===r?t.valuesFromTopLeftCorner():this.dependencyGraph.computeListOfValuesInRange(r),o="first"===n?e=>e<i.length:e=>e>=0,s="first"===n?e=>e+1:e=>e-1;for(let a="first"===n?0:i.length-1;o(a);a=s(a))if(e(U3(i[a])))return a;return-1}basicFind(e,t,n,{ordering:r,ifNoMatch:i,returnOccurrence:o}){const s="string"==typeof e?t5(e):e,a=t.range;return void 0===a?this.findNormalizedValue(s,t.valuesFromTopLeftCorner(),i,o):"none"===r?this.findNormalizedValue(s,this.dependencyGraph.computeListOfValuesInRange(a),i,o):M8(s,a,{searchCoordinate:n,orderingDirection:r,ifNoMatch:i},this.dependencyGraph)}findNormalizedValue(e,t,n="returnNotFound",r="first"){const i=t.map(U3).map((e=>"string"==typeof e?t5(e):e));if("returnNotFound"===n)return"first"===r?i.indexOf(e):i.lastIndexOf(e);const o="returnLowerBound"===n?(e,t)=>I8(e,t):(e,t)=>-I8(e,t);let s="returnLowerBound"===n?-1/0:1/0,a=-1;const l="first"===r?e=>e<i.length:e=>e>=0,h="first"===r?e=>e+1:e=>e-1;for(let u="first"===r?0:i.length-1;l(u);u=h(u)){const t=i[u];if(t===e)return u;o(t,e)>0||o(s,t)<0&&(s=t,a=u)}return a}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class x8 extends O8{constructor(e){super(e),this.dependencyGraph=e}add(e,t){}remove(e,t){}change(e,t,n){}applyChanges(e){}addColumns(e){}removeColumns(e){}removeSheet(e){}moveValues(e,t,n,r){}removeValues(e){}find(e,t,n){return this.basicFind(e,t,"row",n)}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class P8{constructor(e,t,n){this.dependencyGraph=e,this.config=t,this.stats=n,this.index=new Map,this.transformingService=this.dependencyGraph.lazilyTransformingAstService,this.binarySearchStrategy=new x8(e)}add(e,t){if(!(e===V3||e instanceof C4))if(e instanceof Z3)for(const[n,r]of e.entriesFromTopLeftCorner(t))this.addSingleCellValue(U3(n),r);else this.addSingleCellValue(e,t)}remove(e,t){if(void 0!==e)if(e instanceof Z3)for(const[n,r]of e.entriesFromTopLeftCorner(t))this.removeSingleValue(U3(n),r);else this.removeSingleValue(e,t)}change(e,t,n){e!==t&&(this.remove(e,n),this.add(t,n))}applyChanges(e){for(const t of e)void 0!==t.oldValue&&this.change(U3(t.oldValue),U3(t.value),t.address)}moveValues(e,t,n,r){for(const[i,o]of e){const e=A4(o,r,t,n);this.remove(i,o),this.add(i,e)}}removeValues(e){for(const[t,n]of e)this.remove(t,n)}find(e,t,{ordering:n,ifNoMatch:r,returnOccurrence:i}){null==i&&(i="none"===n?"first":"last");const o=this.findUsingColumnIndex(e,t,i);return void 0!==o?o:this.binarySearchStrategy.find(e,t,{ordering:n,ifNoMatch:r,returnOccurrence:i})}findUsingColumnIndex(e,t,n){const r=t.range;if(void 0===r)return;this.ensureRecentData(r.sheet,r.start.col,e);const i=this.getColumnMap(r.sheet,r.start.col);if(!i)return-1;const o="string"==typeof e?t5(e):e,s=i.get(o);if(!s||!s.index||0===s.index.length)return;const a=P8.findRowBelongingToRange(s,r,n);return void 0!==a?a-r.start.row:void 0}static findRowBelongingToRange(e,t,n){const r=t.start.row,i=t.end.row,o="first"===n?_8(r,e.index,"upperBound"):_8(i,e.index,"lowerBound");if(-1===o)return;const s=e.index[o];return s>=r&&s<=i?s:void 0}advancedFind(e,t,n={returnOccurrence:"first"}){return this.binarySearchStrategy.advancedFind(e,t,n)}addColumns(e){const t=this.index.get(e.sheet);t&&t.splice(e.columnStart,0,...Array(e.numberOfColumns))}removeColumns(e){const t=this.index.get(e.sheet);t&&t.splice(e.columnStart,e.numberOfColumns)}removeSheet(e){this.index.delete(e)}getColumnMap(e,t){this.index.has(e)||this.index.set(e,[]);const n=this.index.get(e);let r=n[t];return r||(r=new Map,n[t]=r),r}getValueIndex(e,t,n){const r=this.getColumnMap(e,t);let i=this.getColumnMap(e,t).get(n);return i||(i={version:this.transformingService.version(),index:[]},r.set(n,i)),i}ensureRecentData(e,t,n){const r=this.getValueIndex(e,t,n),i=this.transformingService.version();if(r.version===i)return;const o=this.transformingService.getTransformationsFrom(r.version,(t=>t.sheet===e&&(t instanceof v6||t instanceof b6)));for(const s of o)s instanceof v6?this.addRows(t,s.rowsSpan,n):s instanceof b6&&this.removeRows(t,s.rowsSpan,n);r.version=i}addSingleCellValue(e,t){this.stats.measure(q3.BUILD_COLUMN_INDEX,(()=>{this.ensureRecentData(t.sheet,t.col,e),"string"==typeof e&&(e=t5(e));const n=this.getValueIndex(t.sheet,t.col,e);P8.addValue(n,t.row)}))}removeSingleValue(e,t){this.stats.measure(q3.BUILD_COLUMN_INDEX,(()=>{this.ensureRecentData(t.sheet,t.col,e);const n=this.getColumnMap(t.sheet,t.col);"string"==typeof e&&(e=t5(e));const r=n.get(e);if(!r)return;const i=_8(t.row,r.index);i>-1&&r.index.splice(i,1),0===r.index.length&&n.delete(e),0===n.size&&delete this.index.get(t.sheet)[t.col]}))}addRows(e,t,n){const r=this.getValueIndex(t.sheet,e,n);P8.shiftRows(r,t.rowStart,t.numberOfRows)}removeRows(e,t,n){const r=this.getValueIndex(t.sheet,e,n);P8.removeRowsFromValues(r,t),P8.shiftRows(r,t.rowEnd+1,-t.numberOfRows)}static addValue(e,t){const n=_8(t,e.index,"lowerBound");e.index[n]===t||e.index.splice(n+1,0,t)}static removeRowsFromValues(e,t){const n=_8(t.rowStart,e.index,"upperBound"),r=_8(t.rowEnd,e.index,"lowerBound");n>-1&&r>-1&&n<=r&&e.index[n]<=t.rowEnd&&e.index.splice(n,r-n+1)}static shiftRows(e,t,n){const r=_8(t,e.index,"upperBound");if(-1!==r)for(let i=r;i<e.index.length;++i)e.index[i]+=n}}function _8(e,t,n="upperBound"){let r=0,i=t.length-1;for(;r<=i;){const n=Math.floor((r+i)/2);if(e>t[n])r=n+1;else{if(!(e<t[n]))return n;i=n-1}}const o="lowerBound"===n?i:r;return o>=0&&o<=t.length?o:-1}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
class L8{constructor(e){this.config=e;const t="."===this.config.thousandSeparator?`\\${this.config.thousandSeparator}`:this.config.thousandSeparator,n="."===this.config.decimalSeparator?`\\${this.config.decimalSeparator}`:this.config.decimalSeparator;this.numberPattern=new RegExp(`^([+-]?((${n}\\d+)|(\\d+(${t}\\d{3,})*(${n}\\d*)?)))(e[+-]?\\d+)?$`),this.allThousandSeparatorsRegex=new RegExp(`${t}`,"g")}numericStringToMaybeNumber(e){if(this.numberPattern.test(e)){const t=this.numericStringToNumber(e);if(isNaN(t))return;return t}}numericStringToNumber(e){const t=e.replace(this.allThousandSeparatorsRegex,"").replace(this.config.decimalSeparator,".");return Number(t)}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class H8{constructor(e,t,n){this.dependencyGraph=e,this.unparser=t,this.exporter=n}getCellHyperlink(e){const t=this.dependencyGraph.getCell(e);if(t instanceof j9){const e=t.getFormula(this.dependencyGraph.lazilyTransformingAstService);if("HYPERLINK"===e.procedureName)return e.hyperlink}}getCellFormula(e,t){const n=this.dependencyGraph.getCell(e);if(n instanceof j9){const r=n.getFormula(this.dependencyGraph.lazilyTransformingAstService);return t=null!=t?t:e,this.unparser.unparse(r,t)}if(n instanceof W9){const r=n.getAddress(this.dependencyGraph.lazilyTransformingAstService);if(r.row!==e.row||r.col!==e.col||r.sheet!==e.sheet)return;t=null!=t?t:e;const i=n.getFormula(this.dependencyGraph.lazilyTransformingAstService);if(void 0!==i)return this.unparser.unparse(i,t)}else if(n instanceof h4)return n.getFormula()}getCellSerialized(e,t){var n;return null!==(n=this.getCellFormula(e,t))&&void 0!==n?n:this.getRawValue(e)}getCellValue(e){return this.exporter.exportValue(this.dependencyGraph.getScalarValue(e))}getRawValue(e){return this.dependencyGraph.getRawValue(e)}getSheetValues(e){return this.genericSheetGetter(e,(e=>this.getCellValue(e)))}getSheetFormulas(e){return this.genericSheetGetter(e,(e=>this.getCellFormula(e)))}genericSheetGetter(e,t){const n=this.dependencyGraph.getSheetHeight(e),r=this.dependencyGraph.getSheetWidth(e),i=new Array(n);for(let o=0;o<n;o++){i[o]=new Array(r);for(let n=0;n<r;n++){const r=T4(e,n,o);i[o][n]=t(r)}for(let e=r-1;e>=0&&(null===i[o][e]||void 0===i[o][e]);e--)i[o].pop()}for(let o=n-1;o>=0&&0===i[o].length;o--)i.pop();return i}genericAllSheetsGetter(e){const t={};for(const n of this.dependencyGraph.sheetMapping.displayNames()){const r=this.dependencyGraph.sheetMapping.fetch(n);t[n]=e(r)}return t}getSheetSerialized(e){return this.genericSheetGetter(e,(e=>this.getCellSerialized(e)))}getAllSheetsValues(){return this.genericAllSheetsGetter((e=>this.getSheetValues(e)))}getAllSheetsFormulas(){return this.genericAllSheetsGetter((e=>this.getSheetFormulas(e)))}getAllSheetsSerialized(){return this.genericAllSheetsGetter((e=>this.getSheetSerialized(e)))}getAllNamedExpressionsSerialized(){const e=[];let t=0;for(const n of this.dependencyGraph.sheetMapping.displayNames()){const r=this.dependencyGraph.sheetMapping.fetch(n);e[r]=t,t++}return this.dependencyGraph.namedExpressions.getAllNamedExpressions().map((t=>({name:t.expression.displayName,expression:this.getCellSerialized(t.expression.address),scope:void 0!==t.scope?e[t.scope]:void 0,options:t.expression.options})))}withNewConfig(e,t){const n=new M3(e,T3(e),this.dependencyGraph.sheetMapping.fetchDisplayName,t);return new H8(this.dependencyGraph,n,this.exporter)}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class k8{static buildFromSheets(e,t={},n=[]){const r=new z8(t);return this.buildEngine(r,e,n)}static buildFromSheet(e,t={},n=[]){const r=new z8(t),i=r.translationPackage.getUITranslation(e4.NEW_SHEET_PREFIX)+"1";return this.buildEngine(r,{[i]:e},n)}static buildEmpty(e={},t=[]){return this.buildEngine(new z8(e),{},t)}static rebuildWithConfig(e,t,n,r){return this.buildEngine(e,t,n,r)}static buildEngine(e,t={},n=[],r=(e.useStats?new n9:new r9)){r.start(q3.BUILD_ENGINE_TOTAL);const i=new m6,o=new f8(e),s=new N8(r),a=s4.buildEmpty(s,e,o,i,r),l=function(e,t,n){return t.useColumnIndex?new P8(e,t,n):new x8(e)}(a,e,r),h=a.sheetMapping,u=a.addressMapping;for(const N in t)if(Object.prototype.hasOwnProperty.call(t,N)){const n=t[N];N6(n);const r=A6(n);if(r.height>e.maxRows||r.width>e.maxColumns)throw new a9;const i=h.addSheet(N);u.autoAddSheet(i,r)}const c=new O3(e,o,h.get);s.parser=c;const d=new M3(e,T3(e),h.fetchDisplayName,i),p=new P5(e),g=new L8(e),m=new V4(e,p,g),f=new h6(e,p,g),w=new a5(e,o),y=new P6(e,a,l,f,c,r,s,i,w),v=new r8(e,y);s.undoRedo=v;const C=new c6(e,a,y),S=new i8(e,y,v,C,a,l,c,f,s,i);n.forEach((e=>{S.ensureItIsPossibleToAddNamedExpression(e.name,e.expression,e.scope),S.operations.addNamedExpression(e.name,e.expression,e.scope,e.options)}));const R=new u8(e,i,h.fetchDisplayName,s),E=new H8(a,d,R),b=new R8(e,a,l,r,m,o,i,E,w,p);r.measure(q3.GRAPH_BUILD,(()=>{new c8(a,l,c,f,r,w).buildGraph(t,r)}));const T=new a8(e,r,b,s,a,l);return T.run(),r.end(q3.BUILD_ENGINE_TOTAL),{config:e,stats:r,dependencyGraph:a,columnSearch:l,parser:c,unparser:d,cellContentParser:f,evaluator:T,lazilyTransformingAstService:s,crudOperations:S,exporter:R,namedExpressions:i,serialization:E,functionRegistry:o}}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */function F8(e){return()=>{throw new Error(`The "${e}" method cannot be called because this HyperFormula instance has been destroyed`)}}var D8={exports:{}};function V8(){}V8.prototype={on:function(e,t,n){var r=this.e||(this.e={});return(r[e]||(r[e]=[])).push({fn:t,ctx:n}),this},once:function(e,t,n){var r=this;function i(){r.off(e,i),t.apply(n,arguments)}return i._=t,this.on(e,i,n)},emit:function(e){for(var t=[].slice.call(arguments,1),n=((this.e||(this.e={}))[e]||[]).slice(),r=0,i=n.length;r<i;r++)n[r].fn.apply(n[r].ctx,t);return this},off:function(e,t){var n=this.e||(this.e={}),r=n[e],i=[];if(r&&t)for(var o=0,s=r.length;o<s;o++)r[o].fn!==t&&r[o].fn._!==t&&i.push(r[o]);return i.length?n[e]=i:delete n[e],this}},D8.exports=V8;var U8,B8=D8.exports.TinyEmitter=V8;
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */!function(e){e.SheetAdded="sheetAdded",e.SheetRemoved="sheetRemoved",e.SheetRenamed="sheetRenamed",e.NamedExpressionAdded="namedExpressionAdded",e.NamedExpressionRemoved="namedExpressionRemoved",e.ValuesUpdated="valuesUpdated",e.EvaluationSuspended="evaluationSuspended",e.EvaluationResumed="evaluationResumed"}(U8||(U8={}));class W8 extends B8{emit(e,...t){return super.emit(e,...t),this}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class j8{constructor(e,t,n,r,i,o,s,a,l,h,u,c,d,p){this._config=e,this._stats=t,this._dependencyGraph=n,this._columnSearch=r,this._parser=i,this._unparser=o,this._cellContentParser=s,this._evaluator=a,this._lazilyTransformingAstService=l,this._crudOperations=h,this._exporter=u,this._namedExpressions=c,this._serialization=d,this._functionRegistry=p,this._emitter=new W8,this._evaluationSuspended=!1}static get defaultConfig(){return $8({})}get graph(){return this.dependencyGraph.graph}get rangeMapping(){return this.dependencyGraph.rangeMapping}get arrayMapping(){return this.dependencyGraph.arrayMapping}get sheetMapping(){return this.dependencyGraph.sheetMapping}get addressMapping(){return this.dependencyGraph.addressMapping}get dependencyGraph(){return this._dependencyGraph}get evaluator(){return this._evaluator}get columnSearch(){return this._columnSearch}get lazilyTransformingAstService(){return this._lazilyTransformingAstService}get licenseKeyValidityState(){return this._config.licenseKeyValidityState}static buildFromArray(e,t={},n=[]){return this.buildFromEngineState(k8.buildFromSheet(e,t,n))}static buildFromSheets(e,t={},n=[]){return this.buildFromEngineState(k8.buildFromSheets(e,t,n))}static buildEmpty(e={},t=[]){return this.buildFromEngineState(k8.buildEmpty(e,t))}static getLanguage(e){p5(e,"string","languageCode");const t=this.registeredLanguages.get(e);if(void 0===t)throw new M9;return t}static registerLanguage(e,t){if(p5(e,"string","languageCode"),this.registeredLanguages.has(e))throw new I9;var n;this.registeredLanguages.set(e,(n=t,new J9(Object.assign({},n.functions),Object.assign({},n.errors),Object.assign({},n.ui))))}static unregisterLanguage(e){if(p5(e,"string","languageCode"),!this.registeredLanguages.has(e))throw new M9;this.registeredLanguages.delete(e)}static getRegisteredLanguagesCodes(){return Array.from(this.registeredLanguages.keys())}static registerFunctionPlugin(e,t){f8.registerFunctionPlugin(e,t)}static unregisterFunctionPlugin(e){f8.unregisterFunctionPlugin(e)}static registerFunction(e,t,n){p5(e,"string","functionId"),f8.registerFunction(e,t,n)}static unregisterFunction(e){p5(e,"string","functionId"),f8.unregisterFunction(e)}static unregisterAllFunctions(){f8.unregisterAll()}static getRegisteredFunctionNames(e){p5(e,"string","code");const t=f8.getRegisteredFunctionIds();return this.getLanguage(e).getFunctionTranslations(t)}static getFunctionPlugin(e){return p5(e,"string","functionId"),f8.getFunctionPlugin(e)}static getAllFunctionPlugins(){return f8.getPlugins()}static buildFromEngineState(e){return new j8(e.config,e.stats,e.dependencyGraph,e.columnSearch,e.parser,e.unparser,e.cellContentParser,e.evaluator,e.lazilyTransformingAstService,e.crudOperations,e.exporter,e.namedExpressions,e.serialization,e.functionRegistry)}getCellValue(e){if(!I4(e))throw new C9("SimpleCellAddress","cellAddress");return this.ensureEvaluationIsNotSuspended(),this._serialization.getCellValue(e)}getCellFormula(e){if(!I4(e))throw new C9("SimpleCellAddress","cellAddress");return this._serialization.getCellFormula(e)}getCellHyperlink(e){if(!I4(e))throw new C9("SimpleCellAddress","cellAddress");return this.ensureEvaluationIsNotSuspended(),this._serialization.getCellHyperlink(e)}getCellSerialized(e){if(!I4(e))throw new C9("SimpleCellAddress","cellAddress");return this.ensureEvaluationIsNotSuspended(),this._serialization.getCellSerialized(e)}getSheetValues(e){return p5(e,"number","sheetId"),this.ensureEvaluationIsNotSuspended(),this._serialization.getSheetValues(e)}getSheetFormulas(e){return p5(e,"number","sheetId"),this._serialization.getSheetFormulas(e)}getSheetSerialized(e){return p5(e,"number","sheetId"),this.ensureEvaluationIsNotSuspended(),this._serialization.getSheetSerialized(e)}getAllSheetsDimensions(){return this._serialization.genericAllSheetsGetter((e=>this.getSheetDimensions(e)))}getSheetDimensions(e){return p5(e,"number","sheetId"),{width:this.dependencyGraph.getSheetWidth(e),height:this.dependencyGraph.getSheetHeight(e)}}getAllSheetsValues(){return this.ensureEvaluationIsNotSuspended(),this._serialization.getAllSheetsValues()}getAllSheetsFormulas(){return this._serialization.getAllSheetsFormulas()}getAllSheetsSerialized(){return this.ensureEvaluationIsNotSuspended(),this._serialization.getAllSheetsSerialized()}updateConfig(e){Object.entries(e).every((([e,t])=>this._config[e]===t))||this.rebuildWithConfig(e)}getConfig(){return this._config.getConfig()}rebuildAndRecalculate(){this.rebuildWithConfig({})}getStats(){return this._stats.snapshot()}undo(){return this._crudOperations.undo(),this.recomputeIfDependencyGraphNeedsIt()}redo(){return this._crudOperations.redo(),this.recomputeIfDependencyGraphNeedsIt()}isThereSomethingToUndo(){return this._crudOperations.isThereSomethingToUndo()}isThereSomethingToRedo(){return this._crudOperations.isThereSomethingToRedo()}isItPossibleToSetCellContents(e){let t;if(I4(e))t=new L4(e,e);else{if(!P4(e))throw new C9("SimpleCellAddress | SimpleCellRange","address");t=new L4(e.start,e.end)}try{this._crudOperations.ensureRangeInSizeLimits(t);for(const e of t.addresses(this._dependencyGraph))this._crudOperations.ensureItIsPossibleToChangeContent(e)}catch(n){return!1}return!0}setCellContents(e,t){return this._crudOperations.setCellContents(e,t),this.recomputeIfDependencyGraphNeedsIt()}swapRowIndexes(e,t){return p5(e,"number","sheetId"),this._crudOperations.setRowOrder(e,t),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToSwapRowIndexes(e,t){p5(e,"number","sheetId");try{return this._crudOperations.validateSwapRowIndexes(e,t),this._crudOperations.testRowOrderForArrays(e,t),!0}catch(n){return!1}}setRowOrder(e,t){p5(e,"number","sheetId");const n=this._crudOperations.mappingFromOrder(e,t,"row");return this.swapRowIndexes(e,n)}isItPossibleToSetRowOrder(e,t){p5(e,"number","sheetId");try{const n=this._crudOperations.mappingFromOrder(e,t,"row");return this._crudOperations.validateSwapRowIndexes(e,n),this._crudOperations.testRowOrderForArrays(e,n),!0}catch(n){return!1}}swapColumnIndexes(e,t){return p5(e,"number","sheetId"),this._crudOperations.setColumnOrder(e,t),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToSwapColumnIndexes(e,t){p5(e,"number","sheetId");try{return this._crudOperations.validateSwapColumnIndexes(e,t),this._crudOperations.testColumnOrderForArrays(e,t),!0}catch(n){return!1}}setColumnOrder(e,t){p5(e,"number","sheetId");const n=this._crudOperations.mappingFromOrder(e,t,"column");return this.swapColumnIndexes(e,n)}isItPossibleToSetColumnOrder(e,t){p5(e,"number","sheetId");try{const n=this._crudOperations.mappingFromOrder(e,t,"column");return this._crudOperations.validateSwapColumnIndexes(e,n),this._crudOperations.testColumnOrderForArrays(e,n),!0}catch(n){return!1}}isItPossibleToAddRows(e,...t){p5(e,"number","sheetId");const n=L6(t);try{return this._crudOperations.ensureItIsPossibleToAddRows(e,...n),!0}catch(r){return!1}}addRows(e,...t){return p5(e,"number","sheetId"),this._crudOperations.addRows(e,...t),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToRemoveRows(e,...t){p5(e,"number","sheetId");const n=_6(t);try{return this._crudOperations.ensureItIsPossibleToRemoveRows(e,...n),!0}catch(r){return!1}}removeRows(e,...t){return p5(e,"number","sheetId"),this._crudOperations.removeRows(e,...t),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToAddColumns(e,...t){p5(e,"number","sheetId");const n=L6(t);try{return this._crudOperations.ensureItIsPossibleToAddColumns(e,...n),!0}catch(r){return!1}}addColumns(e,...t){return p5(e,"number","sheetId"),this._crudOperations.addColumns(e,...t),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToRemoveColumns(e,...t){p5(e,"number","sheetId");const n=_6(t);try{return this._crudOperations.ensureItIsPossibleToRemoveColumns(e,...n),!0}catch(r){return!1}}removeColumns(e,...t){return p5(e,"number","sheetId"),this._crudOperations.removeColumns(e,...t),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToMoveCells(e,t){if(!I4(t))throw new C9("SimpleCellAddress","destinationLeftCorner");if(!P4(e))throw new C9("SimpleCellRange","source");try{const n=new L4(e.start,e.end);return this._crudOperations.operations.ensureItIsPossibleToMoveCells(n.start,n.width(),n.height(),t),!0}catch(n){return!1}}moveCells(e,t){if(!I4(t))throw new C9("SimpleCellAddress","destinationLeftCorner");if(!P4(e))throw new C9("SimpleCellRange","source");const n=new L4(e.start,e.end);return this._crudOperations.moveCells(n.start,n.width(),n.height(),t),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToMoveRows(e,t,n,r){p5(e,"number","sheetId"),p5(t,"number","startRow"),p5(n,"number","numberOfRows"),p5(r,"number","targetRow");try{return this._crudOperations.ensureItIsPossibleToMoveRows(e,t,n,r),!0}catch(i){return!1}}moveRows(e,t,n,r){return p5(e,"number","sheetId"),p5(t,"number","startRow"),p5(n,"number","numberOfRows"),p5(r,"number","targetRow"),this._crudOperations.moveRows(e,t,n,r),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToMoveColumns(e,t,n,r){p5(e,"number","sheetId"),p5(t,"number","startColumn"),p5(n,"number","numberOfColumns"),p5(r,"number","targetColumn");try{return this._crudOperations.ensureItIsPossibleToMoveColumns(e,t,n,r),!0}catch(i){return!1}}moveColumns(e,t,n,r){return p5(e,"number","sheetId"),p5(t,"number","startColumn"),p5(n,"number","numberOfColumns"),p5(r,"number","targetColumn"),this._crudOperations.moveColumns(e,t,n,r),this.recomputeIfDependencyGraphNeedsIt()}copy(e){if(!P4(e))throw new C9("SimpleCellRange","source");const t=new L4(e.start,e.end);return this._crudOperations.copy(t.start,t.width(),t.height()),this.getRangeValues(e)}cut(e){if(!P4(e))throw new C9("SimpleCellRange","source");const t=new L4(e.start,e.end);return this._crudOperations.cut(t.start,t.width(),t.height()),this.getRangeValues(e)}paste(e){if(!I4(e))throw new C9("SimpleCellAddress","targetLeftCorner");return this.ensureEvaluationIsNotSuspended(),this._crudOperations.paste(e),this.recomputeIfDependencyGraphNeedsIt()}isClipboardEmpty(){return this._crudOperations.isClipboardEmpty()}clearClipboard(){this._crudOperations.clearClipboard()}clearRedoStack(){this._crudOperations.undoRedo.clearRedoStack()}clearUndoStack(){this._crudOperations.undoRedo.clearUndoStack()}getRangeValues(e){if(!P4(e))throw new C9("SimpleCellRange","source");return new L4(e.start,e.end).arrayOfAddressesInRange().map((e=>e.map((e=>this.getCellValue(e)))))}getRangeFormulas(e){if(!P4(e))throw new C9("SimpleCellRange","source");return new L4(e.start,e.end).arrayOfAddressesInRange().map((e=>e.map((e=>this.getCellFormula(e)))))}getRangeSerialized(e){if(!P4(e))throw new C9("SimpleCellRange","source");return new L4(e.start,e.end).arrayOfAddressesInRange().map((e=>e.map((e=>this.getCellSerialized(e)))))}getFillRangeData(e,t,n=!1){if(!P4(e))throw new C9("SimpleCellRange","source");if(!P4(t))throw new C9("SimpleCellRange","target");const r=new L4(e.start,e.end),i=new L4(t.start,t.end);return this.ensureEvaluationIsNotSuspended(),i.arrayOfAddressesInRange().map((i=>i.map((i=>{const o=((i.row-(n?t:e).start.row)%r.height()+r.height())%r.height()+e.start.row,s=((i.col-(n?t:e).start.col)%r.width()+r.width())%r.width()+e.start.col;return this._serialization.getCellSerialized({row:o,col:s,sheet:r.sheet},i)}))))}isItPossibleToAddSheet(e){p5(e,"string","sheetName");try{return this._crudOperations.ensureItIsPossibleToAddSheet(e),!0}catch(t){return!1}}addSheet(e){void 0!==e&&p5(e,"string","sheetName");const t=this._crudOperations.addSheet(e);return this._emitter.emit(U8.SheetAdded,t),t}isItPossibleToRemoveSheet(e){p5(e,"number","sheetId");try{return this._crudOperations.ensureScopeIdIsValid(e),!0}catch(t){return!1}}removeSheet(e){p5(e,"number","sheetId");const t=this.sheetMapping.getDisplayName(e);this._crudOperations.removeSheet(e);const n=this.recomputeIfDependencyGraphNeedsIt();return this._emitter.emit(U8.SheetRemoved,t,n),n}isItPossibleToClearSheet(e){p5(e,"number","sheetId");try{return this._crudOperations.ensureScopeIdIsValid(e),!0}catch(t){return!1}}clearSheet(e){return p5(e,"number","sheetId"),this._crudOperations.clearSheet(e),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToReplaceSheetContent(e,t){p5(e,"number","sheetId");try{return this._crudOperations.ensureScopeIdIsValid(e),this._crudOperations.ensureItIsPossibleToChangeSheetContents(e,t),!0}catch(n){return!1}}setSheetContent(e,t){return p5(e,"number","sheetId"),this._crudOperations.setSheetContent(e,t),this.recomputeIfDependencyGraphNeedsIt()}simpleCellAddressFromString(e,t){return p5(e,"string","cellAddress"),p5(t,"number","sheetId"),cZ(this.sheetMapping.get,e,t)}simpleCellRangeFromString(e,t){return p5(e,"string","cellRange"),p5(t,"number","sheetId"),((e,t,n)=>{const r=t.split(GQ);if(2!==r.length)return;const[i,o]=r,s=cZ(e,i,n);if(void 0===s)return;const a=cZ(e,o,s.sheet);return void 0!==a&&s.sheet===a.sheet?_4(s,a):void 0})(this.sheetMapping.get,e,t)}simpleCellAddressToString(e,t={}){if(!I4(e))throw new C9("SimpleCellAddress","cellAddress");const n="number"==typeof t?t:t.includeSheetName?e.sheet+1:e.sheet;return dZ(this.sheetMapping.fetchDisplayName,e,n)}simpleCellRangeToString(e,t={}){if(!P4(e))throw new C9("SimpleCellRange","cellRange");const n="number"==typeof t?t:t.includeSheetName?e.start.sheet+e.end.sheet+1:e.start.sheet;return((e,t,n)=>{const r=dZ(e,t.start,n),i=dZ(e,t.end,t.start.sheet);return void 0===r||void 0===i?void 0:`${r}${GQ}${i}`})(this.sheetMapping.fetchDisplayName,e,n)}getCellDependents(e){let t;if(I4(e))t=this._dependencyGraph.addressMapping.getCell(e);else{if(!P4(e))throw new C9("SimpleCellAddress | SimpleCellRange",e);t=this._dependencyGraph.rangeMapping.getRange(e.start,e.end)}return void 0===t?[]:this._dependencyGraph.getAdjacentNodesAddresses(t)}getCellPrecedents(e){let t;if(I4(e))t=this._dependencyGraph.addressMapping.getCell(e);else{if(!P4(e))throw new C9("SimpleCellAddress | SimpleCellRange",e);t=this._dependencyGraph.rangeMapping.getRange(e.start,e.end)}return void 0===t?[]:this._dependencyGraph.dependencyQueryAddresses(t)}getSheetName(e){return p5(e,"number","sheetId"),this.sheetMapping.getDisplayName(e)}getSheetNames(){return this.sheetMapping.sheetNames()}getSheetId(e){return p5(e,"string","sheetName"),this.sheetMapping.get(e)}doesSheetExist(e){return p5(e,"string","sheetName"),this.sheetMapping.hasSheetWithName(e)}getCellType(e){if(!I4(e))throw new C9("SimpleCellAddress","cellAddress");return((e,t)=>e instanceof W9?e.isLeftCorner(t)?n4.ARRAYFORMULA:n4.ARRAY:e instanceof j9||e instanceof h4?n4.FORMULA:e instanceof l4?n4.VALUE:n4.EMPTY)(this.dependencyGraph.getCell(e),e)}doesCellHaveSimpleValue(e){if(!I4(e))throw new C9("SimpleCellAddress","cellAddress");return this.getCellType(e)===n4.VALUE}doesCellHaveFormula(e){if(!I4(e))throw new C9("SimpleCellAddress","cellAddress");const t=this.getCellType(e);return t===n4.FORMULA||t===n4.ARRAYFORMULA}isCellEmpty(e){if(!I4(e))throw new C9("SimpleCellAddress","cellAddress");return this.getCellType(e)===n4.EMPTY}isCellPartOfArray(e){if(!I4(e))throw new C9("SimpleCellAddress","cellAddress");const t=this.getCellType(e);return t===n4.ARRAY||t===n4.ARRAYFORMULA}getCellValueType(e){if(!I4(e))throw new C9("SimpleCellAddress","cellAddress");this.ensureEvaluationIsNotSuspended();const t=this.dependencyGraph.getCellValue(e);return w4(t)}getCellValueDetailedType(e){if(!I4(e))throw new C9("SimpleCellAddress","cellAddress");this.ensureEvaluationIsNotSuspended();const t=this.dependencyGraph.getCellValue(e);return y4(t)}getCellValueFormat(e){if(!I4(e))throw new C9("SimpleCellAddress","cellAddress");this.ensureEvaluationIsNotSuspended();const t=this.dependencyGraph.getCellValue(e);return v4(t)}countSheets(){return this.sheetMapping.numberOfSheets()}isItPossibleToRenameSheet(e,t){p5(e,"number","sheetId"),p5(t,"string","newName");try{return this._crudOperations.ensureItIsPossibleToRenameSheet(e,t),!0}catch(n){return!1}}renameSheet(e,t){p5(e,"number","sheetId"),p5(t,"string","newName");const n=this._crudOperations.renameSheet(e,t);void 0!==n&&this._emitter.emit(U8.SheetRenamed,n,t)}batch(e){this.suspendEvaluation(),this._crudOperations.beginUndoRedoBatchMode();try{e()}catch(t){throw this._crudOperations.commitUndoRedoBatchMode(),this.resumeEvaluation(),t}return this._crudOperations.commitUndoRedoBatchMode(),this.resumeEvaluation()}suspendEvaluation(){this._evaluationSuspended=!0,this._emitter.emit(U8.EvaluationSuspended)}resumeEvaluation(){this._evaluationSuspended=!1;const e=this.recomputeIfDependencyGraphNeedsIt();return this._emitter.emit(U8.EvaluationResumed,e),e}isEvaluationSuspended(){return this._evaluationSuspended}isItPossibleToAddNamedExpression(e,t,n){p5(e,"string","expressionName"),void 0!==n&&p5(n,"number","scope");try{return this._crudOperations.ensureItIsPossibleToAddNamedExpression(e,t,n),!0}catch(r){return!1}}addNamedExpression(e,t,n,r){p5(e,"string","expressionName"),void 0!==n&&p5(n,"number","scope"),this._crudOperations.addNamedExpression(e,t,n,r);const i=this.recomputeIfDependencyGraphNeedsIt();return this._emitter.emit(U8.NamedExpressionAdded,e,i),i}getNamedExpressionValue(e,t){p5(e,"string","expressionName"),void 0!==t&&p5(t,"number","scope"),this.ensureEvaluationIsNotSuspended(),this._crudOperations.ensureScopeIdIsValid(t);const n=this._namedExpressions.namedExpressionForScope(e,t);return n?this._serialization.getCellValue(n.address):void 0}getNamedExpressionFormula(e,t){p5(e,"string","expressionName"),void 0!==t&&p5(t,"number","scope"),this._crudOperations.ensureScopeIdIsValid(t);const n=this._namedExpressions.namedExpressionForScope(e,t);return void 0===n?void 0:this._serialization.getCellFormula(n.address)}getNamedExpression(e,t){p5(e,"string","expressionName"),void 0!==t&&p5(t,"number","scope");const n=this._namedExpressions.namedExpressionForScope(e,t);if(void 0===n)return;return{name:e,scope:t,expression:this._serialization.getCellFormula(n.address),options:n.options}}isItPossibleToChangeNamedExpression(e,t,n){p5(e,"string","expressionName"),void 0!==n&&p5(n,"number","scope");try{return this._crudOperations.ensureItIsPossibleToChangeNamedExpression(e,t,n),!0}catch(r){return!1}}changeNamedExpression(e,t,n,r){return p5(e,"string","expressionName"),void 0!==n&&p5(n,"number","scope"),this._crudOperations.changeNamedExpressionExpression(e,n,t,r),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToRemoveNamedExpression(e,t){p5(e,"string","expressionName"),void 0!==t&&p5(t,"number","scope");try{return this._crudOperations.isItPossibleToRemoveNamedExpression(e,t),!0}catch(n){return!1}}removeNamedExpression(e,t){p5(e,"string","expressionName"),void 0!==t&&p5(t,"number","scope");const n=this._crudOperations.removeNamedExpression(e,t);if(n){const e=this.recomputeIfDependencyGraphNeedsIt();return this._emitter.emit(U8.NamedExpressionRemoved,n.displayName,e),e}return[]}listNamedExpressions(e){return void 0!==e&&p5(e,"number","scope"),this._crudOperations.ensureScopeIdIsValid(e),this._namedExpressions.getAllNamedExpressionsNamesInScope(e)}getAllNamedExpressionsSerialized(){return this._serialization.getAllNamedExpressionsSerialized()}normalizeFormula(e){p5(e,"string","formulaString");const{ast:t,address:n}=this.extractTemporaryFormula(e);if(void 0===t)throw new l9;return this._unparser.unparse(t,n)}calculateFormula(e,t){p5(e,"string","formulaString"),p5(t,"number","sheetId"),this._crudOperations.ensureScopeIdIsValid(t);const{ast:n,address:r,dependencies:i}=this.extractTemporaryFormula(e,t);if(void 0===n)throw new l9;const o=this.evaluator.runAndForget(n,r,i);return this._exporter.exportScalarOrRange(o)}getNamedExpressionsFromFormula(e){p5(e,"string","formulaString");const{ast:t,dependencies:n}=this.extractTemporaryFormula(e);if(void 0===t)throw new l9;const r=n.filter((e=>e instanceof F3)).map((e=>e.name));return[...new Set(r)]}validateFormula(e){p5(e,"string","formulaString");const{ast:t}=this.extractTemporaryFormula(e);return void 0!==t}getRegisteredFunctionNames(){return j8.getLanguage(this._config.language).getFunctionTranslations(this._functionRegistry.getRegisteredFunctionIds())}getFunctionPlugin(e){return p5(e,"string","functionId"),this._functionRegistry.getFunctionPlugin(e)}getAllFunctionPlugins(){return this._functionRegistry.getPlugins()}numberToDateTime(e){return p5(e,"number","val"),this._evaluator.interpreter.dateTimeHelper.numberToSimpleDateTime(e)}numberToDate(e){return p5(e,"number","val"),this._evaluator.interpreter.dateTimeHelper.numberToSimpleDate(e)}numberToTime(e){return p5(e,"number","val"),H5(e)}on(e,t){this._emitter.on(e,t)}once(e,t){this._emitter.once(e,t)}off(e,t){this._emitter.off(e,t)}destroy(){!function(e){for(const[t,n]of Object.entries(e))n instanceof Function?e[t]=F8(n):delete e[t]}(this)}ensureEvaluationIsNotSuspended(){if(this._evaluationSuspended)throw new T9}extractTemporaryFormula(e,t=1){const n=this._cellContentParser.parse(e),r={sheet:t,col:0,row:0};if(!(n instanceof s6.Formula))return{address:r,dependencies:[]};const{ast:i,errors:o,dependencies:s}=this._parser.parse(n.formula,r);return o.length>0?{address:r,dependencies:[]}:{ast:i,address:r,dependencies:s}}rebuildWithConfig(e){const t=this._config.mergeConfig(e),n=this._config.mergeConfig({language:e.language}),r=this._serialization.withNewConfig(n,this._namedExpressions).getAllSheetsSerialized(),i=this._serialization.getAllNamedExpressionsSerialized(),o=k8.rebuildWithConfig(t,r,i,this._stats);this._config=o.config,this._stats=o.stats,this._dependencyGraph=o.dependencyGraph,this._columnSearch=o.columnSearch,this._parser=o.parser,this._unparser=o.unparser,this._cellContentParser=o.cellContentParser,this._evaluator=o.evaluator,this._lazilyTransformingAstService=o.lazilyTransformingAstService,this._crudOperations=o.crudOperations,this._exporter=o.exporter,this._namedExpressions=o.namedExpressions,this._serialization=o.serialization,this._functionRegistry=o.functionRegistry}recomputeIfDependencyGraphNeedsIt(){if(this._evaluationSuspended)return[];{const e=this._crudOperations.getAndClearContentChanges(),t=this.dependencyGraph.verticesToRecompute();this.dependencyGraph.clearDirtyVertices(),t.length>0&&e.addAll(this.evaluator.partialRun(t));const n=e.exportChanges(this._exporter);return e.isEmpty()||this._emitter.emit(U8.ValuesUpdated,n),n}}}j8.version="3.0.0",j8.buildDate="14/01/2025 11:44:17",j8.releaseDate="14/01/2025",j8.languages={},j8.registeredLanguages=new Map;
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
const G8=new WeakMap;class z8{constructor(e={},t=!0){const{accentSensitive:n,caseSensitive:r,caseFirst:i,chooseAddressMappingPolicy:o,context:s,currencySymbol:a,dateFormats:l,decimalSeparator:h,evaluateNullToZero:u,functionArgSeparator:c,functionPlugins:d,ignorePunctuation:p,leapYear1900:g,localeLang:m,language:f,ignoreWhiteSpace:w,licenseKey:y,matchWholeCell:v,arrayColumnSeparator:C,arrayRowSeparator:S,maxRows:R,maxColumns:E,nullYear:b,nullDate:T,parseDateTime:N,precisionEpsilon:A,precisionRounding:M,stringifyDateTime:I,stringifyDuration:O,smartRounding:x,timeFormats:P,thousandSeparator:_,useArrayArithmetic:L,useStats:H,undoLimit:k,useColumnIndex:F,useRegularExpressions:D,useWildcards:V}=e;this.useArrayArithmetic=h5(L,"boolean","useArrayArithmetic"),this.accentSensitive=h5(n,"boolean","accentSensitive"),this.caseSensitive=h5(r,"boolean","caseSensitive"),this.caseFirst=h5(i,["upper","lower","false"],"caseFirst"),this.ignorePunctuation=h5(p,"boolean","ignorePunctuation"),this.chooseAddressMappingPolicy=null!=o?o:z8.defaultConfig.chooseAddressMappingPolicy,this.dateFormats=[...c5(l,Array.isArray,"array","dateFormats")],this.timeFormats=[...c5(P,Array.isArray,"array","timeFormats")],this.functionArgSeparator=h5(c,"string","functionArgSeparator"),this.decimalSeparator=h5(h,[".",","],"decimalSeparator"),this.language=h5(f,"string","language"),this.ignoreWhiteSpace=h5(w,["standard","any"],"ignoreWhiteSpace"),this.licenseKey=h5(y,"string","licenseKey"),this.thousandSeparator=h5(_,["",","," ","."],"thousandSeparator"),this.arrayColumnSeparator=h5(C,[",",";"],"arrayColumnSeparator"),this.arrayRowSeparator=h5(S,[";","|"],"arrayRowSeparator"),this.localeLang=h5(m,"string","localeLang"),this.functionPlugins=[...null!=d?d:z8.defaultConfig.functionPlugins],this.smartRounding=h5(x,"boolean","smartRounding"),this.evaluateNullToZero=h5(u,"boolean","evaluateNullToZero"),this.nullYear=h5(b,"number","nullYear"),u5(this.nullYear,"nullYear",0),function(e,t,n){if(e>n)throw new E9(t,n)}(this.nullYear,"nullYear",100),this.precisionRounding=h5(M,"number","precisionRounding"),u5(this.precisionRounding,"precisionRounding",0),this.precisionEpsilon=h5(A,"number","precisionEpsilon"),u5(this.precisionEpsilon,"precisionEpsilon",0),this.useColumnIndex=h5(F,"boolean","useColumnIndex"),this.useStats=h5(H,"boolean","useStats"),this.parseDateTime=h5(N,"function","parseDateTime"),this.stringifyDateTime=h5(I,"function","stringifyDateTime"),this.stringifyDuration=h5(O,"function","stringifyDuration"),this.translationPackage=j8.getLanguage(this.language),this.errorMapping=this.translationPackage.buildErrorMapping(),this.nullDate=c5(T,I5,"IDate","nullDate"),this.leapYear1900=h5(g,"boolean","leapYear1900"),this.undoLimit=h5(k,"number","undoLimit"),this.useRegularExpressions=h5(D,"boolean","useRegularExpressions"),this.useWildcards=h5(V,"boolean","useWildcards"),this.matchWholeCell=h5(v,"boolean","matchWholeCell"),u5(this.undoLimit,"undoLimit",0),this.maxRows=h5(R,"number","maxRows"),u5(this.maxRows,"maxRows",1),this.maxColumns=h5(E,"number","maxColumns"),this.currencySymbol=this.setupCurrencySymbol(a),u5(this.maxColumns,"maxColumns",1),this.context=s,G8.set(this,{licenseKeyValidityState:o6(this.licenseKey)}),d5({value:this.decimalSeparator,name:"decimalSeparator"},{value:this.functionArgSeparator,name:"functionArgSeparator"},{value:this.thousandSeparator,name:"thousandSeparator"}),d5({value:this.arrayRowSeparator,name:"arrayRowSeparator"},{value:this.arrayColumnSeparator,name:"arrayColumnSeparator"})}setupCurrencySymbol(e){const t=[...c5(e,Array.isArray,"array","currencySymbol")];return t.forEach((e=>{if("string"!=typeof e)throw new C9("string[]","currencySymbol");if(""===e)throw new S9("currencySymbol")})),t}get licenseKeyValidityState(){return G8.get(this).licenseKeyValidityState}getConfig(){return $8(this)}mergeConfig(e){const t=Object.assign({},this.getConfig(),e);return new z8(t,!1)}static warnDeprecatedOptions(e){}static warnDeprecatedIfUsed(e,t,n,r){void 0!==e&&(void 0===r?console.warn(`${t} option is deprecated since ${n}`):console.warn(`${t} option is deprecated since ${n}, please use ${r}`))}}function $8(e){var t;const n={};for(const r in z8.defaultConfig){const i=null!==(t=e[r])&&void 0!==t?t:z8.defaultConfig[r];Array.isArray(i)?n[r]=[...i]:n[r]=i}return n}z8.defaultConfig={accentSensitive:!1,currencySymbol:["$"],caseSensitive:!1,caseFirst:"lower",context:void 0,chooseAddressMappingPolicy:new class{call(){return c4}},dateFormats:["DD/MM/YYYY","DD/MM/YY"],decimalSeparator:".",evaluateNullToZero:!1,functionArgSeparator:",",functionPlugins:[],ignorePunctuation:!1,language:"enGB",ignoreWhiteSpace:"standard",licenseKey:"",leapYear1900:!1,localeLang:"en",matchWholeCell:!0,arrayColumnSeparator:",",arrayRowSeparator:";",maxRows:4e4,maxColumns:18278,nullYear:30,nullDate:{year:1899,month:12,day:30},parseDateTime:function(e,t,n){if(void 0===t&&void 0===n)return;let r=e.replace(f5," ").trim().toLowerCase();if(!function(e){return m5.test(e)}(r))return;let i=r.substring(r.length-2);"am"===i||"pm"===i?r=r.substring(0,r.length-2).trim():(i=r.substring(r.length-1),"a"===i||"p"===i?r=r.substring(0,r.length-1).trim():i=void 0);const o=r.split(w5);o.length>=2&&o[o.length-2].includes(":")&&(o[o.length-2]=o[o.length-2]+"."+o[o.length-1],o.pop());const s=o[o.length-1].split(":");if(void 0!==i&&s.push(i),1===o.length)return S5(s,n);if(1===s.length)return R5(o,t);const a=R5(o.slice(0,o.length-1),t),l=S5(s,n);return void 0===a||void 0===l?void 0:Object.assign(Object.assign({},a),l)},precisionEpsilon:1e-13,precisionRounding:10,smartRounding:!0,stringifyDateTime:function(e,t){const n=G5(t);if(void 0===n)return;const r=n.tokens;let i="",o=!1;const s=r.some((e=>e.type===U5.FORMAT&&("a/p"===e.value||"A/P"===e.value||"am/pm"===e.value||"AM/PM"===e.value)));for(let a=0;a<r.length;a++){const t=r[a];if(t.type!==U5.FREE_TEXT)switch(t.value.toLowerCase()){case"h":case"hh":o=!0,i+=K5(s?(e.hours+11)%12+1:e.hours,t.value.length);break;case"d":case"dd":i+=K5(e.day,t.value.length);break;case"s":case"ss":i+=K5(Math.floor(e.seconds),t.value.length);break;case"m":case"mm":a+1<r.length&&r[a+1].value.startsWith(":")&&(o=!0),i+=K5(o?e.minutes:e.month,t.value.length),o=!0;break;case"yy":i+=K5(e.year%100,t.value.length);break;case"yyyy":i+=e.year;break;case"am/pm":case"a/p":{const[n,r]=t.value.split("/");i+=e.hours<12?n:r;break}default:if(g5.test(t.value)){const n=t.value.length-3;i+=`${e.seconds<10?"0":""}${Math.floor(e.seconds*Math.pow(10,n))/Math.pow(10,n)}`;continue}return}else i+=t.value}return i},stringifyDuration:function(e,t){const n=G5(t);if(void 0===n)return;const r=n.tokens;let i="";for(const o of r)if(o.type!==U5.FREE_TEXT)switch(o.value.toLowerCase()){case"h":case"hh":i+=K5(e.hours,o.value.length),e.hours=0;break;case"[hh]":i+=K5(e.hours,o.value.length-2),e.hours=0;break;case"m":case"mm":i+=K5(e.minutes,o.value.length),e.minutes=0;break;case"[mm]":i+=K5(e.minutes+60*e.hours,o.value.length-2),e.minutes=0,e.hours=0;break;case"s":case"ss":i+=K5(Math.floor(e.seconds),o.value.length);break;default:if(g5.test(o.value)){const t=Math.max(o.value.length-3,0);i+=`${e.seconds<10?"0":""}${Math.floor(e.seconds*Math.pow(10,t))/Math.pow(10,t)}`;continue}return}else i+=o.value;return i},timeFormats:["hh:mm","hh:mm:ss.sss"],thousandSeparator:"",undoLimit:20,useRegularExpressions:!1,useWildcards:!0,useColumnIndex:!1,useStats:!1,useArrayArithmetic:!1};
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
const Y8={errors:{CYCLE:"#CYCLE!",DIV_BY_ZERO:"#DIV/0!",ERROR:"#ERROR!",NA:"#N/A",NAME:"#NAME?",NUM:"#NUM!",REF:"#REF!",SPILL:"#SPILL!",VALUE:"#VALUE!"},functions:{FILTER:"FILTER",ADDRESS:"ADDRESS",ARRAY_CONSTRAIN:"ARRAY_CONSTRAIN",ARRAYFORMULA:"ARRAYFORMULA",ABS:"ABS",ACOS:"ACOS",ACOSH:"ACOSH",ACOT:"ACOT",ACOTH:"ACOTH",AND:"AND",ARABIC:"ARABIC",ASIN:"ASIN",ASINH:"ASINH",ATAN2:"ATAN2",ATAN:"ATAN",ATANH:"ATANH",AVERAGE:"AVERAGE",AVERAGEA:"AVERAGEA",AVERAGEIF:"AVERAGEIF",BASE:"BASE",BIN2DEC:"BIN2DEC",BIN2HEX:"BIN2HEX",BIN2OCT:"BIN2OCT",BITAND:"BITAND",BITLSHIFT:"BITLSHIFT",BITOR:"BITOR",BITRSHIFT:"BITRSHIFT",BITXOR:"BITXOR",CEILING:"CEILING",CHAR:"CHAR",CHOOSE:"CHOOSE",CLEAN:"CLEAN",CODE:"CODE",COLUMN:"COLUMN",COLUMNS:"COLUMNS",CONCATENATE:"CONCATENATE",CORREL:"CORREL",COS:"COS",COSH:"COSH",COT:"COT",COTH:"COTH",COUNT:"COUNT",COUNTA:"COUNTA",COUNTBLANK:"COUNTBLANK",COUNTIF:"COUNTIF",COUNTIFS:"COUNTIFS",COUNTUNIQUE:"COUNTUNIQUE",CSC:"CSC",CSCH:"CSCH",CUMIPMT:"CUMIPMT",CUMPRINC:"CUMPRINC",DATE:"DATE",DATEDIF:"DATEDIF",DATEVALUE:"DATEVALUE",DAY:"DAY",DAYS360:"DAYS360",DAYS:"DAYS",DB:"DB",DDB:"DDB",DEC2BIN:"DEC2BIN",DEC2HEX:"DEC2HEX",DEC2OCT:"DEC2OCT",DECIMAL:"DECIMAL",DEGREES:"DEGREES",DELTA:"DELTA",DOLLARDE:"DOLLARDE",DOLLARFR:"DOLLARFR",EDATE:"EDATE",EFFECT:"EFFECT",EOMONTH:"EOMONTH",ERF:"ERF",ERFC:"ERFC",EVEN:"EVEN",EXACT:"EXACT",EXP:"EXP",FALSE:"FALSE",FIND:"FIND",FORMULATEXT:"FORMULATEXT",FV:"FV",FVSCHEDULE:"FVSCHEDULE",HEX2BIN:"HEX2BIN",HEX2DEC:"HEX2DEC",HEX2OCT:"HEX2OCT",HLOOKUP:"HLOOKUP",HOUR:"HOUR",HYPERLINK:"HYPERLINK",IF:"IF",IFERROR:"IFERROR",IFNA:"IFNA",IFS:"IFS",INDEX:"INDEX",INT:"INT",INTERVAL:"INTERVAL",IPMT:"IPMT",ISBINARY:"ISBINARY",ISBLANK:"ISBLANK",ISERR:"ISERR",ISERROR:"ISERROR",ISEVEN:"ISEVEN",ISFORMULA:"ISFORMULA",ISLOGICAL:"ISLOGICAL",ISNA:"ISNA",ISNONTEXT:"ISNONTEXT",ISNUMBER:"ISNUMBER",ISODD:"ISODD",ISOWEEKNUM:"ISOWEEKNUM",ISPMT:"ISPMT",ISREF:"ISREF",ISTEXT:"ISTEXT",LEFT:"LEFT",LEN:"LEN",LN:"LN",LOG10:"LOG10",LOG:"LOG",LOWER:"LOWER",MATCH:"MATCH",MAX:"MAX",MAXA:"MAXA",MAXIFS:"MAXIFS",MAXPOOL:"MAXPOOL",MEDIAN:"MEDIAN",MEDIANPOOL:"MEDIANPOOL",MID:"MID",MIN:"MIN",MINA:"MINA",MINIFS:"MINIFS",MINUTE:"MINUTE",MIRR:"MIRR",MMULT:"MMULT",MOD:"MOD",MONTH:"MONTH",NA:"NA",NETWORKDAYS:"NETWORKDAYS","NETWORKDAYS.INTL":"NETWORKDAYS.INTL",NOMINAL:"NOMINAL",NOT:"NOT",NOW:"NOW",NPER:"NPER",NPV:"NPV",OCT2BIN:"OCT2BIN",OCT2DEC:"OCT2DEC",OCT2HEX:"OCT2HEX",ODD:"ODD",OFFSET:"OFFSET",OR:"OR",PI:"PI",PMT:"PMT",PDURATION:"PDURATION",PRODUCT:"PRODUCT",POWER:"POWER",PPMT:"PPMT",PROPER:"PROPER",PV:"PV",RADIANS:"RADIANS",RAND:"RAND",RATE:"RATE",REPLACE:"REPLACE",REPT:"REPT",RIGHT:"RIGHT",ROMAN:"ROMAN",ROUND:"ROUND",ROUNDDOWN:"ROUNDDOWN",ROUNDUP:"ROUNDUP",ROW:"ROW",ROWS:"ROWS",RRI:"RRI",SEARCH:"SEARCH",SEC:"SEC",SECH:"SECH",SECOND:"SECOND",SHEET:"SHEET",SHEETS:"SHEETS",SIN:"SIN",SINH:"SINH",SLN:"SLN",SPLIT:"SPLIT",SQRT:"SQRT",STDEVA:"STDEVA","STDEV.P":"STDEV.P",STDEVPA:"STDEVPA","STDEV.S":"STDEV.S",SUBSTITUTE:"SUBSTITUTE",SUBTOTAL:"SUBTOTAL",SUM:"SUM",SUMIF:"SUMIF",SUMIFS:"SUMIFS",SUMPRODUCT:"SUMPRODUCT",SUMSQ:"SUMSQ",SWITCH:"SWITCH",SYD:"SYD",T:"T",TAN:"TAN",TANH:"TANH",TBILLEQ:"TBILLEQ",TBILLPRICE:"TBILLPRICE",TBILLYIELD:"TBILLYIELD",TEXT:"TEXT",TIME:"TIME",TIMEVALUE:"TIMEVALUE",TODAY:"TODAY",TRANSPOSE:"TRANSPOSE",TRIM:"TRIM",TRUE:"TRUE",TRUNC:"TRUNC",UNICHAR:"UNICHAR",UNICODE:"UNICODE",UPPER:"UPPER",VARA:"VARA","VAR.P":"VAR.P",VARPA:"VARPA","VAR.S":"VAR.S",VLOOKUP:"VLOOKUP",WEEKDAY:"WEEKDAY",WEEKNUM:"WEEKNUM",WORKDAY:"WORKDAY","WORKDAY.INTL":"WORKDAY.INTL",XNPV:"XNPV",XOR:"XOR",XLOOKUP:"XLOOKUP",YEAR:"YEAR",YEARFRAC:"YEARFRAC","HF.ADD":"HF.ADD","HF.CONCAT":"HF.CONCAT","HF.DIVIDE":"HF.DIVIDE","HF.EQ":"HF.EQ","HF.GT":"HF.GT","HF.GTE":"HF.GTE","HF.LT":"HF.LT","HF.LTE":"HF.LTE","HF.MINUS":"HF.MINUS","HF.MULTIPLY":"HF.MULTIPLY","HF.NE":"HF.NE","HF.POW":"HF.POW","HF.UMINUS":"HF.UMINUS","HF.UNARY_PERCENT":"HF.UNARY_PERCENT","HF.UPLUS":"HF.UPLUS",VARP:"VARP",VAR:"VAR",STDEVP:"STDEVP",STDEV:"STDEV","EXPON.DIST":"EXPON.DIST",FISHER:"FISHER",FISHERINV:"FISHERINV",GAMMA:"GAMMA","GAMMA.DIST":"GAMMA.DIST",GAMMALN:"GAMMALN","GAMMALN.PRECISE":"GAMMALN.PRECISE","GAMMA.INV":"GAMMA.INV",GAUSS:"GAUSS",FACT:"FACT",FACTDOUBLE:"FACTDOUBLE",COMBIN:"COMBIN",COMBINA:"COMBINA",GCD:"GCD",LCM:"LCM",MROUND:"MROUND",MULTINOMIAL:"MULTINOMIAL",QUOTIENT:"QUOTIENT",RANDBETWEEN:"RANDBETWEEN",SERIESSUM:"SERIESSUM",SIGN:"SIGN",SQRTPI:"SQRTPI",SUMX2MY2:"SUMX2MY2",SUMX2PY2:"SUMX2PY2",SUMXMY2:"SUMXMY2",EXPONDIST:"EXPONDIST",GAMMADIST:"GAMMADIST",GAMMAINV:"GAMMAINV","BETA.DIST":"BETA.DIST",BETADIST:"BETADIST","BETA.INV":"BETA.INV",BETAINV:"BETAINV","BINOM.DIST":"BINOM.DIST",BINOMDIST:"BINOMDIST","BINOM.INV":"BINOM.INV",BESSELI:"BESSELI",BESSELJ:"BESSELJ",BESSELK:"BESSELK",BESSELY:"BESSELY","CHISQ.DIST":"CHISQ.DIST","CHISQ.DIST.RT":"CHISQ.DIST.RT","CHISQ.INV":"CHISQ.INV","CHISQ.INV.RT":"CHISQ.INV.RT",CHIDIST:"CHIDIST",CHIINV:"CHIINV","F.DIST":"F.DIST","F.DIST.RT":"F.DIST.RT","F.INV":"F.INV","F.INV.RT":"F.INV.RT",FDIST:"FDIST",FINV:"FINV",WEIBULL:"WEIBULL","WEIBULL.DIST":"WEIBULL.DIST",POISSON:"POISSON","POISSON.DIST":"POISSON.DIST","HYPGEOM.DIST":"HYPGEOM.DIST",HYPGEOMDIST:"HYPGEOMDIST","T.DIST":"T.DIST","T.DIST.2T":"T.DIST.2T","T.DIST.RT":"T.DIST.RT","T.INV":"T.INV","T.INV.2T":"T.INV.2T",TDIST:"TDIST",TINV:"TINV",LOGINV:"LOGINV","LOGNORM.DIST":"LOGNORM.DIST","LOGNORM.INV":"LOGNORM.INV",LOGNORMDIST:"LOGNORMDIST","NORM.DIST":"NORM.DIST","NORM.INV":"NORM.INV","NORM.S.DIST":"NORM.S.DIST","NORM.S.INV":"NORM.S.INV",NORMDIST:"NORMDIST",NORMINV:"NORMINV",NORMSDIST:"NORMSDIST",NORMSINV:"NORMSINV",PHI:"PHI","NEGBINOM.DIST":"NEGBINOM.DIST",NEGBINOMDIST:"NEGBINOMDIST",COMPLEX:"COMPLEX",IMABS:"IMABS",IMAGINARY:"IMAGINARY",IMARGUMENT:"IMARGUMENT",IMCONJUGATE:"IMCONJUGATE",IMCOS:"IMCOS",IMCOSH:"IMCOSH",IMCOT:"IMCOT",IMCSC:"IMCSC",IMCSCH:"IMCSCH",IMDIV:"IMDIV",IMEXP:"IMEXP",IMLN:"IMLN",IMLOG10:"IMLOG10",IMLOG2:"IMLOG2",IMPOWER:"IMPOWER",IMPRODUCT:"IMPRODUCT",IMREAL:"IMREAL",IMSEC:"IMSEC",IMSECH:"IMSECH",IMSIN:"IMSIN",IMSINH:"IMSINH",IMSQRT:"IMSQRT",IMSUB:"IMSUB",IMSUM:"IMSUM",IMTAN:"IMTAN",LARGE:"LARGE",SMALL:"SMALL",AVEDEV:"AVEDEV",CONFIDENCE:"CONFIDENCE","CONFIDENCE.NORM":"CONFIDENCE.NORM","CONFIDENCE.T":"CONFIDENCE.T",DEVSQ:"DEVSQ",GEOMEAN:"GEOMEAN",HARMEAN:"HARMEAN",CRITBINOM:"CRITBINOM","COVARIANCE.P":"COVARIANCE.P","COVARIANCE.S":"COVARIANCE.S",COVAR:"COVAR",PEARSON:"PEARSON",RSQ:"RSQ",STANDARDIZE:"STANDARDIZE","Z.TEST":"Z.TEST",ZTEST:"ZTEST","F.TEST":"F.TEST",FTEST:"FTEST",STEYX:"STEYX",SLOPE:"SLOPE","CHISQ.TEST":"CHISQ.TEST",CHITEST:"CHITEST","T.TEST":"T.TEST",TTEST:"TTEST",SKEW:"SKEW","SKEW.P":"SKEW.P",WEIBULLDIST:"WEIBULLDIST",VARS:"VARS",TINV2T:"TINV2T",TDISTRT:"TDISTRT",TDIST2T:"TDIST2T",STDEVS:"STDEVS",FINVRT:"FINVRT",FDISTRT:"FDISTRT",CHIDISTRT:"CHIDISTRT",CHIINVRT:"CHIINVRT",COVARIANCEP:"COVARIANCEP",COVARIANCES:"COVARIANCES",LOGNORMINV:"LOGNORMINV",POISSONDIST:"POISSONDIST",SKEWP:"SKEWP","CEILING.MATH":"CEILING.MATH",FLOOR:"FLOOR","FLOOR.MATH":"FLOOR.MATH","CEILING.PRECISE":"CEILING.PRECISE","FLOOR.PRECISE":"FLOOR.PRECISE","ISO.CEILING":"ISO.CEILING"},langCode:"enGB",ui:{NEW_SHEET_PREFIX:"Sheet"}};
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */var K8;!function(e){e[e.FullyAbsolute=1]="FullyAbsolute",e[e.RowAbsoluteColRelative=2]="RowAbsoluteColRelative",e[e.RowRelativeColAbsolute=3]="RowRelativeColAbsolute",e[e.FullyRelative=4]="FullyRelative"}(K8||(K8={}));class X8 extends o5{verifyAddressArguments(e,t,n,r){if(r){if(e<1||t<1)return new C4(t4.VALUE,K2.LessThanOne)}else if(K8.FullyAbsolute==n){if(e<1||t<1)return new C4(t4.VALUE,K2.LessThanOne)}else if(K8.RowAbsoluteColRelative==n){if(e<1)return new C4(t4.VALUE,K2.LessThanOne)}else if(K8.RowRelativeColAbsolute==n&&t<1)return new C4(t4.VALUE,K2.LessThanOne)}address(e,t){return this.runFunction(e.args,t,this.metadata("ADDRESS"),((e,t,n,r,i)=>{const o=this.verifyAddressArguments(e,t,n,r);if(void 0!==o)return o;const s=gZ(t-1);let a="";null!=i&&(a=`${i}!`);const l=0==t?"C":`C[${t}]`,h=0==e?"R":`R[${e}]`;return K8.FullyRelative==n?r?`${a}${s}${e}`:`${a}${h}${l}`:K8.RowRelativeColAbsolute==n?r?`${a}$${s}${e}`:`${a}${h}C${t}`:K8.RowAbsoluteColRelative==n?r?`${a}${s}$${e}`:`${a}R${e}${l}`:r?`${a}$${s}$${e}`:`${a}R${e}C${t}`}))}}X8.implementedFunctions={ADDRESS:{method:"address",parameters:[{argumentType:i5.NUMBER},{argumentType:i5.NUMBER},{argumentType:i5.NUMBER,optionalArg:!0,defaultValue:1,minValue:1,maxValue:4},{argumentType:i5.BOOLEAN,optionalArg:!0,defaultValue:!0},{argumentType:i5.STRING,optionalArg:!0}]}};
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
class q8 extends o5{arrayformula(e,t){return this.runFunction(e.args,t,this.metadata("ARRAYFORMULA"),(e=>e))}arrayformulaArraySize(e,t){if(1!==e.args.length)return s5.error();const n=this.metadata("ARRAYFORMULA");return e.args.map((e=>{var r;return this.arraySizeForAst(e,new F4(t.formulaAddress,t.arraysFlag||null!==(r=null==n?void 0:n.arrayFunction)&&void 0!==r&&r))}))[0]}arrayconstrain(e,t){return this.runFunction(e.args,t,this.metadata("ARRAY_CONSTRAIN"),((e,t,n)=>{t=Math.min(t,e.height()),n=Math.min(n,e.width());const r=e.data,i=[];for(let o=0;o<t;o++)i.push(r[o].slice(0,n));return Z3.onlyValues(i)}))}arrayconstrainArraySize(e,t){if(3!==e.args.length)return s5.error();const n=this.metadata("ARRAY_CONSTRAIN"),r=e.args.map((e=>{var r;return this.arraySizeForAst(e,new F4(t.formulaAddress,t.arraysFlag||null!==(r=null==n?void 0:n.arrayFunction)&&void 0!==r&&r))}));let{height:i,width:o}=r[0];return e.args[1].type===H2.NUMBER&&(i=Math.min(i,e.args[1].value)),e.args[2].type===H2.NUMBER&&(o=Math.min(o,e.args[2].value)),i<1||o<1||!Number.isInteger(i)||!Number.isInteger(o)?s5.error():new s5(o,i)}filter(e,t){return this.runFunction(e.args,t,this.metadata("FILTER"),((e,...t)=>{for(const i of t)if(e.width()!==i.width()||e.height()!==i.height())return new C4(t4.NA,K2.EqualLength);if(e.width()>1&&e.height()>1)return new C4(t4.NA,K2.WrongDimension);const n=e.data,r=[];for(let i=0;i<e.height();i++){const o=[];for(let r=0;r<e.width();r++){let e=!0;for(const n of t){if(!0!==G4(n.data[i][r])){e=!1;break}}e&&o.push(n[i][r])}o.length>0&&r.push(o)}return r.length>0?Z3.onlyValues(r):new C4(t4.NA,K2.EmptyRange)}))}filterArraySize(e,t){if(e.args.length<=1)return s5.error();const n=this.metadata("FILTER"),r=e.args.map((e=>{var r;return this.arraySizeForAst(e,new F4(t.formulaAddress,t.arraysFlag||null!==(r=null==n?void 0:n.arrayFunction)&&void 0!==r&&r))})),i=Math.max(...r.map((e=>e.width))),o=Math.max(...r.map((e=>e.height)));return new s5(i,o)}}q8.implementedFunctions={ARRAYFORMULA:{method:"arrayformula",arraySizeMethod:"arrayformulaArraySize",arrayFunction:!0,parameters:[{argumentType:i5.ANY}]},ARRAY_CONSTRAIN:{method:"arrayconstrain",arraySizeMethod:"arrayconstrainArraySize",parameters:[{argumentType:i5.RANGE},{argumentType:i5.INTEGER,minValue:1},{argumentType:i5.INTEGER,minValue:1}],vectorizationForbidden:!0},FILTER:{method:"filter",arraySizeMethod:"filterArraySize",arrayFunction:!0,parameters:[{argumentType:i5.RANGE},{argumentType:i5.RANGE}],repeatLastArgs:1}};
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
class Q8 extends o5{abs(e,t){return this.runFunction(e.args,t,this.metadata("ABS"),Math.abs)}}Q8.implementedFunctions={ABS:{method:"abs",parameters:[{argumentType:i5.NUMBER}]}};
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
const Z8=0xffffffffffff;class J8 extends o5{bitlshift(e,t){return this.runFunction(e.args,t,this.metadata("BITLSHIFT"),e7)}bitrshift(e,t){return this.runFunction(e.args,t,this.metadata("BITRSHIFT"),t7)}}function e7(e,t){return t<0?t7(e,-t):n7(e*Math.pow(2,t))}function t7(e,t){return t<0?e7(e,-t):n7(Math.floor(e/Math.pow(2,t)))}function n7(e){return e>Z8?new C4(t4.NUM,K2.BitshiftLong):e}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */J8.implementedFunctions={BITLSHIFT:{method:"bitlshift",parameters:[{argumentType:i5.INTEGER,minValue:0},{argumentType:i5.INTEGER,minValue:-53,maxValue:53}]},BITRSHIFT:{method:"bitrshift",parameters:[{argumentType:i5.INTEGER,minValue:0},{argumentType:i5.INTEGER,minValue:-53,maxValue:53}]}};class r7 extends o5{bitand(e,t){return this.runFunction(e.args,t,this.metadata("BITAND"),((e,t)=>e&t))}bitor(e,t){return this.runFunction(e.args,t,this.metadata("BITOR"),((e,t)=>e|t))}bitxor(e,t){return this.runFunction(e.args,t,this.metadata("BITXOR"),((e,t)=>e^t))}}r7.implementedFunctions={BITAND:{method:"bitand",parameters:[{argumentType:i5.INTEGER,minValue:0},{argumentType:i5.INTEGER,minValue:0}]},BITOR:{method:"bitor",parameters:[{argumentType:i5.INTEGER,minValue:0},{argumentType:i5.INTEGER,minValue:0}]},BITXOR:{method:"bitxor",parameters:[{argumentType:i5.INTEGER,minValue:0},{argumentType:i5.INTEGER,minValue:0}]}};
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
class i7 extends o5{literalTrue(e,t){return this.runFunction(e.args,t,this.metadata("TRUE"),(()=>!0))}literalFalse(e,t){return this.runFunction(e.args,t,this.metadata("FALSE"),(()=>!1))}conditionalIf(e,t){return this.runFunction(e.args,t,this.metadata("IF"),((e,t,n)=>e?t:n))}ifs(e,t){return this.runFunction(e.args,t,this.metadata("IFS"),((...e)=>{for(let t=0;t<e.length;t+=2)if(e[t])return e[t+1];return new C4(t4.NA,K2.NoConditionMet)}))}and(e,t){return this.runFunction(e.args,t,this.metadata("AND"),((...e)=>e.filter((e=>void 0!==e)).every((e=>!!e))))}or(e,t){return this.runFunction(e.args,t,this.metadata("OR"),((...e)=>e.filter((e=>void 0!==e)).some((e=>e))))}not(e,t){return this.runFunction(e.args,t,this.metadata("NOT"),(e=>!e))}xor(e,t){return this.runFunction(e.args,t,this.metadata("XOR"),((...e)=>{let t=0;return e.filter((e=>void 0!==e)).forEach((e=>{e&&t++})),t%2==1}))}switch(e,t){return this.runFunction(e.args,t,this.metadata("SWITCH"),((e,...t)=>{const n=t.length;let r=0;for(;r+1<n;r+=2)if(!(t[r]instanceof C4)&&this.arithmeticHelper.eq(e,t[r]))return t[r+1];return r<n?t[r]:new C4(t4.NA,K2.NoDefault)}))}iferror(e,t){return this.runFunction(e.args,t,this.metadata("IFERROR"),((e,t)=>e instanceof C4?t:e))}ifna(e,t){return this.runFunction(e.args,t,this.metadata("IFNA"),((e,t)=>e instanceof C4&&e.type===t4.NA?t:e))}choose(e,t){return this.runFunction(e.args,t,this.metadata("CHOOSE"),((e,...t)=>e>t.length?new C4(t4.NUM,K2.Selector):t[e-1]))}}i7.implementedFunctions={TRUE:{method:"literalTrue",parameters:[]},FALSE:{method:"literalFalse",parameters:[]},IF:{method:"conditionalIf",parameters:[{argumentType:i5.BOOLEAN},{argumentType:i5.SCALAR,passSubtype:!0},{argumentType:i5.SCALAR,defaultValue:!1,passSubtype:!0}]},IFS:{method:"ifs",parameters:[{argumentType:i5.BOOLEAN},{argumentType:i5.SCALAR,passSubtype:!0}],repeatLastArgs:2},AND:{method:"and",parameters:[{argumentType:i5.BOOLEAN}],repeatLastArgs:1,expandRanges:!0},OR:{method:"or",parameters:[{argumentType:i5.BOOLEAN}],repeatLastArgs:1,expandRanges:!0},XOR:{method:"xor",parameters:[{argumentType:i5.BOOLEAN}],repeatLastArgs:1,expandRanges:!0},NOT:{method:"not",parameters:[{argumentType:i5.BOOLEAN}]},SWITCH:{method:"switch",parameters:[{argumentType:i5.NOERROR},{argumentType:i5.SCALAR,passSubtype:!0},{argumentType:i5.SCALAR,passSubtype:!0}],repeatLastArgs:1},IFERROR:{method:"iferror",parameters:[{argumentType:i5.SCALAR,passSubtype:!0},{argumentType:i5.SCALAR,passSubtype:!0}]},IFNA:{method:"ifna",parameters:[{argumentType:i5.SCALAR,passSubtype:!0},{argumentType:i5.SCALAR,passSubtype:!0}]},CHOOSE:{method:"choose",parameters:[{argumentType:i5.INTEGER,minValue:1},{argumentType:i5.SCALAR,passSubtype:!0}],repeatLastArgs:1}};
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
class o7 extends o5{char(e,t){return this.runFunction(e.args,t,this.metadata("CHAR"),(e=>e<1||e>=256?new C4(t4.VALUE,K2.CharacterCodeBounds):String.fromCharCode(Math.trunc(e))))}unichar(e,t){return this.runFunction(e.args,t,this.metadata("CHAR"),(e=>e<1||e>=1114112?new C4(t4.VALUE,K2.CharacterCodeBounds):String.fromCodePoint(Math.trunc(e))))}}o7.implementedFunctions={CHAR:{method:"char",parameters:[{argumentType:i5.NUMBER}]},UNICHAR:{method:"unichar",parameters:[{argumentType:i5.NUMBER}]}};
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
class s7 extends o5{code(e,t){return this.runFunction(e.args,t,this.metadata("CODE"),(e=>0===e.length?new C4(t4.VALUE,K2.EmptyString):e.charCodeAt(0)))}unicode(e,t){return this.runFunction(e.args,t,this.metadata("UNICODE"),(e=>{var t;return null!==(t=e.codePointAt(0))&&void 0!==t?t:new C4(t4.VALUE,K2.EmptyString)}))}}s7.implementedFunctions={CODE:{method:"code",parameters:[{argumentType:i5.STRING}]},UNICODE:{method:"unicode",parameters:[{argumentType:i5.STRING}]}};
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
class a7 extends o5{countblank(e,t){return this.runFunction(e.args,t,this.metadata("COUNTBLANK"),((...e)=>{let t=0;return e.forEach((e=>{e===V3&&t++})),t}))}}a7.implementedFunctions={COUNTBLANK:{method:"countblank",parameters:[{argumentType:i5.SCALAR}],repeatLastArgs:1,expandRanges:!0}};
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
class l7 extends o5{countunique(e,t){return this.runFunction(e.args,t,this.metadata("COUNTUNIQUE"),((...e)=>{const t=new Set,n=new Set;for(const r of e)r instanceof C4?n.add(r.type):""!==r&&t.add(r);return t.size+n.size}))}}l7.implementedFunctions={COUNTUNIQUE:{method:"countunique",parameters:[{argumentType:i5.SCALAR}],repeatLastArgs:1,expandRanges:!0}};
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
class h7 extends o5{constructor(){super(...arguments),this.isoweeknumCore=e=>{const t=Math.floor(this.dateTimeHelper.relativeNumberToAbsoluteNumber(e)),n=this.dateTimeHelper.numberToSimpleDate(e),r=this.dateTimeHelper.dateToNumber({year:n.year,month:1,day:1}),i=this.dateTimeHelper.relativeNumberToAbsoluteNumber(r),o=i+((4-i)%7+7)%7,s=Math.floor((t-1)/7)-Math.floor((o-1)/7)+1;return 0===s?this.isoweeknumCore(e-7)+1:s},this.days360Core=(e,t,n)=>{const r=this.dateTimeHelper.numberToSimpleDate(e),i=this.dateTimeHelper.numberToSimpleDate(t);let o,s;return n?(o=F5(r),s=F5(i)):[o,s]=this.dateTimeHelper.toBasisUS(r,i),360*(s.year-o.year)+30*(s.month-o.month)+s.day-o.day}}date(e,t){return this.runFunction(e.args,t,this.metadata("DATE"),((e,t,n)=>{const r=Math.trunc(n);let i=Math.trunc(t),o=Math.trunc(e);o<this.dateTimeHelper.getEpochYearZero()&&(o+=this.dateTimeHelper.getEpochYearZero());const s=Math.floor((i-1)/12);o+=s,i-=12*s;const a={year:o,month:i,day:1};if(this.dateTimeHelper.isValidDate(a)){let e=this.dateTimeHelper.dateToNumber(a)+(r-1);return e=this.dateTimeHelper.getWithinBounds(e),void 0===e?new C4(t4.NUM,K2.DateBounds):e}return new C4(t4.VALUE,K2.InvalidDate)}))}time(e,t){return this.runFunction(e.args,t,this.metadata("TIME"),((e,t,n)=>{const r=k5({hours:Math.trunc(e),minutes:Math.trunc(t),seconds:Math.trunc(n)});return r<0?new C4(t4.NUM,K2.NegativeTime):r%1}))}eomonth(e,t){return this.runFunction(e.args,t,this.metadata("EOMONTH"),((e,t)=>{const n=this.dateTimeHelper.numberToSimpleDate(e);let r=this.dateTimeHelper.dateToNumber(this.dateTimeHelper.endOfMonth(_5(n,t)));return r=this.dateTimeHelper.getWithinBounds(r),void 0===r?new C4(t4.NUM,K2.DateBounds):r}))}day(e,t){return this.runFunction(e.args,t,this.metadata("DAY"),(e=>this.dateTimeHelper.numberToSimpleDate(e).day))}days(e,t){return this.runFunction(e.args,t,this.metadata("DAYS"),((e,t)=>Math.trunc(e)-Math.trunc(t)))}month(e,t){return this.runFunction(e.args,t,this.metadata("MONTH"),(e=>this.dateTimeHelper.numberToSimpleDate(e).month))}year(e,t){return this.runFunction(e.args,t,this.metadata("YEAR"),(e=>this.dateTimeHelper.numberToSimpleDate(e).year))}hour(e,t){return this.runFunction(e.args,t,this.metadata("HOUR"),(e=>H5(L5(e)%1).hours))}minute(e,t){return this.runFunction(e.args,t,this.metadata("MINUTE"),(e=>H5(L5(e)%1).minutes))}second(e,t){return this.runFunction(e.args,t,this.metadata("SECOND"),(e=>H5(L5(e)%1).seconds))}text(e,t){return this.runFunction(e.args,t,this.metadata("TEXT"),((e,t)=>Y5(e,t,this.config,this.dateTimeHelper)))}weekday(e,t){return this.runFunction(e.args,t,this.metadata("WEEKDAY"),((e,t)=>{const n=Math.floor(this.dateTimeHelper.relativeNumberToAbsoluteNumber(e));if(3===t)return(n-1)%7;const r=d7.get(t);return void 0===r?new C4(t4.NUM,K2.BadMode):(n-r)%7+1}))}weeknum(e,t){return this.runFunction(e.args,t,this.metadata("WEEKNUM"),((e,t)=>{const n=Math.floor(this.dateTimeHelper.relativeNumberToAbsoluteNumber(e)),r=this.dateTimeHelper.numberToSimpleDate(e),i=this.dateTimeHelper.dateToNumber({year:r.year,month:1,day:1}),o=this.dateTimeHelper.relativeNumberToAbsoluteNumber(i);if(21===t)return this.isoweeknumCore(e);const s=d7.get(t);return void 0===s?new C4(t4.NUM,K2.BadMode):Math.floor((n-s)/7)-Math.floor((o-s)/7)+1}))}isoweeknum(e,t){return this.runFunction(e.args,t,this.metadata("ISOWEEKNUM"),this.isoweeknumCore)}datevalue(e,t){return this.runFunction(e.args,t,this.metadata("DATEVALUE"),(e=>{const{dateTime:t}=this.dateTimeHelper.parseDateTimeFromConfigFormats(e);return void 0===t?new C4(t4.VALUE,K2.IncorrectDateTime):I5(t)?(O5(t)?Math.trunc(k5(t)):0)+this.dateTimeHelper.dateToNumber(t):0}))}timevalue(e,t){return this.runFunction(e.args,t,this.metadata("TIMEVALUE"),(e=>{const t=this.dateTimeHelper.dateStringToDateNumber(e);return void 0===t?new C4(t4.VALUE,K2.IncorrectDateTime):U3(t)%1}))}now(e,t){return this.runFunction(e.args,t,this.metadata("NOW"),(()=>{const e=new Date(Date.now());return k5({hours:e.getHours(),minutes:e.getMinutes(),seconds:e.getSeconds()})+this.dateTimeHelper.dateToNumber({year:e.getFullYear(),month:e.getMonth()+1,day:e.getDate()})}))}today(e,t){return this.runFunction(e.args,t,this.metadata("TODAY"),(()=>{const e=new Date(Date.now());return this.dateTimeHelper.dateToNumber({year:e.getFullYear(),month:e.getMonth()+1,day:e.getDate()})}))}edate(e,t){return this.runFunction(e.args,t,this.metadata("EDATE"),((e,t)=>{const n=function(e){return{year:e.year,month:e.month,day:Math.min(e.day,b5[e.month-1])}}(_5(this.dateTimeHelper.numberToSimpleDate(e),t));let r=this.dateTimeHelper.dateToNumber(n);return r=this.dateTimeHelper.getWithinBounds(r),void 0===r?new C4(t4.NUM,K2.DateBounds):r}))}datedif(e,t){return this.runFunction(e.args,t,this.metadata("DATEDIF"),((e,t,n)=>{if(e>t)return new C4(t4.NUM,K2.StartEndDate);if("D"===n)return Math.floor(t)-Math.floor(e);const r=this.dateTimeHelper.numberToSimpleDate(e),i=this.dateTimeHelper.numberToSimpleDate(t);switch(n){case"M":return 12*(i.year-r.year)+(i.month-r.month)-(i.day<r.day?1:0);case"YM":return(i.month-r.month+12-(i.day<r.day?1:0))%12;case"Y":return i.month>r.month||i.month===r.month&&i.day>=r.day?i.year-r.year:i.year-r.year-1;case"MD":if(i.day>=r.day)return i.day-r.day;{const e=1===i.month?12:i.month-1,t=1===i.month?i.year-1:i.year;return this.dateTimeHelper.daysInMonth(t,e)+i.day-r.day}case"YD":return i.month>r.month||i.month===r.month&&i.day>=r.day?Math.floor(t)-this.dateTimeHelper.dateToNumber({year:i.year,month:r.month,day:r.day}):Math.floor(t)-Math.floor(e)-365*(i.year-r.year-1)-this.dateTimeHelper.leapYearsCount(i.year-1)+this.dateTimeHelper.leapYearsCount(r.year);default:return new C4(t4.NUM,K2.BadMode)}}))}days360(e,t){return this.runFunction(e.args,t,this.metadata("DAYS360"),this.days360Core)}yearfrac(e,t){return this.runFunction(e.args,t,this.metadata("YEARFRAC"),((e,t,n)=>{switch((e=Math.trunc(e))>(t=Math.trunc(t))&&([e,t]=[t,e]),n){case 0:return this.days360Core(e,t,!1)/360;case 1:return(t-e)/this.dateTimeHelper.yearLengthForBasis(this.dateTimeHelper.numberToSimpleDate(e),this.dateTimeHelper.numberToSimpleDate(t));case 2:return(t-e)/360;case 3:return(t-e)/365;case 4:return this.days360Core(e,t,!0)/360}throw new Error("Should not be reachable.")}))}interval(e,t){return this.runFunction(e.args,t,this.metadata("INTERVAL"),(e=>{const t=(e=Math.trunc(e))%60,n=(e=Math.trunc(e/60))%60,r=(e=Math.trunc(e/60))%24,i=(e=Math.trunc(e/24))%30,o=(e=Math.trunc(e/30))%12,s=Math.trunc(e/12);return"P"+(s>0?`${s}Y`:"")+(o>0?`${o}M`:"")+(i>0?`${i}D`:"")+"T"+(r>0?`${r}H`:"")+(n>0?`${n}M`:"")+(t>0?`${t}S`:"")}))}networkdays(e,t){return this.runFunction(e.args,t,this.metadata("NETWORKDAYS"),((e,t,n)=>this.networkdayscore(e,t,1,n)))}networkdaysintl(e,t){return this.runFunction(e.args,t,this.metadata("NETWORKDAYS.INTL"),((e,t,n,r)=>this.networkdayscore(e,t,n,r)))}workday(e,t){return this.runFunction(e.args,t,this.metadata("WORKDAY"),((e,t,n)=>this.workdaycore(e,t,1,n)))}workdayintl(e,t){return this.runFunction(e.args,t,this.metadata("WORKDAY.INTL"),((e,t,n,r)=>this.workdaycore(e,t,n,r)))}networkdayscore(e,t,n,r){let i=1;(e=Math.trunc(e))>(t=Math.trunc(t))&&([e,t]=[t,e],i=-1);const o=c7(n);if(o instanceof C4)return o;const s=this.simpleRangeToFilteredHolidays(o,r);return s instanceof C4?s:i*this.countWorkdays(e,t,o,s)}workdaycore(e,t,n,r){e=Math.trunc(e),t=Math.trunc(t);const i=c7(n);if(i instanceof C4)return i;const o=this.simpleRangeToFilteredHolidays(i,r);if(o instanceof C4)return o;if(t>0){let n=1;for(;this.countWorkdays(e+1,e+n,i,o)<t;)n*=2;let r=1;for(;r+1<n;){const s=Math.trunc((r+n)/2);this.countWorkdays(e+1,e+s,i,o)<t?r=s:n=s}return e+n}if(t<0){t*=-1;let n=1;for(;this.countWorkdays(e-n,e-1,i,o)<t;)n*=2;let r=1;for(;r+1<n;){const s=Math.trunc((r+n)/2);this.countWorkdays(e-s,e-1,i,o)<t?r=s:n=s}return e-n}return e}countWorkdays(e,t,n,r){const i=Math.floor(this.dateTimeHelper.relativeNumberToAbsoluteNumber(t)),o=Math.floor(this.dateTimeHelper.relativeNumberToAbsoluteNumber(e));let s=0;for(let a=0;a<7;a++)"0"===n.charAt(a)&&(s+=Math.floor((i+6-a)/7),s-=Math.floor((o-1+6-a)/7));return s-=u7(t+1,r)-u7(e,r),s}simpleRangeToFilteredHolidays(e,t){var n;const r=null!==(n=null==t?void 0:t.valuesFromTopLeftCorner())&&void 0!==n?n:[];for(const o of r)if(o instanceof C4)return o;const i=[];for(const o of r)if(o!==V3){if(!K3(o))return new C4(t4.VALUE,K2.WrongType);i.push(Math.trunc(U3(o)))}return[...new Set(i)].sort(((e,t)=>e-t)).filter((t=>{const n=(this.dateTimeHelper.relativeNumberToAbsoluteNumber(t)-1)%7;return"0"===e.charAt(n)}))}}function u7(e,t){if(0===t.length)return 0;if(e<=t[0])return 0;if(t[t.length-1]<e)return t.length;let n=0,r=t.length-1;for(;n+1<r;){const i=Math.floor((r+n)/2);t[i]>=e?r=i:n=i}return r}function c7(e){var t;return"number"!=typeof e&&"string"!=typeof e?new C4(t4.VALUE,K2.WrongType):"string"==typeof e?7===e.length&&/^(0|1)*$/.test(e)&&"1111111"!==e?e:new C4(t4.NUM,K2.WeekendString):null!==(t=p7.get(e))&&void 0!==t?t:new C4(t4.NUM,K2.BadMode)}h7.implementedFunctions={DATE:{method:"date",parameters:[{argumentType:i5.NUMBER},{argumentType:i5.NUMBER},{argumentType:i5.NUMBER}],returnNumberType:X3.NUMBER_DATE},TIME:{method:"time",parameters:[{argumentType:i5.NUMBER},{argumentType:i5.NUMBER},{argumentType:i5.NUMBER}],returnNumberType:X3.NUMBER_TIME},MONTH:{method:"month",parameters:[{argumentType:i5.NUMBER,minValue:0}]},YEAR:{method:"year",parameters:[{argumentType:i5.NUMBER,minValue:0}]},HOUR:{method:"hour",parameters:[{argumentType:i5.NUMBER,minValue:0}]},MINUTE:{method:"minute",parameters:[{argumentType:i5.NUMBER,minValue:0}]},SECOND:{method:"second",parameters:[{argumentType:i5.NUMBER,minValue:0}]},TEXT:{method:"text",parameters:[{argumentType:i5.NUMBER},{argumentType:i5.STRING}]},EOMONTH:{method:"eomonth",parameters:[{argumentType:i5.NUMBER,minValue:0},{argumentType:i5.NUMBER}],returnNumberType:X3.NUMBER_DATE},DAY:{method:"day",parameters:[{argumentType:i5.NUMBER,minValue:0}]},DAYS:{method:"days",parameters:[{argumentType:i5.NUMBER,minValue:0},{argumentType:i5.NUMBER,minValue:0}]},WEEKDAY:{method:"weekday",parameters:[{argumentType:i5.NUMBER,minValue:0},{argumentType:i5.NUMBER,defaultValue:1}]},WEEKNUM:{method:"weeknum",parameters:[{argumentType:i5.NUMBER,minValue:0},{argumentType:i5.NUMBER,defaultValue:1}]},ISOWEEKNUM:{method:"isoweeknum",parameters:[{argumentType:i5.NUMBER,minValue:0}]},DATEVALUE:{method:"datevalue",parameters:[{argumentType:i5.STRING}],returnNumberType:X3.NUMBER_DATE},TIMEVALUE:{method:"timevalue",parameters:[{argumentType:i5.STRING}],returnNumberType:X3.NUMBER_TIME},NOW:{method:"now",parameters:[],isVolatile:!0,returnNumberType:X3.NUMBER_DATETIME},TODAY:{method:"today",parameters:[],isVolatile:!0,returnNumberType:X3.NUMBER_DATE},EDATE:{method:"edate",parameters:[{argumentType:i5.NUMBER,minValue:0},{argumentType:i5.NUMBER}],returnNumberType:X3.NUMBER_DATE},DAYS360:{method:"days360",parameters:[{argumentType:i5.NUMBER,minValue:0},{argumentType:i5.NUMBER,minValue:0},{argumentType:i5.BOOLEAN,defaultValue:!1}]},DATEDIF:{method:"datedif",parameters:[{argumentType:i5.NUMBER,minValue:0},{argumentType:i5.NUMBER,minValue:0},{argumentType:i5.STRING}]},YEARFRAC:{method:"yearfrac",parameters:[{argumentType:i5.NUMBER,minValue:0},{argumentType:i5.NUMBER,minValue:0},{argumentType:i5.INTEGER,defaultValue:0,minValue:0,maxValue:4}]},INTERVAL:{method:"interval",parameters:[{argumentType:i5.NUMBER,minValue:0}]},NETWORKDAYS:{method:"networkdays",parameters:[{argumentType:i5.NUMBER,minValue:0},{argumentType:i5.NUMBER,minValue:0},{argumentType:i5.RANGE,optionalArg:!0}]},"NETWORKDAYS.INTL":{method:"networkdaysintl",parameters:[{argumentType:i5.NUMBER,minValue:0},{argumentType:i5.NUMBER,minValue:0},{argumentType:i5.NOERROR,defaultValue:1},{argumentType:i5.RANGE,optionalArg:!0}]},WORKDAY:{method:"workday",parameters:[{argumentType:i5.NUMBER,minValue:0},{argumentType:i5.NUMBER},{argumentType:i5.RANGE,optionalArg:!0}]},"WORKDAY.INTL":{method:"workdayintl",parameters:[{argumentType:i5.NUMBER,minValue:0},{argumentType:i5.NUMBER},{argumentType:i5.NOERROR,defaultValue:1},{argumentType:i5.RANGE,optionalArg:!0}]}};const d7=new Map([[1,0],[2,1],[11,1],[12,2],[13,3],[14,4],[15,5],[16,6],[17,0]]),p7=new Map([[1,"0000011"],[2,"1000001"],[3,"1100000"],[4,"0110000"],[5,"0011000"],[6,"0001100"],[7,"0000110"],[11,"0000001"],[12,"1000000"],[13,"0100000"],[14,"0010000"],[15,"0001000"],[16,"0000100"],[17,"0000010"]]);
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
class g7 extends o5{degrees(e,t){return this.runFunction(e.args,t,this.metadata("DEGREES"),(e=>e*(180/Math.PI)))}}g7.implementedFunctions={DEGREES:{method:"degrees",parameters:[{argumentType:i5.NUMBER}]}};
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
class m7 extends o5{delta(e,t){return this.runFunction(e.args,t,this.metadata("DELTA"),((e,t)=>e===t?1:0))}}m7.implementedFunctions={DELTA:{method:"delta",parameters:[{argumentType:i5.NUMBER},{argumentType:i5.NUMBER,defaultValue:0}]}};
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
class f7 extends o5{exp(e,t){return this.runFunction(e.args,t,this.metadata("EXP"),Math.exp)}}f7.implementedFunctions={EXP:{method:"exp",parameters:[{argumentType:i5.NUMBER}]}};
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
class w7 extends o5{pmt(e,t){return this.runFunction(e.args,t,this.metadata("PMT"),y7)}ipmt(e,t){return this.runFunction(e.args,t,this.metadata("IPMT"),v7)}ppmt(e,t){return this.runFunction(e.args,t,this.metadata("PPMT"),S7)}fv(e,t){return this.runFunction(e.args,t,this.metadata("FV"),C7)}cumipmt(e,t){return this.runFunction(e.args,t,this.metadata("CUMIPMT"),((e,t,n,r,i,o)=>{if(r>i)return new C4(t4.NUM,K2.EndStartPeriod);let s=0;for(let a=r;a<=i;a++)s+=v7(e,a,t,n,0,o);return s}))}cumprinc(e,t){return this.runFunction(e.args,t,this.metadata("CUMPRINC"),((e,t,n,r,i,o)=>{if(r>i)return new C4(t4.NUM,K2.EndStartPeriod);let s=0;for(let a=r;a<=i;a++)s+=S7(e,a,t,n,0,o);return s}))}db(e,t){return this.runFunction(e.args,t,this.metadata("DB"),((e,t,n,r,i)=>{if(12===i&&r>n||r>n+1)return new C4(t4.NUM,K2.PeriodLong);if(t>=e)return 0;const o=Math.round(1e3*(1-Math.pow(t/e,1/n)))/1e3,s=e*o*i/12;if(1===r)return s;let a=s;for(let l=0;l<r-2;l++)a+=(e-a)*o;return r===n+1?(e-a)*o*(12-i)/12:(e-a)*o}))}ddb(e,t){return this.runFunction(e.args,t,this.metadata("DDB"),((e,t,n,r,i)=>{if(r>n)return new C4(t4.NUM);let o,s=i/n;s>=1?(s=1,o=1===r?e:0):o=e*Math.pow(1-s,r-1);const a=e*Math.pow(1-s,r);return Math.max(o-Math.max(t,a),0)}))}dollarde(e,t){return this.runFunction(e.args,t,this.metadata("DOLLARDE"),((e,t)=>{if(t<1)return new C4(t4.DIV_BY_ZERO);for(t=Math.trunc(t);t>10;)t/=10;return Math.trunc(e)+10*(e-Math.trunc(e))/t}))}dollarfr(e,t){return this.runFunction(e.args,t,this.metadata("DOLLARFR"),((e,t)=>{if(t<1)return new C4(t4.DIV_BY_ZERO);for(t=Math.trunc(t);t>10;)t/=10;return Math.trunc(e)+(e-Math.trunc(e))*t/10}))}effect(e,t){return this.runFunction(e.args,t,this.metadata("EFFECT"),((e,t)=>(t=Math.trunc(t),Math.pow(1+e/t,t)-1)))}ispmt(e,t){return this.runFunction(e.args,t,this.metadata("ISPMT"),((e,t,n,r)=>0===n?new C4(t4.DIV_BY_ZERO):r*e*(t/n-1)))}nominal(e,t){return this.runFunction(e.args,t,this.metadata("NOMINAL"),((e,t)=>(t=Math.trunc(t),(Math.pow(e+1,1/t)-1)*t)))}nper(e,t){return this.runFunction(e.args,t,this.metadata("NPER"),((e,t,n,r,i)=>0===e?0===t?new C4(t4.DIV_BY_ZERO):(-n-r)/t:(i&&(t*=1+e),Math.log((t-r*e)/(n*e+t))/Math.log(1+e))))}rate(e,t){return this.runFunction(e.args,t,this.metadata("RATE"),((e,t,n,r,i,o)=>{if(o<=-1)return new C4(t4.VALUE);const s=1e-7;let a=o;i=i?1:0;for(let l=0;l<50;l++){if(a<=-1)return new C4(t4.NUM);let o,l;if(Math.abs(a)<s)o=n*(1+e*a)+t*(1+a*i)*e+r;else{const s=Math.pow(1+a,e);o=n*s+t*(1/a+i)*(s-1)+r}if(Math.abs(o)<s)return a;if(Math.abs(a)<s)l=n*e+t*i*e;else{const r=Math.pow(1+a,e),o=e*Math.pow(1+a,e-1);l=n*o+t*(1/a+i)*o+t*(-1/(a*a))*(r-1)}a-=o/l}return new C4(t4.NUM)}))}pv(e,t){return this.runFunction(e.args,t,this.metadata("PV"),((e,t,n,r,i)=>(i=i?1:0,-1===e?new C4(0===t?t4.NUM:t4.DIV_BY_ZERO):0===e?-n*t-r:((1-Math.pow(1+e,t))*n*(1+e*i)/e-r)/Math.pow(1+e,t))))}rri(e,t){return this.runFunction(e.args,t,this.metadata("RRI"),((e,t,n)=>0===t||n<0&&t>0||n>0&&t<0?new C4(t4.NUM):Math.pow(n/t,1/e)-1))}sln(e,t){return this.runFunction(e.args,t,this.metadata("SLN"),((e,t,n)=>0===n?new C4(t4.DIV_BY_ZERO):(e-t)/n))}syd(e,t){return this.runFunction(e.args,t,this.metadata("SYD"),((e,t,n,r)=>r>n?new C4(t4.NUM):(e-t)*(n-r+1)*2/(n*(n+1))))}tbilleq(e,t){return this.runFunction(e.args,t,this.metadata("TBILLEQ"),((e,t,n)=>{if((e=Math.round(e))>=(t=Math.round(t)))return new C4(t4.NUM);const r=this.dateTimeHelper.numberToSimpleDate(e),i=this.dateTimeHelper.numberToSimpleDate(t);if(i.year>r.year+1||i.year===r.year+1&&(i.month>r.month||i.month===r.month&&i.day>r.day))return new C4(t4.NUM);const o=360-n*(t-e);return 0===o?0:o<0?new C4(t4.NUM):365*n/o}))}tbillprice(e,t){return this.runFunction(e.args,t,this.metadata("TBILLPRICE"),((e,t,n)=>{if((e=Math.round(e))>=(t=Math.round(t)))return new C4(t4.NUM);const r=this.dateTimeHelper.numberToSimpleDate(e),i=this.dateTimeHelper.numberToSimpleDate(t);if(i.year>r.year+1||i.year===r.year+1&&(i.month>r.month||i.month===r.month&&i.day>r.day))return new C4(t4.NUM);const o=360-n*(t-e);return 0===o?0:o<0?new C4(t4.NUM):100*(1-n*(t-e)/360)}))}tbillyield(e,t){return this.runFunction(e.args,t,this.metadata("TBILLYIELD"),((e,t,n)=>{if((e=Math.round(e))>=(t=Math.round(t)))return new C4(t4.NUM);const r=this.dateTimeHelper.numberToSimpleDate(e),i=this.dateTimeHelper.numberToSimpleDate(t);return i.year>r.year+1||i.year===r.year+1&&(i.month>r.month||i.month===r.month&&i.day>r.day)?new C4(t4.NUM):360*(100-n)/(n*(t-e))}))}fvschedule(e,t){return this.runFunction(e.args,t,this.metadata("FVSCHEDULE"),((e,t)=>{const n=t.valuesFromTopLeftCorner();for(const r of n)if(r instanceof C4)return r;for(const r of n)if(K3(r))e*=1+U3(r);else if(r!==V3)return new C4(t4.VALUE,K2.NumberExpected);return e}))}npv(e,t){return this.runFunction(e.args,t,this.metadata("NPV"),((e,...t)=>{const n=this.arithmeticHelper.coerceNumbersExactRanges(t);return n instanceof C4?n:R7(e,n)}))}mirr(e,t){return this.runFunction(e.args,t,this.metadata("MIRR"),((e,t,n)=>{const r=this.arithmeticHelper.manyToExactNumbers(e.valuesFromTopLeftCorner());if(r instanceof C4)return r;let i=!1,o=!1;const s=[],a=[];for(const c of r)c>0?(i=!0,s.push(c),a.push(0)):c<0?(o=!0,a.push(c),s.push(0)):(a.push(0),s.push(0));if(!i||!o)return new C4(t4.DIV_BY_ZERO);const l=r.length,h=R7(n,s);if(h instanceof C4)return h;const u=R7(t,a);return u instanceof C4?u:Math.pow(-h*Math.pow(1+n,l)/u/(1+t),1/(l-1))-1}))}pduration(e,t){return this.runFunction(e.args,t,this.metadata("PDURATION"),((e,t,n)=>(Math.log(n)-Math.log(t))/Math.log(1+e)))}xnpv(e,t){return this.runFunction(e.args,t,this.metadata("XNPV"),((e,t,n)=>{const r=t.valuesFromTopLeftCorner();for(const h of r)if("number"!=typeof h)return new C4(t4.VALUE,K2.NumberExpected);const i=r,o=n.valuesFromTopLeftCorner();for(const h of o)if("number"!=typeof h)return new C4(t4.VALUE,K2.NumberExpected);const s=o;if(s.length!==i.length)return new C4(t4.NUM,K2.EqualLength);const a=s.length;let l=0;if(s[0]<0)return new C4(t4.NUM,K2.ValueSmall);for(let h=0;h<a;h++){if(s[h]=Math.floor(s[h]),s[h]<s[0])return new C4(t4.NUM,K2.ValueSmall);l+=i[h]/Math.pow(1+e,(s[h]-s[0])/365)}return l}))}}function y7(e,t,n,r,i){if(0===e)return(-n-r)/t;{const o=Math.pow(1+e,t);return(r*e+n*e*o)*(i?1/(1+e):1)/(1-o)}}function v7(e,t,n,r,i,o){const s=y7(e,n,r,i,o);return 1===t?e*(o?0:-r):e*(o?C7(e,t-2,s,r,o)-s:C7(e,t-1,s,r,o))}function C7(e,t,n,r,i){if(0===e)return-r-n*t;{const o=Math.pow(1+e,t);return n*(i?1+e:1)*(1-o)/e-r*o}}function S7(e,t,n,r,i,o){return y7(e,n,r,i,o)-v7(e,t,n,r,i,o)}function R7(e,t){let n=0;for(let r=t.length-1;r>=0;r--){if(n+=t[r],-1===e){if(0===n)continue;return new C4(t4.DIV_BY_ZERO)}n/=1+e}return n}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */w7.implementedFunctions={PMT:{method:"pmt",parameters:[{argumentType:i5.NUMBER},{argumentType:i5.NUMBER},{argumentType:i5.NUMBER},{argumentType:i5.NUMBER,defaultValue:0},{argumentType:i5.NUMBER,defaultValue:0}],returnNumberType:X3.NUMBER_CURRENCY},IPMT:{method:"ipmt",parameters:[{argumentType:i5.NUMBER},{argumentType:i5.NUMBER},{argumentType:i5.NUMBER},{argumentType:i5.NUMBER},{argumentType:i5.NUMBER,defaultValue:0},{argumentType:i5.NUMBER,defaultValue:0}],returnNumberType:X3.NUMBER_CURRENCY},PPMT:{method:"ppmt",parameters:[{argumentType:i5.NUMBER},{argumentType:i5.NUMBER},{argumentType:i5.NUMBER},{argumentType:i5.NUMBER},{argumentType:i5.NUMBER,defaultValue:0},{argumentType:i5.NUMBER,defaultValue:0}],returnNumberType:X3.NUMBER_CURRENCY},FV:{method:"fv",parameters:[{argumentType:i5.NUMBER},{argumentType:i5.NUMBER},{argumentType:i5.NUMBER},{argumentType:i5.NUMBER,defaultValue:0},{argumentType:i5.NUMBER,defaultValue:0}],returnNumberType:X3.NUMBER_CURRENCY},CUMIPMT:{method:"cumipmt",parameters:[{argumentType:i5.NUMBER,greaterThan:0},{argumentType:i5.NUMBER,greaterThan:0},{argumentType:i5.NUMBER,greaterThan:0},{argumentType:i5.INTEGER,minValue:1},{argumentType:i5.INTEGER,minValue:1},{argumentType:i5.INTEGER,minValue:0,maxValue:1}],returnNumberType:X3.NUMBER_CURRENCY},CUMPRINC:{method:"cumprinc",parameters:[{argumentType:i5.NUMBER,greaterThan:0},{argumentType:i5.NUMBER,greaterThan:0},{argumentType:i5.NUMBER,greaterThan:0},{argumentType:i5.INTEGER,minValue:1},{argumentType:i5.INTEGER,minValue:1},{argumentType:i5.INTEGER,minValue:0,maxValue:1}],returnNumberType:X3.NUMBER_CURRENCY},DB:{method:"db",parameters:[{argumentType:i5.NUMBER,minValue:0},{argumentType:i5.NUMBER,minValue:0},{argumentType:i5.INTEGER,minValue:0},{argumentType:i5.INTEGER,minValue:0},{argumentType:i5.INTEGER,minValue:1,maxValue:12,defaultValue:12}],returnNumberType:X3.NUMBER_CURRENCY},DDB:{method:"ddb",parameters:[{argumentType:i5.NUMBER,minValue:0},{argumentType:i5.NUMBER,minValue:0},{argumentType:i5.INTEGER,minValue:0},{argumentType:i5.NUMBER,minValue:0},{argumentType:i5.NUMBER,greaterThan:0,defaultValue:2}],returnNumberType:X3.NUMBER_CURRENCY},DOLLARDE:{method:"dollarde",parameters:[{argumentType:i5.NUMBER},{argumentType:i5.NUMBER,minValue:0}]},DOLLARFR:{method:"dollarfr",parameters:[{argumentType:i5.NUMBER},{argumentType:i5.NUMBER,minValue:0}]},EFFECT:{method:"effect",parameters:[{argumentType:i5.NUMBER,minValue:0},{argumentType:i5.NUMBER,minValue:1}],returnNumberType:X3.NUMBER_PERCENT},ISPMT:{method:"ispmt",parameters:[{argumentType:i5.NUMBER},{argumentType:i5.NUMBER},{argumentType:i5.NUMBER},{argumentType:i5.NUMBER}]},NOMINAL:{method:"nominal",parameters:[{argumentType:i5.NUMBER,minValue:0},{argumentType:i5.NUMBER,minValue:1}],returnNumberType:X3.NUMBER_PERCENT},NPER:{method:"nper",parameters:[{argumentType:i5.NUMBER},{argumentType:i5.NUMBER},{argumentType:i5.NUMBER},{argumentType:i5.NUMBER,defaultValue:0},{argumentType:i5.NUMBER,defaultValue:0}]},PV:{method:"pv",parameters:[{argumentType:i5.NUMBER},{argumentType:i5.NUMBER},{argumentType:i5.NUMBER},{argumentType:i5.NUMBER,defaultValue:0},{argumentType:i5.NUMBER,defaultValue:0}],returnNumberType:X3.NUMBER_CURRENCY},RATE:{method:"rate",parameters:[{argumentType:i5.NUMBER,greaterThan:0},{argumentType:i5.NUMBER},{argumentType:i5.NUMBER},{argumentType:i5.NUMBER,defaultValue:0},{argumentType:i5.NUMBER,defaultValue:0},{argumentType:i5.NUMBER,defaultValue:.1}],returnNumberType:X3.NUMBER_PERCENT},RRI:{method:"rri",parameters:[{argumentType:i5.NUMBER,greaterThan:0},{argumentType:i5.NUMBER},{argumentType:i5.NUMBER}],returnNumberType:X3.NUMBER_PERCENT},SLN:{method:"sln",parameters:[{argumentType:i5.NUMBER},{argumentType:i5.NUMBER},{argumentType:i5.NUMBER}],returnNumberType:X3.NUMBER_CURRENCY},SYD:{method:"syd",parameters:[{argumentType:i5.NUMBER},{argumentType:i5.NUMBER},{argumentType:i5.NUMBER,greaterThan:0},{argumentType:i5.NUMBER,greaterThan:0}],returnNumberType:X3.NUMBER_CURRENCY},TBILLEQ:{method:"tbilleq",parameters:[{argumentType:i5.NUMBER,minValue:0},{argumentType:i5.NUMBER,minValue:0},{argumentType:i5.NUMBER,greaterThan:0}],returnNumberType:X3.NUMBER_PERCENT},TBILLPRICE:{method:"tbillprice",parameters:[{argumentType:i5.NUMBER,minValue:0},{argumentType:i5.NUMBER,minValue:0},{argumentType:i5.NUMBER,greaterThan:0}],returnNumberType:X3.NUMBER_CURRENCY},TBILLYIELD:{method:"tbillyield",parameters:[{argumentType:i5.NUMBER,minValue:0},{argumentType:i5.NUMBER,minValue:0},{argumentType:i5.NUMBER,greaterThan:0}],returnNumberType:X3.NUMBER_PERCENT},FVSCHEDULE:{method:"fvschedule",parameters:[{argumentType:i5.NUMBER},{argumentType:i5.RANGE}],returnNumberType:X3.NUMBER_CURRENCY},NPV:{method:"npv",parameters:[{argumentType:i5.NUMBER},{argumentType:i5.ANY}],repeatLastArgs:1,returnNumberType:X3.NUMBER_CURRENCY},MIRR:{method:"mirr",parameters:[{argumentType:i5.RANGE},{argumentType:i5.NUMBER},{argumentType:i5.NUMBER}],returnNumberType:X3.NUMBER_PERCENT},PDURATION:{method:"pduration",parameters:[{argumentType:i5.NUMBER,greaterThan:0},{argumentType:i5.NUMBER,greaterThan:0},{argumentType:i5.NUMBER,greaterThan:0}]},XNPV:{method:"xnpv",parameters:[{argumentType:i5.NUMBER,greaterThan:-1},{argumentType:i5.RANGE},{argumentType:i5.RANGE}]}};class E7 extends o5{formulatext(e,t){return this.runFunctionWithReferenceArgument(e.args,t,this.metadata("FORMULATEXT"),(()=>new C4(t4.NA,K2.WrongArgNumber)),(e=>{var t;return null!==(t=this.serialization.getCellFormula(e))&&void 0!==t?t:new C4(t4.NA,K2.Formula)}))}}E7.implementedFunctions={FORMULATEXT:{method:"formulatext",parameters:[{argumentType:i5.NOERROR}],doesNotNeedArgumentsToBeComputed:!0,isDependentOnSheetStructureChange:!0,vectorizationForbidden:!0}};
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
class b7 extends o5{hyperlink(e,t){return this.runFunction(e.args,t,this.metadata("HYPERLINK"),((t,n)=>(e.hyperlink=t,null!=n?n:t)))}}b7.implementedFunctions={HYPERLINK:{method:"hyperlink",parameters:[{argumentType:i5.STRING},{argumentType:i5.STRING,optionalArg:!0}]}};
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
class T7 extends o5{isbinary(e,t){return this.runFunction(e.args,t,this.metadata("ISBINARY"),(e=>/^[01]{1,10}$/.test(e)))}iserr(e,t){return this.runFunction(e.args,t,this.metadata("ISERR"),(e=>e instanceof C4&&e.type!==t4.NA))}iserror(e,t){return this.runFunction(e.args,t,this.metadata("ISERROR"),(e=>e instanceof C4))}isformula(e,t){return this.runFunctionWithReferenceArgument(e.args,t,this.metadata("ISFORMULA"),(()=>new C4(t4.NA,K2.WrongArgNumber)),(e=>this.dependencyGraph.addressMapping.getCell(e)instanceof B9))}isblank(e,t){return this.runFunction(e.args,t,this.metadata("ISBLANK"),(e=>e===V3))}isna(e,t){return this.runFunction(e.args,t,this.metadata("ISNA"),(e=>e instanceof C4&&e.type==t4.NA))}isnumber(e,t){return this.runFunction(e.args,t,this.metadata("ISNUMBER"),K3)}islogical(e,t){return this.runFunction(e.args,t,this.metadata("ISLOGICAL"),(e=>"boolean"==typeof e))}isref(e,t){return this.runFunction(e.args,t,this.metadata("ISREF"),(e=>e instanceof C4&&(e.type==t4.REF||e.type==t4.CYCLE)))}istext(e,t){return this.runFunction(e.args,t,this.metadata("ISTEXT"),(e=>"string"==typeof e))}isnontext(e,t){return this.runFunction(e.args,t,this.metadata("ISNONTEXT"),(e=>!("string"==typeof e)))}column(e,t){return this.runFunctionWithReferenceArgument(e.args,t,this.metadata("COLUMN"),(()=>t.formulaAddress.col+1),(e=>e.col+1))}columns(e,t){if(1!==e.args.length)return new C4(t4.NA,K2.WrongArgNumber);if(e.args.some((e=>e.type===H2.EMPTY)))return new C4(t4.NUM,K2.EmptyArg);let n=e.args[0];for(;n.type===H2.PARENTHESIS;)n=n.expression;if(n.type===H2.CELL_RANGE||n.type===H2.COLUMN_RANGE)return n.end.col-n.start.col+1;if(n.type===H2.CELL_REFERENCE)return 1;if(n.type===H2.ROW_RANGE)return this.config.maxColumns;{const e=this.evaluateAst(n,t);return e instanceof Z3?e.width():e instanceof C4?e:1}}row(e,t){return this.runFunctionWithReferenceArgument(e.args,t,this.metadata("ROW"),(()=>t.formulaAddress.row+1),(e=>e.row+1))}rows(e,t){if(1!==e.args.length)return new C4(t4.NA,K2.WrongArgNumber);if(e.args.some((e=>e.type===H2.EMPTY)))return new C4(t4.NUM,K2.EmptyArg);let n=e.args[0];for(;n.type===H2.PARENTHESIS;)n=n.expression;if(n.type===H2.CELL_RANGE||n.type===H2.ROW_RANGE)return n.end.row-n.start.row+1;if(n.type===H2.CELL_REFERENCE)return 1;if(n.type===H2.COLUMN_RANGE)return this.config.maxRows;{const e=this.evaluateAst(n,t);return e instanceof Z3?e.height():e instanceof C4?e:1}}index(e,t){return this.runFunction(e.args,t,this.metadata("INDEX"),((e,t,n)=>{var r,i,o,s,a,l;return n<1||t<1?new C4(t4.VALUE,K2.LessThanOne):n>e.width()||t>e.height()?new C4(t4.NUM,K2.ValueLarge):null!==(l=null!==(o=null===(i=null===(r=null==e?void 0:e.data)||void 0===r?void 0:r[t-1])||void 0===i?void 0:i[n-1])&&void 0!==o?o:null===(a=null===(s=null==e?void 0:e.data)||void 0===s?void 0:s[0])||void 0===a?void 0:a[0])&&void 0!==l?l:new C4(t4.VALUE,K2.CellRangeExpected)}))}na(e,t){return new C4(t4.NA)}sheet(e,t){return this.runFunctionWithReferenceArgument(e.args,t,this.metadata("SHEET"),(()=>t.formulaAddress.sheet+1),(e=>e.sheet+1),(e=>{const t=this.dependencyGraph.sheetMapping.get(e);return void 0!==t?t+1:new C4(t4.NA,K2.SheetRef)}))}sheets(e,t){return this.runFunctionWithReferenceArgument(e.args,t,this.metadata("SHEETS"),(()=>this.dependencyGraph.sheetMapping.numberOfSheets()),(()=>1),(()=>new C4(t4.VALUE,K2.CellRefExpected)))}}T7.implementedFunctions={COLUMN:{method:"column",parameters:[{argumentType:i5.NOERROR,optionalArg:!0}],isDependentOnSheetStructureChange:!0,doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},COLUMNS:{method:"columns",parameters:[{argumentType:i5.RANGE}],isDependentOnSheetStructureChange:!0,doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},ISBINARY:{method:"isbinary",parameters:[{argumentType:i5.STRING}]},ISERR:{method:"iserr",parameters:[{argumentType:i5.SCALAR}]},ISFORMULA:{method:"isformula",parameters:[{argumentType:i5.NOERROR}],doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},ISNA:{method:"isna",parameters:[{argumentType:i5.SCALAR}]},ISREF:{method:"isref",parameters:[{argumentType:i5.SCALAR}],vectorizationForbidden:!0},ISERROR:{method:"iserror",parameters:[{argumentType:i5.SCALAR}]},ISBLANK:{method:"isblank",parameters:[{argumentType:i5.SCALAR}]},ISNUMBER:{method:"isnumber",parameters:[{argumentType:i5.SCALAR}]},ISLOGICAL:{method:"islogical",parameters:[{argumentType:i5.SCALAR}]},ISTEXT:{method:"istext",parameters:[{argumentType:i5.SCALAR}]},ISNONTEXT:{method:"isnontext",parameters:[{argumentType:i5.SCALAR}]},INDEX:{method:"index",parameters:[{argumentType:i5.RANGE},{argumentType:i5.NUMBER},{argumentType:i5.NUMBER,defaultValue:1}]},NA:{method:"na",parameters:[]},ROW:{method:"row",parameters:[{argumentType:i5.NOERROR,optionalArg:!0}],isDependentOnSheetStructureChange:!0,doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},ROWS:{method:"rows",parameters:[{argumentType:i5.RANGE}],isDependentOnSheetStructureChange:!0,doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},SHEET:{method:"sheet",parameters:[{argumentType:i5.STRING}],doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},SHEETS:{method:"sheets",parameters:[{argumentType:i5.STRING}],doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0}};
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
class N7 extends o5{iseven(e,t){return this.runFunction(e.args,t,this.metadata("ISEVEN"),(e=>e%2==0))}}N7.implementedFunctions={ISEVEN:{method:"iseven",parameters:[{argumentType:i5.NUMBER}]}};
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
class A7 extends o5{isodd(e,t){return this.runFunction(e.args,t,this.metadata("ISODD"),(e=>e%2==1))}}A7.implementedFunctions={ISODD:{method:"isodd",parameters:[{argumentType:i5.NUMBER}]}};
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
class M7 extends o5{log10(e,t){return this.runFunction(e.args,t,this.metadata("LOG10"),Math.log10)}log(e,t){return this.runFunction(e.args,t,this.metadata("LOG"),((e,t)=>Math.log(e)/Math.log(t)))}ln(e,t){return this.runFunction(e.args,t,this.metadata("LN"),Math.log)}}M7.implementedFunctions={LOG10:{method:"log10",parameters:[{argumentType:i5.NUMBER}]},LOG:{method:"log",parameters:[{argumentType:i5.NUMBER,greaterThan:0},{argumentType:i5.NUMBER,defaultValue:10,greaterThan:0}]},LN:{method:"ln",parameters:[{argumentType:i5.NUMBER}]}};
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
const I7=parseFloat(Math.PI.toFixed(14));class O7 extends o5{pi(e,t){return this.runFunction(e.args,t,this.metadata("PI"),(()=>I7))}sqrtpi(e,t){return this.runFunction(e.args,t,this.metadata("SQRTPI"),(e=>Math.sqrt(I7*e)))}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
function x7(e,t){return new s5(t.width,e.height)}function P7(e,t,n){return new s5(1+(e.width-t)/n,1+(e.height-t)/n)}O7.implementedFunctions={PI:{method:"pi",parameters:[]},SQRTPI:{method:"sqrtpi",parameters:[{argumentType:i5.NUMBER,minValue:0}]}};class _7 extends o5{mmult(e,t){return this.runFunction(e.args,t,this.metadata("MMULT"),((e,t)=>{if(!e.hasOnlyNumbers()||!t.hasOnlyNumbers())return new C4(t4.VALUE,K2.NumberRange);if(t.height()!==e.width())return new C4(t4.VALUE,K2.ArrayDimensions);const n=x7(e.size,t.size),r=this.createKernel((function(e,t,n){let r=0;for(let i=0;i<n;++i)r+=e[this.thread.y][i]*t[i][this.thread.x];return r}),n)(e.rawNumbers(),t.rawNumbers(),e.width());return Z3.onlyNumbers(r)}))}mmultArraySize(e,t){if(2!==e.args.length)return s5.error();const n=this.metadata("MMULT"),r=e.args.map((e=>{var r;return this.arraySizeForAst(e,new F4(t.formulaAddress,t.arraysFlag||null!==(r=null==n?void 0:n.arrayFunction)&&void 0!==r&&r))})),[i,o]=r;return x7(i,o)}maxpool(e,t){return this.runFunction(e.args,t,this.metadata("MAXPOOL"),((e,t,n=t)=>{if(!e.hasOnlyNumbers())return new C4(t4.VALUE,K2.NumberRange);const r=P7(e.size,t,n),i=this.createKernel((function(e,t,n){const r=this.thread.x*n,i=this.thread.y*n;let o=e[i][r];for(let s=0;s<t;s++)for(let n=0;n<t;n++)o=Math.max(o,e[i+s][r+n]);return o}),r)(e.rawNumbers(),t,n);return Z3.onlyNumbers(i)}))}medianpool(e,t){return this.runFunction(e.args,t,this.metadata("MEDIANPOOL"),((e,t,n=t)=>{if(!e.hasOnlyNumbers())return new C4(t4.VALUE,K2.NumberRange);const r=P7(e.size,t,n),i=this.createKernel((function(e,t,n){const r=this.thread.x*n,i=this.thread.y*n;let o=e[i][r];for(let c=0;c<t;c++)for(let n=0;n<t;n++)o=Math.max(o,e[i+c][r+n]);let s=e[i][r];for(let c=0;c<t;c++)for(let n=0;n<t;n++)s=Math.min(s,e[i+c][r+n]);const a=t*t;let l=s,h=o,u=42;for(let c=0;c<32;c++){const n=(l+h)/2;let o=0;for(let s=0;s<t;s++)for(let a=0;a<t;a++)e[i+s][r+a]>n&&o++;if(t%2==0){if(o===a/2){u=n;break}o>a/2?l=n:h=n}else{if(o===(a-1)/2){u=n;break}o>(a-1)/2?l=n:h=n}}return u}),r)(e.rawNumbers(),t,n);return Z3.onlyNumbers(i)}))}maxpoolArraySize(e,t){if(e.args.length<2||e.args.length>3)return s5.error();const n=this.metadata("MAXPOOL"),r=e.args.map((e=>{var r;return this.arraySizeForAst(e,new F4(t.formulaAddress,t.arraysFlag||null!==(r=null==n?void 0:n.arrayFunction)&&void 0!==r&&r))}))[0],i=e.args[1];let o;o=i.type===H2.NUMBER?i.value:1;let s=o;if(3===e.args.length){const t=e.args[2];s=t.type===H2.NUMBER?t.value:1}return o>r.width||o>r.height||s>o||(r.width-o)%s!=0||(r.height-o)%s!=0?s5.error():P7(r,o,s)}medianpoolArraySize(e,t){return this.maxpoolArraySize(e,t)}transpose(e,t){return this.runFunction(e.args,t,this.metadata("TRANSPOSE"),(e=>{const t=e.rawData(),n=e.size,r=[];for(let i=0;i<n.width;++i){r[i]=[];for(let e=0;e<n.height;++e)r[i][e]=t[e][i]}return Z3.onlyValues(r)}))}transposeArraySize(e,t){if(1!==e.args.length)return s5.error();const n=this.metadata("TRANSPOSE"),r=e.args.map((e=>{var r;return this.arraySizeForAst(e,new F4(t.formulaAddress,t.arraysFlag||null!==(r=null==n?void 0:n.arrayFunction)&&void 0!==r&&r))})),[i]=r;return new s5(i.height,i.width)}createKernel(e,t){return function(...n){const r=[];for(let i=0;i<t.height;++i){r.push([]);for(let o=0;o<t.width;++o)r[i][o]=e.apply({thread:{x:o,y:i}},n)}return r}}}_7.implementedFunctions={MMULT:{method:"mmult",arraySizeMethod:"mmultArraySize",parameters:[{argumentType:i5.RANGE},{argumentType:i5.RANGE}],vectorizationForbidden:!0},TRANSPOSE:{method:"transpose",arraySizeMethod:"transposeArraySize",parameters:[{argumentType:i5.RANGE}],vectorizationForbidden:!0},MAXPOOL:{method:"maxpool",arraySizeMethod:"maxpoolArraySize",parameters:[{argumentType:i5.RANGE},{argumentType:i5.NUMBER},{argumentType:i5.NUMBER,optionalArg:!0}],vectorizationForbidden:!0},MEDIANPOOL:{method:"medianpool",arraySizeMethod:"medianpoolArraySize",parameters:[{argumentType:i5.RANGE},{argumentType:i5.NUMBER},{argumentType:i5.NUMBER,optionalArg:!0}],vectorizationForbidden:!0}};
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
class L7 extends o5{median(e,t){return this.runFunction(e.args,t,this.metadata("MEDIAN"),((...e)=>{const t=this.arithmeticHelper.coerceNumbersExactRanges(e);return t instanceof C4?t:0===t.length?new C4(t4.NUM,K2.OneValue):(t.sort(((e,t)=>e-t)),t.length%2==0?(t[t.length/2-1]+t[t.length/2])/2:t[Math.floor(t.length/2)])}))}large(e,t){return this.runFunction(e.args,t,this.metadata("LARGE"),((e,t)=>{const n=this.arithmeticHelper.manyToExactNumbers(e.valuesFromTopLeftCorner());return n instanceof C4?n:(n.sort(((e,t)=>e-t)),(t=Math.trunc(t))>n.length?new C4(t4.NUM,K2.ValueLarge):n[n.length-t])}))}small(e,t){return this.runFunction(e.args,t,this.metadata("SMALL"),((e,t)=>{const n=this.arithmeticHelper.manyToExactNumbers(e.valuesFromTopLeftCorner());return n instanceof C4?n:(n.sort(((e,t)=>e-t)),(t=Math.trunc(t))>n.length?new C4(t4.NUM,K2.ValueLarge):n[t-1])}))}}L7.implementedFunctions={MEDIAN:{method:"median",parameters:[{argumentType:i5.ANY}],repeatLastArgs:1},LARGE:{method:"large",parameters:[{argumentType:i5.RANGE},{argumentType:i5.NUMBER,minValue:1}]},SMALL:{method:"small",parameters:[{argumentType:i5.RANGE},{argumentType:i5.NUMBER,minValue:1}]}};
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
class H7 extends o5{mod(e,t){return this.runFunction(e.args,t,this.metadata("MOD"),((e,t)=>0===t?new C4(t4.DIV_BY_ZERO):e%t))}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
function k7(e){return K3(e)&&!Number.isFinite(U3(e))?0:e}H7.implementedFunctions={MOD:{method:"mod",parameters:[{argumentType:i5.NUMBER},{argumentType:i5.NUMBER}]}};class F7{constructor(e,t,n){this.sumsq=e,this.sum=t,this.count=n}static single(e){return new F7(e*e,e,1)}compose(e){return new F7(this.sumsq+e.sumsq,this.sum+e.sum,this.count+e.count)}averageValue(){return this.count>0?this.sum/this.count:void 0}varSValue(){return this.count>1?(this.sumsq-this.sum*this.sum/this.count)/(this.count-1):void 0}varPValue(){return this.count>0?(this.sumsq-this.sum*this.sum/this.count)/this.count:void 0}}F7.empty=new F7(0,0,0);class D7 extends o5{constructor(){super(...arguments),this.addWithEpsilonRaw=(e,t)=>this.arithmeticHelper.addWithEpsilonRaw(e,t)}sum(e,t){return this.doSum(e.args,t)}sumsq(e,t){return this.reduce(e.args,t,0,"SUMSQ",this.addWithEpsilonRaw,(e=>Math.pow(U3(e),2)),V7)}max(e,t){return this.doMax(e.args,t)}maxa(e,t){const n=this.reduce(e.args,t,Number.NEGATIVE_INFINITY,"MAXA",((e,t)=>Math.max(e,t)),U3,U7);return k7(n)}min(e,t){return this.doMin(e.args,t)}mina(e,t){const n=this.reduce(e.args,t,Number.POSITIVE_INFINITY,"MINA",((e,t)=>Math.min(e,t)),U3,U7);return k7(n)}count(e,t){return this.doCount(e.args,t)}counta(e,t){return this.doCounta(e.args,t)}average(e,t){return this.doAverage(e.args,t)}averagea(e,t){var n;const r=this.reduce(e.args,t,F7.empty,"_AGGREGATE_A",((e,t)=>e.compose(t)),(e=>F7.single(U3(e))),U7);return r instanceof C4?r:null!==(n=r.averageValue())&&void 0!==n?n:new C4(t4.DIV_BY_ZERO)}vars(e,t){return this.doVarS(e.args,t)}varp(e,t){return this.doVarP(e.args,t)}vara(e,t){var n;const r=this.reduceAggregateA(e.args,t);return r instanceof C4?r:null!==(n=r.varSValue())&&void 0!==n?n:new C4(t4.DIV_BY_ZERO)}varpa(e,t){var n;const r=this.reduceAggregateA(e.args,t);return r instanceof C4?r:null!==(n=r.varPValue())&&void 0!==n?n:new C4(t4.DIV_BY_ZERO)}stdevs(e,t){return this.doStdevS(e.args,t)}stdevp(e,t){return this.doStdevP(e.args,t)}stdeva(e,t){const n=this.reduceAggregateA(e.args,t);if(n instanceof C4)return n;{const e=n.varSValue();return void 0===e?new C4(t4.DIV_BY_ZERO):Math.sqrt(e)}}stdevpa(e,t){const n=this.reduceAggregateA(e.args,t);if(n instanceof C4)return n;{const e=n.varPValue();return void 0===e?new C4(t4.DIV_BY_ZERO):Math.sqrt(e)}}product(e,t){return this.doProduct(e.args,t)}subtotal(e,t){if(e.args.length<2)return new C4(t4.NA,K2.WrongArgNumber);const n=this.coerceToType(this.evaluateAst(e.args[0],t),{argumentType:i5.NUMBER},t),r=e.args.slice(1);switch(n){case 1:case 101:return this.doAverage(r,t);case 2:case 102:return this.doCount(r,t);case 3:case 103:return this.doCounta(r,t);case 4:case 104:return this.doMax(r,t);case 5:case 105:return this.doMin(r,t);case 6:case 106:return this.doProduct(r,t);case 7:case 107:return this.doStdevS(r,t);case 8:case 108:return this.doStdevP(r,t);case 9:case 109:return this.doSum(r,t);case 10:case 110:return this.doVarS(r,t);case 11:case 111:return this.doVarP(r,t);default:return new C4(t4.VALUE,K2.BadMode)}}reduceAggregate(e,t){return this.reduce(e,t,F7.empty,"_AGGREGATE",((e,t)=>e.compose(t)),(e=>F7.single(U3(e))),V7)}reduceAggregateA(e,t){return this.reduce(e,t,F7.empty,"_AGGREGATE_A",((e,t)=>e.compose(t)),(e=>F7.single(U3(e))),U7)}doAverage(e,t){var n;const r=this.reduceAggregate(e,t);return r instanceof C4?r:null!==(n=r.averageValue())&&void 0!==n?n:new C4(t4.DIV_BY_ZERO)}doVarS(e,t){var n;const r=this.reduceAggregate(e,t);return r instanceof C4?r:null!==(n=r.varSValue())&&void 0!==n?n:new C4(t4.DIV_BY_ZERO)}doVarP(e,t){var n;const r=this.reduceAggregate(e,t);return r instanceof C4?r:null!==(n=r.varPValue())&&void 0!==n?n:new C4(t4.DIV_BY_ZERO)}doStdevS(e,t){const n=this.reduceAggregate(e,t);if(n instanceof C4)return n;{const e=n.varSValue();return void 0===e?new C4(t4.DIV_BY_ZERO):Math.sqrt(e)}}doStdevP(e,t){const n=this.reduceAggregate(e,t);if(n instanceof C4)return n;{const e=n.varPValue();return void 0===e?new C4(t4.DIV_BY_ZERO):Math.sqrt(e)}}doCount(e,t){return this.reduce(e,t,0,"COUNT",((e,t)=>e+t),U3,(e=>K3(e)?1:0))}doCounta(e,t){return this.reduce(e,t,0,"COUNTA",((e,t)=>e+t),U3,(e=>e===V3?0:1))}doMax(e,t){const n=this.reduce(e,t,Number.NEGATIVE_INFINITY,"MAX",((e,t)=>Math.max(e,t)),U3,V7);return k7(n)}doMin(e,t){const n=this.reduce(e,t,Number.POSITIVE_INFINITY,"MIN",((e,t)=>Math.min(e,t)),U3,V7);return k7(n)}doSum(e,t){return this.reduce(e,t,0,"SUM",this.addWithEpsilonRaw,U3,V7)}doProduct(e,t){return this.reduce(e,t,1,"PRODUCT",((e,t)=>e*t),U3,V7)}reduce(e,t,n,r,i,o,s){return e.length<1?new C4(t4.NA,K2.WrongArgNumber):e.reduce(((e,a)=>{if(e instanceof C4)return e;if(a.type===H2.CELL_RANGE||a.type===H2.COLUMN_RANGE||a.type===H2.ROW_RANGE){const l=this.evaluateRange(a,t,n,r,i,o,s);return l instanceof C4?l:i(l,e)}let l;if(l=this.evaluateAst(a,t),l instanceof Z3){const t=Array.from(l.valuesFromTopLeftCorner()).map(s).filter((e=>void 0!==e));return t.map((e=>e instanceof C4?e:o(e))).reduce(((e,t)=>e instanceof C4?e:t instanceof C4?t:i(e,t)),e)}if(a.type===H2.CELL_REFERENCE){if(l=s(l),void 0===l)return e}else if(l=this.coerceScalarToNumberOrError(l),l=s(l),void 0===l)return e;return l instanceof C4?l:i(e,o(l))}),n)}evaluateRange(e,t,n,r,i,o,s){let a;try{a=L4.fromAst(e,t.formulaAddress)}catch(u){if(u instanceof c9)return new C4(t4.REF,K2.RangeManySheets);throw u}const l=this.dependencyGraph.getRange(a.start,a.end);if(void 0===l)throw new Error("Range does not exists in graph");let h=l.getFunctionValue(r);if(void 0===h){h=this.getRangeValues(r,a,l,o,s).reduce(((e,t)=>e instanceof C4?e:t instanceof C4?t:i(e,t)),n),l.setFunctionValue(r,h)}return h}getRangeValues(e,t,n,r,i){const o=[],{smallerRangeVertex:s,restRange:a}=this.dependencyGraph.rangeMapping.findSmallerRange(t);let l;if(void 0!==s&&this.dependencyGraph.existsEdge(s,n)){const t=s.getFunctionValue(e);if(void 0!==t)o.push(t);else for(const e of s.range.addresses(this.dependencyGraph)){const t=i(this.dependencyGraph.getScalarValue(e));t instanceof C4?o.push(t):void 0!==t&&o.push(r(t))}l=a}else l=t;for(const h of l.addresses(this.dependencyGraph)){const e=i(this.dependencyGraph.getScalarValue(h));e instanceof C4?o.push(e):void 0!==e&&o.push(r(e))}return o}}function V7(e){return K3(e)||e instanceof C4?e:void 0}function U7(e){return"boolean"==typeof e?W4(e):K3(e)||e instanceof C4?e:"string"==typeof e?0:void 0}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */D7.implementedFunctions={SUM:{method:"sum",parameters:[{argumentType:i5.ANY}],repeatLastArgs:1},SUMSQ:{method:"sumsq",parameters:[{argumentType:i5.ANY}],repeatLastArgs:1},MAX:{method:"max",parameters:[{argumentType:i5.ANY}],repeatLastArgs:1},MIN:{method:"min",parameters:[{argumentType:i5.ANY}],repeatLastArgs:1},MAXA:{method:"maxa",parameters:[{argumentType:i5.ANY}],repeatLastArgs:1},MINA:{method:"mina",parameters:[{argumentType:i5.ANY}],repeatLastArgs:1},COUNT:{method:"count",parameters:[{argumentType:i5.ANY}],repeatLastArgs:1},COUNTA:{method:"counta",parameters:[{argumentType:i5.ANY}],repeatLastArgs:1},AVERAGE:{method:"average",parameters:[{argumentType:i5.ANY}],repeatLastArgs:1},AVERAGEA:{method:"averagea",parameters:[{argumentType:i5.ANY}],repeatLastArgs:1},PRODUCT:{method:"product",parameters:[{argumentType:i5.ANY}],repeatLastArgs:1},"VAR.S":{method:"vars",parameters:[{argumentType:i5.ANY}],repeatLastArgs:1},"VAR.P":{method:"varp",parameters:[{argumentType:i5.ANY}],repeatLastArgs:1},VARA:{method:"vara",parameters:[{argumentType:i5.ANY}],repeatLastArgs:1},VARPA:{method:"varpa",parameters:[{argumentType:i5.ANY}],repeatLastArgs:1},"STDEV.S":{method:"stdevs",parameters:[{argumentType:i5.ANY}],repeatLastArgs:1},"STDEV.P":{method:"stdevp",parameters:[{argumentType:i5.ANY}],repeatLastArgs:1},STDEVA:{method:"stdeva",parameters:[{argumentType:i5.ANY}],repeatLastArgs:1},STDEVPA:{method:"stdevpa",parameters:[{argumentType:i5.ANY}],repeatLastArgs:1},SUBTOTAL:{method:"subtotal",parameters:[{argumentType:i5.NUMBER},{argumentType:i5.ANY}],repeatLastArgs:1}},D7.aliases={VAR:"VAR.S",VARP:"VAR.P",STDEV:"STDEV.S",STDEVP:"STDEV.P",VARS:"VAR.S",STDEVS:"STDEV.S"};class B7 extends o5{power(e,t){return this.runFunction(e.args,t,this.metadata("POWER"),Math.pow)}}B7.implementedFunctions={POWER:{method:"power",parameters:[{argumentType:i5.NUMBER},{argumentType:i5.NUMBER}]}};
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
class W7 extends o5{radians(e,t){return this.runFunction(e.args,t,this.metadata("RADIANS"),(e=>e*(Math.PI/180)))}}W7.implementedFunctions={RADIANS:{method:"radians",parameters:[{argumentType:i5.NUMBER}]}};
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
const j7=10;class G7 extends o5{dec2bin(e,t){return this.runFunction(e.args,t,this.metadata("DEC2BIN"),((e,t)=>$7(e,2,t)))}dec2oct(e,t){return this.runFunction(e.args,t,this.metadata("DEC2OCT"),((e,t)=>$7(e,8,t)))}dec2hex(e,t){return this.runFunction(e.args,t,this.metadata("DEC2HEX"),((e,t)=>$7(e,16,t)))}bin2dec(e,t){return this.runFunction(e.args,t,this.metadata("BIN2DEC"),(e=>{const t=z7(e,2,j7);return void 0===t?new C4(t4.NUM,K2.NotBinary):q7(t,2)}))}bin2oct(e,t){return this.runFunction(e.args,t,this.metadata("BIN2OCT"),((e,t)=>{const n=z7(e,2,j7);return void 0===n?new C4(t4.NUM,K2.NotBinary):$7(q7(n,2),8,t)}))}bin2hex(e,t){return this.runFunction(e.args,t,this.metadata("BIN2HEX"),((e,t)=>{const n=z7(e,2,j7);return void 0===n?new C4(t4.NUM,K2.NotBinary):$7(q7(n,2),16,t)}))}oct2dec(e,t){return this.runFunction(e.args,t,this.metadata("OCT2DEC"),(e=>{const t=z7(e,8,j7);return void 0===t?new C4(t4.NUM,K2.NotOctal):q7(t,8)}))}oct2bin(e,t){return this.runFunction(e.args,t,this.metadata("OCT2BIN"),((e,t)=>{const n=z7(e,8,j7);return void 0===n?new C4(t4.NUM,K2.NotOctal):$7(q7(n,8),2,t)}))}oct2hex(e,t){return this.runFunction(e.args,t,this.metadata("OCT2HEX"),((e,t)=>{const n=z7(e,8,j7);return void 0===n?new C4(t4.NUM,K2.NotOctal):$7(q7(n,8),16,t)}))}hex2dec(e,t){return this.runFunction(e.args,t,this.metadata("HEX2DEC"),(e=>{const t=z7(e,16,j7);return void 0===t?new C4(t4.NUM,K2.NotHex):q7(t,16)}))}hex2bin(e,t){return this.runFunction(e.args,t,this.metadata("HEX2BIN"),((e,t)=>{const n=z7(e,16,j7);return void 0===n?new C4(t4.NUM,K2.NotHex):$7(q7(n,16),2,t)}))}hex2oct(e,t){return this.runFunction(e.args,t,this.metadata("HEX2OCT"),((e,t)=>{const n=z7(e,16,j7);return void 0===n?new C4(t4.NUM,K2.NotHex):$7(q7(n,16),8,t)}))}base(e,t){return this.runFunction(e.args,t,this.metadata("BASE"),K7)}decimal(e,t){return this.runFunction(e.args,t,this.metadata("DECIMAL"),((e,t)=>{const n=z7(e,t,255);return void 0===n?new C4(t4.NUM,K2.NotHex):parseInt(n,t)}))}}function z7(e,t,n){const r="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ".substr(0,t),i=new RegExp(`^[${r}]+$`);if(!(e.length>n)&&i.test(e))return e}function $7(e,t,n){if(e>function(e){return-Y7(e)-1}(t))return new C4(t4.NUM,K2.ValueBaseLarge);if(e<Y7(t))return new C4(t4.NUM,K2.ValueBaseSmall);const r=X7(e,t);return void 0===n||e<0?r:r.length>n?new C4(t4.NUM,K2.ValueBaseLong):K5(r,n)}function Y7(e){return-Math.pow(e,j7)/2}function K7(e,t,n){const r=X7(e,t);return void 0!==n&&n>r.length?K5(r,n):r}function X7(e,t){return(e+(e<0?Math.pow(t,j7):0)).toString(t).toUpperCase()}function q7(e,t){const n=parseInt(e,t),r=Math.pow(t,j7);return n>=r/2?n-r:n}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */G7.implementedFunctions={DEC2BIN:{method:"dec2bin",parameters:[{argumentType:i5.NUMBER},{argumentType:i5.NUMBER,optionalArg:!0,minValue:1,maxValue:10}]},DEC2OCT:{method:"dec2oct",parameters:[{argumentType:i5.NUMBER},{argumentType:i5.NUMBER,optionalArg:!0,minValue:1,maxValue:10}]},DEC2HEX:{method:"dec2hex",parameters:[{argumentType:i5.NUMBER},{argumentType:i5.NUMBER,optionalArg:!0,minValue:1,maxValue:10}]},BIN2DEC:{method:"bin2dec",parameters:[{argumentType:i5.STRING}]},BIN2OCT:{method:"bin2oct",parameters:[{argumentType:i5.STRING},{argumentType:i5.NUMBER,optionalArg:!0,minValue:0,maxValue:j7}]},BIN2HEX:{method:"bin2hex",parameters:[{argumentType:i5.STRING},{argumentType:i5.NUMBER,optionalArg:!0,minValue:0,maxValue:j7}]},OCT2DEC:{method:"oct2dec",parameters:[{argumentType:i5.STRING}]},OCT2BIN:{method:"oct2bin",parameters:[{argumentType:i5.STRING},{argumentType:i5.NUMBER,optionalArg:!0,minValue:0,maxValue:j7}]},OCT2HEX:{method:"oct2hex",parameters:[{argumentType:i5.STRING},{argumentType:i5.NUMBER,optionalArg:!0,minValue:0,maxValue:j7}]},HEX2DEC:{method:"hex2dec",parameters:[{argumentType:i5.STRING}]},HEX2BIN:{method:"hex2bin",parameters:[{argumentType:i5.STRING},{argumentType:i5.NUMBER,optionalArg:!0,minValue:0,maxValue:j7}]},HEX2OCT:{method:"hex2oct",parameters:[{argumentType:i5.STRING},{argumentType:i5.NUMBER,optionalArg:!0,minValue:0,maxValue:j7}]},DECIMAL:{method:"decimal",parameters:[{argumentType:i5.STRING},{argumentType:i5.NUMBER,minValue:2,maxValue:36}]},BASE:{method:"base",parameters:[{argumentType:i5.NUMBER,minValue:0},{argumentType:i5.NUMBER,minValue:2,maxValue:36},{argumentType:i5.NUMBER,optionalArg:!0,minValue:0,maxValue:255}]}};class Q7 extends o5{rand(e,t){return this.runFunction(e.args,t,this.metadata("RAND"),Math.random)}randbetween(e,t){return this.runFunction(e.args,t,this.metadata("RANDBETWEEN"),((e,t)=>t<e?new C4(t4.NUM,K2.WrongOrder):((e=Math.ceil(e))===(t=Math.floor(t)+1)&&(t+=1),e+Math.floor(Math.random()*(t-e)))))}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
function Z7(e){const t=Math.ceil(e);return t%2==1?t:t+1}function J7(e){const t=Math.ceil(e);return t%2==0?t:t+1}Q7.implementedFunctions={RAND:{method:"rand",parameters:[],isVolatile:!0},RANDBETWEEN:{method:"randbetween",parameters:[{argumentType:i5.NUMBER},{argumentType:i5.NUMBER}],isVolatile:!0}};class eee extends o5{roundup(e,t){return this.runFunction(e.args,t,this.metadata("ROUNDDOWN"),((e,t)=>{const n=Math.pow(10,t);return e<0?-Math.ceil(-e*n)/n:Math.ceil(e*n)/n}))}rounddown(e,t){return this.runFunction(e.args,t,this.metadata("ROUNDDOWN"),((e,t)=>{const n=Math.pow(10,t);return e<0?-Math.floor(-e*n)/n:Math.floor(e*n)/n}))}round(e,t){return this.runFunction(e.args,t,this.metadata("ROUND"),((e,t)=>{const n=Math.pow(10,t);return e<0?-Math.round(-e*n)/n:Math.round(e*n)/n}))}intFunc(e,t){return this.runFunction(e.args,t,this.metadata("INT"),(e=>e<0?-Math.floor(-e):Math.floor(e)))}even(e,t){return this.runFunction(e.args,t,this.metadata("EVEN"),(e=>e<0?-J7(-e):J7(e)))}odd(e,t){return this.runFunction(e.args,t,this.metadata("ODD"),(e=>e<0?-Z7(-e):Z7(e)))}ceilingmath(e,t){return this.runFunction(e.args,t,this.metadata("CEILING.MATH"),((e,t,n)=>0===t||0===e?0:(t=Math.abs(t),1===n&&e<0&&(t=-t),Math.ceil(e/t)*t)))}ceiling(e,t){return this.runFunction(e.args,t,this.metadata("CEILING"),((e,t)=>0===e?0:0===t?new C4(t4.DIV_BY_ZERO):e>0&&t<0?new C4(t4.NUM,K2.DistinctSigns):Math.ceil(e/t)*t))}ceilingprecise(e,t){return this.runFunction(e.args,t,this.metadata("CEILING.PRECISE"),((e,t)=>0===t||0===e?0:(t=Math.abs(t),Math.ceil(e/t)*t)))}floormath(e,t){return this.runFunction(e.args,t,this.metadata("FLOOR.MATH"),((e,t,n)=>0===t||0===e?0:(t=Math.abs(t),1===n&&e<0&&(t*=-1),Math.floor(e/t)*t)))}floor(e,t){return this.runFunction(e.args,t,this.metadata("FLOOR"),((e,t)=>0===e?0:0===t?new C4(t4.DIV_BY_ZERO):e>0&&t<0?new C4(t4.NUM,K2.DistinctSigns):Math.floor(e/t)*t))}floorprecise(e,t){return this.runFunction(e.args,t,this.metadata("FLOOR.PRECISE"),((e,t)=>0===t||0===e?0:(t=Math.abs(t),Math.floor(e/t)*t)))}}eee.implementedFunctions={ROUNDUP:{method:"roundup",parameters:[{argumentType:i5.NUMBER},{argumentType:i5.NUMBER,defaultValue:0}]},ROUNDDOWN:{method:"rounddown",parameters:[{argumentType:i5.NUMBER},{argumentType:i5.NUMBER,defaultValue:0}]},ROUND:{method:"round",parameters:[{argumentType:i5.NUMBER},{argumentType:i5.NUMBER,defaultValue:0}]},INT:{method:"intFunc",parameters:[{argumentType:i5.NUMBER}]},EVEN:{method:"even",parameters:[{argumentType:i5.NUMBER}]},ODD:{method:"odd",parameters:[{argumentType:i5.NUMBER}]},"CEILING.MATH":{method:"ceilingmath",parameters:[{argumentType:i5.NUMBER},{argumentType:i5.NUMBER,defaultValue:1},{argumentType:i5.NUMBER,defaultValue:0}]},CEILING:{method:"ceiling",parameters:[{argumentType:i5.NUMBER},{argumentType:i5.NUMBER}]},"CEILING.PRECISE":{method:"ceilingprecise",parameters:[{argumentType:i5.NUMBER},{argumentType:i5.NUMBER,defaultValue:1}]},"FLOOR.MATH":{method:"floormath",parameters:[{argumentType:i5.NUMBER},{argumentType:i5.NUMBER,defaultValue:1},{argumentType:i5.NUMBER,defaultValue:0}]},FLOOR:{method:"floor",parameters:[{argumentType:i5.NUMBER},{argumentType:i5.NUMBER}]},"FLOOR.PRECISE":{method:"floorprecise",parameters:[{argumentType:i5.NUMBER},{argumentType:i5.NUMBER,defaultValue:1}]}},eee.aliases={"ISO.CEILING":"CEILING.PRECISE",TRUNC:"ROUNDDOWN"};
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
class tee extends o5{sqrt(e,t){return this.runFunction(e.args,t,this.metadata("SQRT"),Math.sqrt)}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
function*nee(){}function ree(e){const t=e[Symbol.iterator](),{done:n,value:r}=t.next();return n?{rest:nee()}:{value:r,rest:t}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */tee.implementedFunctions={SQRT:{method:"sqrt",parameters:[{argumentType:i5.NUMBER}]}};class iee{constructor(e,t,n,r,i){this.interpreter=e,this.cacheKey=t,this.reduceInitialValue=n,this.composeFunction=r,this.mapFunction=i,this.dependencyGraph=this.interpreter.dependencyGraph}compute(e,t){for(const i of t)if(!i.conditionRange.sameDimensionsAs(e))return new C4(t4.VALUE,K2.EqualLength);const n=this.tryToGetRangeVertexForRangeValue(e),r=t.map((e=>this.tryToGetRangeVertexForRangeValue(e.conditionRange)));if(n&&r.every((e=>void 0!==e))){const i=t.map((e=>e.criterionPackage.raw)).join(","),o=this.findAlreadyComputedValueInCache(n,this.cacheKey(t),i);if(void 0!==o)return this.interpreter.stats.incrementCriterionFunctionFullCacheUsed(),o;const s=this.buildNewCriterionCache(this.cacheKey(t),t.map((e=>e.conditionRange.range)),e.range);return s.has(i)||s.set(i,[this.evaluateRangeValue(e,t),t.map((e=>e.criterionPackage.lambda))]),n.setCriterionFunctionValues(this.cacheKey(t),s),r.forEach((e=>{void 0!==e&&e.addDependentCacheRange(n)})),s.get(i)[0]}return this.evaluateRangeValue(e,t)}tryToGetRangeVertexForRangeValue(e){const t=e.range;return void 0===t?void 0:this.dependencyGraph.getRange(t.start,t.end)}reduceFunction(e){let t=this.reduceInitialValue;for(const n of e)t=this.composeFunction(t,n);return t}findAlreadyComputedValueInCache(e,t,n){return e.getCriterionFunctionValue(t,n)}evaluateRangeValue(e,t){const n=t.map((e=>e.criterionPackage.lambda)),r=Array.from(e.valuesFromTopLeftCorner()).map(this.mapFunction)[Symbol.iterator](),i=t.map((e=>e.conditionRange.iterateValuesFromTopLeftCorner())),o=aee(n,i,r);return this.reduceFunction(o)}buildNewCriterionCache(e,t,n){const r=this.dependencyGraph.getRange(n.start,n.end),{smallerRangeVertex:i,restConditionRanges:o,restValuesRange:s}=((e,t,n)=>{if(n.end.row>n.start.row){const r=T4(n.end.sheet,n.end.col,n.end.row-1),i=e.getRange(n.start,r);if(void 0!==i)return{smallerRangeVertex:i,restValuesRange:n.withStart(T4(n.start.sheet,n.start.col,n.end.row)),restConditionRanges:t.map((e=>e.withStart(T4(e.start.sheet,e.start.col,e.end.row))))}}return{restValuesRange:n,restConditionRanges:t}})(this.dependencyGraph,t,n);let a;a=void 0!==i&&this.dependencyGraph.existsEdge(i,r)?i.getCriterionFunctionValues(e):new Map;const l=new Map;return a.forEach((([e,t],n)=>{const r=aee(t,o.map((e=>see(this.dependencyGraph,e))),Array.from(see(this.dependencyGraph,s)).map(this.mapFunction)[Symbol.iterator]()),i=this.composeFunction(e,this.reduceFunction(r));this.interpreter.stats.incrementCriterionFunctionPartialCacheUsed(),l.set(n,[i,t])})),l}}class oee{constructor(e,t){this.conditionRange=e,this.criterionPackage=t}}function*see(e,t){for(const n of t.addresses(e))yield U3(e.getScalarValue(n))}function*aee(e,t,n){for(const r of n){const n=t.map((e=>ree(e)));if(!n.every((e=>Object.prototype.hasOwnProperty.call(e,"value"))))return;lee(n.map((e=>U3(e.value))),e).every((([e,t])=>t(e)))&&(yield r),t=n.map((e=>e.rest))}}function lee(e,t){const n=[];for(let r=0;r<Math.min(e.length,t.length);r++)n.push([e[r],t[r]]);return n}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class hee{constructor(e,t){this.sum=e,this.count=t}static single(e){return new hee(e,1)}compose(e){return new hee(this.sum+e.sum,this.count+e.count)}averageValue(){return this.count>0?this.sum/this.count:void 0}}function uee(e){return K3(e)&&!Number.isFinite(U3(e))?0:e}function cee(e){return e instanceof C4?e:K3(e)?U3(e):void 0}hee.empty=new hee(0,0);class dee extends o5{sumif(e,t){const n="SUMIF";return this.runFunction(e.args,t,this.metadata(n),((e,t,r)=>this.computeConditionalAggregationFunction(null!=r?r:e,[e,t],n,0,((e,t)=>this.arithmeticHelper.nonstrictadd(e,t)),cee)))}sumifs(e,t){const n="SUMIFS";return this.runFunction(e.args,t,this.metadata(n),((e,...t)=>this.computeConditionalAggregationFunction(e,t,n,0,((e,t)=>this.arithmeticHelper.nonstrictadd(e,t)),cee)))}averageif(e,t){const n="AVERAGEIF";return this.runFunction(e.args,t,this.metadata(n),((e,t,r)=>{const i=this.computeConditionalAggregationFunction(null!=r?r:e,[e,t],n,hee.empty,((e,t)=>e.compose(t)),(e=>K3(e)?hee.single(U3(e)):hee.empty));return i instanceof C4?i:i.averageValue()||new C4(t4.DIV_BY_ZERO)}))}countif(e,t){const n="COUNTIF";return this.runFunction(e.args,t,this.metadata(n),((e,t)=>this.computeConditionalAggregationFunction(e,[e,t],n,0,((e,t)=>e+t),(()=>1))))}countifs(e,t){const n="COUNTIFS";return this.runFunction(e.args,t,this.metadata(n),((...e)=>this.computeConditionalAggregationFunction(e[0],e,n,0,((e,t)=>e+t),(()=>1))))}minifs(e,t){const n="MINIFS",r=(e,t)=>void 0===t||void 0===e?void 0===t?e:t:Math.min(e,t);return this.runFunction(e.args,t,this.metadata(n),((e,...t)=>uee(this.computeConditionalAggregationFunction(e,t,n,Number.POSITIVE_INFINITY,r,cee))))}maxifs(e,t){const n="MAXIFS",r=(e,t)=>void 0===t||void 0===e?void 0===t?e:t:Math.max(e,t);return this.runFunction(e.args,t,this.metadata(n),((e,...t)=>uee(this.computeConditionalAggregationFunction(e,t,n,Number.NEGATIVE_INFINITY,r,cee))))}computeConditionalAggregationFunction(e,t,n,r,i,o){const s=[];for(let a=0;a<t.length;a+=2){const e=t[a],n=this.interpreter.criterionBuilder.fromCellValue(t[a+1],this.arithmeticHelper);if(void 0===n)return new C4(t4.VALUE,K2.BadCriterion);s.push(new oee(e,n))}return new iee(this.interpreter,function(e){return t=>{const n=t.map((e=>`${e.conditionRange.range.sheet},${e.conditionRange.range.start.col},${e.conditionRange.range.start.row}`));return[e,...n].join(",")}}(n),r,i,o).compute(e,s)}}dee.implementedFunctions={SUMIF:{method:"sumif",parameters:[{argumentType:i5.RANGE},{argumentType:i5.NOERROR},{argumentType:i5.RANGE,optionalArg:!0}]},COUNTIF:{method:"countif",parameters:[{argumentType:i5.RANGE},{argumentType:i5.NOERROR}]},AVERAGEIF:{method:"averageif",parameters:[{argumentType:i5.RANGE},{argumentType:i5.NOERROR},{argumentType:i5.RANGE,optionalArg:!0}]},SUMIFS:{method:"sumifs",parameters:[{argumentType:i5.RANGE},{argumentType:i5.RANGE},{argumentType:i5.NOERROR}],repeatLastArgs:2},COUNTIFS:{method:"countifs",parameters:[{argumentType:i5.RANGE},{argumentType:i5.NOERROR}],repeatLastArgs:2},MINIFS:{method:"minifs",parameters:[{argumentType:i5.RANGE},{argumentType:i5.RANGE},{argumentType:i5.NOERROR}],repeatLastArgs:2},MAXIFS:{method:"maxifs",parameters:[{argumentType:i5.RANGE},{argumentType:i5.RANGE},{argumentType:i5.NOERROR}],repeatLastArgs:2}};
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
class pee extends o5{sumproduct(e,t){return this.runFunction(e.args,t,this.metadata("SUMPRODUCT"),((...e)=>{const t=e[0].width(),n=e[0].height();for(const o of e)if(o.width()!==t||o.height()!==n)return new C4(t4.VALUE,K2.EqualLength);let r=0;const i=e.map((e=>e.iterateValuesFromTopLeftCorner()));for(let o=0;o<t*n;o++){let e=1;for(const t of i){const n=t.next().value;if(n instanceof C4)return n;const r=this.coerceScalarToNumberOrError(n);K3(r)?e*=U3(r):e=0}r+=e}return r}))}}pee.implementedFunctions={SUMPRODUCT:{method:"sumproduct",parameters:[{argumentType:i5.RANGE}],repeatLastArgs:1}};
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
class gee extends o5{concatenate(e,t){return this.runFunction(e.args,t,this.metadata("CONCATENATE"),((...e)=>"".concat(...e)))}split(e,t){return this.runFunction(e.args,t,this.metadata("SPLIT"),((e,t)=>{const n=e.split(" ");return t>=n.length||t<0?new C4(t4.VALUE,K2.IndexBounds):n[t]}))}len(e,t){return this.runFunction(e.args,t,this.metadata("LEN"),(e=>e.length))}lower(e,t){return this.runFunction(e.args,t,this.metadata("LOWER"),(e=>e.toLowerCase()))}trim(e,t){return this.runFunction(e.args,t,this.metadata("TRIM"),(e=>e.replace(/^ +| +$/g,"").replace(/ +/g," ")))}proper(e,t){return this.runFunction(e.args,t,this.metadata("PROPER"),(e=>e.replace(/\p{L}+/gu,(e=>e.charAt(0).toUpperCase()+e.substring(1).toLowerCase()))))}clean(e,t){return this.runFunction(e.args,t,this.metadata("CLEAN"),(e=>e.replace(/[\u0000-\u001F]/g,"")))}exact(e,t){return this.runFunction(e.args,t,this.metadata("EXACT"),((e,t)=>e===t))}rept(e,t){return this.runFunction(e.args,t,this.metadata("REPT"),((e,t)=>t<0?new C4(t4.VALUE,K2.NegativeCount):e.repeat(t)))}right(e,t){return this.runFunction(e.args,t,this.metadata("RIGHT"),((e,t)=>t<0?new C4(t4.VALUE,K2.NegativeLength):0===t?"":e.slice(-t)))}left(e,t){return this.runFunction(e.args,t,this.metadata("LEFT"),((e,t)=>t<0?new C4(t4.VALUE,K2.NegativeLength):e.slice(0,t)))}mid(e,t){return this.runFunction(e.args,t,this.metadata("MID"),((e,t,n)=>t<1?new C4(t4.VALUE,K2.LessThanOne):n<0?new C4(t4.VALUE,K2.NegativeLength):e.substring(t-1,t+n-1)))}replace(e,t){return this.runFunction(e.args,t,this.metadata("REPLACE"),((e,t,n,r)=>t<1?new C4(t4.VALUE,K2.LessThanOne):n<0?new C4(t4.VALUE,K2.NegativeLength):e.substring(0,t-1)+r+e.substring(t+n-1)))}search(e,t){return this.runFunction(e.args,t,this.metadata("SEARCH"),((e,t,n)=>{if(n<1||n>t.length)return new C4(t4.VALUE,K2.LengthBounds);const r=e.toLowerCase(),i=t.substring(n-1).toLowerCase(),o=this.arithmeticHelper.requiresRegex(r)?this.arithmeticHelper.searchString(r,i):i.indexOf(r);return o>-1?o+n:new C4(t4.VALUE,K2.PatternNotFound)}))}substitute(e,t){return this.runFunction(e.args,t,this.metadata("SUBSTITUTE"),((e,t,n,r)=>{const i=this.escapeRegExpSpecialCharacters(t),o=new RegExp(i,"g");if(void 0===r)return e.replace(o,n);if(r<1)return new C4(t4.VALUE,K2.LessThanOne);let s,a=0;for(;null!==(s=o.exec(e));)if(r===++a)return e.substring(0,s.index)+n+e.substring(o.lastIndex);return e}))}find(e,t){return this.runFunction(e.args,t,this.metadata("FIND"),((e,t,n)=>{if(n<1||n>t.length)return new C4(t4.VALUE,K2.IndexBounds);const r=t.substring(n-1).indexOf(e)+n;return r>0?r:new C4(t4.VALUE,K2.PatternNotFound)}))}t(e,t){return this.runFunction(e.args,t,this.metadata("T"),(e=>e instanceof C4||"string"==typeof e?e:""))}upper(e,t){return this.runFunction(e.args,t,this.metadata("UPPER"),(e=>e.toUpperCase()))}escapeRegExpSpecialCharacters(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}}gee.implementedFunctions={CONCATENATE:{method:"concatenate",parameters:[{argumentType:i5.STRING}],repeatLastArgs:1,expandRanges:!0},EXACT:{method:"exact",parameters:[{argumentType:i5.STRING},{argumentType:i5.STRING}]},SPLIT:{method:"split",parameters:[{argumentType:i5.STRING},{argumentType:i5.NUMBER}]},LEN:{method:"len",parameters:[{argumentType:i5.STRING}]},LOWER:{method:"lower",parameters:[{argumentType:i5.STRING}]},MID:{method:"mid",parameters:[{argumentType:i5.STRING},{argumentType:i5.NUMBER},{argumentType:i5.NUMBER}]},TRIM:{method:"trim",parameters:[{argumentType:i5.STRING}]},T:{method:"t",parameters:[{argumentType:i5.SCALAR}]},PROPER:{method:"proper",parameters:[{argumentType:i5.STRING}]},CLEAN:{method:"clean",parameters:[{argumentType:i5.STRING}]},REPT:{method:"rept",parameters:[{argumentType:i5.STRING},{argumentType:i5.NUMBER}]},RIGHT:{method:"right",parameters:[{argumentType:i5.STRING},{argumentType:i5.NUMBER,defaultValue:1}]},LEFT:{method:"left",parameters:[{argumentType:i5.STRING},{argumentType:i5.NUMBER,defaultValue:1}]},REPLACE:{method:"replace",parameters:[{argumentType:i5.STRING},{argumentType:i5.NUMBER},{argumentType:i5.NUMBER},{argumentType:i5.STRING}]},SEARCH:{method:"search",parameters:[{argumentType:i5.STRING},{argumentType:i5.STRING},{argumentType:i5.NUMBER,defaultValue:1}]},SUBSTITUTE:{method:"substitute",parameters:[{argumentType:i5.STRING},{argumentType:i5.STRING},{argumentType:i5.STRING},{argumentType:i5.NUMBER,optionalArg:!0}]},FIND:{method:"find",parameters:[{argumentType:i5.STRING},{argumentType:i5.STRING},{argumentType:i5.NUMBER,defaultValue:1}]},UPPER:{method:"upper",parameters:[{argumentType:i5.STRING}]}};
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
class mee extends o5{acos(e,t){return this.runFunction(e.args,t,this.metadata("ACOS"),Math.acos)}asin(e,t){return this.runFunction(e.args,t,this.metadata("ASIN"),Math.asin)}cos(e,t){return this.runFunction(e.args,t,this.metadata("COS"),Math.cos)}sin(e,t){return this.runFunction(e.args,t,this.metadata("SIN"),Math.sin)}tan(e,t){return this.runFunction(e.args,t,this.metadata("TAN"),Math.tan)}atan(e,t){return this.runFunction(e.args,t,this.metadata("ATAN"),Math.atan)}atan2(e,t){return this.runFunction(e.args,t,this.metadata("ATAN2"),((e,t)=>0===e&&0===t?new C4(t4.DIV_BY_ZERO):Math.atan2(t,e)))}cot(e,t){return this.runFunction(e.args,t,this.metadata("COT"),(e=>0===e?new C4(t4.DIV_BY_ZERO):1/Math.tan(e)))}acot(e,t){return this.runFunction(e.args,t,this.metadata("ACOT"),(e=>0===e?I7/2:Math.atan(1/e)))}sec(e,t){return this.runFunction(e.args,t,this.metadata("SEC"),(e=>1/Math.cos(e)))}csc(e,t){return this.runFunction(e.args,t,this.metadata("CSC"),(e=>0===e?new C4(t4.DIV_BY_ZERO):1/Math.sin(e)))}sinh(e,t){return this.runFunction(e.args,t,this.metadata("SINH"),Math.sinh)}asinh(e,t){return this.runFunction(e.args,t,this.metadata("ASINH"),Math.asinh)}cosh(e,t){return this.runFunction(e.args,t,this.metadata("COSH"),Math.cosh)}acosh(e,t){return this.runFunction(e.args,t,this.metadata("ACOSH"),Math.acosh)}tanh(e,t){return this.runFunction(e.args,t,this.metadata("TANH"),Math.tanh)}atanh(e,t){return this.runFunction(e.args,t,this.metadata("ATANH"),Math.atanh)}coth(e,t){return this.runFunction(e.args,t,this.metadata("COTH"),(e=>0===e?new C4(t4.DIV_BY_ZERO):1/Math.tanh(e)))}acoth(e,t){return this.runFunction(e.args,t,this.metadata("ACOTH"),(e=>0===e?new C4(t4.NUM,K2.NonZero):Math.atanh(1/e)))}sech(e,t){return this.runFunction(e.args,t,this.metadata("SECH"),(e=>1/Math.cosh(e)))}csch(e,t){return this.runFunction(e.args,t,this.metadata("CSCH"),(e=>0===e?new C4(t4.DIV_BY_ZERO):1/Math.sinh(e)))}}mee.implementedFunctions={ACOS:{method:"acos",parameters:[{argumentType:i5.NUMBER}]},ASIN:{method:"asin",parameters:[{argumentType:i5.NUMBER}]},COS:{method:"cos",parameters:[{argumentType:i5.NUMBER}]},SIN:{method:"sin",parameters:[{argumentType:i5.NUMBER}]},TAN:{method:"tan",parameters:[{argumentType:i5.NUMBER}]},ATAN:{method:"atan",parameters:[{argumentType:i5.NUMBER}]},ATAN2:{method:"atan2",parameters:[{argumentType:i5.NUMBER},{argumentType:i5.NUMBER}]},COT:{method:"cot",parameters:[{argumentType:i5.NUMBER}]},SEC:{method:"sec",parameters:[{argumentType:i5.NUMBER}]},CSC:{method:"csc",parameters:[{argumentType:i5.NUMBER}]},SINH:{method:"sinh",parameters:[{argumentType:i5.NUMBER}]},COSH:{method:"cosh",parameters:[{argumentType:i5.NUMBER}]},TANH:{method:"tanh",parameters:[{argumentType:i5.NUMBER}]},COTH:{method:"coth",parameters:[{argumentType:i5.NUMBER}]},SECH:{method:"sech",parameters:[{argumentType:i5.NUMBER}]},CSCH:{method:"csch",parameters:[{argumentType:i5.NUMBER}]},ACOT:{method:"acot",parameters:[{argumentType:i5.NUMBER}]},ASINH:{method:"asinh",parameters:[{argumentType:i5.NUMBER}]},ACOSH:{method:"acosh",parameters:[{argumentType:i5.NUMBER}]},ATANH:{method:"atanh",parameters:[{argumentType:i5.NUMBER}]},ACOTH:{method:"acoth",parameters:[{argumentType:i5.NUMBER}]}};
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
class fee extends O8{constructor(e){super(e),this.dependencyGraph=e}find(e,t,n){return this.basicFind(e,t,"col",n)}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class wee extends o5{constructor(){super(...arguments),this.rowSearch=new fee(this.dependencyGraph)}vlookup(e,t){return this.runFunction(e.args,t,this.metadata("VLOOKUP"),((e,t,n,r)=>{const i=t.range;if(void 0===i)return new C4(t4.VALUE,K2.WrongType);if(n<1)return new C4(t4.VALUE,K2.LessThanOne);if(n>i.width())return new C4(t4.REF,K2.IndexLarge);const o={ordering:r?"asc":"none",ifNoMatch:r?"returnLowerBound":"returnNotFound"};return this.doVlookup($4(e),t,n-1,o)}))}hlookup(e,t){return this.runFunction(e.args,t,this.metadata("HLOOKUP"),((e,t,n,r)=>{const i=t.range;if(void 0===i)return new C4(t4.VALUE,K2.WrongType);if(n<1)return new C4(t4.VALUE,K2.LessThanOne);if(n>i.height())return new C4(t4.REF,K2.IndexLarge);const o={ordering:r?"asc":"none",ifNoMatch:r?"returnLowerBound":"returnNotFound"};return this.doHlookup($4(e),t,n-1,o)}))}xlookup(e,t){return this.runFunction(e.args,t,this.metadata("XLOOKUP"),((e,t,n,r,i,o)=>{if(![0,-1,1,2].includes(i))return new C4(t4.VALUE,K2.BadMode);if(![1,-1,2,-2].includes(o))return new C4(t4.VALUE,K2.BadMode);const s=t instanceof Z3?t:Z3.fromScalar(t),a=n instanceof Z3?n:Z3.fromScalar(n),l=2===i,h={ordering:2===o?"asc":-2===o?"desc":"none",returnOccurrence:-1===o?"last":"first",ifNoMatch:-1===i?"returnLowerBound":1===i?"returnUpperBound":"returnNotFound"};return this.doXlookup($4(e),s,a,r,l,h)}))}xlookupArraySize(e){var t,n;const r=null===(t=null==e?void 0:e.args)||void 0===t?void 0:t[1],i=null===(n=null==e?void 0:e.args)||void 0===n?void 0:n[2];if(null==(null==r?void 0:r.start)||null==(null==r?void 0:r.end)||null==(null==i?void 0:i.start)||null==(null==i?void 0:i.end))return s5.error();const o=r.end.row-r.start.row+1,s=r.end.col-r.start.col+1,a=i.end.row-i.start.row+1,l=i.end.col-i.start.col+1,h=1===s&&a===o;return h||1===o&&l===s?h?new s5(l,1):new s5(1,a):s5.error()}match(e,t){return this.runFunction(e.args,t,this.metadata("MATCH"),((e,t,n)=>this.doMatch($4(e),t,n)))}searchInRange(e,t,n,r,i){return n&&"string"==typeof e&&this.arithmeticHelper.requiresRegex(e)?i.advancedFind(this.arithmeticHelper.eqMatcherFunction(e),t,{returnOccurrence:r.returnOccurrence}):i.find(e,t,r)}doVlookup(e,t,n,r){this.dependencyGraph.stats.start(q3.VLOOKUP);const i=t.range;let o;o=void 0===i?Z3.onlyValues(t.data.map((e=>[e[0]]))):Z3.onlyRange(L4.spanFrom(i.start,1,i.height()),this.dependencyGraph);const s=this.searchInRange(e,o,"none"===r.ordering,r,this.columnSearch);if(this.dependencyGraph.stats.end(q3.VLOOKUP),-1===s)return new C4(t4.NA,K2.ValueNotFound);let a;if(void 0===i)a=t.data[s][n];else{const e=T4(i.sheet,i.start.col+n,i.start.row+s);a=this.dependencyGraph.getCellValue(e)}return a instanceof Z3?new C4(t4.VALUE,K2.WrongType):a}doHlookup(e,t,n,r){const i=t.range;let o;o=void 0===i?Z3.onlyValues([t.data[0]]):Z3.onlyRange(L4.spanFrom(i.start,i.width(),1),this.dependencyGraph);const s=this.searchInRange(e,o,"none"===r.ordering,r,this.rowSearch);if(-1===s)return new C4(t4.NA,K2.ValueNotFound);let a;if(void 0===i)a=t.data[n][s];else{const e=T4(i.sheet,i.start.col+s,i.start.row+n);a=this.dependencyGraph.getCellValue(e)}return a instanceof Z3?new C4(t4.VALUE,K2.WrongType):a}doXlookup(e,t,n,r,i,o){const s=1===t.width()&&n.height()===t.height(),a=1===t.height()&&n.width()===t.width();if(!s&&!a)return new C4(t4.VALUE,K2.WrongDimension);const l=s?this.columnSearch:this.rowSearch,h=this.searchInRange(e,t,i,o,l);if(-1===h)return r==t4.NA?new C4(t4.NA,K2.ValueNotFound):r;const u=s?[n.data[h]]:n.data.map((e=>[e[h]]));return Z3.onlyValues(u)}doMatch(e,t,n){if(![-1,0,1].includes(n))return new C4(t4.VALUE,K2.BadMode);if(t.width()>1&&t.height()>1)return new C4(t4.NA);const r=0===n?{ordering:"none",ifNoMatch:"returnNotFound"}:{ordering:-1===n?"desc":"asc",ifNoMatch:-1===n?"returnUpperBound":"returnLowerBound"},i=(1===t.width()?this.columnSearch:this.rowSearch).find(e,t,r);return-1===i?new C4(t4.NA,K2.ValueNotFound):i+1}}wee.implementedFunctions={VLOOKUP:{method:"vlookup",parameters:[{argumentType:i5.NOERROR},{argumentType:i5.RANGE},{argumentType:i5.NUMBER},{argumentType:i5.BOOLEAN,defaultValue:!0}]},HLOOKUP:{method:"hlookup",parameters:[{argumentType:i5.NOERROR},{argumentType:i5.RANGE},{argumentType:i5.NUMBER},{argumentType:i5.BOOLEAN,defaultValue:!0}]},XLOOKUP:{method:"xlookup",arraySizeMethod:"xlookupArraySize",parameters:[{argumentType:i5.NOERROR},{argumentType:i5.RANGE},{argumentType:i5.RANGE},{argumentType:i5.SCALAR,optionalArg:!0,defaultValue:t4.NA},{argumentType:i5.NUMBER,optionalArg:!0,defaultValue:0},{argumentType:i5.NUMBER,optionalArg:!0,defaultValue:1}]},MATCH:{method:"match",parameters:[{argumentType:i5.NOERROR},{argumentType:i5.RANGE},{argumentType:i5.NUMBER,defaultValue:1}]}};
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
class yee extends o5{roman(e,t){return this.runFunction(e.args,t,this.metadata("ROMAN"),((e,t)=>(e=Math.trunc(e),!1===t?t=4:!0===t&&(t=0),(t=U3(this.coerceScalarToNumberOrError(t)))instanceof C4?t:(t=Math.trunc(t))<0?new C4(t4.VALUE,K2.ValueSmall):t>4?new C4(t4.VALUE,K2.ValueLarge):function(e,t){const n={val:e%1e3,acc:"M".repeat(Math.floor(e/1e3))};4===t&&(Cee(n,"IM",999,1e3),Cee(n,"ID",499,500));t>=3&&(Cee(n,"VM",995,1e3),Cee(n,"VD",495,500));t>=2&&(Cee(n,"XM",990,1e3),Cee(n,"XD",490,500));t>=1&&(Cee(n,"LM",950,1e3),Cee(n,"LD",450,500));Cee(n,"CM",900,1e3),Cee(n,"CD",400,500),Cee(n,"D",500,900),n.acc+="C".repeat(Math.floor(n.val/100)),n.val%=100,t>=2&&(Cee(n,"IC",99,100),Cee(n,"IL",49,50));t>=1&&(Cee(n,"VC",95,100),Cee(n,"VL",45,50));return Cee(n,"XC",90,100),Cee(n,"XL",40,50),Cee(n,"L",50,90),n.acc+="X".repeat(Math.floor(n.val/10)),n.val%=10,Cee(n,"IX",9,10),Cee(n,"IV",4,5),Cee(n,"V",5,9),n.acc+="I".repeat(n.val),n.acc}(e,t))))}arabic(e,t){return this.runFunction(e.args,t,this.metadata("ARABIC"),(e=>{let t=!1;if((e=e.trim().toUpperCase()).startsWith("-")&&(t=!0,""===(e=e.slice(1))))return new C4(t4.VALUE,K2.InvalidRoman);const n={input:e,acc:0};return vee(n,{token:"MMM",val:3e3},{token:"MM",val:2e3},{token:"M",val:1e3}),vee(n,{token:"IM",val:999},{token:"VM",val:995},{token:"XM",val:990},{token:"LM",val:950},{token:"CM",val:900}),vee(n,{token:"D",val:500},{token:"ID",val:499},{token:"VD",val:495},{token:"XD",val:490},{token:"LD",val:450},{token:"CD",val:400}),vee(n,{token:"CCC",val:300},{token:"CC",val:200},{token:"C",val:100}),vee(n,{token:"IC",val:99},{token:"VC",val:95},{token:"XC",val:90}),vee(n,{token:"L",val:50},{token:"IL",val:49},{token:"VL",val:45},{token:"XL",val:40}),vee(n,{token:"XXX",val:30},{token:"XX",val:20},{token:"X",val:10}),vee(n,{token:"IX",val:9}),vee(n,{token:"V",val:5},{token:"IV",val:4}),vee(n,{token:"III",val:3},{token:"II",val:2},{token:"I",val:1}),""!==n.input?new C4(t4.VALUE,K2.InvalidRoman):t?-n.acc:n.acc}))}}function vee(e,...t){for(const n of t)if(e.input.startsWith(n.token)){e.input=e.input.slice(n.token.length),e.acc+=n.val;break}}function Cee(e,t,n,r){e.val>=n&&e.val<r&&(e.val-=n,e.acc+=t)}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */yee.implementedFunctions={ROMAN:{method:"roman",parameters:[{argumentType:i5.NUMBER,minValue:1,lessThan:4e3},{argumentType:i5.NOERROR,optionalArg:!0,defaultValue:0}]},ARABIC:{method:"arabic",parameters:[{argumentType:i5.STRING}]}};class See extends o5{add(e,t){return this.runFunction(e.args,t,this.metadata("HF.ADD"),this.arithmeticHelper.addWithEpsilon)}concat(e,t){return this.runFunction(e.args,t,this.metadata("HF.CONCAT"),this.arithmeticHelper.concat)}divide(e,t){return this.runFunction(e.args,t,this.metadata("HF.DIVIDE"),this.arithmeticHelper.divide)}eq(e,t){return this.runFunction(e.args,t,this.metadata("HF.EQ"),this.arithmeticHelper.eq)}gt(e,t){return this.runFunction(e.args,t,this.metadata("HF.GT"),this.arithmeticHelper.gt)}gte(e,t){return this.runFunction(e.args,t,this.metadata("HF.GTE"),this.arithmeticHelper.geq)}lt(e,t){return this.runFunction(e.args,t,this.metadata("HF.LT"),this.arithmeticHelper.lt)}lte(e,t){return this.runFunction(e.args,t,this.metadata("HF.LTE"),this.arithmeticHelper.leq)}minus(e,t){return this.runFunction(e.args,t,this.metadata("HF.MINUS"),this.arithmeticHelper.subtract)}multiply(e,t){return this.runFunction(e.args,t,this.metadata("HF.MULTIPLY"),this.arithmeticHelper.multiply)}ne(e,t){return this.runFunction(e.args,t,this.metadata("HF.NE"),this.arithmeticHelper.neq)}pow(e,t){return this.runFunction(e.args,t,this.metadata("HF.POW"),this.arithmeticHelper.pow)}uminus(e,t){return this.runFunction(e.args,t,this.metadata("HF.UMINUS"),this.arithmeticHelper.unaryMinus)}upercent(e,t){return this.runFunction(e.args,t,this.metadata("HF.UNARY_PERCENT"),this.arithmeticHelper.unaryPercent)}uplus(e,t){return this.runFunction(e.args,t,this.metadata("HF.UPLUS"),this.arithmeticHelper.unaryPlus)}}See.implementedFunctions={"HF.ADD":{method:"add",parameters:[{argumentType:i5.NUMBER,passSubtype:!0},{argumentType:i5.NUMBER,passSubtype:!0}]},"HF.CONCAT":{method:"concat",parameters:[{argumentType:i5.STRING,passSubtype:!0},{argumentType:i5.STRING,passSubtype:!0}]},"HF.DIVIDE":{method:"divide",parameters:[{argumentType:i5.NUMBER,passSubtype:!0},{argumentType:i5.NUMBER,passSubtype:!0}]},"HF.EQ":{method:"eq",parameters:[{argumentType:i5.NOERROR,passSubtype:!0},{argumentType:i5.NOERROR,passSubtype:!0}]},"HF.GT":{method:"gt",parameters:[{argumentType:i5.NOERROR,passSubtype:!0},{argumentType:i5.NOERROR,passSubtype:!0}]},"HF.GTE":{method:"gte",parameters:[{argumentType:i5.NOERROR,passSubtype:!0},{argumentType:i5.NOERROR,passSubtype:!0}]},"HF.LT":{method:"lt",parameters:[{argumentType:i5.NOERROR,passSubtype:!0},{argumentType:i5.NOERROR,passSubtype:!0}]},"HF.LTE":{method:"lte",parameters:[{argumentType:i5.NOERROR,passSubtype:!0},{argumentType:i5.NOERROR,passSubtype:!0}]},"HF.MINUS":{method:"minus",parameters:[{argumentType:i5.NUMBER,passSubtype:!0},{argumentType:i5.NUMBER,passSubtype:!0}]},"HF.MULTIPLY":{method:"multiply",parameters:[{argumentType:i5.NUMBER,passSubtype:!0},{argumentType:i5.NUMBER,passSubtype:!0}]},"HF.NE":{method:"ne",parameters:[{argumentType:i5.NOERROR,passSubtype:!0},{argumentType:i5.NOERROR,passSubtype:!0}]},"HF.POW":{method:"pow",parameters:[{argumentType:i5.NUMBER,passSubtype:!0},{argumentType:i5.NUMBER,passSubtype:!0}]},"HF.UMINUS":{method:"uminus",parameters:[{argumentType:i5.NUMBER,passSubtype:!0}]},"HF.UNARY_PERCENT":{method:"upercent",parameters:[{argumentType:i5.NUMBER,passSubtype:!0}]},"HF.UPLUS":{method:"uplus",parameters:[{argumentType:i5.NUMBER,passSubtype:!0}]}};
/**
 * @license
 bessel.js (C) 2013-present SheetJS -- http://sheetjs.com

 Apache License
 Version 2.0, January 2004
 http://www.apache.org/licenses/

 TERMS AND CONDITIONS FOR USE, REPRODUCTION, AND DISTRIBUTION

 1. Definitions.

 "License" shall mean the terms and conditions for use, reproduction,
 and distribution as defined by Sections 1 through 9 of this document.

 "Licensor" shall mean the copyright owner or entity authorized by
 the copyright owner that is granting the License.

 "Legal Entity" shall mean the union of the acting entity and all
 other entities that control, are controlled by, or are under common
 control with that entity. For the purposes of this definition,
 "control" means (i) the power, direct or indirect, to cause the
 direction or management of such entity, whether by contract or
 otherwise, or (ii) ownership of fifty percent (50%) or more of the
 outstanding shares, or (iii) beneficial ownership of such entity.

 "You" (or "Your") shall mean an individual or Legal Entity
 exercising permissions granted by this License.

 "Source" form shall mean the preferred form for making modifications,
 including but not limited to software source code, documentation
 source, and configuration files.

 "Object" form shall mean any form resulting from mechanical
 transformation or translation of a Source form, including but
 not limited to compiled object code, generated documentation,
 and conversions to other media types.

 "Work" shall mean the work of authorship, whether in Source or
 Object form, made available under the License, as indicated by a
 copyright notice that is included in or attached to the work
 (an example is provided in the Appendix below).

 "Derivative Works" shall mean any work, whether in Source or Object
 form, that is based on (or derived from) the Work and for which the
 editorial revisions, annotations, elaborations, or other modifications
 represent, as a whole, an original work of authorship. For the purposes
 of this License, Derivative Works shall not include works that remain
 separable from, or merely link (or bind by name) to the interfaces of,
 the Work and Derivative Works thereof.

 "Contribution" shall mean any work of authorship, including
 the original version of the Work and any modifications or additions
 to that Work or Derivative Works thereof, that is intentionally
 submitted to Licensor for inclusion in the Work by the copyright owner
 or by an individual or Legal Entity authorized to submit on behalf of
 the copyright owner. For the purposes of this definition, "submitted"
 means any form of electronic, verbal, or written communication sent
 to the Licensor or its representatives, including but not limited to
 communication on electronic mailing lists, source code control systems,
 and issue tracking systems that are managed by, or on behalf of, the
 Licensor for the purpose of discussing and improving the Work, but
 excluding communication that is conspicuously marked or otherwise
 designated in writing by the copyright owner as "Not a Contribution."

 "Contributor" shall mean Licensor and any individual or Legal Entity
 on behalf of whom a Contribution has been received by Licensor and
 subsequently incorporated within the Work.

 2. Grant of Copyright License. Subject to the terms and conditions of
 this License, each Contributor hereby grants to You a perpetual,
 worldwide, non-exclusive, no-charge, royalty-free, irrevocable
 copyright license to reproduce, prepare Derivative Works of,
 publicly display, publicly perform, sublicense, and distribute the
 Work and such Derivative Works in Source or Object form.

 3. Grant of Patent License. Subject to the terms and conditions of
 this License, each Contributor hereby grants to You a perpetual,
 worldwide, non-exclusive, no-charge, royalty-free, irrevocable
 (except as stated in this section) patent license to make, have made,
 use, offer to sell, sell, import, and otherwise transfer the Work,
 where such license applies only to those patent claims licensable
 by such Contributor that are necessarily infringed by their
 Contribution(s) alone or by combination of their Contribution(s)
 with the Work to which such Contribution(s) was submitted. If You
 institute patent litigation against any entity (including a
 cross-claim or counterclaim in a lawsuit) alleging that the Work
 or a Contribution incorporated within the Work constitutes direct
 or contributory patent infringement, then any patent licenses
 granted to You under this License for that Work shall terminate
 as of the date such litigation is filed.

 4. Redistribution. You may reproduce and distribute copies of the
 Work or Derivative Works thereof in any medium, with or without
 modifications, and in Source or Object form, provided that You
 meet the following conditions:

 (a) You must give any other recipients of the Work or
 Derivative Works a copy of this License; and

 (b) You must cause any modified files to carry prominent notices
 stating that You changed the files; and

 (c) You must retain, in the Source form of any Derivative Works
 that You distribute, all copyright, patent, trademark, and
 attribution notices from the Source form of the Work,
 excluding those notices that do not pertain to any part of
 the Derivative Works; and

 (d) If the Work includes a "NOTICE" text file as part of its
 distribution, then any Derivative Works that You distribute must
 include a readable copy of the attribution notices contained
 within such NOTICE file, excluding those notices that do not
 pertain to any part of the Derivative Works, in at least one
 of the following places: within a NOTICE text file distributed
 as part of the Derivative Works; within the Source form or
 documentation, if provided along with the Derivative Works; or,
 within a display generated by the Derivative Works, if and
 wherever such third-party notices normally appear. The contents
 of the NOTICE file are for informational purposes only and
 do not modify the License. You may add Your own attribution
 notices within Derivative Works that You distribute, alongside
 or as an addendum to the NOTICE text from the Work, provided
 that such additional attribution notices cannot be construed
 as modifying the License.

 You may add Your own copyright statement to Your modifications and
 may provide additional or different license terms and conditions
 for use, reproduction, or distribution of Your modifications, or
 for any such Derivative Works as a whole, provided Your use,
 reproduction, and distribution of the Work otherwise complies with
 the conditions stated in this License.

 5. Submission of Contributions. Unless You explicitly state otherwise,
 any Contribution intentionally submitted for inclusion in the Work
 by You to the Licensor shall be under the terms and conditions of
 this License, without any additional terms or conditions.
 Notwithstanding the above, nothing herein shall supersede or modify
 the terms of any separate license agreement you may have executed
 with Licensor regarding such Contributions.

 6. Trademarks. This License does not grant permission to use the trade
 names, trademarks, service marks, or product names of the Licensor,
 except as required for reasonable and customary use in describing the
 origin of the Work and reproducing the content of the NOTICE file.

 7. Disclaimer of Warranty. Unless required by applicable law or
 agreed to in writing, Licensor provides the Work (and each
 Contributor provides its Contributions) on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or
 implied, including, without limitation, any warranties or conditions
 of TITLE, NON-INFRINGEMENT, MERCHANTABILITY, or FITNESS FOR A
 PARTICULAR PURPOSE. You are solely responsible for determining the
 appropriateness of using or redistributing the Work and assume any
 risks associated with Your exercise of permissions under this License.

 8. Limitation of Liability. In no event and under no legal theory,
 whether in tort (including negligence), contract, or otherwise,
 unless required by applicable law (such as deliberate and grossly
 negligent acts) or agreed to in writing, shall any Contributor be
 liable to You for damages, including any direct, indirect, special,
 incidental, or consequential damages of any character arising as a
 result of this License or out of the use or inability to use the
 Work (including but not limited to damages for loss of goodwill,
 work stoppage, computer failure or malfunction, or any and all
 other commercial damages or losses), even if such Contributor
 has been advised of the possibility of such damages.

 9. Accepting Warranty or Additional Liability. While redistributing
 the Work or Derivative Works thereof, You may choose to offer,
 and charge a fee for, acceptance of support, warranty, indemnity,
 or other liability obligations and/or rights consistent with this
 License. However, in accepting such obligations, You may act only
 on Your own behalf and on Your sole responsibility, not on behalf
 of any other Contributor, and only if You agree to indemnify,
 defend, and hold each Contributor harmless for any liability
 incurred by, or claims asserted against, such Contributor by reason
 of your accepting any such warranty or additional liability.

 END OF TERMS AND CONDITIONS

 APPENDIX: How to apply the Apache License to your work.

 To apply the Apache License to your work, attach the following
 boilerplate notice, with the fields enclosed by brackets "{}"
 replaced with your own identifying information. (Don't include
 the brackets!)  The text should be enclosed in the appropriate
 comment syntax for the file format. We also recommend that a
 file or class name and description of purpose be included on the
 same "printed page" as the copyright notice for easier
 identification within third-party archives.

 Copyright (C) 2013-present   SheetJS LLC

 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

 http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 */
var Ree=Math;function Eee(e,t){for(var n=0,r=0;n<e.length;++n)r=t*r+e[n];return r}function bee(e,t,n,r,i){if(0===t)return n;if(1===t)return r;for(var o=2/e,s=r,a=1;a<t;++a)s=r*a*o+i*n,n=r,r=s;return s}function Tee(e,t,n,r,i){return function(n,o){if(r){if(0===n)return 1==r?-1/0:1/0;if(n<0)return NaN}return 0===o?e(n):1===o?t(n):o<0?NaN:bee(n,o|=0,e(n),t(n),i)}}var Nee,Aee,Mee,Iee,Oee,xee,Pee,_ee,Lee,Hee,kee,Fee,Dee,Vee=function(){var e=.636619772,t=[57568490574,-13362590354,651619640.7,-11214424.18,77392.33017,-184.9052456].reverse(),n=[57568490411,1029532985,9494680.718,59272.64853,267.8532712,1].reverse(),r=[1,-.001098628627,2734510407e-14,-2073370639e-15,2.093887211e-7].reverse(),i=[-.01562499995,.0001430488765,-6911147651e-15,7.621095161e-7,-9.34935152e-8].reverse();function o(o){var s=0,a=0,l=0,h=o*o;if(o<8)s=(a=Eee(t,h))/(l=Eee(n,h));else{var u=o-.785398164;a=Eee(r,h=64/h),l=Eee(i,h),s=Ree.sqrt(e/o)*(Ree.cos(u)*a-Ree.sin(u)*l*8/o)}return s}var s=[72362614232,-7895059235,242396853.1,-2972611.439,15704.4826,-30.16036606].reverse(),a=[144725228442,2300535178,18583304.74,99447.43394,376.9991397,1].reverse(),l=[1,.00183105,-3516396496e-14,2457520174e-15,-2.40337019e-7].reverse(),h=[.04687499995,-.0002002690873,8449199096e-15,-8.8228987e-7,1.05787412e-7].reverse();function u(t){var n=0,r=0,i=0,o=t*t,u=Ree.abs(t)-2.356194491;return Math.abs(t)<8?n=(r=t*Eee(s,o))/(i=Eee(a,o)):(r=Eee(l,o=64/o),i=Eee(h,o),n=Ree.sqrt(e/Ree.abs(t))*(Ree.cos(u)*r-Ree.sin(u)*i*8/Ree.abs(t)),t<0&&(n=-n)),n}return function e(t,n){if(n=Math.round(n),!isFinite(t))return isNaN(t)?t:0;if(n<0)return(n%2?-1:1)*e(t,-n);if(t<0)return(n%2?-1:1)*e(-t,n);if(0===n)return o(t);if(1===n)return u(t);if(0===t)return 0;var r=0;if(t>n)r=bee(t,n,o(t),u(t),-1);else{for(var i=!1,s=0,a=0,l=1,h=0,c=2/t,d=2*Ree.floor((n+Ree.floor(Ree.sqrt(40*n)))/2);d>0;d--)h=d*c*l-s,s=l,l=h,Ree.abs(l)>1e10&&(l*=1e-10,s*=1e-10,r*=1e-10,a*=1e-10),i&&(a+=l),i=!i,d==n&&(r=s);r/=a=2*a-l}return r}}(),Uee=(Nee=.636619772,Aee=[-2957821389,7062834065,-512359803.6,10879881.29,-86327.92757,228.4622733].reverse(),Mee=[40076544269,745249964.8,7189466.438,47447.2647,226.1030244,1].reverse(),Iee=[1,-.001098628627,2734510407e-14,-2073370639e-15,2.093887211e-7].reverse(),Oee=[-.01562499995,.0001430488765,-6911147651e-15,7.621095161e-7,-9.34945152e-8].reverse(),xee=[-4900604943e3,127527439e4,-51534381390,734926455.1,-4237922.726,8511.937935].reverse(),Pee=[249958057e5,424441966400,3733650367,22459040.02,102042.605,354.9632885,1].reverse(),_ee=[1,.00183105,-3516396496e-14,2457520174e-15,-2.40337019e-7].reverse(),Lee=[.04687499995,-.0002002690873,8449199096e-15,-8.8228987e-7,1.05787412e-7].reverse(),Tee((function(e){var t=0,n=0,r=0,i=e*e,o=e-.785398164;return e<8?t=(n=Eee(Aee,i))/(r=Eee(Mee,i))+Nee*Vee(e,0)*Ree.log(e):(n=Eee(Iee,i=64/i),r=Eee(Oee,i),t=Ree.sqrt(Nee/e)*(Ree.sin(o)*n+Ree.cos(o)*r*8/e)),t}),(function(e){var t=0,n=0,r=0,i=e*e,o=e-2.356194491;return e<8?t=(n=e*Eee(xee,i))/(r=Eee(Pee,i))+Nee*(Vee(e,1)*Ree.log(e)-1/e):(n=Eee(_ee,i=64/i),r=Eee(Lee,i),t=Ree.sqrt(Nee/e)*(Ree.sin(o)*n+Ree.cos(o)*r*8/e)),t}),0,1,-1)),Bee=(Hee=[1,3.5156229,3.0899424,1.2067492,.2659732,.0360768,.0045813].reverse(),kee=[.39894228,.01328592,.00225319,-.00157565,.00916281,-.02057706,.02635537,-.01647633,.00392377].reverse(),Fee=[.5,.87890594,.51498869,.15084934,.02658733,.00301532,32411e-8].reverse(),Dee=[.39894228,-.03988024,-.00362018,.00163801,-.01031555,.02282967,-.02895312,.01787654,-.00420059].reverse(),function e(t,n){if(0===(n=Math.round(n)))return function(e){return e<=3.75?Eee(Hee,e*e/14.0625):Ree.exp(Ree.abs(e))/Ree.sqrt(Ree.abs(e))*Eee(kee,3.75/Ree.abs(e))}(t);if(1===n)return function(e){return e<3.75?e*Eee(Fee,e*e/14.0625):(e<0?-1:1)*Ree.exp(Ree.abs(e))/Ree.sqrt(Ree.abs(e))*Eee(Dee,3.75/Ree.abs(e))}(t);if(n<0)return NaN;if(0===Ree.abs(t))return 0;if(t==1/0)return 1/0;var r,i=0,o=2/Ree.abs(t),s=0,a=1,l=0;for(r=2*Ree.round((n+Ree.round(Ree.sqrt(40*n)))/2);r>0;r--)l=r*o*a+s,s=a,a=l,Ree.abs(a)>1e10&&(a*=1e-10,s*=1e-10,i*=1e-10),r==n&&(i=s);return i*=e(t,0)/a,t<0&&n%2?-i:i}),Wee=function(){var e=[-.57721566,.4227842,.23069756,.0348859,.00262698,1075e-7,74e-7].reverse(),t=[1.25331414,-.07832358,.02189568,-.01062446,.00587872,-.0025154,53208e-8].reverse();var n=[1,.15443144,-.67278579,-.18156897,-.01919402,-.00110404,-4686e-8].reverse(),r=[1.25331414,.23498619,-.0365562,.01504268,-.00780353,.00325614,-68245e-8].reverse();return Tee((function(n){return n<=2?-Ree.log(n/2)*Bee(n,0)+Eee(e,n*n/4):Ree.exp(-n)/Ree.sqrt(n)*Eee(t,2/n)}),(function(e){return e<=2?Ree.log(e/2)*Bee(e,1)+1/e*Eee(n,e*e/4):Ree.exp(-e)/Ree.sqrt(e)*Eee(r,2/e)}),0,2,1)}();
/**
 * @license
 Copyright (c) 2013 jStat

 Permission is hereby granted, free of charge, to any person obtaining a copy
 of this software and associated documentation files (the "Software"), to deal
 in the Software without restriction, including without limitation the rights
 to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 copies of the Software, and to permit persons to whom the Software is
 furnished to do so, subject to the following conditions:

 The above copyright notice and this permission notice shall be included in
 all copies or substantial portions of the Software.

 THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 THE SOFTWARE.
 */
function jee(e){const t=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-.000946595344482036,.000366839497852761,42523324806907e-18,-20278578112534e-18,-1624290004647e-18,130365583558e-17,1.5626441722e-8,-8.5238095915e-8,6.529054439e-9,5.059343495e-9,-9.91364156e-10,-2.27365122e-10,96467911e-18,2394038e-18,-6886027e-18,894487e-18,313092e-18,-112708e-18,381e-18,7106e-18,-1523e-18,-94e-18,121e-18,-28e-18];let n,r,i,o,s=t.length-1,a=!1,l=0,h=0;if(0===e)return 0;for(e<0&&(e=-e,a=!0),n=2/(2+e),r=4*n-2;s>0;s--)i=l,l=r*l-h+t[s],h=i;return o=n*Math.exp(-e*e+.5*(t[0]+r*l)-h),a?o-1:1-o}function Gee(e){return 1-jee(e)}function zee(e){let t,n,r,i,o=0;if(e>=2)return-100;if(e<=0)return 100;for(i=e<1?e:2-e,r=Math.sqrt(-2*Math.log(i/2)),t=-.70711*((2.30753+.27061*r)/(1+r*(.99229+.04481*r))-r);o<2;o++)n=Gee(t)-i,t+=n/(1.1283791670955126*Math.exp(-t*t)-t*n);return e<1?t:-t}const $ee=(e,t)=>e<0?0:t*Math.exp(-t*e),Yee=(e,t)=>e<0?0:1-Math.exp(-t*e);function Kee(e){const t=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],n=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535];let r,i,o,s,a=!1,l=0,h=0,u=0,c=e;if(e>171.6243769536076)return 1/0;if(c<=0){if(s=c%1,!s)return 1/0;a=(1&c?-1:1)*Math.PI/Math.sin(Math.PI*s),c=1-c}for(o=c,i=c<1?c++:(c-=l=(0|c)-1)-1,r=0;r<8;++r)u=(u+t[r])*i,h=h*i+n[r];if(s=u/h+1,o<c)s/=o;else if(o>c)for(r=0;r<l;++r)s*=c,c++;return a&&(s=a/s),s}const Xee=function(e,t,n){return e<0?0:0===e&&1===t?1/n:Math.exp((t-1)*Math.log(e)-e/n-Zee(t)-t*Math.log(n))},qee=function(e,t,n){return e<0?0:Jee(t,e/n)},Qee=function(e,t,n){return ete(e,t)*n};function Zee(e){let t=0;const n=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18];let r,i,o,s=1.000000000190015;for(o=(i=r=e)+5.5,o-=(r+.5)*Math.log(o);t<6;t++)s+=n[t]/++i;return Math.log(2.5066282746310007*s/r)-o}function Jee(e,t){const n=Zee(e);let r=e,i=1/e,o=i,s=t+1-e,a=1/1e-30,l=1/s,h=l,u=1;const c=-~(8.5*Math.log(e>=1?e:1/e)+.4*e+17);let d;if(t<0||e<=0)return NaN;if(t<e+1){for(;u<=c;u++)i+=o*=t/++r;return i*Math.exp(-t+e*Math.log(t)-n)}for(;u<=c;u++)d=-u*(u-e),s+=2,l=d*l+s,a=s+d/a,l=1/l,h*=l*a;return 1-h*Math.exp(-t+e*Math.log(t)-n)}function ete(e,t){let n=0;const r=t-1,i=Zee(t);let o,s,a,l,h,u,c;if(e>=1)return Math.max(100,t+100*Math.sqrt(t));if(e<=0)return 0;for(t>1?(u=Math.log(r),c=Math.exp(r*(u-1)-i),h=e<.5?e:1-e,a=Math.sqrt(-2*Math.log(h)),o=(2.30753+.27061*a)/(1+a*(.99229+.04481*a))-a,e<.5&&(o=-o),o=Math.max(.001,t*Math.pow(1-1/(9*t)-o/(3*Math.sqrt(t)),3))):(a=1-t*(.253+.12*t),o=e<a?Math.pow(e/a,1/t):1-Math.log(1-(e-a)/(1-a)));n<12;n++){if(o<=0)return 0;if(s=Jee(t,o)-e,a=t>1?c*Math.exp(-(o-r)+r*(Math.log(o)-u)):Math.exp(-o+r*Math.log(o)-i),l=s/a,o-=a=l/(1-.5*Math.min(1,l*((t-1)/o-1))),o<=0&&(o=.5*(o+a)),Math.abs(a)<1e-8*o)break}return o}const tte=function(e,t,n){return Math.exp(-.5*Math.log(2*Math.PI)-Math.log(n)-Math.pow(e-t,2)/(2*n*n))},nte=function(e,t,n){return.5*(1+jee((e-t)/Math.sqrt(2*n*n)))},rte=function(e,t,n){return-1.4142135623730951*n*zee(2*e)+t},ite=function(e,t,n){return e>1||e<0?0:1==t&&1==n?1:t<512&&n<512?Math.pow(e,t-1)*Math.pow(1-e,n-1)/ate(t,n):Math.exp((t-1)*Math.log(e)+(n-1)*Math.log(1-e)-lte(t,n))},ote=function(e,t,n){return e>1||e<0?+(e>1):ute(e,t,n)},ste=function(e,t,n){return hte(e,t,n)};function ate(e,t){if(!(e<=0||t<=0))return e+t>170?Math.exp(lte(e,t)):Kee(e)*Kee(t)/Kee(e+t)}function lte(e,t){return Zee(e)+Zee(t)-Zee(e+t)}function hte(e,t,n){var r,i,o,s,a,l,h,u,c,d,p=t-1,g=n-1,m=0;if(e<=0)return 0;if(e>=1)return 1;for(t>=1&&n>=1?(o=e<.5?e:1-e,l=(2.30753+.27061*(s=Math.sqrt(-2*Math.log(o))))/(1+s*(.99229+.04481*s))-s,e<.5&&(l=-l),h=(l*l-3)/6,u=2/(1/(2*t-1)+1/(2*n-1)),c=l*Math.sqrt(h+u)/u-(1/(2*n-1)-1/(2*t-1))*(h+5/6-2/(3*u)),l=t/(t+n*Math.exp(2*c))):(r=Math.log(t/(t+n)),i=Math.log(n/(t+n)),l=e<(s=Math.exp(t*r)/t)/(c=s+(a=Math.exp(n*i)/n))?Math.pow(t*c*e,1/t):1-Math.pow(n*c*(1-e),1/n)),d=-Zee(t)-Zee(n)+Zee(t+n);m<10;m++){if(0===l||1===l)return l;if((l-=s=(a=(ute(l,t,n)-e)/(s=Math.exp(p*Math.log(l)+g*Math.log(1-l)+d)))/(1-.5*Math.min(1,a*(p/l-g/(1-l)))))<=0&&(l=.5*(l+s)),l>=1&&(l=.5*(l+s+1)),Math.abs(s)<1e-8*l&&m>0)break}return l}function ute(e,t,n){var r=0===e||1===e?0:Math.exp(Zee(t+n)-Zee(t)-Zee(n)+t*Math.log(e)+n*Math.log(1-e));return!(e<0||e>1)&&(e<(t+1)/(t+n+2)?r*cte(e,t,n)/t:1-r*cte(1-e,n,t)/n)}function cte(e,t,n){var r,i,o,s,a=1e-30,l=1,h=t+n,u=t+1,c=t-1,d=1,p=1-h*e/u;for(Math.abs(p)<a&&(p=a),s=p=1/p;l<=100&&(p=1+(i=l*(n-l)*e/((c+(r=2*l))*(t+r)))*p,Math.abs(p)<a&&(p=a),d=1+i/d,Math.abs(d)<a&&(d=a),s*=(p=1/p)*d,p=1+(i=-(t+l)*(h+l)*e/((t+r)*(u+r)))*p,Math.abs(p)<a&&(p=a),d=1+i/d,Math.abs(d)<a&&(d=a),s*=o=(p=1/p)*d,!(Math.abs(o-1)<3e-7));l++);return s}const dte=function(e,t,n){return 0===n||1===n?t*n===e?1:0:mte(t,e)*Math.pow(n,e)*Math.pow(1-n,t-e)},pte=function(e,t,n){var r,i=1e-10;if(e<0)return 0;if(e>=t)return 1;if(n<0||n>1||t<=0)return NaN;var o=n,s=(e=Math.floor(e))+1,a=t-e,l=s+a,h=Math.exp(Zee(l)-Zee(a)-Zee(s)+s*Math.log(o)+a*Math.log(1-o));return r=o<(s+1)/(l+2)?h*gte(o,s,a,i):1-h*gte(1-o,a,s,i),Math.round(1/i*(1-r))/(1/i)};function gte(e,t,n,r){for(var i,o=0,s=1,a=1,l=1,h=0,u=0;Math.abs((a-u)/a)>r;)u=a,s=l+(i=-(t+h)*(t+n+h)*e/(t+2*h)/(t+2*h+1))*s,a=(o=a+i*o)+(i=(h+=1)*(n-h)*e/(t+2*h-1)/(t+2*h))*a,o/=l=s+i*l,s/=l,a/=l,l=1;return a/t}function mte(e,t){return e>170||t>170?Math.exp(function(e,t){return fte(e)-fte(t)-fte(e-t)}(e,t)):wte(e)/wte(t)/wte(e-t)}function fte(e){return e<0?NaN:Zee(e+1)}function wte(e){return e<0?NaN:Kee(e+1)}const yte=function(e,t){return e<0?0:0===e&&2===t?.5:Math.exp((t/2-1)*Math.log(e)-e/2-t/2*Math.log(2)-Zee(t/2))},vte=function(e,t){return e<0?0:Jee(t/2,e/2)},Cte=function(e,t){return 2*ete(e,.5*t)},Ste=function(e,t,n){return e<0?0:t<=2?0===e&&t<2?1/0:0===e&&2===t?1:1/ate(t/2,n/2)*Math.pow(t/n,t/2)*Math.pow(e,t/2-1)*Math.pow(1+t/n*e,-(t+n)/2):t*(n/(n+e*t))/2*dte((t-2)/2,(t+n-2)/2,t*e/(n+e*t))},Rte=function(e,t,n){return e<0?0:ute(t*e/(t*e+n),t/2,n/2)},Ete=function(e,t,n){return n/(t*(1/hte(e,t/2,n/2)-1))},bte=function(e,t,n){return e<0||t<0||n<0?0:n/t*Math.pow(e/t,n-1)*Math.exp(-Math.pow(e/t,n))},Tte=function(e,t,n){return e<0?0:1-Math.exp(-Math.pow(e/t,n))},Nte={pdf:function(e,t){return t<0||e%1!=0||e<0?0:Math.pow(t,e)*Math.exp(-t)/wte(e)},cdf:function(e,t){var n=0;if(e<0)return 0;for(var r=0;n<=e;n++)r+=Nte.pdf(n,t);return r}},Ate={pdf:function(e,t,n,r){if(e<0||e<n-(t-r))return 0;if(e>r||e>n)return 0;if(2*n>t)return 2*r>t?Ate.pdf(t-n-r+e,t,t-n,t-r):Ate.pdf(r-e,t,t-n,r);if(2*r>t)return Ate.pdf(n-e,t,n,t-r);if(n<r)return Ate.pdf(e,t,r,n);for(var i=1,o=0,s=0;s<e;s++){for(;i>1&&o<r;)i*=1-n/(t-o),o++;i*=(r-s)*(n-s)/((s+1)*(t-n-r+s+1))}for(;o<r;o++)i*=1-n/(t-o);return Math.min(1,Math.max(0,i))},cdf:function e(t,n,r,i){if(t<0||t<r-(n-i))return 0;if(t>=i||t>=r)return 1;if(2*r>n)return 2*i>n?e(n-r-i+t,n,n-r,n-i):1-Ate.cdf(i-t-1,n,n-r,i);if(2*i>n)return 1-Ate.cdf(r-t-1,n,r,n-i);if(r<i)return Ate.cdf(t,n,i,r);for(var o=1,s=1,a=0,l=0;l<t;l++){for(;o>1&&a<i;){var h=1-r/(n-a);s*=h,o*=h,a++}o+=s*=(i-l)*(r-l)/((l+1)*(n-r-i+l+1))}for(;a<i;a++)o*=1-r/(n-a);return Math.min(1,Math.max(0,o))}},Mte=function(e,t){return t=t>1e100?1e100:t,1/(Math.sqrt(t)*ate(.5,t/2))*Math.pow(1+e*e/t,-(t+1)/2)},Ite=function(e,t){var n=t/2;return ute((e+Math.sqrt(e*e+t))/(2*Math.sqrt(e*e+t)),n,n)},Ote=function(e,t){var n=hte(2*Math.min(e,1-e),.5*t,.5);return n=Math.sqrt(t*(1-n)/n),e>.5?n:-n},xte=function(e,t,n){return e<=0?0:Math.exp(-Math.log(e)-.5*Math.log(2*Math.PI)-Math.log(n)-Math.pow(Math.log(e)-t,2)/(2*n*n))},Pte=function(e,t,n){return e<0?0:.5+.5*jee((Math.log(e)-t)/Math.sqrt(2*n*n))},_te=function(e,t,n){return Math.exp(-1.4142135623730951*n*zee(2*e)+t)},Lte={pdf:function(e,t,n){return e===e>>>0&&(e<0?0:mte(e+t-1,t-1)*Math.pow(1-n,e)*Math.pow(n,t))},cdf:function(e,t,n){var r=0,i=0;if(e<0)return 0;for(;i<=e;i++)r+=Lte.pdf(i,t,n);return r}};function Hte(e){for(var t=0,n=e.length;--n>=0;)t+=e[n];return t}function kte(e){return Hte(e)/e.length}function Fte(e){for(var t,n=kte(e),r=0,i=e.length;--i>=0;)r+=(t=e[i]-n)*t;return r}function Dte(e,t){return Fte(e)/(e.length-(t?1:0))}function Vte(e,t){return Math.sqrt(Dte(e,t))}function Ute(e,t){var n,r=kte(e),i=kte(t),o=e.length,s=new Array(o);for(n=0;n<o;n++)s[n]=(e[n]-r)*(t[n]-i);return Hte(s)/(o-1)}function Bte(e,t){return Ute(e,t)/Vte(e,1)/Vte(t,1)}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class Wte extends o5{erf(e,t){return this.runFunction(e.args,t,this.metadata("ERF"),((e,t)=>void 0===t?jee(e):jee(t)-jee(e)))}erfc(e,t){return this.runFunction(e.args,t,this.metadata("ERFC"),Gee)}expondist(e,t){return this.runFunction(e.args,t,this.metadata("EXPON.DIST"),((e,t,n)=>n?Yee(e,t):$ee(e,t)))}fisher(e,t){return this.runFunction(e.args,t,this.metadata("FISHER"),(e=>Math.log((1+e)/(1-e))/2))}fisherinv(e,t){return this.runFunction(e.args,t,this.metadata("FISHERINV"),(e=>1-2/(Math.exp(2*e)+1)))}gamma(e,t){return this.runFunction(e.args,t,this.metadata("GAMMA"),Kee)}gammadist(e,t){return this.runFunction(e.args,t,this.metadata("GAMMA.DIST"),((e,t,n,r)=>r?qee(e,t,n):Xee(e,t,n)))}gammaln(e,t){return this.runFunction(e.args,t,this.metadata("GAMMALN"),Zee)}gammainv(e,t){return this.runFunction(e.args,t,this.metadata("GAMMA.INV"),Qee)}gauss(e,t){return this.runFunction(e.args,t,this.metadata("GAUSS"),(e=>nte(e,0,1)-.5))}betadist(e,t){return this.runFunction(e.args,t,this.metadata("BETA.DIST"),((e,t,n,r,i,o)=>e<=i?new C4(t4.NUM,K2.ValueSmall):e>=o?new C4(t4.NUM,K2.ValueLarge):(e=(e-i)/(o-i),r?ote(e,t,n):ite(e,t,n))))}betainv(e,t){return this.runFunction(e.args,t,this.metadata("BETA.INV"),((e,t,n,r,i)=>r>=i?new C4(t4.NUM,K2.WrongOrder):ste(e,t,n)*(i-r)+r))}binomialdist(e,t){return this.runFunction(e.args,t,this.metadata("BINOM.DIST"),((e,t,n,r)=>e>t?new C4(t4.NUM,K2.WrongOrder):(e=Math.trunc(e),t=Math.trunc(t),r?pte(e,t,n):dte(e,t,n))))}binomialinv(e,t){return this.runFunction(e.args,t,this.metadata("BINOM.INV"),((e,t,n)=>{let r=-1,i=e=Math.trunc(e);for(;i>r+1;){const o=Math.trunc((r+i)/2);pte(o,e,t)>=n?i=o:r=o}return i}))}besselifn(e,t){return this.runFunction(e.args,t,this.metadata("BESSELI"),((e,t)=>Bee(e,Math.trunc(t))))}besseljfn(e,t){return this.runFunction(e.args,t,this.metadata("BESSELJ"),((e,t)=>Vee(e,Math.trunc(t))))}besselkfn(e,t){return this.runFunction(e.args,t,this.metadata("BESSELK"),((e,t)=>Wee(e,Math.trunc(t))))}besselyfn(e,t){return this.runFunction(e.args,t,this.metadata("BESSELY"),((e,t)=>Uee(e,Math.trunc(t))))}chisqdist(e,t){return this.runFunction(e.args,t,this.metadata("CHISQ.DIST"),((e,t,n)=>(t=Math.trunc(t),n?vte(e,t):yte(e,t))))}chisqdistrt(e,t){return this.runFunction(e.args,t,this.metadata("CHISQ.DIST.RT"),((e,t)=>1-vte(e,Math.trunc(t))))}chisqinv(e,t){return this.runFunction(e.args,t,this.metadata("CHISQ.INV"),((e,t)=>Cte(e,Math.trunc(t))))}chisqinvrt(e,t){return this.runFunction(e.args,t,this.metadata("CHISQ.INV.RT"),((e,t)=>Cte(1-e,Math.trunc(t))))}fdist(e,t){return this.runFunction(e.args,t,this.metadata("F.DIST"),((e,t,n,r)=>(t=Math.trunc(t),n=Math.trunc(n),r?Rte(e,t,n):Ste(e,t,n))))}fdistrt(e,t){return this.runFunction(e.args,t,this.metadata("F.DIST.RT"),((e,t,n)=>1-Rte(e,Math.trunc(t),Math.trunc(n))))}finv(e,t){return this.runFunction(e.args,t,this.metadata("F.INV"),((e,t,n)=>Ete(e,Math.trunc(t),Math.trunc(n))))}finvrt(e,t){return this.runFunction(e.args,t,this.metadata("F.INV.RT"),((e,t,n)=>Ete(1-e,Math.trunc(t),Math.trunc(n))))}weibulldist(e,t){return this.runFunction(e.args,t,this.metadata("WEIBULL.DIST"),((e,t,n,r)=>r?Tte(e,n,t):bte(e,n,t)))}poissondist(e,t){return this.runFunction(e.args,t,this.metadata("POISSON.DIST"),((e,t,n)=>(e=Math.trunc(e),n?Nte.cdf(e,t):Nte.pdf(e,t))))}hypgeomdist(e,t){return this.runFunction(e.args,t,this.metadata("HYPGEOM.DIST"),((e,t,n,r,i)=>e>t||e>n||t>r||n>r||e+r<n+t?new C4(t4.NUM,K2.ValueLarge):(e=Math.trunc(e),t=Math.trunc(t),n=Math.trunc(n),r=Math.trunc(r),i?Ate.cdf(e,r,n,t):Ate.pdf(e,r,n,t))))}tdist(e,t){return this.runFunction(e.args,t,this.metadata("T.DIST"),((e,t,n)=>(t=Math.trunc(t),n?Ite(e,t):Mte(e,t))))}tdist2t(e,t){return this.runFunction(e.args,t,this.metadata("T.DIST.2T"),((e,t)=>2*(1-Ite(e,Math.trunc(t)))))}tdistrt(e,t){return this.runFunction(e.args,t,this.metadata("T.DIST.RT"),((e,t)=>1-Ite(e,Math.trunc(t))))}tdistold(e,t){return this.runFunction(e.args,t,this.metadata("TDIST"),((e,t,n)=>n*(1-Ite(e,Math.trunc(t)))))}tinv(e,t){return this.runFunction(e.args,t,this.metadata("T.INV"),((e,t)=>Ote(e,Math.trunc(t))))}tinv2t(e,t){return this.runFunction(e.args,t,this.metadata("T.INV.2T"),((e,t)=>Ote(1-e/2,Math.trunc(t))))}lognormdist(e,t){return this.runFunction(e.args,t,this.metadata("LOGNORM.DIST"),((e,t,n,r)=>r?Pte(e,t,n):xte(e,t,n)))}lognorminv(e,t){return this.runFunction(e.args,t,this.metadata("LOGNORM.INV"),((e,t,n)=>_te(e,t,n)))}normdist(e,t){return this.runFunction(e.args,t,this.metadata("NORM.DIST"),((e,t,n,r)=>r?nte(e,t,n):tte(e,t,n)))}norminv(e,t){return this.runFunction(e.args,t,this.metadata("NORM.INV"),((e,t,n)=>rte(e,t,n)))}normsdist(e,t){return this.runFunction(e.args,t,this.metadata("NORM.S.DIST"),((e,t)=>t?nte(e,0,1):tte(e,0,1)))}normsinv(e,t){return this.runFunction(e.args,t,this.metadata("NORM.S.INV"),(e=>rte(e,0,1)))}phi(e,t){return this.runFunction(e.args,t,this.metadata("PHI"),(e=>tte(e,0,1)))}negbinomdist(e,t){return this.runFunction(e.args,t,this.metadata("NEGBINOM.DIST"),((e,t,n,r)=>(e=Math.trunc(e),t=Math.trunc(t),r?Lte.cdf(e,t,n):Lte.pdf(e,t,n))))}confidencenorm(e,t){return this.runFunction(e.args,t,this.metadata("CONFIDENCE.NORM"),((e,t,n)=>function(){var e,t=[].slice.call(arguments),n=new Array(2);return e=4===t.length?Math.abs(rte(t[1]/2,0,1)*t[2]/Math.sqrt(t[3])):Math.abs(rte(t[1]/2,0,1)*Vte(t[2])/Math.sqrt(t[2].length)),n[0]=t[0]-e,n[1]=t[0]+e,n}(1,e,t,Math.trunc(n))[1]-1))}confidencet(e,t){return this.runFunction(e.args,t,this.metadata("CONFIDENCE.T"),((e,t,n)=>1===(n=Math.trunc(n))?new C4(t4.DIV_BY_ZERO):function(){var e,t=[].slice.call(arguments),n=new Array(2);return e=4===t.length?Math.abs(Ote(t[1]/2,t[3]-1)*t[2]/Math.sqrt(t[3])):Math.abs(Ote(t[1]/2,t[2].length-1)*Vte(t[2],!0)/Math.sqrt(t[2].length)),n[0]=t[0]-e,n[1]=t[0]+e,n}(1,e,t,n)[1]-1))}standardize(e,t){return this.runFunction(e.args,t,this.metadata("STANDARDIZE"),((e,t,n)=>(e-t)/n))}}Wte.implementedFunctions={ERF:{method:"erf",parameters:[{argumentType:i5.NUMBER},{argumentType:i5.NUMBER,optionalArg:!0}]},ERFC:{method:"erfc",parameters:[{argumentType:i5.NUMBER}]},"EXPON.DIST":{method:"expondist",parameters:[{argumentType:i5.NUMBER,minValue:0},{argumentType:i5.NUMBER,greaterThan:0},{argumentType:i5.BOOLEAN}]},FISHER:{method:"fisher",parameters:[{argumentType:i5.NUMBER,greaterThan:-1,lessThan:1}]},FISHERINV:{method:"fisherinv",parameters:[{argumentType:i5.NUMBER}]},GAMMA:{method:"gamma",parameters:[{argumentType:i5.NUMBER}]},"GAMMA.DIST":{method:"gammadist",parameters:[{argumentType:i5.NUMBER,minValue:0},{argumentType:i5.NUMBER,greaterThan:0},{argumentType:i5.NUMBER,greaterThan:0},{argumentType:i5.BOOLEAN}]},GAMMALN:{method:"gammaln",parameters:[{argumentType:i5.NUMBER,greaterThan:0}]},"GAMMA.INV":{method:"gammainv",parameters:[{argumentType:i5.NUMBER,minValue:0,lessThan:1},{argumentType:i5.NUMBER,greaterThan:0},{argumentType:i5.NUMBER,greaterThan:0}]},GAUSS:{method:"gauss",parameters:[{argumentType:i5.NUMBER}]},"BETA.DIST":{method:"betadist",parameters:[{argumentType:i5.NUMBER},{argumentType:i5.NUMBER,greaterThan:0},{argumentType:i5.NUMBER,greaterThan:0},{argumentType:i5.BOOLEAN},{argumentType:i5.NUMBER,defaultValue:0},{argumentType:i5.NUMBER,defaultValue:1}]},"BETA.INV":{method:"betainv",parameters:[{argumentType:i5.NUMBER,greaterThan:0,maxValue:1},{argumentType:i5.NUMBER,greaterThan:0},{argumentType:i5.NUMBER,greaterThan:0},{argumentType:i5.NUMBER,defaultValue:0},{argumentType:i5.NUMBER,defaultValue:1}]},"BINOM.DIST":{method:"binomialdist",parameters:[{argumentType:i5.NUMBER,minValue:0},{argumentType:i5.NUMBER,minValue:0},{argumentType:i5.NUMBER,minValue:0,maxValue:1},{argumentType:i5.BOOLEAN}]},"BINOM.INV":{method:"binomialinv",parameters:[{argumentType:i5.NUMBER,minValue:0},{argumentType:i5.NUMBER,minValue:0,maxValue:1},{argumentType:i5.NUMBER,greaterThan:0,lessThan:1}]},BESSELI:{method:"besselifn",parameters:[{argumentType:i5.NUMBER},{argumentType:i5.NUMBER,minValue:0}]},BESSELJ:{method:"besseljfn",parameters:[{argumentType:i5.NUMBER},{argumentType:i5.NUMBER,minValue:0}]},BESSELK:{method:"besselkfn",parameters:[{argumentType:i5.NUMBER},{argumentType:i5.NUMBER,minValue:0}]},BESSELY:{method:"besselyfn",parameters:[{argumentType:i5.NUMBER},{argumentType:i5.NUMBER,minValue:0}]},"CHISQ.DIST":{method:"chisqdist",parameters:[{argumentType:i5.NUMBER},{argumentType:i5.NUMBER,minValue:1,maxValue:1e10},{argumentType:i5.BOOLEAN}]},"CHISQ.DIST.RT":{method:"chisqdistrt",parameters:[{argumentType:i5.NUMBER},{argumentType:i5.NUMBER,minValue:1,maxValue:1e10}]},"CHISQ.INV":{method:"chisqinv",parameters:[{argumentType:i5.NUMBER,minValue:0,maxValue:1},{argumentType:i5.NUMBER,minValue:1,maxValue:1e10}]},"CHISQ.INV.RT":{method:"chisqinvrt",parameters:[{argumentType:i5.NUMBER,minValue:0,maxValue:1},{argumentType:i5.NUMBER,minValue:1}]},"F.DIST":{method:"fdist",parameters:[{argumentType:i5.NUMBER,minValue:0},{argumentType:i5.NUMBER,minValue:1},{argumentType:i5.NUMBER,minValue:1},{argumentType:i5.BOOLEAN}]},"F.DIST.RT":{method:"fdistrt",parameters:[{argumentType:i5.NUMBER,minValue:0},{argumentType:i5.NUMBER,minValue:1},{argumentType:i5.NUMBER,minValue:1}]},"F.INV":{method:"finv",parameters:[{argumentType:i5.NUMBER,minValue:0,maxValue:1},{argumentType:i5.NUMBER,minValue:1},{argumentType:i5.NUMBER,minValue:1}]},"F.INV.RT":{method:"finvrt",parameters:[{argumentType:i5.NUMBER,minValue:0,maxValue:1},{argumentType:i5.NUMBER,minValue:1},{argumentType:i5.NUMBER,minValue:1}]},"WEIBULL.DIST":{method:"weibulldist",parameters:[{argumentType:i5.NUMBER,minValue:0},{argumentType:i5.NUMBER,greaterThan:0},{argumentType:i5.NUMBER,greaterThan:0},{argumentType:i5.BOOLEAN}]},"POISSON.DIST":{method:"poissondist",parameters:[{argumentType:i5.NUMBER,minValue:0},{argumentType:i5.NUMBER,minValue:0},{argumentType:i5.BOOLEAN}]},"HYPGEOM.DIST":{method:"hypgeomdist",parameters:[{argumentType:i5.NUMBER,minValue:0},{argumentType:i5.NUMBER,greaterThan:0},{argumentType:i5.NUMBER,greaterThan:0},{argumentType:i5.NUMBER,greaterThan:0},{argumentType:i5.BOOLEAN}]},"T.DIST":{method:"tdist",parameters:[{argumentType:i5.NUMBER},{argumentType:i5.NUMBER,minValue:1},{argumentType:i5.BOOLEAN}]},"T.DIST.2T":{method:"tdist2t",parameters:[{argumentType:i5.NUMBER,minValue:0},{argumentType:i5.NUMBER,minValue:1}]},"T.DIST.RT":{method:"tdistrt",parameters:[{argumentType:i5.NUMBER},{argumentType:i5.NUMBER,minValue:1}]},TDIST:{method:"tdistold",parameters:[{argumentType:i5.NUMBER,minValue:0},{argumentType:i5.NUMBER,minValue:1},{argumentType:i5.INTEGER,minValue:1,maxValue:2}]},"T.INV":{method:"tinv",parameters:[{argumentType:i5.NUMBER,greaterThan:0,lessThan:1},{argumentType:i5.NUMBER,minValue:1}]},"T.INV.2T":{method:"tinv2t",parameters:[{argumentType:i5.NUMBER,greaterThan:0,maxValue:1},{argumentType:i5.NUMBER,minValue:1}]},"LOGNORM.DIST":{method:"lognormdist",parameters:[{argumentType:i5.NUMBER,greaterThan:0},{argumentType:i5.NUMBER},{argumentType:i5.NUMBER,greaterThan:0},{argumentType:i5.BOOLEAN}]},"LOGNORM.INV":{method:"lognorminv",parameters:[{argumentType:i5.NUMBER,greaterThan:0,lessThan:1},{argumentType:i5.NUMBER},{argumentType:i5.NUMBER,greaterThan:0}]},"NORM.DIST":{method:"normdist",parameters:[{argumentType:i5.NUMBER},{argumentType:i5.NUMBER},{argumentType:i5.NUMBER,greaterThan:0},{argumentType:i5.BOOLEAN}]},"NORM.INV":{method:"norminv",parameters:[{argumentType:i5.NUMBER,greaterThan:0,lessThan:1},{argumentType:i5.NUMBER},{argumentType:i5.NUMBER,greaterThan:0}]},"NORM.S.DIST":{method:"normsdist",parameters:[{argumentType:i5.NUMBER},{argumentType:i5.BOOLEAN}]},"NORM.S.INV":{method:"normsinv",parameters:[{argumentType:i5.NUMBER,greaterThan:0,lessThan:1}]},PHI:{method:"phi",parameters:[{argumentType:i5.NUMBER}]},"NEGBINOM.DIST":{method:"negbinomdist",parameters:[{argumentType:i5.NUMBER,minValue:0},{argumentType:i5.NUMBER,minValue:1},{argumentType:i5.NUMBER,minValue:0,maxValue:1},{argumentType:i5.BOOLEAN}]},"CONFIDENCE.NORM":{method:"confidencenorm",parameters:[{argumentType:i5.NUMBER,greaterThan:0,lessThan:1},{argumentType:i5.NUMBER,greaterThan:0},{argumentType:i5.NUMBER,minValue:1}]},"CONFIDENCE.T":{method:"confidencet",parameters:[{argumentType:i5.NUMBER,greaterThan:0,lessThan:1},{argumentType:i5.NUMBER,greaterThan:0},{argumentType:i5.NUMBER,minValue:1}]},STANDARDIZE:{method:"standardize",parameters:[{argumentType:i5.NUMBER},{argumentType:i5.NUMBER},{argumentType:i5.NUMBER,greaterThan:0}]}},Wte.aliases={NEGBINOMDIST:"NEGBINOM.DIST",EXPONDIST:"EXPON.DIST",BETADIST:"BETA.DIST",NORMDIST:"NORM.DIST",NORMINV:"NORM.INV",NORMSDIST:"NORM.S.DIST",NORMSINV:"NORM.S.INV",LOGNORMDIST:"LOGNORM.DIST",LOGINV:"LOGNORM.INV",TINV:"T.INV.2T",HYPGEOMDIST:"HYPGEOM.DIST",POISSON:"POISSON.DIST",WEIBULL:"WEIBULL.DIST",FINV:"F.INV.RT",FDIST:"F.DIST.RT",CHIDIST:"CHISQ.DIST.RT",CHIINV:"CHISQ.INV.RT",GAMMADIST:"GAMMA.DIST","GAMMALN.PRECISE":"GAMMALN",GAMMAINV:"GAMMA.INV",BETAINV:"BETA.INV",BINOMDIST:"BINOM.DIST",CONFIDENCE:"CONFIDENCE.NORM",CRITBINOM:"BINOM.INV",WEIBULLDIST:"WEIBULL.DIST",TINV2T:"T.INV.2T",TDISTRT:"T.DIST.RT",TDIST2T:"T.DIST.2T",FINVRT:"F.INV.RT",FDISTRT:"F.DIST.RT",CHIDISTRT:"CHISQ.DIST.RT",CHIINVRT:"CHISQ.INV.RT",LOGNORMINV:"LOGNORM.INV",POISSONDIST:"POISSON.DIST"};
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
class jte extends o5{fact(e,t){return this.runFunction(e.args,t,this.metadata("FACT"),(e=>{e=Math.trunc(e);let t=1;for(let n=1;n<=e;n++)t*=n;return t}))}factdouble(e,t){return this.runFunction(e.args,t,this.metadata("FACTDOUBLE"),(e=>{let t=1;for(let n=e=Math.trunc(e);n>=1;n-=2)t*=n;return t}))}combin(e,t){return this.runFunction(e.args,t,this.metadata("COMBIN"),((e,t)=>t>e?new C4(t4.NUM,K2.WrongOrder):Gte(e=Math.trunc(e),t=Math.trunc(t))))}combina(e,t){return this.runFunction(e.args,t,this.metadata("COMBINA"),((e,t)=>(e=Math.trunc(e))+(t=Math.trunc(t))-1>=1030?new C4(t4.NUM,K2.ValueLarge):0===e&&0===t?1:Gte(e+t-1,t)))}gcd(e,t){return this.runFunction(e.args,t,this.metadata("GCD"),((...e)=>{const t=this.arithmeticHelper.coerceNumbersCoerceRangesDropNulls(e);if(t instanceof C4)return t;let n=0;for(const r of t){if(r<0)return new C4(t4.NUM,K2.ValueSmall);n=zte(n,Math.trunc(r))}return n>Number.MAX_SAFE_INTEGER?new C4(t4.NUM,K2.ValueLarge):n}))}lcm(e,t){return this.runFunction(e.args,t,this.metadata("LCM"),((...e)=>{const t=this.arithmeticHelper.coerceNumbersCoerceRangesDropNulls(e);if(t instanceof C4)return t;let n=1;for(const r of t){if(r<0)return new C4(t4.NUM,K2.ValueSmall);n=$te(n,Math.trunc(r))}return n>Number.MAX_SAFE_INTEGER?new C4(t4.NUM,K2.ValueLarge):n}))}mround(e,t){return this.runFunction(e.args,t,this.metadata("MROUND"),((e,t)=>0===t?0:e>0&&t<0||e<0&&t>0?new C4(t4.NUM,K2.DistinctSigns):Math.round(e/t)*t))}multinomial(e,t){return this.runFunction(e.args,t,this.metadata("MULTINOMIAL"),((...e)=>{let t=0,n=1;for(let r of e){if(r<0)return new C4(t4.NUM,K2.ValueSmall);r=Math.trunc(r);for(let e=1;e<=r;e++)n*=(t+e)/e;t+=r}return Math.round(n)}))}quotient(e,t){return this.runFunction(e.args,t,this.metadata("QUOTIENT"),((e,t)=>0===t?new C4(t4.DIV_BY_ZERO):Math.trunc(e/t)))}seriessum(e,t){return this.runFunction(e.args,t,this.metadata("SERIESSUM"),((e,t,n,r)=>{const i=this.arithmeticHelper.manyToOnlyNumbersDropNulls(r.valuesFromTopLeftCorner());if(i instanceof C4)return i;let o=0;i.reverse();for(const s of i)o*=Math.pow(e,n),o+=s;return o*Math.pow(e,t)}))}sign(e,t){return this.runFunction(e.args,t,this.metadata("SIGN"),(e=>e>0?1:e<0?-1:0))}sumx2my2(e,t){return this.runFunction(e.args,t,this.metadata("SUMX2MY2"),((e,t)=>{const n=e.valuesFromTopLeftCorner(),r=t.valuesFromTopLeftCorner();if(n.length!==r.length)return new C4(t4.NA,K2.EqualLength);const i=n.length;let o=0;for(let s=0;s<i;s++){const e=n[s],t=r[s];if(e instanceof C4)return e;if(t instanceof C4)return t;"number"==typeof e&&"number"==typeof t&&(o+=Math.pow(e,2)-Math.pow(t,2))}return o}))}sumx2py2(e,t){return this.runFunction(e.args,t,this.metadata("SUMX2PY2"),((e,t)=>{const n=e.valuesFromTopLeftCorner(),r=t.valuesFromTopLeftCorner();if(n.length!==r.length)return new C4(t4.NA,K2.EqualLength);const i=n.length;let o=0;for(let s=0;s<i;s++){const e=n[s],t=r[s];if(e instanceof C4)return e;if(t instanceof C4)return t;"number"==typeof e&&"number"==typeof t&&(o+=Math.pow(e,2)+Math.pow(t,2))}return o}))}sumxmy2(e,t){return this.runFunction(e.args,t,this.metadata("SUMXMY2"),((e,t)=>{const n=e.valuesFromTopLeftCorner(),r=t.valuesFromTopLeftCorner();if(n.length!==r.length)return new C4(t4.NA,K2.EqualLength);const i=n.length;let o=0;for(let s=0;s<i;s++){const e=n[s],t=r[s];if(e instanceof C4)return e;if(t instanceof C4)return t;"number"==typeof e&&"number"==typeof t&&(o+=Math.pow(e-t,2))}return o}))}}function Gte(e,t){2*t>e&&(t=e-t);let n=1;for(let r=1;r<=t;r++)n*=(e-t+r)/r;return Math.round(n)}function zte(e,t){for(e<t&&([e,t]=[t,e]);t>0;)[e,t]=[t,e%t];return e}function $te(e,t){return 0===e||0===t?0:e*(t/zte(e,t))}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */jte.implementedFunctions={FACT:{method:"fact",parameters:[{argumentType:i5.NUMBER,minValue:0,maxValue:170}]},FACTDOUBLE:{method:"factdouble",parameters:[{argumentType:i5.NUMBER,minValue:0,maxValue:288}]},COMBIN:{method:"combin",parameters:[{argumentType:i5.NUMBER,minValue:0,lessThan:1030},{argumentType:i5.NUMBER,minValue:0}]},COMBINA:{method:"combina",parameters:[{argumentType:i5.NUMBER,minValue:0},{argumentType:i5.NUMBER,minValue:0}]},GCD:{method:"gcd",parameters:[{argumentType:i5.ANY}],repeatLastArgs:1},LCM:{method:"lcm",parameters:[{argumentType:i5.ANY}],repeatLastArgs:1},MROUND:{method:"mround",parameters:[{argumentType:i5.NUMBER},{argumentType:i5.NUMBER}]},MULTINOMIAL:{method:"multinomial",parameters:[{argumentType:i5.NUMBER}],repeatLastArgs:1,expandRanges:!0},QUOTIENT:{method:"quotient",parameters:[{argumentType:i5.NUMBER},{argumentType:i5.NUMBER}]},SERIESSUM:{method:"seriessum",parameters:[{argumentType:i5.NUMBER},{argumentType:i5.NUMBER},{argumentType:i5.NUMBER},{argumentType:i5.RANGE}]},SIGN:{method:"sign",parameters:[{argumentType:i5.NUMBER}]},SUMX2MY2:{method:"sumx2my2",parameters:[{argumentType:i5.RANGE},{argumentType:i5.RANGE}]},SUMX2PY2:{method:"sumx2py2",parameters:[{argumentType:i5.RANGE},{argumentType:i5.RANGE}]},SUMXMY2:{method:"sumxmy2",parameters:[{argumentType:i5.RANGE},{argumentType:i5.RANGE}]}};class Yte extends o5{complex(e,t){return this.runFunction(e.args,t,this.metadata("COMPLEX"),((e,t,n)=>"i"!==n&&"j"!==n?new C4(t4.VALUE,K2.ShouldBeIorJ):U4([e,t],n)))}imabs(e,t){return this.runFunction(e.args,t,this.metadata("IMABS"),nne)}imaginary(e,t){return this.runFunction(e.args,t,this.metadata("IMAGINARY"),(([e,t])=>t))}imreal(e,t){return this.runFunction(e.args,t,this.metadata("IMREAL"),(([e,t])=>e))}imargument(e,t){return this.runFunction(e.args,t,this.metadata("IMARGUMENT"),(([e,t])=>0===e&&0===t?new C4(t4.DIV_BY_ZERO):Math.atan2(t,e)))}imconjugate(e,t){return this.runFunction(e.args,t,this.metadata("IMCONJUGATE"),(([e,t])=>U4([e,-t])))}imcos(e,t){return this.runFunction(e.args,t,this.metadata("IMCOS"),(e=>U4(Qte(e))))}imcosh(e,t){return this.runFunction(e.args,t,this.metadata("IMCOSH"),(e=>U4(Zte(e))))}imcot(e,t){return this.runFunction(e.args,t,this.metadata("IMCOT"),(e=>U4(qte(Qte(e),Jte(e)))))}imcsc(e,t){return this.runFunction(e.args,t,this.metadata("IMCSC"),(e=>U4(qte([1,0],Jte(e)))))}imcsch(e,t){return this.runFunction(e.args,t,this.metadata("IMCSCH"),(e=>U4(qte([1,0],ene(e)))))}imsec(e,t){return this.runFunction(e.args,t,this.metadata("IMSEC"),(e=>U4(qte([1,0],Qte(e)))))}imsech(e,t){return this.runFunction(e.args,t,this.metadata("IMSECH"),(e=>U4(qte([1,0],Zte(e)))))}imsin(e,t){return this.runFunction(e.args,t,this.metadata("IMSIN"),(e=>U4(Jte(e))))}imsinh(e,t){return this.runFunction(e.args,t,this.metadata("IMSINH"),(e=>U4(ene(e))))}imtan(e,t){return this.runFunction(e.args,t,this.metadata("IMTAN"),(e=>U4(qte(Jte(e),Qte(e)))))}imdiv(e,t){return this.runFunction(e.args,t,this.metadata("IMDIV"),((e,t)=>U4(qte(e,t))))}improduct(e,t){return this.runFunction(e.args,t,this.metadata("IMPRODUCT"),((...e)=>{const t=this.arithmeticHelper.coerceComplexExactRanges(e);if(t instanceof C4)return t;let n=[1,0];for(const r of t)n=Xte(n,r);return U4(n)}))}imsum(e,t){return this.runFunction(e.args,t,this.metadata("IMSUM"),((...e)=>{const t=this.arithmeticHelper.coerceComplexExactRanges(e);if(t instanceof C4)return t;let n=[0,0];for(const r of t)n=Kte(n,r);return U4(n)}))}imsub(e,t){return this.runFunction(e.args,t,this.metadata("IMSUB"),((e,t)=>U4(function([e,t],[n,r]){return[e-n,t-r]}(e,t))))}imexp(e,t){return this.runFunction(e.args,t,this.metadata("IMEXP"),(e=>U4(tne(e))))}imln(e,t){return this.runFunction(e.args,t,this.metadata("IMLN"),(e=>U4(rne(e))))}imlog10(e,t){return this.runFunction(e.args,t,this.metadata("IMLOG10"),(e=>{const[t,n]=rne(e),r=Math.log(10);return U4([t/r,n/r])}))}imlog2(e,t){return this.runFunction(e.args,t,this.metadata("IMLOG2"),(e=>{const[t,n]=rne(e),r=Math.log(2);return U4([t/r,n/r])}))}impower(e,t){return this.runFunction(e.args,t,this.metadata("IMPOWER"),((e,t)=>U4(ine(e,t))))}imsqrt(e,t){return this.runFunction(e.args,t,this.metadata("IMSQRT"),(e=>U4(ine(e,.5))))}}function Kte([e,t],[n,r]){return[e+n,t+r]}function Xte([e,t],[n,r]){return[e*n-t*r,e*r+n*t]}function qte([e,t],[n,r]){const i=Math.pow(n,2)+Math.pow(r,2),[o,s]=Xte([e,t],[n,-r]);return[o/i,s/i]}function Qte([e,t]){return[Math.cos(e)*Math.cosh(t),-Math.sin(e)*Math.sinh(t)]}function Zte([e,t]){return[Math.cosh(e)*Math.cos(t),Math.sinh(e)*Math.sin(t)]}function Jte([e,t]){return[Math.sin(e)*Math.cosh(t),Math.cos(e)*Math.sinh(t)]}function ene([e,t]){return[Math.sinh(e)*Math.cos(t),Math.cosh(e)*Math.sin(t)]}function tne([e,t]){return[Math.exp(e)*Math.cos(t),Math.exp(e)*Math.sin(t)]}function nne([e,t]){return Math.sqrt(e*e+t*t)}function rne([e,t]){return[Math.log(nne([e,t])),Math.atan2(t,e)]}function ine(e,t){const[n,r]=rne(e);return tne([t*n,t*r])}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */Yte.implementedFunctions={COMPLEX:{method:"complex",parameters:[{argumentType:i5.NUMBER},{argumentType:i5.NUMBER},{argumentType:i5.STRING,defaultValue:"i"}]},IMABS:{method:"imabs",parameters:[{argumentType:i5.COMPLEX}]},IMAGINARY:{method:"imaginary",parameters:[{argumentType:i5.COMPLEX}]},IMREAL:{method:"imreal",parameters:[{argumentType:i5.COMPLEX}]},IMARGUMENT:{method:"imargument",parameters:[{argumentType:i5.COMPLEX}]},IMCONJUGATE:{method:"imconjugate",parameters:[{argumentType:i5.COMPLEX}]},IMCOS:{method:"imcos",parameters:[{argumentType:i5.COMPLEX}]},IMCOSH:{method:"imcosh",parameters:[{argumentType:i5.COMPLEX}]},IMCOT:{method:"imcot",parameters:[{argumentType:i5.COMPLEX}]},IMCSC:{method:"imcsc",parameters:[{argumentType:i5.COMPLEX}]},IMCSCH:{method:"imcsch",parameters:[{argumentType:i5.COMPLEX}]},IMSEC:{method:"imsec",parameters:[{argumentType:i5.COMPLEX}]},IMSECH:{method:"imsech",parameters:[{argumentType:i5.COMPLEX}]},IMSIN:{method:"imsin",parameters:[{argumentType:i5.COMPLEX}]},IMSINH:{method:"imsinh",parameters:[{argumentType:i5.COMPLEX}]},IMTAN:{method:"imtan",parameters:[{argumentType:i5.COMPLEX}]},IMDIV:{method:"imdiv",parameters:[{argumentType:i5.COMPLEX},{argumentType:i5.COMPLEX}]},IMPRODUCT:{method:"improduct",parameters:[{argumentType:i5.ANY}],repeatLastArgs:1},IMSUM:{method:"imsum",parameters:[{argumentType:i5.ANY}],repeatLastArgs:1},IMSUB:{method:"imsub",parameters:[{argumentType:i5.COMPLEX},{argumentType:i5.COMPLEX}]},IMEXP:{method:"imexp",parameters:[{argumentType:i5.COMPLEX}]},IMLN:{method:"imln",parameters:[{argumentType:i5.COMPLEX}]},IMLOG10:{method:"imlog10",parameters:[{argumentType:i5.COMPLEX}]},IMLOG2:{method:"imlog2",parameters:[{argumentType:i5.COMPLEX}]},IMPOWER:{method:"impower",parameters:[{argumentType:i5.COMPLEX},{argumentType:i5.NUMBER}]},IMSQRT:{method:"imsqrt",parameters:[{argumentType:i5.COMPLEX}]}};class one extends o5{avedev(e,t){return this.runFunction(e.args,t,this.metadata("AVEDEV"),((...e)=>{const t=this.arithmeticHelper.coerceNumbersExactRanges(e);if(t instanceof C4)return t;if(0===t.length)return new C4(t4.DIV_BY_ZERO);const n=kte(t);return t.reduce(((e,t)=>e+Math.abs(t-n)),0)/t.length}))}devsq(e,t){return this.runFunction(e.args,t,this.metadata("DEVSQ"),((...e)=>{const t=this.arithmeticHelper.coerceNumbersExactRanges(e);return t instanceof C4?t:0===t.length?0:Fte(t)}))}geomean(e,t){return this.runFunction(e.args,t,this.metadata("GEOMEAN"),((...e)=>{const t=this.arithmeticHelper.coerceNumbersExactRanges(e);if(t instanceof C4)return t;if(0===t.length)return new C4(t4.NUM,K2.OneValue);for(const r of t)if(r<=0)return new C4(t4.NUM,K2.ValueSmall);return n=t,Math.pow(function(e){for(var t=1,n=e.length;--n>=0;)t*=e[n];return t}(n),1/n.length);var n}))}harmean(e,t){return this.runFunction(e.args,t,this.metadata("HARMEAN"),((...e)=>{const t=this.arithmeticHelper.coerceNumbersExactRanges(e);if(t instanceof C4)return t;if(0===t.length)return new C4(t4.NUM,K2.OneValue);for(const n of t)if(n<=0)return new C4(t4.NUM,K2.ValueSmall);return t.length/t.reduce(((e,t)=>e+1/t),0)}))}correl(e,t){return this.runFunction(e.args,t,this.metadata("CORREL"),((e,t)=>{if(e.numberOfElements()!==t.numberOfElements())return new C4(t4.NA,K2.EqualLength);const n=sne(e,t);if(n instanceof C4)return n;return n[0].length<=1?new C4(t4.DIV_BY_ZERO,K2.TwoValues):Bte(n[0],n[1])}))}rsq(e,t){return this.runFunction(e.args,t,this.metadata("RSQ"),((e,t)=>{if(e.numberOfElements()!==t.numberOfElements())return new C4(t4.NA,K2.EqualLength);const n=sne(e,t);if(n instanceof C4)return n;return n[0].length<=1?new C4(t4.DIV_BY_ZERO,K2.TwoValues):Math.pow(Bte(n[0],n[1]),2)}))}covariancep(e,t){return this.runFunction(e.args,t,this.metadata("COVARIANCE.P"),((e,t)=>{if(e.numberOfElements()!==t.numberOfElements())return new C4(t4.NA,K2.EqualLength);const n=sne(e,t);if(n instanceof C4)return n;const r=n[0].length;return r<1?new C4(t4.DIV_BY_ZERO,K2.OneValue):1===r?0:Ute(n[0],n[1])*(r-1)/r}))}covariances(e,t){return this.runFunction(e.args,t,this.metadata("COVARIANCE.S"),((e,t)=>{if(e.numberOfElements()!==t.numberOfElements())return new C4(t4.NA,K2.EqualLength);const n=sne(e,t);if(n instanceof C4)return n;return n[0].length<=1?new C4(t4.DIV_BY_ZERO,K2.TwoValues):Ute(n[0],n[1])}))}ztest(e,t){return this.runFunction(e.args,t,this.metadata("Z.TEST"),((e,t,n)=>{const r=this.arithmeticHelper.manyToExactNumbers(e.valuesFromTopLeftCorner());if(r instanceof C4)return r;const i=r.length;if(void 0===n){if(i<2)return new C4(t4.DIV_BY_ZERO,K2.TwoValues);n=Vte(r,!0)}return i<1?new C4(t4.NA,K2.OneValue):0===n?new C4(t4.DIV_BY_ZERO):1-nte((kte(r)-t)/(n/Math.sqrt(i)),0,1)}))}ftest(e,t){return this.runFunction(e.args,t,this.metadata("F.TEST"),((e,t)=>{const n=this.arithmeticHelper.manyToExactNumbers(e.valuesFromTopLeftCorner()),r=this.arithmeticHelper.manyToExactNumbers(t.valuesFromTopLeftCorner());if(n instanceof C4)return n;if(r instanceof C4)return r;if(n.length<=1||r.length<=1)return new C4(t4.DIV_BY_ZERO);const i=Dte(n,!0),o=Dte(r,!0);if(0===i||0===o)return new C4(t4.DIV_BY_ZERO);const s=Rte(i/o,n.length-1,r.length-1);return 2*Math.min(s,1-s)}))}steyx(e,t){return this.runFunction(e.args,t,this.metadata("STEYX"),((e,t)=>{if(e.numberOfElements()!==t.numberOfElements())return new C4(t4.NA,K2.EqualLength);const n=sne(e,t);if(n instanceof C4)return n;const r=n[0].length;return r<=2?new C4(t4.DIV_BY_ZERO,K2.ThreeValues):Math.sqrt((Fte(n[0])-Math.pow(Ute(n[0],n[1])*(r-1),2)/Fte(n[1]))/(r-2))}))}slope(e,t){return this.runFunction(e.args,t,this.metadata("SLOPE"),((e,t)=>{if(e.numberOfElements()!==t.numberOfElements())return new C4(t4.NA,K2.EqualLength);const n=sne(e,t);if(n instanceof C4)return n;const r=n[0].length;return r<=1?new C4(t4.DIV_BY_ZERO,K2.TwoValues):Ute(n[0],n[1])*(r-1)/Fte(n[1])}))}chisqtest(e,t){return this.runFunction(e.args,t,this.metadata("CHISQ.TEST"),((e,t)=>{const n=e.height(),r=e.width();if(t.height()!==n||t.width()!==r)return new C4(t4.NA,K2.EqualLength);const i=sne(e,t);if(i instanceof C4)return i;if(i[0].length<=1)return new C4(t4.DIV_BY_ZERO,K2.TwoValues);let o=0;for(let s=0;s<i[0].length;s++){if(0===i[1][s])return new C4(t4.DIV_BY_ZERO);o+=Math.pow(i[0][s]-i[1][s],2)/i[1][s]}return o<0?new C4(t4.NUM,K2.NaN):1-vte(o,n>1&&r>1?(n-1)*(r-1):n*r-1)}))}ttest(e,t){return this.runFunction(e.args,t,this.metadata("T.TEST"),((e,t,n,r)=>{const i=this.arithmeticHelper.manyToExactNumbers(e.valuesFromTopLeftCorner()),o=this.arithmeticHelper.manyToExactNumbers(t.valuesFromTopLeftCorner());if(i instanceof C4)return i;if(o instanceof C4)return o;const s=i.length,a=o.length;if(1===r){if(a!==s)return new C4(t4.NA,K2.EqualLength);if(s<=1)return new C4(t4.DIV_BY_ZERO,K2.TwoValues);const e=Array(s);for(let n=0;n<s;n++)e[n]=i[n]-o[n];const t=Vte(e,!0);if(0===t)return new C4(t4.DIV_BY_ZERO);const r=Math.abs(Math.sqrt(s)*kte(e)/t);return n*(1-Ite(r,s-1))}if(2===r){if(s<=1||a<=1)return new C4(t4.DIV_BY_ZERO,K2.TwoValues);const e=(Fte(i)+Fte(o))/(s+a-2);if(0===e)return new C4(t4.DIV_BY_ZERO);const t=Math.abs((kte(i)-kte(o))/Math.sqrt(e*(1/s+1/a)));return n*(1-Ite(t,s+a-2))}{if(s<=1||a<=1)return new C4(t4.DIV_BY_ZERO,K2.TwoValues);const e=Dte(i,!0),t=Dte(o,!0);if(0===e&&0===t)return new C4(t4.DIV_BY_ZERO);const r=Math.abs((kte(i)-kte(o))/Math.sqrt(e/s+t/a)),l=Math.pow(e/s+t/a,2)/(Math.pow(e/s,2)/(s-1)+Math.pow(t/a,2)/(a-1));return n*(1-Ite(r,l))}}))}skew(e,t){return this.runFunction(e.args,t,this.metadata("SKEW"),((...e)=>{const t=this.arithmeticHelper.coerceNumbersExactRanges(e);if(t instanceof C4)return t;const n=t.length;if(n<3)return new C4(t4.DIV_BY_ZERO,K2.ThreeValues);const r=kte(t),i=Vte(t,!0);return 0===i?new C4(t4.DIV_BY_ZERO):t.reduce(((e,t)=>e+Math.pow((t-r)/i,3)),0)*n/(n-1)/(n-2)}))}skewp(e,t){return this.runFunction(e.args,t,this.metadata("SKEW.P"),((...e)=>{const t=this.arithmeticHelper.coerceNumbersExactRanges(e);if(t instanceof C4)return t;const n=t.length;if(n<3)return new C4(t4.DIV_BY_ZERO,K2.ThreeValues);const r=kte(t),i=Vte(t,!1);return 0===i?new C4(t4.DIV_BY_ZERO):t.reduce(((e,t)=>e+Math.pow((t-r)/i,3)),0)/n}))}}function sne(e,t){const n=e.iterateValuesFromTopLeftCorner(),r=t.iterateValuesFromTopLeftCorner();let i,o;const s=[],a=[];for(;i=n.next(),o=r.next(),!i.done&&!o.done;){const e=i.value,t=o.value;if(e instanceof C4)return e;if(t instanceof C4)return t;K3(e)&&K3(t)&&(s.push(U3(e)),a.push(U3(t)))}return[s,a]}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */one.implementedFunctions={AVEDEV:{method:"avedev",parameters:[{argumentType:i5.ANY}],repeatLastArgs:1},DEVSQ:{method:"devsq",parameters:[{argumentType:i5.ANY}],repeatLastArgs:1},GEOMEAN:{method:"geomean",parameters:[{argumentType:i5.ANY}],repeatLastArgs:1},HARMEAN:{method:"harmean",parameters:[{argumentType:i5.ANY}],repeatLastArgs:1},CORREL:{method:"correl",parameters:[{argumentType:i5.RANGE},{argumentType:i5.RANGE}]},RSQ:{method:"rsq",parameters:[{argumentType:i5.RANGE},{argumentType:i5.RANGE}]},"COVARIANCE.P":{method:"covariancep",parameters:[{argumentType:i5.RANGE},{argumentType:i5.RANGE}]},"COVARIANCE.S":{method:"covariances",parameters:[{argumentType:i5.RANGE},{argumentType:i5.RANGE}]},"Z.TEST":{method:"ztest",parameters:[{argumentType:i5.RANGE},{argumentType:i5.NUMBER},{argumentType:i5.NUMBER,optionalArg:!0}]},"F.TEST":{method:"ftest",parameters:[{argumentType:i5.RANGE},{argumentType:i5.RANGE}]},STEYX:{method:"steyx",parameters:[{argumentType:i5.RANGE},{argumentType:i5.RANGE}]},SLOPE:{method:"slope",parameters:[{argumentType:i5.RANGE},{argumentType:i5.RANGE}]},"CHISQ.TEST":{method:"chisqtest",parameters:[{argumentType:i5.RANGE},{argumentType:i5.RANGE}]},"T.TEST":{method:"ttest",parameters:[{argumentType:i5.RANGE},{argumentType:i5.RANGE},{argumentType:i5.INTEGER,minValue:1,maxValue:2},{argumentType:i5.INTEGER,minValue:1,maxValue:3}]},SKEW:{method:"skew",parameters:[{argumentType:i5.ANY}],repeatLastArgs:1},"SKEW.P":{method:"skewp",parameters:[{argumentType:i5.ANY}],repeatLastArgs:1}},one.aliases={COVAR:"COVARIANCE.P",FTEST:"F.TEST",PEARSON:"CORREL",ZTEST:"Z.TEST",CHITEST:"CHISQ.TEST",TTEST:"T.TEST",COVARIANCEP:"COVARIANCE.P",COVARIANCES:"COVARIANCE.S",SKEWP:"SKEW.P"};const ane=Object.freeze(Object.defineProperty({__proto__:null,AbsPlugin:Q8,AddressPlugin:X8,ArrayPlugin:q8,BitShiftPlugin:J8,BitwiseLogicOperationsPlugin:r7,BooleanPlugin:i7,CharPlugin:o7,CodePlugin:s7,ComplexPlugin:Yte,ConditionalAggregationPlugin:dee,CountBlankPlugin:a7,CountUniquePlugin:l7,DateTimePlugin:h7,DegreesPlugin:g7,DeltaPlugin:m7,ExpPlugin:f7,FinancialPlugin:w7,FormulaTextPlugin:E7,HyperlinkPlugin:b7,InformationPlugin:T7,IsEvenPlugin:N7,IsOddPlugin:A7,LogarithmPlugin:M7,LookupPlugin:wee,MathConstantsPlugin:O7,MathPlugin:jte,MatrixPlugin:_7,MedianPlugin:L7,ModuloPlugin:H7,NumericAggregationPlugin:D7,PowerPlugin:B7,RadiansPlugin:W7,RadixConversionPlugin:G7,RandomPlugin:Q7,RomanPlugin:yee,RoundingPlugin:eee,SimpleArithmerticPlugin:See,SqrtPlugin:tee,StatisticalAggregationPlugin:one,StatisticalPlugin:Wte,SumprodPlugin:pee,TextPlugin:gee,TrigonometryPlugin:mee},Symbol.toStringTag,{value:"Module"}));
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class lne extends j8{}lne.HyperFormula=j8,lne.ErrorType=t4,lne.CellError=C4,lne.CellType=n4,lne.CellValueType=g4,lne.CellValueDetailedType=m4,lne.DetailedCellError=l5,lne.ExportedCellChange=l8,lne.ExportedNamedExpressionChange=h8,lne.ConfigValueTooBigError=E9,lne.ConfigValueTooSmallError=R9,lne.EvaluationSuspendedError=T9,lne.ExpectedOneOfValuesError=b9,lne.ExpectedValueOfTypeError=C9,lne.ArraySize=s5,lne.SimpleRangeValue=Z3,lne.EmptyValue=V3,lne.FunctionPlugin=o5,lne.FunctionArgumentType=i5,lne.FunctionPluginValidationError=O9,lne.InvalidAddressError=h9,lne.InvalidArgumentsError=u9,lne.LanguageNotRegisteredError=M9,lne.LanguageAlreadyRegisteredError=I9,lne.MissingTranslationError=N9,lne.NamedExpressionDoesNotExistError=g9,lne.NamedExpressionNameIsAlreadyTakenError=d9,lne.NamedExpressionNameIsInvalidError=p9,lne.NoOperationToRedoError=f9,lne.NoOperationToUndoError=m9,lne.NoRelativeAddressesAllowedError=L9,lne.NoSheetWithIdError=i9,lne.NoSheetWithNameError=o9,lne.NotAFormulaError=l9,lne.NothingToPasteError=w9,lne.ProtectedFunctionTranslationError=A9,lne.SheetNameAlreadyTakenError=s9,lne.SheetSizeLimitExceededError=a9,lne.SourceLocationHasArrayError=P9,lne.TargetLocationHasArrayError=_9,lne.UnableToParseError=v9;const hne=z8.defaultConfig.language;j8.registerLanguage(hne,Y8),j8.languages[Y8.langCode]=Y8;for(const Rne of Object.getOwnPropertyNames(ane))Rne.startsWith("_")||j8.registerFunctionPlugin(ane[Rne]);const une=e=>(C("data-v-3b82a8f2"),e=e(),S(),e),cne={class:"modal-form full-screen columns is-multiline"},dne={class:"column is-4"},pne=une((()=>c("div",{class:"column is-4"},null,-1))),gne={class:"column is-4 justify-right"},mne={class:"is-flex"},fne=une((()=>c("i",{class:"lnir lnir-cloud-download","aria-hidden":"true"},null,-1))),wne=une((()=>c("i",{class:"lnir lnir-trash","aria-hidden":"true"},null,-1))),yne=une((()=>c("i",{class:"lnir lnir-close","aria-hidden":"true"},null,-1))),vne={class:"column is-12"},Cne=n({__name:"ExcelFileEditor",props:{excelFileModal:{type:Boolean},fileId:{},objectId:{},getLeadsList:{type:Boolean},isTemplate:{type:Boolean}},emits:["update:modalHandler","update:OnSuccess"],setup(t,{emit:n}){const r=t;fy(Rk);const s=a(null);j8.buildEmpty({licenseKey:"internal-use-in-handsontable"}),l();const C=A(),S=N(),R=a(!1);DQ(),a(!1);const M=a([[""]]),I=a({id:"",title:"Enter Title",data:Array.from({length:80},(()=>Array(50).fill("")))}),O=()=>{n("update:modalHandler",!1)},x=()=>{n("update:OnSuccess",null)},P=a({data:[],formulas:{engine:j8},plugins:{contextMenu:!0},fixedRowsBottom:2,stretchH:"all",autoWrapRow:!0,autoWrapCol:!0,licenseKey:"non-commercial-and-evaluation",colHeaders:!0,rowHeaders:!0,width:"100%",height:800,minRows:50,minCols:50,rowHeights:30,colWidths:120,manualColumnResize:!0,manualRowResize:!0,columnSorting:!0,filters:!0,dropdownMenu:!0,contextMenu:!0});a([]);const _=async()=>{try{if(R.value=!0,r.fileId||I.value.id){const e=await S.patch(`/api/excel-files/${r.fileId?r.fileId:I.value.id}/`,{is_template:!1,title:I.value.title,object:r.objectId??"",sheet_data:JSON.stringify(M.value)});I.value.id=e.data.id,C.success("Sheet updated successfully!")}else{const e=await S.post("/api/excel-files/",{title:I.value.title,object:r.objectId??"",sheet_data:JSON.stringify(M.value)});I.value.id=e.data.id,C.success("Sheet created successfully!")}x()}catch(Dm){console.error(Dm),C.error("Failed to save sheet.")}finally{R.value=!1}},L=()=>{r.fileId||I.value.id?_():H()},H=async()=>{try{const e=await S.post("/api/excel-files/create-template/",{is_template:!0,title:I.value.title,sheet_data:JSON.stringify(M.value)});I.value.id=e.data.id,x(),C.success("Template saved successfully!")}catch(Dm){console.error(Dm),C.error("Failed to save sheet.")}},k=a([]);h((()=>{u((()=>{s.value||console.error("hotTable is undefined")}))}));return h((async()=>{r.fileId&&await(async()=>{try{const e=await S.get(`/api/excel-files/${r.fileId}/`);let t=e.data.sheet_data,n="string"==typeof t?JSON.parse(t):t;console.log("Parsed Data:",n),Array.isArray(n)||(console.error("Invalid data format: Expected an array"),n=[]),n=n.map((e=>Array.isArray(e)?e.map((e=>null===e?"":e)):"object"==typeof e&&null!==e?Object.values(e).map((e=>null===e?"":e)):[e])),console.log("Fixed Data:",n),M.value=n,I.value.title=e.data.title,I.value.id=e.data.id,await u(),s.value?.hotInstance&&(s.value.hotInstance.loadData(M.value),s.value.hotInstance.render())}catch(Dm){console.log("Error fetching sheet:",Dm)}})(),(async()=>{try{const e=await S.get("/api/excel-files/templates/",{});k.value=e.data}catch(Dm){console.error(Dm),C.error("Failed to save sheet.")}})()})),(t,n)=>{const a=T,l=b,h=E,u=v,N=e;return i(),o("div",cne,[c("div",dne,[d(h,null,{default:p((()=>[d(l,null,{default:p((()=>[d(a,{modelValue:I.value.title,"onUpdate:modelValue":n[0]||(n[0]=e=>I.value.title=e),type:"text",placeholder:"title"},null,8,["modelValue"])])),_:1})])),_:1})]),pne,c("div",gne,[c("div",mne,[r.isTemplate?w("",!0):(i(),g(u,{key:0,loading:R.value,onClick:_,color:"primary",raised:"",class:"mr-2"},{default:p((()=>[m(f(r.fileId||I.value.id?"Update":"Save"),1)])),_:1},8,["loading"])),r.isTemplate?(i(),g(u,{key:1,loading:R.value,onClick:L,color:"success",raised:"",outlined:"",class:"mr-2",light:""},{default:p((()=>[m(f(I.value.id?"Update":"Create")+" Template",1)])),_:1},8,["loading"])):w("",!0),d(N,{bordered:"",onClick:n[1]||(n[1]=e=>(async()=>{try{const e=await S.get(`/api/excel-files/${r.fileId?r.fileId:I.value.id}/download/`,{responseType:"blob"}),t=new Blob([e.data],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),n=window.URL.createObjectURL(t),i=document.createElement("a");i.href=n,i.download=`${I.value.title}.xlsx`,document.body.appendChild(i),i.click(),document.body.removeChild(i),window.URL.revokeObjectURL(n),C.success("File downloaded successfully!")}catch(Dm){console.error("Download Error:",Dm),C.error("Failed to download the sheet.")}})()),loading:"",class:"cu-pointer",color:"info"},{default:p((()=>[fne])),_:1}),d(N,{bordered:"",onClick:n[2]||(n[2]=e=>(async e=>{try{await S.delete(`/api/excel-files/${e}/`),C.success("Sheet deleted successfully!"),O()}catch(Dm){console.error(Dm),C.error("Failed to delete sheet.")}})(I.value.id)),class:"cu-pointer ml-2",color:"danger"},{default:p((()=>[wne])),_:1}),d(N,{onClick:n[3]||(n[3]=e=>O()),class:"cu-pointer ml-2",bordered:"",color:"warning"},{default:p((()=>[yne])),_:1})])]),c("div",vne,[d(y(qM),{ref_key:"hotTable",ref:s,settings:P.value,data:M.value,ContextMenu:!0},null,8,["settings","data"])])])}}}),Sne=R(Cne,[["__scopeId","data-v-3b82a8f2"]]);export{Sne as _};
