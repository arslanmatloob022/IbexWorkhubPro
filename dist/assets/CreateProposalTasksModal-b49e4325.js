import{f as e,s as a,b as l,r as o,o as t,B as s,C as n,O as i,G as r,F as d,m as c,k as u,E as p,U as m,K as v,J as _,P as f,a7 as b,$ as y,e as g,_ as h,w as I,L as w,X as k,N as C,D as P,V as S,W as V,a5 as D,a1 as x,Y as U,Q as j,R as T,S as O,j as M,aS as L,I as A,H as F}from"./index-69081f3d.js";import{_ as $}from"./VModal.vue_vue_type_style_index_0_lang-579ee674.js";import{_ as E}from"./VField.vue_vue_type_script_setup_true_lang-05c8a30c.js";import{_ as H}from"./VControl-9c54ab47.js";import{u as R}from"./useAPI-1291b2e3.js";import{u as N}from"./useNotyf-346954c1.js";import{a as q}from"./useSupportElement-1d09722f.js";import{a as B,_ as J}from"./UnitAddUpdateModal.vue_vue_type_script_setup_true_lang-cd0c61a8.js";import{_ as z}from"./VTextarea.vue_vue_type_script_setup_true_lang-196090ab.js";import{_ as W}from"./VInput.vue_vue_type_script_setup_true_lang-2eaa04da.js";import{_ as K}from"./VCheckbox.vue_vue_type_style_index_0_lang-ae7a192d.js";import{_ as G,a as Q}from"./VOption.vue_vue_type_style_index_0_lang-887da321.js";import{s as Y,g as X,a as Z,c as ee}from"./costItems-58a96177.js";import{_ as ae}from"./VIconButton-628a13b7.js";import{u as le}from"./company-3bba4552.js";import{_ as oe}from"./SweetAlert.vue_vue_type_style_index_0_lang-8128506c.js";import{_ as te}from"./VDropdown.vue_vue_type_style_index_0_lang-c10d3788.js";const se={class:"multiselect-single-label"},ne={class:"select-label-text"},ie={class:"select-label-text"},re=e({__name:"CostByCatalog",props:{centeredActionsOpen:{type:Boolean}},emits:["update:modalHandler","update:OnSuccess"],setup(e,{emit:b}){const y=e;a(),l();const g=N(),h=R();o(!1);const I=o(!1),w=o([]),k=o(""),C=o([]),P=()=>{b("update:modalHandler",!1)},S=()=>{b("update:OnSuccess",null)};return t((async()=>{(async()=>{try{I.value=!0;const e=await h.get("/api/cost/catalogs/");C.value=e.data,w.value=e.data.map((e=>({value:e.id,name:e.title})))}catch(e){console.log(e)}finally{I.value=!1}})()})),(e,a)=>{const l=s("Multiselect"),o=H,t=E,b=f,I=$;return n(),i(I,{open:y.centeredActionsOpen,actions:"right",is:"form",title:"Create Cost item",onSubmit:a[1]||(a[1]=_((e=>(async()=>{const e=C.value.find((e=>e.id==k.value));e?console.log("Matched Item:",e):console.log("No item found with the given ID.");const a=q(e,[]);try{await h.post("/api/cost/",a),P(),S(),g.success("Item added successfully.")}catch(l){g.error("Failed try again")}})()),["prevent"])),onClose:P},{content:r((()=>[d(t,{class:"is-image-select m-b-80",label:"Selecte Catalog"},{default:r((({id:e})=>[d(o,null,{default:r((()=>[d(l,{modelValue:c(k),"onUpdate:modelValue":a[0]||(a[0]=e=>u(k)?k.value=e:null),attrs:{id:e},placeholder:"Select a catalog",label:"name",options:c(w)},{singlelabel:r((({value:e})=>[p("div",se,[p("span",ne,m(e.name),1)])])),option:r((({option:e})=>[p("span",ie,m(e.name),1)])),_:2},1032,["modelValue","attrs","options"])])),_:2},1024)])),_:1})])),action:r((()=>[d(b,{color:"primary",raised:"",type:"submit"},{default:r((()=>[v(" Confirm ")])),_:1})])),_:1},8,["open"])}}}),de=b("useProposal",(()=>{const e=o(!0),a=N(),l=R(),t=o("");o("");const s=o([]),n=o([]),i=o({id:"",jobInfo:{id:"",sales_people_info:[],clientInfo:{id:"",username:"",last_name:null,email:"",role:"",avatar:null},created_by_info:{id:"",username:"",last_name:null,email:"",role:"",avatar:null},managers_list:[],title:"",address:"",current_state:"",city:"",state:"",status:"",zip_code:"",confidence:"",sale_date:"",tags:[],estimated_from:"",estimated_to:"",sources:"",project_type:"",notes:"",attach_mail:"",latitude:0,longitude:0,created_at:"",updated_at:"",created_by:"",client:"",contractor:null,sales_people:[],managers:[]},proposalAmount:0,title:"",approval_deadline:"",internal_notes:"",introductory_text:"",closing_text:"",payment_status:"",type:"",status:"",columns_to_show:[],created_at:"",updated_at:"",job:""}),r=o([{id:"",index:0,title:"",description:"",type:"",quantity:0,unit:"",unit_cost:"",markup:"",total_price:"",cost_code:"",cost_type:"",builder_cost:"",margin:"",profit:"",internal_notes:"",mark_as:"",state:"",group_amount:"",status:null,created_at:"",proposal:""}]);return{loading:e,proposalCostItems:r,leadProposalFormData:i,companyProposalsList:s,leadProposalsList:n,getLeadProposals:async o=>{try{o.value=o,e.value=!0;const a=await l.get(`/api/lead-proposal/by-job/${o.value}/`);n.value=a.data}catch(t){a.error(` ${t}, Lead`)}finally{e.value=!1}},getProposalDetail:async e=>{try{const a=await l.get(`/api/lead-proposal/${e}/detail/`);i.value=a.data,Y.value=a.data.columns_to_show}catch(a){console.log(a)}},getCompanyProposals:async()=>{try{e.value=!0;const a=await l.get("/api/lead-proposal/");s.value=a.data}catch(o){a.error(` ${o}, Lead`)}finally{e.value=!1}},getProposalCostItems:async function(e){try{t.value=e;const a=await l.get(`/api/cost/by-proposal/${e}/`);r.value=a.data}catch(a){console.log(a)}},clearProposalId:function(){t.value="",r.value=[]}}})),ce=b("useCostCode",(()=>{const e=o(!0),a=N(),l=R(),t=o([]),s=o([]),n=o([{value:"",label:"",labour_cost:"",unit_cost:0,worker_cost:0,unit:"--"}]);return{loading:e,companyProposalsList:t,costCodesList:n,costCodesWholeList:s,getLeadProposals:async o=>{try{o.value=o,e.value=!0;const a=await l.get(`/api/lead-proposal/by-job/${o.value}/`);n.value=a.data}catch(t){a.error(` ${t}, Lead`)}finally{e.value=!1}},getCostCodesHandler:async()=>{try{e.value=!0;const a=await l.get("/api/cost-code/");s.value=a.data,n.value=a.data.map((e=>({value:e.id,label:e.name,labour_cost:e.labour_cost,unit_cost:e.unit_cost??0,worker_cost:e.worker_cost??0,unit:e.unit??"--"})))}catch(a){console.log(a)}finally{e.value=!1}}}})),ue={class:"modal-form columns is-multiline"},pe={class:"columns is-multiline"},me={class:"field column is-6 mb-0"},ve=p("label",null,"Title: ",-1),_e={class:"control"},fe=["disabled"],be={class:"multiselect-single-label"},ye={class:"select-label-text"},ge={class:"select-label-text"},he={key:1,class:"field column is-6"},Ie=p("label",{for:""},"Cost Type",-1),we={key:2,class:"field column is-3"},ke=p("label",{for:""},"Add to catalogue",-1),Ce={class:"field column is-3"},Pe=p("label",{for:""},"Mark As",-1),Se={class:"field column is-6"},Ve=p("label",null,"Cost Code *",-1),De={class:"field column is-6"},xe=p("label",{for:""},"Group Cost",-1),Ue={class:"field column is-12 mb-0"},je=p("label",{for:"",class:"label"},"Description",-1),Te={class:"field column is-12 mb-0"},Oe=p("label",{for:"",class:"label"},"Internal Notes",-1),Me={class:"columns is-multiline"},Le={class:"field column is-6"},Ae=p("label",null,"Unit Cost",-1),Fe={class:"field column is-6"},$e=p("label",null,"Quantity",-1),Ee={class:"field column is-6"},He=p("label",null,"Unit",-1),Re={class:"field column is-6"},Ne=p("label",null,"Builder Cost",-1),qe={class:"field column is-6"},Be=p("label",null,"Markup (%)",-1),Je={class:"field column is-6"},ze=p("label",null,"Total Price",-1),We={class:"field column is-6"},Ke=p("label",null,"Margin (%)",-1),Ge={class:"field column is-6"},Qe=p("label",null,"Worker Cost",-1),Ye=e({__name:"EstimateCostItemModal",props:{costItemModal:{type:Boolean},proposalId:{},previousItemIndex:{},costItemId:{},previewCostItems:{type:Boolean},costMode:{}},emits:["update:modalHandler","update:OnSuccess"],setup(e,{emit:b}){const x=e,U=a(),j=ce(),T=de();l();const O=N(),M=R(),L=o(!1),A=o(""),F=o([]),Y=o([]),X=o(!1),Z=o(!1),ee=o({previousItemIndex:0,index:0,id:"",type:"",total_price:0,cost_code:"",cost_type:"",builder_cost:0,internal_notes:"",mark_as:"",state:"",title:"",description:"",quantity:0,unit:"",unit_cost:0,markup:0,margin:0,profit:0,worker_cost:0,group:"",catalog:!1,proposal:x.proposalId});o([{value:"labour",label:"Labour"},{value:"material",label:"Material"},{value:"equipment",label:"Equipment"},{value:"subcontractor",label:"Subcontractor"},{value:"other",label:"Others"}]);const ae=o([{value:"11011",label:"Labour"},{value:"11012",label:"Material"},{value:"11013",label:"Equipment"},{value:"11014",label:"Subcontractor"},{value:"11015",label:"Others"}]),le=o([{value:"bid",label:"Bid"},{value:"allowance",label:"Allowance"}]),oe=async()=>{try{L.value=!0;const e=q(ee.value,[]);if(null!==x.proposalId&&void 0!==x.proposalId&&e.append("proposal",x.proposalId.toString()),x.costItemId){await M.patch(`/api/cost/${x.costItemId}/`,e)}else{const a=await M.post("/api/cost/",e);if(ee.value.catalog){await M.post(`/api/cost/${a.data.id}/create-catalog/`)}T.getProposalDetail(x.proposalId)}te(),se(),O.success("Item added successfully.")}catch(e){O.error(` ${e}, New Worker`)}finally{L.value=!1}},te=()=>{b("update:modalHandler",!1)},se=()=>{b("update:OnSuccess",null)};o(0),o(0);const ne=y((()=>ee.value.unit_cost*ee.value.quantity));o(0),o(0);const ie=y((()=>ee.value.markup>0?ne.value+ne.value*ee.value.markup/100:ee.value.margin>0?ne.value/(1-ee.value.margin/100):ne.value));y((()=>(ie.value-ne.value)/ne.value*100)),y((()=>(ie.value-ne.value)/ie.value*100));const re=g((()=>h((()=>import("./ckeditor-9f4296e0.js").then((e=>e.c))),["assets/ckeditor-9f4296e0.js","assets/index-69081f3d.js","assets/index-1649e834.css","assets/vue.runtime.esm-bundler-ef7f1a91.js"]).then((e=>e.default.component)))),Ye={fontFamily:{options:['"Montserrat", sans-serif','"Roboto", sans-serif']},height:"400px",minHeight:"400px"},Xe=o(!1),Ze=o([]),ea=o(!1);I((()=>ee.value.cost_code),((e,a)=>{if(e){const a=Ze.value.find((a=>a.id===e));a?(ee.value.unit_cost=a.unit_cost,ee.value.worker_cost=a.worker_cost,ee.value.unit=a.unit):console.warn("No matching item found for cost_code:",e)}}));const aa=()=>{if(ee.value.internal_notes){const e=j.costCodesList.find((e=>e.label?.match(ee.value.internal_notes)));e&&(console.log("matched",e.value),ee.value.cost_code=e.value,ee.value.internal_notes.includes("...")?(ee.value.internal_notes="",ee.value.internal_notes="..."):ee.value.internal_notes=""),ee.value.title||(ee.value.title="...")}},la=o([{id:"",title:"",value:"",description:"",is_active:!0,created_at:"",updated_at:""}]),oa=o([{id:"",title:"",value:"",description:"",is_active:!0,created_at:"",updated_at:""}]),ta=async()=>{try{Xe.value=!0;const e=await M.get("/api/units/");la.value=e.data}catch(e){console.log(e)}finally{Xe.value=!1}},sa=async()=>{try{Xe.value=!0;const e=await M.get("/api/cost-types/");oa.value=e.data}catch(e){console.log(e)}finally{Xe.value=!1}};return I(A,((e,a)=>{const l=F.value.find((e=>e.id==A.value));if(l){const{id:e,proposal_id:a,...o}=l;ee.value=o}})),t((async()=>{U.value=await h((()=>import("./ckeditor-65725719.js").then((e=>e.c))),["assets/ckeditor-65725719.js","assets/index-69081f3d.js","assets/index-1649e834.css"]).then((e=>e.default)),x.previousItemIndex&&(ee.value.previousItemIndex=x.previousItemIndex),x.costItemId&&(async()=>{try{Xe.value=!0;const e=await M.get(`/api/cost/${x.costItemId}/`);ee.value=e.data,aa()}catch(e){console.log(e)}finally{Xe.value=!1}})(),ta(),(async()=>{try{ea.value=!0;const e=await M.get("/api/cost-code/");Ze.value=e.data,ae.value=e.data.map((e=>({value:e.id,label:e.name,labour_cost:e.labour_cost,unit_cost:e.unit_cost??0,worker_cost:e.worker_cost??0,unit:e.unit??"--"})))}catch(e){console.log(e)}finally{ea.value=!1}})(),(async()=>{try{Xe.value=!0;const e=await M.get("/api/cost/catalogs/");F.value=e.data,Y.value=e.data.map((e=>({value:e.id,name:e.title})))}catch(e){console.log(e)}finally{Xe.value=!1}})(),sa()})),(e,a)=>{const l=s("Multiselect"),o=H,t=E,b=G,y=Q,g=f,h=K,I=W,T=z,O=D,M=B,F=J,R=$;return n(),i(R,{is:"form",open:x.costItemModal,title:"catalog"==x.costMode?"Update Catalog":"Cost Item ",size:"xl",actions:"right",onSubmit:_(oe,["prevent"]),onClose:te},{content:r((()=>[p("div",ue,[d(O,{class:"column is-12"},{default:r((()=>[p("div",pe,[p("div",me,[ve,p("div",_e,[w(p("input",{type:"text",name:"firstName","onUpdate:modelValue":a[0]||(a[0]=e=>c(ee).title=e),required:"",disabled:x.previewCostItems,class:"input is-primary-focus is-primary-focus",placeholder:"Proposal Title"},null,8,fe),[[k,c(ee).title]])])]),"catalog"!==x.costMode?(n(),i(t,{key:0,class:"column is-6 m-0",label:"Import cost code from catalogue"},{default:r((({id:e})=>[d(o,null,{default:r((()=>[d(l,{modelValue:c(A),"onUpdate:modelValue":a[1]||(a[1]=e=>u(A)?A.value=e:null),attrs:{id:e},placeholder:"Import from cost code",label:"name",options:c(Y)},{singlelabel:r((({value:e})=>[p("div",be,[p("span",ye,m(e.name),1)])])),option:r((({option:e})=>[p("span",ge,m(e.name),1)])),_:2},1032,["modelValue","attrs","options"])])),_:2},1024)])),_:1})):C("",!0),"catalog"!==x.costMode?(n(),P("div",he,[Ie,d(t,{addons:""},{default:r((()=>[d(o,{expanded:""},{default:r((()=>[d(y,{modelValue:c(ee).cost_type,"onUpdate:modelValue":a[2]||(a[2]=e=>c(ee).cost_type=e),required:"",disabled:x.previewCostItems},{default:r((()=>[(n(!0),P(S,null,V(c(oa),((e,a)=>(n(),i(b,{value:e.value},{default:r((()=>[v(m(e.title),1)])),_:2},1032,["value"])))),256))])),_:1},8,["modelValue","disabled"])])),_:1}),d(o,null,{default:r((()=>[d(g,{onClick:a[3]||(a[3]=e=>Z.value=!c(Z)),color:"primary",icon:"fas fa-plus"})])),_:1})])),_:1})])):C("",!0),x.costItemId?C("",!0):(n(),P("div",we,[ke,p("div",null,[d(o,{raw:"",subcontrol:""},{default:r((()=>[d(h,{modelValue:c(ee).catalog,"onUpdate:modelValue":a[4]||(a[4]=e=>c(ee).catalog=e),label:"Create template",color:"info"},null,8,["modelValue"])])),_:1})])])),p("div",Ce,[Pe,d(t,null,{default:r((()=>[d(o,null,{default:r((()=>[d(y,{modelValue:c(ee).mark_as,"onUpdate:modelValue":a[5]||(a[5]=e=>c(ee).mark_as=e),disabled:x.previewCostItems},{default:r((()=>[(n(!0),P(S,null,V(c(le),((e,a)=>(n(),i(b,{value:e.value},{default:r((()=>[v(m(e.label),1)])),_:2},1032,["value"])))),256))])),_:1},8,["modelValue","disabled"])])),_:1})])),_:1})]),p("div",Se,[Ve,d(t,null,{default:r((({id:e})=>[d(o,null,{default:r((()=>[d(l,{required:"",modelValue:c(ee).cost_code,"onUpdate:modelValue":a[6]||(a[6]=e=>c(ee).cost_code=e),disabled:x.previewCostItems,attrs:{id:e},searchable:!0,options:c(j).costCodesList,placeholder:"Select a cost code"},null,8,["modelValue","disabled","attrs","options"])])),_:2},1024)])),_:1})]),p("div",De,[xe,d(t,null,{default:r((()=>[d(o,null,{default:r((()=>[d(I,{modelValue:c(ee).group,"onUpdate:modelValue":a[7]||(a[7]=e=>c(ee).group=e),name:"gcost",placeholder:"Group Cost"},null,8,["modelValue"])])),_:1})])),_:1})]),p("div",Ue,[je,c(U)?(n(),i(c(re),{key:0,disabled:x.previewCostItems,modelValue:c(ee).description,"onUpdate:modelValue":a[8]||(a[8]=e=>c(ee).description=e),editor:c(U),config:Ye},null,8,["disabled","modelValue","editor"])):C("",!0)]),p("div",Te,[Oe,d(t,null,{default:r((()=>[d(o,null,{default:r((()=>[d(T,{modelValue:c(ee).internal_notes,"onUpdate:modelValue":a[9]||(a[9]=e=>c(ee).internal_notes=e),disabled:x.previewCostItems,rows:"3",placeholder:"Internal notes..."},null,8,["modelValue","disabled"])])),_:1})])),_:1})])])])),_:1}),d(O,{class:"column is-12 mt-3"},{default:r((()=>[p("div",Me,[p("div",Le,[Ae,d(t,{addons:""},{default:r((()=>[d(o,{expanded:""},{default:r((()=>[d(I,{modelValue:c(ee).unit_cost,"onUpdate:modelValue":a[10]||(a[10]=e=>c(ee).unit_cost=e),disabled:x.previewCostItems,type:"number",name:"unitCost",step:"any",placeholder:"Unit cost"},null,8,["modelValue","disabled"])])),_:1})])),_:1})]),p("div",Fe,[$e,d(t,null,{default:r((()=>[d(o,null,{default:r((()=>[d(I,{modelValue:c(ee).quantity,"onUpdate:modelValue":a[11]||(a[11]=e=>c(ee).quantity=e),disabled:x.previewCostItems,type:"number",name:"quantity",step:"any",placeholder:"Quantity"},null,8,["modelValue","disabled"])])),_:1})])),_:1})]),p("div",Ee,[He,d(t,{addons:""},{default:r((()=>[d(o,{expanded:""},{default:r((()=>[d(y,{disabled:x.previewCostItems,modelValue:c(ee).unit,"onUpdate:modelValue":a[12]||(a[12]=e=>c(ee).unit=e)},{default:r((()=>[d(b,{value:""},{default:r((()=>[v(" Select Unit ")])),_:1}),(n(!0),P(S,null,V(c(la),(e=>(n(),i(b,{value:e.value},{default:r((()=>[v(m(e.title)+" ("+m(e.value)+") ",1)])),_:2},1032,["value"])))),256))])),_:1},8,["disabled","modelValue"])])),_:1}),d(o,null,{default:r((()=>[d(g,{color:"primary",onClick:a[13]||(a[13]=e=>X.value=!c(X)),icon:"fas fa-plus"})])),_:1})])),_:1})]),p("div",Re,[Ne,d(t,null,{default:r((()=>[d(o,null,{default:r((()=>[d(I,{modelValue:c(ne),"onUpdate:modelValue":a[14]||(a[14]=e=>u(ne)?ne.value=e:null),disabled:x.previewCostItems,type:"number",step:"any",name:"builderCost",placeholder:"Builder cost"},null,8,["modelValue","disabled"])])),_:1})])),_:1})]),p("div",qe,[Be,d(t,null,{default:r((()=>[d(o,null,{default:r((()=>[d(I,{modelValue:c(ee).markup,"onUpdate:modelValue":a[15]||(a[15]=e=>c(ee).markup=e),disabled:x.previewCostItems,type:"number",name:"markup",step:"any",placeholder:"Markup"},null,8,["modelValue","disabled"])])),_:1})])),_:1})]),p("div",Je,[ze,d(t,null,{default:r((()=>[d(o,null,{default:r((()=>[d(I,{modelValue:c(ie),"onUpdate:modelValue":a[16]||(a[16]=e=>u(ie)?ie.value=e:null),disabled:x.previewCostItems,type:"number",name:"markup",step:"any",placeholder:"Total Price"},null,8,["modelValue","disabled"])])),_:1})])),_:1})]),p("div",We,[Ke,d(t,null,{default:r((()=>[d(o,null,{default:r((()=>[d(I,{modelValue:c(ee).margin,"onUpdate:modelValue":a[17]||(a[17]=e=>c(ee).margin=e),disabled:x.previewCostItems,type:"number",name:"markup",step:"any",placeholder:"Margin"},null,8,["modelValue","disabled"])])),_:1})])),_:1})]),p("div",Ge,[Qe,d(t,null,{default:r((()=>[d(o,null,{default:r((()=>[d(I,{modelValue:c(ee).worker_cost,"onUpdate:modelValue":a[18]||(a[18]=e=>c(ee).worker_cost=e),type:"number",name:"workerCost",step:"any",placeholder:"Worker Cost"},null,8,["modelValue"])])),_:1})])),_:1})])])])),_:1}),c(X)?(n(),i(M,{key:0,addUpdateCostUnitModal:c(X),"onUpdate:modalHandler":a[19]||(a[19]=e=>X.value=!1),"onUpdate:OnSuccess":a[20]||(a[20]=e=>ta())},null,8,["addUpdateCostUnitModal"])):C("",!0),c(Z)?(n(),i(F,{key:1,addUpdateCostType:c(Z),"onUpdate:modalHandler":a[21]||(a[21]=e=>Z.value=!1),"onUpdate:OnSuccess":a[22]||(a[22]=e=>sa())},null,8,["addUpdateCostType"])):C("",!0)])])),action:r((()=>[d(g,{loading:c(L),type:"submit",color:"primary",icon:x.costItemId?"":"fas fa-plus",raised:""},{default:r((()=>[v(m(x.costItemId?"Update":"Add"),1)])),_:1},8,["loading","icon"])])),_:1},8,["open","title","onSubmit"])}}}),Xe={class:"modal-form columns is-multiline"},Ze={class:"column is-full"},ea={class:"field"},aa=p("label",{class:"label"},"Send To ",-1),la={class:"control"},oa={class:"column is-full"},ta={class:"field"},sa=p("label",{class:"label"},"Subject ",-1),na={class:"control"},ia={class:"field column is-full mt-5"},ra=p("label",{class:"label"},"Message",-1),da=p("i",{class:"feather:mail"},null,-1),ca=e({__name:"SendProposalEmailModal",props:{proposalSenderModal:{type:Boolean},proposalData:{},columnsToShow:{},selectedProposalsIds:{}},emits:["update:modalHandler","update:OnSuccess"],setup(e,{emit:l}){const s=e,u=de(),m=R(),b=N(),y=o(!1),I=a(),S=window.origin;o(`${S}/proposal-view/?proposal=${s.proposalData?.id}`);const V=()=>{l("update:modalHandler",!1)},D=s.selectedProposalsIds.map((e=>e.id)),U=s.selectedProposalsIds.map((e=>e.proposalAmount)).map(((e,a)=>`<li>Total of proposal ${a+1}:<b> $${e} </b></li>`)).join("<br>"),j=D.map(((e,a)=>`<a href="${S}/proposal-view/?proposal=${e}" style="color: #007bff; text-decoration: none; font-weight: bold;">View Proposal ${a+1}, </a>`)).join("<br>"),T=o({email:u.leadProposalFormData?.jobInfo?.clientInfo?.email?u.leadProposalFormData?.jobInfo?.clientInfo?.email:"N/A",subject:`Proposal ${u.leadProposalFormData?.jobInfo?.title} `,message:`<p><b>Hi ${u.leadProposalFormData?.jobInfo?.clientInfo?.username?u.leadProposalFormData?.jobInfo?.clientInfo?.username:"N/A"} ${u.leadProposalFormData?.jobInfo?.clientInfo?.last_name?u.leadProposalFormData?.jobInfo?.clientInfo?.last_name:""},</b></p>\n\n  <p>We hope this message finds you well.</p>\n\n  <p>\n    Please find attached a detailed proposal outlining the cost items associated with the services/products we will be providing.\n    We have carefully curated this proposal to ensure complete transparency and alignment with your expectations.\n  </p>\n\n  <p>\n    Actions required for all proposals, and uou can review the full proposal(s), including the cost breakdown, by clicking the link below: <br />\n    ${j}\n  </p>\n\n  <p><b>Respectively proposal(s) amount are:</b></p>\n  <ul>\n    ${U}\n  </ul>\n\n  <p>\n    If you have any questions or require further clarification, feel free to reach out to us at your earliest convenience.\n    We are here to assist you.\n  </p>\n\n  <p>Thank you for trusting <b>Ibex Team</b> with your project.</p>\n\n  <p><b>Best Regards,</b><br />\n    Ibex Team\n  </p>`,link:j[0],columns:["cost_code","title","description","unit_cost"],showClient:!0,proposal_ids:D}),O=async()=>{try{y.value=!0;let e=T.value;e.proposal_ids=JSON.stringify(T.value.proposal_ids),e.columns=JSON.stringify(T.value.columns);await m.post("/api/lead-proposal/send-proposal-template/",e);b.success("Email sent successfully"),V()}catch(e){console.log(e)}finally{y.value=!1}},M=g((()=>h((()=>import("./ckeditor-9f4296e0.js").then((e=>e.c))),["assets/ckeditor-9f4296e0.js","assets/index-69081f3d.js","assets/index-1649e834.css","assets/vue.runtime.esm-bundler-ef7f1a91.js"]).then((e=>e.default.component)))),L={fontFamily:{options:['"Montserrat", sans-serif','"Roboto", sans-serif']},height:"400px",minHeight:"400px",maxHeight:"600px"};return t((async()=>{I.value=await h((()=>import("./ckeditor-65725719.js").then((e=>e.c))),["assets/ckeditor-65725719.js","assets/index-69081f3d.js","assets/index-1649e834.css"]).then((e=>e.default))})),(e,a)=>{const l=f,o=$;return n(),P("div",null,[d(x,{name:"fade-slow"},{default:r((()=>[d(o,{is:"form",open:s.proposalSenderModal,title:"Send Proposal",size:"large",actions:"right",onSubmit:_(O,["prevent"]),onClose:V},{content:r((()=>[p("div",Xe,[p("div",Ze,[p("div",ea,[aa,p("div",la,[w(p("input",{type:"email",required:"",class:"input",placeholder:"Enter Mail","onUpdate:modelValue":a[0]||(a[0]=e=>c(T).email=e)},null,512),[[k,c(T).email]])])])]),p("div",oa,[p("div",ta,[sa,p("div",na,[w(p("input",{type:"text",required:"",class:"input",placeholder:"Enter mail subject","onUpdate:modelValue":a[1]||(a[1]=e=>c(T).subject=e)},null,512),[[k,c(T).subject]])])])]),p("div",ia,[ra,c(I)?(n(),i(c(M),{key:0,modelValue:c(T).message,"onUpdate:modelValue":a[2]||(a[2]=e=>c(T).message=e),editor:c(I),config:L},null,8,["modelValue","editor"])):C("",!0)])])])),action:r((()=>[d(l,{type:"submit",color:"primary",loading:c(y),raised:""},{default:r((()=>[da,v(" Send Proposal")])),_:1},8,["loading"])])),cancel:r((()=>[d(l,{color:"light",onClick:V,raised:""},{default:r((()=>[v("Close ")])),_:1})])),_:1},8,["open","onSubmit"])])),_:1})])}}}),ua=R();N();const pa=o(0),ma=async e=>{try{pa.value=3;const a=await ua.get(`/api/lead-proposal/${e.id}/download/`,{responseType:"blob"}),l=new Blob([a.data],{type:"application/pdf"}),o=document.createElement("a");o.href=URL.createObjectURL(l),o.download=`Proposal-${e.title}.pdf`,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(o.href)}catch(a){console.error("Error downloading PDF:",a)}finally{pa.value=0}},va=async e=>{try{pa.value=1;const a=await ua.get(`/api/lead-proposal/${e}/download/`,{responseType:"blob"}),l=new Blob([a.data],{type:"application/pdf"}),o=URL.createObjectURL(l),t=window.open(o,"_blank");t?t.onload=()=>{try{t.print()}catch(e){console.error("Error triggering print:",e)}finally{URL.revokeObjectURL(o)}}:console.error("Failed to open PDF in a new window.")}catch(a){console.error("Error printing PDF:",a)}finally{pa.value=0}},_a=e=>(j("data-v-82ab10b5"),e=e(),T(),e),fa={class:"columns is-multiline"},ba=_a((()=>p("div",{class:"column is-9"},[p("h1",{class:"title is-5 m-1 p-0"},"Preview Lead Proposal"),p("p",{class:"m-1"}," Below is a preview of the proposal that will be sent as a link to the email addresses on this client contact. The proposal can be accessed through the link while it is Released. ")],-1))),ya={class:"column is-12"},ga={class:"invoice-wrapper"},ha={class:"invoice-header"},Ia={class:"left"},wa={class:"right"},ka={class:"controls"},Ca=[_a((()=>p("i",{"aria-hidden":"true",class:"iconify","data-icon":"feather:printer"},null,-1)))],Pa=[_a((()=>p("i",{"aria-hidden":"true",class:"iconify","data-icon":"feather:download-cloud"},null,-1)))],Sa=[_a((()=>p("i",{"aria-hidden":"true",class:"iconify","data-icon":"feather:mail"},null,-1)))],Va={class:"invoice-body"},Da={class:"invoice-card"},xa={class:"invoice-section is-flex pt-0"},Ua=["src"],ja=_a((()=>p("div",{class:"meta"},null,-1))),Ta={class:"end is-right"},Oa=_a((()=>p("span",null,"PO Box 242",-1))),Ma=_a((()=>p("span",null,"Evergreen, CO 80437-0242",-1))),La=_a((()=>p("span",null,"Phone: 720 272-9061",-1))),Aa={class:"invoice-section is-flex"},Fa={class:"meta"},$a={key:0},Ea={key:1},Ha={key:3},Ra={class:"end is-left"},Na={class:"invoice-section"},qa={class:"responsive-table"},Ba=["innerHTML"],Ja={key:1},za={key:2},Wa={key:3},Ka={key:4},Ga={key:5},Qa={key:6},Ya={key:7},Xa={key:8},Za={key:9},el={class:"invoice-section is-flex mt-0 pt-0"},al={class:"end is-left"},ll={class:"text-right"},ol=U('<div class="invoice-section is-flex mt-0 pt-0" data-v-82ab10b5><div class="footer" data-v-82ab10b5><h1 class="subtitle is-6 py-0 mb-0" data-v-82ab10b5> I confirm that my action here represents my electronic signature and is binding. </h1><div class="footer-meta" data-v-82ab10b5><p data-v-82ab10b5>Signature:</p><div data-v-82ab10b5></div></div><div class="footer-meta" data-v-82ab10b5><p data-v-82ab10b5>Date:</p><div data-v-82ab10b5></div></div><div class="footer-meta" data-v-82ab10b5><p class="no-wrap" data-v-82ab10b5>Print Name:</p><div data-v-82ab10b5></div></div></div></div>',1),tl=O(e({__name:"ProposalPreview",props:{columnsToShow:{},proposalData:{}},setup(e){const a=e,l=le(),s=de(),r=o(!1),d=o([]),u=o([]),v=o({}),_=()=>{u.value.push(a.proposalData),v.value=a.proposalData,d.value=s.leadProposalFormData.columns_to_show,r.value=!r.value};function f(e){return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(e)}const b=o({proposal:"Proposal",change_order:"Change Order",draft:"Draft"});return t((()=>{})),(e,o)=>{const t=ae,d=ca;return n(),P("div",fa,[ba,p("div",ya,[p("div",ga,[p("div",ha,[p("div",Ia,[p("h3",null," Proposal-ID "+m(c(s).leadProposalFormData?.id.slice(0,8)),1)]),p("div",wa,[p("div",ka,[1==c(pa)?(n(),i(t,{key:0,color:"primary",outlined:"",size:"small",loading:"",circle:"",icon:"lucide:plus"})):(n(),P("a",{key:1,class:"action",onClick:o[0]||(o[0]=e=>c(va)(c(s).leadProposalFormData?.id))},Ca)),3==c(pa)?(n(),i(t,{key:2,color:"primary",outlined:"",size:"small",loading:"",circle:"",icon:"lucide:plus"})):(n(),P("a",{key:3,class:"action",onClick:o[1]||(o[1]=e=>c(ma)(c(s).leadProposalFormData))},Pa)),p("a",{class:"action",onClick:_},Sa)])])]),p("div",Va,[p("div",Da,[p("div",xa,[p("img",{style:{height:"160px",padding:"0",margin:"0"},src:c(l).currentCompany.invoice_header_logo},null,8,Ua),ja,p("div",Ta,[Oa,Ma,La,p("span",null,m(c(l).currentCompany.branding_line),1)])]),p("div",Aa,[p("div",Fa,[c(s).leadProposalFormData?.jobInfo?.title?(n(),P("h3",$a,m(c(s).leadProposalFormData?.jobInfo?.title?c(s).leadProposalFormData?.jobInfo?.title:""),1)):C("",!0),c(s).leadProposalFormData?.jobInfo?.clientInfo?(n(),P("span",Ea,m(c(s).leadProposalFormData?.jobInfo?.clientInfo?.username??"")+" "+m(c(s).leadProposalFormData?.jobInfo?.clientInfo?.last_name??""),1)):(n(),P("span",Ha,m(c(s).leadProposalFormData?.jobInfo?.contractor_info?.email?c(s).leadProposalFormData?.jobInfo?.contractor_info?.email:""),1)),p("span",null,m(c(b)[c(s).leadProposalFormData?.type]),1)]),p("div",Ra,[p("h3",null,m(c(s).leadProposalFormData?.title),1),p("p",null,m(c(s).leadProposalFormData?.jobInfo?.address??""),1)])]),p("div",Na,[p("table",qa,[p("thead",null,[(n(!0),P(S,null,V(a.columnsToShow,((e,a)=>(n(),P("th",{key:a},m(c(X)[e]),1)))),128))]),p("tbody",null,[(n(!0),P(S,null,V(c(s).proposalCostItems,((e,l)=>(n(),P("tr",{key:e.id},[(n(!0),P(S,null,V(a.columnsToShow,((a,l)=>(n(),P("td",{key:l},["description"===a?(n(),P("div",{key:0,innerHTML:e[c(Z)[a]]},null,8,Ba)):"cost_code"===a?(n(),P("span",Ja,m(e?.cost_code_info?.name),1)):"unit_cost"===a?(n(),P("span",za,m(f(e?.unit_cost)),1)):"margin"===a?(n(),P("span",Wa,m(f(e?.margin)),1)):"markup"===a?(n(),P("span",Ka,m(f(e?.markup)),1)):"builder_cost"===a?(n(),P("span",Ga,m(f(e?.builder_cost)),1)):"total_price"===a?(n(),P("span",Qa,m(f(e?.total_price)),1)):"profit"===a?(n(),P("span",Ya,m(f(e?.profit)),1)):"group_amount"===a?(n(),P("span",Xa,m(f(e?.group_amount)),1)):(n(),P("span",Za,m(e[c(Z)[a]]),1))])))),128))])))),128))])])]),p("div",el,[p("div",al,[p("h3",ll," Total Price: "+m(f(c(s).leadProposalFormData?.proposalAmount)),1)])]),ol])])])]),c(r)?(n(),i(d,{key:0,proposalSenderModal:c(r),selectedProposalsIds:c(u),proposalData:a.proposalData,columnsToShow:a.columnsToShow,"onUpdate:modalHandler":o[2]||(o[2]=e=>{r.value=!1,u.value=[]})},null,8,["proposalSenderModal","selectedProposalsIds","proposalData","columnsToShow"])):C("",!0)])}}}),[["__scopeId","data-v-82ab10b5"]]),sl=e=>(j("data-v-33d2a12b"),e=e(),T(),e),nl={class:"datatable-wrapper mt-0"},il={class:"table-container"},rl={class:"table datatable-table is-fullwidth",id:"external-events"},dl=sl((()=>p("th",null,null,-1))),cl=sl((()=>p("th",null,"Actions",-1))),ul=["data-event","onDragstart","onDrop","onDblclick"],pl={class:"is-relative"},ml=["onClick"],vl=["innerHTML"],_l={key:1},fl={key:2},bl=["onClick"],yl=[sl((()=>p("div",{class:"icon"},[p("i",{"aria-hidden":"true",class:"lnil lnil-briefcase"})],-1))),sl((()=>p("div",{class:"meta"},[p("span",null,"Edit"),p("span",null,"Edit Cost Item")],-1)))],gl=sl((()=>p("hr",{class:"dropdown-divider"},null,-1))),hl=["onClick"],Il=[sl((()=>p("div",{class:"icon"},[p("i",{"aria-hidden":"true",class:"lnil lnil-trash-can-alt"})],-1))),sl((()=>p("div",{class:"meta"},[p("span",null,"Remove"),p("span",null,"Remove from list")],-1)))],wl=e({__name:"CostItemsTable",props:{columnsToShow:{},itemsList:{},proposalId:{}},setup(e){const a=e,l=R(),s=o(""),u=o(!1),v=de(),f=N(),b=o(""),y=o(0),g=o(""),h=o(!1),w=o(!1),k=o({title:"",subtitle:"test",isSweetAlertOpen:!1,btntext:"text"}),D=e=>{e.preventDefault()},x=e=>{e.preventDefault(),e.currentTarget?.classList.add("drag-over")},U=e=>{e.preventDefault(),e.currentTarget?.classList.remove("drag-over")},j=async()=>{try{w.value=!0;await l.delete(`/api/cost/${g.value}/`);O(),k.value.isSweetAlertOpen=!1,f.success("Cost item deleted")}catch(e){console.log(e)}finally{w.value=!1}},T=(e,a=!1)=>{g.value=e.id,h.value=a,b.value=e.proposal,u.value=!u.value},O=()=>{v.getProposalCostItems(b.value)};return I((()=>a.columnsToShow),((e,o)=>{e&&JSON.stringify(e)!==JSON.stringify(o)&&(async()=>{try{a.proposalId&&await l.patch(`/api/lead-proposal/${a.proposalId}/`,{columns_to_show:JSON.stringify(a.columnsToShow)}),v.getProposalDetail(a.proposalId)}catch(e){f.error("Something went wrong, try again")}})()}),{deep:!0}),t((()=>{})),(e,o)=>{const t=te,f=oe,I=Ye;return n(),P("div",nl,[p("div",il,[p("table",rl,[p("thead",null,[dl,(n(!0),P(S,null,V(a.columnsToShow,((e,a)=>(n(),P("th",{key:a},m(c(X)[e]),1)))),128)),cl]),p("tbody",null,[c(v).proposalCostItems.length>0?(n(!0),P(S,{key:0},V(c(v).proposalCostItems,((e,o)=>(n(),P("tr",{key:e.id,"data-event":JSON.stringify(e),draggable:"true",onDragstart:a=>{return l=e.id,s.value=l,void console.log("Drag started for ID:",l);var l},onDrop:a=>(e=>{console.log("Dropped on ID:",e);const a=v.proposalCostItems.find((e=>e.id===s.value)),o=v.proposalCostItems.find((a=>a.id===e));if(a&&o){l.post("/api/cost/drag-drop-items/",{dragged_item_id:a.id,dropped_item_id:o.id});const e=v.proposalCostItems.indexOf(a),t=v.proposalCostItems.indexOf(o);e>=0&&t>=0&&(v.proposalCostItems.splice(e,1),v.proposalCostItems.splice(t,0,a))}else console.error("Dragged or Dropped Item not found");s.value=null})(e.id),onDragover:D,onDragenter:x,onDragleave:U,onDblclick:a=>T(e,!1),class:"draggable-item events"},[p("td",pl,[p("i",{style:{position:"absolute",bottom:"-7px",left:"1px",cursor:"pointer","z-index":"99","font-weight":"600"},onClick:a=>(e=>{b.value=e.proposal,y.value=e.index,u.value=!u.value})(e),class:"lnir lnir-circle-plus info-text","aria-hidden":"true"},null,8,ml)]),(n(!0),P(S,null,V(a.columnsToShow,((a,l)=>(n(),P("td",{key:l},["description"===a?(n(),P("div",{key:0,class:"custom-description",innerHTML:e[c(Z)[a]]},null,8,vl)):(n(),P("span",_l,m(e[c(Z)[a]]),1)),"cost_code"===a?(n(),P("span",fl,m(e?.cost_code_info?.name),1)):C("",!0)])))),128)),p("td",null,[d(t,{icon:"feather:more-vertical",class:"is-pushed-mobile",spaced:"",right:"",up:"",style:{"z-index":"99"}},{content:r((({close:a})=>[p("a",{role:"menuitem",href:"#",class:"dropdown-item is-media",onClick:_((()=>{T(e,!1),a()}),["prevent"])},yl,8,bl),gl,p("a",{role:"menuitem",href:"#",class:"dropdown-item is-media",onClick:_((()=>{(e=>{g.value=e.id,b.value=e.proposal,k.value={title:"Are you sure?",subtitle:"You will not be able to recover this cost item!",btntext:"Delete",isSweetAlertOpen:!0}})(e),a()}),["prevent"])},Il,8,hl)])),_:2},1024)])],40,ul)))),128)):C("",!0)])])]),c(k).isSweetAlertOpen?(n(),i(f,{key:0,isSweetAlertOpen:c(k).isSweetAlertOpen,title:c(k).title,subtitle:c(k).subtitle,btntext:c(k).btntext,onConfirm:j,onCancel:()=>c(k).isSweetAlertOpen=!1},null,8,["isSweetAlertOpen","title","subtitle","btntext","onCancel"])):C("",!0),c(u)?(n(),i(I,{key:1,costItemModal:c(u),proposalId:c(b),costItemId:c(g),previousItemIndex:c(y),previewCostItems:c(h),"onUpdate:modalHandler":o[0]||(o[0]=e=>{u.value=!1,g.value=""}),"onUpdate:OnSuccess":O},null,8,["costItemModal","proposalId","costItemId","previousItemIndex","previewCostItems"])):C("",!0)])}}}),kl=O(wl,[["__scopeId","data-v-33d2a12b"]]),Cl={class:"columns is-multiline"},Pl={class:"column is-12 is-flex space-between"},Sl=p("div",null,[p("h1",{class:"title is-4"},"Proposal Worksheet")],-1),Vl={key:0,class:"column is-12"},Dl={class:"tabs-wrapper column is-12 m-0"},xl={class:"tabs-inner mt-4"},Ul={class:"tabs is-boxed"},jl=[p("span",null,"Worksheet",-1)],Tl=[p("span",null,"Format",-1)],Ol=[p("span",null,"Preview",-1)],Ml={key:0,class:"column is-12"},Ll={key:0,class:"column is-12"},Al=p("div",{class:"column is-12",style:{"text-align":"center"}},[p("h1",{class:"title is-4"},"Connect your clients to their projects"),p("h1",{class:"title is-5"}," Create a client contact and assign them to jobs and lead opportunities effortlessly. ")],-1),Fl={class:"column is-12"},$l={key:0,class:"column is-12"},El=e({__name:"WorksheetItems",props:{leadProposalModal:{type:Boolean},proposalId:{},proposalData:{}},emits:["update:modalHandler","update:OnSuccess"],setup(e,{emit:l}){const m=e,b=R(),y=N(),w=a(),k=de(),S=o(!1),V=o(!1),x=o(!1),U=o("worksheet");g((()=>h((()=>import("./ckeditor-9f4296e0.js").then((e=>e.c))),["assets/ckeditor-9f4296e0.js","assets/index-69081f3d.js","assets/index-1649e834.css","assets/vue.runtime.esm-bundler-ef7f1a91.js"]).then((e=>e.default.component))));const j=async()=>{try{k.getProposalCostItems(m.proposalId)}catch(e){console.log(e)}};return I((()=>Y.value),((e,a)=>{e&&JSON.stringify(e)!==JSON.stringify(a)&&(async()=>{try{m.proposalId&&await b.patch(`/api/lead-proposal/${m.proposalId}/`,{columns_to_show:JSON.stringify(Y.value)}),k.getProposalDetail(m.proposalId)}catch(e){y.error("Something went wrong, try again")}})()}),{deep:!0}),t((async()=>{w.value=await h((()=>import("./ckeditor-65725719.js").then((e=>e.c))),["assets/ckeditor-65725719.js","assets/index-69081f3d.js","assets/index-1649e834.css"]).then((e=>e.default)),m.proposalId&&(j(),k.getProposalDetail(m.proposalId))})),M((()=>{k.clearProposalId()})),(e,a)=>{const l=f,o=s("Multiselect"),t=H,b=E,y=kl,g=D,h=tl,I=Ye,w=re;return n(),P("div",null,[p("div",Cl,[p("div",Pl,[Sl,p("div",null,[d(l,{size:"small",light:"",outlined:"",icon:"fas fa-cogs",class:"mr-2",color:c(V)?"danger":"warning",onClick:a[0]||(a[0]=e=>V.value=!c(V))},{default:r((()=>[v("Customize Columns")])),_:1},8,["color"]),d(l,{size:"small",light:"",outlined:"",color:"primary",onClick:a[1]||(a[1]=e=>S.value=!c(S))},{default:r((()=>[v("Add Item")])),_:1})])]),d(L,{class:"fade-slow",name:"fade-slow"},{default:r((()=>[c(V)?(n(),P("div",Vl,[d(b,{label:"Choose what to show to lead",class:"column is-12"},{default:r((({id:e})=>[d(t,null,{default:r((()=>[d(o,{modelValue:c(Y),"onUpdate:modelValue":a[2]||(a[2]=e=>u(Y)?Y.value=e:null),attrs:{id:e},mode:"tags",searchable:!0,"create-tag":!0,options:c(ee),placeholder:"Add columns"},null,8,["modelValue","attrs","options"])])),_:2},1024)])),_:1})])):C("",!0)])),_:1}),p("div",Dl,[p("div",xl,[p("div",Ul,[p("ul",null,[p("li",{class:A(["worksheet"===c(U)?"is-active":"not-active"])},[p("a",{tabindex:"0",role:"button",onKeydown:a[3]||(a[3]=F(_((e=>U.value="worksheet"),["prevent"]),["space"])),onClick:a[4]||(a[4]=e=>U.value="worksheet")},jl,32)],2),p("li",{class:A(["format"===c(U)?"is-active":"not-active"])},[p("a",{tabindex:"0",role:"button",onKeydown:a[5]||(a[5]=F(_((e=>U.value="format"),["prevent"]),["space"])),onClick:a[6]||(a[6]=e=>U.value="format")},Tl,32)],2),p("li",{class:A(["preview"===c(U)?"is-active":"not-active"])},[p("a",{tabindex:"0",role:"button",onKeydown:a[7]||(a[7]=F(_((e=>U.value="preview"),["prevent"]),["space"])),onClick:a[8]||(a[8]=e=>U.value="preview")},Ol,32)],2)])])])]),d(L,{class:"fade-slow",name:"slide-x"},{default:r((()=>["worksheet"===c(U)?(n(),P("div",Ml,[d(y,{columnsToShow:c(Y),proposalId:m.proposalId},null,8,["columnsToShow","proposalId"])])):C("",!0)])),_:1}),d(L,{class:"fade-slow",name:"slide-x"},{default:r((()=>["format"===c(U)?(n(),P("div",Ll,[d(g,{class:"columns is-multiline m-0"},{default:r((()=>[Al,p("div",Fl,[d(y,{columnsToShow:c(Y),proposalId:m.proposalId},null,8,["columnsToShow","proposalId"])])])),_:1})])):C("",!0)])),_:1}),d(L,{class:"fade-slow",name:"slide-x"},{default:r((()=>["preview"===c(U)?(n(),P("div",$l,[d(h,{proposalData:m.proposalData,proposalId:m.proposalId,columnsToShow:c(Y)},null,8,["proposalData","proposalId","columnsToShow"])])):C("",!0)])),_:1})]),c(S)?(n(),i(I,{key:0,costItemModal:c(S),proposalId:m.proposalId,"onUpdate:modalHandler":a[9]||(a[9]=e=>S.value=!1),"onUpdate:OnSuccess":j},null,8,["costItemModal","proposalId"])):C("",!0),c(x)?(n(),i(w,{key:1,centeredActionsOpen:c(x),proposalId:m.proposalId,"onUpdate:modalHandler":a[10]||(a[10]=e=>x.value=!1),"onUpdate:OnSuccess":j},null,8,["centeredActionsOpen","proposalId"])):C("",!0)])}}}),Hl=e=>(j("data-v-0317543a"),e=e(),T(),e),Rl={class:"columns is-multiline"},Nl=Hl((()=>p("div",{class:"column is-2"},null,-1))),ql={class:"column is-8"},Bl=Hl((()=>p("div",{class:"column is-2"},null,-1))),Jl=Hl((()=>p("div",{class:"column is-2"},null,-1))),zl=Hl((()=>p("div",{class:"column is-8"},[p("p",null," All the tasks will be generated and will start from the date you will put. ")],-1))),Wl=Hl((()=>p("div",{class:"column is-2"},null,-1))),Kl=e({__name:"CreateProposalTasksModal",props:{createProposalTasksModal:{type:Boolean,default:!1},proposalId:{default:""}},emits:["closeModalHandler","update:OnSuccess"],setup(e,{emit:a}){const l=e,s=N(),m=R(),b=o(""),y=o(!1),g=()=>{a("update:OnSuccess",null),a("closeModalHandler",!1)},h=async()=>{try{await m.post("/api/lead-proposal/create-tasks/",{start:b.value,proposal:l.proposalId});s.success("Tasks of this proposal are created in calendar successfully."),g()}catch(e){console.log(e),s.error("Something went wrong, please review the cost codes")}};return t((()=>{})),(e,a)=>{const o=W,t=H,s=E,m=f,I=$;return n(),i(I,{is:"form",open:l.createProposalTasksModal,title:"Generate Tasks",size:"small",actions:"center",onSubmit:_(h,["prevent"]),onClose:g},{content:r((()=>[p("div",Rl,[Nl,p("div",ql,[d(s,{label:"Enter Tasks Starting Date"},{default:r((()=>[d(t,null,{default:r((()=>[d(o,{modelValue:c(b),"onUpdate:modelValue":a[0]||(a[0]=e=>u(b)?b.value=e:null),required:"",name:"startDate",type:"date"},null,8,["modelValue"])])),_:1})])),_:1})]),Bl,Jl,zl,Wl])])),cancel:r((()=>[d(m,{light:"",onClick:a[1]||(a[1]=e=>g())},{default:r((()=>[v("Cancel")])),_:1})])),action:r((()=>[d(m,{loading:c(y),type:"submit",color:"info",light:"",raised:""},{default:r((()=>[v("Generate")])),_:1},8,["loading"])])),_:1},8,["open","onSubmit"])}}}),Gl=O(Kl,[["__scopeId","data-v-0317543a"]]);export{El as _,ca as a,Gl as b,Ye as c,ce as d,ma as e,de as u};
