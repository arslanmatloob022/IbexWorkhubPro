import{e,r as a,o as l,B as t,N as o,F as s,C as i,D as n,U as r,V as d,T as u,E as p,J as c,O as m,P as _,Q as f,R as y,s as v,b as g,_ as b,i as h,K as k,W as w,l as C,M as V,I as P,av as T,Z as I,Y as x,A as S,j,aR as M}from"./index-29281dbb.js";import{_ as U}from"./VModal.vue_vue_type_style_index_0_lang-8219c908.js";import{_ as A}from"./VControl-ee52cd5b.js";import{_ as q}from"./VRadio.vue_vue_type_style_index_0_lang-889eba47.js";import{u as E}from"./useAPI-dc6e43aa.js";import{u as R}from"./useNotyf-10ab29f3.js";import{u as O,_ as D,a as H}from"./CreateProposalTasksModal-5d4b4b2f.js";import{_ as L}from"./VTextarea.vue_vue_type_script_setup_true_lang-66aebab7.js";import{_ as G}from"./VField.vue_vue_type_script_setup_true_lang-6940a4a4.js";import{a as $,C as Z,e as B}from"./useSupportElement-aeaa4876.js";import{u as N}from"./userSession-d868ea25.js";import{s as F,c as z}from"./costItems-d39d9245.js";import{_ as Q}from"./VInput.vue_vue_type_script_setup_true_lang-f9d5e129.js";import{_ as J}from"./VLabel.vue_vue_type_script_setup_true_lang-525dfb1b.js";import{_ as W}from"./V-Snack.vue_vue_type_style_index_0_lang-530f9917.js";import{_ as K}from"./VIcon.vue_vue_type_script_setup_true_lang-db34cc26.js";import{_ as Y}from"./VFlexPagination.vue_vue_type_script_setup_true_lang-ab8295ac.js";import{_ as X,c as ee}from"./VFlexTable.vue_vue_type_style_index_0_lang-8e602d0b.js";import{_ as ae}from"./VCheckbox.vue_vue_type_style_index_0_lang-94655f56.js";import{_ as le}from"./VTag.vue_vue_type_style_index_0_lang-fe995cae.js";import{_ as te}from"./VPlaceholderPage.vue_vue_type_style_index_0_lang-9f399f1c.js";import{_ as oe,a as se}from"./search-4-dark-2b5b440c.js";import{_ as ie}from"./VAvatar.vue_vue_type_style_index_0_lang-318f90bb.js";const ne={key:0,class:"text-center py-4"},re={key:1},de={class:"table is-striped is-fullwidth"},ue=(e=>(_("data-v-871fd9a4"),e=e(),f(),e))((()=>n("thead",null,[n("tr",null,[n("th",{scope:"col"},"Title"),n("th",{scope:"col"},"Amount"),n("th",{scope:"col"},"Cost Items"),n("th",{scope:"col"},"Approval Deadline"),n("th",{scope:"col"},"Status"),n("th",{scope:"col",class:"is-end"},[n("div",{class:"dark-inverted is-flex is-justify-content-flex-end"}," Select ")])])],-1))),pe={class:"capitalize"},ce={class:"is-end"},me={class:"is-flex is-justify-content-flex-end"},_e=y(e({__name:"OpenTempalteModal",props:{opentempalte:{type:Boolean},proposalId:{},leadId:{}},emits:["update:modalHandler","update:OnSuccess"],setup(e,{emit:_}){const f=e,y=E(),v=R(),g=a([]),b=a(null),h=a(!1),k=()=>{_("update:modalHandler",!1)},w=async()=>{b.value?await C(b.value):v.error("Please select a template")},C=async e=>{try{const a=await y.post(`/api/lead-proposal/${e}/import-template/`,{existing_proposal:f.proposalId||"",lead:f.leadId});_("update:OnSuccess",a.data),console.log("test123"),v.success("Template imported successfully!"),k()}catch(a){console.error("Error importing template:",a),v.error("Something went wrong, try again")}};return l((()=>{(async()=>{h.value=!0;try{const e=await y.get("/api/lead-proposal/templates/");g.value=e.data}catch(e){v.error("Failed to fetch templates"),console.error(e)}finally{h.value=!1}})()})),(e,a)=>{const l=q,_=A,y=m,v=U;return t(),o(v,{open:f.opentempalte,size:"big",title:"Template List",actions:"right",onClose:k},{content:s((()=>[h.value?(t(),i("div",ne,"Loading...")):(t(),i("div",re,[n("table",de,[ue,n("tbody",null,[(t(!0),i(r,null,d(g.value,(e=>(t(),i("tr",{key:e.id},[n("td",null,u(e.title),1),n("td",null,u(e.proposalAmount),1),n("td",null,u(e.cost_items),1),n("td",null,u(e.approval_deadline),1),n("td",pe,u(e.status),1),n("td",ce,[n("div",me,[p(_,{raw:"",subcontrol:""},{default:s((()=>[p(l,{modelValue:b.value,"onUpdate:modelValue":a[0]||(a[0]=e=>b.value=e),value:e.id,name:"templateSelection"},null,8,["modelValue","value"])])),_:2},1024)])])])))),128))])])]))])),action:s((()=>[p(y,{color:"primary",raised:"",onClick:w},{default:s((()=>[c("Confirm")])),_:1})])),cancel:s((()=>[p(y,{color:"primary",style:{display:"none"},raised:""},{default:s((()=>[c("Close")])),_:1})])),_:1},8,["open"])}}}),[["__scopeId","data-v-871fd9a4"]]),fe={class:"modal-form columns is-multiline"},ye={class:"column is-12"},ve={class:"columns is-multiline"},ge={class:"field column is-6 mb-0"},be=n("label",null,"Title: *",-1),he={class:"control"},ke={class:"field column is-6"},we=n("label",null,"Approval Deadline *",-1),Ce={class:"control"},Ve={class:"column is-6"},Pe={class:"field column is-3"},Te=n("label",{class:"mb-3"},"Attachments",-1),Ie=n("div",{class:"file"},[n("label",{class:"file-label"},[n("input",{class:"file-input",type:"file",name:"resume",style:{width:"100%"}}),n("span",{class:"file-cta"},[n("span",{class:"file-icon"},[n("i",{class:"fas fa-cloud-upload-alt"})]),n("span",{class:"file-label"}," Choose a fileâ€¦ ")])])],-1),xe={class:"column is-3 pt-5"},Se={class:"column is-12"},je={class:"body-inner-content columns is-multiline"},Me={class:"field column is-12"},Ue=n("label",{for:"",class:"label"},"Internal Notes",-1),Ae={class:"field column is-12 mb-0"},qe=n("label",{for:"",class:"label"},"Introductory Text",-1),Ee={class:"field column is-12 mb-0"},Re=n("label",{for:"",class:"label"},"Closing Text",-1),Oe={class:"column is-12",id:"items-div"},De={key:0},He=e({__name:"LeadProposalModal",props:{leadProposalModal:{type:Boolean},proposalId:{},leadId:{}},emits:["update:modalHandler","update:OnSuccess","clearProposalId"],setup(e,{emit:r}){const d=e;O();const _=v();N();const f=R(),y=E(),T=a(!1),I=a(!1),x=a({id:"",title:"",approval_deadline:"",internal_notes:"",introductory_text:null,closing_text:null,payment_status:"",worksheetItems:[],type:"proposal",project:"",attachments:[],columns_to_show:[],status:"",created_at:"",updated_at:""}),S=async(e=!1)=>{try{T.value=!0,d.leadId&&(x.value.project=d.leadId),x.value.columns_to_show=JSON.stringify(F.value);const a=$(x.value,[]);if(d.proposalId||x.value.id){const e=await y.patch(`/api/lead-proposal/${d.proposalId?d.proposalId:x.value.id}/`,a);x.value=e.data,Z({object_type:"proposal",action:"UPDATE",performedOnName:"proposal",object_id:d.leadId||x.value.project,message:`updated proposal titled <a>${x.value.title}</a> information.`})}else{const e=await y.post("/api/lead-proposal/",a);x.value=e.data,Z({object_type:"proposal",action:"CREATE",performedOnName:"proposal",object_id:d.leadId||x.value.project,message:`created new proposal titled <a>${x.value.title}</a> information.`}),j(100)}H(),e&&M(),f.success(`Proposal ${d.proposalId||x.value.id?"updated":"created"} successfully`)}catch(a){f.error("Something went wrong, try again")}finally{T.value=!1}},j=(e=0)=>{const a=document.getElementById("items-div");if(a){const l=a.offsetTop-e;window.scrollTo({top:l,behavior:"smooth"})}},M=()=>{r("update:modalHandler",!1)},H=()=>{r("update:OnSuccess",null)},B=g((()=>b((()=>import("./ckeditor-abc035b9.js").then((e=>e.c))),["assets/ckeditor-abc035b9.js","assets/index-29281dbb.js","assets/index-a879fc9d.css","assets/vue.runtime.esm-bundler-1ff5ddd1.js"]).then((e=>e.default.component)))),z={fontFamily:{options:['"Montserrat", sans-serif','"Roboto", sans-serif']},height:"400px",minHeight:"400px"},Q=a(!1),J=e=>{x.value=e,console.log("test12")};return l((async()=>{_.value=await b((()=>import("./ckeditor-9e23ed86.js").then((e=>e.c))),["assets/ckeditor-9e23ed86.js","assets/index-29281dbb.js","assets/index-a879fc9d.css"]).then((e=>e.default)),d.proposalId&&(async()=>{try{const e=await y.get(`/api/lead-proposal/${d.proposalId}/`);x.value=e.data,F.value=e.data.columns_to_show}catch(e){console.log(e)}})()})),h((()=>{r("clearProposalId",null),x.value={}})),(e,a)=>{const l=q,r=A,f=G,y=m,v=L,g=D,b=_e,h=U;return t(),o(h,{is:"form",open:d.leadProposalModal,title:"Lead Proposal",size:"xl",actions:"right",onSubmit:a[12]||(a[12]=P((e=>S(!1)),["prevent"])),onClose:M},{content:s((()=>[n("div",fe,[n("div",ye,[n("div",ve,[n("div",ge,[be,n("div",he,[k(n("input",{type:"text",name:"title","onUpdate:modelValue":a[0]||(a[0]=e=>C(x).title=e),required:"",class:"input is-primary-focus is-primary-focus",placeholder:"Proposal Title"},null,512),[[w,C(x).title]])])]),n("div",ke,[we,n("div",Ce,[k(n("input",{type:"date",name:"firstName","onUpdate:modelValue":a[1]||(a[1]=e=>C(x).approval_deadline=e),required:"",class:"input is-primary-focus is-primary-focus",placeholder:"Proposal Approval deadline"},null,512),[[w,C(x).approval_deadline]])])]),n("div",Ve,[p(f,{class:"m-0 p-0",label:"Type"},{default:s((()=>[p(r,null,{default:s((()=>[p(l,{modelValue:C(x).type,"onUpdate:modelValue":a[2]||(a[2]=e=>C(x).type=e),value:"proposal",label:"Proposal",name:"solid_squared_radio",color:"primary",square:"",solid:""},null,8,["modelValue"]),p(l,{modelValue:C(x).type,"onUpdate:modelValue":a[3]||(a[3]=e=>C(x).type=e),value:"change_order",label:"Change Order",name:"solid_squared_radio",color:"info",square:"",solid:""},null,8,["modelValue"]),p(l,{modelValue:C(x).type,"onUpdate:modelValue":a[4]||(a[4]=e=>C(x).type=e),value:"draft",label:"Draft",name:"solid_squared_radio",color:"warning",square:"",solid:""},null,8,["modelValue"])])),_:1})])),_:1})]),n("div",Pe,[Te,p(f,{grouped:"",class:"mt-3"},{default:s((()=>[p(r,null,{default:s((()=>[Ie])),_:1})])),_:1})]),n("div",xe,[p(y,{color:"primary",class:"mt-5",onClick:a[5]||(a[5]=e=>Q.value=!C(Q)),style:{width:"100%"}},{default:s((()=>[c("Import Template")])),_:1})]),n("div",Se,[n("div",je,[n("div",Me,[Ue,p(f,null,{default:s((()=>[p(r,null,{default:s((()=>[p(v,{modelValue:C(x).internal_notes,"onUpdate:modelValue":a[6]||(a[6]=e=>C(x).internal_notes=e),rows:"4",placeholder:"Internal notes..."},null,8,["modelValue"])])),_:1})])),_:1})]),n("div",Ae,[qe,C(_)?(t(),o(C(B),{key:0,modelValue:C(x).introductory_text,"onUpdate:modelValue":a[7]||(a[7]=e=>C(x).introductory_text=e),editor:C(_),config:z},null,8,["modelValue","editor"])):V("",!0)]),n("div",Ee,[Re,C(_)?(t(),o(C(B),{key:0,modelValue:C(x).closing_text,"onUpdate:modelValue":a[8]||(a[8]=e=>C(x).closing_text=e),editor:C(_),config:z},null,8,["modelValue","editor"])):V("",!0)])])])])]),n("div",Oe,[C(x).id||d.proposalId?(t(),i("div",De,[p(g,{proposalId:C(x).id?C(x).id:d.proposalId,proposalData:C(x)},null,8,["proposalId","proposalData"])])):V("",!0)])]),C(Q)?(t(),o(b,{key:0,leadId:d.leadId,proposalId:d.proposalId,openTemplate:C(Q),"onUpdate:OnSuccess":J,"onUpdate:modalHandler":a[9]||(a[9]=e=>Q.value=!1)},null,8,["leadId","proposalId","openTemplate"])):V("",!0)])),action:s((()=>[p(y,{loading:C(T),type:"submit",color:"primary",raised:""},{default:s((()=>[c(u(d.proposalId||C(x).id?"Update Proposal":"Create Proposal"),1)])),_:1},8,["loading"]),p(y,{loading:C(I),onClick:a[10]||(a[10]=e=>S(!0)),color:"info",raised:""},{default:s((()=>[c(u(d.proposalId||C(x).id?"Update & Close":"Create & Close"),1)])),_:1},8,["loading"])])),cancel:s((()=>[p(y,{onClick:a[11]||(a[11]=e=>M()),raised:""},{default:s((()=>[c("Close")])),_:1})])),_:1},8,["open"])}}}),Le={class:"v-grid"},Ge=e({__name:"VGrid",props:{inline:{type:Boolean},gridTemplateColumns:{default:"none"},gridTemplateRows:{default:"none"},gridTemplateAreas:{default:"none"},columnGap:{default:"normal"},rowGap:{default:"normal"},justifyItems:{default:"initial"},alignItems:{default:"initial"},justifyContent:{default:"initial"},alignContent:{default:"initial"},placeContent:{default:"normal"},gridAutoColumns:{default:"auto"},gridAutoRows:{default:"auto"},gridAutoFlow:{default:"row"}},setup(e){const a=e;T((e=>({"36a9ff9c":C(l),"644edfcf":a.gridTemplateColumns,"13ee8f27":a.gridTemplateRows,"68f4ddf8":a.gridTemplateAreas,"3f6d0412":a.columnGap,"9b29192c":a.rowGap,"6ce21d44":a.justifyItems,"274efcee":a.alignItems,"5c2c4e97":a.justifyContent,"1a5afffc":a.alignContent,68195080:a.placeContent,d4bc820c:a.gridAutoColumns,"07161048":a.gridAutoRows,"0721119e":a.gridAutoFlow})));const l=I((()=>a.inline?"inline-grid":"grid"));return(e,a)=>(t(),i("div",Le,[x(e.$slots,"default")]))}}),$e={class:"v-grid-item"},Ze=e({__name:"VGridItem",props:{gridColumnStart:{default:"auto"},gridColumnEnd:{default:"auto"},gridRowStart:{default:"auto"},gridRowEnd:{default:"auto"},justifySelf:{default:"auto"},alignSelf:{default:"auto"},placeSelf:{default:"auto"}},setup(e){const a=e;return T((e=>({"639fd2f2":a.gridColumnStart,"0928fb6b":a.gridColumnEnd,"58f2dc22":a.gridRowStart,"690c909b":a.gridRowEnd,"4e453368":a.justifySelf,"3160ef46":a.alignSelf,"2e640d42":a.placeSelf}))),(e,a)=>(t(),i("div",$e,[x(e.$slots,"default")]))}}),Be={class:"columns is-multiline"},Ne={class:"column is-12"},Fe=(e=>(_("data-v-af7bf7a6"),e=e(),f(),e))((()=>n("div",{class:"column is-12 p-0 m-0"},[n("hr")],-1))),ze={class:"column is-12"},Qe={class:"column is-12"},Je={key:0,class:"column is-12"},We={class:"column is-12"},Ke={class:"column is-12"},Ye=y(e({__name:"MergeProposalModal",props:{groupProposalModal:{type:Boolean,default:!1},leadID:{default:""},selectedProposals:{default:[]}},emits:["update:modalHandler","update:OnSuccess","removeProposal"],setup(e,{emit:u}){const _=e,f=a(!1),y=E(),v=R(),g=a(!1),b=a([{value:"",label:""}]);a([{id:"",proposalAmount:0,title:"",approval_deadline:"",internal_notes:"",introductory_text:"",closing_text:"",payment_status:"",type:"",status:"",created_at:"",updated_at:"",job:""}]);const h=_.selectedProposals.map((e=>e.id)),k=a({title:"",type:"combined",description:"",proposals:h,trades:[],columns_to_show:[]}),w=()=>{u("update:modalHandler",!1)},T=async()=>{try{f.value=!0;let e=k.value;(g.value=!0)?e.columns_to_show=JSON.stringify(k.value.columns_to_show):e.columns_to_show=[],e.proposals=JSON.stringify(k.value.proposals);const a=await y.post("/api/lead-proposal/merge-proposals/",e,{responseType:"blob"}),l=new Blob([a.data],{type:"application/pdf"}),t=window.URL.createObjectURL(l),o=document.createElement("a");o.href=t,o.download="Merged_Proposal.pdf",document.body.appendChild(o),o.click(),document.body.removeChild(o),window.URL.revokeObjectURL(t),w(),v.success("Proposal grouped successfully and saved in documents list")}catch(e){console.log(e)}finally{f.value=!1}};return l((()=>{(async()=>{try{const e=await y.get("/api/cost-trade/");b.value=e.data.map((e=>({value:e.id,label:e.name})))}catch(e){console.log(e)}})()})),(e,a)=>{const l=K,y=W,v=Ze,h=Ge,I=J,x=q,j=A,M=G,E=Q,R=S("Multiselect"),O=L,D=m,H=U;return t(),o(H,{is:"form",open:_.groupProposalModal,title:"Group Proposal",size:"large",actions:"right",onSubmit:P(T,["prevent"]),onClose:a[8]||(a[8]=e=>w())},{content:s((()=>[n("div",Be,[n("div",Ne,[p(h,null,{default:s((()=>[p(v,null,{default:s((()=>[(t(!0),i(r,null,d(_.selectedProposals,(e=>(t(),o(y,{title:e.title,white:"",class:"m-1",icon:"lnir lnir-envelope"},{default:s((()=>[p(l,{onClick:a=>(e=>{u("removeProposal",e)})(e),icon:"lucide:x"},null,8,["onClick"])])),_:2},1032,["title"])))),256))])),_:1})])),_:1})]),Fe,n("div",ze,[p(M,null,{default:s((()=>[p(I,{style:{color:"var(--info) !important"}},{default:s((()=>[c("Select Group Type")])),_:1}),p(j,null,{default:s((()=>[p(x,{modelValue:C(k).type,"onUpdate:modelValue":a[0]||(a[0]=e=>C(k).type=e),value:"combined",label:"Combine Proposals",name:"outlined_squared_radio",color:"warning",square:""},null,8,["modelValue"]),p(x,{modelValue:C(k).type,"onUpdate:modelValue":a[1]||(a[1]=e=>C(k).type=e),value:"trade",label:"Trade Proposal",name:"outlined_squared_radio",color:"primary",square:""},null,8,["modelValue"]),p(x,{modelValue:C(k).type,"onUpdate:modelValue":a[2]||(a[2]=e=>C(k).type=e),value:"summary",label:"Summary Proposal",name:"outlined_squared_radio",color:"info",square:""},null,8,["modelValue"]),p(x,{modelValue:C(k).type,"onUpdate:modelValue":a[3]||(a[3]=e=>C(k).type=e),value:"report",label:"Report",name:"outlined_squared_radio",color:"success",square:""},null,8,["modelValue"])])),_:1})])),_:1})]),n("div",Qe,[p(M,{label:"Proposal Title *"},{default:s((()=>[p(j,null,{default:s((()=>[p(E,{modelValue:C(k).title,"onUpdate:modelValue":a[4]||(a[4]=e=>C(k).title=e),placeholder:"Enter Group Proposal Title",type:"text",name:"title",required:""},null,8,["modelValue"])])),_:1})])),_:1})]),C(g)?(t(),i("div",Je,[p(M,{label:"Choose what to merge in show in group proposal"},{default:s((({id:e})=>[p(j,null,{default:s((()=>[p(R,{modelValue:C(k).columns_to_show,"onUpdate:modelValue":a[5]||(a[5]=e=>C(k).columns_to_show=e),attrs:{id:e},mode:"tags",searchable:!0,"create-tag":!0,options:C(z),placeholder:"Add columns"},null,8,["modelValue","attrs","options"])])),_:2},1024)])),_:1})])):V("",!0),n("div",We,["trade"==C(k).type?(t(),o(M,{key:0,label:"Select the trades to merge"},{default:s((({id:e})=>[p(j,null,{default:s((()=>[p(R,{modelValue:C(k).trades,"onUpdate:modelValue":a[6]||(a[6]=e=>C(k).trades=e),attrs:{id:e},mode:"tags",searchable:!0,"create-tag":!0,options:C(b),placeholder:"Select Trade"},null,8,["modelValue","attrs","options"])])),_:2},1024)])),_:1})):V("",!0)]),n("div",Ke,[p(M,{label:"Group Description"},{default:s((()=>[p(j,null,{default:s((()=>[p(O,{modelValue:C(k).description,"onUpdate:modelValue":a[7]||(a[7]=e=>C(k).description=e),placeholder:"Enter Group Proposal Title",rows:"3",type:"text"},null,8,["modelValue"])])),_:1})])),_:1})])])])),action:s((()=>[p(D,{loading:C(f),type:"submit",color:"warning",raised:""},{default:s((()=>[c("Group Proposals")])),_:1},8,["loading"])])),_:1},8,["open","onSubmit"])}}}),[["__scopeId","data-v-af7bf7a6"]]),Xe=e=>(_("data-v-b307b22f"),e=e(),f(),e),ea={class:"columns is-multiline"},aa={class:"column is-12 is-flex space-between"},la=Xe((()=>n("div",null,null,-1))),ta={class:"is-flex"},oa={class:"column is-12"},sa={class:"flex-list-wrapper flex-list-v2"},ia=Xe((()=>n("img",{class:"light-image",src:oe,alt:""},null,-1))),na=Xe((()=>n("img",{class:"dark-image",src:se,alt:""},null,-1))),ra={class:"tab-content is-active"},da={class:"item-name dark-inverted"},ua={class:"item-meta"},pa={class:"light-text"},ca=y(e({__name:"ProposalGroupModal",props:{leadProposalListModal:{type:Boolean},leadID:{default:""}},emits:["update:modalHandler","update:OnSuccess"],setup(e,{emit:_}){const f=e,y=a([{id:"",proposalAmount:0,title:"",approval_deadline:"",internal_notes:"",introductory_text:"",closing_text:"",payment_status:"",type:"",status:"",created_at:"",updated_at:"",job:""}]),v=a("combine"),g=a(!1),b=a("active"),h=E(),k=a([]),w=a([{value:"",label:""}]),P=a(!1),T=a([]);T.value.map((e=>e.id));const x=a(""),q={picture:{label:"Proposal",grow:!0,media:!0},customer:"Type",industry:"Amount",status:"Status",team:{label:"Payment"},actions:{label:"Select",align:"end"}},R=a(!1),O=e=>{const a=T.value.findIndex((a=>a.id===e.id));-1!==a?T.value.splice(a,1):T.value.push(e)},D=I((()=>{if(x.value){const e=new RegExp(x.value,"i");return y.value.filter((a=>a.title.match(e)||a.description.match(e)))}return y.value})),L=()=>{_("update:modalHandler",!1)};return l((()=>{(async()=>{try{g.value=!0;const e=await h.get(`/api/lead-proposal/by-project/${f.leadID}/`);y.value=e.data}catch(e){console.log(e)}finally{g.value=!1}})(),(async()=>{try{const e=await h.get("/api/cost-trade/");w.value=e.data.map((e=>({value:e.id,label:e.name})))}catch(e){console.log(e)}})()})),(e,a)=>{const l=S("Multiselect"),_=A,y=G,h=m,I=te,x=ee,E=le,$=ae,Z=X,N=Y,F=Ye,z=H,Q=U;return t(),o(Q,{is:"form",open:f.leadProposalListModal,title:"Proposal List",size:"xl",actions:"right",onClose:L},{content:s((()=>[n("div",ea,[n("div",aa,[la,n("div",ta,["trade"==C(v)?(t(),o(y,{key:0,style:{width:"340px"}},{default:s((({id:e})=>[p(_,null,{default:s((()=>[p(l,{modelValue:C(k),"onUpdate:modelValue":a[0]||(a[0]=e=>j(k)?k.value=e:null),attrs:{id:e},mode:"tags",searchable:!0,"create-tag":!0,options:C(w),placeholder:"Select Trades"},null,8,["modelValue","attrs","options"])])),_:2},1024)])),_:1})):V("",!0),p(h,{class:"ml-2",onClick:a[1]||(a[1]=e=>P.value=!C(P)),raised:"",color:"warning",light:"",outlined:"",icon:"lnil lnil-files-alt",disabled:!C(T).length},{default:s((()=>[c(" Group Proposal ")])),_:1},8,["disabled"]),p(h,{class:"ml-2",raised:"",icon:"fas fa-envelope",color:"info",light:"",disabled:!C(T).length,outlined:"",onClick:a[2]||(a[2]=e=>{R.value=!R.value})},{default:s((()=>[c(" Send ")])),_:1},8,["disabled"])])]),n("div",oa,[n("div",sa,["active"===C(b)&&0===C(D).length?(t(),o(I,{key:0,title:"We couldn't find any matching results.",subtitle:"Too bad. Looks like we couldn't find any matching results for the\n          search terms you've entered. Please try different search terms or\n          criteria.",larger:""},{image:s((()=>[ia,na])),_:1})):V("",!0),n("div",ra,[C(D).length?(t(),o(Z,{key:0,data:C(D),columns:q,rounded:""},{body:s((()=>[p(M,{name:"list",tag:"div",class:"flex-list-inner"},{default:s((()=>[(t(!0),i(r,null,d(C(D),(e=>(t(),i("div",{key:e.id,class:"flex-table-item"},[p(x,{column:{media:!0,grow:!0}},{default:s((()=>[n("div",null,[n("span",da,u(e.title??"N/A"),1),n("span",ua,[n("span",null,u(C(B)(e.created_at)),1)])])])),_:2},1024),p(x,null,{default:s((()=>[p(E,null,{default:s((()=>[c(u(e.type),1)])),_:2},1024)])),_:2},1024),p(x,null,{default:s((()=>[n("span",pa,"$"+u(e.proposalAmount),1)])),_:2},1024),p(x,null,{default:s((()=>[p(E,{rounded:""},{default:s((()=>[c(u(e.status),1)])),_:2},1024)])),_:2},1024),p(x,null,{default:s((()=>[p(E,{rounded:""},{default:s((()=>[c(u(e.status),1)])),_:2},1024)])),_:2},1024),p(x,{column:{align:"end"}},{default:s((()=>[p(_,{raw:"",subcontrol:""},{default:s((()=>[p($,{onClick:()=>{O(e)},modelValue:e.payment_status,"onUpdate:modelValue":a=>e.payment_status=a,label:"",color:"primary"},null,8,["onClick","modelValue","onUpdate:modelValue"])])),_:2},1024)])),_:2},1024)])))),128))])),_:1})])),_:1},8,["data"])):V("",!0),C(D).length>5?(t(),o(N,{key:1,"item-per-page":10,"total-items":873,"current-page":42,"max-links-displayed":7})):V("",!0)])])]),C(P)?(t(),o(F,{key:0,"group-proposal-modal":C(P),selectedProposals:C(T),onRemoveProposal:O,"onUpdate:modalHandler":a[3]||(a[3]=e=>P.value=!C(P))},null,8,["group-proposal-modal","selectedProposals"])):V("",!0),C(R)?(t(),o(z,{key:1,proposalSenderModal:C(R),selectedProposalsIds:C(T),"onUpdate:modalHandler":a[4]||(a[4]=e=>R.value=!1)},null,8,["proposalSenderModal","selectedProposalsIds"])):V("",!0)])])),action:s((()=>[p(h,{loading:C(g),type:"submit",color:"warning",raised:"",onClick:L},{default:s((()=>[c("Close")])),_:1},8,["loading"])])),_:1},8,["open"])}}}),[["__scopeId","data-v-b307b22f"]]),ma=a([{id:"12347",title:"Electrical Wiring",cost_code:"040100",cost_type:"Material",unit_cost:20,quantity:500,unit:"meters",total_cost:1e4,price:750,markup:15,markup_type:"percentage",markup_value:1500,markup_amount:3e3,unit_price:50,tax_rate:7.5,client_price:12000.9,total_price:9e3,builder_cost:825,group_price:78987,grand_total:12325,total_markup:9874567,mark_as:"catalogue_item",description:"Electrical wiring and related materials.",internal_notes:"Include wiring for backup generator.",created_by:"user125",created_date:"2024-12-22T12:00:00Z",updated_by:"user125",updated_date:"2024-12-22T13:00:00Z",approved_by:"manager458",approval_date:"2024-12-22T18:00:00Z",status:"pending",category:"Electrical",tags:["wiring","electrical","materials"],attachments:[],visibility:{admin:!0,internal_only:!1,shared_with_client:!1},front_end_elements:{highlighted:!1,background_color:"#f0f0f0",font_color:"#000000",display_order:3,editable:!0}},{id:"56789",title:"Plumbing Fixtures",cost_code:"050200",cost_type:"Labor",unit_cost:45,quantity:200,unit:"hours",total_cost:9e3,price:1500,markup:20,markup_type:"percentage",markup_value:1800,markup_amount:3600,unit_price:75,tax_rate:8,client_price:12000.9,total_price:10800,builder_cost:950,group_price:67890,grand_total:13200,total_markup:1234567,mark_as:"custom_item",description:"Installation of plumbing fixtures.",internal_notes:"Check water pressure before installation.",created_by:"user456",created_date:"2024-11-30T09:00:00Z",updated_by:"user456",updated_date:"2024-12-01T10:00:00Z",approved_by:"manager123",approval_date:"2024-12-01T15:00:00Z",status:"approved",category:"Plumbing",tags:["plumbing","fixtures","labor"],attachments:[],visibility:{admin:!0,internal_only:!0,shared_with_client:!1},front_end_elements:{highlighted:!0,background_color:"#ffffff",font_color:"#333333",display_order:1,editable:!1}},{id:"90123",title:"HVAC Installation",cost_code:"070300",cost_type:"Service",unit_cost:75,quantity:50,unit:"units",total_cost:3750,client_price:12000.9,price:850,markup:10,markup_type:"fixed",markup_value:850,markup_amount:1700,unit_price:95,tax_rate:6.5,total_price:4200,builder_cost:1025,group_price:56789,grand_total:15500,total_markup:654321,mark_as:"service_item",description:"HVAC system installation and setup.",internal_notes:"Ensure proper duct sealing.",created_by:"user789",created_date:"2024-12-10T14:00:00Z",updated_by:"user789",updated_date:"2024-12-15T11:30:00Z",approved_by:"manager567",approval_date:"2024-12-16T09:00:00Z",status:"completed",category:"HVAC",tags:["HVAC","installation","service"],attachments:[],visibility:{admin:!0,internal_only:!1,shared_with_client:!0},front_end_elements:{highlighted:!0,background_color:"#e6e6e6",font_color:"#111111",display_order:2,editable:!0}},{id:"34567",title:"Roofing Materials",cost_code:"080500",cost_type:"Material",unit_cost:30,quantity:1e3,unit:"sheets",total_cost:3e4,client_price:12000.9,price:1200,markup:25,markup_type:"percentage",markup_value:3e3,markup_amount:7500,unit_price:90,tax_rate:9,total_price:32700,builder_cost:1125,group_price:43210,grand_total:37500,total_markup:98765,mark_as:"material_item",description:"High-quality roofing materials.",internal_notes:"Ensure weather-resistant properties.",created_by:"user321",created_date:"2024-12-05T08:00:00Z",updated_by:"user321",updated_date:"2024-12-06T12:00:00Z",approved_by:"manager789",approval_date:"2024-12-07T14:00:00Z",status:"pending",category:"Roofing",tags:["roofing","materials","construction"],attachments:[],visibility:{admin:!1,internal_only:!0,shared_with_client:!0},front_end_elements:{highlighted:!1,background_color:"#dddddd",font_color:"#444444",display_order:4,editable:!1}}]);a({CostCode:"Cost Code",Title:"Title",Unit:"Unit",Description:"Description",CostType:"Cost Type",MarkAs:"Mark As",Quantity:"Quantity",UnitCost:"Unit Cost",BuilderCost:"Builder Cost",Markup:"Markup",MarkupAmount:"Markup Amount",Status:"Status",ClientPrice:"Client Price",GroupPrice:"Group Price",TotalCost:"Total Cost",TotalMarkup:"Total Markup",Profit:"Profit",Notes:"Internal Notes",State:"State"}),a({CostCode:"cost_code",Title:"title",Unit:"unit",Description:"description",CostType:"cost_type",MarkAs:"mark_as",Quantity:"quantity",UnitCost:"unit_cost",ClientPrice:"total_price",BuilderCost:"builder_cost",Markup:"markup",Status:"status",GroupPrice:"group_amount",TotalMarkup:"total_markup",Profit:"profit",Notes:"internal_notes",MarkupAmount:"markup_amount"});const _a={class:"columns is-multiline"},fa={class:"column is-12"},ya={class:"invoice-wrapper"},va=n("div",{class:"invoice-header"},[n("div",{class:"left"},[n("h3",null,"Proposal-ID PD-456-14")]),n("div",{class:"right"},[n("div",{class:"controls"},[n("a",{class:"action"},[n("i",{"aria-hidden":"true",class:"iconify","data-icon":"feather:printer"})]),n("a",{class:"action"},[n("i",{"aria-hidden":"true",class:"iconify","data-icon":"feather:download-cloud"})]),n("a",{class:"action"},[n("i",{"aria-hidden":"true",class:"iconify","data-icon":"feather:mail"})])])])],-1),ga={class:"invoice-body"},ba={class:"invoice-card"},ha={class:"invoice-section is-flex is-bordered"},ka=n("div",{class:"meta"},null,-1),wa=n("div",{class:"end"},[n("span",null,"PO Box 242"),n("span",null,"Evergreen, CO 80437-0242"),n("span",null,"Phone: 720 272-9061"),n("span",null,"Premium Trades for Premier Builders")],-1),Ca=n("div",{class:"invoice-section is-flex is-bordered"},[n("div",{class:"meta"},[n("h3",null,"Client Name"),n("span",null,"Client Phone"),n("span",null,"25724 Independence Trail Evergreen, CO 80439")]),n("div",{class:"end is-left"},[n("h3",null,"Friday Jan 17, 2025"),n("p",null," Lorem ipsum dolor sit amet, consectetur adipiscing elit. Quod equidem non reprehendo. ")])],-1),Va={key:0,class:"invoice-section"},Pa={class:"responsive-table"},Ta=n("br",null,null,-1),Ia=["innerHTML"],xa={class:"invoice-section is-flex mt-0 pt-0"},Sa={class:"end is-left"},ja={class:"text-right"},Ma=n("p",null,"Mentioned price are final",-1),Ua=e({__name:"ProposalViewModal",props:{previewModal:{type:Boolean},columnsToShow:{default:!1},proposalId:{default:""}},emits:["update:modalHandler","update:OnSuccess"],setup(e,{emit:_}){const f=e,y=E();O();const v=a([{name:"Website Redesign",unit:"hrs",quantity:54,rate:24},{name:"Logo Design",unit:"hrs",quantity:12,rate:24},{name:"Custom Illustrations",unit:"hrs",quantity:7,rate:32}]);I((()=>{const e=v.value.reduce(((e,a)=>e+a.quantity*a.rate),0),a=.1*e;return[{label:"Subtotal",value:e},{label:"Taxes",value:a},{label:"Total",value:e+a}]}));const g=["Item","Description","Unit Cost","Qty","Unit","Builder Cost","Markup","Total Price"];a(""),a(!0),a(!0),a(!0),a(!0);const b=I((()=>ma.value.reduce(((e,a)=>e+a.price*a.quantity),0))),h=a(!1);a({id:"c897de41-609f-4a20-8d79-0537b6a873d6",title:"Test Lead's Proposal",approval_deadline:"2025-01-30",internal_notes:null,introductory_text:null,closing_text:null,payment_status:"Pending",type:"proposal",status:"pending",created_at:"2025-01-21T19:08:06.509861Z",updated_at:"2025-01-21T19:08:06.509875Z",job:"da0aa7c1-3744-4856-a637-e5a821f5ec7e"});const k=a([{id:"5e7d026a-b392-47e9-9d24-58fbc1de12c5",index:1,title:"Test Lead Proposal Item",description:"<p>Description</p>",type:"",quantity:100,unit:"Sq ft",unit_cost:"10.00",markup:"150.00",total_price:"1150.00",cost_code:"11012",cost_type:"material",builder_cost:"1000.00",margin:"1.00",profit:"0.00",internal_notes:"Internal notes",mark_as:"bid",state:"active",group_amount:"0.00",status:null,created_at:"2025-01-23T18:25:46.392750Z",proposal:"c897de41-609f-4a20-8d79-0537b6a873d6"}]),w=()=>{_("update:modalHandler",!1)},P=async()=>{try{const e=await y.get(`api/cost/by-proposal/${f.proposalId}/`);k.value=e.data}catch(e){console.log(e)}};return l((()=>{(async()=>{try{h.value=!0,await y.get(`/api/lead-proposal/${f.proposalId}/`),P()}catch(e){console.log(e)}finally{h.value=!1}})()})),(e,a)=>{const l=ie,_=m,y=U;return t(),o(y,{is:"form",open:f.previewModal,title:"Cost Item ",size:"xl",actions:"right",onClose:w},{content:s((()=>[n("div",_a,[n("div",fa,[n("div",ya,[va,n("div",ga,[n("div",ba,[n("div",ha,[p(l,{size:"xl",picture:"/logos/IbexFavicon.png"}),ka,wa]),Ca,C(k).length?(t(),i("div",Va,[n("table",Pa,[n("thead",null,[(t(),i(r,null,d(g,((e,a)=>n("th",{key:a},u(e),1))),64))]),n("tbody",null,[(t(!0),i(r,null,d(C(k),((e,a)=>(t(),i("tr",{key:e.id},[n("td",null,[n("span",null,u(e.title),1),Ta,n("span",null,u(e.cost_code),1)]),n("td",null,[n("span",{innerHTML:e.description},null,8,Ia)]),n("td",null,[n("span",null," $"+u(e.unit_cost),1)]),n("td",null,[n("span",null,u(e.quantity),1)]),n("td",null,[n("span",null,u(e.unit),1)]),n("td",null,[n("span",null," $"+u(e.builder_cost),1)]),n("td",null,[n("span",null," $"+u(e.markup),1)]),n("td",null,[n("span",null," $"+u(e.total_price),1)])])))),128))])])])):V("",!0),n("div",xa,[n("div",Sa,[n("h3",ja,"Total Price: $"+u(C(b)),1),Ma])])])])])])])])),action:s((()=>[p(_,{loading:C(h),type:"submit",color:"warning",raised:"",onClick:w},{default:s((()=>[c("Close")])),_:1},8,["loading"])])),_:1},8,["open"])}}});export{He as _,Ua as a,ca as b};
