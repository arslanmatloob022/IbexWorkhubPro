import{a as e,_ as a}from"./SiteDetailModal-4bc09843.js";import{_ as l}from"./VModal.vue_vue_type_style_index_0_lang-6ce02f3d.js";import{_ as t}from"./VCollapse.vue_vue_type_style_index_0_lang-ec9d300f.js";import{_ as s}from"./VTextarea.vue_vue_type_script_setup_true_lang-807fbaa8.js";import{e as o,r as i,w as n,o as r,M as c,y as d,H as u,B as m,C as p,A as f,D as v,l as g,j as y,J as h,E as b,ad as _,W as I,X as k,L as w,z as x,P as S,Q as C,R as j,t as A,a4 as V,N as M,s as T,O as N,a3 as W,v as R}from"./index-94b0decd.js";import{_ as D}from"./VSwitchSegment.vue_vue_type_style_index_0_lang-e3e84ee3.js";import{_ as P}from"./VField.vue_vue_type_script_setup_true_lang-df35fbf6.js";import{_ as L}from"./VControl-268f8966.js";import{_ as U}from"./VInput.vue_vue_type_script_setup_true_lang-4127fe53.js";import{_ as $}from"./VLabel.vue_vue_type_script_setup_true_lang-cc97d481.js";import{u as O}from"./useAPI-f19b1499.js";import{u as z}from"./useNotyf-4c5e2a2c.js";import{u as J}from"./company-b9870e82.js";import{_ as E}from"./VCheckbox.vue_vue_type_style_index_0_lang-e8bcb7a4.js";import{_ as F}from"./TimeSheetDetail.vue_vue_type_script_setup_true_lang-96a14bda.js";import{_ as G}from"./VPlaceholderPage.vue_vue_type_style_index_0_lang-1375b83c.js";import{_ as H}from"./VDropdown.vue_vue_type_style_index_0_lang-6f7a6f2b.js";import{_ as q}from"./VAvatar.vue_vue_type_style_index_0_lang-8515c50c.js";import{_ as B}from"./PlaceloadV1.vue_vue_type_style_index_0_lang-43ff5ff6.js";import{_ as Y,a as K}from"./projects-dark-4a371d8a.js";import{f as Z,b as Q}from"./useSupportElement-1c0827bb.js";import{_ as X,i as ee,a as ae}from"./index-583f5af2.js";import{F as le}from"./index-94ad6ab7.js";import{i as te}from"./index-1ac9df1c.js";import{_ as se}from"./VIconButton-a3e4e471.js";import{A as oe}from"./vue3-apexcharts.common-5ff8ae0c.js";import{u as ie}from"./useThemeColors-9cf9bcef.js";import{u as ne}from"./viewWrapper-6f3e98dd.js";import"./VIcon.vue_vue_type_script_setup_true_lang-778e7e31.js";import"./useVFieldContext-7cac6ea8.js";import"./userSession-2bbe7c4c.js";import"./notyf-c21a4bc8.js";import"./useDropdown-5ace7dc4.js";import"./VPlaceloadWrap-c076237f.js";import"./VPlaceloadText.vue_vue_type_style_index_0_lang-1ae75b03.js";import"./VPlaceloadAvatar.vue_vue_type_style_index_0_lang-1be2c4fa.js";import"./VSwitchBlock.vue_vue_type_style_index_0_lang-f242fcb5.js";import"./VTags.vue_vue_type_script_setup_true_lang-2faae28f.js";import"./VTag.vue_vue_type_style_index_0_lang-0d1cc5d7.js";import"./vue.runtime.esm-bundler-878ee781.js";const re=e=>(I("data-v-f088ffca"),e=e(),k(),e),ce={class:"modal-form columns is-multiline cu-all-input",id:"addJob"},de={class:"field column is-12 mb-0",id:"rota-celender-two"},ue={class:"columns is-multiline mb-3 cu-all-input"},me={class:"column is-12"},pe={class:"columns is-multiline cu-all-input"},fe={class:"column is-6"},ve={class:"column is-6"},ge={class:"column is-12 smart-search-dropdown"},ye={class:"multiselect-single-label",style:{"background-color":"transparent"}},he=["src"],be={class:"options-div"},_e={class:"option-cdiv"},Ie=["src"],ke={class:"option-ddiv"},we={class:"option-span"},xe={class:"mail-span"},Se=re((()=>p("span",{class:"email-span"},"Email:",-1))),Ce={class:"column is-6"},je={class:"column is-6"},Ae=re((()=>p("i",{class:"lnil lnil-envelope mr-2","aria-hidden":"true"},null,-1))),Ve=re((()=>p("i",{class:"lnil lnil-envelope mr-2","aria-hidden":"true"},null,-1))),Me=re((()=>p("div",{class:"head-info"},[p("div",{class:"head-progress"})],-1))),Te={class:"body-inner-content"},Ne={class:"field columns is-multiline mb-0"},We={class:"column is-12"},Re={class:"columns is-multiline"},De={class:"field column is-5 mb-0"},Pe=re((()=>p("label",null,"Upload File",-1))),Le=re((()=>p("div",{class:"file has-name"},[p("label",{class:"file-label"},[p("input",{class:"file-input",type:"file",name:"resume"}),p("span",{class:"file-cta"},[p("span",{class:"file-icon"},[p("i",{class:"fas fa-cloud-upload-alt"})]),p("span",{class:"file-label"}," Choose a fileâ€¦ ")]),p("span",{class:"file-name light-text"}," filename... ")])],-1))),Ue={class:"",style:{width:"97%"}},$e=o({__name:"AddJobsModal",props:{jobId:{},AddJobModalOpen:{type:Boolean}},emits:["update:modalHandler","update:onSuccess"],setup(e,{emit:a}){const o=e,I=J(),k=i(!1),w=z(),x=O(),S=i(""),C=i({}),j=i({}),A=i([]),V=i(""),M=i(!1),T=i(0),N=i([]),W=i([]),R=i([]);let E=i([]);const F=i(""),G=[{title:"Additional Information",content:"Add additional information about job"}],H=i({externalId:"",title:"",company:"",description:"",manager:0,isWorkWithContractor:!0,file:File}),q=()=>{a("update:modalHandler",!1)},B=()=>{o.jobId?K():Y()},Y=async()=>{k.value=!0;try{if(F.value){H.value.company=I.loggedCompany.id;await x.post("/v3/api/vixen-job/",H.value);w.success("Job Added Successfuly"),q(),a("update:onSuccess",null)}else w.error("Please select a Manager");k.value=!1}catch(e){console.log(e),w.error("Error while adding a job"),k.value=!1}},K=async()=>{k.value=!0;try{await x.patch(`/v3/api/vixen-job/${o.jobId}/`,H.value);w.success("Job Added Successfuly"),q(),a("update:onSuccess",null),k.value=!1}catch(e){console.log(e),w.error("Error while adding a job"),k.value=!1}},Z=async()=>{await B(),Q()},Q=async()=>{try{await x.post("/v3/api/vixen-job/rams-mail/",{job:T.value});w.green("Email sent sucessfuly")}catch(e){console.log(e)}},X=e=>{const a=new Date(e),l=new Intl.DateTimeFormat("en-US",{weekday:"long",day:"2-digit",month:"long"});H.value.title=`Job at ${l.format(a)}`};return n(F,((e,a)=>{H.value.manager=e})),n(S,((e,a)=>{M.value=!1;const l=A.value.find((a=>a.id==e));l&&(C.value=l,M.value=!0)})),n(V,((e,a)=>{M.value=!1;const l=N.value.find((a=>a.id==e));l&&(R.value.push(l),j.value=l,M.value=!0)})),r((()=>{(()=>{let e=new Date,a=e.getFullYear(),l=String(e.getMonth()+1).padStart(2,"0"),t=String(e.getDate()).padStart(2,"0");X(`${a}-${l}-${t}`)})(),(async()=>{try{const e=await x.get(`/v3/api/account/user/company-managers/${I.loggedCompany.id}/`,{});E.value=e.data.map((e=>({value:e.id.toString(),name:`${e.first_name} ${e.last_name}`,icon:e.profileImage,email:e.email}))),W.value=e.data}catch{w.error("Invalid data")}finally{k.value=!1}})(),o.jobId&&(async()=>{try{k.value=!0;const e=await x.get(`/v3/api/vixen-job/${o.jobId}/`);H.value=e.data,e.data.manager&&o.jobId&&(F.value=e.data.manager,console.log("current manager",F.value)),k.value=!1}catch(e){console.log(e)}})()})),(e,a)=>{const i=$,n=U,r=L,I=P,w=c("Multiselect"),x=D,S=b,C=_,j=s,A=t,V=l;return d(),u(V,{is:"form",size:"large",open:o.AddJobModalOpen,title:"Create Job",actions:"right",onClose:q},{content:m((()=>[p("div",ce,[p("div",de,[p("div",ue,[p("div",me,[p("div",pe,[p("div",fe,[f(I,null,{default:m((()=>[f(i,null,{default:m((()=>[v("Name")])),_:1}),f(r,null,{default:m((()=>[f(n,{modelValue:g(H).title,"onUpdate:modelValue":a[0]||(a[0]=e=>g(H).title=e),type:"text",placeholder:"Title"},null,8,["modelValue"])])),_:1})])),_:1})]),p("div",ve,[f(I,null,{default:m((()=>[f(i,null,{default:m((()=>[v("External Id (Optional)")])),_:1}),f(r,null,{default:m((()=>[f(n,{modelValue:g(H).externalId,"onUpdate:modelValue":a[1]||(a[1]=e=>g(H).externalId=e),type:"text",placeholder:"External id"},null,8,["modelValue"])])),_:1})])),_:1})]),p("div",ge,[f(I,null,{default:m((({id:e})=>[f(i,null,{default:m((()=>[v("Select Manager (PM)")])),_:1}),f(r,{class:"placement-wrapper"},{default:m((()=>[f(w,{class:"multi-select",modelValue:g(F),"onUpdate:modelValue":a[2]||(a[2]=e=>y(F)?F.value=e:null),attrs:{id:e},placeholder:"Select a manager",label:"name",options:g(E),searchable:!0,"track-by":"name",height:40,multiselectable:""},{singlelabel:m((({value:e})=>[p("div",ye,[p("img",{class:"select-label-icon mr-2 value-image",src:e.icon,alt:""},null,8,he),v(" "+h(e.name),1)])])),option:m((({option:e})=>[p("div",be,[p("div",_e,[p("img",{class:"select-option-icon mr-2 option-image",src:e.icon,alt:""},null,8,Ie),p("div",ke,[p("span",we,h(e.name),1),p("span",xe,[Se,v(" "+h(e.email),1)])])])])])),_:2},1032,["modelValue","attrs","options"])])),_:2},1024)])),_:1})]),p("div",Ce,[f(I,{horizontal:""},{default:m((()=>[f(r,null,{default:m((()=>[f(x,{modelValue:g(H).isWorkWithContractor,"onUpdate:modelValue":a[3]||(a[3]=e=>g(H).isWorkWithContractor=e),"label-true":"Work with contractor","label-false":"Self Serve",color:"primary"},null,8,["modelValue"])])),_:1})])),_:1})]),p("div",je,[f(C,null,{default:m((()=>[g(H).isWorkWithContractor?(d(),u(S,{key:0,light:"",onClick:Z,rounded:"",color:"info"},{default:m((()=>[Ae,v("Initiate RAMS")])),_:1})):(d(),u(S,{key:1,light:"",rounded:"",color:"info"},{default:m((()=>[Ve,v("Initiate CPP")])),_:1}))])),_:1})]),f(A,{items:G,"with-chevron":"",style:{"border-radius":"14px"}},{"collapse-item-head":m((e=>[Me])),"collapse-item-content":m((e=>[p("div",Te,[p("div",Ne,[p("div",We,[p("div",Re,[p("div",De,[Pe,f(I,{grouped:""},{default:m((()=>[f(r,null,{default:m((()=>[Le])),_:1})])),_:1})]),p("div",Ue,[f(I,null,{default:m((()=>[f(i,null,{default:m((()=>[v("Description")])),_:1}),f(r,null,{default:m((()=>[f(j,{modelValue:g(H).description,"onUpdate:modelValue":a[4]||(a[4]=e=>g(H).description=e),type:"text",placeholder:"Job description"},null,8,["modelValue"])])),_:1})])),_:1})])])])])])])),_:1})])])])])]),f(S,{style:{float:"right"},class:"mr-5",onClick:B,loading:g(k),rounded:"",color:"primary"},{default:m((()=>[v(h(e.$props.jobId?"Update Job":"Create Job"),1)])),_:1},8,["loading"])])),cancel:m((()=>[f(S,{style:{display:"none"},type:"cancel",color:"primary",loading:g(k),raised:""},{default:m((()=>[v("Create job schedule")])),_:1},8,["loading"]),f(S,{style:{display:"none"},type:"submit",color:"primary",loading:g(k),raised:""},{default:m((()=>[v("Create job schedule")])),_:1},8,["loading"])])),action:m((()=>[f(S,{onClick:B,color:"primary",style:{display:"none"},loading:g(k),raised:""},{default:m((()=>[v("Create job ")])),_:1},8,["loading"])])),_:1},8,["open"])}}}),Oe=w($e,[["__scopeId","data-v-f088ffca"]]),ze=e=>(I("data-v-2e6799d4"),e=e(),k(),e),Je={class:"timeline-wrapper"},Ee=ze((()=>p("div",{class:"timeline-header"},null,-1))),Fe={class:"timeline-wrapper-inner"},Ge={class:"timeline-container"},He={class:"timeline-item is-unread"},qe={class:"date"},Be=ze((()=>p("div",{class:"dot is-success"},null,-1))),Ye={class:"content-wrap"},Ke=["onClick"],Ze=ze((()=>p("div",{class:"no-status"},null,-1))),Qe={class:"container"},Xe={class:"half"},ea={class:"",style:{display:"flex","align-items":"center"}},aa={class:"box-text"},la={class:"meta-text"},ta={class:""},sa=ze((()=>p("i",{class:"lnir lnir-hospital-location mr-2",style:{"font-size":"larger",color:"var(--primary)"},"aria-hidden":"true"},null,-1))),oa={class:"half"},ia={class:"",style:{display:"flex","align-items":"center"}},na={class:"box-text"},ra={class:"meta-text"},ca={style:{display:"flex"}},da=ze((()=>p("i",{class:"lnir lnir-hospital-location mr-2",style:{"font-size":"larger",color:"var(--primary)"},"aria-hidden":"true"},null,-1))),ua={class:"box-end"},ma=ze((()=>p("div",{class:"icon"},[p("i",{"aria-hidden":"true",class:"lnil lnil-bubble"})],-1))),pa=ze((()=>p("div",{class:"meta"},[p("span",null,"Activity"),p("span",null,"View activity of Timesheet")],-1))),fa=[ma,pa],va=ze((()=>p("img",{class:"light-image is-larger",src:Y,alt:""},null,-1))),ga=ze((()=>p("img",{class:"dark-image is-larger",src:K,alt:""},null,-1))),ya=o({__name:"JobTImesheet",props:{id:{type:String,default:0}},setup(e){const a=e,l=O(),t=i(!1),s=i(!1),o=i(0),n=i([]);return r((()=>{(async()=>{try{t.value=!0;const e=await l.get(`v3/api/timesheet/job/${a.id}/`);n.value=e.data,console.log("timesheeeet",n.value),t.value=!1}catch(e){console.log(e)}})()})),(e,a)=>{const l=B,i=q,r=H,c=G,y=F;return d(),x("div",Je,[Ee,p("div",Fe,[p("div",Ge,[g(t)?(d(),u(l,{key:0})):S("",!0),(d(!0),x(C,null,j(g(n),(e=>(d(),x("div",He,[p("div",qe,[p("span",null,h(g(Z)(e.created_at)),1)]),Be,p("div",Ye,[p("div",{class:"content-box",onClick:()=>{s.value=!0,o.value=e.id}},[Ze,p("div",Qe,[p("div",Xe,[p("div",ea,[f(i,{picture:e.bookOnImageURL,squared:"",size:"medium"},null,8,["picture"]),p("div",aa,[p("div",la,[p("p",null,[p("span",null,h(g(Q)(e.bookOnTime)),1)]),p("span",ta,[sa,v(" "+h(e.bookOnLocation&&e.bookOnLocation.length>90?e.bookOnLocation.slice(0,90)+"...":e.bookOnLocation),1)])])])])]),p("div",oa,[p("div",ia,[f(i,{picture:e.bookOffImageURL,squared:"",size:"medium"},null,8,["picture"]),p("div",na,[p("div",ra,[p("p",null,[p("span",null,h(g(Q)(e.bookOffTime)),1)]),p("span",ca,[da,v(" "+h(e.bookOffLocation&&e.bookOffLocation.length>90?e.bookOffLocation.slice(0,90)+"...":e.bookOffLocation),1)])])])])])]),p("div",ua,[f(r,{icon:"feather:more-vertical",spaced:"",right:""},{content:m((()=>[p("a",{role:"menuitem",href:"#",class:"dropdown-item is-media",onClick:a[0]||(a[0]=e=>s.value=!0)},fa)])),_:1})])],8,Ke)])])))),256)),0==g(n).length?(d(),u(c,{key:1,title:"No Activity found.",subtitle:"Looks like you don't have done any activity on this worker yet as you will do anything, that will be showing up in here."},{image:m((()=>[va,ga])),_:1})):S("",!0)])]),g(s)?(d(),u(y,{key:0,timeSheetDetailModal:g(s),timesheetId:"993","onUpdate:modalHandler":a[1]||(a[1]=()=>{s.value=!1})},null,8,["timeSheetDetailModal"])):S("",!0)])}}}),ha=w(ya,[["__scopeId","data-v-2e6799d4"]]),ba={class:"row"},_a={class:"columns is-multiline"},Ia={class:"column is-6"},ka={class:"columns is-multiline"},wa={class:"column is-12"},xa={class:"columns is-multiline"},Sa={class:"column is-3"},Ca={class:"column is-9"},ja={class:"is-flex space-between"},Aa={style:{width:"120px","white-space":"nowrap"},class:"title is-5 mb-2"},Va=p("i",{class:"lnir lnir-apple","aria-hidden":"true"},null,-1),Ma=p("i",{class:"iconify ml-3 cu-pointer pointer","data-icon":"feather:external-link"},null,-1),Ta=[Va,Ma],Na={class:"is-flex cus-align-center mb-1"},Wa=p("i",{class:"iconify text-light","data-icon":"feather:phone","aria-hidden":"true"},null,-1),Ra={class:"is-bold"},Da={class:"is-flex cus-align-center mb-1"},Pa=p("i",{class:"iconify","data-icon":"feather:mail","aria-hidden":"true"},null,-1),La={class:"is-bold"},Ua={class:"is-flex cus-align-center mb-1 text-light"},$a=p("i",{class:"iconify","data-icon":"feather:map-pin","aria-hidden":"true"},null,-1),Oa={class:"is-bold"},za={class:"column is-12"},Ja={class:"columns is-multiline"},Ea={class:"column is-5"},Fa=p("h3",{class:"title is-5 mb-2"},"Site Name",-1),Ga={class:"is-bold"},Ha={class:"column is-5"},qa=p("h3",{class:"title is-5 mb-2"},"Date",-1),Ba={class:"is-bold"},Ya={class:"column is-2"},Ka={class:"column is-10"},Za=p("h3",{class:"title is-5 mb-2"},"Site Addreess",-1),Qa={class:"is-bold"},Xa={class:"column is-2"},el=p("div",{class:"column is-6"},[p("div",{id:"myMap",style:{height:"324px",width:"100%","border-radius":"10px"}})],-1),al=p("button",{style:{display:"none"}},"close",-1),ll=o({__name:"RotaDetailView",props:{timeSheetDetailModal:{type:Boolean},timesheetId:{},rotaId:{},getRota:{type:Function}},emits:["update:modalHandler"],setup(e,{emit:a}){const t=e;let s,o,n;const c=i([]),v=A(),g=O(),y=i(!1),b=i(!1),_=i({id:0,siteInfo:{id:5,name:"",address:"",postcode:"",city:"",inchargeName:"",color:"",latitude:0,longitude:0,geofence:{},comments:""},workerInfo:{id:0,firstName:"",lastName:"",latitude:0,longitude:0,postCode:" ",phoneNumber:"",emailAddress:"",profileImageURL:""},customerCompanyInfo:{id:36,name:"",trade_name:"",email:"",phone_number:"",logo:"",postcode:"",latitude:0,longitude:0,business_details:"",reg_no:"",business_type:"",covered_distance:75,vat_no:null,address:"",color:"",created_at:"",company:0,industry:0},date:"",start:"",end:"",shift:"",hourlyRate:0,notes:"",createdAt:"",createdBy:"",UpdatedAt:null,updatedBy:"",company:0,site:0,worker:0,customerCompany:0,job:null,jobsList:[{id:"",end:"",start:"",jobName:"",resourceId:""}]}),I=()=>{a("update:modalHandler",!1),t.getRota()},k=()=>{v.push({name:"/sidebar/company/workers/[id]",params:{id:_.value.wokrkerInfo.id}})};return r((async()=>{await(async()=>{try{const e=await g.get(`/v3/api/timesheet/details/${t.timesheetId}/`);_.value=e.data,console.log("rota info",_.value),c.value=e.data.jobsList.map((e=>({...e,title:e.jobName})))}catch(e){console.log(e)}})(),((e,a,l,t)=>{const i=new google.maps.LatLng(e,a),r=new google.maps.LatLng(l,t);s=new google.maps.Map(document.getElementById("myMap"),{center:i,scrollwheel:!1,mapTypeId:google.maps.MapTypeId.Satellite,zoom:7}),o=new google.maps.DirectionsService,n=new google.maps.DirectionsRenderer,n.setMap(s);const c={origin:i,destination:r,travelMode:google.maps.TravelMode.DRIVING};o.route(c,(function(e,a){a===google.maps.DirectionsStatus.OK?n.setDirections(e):console.error("Error fetching directions: "+a)})),new google.maps.Marker({position:i,map:s,title:"Worker Location"}),new google.maps.Marker({position:r,map:s,title:"Site Location"})})(_.value.wokrkerInfo&&_.value.wokrkerInfo.latitude?_.value.wokrkerInfo.latitude:"0",_.value.wokrkerInfo&&_.value.wokrkerInfo.longitude?_.value.wokrkerInfo:"0",_.value.siteInfo&&_.value.siteInfo.latitude?_.value.siteInfo.latitude:0,_.value.siteInfo&&_.value.siteInfo.longitude?_.value.siteInfo.longitude:"0")})),(e,a)=>{const s=q,o=V,i=X,n=l;return d(),u(n,{open:t.timeSheetDetailModal,title:"Rota Detail",size:"xl",actions:"right",onClose:I},{content:m((()=>[p("div",ba,[p("div",_a,[p("div",Ia,[p("div",ka,[p("i",{style:{position:"absolute",top:"44px",left:"166px"},class:"fas fa-pencil-alt cu-pointer flex-align-end","aria-hidden":"true",onClick:a[0]||(a[0]=e=>y.value=!0)}),p("i",{style:{position:"absolute",top:"44px",left:"190px",color:"var(--danger)"},class:"fas fa-trash-alt cu-pointer flex-align-end","aria-hidden":"true",onClick:a[1]||(a[1]=()=>{b.value=!b.value})}),p("div",wa,[f(o,{radius:"large",elevated:""},{default:m((()=>[p("div",xa,[p("div",Sa,[f(s,{onClick:k,picture:_.value.workerInfo&&_.value.workerInfo.profileImageURL?_.value.workerInfo.profileImageURL:"",size:"big",squared:""},null,8,["picture"])]),p("div",Ca,[p("div",ja,[p("div",null,[p("h3",Aa,h(_.value.workerInfo?_.value.workerInfo.firstName:"------")+" "+h(_.value.workerInfo?_.value.workerInfo.lastName:"------"),1)]),p("div",{onClick:k,class:"is-flex cus-align-center"},Ta)]),p("div",Na,[Wa,p("p",Ra,h(_.value.workerInfo?_.value.workerInfo.phoneNumber:"------"),1)]),p("div",Da,[Pa,p("p",La,h(_.value.workerInfo?_.value.workerInfo.emailAddress:"------"),1)]),p("div",Ua,[$a,p("p",Oa,h(_.value.workerInfo?_.value.workerInfo.postCode:"------"),1)])])])])),_:1})]),p("div",za,[f(o,{radius:"large",elevated:""},{default:m((()=>[p("div",Ja,[p("div",Ea,[Fa,p("p",Ga,h(_.value.siteInfo?_.value.siteInfo.name:"------"),1)]),p("div",Ha,[qa,p("p",Ba,h(_.value&&_.value.created_at?_.value.created_at.slice(0,10):"------"),1)]),p("div",Ya,[f(s,{picture:_.value.customerCompanyInfo?_.value.customerCompanyInfo.logo:"/images/logoplaceholder.png",size:"medium",rounded:""},null,8,["picture"])]),p("div",Ka,[Za,p("p",Qa,h(_.value.siteInfo?_.value.siteInfo.address:"------"),1)]),p("div",Xa,[f(s,{picture:"day"==_.value.shift?"/images/dayTime.png":"/images/nightTime.png",size:"medium",rounded:""},null,8,["picture"])])])])),_:1})])])]),el])]),f(o,{class:"mt-3",radius:"large",elevated:""},{default:m((()=>[f(i,{timesheetId:"993"})])),_:1})])),action:m((()=>[])),cancel:m((()=>[al])),_:1},8,["open"])}}}),tl=e=>(I("data-v-914e8774"),e=e(),k(),e),sl={id:"rota-celender"},ol={class:"columns is-multiline"},il=tl((()=>p("div",{class:"column is-7 is-flex space-between"},[p("h6",{style:{"white-space":"nowrap"},class:"cus-main-heading mr-3 ml-1 mt-5"}," Job Scheduling ")],-1))),nl={class:"column is-5 mt-4"},rl={class:"list-flex-toolbar is-reversed"},cl={class:"buttons"},dl={class:"p-2 flex-columns event-content",style:{display:"flex","justify-content":"space-between",height:"90px",width:"100%","border-radius":"12px","background-color":"#effaec",padding:"6px 10px"}},ul={class:"is-flex space-between mb-2"},ml=tl((()=>p("i",{class:"fas fa-sun",style:{color:"#3f72c8","font-size":"16px"},"aria-hidden":"true"},null,-1))),pl={style:{"font-weight":"600","margin-bottom":"0px","padding-left":"10px",color:"#444"}},fl={class:"is-flex mb-1"},vl=["src"],gl={style:{"font-weight":"600","margin-bottom":"0px","padding-left":"10px",color:"#444"}},yl=tl((()=>p("div",{class:"is-flex"},[p("p",{style:{"font-weight":"600","margin-bottom":"0px","padding-left":"10px",color:"#666"}})],-1))),hl={style:{"margin-top":"12px","font-weight":"600","margin-bottom":"8px","padding-left":"10px",color:"#666"}},bl=o({__name:"JobRota",props:{id:{type:String,default:"0"},calendarView:{type:String,default:"dayGridMonth"}},setup(e){const a=e,l=i(""),t=i(""),s=O(),o=i(!1),c=i(!1),y=i([]),_=i("");const I=i({plugins:[ee,te],initialView:a.calendarView,height:"auto",selectable:!0,eventClick:function(e){_.value=e.event.id,o.value=!o.value},eventColor:"transparent",themeSystem:"bootstrap5",headerToolbar:{left:"prev,next today",center:"title",right:"dayGridMonth,dayGridWeek,dayGridDay"},views:{dayGridMonth:{eventLimit:3},dayGridWeek:{eventLimit:50},dayGridDay:{eventLimit:50}},eventLimitClick:"popover",droppable:!0,editable:!0,dayCellDidMount:function(e){!function(e){var a=e.el;a.style.background="#fff",a.style.borderRadius="16px"}(e)},events:[],datesSet:function(e){l.value=e.startStr.substring(0,10),t.value=e.endStr.substring(0,10)}}),k=()=>{y.value=[];const e=document.querySelector("#rota-celender");e&&e.querySelectorAll("td").forEach((function(e){e.removeAttribute("style")}))},w=e=>{y.value.splice(e,1)},j=async()=>{const{data:e}=await s.get(`v3/api/timesheet/job/${a.id}`);var l;I.value.events=((l=e).forEach((e=>{const a=e.bookOnTime,l=e.bookOffTime;e.startedTime=a,e.endedTime=l,e.start=e.bookOnTime})),l),console.log("rota data",e),k()};return n([()=>l.value,()=>t.value],(([e,a],[l,t])=>{j()})),r((()=>{j()})),n((()=>a.workerId),((e,a)=>{j()})),(e,l)=>{const t=b,s=ae,i=ll;return d(),x(C,null,[p("div",sl,[p("div",ol,[il,p("div",nl,[p("div",rl,[p("div",cl,[f(t,{disabled:!y.value.length,color:"info",onClick:k,elevated:""},{default:m((()=>[v(" Clear Selection ("+h(y.value.length)+") ",1)])),_:1},8,["disabled"]),f(t,{disabled:!y.value.length,color:"primary",onClick:l[0]||(l[0]=e=>c.value=!c.value),elevated:""},{default:m((()=>[v(" Add Rota - Days ("+h(y.value.length)+") ",1)])),_:1},8,["disabled"])])])])]),f(g(le),{options:I.value},{eventContent:m((e=>[p("div",dl,[p("div",ul,[ml,p("p",pl,h(e.event.extendedProps.startedTime?e.event.extendedProps.startedTime.slice(11,16):"-- : --")+" - "+h(e.event.extendedProps.endedTime?e.event.extendedProps.endedTime.slice(11,16):"----"),1)]),p("div",null,[p("div",fl,[p("img",{style:{width:"30px"},src:e.event.extendedProps.workerInfo.profileImageURL,alt:""},null,8,vl),p("p",gl,h(e.event.extendedProps.workerInfo?`${e.event.extendedProps.workerInfo.firstName}\n             ${e.event.extendedProps.workerInfo.lastName}`:"Not Added"),1)]),yl,p("p",hl," Worked: "+h(e.event.extendedProps.hoursWorked?e.event.extendedProps.hoursWorked:"0")+" Hours ",1)])])])),_:1},8,["options"])]),c.value?(d(),u(s,{key:0,"onUpdate:modalHandler":l[1]||(l[1]=()=>{c.value=!c.value,k()}),"onUpdate:OnSuccess":j,AddRotaModalOpen:c.value,selectedDatesArray:y.value,workerId:a.workerId,onRemoveDate:w},null,8,["AddRotaModalOpen","selectedDatesArray","workerId"])):S("",!0),o.value?(d(),u(i,{key:1,timeSheetDetailModal:o.value,timesheetId:_.value,"onUpdate:modalHandler":l[2]||(l[2]=()=>{o.value=!1}),getRota:j},null,8,["timeSheetDetailModal","timesheetId"])):S("",!0)],64)}}}),_l=w(bl,[["__scopeId","data-v-914e8774"]]),Il=e=>(I("data-v-fb16d804"),e=e(),k(),e),kl={class:"card columns is-multiline mb-3",style:{"border-radius":"24px",width:"100%",padding:"20px 20px","background-image":"linear-gradient(180deg, white 85%, #faad4225)"}},wl={class:"column is-12 mt-0"},xl=Il((()=>p("i",{class:"lnir lnir-pencil-alt",style:{"font-weight":"800"},"aria-hidden":"true"},null,-1))),Sl=Il((()=>p("i",{class:"fas fa-arrow-right ml-1","aria-hidden":"true"},null,-1))),Cl=Il((()=>p("i",{class:"fas fa-clipboard","aria-hidden":"true"},null,-1))),jl=Il((()=>p("i",{class:"fas fa-arrow-right ml-1","aria-hidden":"true"},null,-1))),Al=Il((()=>p("i",{class:"fas fa-clipboard-check","aria-hidden":"true"},null,-1))),Vl=Il((()=>p("i",{class:"fas fa-arrow-right ml-1","aria-hidden":"true"},null,-1))),Ml=Il((()=>p("i",{class:"fas fa-clock","aria-hidden":"true"},null,-1))),Tl=Il((()=>p("i",{class:"fas fa-arrow-right ml-1","aria-hidden":"true"},null,-1))),Nl=Il((()=>p("i",{class:"fas fa-child","aria-hidden":"true"},null,-1))),Wl=Il((()=>p("i",{class:"fas fa-check-circle ml-1","aria-hidden":"true"},null,-1))),Rl={class:"column is-6"},Dl={class:"row"},Pl={class:"columns is-multiline"},Ll={class:"column is-12 is-md-bold dark-text"},Ul={class:"column is-3"},$l={class:"is-small-bold"},Ol={style:{"font-size":"13px",color:"#bbb"}},zl={class:"is-small-bold"},Jl={style:{"font-size":"13px",color:"#bbb"}},El={class:"column is-3"},Fl={class:"is-small-bold mb-1"},Gl={style:{"font-size":"13px",color:"#bbb"}},Hl={class:"is-small-bold dark-text"},ql={style:{"font-size":"13px",color:"#bbb"}},Bl={class:"column is-4"},Yl=Il((()=>p("h1",{class:"title"},"Manager",-1))),Kl={class:"is-flex"},Zl={class:"manager-info ml-2"},Ql={class:"is-bold mb-2"},Xl={class:"is-bold mb-2"},et={key:0,class:"modal-form columns is-multiline cu-all-input mt-6"},at={class:"field column is-12 mb-0",id:"rota-celender-two"},lt={class:"columns is-multiline mb-3 cu-all-input"},tt={class:"column is-12"},st={class:"field columns is-multiline mb-0 cu-all-input space-between lengthy-smart-search-dropdown"},ot={class:"field column is-6 mb-0 is-relative"},it={class:"mb-2 columns is-multiline"},nt={class:"column is-4"},rt=["src"],ct={class:"column is-5"},dt={key:0},ut={key:1,class:"is-bold"},mt={class:"column is-12"},pt=Il((()=>p("h1",null,"Job",-1))),ft={class:"is-bold"},vt={class:"column is-5"},gt=Il((()=>p("h1",null,"Id",-1))),yt={class:"is-bold"},ht={class:"column is-4"},bt=Il((()=>p("h1",null,"Type",-1))),_t={class:"is-bold"},It={class:"column is-5"},kt=Il((()=>p("h1",null,"Created At",-1))),wt={class:"is-bold"},xt={class:"column is-4"},St=Il((()=>p("h1",null,"Manager",-1))),Ct={class:"is-bold"},jt={class:"column is-12"},At=Il((()=>p("h1",null,"Description",-1))),Vt={class:"is-bold"},Mt={key:1,class:"modal-form columns is-multiline cu-all-input mt-1"},Tt={class:"field column is-12 mb-0",id:"rota-celender-two"},Nt={class:"columns is-multiline mb-3 cu-all-input"},Wt={class:"column is-12 mt-5"},Rt={key:0,class:"column is-12"},Dt={class:"field columns is-multiline mb-0 cu-all-input space-between lengthy-smart-search-dropdown"},Pt={class:"field column is-5 mb-0"},Lt={class:"multiselect-single-label",style:{"background-color":"transparent"}},Ut={style:{display:"flex","flex-direction":"column",gap:"0.5rem"}},$t={class:"",style:{display:"flex","flex-direction":"column","align-items":"start"}},Ot={style:{color:"#666","font-size":"1rem"}},zt={style:{"font-weight":"500","font-size":"1.2rem"}},Jt={style:{display:"flex","flex-direction":"row",gap:"0.2rem","align-items":"start"}},Et={style:{color:"#666","font-size":"0.9rem"}},Ft={style:{color:"#666","font-size":"0.9rem"}},Gt=Il((()=>p("span",{style:{"background-color":"#eee",height:"2px",width:"100%"}},null,-1))),Ht={class:"mt-5 is-flex space-between cus-align-center"},qt=Il((()=>p("h1",null,"Or",-1))),Bt={class:"field column is-6 mb-0"},Yt={class:"mb-2 columns is-multiline"},Kt={class:"column is-4"},Zt=["src"],Qt={class:"column is-5"},Xt={key:0},es={key:1,class:"is-bold"},as={class:"column is-4"},ls=Il((()=>p("h1",null,"Site Id",-1))),ts={class:"is-bold"},ss={class:"column is-5"},os=Il((()=>p("h1",null,"Site Name",-1))),is={class:"is-bold"},ns={class:"column is-4"},rs=Il((()=>p("h1",null,"Post Code",-1))),cs={class:"is-bold"},ds={class:"column is-5"},us=Il((()=>p("h1",null,"Address",-1))),ms={class:"is-bold"},ps={class:"column is-4"},fs=Il((()=>p("h1",null,"Incharge Name",-1))),vs={class:"is-bold"},gs={class:"column is-5"},ys=Il((()=>p("h1",null,"Incharge Email",-1))),hs={class:"is-bold"},bs={key:1,class:"column is-12"},_s={class:"field columns is-multiline mb-0 cu-all-input space-between smart-search-dropdown"},Is={class:"field column is-5 mb-0"},ks={class:"multiselect-single-label",style:{"background-color":"transparent"}},ws=["src"],xs=["src"],Ss={class:"field column is-6 mb-0"},Cs={key:0,class:"is-md-bold mb-2"},js={key:1,class:"is-md-bold mb-2"},As={class:"mb-2 columns is-multiline"},Vs=["onClick"],Ms={class:"info ml-3"},Ts={class:"is-md-bold"},Ns={class:"is-bold cu-align-center"},Ws=Il((()=>p("i",{class:"iconify mr-1","data-icon":"feather:mail","aria-hidden":"true"},null,-1))),Rs={class:"is-bold cu-align-center"},Ds=Il((()=>p("i",{class:"lnil lnil-map-marker mr-1","aria-hidden":"true"},null,-1))),Ps={class:"column is-3"},Ls=Il((()=>p("h1",null,"Profile Completion",-1))),Us={class:"is-bold"},$s={style:{color:"var(--primary)"}},Os={class:"is-bold"},zs={class:"column is-3"},Js=Il((()=>p("h1",null,"Anomalies",-1))),Es={class:"is-bold"},Fs={class:"is-bold"},Gs={class:"is-bold"},Hs={key:2,class:"modal-form columns is-multiline cu-all-input"},qs={class:"field column is-12 mb-0",id:"rota-celender-two"},Bs={class:"columns is-multiline mb-3 cu-all-input"},Ys={class:"column is-12"},Ks=Il((()=>p("h1",null,"Pending for checks",-1))),Zs={class:"column is-12"},Qs={key:2,class:"modal-form columns is-multiline cu-all-input mt-6"},Xs={class:"field column is-12 mb-0",id:"rota-celender-two"},eo={class:"columns is-multiline mb-3 cu-all-input"},ao={class:"column is-12"},lo={class:"field columns is-multiline mb-0 cu-all-input space-between lengthy-smart-search-dropdown"},to={class:"field column is-12 mb-0 is-relative"},so={class:"mb-2 columns is-multiline"},oo={class:"field column is-6 mb-0"},io={key:0,class:"is-md-bold mb-2"},no={key:1,class:"is-md-bold mb-2"},ro={class:"mb-2 columns is-multiline"},co={class:"column is-6 is-flex"},uo={class:"info ml-3"},mo={class:"is-md-bold"},po={class:"is-bold cu-align-center"},fo=Il((()=>p("i",{class:"iconify mr-1","data-icon":"feather:mail","aria-hidden":"true"},null,-1))),vo={class:"is-bold cu-align-center"},go=Il((()=>p("i",{class:"lnil lnil-map-marker mr-1","aria-hidden":"true"},null,-1))),yo={class:"column is-3"},ho=Il((()=>p("h1",null,"Profile Completion",-1))),bo={class:"is-bold"},_o={style:{color:"var(--primary)"}},Io={class:"is-bold"},ko={class:"column is-3"},wo=Il((()=>p("h1",null,"Anomalies",-1))),xo={class:"is-bold"},So={class:"is-bold"},Co={class:"is-bold"},jo={key:3,class:"modal-form columns is-multiline cu-all-input mt-0"},Ao={class:"field column is-12 mb-0",id:"rota-celender-two"},Vo={class:"columns is-multiline mb-3 cu-all-input"},Mo={class:"column is-12 mt-5"},To={class:"column is-12"},No={key:0},Wo={key:1},Ro={key:4,class:"modal-form columns is-multiline cu-all-input mt-5"},Do={class:"field column is-12 mb-0",id:"rota-celender-two"},Po={class:"columns is-multiline mb-3 cu-all-input"},Lo={class:"column is-12"},Uo={class:"field columns is-multiline mb-0 cu-all-input"},$o={class:"field column is-5 mb-0 is-relative"},Oo={class:"mb-2 columns is-multiline"},zo={class:"field column is-6 mb-0"},Jo=Il((()=>p("h1",{class:"is-md-bold mb-2"}," Please verify wether the following steps have been successfully executed. ",-1))),Eo={class:"field column is-3 mb-0"},Fo=Il((()=>p("div",{class:"field column is-12 mb-0 is-relative"},null,-1))),Go=o({__name:"JobsForms",setup(l){const t=A(),o=ie(),I=M(),k=i(0),w=J(),V=i(!1),R=z(),D=O(),U=i(!1),$=i(!1);i(0);const F=i(!1),G=i("site"),H=i("rotaView"),B=i(""),Y=i(""),K=i(""),Z=i("");let Q=i([]),X=i([]),ee=i([]);const ae=i([]),le=i([]),te=i([]),ne=i([]),re=i([]),ce=i({}),de=i({}),ue=i(""),me=i([0]),pe=i(""),fe=i(!1),ve=i(!1),ge=i(!1),ye=i(!1),he=i(["created","waitingRAMS","readyToStart","started","completed"]),be=e=>he.value.indexOf(e)<=he.value.indexOf(_e.value.state);i({name:"",address:"",postcode:"",latitude:0,longitude:0,city:"",inchargeName:"",inchargePhoneNo:"",inchargeEmail:"",comments:"",geofence:{},color:"",contract:0});const _e=i({id:1,managerInfo:{company:0,email:"",first_name:"",id:0,last_name:"",partner:null,phoneNo:"",profileImage:"",role:""},assignedWorkers:[{id:0,firstName:"",lastName:"",latitude:0,longitude:0,postCode:"",phoneNumber:"",emailAddress:"",profileImageURL:"",profileStat:{percentage:5.9,emptyFields:[{doc:"",status:!1,is_uploaded:!1}],anomalieStats:{expired:0,required_not_uploaded:0,optional_not_uploaded:0}},readyToGo:!1}],siteInfo:{id:0,name:"",address:"",postcode:"",latitude:0,longitude:0,city:"",inchargeName:"",inchargePhoneNo:"",inchargeEmail:null,comments:null,geofence:[{lat:0,lng:0}],created_at:"2024-05-03T11:39:57.787398Z",updated_at:"2024-05-03T11:39:57.968769Z",color:"#D875C7",regionFormat:"Convenience Central",areaManager:"Mark Pannell ",managingDirector:"Kevin Tindall ",contract:60,contractInfo:{id:0,name:" ",company:0,customer_company:0,incharge_name:"",color:"",charge_rate:0,cuCompanyInfo:{id:0,name:"",email:"",logo:"",phone_number:""}}},workersList:[],title:"",description:"",externalId:"",isWorkWithContractor:!0,status:"",createdAt:"",updatedAt:"",manager:null,workers:[],state:"",file:""}),Ie=T({series:[0],chart:{height:240,type:"radialBar",toolbar:{show:!1}},colors:[o.success],plotOptions:{radialBar:{hollow:{size:"40%"},dataLabels:{show:!0,name:{show:!0,fontSize:"16px",fontWeight:500,offsetY:-10,color:o.success},value:{show:!0,fontWeight:600,color:o.success,fontSize:"16px",offsetY:-10}}}},labels:[""]}),ke=async()=>{try{V.value=!0;const e=await D.get(`/v3/api/vixen-job/${I.params.id}/`);_e.value=e.data,pe.value=e.data.state,V.value=!1}catch(e){console.log(e)}},we=e=>{G.value=e},xe=e=>{const a=new Date(e),l=new Intl.DateTimeFormat("en-US",{weekday:"long",day:"2-digit",month:"long"});_e.value.title=`Job at ${l.format(a)}`},Se=async()=>{try{if(V.value=!0,Y.value){await D.patch(`/v3/api/vixen-job/${I.params.id}/`,{site:Y.value});R.success("Site assigned to job")}else R.error("Please select a site first");V.value=!1}catch(e){console.log(e)}},Ce=async()=>{try{const e=await D.get(`/v3/api/vixen-job/${I.params.id}/assigned-workers/`);_e.value.assignedWorkers=e.data,re.value=e.data}catch(e){console.log(e)}},je=async()=>{try{await D.patch(`/v3/api/vixen-job/${I.params.id}/`,{state:"completed"});R.success("Job mark as completed successfully"),t.push("/sidebar/company/jobs")}catch(e){console.log(e)}};return n(Y,((e,a)=>{(async e=>{try{const a=await D.get(`/v3/api/site/${e}/detail/`);_e.value.siteInfo=a.data,console.log("current selected site",a.data)}catch(a){console.log(a)}})(e)})),n(Z,((e,a)=>{_e.value.manager=e})),n(Y,((e,a)=>{$.value=!1;const l=ae.value.find((a=>a.id==e));l&&(ce.value=l,console.log("current sellected site",ce.value),$.value=!0)})),n(K,((e,a)=>{$.value=!1,(async e=>{try{await D.post(`/v3/api/vixen-job/${I.params.id}/assign/${e}/`),R.success("worker assigned"),Ce()}catch(a){console.log(a)}})(e);const l=te.value.find((a=>a.id==e));l&&(ne.value.push(l),de.value=l,console.log("current sellected worker",de.value),$.value=!0)})),n([fe,ve,ge,ye],(([e,a,l,t])=>{let s=0;e&&s++,a&&s++,l&&s++,t&&s++,me.value=25*s})),r((()=>{ke(),(async()=>{try{const e=await D.get(`/v3/api/worker/${w.loggedCompany.id}/worker-short-info/`);te.value=e.data,le.value=e.data.map((e=>({value:e.id.toString(),name:`${e.firstName} ${e.lastName}`,icon:e.profileImageURL})))}catch{R.error("Invalid data")}finally{V.value=!1}})(),(async()=>{try{const e=await D.get(`/v3/api/account/user/company-managers/${w.loggedCompany.id}/`,{});Q.value=e.data.map((e=>({value:e.id.toString(),name:`${e.first_name} ${e.last_name}`,icon:e.profileImage,email:e.email}))),e.data&&(Z.value=e.data[0].id)}catch{R.error("Invalid data")}finally{V.value=!1}})(),(()=>{let e=new Date,a=e.getFullYear(),l=String(e.getMonth()+1).padStart(2,"0"),t=String(e.getDate()).padStart(2,"0");xe(`${a}-${l}-${t}`)})(),(async()=>{try{const e=await D.get(`/v3/api/contract/company/${w.loggedCompany.id}/`,{});X.value=e.data.map((e=>({value:e.id.toString(),name:e.name}))),e.data?B.value=e.data[0].id:B.value=""}catch(e){console.log(e)}})(),(async()=>{try{V.value=!0;const e=await D.get(`/v3/api/site/option/${w.loggedCompany.id}/`);ee.value=e.data.map((e=>({value:e.id.toString(),name:`${e.name}`,postcode:e.postcode,incharge:e.inchargeName}))),e.data&&(ae.value=e.data),V.value=!1}catch(e){console.log(e)}})(),Ce()})),(l,o)=>{const i=b,n=_,r=q,w=c("Multiselect"),A=L,M=P,T=e,$=se,O=s,z=_l,J=ha,B=E,Z=Oe,Q=a;return d(),x("div",null,[p("div",kl,[p("div",wl,[f(n,null,{default:m((()=>[f(i,{light:"",style:{"background-color":"transparent",padding:"5px",margin:"2px"},onClick:o[0]||(o[0]=()=>{pe.value="created"}),class:N([be("created")?"parentActiveState":"","created"===g(pe)?"parentActiveTab":""])},{default:m((()=>[xl,v(" Created "),Sl])),_:1},8,["class"]),f(i,{light:"",style:{"background-color":"transparent",padding:"5px",margin:"2px"},onClick:o[1]||(o[1]=()=>{pe.value="waitingRAMS"}),class:N([be("waitingRAMS")?"parentActiveState":"","waitingRAMS"===g(pe)?"parentActiveTab":""])},{default:m((()=>[Cl,v(" Pending for Checks "),jl])),_:1},8,["class"]),f(i,{light:"",style:{"background-color":"transparent",padding:"5px",margin:"2px"},onClick:o[2]||(o[2]=()=>{pe.value="readyToStart"}),class:N([be("readyToStart")?"parentActiveState":"","readyToStart"===g(pe)?"parentActiveTab":""])},{default:m((()=>[Al,v(" Ready to start "),Vl])),_:1},8,["class"]),f(i,{light:"",style:{"background-color":"transparent",padding:"5px",margin:"2px"},onClick:o[3]||(o[3]=()=>{pe.value="started"}),class:N([be("started")?"parentActiveState":"","started"===g(pe)?"parentActiveTab":""])},{default:m((()=>[Ml,v(" In Progress "),Tl])),_:1},8,["class"]),f(i,{light:"",style:{"background-color":"transparent",padding:"5px",margin:"2px"},onClick:o[4]||(o[4]=()=>{pe.value="completed"}),class:N([be("completed")?"parentActiveState":"","completed"===g(pe)?"parentActiveTab":""])},{default:m((()=>[Nl,v(" Completed "),Wl])),_:1},8,["class"])])),_:1})]),p("div",Rl,[p("div",Dl,[p("div",Pl,[p("p",Ll,h(g(_e).title?g(_e).title:"-----"),1),p("div",Ul,[p("p",$l,[v(" Id: "),p("span",Ol,h(g(_e).externalId?g(_e).externalId:"-----"),1)]),p("p",zl,[v(" Workers: "),p("span",Jl,h(g(_e).workers?g(_e).workers.length:"0"),1)])]),p("div",El,[p("p",Fl,[v(" Type: "),p("span",Gl,h(g(_e).isWorkWithContractor?"Work with contractor":"Self Serve"),1)]),p("p",Hl,[v(" Created At: "),p("span",ql,h(g(_e).createdAt?g(_e).createdAt.slice(0,10):"-----"),1)])])])])]),p("div",Bl,[Yl,p("div",Kl,[f(r,{picture:g(_e).managerInfo&&g(_e).managerInfo.profileImage?g(_e).managerInfo.profileImage:"",size:"medium",squared:""},null,8,["picture"]),p("div",Zl,[p("p",Ql,h(g(_e).managerInfo&&g(_e).managerInfo.first_name?g(_e).managerInfo.first_name:"------")+" "+h(g(_e).managerInfo&&g(_e).managerInfo.last_name?g(_e).managerInfo.last_name:""),1),p("p",Xl,h(g(_e).managerInfo&&g(_e).managerInfo.email?g(_e).managerInfo.email:"------"),1)])])])]),"created"==g(pe)?(d(),x("div",et,[p("div",at,[p("div",lt,[p("div",tt,[p("div",st,[p("div",ot,[p("i",{onClick:o[5]||(o[5]=e=>{return a=g(_e).id,k.value=a,void(U.value=!0);var a}),class:"fas fa-pen cu-pointer","aria-hidden":"true",style:{position:"absolute",right:"14px",top:"10px"}}),p("div",it,[p("div",nt,[g(_e).siteInfo&&g(_e).siteInfo.contractInfo&&g(_e).siteInfo.contractInfo.cuCompanyInfo&&!g(V)?(d(),x("img",{key:0,class:"small-img",src:g(_e).siteInfo.contractInfo.cuCompanyInfo&&g(_e).siteInfo.contractInfo.cuCompanyInfo.logo?g(_e).siteInfo.contractInfo.cuCompanyInfo.logo:"",size:"medium"},null,8,rt)):S("",!0)]),p("div",ct,[g(_e).siteInfo&&g(_e).siteInfo.contractInfo&&g(_e).siteInfo.contractInfo.cuCompanyInfo&&!g(V)?(d(),x("h1",dt,h(g(_e).siteInfo.contractInfo.cuCompanyInfo&&g(_e).siteInfo.contractInfo.cuCompanyInfo.name?g(_e).siteInfo.contractInfo.cuCompanyInfo.name:"Not added yet"),1)):S("",!0),g(_e).siteInfo&&g(_e).siteInfo.contractInfo&&g(_e).siteInfo.contractInfo.cuCompanyInfo&&!g(V)?(d(),x("p",ut,h(g(_e).siteInfo.contractInfo.cuCompanyInfo&&g(_e).siteInfo.contractInfo.cuCompanyInfo.email?g(_e).siteInfo.contractInfo.cuCompanyInfo.email:"------"),1)):S("",!0)]),p("div",mt,[pt,p("p",ft,h(g(_e)&&g(_e).title?g(_e).title:"0"),1)]),p("div",vt,[gt,p("p",yt,h(g(_e).externalId&&g(_e).externalId?g(_e).externalId:"-----"),1)]),p("div",ht,[bt,p("p",_t,h(g(_e).isWorkWithContractor&&g(_e).isWorkWithContractor?"Work with contractor":" Self Serve"),1)]),p("div",It,[kt,p("p",wt,h(g(_e).createdAt&&g(_e).createdAt?g(_e).createdAt.slice(0,10):"0"),1)]),p("div",xt,[St,p("p",Ct,h(g(_e).managerInfo&&g(_e).managerInfo.first_name?g(_e).managerInfo.first_name:"--- --- "),1)]),p("div",jt,[At,p("p",Vt,h(g(_e).description&&g(_e).description?g(_e).description:"-----"),1)])])])])])])])])):S("",!0),"waitingRAMS"==g(pe)?(d(),x("div",Mt,[p("div",Tt,[p("div",Nt,[p("div",Wt,[f(n,null,{default:m((()=>[f(i,{rounded:"",onClick:o[6]||(o[6]=e=>we("waitingRAMS")),color:"waitingRAMS"===g(G)?"primary":""},{default:m((()=>[v("1 - Manage RAMS ")])),_:1},8,["color"]),f(i,{rounded:"",onClick:o[7]||(o[7]=e=>we("site")),color:"site"===g(G)?"primary":""},{default:m((()=>[v("2 - Job Site (optional) ")])),_:1},8,["color"]),f(i,{rounded:"",onClick:o[8]||(o[8]=e=>we("worker")),color:"worker"===g(G)?"primary":""},{default:m((()=>[v("3 - Allocate Worker (optional) ")])),_:1},8,["color"])])),_:1})]),"site"==g(G)?(d(),x("div",Rt,[p("div",Dt,[p("div",Pt,[p("label",null,"Select Site ("+h(g(ee).length>10?g(ee).length:"0"+g(ee).length)+")*",1),f(M,null,{default:m((({id:e})=>[f(A,{class:"placement-wrapper"},{default:m((()=>[f(w,{class:"multi-select lg-multiselect",modelValue:g(Y),"onUpdate:modelValue":o[9]||(o[9]=e=>y(Y)?Y.value=e:null),attrs:{id:e},placeholder:"Select site",label:"name",options:g(ee),searchable:!0,"track-by":"name",height:300},{singlelabel:m((({value:e})=>[p("div",Lt,h(e.name),1)])),option:m((({option:e})=>[p("div",Ut,[p("div",$t,[p("span",Ot,"ID: 00"+h(e.value),1),p("span",zt,h(e.name),1),p("div",Jt,[p("span",Et,"Post Code: "+h(e.postcode?e.postcode:" ---"),1),v(" | "),p("span",Ft,"Incharge: "+h(e.incharge),1)])]),Gt])])),_:2},1032,["modelValue","attrs","options"])])),_:2},1024)])),_:1}),p("div",Ht,[f(i,{onClick:Se,elevated:"",color:"warning"},{default:m((()=>[v(" Assign Site ")])),_:1}),qt,f(i,{onClick:o[10]||(o[10]=()=>{F.value=!g(F)}),elevated:"",color:"warning"},{default:m((()=>[v(" Create new Site ")])),_:1})])]),p("div",Bt,[p("div",Yt,[p("div",Kt,[g(_e).siteInfo&&g(_e).siteInfo.contractInfo&&g(_e).siteInfo.contractInfo.cuCompanyInfo&&!g(V)?(d(),x("img",{key:0,class:"small-img",src:g(_e).siteInfo.contractInfo.cuCompanyInfo&&g(_e).siteInfo.contractInfo.cuCompanyInfo.logo?g(_e).siteInfo.contractInfo.cuCompanyInfo.logo:"",size:"medium"},null,8,Zt)):S("",!0)]),p("div",Qt,[g(_e).siteInfo&&g(_e).siteInfo.contractInfo&&g(_e).siteInfo.contractInfo.cuCompanyInfo&&!g(V)?(d(),x("h1",Xt,h(g(_e).siteInfo.contractInfo.cuCompanyInfo&&g(_e).siteInfo.contractInfo.cuCompanyInfo.name?g(_e).siteInfo.contractInfo.cuCompanyInfo.name:"Not added yet"),1)):S("",!0),g(_e).siteInfo&&g(_e).siteInfo.contractInfo&&g(_e).siteInfo.contractInfo.cuCompanyInfo&&!g(V)?(d(),x("p",es,h(g(_e).siteInfo.contractInfo.cuCompanyInfo&&g(_e).siteInfo.contractInfo.cuCompanyInfo.email?g(_e).siteInfo.contractInfo.cuCompanyInfo.email:"------"),1)):S("",!0)]),p("div",as,[ls,p("p",ts," 00"+h(g(_e).siteInfo&&g(_e).siteInfo.id?g(_e).siteInfo.id:"0"),1)]),p("div",ss,[os,p("p",is,h(g(_e).siteInfo&&g(_e).siteInfo.name?g(_e).siteInfo.name:"0"),1)]),p("div",ns,[rs,p("p",cs,h(g(_e).siteInfo&&g(_e).siteInfo.postcode?g(_e).siteInfo.postcode:"--- --- "),1)]),p("div",ds,[us,p("p",ms,h(g(_e).siteInfo&&g(_e).siteInfo.address?g(_e).siteInfo.address:"-----"),1)]),p("div",ps,[fs,p("p",vs,h(g(_e).siteInfo&&g(_e).siteInfo.inchargeName?g(_e).siteInfo.inchargeName:"--- --- "),1)]),p("div",gs,[ys,p("p",hs,h(g(_e).siteInfo&&g(_e).siteInfo.inchargeEmail?g(_e).siteInfo.inchargeEmail:"-----"),1)])]),g(V)?S("",!0):(d(),u(T,{key:0,style:{width:"90%",height:"220px"},siteData:g(_e).siteInfo?g(_e).siteInfo:g(_e)},null,8,["siteData"]))])])])):S("",!0),"worker"==g(G)?(d(),x("div",bs,[p("div",_s,[p("div",Is,[p("label",null,"Select Worker ("+h(g(le).length>10?g(le).length:"0"+g(le).length)+")*",1),f(M,null,{default:m((({id:e})=>[f(A,{class:"placement-wrapper"},{default:m((()=>[f(w,{class:"multi-select lg-multiselect",modelValue:g(K),"onUpdate:modelValue":o[11]||(o[11]=e=>y(K)?K.value=e:null),attrs:{id:e},placeholder:"Select site",label:"name",options:g(le),searchable:!0,"track-by":"name"},{singlelabel:m((({value:e})=>[p("div",ks,[p("img",{class:"select-label-icon mr-2 value-image",src:e.icon,alt:""},null,8,ws),v(" "+h(e.name),1)])])),option:m((({option:e})=>[p("img",{class:"select-label-icon mr-2 value-image",src:e.icon,alt:""},null,8,xs),v(" "+h(e.name),1)])),_:2},1032,["modelValue","attrs","options"])])),_:2},1024)])),_:1})]),p("div",Ss,[g(_e).assignedWorkers.length?(d(),x("h1",Cs," Assigned Workers ("+h(g(_e).assignedWorkers.length)+") ",1)):(d(),x("h1",js," No Assigned Worker Assigned yet ")),(d(!0),x(C,null,j(g(_e).assignedWorkers,(e=>(d(),x("div",{key:e.id,class:"card px-4 py-3 mb-2 rounded"},[f($,{onClick:a=>(async e=>{try{await D.delete(`/v3/api/vixen-job/${I.params.id}/remove/${e}/`),R.error("Worker removed from the site"),Ce()}catch(a){console.log(a)}})(e.id),color:"danger",light:"",raised:"",circle:"",icon:"feather:x",style:{position:"absolute","font-size":"22px",right:"10px",top:"10px",cursor:"pointer",padding:"0",width:"22px",height:"22px"}},null,8,["onClick"]),p("div",As,[p("div",{class:"column is-6 is-flex cu-pointer",onClick:a=>{return l=e.id,void t.push({name:"/sidebar/company/workers/[id]",params:{id:l}});var l}},[f(r,{picture:e.profileImageURL?e.profileImageURL:"/demo/avatars/11.jpg",size:"large"},null,8,["picture"]),p("div",Ms,[p("p",Ts,h(e.firstName?e.firstName:"---")+" "+h(e.lastName?e.lastName:"---"),1),p("p",Ns,[Ws,v(" "+h(e.emailAddress?e.emailAddress:"--- --- "),1)]),p("p",Rs,[Ds,v(" "+h(e.postCode?e.postCode:"--- --- "),1)])])],8,Vs),p("div",Ps,[Ls,p("p",Us,[p("span",$s,h(e.profileStat&&e.profileStat.percentage?e.profileStat.percentage:"0")+"%",1),v(" Complete ")]),p("p",Os,[p("span",{style:W({color:e.readyToGo?"var(--primary)":"var(--danger)"})},h(1==e.readyToGo?"Ready to go":"Not Ready"),5)])]),p("div",zs,[Js,p("p",Es," Mandatory : - "+h(e.profileStat.anomalieStats?e.profileStat.anomalieStats.required_not_uploaded:"0"),1),p("p",Fs," Optional : - "+h(e.profileStat.anomalieStats?e.profileStat.anomalieStats.optional_not_uploaded:"0"),1),p("p",Gs," Expired : - "+h(e.profileStat.anomalieStats?e.profileStat.anomalieStats.expired:"0"),1)])])])))),128))])])])):S("",!0),"waitingRAMS"==g(G)?(d(),x("div",Hs,[p("div",qs,[p("div",Bs,[p("div",Ys,[Ks,p("div",Zs,[f(M,null,{default:m((()=>[f(A,null,{default:m((()=>[f(O,{modelValue:g(ue),"onUpdate:modelValue":o[12]||(o[12]=e=>y(ue)?ue.value=e:null),rows:"4",placeholder:"Enter note..."},null,8,["modelValue"])])),_:1})])),_:1})])])])])])):S("",!0)])])])):S("",!0),"readyToStart"==g(pe)?(d(),x("div",Qs,[p("div",Xs,[p("div",eo,[p("div",ao,[p("div",lo,[p("div",to,[p("div",so,[p("div",oo,[g(re).length?(d(),x("h1",io,h(g(re).length)+" - Workers are assigned and ready to start the job. ",1)):(d(),x("h1",no," No Assigned Worker Assigned yet ")),(d(!0),x(C,null,j(g(re),(e=>(d(),x("div",{key:e.id,class:"card px-4 py-3 mb-2 rounded"},[p("div",ro,[p("div",co,[f(r,{picture:e.profileImageURL?e.profileImageURL:"/demo/avatars/11.jpg",size:"large"},null,8,["picture"]),p("div",uo,[p("p",mo,h(e.firstName?e.firstName:"---")+" "+h(e.lastName?e.lastName:"---"),1),p("p",po,[fo,v(" "+h(e.emailAddress?e.emailAddress:"--- --- "),1)]),p("p",vo,[go,v(" "+h(e.postCode?e.postCode:"--- --- "),1)])])]),p("div",yo,[ho,p("p",bo,[p("span",_o,h(e.profileStat.percentage)+"%",1),v(" Complete ")]),p("p",Io,[p("span",{style:W({color:e.readyToGo?"var(--primary)":"var(--danger)"})},h(e.readyToGo?"Ready to go":"Not Ready"),5)])]),p("div",ko,[wo,p("p",xo," Mandatory : - "+h(e.profileStat.anomalieStats?e.profileStat.anomalieStats.required_not_uploaded:"0"),1),p("p",So," Optional : - "+h(e.profileStat.anomalieStats?e.profileStat.anomalieStats.optional_not_uploaded:"0"),1),p("p",Co," Expired : - "+h(e.profileStat.anomalieStats?e.profileStat.anomalieStats.expired:"0"),1)])])])))),128))])])])])])])])])):S("",!0),"started"==g(pe)?(d(),x("div",jo,[p("div",Ao,[p("div",Vo,[p("div",Mo,[f(n,null,{default:m((()=>[f(i,{rounded:"",onClick:o[13]||(o[13]=()=>{H.value="rotaView"}),color:"rotaView"===g(H)?"primary":""},{default:m((()=>[v("Schedule ")])),_:1},8,["color"]),f(i,{rounded:"",onClick:o[14]||(o[14]=()=>{H.value="timesheet"}),color:"timesheet"===g(H)?"primary":""},{default:m((()=>[v("Site visit logs ")])),_:1},8,["color"])])),_:1})]),p("div",To,["rotaView"==g(H)?(d(),x("div",No,[f(z,{id:g(I).params.id},null,8,["id"])])):S("",!0),"timesheet"==g(H)?(d(),x("div",Wo,[f(J,{id:g(I).params.id},null,8,["id"])])):S("",!0)])])])])):S("",!0),"completed"==g(pe)?(d(),x("div",Ro,[p("div",Do,[p("div",Po,[p("div",Lo,[p("div",Uo,[p("div",$o,[p("div",Oo,[p("div",zo,[Jo,f(M,null,{default:m((()=>[f(A,{raw:"",subcontrol:""},{default:m((()=>[f(B,{modelValue:g(ge),"onUpdate:modelValue":o[15]||(o[15]=e=>y(ge)?ge.value=e:null),label:"PM assigned ?",color:"info"},null,8,["modelValue"])])),_:1}),f(A,{raw:"",subcontrol:""},{default:m((()=>[f(B,{modelValue:g(ve),"onUpdate:modelValue":o[16]||(o[16]=e=>y(ve)?ve.value=e:null),label:"Checks completed (RAMS/CPP) ?",color:"primary"},null,8,["modelValue"])])),_:1}),f(A,{raw:"",subcontrol:""},{default:m((()=>[f(B,{modelValue:g(ye),"onUpdate:modelValue":o[17]||(o[17]=e=>y(ye)?ye.value=e:null),label:"Workers compliance checked ?",color:"success"},null,8,["modelValue"])])),_:1}),f(A,{raw:"",subcontrol:""},{default:m((()=>[f(B,{modelValue:g(fe),"onUpdate:modelValue":o[18]||(o[18]=e=>y(fe)?fe.value=e:null),color:"info",label:"Job completed successfully ?"},null,8,["modelValue"])])),_:1})])),_:1}),f(i,{onClick:je,style:{float:"right"},elevated:"",color:"warning"},{default:m((()=>[v("Complete Job")])),_:1})])])]),p("div",Eo,[f(g(oe),{id:"radial-circle",class:"circle-chart-wrapper",height:g(Ie).chart.height,type:g(Ie).chart.type,series:[g(me)],options:g(Ie)},null,8,["height","type","series","options"])]),Fo])])])])])):S("",!0),g(U)?(d(),u(Z,{key:5,jobId:g(k),AddJobModalOpen:g(U),"onUpdate:modalHandler":o[19]||(o[19]=e=>U.value=!1),"onUpdate:onSuccess":ke},null,8,["jobId","AddJobModalOpen"])):S("",!0),g(F)?(d(),u(Q,{key:6,contractId:g(_e).siteInfo.contract,"onUpdate:modalHandler":o[20]||(o[20]=()=>{F.value=!g(F)}),AddSiteModalOpen:g(F),"onUpdate:OnSuccess":ke},null,8,["contractId","AddSiteModalOpen"])):S("",!0)])}}}),Ho=w(Go,[["__scopeId","data-v-fb16d804"]]),qo=o({__name:"[id]",setup:e=>(ne().setPageTitle("Job Info"),R({title:"Jobs - Arez"}),(e,a)=>{const l=Ho;return d(),x("div",null,[f(l)])})});export{qo as default};
