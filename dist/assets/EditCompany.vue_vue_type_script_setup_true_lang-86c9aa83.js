import{_ as e}from"./VModal.vue_vue_type_style_index_0_lang-c64f2af6.js";import{e as a,r as l,o as s,B as n,N as o,F as t,D as i,K as u,l as r,W as d,E as m,C as p,M as c,G as y,I as g,j as v,J as b,O as f}from"./index-b2cddf6b.js";import{_ as C}from"./V-Snack.vue_vue_type_style_index_0_lang-ef20910d.js";import{_ as h}from"./VField.vue_vue_type_script_setup_true_lang-56a507fe.js";import{_}from"./VAvatar.vue_vue_type_style_index_0_lang-a2584e4d.js";import{_ as N}from"./VIconButton-68f5ed68.js";import{u as U}from"./useAPI-f754fb36.js";import{u as A}from"./useNotyf-80ed00ef.js";import{m as R}from"./upload-3-2f295b3e.js";import{u as V}from"./company-ede31c97.js";const S={class:"modal-form columns cu-all-input cus-scrollbary is-multiline"},x={class:"field column is-6 mb-0"},E=i("label",null,"Company Name: *",-1),L={class:"control"},j={class:"field column is-6 mb-0"},B=i("label",null,"Site URL: ",-1),w={class:"control"},P={class:"field column is-6 mb-0"},k=i("label",null,"Business Address: ",-1),O={class:"control"},M={class:"field column is-6 mb-0"},I=i("label",null,"Post Code: ",-1),F={class:"control"},K={class:"field column is-6 mb-0"},q=i("label",null,"Country: ",-1),z={class:"control"},D={class:"field column is-6 mb-0"},T=i("label",null,"State: ",-1),W={class:"control"},Y={class:"field column is-6 mb-0"},$=i("label",null,"Year Business Started: ",-1),G={class:"control"},J={class:"field column is-6 mb-0"},H=i("label",null,"Company Phone Number: ",-1),Q={class:"control"},X={class:"field column is-6 mb-0"},Z=i("label",null,"Company Email Address: ",-1),ee={class:"control"},ae={class:"field column is-6 mb-0"},le=i("label",null,"Company Registration Number: ",-1),se={class:"control"},ne={class:"field column is-6 mb-0"},oe=i("label",null,"Company Registered Name: ",-1),te={class:"control"},ie={class:"column is-12"},ue={class:"columns mb-0"},re=i("label",null,"Company Logo:",-1),de={class:"control"},me=["src"],pe={key:1},ce=i("i",{class:"iconify","data-icon":"feather:plus"},null,-1),ye=["src"],ge=a({__name:"EditCompany",props:{EditCompanyModalOpen:{type:Boolean,default:!1},id:{type:Number,default:0}},emits:["update:handleUpdateEditCompanyModalOpen","update:getAllCompanies"],setup(a,{emit:ge}){const ve=a,be=V(),fe=l(!1),Ce=l(!1),he=l(""),_e=A(),Ne=U(),Ue=l([]),Ae=l(!1),Re=l(!1),Ve=l("update"),Se=l([]),xe=l({companyName:"",industry:"",siteURL:"",businessAddress:"",postCode:"",country:"",state:"",yearBusinessStarted:"",companyPhoneNumber:"",billingAddress:"",companyEmailAddress:"",companyRegistrationNumber:"",companyRegisteredName:"",billingPhoneNumber:"",BillingEmailAddress:"",dailyEmailLimit:0,dailySMSLimit:0,noOfLicence:0,noOfWorkers:0,favIcon:"",compnayLogo:null}),Ee=l({}),Le=async()=>{try{Ae.value=!0;const e=new window.FormData;for(const a in Ee.value)e.append(a,Ee.value[a]);await Ne.patch(`/v3/api/company/${ve.id}/`,e);Be(),_e.dismissAll(),Ae.value=!1,_e.success("Company updated, Company"),ge("update:getAllCompanies",null)}catch(e){let a=e.response.data??{};Object.values(a).forEach((e=>{e.forEach((e=>{console.log(e),_e.error(` ${e}, New Company`)}))}))}},je=e=>{if("industry"==e)return console.log("insustry tpe",xe.value.industry.id),void(Ee.value={...Ee.value,industry:xe.value.industry.id});Ee.value={...Ee.value,[e.target.name]:e.target.value}},Be=()=>{ge("update:handleUpdateEditCompanyModalOpen",!1),xe.value={companyName:"",industry:"",siteURL:"",businessAddress:"",postCode:"",country:"",state:"",yearBusinessStarted:"",companyPhoneNumber:"",billingAddress:"",companyEmailAddress:"",companyRegistrationNumber:"",companyRegisteredName:"",billingPhoneNumber:"",BillingEmailAddress:"",dailyEmailLimit:0,dailySMSLimit:0,noOfLicence:0,favIcon:"",compnayLogo:null}},we=()=>{fe.value=!fe.value},Pe=(e,a)=>{const l=Oe(e);Ee.value.favIcon=l,he.value=e},ke=e=>{const a=Oe(e);Ee.value.compnayLogo=a,xe.value.compnayLogo=e};function Oe(e){const a=e.split(","),l=a[0].indexOf("base64")>=0?atob(a[1]):decodeURI(a[1]),s=a[0].split(":")[1].split(";")[0],n=new Uint8Array(l.length);for(let o=0;o<l.length;o++)n[o]=l.charCodeAt(o);return new Blob([n],{type:s})}return s((()=>{(async()=>{try{const e=await Ne.get("/v3/api/industry/");Ue.value=e.data}catch(e){}})(),Se.value=be.loggedCompany.industry,xe.value=be.loggedCompany})),(a,l)=>{const s=N,U=_,A=h,V=C,ge=f,_e=e;return n(),o(_e,{is:"form",open:ve.EditCompanyModalOpen,title:"Edit Company",size:"big",actions:"right",onSubmit:g(Le,["prevent"]),onClose:Be,noclose:""},{content:t((()=>[i("div",S,[i("div",x,[E,i("div",L,[u(i("input",{type:"text",name:"companyName","onUpdate:modelValue":l[0]||(l[0]=e=>r(xe).companyName=e),onChange:l[1]||(l[1]=e=>je(e)),required:"",class:"input is-primary-focus is-primary-focus",placeholder:"Company Name"},null,544),[[d,r(xe).companyName]])])]),i("div",j,[B,i("div",w,[u(i("input",{type:"text",name:"siteURL","onUpdate:modelValue":l[2]||(l[2]=e=>r(xe).siteURL=e),onChange:l[3]||(l[3]=e=>je(e)),class:"input is-primary-focus",placeholder:"Site URL"},null,544),[[d,r(xe).siteURL]])])]),i("div",P,[k,i("div",O,[u(i("input",{name:"businessAddress","onUpdate:modelValue":l[4]||(l[4]=e=>r(xe).businessAddress=e),onChange:l[5]||(l[5]=e=>je(e)),class:"input is-primary-focus",placeholder:"Business Address"},null,544),[[d,r(xe).businessAddress]])])]),i("div",M,[I,i("div",F,[u(i("input",{type:"text",name:"postCode","onUpdate:modelValue":l[6]||(l[6]=e=>r(xe).postCode=e),onChange:l[7]||(l[7]=e=>je(e)),class:"input is-primary-focus",placeholder:"Post Code"},null,544),[[d,r(xe).postCode]])])]),i("div",K,[q,i("div",z,[u(i("input",{type:"text",name:"country","onUpdate:modelValue":l[8]||(l[8]=e=>r(xe).country=e),onChange:l[9]||(l[9]=e=>je(e)),class:"input is-primary-focus",placeholder:"Country"},null,544),[[d,r(xe).country]])])]),i("div",D,[T,i("div",W,[u(i("input",{type:"text",name:"state","onUpdate:modelValue":l[10]||(l[10]=e=>r(xe).state=e),onChange:l[11]||(l[11]=e=>je(e)),class:"input is-primary-focus",placeholder:"State"},null,544),[[d,r(xe).state]])])]),i("div",Y,[$,i("div",G,[u(i("input",{type:"text",name:"yearBusinessStarted","onUpdate:modelValue":l[12]||(l[12]=e=>r(xe).yearBusinessStarted=e),onChange:l[13]||(l[13]=e=>je(e)),class:"input is-primary-focus",placeholder:"Year Business Started"},null,544),[[d,r(xe).yearBusinessStarted]])])]),i("div",J,[H,i("div",Q,[u(i("input",{type:"tel",name:"companyPhoneNumber","onUpdate:modelValue":l[14]||(l[14]=e=>r(xe).companyPhoneNumber=e),onChange:l[15]||(l[15]=e=>je(e)),class:"input is-primary-focus",placeholder:"Company Phone Number"},null,544),[[d,r(xe).companyPhoneNumber]])])]),i("div",X,[Z,i("div",ee,[u(i("input",{type:"email",name:"companyEmailAddress","onUpdate:modelValue":l[16]||(l[16]=e=>r(xe).companyEmailAddress=e),onChange:l[17]||(l[17]=e=>je(e)),class:"input is-primary-focus",placeholder:"Company Email Address"},null,544),[[d,r(xe).companyEmailAddress]])])]),i("div",ae,[le,i("div",se,[u(i("input",{type:"text",name:"companyRegistrationNumber","onUpdate:modelValue":l[18]||(l[18]=e=>r(xe).companyRegistrationNumber=e),onChange:l[19]||(l[19]=e=>je(e)),class:"input is-primary-focus",placeholder:"Company Registration Number"},null,544),[[d,r(xe).companyRegistrationNumber]])])]),i("div",ne,[oe,i("div",te,[u(i("input",{type:"text",name:"companyRegisteredName","onUpdate:modelValue":l[20]||(l[20]=e=>r(xe).companyRegisteredName=e),onChange:l[21]||(l[21]=e=>je(e)),class:"input is-primary-focus",placeholder:"Company Registered Name"},null,544),[[d,r(xe).companyRegisteredName]])])]),i("div",ie,[i("div",ue,[m(A,{class:"column is-3"},{default:t((()=>[re,i("div",de,[m(U,{size:"xl",class:"profile-v-avatar mt-4"},{avatar:t((()=>[r(Re)?c("",!0):(n(),p("img",{key:0,class:"avatar",src:null==r(xe).compnayLogo?"/images/avatars/placeholder.jpg":r(xe).compnayLogo,alt:""},null,8,me)),"update"==r(Ve)?(n(),p("span",pe,[r(Re)?(n(),o(s,{key:1,style:{position:"absolute",top:"60%",right:"-3%"},icon:"feather:arrow-left",class:"edit-button is-back",circle:"",tabindex:"0",onKeydown:l[24]||(l[24]=y(g((e=>Re.value=!1),["prevent"]),["space"])),onClick:l[25]||(l[25]=e=>Re.value=!1)})):(n(),o(s,{key:0,style:{position:"absolute",top:"60%",right:"-3%"},icon:"feather:edit-2",class:"edit-button is-edit",circle:"",tabindex:"0",onKeydown:l[22]||(l[22]=y(g((e=>Re.value=!0),["prevent"]),["space"])),onClick:l[23]||(l[23]=()=>{Ce.value=!r(Ce)})}))])):c("",!0)])),_:1})])])),_:1}),m(r(R),{field:"img",onCropSuccess:ke,modelValue:r(Ce),"onUpdate:modelValue":l[26]||(l[26]=e=>v(Ce)?Ce.value=e:null),noRotate:!1,noSquare:!1,langType:"en","img-format":"png/jpg"},null,8,["modelValue"]),m(A,{class:"column is-3"},{default:t((()=>[m(V,{onClick:we,color:"primary",title:"Favicon",primary:"",icon:"fas fa-cloud-upload-alt"},{default:t((()=>[ce])),_:1}),m(r(R),{field:"img",onCropSuccess:Pe,modelValue:r(fe),"onUpdate:modelValue":l[27]||(l[27]=e=>v(fe)?fe.value=e:null),noRotate:!1,noSquare:!1,langType:"en","img-format":"png/jpg"},null,8,["modelValue"]),i("img",{src:r(he)?r(he):r(be).loggedCompany.favIcon,style:{width:"100px",height:"100px","border-radius":"50%",margin:"10px"}},null,8,ye)])),_:1})])])])])),action:t((()=>[m(ge,{type:"submit",loading:r(Ae),color:"primary",raised:""},{default:t((()=>[b("Update")])),_:1},8,["loading"])])),_:1},8,["open","onSubmit"])}}});export{ge as _};
