import{_ as e,c as l}from"./VFlexTable.vue_vue_type_style_index_0_lang-7ce2d246.js";import{e as a,v as t,x as s,r as o,Z as i,o as n,B as r,C as p,D as d,E as u,F as c,K as _,W as m,l as v,j as y,N as g,U as f,V as b,aR as x,M as k,T as h,J as w,O as C,z as j,H as P,G as T,I as V}from"./index-e7dfe9a4.js";import{_ as A}from"./VControl-481683c7.js";import{u as I}from"./useAPI-91510d39.js";import{u as S}from"./useNotyf-987b3464.js";import{_ as O,a as M,b as L}from"./ProposalViewModal.vue_vue_type_style_index_0_lang-863cb860.js";import{_ as U}from"./SweetAlert.vue_vue_type_style_index_0_lang-7ea203fc.js";import{b as D,c as $}from"./CreateProposalTasksModal-04d179f2.js";import{_ as E}from"./VFlexPagination.vue_vue_type_script_setup_true_lang-4bdf3f17.js";import{_ as H}from"./VPlaceholderPage.vue_vue_type_style_index_0_lang-5cede0f3.js";import{_ as F}from"./VDropdown.vue_vue_type_style_index_0_lang-dccc85ca.js";import{_ as N}from"./VTag.vue_vue_type_style_index_0_lang-b72e22d4.js";import{_ as W}from"./PlaceloadV1.vue_vue_type_style_index_0_lang-20d47390.js";import{_ as z,a as B}from"./search-4-dark-2b5b440c.js";import{e as K,g as R}from"./useSupportElement-6aaafdea.js";import{u as Y}from"./viewWrapper-ad348552.js";import"./VLabel.vue_vue_type_script_setup_true_lang-771cf1a5.js";import"./useVFieldContext-dbc06bde.js";import"./userSession-a8987e04.js";import"./notyf-79dfe734.js";import"./useThemeColors-a807ce5c.js";import"./VModal.vue_vue_type_style_index_0_lang-417ace5b.js";import"./VRadio.vue_vue_type_style_index_0_lang-0d806d2e.js";import"./VTextarea.vue_vue_type_script_setup_true_lang-35eabc19.js";import"./VField.vue_vue_type_script_setup_true_lang-687923b6.js";import"./costItems-f71f117e.js";import"./VInput.vue_vue_type_script_setup_true_lang-6ddab63d.js";import"./V-Snack.vue_vue_type_style_index_0_lang-974ba9c9.js";import"./VIcon.vue_vue_type_script_setup_true_lang-578186d3.js";import"./VCheckbox.vue_vue_type_style_index_0_lang-e74e77d7.js";import"./VAvatar.vue_vue_type_style_index_0_lang-0dd05b73.js";import"./VOption.vue_vue_type_style_index_0_lang-ecc7ba73.js";import"./VIconButton-693920a7.js";import"./VFlex.vue_vue_type_style_index_0_lang-2867fe65.js";import"./useDropdown-9b86a7ec.js";import"./VPlaceloadWrap-a87a6fa1.js";import"./VPlaceloadText.vue_vue_type_style_index_0_lang-62eb0f91.js";import"./VPlaceloadAvatar.vue_vue_type_style_index_0_lang-6557bf95.js";const J={class:"is-flex",style:{"justify-content":"end"}},G={class:"item-name dark-inverted"},Q={class:"light-text"},Z={class:"light-text"},q={class:"light-text"},X=a({__name:"CataLogList",setup(a){t(),s();const j=I();S();const P=o(""),T=o([]);o([]);const V=[{label:"Title",key:"title"},{label:"Unit",key:"unit"},{label:"Total Price",key:"total_price"},{label:"Cost Type",key:"cost_type"},{label:"Actions",key:"actions"}],O=i((()=>T.value.filter((e=>e.title.toLowerCase().includes(P.value.toLowerCase())))));return n((async()=>{try{const e=await j.get("/api/cost/catalogs/");T.value=e.data}catch(e){console.error("Error fetching catalogs:",e)}})),(a,t)=>{const s=A,o=l,i=C,n=e;return r(),p(f,null,[d("div",J,[u(s,{icon:"feather:search"},{default:c((()=>[_(d("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>y(P)?P.value=e:null),class:"input custom-text-filter",placeholder:"Search..."},null,512),[[m,v(P)]])])),_:1})]),v(O).length>0?(r(),g(n,{key:0,class:"mt-5",data:v(O),columns:V,rounded:""},{body:c((()=>[u(x,{name:"list",tag:"div",class:"flex-list-inner"},{default:c((()=>[(r(!0),p(f,null,b(v(O),(e=>(r(),p("div",{key:e.id,class:"flex-table-item"},[u(o,{column:{media:!0,grow:!1},class:"cu-pointer"},{default:c((()=>[d("div",null,[d("span",G,h(e.title),1)])])),_:2},1024),u(o,null,{default:c((()=>[d("span",Q,h(e.unit),1)])),_:2},1024),u(o,null,{default:c((()=>[d("span",Z,h(e.total_price),1)])),_:2},1024),u(o,null,{default:c((()=>[d("span",q,h(e.cost_type),1)])),_:2},1024),u(o,null,{default:c((()=>[u(i,{color:"danger",size:"small",onClick:l=>(async e=>{try{await j.delete(`/api/cost/${e}/`),T.value=T.value.filter((l=>l.id!==e))}catch(l){console.error("Error deleting catalog:",l)}})(e.id)},{default:c((()=>[w("Delete")])),_:2},1032,["onClick"])])),_:2},1024)])))),128))])),_:1})])),_:1},8,["data"])):k("",!0)],64)}}}),ee={class:"flex-toolbar is-reversed is-flex space-between my-4"},le=d("div",null,null,-1),ae={key:0},te={key:1,class:"flex-list-wrapper flex-list-v2"},se={class:"item-name dark-inverted"},oe={class:"item-meta"},ie=["innerHTML"],ne={class:"light-text"},re={class:"item-name dark-inverted"},pe={class:"light-text"},de={class:"item-name dark-inverted"},ue={class:"light-text"},ce=["onClick"],_e=[d("div",{class:"icon"},[d("i",{"aria-hidden":"true",class:"lnil lnil-pencil"})],-1),d("div",{class:"meta"},[d("span",null,"Edit"),d("span",null,"Edit Proposal Details")],-1)],me=["onClick"],ve=[d("div",{class:"icon"},[d("i",{"aria-hidden":"true",class:"lnil lnil-eye"})],-1),d("div",{class:"meta"},[d("span",null,"Preview"),d("span",null,"Preview proposal detail")],-1)],ye=d("hr",{class:"dropdown-divider"},null,-1),ge=["onClick"],fe=[d("div",{class:"icon"},[d("i",{class:"lnir lnir-round-box-check","aria-hidden":"true"})],-1),d("div",{class:"meta"},[d("span",null,"Mark Approved"),d("span",null,"Mark Proposal As Approved")],-1)],be=["onClick"],xe=[d("div",{class:"icon"},[d("i",{"aria-hidden":"true",class:"lnil lnil-trash-can-alt"})],-1),d("div",{class:"meta"},[d("span",null,"Delete"),d("span",null,"Delete from list")],-1)],ke=d("img",{class:"light-image",src:z,alt:""},null,-1),he=d("img",{class:"dark-image",src:B,alt:""},null,-1),we=a({__name:"TemplatePropsalsList",props:{activeTab:{default:"active"},leadId:{default:""},allProposal:{type:Boolean,default:!1}},setup(a){const w=a,C=t();s();const j=I(),P=S(),T=o(!1),V=o([]),z=o(!1),B=o(""),Y=o(!1),J=o(!1),G=o(""),Q=o("");o(w.activeTab);const Z=o({title:"",subtitle:"test",isSweetAlertOpen:!1,btntext:"text"}),q=o({title:"",subtitle:"",isSweetAlertOpen:!1,btntext:""}),X=async()=>{try{T.value=!0;await j.delete(`/api/lead-proposal/${Q.value}/`);P.success("Proposal delete successfully"),Ie()}catch(e){P.error(` ${e}, Proposal`),P.error("Something went wrong please try later")}finally{T.value=!1,Z.value.isSweetAlertOpen=!1}},we={picture:{label:"Proposal",grow:!0,media:!0},deadline:"Cost Items",amount:{label:"Total Amount",media:!0},customer:"Created At",actions:{label:"Actions",align:"end"}},Ce=i((()=>{if(G.value){const e=new RegExp(G.value,"i");return V.value.filter((l=>l.title.match(e)||l.approval_deadline.match(e)))}return V.value})),je=o(!1),Pe=o(!1),Te=o(!1),Ve=o(""),Ae=e=>{C.push(`/sidebar/dashboard/proposals/${e}`)},Ie=()=>{(async()=>{try{T.value=!0;const e=await j.get("/api/lead-proposal/templates/");V.value=e.data}catch(e){P.error(` ${e}, Lead`)}finally{T.value=!1}})()};return n((()=>{Ie()})),(a,t)=>{const s=A,o=W,i=l,n=N,C=F,I=e,S=H,Se=E,Oe=D,Me=O,Le=M,Ue=$,De=U,$e=L;return r(),p("div",null,[d("div",ee,[u(s,{icon:"feather:search"},{default:c((()=>[_(d("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>y(G)?G.value=e:null),class:"input custom-text-filter",placeholder:"Search..."},null,512),[[m,v(G)]])])),_:1}),le]),v(T)?(r(),p("div",ae,[u(o)])):(r(),p("div",te,[v(Ce).length>0&&v(V).length>0?(r(),g(I,{key:0,data:v(Ce),columns:we,rounded:""},{body:c((()=>[u(x,{name:"list",tag:"div",class:"flex-list-inner"},{default:c((()=>[(r(!0),p(f,null,b(v(Ce),(e=>(r(),p("div",{key:e.id,class:"flex-table-item"},[u(i,{column:{media:!0,grow:!0},class:"cu-pointer",onClick:l=>Ae(e.id)},{default:c((()=>[d("div",null,[d("span",se,h(e.title),1),d("span",oe,[d("span",{innerHTML:e.introductory_text},null,8,ie)])])])),_:2},1032,["onClick"]),u(i,{class:"cu-pointer",onClick:l=>Ae(e.id)},{default:c((()=>[d("span",ne,h(),1),u(n,{rounded:"",color:"primary",label:e.cost_items},null,8,["label"])])),_:2},1032,["onClick"]),u(i,{class:"cu-pointer",onClick:l=>Ae(e.id),column:{media:!0}},{default:c((()=>[d("div",null,[d("span",re,"$"+h(e.proposalAmount),1),d("span",pe,h(e.payment_status),1)])])),_:2},1032,["onClick"]),u(i,{column:{media:!0},class:"cu-pointer",onClick:l=>Ae(e.id)},{default:c((()=>[d("div",null,[d("span",de,h(v(K)(e.created_at)),1),d("span",ue,h(v(R)(e.created_at)),1)])])),_:2},1032,["onClick"]),u(i,{column:{align:"end"}},{default:c((()=>[u(C,{class:"is-pushed-mobile",icon:"feather:more-vertical",spaced:"",right:""},{content:c((()=>[d("a",{role:"menuitem",onClick:l=>{return a=e.id,B.value=a,void(z.value=!0);var a},class:"dropdown-item is-media"},_e,8,ce),d("a",{disabled:"",role:"menuitem",onClick:l=>{return a=e.id,Pe.value=a,void(je.value=!je.value);var a},class:"dropdown-item is-media"},ve,8,me),ye,d("a",{role:"menuitem",onClick:l=>(async(e,l)=>{try{await j.patch(`/api/lead-proposal/${l}/`,{status:e}),P.success(`You have ${e} this proposal.`),Ie()}catch(a){console.log(a)}})("approved",e.id),class:"dropdown-item is-media"},fe,8,ge),d("a",{role:"menuitem",onClick:l=>{return a=e.id,Q.value=a,void(Z.value={title:"Delete Proposal?",subtitle:"Are you sure to delete this proposal? After delete you will not be able to recover it again.",btntext:"Yes delete",isSweetAlertOpen:!0});var a},class:"dropdown-item is-media"},xe,8,be)])),_:2},1024)])),_:2},1024)])))),128))])),_:1})])),_:1},8,["data"])):k("",!0),v(V).length<1&&0==v(Ce).length?(r(),g(S,{key:1,title:"There is no proposal created on this lead!",subtitle:"Too bad. Looks like we couldn't created any proposal on this Lead, please create proposal and release to the client",larger:""},{image:c((()=>[ke,he])),_:1})):k("",!0),v(Ce).length>5?(r(),g(Se,{key:2,"item-per-page":10,"total-items":873,"current-page":42,"max-links-displayed":7})):k("",!0)])),v(Y)?(r(),g(Oe,{key:2,createProposalTasksModal:v(Y),proposalId:v(B),onCloseModalHandler:t[1]||(t[1]=e=>Y.value=!1),"onUpdate:OnSuccess":Ie},null,8,["createProposalTasksModal","proposalId"])):k("",!0),v(z)?(r(),g(Me,{key:3,leadId:w.leadId,proposalId:v(B),leadProposalModal:v(z),"onUpdate:modalHandler":t[2]||(t[2]=e=>z.value=!1),"onUpdate:OnSuccess":Ie,onClearProposalId:t[3]||(t[3]=e=>B.value="")},null,8,["leadId","proposalId","leadProposalModal"])):k("",!0),v(je)?(r(),g(Le,{key:4,"preview-modal":v(je),proposalId:v(Pe),"onUpdate:modalHandler":t[4]||(t[4]=e=>je.value=!1)},null,8,["preview-modal","proposalId"])):k("",!0),v(Te)?(r(),g(Ue,{key:5,costItemModal:v(Te),proposalId:v(Ve),"onUpdate:modalHandler":t[5]||(t[5]=e=>Te.value=!1),"onUpdate:OnSuccess":Ie},null,8,["costItemModal","proposalId"])):k("",!0),v(Z).isSweetAlertOpen?(r(),g(De,{key:6,isSweetAlertOpen:v(Z).isSweetAlertOpen,title:v(Z).title,subtitle:v(Z).subtitle,btntext:v(Z).btntext,onConfirm:X,onCancel:()=>v(Z).isSweetAlertOpen=!1},null,8,["isSweetAlertOpen","title","subtitle","btntext","onCancel"])):k("",!0),v(q).isSweetAlertOpen?(r(),g(De,{key:7,isSweetAlertOpen:v(q).isSweetAlertOpen,title:v(q).title,subtitle:v(q).subtitle,btntext:v(q).btntext,onConfirm:X,onCancel:()=>v(q).isSweetAlertOpen=!1},null,8,["isSweetAlertOpen","title","subtitle","btntext","onCancel"])):k("",!0),v(J)?(r(),g($e,{key:8,leadProposalListModal:v(J),leadID:w.leadId,"group-proposal-modal":v(J),"onUpdate:modalHandler":t[6]||(t[6]=e=>J.value=!1)},null,8,["leadProposalListModal","leadID","group-proposal-modal"])):k("",!0)])}}}),Ce={class:"tabs-wrapper"},je={class:"tabs-inner"},Pe={class:"tabs"},Te=[d("span",null,"Templates",-1)],Ve=[d("span",null,"Catalog",-1)],Ae={key:0,class:""},Ie={key:1,class:""},Se=a({__name:"index",setup(e){const l=Y(),a=o("proposalsTemplates");return l.setPageTitle("Proposals Templates"),j({title:"Proposals Templates - Ibex"}),(e,l)=>{const t=we,s=X;return r(),p("div",null,[d("div",Ce,[d("div",je,[d("div",Pe,[d("ul",null,[d("li",{class:P(["proposalsTemplates"===v(a)?"is-active":"not-active"])},[d("a",{tabindex:"0",role:"button",onKeydown:l[0]||(l[0]=T(V((e=>a.value="proposalsTemplates"),["prevent"]),["space"])),onClick:l[1]||(l[1]=e=>a.value="proposalsTemplates")},Te,32)],2),d("li",{class:P(["catalog"===v(a)?"is-active":"not-active"])},[d("a",{tabindex:"0",role:"button",onKeydown:l[2]||(l[2]=T(V((e=>a.value="catalog"),["prevent"]),["space"])),onClick:l[3]||(l[3]=e=>a.value="catalog")},Ve,32)],2)])])])]),"proposalsTemplates"===v(a)?(r(),p("div",Ae,[u(t)])):k("",!0),"catalog"===v(a)?(r(),p("div",Ie,[u(s)])):k("",!0)])}}});export{Se as default};
