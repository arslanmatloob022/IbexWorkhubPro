import{_ as e}from"./SweetAlert.vue_vue_type_style_index_0_lang-df2b83f3.js";import{_ as t}from"./CompanyLargeModal-6f8e1dbb.js";import{_ as s}from"./VFlexPagination.vue_vue_type_script_setup_true_lang-0f3a06f6.js";import{_ as a}from"./VPlaceholderPage.vue_vue_type_style_index_0_lang-ee086f33.js";import{_ as l,c as i}from"./VFlexTable.vue_vue_type_style_index_0_lang-8eb822b1.js";import{_ as n}from"./VDropdown.vue_vue_type_style_index_0_lang-5a74bf98.js";import{_ as o}from"./VAvatar.vue_vue_type_style_index_0_lang-560ded64.js";import{_ as r}from"./PlaceloadV1.vue_vue_type_style_index_0_lang-58bafc79.js";import{e as u,N as c,t as p,r as d,Z as m,o as _,M as v,y as g,z as y,C as f,A as h,B as b,S as x,T as j,D as k,H as w,P as C,l as V,Q as O,R as A,aR as S,j as P,E as T,a3 as I,J as M,W as D,X as N,L as $,v as B}from"./index-879cc21e.js";import{_ as E}from"./VControl-3a0d7b90.js";import{_ as W,a as F}from"./projects-dark-4a371d8a.js";import{u as R}from"./company-5bfaee0a.js";import{u as U}from"./useNotyf-953388fb.js";import{u as z}from"./useAPI-bba6ff57.js";import{u as L}from"./viewWrapper-cd4cd6f9.js";import"./VOption.vue_vue_type_style_index_0_lang-6cc7e380.js";import"./useVFieldContext-1b6aa39a.js";import"./VField.vue_vue_type_script_setup_true_lang-8fda54d1.js";import"./VLabel.vue_vue_type_script_setup_true_lang-010b6911.js";import"./VIconButton-a16d14d0.js";import"./upload-3-63902ba9.js";import"./useSupportElement-23fcf6e3.js";import"./userSession-a2fa2e58.js";import"./VFlex.vue_vue_type_style_index_0_lang-b564a019.js";import"./VIcon.vue_vue_type_script_setup_true_lang-8eb8745d.js";import"./useDropdown-84fb480e.js";import"./VPlaceloadWrap-31e1b55a.js";import"./VPlaceloadText.vue_vue_type_style_index_0_lang-1e98310c.js";import"./VPlaceloadAvatar.vue_vue_type_style_index_0_lang-7398d3bd.js";import"./notyf-058d7186.js";import"./useThemeColors-9b3162c4.js";const q=e=>(D("data-v-aeb7b07e"),e=e(),N(),e),H=q((()=>f("div",{class:"columns",style:{"justify-content":"end"}},null,-1))),Z={class:"columns mt-5"},J={class:"column is-7"},Y={class:"list-flex-toolbar mb-5",style:{"justify-content":"end"}},G={class:"flex-list-wrapper flex-list-v2 mt-5"},Q={class:"user-meta"},X={class:"item-name dark-inverted",style:{"margin-bottom":"6px !important",display:"flex","align-items":"center"}},K={key:0},ee={class:"item-meta"},te=q((()=>f("i",{style:{width:"10px"},class:"iconify","data-icon":"feather:phone","aria-hidden":"true"},null,-1))),se={class:"item-meta"},ae={class:"light-text"},le=q((()=>f("i",{class:"lnir lnir-control-panel","aria-hidden":"true"},null,-1))),ie={class:"light-text"},ne={class:"light-text"},oe={class:"light-text is-flex is-pointer",style:{position:"relative","align-items":"end",cursor:"pointer"}},re=q((()=>f("div",{class:"icon"},[f("i",{"aria-hidden":"true",class:"lnil lnil-briefcase"})],-1))),ue=q((()=>f("div",{class:"meta"},[f("span",null,"View"),f("span",null,"View business details")],-1))),ce=["onClick"],pe=[q((()=>f("div",{class:"icon"},[f("i",{"aria-hidden":"true",class:"lnil lnil-pencil"})],-1))),q((()=>f("div",{class:"meta"},[f("span",null,"Edit"),f("span",null,"Edit business details")],-1)))],de=q((()=>f("hr",{class:"dropdown-divider"},null,-1))),me=["onClick"],_e=[q((()=>f("div",{class:"icon"},[f("i",{"aria-hidden":"true",class:"lnil lnil-trash-can-alt"})],-1))),q((()=>f("div",{class:"meta"},[f("span",null,"Delete"),f("span",null,"Delete from list")],-1)))],ve=q((()=>f("img",{class:"light-image is-larger",src:W,alt:""},null,-1))),ge=q((()=>f("img",{class:"dark-image is-larger",src:F,alt:""},null,-1))),ye=q((()=>f("div",{class:"column is-5 mt-8 is-base-chart is-dark-bordered-12"},[f("div",{class:"content-box"},[f("h1",{class:"title is-5"},"Coverage Area"),f("div",{id:"myMap",style:{height:"550px",width:"550px","border-radius":"10px"}})])],-1))),fe=$(u({__name:"CustomerCompanies",setup(u){const D=L(),N=z(),$=c(),B=p(),W=R(),F=U(),q=d(!1),fe=d(8),he=d(3),be=d("");d("add"),d(!1);const xe=d(""),je=d(0),ke=d(!1),we=d(0),Ce=d({title:"",subtitle:"test",isSweetAlertOpen:!1,btntext:"text"});let Ve={},Oe={};const Ae=d(!1),Se=[],Pe={registrationNumber:"Business Name",email:{label:"Reg# / UTR",align:"center"},relation:{label:"Business_Type",align:"center"},location:{label:"Location",align:"center"},actions:{label:"Actions",align:"end"}},Te=async()=>{q.value=!0,Se.length=0;const e=await N.get(`/v3/api/customer-company/company/${W.loggedCompany.id}`);Se.push(...e.data),we.value=e.data.length,be.value="value",be.value="",q.value=!1,Ee(Se),D.setPageTitle(`Customers (${we?.value}) `)},Ie=m((()=>{let e=Se;if(be.value){const t=new RegExp(be.value,"i");e=Se.filter((e=>{const s=e.name&&e.name.match(t),a=e.email&&e.email.match(t);return s||a}))}return e})),Me=m((()=>{const e=(De.value-1)*fe.value,t=e+fe.value;return Ie.value.slice(e,t)})),De=m((()=>{let e=$.query.page;return e=null==e||"undefined"==e?1:$.query.page,Number.parseInt($.query.page)||1})),Ne=(e=0)=>{xe.value=e,ke.value=!0},$e=async()=>{try{Ce.value.isSweetAlertOpen=!1;await N.delete(`/v3/api/customer-company/${je.value}/`,{});Te(),F.dismissAll(),F.success("Business Delete")}catch(e){console.error("ok",e)}};const Be=e=>{e.latitude&&(Ve.panTo({lat:e.latitude,lng:e.longitude}),Ve.setZoom(8),function(e){const t=Oe[e];if(t){t.setOptions({strokeOpacity:.3}),t.setOptions({strokeWeight:50});for(const t in Oe)if(t!=e){const e=Oe[t];e&&(e.setOptions({strokeOpacity:.1}),e.setOptions({strokeWeight:20}))}}}(e.id))};function Ee(e=Se){console.log("Map View:",e);Ve=new google.maps.Map(document.getElementById("myMap"),{center:{lat:51.4497984,lng:-.3464489},scrollwheel:!1,mapTypeId:google.maps.MapTypeId.Satellite,zoom:8}),e.forEach(((e,t)=>{if(!e.latitude)return;const s=new google.maps.Circle({strokeColor:e.color,strokeOpacity:.1,strokeWeight:25,fillColor:e.color,fillOpacity:.7,map:Ve,center:{lat:e.latitude,lng:e.longitude},radius:1e4*1.63});Oe[e.id]=s})),Ae.value=!1}const We=async e=>{try{const t=await N.get(`/v3/api/site/customer-company/${e}/`);console.log("customer site",t.data),Ee(t.data)}catch(t){console.log(t)}};return _((()=>{D.setPageTitle(`Customers (${we?.value}) `),Te()})),(u,c)=>{const p=E,d=T,m=r,_=o,D=i,N=v("RouterLink"),$=n,W=l,F=a,R=s,U=t,z=e;return g(),y(O,null,[H,f("div",Z,[f("div",J,[f("div",null,[f("div",Y,[h(p,{icon:"feather:search"},{default:b((()=>[x(f("input",{"onUpdate:modelValue":c[0]||(c[0]=e=>be.value=e),class:"input custom-text-filter",placeholder:"Search..."},null,512),[[j,be.value]])])),_:1}),h(d,{onClick:c[1]||(c[1]=e=>Ne()),class:"ml-2",color:"primary",icon:"fas fa-plus",elevated:""},{default:b((()=>[k(" New Business ")])),_:1})]),f("div",G,[q.value?(g(),w(m,{key:0})):C("",!0),V(Me).length?(g(),w(W,{key:1,data:V(Me),columns:Pe,rounded:""},{body:b((()=>[h(S,{name:"list",tag:"div",class:"flex-list-inner"},{default:b((()=>[(g(!0),y(O,null,A(V(Me),((e,t)=>(g(),y("div",{key:e.id,class:"flex-table-item mt-1",style:I({backgroundImage:`linear-gradient(-175deg, white 50%, ${e.color}45)`})},[h(D,{column:{media:!0},onClick:t=>V(B).push({path:`/sidebar/company/business/${e.id}`,params:{id:e.id}})},{default:b((()=>[h(_,{size:"medium",picture:e.logo?e.logo:"/images/avatars/placeholder.jpg"},null,8,["picture"]),f("div",Q,[f("span",X,[k(M(e.name.slice(0,20))+" ",1),e.name.length>20?(g(),y("span",K,"...")):C("",!0)]),f("span",ee,[f("span",null,[te,k(" "+M(e.phone_number),1)])]),f("span",se,[f("span",ae,[le,k(" "+M(e.email?e.email.slice(0,12)+"..":"------"),1)])])])])),_:2},1032,["onClick"]),h(D,{column:{align:"center"},onClick:t=>We(e.id)},{default:b((()=>[f("span",ie,M(e.reg_no?e.reg_no.slice(0,20):"-------"),1)])),_:2},1032,["onClick"]),h(D,{column:{align:"center"},onClick:t=>We(e.id)},{default:b((()=>[f("span",ne,M(e.business_type?e.business_type.slice(0,20):"-------"),1)])),_:2},1032,["onClick"]),h(D,{onMouseleave:c[2]||(c[2]=e=>function(){Ve.setZoom(6);for(const e in Oe){const t=Oe[e];t&&(t.setOptions({strokeOpacity:.1}),t.setOptions({strokeWeight:20}))}}()),onMouseover:()=>Be(e)},{default:b((()=>[f("div",oe,[f("div",null,[f("i",{class:"me-2 fa fa-map-marker mr-3",style:I({color:e?.color,fontSize:"30px"})},null,4),k(" "+M(e.address&&e.address.length>20?e.address.slice(0,20)+"...":e.address||"------------"),1)])])])),_:2},1032,["onMouseover"]),h(D,{column:{align:"end"}},{default:b((()=>[h($,{style:{position:"relative"},class:"is-pushed-mobile",icon:"feather:more-vertical",spaced:"",right:""},{content:b((()=>[h(N,{role:"menuitem",href:"#",class:"dropdown-item is-media",to:{name:"/sidebar/company/business/[id]",params:{id:e.id}}},{default:b((()=>[re,ue])),_:2},1032,["to"]),f("a",{role:"menuitem",href:"#",class:"dropdown-item is-media",onClick:t=>Ne(e.id)},pe,8,ce),de,f("a",{role:"menuitem",href:"#",class:"dropdown-item is-media",onClick:t=>{return s=e.id,je.value=s,void(Ce.value={title:"Are you sure?",subtitle:"You will not be able to recover this business!",btntext:"Yes, Delete it",isSweetAlertOpen:!0});var s}},_e,8,me)])),_:2},1024)])),_:2},1024)],4)))),128))])),_:1})])),_:1},8,["data"])):(g(),w(F,{key:2,title:"No service partners found.",subtitle:"It seems that you haven't connected with any service partners yet. As you begin to finalize projects, they will be displayed here."},{image:b((()=>[ve,ge])),_:1})),V(Ie).length>fe.value?(g(),w(R,{key:3,"item-per-page":fe.value,modelValue:V(De),"onUpdate:modelValue":c[3]||(c[3]=e=>P(De)?De.value=e:null),"total-items":V(Ie).length,"current-page":V(De),"max-links-displayed":he.value},null,8,["item-per-page","modelValue","total-items","current-page","max-links-displayed"])):C("",!0)])])]),ye]),ke.value?(g(),w(U,{key:0,id:xe.value,openCustomCompany:ke.value,"onUpdate:modalHandler":c[4]||(c[4]=e=>ke.value=e),"onUpdate:OnSuccess":Te},null,8,["id","openCustomCompany"])):C("",!0),Ce.value.isSweetAlertOpen?(g(),w(z,{key:1,isSweetAlertOpen:Ce.value.isSweetAlertOpen,title:Ce.value.title,subtitle:Ce.value.subtitle,btntext:Ce.value.btntext,onConfirm:$e,onCancel:()=>Ce.value.isSweetAlertOpen=!1},null,8,["isSweetAlertOpen","title","subtitle","btntext","onCancel"])):C("",!0)],64)}}}),[["__scopeId","data-v-aeb7b07e"]]),he={class:"page-content-inner"},be=u({__name:"index",setup:e=>(L().setPageTitle("Customers"),B({title:"Customers - Ibex"}),(e,t)=>{const s=fe;return g(),y("div",he,[h(s)])})});export{be as default};
