import{_ as e}from"./VModal.vue_vue_type_style_index_0_lang-579ee674.js";import{_ as l}from"./VField.vue_vue_type_script_setup_true_lang-05c8a30c.js";import{_ as a}from"./VInput.vue_vue_type_script_setup_true_lang-2eaa04da.js";import{_ as t}from"./VLabel.vue_vue_type_script_setup_true_lang-af499751.js";import{_ as s}from"./ExcelFileEditor-9295c243.js";import{_ as o}from"./VIconWrap.vue_vue_type_style_index_0_lang-196d99cd.js";import{_ as i}from"./VControl-9c54ab47.js";import{f as n,b as r,r as u,w as c,$ as d,o as p,C as m,O as v,D as _,E as f,F as y,G as g,K as h,L as x,X as b,V as k,W as C,m as w,N as j,U as I,J as T,P as V,al as S,Q as P,R as A,S as M,x as U,y as O,k as L,aS as F,A as E,I as $,H as D}from"./index-69081f3d.js";import{_ as H}from"./PlaceloadV4.vue_vue_type_style_index_0_lang-0ab4f88f.js";import{u as R}from"./useAPI-1291b2e3.js";import{u as K}from"./useNotyf-346954c1.js";import{e as W,a as z,f as B,h as N}from"./useSupportElement-1d09722f.js";import{c as q,b as Q}from"./CreateProposalTasksModal-b49e4325.js";import{_ as X,c as Y}from"./VFlexTable.vue_vue_type_style_index_0_lang-0bed1c58.js";import{_ as G,a as J,b as Z}from"./ProposalViewModal.vue_vue_type_style_index_0_lang-8cd9cb50.js";import{_ as ee}from"./SweetAlert.vue_vue_type_style_index_0_lang-8128506c.js";import{_ as le}from"./VFlexPagination.vue_vue_type_script_setup_true_lang-0418399c.js";import{_ as ae}from"./VPlaceholderPage.vue_vue_type_style_index_0_lang-b504e853.js";import{_ as te}from"./VDropdown.vue_vue_type_style_index_0_lang-c10d3788.js";import{_ as se}from"./VTag.vue_vue_type_style_index_0_lang-1b23da92.js";import{_ as oe}from"./PlaceloadV1.vue_vue_type_style_index_0_lang-49cf227c.js";import{_ as ie,a as ne}from"./search-4-dark-2b5b440c.js";import{u as re}from"./viewWrapper-de78572e.js";import"./useVFieldContext-706bc66d.js";import"./VIconBox.vue_vue_type_style_index_0_lang-45e437df.js";import"./moment-1b9a430c.js";import"./via-placeholder-24645670.js";import"./VPlaceloadText.vue_vue_type_style_index_0_lang-2409ac51.js";import"./VPlaceloadAvatar.vue_vue_type_style_index_0_lang-205d63fc.js";import"./notyf-93785595.js";import"./useThemeColors-f709bd19.js";import"./UnitAddUpdateModal.vue_vue_type_script_setup_true_lang-cd0c61a8.js";import"./VTextarea.vue_vue_type_script_setup_true_lang-196090ab.js";import"./VCheckbox.vue_vue_type_style_index_0_lang-ae7a192d.js";import"./VOption.vue_vue_type_style_index_0_lang-887da321.js";import"./costItems-58a96177.js";import"./VIconButton-628a13b7.js";import"./company-3bba4552.js";import"./VRadio.vue_vue_type_style_index_0_lang-c3c43c67.js";import"./V-Snack.vue_vue_type_style_index_0_lang-b22348f4.js";import"./VIcon.vue_vue_type_script_setup_true_lang-486fea66.js";import"./VAvatar.vue_vue_type_style_index_0_lang-2886593b.js";import"./VFlex.vue_vue_type_style_index_0_lang-8a6f33e9.js";import"./useDropdown-490d1405.js";import"./VPlaceloadWrap-1d89fb9d.js";const ue={key:1,class:"columns is-multiline"},ce={class:"column is-12"},de={class:"columns is-multiline"},pe={class:"list-flex-toolbar is-reversed column is-12"},me={class:"card p-4 curved is-flex space-between"},ve={class:"subtitle is-5 m-0"},_e={class:"content"},fe={class:"is-flex"},ye={class:"modal-form columns is-multiline"},ge={class:"file has-name"},he={class:"file-label"},xe=(e=>(P("data-v-09397dde"),e=e(),A(),e))((()=>f("span",{class:"file-cta"},[f("span",{class:"file-icon"},[f("i",{class:"fas fa-cloud-upload-alt"})]),f("span",{class:"file-label"}," Choose a fileâ€¦ ")],-1))),be={class:"file-name light-text"},ke=M(n({__name:"CalculationsTemplates",props:{fetchAll:{},fetchTemplates:{},userId:{},objectId:{}},setup(n){const P=n,A=r(),M=R(),U=K(),O=u(!1),L=u([]),F=u([]),E=u(""),$=u(!1),D=u(""),B=u(!1),N=u(0),q=u({file:"",title:"",user_id:A.user.id,object_id:P.objectId}),Q=e=>{let l=e.target.files[0];q.value.file=l,D.value=l.name,q.value.title=l.name},X=u(""),Y=u([{value:"",name:""}]),G=async()=>{try{O.value=!0;const e=await M.get("/api/excel-files/");L.value=e.data}catch(e){console.error(e)}finally{O.value=!1}},J=async()=>{try{O.value=!0;const e=await M.get("/api/excel-files/templates/");F.value=e.data,Y.value=F.value.map((e=>({value:e.id,name:e.title})))}catch(e){console.error(e)}finally{O.value=!1}},Z=(e="")=>{N.value=e,B.value=!0},ee=u(!1),le=async()=>{try{ee.value=!0;const e=z(q.value,[""]);await M.post("/api/excel-files/upload-excel/",e);G(),U.success("Sheet uploaded successfully")}catch(e){console.error(e)}finally{ee.value=!1,$.value=!1}};c((()=>X.value),(e=>{e&&(async e=>{try{ee.value=!0,await M.post(`/api/excel-files/create-from-template/${e}/`),U.success("Sheet create successfully"),G()}catch(l){console.error(l)}finally{ee.value=!1,$.value=!1}})(e)}));const ae=d((()=>{if(E.value){const e=new RegExp(E.value,"i");return F.value.filter((l=>l.title?.match(e)))}return F.value}));return p((async()=>{J()})),(n,r)=>{const u=H,c=V,d=S,p=i,P=o,A=s,L=t,F=a,R=l,K=e;return O.value?(m(),v(u,{key:0})):(m(),_("div",ue,[f("div",ce,[f("div",de,[f("div",pe,[y(d,null,{default:g((()=>[y(c,{icon:"fas fa-plus",color:"info",outlined:"",light:"",class:"ml-2",raised:"",onClick:r[0]||(r[0]=e=>Z())},{default:g((()=>[h("Template")])),_:1}),y(c,{icon:"fas fa-upload",raised:"",light:"",onClick:r[1]||(r[1]=e=>$.value=!$.value),outlined:"",color:"primary"},{default:g((()=>[h(" File ")])),_:1})])),_:1}),f("div",null,[y(p,{class:"mr-2 h-hidden-mobile",icon:"feather:search"},{default:g((()=>[x(f("input",{"onUpdate:modelValue":r[2]||(r[2]=e=>E.value=e),class:"input custom-text-filter",placeholder:"Search..."},null,512),[[b,E.value]])])),_:1})])]),(m(!0),_(k,null,C(w(ae),((e,l)=>(m(),_("div",{class:"column is-6",key:e.id},[f("div",me,[f("div",null,[f("h4",ve,I(e.title),1),f("div",_e,[f("p",null,I(w(W)(e.created_at)),1)])]),f("div",fe,[y(P,{icon:"lucide:pen",color:"info",class:"cu-pointer",onClick:l=>Z(e.id),"has-background":""},null,8,["onClick"]),y(P,{onClick:l=>(async e=>{try{await M.delete(`/api/excel-files/${e}/`),U.success("Sheet deleted successfully!"),J()}catch(l){console.error(l),U.error("Failed to delete sheet.")}})(e.id),icon:"lucide:trash",color:"danger","has-background":"",class:"cu-pointer ml-1"},null,8,["onClick"])])])])))),128))])]),B.value?(m(),v(A,{key:0,class:"fullscreen","excel-file-modal":B.value,fileId:N.value,isTemplate:!0,"onUpdate:modalHandler":r[3]||(r[3]=e=>{J(),B.value=!1})},null,8,["excel-file-modal","fileId"])):j("",!0),y(K,{is:"form",open:$.value,title:"Upload Task File",size:"medium",actions:"right",onClose:r[6]||(r[6]=e=>$.value=!1),onSubmit:T(le,["prevent"])},{content:g((()=>[f("div",ye,[y(R,{class:"column is-12"},{default:g((()=>[y(L,null,{default:g((()=>[h("File Title")])),_:1}),y(p,null,{default:g((()=>[y(F,{modelValue:q.value.title,"onUpdate:modelValue":r[4]||(r[4]=e=>q.value.title=e),type:"text"},null,8,["modelValue"])])),_:1})])),_:1}),y(R,{class:"column is-12",grouped:""},{default:g((()=>[y(p,null,{default:g((()=>[f("div",ge,[f("label",he,[f("input",{onChange:Q,class:"file-input",type:"file",name:"file",required:""},null,32),xe,f("span",be,I(D.value?D.value:"Upload any file"),1)])])])),_:1})])),_:1})])])),cancel:g((()=>[y(c,{onClick:r[5]||(r[5]=e=>$.value=!1),raised:""},{default:g((()=>[h("Close")])),_:1})])),action:g((()=>[y(c,{type:"submit",color:"primary",raised:""},{default:g((()=>[h("Upload")])),_:1})])),_:1},8,["open","onSubmit"])]))}}}),[["__scopeId","data-v-09397dde"]]),Ce={class:"is-flex",style:{"justify-content":"end"}},we={class:"item-name dark-inverted"},je={class:"light-text"},Ie={class:"light-text"},Te={class:"light-text"},Ve=n({__name:"CataLogList",setup(e){U(),O();const l=R();K();const a=u(""),t=u([]);u([]);const s=u(!1),o=u(""),n=u(0),r=u(""),c=u("catalog"),T=[{label:"Title",key:"title"},{label:"Unit",key:"unit"},{label:"Total Price",key:"total_price"},{label:"Cost Type",key:"cost_type"},{label:"Actions",key:"actions"}],S=async()=>{try{const e=await l.get("/api/cost/catalogs/");t.value=e.data}catch(e){console.error("Error fetching catalogs:",e)}},P=d((()=>t.value.filter((e=>e.title.toLowerCase().includes(a.value.toLowerCase())))));return p(S),(e,u)=>{const d=i,p=Y,A=V,M=X,U=q;return m(),_(k,null,[f("div",Ce,[y(d,{icon:"feather:search"},{default:g((()=>[x(f("input",{"onUpdate:modelValue":u[0]||(u[0]=e=>L(a)?a.value=e:null),class:"input custom-text-filter",placeholder:"Search..."},null,512),[[b,w(a)]])])),_:1})]),w(P).length>0?(m(),v(M,{key:0,class:"mt-5",data:w(P),columns:T,rounded:""},{body:g((()=>[y(F,{name:"list",tag:"div",class:"flex-list-inner"},{default:g((()=>[(m(!0),_(k,null,C(w(P),(e=>(m(),_("div",{key:e.id,class:"flex-table-item"},[y(p,{column:{media:!0,grow:!1},class:"cu-pointer"},{default:g((()=>[f("div",null,[f("span",we,I(e.title),1)])])),_:2},1024),y(p,null,{default:g((()=>[f("span",je,I(e.unit),1)])),_:2},1024),y(p,null,{default:g((()=>[f("span",Ie,I(e.total_price),1)])),_:2},1024),y(p,null,{default:g((()=>[f("span",Te,I(e.cost_type),1)])),_:2},1024),y(p,null,{default:g((()=>[y(A,{color:"primary",size:"medium",light:"",onClick:l=>{return a=e,r.value=a.id,o.value=a.proposal,void(s.value=!s.value);var a},icon:"fas fa-pen"},{default:g((()=>[h("Edit")])),_:2},1032,["onClick"]),y(A,{class:"ml-2",color:"danger",size:"medium",light:"",onClick:a=>(async e=>{try{await l.delete(`/api/cost/${e}/`),t.value=t.value.filter((l=>l.id!==e))}catch(a){console.error("Error deleting catalog:",a)}})(e.id),icon:"fas fa-trash-alt"},{default:g((()=>[h("Delete")])),_:2},1032,["onClick"])])),_:2},1024)])))),128))])),_:1})])),_:1},8,["data"])):j("",!0),w(s)?(m(),v(U,{key:1,costItemModal:w(s),proposalId:w(o),costItemId:w(r),previousItemIndex:w(n),costMode:w(c),"onUpdate:modalHandler":u[1]||(u[1]=e=>{s.value=!1,r.value=""}),"onUpdate:OnSuccess":S},null,8,["costItemModal","proposalId","costItemId","previousItemIndex","costMode"])):j("",!0)],64)}}}),Se={class:"flex-toolbar is-reversed is-flex space-between my-4"},Pe={key:0},Ae={key:1,class:"flex-list-wrapper flex-list-v2"},Me={class:"item-name dark-inverted"},Ue={class:"item-meta"},Oe=["innerHTML"],Le={class:"light-text"},Fe={class:"item-name dark-inverted"},Ee={class:"light-text"},$e={class:"item-name dark-inverted"},De={class:"light-text"},He=["onClick"],Re=[f("div",{class:"icon"},[f("i",{"aria-hidden":"true",class:"lnil lnil-pencil"})],-1),f("div",{class:"meta"},[f("span",null,"Edit"),f("span",null,"Edit Proposal Details")],-1)],Ke=["onClick"],We=[f("div",{class:"icon"},[f("i",{"aria-hidden":"true",class:"lnil lnil-eye"})],-1),f("div",{class:"meta"},[f("span",null,"Preview"),f("span",null,"Preview proposal detail")],-1)],ze=f("hr",{class:"dropdown-divider"},null,-1),Be=["onClick"],Ne=[f("div",{class:"icon"},[f("i",{class:"lnir lnir-round-box-check","aria-hidden":"true"})],-1),f("div",{class:"meta"},[f("span",null,"Mark Approved"),f("span",null,"Mark Proposal As Approved")],-1)],qe=["onClick"],Qe=[f("div",{class:"icon"},[f("i",{"aria-hidden":"true",class:"lnil lnil-trash-can-alt"})],-1),f("div",{class:"meta"},[f("span",null,"Delete"),f("span",null,"Delete from list")],-1)],Xe=f("img",{class:"light-image",src:ie,alt:""},null,-1),Ye=f("img",{class:"dark-image",src:ne,alt:""},null,-1),Ge=n({__name:"TemplatePropsalsList",props:{activeTab:{default:"active"},leadId:{default:""},allProposal:{type:Boolean,default:!1}},setup(e){const l=e,a=U();O();const t=R(),s=K(),o=u(!1),n=u([]),r=u(!1),c=u(""),T=u(!1),S=u(!1),P=u(""),A=u("");u(l.activeTab);const M=u({title:"",subtitle:"test",isSweetAlertOpen:!1,btntext:"text"}),E=u({title:"",subtitle:"",isSweetAlertOpen:!1,btntext:""}),$=async()=>{try{o.value=!0;await t.delete(`/api/lead-proposal/${A.value}/`);s.success("Proposal delete successfully"),ue()}catch(e){s.error(` ${e}, Proposal`),s.error("Something went wrong please try later")}finally{o.value=!1,M.value.isSweetAlertOpen=!1}},D={picture:{label:"Proposal",grow:!0,media:!0},deadline:"Cost Items",amount:{label:"Total Amount",media:!0},customer:"Created At",actions:{label:"Actions",align:"end"}},H=d((()=>{if(P.value){const e=new RegExp(P.value,"i");return n.value.filter((l=>l.title.match(e)||l.approval_deadline.match(e)))}return n.value})),W=u(!1),z=u(!1),ie=u(!1),ne=u(""),re=e=>{a.push(`/sidebar/dashboard/proposals/${e}`)},ue=()=>{(async()=>{try{o.value=!0;const e=await t.get("/api/lead-proposal/templates/");n.value=e.data}catch(e){s.error(` ${e}, Lead`)}finally{o.value=!1}})()};return p((()=>{ue()})),(e,a)=>{const u=i,d=V,p=oe,U=Y,O=se,R=te,K=X,ce=ae,de=le,pe=Q,me=G,ve=J,_e=q,fe=ee,ye=Z;return m(),_("div",null,[f("div",Se,[y(u,{icon:"feather:search"},{default:g((()=>[x(f("input",{"onUpdate:modelValue":a[0]||(a[0]=e=>L(P)?P.value=e:null),class:"input custom-text-filter",placeholder:"Search..."},null,512),[[b,w(P)]])])),_:1}),f("div",null,[y(d,{color:"primary",onClick:a[1]||(a[1]=e=>r.value=!w(r)),icon:"fas fa-plus"},{default:g((()=>[h("Template ")])),_:1})])]),w(o)?(m(),_("div",Pe,[y(p)])):(m(),_("div",Ae,[w(H).length>0&&w(n).length>0?(m(),v(K,{key:0,data:w(H),columns:D,rounded:""},{body:g((()=>[y(F,{name:"list",tag:"div",class:"flex-list-inner"},{default:g((()=>[(m(!0),_(k,null,C(w(H),(e=>(m(),_("div",{key:e.id,class:"flex-table-item"},[y(U,{column:{media:!0,grow:!0},class:"cu-pointer",onClick:l=>re(e.id)},{default:g((()=>[f("div",null,[f("span",Me,I(e.title),1),f("span",Ue,[f("span",{innerHTML:e.introductory_text},null,8,Oe)])])])),_:2},1032,["onClick"]),y(U,{class:"cu-pointer",onClick:l=>re(e.id)},{default:g((()=>[f("span",Le,I(),1),y(O,{rounded:"",color:"primary",label:e.cost_items},null,8,["label"])])),_:2},1032,["onClick"]),y(U,{class:"cu-pointer",onClick:l=>re(e.id),column:{media:!0}},{default:g((()=>[f("div",null,[f("span",Fe,"$"+I(e.proposalAmount),1),f("span",Ee,I(e.payment_status),1)])])),_:2},1032,["onClick"]),y(U,{column:{media:!0},class:"cu-pointer",onClick:l=>re(e.id)},{default:g((()=>[f("div",null,[f("span",$e,I(w(B)(e.created_at)),1),f("span",De,I(w(N)(e.created_at)),1)])])),_:2},1032,["onClick"]),y(U,{column:{align:"end"}},{default:g((()=>[y(R,{class:"is-pushed-mobile",icon:"feather:more-vertical",spaced:"",right:""},{content:g((()=>[f("a",{role:"menuitem",onClick:l=>{return a=e.id,c.value=a,void(r.value=!0);var a},class:"dropdown-item is-media"},Re,8,He),f("a",{disabled:"",role:"menuitem",onClick:l=>{return a=e.id,z.value=a,void(W.value=!W.value);var a},class:"dropdown-item is-media"},We,8,Ke),ze,f("a",{role:"menuitem",onClick:l=>(async(e,l)=>{try{await t.patch(`/api/lead-proposal/${l}/`,{status:e}),s.success(`You have ${e} this proposal.`),ue()}catch(a){console.log(a)}})("approved",e.id),class:"dropdown-item is-media"},Ne,8,Be),f("a",{role:"menuitem",onClick:l=>{return a=e.id,A.value=a,void(M.value={title:"Delete Proposal?",subtitle:"Are you sure to delete this proposal? After delete you will not be able to recover it again.",btntext:"Yes delete",isSweetAlertOpen:!0});var a},class:"dropdown-item is-media"},Qe,8,qe)])),_:2},1024)])),_:2},1024)])))),128))])),_:1})])),_:1},8,["data"])):j("",!0),w(n).length<1&&0==w(H).length?(m(),v(ce,{key:1,title:"There is no proposal created on this lead!",subtitle:"Too bad. Looks like we couldn't created any proposal on this Lead, please create proposal and release to the client",larger:""},{image:g((()=>[Xe,Ye])),_:1})):j("",!0),w(H).length>5?(m(),v(de,{key:2,"item-per-page":10,"total-items":873,"current-page":42,"max-links-displayed":7})):j("",!0)])),w(T)?(m(),v(pe,{key:2,createProposalTasksModal:w(T),proposalId:w(c),onCloseModalHandler:a[2]||(a[2]=e=>T.value=!1),"onUpdate:OnSuccess":ue},null,8,["createProposalTasksModal","proposalId"])):j("",!0),w(r)?(m(),v(me,{key:3,leadId:l.leadId,proposalId:w(c),createTemplate:!0,leadProposalModal:w(r),"onUpdate:modalHandler":a[3]||(a[3]=e=>{r.value=!1,ue()}),"onUpdate:OnSuccess":ue,onClearProposalId:a[4]||(a[4]=e=>c.value="")},null,8,["leadId","proposalId","leadProposalModal"])):j("",!0),w(W)?(m(),v(ve,{key:4,"preview-modal":w(W),proposalId:w(z),"onUpdate:modalHandler":a[5]||(a[5]=e=>W.value=!1)},null,8,["preview-modal","proposalId"])):j("",!0),w(ie)?(m(),v(_e,{key:5,costItemModal:w(ie),proposalId:w(ne),"onUpdate:modalHandler":a[6]||(a[6]=e=>ie.value=!1),"onUpdate:OnSuccess":ue},null,8,["costItemModal","proposalId"])):j("",!0),w(M).isSweetAlertOpen?(m(),v(fe,{key:6,isSweetAlertOpen:w(M).isSweetAlertOpen,title:w(M).title,subtitle:w(M).subtitle,btntext:w(M).btntext,onConfirm:$,onCancel:()=>w(M).isSweetAlertOpen=!1},null,8,["isSweetAlertOpen","title","subtitle","btntext","onCancel"])):j("",!0),w(E).isSweetAlertOpen?(m(),v(fe,{key:7,isSweetAlertOpen:w(E).isSweetAlertOpen,title:w(E).title,subtitle:w(E).subtitle,btntext:w(E).btntext,onConfirm:$,onCancel:()=>w(E).isSweetAlertOpen=!1},null,8,["isSweetAlertOpen","title","subtitle","btntext","onCancel"])):j("",!0),w(S)?(m(),v(ye,{key:8,leadProposalListModal:w(S),leadID:l.leadId,"group-proposal-modal":w(S),"onUpdate:modalHandler":a[7]||(a[7]=e=>S.value=!1)},null,8,["leadProposalListModal","leadID","group-proposal-modal"])):j("",!0)])}}}),Je={class:"tabs-wrapper"},Ze={class:"tabs-inner"},el={class:"tabs"},ll=[f("span",null,"Proposal Templates",-1)],al=[f("span",null,"Cost Catalogs",-1)],tl=[f("span",null,"Calculations Template",-1)],sl={key:0,class:""},ol={key:1,class:""},il={key:2,class:""},nl=n({__name:"index",setup(e){const l=re(),a=u("proposalsTemplates");return l.setPageTitle("Templates & Catalogs"),E({title:"Templates & Catalogs - Ibex"}),(e,l)=>{const t=Ge,s=Ve,o=ke;return m(),_("div",null,[f("div",Je,[f("div",Ze,[f("div",el,[f("ul",null,[f("li",{class:$(["proposalsTemplates"===w(a)?"is-active":"not-active"])},[f("a",{tabindex:"0",role:"button",onKeydown:l[0]||(l[0]=D(T((e=>a.value="proposalsTemplates"),["prevent"]),["space"])),onClick:l[1]||(l[1]=e=>a.value="proposalsTemplates")},ll,32)],2),f("li",{class:$(["catalog"===w(a)?"is-active":"not-active"])},[f("a",{tabindex:"0",role:"button",onKeydown:l[2]||(l[2]=D(T((e=>a.value="catalog"),["prevent"]),["space"])),onClick:l[3]||(l[3]=e=>a.value="catalog")},al,32)],2),f("li",{class:$(["calculations"===w(a)?"is-active":"not-active"])},[f("a",{tabindex:"0",role:"button",onKeydown:l[4]||(l[4]=D(T((e=>a.value="calculations"),["prevent"]),["space"])),onClick:l[5]||(l[5]=e=>a.value="calculations")},tl,32)],2)])])])]),"proposalsTemplates"===w(a)?(m(),_("div",sl,[y(t)])):j("",!0),"catalog"===w(a)?(m(),_("div",ol,[y(s)])):j("",!0),"calculations"===w(a)?(m(),_("div",il,[y(o)])):j("",!0)])}}});export{nl as default};
