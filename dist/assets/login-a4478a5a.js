import{_ as e}from"./VMessage.vue_vue_type_style_index_0_lang-2ef527f9.js";import{e as a,r as s,D as o,L as l,M as t,o as i,X as n,t as r,K as d,v as u,x as c,A as p,y as m,z as v,G as f,l as g,N as y,I as h,B as _,j as b,R as w,Y as k,O as x,F as j,T as C,C as V,V as z,W as A,J as I}from"./index-a3511ab8.js";import{_ as P}from"./VField.vue_vue_type_script_setup_true_lang-e06a2d38.js";import{_ as S}from"./VControl-f6dba4dd.js";import{_ as L}from"./VInput.vue_vue_type_script_setup_true_lang-17074c81.js";import{_ as U}from"./VLabel.vue_vue_type_script_setup_true_lang-dfa6e2cd.js";import{_ as R}from"./AnimatedLogo-6cc2e185.js";import{u as F}from"./userSession-1e35e5f3.js";import{u as T}from"./company-ca9a809c.js";import{u as W}from"./useNotyf-bee6672a.js";import{u as E}from"./useFetch-4785c4fe.js";import{u as K}from"./useAPI-2f913358.js";import{u as D}from"./layoutSwitcher-616936e2.js";import"./useVFieldContext-f66aca7a.js";import"./useSupportElement-ec851bb5.js";import"./notyf-bdcd12d6.js";import"./useThemeColors-9cb1eefd.js";const M=e=>(z("data-v-f6dec2e5"),e=e(),A(),e),N={class:"modern-login"},q=M((()=>p("div",{class:"underlay h-hidden-mobile h-hidden-tablet-p"},null,-1))),O={class:"columns is-gapless is-vcentered"},X=C('<div class="column is-relative is-8 h-hidden-mobile h-hidden-tablet-p" data-v-f6dec2e5><div class="hero is-fullheight is-image" data-v-f6dec2e5><div class="hero-body" data-v-f6dec2e5><div class="container" data-v-f6dec2e5><div class="columns" data-v-f6dec2e5><div class="column" data-v-f6dec2e5><img class="hero-image" src="/images/loginPageImage.jpg" alt="" data-v-f6dec2e5></div></div></div></div></div></div>',1),Y={style:{"z-index":"99999"},class:"column is-4 is-relative"},B={class:"top-tools"},G=M((()=>p("h3",{class:"",style:{"font-size":"1.8rem","font-weight":"600","margin-left":"1rem",color:"#777"}},[p("span",{style:{color:"#2aac8e","font-size":"1.9rem"}},"Admin"),_(" Portal ")],-1))),J=["checked"],Z=M((()=>p("span",null,null,-1))),$={class:"is-form"},H={class:"is-form-inner"},Q=[M((()=>p("h2",null,"Sign In",-1))),M((()=>p("p",null,"Welcome back to your account.",-1)))],ee=[M((()=>p("h2",null,"Recover Account",-1))),M((()=>p("p",null,"Reset your account password.",-1)))],ae=["onSubmit"],se=[M((()=>p("i",{class:"iconify","data-icon":"feather:eye","aria-hidden":"true",style:{"font-size":"1.5rem",color:"#888"}},null,-1)))],oe=[M((()=>p("i",{class:"iconify","data-icon":"feather:eye-off","aria-hidden":"true",style:{"font-size":"1.5rem",color:"#888"}},null,-1)))],le=M((()=>p("span",{class:"toggler"},[p("span",{class:"active"},[p("i",{"aria-hidden":"true",class:"iconify","data-icon":"feather:check"})]),p("span",{class:"inactive"},[p("i",{"aria-hidden":"true",class:"iconify","data-icon":"feather:circle"})])],-1))),te={class:"button-wrap has-help"},ie={key:0,class:"recover-text"},ne={class:"button-wrap"},re=I(a({__name:"login",setup(a){const C=D(),z=s("login"),A=s(!1),I=o(),M=l(),re=t(),de=W();E();const ue=K(),ce=T(),pe=F();let me=!1;re.query.redirect;const ve=s(""),fe=s(""),ge=s(""),ye=s(!1),he=s(!1),_e=s(!1),be=async()=>{if(!A.value){A.value=!0;try{const e=await ue.post("/v3/api/account/auth/login/",{email:ve.value,password:fe.value});console.log("resp",e.data.user),me=e.data.user.is_superuser,pe.setToken(e.data.access),pe.setUser(e.data.user),we()}catch(e){A.value=!1,console.log("errr",e),de.error("Invalid Credentials, Sign In")}}},we=()=>{console.log("inside login success"),A.value=!1,de.success(`Welcome back, ${pe.user.first_name}`),console.log("user",pe.user.is_superuser),pe.user.company&&ce.loadCompany(pe.user.company),C.setDynamicLayoutId("sideblock-default"),"partner"==pe.user.role?M.push("/sidebar/partner/dashboard"):M.push("/sidebar/company")},ke=()=>{ye.value=!ye.value};return i((()=>{pe.token&&(async()=>{try{const e=await ue.get("/v3/api/account/get_user_from_token");pe.setUser(e.data[0]),console.log(pe.user,"session user"),me=e.data[0].is_superuser,we()}catch(e){}})()})),n((()=>{const e=window.location.search,a=new URLSearchParams(e).get("token");a?pe.setToken(a):console.log("Invalid token")})),r({title:"Auth Login 1 - Arez"}),(a,s)=>{const o=R,l=d("RouterLink"),t=U,i=L,n=S,r=P,C=V,F=e;return u(),c("div",N,[q,p("div",O,[X,p("div",Y,[p("div",B,[m(l,{to:"/",class:"top-logo"},{default:v((()=>[m(o,{style:{width:"38px",height:"38px"}}),G])),_:1}),p("label",{class:"dark-mode",tabindex:"0",role:"button",onKeydown:s[1]||(s[1]=f(h((e=>e.target.click()),["prevent"]),["space"]))},[p("input",{"data-cy":"dark-mode-toggle",type:"checkbox",checked:!g(I).isDark,onChange:s[0]||(s[0]=(...e)=>g(I).onChange&&g(I).onChange(...e))},null,40,J),Z],32)]),p("div",$,[p("div",H,[p("div",{class:y(["form-text",["login"!==g(z)&&"is-hidden"]])},Q,2),p("div",{class:y(["form-text",["login"===g(z)&&"is-hidden"]])},ee,2),p("form",{method:"post",novalidate:"","data-cy":"login-form",class:y([["login"!==g(z)&&"is-hidden"],"login-wrapper"]),onSubmit:h(be,["prevent"])},[m(r,null,{default:v((()=>[m(n,{icon:"lnil lnil-envelope autv-icon"},{default:v((()=>[m(t,{class:"auth-label"},{default:v((()=>[_(" Email Address ")])),_:1}),m(i,{modelValue:g(ve),"onUpdate:modelValue":s[2]||(s[2]=e=>b(ve)?ve.value=e:null),"data-cy":"email-input",type:"email",autocomplete:"current-password"},null,8,["modelValue"])])),_:1})])),_:1}),m(r,null,{default:v((()=>[m(n,{icon:"lnil lnil-lock-alt autv-icon",style:{position:"relative"}},{default:v((()=>[w(p("span",{style:{position:"absolute","z-index":"9999",right:"1rem",top:"1.4rem"},onClick:ke},se,512),[[k,!g(ye)]]),w(p("span",{style:{position:"absolute","z-index":"9999",right:"1rem",top:"1.4rem"},onClick:ke},oe,512),[[k,g(ye)]]),m(t,{class:"auth-label"},{default:v((()=>[_("Password")])),_:1}),m(i,{modelValue:g(fe),"onUpdate:modelValue":s[3]||(s[3]=e=>b(fe)?fe.value=e:null),"data-cy":"password-input",type:g(ye)?"text":"password",autocomplete:"current-password"},null,8,["modelValue","type"])])),_:1})])),_:1}),m(r,null,{default:v((()=>[m(n,{class:"is-flex"},{default:v((()=>[m(t,{raw:"",class:"remember-toggle"},{default:v((()=>[m(i,{raw:"",type:"checkbox"}),le])),_:1}),m(t,{raw:"",class:"remember-me"},{default:v((()=>[_(" Remember Me ")])),_:1}),p("a",{tabindex:"0",role:"button",onKeydown:s[4]||(s[4]=f(h((e=>z.value="forgot-password"),["prevent"]),["space"])),onClick:s[5]||(s[5]=e=>z.value="forgot-password")}," Forgot Password? ",32)])),_:1})])),_:1}),p("div",te,[m(C,{id:"login-button",loading:g(A),color:"primary",type:"submit",size:"big",rounded:"",raised:"",bold:""},{default:v((()=>[_(" Confirm ")])),_:1},8,["loading"]),p("span",null,[_(" Or "),m(l,{to:"/auth/signup-1"},{default:v((()=>[_("Create")])),_:1}),_(" an account. ")])])],42,ae),p("form",{method:"post",novalidate:"",class:y([["forgot-password"!==g(z)&&"is-hidden"],"login-wrapper"]),onSubmit:s[12]||(s[12]=h((()=>{}),["prevent"]))},[g(he)?x("",!0):(u(),c("p",ie," Enter your email and click on the confirm button to reset your password. We'll send you an email detailing the steps to complete the procedure. ")),g(he)?(u(),j(F,{key:1,color:"primary",class:"is-flex",closable:"",onClose:s[6]||(s[6]=e=>he.value=!1)},{default:v((()=>[_(" A password reset request has been sent to your email. Please check your inbox to change your password. ")])),_:1})):x("",!0),g(_e)?(u(),j(F,{key:2,color:"danger",class:"is-flex mt-4",closable:"",onClose:s[7]||(s[7]=e=>_e.value=!1)},{default:v((()=>[_(" Please enter valid email address. ")])),_:1})):x("",!0),m(r,null,{default:v((()=>[m(n,{icon:"lnil lnil-envelope autv-icon"},{default:v((()=>[m(t,{class:"auth-label"},{default:v((()=>[_(" Email Address ")])),_:1}),m(i,{type:"email",modelValue:g(ge),"onUpdate:modelValue":s[8]||(s[8]=e=>b(ge)?ge.value=e:null),autocomplete:"current-password"},null,8,["modelValue"])])),_:1})])),_:1}),m(r,null,{default:v((()=>[m(n,{class:"is-flex"},{default:v((()=>[p("a",{tabindex:"0",role:"button",onKeydown:s[9]||(s[9]=f(h((e=>z.value="login"),["prevent"]),["space"])),onClick:s[10]||(s[10]=e=>z.value="login")}," Login ? ",32)])),_:1})])),_:1}),p("div",ne,[m(C,{loading:g(A),color:"primary",size:"big",type:"submit",lower:"",rounded:"",solid:"",onClick:s[11]||(s[11]=e=>(async e=>{try{A.value=!0,await ue.post("/v3/api/account/auth/forget-password/",{email:e}),he.value=!0}catch(a){_e.value=!0,de.error("Please enter your valid email address")}finally{A.value=!1}})(g(ge)))},{default:v((()=>[_(" Confirm ")])),_:1},8,["loading"])])],34)])])])])])}}}),[["__scopeId","data-v-f6dec2e5"]]);export{re as default};
