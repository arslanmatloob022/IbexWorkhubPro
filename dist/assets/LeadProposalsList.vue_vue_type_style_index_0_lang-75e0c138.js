import{_ as e,a}from"./ProposalViewModal.vue_vue_type_style_index_0_lang-5e713365.js";import{_ as l}from"./SweetAlert.vue_vue_type_style_index_0_lang-b194db95.js";import{a as t,_ as s,b as o}from"./CreateProposalTasksModal-bdedf8b0.js";import{_ as i}from"./VPlaceholderPage.vue_vue_type_style_index_0_lang-5b759f5a.js";import{_ as r,c as n}from"./VFlexTable.vue_vue_type_style_index_0_lang-90ce9b44.js";import{_ as d}from"./VDropdown.vue_vue_type_style_index_0_lang-1cbd91b4.js";import{_ as p}from"./VTag.vue_vue_type_style_index_0_lang-aeb476fd.js";import{f as u,x as c,y as m,r as v,$ as _,o as y,av as f,C as k,D as b,m as h,F as w,E as g,G as C,L as x,X as P,k as A,K as S,O as I,N as j,V as O,W as L,aS as T,P as M,U as $}from"./index-451213d4.js";import{_ as V}from"./VControl-45df5642.js";import{_ as D}from"./PlaceloadV1.vue_vue_type_style_index_0_lang-c0cd22b3.js";import{_ as U,a as H}from"./search-4-dark-2b5b440c.js";import{u as E}from"./useAPI-1ed33b31.js";import{u as N}from"./useNotyf-b28f6053.js";import{f as F,j as Y}from"./useSupportElement-e61ac170.js";import{b as z,c as B,d as G,e as K}from"./estimatesScripts-01d5ff64.js";const R={key:0},W={key:1},X={class:"flex-toolbar is-reversed is-flex space-between my-4"},q={class:"flex-list-wrapper flex-list-v2"},J={class:"item-name dark-inverted show-text-250"},Q={class:"item-meta"},Z=g("i",{"aria-hidden":"true",class:"iconify","data-icon":"feather:clock"},null,-1),ee={class:"item-name dark-inverted"},ae=["onClick"],le=[g("div",{class:"icon"},[g("i",{"aria-hidden":"true",class:"lnil lnil-pencil"})],-1),g("div",{class:"meta"},[g("span",null,"Edit"),g("span",null,"Edit Proposal Details")],-1)],te=["onClick"],se=[g("div",{class:"icon"},[g("i",{"aria-hidden":"true",class:"lnil lnil-eye"})],-1),g("div",{class:"meta"},[g("span",null,"Preview"),g("span",null,"Preview proposal detail")],-1)],oe=["onClick"],ie=[g("div",{class:"icon"},[g("i",{class:"lnil lnil-calender-alt-1","aria-hidden":"true"})],-1),g("div",{class:"meta"},[g("span",null,"Create Tasks"),g("span",null,"Create tasks in chart ")],-1)],re=g("hr",{class:"dropdown-divider"},null,-1),ne=["onClick"],de=[g("div",{class:"icon"},[g("i",{class:"lnir lnir-round-box-check","aria-hidden":"true"})],-1),g("div",{class:"meta"},[g("span",null,"Mark Approved"),g("span",null,"Mark Proposal As Approved")],-1)],pe=["onClick"],ue=[g("div",{class:"icon"},[g("i",{"aria-hidden":"true",class:"lnil lnil-trash-can-alt"})],-1),g("div",{class:"meta"},[g("span",null,"Delete"),g("span",null,"Delete from list")],-1)],ce=g("img",{class:"light-image",src:U,alt:""},null,-1),me=g("img",{class:"dark-image",src:H,alt:""},null,-1),ve=u({__name:"LeadProposalsList",props:{activeTab:{default:"active"},leadId:{default:""},allProposal:{type:Boolean,default:!1}},emits:["updateCompany"],setup(u,{emit:U}){const H=u,ve=c();m();const _e=E(),ye=N(),fe=v([]),ke=v(""),be=v(!1),he=v(!1),we=v(!1),ge=v(!1),Ce=v(!1),xe=v(!1),Pe=v(!1),Ae=v(""),Se=v(""),Ie=v("");v(H.activeTab);const je={picture:{label:"Proposal",grow:!0,media:!0},industry:"Type",status:"Status",amount:{label:"Total Amount",media:!0},customer:"Calendar Tasks ",actions:{label:"Actions",align:"end"}},Oe=v({title:"",subtitle:"test",isSweetAlertOpen:!1,btntext:"text"}),Le=v({title:"",subtitle:"",isSweetAlertOpen:!1,btntext:""}),Te=async()=>{try{be.value=!0;await _e.delete(`/api/lead-proposal/${Ie.value}/`);ye.success("Proposal delete successfully"),$e()}catch(e){ye.error(` ${e}, Proposal`),ye.error("Something went wrong please try later")}finally{be.value=!1,Oe.value.isSweetAlertOpen=!1}},Me=e=>{ve.push(`/sidebar/dashboard/proposals/${e}`)},$e=()=>{1==H.allProposal?(async()=>{try{be.value=!0;const e=await _e.get("/api/lead-proposal/");fe.value=e.data}catch(e){ye.error(` ${e}, Lead`)}finally{be.value=!1}})():H.leadId&&(async()=>{try{be.value=!0;const e=await _e.get(`/api/lead-proposal/by-project/${H.leadId}/`);fe.value=e.data}catch(e){ye.error(` ${e}, Lead`)}finally{be.value=!1}})()},Ve=_((()=>{if(Se.value){const e=new RegExp(Se.value,"i");return fe.value.filter((a=>a.title.match(e)))}return fe.value}));return y((()=>{$e()})),(u,c)=>{const m=D,v=V,_=M,y=n,E=p,N=d,ve=r,De=i,Ue=t,He=s,Ee=e,Ne=o,Fe=l,Ye=a,ze=f("tooltip");return k(),b("div",null,[h(be)?(k(),b("div",R,[w(m)])):(k(),b("div",W,[g("div",X,[w(v,{icon:"feather:search"},{default:C((()=>[x(g("input",{"onUpdate:modelValue":c[0]||(c[0]=e=>A(Se)?Se.value=e:null),class:"input custom-text-filter",placeholder:"Search..."},null,512),[[P,h(Se)]])])),_:1}),g("div",null,[w(_,{color:"primary",onClick:c[1]||(c[1]=e=>he.value=!h(he)),icon:"fas fa-plus"},{default:C((()=>[S("Lead Proposal ")])),_:1}),H.leadId?(k(),I(_,{key:0,color:"warning",class:"ml-2",onClick:c[2]||(c[2]=e=>{ge.value=!0}),icon:"fas fa-cogs"},{default:C((()=>[S("Proposals")])),_:1})):j("",!0)])]),g("div",q,[h(Ve).length>0&&h(fe).length>0?(k(),I(ve,{key:0,data:h(Ve),columns:je,rounded:""},{body:C((()=>[w(T,{name:"list",tag:"div",class:"flex-list-inner"},{default:C((()=>[(k(!0),b(O,null,L(h(Ve),(e=>(k(),b("div",{key:e.id,class:"flex-table-item"},[w(y,{column:{media:!0,grow:!0},class:"cu-pointer",onClick:a=>Me(e.id)},{default:C((()=>[x((k(),b("div",null,[g("span",J,$(e.title),1),g("span",Q,[g("span",null,[Z,S($(h(F)(e.created_at)),1)])])])),[[ze,`${e.title}`,void 0,{rounded:!0,light:!0}]])])),_:2},1032,["onClick"]),w(y,{class:"cu-pointer",onClick:a=>Me(e.id)},{default:C((()=>[w(E,{rounded:"",color:h(z)[e.type]},{default:C((()=>[S($(h(B)[e.type]),1)])),_:2},1032,["color"])])),_:2},1032,["onClick"]),w(y,{class:"cu-pointer",onClick:a=>Me(e.id)},{default:C((()=>[w(E,{class:"capitalized",rounded:"",color:h(G)[e.status]},{default:C((()=>[S($(h(K)[e.status]),1)])),_:2},1032,["color"])])),_:2},1032,["onClick"]),w(y,{class:"cu-pointer",onClick:a=>Me(e.id),column:{media:!0}},{default:C((()=>[g("div",null,[g("span",ee,$(h(Y)(e?.proposalAmount)),1)])])),_:2},1032,["onClick"]),w(y,{class:"cu-pointer",onClick:a=>Me(e.id)},{default:C((()=>[w(E,{color:"purple",outlined:""},{default:C((()=>[S($(e.is_task_created?"Created":"Not Created"),1)])),_:2},1024)])),_:2},1032,["onClick"]),w(y,{column:{align:"end"}},{default:C((()=>[w(N,{class:"is-pushed-mobile",icon:"feather:more-vertical",spaced:"",right:""},{content:C((()=>[g("a",{role:"menuitem",onClick:a=>{return l=e.id,ke.value=l,void(he.value=!0);var l},class:"dropdown-item is-media"},le,8,ae),g("a",{disabled:"",role:"menuitem",onClick:a=>{return l=e.id,xe.value=l,void(Ce.value=!Ce.value);var l},class:"dropdown-item is-media"},se,8,te),"approved"==e.status?(k(),b("a",{key:0,role:"menuitem",onClick:a=>{return l=e.id,ke.value=l,void(we.value=!0);var l},class:"dropdown-item is-media"},ie,8,oe)):j("",!0),re,"approved"!=e.status?(k(),b("a",{key:1,role:"menuitem",onClick:a=>(async(e,a)=>{try{await _e.patch(`/api/lead-proposal/${a}/`,{status:e}),ye.success(`You have ${e} this proposal.`),"approved"==e&&U("updateCompany",null),$e()}catch(l){console.log(l)}})("approved",e.id),class:"dropdown-item is-media"},de,8,ne)):j("",!0),g("a",{role:"menuitem",onClick:a=>{return l=e.id,Ie.value=l,void(Oe.value={title:"Delete Proposal?",subtitle:"Are you sure to delete this proposal? After delete you will not be able to recover it again.",btntext:"Yes delete",isSweetAlertOpen:!0});var l},class:"dropdown-item is-media"},ue,8,pe)])),_:2},1024)])),_:2},1024)])))),128))])),_:1})])),_:1},8,["data"])):j("",!0),h(fe).length<1&&0==h(Ve).length?(k(),I(De,{key:1,title:"There is no proposal created on this lead!",subtitle:"Too bad. Looks like we couldn't created any proposal on this Lead, please create proposal and release to the client",larger:""},{image:C((()=>[ce,me])),_:1})):j("",!0)]),h(we)?(k(),I(Ue,{key:0,createProposalTasksModal:h(we),proposalId:h(ke),onCloseModalHandler:c[3]||(c[3]=e=>we.value=!1),"onUpdate:OnSuccess":c[4]||(c[4]=e=>$e())},null,8,["createProposalTasksModal","proposalId"])):j("",!0),h(he)?(k(),I(He,{key:1,leadId:H.leadId,proposalId:h(ke),leadProposalModal:h(he),getLeadsList:H.allProposal,"onUpdate:modalHandler":c[5]||(c[5]=()=>{$e(),he.value=!1}),onClearProposalId:c[6]||(c[6]=e=>ke.value="")},null,8,["leadId","proposalId","leadProposalModal","getLeadsList"])):j("",!0),h(Ce)?(k(),I(Ee,{key:2,"preview-modal":h(Ce),proposalId:h(xe),"onUpdate:modalHandler":c[7]||(c[7]=e=>Ce.value=!1)},null,8,["preview-modal","proposalId"])):j("",!0),h(Pe)?(k(),I(Ne,{key:3,costItemModal:h(Pe),proposalId:h(Ae),"onUpdate:modalHandler":c[8]||(c[8]=e=>Pe.value=!1),"onUpdate:OnSuccess":$e},null,8,["costItemModal","proposalId"])):j("",!0),h(Oe).isSweetAlertOpen?(k(),I(Fe,{key:4,isSweetAlertOpen:h(Oe).isSweetAlertOpen,title:h(Oe).title,subtitle:h(Oe).subtitle,btntext:h(Oe).btntext,onConfirm:Te,onCancel:()=>h(Oe).isSweetAlertOpen=!1},null,8,["isSweetAlertOpen","title","subtitle","btntext","onCancel"])):j("",!0),h(Le).isSweetAlertOpen?(k(),I(Fe,{key:5,isSweetAlertOpen:h(Le).isSweetAlertOpen,title:h(Le).title,subtitle:h(Le).subtitle,btntext:h(Le).btntext,onConfirm:Te,onCancel:()=>h(Le).isSweetAlertOpen=!1},null,8,["isSweetAlertOpen","title","subtitle","btntext","onCancel"])):j("",!0),h(ge)?(k(),I(Ye,{key:6,leadProposalListModal:h(ge),leadID:H.leadId,"group-proposal-modal":h(ge),"onUpdate:modalHandler":c[9]||(c[9]=e=>ge.value=!1)},null,8,["leadProposalListModal","leadID","group-proposal-modal"])):j("",!0)]))])}}});export{ve as _};
