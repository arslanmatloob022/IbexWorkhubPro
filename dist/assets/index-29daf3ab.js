import{_ as e}from"./AddUpdateUser-f1184667.js";import{_ as t}from"./SweetAlert.vue_vue_type_style_index_0_lang-c93f6d7f.js";import{_ as s}from"./VProgress.vue_vue_type_style_index_0_lang-73c6141f.js";import{_ as a}from"./VAvatar.vue_vue_type_style_index_0_lang-04b2a1a6.js";import{_ as l}from"./VPlaceholderPage.vue_vue_type_style_index_0_lang-4444dc72.js";import{e as i,r as n,Z as r,o,l as u,B as c,N as d,C as _,D as p,E as v,F as m,K as g,W as k,j as f,H as y,U as b,V as h,aR as w,M as x,O as j,T as A,J as C,x as S,z as V}from"./index-240e3878.js";import{_ as O}from"./VControl-8c8224f2.js";import{_ as P}from"./PlaceloadV3.vue_vue_type_style_index_0_lang-723b9627.js";import{_ as T,a as W}from"./search-4-dark-2b5b440c.js";import{u as U}from"./useAPI-019d2f30.js";import{u as I}from"./useNotyf-f1f05451.js";import{u as M}from"./viewWrapper-17733bfa.js";import"./VModal.vue_vue_type_style_index_0_lang-994c6311.js";import"./VSwitchBlock.vue_vue_type_style_index_0_lang-5cd7bdf5.js";import"./VLabel.vue_vue_type_script_setup_true_lang-81518b78.js";import"./useVFieldContext-fe61b166.js";import"./VIcon.vue_vue_type_script_setup_true_lang-c9209b13.js";import"./VFilePond.vue_vue_type_script_lang-00f201d3.js";import"./VField.vue_vue_type_script_setup_true_lang-ced660cf.js";import"./VInput.vue_vue_type_script_setup_true_lang-fc468275.js";import"./useSupportElement-44ee693d.js";import"./userSession-bdc7ada1.js";import"./VPlaceloadText.vue_vue_type_style_index_0_lang-fb248644.js";import"./VPlaceloadAvatar.vue_vue_type_style_index_0_lang-f425c86a.js";import"./notyf-09abdaaa.js";import"./useThemeColors-3d8be1d8.js";const D={key:1},E={class:"card-grid-toolbar"},F={class:"buttons"},z=p("span",{class:"icon"},[p("i",{"aria-hidden":"true",class:"fas fa-plus"})],-1),H=p("span",null," Worker",-1),L={class:"card-grid card-grid-v1"},$=p("img",{class:"light-image",src:T,alt:""},null,-1),B=p("img",{class:"dark-image",src:W,alt:""},null,-1),N={class:"card-grid-item"},R={class:"card-grid-item-body"},J={class:"left"},K={class:"meta"},Z={class:"dark-inverted"},q={class:"right"},Y={class:"social-links"},G=["onClick"],Q=[p("i",{class:"success-text fas fa-check-circle","aria-hidden":"true"},null,-1)],X=["onClick"],ee=[p("i",{class:"fas fa-ban warning-text","aria-hidden":"true"},null,-1)],te={key:2,channel:"Twitter",class:"social-link"},se=[p("i",{class:"fas fa-envelope warning-text","aria-hidden":"true"},null,-1)],ae=["onClick"],le=[p("i",{"aria-hidden":"true",class:"fas fa-edit info-text"},null,-1)],ie=["onClick"],ne=[p("i",{"aria-hidden":"true",class:"fas fa-trash danger-text"},null,-1)],re={class:"card-grid-item-footer"},oe={class:"left"},ue={class:"progress-stats"},ce=p("span",{class:"dark-inverted"},"Progress",-1),de={class:"progress-bar"},_e={class:"right"},pe={class:"buttons"},ve=i({__name:"IbexWorkers",setup(i){const S=U(),V=I(),T=n(""),W=n("");n(0);const M=n(""),ve=n(!1),me=n(!1),ge=n(null),ke=n(null),fe=n({title:"",subtitle:"test",isSweetAlertOpen:!1,btntext:"text"}),ye=n({title:"",subtitle:"test",isSweetAlertOpen:!1,btntext:"text"}),be=n([{id:"",active_tasks:0,completed_tasks:2,cancelled_tasks:0,pending_tasks:13,password:"",last_login:null,date_joined:"",email:"",role:"",is_active:!0,phoneNumber:"",username:"",is_sentMail:!1,avatar:null}]),he=(e="")=>{M.value=e,ve.value=!ve.value},we=r((()=>T.value?be.value.filter((e=>e.username.match(new RegExp(T.value,"i"))||e.email.match(new RegExp(T.value,"i")))):be.value)),xe=e=>{ge.value=e.id,ke.value=e.is_active,fe.value.title="Change Status",fe.value.btntext=""+(e.is_active?"In-Activate":"Activate"),fe.value.subtitle=ke.value?"After this User will not be able to login into the system":"From now this user will be able to login and perform all activities",fe.value.isSweetAlertOpen=!0},je=async()=>{try{me.value=!0,await S.delete(`/api/users/${W.value}/`,{}),await Ae(),V.green("Worker deleted successfully")}catch(e){console.log(e),V.error("Error while deleting")}finally{me.value=!1}},Ae=async()=>{try{me.value=!0;const e=await S.get("/api/users/workers/",{});be.value=e.data.map((e=>({...e,totalTasks:e.active_tasks+e.pending_tasks+e.completed_tasks}))),console.log("data",be.value)}catch(e){console.log(e)}finally{me.value=!1}},Ce=async()=>{try{me.value=!0;const e=await S.patch(`/api/users/${ge.value}/`,{is_active:!ke.value});await Ae(),V.success(ke.value?"Worker set inactive successfully":"Worker set active successfully"),fe.value.isSweetAlertOpen=!1,console.log(e)}catch(e){console.log(e)}finally{me.value=!1}};return o((()=>{Ae()})),(i,n)=>{const r=P,o=O,S=j,V=l,U=a,I=s,ge=t,ke=e;return u(me)?(c(),d(r,{key:0})):(c(),_("div",D,[p("div",E,[v(o,{icon:"feather:search"},{default:m((()=>[g(p("input",{"onUpdate:modelValue":n[0]||(n[0]=e=>f(T)?T.value=e:null),class:"input custom-text-filter",placeholder:"Search..."},null,512),[[k,u(T)]])])),_:1}),p("div",F,[v(S,{onClick:n[1]||(n[1]=e=>he()),color:"primary",raised:""},{default:m((()=>[z,H])),_:1})])]),p("div",L,[v(V,{class:y([0!==u(we).length&&"is-hidden"]),title:"We couldn't find any matching results.",subtitle:"Too bad. Looks like we couldn't find any matching results for the\n          search terms you've entered. Please try different search terms or\n          criteria.",larger:""},{image:m((()=>[$,B])),_:1},8,["class"]),v(w,{name:"list",tag:"div",class:"columns is-multiline"},{default:m((()=>[(c(!0),_(b,null,h(u(we),((e,t)=>(c(),_("div",{key:t,class:"column is-6"},[p("div",N,[p("div",R,[p("div",J,[v(U,{size:"big",picture:e?.avatar},null,8,["picture"]),p("div",K,[p("span",Z,A(e.username),1),p("span",null,A(e.role),1)])]),p("div",q,[p("div",Y,[e.is_active?(c(),_("a",{key:0,onClick:t=>xe(e),channel:"Linkedin",class:"social-link"},Q,8,G)):(c(),_("a",{key:1,onClick:t=>xe(e),channel:"Linkedin",class:"social-link"},ee,8,X)),e.is_sentMail?(c(),_("a",te,se)):x("",!0),p("a",{channel:"Dribbble",onClick:t=>he(e.id),class:"social-link"},le,8,ae),p("a",{channel:"Dribbble",onClick:t=>{return s=e,W.value=s.id,void(ye.value={title:`Delete ${s.username}?`,subtitle:"After deleting this worker you won't be able to recover it again.",btntext:"Delete it",isSweetAlertOpen:!0});var s},class:"social-link"},ne,8,ie)])])]),p("div",re,[p("div",oe,[p("div",ue,[ce,p("span",null,A(e.completed_tasks?e.completed_tasks/e.totalTasks*100:"0")+"%",1)]),p("div",de,[v(I,{size:"tiny",value:e.completed_tasks?e.completed_tasks:0,max:e.totalTasks?e.totalTasks:0},null,8,["value","max"])])]),p("div",_e,[p("div",pe,[v(S,{to:`/sidebar/dashboard/workers/${e.id}`,"dark-outlined":"",rounded:""},{default:m((()=>[C(" View Profile ")])),_:2},1032,["to"])])])])])])))),128))])),_:1})]),u(fe).isSweetAlertOpen?(c(),d(ge,{key:0,loading:u(me),isSweetAlertOpen:u(fe).isSweetAlertOpen,title:u(fe).title,subtitle:u(fe).subtitle,btntext:u(fe).btntext,onConfirm:Ce,onCancel:()=>u(fe).isSweetAlertOpen=!1},null,8,["loading","isSweetAlertOpen","title","subtitle","btntext","onCancel"])):x("",!0),u(ye).isSweetAlertOpen?(c(),d(ge,{key:1,loading:u(me),isSweetAlertOpen:u(ye).isSweetAlertOpen,title:u(ye).title,subtitle:u(ye).subtitle,btntext:u(ye).btntext,onConfirm:je,onCancel:()=>u(ye).isSweetAlertOpen=!1},null,8,["loading","isSweetAlertOpen","title","subtitle","btntext","onCancel"])):x("",!0),u(ve)?(c(),d(ke,{key:2,"is-modal-open":u(ve),"user-role":"worker","user-id":u(M),"onUpdate:closeModalHandler":n[2]||(n[2]=e=>ve.value=!1),"onUpdate:actionUpdateHandler":Ae},null,8,["is-modal-open","user-id"])):x("",!0)]))}}}),me={class:"page-content-inner"},ge=i({__name:"index",setup(e){S();return M().setPageTitle("Workers"),V({title:"Workers - Ibex"}),(e,t)=>{const s=ve;return c(),_("div",me,[v(s)])}}});export{ge as default};
