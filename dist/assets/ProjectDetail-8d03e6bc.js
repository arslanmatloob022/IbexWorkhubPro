import{_ as e}from"./UpdateTask.vue_vue_type_script_setup_true_lang-84d6284b.js";import{_ as a}from"./SweetAlert.vue_vue_type_style_index_0_lang-4d05d8dc.js";import{_ as l}from"./VPlaceholderPage.vue_vue_type_style_index_0_lang-4bb44ccd.js";import{_ as t}from"./VAvatar.vue_vue_type_style_index_0_lang-cbd0efae.js";import{_ as s}from"./VDropdown.vue_vue_type_style_index_0_lang-3e327287.js";import{e as i,r as n,Z as o,o as r,au as c,B as d,C as u,l as p,N as v,D as m,E as h,F as f,K as k,W as g,j as _,J as y,H as b,G as w,T as j,U as C,V as x,M as S,O as D,ak as A,I as T,P as I,Q as O,R as V,aR as U,x as P,v as E,s as $,A as N}from"./index-0b5beb63.js";import{_ as M}from"./VControl-aa90594a.js";import{_ as F}from"./PlaceloadV3.vue_vue_type_style_index_0_lang-77a2ec2c.js";import{_ as W,a as z}from"./projects-dark-4a371d8a.js";import{a as H}from"./useSupportElement-5c22c6f0.js";import{u as K}from"./useNotyf-5fa99148.js";import{u as L}from"./useAPI-7cb6365b.js";import{_ as R}from"./ProjectTodayTasks.vue_vue_type_style_index_0_lang-d489b253.js";import{_ as B,a as q}from"./VOption.vue_vue_type_style_index_0_lang-98b43832.js";import{_ as Y}from"./VLabel.vue_vue_type_script_setup_true_lang-f454a4c2.js";import{_ as Z}from"./VField.vue_vue_type_script_setup_true_lang-f78e6aa1.js";import{_ as J}from"./UserPopoverContent.vue_vue_type_script_setup_true_lang-3b0bbfc8.js";import{_ as G}from"./VModal.vue_vue_type_style_index_0_lang-4fa8f766.js";import{_ as Q}from"./VInput.vue_vue_type_script_setup_true_lang-d81d4e6d.js";import{_ as X,a as ee}from"./search-4-dark-2b5b440c.js";import{_ as ae}from"./sheet-50221dfe.js";import{o as le}from"./via-placeholder-24645670.js";import{_ as te}from"./VIcon.vue_vue_type_script_setup_true_lang-e215e78c.js";import{A as se}from"./vue3-apexcharts.common-104d507e.js";import{u as ie}from"./useThemeColors-a1156f44.js";import{u as ne}from"./userSession-acc5debe.js";const oe=e=>(I("data-v-6eb1ed57"),e=e(),O(),e),re={key:1},ce={class:"list-flex-toolbar is-reversed"},de={class:"tabs-inner"},ue={class:"tabs"},pe=oe((()=>m("span",null,"All",-1))),ve=[pe],me=oe((()=>m("span",null,"Completed",-1))),he=[me],fe=oe((()=>m("li",{class:"tab-naver"},null,-1))),ke={class:"flex-list-wrapper flex-list-v2"},ge={key:0,class:"tab-content is-active"},_e={class:"all-projects"},ye={class:"all-projects-header"},be={class:"header-item"},we={class:"item-inner"},je=oe((()=>m("i",{"aria-hidden":"true",class:"lnil lnil-analytics-alt-1"},null,-1))),Ce=oe((()=>m("p",null,"Total Tasks",-1))),xe={class:"header-item"},Se={class:"item-inner"},De=oe((()=>m("i",{"aria-hidden":"true",class:"lnil lnil-target-alt-1"},null,-1))),Ae=oe((()=>m("p",null,"Completed Tasks",-1))),Te={class:"header-item"},Ie={class:"item-inner"},Oe=oe((()=>m("i",{"aria-hidden":"true",class:"lnil lnil-pie-chart-alt"},null,-1))),Ve=oe((()=>m("p",null,"Pending Tasks",-1))),Ue={class:"header-item"},Pe={class:"item-inner"},Ee=oe((()=>m("i",{"aria-hidden":"true",class:"lnil lnil-leaf"},null,-1))),$e=oe((()=>m("p",null,"Active Tasks",-1))),Ne={key:0,class:"columns is-multiline projects-card-grid"},Me={class:"column is-6"},Fe={class:"grid-item"},We={class:"top-section"},ze={class:"head"},He=["onClick"],Ke=[oe((()=>m("div",{class:"icon"},[m("i",{class:"lnir lnir-play","aria-hidden":"true"})],-1))),oe((()=>m("div",{class:"meta"},[m("span",null,"Active"),m("span",null,"Start work on this task")],-1)))],Le=["onClick"],Re=[oe((()=>m("div",{class:"icon"},[m("i",{class:"lnir lnir-playlist-alt","aria-hidden":"true"})],-1))),oe((()=>m("div",{class:"meta"},[m("span",null,"Pending"),m("span",null,"Waiting to work on")],-1)))],Be=["onClick"],qe=[oe((()=>m("div",{class:"icon"},[m("i",{class:"lnir lnir-round-box-check","aria-hidden":"true"})],-1))),oe((()=>m("div",{class:"meta"},[m("span",null,"Completed"),m("span",null,"Mark task as completed")],-1)))],Ye=oe((()=>m("hr",{class:"dropdown-divider"},null,-1))),Ze=["onClick"],Je=[oe((()=>m("div",{class:"icon"},[m("i",{class:"lnir lnir-pencil-alt","aria-hidden":"true"})],-1))),oe((()=>m("div",{class:"meta"},[m("span",null,"Edit"),m("span",null,"Edit Task detail")],-1)))],Ge=["onClick"],Qe=[oe((()=>m("div",{class:"icon"},[m("i",{class:"lnir lnir-trash-can-alt-1","aria-hidden":"true"})],-1))),oe((()=>m("div",{class:"meta"},[m("span",null,"Delete "),m("span",null,"Delete this task")],-1)))],Xe={class:"body"},ea={class:"bottom-section"},aa={class:"foot-block"},la=oe((()=>m("h4",{class:"heading"},"Worker(s)",-1))),ta={class:"developers"},sa={class:"foot-block"},ia=oe((()=>m("h4",{class:"heading"},"Start date",-1))),na={class:"foot-block"},oa=oe((()=>m("h4",{class:"heading"},"End date",-1))),ra={class:"foot-block"},ca=oe((()=>m("h4",{class:"heading"},"Status",-1))),da=oe((()=>m("img",{class:"light-image is-larger",src:W,alt:""},null,-1))),ua=oe((()=>m("img",{class:"dark-image is-larger",src:z,alt:""},null,-1))),pa={key:1,class:"tab-content is-active"},va={class:"all-projects"},ma={key:0,class:"columns is-multiline projects-card-grid"},ha={class:"column is-6"},fa={class:"grid-item"},ka={class:"top-section"},ga={class:"head"},_a=["onClick"],ya=[oe((()=>m("div",{class:"icon"},[m("i",{"aria-hidden":"true",class:"lnil lnil-eye"})],-1))),oe((()=>m("div",{class:"meta"},[m("span",null,"Active"),m("span",null,"Start work on this task")],-1)))],ba=["onClick"],wa=[oe((()=>m("div",{class:"icon"},[m("i",{"aria-hidden":"true",class:"lnil lnil-pencil"})],-1))),oe((()=>m("div",{class:"meta"},[m("span",null,"Pending"),m("span",null,"Waiting to work on")],-1)))],ja=["onClick"],Ca=[oe((()=>m("div",{class:"icon"},[m("i",{"aria-hidden":"true",class:"lnil lnil-pencil"})],-1))),oe((()=>m("div",{class:"meta"},[m("span",null,"Completed"),m("span",null,"Mark task as completed")],-1)))],xa=oe((()=>m("hr",{class:"dropdown-divider"},null,-1))),Sa=["onClick"],Da=[oe((()=>m("div",{class:"icon"},[m("i",{"aria-hidden":"true",class:"lnil lnil-pencil"})],-1))),oe((()=>m("div",{class:"meta"},[m("span",null,"Edit"),m("span",null,"Edit Task detail")],-1)))],Aa=["onClick"],Ta=[oe((()=>m("div",{class:"icon"},[m("i",{"aria-hidden":"true",class:"lnil lnil-archive"})],-1))),oe((()=>m("div",{class:"meta"},[m("span",null,"Delete "),m("span",null,"Delete this task")],-1)))],Ia={class:"body"},Oa={class:"bottom-section"},Va={class:"foot-block"},Ua=oe((()=>m("h4",{class:"heading"},"Worker(s)",-1))),Pa={class:"developers"},Ea={class:"foot-block"},$a=oe((()=>m("h4",{class:"heading"},"Start date",-1))),Na={class:"foot-block"},Ma=oe((()=>m("h4",{class:"heading"},"End date",-1))),Fa={class:"foot-block"},Wa=oe((()=>m("h4",{class:"heading"},"Status",-1))),za=oe((()=>m("img",{class:"light-image is-larger",src:W,alt:""},null,-1))),Ha=oe((()=>m("img",{class:"dark-image is-larger",src:z,alt:""},null,-1))),Ka=V(i({__name:"ProjectsTasks",props:{projectID:{default:""}},emits:["update:getAllTasks","update:completedTasks","update:activeTasks"],setup(i,{emit:I}){const O=i,V=L(),U=K();n(1);const P=n("");n("Edit Project"),n("Add Task");const E=n(""),$=n("active"),N=n(0),W=n(!1),z=n(!1),H=n(0);n({});const R=n("");n([{id:0,username:"",email:"",phoneNumber:""}]);const B=n([{id:0,title:"",description:"",startDate:"",endDate:"",project:0,status:"",worker:[{id:0,username:"",email:"",role:"",avatar:""}],quantity:"",unit:"",costCode:""}]),q=n({title:"",subtitle:"test",isSweetAlertOpen:!1,btntext:"text"}),Y=e=>{H.value=e,q.value={title:"Delete Task?",subtitle:"Do you really want to delete this task permanently?",btntext:"Yes, Delete",isSweetAlertOpen:!0}},Z=async()=>{try{W.value=!0;const e=await V.get(`api/task/${O.projectID}/project/`);B.value=e.data,console.log(e.data)}catch(e){console.log(e)}finally{W.value=!1}},J=o((()=>{let e=B.value.filter((e=>"active"==e.status));return I("update:completedTasks",e.length),e.length})),G=o((()=>{let e=B.value.filter((e=>"pending"==e.status));return I("update:activeTasks",e.length),e.length})),Q=o((()=>B.value.filter((e=>"completed"==e.status)).length)),X=e=>{R.value=e,z.value=!0},ee=()=>{Z(),z.value=!1,R.value=""},ae=async(e,a)=>{try{W.value=!0;await V.patch(`/api/task/${e}/`,{status:a,schedule_mode:localStorage.getItem("isScheduleMode")});Z(),U.success(`Task set to ${a} successfully`),N.value=0,W.value=!1}catch(l){console.log(l)}},le=async()=>{try{W.value=!0;const e=await V.delete(`/api/task/${H.value}/`);console.log(e),U.success("Task deleted successfully"),Z(),q.value.isSweetAlertOpen=!1,N.value=0}catch(e){console.log(e)}finally{W.value=!1}},te=o((()=>{if(E.value){const e=new RegExp(E.value,"i");return B.value.filter((a=>"completed"!=a.status&&(a.title.match(e)||a.description.match(e)||a.status.match(e))))}return B.value.filter((e=>"completed"!=e.status))})),se=o((()=>{if(E.value){const e=new RegExp(E.value,"i");return B.value.filter((a=>"completed"==a.status&&(a.title.match(e)||a.description.match(e)||a.status.match(e))))}return B.value.filter((e=>"completed"==e.status))}));return r((()=>{Z()})),(i,n)=>{const o=F,r=M,I=D,V=A,U=s,N=t,H=l,K=a,L=e,ie=c("tooltip");return d(),u(C,null,[p(W)?(d(),v(o,{key:0})):(d(),u("div",re,[m("div",ce,[h(V,null,{default:f((()=>[h(r,{class:"mr-2 h-hidden-mobile",icon:"feather:search"},{default:f((()=>[k(m("input",{"onUpdate:modelValue":n[0]||(n[0]=e=>_(E)?E.value=e:null),class:"input custom-text-filter",placeholder:"Search..."},null,512),[[g,p(E)]])])),_:1}),h(I,{onClick:n[1]||(n[1]=e=>X()),color:"primary",icon:"fas fa-plus",elevated:"",raised:""},{default:f((()=>[y("Task")])),_:1})])),_:1}),m("div",de,[m("div",ue,[m("ul",null,[m("li",{class:b(["active"===p($)&&"is-active"])},[m("a",{tabindex:"0",role:"button",onKeydown:n[2]||(n[2]=w(T((e=>$.value="active"),["prevent"]),["space"])),onClick:n[3]||(n[3]=e=>$.value="active")},ve,32)],2),m("li",{class:b(["closed"===p($)&&"is-active"])},[m("a",{tabindex:"0",role:"button",onKeydown:n[4]||(n[4]=w(T((e=>$.value="closed"),["prevent"]),["space"])),onClick:n[5]||(n[5]=e=>$.value="closed")},he,32)],2),fe])])])]),m("div",ke,["active"===p($)?(d(),u("div",ge,[m("div",_e,[m("div",ye,[m("div",be,[m("div",we,[je,m("span",null,j(p(B).length),1),Ce])]),m("div",xe,[m("div",Se,[De,m("span",null,j(p(Q)),1),Ae])]),m("div",Te,[m("div",Ie,[Oe,m("span",null,j(p(G)),1),Ve])]),m("div",Ue,[m("div",Pe,[Ee,m("span",null,j(p(J)),1),$e])])]),p(te).length?(d(),u("div",Ne,[(d(!0),u(C,null,x(p(te),(e=>(d(),u("div",Me,[m("div",Fe,[m("div",We,[m("div",ze,[m("h3",null,j(e.title),1),h(U,{icon:"feather:more-vertical",spaced:"",right:""},{content:f((()=>[m("a",{onClick:a=>ae(e.id,"active"),role:"menuitem",class:"dropdown-item is-media"},Ke,8,He),m("a",{onClick:a=>ae(e.id,"pending"),role:"menuitem",class:"dropdown-item is-media"},Re,8,Le),m("a",{onClick:a=>ae(e.id,"completed"),role:"menuitem",class:"dropdown-item is-media"},qe,8,Be),Ye,m("a",{onClick:a=>X(e.id),role:"menuitem",class:"dropdown-item is-media"},Je,8,Ze),m("a",{onClick:a=>Y(e.id),role:"menuitem",class:"dropdown-item is-media"},Qe,8,Ge)])),_:2},1024)]),m("div",Xe,[m("p",null,j(e.description),1)])]),m("div",ea,[m("div",aa,[la,m("div",ta,[(d(!0),u(C,null,x(e.workers,(e=>k((d(),v(N,{picture:e.avatar,size:"small",color:"primary",initials:e.avatar?"":e.username.slice(0,2)},null,8,["picture","initials"])),[[ie,`${e.username}`,void 0,{rounded:!0,info:!0}]]))),256))])]),m("div",sa,[ia,m("p",null,j(e.startDate),1)]),m("div",na,[oa,m("p",null,j(e.endDate),1)]),m("div",ra,[ca,m("p",null,j(e.status),1)])])])])))),256))])):(d(),v(H,{key:1,title:"There is no task added on this projects.",subtitle:"Looks like you don't have any task on this project yet. When you'll\n                start creating tasks of this project, they will be showing up in here."},{image:f((()=>[da,ua])),_:1}))])])):"closed"===p($)?(d(),u("div",pa,[m("div",va,[p(se).length?(d(),u("div",ma,[(d(!0),u(C,null,x(p(se),(e=>(d(),u("div",ha,[m("div",fa,[m("div",ka,[m("div",ga,[m("h3",null,j(e.title),1),h(U,{icon:"feather:more-vertical",spaced:"",right:""},{content:f((()=>[m("a",{onClick:a=>ae(e.id,"active"),role:"menuitem",class:"dropdown-item is-media"},ya,8,_a),m("a",{onClick:a=>ae(e.id,"pending"),role:"menuitem",class:"dropdown-item is-media"},wa,8,ba),m("a",{onClick:a=>ae(e.id,"completed"),role:"menuitem",class:"dropdown-item is-media"},Ca,8,ja),xa,m("a",{onClick:a=>X(e.id),role:"menuitem",class:"dropdown-item is-media"},Da,8,Sa),m("a",{onClick:a=>Y(e.id),role:"menuitem",class:"dropdown-item is-media"},Ta,8,Aa)])),_:2},1024)]),m("div",Ia,[m("p",null,j(e.description),1)])]),m("div",Oa,[m("div",Va,[Ua,m("div",Pa,[(d(!0),u(C,null,x(e.workers,(e=>k((d(),v(N,{picture:e.avatar,size:"small",color:"primary",initials:e.avatar?"":e.username.slice(0,2)},null,8,["picture","initials"])),[[ie,`${e.username}`,void 0,{rounded:!0,info:!0}]]))),256))])]),m("div",Ea,[$a,m("p",null,j(e.startDate),1)]),m("div",Na,[Ma,m("p",null,j(e.endDate),1)]),m("div",Fa,[Wa,m("p",null,j(e.status),1)])])])])))),256))])):(d(),v(H,{key:1,title:"No closed projects.",subtitle:"Looks like you don't have any closed project yet. When you'll\n                start closing off projects, they will be showing up in here."},{image:f((()=>[za,Ha])),_:1}))])])):S("",!0)])])),p(q).isSweetAlertOpen?(d(),v(K,{key:2,isSweetAlertOpen:p(q).isSweetAlertOpen,title:p(q).title,subtitle:p(q).subtitle,btntext:p(q).btntext,onConfirm:le,loading:p(W),onCancel:()=>p(q).isSweetAlertOpen=!1},null,8,["isSweetAlertOpen","title","subtitle","btntext","loading","onCancel"])):S("",!0),p(z)?(d(),v(L,{key:3,projectID:O.projectID,isOpen:p(z),taskIdSelected:p(R),startDate:p(P),"onUpdate:modalHandler":ee,"onUpdate:OnSuccess":Z},null,8,["projectID","isOpen","taskIdSelected","startDate"])):S("",!0)],64)}}}),[["__scopeId","data-v-6eb1ed57"]]),La=e=>(I("data-v-0c7f5f21"),e=e(),O(),e),Ra={class:"tile-grid-toolbar"},Ba={class:"buttons"},qa={class:"tile-grid tile-grid-v2"},Ya=La((()=>m("img",{class:"light-image",src:X,alt:""},null,-1))),Za=La((()=>m("img",{class:"dark-image",src:ee,alt:""},null,-1))),Ja={class:"tile-grid-item"},Ga={class:"tile-grid-item-inner"},Qa={class:"meta"},Xa={class:"dark-inverted"},el=["onClick"],al=[La((()=>m("div",{class:"icon"},[m("i",{"aria-hidden":"true",class:"lnil lnil-trash-can-alt"})],-1))),La((()=>m("div",{class:"meta"},[m("span",null,"Delete"),m("span",null,"Delete this file")],-1)))],ll={class:"modal-form columns is-multiline"},tl={class:"file has-name"},sl={class:"file-label"},il=La((()=>m("span",{class:"file-cta"},[m("span",{class:"file-icon"},[m("i",{class:"fas fa-cloud-upload-alt"})]),m("span",{class:"file-label"}," Choose a file… ")],-1))),nl={class:"file-name light-text"},ol=V(i({__name:"ProjectFiles",props:{projectId:{},files:{}},emits:["update:onUploadFile"],setup(e,{emit:t}){const i=e,r=L(),c=K(),w=n(!1),A=n(!1),I=n(""),O=o((()=>I.value?i.files.filter((e=>e.match(new RegExp(I.value,"i")))):i.files)),V=n(""),P=n(""),E=n("");let $=null;const N=async()=>{try{w.value=!0;const e=await r.post(`/api/task/bulk-upload/${i.projectId}/`,{file:$,start:E.value});c.green("Tasks Will be generated automatically"),console.log(e),t("update:onUploadFile",null),w.value=!1}catch(e){console.log(e)}finally{A.value=!1}},F=e=>{const a=e.match(/\d{4}-\d{2}-\d{2}/);if(a){return a[0]}return"N/A"},W=e=>{let a=e.target.files[0];$=a,P.value=a.name},z=n({title:"",subtitle:"test",isSweetAlertOpen:!1,btntext:"text"}),H=async()=>{try{w.value=!0;await r.patch(`/api/project/${i.projectId}/delete-doc-tasks/`,{document_name:V.value});t("update:onUploadFile",null),c.success("Sheet deleted successfully!"),z.value.isSweetAlertOpen=!1}catch(e){console.log(e)}finally{w.value=!1}};return(e,t)=>{const i=M,n=D,o=l,r=s,c=a,w=Y,$=Q,K=Z,L=G;return d(),u(C,null,[m("div",null,[m("div",Ra,[h(i,{icon:"feather:search"},{default:f((()=>[k(m("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>_(I)?I.value=e:null),class:"input custom-text-filter",placeholder:"Search..."},null,512),[[g,p(I)]])])),_:1}),m("div",Ba,[h(n,{icon:"fas fa-plus",raised:"",size:"small",light:"",onClick:t[1]||(t[1]=e=>A.value=!p(A)),outlined:"",color:"primary"},{default:f((()=>[y(" File ")])),_:1})])]),m("div",qa,[h(o,{class:b([0!==p(O).length&&"is-hidden"]),title:"There is not file uploaded",subtitle:"There is no file uploaded on this project to create the tasks. As you will upload the file and that will appear here on the spot",larger:""},{image:f((()=>[Ya,Za])),_:1},8,["class"]),h(U,{name:"list",tag:"div",class:"columns is-multiline"},{default:f((()=>[(d(!0),u(C,null,x(p(O),(e=>(d(),u("div",{key:e.id,class:"column is-6"},[m("div",Ja,[m("div",Ga,[m("img",{src:ae,alt:"",onErrorOnce:t[2]||(t[2]=e=>p(le)(150))},null,32),m("div",Qa,[m("span",Xa,j(e.length>20?e.slice(0,24):e),1),m("span",null,[m("span",null,"Updated: "+j(F(e)),1)])]),h(r,{icon:"feather:more-vertical",spaced:"",right:""},{content:f((()=>[m("a",{onClick:a=>{return l=e,V.value=l,void(z.value={title:"Are you sure?",subtitle:"This file and all task generated from this file will be deleted permanently!",btntext:"Yes, Delete it",isSweetAlertOpen:!0});var l},role:"menuitem",class:"dropdown-item is-media"},al,8,el)])),_:2},1024)])])])))),128))])),_:1})])]),p(z).isSweetAlertOpen?(d(),v(c,{key:0,isSweetAlertOpen:p(z).isSweetAlertOpen,title:p(z).title,subtitle:p(z).subtitle,btntext:p(z).btntext,onConfirm:H,onCancel:()=>p(z).isSweetAlertOpen=!1},null,8,["isSweetAlertOpen","title","subtitle","btntext","onCancel"])):S("",!0),h(L,{is:"form",open:p(A),title:"Upload Task File",size:"medium",actions:"right",onClose:t[5]||(t[5]=e=>A.value=!1),onSubmit:T(N,["prevent"])},{content:f((()=>[m("div",ll,[h(K,{class:"column is-12"},{default:f((()=>[h(w,null,{default:f((()=>[y("Start date of task")])),_:1}),h(i,null,{default:f((()=>[h($,{modelValue:p(E),"onUpdate:modelValue":t[3]||(t[3]=e=>_(E)?E.value=e:null),type:"date"},null,8,["modelValue"])])),_:1})])),_:1}),h(K,{class:"column is-12",grouped:""},{default:f((()=>[h(i,null,{default:f((()=>[m("div",tl,[m("label",sl,[m("input",{onChange:W,class:"file-input",type:"file",name:"file",required:""},null,32),il,m("span",nl,j(p(P)?p(P):"Upload any file"),1)])])])),_:1})])),_:1})])])),cancel:f((()=>[h(n,{onClick:t[4]||(t[4]=e=>A.value=!1),raised:""},{default:f((()=>[y("Close")])),_:1})])),action:f((()=>[h(n,{type:"submit",color:"primary",raised:""},{default:f((()=>[y("Upload")])),_:1})])),_:1},8,["open","onSubmit"])],64)}}}),[["__scopeId","data-v-0c7f5f21"]]),rl=e=>(I("data-v-43be88a5"),e=e(),O(),e),cl={class:"personal-dashboard personal-dashboard-v2"},dl={class:"columns is-multiline"},ul={class:"column is-12"},pl={class:"dashboard-header is-relative"},vl={class:"user-meta is-dark-bordered-12"},ml={class:"title is-4 is-narrow is-bold"},hl={class:"light-text"},fl={class:"info-text is-bold"},kl=rl((()=>m("i",{class:"fas fa-home"},null,-1))),gl={class:"user-action"},_l=rl((()=>m("h3",{class:"title is-5 is-narrow"},"Information",-1))),yl={class:"light-text"},bl={class:"light-text"},wl={class:"light-text"},jl={class:"media-flex inverted-text"},Cl=rl((()=>m("a",{class:"link inverted-text"},"Change status",-1))),xl={key:0,class:"tabs-inner"},Sl={class:"tabs is-boxed",slider:""},Dl=[rl((()=>m("span",null,"Project info",-1)))],Al=[rl((()=>m("span",null,"Tasks",-1)))],Tl=rl((()=>m("li",{class:"tab-naver"},null,-1))),Il={key:1,class:"columns is-multiline"},Ol={key:0,class:"column is-8"},Vl={class:"dashboard-card has-margin-bottom"},Ul=["innerHTML"],Pl={class:"dashboard-card has-margin-bottom"},El={class:"dashboard-card"},$l=rl((()=>m("div",{class:"card-head"},[m("h3",{class:"dark-inverted"},"Task Completion"),m("a",{class:"action-link",tabindex:"0"},"Reports")],-1))),Nl={class:"dashboard-card"},Ml={class:"card-head"},Fl=rl((()=>m("h3",{class:"dark-inverted"},"Assigned Manager",-1))),Wl={class:"active-team"},zl={key:0,class:"user-list"},Hl={class:"user-list-info"},Kl={class:"name dark-inverted"},Ll={class:"position"},Rl=rl((()=>m("div",{class:"user-list-icons"},null,-1))),Bl={key:1,class:"user-list"},ql=[rl((()=>m("div",{class:"user-list-info"},[m("div",{class:"name dark-inverted"},"No Manager assigned yet")],-1)))],Yl={key:2},Zl={class:"is-flex space-between"},Jl={key:0},Gl={class:"dashboard-card"},Ql={class:"card-head"},Xl=rl((()=>m("h3",{class:"dark-inverted"},"Client Information",-1))),et={class:"active-team"},at={key:0,class:"user-list"},lt={class:"user-list-info"},tt={class:"name dark-inverted"},st={class:"position"},it=rl((()=>m("div",{class:"user-list-icons"},null,-1))),nt={key:1,class:"user-list"},ot=[rl((()=>m("div",{class:"user-list-info"},[m("div",{class:"name dark-inverted"},"No Client Info Added yet")],-1)))],rt={key:2},ct={class:"dashboard-card"},dt={class:"card-head"},ut=rl((()=>m("h3",{class:"dark-inverted"},"Contractor Information",-1))),pt={class:"active-team"},vt={key:0,class:"user-list"},mt={class:"user-list-info"},ht={class:"name dark-inverted"},ft={class:"position"},kt=rl((()=>m("div",{class:"user-list-icons"},null,-1))),gt={key:1,class:"user-list"},_t=[rl((()=>m("div",{class:"user-list-info"},[m("div",{class:"name dark-inverted"}," No contractor Info Added yet ")],-1)))],yt={key:2},bt={class:"dashboard-card"},wt={key:2,class:"columns is-multiline"},jt={class:"column is-12"},Ct=V(i({__name:"ProjectDetail",setup(e){const a=ie(),l=L(),s=K(),i=P(),o=E(),c=ne(),k=n("detail"),g=n(!1),D=n(!1);n(!1);const A=n(!1);n(!1);const I=n(!1),O=n([]),V=n([]),U=n([]),F=n([]),W=n([]);n(0);const z=n(0),G=n(0),Q=n(""),X=n("");n("");const ee=n([{id:0,username:"",email:"",phoneNumber:""}]),ae=n([]),le=n({id:0,title:"",created:"",startDate:"",color:"",endDate:"",description:"",image:"",is_active:null,status:"",address:"",total_tasks:0,client:0,contractor:0,clientInfo:{id:0,username:"",email:"",password:"",avatar:null},uploaded_files:[],contractorInfo:{id:0,username:"",email:"",password:"",avatar:null},managers:[{id:0,username:"",avatar:null,email:"",role:""}]});n({title:"",description:"",startDate:"",endDate:"",status:"",project:i.params.id,workers:[]});const oe=n([{id:0,title:"",description:"",startDate:"",endDate:"",project:0,status:"",worker:[{id:0,username:"",email:"",role:"",avatar:""}]}]),re=$({height:180,type:"radialBar",series:[],title:{text:""},chart:{toolbar:{show:!1}},colors:[a.primary,a.purple,a.orange],plotOptions:{radialBar:{hollow:{size:"55%"}}},labels:["Progress"]}),ce=$({series:[],chart:{height:295,type:"area",toolbar:{show:!1}},colors:[a.accent,a.info,a.primary],legend:{position:"top"},dataLabels:{enabled:!1},stroke:{width:[2,3,5],curve:"smooth"},xaxis:{type:"date",categories:["2024-11-12","2024-11-13","2024-11-14","2024-11-15","2024-11-16","2024-11-17","2024-11-18","2024-11-19","2024-11-20","2024-11-21","2024-11-22","2024-11-23","2024-11-24","2024-11-25"]},tooltip:{x:{format:"dd/MM/yy HH:mm"}}}),de=()=>{A.value=!A.value},ue=()=>{D.value=!D.value},pe=n(!1),ve=()=>{pe.value=!pe.value};n(0);const me=async()=>{try{g.value=!0;const e=await l.get(`/api/project/${X.value}/`);le.value=e.data;let a=e.data.percentage.toFixed(2);re.value.series.push(a),Q.value=e.data.image,U.value=e.data.managers?e.data.managers:[],fe()}catch(e){console.log(e)}finally{g.value=!1}},he=n([]),fe=async()=>{try{g.value=!0;const e=await l.get(`api/task/${i.params.id}/project/`);oe.value=e.data;const a={pending:[],completed:[],active:[]};oe.value.forEach((e=>{const l=new Date(e.startDate).toISOString().split("T")[0],t=e.status||"Unknown";a[t]||(a[t]=[]);const s=a[t].findIndex((e=>e.date===l));s>-1?a[t][s].count+=1:a[t].push({date:l,count:1})})),ce.value.series=Object.keys(a).map((e=>({name:e,data:a[e].map((e=>e.count))}))),console.log("Task Series Data:",he.value),g.value=!1}catch(e){console.log(e),g.value=!1}},ke=n([]),ge=async()=>{try{le.value.managers=ke.value;let e=H(le.value,["image"]);e.delete("clientInfo"),e.delete("contractorInfo"),"object"==typeof le.value.client&&e.delete("client"),"object"==typeof le.value.contractor&&e.delete("contractor");const a=await l.patch(`/api/project/${i.params.id}/`,e);D.value=!1,A.value=!1,s.green("Project updated successfully"),pe.value=!1,me(a.data.id)}catch(e){console.log(e)}};n("");const _e=e=>{z.value=e},ye=e=>{G.value=e};return r((()=>{X.value=i.params.id,me(),(async()=>{try{I.value=!0;const e=await l.get("/api/users/",{});ee.value=e.data.filter((e=>"worker"==e.role)),O.value=e.data.filter((e=>"client"==e.role)),V.value=e.data.filter((e=>"contractor"==e.role)),F.value=e.data.filter((e=>"manager"==e.role)),W.value=F.value.map((e=>({value:e.id.toString(),name:`${e.username}`,supplier:e.partner?e.partner:"",image:e.avatar}))),console.log("data",ee.value)}catch(e){console.log(e)}finally{I.value=!1}})(),fe(),(async()=>{try{const e=await l.get(`/api/task/today-tasks/?project=${i.params.id}`);ae.value=e.data}catch(e){console.log(e)}})()})),(e,a)=>{const l=te,s=t,n=N("Address"),r=ol,I=J,P=N("Tippy"),E=N("Multiselect"),$=M,F=Z,z=Y,H=B,K=q,L=R,G=Ka;return d(),u("div",cl,[m("div",dl,[m("div",ul,[m("div",pl,["admin"==p(c).user.role||"manager"==p(c).user.role?(d(),v(l,{key:0,style:{position:"absolute",top:"10px","font-size":"18px","font-weight":"600",right:"10px",color:"var(--info)"},class:"cu-pointer",onClick:a[0]||(a[0]=()=>{p(o).push(`/sidebar/dashboard/projects/add-project/?id=${p(le).id}`)}),icon:"lucide:edit"})):S("",!0),h(s,{picture:p(le).image,squared:"",color:"primary",badge:"/images/icons/flags/united-states-of-america.svg",size:"xxl"},null,8,["picture"]),m("div",vl,[m("h3",ml,j(p(le).title?p(le).title:"N/A"),1),m("p",hl,[y(" Current status: "),m("span",fl,j("pending"===p(le).status?"Pre Construction":p(le).status.charAt(0).toUpperCase()+p(le).status.slice(1)),1)]),h(n,null,{default:f((()=>[kl,y(" "+j(p(le).address),1)])),_:1})]),m("div",gl,[_l,m("p",yl," Started at: "+j(p(le)?.startDate?p(le)?.startDate:"N/A"),1),m("p",bl," Expected end: "+j(p(le)?.endDate?p(le)?.endDate:"N/A"),1),m("p",wl," Total jobs: "+j(p(le).total_tasks?p(le).total_tasks:"N/A")+" Tasks ",1)]),m("div",null,[m("div",jl,[p(g)?S("",!0):(d(),v(p(se),{key:0,id:"completion-chart",height:p(re).height,type:p(re).type,series:p(re).series,options:p(re)},null,8,["height","type","series","options"]))]),Cl])])])]),"admin"==p(c).user.role||"manager"==p(c).user.role?(d(),u("div",xl,[m("div",Sl,[m("ul",null,[m("li",{class:b(["detail"===p(k)&&"is-active"])},[m("a",{tabindex:"0",role:"button",onKeydown:a[1]||(a[1]=w(T((e=>k.value="detail"),["prevent"]),["space"])),onClick:a[2]||(a[2]=e=>k.value="detail")},Dl,32)],2),m("li",{class:b(["tasks"===p(k)&&"is-active"])},[m("a",{tabindex:"0",role:"button",onKeydown:a[3]||(a[3]=w(T((e=>k.value="tasks"),["prevent"]),["space"])),onClick:a[4]||(a[4]=e=>k.value="tasks")},Al,32)],2),Tl])])])):S("",!0),"detail"===p(k)?(d(),u("div",Il,["admin"==p(c).user.role||"manager"==p(c).user.role?(d(),u("div",Ol,[m("div",Vl,[m("div",{innerHTML:p(le).description},null,8,Ul)]),m("div",Pl,[h(r,{projectId:p(i).params.id,files:p(le).uploaded_files,"onUpdate:onUploadFile":me},null,8,["projectId","files"])]),m("div",El,[$l,h(p(se),{id:"completion-chart",height:p(ce).chart.height,type:p(ce).chart.type,series:p(ce).series,options:p(ce)},null,8,["height","type","series","options"])])])):S("",!0),m("div",{class:b("admin"==p(c).user.role||"manager"==p(c).user.role?"column is-4":"column is-12")},[m("div",Nl,[m("div",Ml,[Fl,"admin"==p(c).user.role||"manager"==p(c).user.role?(d(),u("a",{key:0,onClick:ve,class:"action-link",tabindex:"0"},j(p(pe)?"Close":"Edit"),1)):S("",!0)]),m("div",Wl,[p(U).length>0?(d(),u("ul",zl,[(d(!0),u(C,null,x(p(U),(e=>(d(),u("li",{key:e.id},[m("div",null,[h(P,{class:"has-help-cursor",interactive:"",offset:[0,10]},{content:f((()=>[h(I,{user:e},null,8,["user"])])),default:f((()=>[h(s,{picture:e.avatar},null,8,["picture"])])),_:2},1024)]),m("div",Hl,[m("div",Kl,j(e.username),1),m("div",Ll,j(e.email),1)]),Rl])))),128))])):(d(),u("ul",Bl,ql)),p(pe)?(d(),u("div",Yl,[h(F,null,{default:f((({id:e})=>[h($,null,{default:f((()=>[h(E,{modelValue:p(ke),"onUpdate:modelValue":a[5]||(a[5]=e=>_(ke)?ke.value=e:null),attrs:{id:e},mode:"tags",placeholder:"Select manager","track-by":"name",label:"name",searchable:!0,"create-tag":!0,options:p(W),"max-height":145},null,8,["modelValue","attrs","options"])])),_:2},1024)])),_:1})])):S("",!0),m("div",Zl,[p(pe)?(d(),u("a",Jl)):S("",!0),p(pe)?(d(),u("a",{key:1,onClick:ge,class:"action-link",tabindex:"0"},"Save ")):S("",!0)])])]),m("div",Gl,[m("div",Ql,[Xl,"admin"==p(c).user.role||"manager"==p(c).user.role?(d(),u("a",{key:0,onClick:ue,class:"action-link",tabindex:"0"},j(p(D)?"Close":"Edit"),1)):S("",!0)]),m("div",et,[p(le).client?(d(),u("ul",at,[m("li",null,[m("div",null,[h(P,{class:"has-help-cursor",interactive:"",offset:[0,10]},{content:f((()=>[h(I,{user:p(le).client},null,8,["user"])])),default:f((()=>[h(s,{picture:p(le).client.avatar},null,8,["picture"])])),_:1})]),m("div",lt,[m("div",tt,j(p(le).client.username),1),m("div",st,j(p(le).client.email),1)]),it])])):(d(),u("ul",nt,ot)),p(D)?(d(),u("div",rt,[h(F,null,{default:f((()=>[h(z,null,{default:f((()=>[y("Select client")])),_:1}),h($,null,{default:f((()=>[h(K,{modelValue:p(le).client,"onUpdate:modelValue":a[6]||(a[6]=e=>p(le).client=e),onChange:ge},{default:f((()=>[h(H,{value:""},{default:f((()=>[y(" Clients ")])),_:1}),(d(!0),u(C,null,x(p(O),(e=>(d(),v(H,{key:e.id,value:e.id},{default:f((()=>[y(j(e.username),1)])),_:2},1032,["value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1})])):S("",!0)])]),m("div",ct,[m("div",dt,[ut,"admin"==p(c).user.role||"manager"==p(c).user.role?(d(),u("a",{key:0,onClick:de,class:"action-link",tabindex:"0"},j(p(A)?"Close":"Edit"),1)):S("",!0)]),m("div",pt,[p(le).contractor?(d(),u("ul",vt,[m("li",null,[m("div",null,[h(P,{class:"has-help-cursor",interactive:"",offset:[0,10]},{content:f((()=>[h(I,{user:p(le).contractor},null,8,["user"])])),default:f((()=>[h(s,{picture:p(le).contractor.avatar},null,8,["picture"])])),_:1})]),m("div",mt,[m("div",ht,j(p(le).contractor.username),1),m("div",ft,j(p(le).contractor.email),1)]),kt])])):(d(),u("ul",gt,_t)),p(A)?(d(),u("div",yt,[h(F,null,{default:f((()=>[h(z,null,{default:f((()=>[y("Select contractor")])),_:1}),h($,null,{default:f((()=>[h(K,{modelValue:p(le).contractor,"onUpdate:modelValue":a[7]||(a[7]=e=>p(le).contractor=e),onChange:ge},{default:f((()=>[(d(!0),u(C,null,x(p(V),(e=>(d(),v(H,{key:e.id,value:e.id},{default:f((()=>[y(j(e.username),1)])),_:2},1032,["value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1})])):S("",!0)])]),m("div",bt,[h(L,{projectId:p(i).params.id},null,8,["projectId"])])],2)])):S("",!0),"tasks"===p(k)?(d(),u("div",wt,[m("div",jt,[h(G,{"onUpdate:completedTasks":_e,"onUpdate:activeTasks":ye,projectID:p(i).params.id},null,8,["projectID"])])])):S("",!0)])}}}),[["__scopeId","data-v-43be88a5"]]);export{Ct as _};
