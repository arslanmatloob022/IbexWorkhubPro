import{_ as e}from"./ProposalViewModal.vue_vue_type_style_index_0_lang-2f0e95a7.js";import{_ as a}from"./SweetAlert.vue_vue_type_style_index_0_lang-870e2962.js";import{_ as l}from"./LeadAddUpdateModal.vue_vue_type_style_index_0_lang-d9913069.js";import{_ as t}from"./VFlexPagination.vue_vue_type_script_setup_true_lang-0db7eee4.js";import{_ as s,c as n}from"./VFlexTable.vue_vue_type_style_index_0_lang-ab2107af.js";import{_ as i}from"./VDropdown.vue_vue_type_style_index_0_lang-85a7cc4a.js";import{_ as o}from"./VAvatar.vue_vue_type_style_index_0_lang-63e4eba4.js";import{_ as r}from"./VTag.vue_vue_type_style_index_0_lang-1252130e.js";import{_ as u}from"./VPlaceholderPage.vue_vue_type_style_index_0_lang-9dfe867b.js";import{f as d,r as c,x as p,$ as _,o as m,av as v,C as f,D as y,m as g,O as b,E as h,F as j,G as k,L as x,X as w,k as C,K as V,V as A,W as S,N as L,aS as I,P,al as O,U,J as $,A as M}from"./index-3fb2b8a1.js";import{_ as T,a as D}from"./VOption.vue_vue_type_style_index_0_lang-f6b7c5e9.js";import{_ as N}from"./VField.vue_vue_type_script_setup_true_lang-3f4a6a92.js";import{_ as F}from"./VControl-a26a7847.js";import{_ as E}from"./PlaceloadV1.vue_vue_type_style_index_0_lang-60b84e36.js";import{_ as J,a as R}from"./search-4-dark-2b5b440c.js";import{u as W}from"./useAPI-a06e0453.js";import{u as H}from"./useNotyf-3e0fbfcf.js";import{f as K,g as Z}from"./useSupportElement-8776fb44.js";import{g as q,f as z}from"./estimatesScripts-b610ab56.js";import{u as B}from"./viewWrapper-4501df4a.js";import{b as X}from"./route-block-83d24a4e.js";import"./VModal.vue_vue_type_style_index_0_lang-ae227fef.js";import"./VRadio.vue_vue_type_style_index_0_lang-413bf461.js";import"./VLabel.vue_vue_type_script_setup_true_lang-7778ff4d.js";import"./useVFieldContext-e649f23b.js";import"./CreateProposalTasksModal-5f9a649f.js";import"./UnitAddUpdateModal.vue_vue_type_script_setup_true_lang-b7dba443.js";import"./VTextarea.vue_vue_type_script_setup_true_lang-a474c4e3.js";import"./VCheckbox.vue_vue_type_style_index_0_lang-6c141f45.js";import"./VInput.vue_vue_type_script_setup_true_lang-510b5602.js";import"./costItems-f8598266.js";import"./VIconButton-7fb21a7b.js";import"./company-538b21c5.js";import"./V-Snack.vue_vue_type_style_index_0_lang-c445f681.js";import"./VIcon.vue_vue_type_script_setup_true_lang-7ff8429d.js";import"./LeadProposalsList.vue_vue_type_style_index_0_lang-67b46358.js";import"./VSwitchBlock.vue_vue_type_style_index_0_lang-d5c3f3ad.js";import"./ScheduleEmailModal.vue_vue_type_script_setup_true_lang-731349f0.js";import"./ckeditor-6dd13c36.js";import"./vue.runtime.esm-bundler-e15f2500.js";import"./ckeditor-faa62281.js";import"./VFlex.vue_vue_type_style_index_0_lang-4730dcc4.js";import"./useDropdown-0b00ef01.js";import"./VPlaceloadWrap-456ede63.js";import"./VPlaceloadText.vue_vue_type_style_index_0_lang-4dfbc07a.js";import"./VPlaceloadAvatar.vue_vue_type_style_index_0_lang-41114990.js";import"./notyf-c68bb5fc.js";import"./useThemeColors-8b0ae05c.js";const G={key:1},Q={class:"list-flex-toolbar flex-list-v1"},Y={class:"page-content-inner"},ee={class:"flex-list-wrapper flex-list-v1"},ae=h("img",{class:"light-image",src:J,alt:""},null,-1),le=h("img",{class:"dark-image",src:R,alt:""},null,-1),te={class:"item-name dark-inverted show-text-200"},se={class:"item-meta show-text-200"},ne={key:0},ie={class:"item-name dark-inverted"},oe={class:"item-meta"},re={key:1},ue={class:"item-name dark-inverted"},de={class:"item-meta"},ce={class:"item-name"},pe={class:"item-meta"},_e=["onClick"],me=[h("div",{class:"icon"},[h("i",{"aria-hidden":"true",class:"lnil lnil-eye"})],-1),h("div",{class:"meta"},[h("span",null,"View"),h("span",null,"View user details")],-1)],ve=["onClick"],fe=[h("div",{class:"icon"},[h("i",{class:"lnil lnil-copy","aria-hidden":"true"})],-1),h("div",{class:"meta"},[h("span",null,"Add Proposals"),h("span",null,"Add new proposal to lead")],-1)],ye=["onClick"],ge=[h("div",{class:"icon"},[h("i",{"aria-hidden":"true",class:"lnil lnil-pencil"})],-1),h("div",{class:"meta"},[h("span",null,"Edit"),h("span",null,"Update Lead Info")],-1)],be=h("hr",{class:"dropdown-divider"},null,-1),he=["onClick"],je=[h("div",{class:"icon"},[h("i",{class:"lnil lnil-checkmark","aria-hidden":"true"})],-1),h("div",{class:"meta"},[h("span",null,"Mark As Done"),h("span",null,"Mark Job As Completed")],-1)],ke=["onClick"],xe=[h("div",{class:"icon"},[h("i",{"aria-hidden":"true",class:"lnil lnil-trash-can-alt"})],-1),h("div",{class:"meta"},[h("span",null,"Delete"),h("span",null,"Delete Proposal Permanently")],-1)],we=d({__name:"LeadsList",setup(d){const M=c(""),J=p(),R=H(),B=W(),X=c(),we=c({id:"54985a54-db61-4761-becd-3b35f8ec503e",sales_people_info:[],clientInfo:null,created_by_info:null,manager_info:null,title:"test job",address:null,current_state:"lead",city:null,state:null,status:null,zip_code:null,confidence:"0.00",sale_date:null,tags:[],estimated_from:null,estimated_to:null,sources:null,project_type:null,notes:null,attach_mail:null,created:"2025-01-15T19:55:18.448485Z",updated_at:"2025-01-15T19:55:18.448510Z",created_by:null,manager:null,client:null,sales_people:[]}),Ce=c(42),Ve=c(""),Ae=c(""),Se=c(!1),Le=c(!1),Ie=c([{value:"open",label:"Open"},{value:"sold",label:"Sold"},{value:"lost",label:"Lost"},{value:"onHold",label:"On hold"}]),Pe={location:{label:"Job",grow:!0},username:{label:"Contractor/Client",grow:!0},contacts:"Date Created",status:"Lead Status",industry:"Manager",actions:{label:"Actions",align:"end"}},Oe=async()=>{try{X.value=!0;const e=await B.get("/api/project/project-leads/");we.value=e.data}catch(e){R.error(` ${e}, Lead`)}finally{X.value=!1}},Ue=e=>{M.value=e,Le.value=!0},$e=c({title:"",subtitle:"test",isSweetAlertOpen:!1,btntext:"text"}),Me=c(!1),Te=async()=>{try{X.value=!0;await B.delete(`/api/project/${M.value}/`);R.info("Lead deleted successfully"),Oe()}catch(e){R.error(` ${e}, Lead`),R.error("Something went wrong please try later")}finally{X.value=!1,$e.value.isSweetAlertOpen=!1}},De=_((()=>{if(Ve.value){const e=new RegExp(Ve.value,"i");return we.value.filter((a=>a.title?.match(e)||a.address?.match(e)||a.clientInfo?.username?.match(e)||a.clientInfo?.last_name?.match(e)||a.clientInfo?.username?.match(e)||a.city?.match(e)||a.created?.match(e)))}return we.value})),Ne=_((()=>Ae.value?De.value?.filter((e=>e.leadStatus==Ae.value)):De.value));return m((()=>{Oe()})),(d,c)=>{const p=E,_=F,m=N,W=T,H=D,we=P,De=O,Fe=u,Ee=n,Je=r,Re=o,We=i,He=s,Ke=t,Ze=l,qe=a,ze=e,Be=v("tooltip");return f(),y("div",null,[g(X)?(f(),b(p,{key:0})):(f(),y("div",G,[h("div",Q,[j(m,null,{default:k((()=>[j(_,{icon:"feather:search"},{default:k((()=>[x(h("input",{"onUpdate:modelValue":c[0]||(c[0]=e=>C(Ve)?Ve.value=e:null),class:"input custom-text-filter",placeholder:"Search..."},null,512),[[w,g(Ve)]])])),_:1})])),_:1}),j(m,null,{default:k((()=>[j(_,{class:"has-icons-left",icon:"fas fa-globe"},{default:k((()=>[j(H,{modelValue:g(Ae),"onUpdate:modelValue":c[1]||(c[1]=e=>C(Ae)?Ae.value=e:null)},{default:k((()=>[j(W,{value:""},{default:k((()=>[V(" All ")])),_:1}),(f(!0),y(A,null,S(g(Ie),(e=>(f(),b(W,{value:e.value},{default:k((()=>[V(U(e.label),1)])),_:2},1032,["value"])))),256))])),_:1},8,["modelValue"])])),_:1})])),_:1}),j(De,null,{default:k((()=>[j(we,{onClick:c[2]||(c[2]=e=>Ue("")),color:"primary",icon:"fas fa-plus",elevated:""},{default:k((()=>[V(" Lead Opportunity ")])),_:1})])),_:1})]),h("div",Y,[h("div",ee,[g(Ne)?.length?L("",!0):(f(),b(Fe,{key:0,title:"We couldn't find any matching results.",subtitle:"Too bad. Looks like we couldn't find any matching results for the\n          search terms you've entered. Please try different search terms or\n          criteria.",larger:""},{image:k((()=>[ae,le])),_:1})),g(Ne)?.length?(f(),b(He,{key:1,data:g(Ne),columns:Pe,compact:""},{body:k((()=>[j(I,{name:"list",tag:"div",class:"flex-list-inner"},{default:k((()=>[(f(!0),y(A,null,S(g(Ne),(e=>(f(),y("div",{key:e.id,class:"flex-table-item"},[j(Ee,{onClick:()=>{g(J).push(`/sidebar/dashboard/jobs/${e.id}`)},class:"cu-pointer",column:{media:!0,grow:!0}},{default:k((()=>[h("div",null,[h("span",te,U(e.title?e.title:"N/A"),1),h("span",se,[h("span",null,U(e.address?e.address:"N/A"),1)])])])),_:2},1032,["onClick"]),j(Ee,{onClick:()=>{g(J).push(`/sidebar/dashboard/jobs/${e.id}`)},class:"cu-pointer",column:{media:!0,grow:!0}},{default:k((()=>[e.clientInfo?(f(),y("div",ne,[h("span",ie,U(e.clientInfo?.username?e.clientInfo?.username:"N/A"),1),h("span",oe,[h("span",null,U(e.clientInfo?.email?e.clientInfo?.email:"N/A"),1)])])):e.contractor_info?(f(),y("div",re,[h("span",ue,U(e.contractor_info?.username?e.contractor_info?.username:"N/A"),1),h("span",de,[h("span",null,U(e.contractor_info?.email?e.contractor_info?.email:"N/A"),1)])])):L("",!0)])),_:2},1032,["onClick"]),j(Ee,{onClick:()=>{g(J).push(`/sidebar/dashboard/jobs/${e.id}`)},class:"cu-pointer",column:{media:!0}},{default:k((()=>[h("div",null,[h("span",ce,U(g(K)(e.created)),1),h("span",pe,[h("span",null,"At:"+U(g(Z)(e.created)),1)])])])),_:2},1032,["onClick"]),j(Ee,{onClick:()=>{g(J).push(`/sidebar/dashboard/jobs/${e.id}`)},class:"cu-pointer"},{default:k((()=>[j(Je,{color:g(q)[e.leadStatus],rounded:""},{default:k((()=>[V(U(g(z)[e.leadStatus]),1)])),_:2},1032,["color"])])),_:2},1032,["onClick"]),j(Ee,{onClick:()=>{g(J).push(`/sidebar/dashboard/jobs/${e.id}`)},class:"cu-pointer",column:{media:!0}},{default:k((()=>[h("div",null,[(f(!0),y(A,null,S(e.managers_list,(e=>x((f(),b(Re,{initials:e.username.slice(0,2),picture:e.avatar,color:"primary",size:"small"},null,8,["initials","picture"])),[[Be,`${e.username} ${e.last_name??""}`,void 0,{center:!0,primary:!0,rounded:!0}]]))),256))])])),_:2},1032,["onClick"]),j(Ee,{column:{align:"end"}},{default:k((()=>[j(We,{icon:"feather:more-vertical",class:"is-pushed-mobile",spaced:"",right:""},{content:k((({close:a})=>[h("a",{role:"menuitem",class:"dropdown-item is-media",onClick:()=>{g(J).push(`/sidebar/dashboard/jobs/${e.id}`)}},me,8,_e),h("a",{role:"menuitem",onClick:a=>{return l=e.id,M.value=l,void(Se.value=!Se.value);var l},class:"dropdown-item is-media"},fe,8,ve),h("a",{role:"menuitem",class:"dropdown-item is-media",onClick:$((a=>Ue(e.id)),["prevent"])},ge,8,ye),be,h("a",{role:"menuitem",onClick:a=>(async(e="")=>{try{Me.value=!0,await B.patch(`/api/project/${e}/`,{status:"completed"}),R.success("Jobs Completed Successfully."),Oe()}catch(a){console.log(a)}finally{Me.value=!1}})(e.id),class:"dropdown-item is-media"},je,8,he),h("a",{role:"menuitem",class:"dropdown-item is-media",onClick:$((a=>{return l=e.id,M.value=l,void($e.value={title:"Delete Lead?",subtitle:"Are you sure to delete this Lead? After delete you will not be able to recover it again.",btntext:"Delete",isSweetAlertOpen:!0});var l}),["prevent"])},xe,8,ke)])),_:2},1024)])),_:2},1024)])))),128))])),_:1})])),_:1},8,["data"])):L("",!0),g(Ne)?.length>5?(f(),b(Ke,{key:2,"current-page":g(Ce),"onUpdate:currentPage":c[3]||(c[3]=e=>C(Ce)?Ce.value=e:null),"item-per-page":10,"total-items":80,"max-links-displayed":7,"no-router":""},null,8,["current-page"])):L("",!0)])])])),g(Le)?(f(),b(Ze,{key:2,addUpdateLeadModal:g(Le),leadId:g(M),"onUpdate:modalHandler":c[4]||(c[4]=e=>Le.value=!1),"onUpdate:OnSuccess":Oe},null,8,["addUpdateLeadModal","leadId"])):L("",!0),g($e).isSweetAlertOpen?(f(),b(qe,{key:3,isSweetAlertOpen:g($e).isSweetAlertOpen,title:g($e).title,subtitle:g($e).subtitle,loading:g(X),btntext:g($e).btntext,onConfirm:Te,onCancel:()=>g($e).isSweetAlertOpen=!1},null,8,["isSweetAlertOpen","title","subtitle","loading","btntext","onCancel"])):L("",!0),g(Se)?(f(),b(ze,{key:4,"lead-proposal-modal":g(Se),"lead-id":g(M),"onUpdate:modalHandler":c[5]||(c[5]=e=>Se.value=!1),"onUpdate:OnSuccess":Oe},null,8,["lead-proposal-modal","lead-id"])):L("",!0)])}}}),Ce=d({__name:"index",setup:e=>(B().setPageTitle("Leads"),M({title:"Leads - Ibex"}),(e,a)=>{const l=we;return f(),y("div",null,[j(l)])})});"function"==typeof X&&X(Ce);export{Ce as default};
