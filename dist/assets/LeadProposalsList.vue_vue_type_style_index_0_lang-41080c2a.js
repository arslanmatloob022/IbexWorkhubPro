import{_ as e}from"./VModal.vue_vue_type_style_index_0_lang-aa53c266.js";import{_ as l}from"./VFlexPagination.vue_vue_type_script_setup_true_lang-4ab60d1d.js";import{_ as a,c as t}from"./VFlexTable.vue_vue_type_style_index_0_lang-5af3c304.js";import{_ as s}from"./VCheckbox.vue_vue_type_style_index_0_lang-d51d6aea.js";import{_ as o}from"./VTag.vue_vue_type_style_index_0_lang-2c85544e.js";import{_ as n}from"./VPlaceholderPage.vue_vue_type_style_index_0_lang-71bad0fb.js";import{e as i,s as r,r as d,b as u,_ as p,o as c,i as m,B as v,N as _,F as f,D as y,H as g,l as b,G as h,C as w,K as x,W as k,E as P,M as I,J as V,T as C,I as j,O as T,Z as S,j as A,U as q,V as U,aR as D,P as O,Q as M,R as L,v as $,x as H}from"./index-bd02fd97.js";import{_ as E}from"./VField.vue_vue_type_script_setup_true_lang-0ce07994.js";import{_ as R}from"./VControl-14860196.js";import{_ as W}from"./VRadio.vue_vue_type_style_index_0_lang-f3342fe5.js";import{_ as B,a as F}from"./search-4-dark-2b5b440c.js";import{_ as N,a as z}from"./projects-dark-4a371d8a.js";import{u as G}from"./useAPI-5821d9f5.js";import{a as J,e as K,g as Z}from"./useSupportElement-d56c346c.js";import{_ as Q}from"./SweetAlert.vue_vue_type_style_index_0_lang-46b7b901.js";import{u as Y,s as X,_ as ee,a as le}from"./WorksheetItems.vue_vue_type_script_setup_true_lang-bf156fc1.js";import{_ as ae}from"./VAvatar.vue_vue_type_style_index_0_lang-e9763bc9.js";import{c as te}from"./proposalItems-421c183f.js";import{_ as se}from"./VTextarea.vue_vue_type_script_setup_true_lang-82b79b6d.js";import{u as oe}from"./useNotyf-a8509ab6.js";import{u as ne}from"./userSession-87a2ed4a.js";import{_ as ie}from"./VDropdown.vue_vue_type_style_index_0_lang-8db773c0.js";import{_ as re}from"./PlaceloadV1.vue_vue_type_style_index_0_lang-e7df3645.js";const de={class:"modal-form columns is-multiline"},ue={class:"tabs-wrapper column is-12 m-0"},pe={class:"tabs-inner"},ce={class:"tabs is-boxed"},me=[y("span",null,"Proposal",-1)],ve=["disabled"],_e=[y("span",null,"Worksheet",-1)],fe={key:0,class:"column is-12"},ye={class:"columns is-multiline"},ge={class:"field column is-6 mb-0"},be=y("label",null,"Title: *",-1),he={class:"control"},we={class:"column is-6"},xe={class:"field column is-6"},ke=y("label",null,"Approval Deadline *",-1),Pe={class:"control"},Ie={class:"field column is-6"},Ve=y("label",null,"Attachments",-1),Ce=y("div",{class:"file"},[y("label",{class:"file-label"},[y("input",{class:"file-input",type:"file",name:"resume"}),y("span",{class:"file-cta"},[y("span",{class:"file-icon"},[y("i",{class:"fas fa-cloud-upload-alt"})]),y("span",{class:"file-label"}," Choose a fileâ€¦ ")])])],-1),je={class:"column is-12"},Te={class:"body-inner-content columns is-multiline"},Se={class:"field column is-12"},Ae=y("label",{for:"",class:"label"},"Internal Notes",-1),qe={class:"field column is-12 mb-0"},Ue=y("label",{for:"",class:"label"},"Introductory Text",-1),De={class:"field column is-12 mb-0"},Oe=y("label",{for:"",class:"label"},"Closing Text",-1),Me={class:"column is-12"},Le={key:0,class:"columns is-multiline"},$e=i({__name:"LeadProposalModal",props:{leadProposalModal:{type:Boolean},proposalId:{},leadId:{}},emits:["update:modalHandler","update:OnSuccess","clearProposalId"],setup(l,{emit:a}){const t=l;Y();const s=r();ne();const o=oe(),n=G(),i=d(!1);d({}),d("");const S=d("general"),A=d({id:"",title:"",approval_deadline:"",internal_notes:"",introductory_text:null,closing_text:null,payment_status:"",worksheetItems:[],type:"proposal",job:"",attachments:[],columns_to_show:[],status:"",created_at:"",updated_at:""}),q=async(e=!0)=>{try{if(i.value=!0,!A.value.title&&!e)return;t.leadId&&(A.value.job=t.leadId),A.value.columns_to_show=JSON.stringify(X.value);const l=J(A.value,[]);if(t.proposalId||A.value.id){const e=await n.patch(`/api/lead-proposal/${t.proposalId?t.proposalId:A.value.id}/`,l);A.value=e.data}else{const e=await n.post("/api/lead-proposal/",l);A.value=e.data}D(),e&&o.success(`Proposal ${t.proposalId||A.value.id?"updated":"created"} successfully`)}catch(l){o.error("Something went wrong, try again")}finally{i.value=!1}},U=()=>{a("update:modalHandler",!1)},D=()=>{a("update:OnSuccess",null)},O=u((()=>p((()=>import("./ckeditor-77248636.js").then((e=>e.c))),["assets/ckeditor-77248636.js","assets/index-bd02fd97.js","assets/index-ce8747cd.css","assets/vue.runtime.esm-bundler-823f2db1.js"]).then((e=>e.default.component)))),M={fontFamily:{options:['"Montserrat", sans-serif','"Roboto", sans-serif']},height:"400px",minHeight:"400px"};return c((async()=>{s.value=await p((()=>import("./ckeditor-8c2617fd.js").then((e=>e.c))),["assets/ckeditor-8c2617fd.js","assets/index-bd02fd97.js","assets/index-ce8747cd.css"]).then((e=>e.default)),t.proposalId&&(async()=>{try{const e=await n.get(`/api/lead-proposal/${t.proposalId}/`);A.value=e.data,X.value=e.data.columns_to_show}catch(e){console.log(e)}})()})),m((()=>{a("clearProposalId",null),A.value={}})),(l,a)=>{const o=W,n=R,r=E,d=se,u=ee,p=T,c=e;return v(),_(c,{is:"form",open:t.leadProposalModal,title:"Lead Proposal",size:"xl",actions:"right",onSubmit:j(q,["prevent"]),onClose:U},{content:f((()=>[y("div",de,[y("div",ue,[y("div",pe,[y("div",ce,[y("ul",null,[y("li",{class:g(["general"===b(S)?"is-active":"not-active"])},[y("a",{tabindex:"0",role:"button",onKeydown:a[0]||(a[0]=h(j((e=>S.value="general"),["prevent"]),["space"])),onClick:a[1]||(a[1]=e=>S.value="general")},me,32)],2),y("li",{class:g(["CostWorksheet"===b(S)?"is-active":"not-active"])},[y("a",{tabindex:"0",role:"button",disabled:!!b(A).title,onKeydown:a[2]||(a[2]=h(j((e=>S.value="CostWorksheet"),["prevent"]),["space"])),onClick:a[3]||(a[3]=()=>{S.value="CostWorksheet",q(!1)})},_e,40,ve)],2)])])])]),"general"==b(S)?(v(),w("div",fe,[y("div",ye,[y("div",ge,[be,y("div",he,[x(y("input",{type:"text",name:"title","onUpdate:modelValue":a[4]||(a[4]=e=>b(A).title=e),required:"",class:"input is-primary-focus is-primary-focus",placeholder:"Proposal Title"},null,512),[[k,b(A).title]])])]),y("div",we,[P(r,{class:"m-0 p-0",label:"Type"},{default:f((()=>[P(n,null,{default:f((()=>[P(o,{modelValue:b(A).type,"onUpdate:modelValue":a[5]||(a[5]=e=>b(A).type=e),value:"proposal",label:"Proposal",name:"solid_squared_radio",color:"primary",square:"",solid:""},null,8,["modelValue"]),P(o,{modelValue:b(A).type,"onUpdate:modelValue":a[6]||(a[6]=e=>b(A).type=e),value:"change_order",label:"Change Order",name:"solid_squared_radio",color:"info",square:"",solid:""},null,8,["modelValue"]),P(o,{modelValue:b(A).type,"onUpdate:modelValue":a[7]||(a[7]=e=>b(A).type=e),value:"draft",label:"Draft",name:"solid_squared_radio",color:"warning",square:"",solid:""},null,8,["modelValue"])])),_:1})])),_:1})]),y("div",xe,[ke,y("div",Pe,[x(y("input",{type:"date",name:"firstName","onUpdate:modelValue":a[8]||(a[8]=e=>b(A).approval_deadline=e),required:"",class:"input is-primary-focus is-primary-focus",placeholder:"Proposal Approval deadline"},null,512),[[k,b(A).approval_deadline]])])]),y("div",Ie,[Ve,P(r,{grouped:""},{default:f((()=>[P(n,null,{default:f((()=>[Ce])),_:1})])),_:1})]),y("div",je,[y("div",Te,[y("div",Se,[Ae,P(r,null,{default:f((()=>[P(n,null,{default:f((()=>[P(d,{modelValue:b(A).internal_notes,"onUpdate:modelValue":a[9]||(a[9]=e=>b(A).internal_notes=e),rows:"4",placeholder:"Internal notes..."},null,8,["modelValue"])])),_:1})])),_:1})]),y("div",qe,[Ue,b(s)?(v(),_(b(O),{key:0,modelValue:b(A).introductory_text,"onUpdate:modelValue":a[10]||(a[10]=e=>b(A).introductory_text=e),editor:b(s),config:M},null,8,["modelValue","editor"])):I("",!0)]),y("div",De,[Oe,b(s)?(v(),_(b(O),{key:0,modelValue:b(A).closing_text,"onUpdate:modelValue":a[11]||(a[11]=e=>b(A).closing_text=e),editor:b(s),config:M},null,8,["modelValue","editor"])):I("",!0)])])])])])):I("",!0),y("div",Me,["CostWorksheet"==b(S)?(v(),w("div",Le,[P(u,{proposalId:b(A).id?b(A).id:t.proposalId,proposalData:b(A)},null,8,["proposalId","proposalData"])])):I("",!0)])])])),action:f((()=>[P(p,{loading:b(i),type:"submit",color:"primary",raised:""},{default:f((()=>[V(C(t.proposalId?"Update Proposal":"Create Proposal"),1)])),_:1},8,["loading"])])),cancel:f((()=>[P(p,{onClick:a[12]||(a[12]=e=>U()),raised:""},{default:f((()=>[V("Close")])),_:1})])),_:1},8,["open","onSubmit"])}}}),He=e=>(O("data-v-49fc098e"),e=e(),M(),e),Ee={class:"columns is-multiline"},Re={class:"column is-12 is-flex space-between"},We={class:"column is-12"},Be={class:"flex-list-wrapper flex-list-v2"},Fe=He((()=>y("img",{class:"light-image",src:B,alt:""},null,-1))),Ne=He((()=>y("img",{class:"dark-image",src:F,alt:""},null,-1))),ze={key:1,class:"tab-content is-active"},Ge={class:"item-name dark-inverted"},Je={class:"item-meta"},Ke={class:"light-text"},Ze={key:2,class:"tab-content is-active"},Qe=He((()=>y("img",{class:"light-image is-larger",src:N,alt:""},null,-1))),Ye=He((()=>y("img",{class:"dark-image is-larger",src:z,alt:""},null,-1))),Xe=L(i({__name:"ProposalGroupModal",props:{groupProposalModal:{type:Boolean},leadID:{default:""}},emits:["update:modalHandler","update:OnSuccess"],setup(i,{emit:r}){const u=i,p=d([{id:"",proposalAmount:0,title:"",approval_deadline:"",internal_notes:"",introductory_text:"",closing_text:"",payment_status:"",type:"",status:"",created_at:"",updated_at:"",job:""}]),m=d("combine"),g=d(!1),h=d("active"),x=G(),k=d(""),j={picture:{label:"Proposal",grow:!0,media:!0},customer:"Type",industry:"Amount",status:"Status",team:{label:"Payment"},actions:{label:"Select",align:"end"}},O=S((()=>{if(k.value){const e=new RegExp(k.value,"i");return p.value.filter((l=>l.title.match(e)||l.description.match(e)))}return p.value})),M=()=>{r("update:modalHandler",!1)};return c((()=>{(async()=>{try{g.value=!0;const e=await x.get(`/api/lead-proposal/by-job/${u.leadID}/`);p.value=e.data}catch(e){console.log(e)}finally{g.value=!1}})()})),(i,r)=>{const d=W,p=R,c=E,x=T,k=n,S=t,L=o,$=s,H=a,B=l,F=e;return v(),_(F,{is:"form",open:u.groupProposalModal,title:"Group Proposal",size:"xl",actions:"right",onClose:M},{content:f((()=>[y("div",Ee,[y("div",Re,[P(c,null,{default:f((()=>[P(p,null,{default:f((()=>[P(d,{modelValue:b(m),"onUpdate:modelValue":r[0]||(r[0]=e=>A(m)?m.value=e:null),value:"combine",label:"Combine Proposals",name:"outlined_squared_radio",color:"warning",square:""},null,8,["modelValue"]),P(d,{modelValue:b(m),"onUpdate:modelValue":r[1]||(r[1]=e=>A(m)?m.value=e:null),value:"trade",label:"Trade Proposal",name:"outlined_squared_radio",color:"primary",square:""},null,8,["modelValue"]),P(d,{modelValue:b(m),"onUpdate:modelValue":r[2]||(r[2]=e=>A(m)?m.value=e:null),value:"summary",label:"Summary Proposal",name:"outlined_squared_radio",color:"info",square:""},null,8,["modelValue"]),P(d,{modelValue:b(m),"onUpdate:modelValue":r[3]||(r[3]=e=>A(m)?m.value=e:null),value:"report",label:"Report",name:"outlined_squared_radio",color:"success",square:""},null,8,["modelValue"])])),_:1})])),_:1}),P(x,{color:"warning",size:"small"},{default:f((()=>[V(" Merge ")])),_:1})]),y("div",We,[y("div",Be,["active"===b(h)&&0===b(O).length?(v(),_(k,{key:0,title:"We couldn't find any matching results.",subtitle:"Too bad. Looks like we couldn't find any matching results for the\n          search terms you've entered. Please try different search terms or\n          criteria.",larger:""},{image:f((()=>[Fe,Ne])),_:1})):I("",!0),"active"===b(h)?(v(),w("div",ze,[b(O).length?(v(),_(H,{key:0,data:b(O),columns:j,rounded:""},{body:f((()=>[P(D,{name:"list",tag:"div",class:"flex-list-inner"},{default:f((()=>[(v(!0),w(q,null,U(b(O),(e=>(v(),w("div",{key:e.id,class:"flex-table-item"},[P(S,{column:{media:!0,grow:!0}},{default:f((()=>[y("div",null,[y("span",Ge,C(e.title??"N/A"),1),y("span",Je,[y("span",null,C(b(K)(e.created_at)),1)])])])),_:2},1024),P(S,null,{default:f((()=>[P(L,null,{default:f((()=>[V(C(e.type),1)])),_:2},1024)])),_:2},1024),P(S,null,{default:f((()=>[y("span",Ke,"$"+C(e.proposalAmount),1)])),_:2},1024),P(S,null,{default:f((()=>[P(L,{rounded:""},{default:f((()=>[V(C(e.status),1)])),_:2},1024)])),_:2},1024),P(S,null,{default:f((()=>[P(L,{rounded:""},{default:f((()=>[V(C(e.status),1)])),_:2},1024)])),_:2},1024),P(S,{column:{align:"end"}},{default:f((()=>[P(p,{raw:"",subcontrol:""},{default:f((()=>[P($,{modelValue:e.payment_status,"onUpdate:modelValue":l=>e.payment_status=l,label:"",color:"primary"},null,8,["modelValue","onUpdate:modelValue"])])),_:2},1024)])),_:2},1024)])))),128))])),_:1})])),_:1},8,["data"])):I("",!0),b(O).length>5?(v(),_(B,{key:1,"item-per-page":10,"total-items":873,"current-page":42,"max-links-displayed":7})):I("",!0)])):"closed"===b(h)?(v(),w("div",Ze,[P(k,{title:"No closed projects.",subtitle:"Looks like you don't have any closed project yet. When you'll\n              start closing off projects, they will be showing up in here."},{image:f((()=>[Qe,Ye])),_:1})])):I("",!0)])])])])),action:f((()=>[P(x,{loading:b(g),type:"submit",color:"warning",raised:"",onClick:M},{default:f((()=>[V("Close")])),_:1},8,["loading"])])),_:1},8,["open"])}}}),[["__scopeId","data-v-49fc098e"]]),el={class:"columns is-multiline"},ll={class:"column is-12"},al={class:"invoice-wrapper"},tl=y("div",{class:"invoice-header"},[y("div",{class:"left"},[y("h3",null,"Proposal-ID PD-456-14")]),y("div",{class:"right"},[y("div",{class:"controls"},[y("a",{class:"action"},[y("i",{"aria-hidden":"true",class:"iconify","data-icon":"feather:printer"})]),y("a",{class:"action"},[y("i",{"aria-hidden":"true",class:"iconify","data-icon":"feather:download-cloud"})]),y("a",{class:"action"},[y("i",{"aria-hidden":"true",class:"iconify","data-icon":"feather:mail"})])])])],-1),sl={class:"invoice-body"},ol={class:"invoice-card"},nl={class:"invoice-section is-flex is-bordered"},il=y("div",{class:"meta"},null,-1),rl=y("div",{class:"end"},[y("span",null,"PO Box 242"),y("span",null,"Evergreen, CO 80437-0242"),y("span",null,"Phone: 720 272-9061"),y("span",null,"Premium Trades for Premier Builders")],-1),dl=y("div",{class:"invoice-section is-flex is-bordered"},[y("div",{class:"meta"},[y("h3",null,"Client Name"),y("span",null,"Client Phone"),y("span",null,"25724 Independence Trail Evergreen, CO 80439")]),y("div",{class:"end is-left"},[y("h3",null,"Friday Jan 17, 2025"),y("p",null," Lorem ipsum dolor sit amet, consectetur adipiscing elit. Quod equidem non reprehendo. ")])],-1),ul={key:0,class:"invoice-section"},pl={class:"responsive-table"},cl=y("br",null,null,-1),ml=["innerHTML"],vl={class:"invoice-section is-flex mt-0 pt-0"},_l={class:"end is-left"},fl={class:"text-right"},yl=y("p",null,"Mentioned price are final",-1),gl=i({__name:"ProposalViewModal",props:{previewModal:{type:Boolean},columnsToShow:{default:!1},proposalId:{default:""}},emits:["update:modalHandler","update:OnSuccess"],setup(l,{emit:a}){const t=l,s=G();Y();const o=d([{name:"Website Redesign",unit:"hrs",quantity:54,rate:24},{name:"Logo Design",unit:"hrs",quantity:12,rate:24},{name:"Custom Illustrations",unit:"hrs",quantity:7,rate:32}]);S((()=>{const e=o.value.reduce(((e,l)=>e+l.quantity*l.rate),0),l=.1*e;return[{label:"Subtotal",value:e},{label:"Taxes",value:l},{label:"Total",value:e+l}]}));const n=["Item","Description","Unit Cost","Qty","Unit","Builder Cost","Markup","Total Price"];d(""),d(!0),d(!0),d(!0),d(!0);const i=S((()=>te.value.reduce(((e,l)=>e+l.price*l.quantity),0))),r=d(!1);d({id:"c897de41-609f-4a20-8d79-0537b6a873d6",title:"Test Lead's Proposal",approval_deadline:"2025-01-30",internal_notes:null,introductory_text:null,closing_text:null,payment_status:"Pending",type:"proposal",status:"pending",created_at:"2025-01-21T19:08:06.509861Z",updated_at:"2025-01-21T19:08:06.509875Z",job:"da0aa7c1-3744-4856-a637-e5a821f5ec7e"});const u=d([{id:"5e7d026a-b392-47e9-9d24-58fbc1de12c5",index:1,title:"Test Lead Proposal Item",description:"<p>Description</p>",type:"",quantity:100,unit:"Sq ft",unit_cost:"10.00",markup:"150.00",total_price:"1150.00",cost_code:"11012",cost_type:"material",builder_cost:"1000.00",margin:"1.00",profit:"0.00",internal_notes:"Internal notes",mark_as:"bid",state:"active",group_amount:"0.00",status:null,created_at:"2025-01-23T18:25:46.392750Z",proposal:"c897de41-609f-4a20-8d79-0537b6a873d6"}]),p=()=>{a("update:modalHandler",!1)},m=async()=>{try{const e=await s.get(`api/cost/by-proposal/${t.proposalId}/`);u.value=e.data}catch(e){console.log(e)}};return c((()=>{(async()=>{try{r.value=!0,await s.get(`/api/lead-proposal/${t.proposalId}/`),m()}catch(e){console.log(e)}finally{r.value=!1}})()})),(l,a)=>{const s=ae,o=T,d=e;return v(),_(d,{is:"form",open:t.previewModal,title:"Cost Item ",size:"xl",actions:"right",onClose:p},{content:f((()=>[y("div",el,[y("div",ll,[y("div",al,[tl,y("div",sl,[y("div",ol,[y("div",nl,[P(s,{size:"xl",picture:"/logos/IbexFavicon.png"}),il,rl]),dl,b(u).length?(v(),w("div",ul,[y("table",pl,[y("thead",null,[(v(),w(q,null,U(n,((e,l)=>y("th",{key:l},C(e),1))),64))]),y("tbody",null,[(v(!0),w(q,null,U(b(u),((e,l)=>(v(),w("tr",{key:e.id},[y("td",null,[y("span",null,C(e.title),1),cl,y("span",null,C(e.cost_code),1)]),y("td",null,[y("span",{innerHTML:e.description},null,8,ml)]),y("td",null,[y("span",null," $"+C(e.unit_cost),1)]),y("td",null,[y("span",null,C(e.quantity),1)]),y("td",null,[y("span",null,C(e.unit),1)]),y("td",null,[y("span",null," $"+C(e.builder_cost),1)]),y("td",null,[y("span",null," $"+C(e.markup),1)]),y("td",null,[y("span",null," $"+C(e.total_price),1)])])))),128))])])])):I("",!0),y("div",vl,[y("div",_l,[y("h3",fl,"Total Price: $"+C(b(i)),1),yl])])])])])])])])),action:f((()=>[P(o,{loading:b(r),type:"submit",color:"warning",raised:"",onClick:p},{default:f((()=>[V("Close")])),_:1},8,["loading"])])),_:1},8,["open"])}}}),bl={onHold:"warning",open:"info",sold:"success",lost:"danger"},hl={pending:"info",approve:"success",review:"warning",disapprove:"danger"},wl={pending:"Pending",approve:"Approved",review:"Require Review",disapprove:"Disapproved"},xl={proposal:"primary",change_order:"warning",draft:"light"},kl={proposal:"Proposal",change_order:"Change Order",draft:"Draft"},Pl=[{value:"call",label:"Phone Call"},{value:"email",label:"Email"},{value:"followup",label:"Follow Up"},{value:"visit",label:"Site Visit"},{value:"form",label:"Website Form"}],Il={class:"flex-toolbar is-reversed is-flex space-between my-4"},Vl={key:0},Cl={key:1,class:"flex-list-wrapper flex-list-v2"},jl={class:"item-name dark-inverted"},Tl={class:"item-name dark-inverted"},Sl={class:"light-text"},Al={class:"light-text"},ql={class:"item-name dark-inverted"},Ul={class:"light-text"},Dl=["onClick"],Ol=[y("div",{class:"icon"},[y("i",{"aria-hidden":"true",class:"lnil lnil-pencil"})],-1),y("div",{class:"meta"},[y("span",null,"Edit"),y("span",null,"Edit Proposal Details")],-1)],Ml=["onClick"],Ll=[y("div",{class:"icon"},[y("i",{"aria-hidden":"true",class:"lnil lnil-briefcase"})],-1),y("div",{class:"meta"},[y("span",null,"View Detail"),y("span",null,"View detail in page")],-1)],$l=["onClick"],Hl=[y("div",{class:"icon"},[y("i",{"aria-hidden":"true",class:"lnil lnil-eye"})],-1),y("div",{class:"meta"},[y("span",null,"Preview"),y("span",null,"Preview proposal detail")],-1)],El=["onClick"],Rl=[y("div",{class:"icon"},[y("i",{"aria-hidden":"true",class:"lnil lnil-add-files"})],-1),y("div",{class:"meta"},[y("span",null,"Add Cost Item"),y("span",null,"Add a new cost item")],-1)],Wl=y("hr",{class:"dropdown-divider"},null,-1),Bl=["onClick"],Fl=[y("div",{class:"icon"},[y("i",{"aria-hidden":"true",class:"lnil lnil-trash-can-alt"})],-1),y("div",{class:"meta"},[y("span",null,"Delete"),y("span",null,"Delete from list")],-1)],Nl=y("img",{class:"light-image",src:B,alt:""},null,-1),zl=y("img",{class:"dark-image",src:F,alt:""},null,-1),Gl=i({__name:"LeadProposalsList",props:{activeTab:{default:"active"},leadId:{default:""},allProposal:{type:Boolean,default:!1}},setup(e){const s=e,i=$();H();const r=G(),u=oe(),p=d(!1),m=d([]),g=d(!1),h=d(""),j=d(!1),O=d(""),M=d("");d(s.activeTab);const L=d({title:"",subtitle:"test",isSweetAlertOpen:!1,btntext:"text"}),E=async()=>{try{p.value=!0;const e=await r.delete(`/api/lead-proposal/${M.value}/`);m.value=e.data,u.success("Proposal delete successfully"),Y()}catch(e){u.error(` ${e}, Proposal`),u.error("Something went wrong please try later")}finally{p.value=!1,L.value.isSweetAlertOpen=!1}},W={picture:{label:"Proposal",grow:!0,media:!0},customer:"Created At",industry:"Type",deadline:"Deadline",status:"Status",amount:{label:"Total Amount",media:!0},actions:{label:"Actions",align:"end"}},B=S((()=>{if(O.value){const e=new RegExp(O.value,"i");return m.value.filter((l=>l.title.match(e)||l.approval_deadline.match(e)))}return m.value})),F=d(!1),N=d(!1),z=d(!1),J=d(""),Y=()=>{1==s.allProposal?(async()=>{try{p.value=!0;const e=await r.get("/api/lead-proposal/");m.value=e.data}catch(e){u.error(` ${e}, Lead`)}finally{p.value=!1}})():s.leadId&&(async()=>{try{p.value=!0;const e=await r.get(`/api/lead-proposal/by-job/${s.leadId}/`);m.value=e.data}catch(e){u.error(` ${e}, Lead`)}finally{p.value=!1}})()};return c((()=>{Y()})),(e,r)=>{const d=R,u=T,c=re,S=t,$=o,H=ie,G=a,X=n,ee=l,ae=$e,te=gl,se=le,oe=Q,ne=Xe;return v(),w("div",null,[y("div",Il,[P(d,{icon:"feather:search"},{default:f((()=>[x(y("input",{"onUpdate:modelValue":r[0]||(r[0]=e=>A(O)?O.value=e:null),class:"input custom-text-filter",placeholder:"Search..."},null,512),[[k,b(O)]])])),_:1}),y("div",null,[P(u,{color:"primary",onClick:r[1]||(r[1]=e=>g.value=!b(g)),icon:"fas fa-plus"},{default:f((()=>[V("Lead Proposal")])),_:1}),s.leadId?(v(),_(u,{key:0,color:"warning",class:"ml-2",onClick:r[2]||(r[2]=e=>{j.value=!0}),icon:"fas fa-plus"},{default:f((()=>[V("Group")])),_:1})):I("",!0)])]),b(p)?(v(),w("div",Vl,[P(c)])):(v(),w("div",Cl,[b(B).length>0&&b(m).length>0?(v(),_(G,{key:0,data:b(B),columns:W,rounded:""},{body:f((()=>[P(D,{name:"list",tag:"div",class:"flex-list-inner"},{default:f((()=>[(v(!0),w(q,null,U(b(B),(e=>(v(),w("div",{key:e.id,class:"flex-table-item"},[P(S,{column:{media:!0,grow:!0}},{default:f((()=>[y("div",null,[y("span",jl,C(e.title),1)])])),_:2},1024),P(S,{column:{media:!0}},{default:f((()=>[y("div",null,[y("span",Tl,C(b(K)(e.created_at)),1),y("span",Sl,C(b(Z)(e.created_at)),1)])])),_:2},1024),P(S,null,{default:f((()=>[P($,{rounded:"",color:b(xl)[e.type]},{default:f((()=>[V(C(b(kl)[e.type]),1)])),_:2},1032,["color"])])),_:2},1024),P(S,null,{default:f((()=>[y("span",Al,C(e.approval_deadline),1)])),_:2},1024),P(S,null,{default:f((()=>[P($,{class:"capitalized",rounded:"",color:b(hl)[e.status]},{default:f((()=>[V(C(b(wl)[e.status]),1)])),_:2},1032,["color"])])),_:2},1024),P(S,{column:{media:!0}},{default:f((()=>[y("div",null,[y("span",ql,"$"+C(e.proposalAmount),1),y("span",Ul,C(e.payment_status),1)])])),_:2},1024),P(S,{column:{align:"end"}},{default:f((()=>[P(H,{class:"is-pushed-mobile",icon:"feather:more-vertical",spaced:"",right:""},{content:f((()=>[y("a",{role:"menuitem",onClick:l=>{return a=e.id,h.value=a,void(g.value=!0);var a},class:"dropdown-item is-media"},Ol,8,Dl),y("a",{role:"menuitem",onClick:l=>b(i).push(`/sidebar/dashboard/proposals/${e.id}`),class:"dropdown-item is-media"},Ll,8,Ml),y("a",{disabled:"",role:"menuitem",onClick:l=>{return a=e.id,N.value=a,void(F.value=!F.value);var a},class:"dropdown-item is-media"},Hl,8,$l),y("a",{role:"menuitem",onClick:l=>{return a=e.id,J.value=a,void(z.value=!z.value);var a},class:"dropdown-item is-media"},Rl,8,El),Wl,y("a",{role:"menuitem",onClick:l=>{return a=e.id,M.value=a,void(L.value={title:"Delete Proposal?",subtitle:"Are you sure to delete this proposal? After delete you will not be able to recover it again.",btntext:"Yes delete",isSweetAlertOpen:!0});var a},class:"dropdown-item is-media"},Fl,8,Bl)])),_:2},1024)])),_:2},1024)])))),128))])),_:1})])),_:1},8,["data"])):I("",!0),b(m).length<1&&0==b(B).length?(v(),_(X,{key:1,title:"There is no proposal created on this lead!",subtitle:"Too bad. Looks like we couldn't created any proposal on this Lead, please create proposal and release to the client",larger:""},{image:f((()=>[Nl,zl])),_:1})):I("",!0),b(B).length>5?(v(),_(ee,{key:2,"item-per-page":10,"total-items":873,"current-page":42,"max-links-displayed":7})):I("",!0)])),b(g)?(v(),_(ae,{key:2,leadId:s.leadId,proposalId:b(h),leadProposalModal:b(g),"onUpdate:modalHandler":r[3]||(r[3]=e=>g.value=!1),"onUpdate:OnSuccess":Y,onClearProposalId:r[4]||(r[4]=e=>h.value="")},null,8,["leadId","proposalId","leadProposalModal"])):I("",!0),b(F)?(v(),_(te,{key:3,"preview-modal":b(F),proposalId:b(N),"onUpdate:modalHandler":r[5]||(r[5]=e=>F.value=!1)},null,8,["preview-modal","proposalId"])):I("",!0),b(z)?(v(),_(se,{key:4,costItemModal:b(z),proposalId:b(J),"onUpdate:modalHandler":r[6]||(r[6]=e=>z.value=!1),"onUpdate:OnSuccess":Y},null,8,["costItemModal","proposalId"])):I("",!0),b(L).isSweetAlertOpen?(v(),_(oe,{key:5,isSweetAlertOpen:b(L).isSweetAlertOpen,title:b(L).title,subtitle:b(L).subtitle,btntext:b(L).btntext,onConfirm:E,onCancel:()=>b(L).isSweetAlertOpen=!1},null,8,["isSweetAlertOpen","title","subtitle","btntext","onCancel"])):I("",!0),b(j)?(v(),_(ne,{key:6,leadID:s.leadId,"group-proposal-modal":b(j),"onUpdate:modalHandler":r[7]||(r[7]=e=>j.value=!1)},null,8,["leadID","group-proposal-modal"])):I("",!0)])}}});export{$e as _,Gl as a,Pl as b,bl as g};
