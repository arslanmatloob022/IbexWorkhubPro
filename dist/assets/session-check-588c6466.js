import{d as e,b as r}from"./index-65642adb.js";import{u as o}from"./useAPI-a1c8acf2.js";import{u as s}from"./layoutSwitcher-4ef233dc.js";import{u as t}from"./company-9dbce81c.js";import{u as a}from"./supportElements-deb1a4d1.js";import"./useNotyf-b0e060ae.js";import"./notyf-3f1b770a.js";import"./useThemeColors-f00ee862.js";import"./useSupportElement-a2e3d3dc.js";const i=s(),l=e((async({router:e,pinia:s})=>{const l=r(s),m=o(),u=t(),n=a();if(l.isLoggedIn)try{const e=(await m.get("/api/auth/validate-user/")).data;i.setDynamicLayoutId("sideblock-default"),l.setUser(e),n.getUserPermissions(e.id),u.loadCompany()}catch(d){l.logoutUser()}e.beforeEach((e=>e.meta.requiresAuth&&!l.isLoggedIn||"admin"===l.user.role&&!1===e.meta.isAdminAllowed||"supplier"===l.user.role&&!1===e.meta.isPartnerAllowed||"manager"===l.user.role&&!1===e.meta.isManagerAllowed||"contractor"===l.user.role&&!1===e.meta.isContractorAllowed||"worker"===l.user.role&&!1===e.meta.isWorkerAllowed||"client"===l.user.role&&!1===e.meta.isClientAllowed?{name:"/",query:{redirect:e.fullPath}}:void 0))}));export{l as default};
