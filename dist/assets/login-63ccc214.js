import{_ as e}from"./VMessage.vue_vue_type_style_index_0_lang-8ca73852.js";import{e as a,r as s,F as l,t as o,N as t,o as i,x as r,v as n,M as u,y as c,z as d,C as p,l as m,A as v,B as f,I as h,O as g,K as y,D as _,j as b,S as w,Y as k,P as x,H as j,E as C,W as V,X as I,L as z}from"./index-023a2237.js";import{_ as S}from"./VField.vue_vue_type_script_setup_true_lang-65e70890.js";import{_ as A}from"./VControl-427c87b7.js";import{_ as L}from"./VInput.vue_vue_type_script_setup_true_lang-90ddbbe7.js";import{_ as P}from"./VLabel.vue_vue_type_script_setup_true_lang-5a4cec82.js";import{_ as D}from"./AnimatedLogo-7744d59d.js";import{_ as R}from"./ibexwhite-47d2fe94.js";import{u as E}from"./userSession-1b1da0d4.js";import{u as U}from"./useNotyf-c16238a4.js";import{u as W,a as F}from"./useAPI-329c7502.js";import{u as K}from"./layoutSwitcher-da5b7369.js";import"./useVFieldContext-28aff213.js";import"./notyf-577918b8.js";import"./useThemeColors-f46d40e9.js";const q=e=>(V("data-v-4282ee50"),e=e(),I(),e),B={class:"modern-login"},H=q((()=>p("div",{class:"underlay h-hidden-mobile h-hidden-tablet-p"},null,-1))),M={class:"columns is-gapless is-vcentered"},O={class:"column is-relative is-8 h-hidden-mobile h-hidden-tablet-p"},T={class:"hero is-fullheight is-image"},N={class:"hero-body"},X={class:"container"},G={class:"columns"},J={class:"column"},Y={key:0,class:"hero-image",src:R,alt:""},$={key:1,class:"hero-image",src:"/logos/IBEXDark.png",alt:""},Q={style:{"z-index":"99999"},class:"column is-4 is-relative"},Z={class:"top-tools"},ee=q((()=>p("h3",{style:{"font-size":"1.8rem","font-weight":"600","margin-left":"1rem",color:"#777"}},[p("span",{style:{color:"#2aac8e","font-size":"1.9rem"}},"Ibex"),_(" WorkHub ")],-1))),ae=["checked"],se=q((()=>p("span",null,null,-1))),le={class:"is-form"},oe={class:"is-form-inner"},te=[q((()=>p("h2",null,"Sign In",-1))),q((()=>p("p",null,"Welcome back to your account.",-1)))],ie=[q((()=>p("h2",null,"Recover Account",-1))),q((()=>p("p",null,"Reset your account password.",-1)))],re=["onSubmit"],ne=[q((()=>p("i",{class:"iconify","data-icon":"feather:eye","aria-hidden":"true",style:{"font-size":"1.5rem",color:"#888"}},null,-1)))],ue=[q((()=>p("i",{class:"iconify","data-icon":"feather:eye-off","aria-hidden":"true",style:{"font-size":"1.5rem",color:"#888"}},null,-1)))],ce=q((()=>p("span",{class:"toggler"},[p("span",{class:"active"},[p("i",{"aria-hidden":"true",class:"iconify","data-icon":"feather:check"})]),p("span",{class:"inactive"},[p("i",{"aria-hidden":"true",class:"iconify","data-icon":"feather:circle"})])],-1))),de={class:"button-wrap has-help"},pe={key:0,class:"recover-text"},me={class:"button-wrap"},ve=z(a({__name:"login",setup(a){const V=K(),I=s("login"),z=s(!1),R=l(),q=o(),ve=t(),fe=U(),he=W(),ge=E();ve.query.redirect;const ye=s(""),_e=s(""),be=s(""),we=s(!1),ke=s(!1),xe=s(!1),je=async()=>{if(!z.value){z.value=!0;try{const e=await F.post("https://vecel-practice.vercel.app/api/auth/login/",{email:ye.value,password:_e.value});console.log("resp",e.data);const a=e.data.token,s=e.data.user;ge.setToken(a),ge.setUser(s),Ce()}catch(e){z.value=!1}finally{z.value=!1}}},Ce=()=>{console.log("inside login success"),V.setDynamicLayoutId("sideblock-default"),fe.success(`Welcome back, ${ge.user.username}`),z.value=!1,"admin"==ge.user.role?q.push("/sidebar/dashboard"):"worker"==ge.user.role?q.push("/sidebar/worker/tasks"):"manager"==ge.user.role?q.push("/sidebar/manager/projects"):"contractor"==ge.user.role&&q.push("/sidebar/contractor/projects")},Ve=()=>{we.value=!we.value};return i((()=>{})),r((()=>{const e=window.location.search,a=new URLSearchParams(e);console.log("urlDAta",window.location.search);const s=a.get("token");s?ge.setToken(s):console.log("Invalid token")})),n({title:"Login - Ibex"}),(a,s)=>{const l=D,o=u("RouterLink"),t=P,i=L,r=A,n=S,V=C,E=e;return c(),d("div",B,[H,p("div",M,[p("div",O,[p("div",T,[p("div",N,[p("div",X,[p("div",G,[p("div",J,[m(R).isDark?(c(),d("img",Y)):(c(),d("img",$))])])])])])]),p("div",Q,[p("div",Z,[v(o,{to:"/auth/login",class:"top-logo"},{default:f((()=>[v(l,{style:{width:"38px",height:"38px"}}),ee])),_:1}),p("label",{class:"dark-mode",tabindex:"0",role:"button",onKeydown:s[1]||(s[1]=h(y((e=>e.target.click()),["prevent"]),["space"]))},[p("input",{"data-cy":"dark-mode-toggle",type:"checkbox",checked:!m(R).isDark,onChange:s[0]||(s[0]=(...e)=>m(R).onChange&&m(R).onChange(...e))},null,40,ae),se],32)]),p("div",le,[p("div",oe,[p("div",{class:g(["form-text",["login"!==m(I)&&"is-hidden"]])},te,2),p("div",{class:g(["form-text",["login"===m(I)&&"is-hidden"]])},ie,2),p("form",{method:"post",novalidate:"","data-cy":"login-form",class:g([["login"!==m(I)&&"is-hidden"],"login-wrapper"]),onSubmit:y(je,["prevent"])},[v(n,null,{default:f((()=>[v(r,{icon:"lnil lnil-envelope autv-icon"},{default:f((()=>[v(t,{class:"auth-label"},{default:f((()=>[_(" Email Address ")])),_:1}),v(i,{modelValue:m(ye),"onUpdate:modelValue":s[2]||(s[2]=e=>b(ye)?ye.value=e:null),"data-cy":"email-input",type:"email",autocomplete:"current-password"},null,8,["modelValue"])])),_:1})])),_:1}),v(n,null,{default:f((()=>[v(r,{icon:"lnil lnil-lock-alt autv-icon",style:{position:"relative"}},{default:f((()=>[w(p("span",{style:{position:"absolute","z-index":"9999",right:"1rem",top:"1.4rem"},onClick:Ve},ne,512),[[k,!m(we)]]),w(p("span",{style:{position:"absolute","z-index":"9999",right:"1rem",top:"1.4rem"},onClick:Ve},ue,512),[[k,m(we)]]),v(t,{class:"auth-label"},{default:f((()=>[_("Password")])),_:1}),v(i,{modelValue:m(_e),"onUpdate:modelValue":s[3]||(s[3]=e=>b(_e)?_e.value=e:null),"data-cy":"password-input",type:m(we)?"text":"password",autocomplete:"current-password"},null,8,["modelValue","type"])])),_:1})])),_:1}),v(n,null,{default:f((()=>[v(r,{class:"is-flex"},{default:f((()=>[v(t,{raw:"",class:"remember-toggle"},{default:f((()=>[v(i,{raw:"",type:"checkbox"}),ce])),_:1}),v(t,{raw:"",class:"remember-me"},{default:f((()=>[_(" Remember Me ")])),_:1}),p("a",{tabindex:"0",role:"button",onKeydown:s[4]||(s[4]=h(y((e=>I.value="forgot-password"),["prevent"]),["space"])),onClick:s[5]||(s[5]=e=>I.value="forgot-password")}," Forgot Password? ",32)])),_:1})])),_:1}),p("div",de,[v(V,{id:"login-button",loading:m(z),color:"primary",type:"submit",size:"big",rounded:"",raised:"",bold:""},{default:f((()=>[_(" Confirm ")])),_:1},8,["loading"]),p("span",null,[_(" Or "),v(o,{to:"/auth/signup-1"},{default:f((()=>[_("Create")])),_:1}),_(" an account. ")])])],42,re),p("form",{method:"post",novalidate:"",class:g([["forgot-password"!==m(I)&&"is-hidden"],"login-wrapper"]),onSubmit:s[12]||(s[12]=y((()=>{}),["prevent"]))},[m(ke)?x("",!0):(c(),d("p",pe," Enter your email and click on the confirm button to reset your password. We'll send you an email detailing the steps to complete the procedure. ")),m(ke)?(c(),j(E,{key:1,color:"primary",class:"is-flex",closable:"",onClose:s[6]||(s[6]=e=>ke.value=!1)},{default:f((()=>[_(" A password reset request has been sent to your email. Please check your inbox to change your password. ")])),_:1})):x("",!0),m(xe)?(c(),j(E,{key:2,color:"danger",class:"is-flex mt-4",closable:"",onClose:s[7]||(s[7]=e=>xe.value=!1)},{default:f((()=>[_(" Please enter valid email address. ")])),_:1})):x("",!0),v(n,null,{default:f((()=>[v(r,{icon:"lnil lnil-envelope autv-icon"},{default:f((()=>[v(t,{class:"auth-label"},{default:f((()=>[_(" Email Address ")])),_:1}),v(i,{type:"email",modelValue:m(be),"onUpdate:modelValue":s[8]||(s[8]=e=>b(be)?be.value=e:null),autocomplete:"current-password"},null,8,["modelValue"])])),_:1})])),_:1}),v(n,null,{default:f((()=>[v(r,{class:"is-flex"},{default:f((()=>[p("a",{tabindex:"0",role:"button",onKeydown:s[9]||(s[9]=h(y((e=>I.value="login"),["prevent"]),["space"])),onClick:s[10]||(s[10]=e=>I.value="login")}," Login ? ",32)])),_:1})])),_:1}),p("div",me,[v(V,{loading:m(z),color:"primary",size:"big",type:"submit",lower:"",rounded:"",solid:"",onClick:s[11]||(s[11]=e=>(async e=>{try{z.value=!0,await he.post("/v3/api/account/auth/forget-password/",{email:e}),ke.value=!0}catch(a){xe.value=!0,fe.error("Please enter your valid email address")}finally{z.value=!1}})(m(be)))},{default:f((()=>[_(" Confirm ")])),_:1},8,["loading"])])],34)])])])])])}}}),[["__scopeId","data-v-4282ee50"]]);export{ve as default};
