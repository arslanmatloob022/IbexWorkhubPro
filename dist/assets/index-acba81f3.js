import{_ as e,d as a,i as l}from"./estimatesScripts-d8f66174.js";import{_ as t}from"./SweetAlert.vue_vue_type_style_index_0_lang-77a5b8b5.js";import{_ as s}from"./LeadAddUpdateModal.vue_vue_type_style_index_0_lang-167a2bf8.js";import{_ as n}from"./VFlexPagination.vue_vue_type_script_setup_true_lang-af0d8306.js";import{_ as i,c as o}from"./VFlexTable.vue_vue_type_style_index_0_lang-1dd22f7e.js";import{_ as r}from"./VDropdown.vue_vue_type_style_index_0_lang-0868859d.js";import{_ as u}from"./VAvatar.vue_vue_type_style_index_0_lang-415ba8c9.js";import{_ as d}from"./VTag.vue_vue_type_style_index_0_lang-49128f21.js";import{_ as c}from"./VPlaceholderPage.vue_vue_type_style_index_0_lang-cff9fb0c.js";import{e as p,r as _,v as m,Z as v,o as f,au as y,B as g,C as b,l as h,N as j,D as x,E as k,F as w,K as V,W as C,j as A,J as S,U as I,V as L,M as O,aR as P,O as T,ak as U,T as $,I as N,z as D}from"./index-797f323c.js";import{_ as M,a as F}from"./VOption.vue_vue_type_style_index_0_lang-048157b0.js";import{_ as E}from"./VField.vue_vue_type_script_setup_true_lang-309269dc.js";import{_ as W}from"./VControl-bbf92ffd.js";import{_ as z}from"./PlaceloadV1.vue_vue_type_style_index_0_lang-5edd70d0.js";import{_ as H,a as B}from"./search-4-dark-2b5b440c.js";import{u as J}from"./useAPI-b2b28f22.js";import{u as R}from"./useNotyf-b138f887.js";import{e as Z,g as Y}from"./useSupportElement-012e6b86.js";import{u as K}from"./viewWrapper-b24b3ba8.js";import{b as Q}from"./route-block-83d24a4e.js";import"./VModal.vue_vue_type_style_index_0_lang-ea769eae.js";import"./CreateProposalTasksModal-d6f84737.js";import"./VTextarea.vue_vue_type_script_setup_true_lang-db18e983.js";import"./useVFieldContext-2bbe4b01.js";import"./VInput.vue_vue_type_script_setup_true_lang-228d2028.js";import"./VCheckbox.vue_vue_type_style_index_0_lang-0e6ca9b5.js";import"./VLabel.vue_vue_type_script_setup_true_lang-859c7375.js";import"./userSession-591942fc.js";import"./VIconButton-1fbf9a94.js";import"./costItems-33806892.js";import"./VRadio.vue_vue_type_style_index_0_lang-f154d1b4.js";import"./V-Snack.vue_vue_type_style_index_0_lang-8ebd73e7.js";import"./VIcon.vue_vue_type_script_setup_true_lang-6ee0dd7e.js";import"./LeadProposalsList.vue_vue_type_style_index_0_lang-2d49d71a.js";import"./VSwitchBlock.vue_vue_type_style_index_0_lang-0ac6365d.js";import"./ckeditor-a40f5948.js";import"./vue.runtime.esm-bundler-33ed4b7f.js";import"./ckeditor-65aad31c.js";import"./VFlex.vue_vue_type_style_index_0_lang-f29c0f4b.js";import"./useDropdown-3a752b09.js";import"./VPlaceloadWrap-12a7632a.js";import"./VPlaceloadText.vue_vue_type_style_index_0_lang-1ad2b65b.js";import"./VPlaceloadAvatar.vue_vue_type_style_index_0_lang-c26c6900.js";import"./notyf-72412716.js";import"./useThemeColors-d4407185.js";const q={key:1},G={class:"list-flex-toolbar flex-list-v1"},X={class:"page-content-inner"},ee={class:"flex-list-wrapper flex-list-v1"},ae=x("img",{class:"light-image",src:H,alt:""},null,-1),le=x("img",{class:"dark-image",src:B,alt:""},null,-1),te={class:"item-name dark-inverted show-text-200"},se={class:"item-meta show-text-200"},ne={key:0,class:"show-text-200"},ie={class:"item-name"},oe={class:"item-meta"},re={key:1,class:"show-text-200"},ue={class:"item-name"},de={class:"item-meta"},ce={class:"item-name"},pe={class:"item-meta"},_e=["onClick"],me=[x("div",{class:"icon"},[x("i",{"aria-hidden":"true",class:"lnil lnil-eye"})],-1),x("div",{class:"meta"},[x("span",null,"View"),x("span",null,"View user details")],-1)],ve=["onClick"],fe=[x("div",{class:"icon"},[x("i",{class:"lnil lnil-copy","aria-hidden":"true"})],-1),x("div",{class:"meta"},[x("span",null,"Add Proposals"),x("span",null,"Add new proposal to lead")],-1)],ye=["onClick"],ge=[x("div",{class:"icon"},[x("i",{"aria-hidden":"true",class:"lnil lnil-pencil"})],-1),x("div",{class:"meta"},[x("span",null,"Edit"),x("span",null,"Update Lead Info")],-1)],be=x("hr",{class:"dropdown-divider"},null,-1),he=["onClick"],je=[x("div",{class:"icon"},[x("i",{"aria-hidden":"true",class:"lnil lnil-trash-can-alt"})],-1),x("div",{class:"meta"},[x("span",null,"Delete"),x("span",null,"Delete Proposal Permanently")],-1)],xe=p({__name:"LeadsList",setup(p){const D=_(""),H=m(),B=R(),K=J(),Q=_(),xe=_({id:"54985a54-db61-4761-becd-3b35f8ec503e",sales_people_info:[],clientInfo:null,created_by_info:null,manager_info:null,title:"test job",address:null,current_state:"lead",city:null,state:null,status:null,zip_code:null,confidence:"0.00",sale_date:null,tags:[],estimated_from:null,estimated_to:null,sources:null,project_type:null,notes:null,attach_mail:null,created:"2025-01-15T19:55:18.448485Z",updated_at:"2025-01-15T19:55:18.448510Z",created_by:null,manager:null,client:null,sales_people:[]}),ke=_(42),we=_(""),Ve=_(""),Ce=_(!1),Ae=_(!1),Se=_([{value:"open",label:"Open"},{value:"sold",label:"Sold"},{value:"lost",label:"Lost"},{value:"onHold",label:"On hold"}]),Ie={location:{label:"Job",grow:!0},username:{label:"Contractor/Client",grow:!0},contacts:"Date Created",status:"Lead Status",industry:"Manager",actions:{label:"Actions",align:"end"}},Le=async()=>{try{Q.value=!0;const e=await K.get("/api/project/project-leads/");xe.value=e.data}catch(e){B.error(` ${e}, Lead`)}finally{Q.value=!1}},Oe=e=>{D.value=e,Ae.value=!0},Pe=_({title:"",subtitle:"test",isSweetAlertOpen:!1,btntext:"text"}),Te=async()=>{try{Q.value=!0;await K.delete(`/api/project/${D.value}/`);B.info("Lead deleted successfully"),Le()}catch(e){B.error(` ${e}, Lead`),B.error("Something went wrong please try later")}finally{Q.value=!1,Pe.value.isSweetAlertOpen=!1}},Ue=v((()=>{if(we.value){const e=new RegExp(we.value,"i");return xe.value.filter((a=>a.title?.match(e)||a.address?.match(e)||a.clientInfo?.username?.match(e)||a.clientInfo?.last_name?.match(e)||a.clientInfo?.username?.match(e)||a.city?.match(e)||a.created?.match(e)))}return xe.value})),$e=v((()=>Ve.value?Ue.value?.filter((e=>e.leadStatus==Ve.value)):Ue.value));return f((()=>{Le()})),(p,_)=>{const m=z,v=W,f=E,B=M,J=F,R=T,K=U,xe=c,Ue=o,Ne=d,De=u,Me=r,Fe=i,Ee=n,We=s,ze=t,He=e,Be=y("tooltip");return g(),b("div",null,[h(Q)?(g(),j(m,{key:0})):(g(),b("div",q,[x("div",G,[k(f,null,{default:w((()=>[k(v,{icon:"feather:search"},{default:w((()=>[V(x("input",{"onUpdate:modelValue":_[0]||(_[0]=e=>A(we)?we.value=e:null),class:"input custom-text-filter",placeholder:"Search..."},null,512),[[C,h(we)]])])),_:1})])),_:1}),k(f,null,{default:w((()=>[k(v,{class:"has-icons-left",icon:"fas fa-globe"},{default:w((()=>[k(J,{modelValue:h(Ve),"onUpdate:modelValue":_[1]||(_[1]=e=>A(Ve)?Ve.value=e:null)},{default:w((()=>[k(B,{value:""},{default:w((()=>[S(" All ")])),_:1}),(g(!0),b(I,null,L(h(Se),(e=>(g(),j(B,{value:e.value},{default:w((()=>[S($(e.label),1)])),_:2},1032,["value"])))),256))])),_:1},8,["modelValue"])])),_:1})])),_:1}),k(K,null,{default:w((()=>[k(R,{onClick:_[2]||(_[2]=e=>Oe("")),color:"primary",icon:"fas fa-plus",elevated:""},{default:w((()=>[S(" Lead Opportunity ")])),_:1})])),_:1})]),x("div",X,[x("div",ee,[h($e)?.length?O("",!0):(g(),j(xe,{key:0,title:"We couldn't find any matching results.",subtitle:"Too bad. Looks like we couldn't find any matching results for the\n          search terms you've entered. Please try different search terms or\n          criteria.",larger:""},{image:w((()=>[ae,le])),_:1})),h($e)?.length?(g(),j(Fe,{key:1,data:h($e),columns:Ie,compact:""},{body:w((()=>[k(P,{name:"list",tag:"div",class:"flex-list-inner"},{default:w((()=>[(g(!0),b(I,null,L(h($e),(e=>(g(),b("div",{key:e.id,class:"flex-table-item"},[k(Ue,{onClick:()=>{h(H).push(`/sidebar/dashboard/jobs/${e.id}`)},class:"cu-pointer",column:{media:!0,grow:!0}},{default:w((()=>[x("div",null,[x("span",te,$(e.title?e.title:"N/A"),1),x("span",se,[x("span",null,$(e.address?e.address:"N/A"),1)])])])),_:2},1032,["onClick"]),k(Ue,{onClick:()=>{h(H).push(`/sidebar/dashboard/jobs/${e.id}`)},class:"cu-pointer",column:{media:!0,grow:!0}},{default:w((()=>[e.clientInfo?(g(),b("div",ne,[x("span",ie,$(e.clientInfo?.username?e.clientInfo?.username:"N/A"),1),x("span",oe,[x("span",null,$(e.clientInfo?.email?e.clientInfo?.email:"N/A"),1)])])):e.contractor_info?(g(),b("div",re,[x("span",ue,$(e.contractor_info?.username?e.contractor_info?.username:"N/A"),1),x("span",de,[x("span",null,$(e.contractor_info?.email?e.contractor_info?.email:"N/A"),1)])])):O("",!0)])),_:2},1032,["onClick"]),k(Ue,{onClick:()=>{h(H).push(`/sidebar/dashboard/jobs/${e.id}`)},class:"cu-pointer",column:{media:!0}},{default:w((()=>[x("div",null,[x("span",ce,$(h(Z)(e.created)),1),x("span",pe,[x("span",null,"At:"+$(h(Y)(e.created)),1)])])])),_:2},1032,["onClick"]),k(Ue,{onClick:()=>{h(H).push(`/sidebar/dashboard/jobs/${e.id}`)},class:"cu-pointer"},{default:w((()=>[k(Ne,{color:h(a)[e.leadStatus],rounded:""},{default:w((()=>[S($(h(l)[e.leadStatus]),1)])),_:2},1032,["color"])])),_:2},1032,["onClick"]),k(Ue,{onClick:()=>{h(H).push(`/sidebar/dashboard/jobs/${e.id}`)},class:"cu-pointer",column:{media:!0}},{default:w((()=>[x("div",null,[(g(!0),b(I,null,L(e.managers_list,(e=>V((g(),j(De,{initials:e.username.slice(0,2),picture:e.avatar,color:"primary",size:"small"},null,8,["initials","picture"])),[[Be,`${e.username} ${e.last_name??""}`,void 0,{center:!0,primary:!0,rounded:!0}]]))),256))])])),_:2},1032,["onClick"]),k(Ue,{column:{align:"end"}},{default:w((()=>[k(Me,{icon:"feather:more-vertical",class:"is-pushed-mobile",spaced:"",right:""},{content:w((({close:a})=>[x("a",{role:"menuitem",class:"dropdown-item is-media",onClick:()=>{h(H).push(`/sidebar/dashboard/jobs/${e.id}`)}},me,8,_e),x("a",{role:"menuitem",onClick:a=>{return l=e.id,D.value=l,void(Ce.value=!Ce.value);var l},class:"dropdown-item is-media"},fe,8,ve),x("a",{role:"menuitem",class:"dropdown-item is-media",onClick:N((a=>Oe(e.id)),["prevent"])},ge,8,ye),be,x("a",{role:"menuitem",class:"dropdown-item is-media",onClick:N((a=>{return l=e.id,D.value=l,void(Pe.value={title:"Delete Lead?",subtitle:"Are you sure to delete this Lead? After delete you will not be able to recover it again.",btntext:"Delete",isSweetAlertOpen:!0});var l}),["prevent"])},je,8,he)])),_:2},1024)])),_:2},1024)])))),128))])),_:1})])),_:1},8,["data"])):O("",!0),h($e)?.length>5?(g(),j(Ee,{key:2,"current-page":h(ke),"onUpdate:currentPage":_[3]||(_[3]=e=>A(ke)?ke.value=e:null),"item-per-page":10,"total-items":80,"max-links-displayed":7,"no-router":""},null,8,["current-page"])):O("",!0)])])])),h(Ae)?(g(),j(We,{key:2,addUpdateLeadModal:h(Ae),leadId:h(D),"onUpdate:modalHandler":_[4]||(_[4]=e=>Ae.value=!1),"onUpdate:OnSuccess":Le},null,8,["addUpdateLeadModal","leadId"])):O("",!0),h(Pe).isSweetAlertOpen?(g(),j(ze,{key:3,isSweetAlertOpen:h(Pe).isSweetAlertOpen,title:h(Pe).title,subtitle:h(Pe).subtitle,loading:h(Q),btntext:h(Pe).btntext,onConfirm:Te,onCancel:()=>h(Pe).isSweetAlertOpen=!1},null,8,["isSweetAlertOpen","title","subtitle","loading","btntext","onCancel"])):O("",!0),h(Ce)?(g(),j(He,{key:4,"lead-proposal-modal":h(Ce),"lead-id":h(D),"onUpdate:modalHandler":_[5]||(_[5]=e=>Ce.value=!1),"onUpdate:OnSuccess":Le},null,8,["lead-proposal-modal","lead-id"])):O("",!0)])}}}),ke=p({__name:"index",setup:e=>(K().setPageTitle("Leads"),D({title:"Leads - Ibex"}),(e,a)=>{const l=xe;return g(),b("div",null,[k(l)])})});"function"==typeof Q&&Q(ke);export{ke as default};
