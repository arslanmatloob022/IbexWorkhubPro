import{_ as e}from"./VModal.vue_vue_type_style_index_0_lang-7398293b.js";import{b as a,u as l,c as t}from"./CreateProposalTasksModal-070720d7.js";import{e as o,av as s,l as n,Z as i,B as r,C as d,Y as u,r as p,o as c,A as m,N as _,F as f,D as v,E as y,U as g,V as b,M as h,J as k,I as w,O as C,R as P,j as V,aR as I,T,P as x,Q as S,s as M,b as j,_ as U,i as A,K as q,W as R}from"./index-70b05a5f.js";import{_ as H}from"./VTextarea.vue_vue_type_script_setup_true_lang-7d03ad7b.js";import{_ as O}from"./VInput.vue_vue_type_script_setup_true_lang-f03dec85.js";import{_ as E}from"./VField.vue_vue_type_script_setup_true_lang-d6432c8a.js";import{_ as D}from"./VControl-0234c21a.js";import{_ as L}from"./VRadio.vue_vue_type_style_index_0_lang-c0f04af3.js";import{_ as G}from"./V-Snack.vue_vue_type_style_index_0_lang-a1b5c6da.js";import{_ as Z}from"./VIcon.vue_vue_type_script_setup_true_lang-eba97353.js";import{u as B}from"./useAPI-ebd6fc63.js";import{u as $}from"./useNotyf-2c361439.js";import{_ as F}from"./VFlexPagination.vue_vue_type_script_setup_true_lang-d7f77b71.js";import{_ as N,c as z}from"./VFlexTable.vue_vue_type_style_index_0_lang-54a6828f.js";import{_ as Q}from"./VCheckbox.vue_vue_type_style_index_0_lang-5f02f13d.js";import{_ as J}from"./VTag.vue_vue_type_style_index_0_lang-1c3765a2.js";import{_ as W}from"./VPlaceholderPage.vue_vue_type_style_index_0_lang-f6e5226b.js";import{_ as K,a as Y}from"./search-4-dark-2b5b440c.js";import{e as X,a as ee}from"./useSupportElement-300af3cd.js";import{_ as ae}from"./VAvatar.vue_vue_type_style_index_0_lang-dededacb.js";import{u as le}from"./userSession-0e9987e3.js";import{s as te}from"./costItems-a946e641.js";const oe={class:"v-grid"},se=o({__name:"VGrid",props:{inline:{type:Boolean},gridTemplateColumns:{default:"none"},gridTemplateRows:{default:"none"},gridTemplateAreas:{default:"none"},columnGap:{default:"normal"},rowGap:{default:"normal"},justifyItems:{default:"initial"},alignItems:{default:"initial"},justifyContent:{default:"initial"},alignContent:{default:"initial"},placeContent:{default:"normal"},gridAutoColumns:{default:"auto"},gridAutoRows:{default:"auto"},gridAutoFlow:{default:"row"}},setup(e){const a=e;s((e=>({"36a9ff9c":n(l),"644edfcf":a.gridTemplateColumns,"13ee8f27":a.gridTemplateRows,"68f4ddf8":a.gridTemplateAreas,"3f6d0412":a.columnGap,"9b29192c":a.rowGap,"6ce21d44":a.justifyItems,"274efcee":a.alignItems,"5c2c4e97":a.justifyContent,"1a5afffc":a.alignContent,68195080:a.placeContent,d4bc820c:a.gridAutoColumns,"07161048":a.gridAutoRows,"0721119e":a.gridAutoFlow})));const l=i((()=>a.inline?"inline-grid":"grid"));return(e,a)=>(r(),d("div",oe,[u(e.$slots,"default")]))}}),ne={class:"v-grid-item"},ie=o({__name:"VGridItem",props:{gridColumnStart:{default:"auto"},gridColumnEnd:{default:"auto"},gridRowStart:{default:"auto"},gridRowEnd:{default:"auto"},justifySelf:{default:"auto"},alignSelf:{default:"auto"},placeSelf:{default:"auto"}},setup(e){const a=e;return s((e=>({"639fd2f2":a.gridColumnStart,"0928fb6b":a.gridColumnEnd,"58f2dc22":a.gridRowStart,"690c909b":a.gridRowEnd,"4e453368":a.justifySelf,"3160ef46":a.alignSelf,"2e640d42":a.placeSelf}))),(e,a)=>(r(),d("div",ne,[u(e.$slots,"default")]))}}),re={class:"columns is-multiline"},de={class:"column is-12"},ue={class:"column is-12"},pe={class:"column is-12"},ce={class:"column is-12"},me={class:"column is-12"},_e=P(o({__name:"MergeProposalModal",props:{groupProposalModal:{type:Boolean,default:!1},leadID:{default:""},selectedProposals:{default:[]}},emits:["update:modalHandler","update:OnSuccess","removeProposal"],setup(a,{emit:l}){const t=a,o=p(!1),s=B(),i=$();p("");const u=p([{value:"",label:""}]);p([{id:"",proposalAmount:0,title:"",approval_deadline:"",internal_notes:"",introductory_text:"",closing_text:"",payment_status:"",type:"",status:"",created_at:"",updated_at:"",job:""}]);const P=t.selectedProposals.map((e=>e.id)),V=p({title:"",type:"combined",description:"",proposals:P,trades:[],columns_to_show:[]}),I=()=>{l("update:modalHandler",!1)},T=async()=>{try{o.value=!0;let e=V.value;e.columns_to_show=JSON.stringify(V.value.columns_to_show),e.proposals=JSON.stringify(V.value.proposals);const a=await s.post("/api/lead-proposal/merge-proposals/",e,{responseType:"blob"}),l=new Blob([a.data],{type:"application/pdf"}),t=window.URL.createObjectURL(l),n=document.createElement("a");n.href=t,n.download="Merged_Proposal.pdf",document.body.appendChild(n),n.click(),document.body.removeChild(n),window.URL.revokeObjectURL(t),I(),i.success("Proposal grouped successfully and saved in documents list")}catch(e){console.log(e)}finally{o.value=!1}};return c((()=>{(async()=>{try{const e=await s.get("/api/cost-trade/");u.value=e.data.map((e=>({value:e.id,label:e.name})))}catch(e){console.log(e)}})()})),(a,s)=>{const i=Z,p=G,c=ie,P=se,x=L,S=D,M=E,j=O,U=m("Multiselect"),A=H,q=C,R=e;return r(),_(R,{is:"form",open:t.groupProposalModal,title:"Group Proposal",size:"large",actions:"right",onSubmit:w(T,["prevent"]),onClose:s[7]||(s[7]=e=>I())},{content:f((()=>[v("div",re,[v("div",de,[y(P,null,{default:f((()=>[y(c,null,{default:f((()=>[(r(!0),d(g,null,b(t.selectedProposals,(e=>(r(),_(p,{title:e.title,white:"",class:"m-1",icon:"lnir lnir-envelope"},{default:f((()=>[y(i,{onClick:a=>(e=>{l("removeProposal",e)})(e),icon:"lucide:x"},null,8,["onClick"])])),_:2},1032,["title"])))),256))])),_:1})])),_:1})]),v("div",ue,[y(M,{label:"Select Group Type"},{default:f((()=>[y(S,null,{default:f((()=>[y(x,{modelValue:n(V).type,"onUpdate:modelValue":s[0]||(s[0]=e=>n(V).type=e),value:"combined",label:"Combine Proposals",name:"outlined_squared_radio",color:"warning",square:""},null,8,["modelValue"]),y(x,{modelValue:n(V).type,"onUpdate:modelValue":s[1]||(s[1]=e=>n(V).type=e),value:"trade",label:"Trade Proposal",name:"outlined_squared_radio",color:"primary",square:""},null,8,["modelValue"]),y(x,{modelValue:n(V).type,"onUpdate:modelValue":s[2]||(s[2]=e=>n(V).type=e),value:"summary",label:"Summary Proposal",name:"outlined_squared_radio",color:"info",square:""},null,8,["modelValue"]),y(x,{modelValue:n(V).type,"onUpdate:modelValue":s[3]||(s[3]=e=>n(V).type=e),value:"report",label:"Report",name:"outlined_squared_radio",color:"success",square:""},null,8,["modelValue"])])),_:1})])),_:1})]),v("div",pe,[y(M,{label:"Proposal Title *"},{default:f((()=>[y(S,null,{default:f((()=>[y(j,{modelValue:n(V).title,"onUpdate:modelValue":s[4]||(s[4]=e=>n(V).title=e),placeholder:"Enter Group Proposal Title",type:"text",name:"title",required:""},null,8,["modelValue"])])),_:1})])),_:1})]),v("div",ce,["trade"==n(V).type?(r(),_(M,{key:0,label:"Select the trades to merge"},{default:f((({id:e})=>[y(S,null,{default:f((()=>[y(U,{modelValue:n(V).trades,"onUpdate:modelValue":s[5]||(s[5]=e=>n(V).trades=e),attrs:{id:e},mode:"tags",searchable:!0,"create-tag":!0,options:n(u),placeholder:"Select Trade"},null,8,["modelValue","attrs","options"])])),_:2},1024)])),_:1})):h("",!0)]),v("div",me,[y(M,{label:"Group Description"},{default:f((()=>[y(S,null,{default:f((()=>[y(A,{modelValue:n(V).description,"onUpdate:modelValue":s[6]||(s[6]=e=>n(V).description=e),placeholder:"Enter Group Proposal Title",rows:"3",type:"text"},null,8,["modelValue"])])),_:1})])),_:1})])])])),action:f((()=>[y(q,{loading:n(o),type:"submit",color:"warning",raised:""},{default:f((()=>[k("Group Proposals")])),_:1},8,["loading"])])),_:1},8,["open","onSubmit"])}}}),[["__scopeId","data-v-7b8ce435"]]),fe=e=>(x("data-v-2ca52735"),e=e(),S(),e),ve={class:"columns is-multiline"},ye={class:"column is-12 is-flex space-between"},ge=fe((()=>v("div",null,null,-1))),be={class:"is-flex"},he={class:"column is-12"},ke={class:"flex-list-wrapper flex-list-v2"},we=fe((()=>v("img",{class:"light-image",src:K,alt:""},null,-1))),Ce=fe((()=>v("img",{class:"dark-image",src:Y,alt:""},null,-1))),Pe={class:"tab-content is-active"},Ve={class:"item-name dark-inverted"},Ie={class:"item-meta"},Te={class:"light-text"},xe=P(o({__name:"ProposalGroupModal",props:{leadProposalListModal:{type:Boolean},leadID:{default:""}},emits:["update:modalHandler","update:OnSuccess"],setup(l,{emit:t}){const o=l,s=p([{id:"",proposalAmount:0,title:"",approval_deadline:"",internal_notes:"",introductory_text:"",closing_text:"",payment_status:"",type:"",status:"",created_at:"",updated_at:"",job:""}]),u=p("combine"),w=p(!1),P=p("active"),x=B(),S=p([]),M=p([{value:"",label:""}]),j=p(!1),U=p([]);U.value.map((e=>e.id));const A=p(""),q={picture:{label:"Proposal",grow:!0,media:!0},customer:"Type",industry:"Amount",status:"Status",team:{label:"Payment"},actions:{label:"Select",align:"end"}},R=p(!1),H=e=>{const a=U.value.findIndex((a=>a.id===e.id));-1!==a?U.value.splice(a,1):U.value.push(e)},O=i((()=>{if(A.value){const e=new RegExp(A.value,"i");return s.value.filter((a=>a.title.match(e)||a.description.match(e)))}return s.value})),L=()=>{t("update:modalHandler",!1)};return c((()=>{(async()=>{try{w.value=!0;const e=await x.get(`/api/lead-proposal/by-project/${o.leadID}/`);s.value=e.data}catch(e){console.log(e)}finally{w.value=!1}})(),(async()=>{try{const e=await x.get("/api/cost-trade/");M.value=e.data.map((e=>({value:e.id,label:e.name})))}catch(e){console.log(e)}})()})),(l,t)=>{const s=m("Multiselect"),i=D,p=E,c=C,x=W,A=z,G=J,Z=Q,B=N,$=F,K=_e,Y=a,ee=e;return r(),_(ee,{is:"form",open:o.leadProposalListModal,title:"Proposal List",size:"xl",actions:"right",onClose:L},{content:f((()=>[v("div",ve,[v("div",ye,[ge,v("div",be,["trade"==n(u)?(r(),_(p,{key:0,style:{width:"340px"}},{default:f((({id:e})=>[y(i,null,{default:f((()=>[y(s,{modelValue:n(S),"onUpdate:modelValue":t[0]||(t[0]=e=>V(S)?S.value=e:null),attrs:{id:e},mode:"tags",searchable:!0,"create-tag":!0,options:n(M),placeholder:"Select Trades"},null,8,["modelValue","attrs","options"])])),_:2},1024)])),_:1})):h("",!0),y(c,{class:"ml-2",onClick:t[1]||(t[1]=e=>j.value=!n(j)),raised:"",color:"warning",light:"",outlined:"",icon:"lnil lnil-files-alt",disabled:!n(U).length},{default:f((()=>[k(" Group Proposal ")])),_:1},8,["disabled"]),y(c,{class:"ml-2",raised:"",icon:"fas fa-envelope",color:"info",light:"",disabled:!n(U).length,outlined:"",onClick:t[2]||(t[2]=e=>{R.value=!R.value})},{default:f((()=>[k(" Send ")])),_:1},8,["disabled"])])]),v("div",he,[v("div",ke,["active"===n(P)&&0===n(O).length?(r(),_(x,{key:0,title:"We couldn't find any matching results.",subtitle:"Too bad. Looks like we couldn't find any matching results for the\n          search terms you've entered. Please try different search terms or\n          criteria.",larger:""},{image:f((()=>[we,Ce])),_:1})):h("",!0),v("div",Pe,[n(O).length?(r(),_(B,{key:0,data:n(O),columns:q,rounded:""},{body:f((()=>[y(I,{name:"list",tag:"div",class:"flex-list-inner"},{default:f((()=>[(r(!0),d(g,null,b(n(O),(e=>(r(),d("div",{key:e.id,class:"flex-table-item"},[y(A,{column:{media:!0,grow:!0}},{default:f((()=>[v("div",null,[v("span",Ve,T(e.title??"N/A"),1),v("span",Ie,[v("span",null,T(n(X)(e.created_at)),1)])])])),_:2},1024),y(A,null,{default:f((()=>[y(G,null,{default:f((()=>[k(T(e.type),1)])),_:2},1024)])),_:2},1024),y(A,null,{default:f((()=>[v("span",Te,"$"+T(e.proposalAmount),1)])),_:2},1024),y(A,null,{default:f((()=>[y(G,{rounded:""},{default:f((()=>[k(T(e.status),1)])),_:2},1024)])),_:2},1024),y(A,null,{default:f((()=>[y(G,{rounded:""},{default:f((()=>[k(T(e.status),1)])),_:2},1024)])),_:2},1024),y(A,{column:{align:"end"}},{default:f((()=>[y(i,{raw:"",subcontrol:""},{default:f((()=>[y(Z,{onClick:()=>{H(e)},modelValue:e.payment_status,"onUpdate:modelValue":a=>e.payment_status=a,label:"",color:"primary"},null,8,["onClick","modelValue","onUpdate:modelValue"])])),_:2},1024)])),_:2},1024)])))),128))])),_:1})])),_:1},8,["data"])):h("",!0),n(O).length>5?(r(),_($,{key:1,"item-per-page":10,"total-items":873,"current-page":42,"max-links-displayed":7})):h("",!0)])])]),n(j)?(r(),_(K,{key:0,"group-proposal-modal":n(j),selectedProposals:n(U),onRemoveProposal:H,"onUpdate:modalHandler":t[3]||(t[3]=e=>j.value=!1)},null,8,["group-proposal-modal","selectedProposals"])):h("",!0),n(R)?(r(),_(Y,{key:1,proposalSenderModal:n(R),selectedProposalsIds:n(U),"onUpdate:modalHandler":t[4]||(t[4]=e=>R.value=!1)},null,8,["proposalSenderModal","selectedProposalsIds"])):h("",!0)])])),action:f((()=>[y(c,{loading:n(w),type:"submit",color:"warning",raised:"",onClick:L},{default:f((()=>[k("Close")])),_:1},8,["loading"])])),_:1},8,["open"])}}}),[["__scopeId","data-v-2ca52735"]]),Se=p([{id:"12347",title:"Electrical Wiring",cost_code:"040100",cost_type:"Material",unit_cost:20,quantity:500,unit:"meters",total_cost:1e4,price:750,markup:15,markup_type:"percentage",markup_value:1500,markup_amount:3e3,unit_price:50,tax_rate:7.5,client_price:12000.9,total_price:9e3,builder_cost:825,group_price:78987,grand_total:12325,total_markup:9874567,mark_as:"catalogue_item",description:"Electrical wiring and related materials.",internal_notes:"Include wiring for backup generator.",created_by:"user125",created_date:"2024-12-22T12:00:00Z",updated_by:"user125",updated_date:"2024-12-22T13:00:00Z",approved_by:"manager458",approval_date:"2024-12-22T18:00:00Z",status:"pending",category:"Electrical",tags:["wiring","electrical","materials"],attachments:[],visibility:{admin:!0,internal_only:!1,shared_with_client:!1},front_end_elements:{highlighted:!1,background_color:"#f0f0f0",font_color:"#000000",display_order:3,editable:!0}},{id:"56789",title:"Plumbing Fixtures",cost_code:"050200",cost_type:"Labor",unit_cost:45,quantity:200,unit:"hours",total_cost:9e3,price:1500,markup:20,markup_type:"percentage",markup_value:1800,markup_amount:3600,unit_price:75,tax_rate:8,client_price:12000.9,total_price:10800,builder_cost:950,group_price:67890,grand_total:13200,total_markup:1234567,mark_as:"custom_item",description:"Installation of plumbing fixtures.",internal_notes:"Check water pressure before installation.",created_by:"user456",created_date:"2024-11-30T09:00:00Z",updated_by:"user456",updated_date:"2024-12-01T10:00:00Z",approved_by:"manager123",approval_date:"2024-12-01T15:00:00Z",status:"approved",category:"Plumbing",tags:["plumbing","fixtures","labor"],attachments:[],visibility:{admin:!0,internal_only:!0,shared_with_client:!1},front_end_elements:{highlighted:!0,background_color:"#ffffff",font_color:"#333333",display_order:1,editable:!1}},{id:"90123",title:"HVAC Installation",cost_code:"070300",cost_type:"Service",unit_cost:75,quantity:50,unit:"units",total_cost:3750,client_price:12000.9,price:850,markup:10,markup_type:"fixed",markup_value:850,markup_amount:1700,unit_price:95,tax_rate:6.5,total_price:4200,builder_cost:1025,group_price:56789,grand_total:15500,total_markup:654321,mark_as:"service_item",description:"HVAC system installation and setup.",internal_notes:"Ensure proper duct sealing.",created_by:"user789",created_date:"2024-12-10T14:00:00Z",updated_by:"user789",updated_date:"2024-12-15T11:30:00Z",approved_by:"manager567",approval_date:"2024-12-16T09:00:00Z",status:"completed",category:"HVAC",tags:["HVAC","installation","service"],attachments:[],visibility:{admin:!0,internal_only:!1,shared_with_client:!0},front_end_elements:{highlighted:!0,background_color:"#e6e6e6",font_color:"#111111",display_order:2,editable:!0}},{id:"34567",title:"Roofing Materials",cost_code:"080500",cost_type:"Material",unit_cost:30,quantity:1e3,unit:"sheets",total_cost:3e4,client_price:12000.9,price:1200,markup:25,markup_type:"percentage",markup_value:3e3,markup_amount:7500,unit_price:90,tax_rate:9,total_price:32700,builder_cost:1125,group_price:43210,grand_total:37500,total_markup:98765,mark_as:"material_item",description:"High-quality roofing materials.",internal_notes:"Ensure weather-resistant properties.",created_by:"user321",created_date:"2024-12-05T08:00:00Z",updated_by:"user321",updated_date:"2024-12-06T12:00:00Z",approved_by:"manager789",approval_date:"2024-12-07T14:00:00Z",status:"pending",category:"Roofing",tags:["roofing","materials","construction"],attachments:[],visibility:{admin:!1,internal_only:!0,shared_with_client:!0},front_end_elements:{highlighted:!1,background_color:"#dddddd",font_color:"#444444",display_order:4,editable:!1}}]);p({CostCode:"Cost Code",Title:"Title",Unit:"Unit",Description:"Description",CostType:"Cost Type",MarkAs:"Mark As",Quantity:"Quantity",UnitCost:"Unit Cost",BuilderCost:"Builder Cost",Markup:"Markup",MarkupAmount:"Markup Amount",Status:"Status",ClientPrice:"Client Price",GroupPrice:"Group Price",TotalCost:"Total Cost",TotalMarkup:"Total Markup",Profit:"Profit",Notes:"Internal Notes",State:"State"}),p({CostCode:"cost_code",Title:"title",Unit:"unit",Description:"description",CostType:"cost_type",MarkAs:"mark_as",Quantity:"quantity",UnitCost:"unit_cost",ClientPrice:"total_price",BuilderCost:"builder_cost",Markup:"markup",Status:"status",GroupPrice:"group_amount",TotalMarkup:"total_markup",Profit:"profit",Notes:"internal_notes",MarkupAmount:"markup_amount"});const Me={class:"columns is-multiline"},je={class:"column is-12"},Ue={class:"invoice-wrapper"},Ae=v("div",{class:"invoice-header"},[v("div",{class:"left"},[v("h3",null,"Proposal-ID PD-456-14")]),v("div",{class:"right"},[v("div",{class:"controls"},[v("a",{class:"action"},[v("i",{"aria-hidden":"true",class:"iconify","data-icon":"feather:printer"})]),v("a",{class:"action"},[v("i",{"aria-hidden":"true",class:"iconify","data-icon":"feather:download-cloud"})]),v("a",{class:"action"},[v("i",{"aria-hidden":"true",class:"iconify","data-icon":"feather:mail"})])])])],-1),qe={class:"invoice-body"},Re={class:"invoice-card"},He={class:"invoice-section is-flex is-bordered"},Oe=v("div",{class:"meta"},null,-1),Ee=v("div",{class:"end"},[v("span",null,"PO Box 242"),v("span",null,"Evergreen, CO 80437-0242"),v("span",null,"Phone: 720 272-9061"),v("span",null,"Premium Trades for Premier Builders")],-1),De=v("div",{class:"invoice-section is-flex is-bordered"},[v("div",{class:"meta"},[v("h3",null,"Client Name"),v("span",null,"Client Phone"),v("span",null,"25724 Independence Trail Evergreen, CO 80439")]),v("div",{class:"end is-left"},[v("h3",null,"Friday Jan 17, 2025"),v("p",null," Lorem ipsum dolor sit amet, consectetur adipiscing elit. Quod equidem non reprehendo. ")])],-1),Le={key:0,class:"invoice-section"},Ge={class:"responsive-table"},Ze=v("br",null,null,-1),Be=["innerHTML"],$e={class:"invoice-section is-flex mt-0 pt-0"},Fe={class:"end is-left"},Ne={class:"text-right"},ze=v("p",null,"Mentioned price are final",-1),Qe=o({__name:"ProposalViewModal",props:{previewModal:{type:Boolean},columnsToShow:{default:!1},proposalId:{default:""}},emits:["update:modalHandler","update:OnSuccess"],setup(a,{emit:t}){const o=a,s=B();l();const u=p([{name:"Website Redesign",unit:"hrs",quantity:54,rate:24},{name:"Logo Design",unit:"hrs",quantity:12,rate:24},{name:"Custom Illustrations",unit:"hrs",quantity:7,rate:32}]);i((()=>{const e=u.value.reduce(((e,a)=>e+a.quantity*a.rate),0),a=.1*e;return[{label:"Subtotal",value:e},{label:"Taxes",value:a},{label:"Total",value:e+a}]}));const m=["Item","Description","Unit Cost","Qty","Unit","Builder Cost","Markup","Total Price"];p(""),p(!0),p(!0),p(!0),p(!0);const w=i((()=>Se.value.reduce(((e,a)=>e+a.price*a.quantity),0))),P=p(!1);p({id:"c897de41-609f-4a20-8d79-0537b6a873d6",title:"Test Lead's Proposal",approval_deadline:"2025-01-30",internal_notes:null,introductory_text:null,closing_text:null,payment_status:"Pending",type:"proposal",status:"pending",created_at:"2025-01-21T19:08:06.509861Z",updated_at:"2025-01-21T19:08:06.509875Z",job:"da0aa7c1-3744-4856-a637-e5a821f5ec7e"});const V=p([{id:"5e7d026a-b392-47e9-9d24-58fbc1de12c5",index:1,title:"Test Lead Proposal Item",description:"<p>Description</p>",type:"",quantity:100,unit:"Sq ft",unit_cost:"10.00",markup:"150.00",total_price:"1150.00",cost_code:"11012",cost_type:"material",builder_cost:"1000.00",margin:"1.00",profit:"0.00",internal_notes:"Internal notes",mark_as:"bid",state:"active",group_amount:"0.00",status:null,created_at:"2025-01-23T18:25:46.392750Z",proposal:"c897de41-609f-4a20-8d79-0537b6a873d6"}]),I=()=>{t("update:modalHandler",!1)},x=async()=>{try{const e=await s.get(`api/cost/by-proposal/${o.proposalId}/`);V.value=e.data}catch(e){console.log(e)}};return c((()=>{(async()=>{try{P.value=!0,await s.get(`/api/lead-proposal/${o.proposalId}/`),x()}catch(e){console.log(e)}finally{P.value=!1}})()})),(a,l)=>{const t=ae,s=C,i=e;return r(),_(i,{is:"form",open:o.previewModal,title:"Cost Item ",size:"xl",actions:"right",onClose:I},{content:f((()=>[v("div",Me,[v("div",je,[v("div",Ue,[Ae,v("div",qe,[v("div",Re,[v("div",He,[y(t,{size:"xl",picture:"/logos/IbexFavicon.png"}),Oe,Ee]),De,n(V).length?(r(),d("div",Le,[v("table",Ge,[v("thead",null,[(r(),d(g,null,b(m,((e,a)=>v("th",{key:a},T(e),1))),64))]),v("tbody",null,[(r(!0),d(g,null,b(n(V),((e,a)=>(r(),d("tr",{key:e.id},[v("td",null,[v("span",null,T(e.title),1),Ze,v("span",null,T(e.cost_code),1)]),v("td",null,[v("span",{innerHTML:e.description},null,8,Be)]),v("td",null,[v("span",null," $"+T(e.unit_cost),1)]),v("td",null,[v("span",null,T(e.quantity),1)]),v("td",null,[v("span",null,T(e.unit),1)]),v("td",null,[v("span",null," $"+T(e.builder_cost),1)]),v("td",null,[v("span",null," $"+T(e.markup),1)]),v("td",null,[v("span",null," $"+T(e.total_price),1)])])))),128))])])])):h("",!0),v("div",$e,[v("div",Fe,[v("h3",Ne,"Total Price: $"+T(n(w)),1),ze])])])])])])])])),action:f((()=>[y(s,{loading:n(P),type:"submit",color:"warning",raised:"",onClick:I},{default:f((()=>[k("Close")])),_:1},8,["loading"])])),_:1},8,["open"])}}}),Je={key:0,class:"text-center py-4"},We={key:1},Ke={class:"table is-striped is-fullwidth"},Ye=(e=>(x("data-v-871fd9a4"),e=e(),S(),e))((()=>v("thead",null,[v("tr",null,[v("th",{scope:"col"},"Title"),v("th",{scope:"col"},"Amount"),v("th",{scope:"col"},"Cost Items"),v("th",{scope:"col"},"Approval Deadline"),v("th",{scope:"col"},"Status"),v("th",{scope:"col",class:"is-end"},[v("div",{class:"dark-inverted is-flex is-justify-content-flex-end"}," Select ")])])],-1))),Xe={class:"capitalize"},ea={class:"is-end"},aa={class:"is-flex is-justify-content-flex-end"},la=P(o({__name:"OpenTempalteModal",props:{opentempalte:{type:Boolean},proposalId:{},leadId:{}},emits:["update:modalHandler","update:OnSuccess"],setup(a,{emit:l}){const t=a,o=B(),s=$(),n=p([]),i=p(null),u=p(!1),m=()=>{l("update:modalHandler",!1)},h=async()=>{i.value?await w(i.value):s.error("Please select a template")},w=async e=>{try{const a=await o.post(`/api/lead-proposal/${e}/import-template/`,{existing_proposal:t.proposalId||"",lead:t.leadId});l("update:OnSuccess",a.data),console.log("test123"),s.success("Template imported successfully!"),m()}catch(a){console.error("Error importing template:",a),s.error("Something went wrong, try again")}};return c((()=>{(async()=>{u.value=!0;try{const e=await o.get("/api/lead-proposal/templates/");n.value=e.data}catch(e){s.error("Failed to fetch templates"),console.error(e)}finally{u.value=!1}})()})),(a,l)=>{const o=L,s=D,p=C,c=e;return r(),_(c,{open:t.opentempalte,size:"big",title:"Template List",actions:"right",onClose:m},{content:f((()=>[u.value?(r(),d("div",Je,"Loading...")):(r(),d("div",We,[v("table",Ke,[Ye,v("tbody",null,[(r(!0),d(g,null,b(n.value,(e=>(r(),d("tr",{key:e.id},[v("td",null,T(e.title),1),v("td",null,T(e.proposalAmount),1),v("td",null,T(e.cost_items),1),v("td",null,T(e.approval_deadline),1),v("td",Xe,T(e.status),1),v("td",ea,[v("div",aa,[y(s,{raw:"",subcontrol:""},{default:f((()=>[y(o,{modelValue:i.value,"onUpdate:modelValue":l[0]||(l[0]=e=>i.value=e),value:e.id,name:"templateSelection"},null,8,["modelValue","value"])])),_:2},1024)])])])))),128))])])]))])),action:f((()=>[y(p,{color:"primary",raised:"",onClick:h},{default:f((()=>[k("Confirm")])),_:1})])),cancel:f((()=>[y(p,{color:"primary",style:{display:"none"},raised:""},{default:f((()=>[k("Close")])),_:1})])),_:1},8,["open"])}}}),[["__scopeId","data-v-871fd9a4"]]),ta={class:"modal-form columns is-multiline"},oa={class:"column is-12"},sa={class:"columns is-multiline"},na={class:"field column is-6 mb-0"},ia=v("label",null,"Title: *",-1),ra={class:"control"},da={class:"field column is-6"},ua=v("label",null,"Approval Deadline *",-1),pa={class:"control"},ca={class:"column is-6"},ma={class:"field column is-3"},_a=v("label",{class:"mb-3"},"Attachments",-1),fa=v("div",{class:"file"},[v("label",{class:"file-label"},[v("input",{class:"file-input",type:"file",name:"resume",style:{width:"100%"}}),v("span",{class:"file-cta"},[v("span",{class:"file-icon"},[v("i",{class:"fas fa-cloud-upload-alt"})]),v("span",{class:"file-label"}," Choose a file… ")])])],-1),va={class:"column is-3 pt-5"},ya={class:"column is-12"},ga={class:"body-inner-content columns is-multiline"},ba={class:"field column is-12"},ha=v("label",{for:"",class:"label"},"Internal Notes",-1),ka={class:"field column is-12 mb-0"},wa=v("label",{for:"",class:"label"},"Introductory Text",-1),Ca={class:"field column is-12 mb-0"},Pa=v("label",{for:"",class:"label"},"Closing Text",-1),Va={class:"column is-12",id:"items-div"},Ia={key:0},Ta=o({__name:"LeadProposalModal",props:{leadProposalModal:{type:Boolean},proposalId:{},leadId:{}},emits:["update:modalHandler","update:OnSuccess","clearProposalId"],setup(a,{emit:o}){const s=a;l();const i=M();le();const u=$(),m=B(),g=p(!1),b=p(!1),P=p({id:"",title:"",approval_deadline:"",internal_notes:"",introductory_text:null,closing_text:null,payment_status:"",worksheetItems:[],type:"proposal",project:"",attachments:[],columns_to_show:[],status:"",created_at:"",updated_at:""}),V=async(e=!1)=>{try{g.value=!0,s.leadId&&(P.value.project=s.leadId),P.value.columns_to_show=JSON.stringify(te.value);const a=ee(P.value,[]);if(s.proposalId||P.value.id){const e=await m.patch(`/api/lead-proposal/${s.proposalId?s.proposalId:P.value.id}/`,a);P.value=e.data}else{const e=await m.post("/api/lead-proposal/",a);P.value=e.data,I(100)}S(),e&&x(),u.success(`Proposal ${s.proposalId||P.value.id?"updated":"created"} successfully`)}catch(a){u.error("Something went wrong, try again")}finally{g.value=!1}},I=(e=0)=>{const a=document.getElementById("items-div");if(a){const l=a.offsetTop-e;window.scrollTo({top:l,behavior:"smooth"})}},x=()=>{o("update:modalHandler",!1)},S=()=>{o("update:OnSuccess",null)},O=j((()=>U((()=>import("./ckeditor-3d05ba6e.js").then((e=>e.c))),["assets/ckeditor-3d05ba6e.js","assets/index-70b05a5f.js","assets/index-ce8747cd.css","assets/vue.runtime.esm-bundler-ac2bf98e.js"]).then((e=>e.default.component)))),G={fontFamily:{options:['"Montserrat", sans-serif','"Roboto", sans-serif']},height:"400px",minHeight:"400px"},Z=p(!1),F=e=>{P.value=e,console.log("test12")};return c((async()=>{i.value=await U((()=>import("./ckeditor-445c3f9b.js").then((e=>e.c))),["assets/ckeditor-445c3f9b.js","assets/index-70b05a5f.js","assets/index-ce8747cd.css"]).then((e=>e.default)),s.proposalId&&(async()=>{try{const e=await m.get(`/api/lead-proposal/${s.proposalId}/`);P.value=e.data,te.value=e.data.columns_to_show}catch(e){console.log(e)}})()})),A((()=>{o("clearProposalId",null),P.value={}})),(a,l)=>{const o=L,u=D,p=E,c=C,m=H,I=t,S=la,M=e;return r(),_(M,{is:"form",open:s.leadProposalModal,title:"Lead Proposal",size:"xl",actions:"right",onSubmit:l[12]||(l[12]=w((e=>V(!1)),["prevent"])),onClose:x},{content:f((()=>[v("div",ta,[v("div",oa,[v("div",sa,[v("div",na,[ia,v("div",ra,[q(v("input",{type:"text",name:"title","onUpdate:modelValue":l[0]||(l[0]=e=>n(P).title=e),required:"",class:"input is-primary-focus is-primary-focus",placeholder:"Proposal Title"},null,512),[[R,n(P).title]])])]),v("div",da,[ua,v("div",pa,[q(v("input",{type:"date",name:"firstName","onUpdate:modelValue":l[1]||(l[1]=e=>n(P).approval_deadline=e),required:"",class:"input is-primary-focus is-primary-focus",placeholder:"Proposal Approval deadline"},null,512),[[R,n(P).approval_deadline]])])]),v("div",ca,[y(p,{class:"m-0 p-0",label:"Type"},{default:f((()=>[y(u,null,{default:f((()=>[y(o,{modelValue:n(P).type,"onUpdate:modelValue":l[2]||(l[2]=e=>n(P).type=e),value:"proposal",label:"Proposal",name:"solid_squared_radio",color:"primary",square:"",solid:""},null,8,["modelValue"]),y(o,{modelValue:n(P).type,"onUpdate:modelValue":l[3]||(l[3]=e=>n(P).type=e),value:"change_order",label:"Change Order",name:"solid_squared_radio",color:"info",square:"",solid:""},null,8,["modelValue"]),y(o,{modelValue:n(P).type,"onUpdate:modelValue":l[4]||(l[4]=e=>n(P).type=e),value:"draft",label:"Draft",name:"solid_squared_radio",color:"warning",square:"",solid:""},null,8,["modelValue"])])),_:1})])),_:1})]),v("div",ma,[_a,y(p,{grouped:"",class:"mt-3"},{default:f((()=>[y(u,null,{default:f((()=>[fa])),_:1})])),_:1})]),v("div",va,[y(c,{color:"primary",class:"mt-5",onClick:l[5]||(l[5]=e=>Z.value=!n(Z)),style:{width:"100%"}},{default:f((()=>[k("Import Template")])),_:1})]),v("div",ya,[v("div",ga,[v("div",ba,[ha,y(p,null,{default:f((()=>[y(u,null,{default:f((()=>[y(m,{modelValue:n(P).internal_notes,"onUpdate:modelValue":l[6]||(l[6]=e=>n(P).internal_notes=e),rows:"4",placeholder:"Internal notes..."},null,8,["modelValue"])])),_:1})])),_:1})]),v("div",ka,[wa,n(i)?(r(),_(n(O),{key:0,modelValue:n(P).introductory_text,"onUpdate:modelValue":l[7]||(l[7]=e=>n(P).introductory_text=e),editor:n(i),config:G},null,8,["modelValue","editor"])):h("",!0)]),v("div",Ca,[Pa,n(i)?(r(),_(n(O),{key:0,modelValue:n(P).closing_text,"onUpdate:modelValue":l[8]||(l[8]=e=>n(P).closing_text=e),editor:n(i),config:G},null,8,["modelValue","editor"])):h("",!0)])])])])]),v("div",Va,[n(P).id||s.proposalId?(r(),d("div",Ia,[y(I,{proposalId:n(P).id?n(P).id:s.proposalId,proposalData:n(P)},null,8,["proposalId","proposalData"])])):h("",!0)])]),n(Z)?(r(),_(S,{key:0,leadId:s.leadId,proposalId:s.proposalId,opentempalte:n(Z),"onUpdate:OnSuccess":F,"onUpdate:modalHandler":l[9]||(l[9]=e=>Z.value=!1)},null,8,["leadId","proposalId","opentempalte"])):h("",!0)])),action:f((()=>[y(c,{loading:n(g),type:"submit",color:"primary",raised:""},{default:f((()=>[k(T(s.proposalId||n(P).id?"Update Proposal":"Create Proposal"),1)])),_:1},8,["loading"]),y(c,{loading:n(b),onClick:l[10]||(l[10]=e=>V(!0)),color:"info",raised:""},{default:f((()=>[k(T(s.proposalId||n(P).id?"Update & Close":"Create & Close"),1)])),_:1},8,["loading"])])),cancel:f((()=>[y(c,{onClick:l[11]||(l[11]=e=>x()),raised:""},{default:f((()=>[k("Close")])),_:1})])),_:1},8,["open"])}}}),xa={onHold:"warning",open:"info",sold:"success",lost:"danger"},Sa={onHold:"On Hold",open:"Open",sold:"Sold",lost:"Lost"},Ma={pending:"info",approved:"success",approve:"success",review:"warning",disapprove:"danger"},ja={pending:"Pending",approved:"Approved",approve:"Approved",review:"Require Review",disapprove:"Disapproved"},Ua={proposal:"primary",change_order:"warning",draft:"light"},Aa={proposal:"Proposal",change_order:"Change Order",draft:"Draft"},qa=[{value:"call",label:"Phone Call"},{value:"email",label:"Email"},{value:"followup",label:"Follow Up"},{value:"visit",label:"Site Visit"},{value:"form",label:"Website Form"}];export{Ta as _,ja as a,Qe as b,xe as c,xa as d,Ua as e,Aa as f,Ma as g,qa as h,Sa as i};
