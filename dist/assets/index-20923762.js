import{_ as e}from"./CreateProposalTasksModal-2a002abe.js";import{_ as a}from"./SweetAlert.vue_vue_type_style_index_0_lang-850b3f73.js";import{_ as l}from"./LeadAddUpdateModal.vue_vue_type_style_index_0_lang-8acbb8e7.js";import{_ as t}from"./VFlexPagination.vue_vue_type_script_setup_true_lang-9d435fa3.js";import{_ as s,c as n}from"./VFlexTable.vue_vue_type_style_index_0_lang-e854eff7.js";import{_ as i}from"./VTag.vue_vue_type_style_index_0_lang-e97790b2.js";import{_ as o}from"./VAvatar.vue_vue_type_style_index_0_lang-1d1ef4db.js";import{_ as r}from"./VPlaceholderPage.vue_vue_type_style_index_0_lang-98f52303.js";import{f as u,r as d,x as c,y as p,$ as _,o as m,av as v,C as f,D as y,m as g,O as b,E as j,F as h,G as k,L as x,X as w,k as C,V,W as A,K as S,N as I,aS as L,P,al as O,U,J as $,A as M}from"./index-ebe3ec19.js";import{_ as N}from"./VDropdown.vue_vue_type_style_index_0_lang-2036237f.js";import{_ as T}from"./VField.vue_vue_type_script_setup_true_lang-cfbb2fbb.js";import{_ as D}from"./VControl-0c6a1405.js";import{_ as F}from"./PlaceloadV1.vue_vue_type_style_index_0_lang-c9a092b7.js";import{_ as q,a as E}from"./search-4-dark-2b5b440c.js";import{u as H}from"./useAPI-51d690ef.js";import{u as J}from"./useNotyf-0d335162.js";import{d as W,i as z}from"./useSupportElement-b9e097c1.js";import{f as B,h as X}from"./estimatesScripts-99b5099c.js";import{u as R}from"./viewWrapper-84a185a0.js";import{b as Z}from"./route-block-83d24a4e.js";import"./VModal.vue_vue_type_style_index_0_lang-d69e7fb7.js";import"./VRadio.vue_vue_type_style_index_0_lang-55d250f9.js";import"./VLabel.vue_vue_type_script_setup_true_lang-415eec9b.js";import"./useVFieldContext-84670641.js";import"./UnitAddUpdateModal.vue_vue_type_script_setup_true_lang-9b910b6e.js";import"./VTextarea.vue_vue_type_script_setup_true_lang-112e363c.js";import"./VCheckbox.vue_vue_type_style_index_0_lang-61c18609.js";import"./VInput.vue_vue_type_script_setup_true_lang-2a5c8b19.js";import"./VOption.vue_vue_type_style_index_0_lang-997d4a12.js";import"./costItems-4a0a49ec.js";import"./VIconButton-d6a77bb0.js";import"./company-c1631a54.js";import"./LeadProposalsList.vue_vue_type_style_index_0_lang-8f1c56ba.js";import"./ProposalViewModal.vue_vue_type_style_index_0_lang-6fd1ef4f.js";import"./V-Snack.vue_vue_type_style_index_0_lang-98c33411.js";import"./VIcon.vue_vue_type_script_setup_true_lang-3514b5f9.js";import"./VSwitchBlock.vue_vue_type_style_index_0_lang-2e1a22f4.js";import"./ScheduleEmailModal.vue_vue_type_script_setup_true_lang-5d0481c8.js";import"./ckeditor-c46087fc.js";import"./vue.runtime.esm-bundler-880ac416.js";import"./ckeditor-902b1d58.js";import"./VFlex.vue_vue_type_style_index_0_lang-540672db.js";import"./useDropdown-1e43146f.js";import"./VPlaceloadWrap-ab730e4e.js";import"./VPlaceloadText.vue_vue_type_style_index_0_lang-13365529.js";import"./VPlaceloadAvatar.vue_vue_type_style_index_0_lang-94f313f6.js";import"./notyf-c99f0315.js";import"./useThemeColors-70b40381.js";const G={key:1},K={class:"list-flex-toolbar columns is-multiline"},Q={class:"column is-6 is-flex"},Y=["value","onClick"],ee={class:"meta"},ae={class:"column is-6 is-flex is-justify-content-end"},le={class:"page-content-inner"},te={class:"flex-list-wrapper flex-list-v1"},se=j("img",{class:"light-image",src:q,alt:""},null,-1),ne=j("img",{class:"dark-image",src:E,alt:""},null,-1),ie={class:"item-name dark-inverted"},oe={key:0},re={class:"item-meta show-text-200"},ue={key:0},de={class:"item-name dark-inverted"},ce={class:"item-meta"},pe={key:1},_e={class:"item-name dark-inverted"},me={class:"item-meta"},ve={class:"item-name dark-inverted"},fe={class:"item-meta"},ye=["onClick"],ge=[j("div",{class:"icon"},[j("i",{"aria-hidden":"true",class:"lnil lnil-eye"})],-1),j("div",{class:"meta"},[j("span",null,"View"),j("span",null,"View user details")],-1)],be=["onClick"],je=[j("div",{class:"icon"},[j("i",{class:"lnil lnil-copy","aria-hidden":"true"})],-1),j("div",{class:"meta"},[j("span",null,"Add Proposals"),j("span",null,"Add new proposal to lead")],-1)],he=["onClick"],ke=[j("div",{class:"icon"},[j("i",{"aria-hidden":"true",class:"lnil lnil-pencil"})],-1),j("div",{class:"meta"},[j("span",null,"Edit"),j("span",null,"Update Lead Info")],-1)],xe=j("hr",{class:"dropdown-divider"},null,-1),we=["onClick"],Ce=[j("div",{class:"icon"},[j("i",{class:"lnil lnil-checkmark","aria-hidden":"true"})],-1),j("div",{class:"meta"},[j("span",null,"Mark As Done"),j("span",null,"Mark Job As Completed")],-1)],Ve=["onClick"],Ae=[j("div",{class:"icon"},[j("i",{"aria-hidden":"true",class:"lnil lnil-trash-can-alt"})],-1),j("div",{class:"meta"},[j("span",null,"Delete"),j("span",null,"Delete Proposal Permanently")],-1)],Se=u({__name:"LeadsList",setup(u){const M=d(""),q=c(),E=J(),R=H(),Z=d(),Se=d([{id:"54985a54-db61-4761-becd-3b35f8ec503e",sales_people_info:[],clientInfo:null,created_by_info:null,manager_info:null,title:"test job",address:null,current_state:"lead",city:null,state:null,status:null,zip_code:null,confidence:"0.00",image:"",sale_date:null,tags:[],estimated_from:null,estimated_to:null,sources:null,project_type:null,notes:null,attach_mail:null,created:"2025-01-15T19:55:18.448485Z",updated_at:"2025-01-15T19:55:18.448510Z",created_by:null,manager:null,client:null,sales_people:[]}]);d(1);const Ie=d(20),Le=d(""),Pe=p(),Oe=d(""),Ue=d(!1),$e=d(!1),Me=d([{value:"open",label:"Open"},{value:"sold",label:"Sold"},{value:"lost",label:"Lost"},{value:"onHold",label:"On hold"}]),Ne={location:{label:"Job",grow:!0},username:{label:"Contractor/Client",grow:!0},contacts:"Date Created",status:"Lead Status",industry:"Manager",actions:{label:"Actions",align:"end"}},Te=async()=>{try{Z.value=!0;const e=await R.get("/api/project/project-leads/");Se.value=e.data}catch(e){E.error(` ${e}, Lead`)}finally{Z.value=!1}},De=e=>{M.value=e,$e.value=!0},Fe=d({title:"",subtitle:"test",isSweetAlertOpen:!1,btntext:"text"}),qe=d(!1),Ee=async()=>{try{Z.value=!0;await R.delete(`/api/project/${M.value}/`);E.info("Lead deleted successfully"),Te()}catch(e){E.error(` ${e}, Lead`),E.error("Something went wrong please try later")}finally{Z.value=!1,Fe.value.isSweetAlertOpen=!1}},He=_((()=>{let e=Pe.query.page;return e=null==e||"undefined"==e?1:Pe.query.page,Number.parseInt(Pe.query.page)||1})),Je=_((()=>{if(Le.value){const e=new RegExp(Le.value,"i");return Se.value.filter((a=>a.title?.match(e)||a.address?.match(e)||a.clientInfo?.username?.match(e)||a.clientInfo?.last_name?.match(e)||a.clientInfo?.username?.match(e)||a.city?.match(e)||a.created?.match(e)))}return Se.value})),We=_((()=>Oe.value?Je.value?.filter((e=>e.leadStatus==Oe.value)):Je.value)),ze=_((()=>{const e=(He.value-1)*Ie.value,a=e+Ie.value;return We.value.slice(e,a)}));return m((()=>{Te()})),(u,d)=>{const c=F,p=D,_=T,m=N,H=P,J=O,Pe=r,Je=o,Be=n,Xe=i,Re=s,Ze=t,Ge=l,Ke=a,Qe=e,Ye=v("tooltip");return f(),y("div",null,[g(Z)?(f(),b(c,{key:0})):(f(),y("div",G,[j("div",K,[j("div",Q,[h(_,null,{default:k((()=>[h(p,{icon:"feather:search"},{default:k((()=>[x(j("input",{"onUpdate:modelValue":d[0]||(d[0]=e=>C(Le)?Le.value=e:null),class:"input custom-text-filter",placeholder:"Search..."},null,512),[[w,g(Le)]])])),_:1})])),_:1}),h(m,{title:"Apply sorting",modern:"",spaced:""},{content:k((()=>[(f(!0),y(V,null,A(g(Me),(e=>(f(),y("a",{value:e.value,class:"dropdown-item is-media",onClick:a=>Oe.value=e.value},[j("div",ee,[j("span",null,U(e.label),1)])],8,Y)))),256))])),_:1})]),j("div",ae,[h(J,null,{default:k((()=>[h(H,{onClick:d[1]||(d[1]=e=>De("")),color:"primary",icon:"fas fa-plus",elevated:""},{default:k((()=>[S(" Lead Opportunity ")])),_:1})])),_:1})])]),j("div",le,[j("div",te,[g(We)?.length?I("",!0):(f(),b(Pe,{key:0,title:"We couldn't find any matching results.",subtitle:"Too bad. Looks like we couldn't find any matching results for the\n          search terms you've entered. Please try different search terms or\n          criteria.",larger:""},{image:k((()=>[se,ne])),_:1})),g(ze)?.length?(f(),b(Re,{key:1,data:g(ze),columns:Ne,compact:""},{body:k((()=>[h(L,{name:"list",tag:"div",class:"flex-list-inner"},{default:k((()=>[(f(!0),y(V,null,A(g(ze),(e=>(f(),y("div",{key:e.id,class:"flex-table-item"},[h(Be,{onClick:()=>{g(q).push(`/sidebar/dashboard/jobs/${e.id}`)},class:"cu-pointer",column:{media:!0,grow:!0}},{default:k((()=>[h(Je,{picture:e.image?e.image:"/IbexImages/home-icon.png",squared:"",size:"medium"},null,8,["picture"]),j("div",null,[j("span",ie,[S(U(e.contractor_info?.username?e.contractor_info?.username:"")+" "+U(e.contractor_info?.last_name?e.contractor_info?.last_name:"")+" "+U(e.clientInfo?.username?e.clientInfo?.username:"")+" ",1),e.contractor_info?.username||e.clientInfo?.username?(f(),y("span",oe,"-")):I("",!0),S(U(e.title?e.title:"N/A"),1)]),j("span",re,[j("span",null,U(e.address?e.address:"N/A"),1)])])])),_:2},1032,["onClick"]),h(Be,{onClick:()=>{g(q).push(`/sidebar/dashboard/jobs/${e.id}`)},class:"cu-pointer",column:{media:!0,grow:!0}},{default:k((()=>[e.clientInfo?(f(),y("div",ue,[j("span",de,U(e.clientInfo?.username?e.clientInfo?.username:"N/A"),1),j("span",ce,[j("span",null,U(e.clientInfo?.email?e.clientInfo?.email:"N/A"),1)])])):e.contractor_info?(f(),y("div",pe,[j("span",_e,U(e.contractor_info?.username?e.contractor_info?.username:"N/A")+" "+U(e.contractor_info?.last_name?e.contractor_info?.last_name:"N/A"),1),j("span",me,[j("span",null,U(e.contractor_info?.email?e.contractor_info?.email:"N/A"),1)])])):I("",!0)])),_:2},1032,["onClick"]),h(Be,{onClick:()=>{g(q).push(`/sidebar/dashboard/jobs/${e.id}`)},class:"cu-pointer",column:{media:!0}},{default:k((()=>[j("div",null,[j("span",ve,U(g(W)(e.created)),1),j("span",fe,[j("span",null,"At:"+U(g(z)(e.created)),1)])])])),_:2},1032,["onClick"]),h(Be,{onClick:()=>{g(q).push(`/sidebar/dashboard/jobs/${e.id}`)},class:"cu-pointer"},{default:k((()=>[h(Xe,{color:g(B)[e.leadStatus],rounded:""},{default:k((()=>[S(U(g(X)[e.leadStatus]),1)])),_:2},1032,["color"])])),_:2},1032,["onClick"]),h(Be,{onClick:()=>{g(q).push(`/sidebar/dashboard/jobs/${e.id}`)},class:"cu-pointer",column:{media:!0}},{default:k((()=>[j("div",null,[(f(!0),y(V,null,A(e.managers_list,(e=>x((f(),b(Je,{initials:e.username.slice(0,2),picture:e.avatar,color:"primary",size:"small"},null,8,["initials","picture"])),[[Ye,`${e.username} ${e.last_name??""}`,void 0,{center:!0,primary:!0,rounded:!0}]]))),256))])])),_:2},1032,["onClick"]),h(Be,{column:{align:"end"}},{default:k((()=>[h(m,{icon:"feather:more-vertical",class:"is-pushed-mobile",spaced:"",right:""},{content:k((({close:a})=>[j("a",{role:"menuitem",class:"dropdown-item is-media",onClick:()=>{g(q).push(`/sidebar/dashboard/jobs/${e.id}`)}},ge,8,ye),j("a",{role:"menuitem",onClick:a=>{return l=e.id,M.value=l,void(Ue.value=!Ue.value);var l},class:"dropdown-item is-media"},je,8,be),j("a",{role:"menuitem",class:"dropdown-item is-media",onClick:$((a=>De(e.id)),["prevent"])},ke,8,he),xe,j("a",{role:"menuitem",onClick:a=>(async(e="")=>{try{qe.value=!0,await R.patch(`/api/project/${e}/`,{status:"completed"}),E.success("Jobs Completed Successfully."),Te()}catch(a){console.log(a)}finally{qe.value=!1}})(e.id),class:"dropdown-item is-media"},Ce,8,we),j("a",{role:"menuitem",class:"dropdown-item is-media",onClick:$((a=>{return l=e.id,M.value=l,void(Fe.value={title:"Delete Lead?",subtitle:"Are you sure to delete this Lead? After delete you will not be able to recover it again.",btntext:"Delete",isSweetAlertOpen:!0});var l}),["prevent"])},Ae,8,Ve)])),_:2},1024)])),_:2},1024)])))),128))])),_:1})])),_:1},8,["data"])):I("",!0),g(Se)?.length>g(Ie)?(f(),b(Ze,{key:2,"item-per-page":g(Ie),modelValue:g(He),"onUpdate:modelValue":d[2]||(d[2]=e=>C(He)?He.value=e:null),"total-items":g(Se).length,"current-page":g(He),"max-links-displayed":7},null,8,["item-per-page","modelValue","total-items","current-page"])):I("",!0)])])])),g($e)?(f(),b(Ge,{key:2,addUpdateLeadModal:g($e),leadId:g(M),"onUpdate:modalHandler":d[3]||(d[3]=e=>$e.value=!1),"onUpdate:OnSuccess":Te},null,8,["addUpdateLeadModal","leadId"])):I("",!0),g(Fe).isSweetAlertOpen?(f(),b(Ke,{key:3,isSweetAlertOpen:g(Fe).isSweetAlertOpen,title:g(Fe).title,subtitle:g(Fe).subtitle,loading:g(Z),btntext:g(Fe).btntext,onConfirm:Ee,onCancel:()=>g(Fe).isSweetAlertOpen=!1},null,8,["isSweetAlertOpen","title","subtitle","loading","btntext","onCancel"])):I("",!0),g(Ue)?(f(),b(Qe,{key:4,"lead-proposal-modal":g(Ue),"lead-id":g(M),"onUpdate:modalHandler":d[4]||(d[4]=e=>Ue.value=!1),"onUpdate:OnSuccess":Te},null,8,["lead-proposal-modal","lead-id"])):I("",!0)])}}}),Ie=u({__name:"index",setup:e=>(R().setPageTitle("Lead Opportunities"),M({title:"Lead Opportunities - Ibex"}),(e,a)=>{const l=Se;return f(),y("div",null,[h(l)])})});"function"==typeof Z&&Z(Ie);export{Ie as default};
