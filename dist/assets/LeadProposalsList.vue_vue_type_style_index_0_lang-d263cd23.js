import{_ as e}from"./SweetAlert.vue_vue_type_style_index_0_lang-d72081e6.js";import{_ as l}from"./VModal.vue_vue_type_style_index_0_lang-d2bfe783.js";import{e as a,r as t,Z as s,o,B as n,N as i,F as r,D as d,E as u,l as p,C as c,U as m,V as v,M as _,T as f,J as y,O as b,s as g,b as h,_ as x,i as w,H as k,G as I,K as P,W as C,I as V,v as T,x as j,j as A,aR as O}from"./index-5ef4b004.js";import{_ as S}from"./VAvatar.vue_vue_type_style_index_0_lang-17f6d66a.js";import{u as D,c as q,_ as L}from"./WorksheetItems.vue_vue_type_script_setup_true_lang-c344ace5.js";import{u as $}from"./useAPI-9ed6129f.js";import{_ as M}from"./VCollapse.vue_vue_type_style_index_0_lang-0b3654a3.js";import{_ as U}from"./VTextarea.vue_vue_type_script_setup_true_lang-282e7ede.js";import{_ as H}from"./VField.vue_vue_type_script_setup_true_lang-3b3b84f8.js";import{_ as N}from"./VControl-b58d2761.js";import{_ as E}from"./VRadio.vue_vue_type_style_index_0_lang-4471a8b9.js";import{u as F}from"./useNotyf-25049f18.js";import{a as R,e as W,g as B}from"./useSupportElement-5a413a4a.js";import{u as J}from"./userSession-03919bcf.js";import{_ as Z}from"./VFlexPagination.vue_vue_type_script_setup_true_lang-407be46c.js";import{_ as z}from"./VPlaceholderPage.vue_vue_type_style_index_0_lang-93b1c51f.js";import{_ as K,c as G}from"./VFlexTable.vue_vue_type_style_index_0_lang-d4b70ca1.js";import{_ as Q}from"./VDropdown.vue_vue_type_style_index_0_lang-05fd7e90.js";import{_ as Y}from"./VTag.vue_vue_type_style_index_0_lang-1e828c4f.js";import{_ as X}from"./PlaceloadV1.vue_vue_type_style_index_0_lang-02ee5366.js";import{_ as ee,a as le}from"./search-4-dark-2b5b440c.js";const ae={class:"columns is-multiline"},te={class:"column is-12"},se={class:"invoice-wrapper"},oe=d("div",{class:"invoice-header"},[d("div",{class:"left"},[d("h3",null,"Proposal-ID PD-456-14")]),d("div",{class:"right"},[d("div",{class:"controls"},[d("a",{class:"action"},[d("i",{"aria-hidden":"true",class:"iconify","data-icon":"feather:printer"})]),d("a",{class:"action"},[d("i",{"aria-hidden":"true",class:"iconify","data-icon":"feather:download-cloud"})]),d("a",{class:"action"},[d("i",{"aria-hidden":"true",class:"iconify","data-icon":"feather:mail"})])])])],-1),ne={class:"invoice-body"},ie={class:"invoice-card"},re={class:"invoice-section is-flex is-bordered"},de=d("div",{class:"meta"},null,-1),ue=d("div",{class:"end"},[d("span",null,"PO Box 242"),d("span",null,"Evergreen, CO 80437-0242"),d("span",null,"Phone: 720 272-9061"),d("span",null,"Premium Trades for Premier Builders")],-1),pe=d("div",{class:"invoice-section is-flex is-bordered"},[d("div",{class:"meta"},[d("h3",null,"Client Name"),d("span",null,"Client Phone"),d("span",null,"25724 Independence Trail Evergreen, CO 80439")]),d("div",{class:"end is-left"},[d("h3",null,"Friday Jan 17, 2025"),d("p",null," Lorem ipsum dolor sit amet, consectetur adipiscing elit. Quod equidem non reprehendo. ")])],-1),ce={key:0,class:"invoice-section"},me={class:"responsive-table"},ve=d("br",null,null,-1),_e=["innerHTML"],fe={class:"invoice-section is-flex mt-0 pt-0"},ye={class:"end is-left"},be={class:"text-right"},ge=d("p",null,"Mentioned price are final",-1),he=a({__name:"ProposalViewModal",props:{previewModal:{type:Boolean},columnsToShow:{default:!1},proposalId:{default:""}},emits:["update:modalHandler","update:OnSuccess"],setup(e,{emit:a}){const g=e,h=$();D();const x=t([{name:"Website Redesign",unit:"hrs",quantity:54,rate:24},{name:"Logo Design",unit:"hrs",quantity:12,rate:24},{name:"Custom Illustrations",unit:"hrs",quantity:7,rate:32}]);s((()=>{const e=x.value.reduce(((e,l)=>e+l.quantity*l.rate),0),l=.1*e;return[{label:"Subtotal",value:e},{label:"Taxes",value:l},{label:"Total",value:e+l}]}));const w=["Item","Description","Unit Cost","Qty","Unit","Builder Cost","Markup","Total Price"];t(""),t(!0),t(!0),t(!0),t(!0);const k=s((()=>q.value.reduce(((e,l)=>e+l.price*l.quantity),0))),I=t(!1);t({id:"c897de41-609f-4a20-8d79-0537b6a873d6",title:"Test Lead's Proposal",approval_deadline:"2025-01-30",internal_notes:null,introductory_text:null,closing_text:null,payment_status:"Pending",type:"proposal",status:"pending",created_at:"2025-01-21T19:08:06.509861Z",updated_at:"2025-01-21T19:08:06.509875Z",job:"da0aa7c1-3744-4856-a637-e5a821f5ec7e"});const P=t([{id:"5e7d026a-b392-47e9-9d24-58fbc1de12c5",index:1,title:"Test Lead Proposal Item",description:"<p>Description</p>",type:"",quantity:100,unit:"Sq ft",unit_cost:"10.00",markup:"150.00",total_price:"1150.00",cost_code:"11012",cost_type:"material",builder_cost:"1000.00",margin:"1.00",profit:"0.00",internal_notes:"Internal notes",mark_as:"bid",state:"active",group_amount:"0.00",status:null,created_at:"2025-01-23T18:25:46.392750Z",proposal:"c897de41-609f-4a20-8d79-0537b6a873d6"}]),C=()=>{a("update:modalHandler",!1)},V=async()=>{try{const e=await h.get(`api/cost/by-proposal/${g.proposalId}/`);P.value=e.data}catch(e){console.log(e)}};return o((()=>{(async()=>{try{I.value=!0,await h.get(`/api/lead-proposal/${g.proposalId}/`),V()}catch(e){console.log(e)}finally{I.value=!1}})()})),(e,a)=>{const t=S,s=b,o=l;return n(),i(o,{is:"form",open:g.previewModal,title:"Cost Item ",size:"xl",actions:"right",onClose:C},{content:r((()=>[d("div",ae,[d("div",te,[d("div",se,[oe,d("div",ne,[d("div",ie,[d("div",re,[u(t,{size:"xl",picture:"/logos/IbexFavicon.png"}),de,ue]),pe,p(P).length?(n(),c("div",ce,[d("table",me,[d("thead",null,[(n(),c(m,null,v(w,((e,l)=>d("th",{key:l},f(e),1))),64))]),d("tbody",null,[(n(!0),c(m,null,v(p(P),((e,l)=>(n(),c("tr",{key:e.id},[d("td",null,[d("span",null,f(e.title),1),ve,d("span",null,f(e.cost_code),1)]),d("td",null,[d("span",{innerHTML:e.description},null,8,_e)]),d("td",null,[d("span",null," $"+f(e.unit_cost),1)]),d("td",null,[d("span",null,f(e.quantity),1)]),d("td",null,[d("span",null,f(e.unit),1)]),d("td",null,[d("span",null," $"+f(e.builder_cost),1)]),d("td",null,[d("span",null," $"+f(e.markup),1)]),d("td",null,[d("span",null," $"+f(e.total_price),1)])])))),128))])])])):_("",!0),d("div",fe,[d("div",ye,[d("h3",be,"Total Price: $"+f(p(k)),1),ge])])])])])])])])),action:r((()=>[u(s,{loading:p(I),type:"submit",color:"warning",raised:"",onClick:C},{default:r((()=>[y("Close")])),_:1},8,["loading"])])),_:1},8,["open"])}}}),xe={class:"modal-form columns is-multiline"},we={class:"tabs-wrapper column is-12 m-0"},ke={class:"tabs-inner"},Ie={class:"tabs is-boxed"},Pe=[d("span",null,"Proposal",-1)],Ce=[d("span",null,"Worksheet",-1)],Ve={key:0,class:"columns is-multiline"},Te={class:"field column is-6 mb-0"},je=d("label",null,"Title: *",-1),Ae={class:"control"},Oe={class:"column is-6"},Se={class:"field column is-6"},De=d("label",null,"Approval Deadline *",-1),qe={class:"control"},Le={class:"field column is-6"},$e=d("label",null,"Attachments",-1),Me=d("div",{class:"file"},[d("label",{class:"file-label"},[d("input",{class:"file-input",type:"file",name:"resume"}),d("span",{class:"file-cta"},[d("span",{class:"file-icon"},[d("i",{class:"fas fa-cloud-upload-alt"})]),d("span",{class:"file-label"}," Choose a fileâ€¦ ")])])],-1),Ue={class:"body-inner-content"},He={class:"field columns is-multiline mb-0"},Ne={class:"field column is-12 mb-0"},Ee=d("label",{for:"",class:"label"},"Internal Notes",-1),Fe={class:"field column is-12 mb-0"},Re=d("label",{for:"",class:"label"},"Introductory Text",-1),We={class:"field column is-12 mb-0"},Be=d("label",{for:"",class:"label"},"Closing Text",-1),Je={key:1,class:"columns is-multiline"},Ze=a({__name:"LeadProposalModal",props:{leadProposalModal:{type:Boolean},proposalId:{},leadId:{}},emits:["update:modalHandler","update:OnSuccess","clearProposalId"],setup(e,{emit:a}){const s=e;D();const m=g();J();const v=F(),f=$(),T=t(!1);t({});const j=t("general");t(!1),t([]),t([]),t([]);const A=[{title:"More Details",content:"Add additional information about rota, rate or worker"}];t({title:"",description:"",quantity:0,unit:0,unitCost:0,markup:0,clientPrice:0,costCode:"",costType:"",builderCost:"",margin:0,profit:0,internalNotes:""});const O=t({title:"",approval_deadline:"",attachments:[],approvalDeadline:"",internalNotes:"",introductoryText:"",closingText:"",paymentStatus:"",worksheetItems:[],type:"proposal",job:""});t([{value:"all",label:"All"},{value:"contact",label:"Contact Form"},{value:"google",label:"Google"},{value:"referral",label:"Referral"}]),t([{value:"open",label:"Open"},{value:"inProgress",label:"In Progress"},{value:"onHold",label:"On Hold"},{value:"pending",label:"Pending"},{value:"lost",label:"Lost"},{value:"sold",label:"sold"},{value:"noOpportunity",label:"No Opportunity"}]);const S=t(""),q=async()=>{try{T.value=!0,s.leadId&&(O.value.job=s.leadId);const e=R(O.value,[""]);if(s.proposalId){await f.patch(`/api/lead-proposal/${s.proposalId}/`,e)}else{const l=await f.post("/api/lead-proposal/",e);S.value=l.data.id,O.value=l.data}B(),v.dismissAll(),v.success(`Proposal ${s.proposalId?"updated":"created"} successfully`)}catch(e){v.error(` ${e}, New Worker`)}finally{T.value=!1}},W=()=>{a("update:modalHandler",!1)},B=()=>{a("update:OnSuccess",null)},Z=h((()=>x((()=>import("./ckeditor-085bee9e.js").then((e=>e.c))),["assets/ckeditor-085bee9e.js","assets/index-5ef4b004.js","assets/index-1c8d8af6.css","assets/vue.runtime.esm-bundler-5a41c0a5.js"]).then((e=>e.default.component)))),z={fontFamily:{options:['"Montserrat", sans-serif','"Roboto", sans-serif']},height:"400px",minHeight:"400px"};return o((async()=>{m.value=await x((()=>import("./ckeditor-bbd34669.js").then((e=>e.c))),["assets/ckeditor-bbd34669.js","assets/index-5ef4b004.js","assets/index-1c8d8af6.css"]).then((e=>e.default)),s.proposalId&&(async()=>{try{const e=await f.get(`/api/lead-proposal/${s.proposalId}/`);O.value=e.data}catch(e){console.log(e)}})()})),w((()=>{a("clearProposalId",null),O.value={}})),(e,a)=>{const t=E,o=N,v=H,f=U,g=M,h=L,x=b,w=l;return n(),i(w,{is:"form",open:s.leadProposalModal,title:"Lead Proposal",size:"xl",actions:"right",onSubmit:V(q,["prevent"]),onClose:W},{content:r((()=>[d("div",xe,[d("div",we,[d("div",ke,[d("div",Ie,[d("ul",null,[d("li",{class:k(["general"===p(j)?"is-active":"not-active"])},[d("a",{tabindex:"0",role:"button",onKeydown:a[0]||(a[0]=I(V((e=>j.value="general"),["prevent"]),["space"])),onClick:a[1]||(a[1]=e=>j.value="general")},Pe,32)],2),d("li",{class:k(["CostWorksheet"===p(j)?"is-active":"not-active"])},[d("a",{tabindex:"0",role:"button",onKeydown:a[2]||(a[2]=I(V((e=>j.value="CostWorksheet"),["prevent"]),["space"])),onClick:a[3]||(a[3]=e=>j.value="CostWorksheet")},Ce,32)],2)])])])]),"general"==p(j)?(n(),c("div",Ve,[d("div",Te,[je,d("div",Ae,[P(d("input",{type:"text",name:"firstName","onUpdate:modelValue":a[4]||(a[4]=e=>p(O).title=e),required:"",class:"input is-primary-focus is-primary-focus",placeholder:"Proposal Title"},null,512),[[C,p(O).title]])])]),d("div",Oe,[u(v,{class:"m-0 p-0",label:"Type"},{default:r((()=>[u(o,null,{default:r((()=>[u(t,{modelValue:p(O).type,"onUpdate:modelValue":a[5]||(a[5]=e=>p(O).type=e),value:"proposal",label:"Proposal",name:"solid_squared_radio",color:"primary",square:"",solid:""},null,8,["modelValue"]),u(t,{modelValue:p(O).type,"onUpdate:modelValue":a[6]||(a[6]=e=>p(O).type=e),value:"change_order",label:"Change Order",name:"solid_squared_radio",color:"info",square:"",solid:""},null,8,["modelValue"]),u(t,{modelValue:p(O).type,"onUpdate:modelValue":a[7]||(a[7]=e=>p(O).type=e),value:"draft",label:"Draft",name:"solid_squared_radio",color:"warning",square:"",solid:""},null,8,["modelValue"])])),_:1})])),_:1})]),d("div",Se,[De,d("div",qe,[P(d("input",{type:"date",name:"firstName","onUpdate:modelValue":a[8]||(a[8]=e=>p(O).approval_deadline=e),required:"",class:"input is-primary-focus is-primary-focus",placeholder:"Proposal Approval deadline"},null,512),[[C,p(O).approval_deadline]])])]),d("div",Le,[$e,u(v,{grouped:""},{default:r((()=>[u(o,null,{default:r((()=>[Me])),_:1})])),_:1})]),u(g,{items:A,"with-chevron":"",style:{"border-radius":"14px"},class:"m-3"},{"collapse-item-content":r((e=>[d("div",Ue,[d("div",He,[d("div",Ne,[Ee,u(v,null,{default:r((()=>[u(o,null,{default:r((()=>[u(f,{modelValue:p(O).internalNotes,"onUpdate:modelValue":a[9]||(a[9]=e=>p(O).internalNotes=e),rows:"4",placeholder:"Internal notes..."},null,8,["modelValue"])])),_:1})])),_:1})]),d("div",Fe,[Re,p(m)?(n(),i(p(Z),{key:0,modelValue:p(O).introductoryText,"onUpdate:modelValue":a[10]||(a[10]=e=>p(O).introductoryText=e),editor:p(m),config:z},null,8,["modelValue","editor"])):_("",!0)]),d("div",We,[Be,p(m)?(n(),i(p(Z),{key:0,modelValue:p(O).closingText,"onUpdate:modelValue":a[11]||(a[11]=e=>p(O).closingText=e),editor:p(m),config:z},null,8,["modelValue","editor"])):_("",!0)])])])])),_:1})])):_("",!0),"CostWorksheet"==p(j)?(n(),c("div",Je,[u(h,{proposalId:p(O).id?p(O).id:s.proposalId},null,8,["proposalId"])])):_("",!0)])])),action:r((()=>[u(x,{loading:p(T),type:"submit",color:"primary",icon:"fas fa-plus",raised:""},{default:r((()=>[y("Create")])),_:1},8,["loading"])])),_:1},8,["open","onSubmit"])}}}),ze={class:"flex-toolbar is-reversed is-flex space-between my-4"},Ke={key:0},Ge={key:1,class:"flex-list-wrapper flex-list-v2"},Qe={class:"item-name dark-inverted"},Ye={class:"item-name dark-inverted"},Xe={class:"light-text"},el={class:"light-text"},ll=["onClick"],al=[d("div",{class:"icon"},[d("i",{"aria-hidden":"true",class:"lnil lnil-pencil"})],-1),d("div",{class:"meta"},[d("span",null,"Edit"),d("span",null,"Edit Proposal Details")],-1)],tl=["onClick"],sl=[d("div",{class:"icon"},[d("i",{"aria-hidden":"true",class:"lnil lnil-briefcase"})],-1),d("div",{class:"meta"},[d("span",null,"View Detail"),d("span",null,"View detail in page")],-1)],ol=["onClick"],nl=[d("div",{class:"icon"},[d("i",{"aria-hidden":"true",class:"lnil lnil-eye"})],-1),d("div",{class:"meta"},[d("span",null,"Preview"),d("span",null,"Preview proposal detail")],-1)],il=d("a",{role:"menuitem",href:"#",class:"dropdown-item is-media"},[d("div",{class:"icon"},[d("i",{"aria-hidden":"true",class:"lnil lnil-add-files"})]),d("div",{class:"meta"},[d("span",null,"Add Cost Item"),d("span",null,"Add a new cost item")])],-1),rl=d("hr",{class:"dropdown-divider"},null,-1),dl=["onClick"],ul=[d("div",{class:"icon"},[d("i",{"aria-hidden":"true",class:"lnil lnil-trash-can-alt"})],-1),d("div",{class:"meta"},[d("span",null,"Delete"),d("span",null,"Delete from list")],-1)],pl=d("img",{class:"light-image",src:ee,alt:""},null,-1),cl=d("img",{class:"dark-image",src:le,alt:""},null,-1),ml=a({__name:"LeadProposalsList",props:{activeTab:{default:"active"},leadId:{default:""},allProposal:{type:Boolean,default:!1}},setup(l){const a=l,g=T();j();const h=$(),x=F(),w=t(!1),k=t([]),I=t(!1),V=t(""),S=t(""),D=t("");t(a.activeTab);const q=t({title:"",subtitle:"test",isSweetAlertOpen:!1,btntext:"text"}),L=async()=>{try{w.value=!0;const e=await h.delete(`/api/lead-proposal/${D.value}/`);k.value=e.data,x.success("Proposal delete successfully"),R()}catch(e){x.error(` ${e}, Proposal`),x.error("Something went wrong please try later")}finally{w.value=!1,q.value.isSweetAlertOpen=!1}},M={picture:{label:"Proposal",grow:!0,media:!0},customer:"Created At",industry:"Type",deadline:"Deadline",status:"Status",actions:{label:"Actions",align:"end"}},U=s((()=>{if(S.value){const e=new RegExp(S.value,"i");return k.value.filter((l=>l.title.match(e)||l.approval_deadline.match(e)))}return k.value})),H=t(!1),E=t(!1),R=()=>{1==a.allProposal?(async()=>{try{w.value=!0;const e=await h.get("/api/lead-proposal/");k.value=e.data}catch(e){x.error(` ${e}, Lead`)}finally{w.value=!1}})():a.leadId&&(async()=>{try{w.value=!0;const e=await h.get(`/api/lead-proposal/by-job/${a.leadId}/`);k.value=e.data}catch(e){x.error(` ${e}, Lead`)}finally{w.value=!1}})()};return o((()=>{R()})),(l,t)=>{const s=N,o=b,h=X,x=G,T=Y,j=Q,$=K,F=z,J=Z,ee=Ze,le=he,ae=e;return n(),c("div",null,[d("div",ze,[u(s,{icon:"feather:search"},{default:r((()=>[P(d("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>A(S)?S.value=e:null),class:"input custom-text-filter",placeholder:"Search..."},null,512),[[C,p(S)]])])),_:1}),d("div",null,[u(o,{color:"primary",onClick:t[1]||(t[1]=e=>I.value=!p(I)),icon:"fas fa-plus"},{default:r((()=>[y("Lead Proposal")])),_:1})])]),p(w)?(n(),c("div",Ke,[u(h)])):(n(),c("div",Ge,[p(U).length>0&&p(k).length>0?(n(),i($,{key:0,data:p(U),columns:M,rounded:""},{body:r((()=>[u(O,{name:"list",tag:"div",class:"flex-list-inner"},{default:r((()=>[(n(!0),c(m,null,v(p(U),(e=>(n(),c("div",{key:e.id,class:"flex-table-item"},[u(x,{column:{media:!0,grow:!0}},{default:r((()=>[d("div",null,[d("span",Qe,f(e.title),1)])])),_:2},1024),u(x,{column:{media:!0}},{default:r((()=>[d("div",null,[d("span",Ye,f(p(W)(e.created_at)),1),d("span",Xe,f(p(B)(e.created_at)),1)])])),_:2},1024),u(x,null,{default:r((()=>[u(T,{rounded:""},{default:r((()=>[y(f(e.type),1)])),_:2},1024)])),_:2},1024),u(x,null,{default:r((()=>[d("span",el,f(e.approval_deadline),1)])),_:2},1024),u(x,null,{default:r((()=>[u(T,{rounded:"",color:"info"},{default:r((()=>[y(f(e.payment_status),1)])),_:2},1024)])),_:2},1024),u(x,{column:{align:"end"}},{default:r((()=>[u(j,{class:"is-pushed-mobile",icon:"feather:more-vertical",spaced:"",right:""},{content:r((()=>[d("a",{role:"menuitem",onClick:l=>{return a=e.id,V.value=a,void(I.value=!0);var a},class:"dropdown-item is-media"},al,8,ll),d("a",{role:"menuitem",onClick:l=>p(g).push(`/sidebar/dashboard/proposals/${e.id}`),class:"dropdown-item is-media"},sl,8,tl),d("a",{disabled:"",role:"menuitem",onClick:l=>{return a=e.id,E.value=a,void(H.value=!H.value);var a},class:"dropdown-item is-media"},nl,8,ol),il,rl,d("a",{role:"menuitem",onClick:l=>{return a=e.id,D.value=a,void(q.value={title:"Delete Proposal?",subtitle:"Are you sure to delete this proposal? After delete you will not be able to recover it again.",btntext:"Yes delete",isSweetAlertOpen:!0});var a},class:"dropdown-item is-media"},ul,8,dl)])),_:2},1024)])),_:2},1024)])))),128))])),_:1})])),_:1},8,["data"])):_("",!0),p(k).length<1&&0==p(U).length?(n(),i(F,{key:1,title:"There is no proposal created on this lead!",subtitle:"Too bad. Looks like we couldn't created any proposal on this Lead, please create proposal and release to the client",larger:""},{image:r((()=>[pl,cl])),_:1})):_("",!0),p(U).length>5?(n(),i(J,{key:2,"item-per-page":10,"total-items":873,"current-page":42,"max-links-displayed":7})):_("",!0)])),p(I)?(n(),i(ee,{key:2,leadId:a.leadId,proposalId:p(V),leadProposalModal:p(I),"onUpdate:modalHandler":t[2]||(t[2]=e=>I.value=!1),"onUpdate:OnSuccess":R,onClearProposalId:t[3]||(t[3]=e=>V.value="")},null,8,["leadId","proposalId","leadProposalModal"])):_("",!0),p(H)?(n(),i(le,{key:3,"preview-modal":p(H),proposalId:p(E),"onUpdate:modalHandler":t[4]||(t[4]=e=>H.value=!1)},null,8,["preview-modal","proposalId"])):_("",!0),p(q).isSweetAlertOpen?(n(),i(ae,{key:4,isSweetAlertOpen:p(q).isSweetAlertOpen,title:p(q).title,subtitle:p(q).subtitle,btntext:p(q).btntext,onConfirm:L,onCancel:()=>p(q).isSweetAlertOpen=!1},null,8,["isSweetAlertOpen","title","subtitle","btntext","onCancel"])):_("",!0)])}}});export{ml as _};
