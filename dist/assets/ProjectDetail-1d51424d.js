import{_ as e}from"./UpdateTask.vue_vue_type_script_setup_true_lang-cfecb97b.js";import{_ as a}from"./SweetAlert.vue_vue_type_style_index_0_lang-8bf5e8c9.js";import{_ as l}from"./VPlaceholderPage.vue_vue_type_style_index_0_lang-90af8ff7.js";import{_ as s}from"./VAvatar.vue_vue_type_style_index_0_lang-5c79a9db.js";import{_ as t}from"./VDropdown.vue_vue_type_style_index_0_lang-8dbd522d.js";import{e as i,r as n,Z as o,o as r,au as c,B as d,C as u,l as p,N as v,D as m,E as h,F as f,K as g,W as k,j as _,J as y,H as b,G as w,T as j,U as x,V as C,M as S,O as A,ak as D,I as T,a3 as I,P as V,Q as O,R as U,aR as P,x as E,v as $,s as N,A as z}from"./index-97719e31.js";import{_ as F}from"./VControl-8b94732d.js";import{_ as M}from"./PlaceloadV3.vue_vue_type_style_index_0_lang-ceb75945.js";import{_ as W,a as K}from"./projects-dark-4a371d8a.js";import{a as L}from"./useSupportElement-ea661a0e.js";import{u as R}from"./useNotyf-b09ca78e.js";import{u as H}from"./useAPI-66b92ca2.js";import{_ as B}from"./ProjectTodayTasks.vue_vue_type_style_index_0_lang-7eb63684.js";import{_ as q,a as Y}from"./VOption.vue_vue_type_style_index_0_lang-94499f00.js";import{_ as Z}from"./VLabel.vue_vue_type_script_setup_true_lang-7fcfc94c.js";import{_ as J}from"./VField.vue_vue_type_script_setup_true_lang-f1eeffdd.js";import{_ as G}from"./UserPopoverContent.vue_vue_type_script_setup_true_lang-36f08552.js";import{_ as Q}from"./VModal.vue_vue_type_style_index_0_lang-cc2ec419.js";import{_ as X}from"./VInput.vue_vue_type_script_setup_true_lang-42972079.js";import{_ as ee,a as ae}from"./search-4-dark-2b5b440c.js";import{_ as le}from"./sheet-50221dfe.js";import{o as se}from"./via-placeholder-24645670.js";import{_ as te}from"./VIcon.vue_vue_type_script_setup_true_lang-6ca46721.js";import{A as ie}from"./vue3-apexcharts.common-55a583b6.js";import{u as ne}from"./useThemeColors-90da9f2e.js";import{u as oe}from"./userSession-579aa9b9.js";const re=e=>(V("data-v-ec21a4f3"),e=e(),O(),e),ce={key:1},de={class:"list-flex-toolbar is-reversed"},ue={class:"tabs-inner"},pe={class:"tabs"},ve=re((()=>m("span",null,"All",-1))),me=[ve],he=re((()=>m("span",null,"Completed",-1))),fe=[he],ge=re((()=>m("li",{class:"tab-naver"},null,-1))),ke={class:"flex-list-wrapper flex-list-v2"},_e={key:0,class:"tab-content is-active"},ye={class:"all-projects"},be={class:"all-projects-header"},we={class:"header-item"},je={class:"item-inner"},xe=re((()=>m("i",{"aria-hidden":"true",class:"lnil lnil-analytics-alt-1"},null,-1))),Ce=re((()=>m("p",null,"Total Tasks",-1))),Se={class:"header-item"},Ae={class:"item-inner"},De=re((()=>m("i",{"aria-hidden":"true",class:"lnil lnil-target-alt-1"},null,-1))),Te=re((()=>m("p",null,"Completed Tasks",-1))),Ie={class:"header-item"},Ve={class:"item-inner"},Oe=re((()=>m("i",{"aria-hidden":"true",class:"lnil lnil-pie-chart-alt"},null,-1))),Ue=re((()=>m("p",null,"Pending Tasks",-1))),Pe={class:"header-item"},Ee={class:"item-inner"},$e=re((()=>m("i",{"aria-hidden":"true",class:"lnil lnil-leaf"},null,-1))),Ne=re((()=>m("p",null,"Active Tasks",-1))),ze={key:0,class:"columns is-multiline projects-card-grid"},Fe={class:"column is-6"},Me={class:"top-section"},We={class:"head"},Ke=["onClick"],Le=[re((()=>m("div",{class:"icon"},[m("i",{class:"lnir lnir-play","aria-hidden":"true"})],-1))),re((()=>m("div",{class:"meta"},[m("span",null,"Active"),m("span",null,"Start work on this task")],-1)))],Re=["onClick"],He=[re((()=>m("div",{class:"icon"},[m("i",{class:"lnir lnir-playlist-alt","aria-hidden":"true"})],-1))),re((()=>m("div",{class:"meta"},[m("span",null,"Pending"),m("span",null,"Waiting to work on")],-1)))],Be=["onClick"],qe=[re((()=>m("div",{class:"icon"},[m("i",{class:"lnir lnir-round-box-check","aria-hidden":"true"})],-1))),re((()=>m("div",{class:"meta"},[m("span",null,"Completed"),m("span",null,"Mark task as completed")],-1)))],Ye=re((()=>m("hr",{class:"dropdown-divider"},null,-1))),Ze=["onClick"],Je=[re((()=>m("div",{class:"icon"},[m("i",{class:"lnir lnir-pencil-alt","aria-hidden":"true"})],-1))),re((()=>m("div",{class:"meta"},[m("span",null,"Edit"),m("span",null,"Edit Task detail")],-1)))],Ge=["onClick"],Qe=[re((()=>m("div",{class:"icon"},[m("i",{class:"lnir lnir-trash-can-alt-1","aria-hidden":"true"})],-1))),re((()=>m("div",{class:"meta"},[m("span",null,"Delete "),m("span",null,"Delete this task")],-1)))],Xe={class:"body"},ea={class:"bottom-section"},aa={class:"foot-block"},la=re((()=>m("h4",{class:"heading"},"Worker(s)",-1))),sa={class:"developers"},ta={class:"foot-block"},ia=re((()=>m("h4",{class:"heading"},"Start date",-1))),na={class:"foot-block"},oa=re((()=>m("h4",{class:"heading"},"End date",-1))),ra={class:"foot-block"},ca=re((()=>m("h4",{class:"heading"},"Status",-1))),da=re((()=>m("img",{class:"light-image is-larger",src:W,alt:""},null,-1))),ua=re((()=>m("img",{class:"dark-image is-larger",src:K,alt:""},null,-1))),pa={key:1,class:"tab-content is-active"},va={class:"all-projects"},ma={key:0,class:"columns is-multiline projects-card-grid"},ha={class:"column is-6"},fa={class:"grid-item"},ga={class:"top-section"},ka={class:"head"},_a=["onClick"],ya=[re((()=>m("div",{class:"icon"},[m("i",{"aria-hidden":"true",class:"lnil lnil-eye"})],-1))),re((()=>m("div",{class:"meta"},[m("span",null,"Active"),m("span",null,"Start work on this task")],-1)))],ba=["onClick"],wa=[re((()=>m("div",{class:"icon"},[m("i",{"aria-hidden":"true",class:"lnil lnil-pencil"})],-1))),re((()=>m("div",{class:"meta"},[m("span",null,"Pending"),m("span",null,"Waiting to work on")],-1)))],ja=["onClick"],xa=[re((()=>m("div",{class:"icon"},[m("i",{"aria-hidden":"true",class:"lnil lnil-pencil"})],-1))),re((()=>m("div",{class:"meta"},[m("span",null,"Completed"),m("span",null,"Mark task as completed")],-1)))],Ca=re((()=>m("hr",{class:"dropdown-divider"},null,-1))),Sa=["onClick"],Aa=[re((()=>m("div",{class:"icon"},[m("i",{"aria-hidden":"true",class:"lnil lnil-pencil"})],-1))),re((()=>m("div",{class:"meta"},[m("span",null,"Edit"),m("span",null,"Edit Task detail")],-1)))],Da=["onClick"],Ta=[re((()=>m("div",{class:"icon"},[m("i",{"aria-hidden":"true",class:"lnil lnil-archive"})],-1))),re((()=>m("div",{class:"meta"},[m("span",null,"Delete "),m("span",null,"Delete this task")],-1)))],Ia={class:"body"},Va={class:"bottom-section"},Oa={class:"foot-block"},Ua=re((()=>m("h4",{class:"heading"},"Worker(s)",-1))),Pa={class:"developers"},Ea={class:"foot-block"},$a=re((()=>m("h4",{class:"heading"},"Start date",-1))),Na={class:"foot-block"},za=re((()=>m("h4",{class:"heading"},"End date",-1))),Fa={class:"foot-block"},Ma=re((()=>m("h4",{class:"heading"},"Status",-1))),Wa=re((()=>m("img",{class:"light-image is-larger",src:W,alt:""},null,-1))),Ka=re((()=>m("img",{class:"dark-image is-larger",src:K,alt:""},null,-1))),La=U(i({__name:"ProjectsTasks",props:{projectID:{default:""}},emits:["update:getAllTasks","update:completedTasks","update:activeTasks"],setup(i,{emit:V}){const O=i,U=H(),P=R();n(1);const E=n("");n("Edit Project"),n("Add Task");const $=n(""),N=n("active"),z=n(0),W=n(!1),K=n(!1),L=n(0);n({});const B=n("");n([{id:0,username:"",email:"",phoneNumber:""}]);const q=n([{id:0,title:"",description:"",startDate:"",endDate:"",project:0,status:"",worker:[{id:0,username:"",email:"",role:"",avatar:""}],quantity:"",unit:"",costCode:""}]),Y=n({title:"",subtitle:"test",isSweetAlertOpen:!1,btntext:"text"}),Z=e=>{L.value=e,Y.value={title:"Delete Task?",subtitle:"Do you really want to delete this task permanently?",btntext:"Yes, Delete",isSweetAlertOpen:!0}},J=async()=>{try{W.value=!0;const e=await U.get(`api/task/${O.projectID}/project/`);q.value=e.data,console.log(e.data)}catch(e){console.log(e)}finally{W.value=!1}},G={active:"#336aeb",pending:"#faad42",canceled:"#e62864",completed:"#f3c2c2ff"},Q=o((()=>{let e=q.value.filter((e=>"active"==e.status));return V("update:completedTasks",e.length),e.length})),X=o((()=>{let e=q.value.filter((e=>"pending"==e.status));return V("update:activeTasks",e.length),e.length})),ee=o((()=>q.value.filter((e=>"completed"==e.status)).length)),ae=e=>{B.value=e,K.value=!0},le=()=>{J(),K.value=!1,B.value=""},se=async(e,a)=>{try{W.value=!0;await U.patch(`/api/task/${e}/`,{status:a,schedule_mode:localStorage.getItem("isScheduleMode")});J(),P.success(`Task set to ${a} successfully`),z.value=0,W.value=!1}catch(l){console.log(l)}},te=async()=>{try{W.value=!0;const e=await U.delete(`/api/task/${L.value}/`);console.log(e),P.success("Task deleted successfully"),J(),Y.value.isSweetAlertOpen=!1,z.value=0}catch(e){console.log(e)}finally{W.value=!1}},ie=o((()=>{if($.value){const e=new RegExp($.value,"i");return q.value.filter((a=>"completed"!=a.status&&(a.title.match(e)||a.description.match(e)||a.status.match(e))))}return q.value.filter((e=>"completed"!=e.status))})),ne=o((()=>{if($.value){const e=new RegExp($.value,"i");return q.value.filter((a=>"completed"==a.status&&(a.title.match(e)||a.description.match(e)||a.status.match(e))))}return q.value.filter((e=>"completed"==e.status))}));return r((()=>{J()})),(i,n)=>{const o=M,r=F,V=A,U=D,P=t,z=s,L=l,R=a,H=e,oe=c("tooltip");return d(),u(x,null,[p(W)?(d(),v(o,{key:0})):(d(),u("div",ce,[m("div",de,[h(U,null,{default:f((()=>[h(r,{class:"mr-2 h-hidden-mobile",icon:"feather:search"},{default:f((()=>[g(m("input",{"onUpdate:modelValue":n[0]||(n[0]=e=>_($)?$.value=e:null),class:"input custom-text-filter",placeholder:"Search..."},null,512),[[k,p($)]])])),_:1}),h(V,{onClick:n[1]||(n[1]=e=>ae()),color:"primary",icon:"fas fa-plus",elevated:"",raised:""},{default:f((()=>[y("Task")])),_:1})])),_:1}),m("div",ue,[m("div",pe,[m("ul",null,[m("li",{class:b(["active"===p(N)&&"is-active"])},[m("a",{tabindex:"0",role:"button",onKeydown:n[2]||(n[2]=w(T((e=>N.value="active"),["prevent"]),["space"])),onClick:n[3]||(n[3]=e=>N.value="active")},me,32)],2),m("li",{class:b(["closed"===p(N)&&"is-active"])},[m("a",{tabindex:"0",role:"button",onKeydown:n[4]||(n[4]=w(T((e=>N.value="closed"),["prevent"]),["space"])),onClick:n[5]||(n[5]=e=>N.value="closed")},fe,32)],2),ge])])])]),m("div",ke,["active"===p(N)?(d(),u("div",_e,[m("div",ye,[m("div",be,[m("div",we,[m("div",je,[xe,m("span",null,j(p(q).length),1),Ce])]),m("div",Se,[m("div",Ae,[De,m("span",null,j(p(ee)),1),Te])]),m("div",Ie,[m("div",Ve,[Oe,m("span",null,j(p(X)),1),Ue])]),m("div",Pe,[m("div",Ee,[$e,m("span",null,j(p(Q)),1),Ne])])]),p(ie).length?(d(),u("div",ze,[(d(!0),u(x,null,C(p(ie),(e=>(d(),u("div",Fe,[m("div",{class:"grid-item",style:I({boxShadow:`2px 4px 8px 2px ${G[e.status]}40`})},[m("div",Me,[m("div",We,[m("h3",null,j(e.title),1),h(P,{icon:"feather:more-vertical",spaced:"",right:""},{content:f((()=>[m("a",{onClick:a=>se(e.id,"active"),role:"menuitem",class:"dropdown-item is-media"},Le,8,Ke),m("a",{onClick:a=>se(e.id,"pending"),role:"menuitem",class:"dropdown-item is-media"},He,8,Re),m("a",{onClick:a=>se(e.id,"completed"),role:"menuitem",class:"dropdown-item is-media"},qe,8,Be),Ye,m("a",{onClick:a=>ae(e.id),role:"menuitem",class:"dropdown-item is-media"},Je,8,Ze),m("a",{onClick:a=>Z(e.id),role:"menuitem",class:"dropdown-item is-media"},Qe,8,Ge)])),_:2},1024)]),m("div",Xe,[m("p",null,j(e.description),1)])]),m("div",ea,[m("div",aa,[la,m("div",sa,[(d(!0),u(x,null,C(e.workers,(e=>g((d(),v(z,{picture:e.avatar,size:"small",color:"primary",initials:e.avatar?"":e.username.slice(0,2)},null,8,["picture","initials"])),[[oe,`${e.username}`,void 0,{rounded:!0,info:!0}]]))),256))])]),m("div",ta,[ia,m("p",null,j(e.startDate),1)]),m("div",na,[oa,m("p",null,j(e.endDate),1)]),m("div",ra,[ca,m("p",{style:I([{"text-transform":"capitalize"},{color:G[e.status]}])},j(e.status),5)])])],4)])))),256))])):(d(),v(L,{key:1,title:"There is no task added on this projects.",subtitle:"Looks like you don't have any task on this project yet. When you'll\n                start creating tasks of this project, they will be showing up in here."},{image:f((()=>[da,ua])),_:1}))])])):"closed"===p(N)?(d(),u("div",pa,[m("div",va,[p(ne).length?(d(),u("div",ma,[(d(!0),u(x,null,C(p(ne),(e=>(d(),u("div",ha,[m("div",fa,[m("div",ga,[m("div",ka,[m("h3",null,j(e.title),1),h(P,{icon:"feather:more-vertical",spaced:"",right:""},{content:f((()=>[m("a",{onClick:a=>se(e.id,"active"),role:"menuitem",class:"dropdown-item is-media"},ya,8,_a),m("a",{onClick:a=>se(e.id,"pending"),role:"menuitem",class:"dropdown-item is-media"},wa,8,ba),m("a",{onClick:a=>se(e.id,"completed"),role:"menuitem",class:"dropdown-item is-media"},xa,8,ja),Ca,m("a",{onClick:a=>ae(e.id),role:"menuitem",class:"dropdown-item is-media"},Aa,8,Sa),m("a",{onClick:a=>Z(e.id),role:"menuitem",class:"dropdown-item is-media"},Ta,8,Da)])),_:2},1024)]),m("div",Ia,[m("p",null,j(e.description),1)])]),m("div",Va,[m("div",Oa,[Ua,m("div",Pa,[(d(!0),u(x,null,C(e.workers,(e=>g((d(),v(z,{picture:e.avatar,size:"small",color:"primary",initials:e.avatar?"":e.username.slice(0,2)},null,8,["picture","initials"])),[[oe,`${e.username}`,void 0,{rounded:!0,info:!0}]]))),256))])]),m("div",Ea,[$a,m("p",null,j(e.startDate),1)]),m("div",Na,[za,m("p",null,j(e.endDate),1)]),m("div",Fa,[Ma,m("p",null,j(e.status),1)])])])])))),256))])):(d(),v(L,{key:1,title:"No closed projects.",subtitle:"Looks like you don't have any closed project yet. When you'll\n                start closing off projects, they will be showing up in here."},{image:f((()=>[Wa,Ka])),_:1}))])])):S("",!0)])])),p(Y).isSweetAlertOpen?(d(),v(R,{key:2,isSweetAlertOpen:p(Y).isSweetAlertOpen,title:p(Y).title,subtitle:p(Y).subtitle,btntext:p(Y).btntext,onConfirm:te,loading:p(W),onCancel:()=>p(Y).isSweetAlertOpen=!1},null,8,["isSweetAlertOpen","title","subtitle","btntext","loading","onCancel"])):S("",!0),p(K)?(d(),v(H,{key:3,projectID:O.projectID,isOpen:p(K),taskIdSelected:p(B),startDate:p(E),"onUpdate:modalHandler":le,"onUpdate:OnSuccess":J},null,8,["projectID","isOpen","taskIdSelected","startDate"])):S("",!0)],64)}}}),[["__scopeId","data-v-ec21a4f3"]]),Ra=e=>(V("data-v-0c7f5f21"),e=e(),O(),e),Ha={class:"tile-grid-toolbar"},Ba={class:"buttons"},qa={class:"tile-grid tile-grid-v2"},Ya=Ra((()=>m("img",{class:"light-image",src:ee,alt:""},null,-1))),Za=Ra((()=>m("img",{class:"dark-image",src:ae,alt:""},null,-1))),Ja={class:"tile-grid-item"},Ga={class:"tile-grid-item-inner"},Qa={class:"meta"},Xa={class:"dark-inverted"},el=["onClick"],al=[Ra((()=>m("div",{class:"icon"},[m("i",{"aria-hidden":"true",class:"lnil lnil-trash-can-alt"})],-1))),Ra((()=>m("div",{class:"meta"},[m("span",null,"Delete"),m("span",null,"Delete this file")],-1)))],ll={class:"modal-form columns is-multiline"},sl={class:"file has-name"},tl={class:"file-label"},il=Ra((()=>m("span",{class:"file-cta"},[m("span",{class:"file-icon"},[m("i",{class:"fas fa-cloud-upload-alt"})]),m("span",{class:"file-label"}," Choose a file… ")],-1))),nl={class:"file-name light-text"},ol=U(i({__name:"ProjectFiles",props:{projectId:{},files:{}},emits:["update:onUploadFile"],setup(e,{emit:s}){const i=e,r=H(),c=R(),w=n(!1),D=n(!1),I=n(""),V=o((()=>I.value?i.files.filter((e=>e.match(new RegExp(I.value,"i")))):i.files)),O=n(""),U=n(""),E=n("");let $=null;const N=async()=>{try{w.value=!0;const e=await r.post(`/api/task/bulk-upload/${i.projectId}/`,{file:$,start:E.value});c.green("Tasks Will be generated automatically"),console.log(e),s("update:onUploadFile",null),w.value=!1}catch(e){console.log(e)}finally{D.value=!1}},z=e=>{const a=e.match(/\d{4}-\d{2}-\d{2}/);if(a){return a[0]}return"N/A"},M=e=>{let a=e.target.files[0];$=a,U.value=a.name},W=n({title:"",subtitle:"test",isSweetAlertOpen:!1,btntext:"text"}),K=async()=>{try{w.value=!0;await r.patch(`/api/project/${i.projectId}/delete-doc-tasks/`,{document_name:O.value});s("update:onUploadFile",null),c.success("Sheet deleted successfully!"),W.value.isSweetAlertOpen=!1}catch(e){console.log(e)}finally{w.value=!1}};return(e,s)=>{const i=F,n=A,o=l,r=t,c=a,w=Z,$=X,L=J,R=Q;return d(),u(x,null,[m("div",null,[m("div",Ha,[h(i,{icon:"feather:search"},{default:f((()=>[g(m("input",{"onUpdate:modelValue":s[0]||(s[0]=e=>_(I)?I.value=e:null),class:"input custom-text-filter",placeholder:"Search..."},null,512),[[k,p(I)]])])),_:1}),m("div",Ba,[h(n,{icon:"fas fa-plus",raised:"",size:"small",light:"",onClick:s[1]||(s[1]=e=>D.value=!p(D)),outlined:"",color:"primary"},{default:f((()=>[y(" File ")])),_:1})])]),m("div",qa,[h(o,{class:b([0!==p(V).length&&"is-hidden"]),title:"There is not file uploaded",subtitle:"There is no file uploaded on this project to create the tasks. As you will upload the file and that will appear here on the spot",larger:""},{image:f((()=>[Ya,Za])),_:1},8,["class"]),h(P,{name:"list",tag:"div",class:"columns is-multiline"},{default:f((()=>[(d(!0),u(x,null,C(p(V),(e=>(d(),u("div",{key:e.id,class:"column is-6"},[m("div",Ja,[m("div",Ga,[m("img",{src:le,alt:"",onErrorOnce:s[2]||(s[2]=e=>p(se)(150))},null,32),m("div",Qa,[m("span",Xa,j(e.length>20?e.slice(0,24):e),1),m("span",null,[m("span",null,"Updated: "+j(z(e)),1)])]),h(r,{icon:"feather:more-vertical",spaced:"",right:""},{content:f((()=>[m("a",{onClick:a=>{return l=e,O.value=l,void(W.value={title:"Are you sure?",subtitle:"This file and all task generated from this file will be deleted permanently!",btntext:"Yes, Delete it",isSweetAlertOpen:!0});var l},role:"menuitem",class:"dropdown-item is-media"},al,8,el)])),_:2},1024)])])])))),128))])),_:1})])]),p(W).isSweetAlertOpen?(d(),v(c,{key:0,isSweetAlertOpen:p(W).isSweetAlertOpen,title:p(W).title,subtitle:p(W).subtitle,btntext:p(W).btntext,onConfirm:K,onCancel:()=>p(W).isSweetAlertOpen=!1},null,8,["isSweetAlertOpen","title","subtitle","btntext","onCancel"])):S("",!0),h(R,{is:"form",open:p(D),title:"Upload Task File",size:"medium",actions:"right",onClose:s[5]||(s[5]=e=>D.value=!1),onSubmit:T(N,["prevent"])},{content:f((()=>[m("div",ll,[h(L,{class:"column is-12"},{default:f((()=>[h(w,null,{default:f((()=>[y("Start date of task")])),_:1}),h(i,null,{default:f((()=>[h($,{modelValue:p(E),"onUpdate:modelValue":s[3]||(s[3]=e=>_(E)?E.value=e:null),type:"date"},null,8,["modelValue"])])),_:1})])),_:1}),h(L,{class:"column is-12",grouped:""},{default:f((()=>[h(i,null,{default:f((()=>[m("div",sl,[m("label",tl,[m("input",{onChange:M,class:"file-input",type:"file",name:"file",required:""},null,32),il,m("span",nl,j(p(U)?p(U):"Upload any file"),1)])])])),_:1})])),_:1})])])),cancel:f((()=>[h(n,{onClick:s[4]||(s[4]=e=>D.value=!1),raised:""},{default:f((()=>[y("Close")])),_:1})])),action:f((()=>[h(n,{type:"submit",color:"primary",raised:""},{default:f((()=>[y("Upload")])),_:1})])),_:1},8,["open","onSubmit"])],64)}}}),[["__scopeId","data-v-0c7f5f21"]]),rl=e=>(V("data-v-97b5d42c"),e=e(),O(),e),cl={class:"personal-dashboard personal-dashboard-v2"},dl={class:"columns is-multiline"},ul={class:"column is-12"},pl={class:"dashboard-header is-relative"},vl={class:"user-meta is-dark-bordered-12"},ml={class:"title is-4 is-narrow is-bold"},hl={class:"light-text"},fl={class:"info-text is-bold"},gl=rl((()=>m("i",{class:"fas fa-home"},null,-1))),kl={class:"user-action"},_l=rl((()=>m("h3",{class:"title is-5 is-narrow"},"Information",-1))),yl={class:"light-text"},bl={class:"light-text"},wl={class:"light-text"},jl={class:"media-flex inverted-text"},xl=rl((()=>m("a",{class:"link inverted-text"},"Change status",-1))),Cl={key:0,class:"tabs-inner"},Sl={class:"tabs is-boxed",slider:""},Al=[rl((()=>m("span",null,"Project info",-1)))],Dl=[rl((()=>m("span",null,"Tasks",-1)))],Tl=rl((()=>m("li",{class:"tab-naver"},null,-1))),Il={key:1,class:"columns is-multiline"},Vl={key:0,class:"column is-8"},Ol={class:"dashboard-card has-margin-bottom"},Ul=["innerHTML"],Pl={class:"dashboard-card has-margin-bottom"},El={class:"dashboard-card"},$l=rl((()=>m("div",{class:"card-head"},[m("h3",{class:"dark-inverted"},"Task Completion"),m("a",{class:"action-link",tabindex:"0"},"Reports")],-1))),Nl={class:"dashboard-card"},zl={class:"card-head"},Fl=rl((()=>m("h3",{class:"dark-inverted"},"Assigned Manager",-1))),Ml={class:"active-team"},Wl={key:0,class:"user-list"},Kl={class:"user-list-info"},Ll={class:"name dark-inverted"},Rl={class:"position"},Hl=rl((()=>m("div",{class:"user-list-icons"},null,-1))),Bl={key:1,class:"user-list"},ql=[rl((()=>m("div",{class:"user-list-info"},[m("div",{class:"name dark-inverted"},"No Manager assigned yet")],-1)))],Yl={key:2},Zl={class:"is-flex space-between"},Jl={key:0},Gl={class:"dashboard-card"},Ql={class:"card-head"},Xl=rl((()=>m("h3",{class:"dark-inverted"},"Client Information",-1))),es={class:"active-team"},as={key:0,class:"user-list"},ls={class:"user-list-info"},ss={class:"name dark-inverted"},ts={class:"position"},is=rl((()=>m("div",{class:"user-list-icons"},null,-1))),ns={key:1,class:"user-list"},os=[rl((()=>m("div",{class:"user-list-info"},[m("div",{class:"name dark-inverted"},"No Client Info Added yet")],-1)))],rs={key:2},cs={class:"dashboard-card"},ds={class:"card-head"},us=rl((()=>m("h3",{class:"dark-inverted"},"Contractor Information",-1))),ps={class:"active-team"},vs={key:0,class:"user-list"},ms={class:"user-list-info"},hs={class:"name dark-inverted"},fs={class:"position"},gs=rl((()=>m("div",{class:"user-list-icons"},null,-1))),ks={key:1,class:"user-list"},_s=[rl((()=>m("div",{class:"user-list-info"},[m("div",{class:"name dark-inverted"}," No contractor Info Added yet ")],-1)))],ys={key:2},bs={class:"dashboard-card"},ws={key:2,class:"columns is-multiline"},js={class:"column is-12"},xs=U(i({__name:"ProjectDetail",setup(e){const a=ne(),l=H(),t=R(),i=E(),o=$(),c=oe(),g=n("detail"),k=n(!1),A=n(!1);n(!1);const D=n(!1);n(!1);const I=n(!1),V=n([]),O=n([]),U=n([]),P=n([]),M=n([]);n(0);const W=n(0),K=n(0),Q=n(""),X=n("");n("");const ee=n([{id:0,username:"",email:"",phoneNumber:""}]),ae=n([]),le=n({id:0,title:"",created:"",startDate:"",color:"",endDate:"",description:"",image:"",is_active:null,status:"",address:"",total_tasks:0,client:0,contractor:0,clientInfo:{id:0,username:"",email:"",password:"",avatar:null},uploaded_files:[],contractorInfo:{id:0,username:"",email:"",password:"",avatar:null},managers:[{id:0,username:"",avatar:null,email:"",role:""}]});n({title:"",description:"",startDate:"",endDate:"",status:"",project:i.params.id,workers:[]});const se=n([{id:0,title:"",description:"",startDate:"",endDate:"",project:0,status:"",worker:[{id:0,username:"",email:"",role:"",avatar:""}]}]),re=N({height:180,type:"radialBar",series:[],title:{text:""},chart:{toolbar:{show:!1}},colors:[a.primary,a.purple,a.orange],plotOptions:{radialBar:{hollow:{size:"55%"}}},labels:["Progress"]}),ce=N({series:[],chart:{height:295,type:"pie",toolbar:{show:!1}},labels:["Active","Pending","Completed","Canceled"],colors:[a.accent,a.info,a.primary,a.orange],legend:{position:"right",horizontalAlign:"center"},responsive:[{breakpoint:480,options:{chart:{width:315,toolbar:{show:!1}},legend:{position:"top"}}}],dataLabels:{enabled:!1}}),de=()=>{D.value=!D.value},ue=()=>{A.value=!A.value},pe=n(!1),ve=()=>{pe.value=!pe.value},me=()=>{try{I.value=!0;l.delete(`/api/project/${i.params.id}/`);t.green("Selected project deleted successfully!"),o.push("/sidebar/dashboard/projects")}catch(e){console.log(e)}finally{I.value=!1}};n(0);const he=async()=>{try{k.value=!0;const e=await l.get(`/api/project/${X.value}/`);le.value=e.data;let a=e.data.percentage.toFixed(2);re.value.series.push(a),Q.value=e.data.image,U.value=e.data.managers?e.data.managers:[],fe()}catch(e){console.log(e)}finally{k.value=!1}};n([]);const fe=async()=>{try{k.value=!0;const e=await l.get(`api/task/${i.params.id}/project/`);se.value=e.data;const a={pending:0,completed:0,active:0,canceled:0};se.value.forEach((e=>{const l=e.status||"Unknown";void 0!==a[l]&&a[l]++})),ce.value.series=[a.completed,a.pending,a.active,a.canceled],console.log("Task Series Data:",ce.value.series),k.value=!1}catch(e){console.log(e),k.value=!1}},ge=n([]),ke=async()=>{try{le.value.managers=ge.value;let e=L(le.value,["image"]);e.delete("clientInfo"),e.delete("contractorInfo"),"object"==typeof le.value.client&&e.delete("client"),"object"==typeof le.value.contractor&&e.delete("contractor");const a=await l.patch(`/api/project/${i.params.id}/`,e);A.value=!1,D.value=!1,t.green("Project updated successfully"),pe.value=!1,he(a.data.id)}catch(e){console.log(e)}};n("");const _e=e=>{W.value=e},ye=e=>{K.value=e};return r((()=>{X.value=i.params.id,he(),(async()=>{try{I.value=!0;const e=await l.get("/api/users/",{});ee.value=e.data.filter((e=>"worker"==e.role)),V.value=e.data.filter((e=>"client"==e.role)),O.value=e.data.filter((e=>"contractor"==e.role)),P.value=e.data.filter((e=>"manager"==e.role)),M.value=P.value.map((e=>({value:e.id.toString(),name:`${e.username}`,supplier:e.partner?e.partner:"",image:e.avatar}))),console.log("data",ee.value)}catch(e){console.log(e)}finally{I.value=!1}})(),fe(),(async()=>{try{const e=await l.get(`/api/task/today-tasks/?project=${i.params.id}`);ae.value=e.data}catch(e){console.log(e)}})()})),(e,a)=>{const l=te,t=s,n=z("Address"),r=ol,I=G,P=z("Tippy"),E=z("Multiselect"),$=F,N=J,W=Z,K=q,L=Y,R=B,H=La;return d(),u("div",cl,[m("div",dl,[m("div",ul,[m("div",pl,["admin"==p(c).user.role||"manager"==p(c).user.role?(d(),v(l,{key:0,style:{position:"absolute",top:"10px","font-size":"18px","font-weight":"600",right:"36px",color:"var(--info)"},class:"cu-pointer",onClick:a[0]||(a[0]=()=>{p(o).push(`/sidebar/dashboard/projects/add-project/?id=${p(le).id}`)}),icon:"lucide:edit"})):S("",!0),"admin"==p(c).user.role||"manager"==p(c).user.role?(d(),v(l,{key:1,style:{position:"absolute",top:"10px","font-size":"18px","font-weight":"600",right:"10px",color:"var(--danger)"},class:"cu-pointer",onClick:me,icon:"lucide:trash"})):S("",!0),h(t,{picture:p(le).image,squared:"",color:"primary",badge:"/images/icons/flags/united-states-of-america.svg",size:"xxl"},null,8,["picture"]),m("div",vl,[m("h3",ml,j(p(le).title?p(le).title:"N/A"),1),m("p",hl,[y(" Current status: "),m("span",fl,j("pending"===p(le).status?"Pre Construction":p(le).status.charAt(0).toUpperCase()+p(le).status.slice(1)),1)]),h(n,null,{default:f((()=>[gl,y(" "+j(p(le).address),1)])),_:1})]),m("div",kl,[_l,m("p",yl," Started at: "+j(p(le)?.startDate?p(le)?.startDate:"N/A"),1),m("p",bl," Expected end: "+j(p(le)?.endDate?p(le)?.endDate:"N/A"),1),m("p",wl," Total jobs: "+j(p(le).total_tasks?p(le).total_tasks:"N/A")+" Tasks ",1)]),m("div",null,[m("div",jl,[p(k)?S("",!0):(d(),v(p(ie),{key:0,id:"completion-chart",height:p(re).height,type:p(re).type,series:p(re).series,options:p(re)},null,8,["height","type","series","options"]))]),xl])])])]),"admin"==p(c).user.role||"manager"==p(c).user.role?(d(),u("div",Cl,[m("div",Sl,[m("ul",null,[m("li",{class:b(["detail"===p(g)&&"is-active"])},[m("a",{tabindex:"0",role:"button",onKeydown:a[1]||(a[1]=w(T((e=>g.value="detail"),["prevent"]),["space"])),onClick:a[2]||(a[2]=e=>g.value="detail")},Al,32)],2),m("li",{class:b(["tasks"===p(g)&&"is-active"])},[m("a",{tabindex:"0",role:"button",onKeydown:a[3]||(a[3]=w(T((e=>g.value="tasks"),["prevent"]),["space"])),onClick:a[4]||(a[4]=e=>g.value="tasks")},Dl,32)],2),Tl])])])):S("",!0),"detail"===p(g)?(d(),u("div",Il,["admin"==p(c).user.role||"manager"==p(c).user.role?(d(),u("div",Vl,[m("div",Ol,[m("div",{innerHTML:p(le).description},null,8,Ul)]),m("div",Pl,[h(r,{projectId:p(i).params.id,files:p(le).uploaded_files,"onUpdate:onUploadFile":he},null,8,["projectId","files"])]),m("div",El,[$l,h(p(ie),{height:p(ce).chart.height,type:p(ce).chart.type,series:p(ce).series,options:p(ce)},null,8,["height","type","series","options"])])])):S("",!0),m("div",{class:b("admin"==p(c).user.role||"manager"==p(c).user.role?"column is-4":"column is-12")},[m("div",Nl,[m("div",zl,[Fl,"admin"==p(c).user.role||"manager"==p(c).user.role?(d(),u("a",{key:0,onClick:ve,class:"action-link",tabindex:"0"},j(p(pe)?"Close":"Edit"),1)):S("",!0)]),m("div",Ml,[p(U).length>0?(d(),u("ul",Wl,[(d(!0),u(x,null,C(p(U),(e=>(d(),u("li",{key:e.id},[m("div",null,[h(P,{class:"has-help-cursor",interactive:"",offset:[0,10]},{content:f((()=>[h(I,{user:e},null,8,["user"])])),default:f((()=>[h(t,{picture:e.avatar},null,8,["picture"])])),_:2},1024)]),m("div",Kl,[m("div",Ll,j(e.username),1),m("div",Rl,j(e.email),1)]),Hl])))),128))])):(d(),u("ul",Bl,ql)),p(pe)?(d(),u("div",Yl,[h(N,null,{default:f((({id:e})=>[h($,null,{default:f((()=>[h(E,{modelValue:p(ge),"onUpdate:modelValue":a[5]||(a[5]=e=>_(ge)?ge.value=e:null),attrs:{id:e},mode:"tags",placeholder:"Select manager","track-by":"name",label:"name",searchable:!0,"create-tag":!0,options:p(M),"max-height":145},null,8,["modelValue","attrs","options"])])),_:2},1024)])),_:1})])):S("",!0),m("div",Zl,[p(pe)?(d(),u("a",Jl)):S("",!0),p(pe)?(d(),u("a",{key:1,onClick:ke,class:"action-link",tabindex:"0"},"Save ")):S("",!0)])])]),m("div",Gl,[m("div",Ql,[Xl,"admin"==p(c).user.role||"manager"==p(c).user.role?(d(),u("a",{key:0,onClick:ue,class:"action-link",tabindex:"0"},j(p(A)?"Close":"Edit"),1)):S("",!0)]),m("div",es,[p(le).client?(d(),u("ul",as,[m("li",null,[m("div",null,[h(P,{class:"has-help-cursor",interactive:"",offset:[0,10]},{content:f((()=>[h(I,{user:p(le).client},null,8,["user"])])),default:f((()=>[h(t,{picture:p(le).client.avatar},null,8,["picture"])])),_:1})]),m("div",ls,[m("div",ss,j(p(le).client.username),1),m("div",ts,j(p(le).client.email),1)]),is])])):(d(),u("ul",ns,os)),p(A)?(d(),u("div",rs,[h(N,null,{default:f((()=>[h(W,null,{default:f((()=>[y("Select client")])),_:1}),h($,null,{default:f((()=>[h(L,{modelValue:p(le).client,"onUpdate:modelValue":a[6]||(a[6]=e=>p(le).client=e),onChange:ke},{default:f((()=>[h(K,{value:""},{default:f((()=>[y(" Clients ")])),_:1}),(d(!0),u(x,null,C(p(V),(e=>(d(),v(K,{key:e.id,value:e.id},{default:f((()=>[y(j(e.username),1)])),_:2},1032,["value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1})])):S("",!0)])]),m("div",cs,[m("div",ds,[us,"admin"==p(c).user.role||"manager"==p(c).user.role?(d(),u("a",{key:0,onClick:de,class:"action-link",tabindex:"0"},j(p(D)?"Close":"Edit"),1)):S("",!0)]),m("div",ps,[p(le).contractor?(d(),u("ul",vs,[m("li",null,[m("div",null,[h(P,{class:"has-help-cursor",interactive:"",offset:[0,10]},{content:f((()=>[h(I,{user:p(le).contractor},null,8,["user"])])),default:f((()=>[h(t,{picture:p(le).contractor.avatar},null,8,["picture"])])),_:1})]),m("div",ms,[m("div",hs,j(p(le).contractor.username),1),m("div",fs,j(p(le).contractor.email),1)]),gs])])):(d(),u("ul",ks,_s)),p(D)?(d(),u("div",ys,[h(N,null,{default:f((()=>[h(W,null,{default:f((()=>[y("Select contractor")])),_:1}),h($,null,{default:f((()=>[h(L,{modelValue:p(le).contractor,"onUpdate:modelValue":a[7]||(a[7]=e=>p(le).contractor=e),onChange:ke},{default:f((()=>[(d(!0),u(x,null,C(p(O),(e=>(d(),v(K,{key:e.id,value:e.id},{default:f((()=>[y(j(e.username),1)])),_:2},1032,["value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1})])):S("",!0)])]),m("div",bs,[h(R,{projectId:p(i).params.id},null,8,["projectId"])])],2)])):S("",!0),"tasks"===p(g)?(d(),u("div",ws,[m("div",js,[h(H,{"onUpdate:completedTasks":_e,"onUpdate:activeTasks":ye,projectID:p(i).params.id},null,8,["projectID"])])])):S("",!0)])}}}),[["__scopeId","data-v-97b5d42c"]]);export{xs as _};
