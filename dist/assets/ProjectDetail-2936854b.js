import{_ as e}from"./UpdateTask.vue_vue_type_script_setup_true_lang-ac60149b.js";import{_ as a}from"./SweetAlert.vue_vue_type_style_index_0_lang-d97b35a0.js";import{_ as l}from"./VPlaceholderPage.vue_vue_type_style_index_0_lang-1b84b9f0.js";import{_ as t}from"./VAvatar.vue_vue_type_style_index_0_lang-15847dda.js";import{_ as s}from"./VDropdown.vue_vue_type_style_index_0_lang-0f117635.js";import{e as i,r as n,Z as o,o as r,au as c,B as d,C as u,l as p,N as v,D as m,E as h,F as f,K as g,W as k,j as y,J as _,H as b,G as w,T as j,U as C,V as x,M as A,O as D,ak as T,I as S,P as I,Q as P,R as O,aR as U,x as V,v as E,s as $,A as N}from"./index-65ab8135.js";import{_ as M}from"./VControl-203dd9c0.js";import{_ as F}from"./PlaceloadV3.vue_vue_type_style_index_0_lang-98b70b62.js";import{_ as W,a as H}from"./projects-dark-4a371d8a.js";import{a as K}from"./useSupportElement-92e76e72.js";import{u as L}from"./useNotyf-493e68e7.js";import{u as R}from"./useAPI-008c05f7.js";import{_ as z}from"./ProjectTodayTasks.vue_vue_type_style_index_0_lang-0c17a8c7.js";import{_ as B}from"./VField.vue_vue_type_script_setup_true_lang-a28ace1f.js";import{_ as Z,a as q}from"./VOption.vue_vue_type_style_index_0_lang-700eee4a.js";import{_ as Y}from"./VLabel.vue_vue_type_script_setup_true_lang-aba2fa88.js";import{_ as G}from"./UserPopoverContent.vue_vue_type_script_setup_true_lang-12be4805.js";import{_ as J,a as Q}from"./search-4-dark-2b5b440c.js";import{_ as X}from"./sheet-50221dfe.js";import{o as ee}from"./via-placeholder-24645670.js";import{_ as ae}from"./VIcon.vue_vue_type_script_setup_true_lang-69ba5e53.js";import{A as le}from"./vue3-apexcharts.common-bb95aa30.js";import{u as te}from"./useThemeColors-e89e9c7b.js";import{u as se}from"./userSession-325772ef.js";const ie=e=>(I("data-v-00cffb1a"),e=e(),P(),e),ne={key:1},oe={class:"list-flex-toolbar is-reversed"},re={class:"tabs-inner"},ce={class:"tabs"},de=ie((()=>m("span",null,"All",-1))),ue=[de],pe=ie((()=>m("span",null,"Completed",-1))),ve=[pe],me=ie((()=>m("li",{class:"tab-naver"},null,-1))),he={class:"flex-list-wrapper flex-list-v2"},fe={key:0,class:"tab-content is-active"},ge={class:"all-projects"},ke={class:"all-projects-header"},ye={class:"header-item"},_e={class:"item-inner"},be=ie((()=>m("i",{"aria-hidden":"true",class:"lnil lnil-analytics-alt-1"},null,-1))),we=ie((()=>m("p",null,"Total Tasks",-1))),je={class:"header-item"},Ce={class:"item-inner"},xe=ie((()=>m("i",{"aria-hidden":"true",class:"lnil lnil-target-alt-1"},null,-1))),Ae=ie((()=>m("p",null,"Completed Tasks",-1))),De={class:"header-item"},Te={class:"item-inner"},Se=ie((()=>m("i",{"aria-hidden":"true",class:"lnil lnil-pie-chart-alt"},null,-1))),Ie=ie((()=>m("p",null,"Pending Tasks",-1))),Pe={class:"header-item"},Oe={class:"item-inner"},Ue=ie((()=>m("i",{"aria-hidden":"true",class:"lnil lnil-leaf"},null,-1))),Ve=ie((()=>m("p",null,"Active Tasks",-1))),Ee={key:0,class:"columns is-multiline projects-card-grid"},$e={class:"column is-6"},Ne={class:"grid-item"},Me={class:"top-section"},Fe={class:"head"},We=["onClick"],He=[ie((()=>m("div",{class:"icon"},[m("i",{"aria-hidden":"true",class:"lnil lnil-eye"})],-1))),ie((()=>m("div",{class:"meta"},[m("span",null,"Active"),m("span",null,"Start work on this task")],-1)))],Ke=["onClick"],Le=[ie((()=>m("div",{class:"icon"},[m("i",{"aria-hidden":"true",class:"lnil lnil-pencil"})],-1))),ie((()=>m("div",{class:"meta"},[m("span",null,"Pending"),m("span",null,"Waiting to work on")],-1)))],Re=["onClick"],ze=[ie((()=>m("div",{class:"icon"},[m("i",{"aria-hidden":"true",class:"lnil lnil-pencil"})],-1))),ie((()=>m("div",{class:"meta"},[m("span",null,"Completed"),m("span",null,"Mark task as completed")],-1)))],Be=ie((()=>m("hr",{class:"dropdown-divider"},null,-1))),Ze=["onClick"],qe=[ie((()=>m("div",{class:"icon"},[m("i",{"aria-hidden":"true",class:"lnil lnil-pencil"})],-1))),ie((()=>m("div",{class:"meta"},[m("span",null,"Edit"),m("span",null,"Edit Task detail")],-1)))],Ye=["onClick"],Ge=[ie((()=>m("div",{class:"icon"},[m("i",{"aria-hidden":"true",class:"lnil lnil-archive"})],-1))),ie((()=>m("div",{class:"meta"},[m("span",null,"Delete "),m("span",null,"Delete this task")],-1)))],Je={class:"body"},Qe={class:"bottom-section"},Xe={class:"foot-block"},ea=ie((()=>m("h4",{class:"heading"},"Worker(s)",-1))),aa={class:"developers"},la={class:"foot-block"},ta=ie((()=>m("h4",{class:"heading"},"Start date",-1))),sa={class:"foot-block"},ia=ie((()=>m("h4",{class:"heading"},"End date",-1))),na={class:"foot-block"},oa=ie((()=>m("h4",{class:"heading"},"Status",-1))),ra=ie((()=>m("img",{class:"light-image is-larger",src:W,alt:""},null,-1))),ca=ie((()=>m("img",{class:"dark-image is-larger",src:H,alt:""},null,-1))),da={key:1,class:"tab-content is-active"},ua={class:"all-projects"},pa={key:0,class:"columns is-multiline projects-card-grid"},va={class:"column is-6"},ma={class:"grid-item"},ha={class:"top-section"},fa={class:"head"},ga=["onClick"],ka=[ie((()=>m("div",{class:"icon"},[m("i",{"aria-hidden":"true",class:"lnil lnil-eye"})],-1))),ie((()=>m("div",{class:"meta"},[m("span",null,"Active"),m("span",null,"Start work on this task")],-1)))],ya=["onClick"],_a=[ie((()=>m("div",{class:"icon"},[m("i",{"aria-hidden":"true",class:"lnil lnil-pencil"})],-1))),ie((()=>m("div",{class:"meta"},[m("span",null,"Pending"),m("span",null,"Waiting to work on")],-1)))],ba=["onClick"],wa=[ie((()=>m("div",{class:"icon"},[m("i",{"aria-hidden":"true",class:"lnil lnil-pencil"})],-1))),ie((()=>m("div",{class:"meta"},[m("span",null,"Completed"),m("span",null,"Mark task as completed")],-1)))],ja=ie((()=>m("hr",{class:"dropdown-divider"},null,-1))),Ca=["onClick"],xa=[ie((()=>m("div",{class:"icon"},[m("i",{"aria-hidden":"true",class:"lnil lnil-pencil"})],-1))),ie((()=>m("div",{class:"meta"},[m("span",null,"Edit"),m("span",null,"Edit Task detail")],-1)))],Aa=["onClick"],Da=[ie((()=>m("div",{class:"icon"},[m("i",{"aria-hidden":"true",class:"lnil lnil-archive"})],-1))),ie((()=>m("div",{class:"meta"},[m("span",null,"Delete "),m("span",null,"Delete this task")],-1)))],Ta={class:"body"},Sa={class:"bottom-section"},Ia={class:"foot-block"},Pa=ie((()=>m("h4",{class:"heading"},"Worker(s)",-1))),Oa={class:"developers"},Ua={class:"foot-block"},Va=ie((()=>m("h4",{class:"heading"},"Start date",-1))),Ea={class:"foot-block"},$a=ie((()=>m("h4",{class:"heading"},"End date",-1))),Na={class:"foot-block"},Ma=ie((()=>m("h4",{class:"heading"},"Status",-1))),Fa=ie((()=>m("img",{class:"light-image is-larger",src:W,alt:""},null,-1))),Wa=ie((()=>m("img",{class:"dark-image is-larger",src:H,alt:""},null,-1))),Ha=O(i({__name:"ProjectsTasks",props:{projectID:{default:""}},emits:["update:getAllTasks","update:completedTasks","update:activeTasks"],setup(i,{emit:I}){const P=i,O=R(),U=L();n(1);const V=n("");n("Edit Project"),n("Add Task");const E=n(""),$=n("active");n(!1);const N=n(0);n(!1),n(!1);const W=n(!1);n(!1);const H=n(!1),K=n(0);n(0),n(0),n({}),n([]),n(""),n("");const z=n("");n(""),n([{value:"active",name:"Active"},{value:"pending",name:"Pre Construction"},{value:"completed",name:"Completed"},{value:"cancelled",name:"cancelled"}]),n({icon:"fa fa-bell",alertTitle:"Delete Task ?",alertDescription:"After deleting this task you will not be able to recover it"}),n({icon:"fa fa-warning",alertTitle:"Delete Project Permanently?",alertDescription:"After deleting this Project you will not be able to recover it"}),n([{id:0,username:"",email:"",phoneNumber:""}]);const B=n([{id:0,title:"",description:"",startDate:"",endDate:"",project:0,status:"",worker:[{id:0,username:"",email:"",role:"",avatar:""}],quantity:"",unit:"",costCode:""}]),Z=n({title:"",subtitle:"test",isSweetAlertOpen:!1,btntext:"text"}),q=e=>{K.value=e,Z.value={title:"Delete Task?",subtitle:"Do you really want to delete this task permanently?",btntext:"Yes, Delete",isSweetAlertOpen:!0}},Y=async()=>{try{W.value=!0;const e=await O.get(`api/task/${P.projectID}/project/`);B.value=e.data,console.log(e.data)}catch(e){console.log(e)}finally{W.value=!1}},G=o((()=>{let e=B.value.filter((e=>"active"==e.status));return I("update:completedTasks",e.length),e.length})),J=o((()=>{let e=B.value.filter((e=>"pending"==e.status));return I("update:activeTasks",e.length),e.length})),Q=o((()=>B.value.filter((e=>"completed"==e.status)).length)),X=e=>{z.value=e,H.value=!0},ee=()=>{Y(),H.value=!1,z.value=""},ae=async(e,a)=>{try{W.value=!0;await O.patch(`/api/task/${e}/`,{status:a,schedule_mode:localStorage.getItem("isScheduleMode")});Y(),U.success(`Task set to ${a} successfully`),N.value=0,W.value=!1}catch(l){console.log(l)}},le=async()=>{try{W.value=!0;const e=await O.delete(`/api/task/${K.value}/`);console.log(e),U.success("Task deleted successfully"),Y(),Z.value.isSweetAlertOpen=!1,N.value=0}catch(e){console.log(e)}finally{W.value=!1}},te=o((()=>{if(E.value){const e=new RegExp(E.value,"i");return B.value.filter((a=>"completed"!=a.status&&(a.title.match(e)||a.description.match(e)||a.status.match(e))))}return B.value.filter((e=>"completed"!=e.status))})),se=o((()=>{if(E.value){const e=new RegExp(E.value,"i");return B.value.filter((a=>"completed"==a.status&&(a.title.match(e)||a.description.match(e)||a.status.match(e))))}return B.value.filter((e=>"completed"==e.status))}));return r((()=>{Y()})),(i,n)=>{const o=F,r=M,I=D,O=T,U=s,N=t,K=l,L=a,R=e,ie=c("tooltip");return d(),u(C,null,[p(W)?(d(),v(o,{key:0})):(d(),u("div",ne,[m("div",oe,[h(O,null,{default:f((()=>[h(r,{class:"mr-2 h-hidden-mobile",icon:"feather:search"},{default:f((()=>[g(m("input",{"onUpdate:modelValue":n[0]||(n[0]=e=>y(E)?E.value=e:null),class:"input custom-text-filter",placeholder:"Search..."},null,512),[[k,p(E)]])])),_:1}),h(I,{onClick:n[1]||(n[1]=e=>X()),color:"primary",icon:"fas fa-plus",elevated:"",raised:""},{default:f((()=>[_("Task")])),_:1})])),_:1}),m("div",re,[m("div",ce,[m("ul",null,[m("li",{class:b(["active"===p($)&&"is-active"])},[m("a",{tabindex:"0",role:"button",onKeydown:n[2]||(n[2]=w(S((e=>$.value="active"),["prevent"]),["space"])),onClick:n[3]||(n[3]=e=>$.value="active")},ue,32)],2),m("li",{class:b(["closed"===p($)&&"is-active"])},[m("a",{tabindex:"0",role:"button",onKeydown:n[4]||(n[4]=w(S((e=>$.value="closed"),["prevent"]),["space"])),onClick:n[5]||(n[5]=e=>$.value="closed")},ve,32)],2),me])])])]),m("div",he,["active"===p($)?(d(),u("div",fe,[m("div",ge,[m("div",ke,[m("div",ye,[m("div",_e,[be,m("span",null,j(p(B).length),1),we])]),m("div",je,[m("div",Ce,[xe,m("span",null,j(p(Q)),1),Ae])]),m("div",De,[m("div",Te,[Se,m("span",null,j(p(J)),1),Ie])]),m("div",Pe,[m("div",Oe,[Ue,m("span",null,j(p(G)),1),Ve])])]),p(te).length?(d(),u("div",Ee,[(d(!0),u(C,null,x(p(te),(e=>(d(),u("div",$e,[m("div",Ne,[m("div",Me,[m("div",Fe,[m("h3",null,j(e.title),1),h(U,{icon:"feather:more-vertical",spaced:"",right:""},{content:f((()=>[m("a",{onClick:a=>ae(e.id,"active"),role:"menuitem",class:"dropdown-item is-media"},He,8,We),m("a",{onClick:a=>ae(e.id,"pending"),role:"menuitem",class:"dropdown-item is-media"},Le,8,Ke),m("a",{onClick:a=>ae(e.id,"completed"),role:"menuitem",class:"dropdown-item is-media"},ze,8,Re),Be,m("a",{onClick:a=>X(e.id),role:"menuitem",class:"dropdown-item is-media"},qe,8,Ze),m("a",{onClick:a=>q(e.id),role:"menuitem",class:"dropdown-item is-media"},Ge,8,Ye)])),_:2},1024)]),m("div",Je,[m("p",null,j(e.description),1)])]),m("div",Qe,[m("div",Xe,[ea,m("div",aa,[(d(!0),u(C,null,x(e.workers,(e=>g((d(),v(N,{picture:e.avatar,size:"small",color:"primary",initials:e.avatar?"":e.username.slice(0,2)},null,8,["picture","initials"])),[[ie,`${e.username}`,void 0,{rounded:!0,info:!0}]]))),256))])]),m("div",la,[ta,m("p",null,j(e.startDate),1)]),m("div",sa,[ia,m("p",null,j(e.endDate),1)]),m("div",na,[oa,m("p",null,j(e.status),1)])])])])))),256))])):(d(),v(K,{key:1,title:"There is no task added on this projects.",subtitle:"Looks like you don't have any task on this project yet. When you'll\n                start creating tasks of this project, they will be showing up in here."},{image:f((()=>[ra,ca])),_:1}))])])):"closed"===p($)?(d(),u("div",da,[m("div",ua,[p(se).length?(d(),u("div",pa,[(d(!0),u(C,null,x(p(se),(e=>(d(),u("div",va,[m("div",ma,[m("div",ha,[m("div",fa,[m("h3",null,j(e.title),1),h(U,{icon:"feather:more-vertical",spaced:"",right:""},{content:f((()=>[m("a",{onClick:a=>ae(e.id,"active"),role:"menuitem",class:"dropdown-item is-media"},ka,8,ga),m("a",{onClick:a=>ae(e.id,"pending"),role:"menuitem",class:"dropdown-item is-media"},_a,8,ya),m("a",{onClick:a=>ae(e.id,"completed"),role:"menuitem",class:"dropdown-item is-media"},wa,8,ba),ja,m("a",{onClick:a=>X(e.id),role:"menuitem",class:"dropdown-item is-media"},xa,8,Ca),m("a",{onClick:a=>q(e.id),role:"menuitem",class:"dropdown-item is-media"},Da,8,Aa)])),_:2},1024)]),m("div",Ta,[m("p",null,j(e.description),1)])]),m("div",Sa,[m("div",Ia,[Pa,m("div",Oa,[(d(!0),u(C,null,x(e.workers,(e=>g((d(),v(N,{picture:e.avatar,size:"small",color:"primary",initials:e.avatar?"":e.username.slice(0,2)},null,8,["picture","initials"])),[[ie,`${e.username}`,void 0,{rounded:!0,info:!0}]]))),256))])]),m("div",Ua,[Va,m("p",null,j(e.startDate),1)]),m("div",Ea,[$a,m("p",null,j(e.endDate),1)]),m("div",Na,[Ma,m("p",null,j(e.status),1)])])])])))),256))])):(d(),v(K,{key:1,title:"No closed projects.",subtitle:"Looks like you don't have any closed project yet. When you'll\n                start closing off projects, they will be showing up in here."},{image:f((()=>[Fa,Wa])),_:1}))])])):A("",!0)])])),p(Z).isSweetAlertOpen?(d(),v(L,{key:2,isSweetAlertOpen:p(Z).isSweetAlertOpen,title:p(Z).title,subtitle:p(Z).subtitle,btntext:p(Z).btntext,onConfirm:le,loading:p(W),onCancel:()=>p(Z).isSweetAlertOpen=!1},null,8,["isSweetAlertOpen","title","subtitle","btntext","loading","onCancel"])):A("",!0),p(H)?(d(),v(R,{key:3,projectID:P.projectID,isOpen:p(H),taskIdSelected:p(z),startDate:p(V),"onUpdate:modalHandler":ee,"onUpdate:OnSuccess":Y},null,8,["projectID","isOpen","taskIdSelected","startDate"])):A("",!0)],64)}}}),[["__scopeId","data-v-00cffb1a"]]),Ka=e=>(I("data-v-53696bb6"),e=e(),P(),e),La={class:"tile-grid-toolbar"},Ra={class:"buttons"},za={class:"file"},Ba={class:"file-label"},Za=Ka((()=>m("span",{style:{"background-color":"var(--primary)",color:"#fff"},class:"file-cta"},[m("span",{class:"file-icon"},[m("i",{class:"fas fa-plus"})]),m("span",{class:"file-label"}," File ")],-1))),qa={class:"tile-grid tile-grid-v2"},Ya=Ka((()=>m("img",{class:"light-image",src:J,alt:""},null,-1))),Ga=Ka((()=>m("img",{class:"dark-image",src:Q,alt:""},null,-1))),Ja={class:"tile-grid-item"},Qa={class:"tile-grid-item-inner"},Xa={class:"meta"},el={class:"dark-inverted"},al=["onClick"],ll=[Ka((()=>m("div",{class:"icon"},[m("i",{"aria-hidden":"true",class:"lnil lnil-trash-can-alt"})],-1))),Ka((()=>m("div",{class:"meta"},[m("span",null,"Delete"),m("span",null,"Delete this file")],-1)))],tl=O(i({__name:"ProjectFiles",props:{projectId:{},files:{}},emits:["update:onUploadFile"],setup(e,{emit:t}){const i=e,r=R(),c=L(),_=n(!1),w=n(""),D=o((()=>w.value?i.files.filter((e=>e.match(new RegExp(w.value,"i")))):i.files)),T=n(""),S=n(""),I=e=>{const a=e.match(/\d{4}-\d{2}-\d{2}/);if(a){return a[0]}return"N/A"},P=e=>{let a=e.target.files[0];(async e=>{try{_.value=!0;const a=await r.post(`/api/task/bulk-upload/${i.projectId}/`,{file:e});c.green("Tasks Will be generated automatically"),console.log(a),t("update:onUploadFile",null),_.value=!1}catch(a){console.log(a)}})(a),S.value=a.name},O=n({title:"",subtitle:"test",isSweetAlertOpen:!1,btntext:"text"}),V=async()=>{try{_.value=!0;await r.patch(`/api/project/${i.projectId}/delete-doc-tasks/`,{document_name:T.value});t("update:onUploadFile",null),c.success("Sheet deleted successfully!"),O.value.isSweetAlertOpen=!1}catch(e){console.log(e)}finally{_.value=!1}};return(e,t)=>{const i=M,n=B,o=l,r=s,c=a;return d(),u(C,null,[m("div",null,[m("div",La,[h(i,{icon:"feather:search"},{default:f((()=>[g(m("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>y(w)?w.value=e:null),class:"input custom-text-filter",placeholder:"Search..."},null,512),[[k,p(w)]])])),_:1}),m("div",Ra,[h(n,{grouped:""},{default:f((()=>[h(i,null,{default:f((()=>[m("div",za,[m("label",Ba,[m("input",{onChange:P,class:"file-input",type:"file",name:"file",style:{"background-color":"var(--primary)",color:"#fff"}},null,32),Za])])])),_:1})])),_:1})])]),m("div",qa,[h(o,{class:b([0!==p(D).length&&"is-hidden"]),title:"There is not file uploaded",subtitle:"There is no file uploaded on this project to create the tasks. As you will upload the file and that will appear here on the spot",larger:""},{image:f((()=>[Ya,Ga])),_:1},8,["class"]),h(U,{name:"list",tag:"div",class:"columns is-multiline"},{default:f((()=>[(d(!0),u(C,null,x(p(D),(e=>(d(),u("div",{key:e.id,class:"column is-6"},[m("div",Ja,[m("div",Qa,[m("img",{src:X,alt:"",onErrorOnce:t[1]||(t[1]=e=>p(ee)(150))},null,32),m("div",Xa,[m("span",el,j(e.length>20?e.slice(0,24):e),1),m("span",null,[m("span",null,"Updated: "+j(I(e)),1)])]),h(r,{icon:"feather:more-vertical",spaced:"",right:""},{content:f((()=>[m("a",{onClick:a=>{return l=e,T.value=l,void(O.value={title:"Are you sure?",subtitle:"This file and all task generated from this file will be deleted permanently!",btntext:"Yes, Delete it",isSweetAlertOpen:!0});var l},role:"menuitem",class:"dropdown-item is-media"},ll,8,al)])),_:2},1024)])])])))),128))])),_:1})])]),p(O).isSweetAlertOpen?(d(),v(c,{key:0,isSweetAlertOpen:p(O).isSweetAlertOpen,title:p(O).title,subtitle:p(O).subtitle,btntext:p(O).btntext,onConfirm:V,onCancel:()=>p(O).isSweetAlertOpen=!1},null,8,["isSweetAlertOpen","title","subtitle","btntext","onCancel"])):A("",!0)],64)}}}),[["__scopeId","data-v-53696bb6"]]),sl=e=>(I("data-v-ca2fe52f"),e=e(),P(),e),il={class:"personal-dashboard personal-dashboard-v2"},nl={class:"columns is-multiline"},ol={class:"column is-12"},rl={class:"dashboard-header is-relative"},cl={class:"user-meta is-dark-bordered-12"},dl={class:"title is-4 is-narrow is-bold"},ul={class:"light-text"},pl={class:"info-text is-bold"},vl=sl((()=>m("i",{class:"fas fa-home"},null,-1))),ml={class:"user-action"},hl=sl((()=>m("h3",{class:"title is-5 is-narrow"},"Information",-1))),fl={class:"light-text"},gl={class:"light-text"},kl={class:"light-text"},yl={class:"media-flex inverted-text"},_l=sl((()=>m("a",{class:"link inverted-text"},"Change status",-1))),bl={key:0,class:"tabs-inner"},wl={class:"tabs is-boxed",slider:""},jl=[sl((()=>m("span",null,"Project info",-1)))],Cl=[sl((()=>m("span",null,"Tasks",-1)))],xl=sl((()=>m("li",{class:"tab-naver"},null,-1))),Al={key:1,class:"columns is-multiline"},Dl={key:0,class:"column is-8"},Tl={class:"dashboard-card has-margin-bottom"},Sl=["innerHTML"],Il={class:"dashboard-card has-margin-bottom"},Pl={class:"dashboard-card"},Ol=sl((()=>m("div",{class:"card-head"},[m("h3",{class:"dark-inverted"},"Task Completion"),m("a",{class:"action-link",tabindex:"0"},"Reports")],-1))),Ul={class:"dashboard-card"},Vl=sl((()=>m("div",{class:"card-head"},[m("h3",{class:"dark-inverted"},"Assigned Manager"),m("a",{class:"action-link",tabindex:"0"})],-1))),El={class:"active-team"},$l={key:0,class:"user-list"},Nl={class:"user-list-info"},Ml={class:"name dark-inverted"},Fl={class:"position"},Wl=sl((()=>m("div",{class:"user-list-icons"},null,-1))),Hl={key:1,class:"user-list"},Kl=[sl((()=>m("div",{class:"user-list-info"},[m("div",{class:"name dark-inverted"},"No Manager assigned yet")],-1)))],Ll={class:"dashboard-card"},Rl={class:"card-head"},zl=sl((()=>m("h3",{class:"dark-inverted"},"Client Information",-1))),Bl={class:"active-team"},Zl={key:0,class:"user-list"},ql={class:"user-list-info"},Yl={class:"name dark-inverted"},Gl={class:"position"},Jl=sl((()=>m("div",{class:"user-list-icons"},null,-1))),Ql={key:1,class:"user-list"},Xl=[sl((()=>m("div",{class:"user-list-info"},[m("div",{class:"name dark-inverted"},"No Client Info Added yet")],-1)))],et={key:2},at={class:"dashboard-card"},lt={class:"card-head"},tt=sl((()=>m("h3",{class:"dark-inverted"},"Contractor Information",-1))),st={class:"active-team"},it={key:0,class:"user-list"},nt={class:"user-list-info"},ot={class:"name dark-inverted"},rt={class:"position"},ct=sl((()=>m("div",{class:"user-list-icons"},null,-1))),dt={key:1,class:"user-list"},ut=[sl((()=>m("div",{class:"user-list-info"},[m("div",{class:"name dark-inverted"}," No contractor Info Added yet ")],-1)))],pt={key:2},vt={class:"dashboard-card"},mt={key:2,class:"columns is-multiline"},ht={class:"column is-12"},ft=O(i({__name:"ProjectDetail",setup(e){const a=te(),l=R(),s=L(),i=V(),o=E(),c=se(),g=n("detail"),k=n(!1),y=n(!1);n(!1);const D=n(!1);n(!1);const T=n(!1),I=n([]),P=n([]),O=n([]);n(0);const U=n(0),F=n(0);n(""),n(""),n("");const W=n("");n("");const H=n("");n("");const J=n([{id:0,username:"",email:"",phoneNumber:""}]);n([{value:"active",name:"Active"},{value:"pending",name:"Pre Construction"},{value:"completed",name:"Completed"},{value:"cancelled",name:"cancelled"}]);const Q=n([]),X=n({id:0,title:"",created:"",startDate:"",color:"",endDate:"",description:"",image:"",is_active:null,status:"",address:"",total_tasks:0,client:0,contractor:0,clientInfo:{id:0,username:"",email:"",password:"",avatar:null},uploaded_files:[],contractorInfo:{id:0,username:"",email:"",password:"",avatar:null},managers:[{id:0,username:"",avatar:null,email:"",role:""}]});n({title:"",description:"",startDate:"",endDate:"",status:"",project:i.params.id,workers:[]});const ee=n([{id:0,title:"",description:"",startDate:"",endDate:"",project:0,status:"",worker:[{id:0,username:"",email:"",role:"",avatar:""}]}]),ie=$({height:180,type:"radialBar",series:[],title:{text:""},chart:{toolbar:{show:!1}},colors:[a.primary,a.purple,a.orange],plotOptions:{radialBar:{hollow:{size:"55%"}}},labels:["Progress"]}),ne=$({series:[{name:"Pending",data:[31,40,28,51,42,109,100]},{name:"Completed",data:[11,32,45,32,34,52,41]},{name:"Blocked",data:[78,53,36,10,14,5,2]}],chart:{height:295,type:"area",toolbar:{show:!1}},colors:[a.accent,a.info,a.primary],legend:{position:"top"},dataLabels:{enabled:!1},stroke:{width:[2,3,5],curve:"smooth"},xaxis:{type:"date",categories:["2020-09-19","2020-09-20","2020-09-21","2020-09-22","2020-09-23","2020-09-24","2020-09-25"]},tooltip:{x:{format:"dd/MM/yy HH:mm"}}}),oe=()=>{D.value=!D.value},re=()=>{y.value=!y.value},ce=n(0),de=async()=>{try{k.value=!0;const e=await l.get(`/api/project/${H.value}/`);X.value=e.data;let a=e.data.percentage.toFixed(2);ie.value.series.push(a),W.value=e.data.image,ue()}catch(e){console.log(e)}finally{k.value=!1}},ue=async()=>{try{k.value=!0;const e=await l.get(`api/task/${i.params.id}/project/`);ee.value=e.data,console.log(e.data),(()=>{let e=ee.value.filter((e=>"active"==e.status));ce.value=e.length})(),k.value=!1}catch(e){console.log(e)}},pe=async()=>{try{X.value.managers=O;let e=K(X.value,["image"]);e.delete("clientInfo"),e.delete("contractorInfo"),"object"==typeof X.value.client&&e.delete("client"),"object"==typeof X.value.contractor&&e.delete("contractor");const a=await l.patch(`/api/project/${i.params.id}/`,e);y.value=!1,D.value=!1,s.green("Project updated successfully"),de(a.data.id)}catch(e){console.log(e)}};n("");const ve=e=>{U.value=e},me=e=>{F.value=e};return r((()=>{H.value=i.params.id,de(),(async()=>{try{T.value=!0;const e=await l.get("/api/users/",{});J.value=e.data.filter((e=>"worker"==e.role)),I.value=e.data.filter((e=>"client"==e.role)),P.value=e.data.filter((e=>"contractor"==e.role)),console.log("data",J.value)}catch(e){console.log(e)}finally{T.value=!1}})(),ue(),(async()=>{try{const e=await l.get(`/api/task/today-tasks/?project=${i.params.id}`);Q.value=e.data}catch(e){console.log(e)}})()})),(e,a)=>{const l=ae,s=t,n=N("Address"),r=tl,T=G,O=N("Tippy"),U=Y,V=Z,E=q,$=M,F=B,W=z,H=Ha;return d(),u("div",il,[m("div",nl,[m("div",ol,[m("div",rl,["admin"==p(c).user.role||"manager"==p(c).user.role?(d(),v(l,{key:0,style:{position:"absolute",top:"10px","font-size":"18px","font-weight":"600",right:"10px",color:"var(--info)"},class:"cu-pointer",onClick:a[0]||(a[0]=()=>{p(o).push(`/sidebar/dashboard/projects/add-project/?id=${p(X).id}`)}),icon:"lucide:edit"})):A("",!0),h(s,{picture:p(X).image,squared:"",color:"primary",badge:"/images/icons/flags/united-states-of-america.svg",size:"xxl"},null,8,["picture"]),m("div",cl,[m("h3",dl,j(p(X).title?p(X).title:"N/A"),1),m("p",ul,[_(" Current status: "),m("span",pl,j("pending"===p(X).status?"Pre Construction":p(X).status.charAt(0).toUpperCase()+p(X).status.slice(1)),1)]),h(n,null,{default:f((()=>[vl,_(" "+j(p(X).address),1)])),_:1})]),m("div",ml,[hl,m("p",fl," Started at: "+j(p(X)?.startDate?p(X)?.startDate:"N/A"),1),m("p",gl," Expected end: "+j(p(X)?.endDate?p(X)?.endDate:"N/A"),1),m("p",kl," Total jobs: "+j(p(X).total_tasks?p(X).total_tasks:"N/A")+" Tasks ",1)]),m("div",null,[m("div",yl,[p(k)?A("",!0):(d(),v(p(le),{key:0,id:"completion-chart",height:p(ie).height,type:p(ie).type,series:p(ie).series,options:p(ie)},null,8,["height","type","series","options"]))]),_l])])])]),"admin"==p(c).user.role||"manager"==p(c).user.role?(d(),u("div",bl,[m("div",wl,[m("ul",null,[m("li",{class:b(["detail"===p(g)&&"is-active"])},[m("a",{tabindex:"0",role:"button",onKeydown:a[1]||(a[1]=w(S((e=>g.value="detail"),["prevent"]),["space"])),onClick:a[2]||(a[2]=e=>g.value="detail")},jl,32)],2),m("li",{class:b(["tasks"===p(g)&&"is-active"])},[m("a",{tabindex:"0",role:"button",onKeydown:a[3]||(a[3]=w(S((e=>g.value="tasks"),["prevent"]),["space"])),onClick:a[4]||(a[4]=e=>g.value="tasks")},Cl,32)],2),xl])])])):A("",!0),"detail"===p(g)?(d(),u("div",Al,["admin"==p(c).user.role||"manager"==p(c).user.role?(d(),u("div",Dl,[m("div",Tl,[m("div",{innerHTML:p(X).description},null,8,Sl)]),m("div",Il,[h(r,{projectId:p(i).params.id,files:p(X).uploaded_files,"onUpdate:onUploadFile":de},null,8,["projectId","files"])]),m("div",Pl,[Ol,h(p(le),{id:"completion-chart",height:p(ne).chart.height,type:p(ne).chart.type,series:p(ne).series,options:p(ne)},null,8,["height","type","series","options"])])])):A("",!0),m("div",{class:b("admin"==p(c).user.role||"manager"==p(c).user.role?"column is-4":"column is-12")},[m("div",Ul,[Vl,m("div",El,[p(X).managers.length>0?(d(),u("ul",$l,[(d(!0),u(C,null,x(p(X).managers,(e=>(d(),u("li",{key:e.id},[m("div",null,[h(O,{class:"has-help-cursor",interactive:"",offset:[0,10]},{content:f((()=>[h(T,{user:e},null,8,["user"])])),default:f((()=>[h(s,{picture:e.avatar},null,8,["picture"])])),_:2},1024)]),m("div",Nl,[m("div",Ml,j(e.username),1),m("div",Fl,j(e.email),1)]),Wl])))),128))])):(d(),u("ul",Hl,Kl))])]),m("div",Ll,[m("div",Rl,[zl,"admin"==p(c).user.role||"manager"==p(c).user.role?(d(),u("a",{key:0,onClick:re,class:"action-link",tabindex:"0"},j(p(y)?"Close":"Edit"),1)):A("",!0)]),m("div",Bl,[p(X).client?(d(),u("ul",Zl,[m("li",null,[m("div",null,[h(O,{class:"has-help-cursor",interactive:"",offset:[0,10]},{content:f((()=>[h(T,{user:p(X).client},null,8,["user"])])),default:f((()=>[h(s,{picture:p(X).client.avatar},null,8,["picture"])])),_:1})]),m("div",ql,[m("div",Yl,j(p(X).client.username),1),m("div",Gl,j(p(X).client.email),1)]),Jl])])):(d(),u("ul",Ql,Xl)),p(y)?(d(),u("div",et,[h(F,null,{default:f((()=>[h(U,null,{default:f((()=>[_("Select client")])),_:1}),h($,null,{default:f((()=>[h(E,{modelValue:p(X).client,"onUpdate:modelValue":a[5]||(a[5]=e=>p(X).client=e),onChange:pe},{default:f((()=>[h(V,{value:""},{default:f((()=>[_(" Clients ")])),_:1}),(d(!0),u(C,null,x(p(I),(e=>(d(),v(V,{key:e.id,value:e.id},{default:f((()=>[_(j(e.username),1)])),_:2},1032,["value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1})])):A("",!0)])]),m("div",at,[m("div",lt,[tt,"admin"==p(c).user.role||"manager"==p(c).user.role?(d(),u("a",{key:0,onClick:oe,class:"action-link",tabindex:"0"},j(p(D)?"Close":"Edit"),1)):A("",!0)]),m("div",st,[p(X).contractor?(d(),u("ul",it,[m("li",null,[m("div",null,[h(O,{class:"has-help-cursor",interactive:"",offset:[0,10]},{content:f((()=>[h(T,{user:p(X).contractor},null,8,["user"])])),default:f((()=>[h(s,{picture:p(X).contractor.avatar},null,8,["picture"])])),_:1})]),m("div",nt,[m("div",ot,j(p(X).contractor.username),1),m("div",rt,j(p(X).contractor.email),1)]),ct])])):(d(),u("ul",dt,ut)),p(D)?(d(),u("div",pt,[h(F,null,{default:f((()=>[h(U,null,{default:f((()=>[_("Select contractor")])),_:1}),h($,null,{default:f((()=>[h(E,{modelValue:p(X).contractor,"onUpdate:modelValue":a[6]||(a[6]=e=>p(X).contractor=e),onChange:pe},{default:f((()=>[(d(!0),u(C,null,x(p(P),(e=>(d(),v(V,{key:e.id,value:e.id},{default:f((()=>[_(j(e.username),1)])),_:2},1032,["value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1})])):A("",!0)])]),m("div",vt,[h(W,{projectId:p(i).params.id},null,8,["projectId"])])],2)])):A("",!0),"tasks"===p(g)?(d(),u("div",mt,[m("div",ht,[h(H,{"onUpdate:completedTasks":ve,"onUpdate:activeTasks":me,projectID:p(i).params.id},null,8,["projectID"])])])):A("",!0)])}}}),[["__scopeId","data-v-ca2fe52f"]]);export{ft as _};
