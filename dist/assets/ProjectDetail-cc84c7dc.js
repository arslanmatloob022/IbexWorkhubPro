import{_ as e}from"./UpdateTask.vue_vue_type_script_setup_true_lang-39ba4f73.js";import{_ as a}from"./SweetAlert.vue_vue_type_style_index_0_lang-7ea203fc.js";import{_ as l}from"./VPlaceholderPage.vue_vue_type_style_index_0_lang-5cede0f3.js";import{_ as t}from"./VTag.vue_vue_type_style_index_0_lang-b72e22d4.js";import{_ as s}from"./VAvatar.vue_vue_type_style_index_0_lang-0dd05b73.js";import{_ as i}from"./VDropdown.vue_vue_type_style_index_0_lang-dccc85ca.js";import{e as n,r as o,Z as r,o as c,au as d,B as u,C as p,l as v,N as m,D as h,E as g,F as f,K as k,W as _,j as y,J as b,H as w,G as j,T as C,U as x,V as S,M as A,O as T,ak as D,I,a3 as V,P as O,Q as U,R as P,aR as E,x as $,v as N,s as M,A as z}from"./index-e7dfe9a4.js";import{_ as F}from"./VControl-481683c7.js";import{_ as W}from"./PlaceloadV3.vue_vue_type_style_index_0_lang-477fead2.js";import{_ as L,a as R}from"./projects-dark-4a371d8a.js";import{a as K}from"./useSupportElement-6aaafdea.js";import{u as H}from"./useNotyf-987b3464.js";import{u as q}from"./useAPI-91510d39.js";import{_ as B}from"./ProjectTodayTasks.vue_vue_type_style_index_0_lang-44802ccf.js";import{_ as G,a as J}from"./VOption.vue_vue_type_style_index_0_lang-ecc7ba73.js";import{_ as Y}from"./VLabel.vue_vue_type_script_setup_true_lang-771cf1a5.js";import{_ as Z}from"./VField.vue_vue_type_script_setup_true_lang-687923b6.js";import{_ as Q}from"./UserPopoverContent.vue_vue_type_script_setup_true_lang-87f18971.js";import{_ as X}from"./VModal.vue_vue_type_style_index_0_lang-417ace5b.js";import{_ as ee}from"./VInput.vue_vue_type_script_setup_true_lang-6ddab63d.js";import{_ as ae,a as le}from"./search-4-dark-2b5b440c.js";import{_ as te}from"./sheet-50221dfe.js";import{o as se}from"./via-placeholder-24645670.js";import{_ as ie}from"./VIcon.vue_vue_type_script_setup_true_lang-578186d3.js";import{A as ne}from"./vue3-apexcharts.common-a01a75f9.js";import{u as oe}from"./useThemeColors-a807ce5c.js";import{u as re}from"./userSession-a8987e04.js";const ce=e=>(O("data-v-f44e0448"),e=e(),U(),e),de={key:1},ue={class:"list-flex-toolbar is-reversed"},pe={class:"tabs-inner"},ve={class:"tabs"},me=ce((()=>h("span",null,"All",-1))),he=[me],ge=ce((()=>h("span",null,"Completed",-1))),fe=[ge],ke=ce((()=>h("li",{class:"tab-naver"},null,-1))),_e={class:"flex-list-wrapper flex-list-v2"},ye={key:0,class:"tab-content is-active"},be={class:"all-projects"},we={class:"all-projects-header"},je={class:"header-item"},Ce={class:"item-inner"},xe=ce((()=>h("i",{"aria-hidden":"true",class:"lnil lnil-analytics-alt-1"},null,-1))),Se=ce((()=>h("p",null,"Total Tasks",-1))),Ae={class:"header-item"},Te={class:"item-inner"},De=ce((()=>h("i",{"aria-hidden":"true",class:"lnil lnil-target-alt-1"},null,-1))),Ie=ce((()=>h("p",null,"Completed Tasks",-1))),Ve={class:"header-item"},Oe={class:"item-inner"},Ue=ce((()=>h("i",{"aria-hidden":"true",class:"lnil lnil-pie-chart-alt"},null,-1))),Pe=ce((()=>h("p",null,"Pending Tasks",-1))),Ee={class:"header-item"},$e={class:"item-inner"},Ne=ce((()=>h("i",{"aria-hidden":"true",class:"lnil lnil-leaf"},null,-1))),Me=ce((()=>h("p",null,"Active Tasks",-1))),ze={key:0,class:"columns is-multiline projects-card-grid"},Fe={class:"column is-6"},We={class:"top-section"},Le={class:"head"},Re=["onClick"],Ke=[ce((()=>h("div",{class:"icon"},[h("i",{class:"lnir lnir-play","aria-hidden":"true"})],-1))),ce((()=>h("div",{class:"meta"},[h("span",null,"Active"),h("span",null,"Start work on this task")],-1)))],He=["onClick"],qe=[ce((()=>h("div",{class:"icon"},[h("i",{class:"lnir lnir-playlist-alt","aria-hidden":"true"})],-1))),ce((()=>h("div",{class:"meta"},[h("span",null,"Pending"),h("span",null,"Waiting to work on")],-1)))],Be=["onClick"],Ge=[ce((()=>h("div",{class:"icon"},[h("i",{class:"lnir lnir-round-box-check","aria-hidden":"true"})],-1))),ce((()=>h("div",{class:"meta"},[h("span",null,"Completed"),h("span",null,"Mark task as completed")],-1)))],Je=ce((()=>h("hr",{class:"dropdown-divider"},null,-1))),Ye=["onClick"],Ze=[ce((()=>h("div",{class:"icon"},[h("i",{class:"lnir lnir-pencil-alt","aria-hidden":"true"})],-1))),ce((()=>h("div",{class:"meta"},[h("span",null,"Edit"),h("span",null,"Edit Task detail")],-1)))],Qe=["onClick"],Xe=[ce((()=>h("div",{class:"icon"},[h("i",{class:"lnir lnir-trash-can-alt-1","aria-hidden":"true"})],-1))),ce((()=>h("div",{class:"meta"},[h("span",null,"Delete "),h("span",null,"Delete this task")],-1)))],ea={class:"body"},aa={class:"bottom-section"},la={class:"foot-block"},ta=ce((()=>h("h4",{class:"heading"},"Worker(s)",-1))),sa={class:"developers"},ia={class:"foot-block"},na=ce((()=>h("h4",{class:"heading"},"Start date",-1))),oa={class:"foot-block"},ra=ce((()=>h("h4",{class:"heading"},"End date",-1))),ca={class:"foot-block"},da=ce((()=>h("h4",{class:"heading"},"Status",-1))),ua=ce((()=>h("img",{class:"light-image is-larger",src:L,alt:""},null,-1))),pa=ce((()=>h("img",{class:"dark-image is-larger",src:R,alt:""},null,-1))),va={key:1,class:"tab-content is-active"},ma={class:"all-projects"},ha={key:0,class:"columns is-multiline projects-card-grid"},ga={class:"column is-6"},fa={class:"grid-item"},ka={class:"top-section"},_a={class:"head"},ya=["onClick"],ba=[ce((()=>h("div",{class:"icon"},[h("i",{"aria-hidden":"true",class:"lnil lnil-eye"})],-1))),ce((()=>h("div",{class:"meta"},[h("span",null,"Active"),h("span",null,"Start work on this task")],-1)))],wa=["onClick"],ja=[ce((()=>h("div",{class:"icon"},[h("i",{"aria-hidden":"true",class:"lnil lnil-pencil"})],-1))),ce((()=>h("div",{class:"meta"},[h("span",null,"Pending"),h("span",null,"Waiting to work on")],-1)))],Ca=["onClick"],xa=[ce((()=>h("div",{class:"icon"},[h("i",{"aria-hidden":"true",class:"lnil lnil-pencil"})],-1))),ce((()=>h("div",{class:"meta"},[h("span",null,"Completed"),h("span",null,"Mark task as completed")],-1)))],Sa=ce((()=>h("hr",{class:"dropdown-divider"},null,-1))),Aa=["onClick"],Ta=[ce((()=>h("div",{class:"icon"},[h("i",{"aria-hidden":"true",class:"lnil lnil-pencil"})],-1))),ce((()=>h("div",{class:"meta"},[h("span",null,"Edit"),h("span",null,"Edit Task detail")],-1)))],Da=["onClick"],Ia=[ce((()=>h("div",{class:"icon"},[h("i",{"aria-hidden":"true",class:"lnil lnil-archive"})],-1))),ce((()=>h("div",{class:"meta"},[h("span",null,"Delete "),h("span",null,"Delete this task")],-1)))],Va={class:"body"},Oa={class:"bottom-section"},Ua={class:"foot-block"},Pa=ce((()=>h("h4",{class:"heading"},"Worker(s)",-1))),Ea={class:"developers"},$a={class:"foot-block"},Na=ce((()=>h("h4",{class:"heading"},"Start date",-1))),Ma={class:"foot-block"},za=ce((()=>h("h4",{class:"heading"},"End date",-1))),Fa={class:"foot-block"},Wa=ce((()=>h("h4",{class:"heading"},"Status",-1))),La=ce((()=>h("img",{class:"light-image is-larger",src:L,alt:""},null,-1))),Ra=ce((()=>h("img",{class:"dark-image is-larger",src:R,alt:""},null,-1))),Ka=P(n({__name:"ProjectsTasks",props:{projectID:{default:""}},emits:["update:getAllTasks","update:completedTasks","update:activeTasks"],setup(n,{emit:O}){const U=n,P=q(),E=H();o(1);const $=o("");o("Edit Project"),o("Add Task");const N=o(""),M=o("active"),z=o(0),L=o(!1),R=o(!1),K=o(0);o({});const B=o("");o([{id:0,username:"",email:"",phoneNumber:""}]);const G=o([{id:0,title:"",description:"",startDate:"",endDate:"",project:0,status:"",worker:[{id:0,username:"",email:"",role:"",avatar:""}],quantity:"",unit:"",costCode:""}]),J=o({title:"",subtitle:"test",isSweetAlertOpen:!1,btntext:"text"}),Y=e=>{K.value=e,J.value={title:"Delete Task?",subtitle:"Do you really want to delete this task permanently?",btntext:"Yes, Delete",isSweetAlertOpen:!0}},Z=async()=>{try{L.value=!0;const e=await P.get(`api/task/${U.projectID}/project/`);G.value=e.data,console.log(e.data)}catch(e){console.log(e)}finally{L.value=!1}},Q={active:"#336aeb",pending:"#faad42",canceled:"#e62864",completed:"#f3c2c2ff"},X={active:"info",pending:"warning",canceled:"danger",completed:"primary"},ee=r((()=>{let e=G.value.filter((e=>"active"==e.status));return O("update:completedTasks",e.length),e.length})),ae=r((()=>{let e=G.value.filter((e=>"pending"==e.status));return O("update:activeTasks",e.length),e.length})),le=r((()=>G.value.filter((e=>"completed"==e.status)).length)),te=e=>{B.value=e,R.value=!0},se=()=>{Z(),R.value=!1,B.value=""},ie=async(e,a)=>{try{L.value=!0;await P.patch(`/api/task/${e}/`,{status:a,schedule_mode:localStorage.getItem("isScheduleMode")});Z(),E.success(`Task set to ${a} successfully`),z.value=0,L.value=!1}catch(l){console.log(l)}},ne=async()=>{try{L.value=!0;const e=await P.delete(`/api/task/${K.value}/`);console.log(e),E.success("Task deleted successfully"),Z(),J.value.isSweetAlertOpen=!1,z.value=0}catch(e){console.log(e)}finally{L.value=!1}},oe=r((()=>{if(N.value){const e=new RegExp(N.value,"i");return G.value.filter((a=>"completed"!=a.status&&(a.title.match(e)||a.description.match(e)||a.status.match(e))))}return G.value.filter((e=>"completed"!=e.status))})),re=r((()=>{if(N.value){const e=new RegExp(N.value,"i");return G.value.filter((a=>"completed"==a.status&&(a.title.match(e)||a.description.match(e)||a.status.match(e))))}return G.value.filter((e=>"completed"==e.status))}));return c((()=>{Z()})),(n,o)=>{const r=W,c=F,O=T,P=D,E=i,z=s,K=t,H=l,q=a,ce=e,me=d("tooltip");return u(),p(x,null,[v(L)?(u(),m(r,{key:0})):(u(),p("div",de,[h("div",ue,[g(P,null,{default:f((()=>[g(c,{class:"mr-2 h-hidden-mobile",icon:"feather:search"},{default:f((()=>[k(h("input",{"onUpdate:modelValue":o[0]||(o[0]=e=>y(N)?N.value=e:null),class:"input custom-text-filter",placeholder:"Search..."},null,512),[[_,v(N)]])])),_:1}),g(O,{onClick:o[1]||(o[1]=e=>te()),color:"primary",icon:"fas fa-plus",elevated:"",raised:""},{default:f((()=>[b("Task")])),_:1})])),_:1}),h("div",pe,[h("div",ve,[h("ul",null,[h("li",{class:w(["active"===v(M)&&"is-active"])},[h("a",{tabindex:"0",role:"button",onKeydown:o[2]||(o[2]=j(I((e=>M.value="active"),["prevent"]),["space"])),onClick:o[3]||(o[3]=e=>M.value="active")},he,32)],2),h("li",{class:w(["closed"===v(M)&&"is-active"])},[h("a",{tabindex:"0",role:"button",onKeydown:o[4]||(o[4]=j(I((e=>M.value="closed"),["prevent"]),["space"])),onClick:o[5]||(o[5]=e=>M.value="closed")},fe,32)],2),ke])])])]),h("div",_e,["active"===v(M)?(u(),p("div",ye,[h("div",be,[h("div",we,[h("div",je,[h("div",Ce,[xe,h("span",null,C(v(G).length),1),Se])]),h("div",Ae,[h("div",Te,[De,h("span",null,C(v(le)),1),Ie])]),h("div",Ve,[h("div",Oe,[Ue,h("span",null,C(v(ae)),1),Pe])]),h("div",Ee,[h("div",$e,[Ne,h("span",null,C(v(ee)),1),Me])])]),v(oe).length?(u(),p("div",ze,[(u(!0),p(x,null,S(v(oe),(e=>(u(),p("div",Fe,[h("div",{class:"grid-item",style:V({backgroundImage:`linear-gradient(350deg, white 65%, ${Q[e.status]}30)`})},[h("div",We,[h("div",Le,[h("h3",null,C(e.title),1),g(E,{icon:"feather:more-vertical",spaced:"",right:""},{content:f((()=>[h("a",{onClick:a=>ie(e.id,"active"),role:"menuitem",class:"dropdown-item is-media"},Ke,8,Re),h("a",{onClick:a=>ie(e.id,"pending"),role:"menuitem",class:"dropdown-item is-media"},qe,8,He),h("a",{onClick:a=>ie(e.id,"completed"),role:"menuitem",class:"dropdown-item is-media"},Ge,8,Be),Je,h("a",{onClick:a=>te(e.id),role:"menuitem",class:"dropdown-item is-media"},Ze,8,Ye),h("a",{onClick:a=>Y(e.id),role:"menuitem",class:"dropdown-item is-media"},Xe,8,Qe)])),_:2},1024)]),h("div",ea,[h("p",null,C(e.description),1)])]),h("div",aa,[h("div",la,[ta,h("div",sa,[(u(!0),p(x,null,S(e.workers,(e=>k((u(),m(z,{picture:e.avatar,size:"small",color:"primary",initials:e.avatar?"":e.username.slice(0,2)},null,8,["picture","initials"])),[[me,`${e.username}`,void 0,{rounded:!0,info:!0}]]))),256))])]),h("div",ia,[na,h("p",null,C(e.startDate),1)]),h("div",oa,[ra,h("p",null,C(e.endDate),1)]),h("div",ca,[da,g(K,{outlined:"",rounded:"",color:X[e.status]},{default:f((()=>[b(C(e.status),1)])),_:2},1032,["color"])])])],4)])))),256))])):(u(),m(H,{key:1,title:"There is no task added on this projects.",subtitle:"Looks like you don't have any task on this project yet. When you'll\n                start creating tasks of this project, they will be showing up in here."},{image:f((()=>[ua,pa])),_:1}))])])):"closed"===v(M)?(u(),p("div",va,[h("div",ma,[v(re).length?(u(),p("div",ha,[(u(!0),p(x,null,S(v(re),(e=>(u(),p("div",ga,[h("div",fa,[h("div",ka,[h("div",_a,[h("h3",null,C(e.title),1),g(E,{icon:"feather:more-vertical",spaced:"",right:""},{content:f((()=>[h("a",{onClick:a=>ie(e.id,"active"),role:"menuitem",class:"dropdown-item is-media"},ba,8,ya),h("a",{onClick:a=>ie(e.id,"pending"),role:"menuitem",class:"dropdown-item is-media"},ja,8,wa),h("a",{onClick:a=>ie(e.id,"completed"),role:"menuitem",class:"dropdown-item is-media"},xa,8,Ca),Sa,h("a",{onClick:a=>te(e.id),role:"menuitem",class:"dropdown-item is-media"},Ta,8,Aa),h("a",{onClick:a=>Y(e.id),role:"menuitem",class:"dropdown-item is-media"},Ia,8,Da)])),_:2},1024)]),h("div",Va,[h("p",null,C(e.description),1)])]),h("div",Oa,[h("div",Ua,[Pa,h("div",Ea,[(u(!0),p(x,null,S(e.workers,(e=>k((u(),m(z,{picture:e.avatar,size:"small",color:"primary",initials:e.avatar?"":e.username.slice(0,2)},null,8,["picture","initials"])),[[me,`${e.username}`,void 0,{rounded:!0,info:!0}]]))),256))])]),h("div",$a,[Na,h("p",null,C(e.startDate),1)]),h("div",Ma,[za,h("p",null,C(e.endDate),1)]),h("div",Fa,[Wa,h("p",null,C(e.status),1)])])])])))),256))])):(u(),m(H,{key:1,title:"No closed projects.",subtitle:"Looks like you don't have any closed project yet. When you'll\n                start closing off projects, they will be showing up in here."},{image:f((()=>[La,Ra])),_:1}))])])):A("",!0)])])),v(J).isSweetAlertOpen?(u(),m(q,{key:2,isSweetAlertOpen:v(J).isSweetAlertOpen,title:v(J).title,subtitle:v(J).subtitle,btntext:v(J).btntext,onConfirm:ne,loading:v(L),onCancel:()=>v(J).isSweetAlertOpen=!1},null,8,["isSweetAlertOpen","title","subtitle","btntext","loading","onCancel"])):A("",!0),v(R)?(u(),m(ce,{key:3,projectID:U.projectID,isOpen:v(R),taskIdSelected:v(B),startDate:v($),"onUpdate:modalHandler":se,"onUpdate:OnSuccess":Z},null,8,["projectID","isOpen","taskIdSelected","startDate"])):A("",!0)],64)}}}),[["__scopeId","data-v-f44e0448"]]),Ha=e=>(O("data-v-0c7f5f21"),e=e(),U(),e),qa={class:"tile-grid-toolbar"},Ba={class:"buttons"},Ga={class:"tile-grid tile-grid-v2"},Ja=Ha((()=>h("img",{class:"light-image",src:ae,alt:""},null,-1))),Ya=Ha((()=>h("img",{class:"dark-image",src:le,alt:""},null,-1))),Za={class:"tile-grid-item"},Qa={class:"tile-grid-item-inner"},Xa={class:"meta"},el={class:"dark-inverted"},al=["onClick"],ll=[Ha((()=>h("div",{class:"icon"},[h("i",{"aria-hidden":"true",class:"lnil lnil-trash-can-alt"})],-1))),Ha((()=>h("div",{class:"meta"},[h("span",null,"Delete"),h("span",null,"Delete this file")],-1)))],tl={class:"modal-form columns is-multiline"},sl={class:"file has-name"},il={class:"file-label"},nl=Ha((()=>h("span",{class:"file-cta"},[h("span",{class:"file-icon"},[h("i",{class:"fas fa-cloud-upload-alt"})]),h("span",{class:"file-label"}," Choose a fileâ€¦ ")],-1))),ol={class:"file-name light-text"},rl=P(n({__name:"ProjectFiles",props:{projectId:{},files:{}},emits:["update:onUploadFile"],setup(e,{emit:t}){const s=e,n=q(),c=H(),d=o(!1),j=o(!1),D=o(""),V=r((()=>D.value?s.files.filter((e=>e.match(new RegExp(D.value,"i")))):s.files)),O=o(""),U=o(""),P=o("");let $=null;const N=async()=>{try{d.value=!0;const e=await n.post(`/api/task/bulk-upload/${s.projectId}/`,{file:$,start:P.value});c.green("Tasks Will be generated automatically"),console.log(e),t("update:onUploadFile",null),d.value=!1}catch(e){console.log(e)}finally{j.value=!1}},M=e=>{const a=e.match(/\d{4}-\d{2}-\d{2}/);if(a){return a[0]}return"N/A"},z=e=>{let a=e.target.files[0];$=a,U.value=a.name},W=o({title:"",subtitle:"test",isSweetAlertOpen:!1,btntext:"text"}),L=async()=>{try{d.value=!0;await n.patch(`/api/project/${s.projectId}/delete-doc-tasks/`,{document_name:O.value});t("update:onUploadFile",null),c.success("Sheet deleted successfully!"),W.value.isSweetAlertOpen=!1}catch(e){console.log(e)}finally{d.value=!1}};return(e,t)=>{const s=F,n=T,o=l,r=i,c=a,d=Y,$=ee,R=Z,K=X;return u(),p(x,null,[h("div",null,[h("div",qa,[g(s,{icon:"feather:search"},{default:f((()=>[k(h("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>y(D)?D.value=e:null),class:"input custom-text-filter",placeholder:"Search..."},null,512),[[_,v(D)]])])),_:1}),h("div",Ba,[g(n,{icon:"fas fa-plus",raised:"",size:"small",light:"",onClick:t[1]||(t[1]=e=>j.value=!v(j)),outlined:"",color:"primary"},{default:f((()=>[b(" File ")])),_:1})])]),h("div",Ga,[g(o,{class:w([0!==v(V).length&&"is-hidden"]),title:"There is not file uploaded",subtitle:"There is no file uploaded on this project to create the tasks. As you will upload the file and that will appear here on the spot",larger:""},{image:f((()=>[Ja,Ya])),_:1},8,["class"]),g(E,{name:"list",tag:"div",class:"columns is-multiline"},{default:f((()=>[(u(!0),p(x,null,S(v(V),(e=>(u(),p("div",{key:e.id,class:"column is-6"},[h("div",Za,[h("div",Qa,[h("img",{src:te,alt:"",onErrorOnce:t[2]||(t[2]=e=>v(se)(150))},null,32),h("div",Xa,[h("span",el,C(e.length>20?e.slice(0,24):e),1),h("span",null,[h("span",null,"Updated: "+C(M(e)),1)])]),g(r,{icon:"feather:more-vertical",spaced:"",right:""},{content:f((()=>[h("a",{onClick:a=>{return l=e,O.value=l,void(W.value={title:"Are you sure?",subtitle:"This file and all task generated from this file will be deleted permanently!",btntext:"Yes, Delete it",isSweetAlertOpen:!0});var l},role:"menuitem",class:"dropdown-item is-media"},ll,8,al)])),_:2},1024)])])])))),128))])),_:1})])]),v(W).isSweetAlertOpen?(u(),m(c,{key:0,isSweetAlertOpen:v(W).isSweetAlertOpen,title:v(W).title,subtitle:v(W).subtitle,btntext:v(W).btntext,onConfirm:L,onCancel:()=>v(W).isSweetAlertOpen=!1},null,8,["isSweetAlertOpen","title","subtitle","btntext","onCancel"])):A("",!0),g(K,{is:"form",open:v(j),title:"Upload Task File",size:"medium",actions:"right",onClose:t[5]||(t[5]=e=>j.value=!1),onSubmit:I(N,["prevent"])},{content:f((()=>[h("div",tl,[g(R,{class:"column is-12"},{default:f((()=>[g(d,null,{default:f((()=>[b("Start date of task")])),_:1}),g(s,null,{default:f((()=>[g($,{modelValue:v(P),"onUpdate:modelValue":t[3]||(t[3]=e=>y(P)?P.value=e:null),type:"date"},null,8,["modelValue"])])),_:1})])),_:1}),g(R,{class:"column is-12",grouped:""},{default:f((()=>[g(s,null,{default:f((()=>[h("div",sl,[h("label",il,[h("input",{onChange:z,class:"file-input",type:"file",name:"file",required:""},null,32),nl,h("span",ol,C(v(U)?v(U):"Upload any file"),1)])])])),_:1})])),_:1})])])),cancel:f((()=>[g(n,{onClick:t[4]||(t[4]=e=>j.value=!1),raised:""},{default:f((()=>[b("Close")])),_:1})])),action:f((()=>[g(n,{type:"submit",color:"primary",raised:""},{default:f((()=>[b("Upload")])),_:1})])),_:1},8,["open","onSubmit"])],64)}}}),[["__scopeId","data-v-0c7f5f21"]]),cl=e=>(O("data-v-5dd66bc1"),e=e(),U(),e),dl={class:"personal-dashboard personal-dashboard-v2"},ul={class:"columns is-multiline"},pl={class:"column is-12"},vl={class:"dashboard-header is-relative"},ml={class:"user-meta is-dark-bordered-12"},hl={class:"title is-4 is-narrow is-bold"},gl={class:"light-text"},fl={class:"info-text is-bold"},kl=cl((()=>h("i",{class:"fas fa-home"},null,-1))),_l={class:"user-action"},yl=cl((()=>h("h3",{class:"title is-5 is-narrow"},"Information",-1))),bl={class:"light-text"},wl={class:"light-text"},jl={class:"light-text"},Cl={class:"media-flex inverted-text"},xl=cl((()=>h("a",{class:"link inverted-text"},"Change status",-1))),Sl={key:0,class:"tabs-inner"},Al={class:"tabs is-boxed",slider:""},Tl=[cl((()=>h("span",null,"Project info",-1)))],Dl=[cl((()=>h("span",null,"Tasks",-1)))],Il=cl((()=>h("li",{class:"tab-naver"},null,-1))),Vl={key:1,class:"columns is-multiline"},Ol={key:0,class:"column is-8"},Ul={class:"dashboard-card has-margin-bottom"},Pl=["innerHTML"],El={class:"dashboard-card has-margin-bottom"},$l={class:"dashboard-card"},Nl=cl((()=>h("div",{class:"card-head"},[h("h3",{class:"dark-inverted"},"Task Completion"),h("a",{class:"action-link",tabindex:"0"},"Reports")],-1))),Ml={class:"dashboard-card"},zl={class:"card-head"},Fl=cl((()=>h("h3",{class:"dark-inverted"},"Assigned Manager",-1))),Wl={class:"active-team"},Ll={key:0,class:"user-list"},Rl={class:"user-list-info"},Kl={class:"name dark-inverted"},Hl={class:"position"},ql=cl((()=>h("div",{class:"user-list-icons"},null,-1))),Bl={key:1,class:"user-list"},Gl=[cl((()=>h("div",{class:"user-list-info"},[h("div",{class:"name dark-inverted"},"No Manager assigned yet")],-1)))],Jl={key:2},Yl={class:"is-flex space-between"},Zl={key:0},Ql={class:"dashboard-card"},Xl={class:"card-head"},et=cl((()=>h("h3",{class:"dark-inverted"},"Client Information",-1))),at={class:"active-team"},lt={key:0,class:"user-list"},tt={class:"user-list-info"},st={class:"name dark-inverted"},it={class:"position"},nt=cl((()=>h("div",{class:"user-list-icons"},null,-1))),ot={key:1,class:"user-list"},rt=[cl((()=>h("div",{class:"user-list-info"},[h("div",{class:"name dark-inverted"},"No Client Info Added yet")],-1)))],ct={key:2},dt={class:"dashboard-card"},ut={class:"card-head"},pt=cl((()=>h("h3",{class:"dark-inverted"},"Contractor Information",-1))),vt={class:"active-team"},mt={key:0,class:"user-list"},ht={class:"user-list-info"},gt={class:"name dark-inverted"},ft={class:"position"},kt=cl((()=>h("div",{class:"user-list-icons"},null,-1))),_t={key:1,class:"user-list"},yt=[cl((()=>h("div",{class:"user-list-info"},[h("div",{class:"name dark-inverted"}," No contractor Info Added yet ")],-1)))],bt={key:2},wt={class:"dashboard-card"},jt={key:2,class:"columns is-multiline"},Ct={class:"column is-12"},xt=P(n({__name:"ProjectDetail",setup(e){const a=oe(),l=q(),t=H(),i=$(),n=N(),r=re(),d=o("detail"),k=o(!1),_=o(!1);o(!1);const T=o(!1);o(!1);const D=o(!1),V=o([]),O=o([]),U=o([]),P=o([]),E=o([]);o(0);const W=o(0),L=o(0),R=o(""),X=o("");o("");const ee=o([{id:0,username:"",email:"",phoneNumber:""}]),ae=o([]),le=o({id:0,title:"",created:"",startDate:"",color:"",endDate:"",description:"",image:"",is_active:null,status:"",address:"",total_tasks:0,client:0,contractor:0,clientInfo:{id:0,username:"",email:"",password:"",avatar:null},uploaded_files:[],contractorInfo:{id:0,username:"",email:"",password:"",avatar:null},managers:[{id:0,username:"",avatar:null,email:"",role:""}]});o({title:"",description:"",startDate:"",endDate:"",status:"",project:i.params.id,workers:[]});const te=o([{id:0,title:"",description:"",startDate:"",endDate:"",project:0,status:"",worker:[{id:0,username:"",email:"",role:"",avatar:""}]}]),se=M({height:180,type:"radialBar",series:[],title:{text:""},chart:{toolbar:{show:!1}},colors:[a.primary,a.purple,a.orange],plotOptions:{radialBar:{hollow:{size:"55%"}}},labels:["Progress"]}),ce=M({series:[],chart:{height:295,type:"pie",toolbar:{show:!1}},labels:["Active","Pending","Completed","Canceled"],colors:[a.accent,a.info,a.primary,a.orange],legend:{position:"right",horizontalAlign:"center"},responsive:[{breakpoint:480,options:{chart:{width:315,toolbar:{show:!1}},legend:{position:"top"}}}],dataLabels:{enabled:!1}}),de=()=>{T.value=!T.value},ue=()=>{_.value=!_.value},pe=o(!1),ve=()=>{pe.value=!pe.value},me=()=>{try{D.value=!0;l.delete(`/api/project/${i.params.id}/`);t.green("Selected project deleted successfully!"),n.push("/sidebar/dashboard/projects")}catch(e){console.log(e)}finally{D.value=!1}};o(0);const he=async()=>{try{k.value=!0;const e=await l.get(`/api/project/${X.value}/`);le.value=e.data;let a=e.data.percentage.toFixed(2);se.value.series.push(a),R.value=e.data.image,U.value=e.data.managers?e.data.managers:[],ge()}catch(e){console.log(e)}finally{k.value=!1}};o([]);const ge=async()=>{try{k.value=!0;const e=await l.get(`api/task/${i.params.id}/project/`);te.value=e.data;const a={pending:0,completed:0,active:0,canceled:0};te.value.forEach((e=>{const l=e.status||"Unknown";void 0!==a[l]&&a[l]++})),ce.value.series=[a.completed,a.pending,a.active,a.canceled],k.value=!1}catch(e){console.log(e),k.value=!1}},fe=o([]),ke=async()=>{try{le.value.managers=fe.value;let e=K(le.value,["image"]);e.delete("clientInfo"),e.delete("contractorInfo"),"object"==typeof le.value.client&&e.delete("client"),"object"==typeof le.value.contractor&&e.delete("contractor");const a=await l.patch(`/api/project/${i.params.id}/`,e);_.value=!1,T.value=!1,t.green("Project updated successfully"),pe.value=!1,he(a.data.id)}catch(e){console.log(e)}};o("");const _e=e=>{W.value=e},ye=e=>{L.value=e};return c((async()=>{X.value=i.params.id,he(),(async()=>{try{D.value=!0;const e=await l.get("/api/users/",{});ee.value=e.data.filter((e=>"worker"==e.role)),V.value=e.data.filter((e=>"client"==e.role)),O.value=e.data.filter((e=>"contractor"==e.role)),P.value=e.data.filter((e=>"manager"==e.role)),E.value=P.value.map((e=>({value:e.id.toString(),name:`${e.username}`,supplier:e.partner?e.partner:"",image:e.avatar}))),console.log("data",ee.value)}catch(e){console.log(e)}finally{D.value=!1}})(),await ge(),(async()=>{try{const e=await l.get(`/api/task/today-tasks/?project=${i.params.id}`);ae.value=e.data}catch(e){console.log(e)}})()})),(e,a)=>{const l=ie,t=s,o=z("Address"),c=rl,D=Q,P=z("Tippy"),$=z("Multiselect"),N=F,M=Z,W=Y,L=G,R=J,K=B,H=Ka;return u(),p("div",dl,[h("div",ul,[h("div",pl,[h("div",vl,["admin"==v(r).user.role||"manager"==v(r).user.role?(u(),m(l,{key:0,style:{position:"absolute",top:"10px","font-size":"18px","font-weight":"600",right:"36px",color:"var(--info)"},class:"cu-pointer",onClick:a[0]||(a[0]=()=>{v(n).push(`/sidebar/dashboard/projects/add-project/?id=${v(le).id}`)}),icon:"lucide:edit"})):A("",!0),"admin"==v(r).user.role||"manager"==v(r).user.role?(u(),m(l,{key:1,style:{position:"absolute",top:"10px","font-size":"18px","font-weight":"600",right:"10px",color:"var(--danger)"},class:"cu-pointer",onClick:me,icon:"lucide:trash"})):A("",!0),g(t,{picture:v(le).image,squared:"",color:"primary",badge:"/images/icons/flags/united-states-of-america.svg",size:"xxl"},null,8,["picture"]),h("div",ml,[h("h3",hl,C(v(le).title?v(le).title:"N/A"),1),h("p",gl,[b(" Current status: "),h("span",fl,C("pending"===v(le).status?"Pre Construction":v(le).status.charAt(0).toUpperCase()+v(le).status.slice(1)),1)]),g(o,null,{default:f((()=>[kl,b(" "+C(v(le).address),1)])),_:1})]),h("div",_l,[yl,h("p",bl," Started at: "+C(v(le)?.startDate?v(le)?.startDate:"N/A"),1),h("p",wl," Expected end: "+C(v(le)?.endDate?v(le)?.endDate:"N/A"),1),h("p",jl," Total jobs: "+C(v(le).total_tasks?v(le).total_tasks:"N/A")+" Tasks ",1)]),h("div",null,[h("div",Cl,[v(k)?A("",!0):(u(),m(v(ne),{key:0,id:"completion-chart",height:v(se).height,type:v(se).type,series:v(se).series,options:v(se)},null,8,["height","type","series","options"]))]),xl])])])]),"admin"==v(r).user.role||"manager"==v(r).user.role?(u(),p("div",Sl,[h("div",Al,[h("ul",null,[h("li",{class:w(["detail"===v(d)&&"is-active"])},[h("a",{tabindex:"0",role:"button",onKeydown:a[1]||(a[1]=j(I((e=>d.value="detail"),["prevent"]),["space"])),onClick:a[2]||(a[2]=e=>d.value="detail")},Tl,32)],2),h("li",{class:w(["tasks"===v(d)&&"is-active"])},[h("a",{tabindex:"0",role:"button",onKeydown:a[3]||(a[3]=j(I((e=>d.value="tasks"),["prevent"]),["space"])),onClick:a[4]||(a[4]=e=>d.value="tasks")},Dl,32)],2),Il])])])):A("",!0),"detail"===v(d)?(u(),p("div",Vl,["admin"==v(r).user.role||"manager"==v(r).user.role?(u(),p("div",Ol,[h("div",Ul,[h("div",{innerHTML:v(le).description},null,8,Pl)]),h("div",El,[g(c,{projectId:v(i).params.id,files:v(le).uploaded_files,"onUpdate:onUploadFile":he},null,8,["projectId","files"])]),h("div",$l,[Nl,0!=v(te).length?(u(),m(v(ne),{key:0,height:v(ce).chart.height,type:v(ce).chart.type,series:v(ce).series,options:v(ce)},null,8,["height","type","series","options"])):A("",!0)])])):A("",!0),h("div",{class:w("admin"==v(r).user.role||"manager"==v(r).user.role?"column is-4":"column is-12")},[h("div",Ml,[h("div",zl,[Fl,"admin"==v(r).user.role||"manager"==v(r).user.role?(u(),p("a",{key:0,onClick:ve,class:"action-link",tabindex:"0"},C(v(pe)?"Close":"Edit"),1)):A("",!0)]),h("div",Wl,[v(U).length>0?(u(),p("ul",Ll,[(u(!0),p(x,null,S(v(U),(e=>(u(),p("li",{key:e.id},[h("div",null,[g(P,{class:"has-help-cursor",interactive:"",offset:[0,10]},{content:f((()=>[g(D,{user:e},null,8,["user"])])),default:f((()=>[g(t,{picture:e.avatar},null,8,["picture"])])),_:2},1024)]),h("div",Rl,[h("div",Kl,C(e.username),1),h("div",Hl,C(e.email),1)]),ql])))),128))])):(u(),p("ul",Bl,Gl)),v(pe)?(u(),p("div",Jl,[g(M,null,{default:f((({id:e})=>[g(N,null,{default:f((()=>[g($,{modelValue:v(fe),"onUpdate:modelValue":a[5]||(a[5]=e=>y(fe)?fe.value=e:null),attrs:{id:e},mode:"tags",placeholder:"Select manager","track-by":"name",label:"name",searchable:!0,"create-tag":!0,options:v(E),"max-height":145},null,8,["modelValue","attrs","options"])])),_:2},1024)])),_:1})])):A("",!0),h("div",Yl,[v(pe)?(u(),p("a",Zl)):A("",!0),v(pe)?(u(),p("a",{key:1,onClick:ke,class:"action-link",tabindex:"0"},"Save ")):A("",!0)])])]),h("div",Ql,[h("div",Xl,[et,"admin"==v(r).user.role||"manager"==v(r).user.role?(u(),p("a",{key:0,onClick:ue,class:"action-link",tabindex:"0"},C(v(_)?"Close":"Edit"),1)):A("",!0)]),h("div",at,[v(le).client?(u(),p("ul",lt,[h("li",null,[h("div",null,[g(P,{class:"has-help-cursor",interactive:"",offset:[0,10]},{content:f((()=>[g(D,{user:v(le).client},null,8,["user"])])),default:f((()=>[g(t,{picture:v(le).client.avatar},null,8,["picture"])])),_:1})]),h("div",tt,[h("div",st,C(v(le).client.username),1),h("div",it,C(v(le).client.email),1)]),nt])])):(u(),p("ul",ot,rt)),v(_)?(u(),p("div",ct,[g(M,null,{default:f((()=>[g(W,null,{default:f((()=>[b("Select client")])),_:1}),g(N,null,{default:f((()=>[g(R,{modelValue:v(le).client,"onUpdate:modelValue":a[6]||(a[6]=e=>v(le).client=e),onChange:ke},{default:f((()=>[g(L,{value:""},{default:f((()=>[b(" Clients ")])),_:1}),(u(!0),p(x,null,S(v(V),(e=>(u(),m(L,{key:e.id,value:e.id},{default:f((()=>[b(C(e.username),1)])),_:2},1032,["value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1})])):A("",!0)])]),h("div",dt,[h("div",ut,[pt,"admin"==v(r).user.role||"manager"==v(r).user.role?(u(),p("a",{key:0,onClick:de,class:"action-link",tabindex:"0"},C(v(T)?"Close":"Edit"),1)):A("",!0)]),h("div",vt,[v(le).contractor?(u(),p("ul",mt,[h("li",null,[h("div",null,[g(P,{class:"has-help-cursor",interactive:"",offset:[0,10]},{content:f((()=>[g(D,{user:v(le).contractor},null,8,["user"])])),default:f((()=>[g(t,{picture:v(le).contractor.avatar},null,8,["picture"])])),_:1})]),h("div",ht,[h("div",gt,C(v(le).contractor.username),1),h("div",ft,C(v(le).contractor.email),1)]),kt])])):(u(),p("ul",_t,yt)),v(T)?(u(),p("div",bt,[g(M,null,{default:f((()=>[g(W,null,{default:f((()=>[b("Select contractor")])),_:1}),g(N,null,{default:f((()=>[g(R,{modelValue:v(le).contractor,"onUpdate:modelValue":a[7]||(a[7]=e=>v(le).contractor=e),onChange:ke},{default:f((()=>[(u(!0),p(x,null,S(v(O),(e=>(u(),m(L,{key:e.id,value:e.id},{default:f((()=>[b(C(e.username),1)])),_:2},1032,["value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1})])):A("",!0)])]),h("div",wt,[g(K,{projectId:v(i).params.id},null,8,["projectId"])])],2)])):A("",!0),"tasks"===v(d)?(u(),p("div",jt,[h("div",Ct,[g(H,{"onUpdate:completedTasks":_e,"onUpdate:activeTasks":ye,projectID:v(i).params.id},null,8,["projectID"])])])):A("",!0)])}}}),[["__scopeId","data-v-5dd66bc1"]]);export{xt as _};
