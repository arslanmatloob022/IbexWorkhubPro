import{_ as e,a,b as l}from"./ProposalViewModal.vue_vue_type_style_index_0_lang-66eaf9bd.js";import{_ as t}from"./SweetAlert.vue_vue_type_style_index_0_lang-e64078f6.js";import{b as s,c as o}from"./CreateProposalTasksModal-3cc417c1.js";import{_ as i}from"./VFlexPagination.vue_vue_type_script_setup_true_lang-b9914b1c.js";import{_ as n}from"./VPlaceholderPage.vue_vue_type_style_index_0_lang-b4539a0d.js";import{_ as r,c as d}from"./VFlexTable.vue_vue_type_style_index_0_lang-61f6ee49.js";import{_ as p}from"./VDropdown.vue_vue_type_style_index_0_lang-d0dd0ddd.js";import{_ as u}from"./VTag.vue_vue_type_style_index_0_lang-5d3e771a.js";import{e as c,v as m,x as v,r as _,Z as y,o as f,au as k,B as h,C as b,l as g,E as w,D as C,F as x,K as P,W as A,j as S,J as I,N as O,M as j,U as M,V as T,aR as $,O as U,T as V}from"./index-33506c71.js";import{_ as L}from"./VControl-07dce6f5.js";import{_ as D}from"./PlaceloadV1.vue_vue_type_style_index_0_lang-d253910d.js";import{_ as E,a as H}from"./search-4-dark-2b5b440c.js";import{u as F}from"./useAPI-fb206f43.js";import{u as N}from"./useNotyf-63ef8eb2.js";import{f as z}from"./useSupportElement-cb28081e.js";import{b as B,c as J,d as R,e as Y}from"./estimatesScripts-cd987e22.js";const K={key:0},W={key:1},Z={class:"flex-toolbar is-reversed is-flex space-between my-4"},q={class:"flex-list-wrapper flex-list-v2"},G={class:"item-name dark-inverted show-text-250"},Q={class:"item-meta"},X=C("i",{"aria-hidden":"true",class:"iconify","data-icon":"feather:clock"},null,-1),ee={class:"item-name dark-inverted"},ae={class:"light-text"},le=["onClick"],te=[C("div",{class:"icon"},[C("i",{"aria-hidden":"true",class:"lnil lnil-pencil"})],-1),C("div",{class:"meta"},[C("span",null,"Edit"),C("span",null,"Edit Proposal Details")],-1)],se=["onClick"],oe=[C("div",{class:"icon"},[C("i",{"aria-hidden":"true",class:"lnil lnil-eye"})],-1),C("div",{class:"meta"},[C("span",null,"Preview"),C("span",null,"Preview proposal detail")],-1)],ie=["onClick"],ne=[C("div",{class:"icon"},[C("i",{class:"lnil lnil-calender-alt-1","aria-hidden":"true"})],-1),C("div",{class:"meta"},[C("span",null,"Create Tasks"),C("span",null,"Create tasks in chart ")],-1)],re=C("hr",{class:"dropdown-divider"},null,-1),de=["onClick"],pe=[C("div",{class:"icon"},[C("i",{class:"lnir lnir-round-box-check","aria-hidden":"true"})],-1),C("div",{class:"meta"},[C("span",null,"Mark Approved"),C("span",null,"Mark Proposal As Approved")],-1)],ue=["onClick"],ce=[C("div",{class:"icon"},[C("i",{"aria-hidden":"true",class:"lnil lnil-trash-can-alt"})],-1),C("div",{class:"meta"},[C("span",null,"Delete"),C("span",null,"Delete from list")],-1)],me=C("img",{class:"light-image",src:E,alt:""},null,-1),ve=C("img",{class:"dark-image",src:H,alt:""},null,-1),_e=c({__name:"LeadProposalsList",props:{activeTab:{default:"active"},leadId:{default:""},allProposal:{type:Boolean,default:!1}},emits:["updateCompany"],setup(c,{emit:E}){const H=c,_e=m();v();const ye=F(),fe=N(),ke=_(!1),he=_([]),be=_(!1),ge=_(""),we=_(!1),Ce=_(!1),xe=_(""),Pe=_("");_(H.activeTab);const Ae=_({title:"",subtitle:"test",isSweetAlertOpen:!1,btntext:"text"}),Se=_({title:"",subtitle:"",isSweetAlertOpen:!1,btntext:""}),Ie=async()=>{try{ke.value=!0;await ye.delete(`/api/lead-proposal/${Pe.value}/`);fe.success("Proposal delete successfully"),Le()}catch(e){fe.error(` ${e}, Proposal`),fe.error("Something went wrong please try later")}finally{ke.value=!1,Ae.value.isSweetAlertOpen=!1}},Oe={picture:{label:"Proposal",grow:!0,media:!0},industry:"Type",status:"Status",amount:{label:"Total Amount",media:!0},customer:"Calendar Tasks ",actions:{label:"Actions",align:"end"}},je=y((()=>{if(xe.value){const e=new RegExp(xe.value,"i");return he.value.filter((a=>a.title.match(e)||a.approval_deadline.match(e)))}return he.value})),Me=_(!1),Te=_(!1),$e=_(!1),Ue=_(""),Ve=e=>{_e.push(`/sidebar/dashboard/proposals/${e}`)},Le=()=>{1==H.allProposal?(async()=>{try{ke.value=!0;const e=await ye.get("/api/lead-proposal/");he.value=e.data}catch(e){fe.error(` ${e}, Lead`)}finally{ke.value=!1}})():H.leadId&&(async()=>{try{ke.value=!0;const e=await ye.get(`/api/lead-proposal/by-project/${H.leadId}/`);he.value=e.data}catch(e){fe.error(` ${e}, Lead`)}finally{ke.value=!1}})()};return f((()=>{Le()})),(c,m)=>{const v=D,_=L,y=U,f=d,F=u,N=p,_e=r,De=n,Ee=i,He=s,Fe=e,Ne=a,ze=o,Be=t,Je=l,Re=k("tooltip");return h(),b("div",null,[g(ke)?(h(),b("div",K,[w(v)])):(h(),b("div",W,[C("div",Z,[w(_,{icon:"feather:search"},{default:x((()=>[P(C("input",{"onUpdate:modelValue":m[0]||(m[0]=e=>S(xe)?xe.value=e:null),class:"input custom-text-filter",placeholder:"Search..."},null,512),[[A,g(xe)]])])),_:1}),C("div",null,[w(y,{color:"primary",onClick:m[1]||(m[1]=e=>be.value=!g(be)),icon:"fas fa-plus"},{default:x((()=>[I("Lead Proposal ")])),_:1}),H.leadId?(h(),O(y,{key:0,color:"warning",class:"ml-2",onClick:m[2]||(m[2]=e=>{Ce.value=!0}),icon:"fas fa-cogs"},{default:x((()=>[I("Proposals")])),_:1})):j("",!0)])]),C("div",q,[g(je).length>0&&g(he).length>0?(h(),O(_e,{key:0,data:g(je),columns:Oe,rounded:""},{body:x((()=>[w($,{name:"list",tag:"div",class:"flex-list-inner"},{default:x((()=>[(h(!0),b(M,null,T(g(je),(e=>(h(),b("div",{key:e.id,class:"flex-table-item"},[w(f,{column:{media:!0,grow:!0},class:"cu-pointer",onClick:a=>Ve(e.id)},{default:x((()=>[P((h(),b("div",null,[C("span",G,V(e.title),1),C("span",Q,[C("span",null,[X,I(V(g(z)(e.created_at)),1)])])])),[[Re,`${e.title}`,void 0,{rounded:!0,light:!0}]])])),_:2},1032,["onClick"]),w(f,{class:"cu-pointer",onClick:a=>Ve(e.id)},{default:x((()=>[w(F,{rounded:"",color:g(B)[e.type]},{default:x((()=>[I(V(g(J)[e.type]),1)])),_:2},1032,["color"])])),_:2},1032,["onClick"]),w(f,{class:"cu-pointer",onClick:a=>Ve(e.id)},{default:x((()=>[w(F,{class:"capitalized",rounded:"",color:g(R)[e.status]},{default:x((()=>[I(V(g(Y)[e.status]),1)])),_:2},1032,["color"])])),_:2},1032,["onClick"]),w(f,{class:"cu-pointer",onClick:a=>Ve(e.id),column:{media:!0}},{default:x((()=>[C("div",null,[C("span",ee,"$"+V(e.proposalAmount),1),C("span",ae,V(e.payment_status),1)])])),_:2},1032,["onClick"]),w(f,{class:"cu-pointer",onClick:a=>Ve(e.id)},{default:x((()=>[w(F,{color:"purple",outlined:""},{default:x((()=>[I(V(e.is_task_created?"Created":"Not Created"),1)])),_:2},1024)])),_:2},1032,["onClick"]),w(f,{column:{align:"end"}},{default:x((()=>[w(N,{class:"is-pushed-mobile",icon:"feather:more-vertical",spaced:"",right:""},{content:x((()=>[C("a",{role:"menuitem",onClick:a=>{return l=e.id,ge.value=l,void(be.value=!0);var l},class:"dropdown-item is-media"},te,8,le),C("a",{disabled:"",role:"menuitem",onClick:a=>{return l=e.id,Te.value=l,void(Me.value=!Me.value);var l},class:"dropdown-item is-media"},oe,8,se),"approved"==e.status?(h(),b("a",{key:0,role:"menuitem",onClick:a=>{return l=e.id,ge.value=l,void(we.value=!0);var l},class:"dropdown-item is-media"},ne,8,ie)):j("",!0),re,"approved"!=e.status?(h(),b("a",{key:1,role:"menuitem",onClick:a=>(async(e,a)=>{try{await ye.patch(`/api/lead-proposal/${a}/`,{status:e}),fe.success(`You have ${e} this proposal.`),"approved"==e&&E("updateCompany",null),Le()}catch(l){console.log(l)}})("approved",e.id),class:"dropdown-item is-media"},pe,8,de)):j("",!0),C("a",{role:"menuitem",onClick:a=>{return l=e.id,Pe.value=l,void(Ae.value={title:"Delete Proposal?",subtitle:"Are you sure to delete this proposal? After delete you will not be able to recover it again.",btntext:"Yes delete",isSweetAlertOpen:!0});var l},class:"dropdown-item is-media"},ce,8,ue)])),_:2},1024)])),_:2},1024)])))),128))])),_:1})])),_:1},8,["data"])):j("",!0),g(he).length<1&&0==g(je).length?(h(),O(De,{key:1,title:"There is no proposal created on this lead!",subtitle:"Too bad. Looks like we couldn't created any proposal on this Lead, please create proposal and release to the client",larger:""},{image:x((()=>[me,ve])),_:1})):j("",!0),g(je).length>5?(h(),O(Ee,{key:2,"item-per-page":10,"total-items":873,"current-page":42,"max-links-displayed":7})):j("",!0)]),g(we)?(h(),O(He,{key:0,createProposalTasksModal:g(we),proposalId:g(ge),onCloseModalHandler:m[3]||(m[3]=e=>we.value=!1),"onUpdate:OnSuccess":Le},null,8,["createProposalTasksModal","proposalId"])):j("",!0),g(be)?(h(),O(Fe,{key:1,leadId:H.leadId,proposalId:g(ge),leadProposalModal:g(be),"onUpdate:modalHandler":m[4]||(m[4]=e=>be.value=!1),"onUpdate:OnSuccess":Le,onClearProposalId:m[5]||(m[5]=e=>ge.value="")},null,8,["leadId","proposalId","leadProposalModal"])):j("",!0),g(Me)?(h(),O(Ne,{key:2,"preview-modal":g(Me),proposalId:g(Te),"onUpdate:modalHandler":m[6]||(m[6]=e=>Me.value=!1)},null,8,["preview-modal","proposalId"])):j("",!0),g($e)?(h(),O(ze,{key:3,costItemModal:g($e),proposalId:g(Ue),"onUpdate:modalHandler":m[7]||(m[7]=e=>$e.value=!1),"onUpdate:OnSuccess":Le},null,8,["costItemModal","proposalId"])):j("",!0),g(Ae).isSweetAlertOpen?(h(),O(Be,{key:4,isSweetAlertOpen:g(Ae).isSweetAlertOpen,title:g(Ae).title,subtitle:g(Ae).subtitle,btntext:g(Ae).btntext,onConfirm:Ie,onCancel:()=>g(Ae).isSweetAlertOpen=!1},null,8,["isSweetAlertOpen","title","subtitle","btntext","onCancel"])):j("",!0),g(Se).isSweetAlertOpen?(h(),O(Be,{key:5,isSweetAlertOpen:g(Se).isSweetAlertOpen,title:g(Se).title,subtitle:g(Se).subtitle,btntext:g(Se).btntext,onConfirm:Ie,onCancel:()=>g(Se).isSweetAlertOpen=!1},null,8,["isSweetAlertOpen","title","subtitle","btntext","onCancel"])):j("",!0),g(Ce)?(h(),O(Je,{key:6,leadProposalListModal:g(Ce),leadID:H.leadId,"group-proposal-modal":g(Ce),"onUpdate:modalHandler":m[8]||(m[8]=e=>Ce.value=!1)},null,8,["leadProposalListModal","leadID","group-proposal-modal"])):j("",!0)]))])}}});export{_e as _};
