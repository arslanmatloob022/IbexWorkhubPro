import{e,r as a,o as l,M as t,y as s,z as n,C as o,K as i,A as u,B as r,l as c,J as d,D as p,Q as m,R as _,j as v,P as f,E as y,v as b,H as h,ak as g}from"./index-77242730.js";import{_ as k}from"./VInput.vue_vue_type_script_setup_true_lang-66b33f9b.js";import{_ as V,a as x}from"./VOption.vue_vue_type_style_index_0_lang-12a52e16.js";import{_ as j}from"./VLabel.vue_vue_type_script_setup_true_lang-acbcb236.js";import{_ as C}from"./VField.vue_vue_type_script_setup_true_lang-e2d6e1aa.js";import{_ as w}from"./VControl-79521a51.js";import{_ as A}from"./VAvatar.vue_vue_type_style_index_0_lang-35ef34aa.js";import{u as P}from"./useAPI-e8734e40.js";import{u as S}from"./useNotyf-4be88095.js";import{a as q}from"./useSupportElement-91c8ba2a.js";import{u as I}from"./viewWrapper-44b4c78c.js";import{b as U}from"./route-block-83d24a4e.js";import"./useVFieldContext-15b49a74.js";import"./userSession-d0056014.js";import"./notyf-f1fbebc2.js";import"./useThemeColors-a9ec37bd.js";const z={class:"banking-dashboard banking-dashboard-v1"},F={class:"columns is-multiline"},T={class:"column is-12"},L={class:"columns is-multiline"},N={class:"column is-6"},O={class:"dashboard-card is-contacts"},B=o("div",{class:"title-wrap"},[o("h3",{class:"dark-inverted"},"Create link")],-1),M=["onSubmit"],Q={class:"transfer-form"},$=o("label",{for:""}," Client",-1),E={class:"multiselect-single-label"},J={class:"select-label-text"},R={class:"select-label-text"},D=["onSubmit"],H={class:"column is-12"},K={class:"mb-2"},W={class:"is-bold"},G=o("br",null,null,-1),X=["onClick"],Y={class:"submit-wrap mt-5"},Z={class:"column is-6"},ee={class:"dashboard-card"},ae=o("div",{class:"title-wrap"},[o("h3",{class:"dark-inverted"},"Payment links")],-1),le={key:0,class:"context-text"},te=e({__name:"IbexPaymentModule",setup(e){const b=P(),h=S();a(!1);const g=a(""),I=a([]),U=a(!1);a(!1);const te=a(!1),se=a({payment_method:"us_bank_account",description:"",client:""}),ne=a({title:"",amount:0,quantity:1}),oe=a([]),ie=()=>{oe.value.push(ne.value),ne.value={title:"",amount:0,quantity:1}},ue=async()=>{try{te.value=!0;const e=q(se.value,[""]);e.append("itemsList",JSON.stringify(oe.value)),e.append("enableTax","False");const a=await b.post("/api/paypal/stripe-session-new/",e);g.value=a.data.url,h.success("link Created")}catch(e){h.error("Something went wrong")}finally{te.value=!1}};return l((()=>{(async()=>{try{U.value=!0;const e=await b.get("/api/users/by-role/client/",{});I.value=e.data.map((e=>({value:e.id,name:e.username,icon:e.avatar})))}catch(e){console.log(e)}finally{U.value=!1}})()})),(e,a)=>{const l=A,b=t("Multiselect"),P=w,S=C,q=j,U=V,re=x,ce=k,de=y;return s(),n("div",z,[o("div",F,[o("div",T,[o("div",L,[o("div",N,[o("div",O,[B,o("form",{action:"",onSubmit:i(ue,["prevent"])},[o("div",Q,[u(S,{class:"is-image-select has-curved-images"},{default:r((()=>[$,u(P,null,{default:r((()=>[u(b,{modelValue:c(se).client,"onUpdate:modelValue":a[0]||(a[0]=e=>c(se).client=e),placeholder:"Select a client",label:"name","max-height":145,options:c(I)},{singlelabel:r((({value:e})=>[o("div",E,[u(l,{class:"select-option-icon",size:"xs",squared:"",picture:e.icon},null,8,["picture"]),o("span",J,d(e.name),1)])])),option:r((({option:e})=>[u(l,{class:"select-option-icon",size:"xs",squared:"",picture:e.icon},null,8,["picture"]),o("span",R,d(e.name),1)])),_:1},8,["modelValue","options"])])),_:1})])),_:1}),u(S,{class:"field column is-12 p-0"},{default:r((()=>[u(q,{for:""},{default:r((()=>[p("Pay by")])),_:1}),u(re,{modelValue:c(se).payment_method,"onUpdate:modelValue":a[1]||(a[1]=e=>c(se).payment_method=e)},{default:r((()=>[u(U,{value:"us_bank_account"},{default:r((()=>[p("US Bank Account")])),_:1}),u(U,{value:"card"},{default:r((()=>[p("Credit Card")])),_:1}),u(U,{value:"both"},{default:r((()=>[p("Any")])),_:1})])),_:1},8,["modelValue"])])),_:1}),o("form",{action:"post",onSubmit:i(ie,["prevent"])},[u(S,null,{default:r((()=>[u(q,null,{default:r((()=>[p("Title")])),_:1}),u(P,null,{default:r((()=>[u(ce,{required:"",modelValue:c(ne).title,"onUpdate:modelValue":a[2]||(a[2]=e=>c(ne).title=e),type:"text",placeholder:"Item title"},null,8,["modelValue"])])),_:1})])),_:1}),u(S,{class:"field column is-12 p-0"},{default:r((()=>[u(q,null,{default:r((()=>[p("Amount in ($)")])),_:1}),u(P,null,{default:r((()=>[u(ce,{required:"",modelValue:c(ne).amount,"onUpdate:modelValue":a[3]||(a[3]=e=>c(ne).amount=e),type:"number",step:"0",placeholder:"Amount in $"},null,8,["modelValue"])])),_:1})])),_:1}),u(de,{type:"submit",color:"info",size:"big",fullwidth:"",loading:c(te),raised:"",bold:""},{default:r((()=>[p(" Add Item ")])),_:1},8,["loading"])],40,D),o("div",H,[(s(!0),n(m,null,_(c(oe),((e,a)=>(s(),n("div",K,[o("p",W,[o("span",null,d(a+1)+". ",1),o("span",null,d(e.title),1)]),o("p",null,[o("span",null,"Amount: $"+d(e.amount),1),G,o("span",null,"Quantity: "+d(e.quantity?e.quantity:""),1)]),o("p",{onClick:e=>(e=>{se.value.itemsList.splice(e,1)})(a)},"Remove",8,X)])))),256))]),o("div",Y,[u(de,{type:"submit",color:"primary",size:"big",fullwidth:"",loading:c(te),raised:"",bold:""},{default:r((()=>[p(" Create Payment link ")])),_:1},8,["loading"])])])],40,M)])]),o("div",Z,[o("div",ee,[ae,u(S,{label:"Checkout link",addons:""},{default:r((()=>[u(P,{expanded:""},{default:r((()=>[u(ce,{type:"text",modelValue:c(g),"onUpdate:modelValue":a[4]||(a[4]=e=>v(g)?g.value=e:null),class:"input",placeholder:"link..."},null,8,["modelValue"])])),_:1}),u(P,null,{default:r((()=>[u(de,{icon:"fas fa-copy",onClick:a[5]||(a[5]=e=>{var a;(a=c(g))?navigator.clipboard.writeText(a).then((()=>{h.success("Link copied to clipboard!")})).catch((e=>{h.error("Failed to copy the link: ",e)})):h.error("No link to copy!")}),class:"cu-pointer",color:"primary"},{default:r((()=>[p(" Copy ")])),_:1})])),_:1})])),_:1}),c(g)?(s(),n("p",le," payment link has been successfully created ")):f("",!0)])])])])])])}}}),se={class:"page-content-inner"},ne=o("div",{class:"lifestyle-dashboard-bg has-top-nav"},null,-1),oe=e({__name:"index",setup:e=>(I().setPageTitle("Ibex Payment"),b({title:"Ibex Payment"}),(e,a)=>{const l=te;return s(),n("div",se,[(s(),h(g,{to:"[data-teleport-bg]"},[ne])),u(l,{class:"has-navbar-spacing"})])})});"function"==typeof U&&U(oe);export{oe as default};
