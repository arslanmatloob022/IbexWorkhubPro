import{_ as e}from"./SweetAlert.vue_vue_type_style_index_0_lang-1d88621e.js";import{_ as t}from"./VFlexPagination.vue_vue_type_script_setup_true_lang-1b3efaa2.js";import{_ as a,c as l}from"./VFlexTable.vue_vue_type_style_index_0_lang-5e72d61b.js";import{_ as s}from"./VIconWrap.vue_vue_type_style_index_0_lang-d13d2b8c.js";import{_ as i}from"./VAvatar.vue_vue_type_style_index_0_lang-ca35c0b4.js";import{_ as n}from"./VTag.vue_vue_type_style_index_0_lang-b5273870.js";import{_ as r}from"./VPlaceholderPage.vue_vue_type_style_index_0_lang-60676b0d.js";import{_ as o}from"./VControl-3e240123.js";import{_ as u}from"./PlaceloadV1.vue_vue_type_style_index_0_lang-fcfb9eec.js";import{e as c,x as d,r as p,v as _,Z as m,o as v,l as y,B as f,N as g,C as b,D as x,E as h,F as k,K as j,W as w,j as V,M as P,U as A,V as C,aR as S,T as O,H as T,J as F,P as N,Q as q,R as z,S as I,z as L}from"./index-083aead2.js";import{_ as W,a as E}from"./search-4-dark-2b5b440c.js";import{u as U}from"./useAPI-4bc9c287.js";import{f as Y}from"./useSupportElement-83d1f44a.js";import{u as $}from"./useNotyf-82024493.js";import{u as D}from"./viewWrapper-324fa8be.js";import{b as M}from"./route-block-83d24a4e.js";import"./VFlex.vue_vue_type_style_index_0_lang-9ac36ab2.js";import"./via-placeholder-24645670.js";import"./VLabel.vue_vue_type_script_setup_true_lang-b9c53ff4.js";import"./useVFieldContext-0c090f92.js";import"./VPlaceloadWrap-9fdf14b1.js";import"./VPlaceloadText.vue_vue_type_style_index_0_lang-08758cca.js";import"./VPlaceloadAvatar.vue_vue_type_style_index_0_lang-f4d4ea8f.js";import"./VField.vue_vue_type_script_setup_true_lang-a9286499.js";import"./userSession-0864928d.js";import"./notyf-bd6af76a.js";import"./useThemeColors-91d0c2e7.js";const R=e=>(N("data-v-139cd9f4"),e=e(),q(),e),J={key:1,class:"is-relative tabs-wrapper is-slider is-squared"},B={class:"page-content-inner"},H={class:"list-flex-toolbar is-reversed"},K={class:"flex-list-v2"},Q=R((()=>x("img",{class:"light-image",src:W,alt:""},null,-1))),Z=R((()=>x("img",{class:"dark-image",src:E,alt:""},null,-1))),G={key:1,class:"tab-content is-active"},X={class:"light-text text-overflow"},ee=["onClick"],te=["onClick"],ae=R((()=>x("i",{style:{color:"var(--info)"},class:"fas fa-copy cu-pointer","aria-hidden":"true"},null,-1))),le={class:"item-name dark-inverted"},se={class:"item-meta"},ie={class:"light-text mt-2"},ne={class:"",style:{"font-size":"18px"}},re={class:"item-name dark-inverted"},oe={class:"item-meta"},ue=z(c({__name:"IbexPaymentsList",setup(c){const N=d(),q=p(""),z=p(!1),I=$(),L=U();_();const W=p(""),E=p("paid"),D=p(10),M=p(6),R=p(!1),ue=p([{id:"",client_info:{id:"",username:"",email:"",role:"",avatar:""},description:"",checkoutLink:"",type:"",created_by_info:{id:"",username:"",email:"",role:"",avatar:""},amount:0,status:"",created_at:"",created_by:"",client:null}]),ce={description:{label:"Description",grow:!0,media:!0},picture:{label:"Created by",grow:!0,media:!0},amount:{label:"Amount",align:"center"},client:{label:"Client",align:"center",grow:!0},status:"Status",team:{label:"Method"},actions:{label:"Actions",align:"end"}},de=m((()=>{const e=(_e.value-1)*D.value,t=e+D.value;return pe.value.slice(e,t)})),pe=m((()=>{if(W.value){const e=new RegExp(W.value,"i");return ue.value.filter((t=>t.id.match(e)||t.created_by_info.username.match(e)||t.type.match(e)||t.description.match(e)))}return ue.value})),_e=m((()=>{let e=N.query.page;return e=null==e||"undefined"==e?1:N.query.page,Number.parseInt(N.query.page)||1})),me=async()=>{try{R.value=!0;const e=await L.get("/api/paypal/");ue.value=e.data}catch(e){console.log(e)}finally{R.value=!1}},ve=p({title:"",subtitle:"test",isSweetAlertOpen:!1,btntext:"text"}),ye=async()=>{try{z.value=!0;await L.delete(`/api/paypal/${q.value}/`);ve.value.isSweetAlertOpen=!1,I.success("Payment deleted successfully"),me()}catch(e){console.log(e)}finally{z.value=!1}},fe={created:"info",pending:"warning",canceled:"danger",succeeded:"primary",processing:"success"};return v((()=>{me()})),(c,d)=>{const p=u,_=o,m=r,v=l,N=n,z=i,L=s,U=a,$=t,me=e;return y(R)?(f(),g(p,{key:0})):(f(),b("div",J,[x("div",B,[x("div",H,[h(_,{icon:"feather:search"},{default:k((()=>[j(x("input",{"onUpdate:modelValue":d[0]||(d[0]=e=>V(W)?W.value=e:null),class:"input custom-text-filter",placeholder:"Search..."},null,512),[[w,y(W)]])])),_:1})]),x("div",K,[0===y(pe).length?(f(),g(m,{key:0,title:"We couldn't find any matching results.",subtitle:"Too bad. Looks like we couldn't find any matching results for the\n          search terms you've entered. Please try different search terms or\n          criteria.",larger:""},{image:k((()=>[Q,Z])),_:1})):P("",!0),"paid"===y(E)?(f(),b("div",G,[y(pe).length?(f(),g(U,{key:0,data:y(pe),columns:ce,rounded:""},{body:k((()=>[h(S,{name:"list",tag:"div",class:"flex-list-inner"},{default:k((()=>[(f(!0),b(A,null,C(y(de),(e=>(f(),b("div",{key:e.id,class:"flex-table-item"},[h(v,null,{default:k((()=>[x("div",null,[x("p",X,O(e.description?e.description:"not added"),1),x("p",{class:T(["light-text text-overflow","succeeded"===e.status?"is-link":""]),onClick:t=>(e=>{if("succeeded"===e.status){const t=`https://dashboard.stripe.com/payments/${e.response?.id}`;window.open(t,"_blank")}})(e)}," Payment link ",10,ee),"succeeded"!==e.status?(f(),b("p",{key:0,class:"mt-2",onClick:t=>{var a;(a=e.checkoutLink)?navigator.clipboard.writeText(a).then((()=>{I.success("Link copied to clipboard!")})).catch((e=>{I.error("Failed to copy the link: ",e)})):I.error("No link to copy!")}},[F(" Checkout link "),ae],8,te)):P("",!0)])])),_:2},1024),h(v,{column:{media:!0,grow:!0}},{default:k((()=>[x("div",null,[x("span",le,O(e?.created_by_info?.username),1),x("span",se,[x("span",null,O(e.created_by_info?.email),1)]),x("span",ie,"At: "+O(y(Y)(e.created_at)),1)])])),_:2},1024),h(v,null,{default:k((()=>[x("span",ne,"$"+O(e.amount),1)])),_:2},1024),h(v,null,{default:k((()=>[x("div",null,[x("span",re,O(e?.client_info?.username?e?.client_info?.username:"N/A"),1),x("span",oe,[x("span",null,O(e.client_info?.email),1)])])])),_:2},1024),h(v,null,{default:k((()=>[h(N,{elevated:"",raised:"",rounded:"",style:{"text-transform":"capitalize"},color:fe[e.status]},{default:k((()=>[F(O(e.status),1)])),_:2},1032,["color"])])),_:2},1024),h(v,null,{default:k((()=>["Stripe"==e.type?(f(),g(z,{key:0,picture:"/icons/stripe-48.png",squared:"",size:"medium"})):(f(),g(z,{key:1,picture:"/icons/paypal-48.png",squared:"",size:"medium"}))])),_:2},1024),h(v,{column:{align:"end"}},{default:k((()=>[h(L,{onClick:t=>{return a=e.id,q.value=a,void(ve.value={title:"Are you sure?",subtitle:"You will not be able to recover this Payment again!",btntext:"Yes, Delete it",isSweetAlertOpen:!0});var a},color:"danger",class:"cu-pointer",icon:"lucide:trash"},null,8,["onClick"])])),_:2},1024)])))),128))])),_:1})])),_:1},8,["data"])):P("",!0),y(ue).length>y(D)?(f(),g($,{key:1,"item-per-page":y(D),modelValue:y(_e),"onUpdate:modelValue":d[1]||(d[1]=e=>V(_e)?_e.value=e:null),"total-items":y(ue).length,"current-page":y(_e),"max-links-displayed":y(M)},null,8,["item-per-page","modelValue","total-items","current-page","max-links-displayed"])):P("",!0)])):P("",!0)])]),y(ve).isSweetAlertOpen?(f(),g(me,{key:0,isSweetAlertOpen:y(ve).isSweetAlertOpen,title:y(ve).title,loading:!1,subtitle:y(ve).subtitle,btntext:y(ve).btntext,onConfirm:ye,onCancel:()=>y(ve).isSweetAlertOpen=!1},null,8,["isSweetAlertOpen","title","subtitle","btntext","onCancel"])):P("",!0)]))}}}),[["__scopeId","data-v-139cd9f4"]]),ce={class:"page-content-inner"},de=c({__name:"index",setup(e){I();return D().setPageTitle("Payments"),L((()=>({title:"Payments"}))),(e,t)=>{const a=ue;return f(),b("div",ce,[h(a)])}}});"function"==typeof M&&M(de);export{de as default};
