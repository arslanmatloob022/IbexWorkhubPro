import{e,s as a,r as l,o,A as t,B as s,N as n,F as i,E as r,l as d,j as u,D as c,T as p,J as m,I as v,O as b,Z as f,b as _,_ as g,w as y,K as h,W as w,M as I,C as k,U as C,V as P,a4 as S,a6 as V,a0 as D,X as x,P as T,Q as O,R as j,i as M,aR as U,H as A,G as F}from"./index-1fb32d56.js";import{_ as E}from"./VModal.vue_vue_type_style_index_0_lang-1ed88e8a.js";import{_ as H}from"./VField.vue_vue_type_script_setup_true_lang-b628d9e7.js";import{_ as L}from"./VControl-08451c2f.js";import{u as $}from"./useAPI-33adf908.js";import{u as q}from"./useNotyf-fd26dfc5.js";import{a as N,C as R}from"./useSupportElement-1b217a2b.js";import{u as B}from"./userSession-b9f446e0.js";import{_ as W}from"./VTextarea.vue_vue_type_script_setup_true_lang-f36c2d1f.js";import{_ as z}from"./VInput.vue_vue_type_script_setup_true_lang-ed545180.js";import{_ as J}from"./VCheckbox.vue_vue_type_style_index_0_lang-b7f24622.js";import{_ as G,a as K}from"./VOption.vue_vue_type_style_index_0_lang-7e386811.js";import{s as Y,a as Q,g as X,c as Z}from"./costItems-39796eb0.js";import{_ as ee}from"./VAvatar.vue_vue_type_style_index_0_lang-d2ee1ce9.js";import{_ as ae}from"./VIconButton-c0010819.js";import{_ as le}from"./SweetAlert.vue_vue_type_style_index_0_lang-b953efb6.js";import{_ as oe}from"./VDropdown.vue_vue_type_style_index_0_lang-b699a3cd.js";const te={class:"multiselect-single-label"},se={class:"select-label-text"},ne={class:"select-label-text"},ie=e({__name:"CostByCatalog",props:{centeredActionsOpen:{type:Boolean}},emits:["update:modalHandler","update:OnSuccess"],setup(e,{emit:f}){const _=e;a(),B();const g=q(),y=$(),h=l(!1),w=l(!1),I=l([]),k=l(""),C=l([]),P=()=>{f("update:modalHandler",!1)},S=()=>{f("update:OnSuccess",null)};return o((async()=>{(async()=>{try{w.value=!0;const e=await y.get("/api/cost/catalogs/");C.value=e.data,I.value=e.data.map((e=>({value:e.id,name:e.title})))}catch(e){console.log(e)}finally{w.value=!1}})()})),(e,a)=>{const l=t("Multiselect"),o=L,f=H,w=b,V=E;return s(),n(V,{open:_.centeredActionsOpen,actions:"right",is:"form",title:"Create Cost item",onSubmit:a[1]||(a[1]=v((e=>(async()=>{const e=C.value.find((e=>e.id==k.value));e?console.log("Matched Item:",e):console.log("No item found with the given ID.");const a=N(e,[]);try{await y.post("/api/cost/",a),P(),S(),g.success("Item added successfully.")}catch(l){g.error("Failed try again")}})()),["prevent"])),onClose:a[2]||(a[2]=e=>h.value=!1)},{content:i((()=>[r(f,{class:"is-image-select m-b-80",label:"Selecte Catalog"},{default:i((({id:e})=>[r(o,null,{default:i((()=>[r(l,{modelValue:d(k),"onUpdate:modelValue":a[0]||(a[0]=e=>u(k)?k.value=e:null),attrs:{id:e},placeholder:"Select a catalog",label:"name",options:d(I)},{singlelabel:i((({value:e})=>[c("div",te,[c("span",se,p(e.name),1)])])),option:i((({option:e})=>[c("span",ne,p(e.name),1)])),_:2},1032,["modelValue","attrs","options"])])),_:2},1024)])),_:1})])),action:i((()=>[r(w,{color:"primary",raised:"",type:"submit"},{default:i((()=>[m(" Confirm ")])),_:1})])),cancel:i((()=>[r(w,{color:"primary",raised:"",style:{display:"none"}},{default:i((()=>[m(" Confirm ")])),_:1})])),_:1},8,["open"])}}}),re={onHold:"warning",open:"info",sold:"success",lost:"danger"},de={onHold:"On Hold",open:"Open",sold:"Sold",lost:"Lost"},ue={pending:"info",approved:"success",approve:"success",review:"warning",disapprove:"danger"},ce={pending:"Pending",approved:"Approved",approve:"Approved",review:"Require Review",disapprove:"Disapproved"},pe={proposal:"primary",change_order:"warning",draft:"light"},me={proposal:"Proposal",change_order:"Change Order",draft:"Draft"},ve=[{value:"call",label:"Phone Call"},{value:"email",label:"Email"},{value:"followup",label:"Follow Up"},{value:"visit",label:"Site Visit"},{value:"form",label:"Website Form"}];l([{value:"open",label:"Open"},{value:"inProgress",label:"In Progress"},{value:"onHold",label:"On Hold"},{value:"pending",label:"Pending"},{value:"lost",label:"Lost"},{value:"sold",label:"sold"},{value:"noOpportunity",label:"No Opportunity"}]);const be=[{label:"Square Foot",value:"sq_ft",category:"area"},{label:"Square Meter",value:"sq_m",category:"area"},{label:"Acre",value:"acre",category:"area"},{label:"Hectare",value:"ha",category:"area"},{label:"Square Yard",value:"sq_yd",category:"area"},{label:"Square Inch",value:"sq_in",category:"area"},{label:"Meter",value:"m",category:"length"},{label:"Centimeter",value:"cm",category:"length"},{label:"Millimeter",value:"mm",category:"length"},{label:"Foot",value:"ft",category:"length"},{label:"Inch",value:"in",category:"length"},{label:"Yard",value:"yd",category:"length"},{label:"Cubic Meter",value:"m3",category:"volume"},{label:"Cubic Foot",value:"ft3",category:"volume"},{label:"Cubic Yard",value:"yd3",category:"volume"},{label:"Liter",value:"L",category:"volume"},{label:"Gallon",value:"gal",category:"volume"},{label:"Kilogram",value:"kg",category:"weight"},{label:"Gram",value:"g",category:"weight"},{label:"Pound",value:"lb",category:"weight"},{label:"Ounce",value:"oz",category:"weight"},{label:"Ton",value:"ton",category:"weight"},{label:"Metric Ton",value:"tonne",category:"weight"},{label:"Bag (Cement)",value:"bag",category:"materials"},{label:"Cubic Yard (Concrete)",value:"yd3_concrete",category:"materials"},{label:"Sheet (Drywall)",value:"sheet",category:"materials"},{label:"Board Foot (Lumber)",value:"board_ft",category:"materials"},{label:"Linear Foot",value:"linear_ft",category:"materials"},{label:"Square Foot (Flooring)",value:"sq_ft_flooring",category:"materials"},{label:"Roll (Insulation)",value:"roll",category:"materials"},{label:"Tile (Floor/Wall)",value:"tile",category:"materials"},{label:"Brick",value:"brick",category:"materials"},{label:"Block (Concrete)",value:"block",category:"materials"},{label:"Pallet (Bricks/Blocks)",value:"pallet",category:"materials"},{label:"Hour",value:"hr",category:"time"},{label:"Day",value:"day",category:"time"},{label:"Week",value:"week",category:"time"},{label:"Month",value:"month",category:"time"},{label:"Year",value:"year",category:"time"},{label:"Watt",value:"W",category:"power"},{label:"Kilowatt",value:"kW",category:"power"},{label:"Horsepower",value:"hp",category:"power"},{label:"BTU (Heating/Cooling)",value:"btu",category:"energy"},{label:"Therm (Gas)",value:"therm",category:"energy"},{label:"Pascal",value:"Pa",category:"pressure"},{label:"Kilopascal",value:"kPa",category:"pressure"},{label:"PSI (Pounds per Square Inch)",value:"psi",category:"pressure"},{label:"Degree Celsius",value:"°C",category:"temperature"},{label:"Degree Fahrenheit",value:"°F",category:"temperature"}],fe={class:"modal-form columns is-multiline"},_e={class:"columns is-multiline"},ge={class:"field column is-6 mb-0"},ye=c("label",null,"Title: ",-1),he={class:"control"},we=["disabled"],Ie={class:"multiselect-single-label"},ke={class:"select-label-text"},Ce={class:"select-label-text"},Pe={key:1,class:"field column is-6"},Se=c("label",{for:""},"Cost Type",-1),Ve={key:2,class:"field column is-3"},De=c("label",{for:""},"Catalog",-1),xe={class:"field column is-3"},Te=c("label",{for:""},"Mark As",-1),Oe={class:"field column is-6"},je=c("label",null,"Cost Code *",-1),Me={class:"field column is-6"},Ue=c("label",{for:""},"Group Cost",-1),Ae={class:"field column is-12 mb-0"},Fe=c("label",{for:"",class:"label"},"Description",-1),Ee={class:"field column is-12 mb-0"},He=c("label",{for:"",class:"label"},"Internal Notes",-1),Le={class:"columns is-multiline"},$e={class:"field column is-6"},qe=c("label",null,"Unit Cost",-1),Ne={class:"field column is-6"},Re=c("label",null,"Quantity",-1),Be={class:"field column is-6"},We=c("label",null,"Unit",-1),ze={class:"field column is-6"},Je=c("label",null,"Builder Cost",-1),Ge={class:"field column is-6"},Ke=c("label",null,"Markup (%)",-1),Ye={class:"field column is-6"},Qe=c("label",null,"Total Price",-1),Xe={class:"field column is-6"},Ze=c("label",null,"Margin (%)",-1),ea={class:"field column is-6"},aa=c("label",null,"Worker Cost",-1),la=e({__name:"EstimateCostItemModal",props:{costItemModal:{type:Boolean},proposalId:{},previousItemIndex:{},costItemId:{},previewCostItems:{type:Boolean},costMode:{}},emits:["update:modalHandler","update:OnSuccess"],setup(e,{emit:V}){const D=e,x=a();B();const T=q(),O=$(),j=l(!1),M=l(""),U=l([]),A=l([]),F=l({previousItemIndex:0,index:0,id:"",type:"",total_price:0,cost_code:"",cost_type:"",builder_cost:0,internal_notes:"",mark_as:"",state:"",title:"",description:"",quantity:0,unit:"",unit_cost:0,markup:0,margin:0,profit:0,worker_cost:0,group:"",catalog:!1,proposal:D.proposalId}),Y=l([{value:"labour",label:"Labour"},{value:"material",label:"Material"},{value:"equipment",label:"Equipment"},{value:"subcontractor",label:"Subcontractor"},{value:"other",label:"Others"}]),Q=l([{value:"11011",label:"Labour"},{value:"11012",label:"Material"},{value:"11013",label:"Equipment"},{value:"11014",label:"Subcontractor"},{value:"11015",label:"Others"}]),X=l([{value:"bid",label:"Bid"},{value:"allowance",label:"Allowance"}]),Z=async()=>{try{j.value=!0;const e=N(F.value,[]);if(D.costItemId){await O.patch(`/api/cost/${D.costItemId}/`,e);R({message:"Cost item Update ",action:"UPDATE",performedOnName:"Cost",object_id:D.costItemId})}else{const a=await O.post("/api/cost/",e);if(F.value.catalog){await O.post(`/api/cost/${a.data.id}/create-catalog/`);R({message:"CataLog Create",action:"CREATE",performedOnName:"Cost",object_id:a.data[0]})}R({message:"Cost Item Create",action:"CREATE",performedOnName:"Cost",object_id:a.data[0]})}ee(),ae(),T.success("Item added successfully.")}catch(e){T.error(` ${e}, New Worker`)}finally{j.value=!1}},ee=()=>{V("update:modalHandler",!1)},ae=()=>{V("update:OnSuccess",null)};l(0),l(0);const le=f((()=>F.value.unit_cost*F.value.quantity));l(0),l(0);const oe=f((()=>F.value.markup>0?le.value+le.value*F.value.markup/100:F.value.margin>0?le.value/(1-F.value.margin/100):le.value));f((()=>(oe.value-le.value)/le.value*100)),f((()=>(oe.value-le.value)/oe.value*100));const te=_((()=>g((()=>import("./ckeditor-5c604219.js").then((e=>e.c))),["assets/ckeditor-5c604219.js","assets/index-1fb32d56.js","assets/index-a879fc9d.css","assets/vue.runtime.esm-bundler-94f07bb9.js"]).then((e=>e.default.component)))),se={fontFamily:{options:['"Montserrat", sans-serif','"Roboto", sans-serif']},height:"400px",minHeight:"400px"},ne=l(!1),ie=l([]),re=l(!1);y((()=>F.value.cost_code),((e,a)=>{if(e){const a=ie.value.find((a=>a.id===e));a?(F.value.unit_cost=a.unit_cost,F.value.worker_cost=a.worker_cost):console.warn("No matching item found for cost_code:",e)}})),o((async()=>{x.value=await g((()=>import("./ckeditor-4e82cada.js").then((e=>e.c))),["assets/ckeditor-4e82cada.js","assets/index-1fb32d56.js","assets/index-a879fc9d.css"]).then((e=>e.default)),D.previousItemIndex&&(F.value.previousItemIndex=D.previousItemIndex),D.costItemId&&(async()=>{try{ne.value=!0;const e=await O.get(`/api/cost/${D.costItemId}/`);F.value=e.data}catch(e){console.log(e)}finally{ne.value=!1}})(),(async()=>{try{re.value=!0;const e=await O.get("/api/cost-code/");ie.value=e.data,Q.value=e.data.map((e=>({value:e.id,label:e.name,labour_cost:e.labour_cost,unit_cost:e.unit_cost??0,worker_cost:e.worker_cost??0})))}catch(e){console.log(e)}finally{re.value=!1}})(),de()}));const de=async()=>{try{ne.value=!0;const e=await O.get("/api/cost/catalogs/");U.value=e.data,A.value=e.data.map((e=>({value:e.id,name:e.title})))}catch(e){console.log(e)}finally{ne.value=!1}};return y(M,((e,a)=>{const l=U.value.find((e=>e.id==M.value)),{id:o,...t}=l;F.value=t})),(e,a)=>{const l=t("Multiselect"),o=L,f=H,_=G,g=K,y=J,V=z,T=W,O=S,U=b,$=E;return s(),n($,{is:"form",open:D.costItemModal,title:"catalog"==D.costMode?"Update Catalog":"Cost Item ",size:"xl",actions:"right",onSubmit:v(Z,["prevent"]),onClose:ee},{content:i((()=>[c("div",fe,[r(O,{class:"column is-12"},{default:i((()=>[c("div",_e,[c("div",ge,[ye,c("div",he,[h(c("input",{type:"text",name:"firstName","onUpdate:modelValue":a[0]||(a[0]=e=>d(F).title=e),required:"",disabled:D.previewCostItems,class:"input is-primary-focus is-primary-focus",placeholder:"Proposal Title"},null,8,we),[[w,d(F).title]])])]),"catalog"!==D.costMode?(s(),n(f,{key:0,class:"is-image-select column is-6",label:"Select Catalog"},{default:i((({id:e})=>[r(o,null,{default:i((()=>[r(l,{modelValue:d(M),"onUpdate:modelValue":a[1]||(a[1]=e=>u(M)?M.value=e:null),attrs:{id:e},placeholder:"Select a catalog",label:"name",options:d(A)},{singlelabel:i((({value:e})=>[c("div",Ie,[c("span",ke,p(e.name),1)])])),option:i((({option:e})=>[c("span",Ce,p(e.name),1)])),_:2},1032,["modelValue","attrs","options"])])),_:2},1024)])),_:1})):I("",!0),"catalog"!==D.costMode?(s(),k("div",Pe,[Se,r(f,null,{default:i((()=>[r(o,null,{default:i((()=>[r(g,{modelValue:d(F).cost_type,"onUpdate:modelValue":a[2]||(a[2]=e=>d(F).cost_type=e),disabled:D.previewCostItems},{default:i((()=>[(s(!0),k(C,null,P(d(Y),((e,a)=>(s(),n(_,{value:e.value},{default:i((()=>[m(p(e.label),1)])),_:2},1032,["value"])))),256))])),_:1},8,["modelValue","disabled"])])),_:1})])),_:1})])):I("",!0),D.costItemId?I("",!0):(s(),k("div",Ve,[De,c("div",null,[r(o,{raw:"",subcontrol:""},{default:i((()=>[r(y,{modelValue:d(F).catalog,"onUpdate:modelValue":a[3]||(a[3]=e=>d(F).catalog=e),label:"Create Template",color:"info"},null,8,["modelValue"])])),_:1})])])),c("div",xe,[Te,r(f,null,{default:i((()=>[r(o,null,{default:i((()=>[r(g,{modelValue:d(F).mark_as,"onUpdate:modelValue":a[4]||(a[4]=e=>d(F).mark_as=e),disabled:D.previewCostItems},{default:i((()=>[(s(!0),k(C,null,P(d(X),((e,a)=>(s(),n(_,{value:e.value},{default:i((()=>[m(p(e.label),1)])),_:2},1032,["value"])))),256))])),_:1},8,["modelValue","disabled"])])),_:1})])),_:1})]),c("div",Oe,[je,r(f,null,{default:i((({id:e})=>[r(o,null,{default:i((()=>[r(l,{required:"",modelValue:d(F).cost_code,"onUpdate:modelValue":a[5]||(a[5]=e=>d(F).cost_code=e),disabled:D.previewCostItems,attrs:{id:e},searchable:!0,options:d(Q),placeholder:"Select a cost code"},null,8,["modelValue","disabled","attrs","options"])])),_:2},1024)])),_:1})]),c("div",Me,[Ue,r(f,null,{default:i((()=>[r(o,null,{default:i((()=>[r(V,{modelValue:d(F).group,"onUpdate:modelValue":a[6]||(a[6]=e=>d(F).group=e),name:"gcost",placeholder:"Group Cost"},null,8,["modelValue"])])),_:1})])),_:1})]),c("div",Ae,[Fe,d(x)?(s(),n(d(te),{key:0,disabled:D.previewCostItems,modelValue:d(F).description,"onUpdate:modelValue":a[7]||(a[7]=e=>d(F).description=e),editor:d(x),config:se},null,8,["disabled","modelValue","editor"])):I("",!0)]),c("div",Ee,[He,r(f,null,{default:i((()=>[r(o,null,{default:i((()=>[r(T,{modelValue:d(F).internal_notes,"onUpdate:modelValue":a[8]||(a[8]=e=>d(F).internal_notes=e),disabled:D.previewCostItems,rows:"4",placeholder:"Internal notes..."},null,8,["modelValue","disabled"])])),_:1})])),_:1})])])])),_:1}),r(O,{class:"column is-12 mt-3"},{default:i((()=>[c("div",Le,[c("div",$e,[qe,r(f,null,{default:i((()=>[r(o,null,{default:i((()=>[r(V,{modelValue:d(F).unit_cost,"onUpdate:modelValue":a[9]||(a[9]=e=>d(F).unit_cost=e),disabled:D.previewCostItems,type:"number",name:"unitCost",step:"any",placeholder:"Unit cost"},null,8,["modelValue","disabled"])])),_:1})])),_:1})]),c("div",Ne,[Re,r(f,null,{default:i((()=>[r(o,null,{default:i((()=>[r(V,{modelValue:d(F).quantity,"onUpdate:modelValue":a[10]||(a[10]=e=>d(F).quantity=e),disabled:D.previewCostItems,type:"number",name:"quantity",step:"any",placeholder:"Quantity"},null,8,["modelValue","disabled"])])),_:1})])),_:1})]),c("div",Be,[We,r(f,null,{default:i((()=>[r(o,null,{default:i((()=>[r(g,{disabled:D.previewCostItems,modelValue:d(F).unit,"onUpdate:modelValue":a[11]||(a[11]=e=>d(F).unit=e)},{default:i((()=>[r(_,{value:""},{default:i((()=>[m(" Select Unit ")])),_:1}),(s(!0),k(C,null,P(d(be),(e=>(s(),n(_,{value:e.value},{default:i((()=>[m(p(e.label),1)])),_:2},1032,["value"])))),256))])),_:1},8,["disabled","modelValue"])])),_:1})])),_:1})]),c("div",ze,[Je,r(f,null,{default:i((()=>[r(o,null,{default:i((()=>[r(V,{modelValue:d(le),"onUpdate:modelValue":a[12]||(a[12]=e=>u(le)?le.value=e:null),disabled:D.previewCostItems,type:"number",step:"any",name:"builderCost",placeholder:"Builder cost"},null,8,["modelValue","disabled"])])),_:1})])),_:1})]),c("div",Ge,[Ke,r(f,null,{default:i((()=>[r(o,null,{default:i((()=>[r(V,{modelValue:d(F).markup,"onUpdate:modelValue":a[13]||(a[13]=e=>d(F).markup=e),disabled:D.previewCostItems,type:"number",name:"markup",step:"any",placeholder:"Markup"},null,8,["modelValue","disabled"])])),_:1})])),_:1})]),c("div",Ye,[Qe,r(f,null,{default:i((()=>[r(o,null,{default:i((()=>[r(V,{modelValue:d(oe),"onUpdate:modelValue":a[14]||(a[14]=e=>u(oe)?oe.value=e:null),disabled:D.previewCostItems,type:"number",name:"markup",step:"any",placeholder:"Total Price"},null,8,["modelValue","disabled"])])),_:1})])),_:1})]),c("div",Xe,[Ze,r(f,null,{default:i((()=>[r(o,null,{default:i((()=>[r(V,{modelValue:d(F).margin,"onUpdate:modelValue":a[15]||(a[15]=e=>d(F).margin=e),disabled:D.previewCostItems,type:"number",name:"markup",step:"any",placeholder:"Margin"},null,8,["modelValue","disabled"])])),_:1})])),_:1})]),c("div",ea,[aa,r(f,null,{default:i((()=>[r(o,null,{default:i((()=>[r(V,{modelValue:d(F).worker_cost,"onUpdate:modelValue":a[16]||(a[16]=e=>d(F).worker_cost=e),type:"number",name:"workerCost",step:"any",placeholder:"Worker Cost"},null,8,["modelValue"])])),_:1})])),_:1})])])])),_:1})])])),action:i((()=>[r(U,{loading:d(j),type:"submit",color:"primary",icon:D.costItemId?"":"fas fa-plus",raised:""},{default:i((()=>[m(p(D.costItemId?"Update":"Add"),1)])),_:1},8,["loading","icon"])])),_:1},8,["open","title","onSubmit"])}}}),oa=V("useProposal",(()=>{const e=l(!0),a=q(),o=$(),t=l("");l("");const s=l([]),n=l([]),i=l({id:"",jobInfo:{id:"",sales_people_info:[],clientInfo:{id:"",username:"",last_name:null,email:"",role:"",avatar:null},created_by_info:{id:"",username:"",last_name:null,email:"",role:"",avatar:null},managers_list:[],title:"",address:"",current_state:"",city:"",state:"",status:"",zip_code:"",confidence:"",sale_date:"",tags:[],estimated_from:"",estimated_to:"",sources:"",project_type:"",notes:"",attach_mail:"",latitude:0,longitude:0,created_at:"",updated_at:"",created_by:"",client:"",contractor:null,sales_people:[],managers:[]},proposalAmount:0,title:"",approval_deadline:"",internal_notes:"",introductory_text:"",closing_text:"",payment_status:"",type:"",status:"",columns_to_show:[],created_at:"",updated_at:"",job:""}),r=l([{id:"",index:0,title:"",description:"",type:"",quantity:0,unit:"",unit_cost:"",markup:"",total_price:"",cost_code:"",cost_type:"",builder_cost:"",margin:"",profit:"",internal_notes:"",mark_as:"",state:"",group_amount:"",status:null,created_at:"",proposal:""}]);return{loading:e,proposalCostItems:r,leadProposalFormData:i,companyProposalsList:s,leadProposalsList:n,getLeadProposals:async l=>{try{l.value=l,e.value=!0;const a=await o.get(`/api/lead-proposal/by-job/${l.value}/`);n.value=a.data}catch(t){a.error(` ${t}, Lead`)}finally{e.value=!1}},getProposalDetail:async e=>{try{const a=await o.get(`/api/lead-proposal/${e}/detail/`);i.value=a.data,Y.value=a.data.columns_to_show}catch(a){console.log(a)}},getCompanyProposals:async()=>{try{e.value=!0;const a=await o.get("/api/lead-proposal/");s.value=a.data}catch(l){a.error(` ${l}, Lead`)}finally{e.value=!1}},getProposalCostItems:async function(e){try{t.value=e;const a=await o.get(`/api/cost/by-proposal/${e}/`);r.value=a.data}catch(a){console.log(a)}},clearProposalId:function(){t.value="",r.value=[]}}})),ta={class:"modal-form columns is-multiline"},sa={class:"column is-full"},na={class:"field"},ia=c("label",{class:"label"},"Send To ",-1),ra={class:"control"},da={class:"column is-full"},ua={class:"field"},ca=c("label",{class:"label"},"Subject ",-1),pa={class:"control"},ma={class:"field column is-full mt-5"},va=c("label",{class:"label"},"Message",-1),ba=c("i",{class:"feather:mail"},null,-1),fa=e({__name:"SendProposalEmailModal",props:{proposalSenderModal:{type:Boolean},proposalData:{},columnsToShow:{},selectedProposalsIds:{}},emits:["update:modalHandler","update:OnSuccess"],setup(e,{emit:t}){const u=e,p=oa(),f=$(),y=q(),C=l(!1),P=a(),S=window.origin;l(`${S}/proposal-view/?proposal=${u.proposalData?.id}`);const V=()=>{t("update:modalHandler",!1)},x=u.selectedProposalsIds.map((e=>e.id)),T=u.selectedProposalsIds.map((e=>e.proposalAmount)).map(((e,a)=>`<li>Total of proposal ${a+1}:<b> $${e} </b></li>`)).join("<br>"),O=x.map(((e,a)=>`<a href="${S}/proposal-view/?proposal=${e}" style="color: #007bff; text-decoration: none; font-weight: bold;">View Proposal ${a+1}, </a>`)).join("<br>"),j=l({email:p.leadProposalFormData?.jobInfo?.clientInfo?.email?p.leadProposalFormData?.jobInfo?.clientInfo?.email:"N/A",subject:`Proposal ${p.leadProposalFormData?.jobInfo?.title} `,message:`<p><b>Hi ${p.leadProposalFormData?.jobInfo?.clientInfo?.username?p.leadProposalFormData?.jobInfo?.clientInfo?.username:"N/A"} ${p.leadProposalFormData?.jobInfo?.clientInfo?.last_name?p.leadProposalFormData?.jobInfo?.clientInfo?.last_name:""},</b></p>\n\n  <p>We hope this message finds you well.</p>\n\n  <p>\n    Please find attached a detailed proposal outlining the cost items associated with the services/products we will be providing.\n    We have carefully curated this proposal to ensure complete transparency and alignment with your expectations.\n  </p>\n\n  <p>\n    Actions required for all proposals, and uou can review the full proposal(s), including the cost breakdown, by clicking the link below: <br />\n    ${O}\n  </p>\n\n  <p><b>Respectively proposal(s) amount are:</b></p>\n  <ul>\n    ${T}\n  </ul>\n\n  <p>\n    If you have any questions or require further clarification, feel free to reach out to us at your earliest convenience.\n    We are here to assist you.\n  </p>\n\n  <p>Thank you for trusting <b>Ibex Team</b> with your project.</p>\n\n  <p><b>Best Regards,</b><br />\n    Ibex Team\n  </p>`,link:O[0],columns:["cost_code","title","description","unit_cost"],showClient:!0,proposal_ids:x}),M=async()=>{try{C.value=!0;let e=j.value;e.proposal_ids=JSON.stringify(j.value.proposal_ids),e.columns=JSON.stringify(j.value.columns);await f.post("/api/lead-proposal/send-proposal-template/",e);y.success("Email sent successfully"),V()}catch(e){console.log(e)}finally{C.value=!1}},U=_((()=>g((()=>import("./ckeditor-5c604219.js").then((e=>e.c))),["assets/ckeditor-5c604219.js","assets/index-1fb32d56.js","assets/index-a879fc9d.css","assets/vue.runtime.esm-bundler-94f07bb9.js"]).then((e=>e.default.component)))),A={fontFamily:{options:['"Montserrat", sans-serif','"Roboto", sans-serif']},height:"400px",minHeight:"400px",maxHeight:"600px"};return o((async()=>{P.value=await g((()=>import("./ckeditor-4e82cada.js").then((e=>e.c))),["assets/ckeditor-4e82cada.js","assets/index-1fb32d56.js","assets/index-a879fc9d.css"]).then((e=>e.default))})),(e,a)=>{const l=b,o=E;return s(),k("div",null,[r(D,{name:"fade-slow"},{default:i((()=>[r(o,{is:"form",open:u.proposalSenderModal,title:"Send Proposal",size:"large",actions:"right",onSubmit:v(M,["prevent"]),onClose:V},{content:i((()=>[c("div",ta,[c("div",sa,[c("div",na,[ia,c("div",ra,[h(c("input",{type:"email",required:"",class:"input",placeholder:"Enter Mail","onUpdate:modelValue":a[0]||(a[0]=e=>d(j).email=e)},null,512),[[w,d(j).email]])])])]),c("div",da,[c("div",ua,[ca,c("div",pa,[h(c("input",{type:"text",required:"",class:"input",placeholder:"Enter mail subject","onUpdate:modelValue":a[1]||(a[1]=e=>d(j).subject=e)},null,512),[[w,d(j).subject]])])])]),c("div",ma,[va,d(P)?(s(),n(d(U),{key:0,modelValue:d(j).message,"onUpdate:modelValue":a[2]||(a[2]=e=>d(j).message=e),editor:d(P),config:A},null,8,["modelValue","editor"])):I("",!0)])])])),action:i((()=>[r(l,{type:"submit",color:"primary",loading:d(C),raised:""},{default:i((()=>[ba,m(" Send Proposal")])),_:1},8,["loading"])])),cancel:i((()=>[r(l,{color:"light",onClick:V,raised:""},{default:i((()=>[m("Close ")])),_:1})])),_:1},8,["open","onSubmit"])])),_:1})])}}}),_a=$();q();const ga=l(0),ya=async e=>{try{ga.value=3;const a=await _a.get(`/api/lead-proposal/${e.id}/download/`,{responseType:"blob"}),l=new Blob([a.data],{type:"application/pdf"}),o=document.createElement("a");o.href=URL.createObjectURL(l),o.download=`Proposal-${e.title}.pdf`,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(o.href)}catch(a){console.error("Error downloading PDF:",a)}finally{ga.value=0}},ha=async e=>{try{ga.value=1;const a=await _a.get(`/api/lead-proposal/${e}/download/`,{responseType:"blob"}),l=new Blob([a.data],{type:"application/pdf"}),o=URL.createObjectURL(l),t=document.createElement("iframe");t.style.display="none",t.src=o,document.body.appendChild(t),t.onload=()=>{t.contentWindow?.print(),document.body.removeChild(t)}}catch(a){console.error("Error printing PDF:",a)}finally{ga.value=0}},wa=e=>(T("data-v-a579a0ad"),e=e(),O(),e),Ia={class:"columns is-multiline"},ka=wa((()=>c("div",{class:"column is-9"},[c("h1",{class:"title is-5 m-1 p-0"},"Preview Lead Proposal"),c("p",{class:"m-1"}," Below is a preview of the proposal that will be sent as a link to the email addresses on this client contact. The proposal can be accessed through the link while it is Released. ")],-1))),Ca={class:"column is-12"},Pa={class:"invoice-wrapper"},Sa={class:"invoice-header"},Va={class:"left"},Da={class:"right"},xa={class:"controls"},Ta=[wa((()=>c("i",{"aria-hidden":"true",class:"iconify","data-icon":"feather:printer"},null,-1)))],Oa=[wa((()=>c("i",{"aria-hidden":"true",class:"iconify","data-icon":"feather:download-cloud"},null,-1)))],ja=[wa((()=>c("i",{"aria-hidden":"true",class:"iconify","data-icon":"feather:mail"},null,-1)))],Ma={class:"invoice-body"},Ua={class:"invoice-card"},Aa={class:"invoice-section is-flex"},Fa=wa((()=>c("div",{class:"meta"},null,-1))),Ea=wa((()=>c("div",{class:"end is-right"},[c("span",null,"PO Box 242"),c("span",null,"Evergreen, CO 80437-0242"),c("span",null,"Phone: 720 272-9061"),c("span",null,"Premium Trades for Premier Builders")],-1))),Ha={class:"invoice-section is-flex"},La={class:"meta"},$a={class:"end is-left"},qa={class:"invoice-section"},Na={class:"responsive-table"},Ra=["innerHTML"],Ba={key:1},Wa={key:2},za={class:"invoice-section is-flex mt-0 pt-0"},Ja={class:"end is-left"},Ga={class:"text-right"},Ka=x('<div class="invoice-section is-flex mt-0 pt-0" data-v-a579a0ad><div class="footer" data-v-a579a0ad><div class="footer-meta" data-v-a579a0ad><p data-v-a579a0ad>Signature:</p><div data-v-a579a0ad></div></div><div class="footer-meta" data-v-a579a0ad><p data-v-a579a0ad>Date:</p><div data-v-a579a0ad></div></div><div class="footer-meta" data-v-a579a0ad><p class="no-wrap" data-v-a579a0ad>Print Name:</p><div data-v-a579a0ad></div></div></div></div>',1),Ya=j(e({__name:"ProposalPreview",props:{columnsToShow:{},proposalData:{}},setup(e){const a=e,t=oa(),i=l(!1),u=l([]),m=l([]),v=l({}),b=()=>{m.value.push(a.proposalData),v.value=a.proposalData,u.value=t.leadProposalFormData.columns_to_show,i.value=!i.value};return o((()=>{})),(e,l)=>{const o=ae,u=ee,v=fa;return s(),k("div",Ia,[ka,c("div",Ca,[c("div",Pa,[c("div",Sa,[c("div",Va,[c("h3",null," Proposal-ID "+p(d(t).leadProposalFormData?.id.slice(0,8)),1)]),c("div",Da,[c("div",xa,[1==d(ga)?(s(),n(o,{key:0,color:"primary",outlined:"",size:"small",loading:"",circle:"",icon:"lucide:plus"})):(s(),k("a",{key:1,class:"action",onClick:l[0]||(l[0]=e=>d(ha)(d(t).leadProposalFormData?.id))},Ta)),3==d(ga)?(s(),n(o,{key:2,color:"primary",outlined:"",size:"small",loading:"",circle:"",icon:"lucide:plus"})):(s(),k("a",{key:3,class:"action",onClick:l[1]||(l[1]=e=>d(ya)(d(t).leadProposalFormData))},Oa)),c("a",{class:"action",onClick:b},ja)])])]),c("div",Ma,[c("div",Ua,[c("div",Aa,[r(u,{size:"xl",picture:"/logos/IbexFavicon.png"}),Fa,Ea]),c("div",Ha,[c("div",La,[c("h3",null,p(d(t).leadProposalFormData?.jobInfo?.clientInfo?.username??"N/A")+" "+p(d(t).leadProposalFormData?.jobInfo?.clientInfo?.last_name??""),1),c("span",null,p(d(t).leadProposalFormData?.jobInfo?.clientInfo?.email?d(t).leadProposalFormData?.jobInfo?.clientInfo?.email:"N/A"),1)]),c("div",$a,[c("h3",null,p(d(t).leadProposalFormData?.title),1),c("p",null," Job Address: "+p(d(t).leadProposalFormData?.jobInfo?.address??"N/A"),1)])]),c("div",qa,[c("table",Na,[c("thead",null,[(s(!0),k(C,null,P(a.columnsToShow,((e,a)=>(s(),k("th",{key:a},p(d(Q)[e]),1)))),128))]),c("tbody",null,[(s(!0),k(C,null,P(d(t).proposalCostItems,((e,l)=>(s(),k("tr",{key:e.id},[(s(!0),k(C,null,P(a.columnsToShow,((a,l)=>(s(),k("td",{key:l},["description"===a?(s(),k("div",{key:0,innerHTML:e[d(X)[a]]},null,8,Ra)):(s(),k("span",Ba,p(e[d(X)[a]]),1)),"cost_code"===a?(s(),k("span",Wa,p(e?.cost_code_info?.name),1)):I("",!0)])))),128))])))),128))])])]),c("div",za,[c("div",Ja,[c("h3",Ga," Total Price: $"+p(d(t).leadProposalFormData?.proposalAmount),1)])]),Ka])])])]),d(i)?(s(),n(v,{key:0,proposalSenderModal:d(i),selectedProposalsIds:d(m),proposalData:a.proposalData,columnsToShow:a.columnsToShow,"onUpdate:modalHandler":l[2]||(l[2]=e=>{i.value=!1,m.value=[]})},null,8,["proposalSenderModal","selectedProposalsIds","proposalData","columnsToShow"])):I("",!0)])}}}),[["__scopeId","data-v-a579a0ad"]]),Qa=e=>(T("data-v-48fb440f"),e=e(),O(),e),Xa={class:"datatable-wrapper mt-0"},Za={class:"table-container"},el={class:"table datatable-table is-fullwidth",id:"external-events"},al=Qa((()=>c("th",null,null,-1))),ll=Qa((()=>c("th",null,"Actions",-1))),ol=["data-event","onDragstart","onDrop","onDblclick"],tl={class:"is-relative"},sl=["onClick"],nl=["innerHTML"],il={key:1},rl={key:2},dl=["onClick"],ul=[Qa((()=>c("div",{class:"icon"},[c("i",{"aria-hidden":"true",class:"lnil lnil-briefcase"})],-1))),Qa((()=>c("div",{class:"meta"},[c("span",null,"Edit"),c("span",null,"Edit Cost Item")],-1)))],cl=Qa((()=>c("hr",{class:"dropdown-divider"},null,-1))),pl=["onClick"],ml=[Qa((()=>c("div",{class:"icon"},[c("i",{"aria-hidden":"true",class:"lnil lnil-trash-can-alt"})],-1))),Qa((()=>c("div",{class:"meta"},[c("span",null,"Remove"),c("span",null,"Remove from list")],-1)))],vl=e({__name:"CostItemsTable",props:{columnsToShow:{},itemsList:{},proposalId:{}},setup(e){const a=e,t=$(),u=l(""),m=l(!1),b=oa(),f=q(),_=l(""),g=l(0),h=l(""),w=l(!1),S=l(!1),V=l({title:"",subtitle:"test",isSweetAlertOpen:!1,btntext:"text"}),D=e=>{e.preventDefault()},x=e=>{e.preventDefault(),e.currentTarget?.classList.add("drag-over")},T=e=>{e.preventDefault(),e.currentTarget?.classList.remove("drag-over")},O=async()=>{try{S.value=!0;await t.delete(`/api/cost/${h.value}/`);M(),V.value.isSweetAlertOpen=!1,f.success("Cost item deleted")}catch(e){console.log(e)}finally{S.value=!1}},j=(e,a=!1)=>{h.value=e.id,w.value=a,_.value=e.proposal,m.value=!m.value},M=()=>{b.getProposalCostItems(_.value)};return y((()=>a.columnsToShow),((e,l)=>{e&&JSON.stringify(e)!==JSON.stringify(l)&&(async()=>{try{a.proposalId&&await t.patch(`/api/lead-proposal/${a.proposalId}/`,{columns_to_show:JSON.stringify(a.columnsToShow)}),b.getProposalDetail(a.proposalId)}catch(e){f.error("Something went wrong, try again")}})()}),{deep:!0}),o((()=>{})),(e,l)=>{const o=oe,f=le,y=la;return s(),k("div",Xa,[c("div",Za,[c("table",el,[c("thead",null,[al,(s(!0),k(C,null,P(a.columnsToShow,((e,a)=>(s(),k("th",{key:a},p(d(Q)[e]),1)))),128)),ll]),c("tbody",null,[d(b).proposalCostItems.length>0?(s(!0),k(C,{key:0},P(d(b).proposalCostItems,((e,l)=>(s(),k("tr",{key:e.id,"data-event":JSON.stringify(e),draggable:"true",onDragstart:a=>{return l=e.id,u.value=l,void console.log("Drag started for ID:",l);var l},onDrop:a=>(e=>{console.log("Dropped on ID:",e);const a=b.proposalCostItems.find((e=>e.id===u.value)),l=b.proposalCostItems.find((a=>a.id===e));if(a&&l){t.post("/api/cost/drag-drop-items/",{dragged_item_id:a.id,dropped_item_id:l.id});const e=b.proposalCostItems.indexOf(a),o=b.proposalCostItems.indexOf(l);e>=0&&o>=0&&(b.proposalCostItems.splice(e,1),b.proposalCostItems.splice(o,0,a))}else console.error("Dragged or Dropped Item not found");u.value=null})(e.id),onDragover:D,onDragenter:x,onDragleave:T,onDblclick:a=>j(e,!1),class:"draggable-item events"},[c("td",tl,[c("i",{style:{position:"absolute",bottom:"-7px",left:"1px",cursor:"pointer","z-index":"99","font-weight":"600"},onClick:a=>(e=>{_.value=e.proposal,g.value=e.index,m.value=!m.value})(e),class:"lnir lnir-circle-plus info-text","aria-hidden":"true"},null,8,sl)]),(s(!0),k(C,null,P(a.columnsToShow,((a,l)=>(s(),k("td",{key:l},["description"===a?(s(),k("div",{key:0,innerHTML:e[d(X)[a]]},null,8,nl)):(s(),k("span",il,p(e[d(X)[a]]),1)),"cost_code"===a?(s(),k("span",rl,p(e?.cost_code_info?.name),1)):I("",!0)])))),128)),c("td",null,[r(o,{icon:"feather:more-vertical",class:"is-pushed-mobile",spaced:"",right:"",up:"",style:{"z-index":"99"}},{content:i((({close:a})=>[c("a",{role:"menuitem",href:"#",class:"dropdown-item is-media",onClick:v((()=>{j(e,!1),a()}),["prevent"])},ul,8,dl),cl,c("a",{role:"menuitem",href:"#",class:"dropdown-item is-media",onClick:v((()=>{(e=>{h.value=e.id,_.value=e.proposal,V.value={title:"Are you sure?",subtitle:"You will not be able to recover this cost item!",btntext:"Delete",isSweetAlertOpen:!0}})(e),a()}),["prevent"])},ml,8,pl)])),_:2},1024)])],40,ol)))),128)):I("",!0)])])]),d(V).isSweetAlertOpen?(s(),n(f,{key:0,isSweetAlertOpen:d(V).isSweetAlertOpen,title:d(V).title,subtitle:d(V).subtitle,btntext:d(V).btntext,onConfirm:O,onCancel:()=>d(V).isSweetAlertOpen=!1},null,8,["isSweetAlertOpen","title","subtitle","btntext","onCancel"])):I("",!0),d(m)?(s(),n(y,{key:1,costItemModal:d(m),proposalId:d(_),costItemId:d(h),previousItemIndex:d(g),previewCostItems:d(w),"onUpdate:modalHandler":l[0]||(l[0]=e=>{m.value=!1,h.value=""}),"onUpdate:OnSuccess":M},null,8,["costItemModal","proposalId","costItemId","previousItemIndex","previewCostItems"])):I("",!0)])}}}),bl=j(vl,[["__scopeId","data-v-48fb440f"]]),fl={class:"columns is-multiline"},_l={class:"column is-12 is-flex space-between"},gl=c("div",null,[c("h1",{class:"title is-4"},"Proposal Worksheet")],-1),yl={key:0,class:"column is-12"},hl={class:"tabs-wrapper column is-12 m-0"},wl={class:"tabs-inner mt-4"},Il={class:"tabs is-boxed"},kl=[c("span",null,"Worksheet",-1)],Cl=[c("span",null,"Format",-1)],Pl=[c("span",null,"Preview",-1)],Sl={key:0,class:"column is-12"},Vl={key:0,class:"column is-12"},Dl={class:"columns is-multiline"},xl=c("div",{class:"column is-12",style:{"text-align":"center"}},[c("h1",{class:"title is-4"},"Connect your clients to their projects"),c("h1",{class:"title is-5"}," Create a client contact and assign them to jobs and lead opportunities effortlessly. ")],-1),Tl={class:"column is-12"},Ol={key:0,class:"column is-12"},jl=e({__name:"WorksheetItems",props:{leadProposalModal:{type:Boolean},proposalId:{},proposalData:{}},emits:["update:modalHandler","update:OnSuccess"],setup(e,{emit:p}){const f=e,h=$(),w=q(),C=a(),P=oa(),V=l(!1),D=l(!1),x=l(!1),T=l("worksheet");_((()=>g((()=>import("./ckeditor-5c604219.js").then((e=>e.c))),["assets/ckeditor-5c604219.js","assets/index-1fb32d56.js","assets/index-a879fc9d.css","assets/vue.runtime.esm-bundler-94f07bb9.js"]).then((e=>e.default.component))));const O=async()=>{try{P.getProposalCostItems(f.proposalId)}catch(e){console.log(e)}};return y((()=>Y.value),((e,a)=>{e&&JSON.stringify(e)!==JSON.stringify(a)&&(async()=>{try{f.proposalId&&await h.patch(`/api/lead-proposal/${f.proposalId}/`,{columns_to_show:JSON.stringify(Y.value)}),P.getProposalDetail(f.proposalId)}catch(e){w.error("Something went wrong, try again")}})()}),{deep:!0}),o((async()=>{C.value=await g((()=>import("./ckeditor-4e82cada.js").then((e=>e.c))),["assets/ckeditor-4e82cada.js","assets/index-1fb32d56.js","assets/index-a879fc9d.css"]).then((e=>e.default)),f.proposalId&&(O(),P.getProposalDetail(f.proposalId))})),M((()=>{P.clearProposalId()})),(e,a)=>{const l=b,o=t("Multiselect"),p=L,_=H,g=bl,y=S,h=Ya,w=la,C=ie;return s(),k("div",null,[c("div",fl,[c("div",_l,[gl,c("div",null,[r(l,{size:"small",light:"",outlined:"",icon:"fas fa-cog",class:"mr-2",color:d(D)?"danger":"success",onClick:a[0]||(a[0]=e=>D.value=!d(D))},{default:i((()=>[m("Table")])),_:1},8,["color"]),r(l,{size:"small",light:"",outlined:"",class:"mr-2",color:"info",onClick:a[1]||(a[1]=e=>x.value=!d(x))},{default:i((()=>[m("Import")])),_:1}),r(l,{size:"small",light:"",outlined:"",class:"mr-2",color:"primary",onClick:a[2]||(a[2]=e=>V.value=!d(V))},{default:i((()=>[m("Add From")])),_:1}),r(l,{size:"small",light:"",outlined:"",color:"warning",onClick:a[3]||(a[3]=e=>V.value=!d(V))},{default:i((()=>[m("Add Item")])),_:1})])]),r(U,{class:"fade-slow",name:"fade-slow"},{default:i((()=>[d(D)?(s(),k("div",yl,[r(_,{label:"Choose what to show to lead",class:"column is-12"},{default:i((({id:e})=>[r(p,null,{default:i((()=>[r(o,{modelValue:d(Y),"onUpdate:modelValue":a[4]||(a[4]=e=>u(Y)?Y.value=e:null),attrs:{id:e},mode:"tags",searchable:!0,"create-tag":!0,options:d(Z),placeholder:"Add columns"},null,8,["modelValue","attrs","options"])])),_:2},1024)])),_:1})])):I("",!0)])),_:1}),c("div",hl,[c("div",wl,[c("div",Il,[c("ul",null,[c("li",{class:A(["worksheet"===d(T)?"is-active":"not-active"])},[c("a",{tabindex:"0",role:"button",onKeydown:a[5]||(a[5]=F(v((e=>T.value="worksheet"),["prevent"]),["space"])),onClick:a[6]||(a[6]=e=>T.value="worksheet")},kl,32)],2),c("li",{class:A(["format"===d(T)?"is-active":"not-active"])},[c("a",{tabindex:"0",role:"button",onKeydown:a[7]||(a[7]=F(v((e=>T.value="format"),["prevent"]),["space"])),onClick:a[8]||(a[8]=e=>T.value="format")},Cl,32)],2),c("li",{class:A(["preview"===d(T)?"is-active":"not-active"])},[c("a",{tabindex:"0",role:"button",onKeydown:a[9]||(a[9]=F(v((e=>T.value="preview"),["prevent"]),["space"])),onClick:a[10]||(a[10]=e=>T.value="preview")},Pl,32)],2)])])])]),r(U,{class:"fade-slow",name:"slide-x"},{default:i((()=>["worksheet"===d(T)?(s(),k("div",Sl,[r(g,{columnsToShow:d(Y),proposalId:f.proposalId},null,8,["columnsToShow","proposalId"])])):I("",!0)])),_:1}),r(U,{class:"fade-slow",name:"slide-x"},{default:i((()=>["format"===d(T)?(s(),k("div",Vl,[c("div",Dl,[r(_,{label:"Choose what to show to lead",class:"column is-12"},{default:i((({id:e})=>[r(p,null,{default:i((()=>[r(o,{modelValue:d(Y),"onUpdate:modelValue":a[11]||(a[11]=e=>u(Y)?Y.value=e:null),attrs:{id:e},mode:"tags",searchable:!0,"create-tag":!0,options:d(Z),placeholder:"Add tags"},null,8,["modelValue","attrs","options"])])),_:2},1024)])),_:1})]),r(y,{class:"columns is-multiline m-0"},{default:i((()=>[xl,c("div",Tl,[r(g,{columnsToShow:d(Y),proposalId:f.proposalId},null,8,["columnsToShow","proposalId"])])])),_:1})])):I("",!0)])),_:1}),r(U,{class:"fade-slow",name:"slide-x"},{default:i((()=>["preview"===d(T)?(s(),k("div",Ol,[r(h,{proposalData:f.proposalData,proposalId:f.proposalId,columnsToShow:d(Y)},null,8,["proposalData","proposalId","columnsToShow"])])):I("",!0)])),_:1})]),d(V)?(s(),n(w,{key:0,costItemModal:d(V),proposalId:f.proposalId,"onUpdate:modalHandler":a[12]||(a[12]=e=>V.value=!1),"onUpdate:OnSuccess":O},null,8,["costItemModal","proposalId"])):I("",!0),d(x)?(s(),n(C,{key:1,centeredActionsOpen:d(x),proposalId:f.proposalId,"onUpdate:modalHandler":a[13]||(a[13]=e=>x.value=!1),"onUpdate:OnSuccess":O},null,8,["centeredActionsOpen","proposalId"])):I("",!0)])}}}),Ml=e=>(T("data-v-0317543a"),e=e(),O(),e),Ul={class:"columns is-multiline"},Al=Ml((()=>c("div",{class:"column is-2"},null,-1))),Fl={class:"column is-8"},El=Ml((()=>c("div",{class:"column is-2"},null,-1))),Hl=Ml((()=>c("div",{class:"column is-2"},null,-1))),Ll=Ml((()=>c("div",{class:"column is-8"},[c("p",null," All the tasks will be generated and will start from the date you will put. ")],-1))),$l=Ml((()=>c("div",{class:"column is-2"},null,-1))),ql=e({__name:"CreateProposalTasksModal",props:{createProposalTasksModal:{type:Boolean,default:!1},proposalId:{default:""}},emits:["closeModalHandler","update:OnSuccess"],setup(e,{emit:a}){const t=e,p=q(),f=$(),_=l(""),g=l(!1),y=()=>{a("update:OnSuccess",null),a("closeModalHandler",!1)},h=async()=>{try{await f.post("/api/lead-proposal/create-tasks/",{start:_.value,proposal:t.proposalId});p.success("Tasks of this proposal are created in calendar successfully."),y()}catch(e){console.log(e),p.error("Something went wrong, please review the cost codes")}};return o((()=>{})),(e,a)=>{const l=z,o=L,p=H,f=b,w=E;return s(),n(w,{is:"form",open:t.createProposalTasksModal,title:"Generate Tasks",size:"small",actions:"center",onSubmit:v(h,["prevent"]),onClose:y},{content:i((()=>[c("div",Ul,[Al,c("div",Fl,[r(p,{label:"Enter Tasks Starting Date"},{default:i((()=>[r(o,null,{default:i((()=>[r(l,{modelValue:d(_),"onUpdate:modelValue":a[0]||(a[0]=e=>u(_)?_.value=e:null),required:"",name:"startDate",type:"date"},null,8,["modelValue"])])),_:1})])),_:1})]),El,Hl,Ll,$l])])),cancel:i((()=>[r(f,{light:"",onClick:a[1]||(a[1]=e=>y())},{default:i((()=>[m("Cancel")])),_:1})])),action:i((()=>[r(f,{loading:d(g),type:"submit",color:"info",light:"",raised:""},{default:i((()=>[m("Generate")])),_:1},8,["loading"])])),_:1},8,["open","onSubmit"])}}}),Nl=j(ql,[["__scopeId","data-v-0317543a"]]);export{jl as _,fa as a,Nl as b,la as c,pe as d,me as e,ue as f,re as g,ce as h,ve as i,de as j,ya as k,oa as u};
