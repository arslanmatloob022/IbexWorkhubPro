import{_ as e}from"./VModal.vue_vue_type_style_index_0_lang-2f7a683d.js";import{_ as l}from"./VField.vue_vue_type_script_setup_true_lang-86919e0d.js";import{_ as a}from"./VInput.vue_vue_type_script_setup_true_lang-56556dad.js";import{_ as t}from"./VLabel.vue_vue_type_script_setup_true_lang-fd59f278.js";import{_ as s}from"./ExcelFileEditor-5c287576.js";import{_ as o}from"./VIconWrap.vue_vue_type_style_index_0_lang-793d65d9.js";import{_ as i}from"./VControl-52aa362e.js";import{f as n,b as r,r as u,w as c,$ as d,o as p,C as m,O as _,D as v,E as f,F as y,G as g,K as h,L as x,X as b,V as k,W as C,m as w,N as j,U as I,J as T,P as V,al as P,Q as S,R as A,S as M,x as U,y as O,k as L,aS as D,A as E,I as F,H}from"./index-65642adb.js";import{_ as $}from"./PlaceloadV4.vue_vue_type_style_index_0_lang-51f877ef.js";import{u as B}from"./useAPI-a1c8acf2.js";import{u as K}from"./useNotyf-b0e060ae.js";import{f as R,a as W,d as z,i as N}from"./useSupportElement-a2e3d3dc.js";import{b as J,a as Q,_ as X}from"./CreateProposalTasksModal-97345577.js";import{_ as Y,c as q}from"./VFlexTable.vue_vue_type_style_index_0_lang-05ca3d12.js";import{_ as G,a as Z}from"./ProposalViewModal.vue_vue_type_style_index_0_lang-8266babe.js";import{_ as ee}from"./SweetAlert.vue_vue_type_style_index_0_lang-179df1ae.js";import{_ as le}from"./VFlexPagination.vue_vue_type_script_setup_true_lang-70a5a1b6.js";import{_ as ae}from"./VPlaceholderPage.vue_vue_type_style_index_0_lang-6cd544fc.js";import{_ as te}from"./VDropdown.vue_vue_type_style_index_0_lang-a2264ad0.js";import{_ as se}from"./VTag.vue_vue_type_style_index_0_lang-8b8ef89e.js";import{_ as oe}from"./PlaceloadV1.vue_vue_type_style_index_0_lang-01054573.js";import{_ as ie,a as ne}from"./search-4-dark-3664abd4.js";import{u as re}from"./viewWrapper-c491b312.js";import"./useVFieldContext-845190db.js";import"./VIconBox.vue_vue_type_style_index_0_lang-ecd7da1b.js";import"./moment-bad41465.js";import"./via-placeholder-24645670.js";import"./VPlaceloadText.vue_vue_type_style_index_0_lang-b1367dc3.js";import"./VPlaceloadAvatar.vue_vue_type_style_index_0_lang-91013028.js";import"./notyf-3f1b770a.js";import"./useThemeColors-f00ee862.js";import"./VRadio.vue_vue_type_style_index_0_lang-2f23a1a1.js";import"./UnitAddUpdateModal.vue_vue_type_script_setup_true_lang-0a084fb2.js";import"./VTextarea.vue_vue_type_script_setup_true_lang-e4540314.js";import"./VCheckbox.vue_vue_type_style_index_0_lang-4dc32132.js";import"./VOption.vue_vue_type_style_index_0_lang-e6230e31.js";import"./costItems-17d2cf4d.js";import"./VIconButton-b1eaa9f0.js";import"./company-9dbce81c.js";import"./V-Snack.vue_vue_type_style_index_0_lang-e4cd616b.js";import"./VIcon.vue_vue_type_script_setup_true_lang-b858de5c.js";import"./VAvatar.vue_vue_type_style_index_0_lang-5796122b.js";import"./VFlex.vue_vue_type_style_index_0_lang-1667ceb5.js";import"./useDropdown-c1c13eb4.js";import"./VPlaceloadWrap-27fd4a9e.js";const ue={key:1,class:"columns is-multiline"},ce={class:"column is-12"},de={class:"columns is-multiline"},pe={class:"list-flex-toolbar is-reversed column is-12"},me={class:"card p-4 curved is-flex space-between"},_e={class:"subtitle is-5 m-0"},ve={class:"content"},fe={class:"is-flex"},ye={class:"modal-form columns is-multiline"},ge={class:"file has-name"},he={class:"file-label"},xe=(e=>(S("data-v-09397dde"),e=e(),A(),e))((()=>f("span",{class:"file-cta"},[f("span",{class:"file-icon"},[f("i",{class:"fas fa-cloud-upload-alt"})]),f("span",{class:"file-label"}," Choose a fileâ€¦ ")],-1))),be={class:"file-name light-text"},ke=M(n({__name:"CalculationsTemplates",props:{fetchAll:{},fetchTemplates:{},userId:{},objectId:{}},setup(n){const S=n,A=r(),M=B(),U=K(),O=u(!1),L=u([]),D=u([]),E=u(""),F=u(!1),H=u(""),z=u(!1),N=u(0),J=u({file:"",title:"",user_id:A.user.id,object_id:S.objectId}),Q=e=>{let l=e.target.files[0];J.value.file=l,H.value=l.name,J.value.title=l.name},X=u(""),Y=u([{value:"",name:""}]),q=async()=>{try{O.value=!0;const e=await M.get("/api/excel-files/");L.value=e.data}catch(e){console.error(e)}finally{O.value=!1}},G=async()=>{try{O.value=!0;const e=await M.get("/api/excel-files/templates/");D.value=e.data,Y.value=D.value.map((e=>({value:e.id,name:e.title})))}catch(e){console.error(e)}finally{O.value=!1}},Z=(e="")=>{N.value=e,z.value=!0},ee=u(!1),le=async()=>{try{ee.value=!0;const e=W(J.value,[""]);await M.post("/api/excel-files/upload-excel/",e);q(),U.success("Sheet uploaded successfully")}catch(e){console.error(e)}finally{ee.value=!1,F.value=!1}};c((()=>X.value),(e=>{e&&(async e=>{try{ee.value=!0,await M.post(`/api/excel-files/create-from-template/${e}/`),U.success("Sheet create successfully"),q()}catch(l){console.error(l)}finally{ee.value=!1,F.value=!1}})(e)}));const ae=d((()=>{if(E.value){const e=new RegExp(E.value,"i");return D.value.filter((l=>l.title?.match(e)))}return D.value}));return p((async()=>{G()})),(n,r)=>{const u=$,c=V,d=P,p=i,S=o,A=s,L=t,D=a,B=l,K=e;return O.value?(m(),_(u,{key:0})):(m(),v("div",ue,[f("div",ce,[f("div",de,[f("div",pe,[y(d,null,{default:g((()=>[y(c,{icon:"fas fa-plus",color:"info",outlined:"",light:"",class:"ml-2",raised:"",onClick:r[0]||(r[0]=e=>Z())},{default:g((()=>[h("Template")])),_:1}),y(c,{icon:"fas fa-upload",raised:"",light:"",onClick:r[1]||(r[1]=e=>F.value=!F.value),outlined:"",color:"primary"},{default:g((()=>[h(" File ")])),_:1})])),_:1}),f("div",null,[y(p,{class:"mr-2 h-hidden-mobile",icon:"feather:search"},{default:g((()=>[x(f("input",{"onUpdate:modelValue":r[2]||(r[2]=e=>E.value=e),class:"input custom-text-filter",placeholder:"Search..."},null,512),[[b,E.value]])])),_:1})])]),(m(!0),v(k,null,C(w(ae),((e,l)=>(m(),v("div",{class:"column is-6",key:e.id},[f("div",me,[f("div",null,[f("h4",_e,I(e.title),1),f("div",ve,[f("p",null,I(w(R)(e.created_at)),1)])]),f("div",fe,[y(S,{icon:"lucide:pen",color:"info",class:"cu-pointer",onClick:l=>Z(e.id),"has-background":""},null,8,["onClick"]),y(S,{onClick:l=>(async e=>{try{await M.delete(`/api/excel-files/${e}/`),U.success("Sheet deleted successfully!"),G()}catch(l){console.error(l),U.error("Failed to delete sheet.")}})(e.id),icon:"lucide:trash",color:"danger","has-background":"",class:"cu-pointer ml-1"},null,8,["onClick"])])])])))),128))])]),z.value?(m(),_(A,{key:0,class:"fullscreen","excel-file-modal":z.value,fileId:N.value,isTemplate:!0,"onUpdate:modalHandler":r[3]||(r[3]=e=>{G(),z.value=!1})},null,8,["excel-file-modal","fileId"])):j("",!0),y(K,{is:"form",open:F.value,title:"Upload Task File",size:"medium",actions:"right",onClose:r[6]||(r[6]=e=>F.value=!1),onSubmit:T(le,["prevent"])},{content:g((()=>[f("div",ye,[y(B,{class:"column is-12"},{default:g((()=>[y(L,null,{default:g((()=>[h("File Title")])),_:1}),y(p,null,{default:g((()=>[y(D,{modelValue:J.value.title,"onUpdate:modelValue":r[4]||(r[4]=e=>J.value.title=e),type:"text"},null,8,["modelValue"])])),_:1})])),_:1}),y(B,{class:"column is-12",grouped:""},{default:g((()=>[y(p,null,{default:g((()=>[f("div",ge,[f("label",he,[f("input",{onChange:Q,class:"file-input",type:"file",name:"file",required:""},null,32),xe,f("span",be,I(H.value?H.value:"Upload any file"),1)])])])),_:1})])),_:1})])])),cancel:g((()=>[y(c,{onClick:r[5]||(r[5]=e=>F.value=!1),raised:""},{default:g((()=>[h("Close")])),_:1})])),action:g((()=>[y(c,{type:"submit",color:"primary",raised:""},{default:g((()=>[h("Upload")])),_:1})])),_:1},8,["open","onSubmit"])]))}}}),[["__scopeId","data-v-09397dde"]]),Ce={class:"is-flex",style:{"justify-content":"end"}},we={class:"item-name dark-inverted"},je={class:"light-text"},Ie={class:"light-text"},Te={class:"light-text"},Ve=n({__name:"CataLogList",setup(e){U(),O();const l=B();K();const a=u(""),t=u([]);u([]);const s=u(!1),o=u(""),n=u(0),r=u(""),c=u("catalog"),T=[{label:"Title",key:"title"},{label:"Unit",key:"unit"},{label:"Total Price",key:"total_price"},{label:"Cost Type",key:"cost_type"},{label:"Actions",key:"actions"}],P=async()=>{try{const e=await l.get("/api/cost/catalogs/");t.value=e.data}catch(e){console.error("Error fetching catalogs:",e)}},S=d((()=>t.value.filter((e=>e.title.toLowerCase().includes(a.value.toLowerCase())))));return p(P),(e,u)=>{const d=i,p=q,A=V,M=Y,U=J;return m(),v(k,null,[f("div",Ce,[y(d,{icon:"feather:search"},{default:g((()=>[x(f("input",{"onUpdate:modelValue":u[0]||(u[0]=e=>L(a)?a.value=e:null),class:"input custom-text-filter",placeholder:"Search..."},null,512),[[b,w(a)]])])),_:1})]),w(S).length>0?(m(),_(M,{key:0,class:"mt-5",data:w(S),columns:T,rounded:""},{body:g((()=>[y(D,{name:"list",tag:"div",class:"flex-list-inner"},{default:g((()=>[(m(!0),v(k,null,C(w(S),(e=>(m(),v("div",{key:e.id,class:"flex-table-item"},[y(p,{column:{media:!0,grow:!1},class:"cu-pointer"},{default:g((()=>[f("div",null,[f("span",we,I(e.title),1)])])),_:2},1024),y(p,null,{default:g((()=>[f("span",je,I(e.unit),1)])),_:2},1024),y(p,null,{default:g((()=>[f("span",Ie,I(e.total_price),1)])),_:2},1024),y(p,null,{default:g((()=>[f("span",Te,I(e.cost_type),1)])),_:2},1024),y(p,null,{default:g((()=>[y(A,{color:"primary",size:"medium",light:"",onClick:l=>{return a=e,r.value=a.id,o.value=a.proposal,void(s.value=!s.value);var a},icon:"fas fa-pen"},{default:g((()=>[h("Edit")])),_:2},1032,["onClick"]),y(A,{class:"ml-2",color:"danger",size:"medium",light:"",onClick:a=>(async e=>{try{await l.delete(`/api/cost/${e}/`),t.value=t.value.filter((l=>l.id!==e))}catch(a){console.error("Error deleting catalog:",a)}})(e.id),icon:"fas fa-trash-alt"},{default:g((()=>[h("Delete")])),_:2},1032,["onClick"])])),_:2},1024)])))),128))])),_:1})])),_:1},8,["data"])):j("",!0),w(s)?(m(),_(U,{key:1,costItemModal:w(s),proposalId:w(o),costItemId:w(r),previousItemIndex:w(n),costMode:w(c),"onUpdate:modalHandler":u[1]||(u[1]=e=>{s.value=!1,r.value=""}),"onUpdate:OnSuccess":P},null,8,["costItemModal","proposalId","costItemId","previousItemIndex","costMode"])):j("",!0)],64)}}}),Pe={class:"flex-toolbar is-reversed is-flex space-between my-4"},Se={key:0},Ae={key:1,class:"flex-list-wrapper flex-list-v2"},Me={class:"item-name dark-inverted"},Ue={class:"item-meta"},Oe=["innerHTML"],Le={class:"light-text"},De={class:"item-name dark-inverted"},Ee={class:"light-text"},Fe={class:"item-name dark-inverted"},He={class:"light-text"},$e=["onClick"],Be=[f("div",{class:"icon"},[f("i",{"aria-hidden":"true",class:"lnil lnil-pencil"})],-1),f("div",{class:"meta"},[f("span",null,"Edit"),f("span",null,"Edit Proposal Details")],-1)],Ke=["onClick"],Re=[f("div",{class:"icon"},[f("i",{"aria-hidden":"true",class:"lnil lnil-eye"})],-1),f("div",{class:"meta"},[f("span",null,"Preview"),f("span",null,"Preview proposal detail")],-1)],We=f("hr",{class:"dropdown-divider"},null,-1),ze=["onClick"],Ne=[f("div",{class:"icon"},[f("i",{class:"lnir lnir-round-box-check","aria-hidden":"true"})],-1),f("div",{class:"meta"},[f("span",null,"Mark Approved"),f("span",null,"Mark Proposal As Approved")],-1)],Je=["onClick"],Qe=[f("div",{class:"icon"},[f("i",{"aria-hidden":"true",class:"lnil lnil-trash-can-alt"})],-1),f("div",{class:"meta"},[f("span",null,"Delete"),f("span",null,"Delete from list")],-1)],Xe=f("img",{class:"light-image",src:ie,alt:""},null,-1),Ye=f("img",{class:"dark-image",src:ne,alt:""},null,-1),qe=n({__name:"TemplatePropsalsList",props:{activeTab:{default:"active"},leadId:{default:""},allProposal:{type:Boolean,default:!1}},setup(e){const l=e,a=U();O();const t=B(),s=K(),o=u(!1),n=u([]),r=u(!1),c=u(""),T=u(!1),P=u(!1),S=u(""),A=u("");u(l.activeTab);const M=u({title:"",subtitle:"test",isSweetAlertOpen:!1,btntext:"text"}),E=u({title:"",subtitle:"",isSweetAlertOpen:!1,btntext:""}),F=async()=>{try{o.value=!0;await t.delete(`/api/lead-proposal/${A.value}/`);s.success("Proposal delete successfully"),ue()}catch(e){s.error(` ${e}, Proposal`),s.error("Something went wrong please try later")}finally{o.value=!1,M.value.isSweetAlertOpen=!1}},H={picture:{label:"Proposal",grow:!0,media:!0},deadline:"Cost Items",amount:{label:"Total Amount",media:!0},customer:"Created At",actions:{label:"Actions",align:"end"}},$=d((()=>{if(S.value){const e=new RegExp(S.value,"i");return n.value.filter((l=>l.title.match(e)||l.approval_deadline.match(e)))}return n.value})),R=u(!1),W=u(!1),ie=u(!1),ne=u(""),re=e=>{a.push(`/sidebar/dashboard/proposals/${e}`)},ue=()=>{(async()=>{try{o.value=!0;const e=await t.get("/api/lead-proposal/templates/");n.value=e.data}catch(e){s.error(` ${e}, Lead`)}finally{o.value=!1}})()};return p((()=>{ue()})),(e,a)=>{const u=i,d=V,p=oe,U=q,O=se,B=te,K=Y,ce=ae,de=le,pe=Q,me=X,_e=G,ve=J,fe=ee,ye=Z;return m(),v("div",null,[f("div",Pe,[y(u,{icon:"feather:search"},{default:g((()=>[x(f("input",{"onUpdate:modelValue":a[0]||(a[0]=e=>L(S)?S.value=e:null),class:"input custom-text-filter",placeholder:"Search..."},null,512),[[b,w(S)]])])),_:1}),f("div",null,[y(d,{color:"primary",onClick:a[1]||(a[1]=e=>r.value=!w(r)),icon:"fas fa-plus"},{default:g((()=>[h("Template ")])),_:1})])]),w(o)?(m(),v("div",Se,[y(p)])):(m(),v("div",Ae,[w($).length>0&&w(n).length>0?(m(),_(K,{key:0,data:w($),columns:H,rounded:""},{body:g((()=>[y(D,{name:"list",tag:"div",class:"flex-list-inner"},{default:g((()=>[(m(!0),v(k,null,C(w($),(e=>(m(),v("div",{key:e.id,class:"flex-table-item"},[y(U,{column:{media:!0,grow:!0},class:"cu-pointer",onClick:l=>re(e.id)},{default:g((()=>[f("div",null,[f("span",Me,I(e.title),1),f("span",Ue,[f("span",{innerHTML:e.introductory_text},null,8,Oe)])])])),_:2},1032,["onClick"]),y(U,{class:"cu-pointer",onClick:l=>re(e.id)},{default:g((()=>[f("span",Le,I(),1),y(O,{rounded:"",color:"primary",label:e.cost_items},null,8,["label"])])),_:2},1032,["onClick"]),y(U,{class:"cu-pointer",onClick:l=>re(e.id),column:{media:!0}},{default:g((()=>[f("div",null,[f("span",De,"$"+I(e.proposalAmount),1),f("span",Ee,I(e.payment_status),1)])])),_:2},1032,["onClick"]),y(U,{column:{media:!0},class:"cu-pointer",onClick:l=>re(e.id)},{default:g((()=>[f("div",null,[f("span",Fe,I(w(z)(e.created_at)),1),f("span",He,I(w(N)(e.created_at)),1)])])),_:2},1032,["onClick"]),y(U,{column:{align:"end"}},{default:g((()=>[y(B,{class:"is-pushed-mobile",icon:"feather:more-vertical",spaced:"",right:""},{content:g((()=>[f("a",{role:"menuitem",onClick:l=>{return a=e.id,c.value=a,void(r.value=!0);var a},class:"dropdown-item is-media"},Be,8,$e),f("a",{disabled:"",role:"menuitem",onClick:l=>{return a=e.id,W.value=a,void(R.value=!R.value);var a},class:"dropdown-item is-media"},Re,8,Ke),We,f("a",{role:"menuitem",onClick:l=>(async(e,l)=>{try{await t.patch(`/api/lead-proposal/${l}/`,{status:e}),s.success(`You have ${e} this proposal.`),ue()}catch(a){console.log(a)}})("approved",e.id),class:"dropdown-item is-media"},Ne,8,ze),f("a",{role:"menuitem",onClick:l=>{return a=e.id,A.value=a,void(M.value={title:"Delete Proposal?",subtitle:"Are you sure to delete this proposal? After delete you will not be able to recover it again.",btntext:"Yes delete",isSweetAlertOpen:!0});var a},class:"dropdown-item is-media"},Qe,8,Je)])),_:2},1024)])),_:2},1024)])))),128))])),_:1})])),_:1},8,["data"])):j("",!0),w(n).length<1&&0==w($).length?(m(),_(ce,{key:1,title:"There is no proposal created on this lead!",subtitle:"Too bad. Looks like we couldn't created any proposal on this Lead, please create proposal and release to the client",larger:""},{image:g((()=>[Xe,Ye])),_:1})):j("",!0),w($).length>5?(m(),_(de,{key:2,"item-per-page":10,"total-items":873,"current-page":42,"max-links-displayed":7})):j("",!0)])),w(T)?(m(),_(pe,{key:2,createProposalTasksModal:w(T),proposalId:w(c),onCloseModalHandler:a[2]||(a[2]=e=>T.value=!1),"onUpdate:OnSuccess":ue},null,8,["createProposalTasksModal","proposalId"])):j("",!0),w(r)?(m(),_(me,{key:3,leadId:l.leadId,proposalId:w(c),createTemplate:!0,leadProposalModal:w(r),"onUpdate:modalHandler":a[3]||(a[3]=e=>{r.value=!1,ue()}),"onUpdate:OnSuccess":ue,onClearProposalId:a[4]||(a[4]=e=>c.value="")},null,8,["leadId","proposalId","leadProposalModal"])):j("",!0),w(R)?(m(),_(_e,{key:4,"preview-modal":w(R),proposalId:w(W),"onUpdate:modalHandler":a[5]||(a[5]=e=>R.value=!1)},null,8,["preview-modal","proposalId"])):j("",!0),w(ie)?(m(),_(ve,{key:5,costItemModal:w(ie),proposalId:w(ne),"onUpdate:modalHandler":a[6]||(a[6]=e=>ie.value=!1),"onUpdate:OnSuccess":ue},null,8,["costItemModal","proposalId"])):j("",!0),w(M).isSweetAlertOpen?(m(),_(fe,{key:6,isSweetAlertOpen:w(M).isSweetAlertOpen,title:w(M).title,subtitle:w(M).subtitle,btntext:w(M).btntext,onConfirm:F,onCancel:()=>w(M).isSweetAlertOpen=!1},null,8,["isSweetAlertOpen","title","subtitle","btntext","onCancel"])):j("",!0),w(E).isSweetAlertOpen?(m(),_(fe,{key:7,isSweetAlertOpen:w(E).isSweetAlertOpen,title:w(E).title,subtitle:w(E).subtitle,btntext:w(E).btntext,onConfirm:F,onCancel:()=>w(E).isSweetAlertOpen=!1},null,8,["isSweetAlertOpen","title","subtitle","btntext","onCancel"])):j("",!0),w(P)?(m(),_(ye,{key:8,leadProposalListModal:w(P),leadID:l.leadId,"group-proposal-modal":w(P),"onUpdate:modalHandler":a[7]||(a[7]=e=>P.value=!1)},null,8,["leadProposalListModal","leadID","group-proposal-modal"])):j("",!0)])}}}),Ge={class:"tabs-wrapper"},Ze={class:"tabs-inner"},el={class:"tabs"},ll=[f("span",null,"Proposal Templates",-1)],al=[f("span",null,"Cost Catalogs",-1)],tl=[f("span",null,"Calculations Template",-1)],sl={key:0,class:""},ol={key:1,class:""},il={key:2,class:""},nl=n({__name:"index",setup(e){const l=re(),a=u("proposalsTemplates");return l.setPageTitle("Templates & Catalogs"),E({title:"Templates & Catalogs - Ibex"}),(e,l)=>{const t=qe,s=Ve,o=ke;return m(),v("div",null,[f("div",Ge,[f("div",Ze,[f("div",el,[f("ul",null,[f("li",{class:F(["proposalsTemplates"===w(a)?"is-active":"not-active"])},[f("a",{tabindex:"0",role:"button",onKeydown:l[0]||(l[0]=H(T((e=>a.value="proposalsTemplates"),["prevent"]),["space"])),onClick:l[1]||(l[1]=e=>a.value="proposalsTemplates")},ll,32)],2),f("li",{class:F(["catalog"===w(a)?"is-active":"not-active"])},[f("a",{tabindex:"0",role:"button",onKeydown:l[2]||(l[2]=H(T((e=>a.value="catalog"),["prevent"]),["space"])),onClick:l[3]||(l[3]=e=>a.value="catalog")},al,32)],2),f("li",{class:F(["calculations"===w(a)?"is-active":"not-active"])},[f("a",{tabindex:"0",role:"button",onKeydown:l[4]||(l[4]=H(T((e=>a.value="calculations"),["prevent"]),["space"])),onClick:l[5]||(l[5]=e=>a.value="calculations")},tl,32)],2)])])])]),"proposalsTemplates"===w(a)?(m(),v("div",sl,[y(t)])):j("",!0),"catalog"===w(a)?(m(),v("div",ol,[y(s)])):j("",!0),"calculations"===w(a)?(m(),v("div",il,[y(o)])):j("",!0)])}}});export{nl as default};
