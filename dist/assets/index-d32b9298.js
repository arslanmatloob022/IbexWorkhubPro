import{_ as e}from"./CreateProposalTasksModal-7c7276b8.js";import{_ as a}from"./SweetAlert.vue_vue_type_style_index_0_lang-694f4f5c.js";import{_ as l}from"./LeadAddUpdateModal.vue_vue_type_style_index_0_lang-39070af7.js";import{_ as t}from"./VFlexPagination.vue_vue_type_script_setup_true_lang-ecf55c35.js";import{_ as s,c as n}from"./VFlexTable.vue_vue_type_style_index_0_lang-66aa0732.js";import{_ as i}from"./VDropdown.vue_vue_type_style_index_0_lang-005157a7.js";import{_ as o}from"./VAvatar.vue_vue_type_style_index_0_lang-9690dec4.js";import{_ as r}from"./VTag.vue_vue_type_style_index_0_lang-e95af7d6.js";import{_ as u}from"./VPlaceholderPage.vue_vue_type_style_index_0_lang-566a44c3.js";import{f as d,r as c,x as p,y as _,$ as m,o as v,av as f,C as y,D as g,m as b,O as h,E as j,F as k,G as x,L as w,X as C,k as V,K as A,V as S,W as L,N as I,aS as P,P as O,al as U,U as $,J as M,A as T}from"./index-99e15d25.js";import{_ as N,a as D}from"./VOption.vue_vue_type_style_index_0_lang-9bcebb03.js";import{_ as F}from"./VField.vue_vue_type_script_setup_true_lang-0a6f32d2.js";import{_ as W}from"./VControl-d58d6ce6.js";import{_ as q}from"./PlaceloadV1.vue_vue_type_style_index_0_lang-3972c039.js";import{_ as E,a as H}from"./search-4-dark-2b5b440c.js";import{u as J}from"./useAPI-c55c1b44.js";import{u as Z}from"./useNotyf-b5c4c6a6.js";import{d as z,i as B}from"./useSupportElement-dd6ff5a3.js";import{f as R,h as G}from"./estimatesScripts-43ca9e77.js";import{u as K}from"./viewWrapper-f7e223f8.js";import{b as X}from"./route-block-83d24a4e.js";import"./VModal.vue_vue_type_style_index_0_lang-4e1acbcc.js";import"./VRadio.vue_vue_type_style_index_0_lang-bad19ce8.js";import"./VLabel.vue_vue_type_script_setup_true_lang-0d8baa39.js";import"./useVFieldContext-c40a6a91.js";import"./UnitAddUpdateModal.vue_vue_type_script_setup_true_lang-18e0736e.js";import"./VTextarea.vue_vue_type_script_setup_true_lang-646ee24f.js";import"./VCheckbox.vue_vue_type_style_index_0_lang-b94018db.js";import"./VInput.vue_vue_type_script_setup_true_lang-1069e5b5.js";import"./costItems-bbbb123a.js";import"./VIconButton-11100a3f.js";import"./company-7785ffb1.js";import"./LeadProposalsList.vue_vue_type_style_index_0_lang-7f11bff4.js";import"./ProposalViewModal.vue_vue_type_style_index_0_lang-933aad61.js";import"./V-Snack.vue_vue_type_style_index_0_lang-6994e0c2.js";import"./VIcon.vue_vue_type_script_setup_true_lang-85af6c15.js";import"./VSwitchBlock.vue_vue_type_style_index_0_lang-7659fadc.js";import"./ScheduleEmailModal.vue_vue_type_script_setup_true_lang-8a94bc3b.js";import"./ckeditor-2270b0bf.js";import"./vue.runtime.esm-bundler-a5bd3ba1.js";import"./ckeditor-91af55b4.js";import"./VFlex.vue_vue_type_style_index_0_lang-4d46da06.js";import"./useDropdown-19db524c.js";import"./VPlaceloadWrap-154df3c1.js";import"./VPlaceloadText.vue_vue_type_style_index_0_lang-a7e06dff.js";import"./VPlaceloadAvatar.vue_vue_type_style_index_0_lang-5c82d083.js";import"./notyf-4c2a0882.js";import"./useThemeColors-a20eef99.js";const Q={key:1},Y={class:"list-flex-toolbar flex-list-v1"},ee={class:"page-content-inner"},ae={class:"flex-list-wrapper flex-list-v1"},le=j("img",{class:"light-image",src:E,alt:""},null,-1),te=j("img",{class:"dark-image",src:H,alt:""},null,-1),se={class:"item-name dark-inverted show-text-200"},ne={class:"item-meta show-text-200"},ie={key:0},oe={class:"item-name dark-inverted"},re={class:"item-meta"},ue={key:1},de={class:"item-name dark-inverted"},ce={class:"item-meta"},pe={class:"item-name dark-inverted"},_e={class:"item-meta"},me=["onClick"],ve=[j("div",{class:"icon"},[j("i",{"aria-hidden":"true",class:"lnil lnil-eye"})],-1),j("div",{class:"meta"},[j("span",null,"View"),j("span",null,"View user details")],-1)],fe=["onClick"],ye=[j("div",{class:"icon"},[j("i",{class:"lnil lnil-copy","aria-hidden":"true"})],-1),j("div",{class:"meta"},[j("span",null,"Add Proposals"),j("span",null,"Add new proposal to lead")],-1)],ge=["onClick"],be=[j("div",{class:"icon"},[j("i",{"aria-hidden":"true",class:"lnil lnil-pencil"})],-1),j("div",{class:"meta"},[j("span",null,"Edit"),j("span",null,"Update Lead Info")],-1)],he=j("hr",{class:"dropdown-divider"},null,-1),je=["onClick"],ke=[j("div",{class:"icon"},[j("i",{class:"lnil lnil-checkmark","aria-hidden":"true"})],-1),j("div",{class:"meta"},[j("span",null,"Mark As Done"),j("span",null,"Mark Job As Completed")],-1)],xe=["onClick"],we=[j("div",{class:"icon"},[j("i",{"aria-hidden":"true",class:"lnil lnil-trash-can-alt"})],-1),j("div",{class:"meta"},[j("span",null,"Delete"),j("span",null,"Delete Proposal Permanently")],-1)],Ce=d({__name:"LeadsList",setup(d){const T=c(""),E=p(),H=Z(),K=J(),X=c(),Ce=c([{id:"54985a54-db61-4761-becd-3b35f8ec503e",sales_people_info:[],clientInfo:null,created_by_info:null,manager_info:null,title:"test job",address:null,current_state:"lead",city:null,state:null,status:null,zip_code:null,confidence:"0.00",sale_date:null,tags:[],estimated_from:null,estimated_to:null,sources:null,project_type:null,notes:null,attach_mail:null,created:"2025-01-15T19:55:18.448485Z",updated_at:"2025-01-15T19:55:18.448510Z",created_by:null,manager:null,client:null,sales_people:[]}]);c(1);const Ve=c(20),Ae=c(""),Se=_(),Le=c(""),Ie=c(!1),Pe=c(!1),Oe=c([{value:"open",label:"Open"},{value:"sold",label:"Sold"},{value:"lost",label:"Lost"},{value:"onHold",label:"On hold"}]),Ue={location:{label:"Job",grow:!0},username:{label:"Contractor/Client",grow:!0},contacts:"Date Created",status:"Lead Status",industry:"Manager",actions:{label:"Actions",align:"end"}},$e=async()=>{try{X.value=!0;const e=await K.get("/api/project/project-leads/");Ce.value=e.data}catch(e){H.error(` ${e}, Lead`)}finally{X.value=!1}},Me=e=>{T.value=e,Pe.value=!0},Te=c({title:"",subtitle:"test",isSweetAlertOpen:!1,btntext:"text"}),Ne=c(!1),De=async()=>{try{X.value=!0;await K.delete(`/api/project/${T.value}/`);H.info("Lead deleted successfully"),$e()}catch(e){H.error(` ${e}, Lead`),H.error("Something went wrong please try later")}finally{X.value=!1,Te.value.isSweetAlertOpen=!1}},Fe=m((()=>{let e=Se.query.page;return e=null==e||"undefined"==e?1:Se.query.page,Number.parseInt(Se.query.page)||1})),We=m((()=>{if(Ae.value){const e=new RegExp(Ae.value,"i");return Ce.value.filter((a=>a.title?.match(e)||a.address?.match(e)||a.clientInfo?.username?.match(e)||a.clientInfo?.last_name?.match(e)||a.clientInfo?.username?.match(e)||a.city?.match(e)||a.created?.match(e)))}return Ce.value})),qe=m((()=>Le.value?We.value?.filter((e=>e.leadStatus==Le.value)):We.value)),Ee=m((()=>{const e=(Fe.value-1)*Ve.value,a=e+Ve.value;return qe.value.slice(e,a)}));return v((()=>{$e()})),(d,c)=>{const p=q,_=W,m=F,v=N,J=D,Z=O,Se=U,We=u,He=n,Je=r,Ze=o,ze=i,Be=s,Re=t,Ge=l,Ke=a,Xe=e,Qe=f("tooltip");return y(),g("div",null,[b(X)?(y(),h(p,{key:0})):(y(),g("div",Q,[j("div",Y,[k(m,null,{default:x((()=>[k(_,{icon:"feather:search"},{default:x((()=>[w(j("input",{"onUpdate:modelValue":c[0]||(c[0]=e=>V(Ae)?Ae.value=e:null),class:"input custom-text-filter",placeholder:"Search..."},null,512),[[C,b(Ae)]])])),_:1})])),_:1}),k(m,null,{default:x((()=>[k(_,{class:"has-icons-left",icon:"fas fa-globe"},{default:x((()=>[k(J,{modelValue:b(Le),"onUpdate:modelValue":c[1]||(c[1]=e=>V(Le)?Le.value=e:null)},{default:x((()=>[k(v,{value:""},{default:x((()=>[A(" All ")])),_:1}),(y(!0),g(S,null,L(b(Oe),(e=>(y(),h(v,{value:e.value},{default:x((()=>[A($(e.label),1)])),_:2},1032,["value"])))),256))])),_:1},8,["modelValue"])])),_:1})])),_:1}),k(Se,null,{default:x((()=>[k(Z,{onClick:c[2]||(c[2]=e=>Me("")),color:"primary",icon:"fas fa-plus",elevated:""},{default:x((()=>[A(" Lead Opportunity ")])),_:1})])),_:1})]),j("div",ee,[j("div",ae,[b(qe)?.length?I("",!0):(y(),h(We,{key:0,title:"We couldn't find any matching results.",subtitle:"Too bad. Looks like we couldn't find any matching results for the\n          search terms you've entered. Please try different search terms or\n          criteria.",larger:""},{image:x((()=>[le,te])),_:1})),b(Ee)?.length?(y(),h(Be,{key:1,data:b(Ee),columns:Ue,compact:""},{body:x((()=>[k(P,{name:"list",tag:"div",class:"flex-list-inner"},{default:x((()=>[(y(!0),g(S,null,L(b(Ee),(e=>(y(),g("div",{key:e.id,class:"flex-table-item"},[k(He,{onClick:()=>{b(E).push(`/sidebar/dashboard/jobs/${e.id}`)},class:"cu-pointer",column:{media:!0,grow:!0}},{default:x((()=>[j("div",null,[j("span",se,$(e.title?e.title:"N/A"),1),j("span",ne,[j("span",null,$(e.address?e.address:"N/A"),1)])])])),_:2},1032,["onClick"]),k(He,{onClick:()=>{b(E).push(`/sidebar/dashboard/jobs/${e.id}`)},class:"cu-pointer",column:{media:!0,grow:!0}},{default:x((()=>[e.clientInfo?(y(),g("div",ie,[j("span",oe,$(e.clientInfo?.username?e.clientInfo?.username:"N/A"),1),j("span",re,[j("span",null,$(e.clientInfo?.email?e.clientInfo?.email:"N/A"),1)])])):e.contractor_info?(y(),g("div",ue,[j("span",de,$(e.contractor_info?.username?e.contractor_info?.username:"N/A"),1),j("span",ce,[j("span",null,$(e.contractor_info?.email?e.contractor_info?.email:"N/A"),1)])])):I("",!0)])),_:2},1032,["onClick"]),k(He,{onClick:()=>{b(E).push(`/sidebar/dashboard/jobs/${e.id}`)},class:"cu-pointer",column:{media:!0}},{default:x((()=>[j("div",null,[j("span",pe,$(b(z)(e.created)),1),j("span",_e,[j("span",null,"At:"+$(b(B)(e.created)),1)])])])),_:2},1032,["onClick"]),k(He,{onClick:()=>{b(E).push(`/sidebar/dashboard/jobs/${e.id}`)},class:"cu-pointer"},{default:x((()=>[k(Je,{color:b(R)[e.leadStatus],rounded:""},{default:x((()=>[A($(b(G)[e.leadStatus]),1)])),_:2},1032,["color"])])),_:2},1032,["onClick"]),k(He,{onClick:()=>{b(E).push(`/sidebar/dashboard/jobs/${e.id}`)},class:"cu-pointer",column:{media:!0}},{default:x((()=>[j("div",null,[(y(!0),g(S,null,L(e.managers_list,(e=>w((y(),h(Ze,{initials:e.username.slice(0,2),picture:e.avatar,color:"primary",size:"small"},null,8,["initials","picture"])),[[Qe,`${e.username} ${e.last_name??""}`,void 0,{center:!0,primary:!0,rounded:!0}]]))),256))])])),_:2},1032,["onClick"]),k(He,{column:{align:"end"}},{default:x((()=>[k(ze,{icon:"feather:more-vertical",class:"is-pushed-mobile",spaced:"",right:""},{content:x((({close:a})=>[j("a",{role:"menuitem",class:"dropdown-item is-media",onClick:()=>{b(E).push(`/sidebar/dashboard/jobs/${e.id}`)}},ve,8,me),j("a",{role:"menuitem",onClick:a=>{return l=e.id,T.value=l,void(Ie.value=!Ie.value);var l},class:"dropdown-item is-media"},ye,8,fe),j("a",{role:"menuitem",class:"dropdown-item is-media",onClick:M((a=>Me(e.id)),["prevent"])},be,8,ge),he,j("a",{role:"menuitem",onClick:a=>(async(e="")=>{try{Ne.value=!0,await K.patch(`/api/project/${e}/`,{status:"completed"}),H.success("Jobs Completed Successfully."),$e()}catch(a){console.log(a)}finally{Ne.value=!1}})(e.id),class:"dropdown-item is-media"},ke,8,je),j("a",{role:"menuitem",class:"dropdown-item is-media",onClick:M((a=>{return l=e.id,T.value=l,void(Te.value={title:"Delete Lead?",subtitle:"Are you sure to delete this Lead? After delete you will not be able to recover it again.",btntext:"Delete",isSweetAlertOpen:!0});var l}),["prevent"])},we,8,xe)])),_:2},1024)])),_:2},1024)])))),128))])),_:1})])),_:1},8,["data"])):I("",!0),b(Ce)?.length>b(Ve)?(y(),h(Re,{key:2,"item-per-page":b(Ve),modelValue:b(Fe),"onUpdate:modelValue":c[3]||(c[3]=e=>V(Fe)?Fe.value=e:null),"total-items":b(Ce).length,"current-page":b(Fe),"max-links-displayed":7},null,8,["item-per-page","modelValue","total-items","current-page"])):I("",!0)])])])),b(Pe)?(y(),h(Ge,{key:2,addUpdateLeadModal:b(Pe),leadId:b(T),"onUpdate:modalHandler":c[4]||(c[4]=e=>Pe.value=!1),"onUpdate:OnSuccess":$e},null,8,["addUpdateLeadModal","leadId"])):I("",!0),b(Te).isSweetAlertOpen?(y(),h(Ke,{key:3,isSweetAlertOpen:b(Te).isSweetAlertOpen,title:b(Te).title,subtitle:b(Te).subtitle,loading:b(X),btntext:b(Te).btntext,onConfirm:De,onCancel:()=>b(Te).isSweetAlertOpen=!1},null,8,["isSweetAlertOpen","title","subtitle","loading","btntext","onCancel"])):I("",!0),b(Ie)?(y(),h(Xe,{key:4,"lead-proposal-modal":b(Ie),"lead-id":b(T),"onUpdate:modalHandler":c[5]||(c[5]=e=>Ie.value=!1),"onUpdate:OnSuccess":$e},null,8,["lead-proposal-modal","lead-id"])):I("",!0)])}}}),Ve=d({__name:"index",setup:e=>(K().setPageTitle("Leads"),T({title:"Leads - Ibex"}),(e,a)=>{const l=Ce;return y(),g("div",null,[k(l)])})});"function"==typeof X&&X(Ve);export{Ve as default};
