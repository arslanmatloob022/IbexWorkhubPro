import{_ as e}from"./VField.vue_vue_type_script_setup_true_lang-1707e593.js";import{_ as t}from"./VControl-34d13635.js";import{_ as s}from"./VInput.vue_vue_type_script_setup_true_lang-c821f083.js";import{e as a,r as o,o as r,B as l,C as n,D as i,E as u,F as c,l as p,j as d,I as m,T as v,R as f,z as _,N as h,al as j}from"./index-d5d6981c.js";import{F as y}from"./FullCalendar-78a8be59.js";import{i as g}from"./index-55eb4335.js";import{i as b}from"./index-66b17547.js";import{u as w}from"./userSession-c40b60f4.js";import{u as k}from"./useNotyf-6fa9b8a5.js";import{u as x}from"./useAPI-b5df5dfa.js";import{u as I}from"./viewWrapper-1f318198.js";import{b as C}from"./route-block-83d24a4e.js";import"./VLabel.vue_vue_type_script_setup_true_lang-d6eca460.js";import"./useVFieldContext-52b8b614.js";import"./notyf-491c3470.js";import"./useThemeColors-9c738c32.js";const T=["onSubmit"],V={class:"datatable-toolbar"},W={style:{display:"flex","flex-wrap":"wrap","align-items":"center","justify-content":"space-between"}},D={style:{"font-weight":"500","margin-bottom":"0px","padding-left":"10px"}},F=f(a({__name:"ProjectWorkerCalendar",setup(a){const f=x();w(),k();const _=o(!1);o(!1),o(""),o(!1),o("all");const h=o(""),j=o([]);o([]);const I=o([]);o(0),o(""),o("");const C=o(0),F=o(!0);o(!1),o(0),o({all:"all",active:"active",pending:"pending",completed:"completed"});const S=o({pending:"#8392ab",active:"#fbcf33",completed:"#82d616",canceled:"#344767"}),E=o({plugins:[g,b],schedulerLicenseKey:"0965592368-fcs-1694657447",initialView:"resourceTimelineMonth",height:"auto",themeSystem:"cerulean",resourceAreaWidth:"20%",resourceGroupField:"title",resourcesInitiallyExpanded:!1,selectable:!0,headerToolbar:{left:"today prev,next",center:"title",right:"resourceTimelineWeek,resourceTimelineMonth,resourceTimelineYear"},editable:!0,views:{resourceTimelineWeek:{slotDuration:{days:1,hours:1},slotLabelFormat:{weekday:"short",month:"numeric",day:"numeric",year:"numeric"}}},resourceAreaHeaderContent:"Workers",resources:[],resourceId:C.value}),L=e=>{let t=new Date(e);return t.setDate(t.getDate()+1),t.toISOString().slice(0,10)},P=()=>{let e=[],t=[];t=h.value?A.value.filter((e=>e.username.toLowerCase().includes(h.value.toLowerCase()))):A.value,t.forEach((t=>{e.push({id:t.id,title:t.username})})),E.value.resources=e},A=o([]),M=async()=>{try{_.value=!0,console.log("inside all projects func");const e=await f.get("/api/users/by-role/worker/",{});A.value=e.data,_.value=!1}catch(e){console.error(e),A.value=[],_.value=!1}},N=async()=>{try{const e=await f.get("/api/task/all-tasks/",{});j.value=e.data}catch(e){j.value=[]}};return r((async()=>{await Promise.all([M(),N()]),(()=>{console.log(I.value);const e=[],t=[];A.value.forEach((s=>{j.value.forEach((t=>{t.workers.includes(s.id)&&e.push({id:t.id,resourceId:s.id,project:t.project,start:t.startDate,end:L(t.endDate),title:t.title,color:t.color,description:t.description,borderColor:S[t.status],projectInfo:t.projectInfo})})),t.push({id:s.id,title:s.username})})),E.value.resources=t,E.value.events=[...e]})(),console.log("projects",E.value),F.value=!0})),(a,o)=>{const r=s,f=t,_=e;return l(),n("div",null,[i("form",{onSubmit:m(P,["prevent"])},[i("div",V,[u(_,{elevated:""},{default:c((()=>[u(f,{icon:"fas fa-search"},{default:c((()=>[u(r,{type:"text",placeholder:"Search worker...",modelValue:p(h),"onUpdate:modelValue":o[0]||(o[0]=e=>d(h)?h.value=e:null),onInput:o[1]||(o[1]=e=>P()),class:""},null,8,["modelValue"])])),_:1})])),_:1})])],40,T),u(p(y),{options:p(E)},{eventContent:c((e=>[i("div",W,[i("p",D," ("+v(e.event.extendedProps.projectInfo.title)+") "+v(e.event.title),1)])])),_:1},8,["options"])])}}}),[["__scopeId","data-v-bb268ff5"]]),S={class:"page-content-inner"},E=i("div",{class:"lifestyle-dashboard-bg has-top-nav"},null,-1),L=a({__name:"index",setup:e=>(I().setPageTitle("Workers Tasks"),_({title:"Workers tasks"}),(e,t)=>{const s=F;return l(),n("div",S,[(l(),h(j,{to:"[data-teleport-bg]"},[E])),u(s)])})});"function"==typeof C&&C(L);export{L as default};
