import{_ as e}from"./VInput.vue_vue_type_script_setup_true_lang-e35048cd.js";import{e as a,r as s,o as l,M as t,y as n,z as o,C as i,A as c,B as r,l as p,J as u,S as d,T as m,D as v,E as y,v as _,H as f,ak as h}from"./index-0be7d825.js";import{_ as b}from"./VTextarea.vue_vue_type_script_setup_true_lang-b1bf4af1.js";import{_ as g}from"./VField.vue_vue_type_script_setup_true_lang-aa0edb62.js";import{_ as k}from"./VControl-730c576e.js";import{_ as x}from"./VAvatar.vue_vue_type_style_index_0_lang-2c6bcd74.js";import{u as C}from"./useAPI-4f36037c.js";import{u as V}from"./incomeHistoryChart-80812184.js";import{u as w}from"./useNotyf-8f2dd69a.js";import{u as j}from"./viewWrapper-5b8f25b4.js";import"./useVFieldContext-fbc12d9c.js";import"./VLabel.vue_vue_type_script_setup_true_lang-0f170a89.js";import"./userSession-56f5c36a.js";import"./useThemeColors-ca687f1c.js";import"./notyf-69250ce7.js";const P={class:"banking-dashboard banking-dashboard-v1"},A={class:"columns is-multiline"},T={class:"column is-12"},D={class:"columns is-multiline"},I={class:"column is-6"},B={class:"dashboard-card is-contacts"},S=i("div",{class:"title-wrap"},[i("h3",{class:"dark-inverted"},"Create link")],-1),E=i("div",{class:"people-wrap"},[i("div",{class:"actions"},[i("span",null,"Clients")])],-1),M={class:"transfer-form"},U={class:"multiselect-single-label"},z={class:"select-label-text"},F={class:"select-label-text"},L={class:"field"},Q=i("label",null,"Amount",-1),X={class:"field has-addons"},Y={class:"field-addon-body"},q=i("div",{class:"control"},[i("span",{class:"select currency-select"},[i("select",null,[i("option",null,"$")])])],-1),G={class:"control is-expanded"},H={class:"field"},N=i("label",null,"Description",-1),R=i("p",{class:"context-text"}," Please enter amount you want your client to pay with small description. ",-1),J={class:"submit-wrap"},O={class:"column is-6"},W={class:"dashboard-card"},Z=i("div",{class:"title-wrap"},[i("h3",{class:"dark-inverted"},"Payment links")],-1),$={class:"context-text"},K=a({__name:"IbexPaymentModule",setup(a){const _=C(),f=w(),h=s({amount:0,description:"",client:""}),j=s(!1),K=s({payments:[],count:0});s(["default"]);const ee=s([]),ae=s(!1),se=s(!1),le=s({success:!0,msg:"payment link has been successfully created",resp:{id:"PAYID-M4BCCXQ345677503C442360B",intent:"sale",state:"created",payer:{payment_method:"paypal"},transactions:[{amount:{total:"10.00",currency:"USD"},description:"Desc",related_resources:[]}],create_time:"2024-10-06T05:34:22Z",links:[{href:"https://api.sandbox.paypal.com/v1/payments/payment/PAYID-M4BCCXQ345677503C442360B",rel:"self",method:"GET"},{href:"https://www.sandbox.paypal.com/cgi-bin/webscr?cmd=_express-checkout&token=EC-4812231612231625T",rel:"approval_url",method:"REDIRECT"},{href:"https://api.sandbox.paypal.com/v1/payments/payment/PAYID-M4BCCXQ345677503C442360B/execute",rel:"execute",method:"POST"}]}});V(),s(0);const te=e=>{e?navigator.clipboard.writeText(e).then((()=>{f.success("Link copied to clipboard!")})).catch((e=>{f.error("Failed to copy the link: ",e)})):f.error("No link to copy!")},ne=async()=>{try{se.value=!0;const e=await _.post("/api/paypal/create-link/",{amount:h.value.amount,description:h.value.description});le.value=e.data,f.success("link Created")}catch(e){f.success("Something went wrong")}finally{se.value=!1}};return l((()=>{(async()=>{try{ae.value=!0;const e=await _.get("/api/users/by-role/client/",{});ee.value=e.data.map((e=>({value:e.id,name:e.username,icon:e.avatar})))}catch(e){console.log(e)}finally{ae.value=!1}})(),(async()=>{try{j.value=!0;const e=await _.get("/api/paypal/payments/");K.value=e.data}catch(e){console.log(e)}finally{j.value=!1}})()})),(a,s)=>{const l=x,_=t("Multiselect"),f=k,C=g,V=b,w=y,j=e;return n(),o("div",P,[i("div",A,[i("div",T,[i("div",D,[i("div",I,[i("div",B,[S,E,i("div",M,[c(C,{class:"is-image-select has-curved-images"},{default:r((()=>[c(f,null,{default:r((()=>[c(_,{modelValue:p(h).client,"onUpdate:modelValue":s[0]||(s[0]=e=>p(h).client=e),placeholder:"Select a client",label:"name","max-height":145,options:p(ee)},{singlelabel:r((({value:e})=>[i("div",U,[c(l,{class:"select-option-icon",size:"xs",squared:"",picture:e.icon},null,8,["picture"]),i("span",z,u(e.name),1)])])),option:r((({option:e})=>[c(l,{class:"select-option-icon",size:"xs",squared:"",picture:e.icon},null,8,["picture"]),i("span",F,u(e.name),1)])),_:1},8,["modelValue","options"])])),_:1})])),_:1}),i("div",L,[Q,i("div",X,[i("div",Y,[q,i("div",G,[d(i("input",{"onUpdate:modelValue":s[1]||(s[1]=e=>p(h).amount=e),class:"input",type:"number",placeholder:"Amount of money"},null,512),[[m,p(h).amount]])])])])]),i("div",H,[N,c(C,null,{default:r((()=>[c(f,null,{default:r((()=>[c(V,{modelValue:p(h).description,"onUpdate:modelValue":s[2]||(s[2]=e=>p(h).description=e),class:"is-primary-focus",rows:"2",placeholder:"Description..."},null,8,["modelValue"])])),_:1})])),_:1})]),R,i("div",J,[c(w,{onClick:ne,color:"info",size:"big",fullwidth:"",loading:p(se),raised:"",bold:"",icon:"lnir lnir-paypal"},{default:r((()=>[v(" Create Payment link ")])),_:1},8,["loading"])])])])]),i("div",O,[i("div",W,[Z,c(C,{label:"Client link",addons:""},{default:r((()=>[c(f,{expanded:""},{default:r((()=>[c(j,{type:"text",modelValue:p(le).resp.links[1].href,"onUpdate:modelValue":s[3]||(s[3]=e=>p(le).resp.links[1].href=e),class:"input",placeholder:"Approved link..."},null,8,["modelValue"])])),_:1}),c(f,null,{default:r((()=>[c(w,{onClick:s[4]||(s[4]=e=>te(p(le).resp.links[1].href)),class:"cu-pointer",color:"primary",icon:"fas fa-envelope"},{default:r((()=>[v(" Send ")])),_:1})])),_:1})])),_:1}),c(C,{label:"Client link",addons:""},{default:r((()=>[c(f,{expanded:""},{default:r((()=>[c(j,{type:"text",modelValue:p(le).resp.links[1].href,"onUpdate:modelValue":s[5]||(s[5]=e=>p(le).resp.links[1].href=e),class:"input",placeholder:"Approved link..."},null,8,["modelValue"])])),_:1}),c(f,null,{default:r((()=>[c(w,{icon:"fas fa-copy",onClick:s[6]||(s[6]=e=>te(p(le).resp.links[1].href)),class:"cu-pointer",color:"primary"},{default:r((()=>[v(" Copy ")])),_:1})])),_:1})])),_:1}),i("p",$,u(p(le).msg?p(le).msg:"Link not generated yet"),1)])])])])])])}}}),ee={class:"page-content-inner"},ae=i("div",{class:"lifestyle-dashboard-bg has-top-nav"},null,-1),se=a({__name:"index",setup:e=>(j().setPageTitle("Ibex Payment"),_({title:"Ibex Payment"}),(e,a)=>{const s=K;return n(),o("div",ee,[(n(),f(h,{to:"[data-teleport-bg]"},[ae])),c(s,{class:"has-navbar-spacing"})])})});export{se as default};
