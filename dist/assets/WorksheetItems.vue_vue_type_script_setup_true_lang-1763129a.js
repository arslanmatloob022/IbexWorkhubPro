import{e,s as l,r as a,Z as t,b as o,_ as s,o as n,A as i,B as r,N as u,F as d,D as c,E as p,K as _,W as m,l as v,C as f,V as b,U as y,J as h,M as I,j as g,T as w,I as C,O as k,a4 as P,a6 as V,a0 as x,X as D,P as T,Q as S,R as j,i as A,aR as M,H as U,G as O}from"./index-c5eacac6.js";import{_ as E}from"./VModal.vue_vue_type_style_index_0_lang-436e1f89.js";import{_ as F}from"./VInput.vue_vue_type_script_setup_true_lang-714bb8d5.js";import{_ as L}from"./VTextarea.vue_vue_type_script_setup_true_lang-babbbab3.js";import{_ as q}from"./VField.vue_vue_type_script_setup_true_lang-89a1ecaf.js";import{_ as H}from"./VControl-73271265.js";import{a as $,_ as N}from"./VOption.vue_vue_type_style_index_0_lang-669cf2b6.js";import{u as B}from"./useAPI-026ef94e.js";import{u as R}from"./useNotyf-29271abb.js";import{a as z,e as W}from"./useSupportElement-fcd6e19c.js";import{u as J}from"./userSession-333f1640.js";import{_ as G}from"./VAvatar.vue_vue_type_style_index_0_lang-0ceb3dc6.js";import{_ as Q}from"./SweetAlert.vue_vue_type_style_index_0_lang-142709c4.js";import{_ as K}from"./VDropdown.vue_vue_type_style_index_0_lang-82539e0f.js";const Y={class:"modal-form columns is-multiline"},X={class:"columns is-multiline"},Z={class:"field column is-12 mb-0"},ee=c("label",null,"Title: ",-1),le={class:"control"},ae=["disabled"],te={class:"field column is-6"},oe=c("label",{for:""},"Cost Type",-1),se={class:"field column is-3"},ne=c("label",{for:""},"Catalog",-1),ie={class:"field column is-3"},re=c("label",{for:""},"Mark As",-1),ue={class:"field column is-6"},de=c("label",null,"Cost Code *",-1),ce={class:"field column is-6"},pe=c("label",{for:""},"Group Cost",-1),_e={class:"field column is-12 mb-0"},me=c("label",{for:"",class:"label"},"Description",-1),ve={class:"field column is-12 mb-0"},fe=c("label",{for:"",class:"label"},"Internal Notes",-1),be={class:"columns is-multiline"},ye={class:"field column is-6"},he=c("label",null,"Unit Cost",-1),Ie={class:"field column is-6"},ge=c("label",null,"Quantity",-1),we={class:"field column is-6"},Ce=c("label",null,"Unit",-1),ke={class:"field column is-6"},Pe=c("label",null,"Builder Cost",-1),Ve={class:"field column is-6"},xe=c("label",null,"Markup (%)",-1),De={class:"field column is-6"},Te=c("label",null,"Client Price",-1),Se={class:"field column is-6"},je=c("label",null,"Margin (%)",-1),Ae=e({__name:"EstimateCostItemModal",props:{costItemModal:{type:Boolean},proposalId:{},previousItemIndex:{},costItemId:{},previewCostItems:{type:Boolean}},emits:["update:modalHandler","update:OnSuccess"],setup(e,{emit:V}){const x=e,D=l();J();const T=R(),S=B(),j=a(!1);a([]),a([]);const A=a({previousItemIndex:0,index:0,id:"",type:"",total_price:0,cost_code:"",cost_type:"",builder_cost:0,internal_notes:"",mark_as:"",state:"",title:"",description:"",quantity:0,unit:"",unit_cost:0,markup:0,margin:0,profit:0,group:"",proposal:x.proposalId}),M=a([{value:"labour",label:"Labour"},{value:"material",label:"Material"},{value:"equipment",label:"Equipment"},{value:"subcontractor",label:"Subcontractor"},{value:"other",label:"Others"}]),U=a([{value:"11011",label:"Labour"},{value:"11012",label:"Material"},{value:"11013",label:"Equipment"},{value:"11014",label:"Subcontractor"},{value:"11015",label:"Others"}]),O=a([{value:"Tiling",label:"Tiling"},{value:"Material",label:"Material"},{value:"Paint",label:"Paint"},{value:"Carpenter",label:"Carpenter"}]),W=a([{value:"bid",label:"Bid"},{value:"allowance",label:"Allowance"}]);a([{value:"open",label:"Open"},{value:"inProgress",label:"In Progress"},{value:"onHold",label:"On Hold"},{value:"pending",label:"Pending"},{value:"lost",label:"Lost"},{value:"sold",label:"sold"},{value:"noOpportunity",label:"No Opportunity"}]);const G=async()=>{try{j.value=!0;const e=z(A.value,[]);if(x.costItemId){await S.patch(`/api/cost/${x.costItemId}/`,e)}else{await S.post("/api/cost/",e)}Q(),K(),T.success("Item added successfully.")}catch(e){T.error(` ${e}, New Worker`)}finally{j.value=!1}},Q=()=>{V("update:modalHandler",!1)},K=()=>{V("update:OnSuccess",null)};a(0),a(0);const Ae=t((()=>A.value.unit_cost*A.value.quantity));a(0),a(0);const Me=t((()=>A.value.markup>0?Ae.value+Ae.value*A.value.markup/100:A.value.margin>0?Ae.value/(1-A.value.margin/100):Ae.value));t((()=>(Me.value-Ae.value)/Ae.value*100)),t((()=>(Me.value-Ae.value)/Me.value*100));const Ue=o((()=>s((()=>import("./ckeditor-6d8fc3b5.js").then((e=>e.c))),["assets/ckeditor-6d8fc3b5.js","assets/index-c5eacac6.js","assets/index-ce8747cd.css","assets/vue.runtime.esm-bundler-40e3d7c7.js"]).then((e=>e.default.component)))),Oe={fontFamily:{options:['"Montserrat", sans-serif','"Roboto", sans-serif']},height:"400px",minHeight:"400px"},Ee=a(!1),Fe=a(!1);return n((async()=>{D.value=await s((()=>import("./ckeditor-962b993d.js").then((e=>e.c))),["assets/ckeditor-962b993d.js","assets/index-c5eacac6.js","assets/index-ce8747cd.css"]).then((e=>e.default)),x.previousItemIndex&&(A.value.previousItemIndex=x.previousItemIndex),x.costItemId&&(async()=>{try{Ee.value=!0;const e=await S.get(`/api/cost/${x.costItemId}/`);A.value=e.data}catch(e){console.log(e)}finally{Ee.value=!1}})(),(async()=>{try{Fe.value=!0;const e=await S.get("/api/cost-code/");U.value=e.data.map((e=>({value:e.id,label:e.name})))}catch(e){console.log(e)}finally{Fe.value=!1}})()})),(e,l)=>{const a=N,t=$,o=H,s=q,n=k,V=i("Multiselect"),T=L,S=P,B=F,R=E;return r(),u(R,{is:"form",open:x.costItemModal,title:"Cost Item ",size:"xl",actions:"right",onSubmit:C(G,["prevent"]),onClose:Q},{content:d((()=>[c("div",Y,[p(S,{class:"column is-12"},{default:d((()=>[c("div",X,[c("div",Z,[ee,c("div",le,[_(c("input",{type:"text",name:"firstName","onUpdate:modelValue":l[0]||(l[0]=e=>v(A).title=e),required:"",disabled:x.previewCostItems,class:"input is-primary-focus is-primary-focus",placeholder:"Proposal Title"},null,8,ae),[[m,v(A).title]])])]),c("div",te,[oe,p(s,null,{default:d((()=>[p(o,null,{default:d((()=>[p(t,{modelValue:v(A).cost_type,"onUpdate:modelValue":l[1]||(l[1]=e=>v(A).cost_type=e),disabled:x.previewCostItems},{default:d((()=>[(r(!0),f(y,null,b(v(M),((e,l)=>(r(),u(a,{value:e.value},{default:d((()=>[h(w(e.label),1)])),_:2},1032,["value"])))),256))])),_:1},8,["modelValue","disabled"])])),_:1})])),_:1})]),c("div",se,[ne,c("div",null,[p(n,{color:"info",light:"",raised:"",size:"small"},{default:d((()=>[h("Add in Catalog")])),_:1})])]),c("div",ie,[re,p(s,null,{default:d((()=>[p(o,null,{default:d((()=>[p(t,{modelValue:v(A).mark_as,"onUpdate:modelValue":l[2]||(l[2]=e=>v(A).mark_as=e),disabled:x.previewCostItems},{default:d((()=>[(r(!0),f(y,null,b(v(W),((e,l)=>(r(),u(a,{value:e.value},{default:d((()=>[h(w(e.label),1)])),_:2},1032,["value"])))),256))])),_:1},8,["modelValue","disabled"])])),_:1})])),_:1})]),c("div",ue,[de,p(s,null,{default:d((({id:e})=>[p(o,null,{default:d((()=>[p(V,{required:"",modelValue:v(A).cost_code,"onUpdate:modelValue":l[3]||(l[3]=e=>v(A).cost_code=e),disabled:x.previewCostItems,attrs:{id:e},searchable:!0,options:v(U),placeholder:"Select a cost code"},null,8,["modelValue","disabled","attrs","options"])])),_:2},1024)])),_:1})]),c("div",ce,[pe,p(s,null,{default:d((()=>[p(o,null,{default:d((()=>[p(t,{modelValue:v(A).group,"onUpdate:modelValue":l[4]||(l[4]=e=>v(A).group=e),disabled:x.previewCostItems},{default:d((()=>[(r(!0),f(y,null,b(v(O),((e,l)=>(r(),u(a,{value:e.value},{default:d((()=>[h(w(e.label),1)])),_:2},1032,["value"])))),256))])),_:1},8,["modelValue","disabled"])])),_:1})])),_:1})]),c("div",_e,[me,v(D)?(r(),u(v(Ue),{key:0,disabled:x.previewCostItems,modelValue:v(A).description,"onUpdate:modelValue":l[5]||(l[5]=e=>v(A).description=e),editor:v(D),config:Oe},null,8,["disabled","modelValue","editor"])):I("",!0)]),c("div",ve,[fe,p(s,null,{default:d((()=>[p(o,null,{default:d((()=>[p(T,{modelValue:v(A).internal_notes,"onUpdate:modelValue":l[6]||(l[6]=e=>v(A).internal_notes=e),disabled:x.previewCostItems,rows:"4",placeholder:"Internal notes..."},null,8,["modelValue","disabled"])])),_:1})])),_:1})])])])),_:1}),p(S,{class:"column is-12 mt-3"},{default:d((()=>[c("div",be,[c("div",ye,[he,p(s,null,{default:d((()=>[p(o,null,{default:d((()=>[p(B,{modelValue:v(A).unit_cost,"onUpdate:modelValue":l[7]||(l[7]=e=>v(A).unit_cost=e),disabled:x.previewCostItems,type:"number",name:"unitCost",step:"any",placeholder:"Unit cost"},null,8,["modelValue","disabled"])])),_:1})])),_:1})]),c("div",Ie,[ge,p(s,null,{default:d((()=>[p(o,null,{default:d((()=>[p(B,{modelValue:v(A).quantity,"onUpdate:modelValue":l[8]||(l[8]=e=>v(A).quantity=e),disabled:x.previewCostItems,type:"number",name:"quantity",step:"any",placeholder:"Quantity"},null,8,["modelValue","disabled"])])),_:1})])),_:1})]),c("div",we,[Ce,p(s,null,{default:d((()=>[p(o,null,{default:d((()=>[p(B,{modelValue:v(A).unit,"onUpdate:modelValue":l[9]||(l[9]=e=>v(A).unit=e),disabled:x.previewCostItems,type:"text",name:"unit",placeholder:"Unit"},null,8,["modelValue","disabled"])])),_:1})])),_:1})]),c("div",ke,[Pe,p(s,null,{default:d((()=>[p(o,null,{default:d((()=>[p(B,{modelValue:v(Ae),"onUpdate:modelValue":l[10]||(l[10]=e=>g(Ae)?Ae.value=e:null),disabled:x.previewCostItems,type:"number",step:"any",name:"builderCost",placeholder:"Builder cost"},null,8,["modelValue","disabled"])])),_:1})])),_:1})]),c("div",Ve,[xe,p(s,null,{default:d((()=>[p(o,null,{default:d((()=>[p(B,{modelValue:v(A).markup,"onUpdate:modelValue":l[11]||(l[11]=e=>v(A).markup=e),disabled:x.previewCostItems,type:"number",name:"markup",step:"any",placeholder:"Markup"},null,8,["modelValue","disabled"])])),_:1})])),_:1})]),c("div",De,[Te,p(s,null,{default:d((()=>[p(o,null,{default:d((()=>[p(B,{modelValue:v(Me),"onUpdate:modelValue":l[12]||(l[12]=e=>g(Me)?Me.value=e:null),disabled:x.previewCostItems,type:"number",name:"markup",step:"any",placeholder:"Total Price"},null,8,["modelValue","disabled"])])),_:1})])),_:1})]),c("div",Se,[je,p(s,null,{default:d((()=>[p(o,null,{default:d((()=>[p(B,{modelValue:v(A).margin,"onUpdate:modelValue":l[13]||(l[13]=e=>v(A).margin=e),disabled:x.previewCostItems,type:"number",name:"markup",step:"any",placeholder:"Margin"},null,8,["modelValue","disabled"])])),_:1})])),_:1})])])])),_:1})])])),action:d((()=>[p(n,{loading:v(j),type:"submit",color:"primary",icon:x.costItemId?"":"fas fa-plus",raised:""},{default:d((()=>[h(w(x.costItemId?"Update":"Add"),1)])),_:1},8,["loading","icon"])])),_:1},8,["open","onSubmit"])}}}),Me=V("useProposal",(()=>{const e=a(!0),l=R(),t=B(),o=a("");a("");const s=a([]),n=a([]),i=a({id:"",jobInfo:{id:"",sales_people_info:[],clientInfo:{id:"",username:"",last_name:null,email:"",role:"",avatar:null},created_by_info:{id:"",username:"",last_name:null,email:"",role:"",avatar:null},managers_list:[],title:"",address:"",current_state:"",city:"",state:"",status:"",zip_code:"",confidence:"",sale_date:"",tags:[],estimated_from:"",estimated_to:"",sources:"",project_type:"",notes:"",attach_mail:"",latitude:0,longitude:0,created_at:"",updated_at:"",created_by:"",client:"",contractor:null,sales_people:[],managers:[]},proposalAmount:0,title:"",approval_deadline:"",internal_notes:"",introductory_text:"",closing_text:"",payment_status:"",type:"",status:"",columns_to_show:[],created_at:"",updated_at:"",job:""}),r=a([{id:"",index:0,title:"",description:"",type:"",quantity:0,unit:"",unit_cost:"",markup:"",total_price:"",cost_code:"",cost_type:"",builder_cost:"",margin:"",profit:"",internal_notes:"",mark_as:"",state:"",group_amount:"",status:null,created_at:"",proposal:""}]);return{loading:e,proposalCostItems:r,leadProposalFormData:i,companyProposalsList:s,leadProposalsList:n,getLeadProposals:async a=>{try{a.value=a,e.value=!0;const l=await t.get(`/api/lead-proposal/by-job/${a.value}/`);n.value=l.data}catch(o){l.error(` ${o}, Lead`)}finally{e.value=!1}},getProposalDetail:async e=>{try{const l=await t.get(`/api/lead-proposal/${e}/detail/`);i.value=l.data}catch(l){console.log(l)}},getCompanyProposals:async()=>{try{e.value=!0;const l=await t.get("/api/lead-proposal/");s.value=l.data}catch(a){l.error(` ${a}, Lead`)}finally{e.value=!1}},getProposalCostItems:async function(e){try{o.value=e;const l=await t.get(`/api/cost/by-proposal/${e}/`);r.value=l.data}catch(l){console.log(l)}},clearProposalId:function(){o.value="",r.value=[]}}})),Ue={class:"modal-form columns is-multiline"},Oe={class:"column is-full"},Ee={class:"field"},Fe=c("label",{class:"label"},"Send To ",-1),Le={class:"control"},qe={class:"column is-full"},He={class:"field"},$e=c("label",{class:"label"},"Subject ",-1),Ne={class:"control"},Be={class:"field column is-full mt-5"},Re=c("label",{class:"label"},"Message",-1),ze=c("i",{class:"feather:mail"},null,-1),We=e({__name:"SendProposalEmailModal",props:{proposalSenderModal:{type:Boolean},proposalData:{},columnsToShow:{}},emits:["update:modalHandler","update:OnSuccess"],setup(e,{emit:t}){const i=e,b=Me(),y=B();a(!1);const g=R(),w=a(!1),P=a(""),V=l(),D=window.origin,T=a(`${D}/proposal-view/?proposal=${i.proposalData?.id}`),S=()=>{t("update:modalHandler",!1)};P.value="<b> Hi  <br />\nIbex Management <br />\n</b>";const j=a({scheduleAt:"",sendToGroup:[],link:"",sendTo:b.leadProposalFormData?.jobInfo?.clientInfo?.email?b.leadProposalFormData?.jobInfo?.clientInfo?.email:"N/A",subject:"",message:`<p><b>Hi ${b.leadProposalFormData?.jobInfo?.clientInfo?.username?b.leadProposalFormData?.jobInfo?.clientInfo?.username:"N/A"} ${b.leadProposalFormData?.jobInfo?.clientInfo?.last_name?b.leadProposalFormData?.jobInfo?.clientInfo?.last_name:""},</b></p>\n  \n  <p>We hope this message finds you well.</p>\n  \n  <p>\n    Please find attached a detailed proposal outlining the cost items associated with the services/products we will be providing. \n    We have carefully curated this proposal to ensure complete transparency and alignment with your expectations.\n  </p>\n  \n  <p>\n    You can review the full proposal, including the cost breakdown, by clicking the link below: <br />\n    <a href="${T.value}" style="color: #007bff; text-decoration: none; font-weight: bold;">View Proposal</a>\n  </p>\n\n  \n  <p><b>Summary of Charges:</b></p>\n  <ul>\n    <li><b>Total Items:</b> ${b.leadProposalFormData.proposalAmount??0}</li>\n    <li><b>Total Amount:</b>$${b.leadProposalFormData.proposalAmount??0}</li>\n  </ul>\n  \n  <p>\n    If you have any questions or require further clarification, feel free to reach out to us at your earliest convenience. \n    We are here to assist you.\n  </p>\n  \n  <p>Thank you for trusting <b>Ibex Team</b> with your project.</p>\n  \n  <p><b>Best Regards,</b><br />\n    Ibex Team\n  </p>`}),A=async()=>{try{w.value=!0;await y.post(`/api/lead-proposal/${i.proposalData?.id}/send-proposal-template/`,{email:j.value.sendTo,subject:j.value.subject,message:j.value.message,scheduleAt:j.value.scheduleAt,link:T.value,column:i.columnsToShow});g.success("Email sent to worker successfully"),S()}catch(e){console.log(e)}finally{w.value=!1}},M=o((()=>s((()=>import("./ckeditor-6d8fc3b5.js").then((e=>e.c))),["assets/ckeditor-6d8fc3b5.js","assets/index-c5eacac6.js","assets/index-ce8747cd.css","assets/vue.runtime.esm-bundler-40e3d7c7.js"]).then((e=>e.default.component)))),U={fontFamily:{options:['"Montserrat", sans-serif','"Roboto", sans-serif']},height:"400px",minHeight:"400px",maxHeight:"600px"};return n((async()=>{V.value=await s((()=>import("./ckeditor-962b993d.js").then((e=>e.c))),["assets/ckeditor-962b993d.js","assets/index-c5eacac6.js","assets/index-ce8747cd.css"]).then((e=>e.default))})),(e,l)=>{const a=k,t=E;return r(),f("div",null,[p(x,{name:"fade-slow"},{default:d((()=>[p(t,{is:"form",open:i.proposalSenderModal,title:"Send Proposal",size:"large",actions:"right",onSubmit:C(A,["prevent"]),onClose:S},{content:d((()=>[c("div",Ue,[c("div",Oe,[c("div",Ee,[Fe,c("div",Le,[_(c("input",{type:"email",required:"",class:"input",placeholder:"Enter Mail","onUpdate:modelValue":l[0]||(l[0]=e=>v(j).sendTo=e)},null,512),[[m,v(j).sendTo]])])])]),c("div",qe,[c("div",He,[$e,c("div",Ne,[_(c("input",{type:"text",required:"",class:"input",placeholder:"Enter mail subject","onUpdate:modelValue":l[1]||(l[1]=e=>v(j).subject=e)},null,512),[[m,v(j).subject]])])])]),c("div",Be,[Re,v(V)?(r(),u(v(M),{key:0,modelValue:v(j).message,"onUpdate:modelValue":l[2]||(l[2]=e=>v(j).message=e),editor:v(V),config:U},null,8,["modelValue","editor"])):I("",!0)])])])),action:d((()=>[p(a,{type:"submit",color:"primary",loading:v(w),raised:""},{default:d((()=>[ze,h(" Send Proposal")])),_:1},8,["loading"])])),cancel:d((()=>[p(a,{color:"light",onClick:S,raised:""},{default:d((()=>[h("Close ")])),_:1})])),_:1},8,["open","onSubmit"])])),_:1})])}}}),Je=a(["title","cost_code","description","quantity","unit_cost","unit","total_price"]),Ge=[{value:"title",label:"Title"},{value:"cost_code",label:"Cost Code"},{value:"description",label:"Description"},{value:"quantity",label:"Quantity"},{value:"unit_cost",label:"Unit Cost"},{value:"unit",label:"Unit"},{value:"builder_cost",label:"Builder Cost"},{value:"markup",label:"Markup"},{value:"margin",label:"Margin"},{value:"total_price",label:"Client Price"},{value:"cost_type",label:"Cost Type"},{value:"group_amount",label:"Group Amount"},{value:"notes",label:"Notes"},{value:"profit",label:"Profit"}],Qe=a({cost_code:"cost_code",title:"title",unit:"unit",description:"description",cost_type:"cost_type",mark_as:"mark_as",quantity:"quantity",unit_cost:"unit_cost",total_price:"total_price",builder_cost:"builder_cost",markup:"markup",status:"status",group_amount:"group_amount",profit:"profit",internal_notes:"internal_notes"}),Ke=a({cost_code:"Cost Code",title:"Title",unit:"Unit",description:"Description",cost_type:"Cost Type",mark_as:"Mark As",quantity:"Quantity",unit_cost:"Unit Cost",builder_cost:"Builder Cost",markup:"Markup",markup_amount:"Markup Amount",status:"Status",total_price:"Client Price",group_amount:"Group Price",TotalCost:"Total Cost",total_markup:"Total Markup",profit:"Profit",notes:"Internal Notes",state:"State"}),Ye=e=>(T("data-v-cb33cfee"),e=e(),S(),e),Xe={class:"columns is-multiline"},Ze=Ye((()=>c("div",{class:"column is-9"},[c("h1",{class:"title is-5 m-1 p-0"},"Preview Lead Proposal"),c("p",{class:"m-1"}," Below is a preview of the proposal that will be sent as a link to the email addresses on this client contact. The proposal can be accessed through the link while it is Released. ")],-1))),el={class:"column is-12"},ll={class:"invoice-wrapper"},al={class:"invoice-header"},tl={class:"left"},ol=Ye((()=>c("a",{class:"action"},[c("i",{"aria-hidden":"true",class:"iconify","data-icon":"feather:printer"})],-1))),sl=Ye((()=>c("a",{class:"action"},[c("i",{"aria-hidden":"true",class:"iconify","data-icon":"feather:download-cloud"})],-1))),nl=[Ye((()=>c("i",{"aria-hidden":"true",class:"iconify","data-icon":"feather:mail"},null,-1)))],il={class:"invoice-body"},rl={class:"invoice-card"},ul={class:"invoice-section is-flex is-bordered"},dl=Ye((()=>c("div",{class:"meta"},null,-1))),cl=Ye((()=>c("div",{class:"end is-right"},[c("span",null,"PO Box 242"),c("span",null,"Evergreen, CO 80437-0242"),c("span",null,"Phone: 720 272-9061"),c("span",null,"Premium Trades for Premier Builders")],-1))),pl={class:"invoice-section is-flex is-bordered"},_l={class:"meta"},ml={class:"end is-left"},vl={class:"invoice-section"},fl={class:"responsive-table"},bl=["innerHTML"],yl={key:1},hl={class:"invoice-section is-flex mt-0 pt-0"},Il={class:"end is-left"},gl={class:"text-right"},wl=D('<div class="invoice-section is-flex mt-0 pt-0" data-v-cb33cfee><div class="footer" data-v-cb33cfee><div class="footer-meta" data-v-cb33cfee><p data-v-cb33cfee>Signature:</p><div data-v-cb33cfee> ___________________________________________________________________________________ </div></div><div class="footer-meta" data-v-cb33cfee><p data-v-cb33cfee>Date:</p><div data-v-cb33cfee> ___________________________________________________________________________________ </div></div><div class="footer-meta" data-v-cb33cfee><p class="no-wrap" data-v-cb33cfee>Print Name:</p><div data-v-cb33cfee> ___________________________________________________________________________________ </div></div></div></div>',1),Cl=j(e({__name:"ProposalPreview",props:{columnsToShow:{},proposalData:{}},setup(e){const l=e,t=Me(),o=a(!1),s=a([]),i=a({}),d=()=>{i.value=l.proposalData,s.value=Je,o.value=!o.value};return n((()=>{})),(e,a)=>{const n=G,i=We;return r(),f("div",Xe,[Ze,c("div",el,[c("div",ll,[c("div",al,[c("div",tl,[c("h3",null," Proposal-ID "+w(v(t).leadProposalFormData?.id.slice(1,8)),1)]),c("div",{class:"right"},[c("div",{class:"controls"},[ol,sl,c("a",{class:"action",onClick:d},nl)])])]),c("div",il,[c("div",rl,[c("div",ul,[p(n,{size:"xl",picture:"/logos/IbexFavicon.png"}),dl,cl]),c("div",pl,[c("div",_l,[c("h3",null,w(v(t).leadProposalFormData?.jobInfo?.clientInfo?.username??"N/A")+" "+w(v(t).leadProposalFormData?.jobInfo?.clientInfo?.last_name??""),1),c("span",null,w(v(t).leadProposalFormData?.jobInfo?.clientInfo?.email?v(t).leadProposalFormData?.jobInfo?.clientInfo?.email:"N/A"),1)]),c("div",ml,[c("h3",null,w(v(W)(v(t).leadProposalFormData?.created_at)),1),c("p",null," Job Address: "+w(v(t).leadProposalFormData?.jobInfo?.address??"N/A"),1)])]),c("div",vl,[c("table",fl,[c("thead",null,[(r(!0),f(y,null,b(v(Je),((e,l)=>(r(),f("th",{key:l},w(v(Ke)[e]),1)))),128))]),c("tbody",null,[(r(!0),f(y,null,b(v(t).proposalCostItems,((e,l)=>(r(),f("tr",{key:e.id},[(r(!0),f(y,null,b(v(Je),((l,a)=>(r(),f("td",{key:a},["Description"===l?(r(),f("div",{key:0,innerHTML:e[v(Qe)[l]]},null,8,bl)):(r(),f("span",yl,w(e[v(Qe)[l]]),1))])))),128))])))),128))])])]),c("div",hl,[c("div",Il,[c("h3",gl," Total Price: $"+w(v(t).leadProposalFormData?.proposalAmount),1)])]),wl])])])]),v(o)?(r(),u(i,{key:0,proposalSenderModal:v(o),proposalData:l.proposalData,columnsToShow:v(s),"onUpdate:modalHandler":a[0]||(a[0]=e=>o.value=!1)},null,8,["proposalSenderModal","proposalData","columnsToShow"])):I("",!0)])}}}),[["__scopeId","data-v-cb33cfee"]]),kl=e=>(T("data-v-eafba95d"),e=e(),S(),e),Pl={class:"datatable-wrapper mt-0"},Vl={class:"table-container"},xl={class:"table datatable-table is-fullwidth",id:"external-events"},Dl=kl((()=>c("th",null,"Item#",-1))),Tl=kl((()=>c("th",null,"Actions",-1))),Sl=["data-event","onDragstart","onDrop"],jl={class:"is-relative"},Al=["onClick"],Ml=kl((()=>c("i",{style:{cursor:"grab"},class:"lnir lnir-sort","aria-hidden":"true"},null,-1))),Ul=["innerHTML"],Ol={key:1},El=["onClick"],Fl=[kl((()=>c("div",{class:"icon"},[c("i",{"aria-hidden":"true",class:"lnil lnil-eye"})],-1))),kl((()=>c("div",{class:"meta"},[c("span",null,"View"),c("span",null,"View user details")],-1)))],Ll=["onClick"],ql=[kl((()=>c("div",{class:"icon"},[c("i",{"aria-hidden":"true",class:"lnil lnil-briefcase"})],-1))),kl((()=>c("div",{class:"meta"},[c("span",null,"Edit"),c("span",null,"Edit Cost Item")],-1)))],Hl=kl((()=>c("hr",{class:"dropdown-divider"},null,-1))),$l=["onClick"],Nl=[kl((()=>c("div",{class:"icon"},[c("i",{"aria-hidden":"true",class:"lnil lnil-trash-can-alt"})],-1))),kl((()=>c("div",{class:"meta"},[c("span",null,"Remove"),c("span",null,"Remove from list")],-1)))],Bl=j(e({__name:"CostItemsTable",props:{columnsToShow:{},itemsList:{}},setup(e){const l=e,t=Me(),o=R(),s=a({title:"",subtitle:"test",isSweetAlertOpen:!1,btntext:"text"}),i=B(),_=a(""),m=a(!1);a([]);const g=e=>{e.preventDefault()},k=e=>{e.preventDefault(),e.currentTarget?.classList.add("drag-over")},P=e=>{e.preventDefault(),e.currentTarget?.classList.remove("drag-over")},V=a(""),x=a(0),D=a(""),T=a(!1),S=a(!1),j=async()=>{try{S.value=!0;await i.delete(`/api/cost/${D.value}/`);M(),s.value.isSweetAlertOpen=!1,o.success("Cost item deleted")}catch(e){console.log(e)}finally{S.value=!1}},A=(e,l=!1)=>{D.value=e.id,T.value=l,V.value=e.proposal,m.value=!m.value},M=()=>{t.getProposalCostItems(V.value)};return n((()=>{})),(e,a)=>{const o=K,n=Q,S=Ae;return r(),f("div",Pl,[c("div",Vl,[c("table",xl,[c("thead",null,[Dl,(r(!0),f(y,null,b(l.columnsToShow,((e,l)=>(r(),f("th",{key:l},w(v(Ke)[e]),1)))),128)),Tl]),c("tbody",null,[v(t).proposalCostItems.length>0?(r(!0),f(y,{key:0},b(v(t).proposalCostItems,((e,a)=>(r(),f("tr",{key:e.id,"data-event":JSON.stringify(e),draggable:"true",onDragstart:l=>{return a=e.id,_.value=a,void console.log("Drag started for ID:",a);var a},onDrop:l=>(e=>{console.log("Dropped on ID:",e);const l=t.proposalCostItems.find((e=>e.id===_.value)),a=t.proposalCostItems.find((l=>l.id===e));if(l&&a){i.post("/api/cost/drag-drop-items/",{dragged_item_id:l.id,dropped_item_id:a.id});const e=t.proposalCostItems.indexOf(l),o=t.proposalCostItems.indexOf(a);e>=0&&o>=0&&(t.proposalCostItems.splice(e,1),t.proposalCostItems.splice(o,0,l))}else console.error("Dragged or Dropped Item not found");_.value=null})(e.id),onDragover:g,onDragenter:k,onDragleave:P,class:"draggable-item events"},[c("td",jl,[c("i",{style:{position:"absolute",bottom:"-7px",left:"1px",cursor:"pointer","font-weight":"600"},onClick:l=>(e=>{V.value=e.proposal,x.value=e.index,m.value=!m.value})(e),class:"lnir lnir-circle-plus info-text","aria-hidden":"true"},null,8,Al),Ml,h(" "+w(a+1),1)]),(r(!0),f(y,null,b(l.columnsToShow,((l,a)=>(r(),f("td",{key:a},["description"===l?(r(),f("div",{key:0,innerHTML:e[v(Qe)[l]]},null,8,Ul)):(r(),f("span",Ol,w(e[v(Qe)[l]]),1))])))),128)),c("td",null,[p(o,{icon:"feather:more-vertical",class:"is-pushed-mobile",spaced:"",right:""},{content:d((({close:l})=>[c("a",{role:"menuitem",href:"#",class:"dropdown-item is-media",onClick:C((()=>{A(e,!0),l()}),["prevent"])},Fl,8,El),c("a",{role:"menuitem",href:"#",class:"dropdown-item is-media",onClick:C((()=>{A(e,!1),l()}),["prevent"])},ql,8,Ll),Hl,c("a",{role:"menuitem",href:"#",class:"dropdown-item is-media",onClick:C((()=>{(e=>{D.value=e.id,V.value=e.proposal,s.value={title:"Are you sure?",subtitle:"You will not be able to recover this cost item!",btntext:"Delete",isSweetAlertOpen:!0}})(e),l()}),["prevent"])},Nl,8,$l)])),_:2},1024)])],40,Sl)))),128)):I("",!0)])])]),v(s).isSweetAlertOpen?(r(),u(n,{key:0,isSweetAlertOpen:v(s).isSweetAlertOpen,title:v(s).title,subtitle:v(s).subtitle,btntext:v(s).btntext,onConfirm:j,onCancel:()=>v(s).isSweetAlertOpen=!1},null,8,["isSweetAlertOpen","title","subtitle","btntext","onCancel"])):I("",!0),v(m)?(r(),u(S,{key:1,costItemModal:v(m),proposalId:v(V),costItemId:v(D),previousItemIndex:v(x),previewCostItems:v(T),"onUpdate:modalHandler":a[0]||(a[0]=e=>m.value=!1),"onUpdate:OnSuccess":M},null,8,["costItemModal","proposalId","costItemId","previousItemIndex","previewCostItems"])):I("",!0)])}}}),[["__scopeId","data-v-eafba95d"]]),Rl={class:"columns is-multiline"},zl={class:"column is-12 is-flex space-between"},Wl=c("div",null,[c("h1",{class:"title is-4"},"Proposal Worksheet")],-1),Jl={key:0,class:"column is-12"},Gl={class:"tabs-wrapper column is-12 m-0"},Ql={class:"tabs-inner mt-4"},Kl={class:"tabs is-boxed"},Yl=[c("span",null,"Worksheet",-1)],Xl=[c("span",null,"Format",-1)],Zl=[c("span",null,"Preview",-1)],ea={key:0,class:"column is-12"},la={key:0,class:"column is-12"},aa={class:"columns is-multiline"},ta=c("div",{class:"column is-12",style:{"text-align":"center"}},[c("h1",{class:"title is-4"},"Connect your clients to their projects"),c("h1",{class:"title is-5"}," Create a client contact and assign them to jobs and lead opportunities effortlessly. ")],-1),oa={class:"column is-12"},sa={key:0,class:"column is-12"},na=e({__name:"WorksheetItems",props:{leadProposalModal:{type:Boolean},proposalId:{},proposalData:{}},emits:["update:modalHandler","update:OnSuccess"],setup(e,{emit:t}){const _=e,m=l(),b=Me(),y=a(!1),w=a(!1),V=a("worksheet");o((()=>s((()=>import("./ckeditor-6d8fc3b5.js").then((e=>e.c))),["assets/ckeditor-6d8fc3b5.js","assets/index-c5eacac6.js","assets/index-ce8747cd.css","assets/vue.runtime.esm-bundler-40e3d7c7.js"]).then((e=>e.default.component))));const x=async()=>{try{b.getProposalCostItems(_.proposalId)}catch(e){console.log(e)}};return n((async()=>{m.value=await s((()=>import("./ckeditor-962b993d.js").then((e=>e.c))),["assets/ckeditor-962b993d.js","assets/index-c5eacac6.js","assets/index-ce8747cd.css"]).then((e=>e.default)),_.proposalId&&(x(),b.getProposalDetail(_.proposalId))})),A((()=>{b.clearProposalId()})),(e,l)=>{const a=k,t=i("Multiselect"),o=H,s=q,n=Bl,m=P,b=Cl,D=Ae;return r(),f("div",null,[c("div",Rl,[c("div",zl,[Wl,c("div",null,[p(a,{size:"small",light:"",outlined:"",icon:"fas fa-cog",class:"mr-2",color:v(w)?"danger":"success",onClick:l[0]||(l[0]=e=>w.value=!v(w))},{default:d((()=>[h("Table")])),_:1},8,["color"]),p(a,{size:"small",light:"",outlined:"",class:"mr-2",color:"info",onClick:l[1]||(l[1]=e=>y.value=!v(y))},{default:d((()=>[h("Import")])),_:1}),p(a,{size:"small",light:"",outlined:"",class:"mr-2",color:"primary",onClick:l[2]||(l[2]=e=>y.value=!v(y))},{default:d((()=>[h("Add From")])),_:1}),p(a,{size:"small",light:"",outlined:"",color:"warning",onClick:l[3]||(l[3]=e=>y.value=!v(y))},{default:d((()=>[h("Add Item")])),_:1})])]),p(M,{class:"fade-slow",name:"fade-slow"},{default:d((()=>[v(w)?(r(),f("div",Jl,[p(s,{label:"Choose what to show to lead",class:"column is-12"},{default:d((({id:e})=>[p(o,null,{default:d((()=>[p(t,{modelValue:v(Je),"onUpdate:modelValue":l[4]||(l[4]=e=>g(Je)?Je.value=e:null),attrs:{id:e},mode:"tags",searchable:!0,"create-tag":!0,options:v(Ge),placeholder:"Add columns"},null,8,["modelValue","attrs","options"])])),_:2},1024)])),_:1})])):I("",!0)])),_:1}),c("div",Gl,[c("div",Ql,[c("div",Kl,[c("ul",null,[c("li",{class:U(["worksheet"===v(V)?"is-active":"not-active"])},[c("a",{tabindex:"0",role:"button",onKeydown:l[5]||(l[5]=O(C((e=>V.value="worksheet"),["prevent"]),["space"])),onClick:l[6]||(l[6]=e=>V.value="worksheet")},Yl,32)],2),c("li",{class:U(["format"===v(V)?"is-active":"not-active"])},[c("a",{tabindex:"0",role:"button",onKeydown:l[7]||(l[7]=O(C((e=>V.value="format"),["prevent"]),["space"])),onClick:l[8]||(l[8]=e=>V.value="format")},Xl,32)],2),c("li",{class:U(["preview"===v(V)?"is-active":"not-active"])},[c("a",{tabindex:"0",role:"button",onKeydown:l[9]||(l[9]=O(C((e=>V.value="preview"),["prevent"]),["space"])),onClick:l[10]||(l[10]=e=>V.value="preview")},Zl,32)],2)])])])]),p(M,{class:"fade-slow",name:"slide-x"},{default:d((()=>["worksheet"===v(V)?(r(),f("div",ea,[p(n,{columnsToShow:v(Je),proposalId:_.proposalId},null,8,["columnsToShow","proposalId"])])):I("",!0)])),_:1}),p(M,{class:"fade-slow",name:"slide-x"},{default:d((()=>["format"===v(V)?(r(),f("div",la,[c("div",aa,[p(s,{label:"Choose what to show to lead",class:"column is-12"},{default:d((({id:e})=>[p(o,null,{default:d((()=>[p(t,{modelValue:v(Je),"onUpdate:modelValue":l[11]||(l[11]=e=>g(Je)?Je.value=e:null),attrs:{id:e},mode:"tags",searchable:!0,"create-tag":!0,options:v(Ge),placeholder:"Add tags"},null,8,["modelValue","attrs","options"])])),_:2},1024)])),_:1})]),p(m,{class:"columns is-multiline m-0"},{default:d((()=>[ta,c("div",oa,[p(n,{columnsToShow:v(Je)},null,8,["columnsToShow"])])])),_:1})])):I("",!0)])),_:1}),p(M,{class:"fade-slow",name:"slide-x"},{default:d((()=>["preview"===v(V)?(r(),f("div",sa,[p(b,{proposalData:_.proposalData,columnsToShow:v(Je)},null,8,["proposalData","columnsToShow"])])):I("",!0)])),_:1})]),v(y)?(r(),u(D,{key:0,costItemModal:v(y),proposalId:_.proposalId,"onUpdate:modalHandler":l[12]||(l[12]=e=>y.value=!1),"onUpdate:OnSuccess":x},null,8,["costItemModal","proposalId"])):I("",!0)])}}});export{na as _,Ae as a,Ge as c,Je as s,Me as u};
