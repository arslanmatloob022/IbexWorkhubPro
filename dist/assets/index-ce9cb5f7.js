import{i as e,F as s}from"./index-770cf7f4.js";import{i as t}from"./index-628293e8.js";import{u as a}from"./userSession-2a1a5dbc.js";import{u as o}from"./useNotyf-c83d15ff.js";import{u as r}from"./useAPI-908cf8be.js";import{e as l,r as i,o as n,y as c,z as d,l as u,H as p,B as v,C as m,J as h,Q as _,R as g,P as f,L as b,s as y,A as j,D as k,E as w,G as x,v as C}from"./index-94fd63d9.js";import{u as S}from"./useThemeColors-105cf341.js";import{A as P}from"./vue3-apexcharts.common-51bc08ed.js";import{_ as A}from"./VIcon.vue_vue_type_script_setup_true_lang-7dc6f338.js";import{_ as D}from"./VBlock.vue_vue_type_style_index_0_lang-3f7533f3.js";import{_ as I}from"./VIconBox.vue_vue_type_style_index_0_lang-ff1a00e9.js";import{u as T,a as $}from"./progressChart-cdb476c0.js";import{b as B}from"./useSupportElement-8f2f795f.js";import{u as W}from"./viewWrapper-2c1ae76a.js";import"./notyf-7873e796.js";import"./vue.runtime.esm-bundler-492622ed.js";import"./billboard-5857d5e1.js";const L={style:{display:"flex","border-radius":"6px","flex-wrap":"wrap","align-items":"center","justify-content":"space-between"}},M={onClick:()=>{},style:{"font-weight":"500","margin-bottom":"0px","padding-left":"10px"}},V={class:"avatars"},H=["src"],R={key:1,style:{width:"100%",height:"100%","background-color":"#292f3c",display:"flex","align-items":"center","justify-content":"center"}},z={class:"mb-0",style:{color:"white"}},O=b(l({__name:"ProjectsDashboardCalendar",setup(l){const b=r(),y=a(),j=o(),k=i(!1),w=i(!1),x=i("");i(!1),i("all"),i(""),i([]),i([]);const C=i([]),S=i({pending:"#8392ab",active:"#fbcf33",completed:"#82d616",canceled:"#344767"}),P=i({plugins:[e,t],schedulerLicenseKey:"0965592368-fcs-1694657447",initialView:"resourceTimelineMonth",height:"auto",resourceAreaWidth:"20%",selectable:!0,headerToolbar:{left:"today prev,next",center:"title",right:"resourceTimelineWeek,resourceTimelineMonth,resourceTimelineYear"},editable:!0,views:{resourceTimelineWeek:{slotDuration:{days:1,hours:1},slotLabelFormat:{weekday:"short",month:"numeric",day:"numeric",year:"numeric"}}},resourceAreaHeaderContent:"Projects",resources:[],eventClick:e=>{"manager"!==y.user.role||e.event.extendedProps.managers.some((e=>e.id===y.user.id))?(w.value=!0,x.value=e.event.id):j.success("You are not allowed to perform this action.")},eventDrop:e=>{let s=e.event.startStr,t=e.event.end.toISOString().substring(0,10);console.log("resource ids",e.event._def.resourceIds[0]),console.log(e.event.extendedProps.project),e.event.extendedProps.project===e.event._def.resourceIds[0]&&confirm(`Are you sure you want to update the project ${e.event.title} date from ${s} to ${t}?`)?D(e.event.id,s,t):e.revert()},eventResize:e=>{let s=e.event.startStr,t=e.event.end.toISOString().substring(0,10);console.log(e.event),confirm(`Are you sure you want to update the project ${e.event.title} date from ${s} to ${t}?`)?D(e.event.id,s,t):e.revert()}}),A=e=>{let s=new Date(e);return s.setDate(s.getDate()+1),s.toISOString().slice(0,10)},D=async(e,s,t)=>{try{let a=await b.patch(`/api/project/${e}/`,{startDate:s,endDate:t});console.log(a),j.success("Project updated successfully")}catch(a){j.error("Something went wrong"),console.log(a)}};return n((async()=>{await(async()=>{try{k.value=!0,console.log("inside all projects func");const e=await b.get("/api/project/",{});C.value=e.data,console.log("scratch projects",C.value),k.value=!1}catch(e){console.error(e),C.value=[],k.value=!1}})(),(()=>{console.log(C.value);const e=C.value.map((e=>({id:e.id,resourceId:e.id,project:e.id,start:e.startDate,end:A(e.endDate),title:e.title,description:e.description,total_tasks:e.total_tasks,managers:e.managers,borderColor:S[e.status]})));P.value.resources=C.value,P.value.events=e})(),console.log("projects",P.value)})),(e,t)=>(c(),d("div",null,[u(k)?f("",!0):(c(),p(u(s),{key:0,options:u(P)},{eventContent:v((e=>[m("div",L,[m("div",null,[m("span",M,h(e.event.title),1),m("span",null," -- tasks ("+h(e.event.extendedProps.total_tasks)+")",1)]),m("div",V,[(c(!0),d(_,null,g(e.event.extendedProps.managers,(e=>(c(),d("div",{class:"avatars__item",key:e.id},[e.avatar?(c(),d("img",{key:0,src:e.avatar,alt:""},null,8,H)):(c(),d("div",R,[m("h6",z,h(e.username?e.username.slice(0,2):"AA"),1)]))])))),128))])])])),_:1},8,["options"]))]))}}),[["__scopeId","data-v-aa7f3ee8"]]),E={class:"dashboard-card"},F=m("div",{class:"card-head"},[m("h3",{class:"dark-inverted"},"Task Completion"),m("a",{class:"action-link",tabindex:"0"},"Reports")],-1),J=l({__name:"DashBoardTasksPie",setup(e){const s=r(),t=i(!1),a=S(),o=y({height:295,type:"pie",series:[],colors:[a.accent,a.info,a.primary,a.purple,a.orange],labels:[],responsive:[{breakpoint:480,options:{chart:{width:315,toolbar:{show:!1}},legend:{position:"top"}}}],legend:{position:"right",horizontalAlign:"center"}});return n((()=>{(async()=>{try{t.value=!0;const e=(await s.get("/api/task/dashboard-analaytics/")).data.series;o.value.labels=e.map((e=>e.name)),console.log("chart",o.value.labels),o.value.series=e.map((e=>e.data.reduce(((e,s)=>e+s),0)))}catch(e){console.error(e)}finally{t.value=!1}})()})),(e,s)=>(c(),d("div",E,[F,u(t)?f("",!0):(c(),p(u(P),{key:0,id:"completion-chart",height:u(o).height,type:u(o).type,series:u(o).series,options:u(o)},null,8,["height","type","series","options"]))]))}}),N={class:"dashboard-card"},U=m("div",{class:"card-head"},[m("h3",{class:"dark-inverted"},"Task Completion"),m("a",{class:"action-link",tabindex:"0"},"Reports")],-1),Y=l({__name:"DashbaordTasksChart",setup(e){const s=r(),t=i(!1),a=S(),o=y({series:[],chart:{height:295,type:"area",toolbar:{show:!1}},colors:[a.accent,a.info,a.primary],legend:{position:"top"},dataLabels:{enabled:!1},stroke:{width:[2,3,5],curve:"smooth"},xaxis:{type:"date",categories:[]},tooltip:{x:{format:"dd/MM/yy HH:mm"}}});return n((()=>{(async()=>{try{t.value=!0;const e=(await s.get("/api/task/dashboard-analaytics/")).data;o.value.series=e.series,o.value.xaxis.categories=e.dates}catch(e){console.error(e)}finally{t.value=!1}})()})),(e,s)=>(c(),d("div",N,[U,u(t)?f("",!0):(c(),p(u(P),{key:0,id:"completion-chart",height:u(o).chart.height,type:u(o).chart.type,series:u(o).series,options:u(o)},null,8,["height","type","series","options"]))]))}}),G={class:"personal-dashboard personal-dashboard-v3"},K={class:"columns is-multiline"},Q={class:"column is-12"},q={class:"columns is-multiline is-flex-tablet-p"},X={class:"column is-12"},Z={class:"stats-wrapper"},ee={class:"columns is-multiline is-flex-tablet-p"},se={class:"column is-3"},te={class:"dashboard-card"},ae=m("i",{class:"fas fa-cubes","aria-hidden":"true"},null,-1),oe={class:"column is-3"},re={class:"dashboard-card"},le=m("i",{class:"fas fa-boxes","aria-hidden":"true"},null,-1),ie={class:"column is-3"},ne={class:"dashboard-card"},ce=m("i",{class:"fas fa-border-style","aria-hidden":"true"},null,-1),de={class:"column is-3"},ue={class:"dashboard-card"},pe=m("i",{class:"fas fa-dice-d6","aria-hidden":"true"},null,-1),ve={class:"column is-3"},me={class:"dashboard-card"},he=m("i",{class:"fas fa-hospital-user","aria-hidden":"true"},null,-1),_e={class:"column is-3"},ge={class:"dashboard-card"},fe=m("i",{class:"fas fa-users","aria-hidden":"true"},null,-1),be={class:"column is-3"},ye={class:"dashboard-card"},je=m("i",{class:"fas fa-user-tag","aria-hidden":"true"},null,-1),ke={class:"column is-3"},we={class:"dashboard-card"},xe=m("i",{class:"fas fa-user-tie","aria-hidden":"true"},null,-1),Ce={class:"columns is-multiline"},Se={class:"column is-8"},Pe={class:"column is-4"},Ae={class:"column is-12"},De=l({__name:"IbexDashboard",setup(e){T(),$();const s=r();S();const t=i(!1),a=i({all_project:0,active_projects:0,pending_projects:0,completed_projects:0,workers:0,managers:0,last_mail_sent:"",clients:0,contractors:0}),o=async()=>{try{t.value=!0;const e=await s.get("/api/project/dashboard/",{});a.value=e.data,t.value=!1}catch(e){console.log(e)}finally{t.value=!1}},l=()=>{try{t.value=!0;const e=s.post("/api/task/worker-mail/",{worker:"all"});console.log(e),o(),t.value=!1}catch(e){console.log(e)}};return n((()=>{o()})),(e,s)=>{const o=I,r=D,i=A,n=w,p=Y,h=J,_=O;return c(),d("div",G,[m("div",K,[m("div",Q,[m("div",q,[m("div",X,[m("div",Z,[m("div",ee,[m("div",se,[m("div",te,[j(r,{title:a.value?.all_project?a.value.all_project:"0",subtitle:"All Projects",center:""},{icon:v((()=>[j(o,{color:"info",rounded:""},{default:v((()=>[ae])),_:1})])),_:1},8,["title"])])]),m("div",oe,[m("div",re,[j(r,{title:a.value?.active_projects?a.value?.active_projects:"0",subtitle:"Active Projects",center:""},{icon:v((()=>[j(o,{color:"blue",rounded:""},{default:v((()=>[le])),_:1})])),_:1},8,["title"])])]),m("div",ie,[m("div",ne,[j(r,{title:a.value?.pending_projects?a.value?.pending_projects:"0",subtitle:"Pre Construction",center:""},{icon:v((()=>[j(o,{color:"pink",rounded:""},{default:v((()=>[ce])),_:1})])),_:1},8,["title"])])]),m("div",de,[m("div",ue,[j(r,{title:a.value?.completed_projects?a.value?.completed_projects:"0",subtitle:"Completed",center:""},{icon:v((()=>[j(o,{color:"green",rounded:""},{default:v((()=>[pe])),_:1})])),_:1},8,["title"])])]),m("div",ve,[m("div",me,[j(r,{title:a.value?.managers?a.value?.managers:"0",subtitle:"Managers",center:""},{icon:v((()=>[j(o,{color:"yellow",rounded:""},{default:v((()=>[he])),_:1})])),_:1},8,["title"])])]),m("div",_e,[m("div",ge,[j(r,{title:a.value?.workers?a.value?.workers:"0",subtitle:"Workers",center:""},{icon:v((()=>[j(o,{color:"lime",rounded:""},{default:v((()=>[fe])),_:1})])),_:1},8,["title"])])]),m("div",be,[m("div",ye,[j(r,{title:a.value?.contractors?a.value?.contractors:"0",subtitle:"Contractors",center:""},{icon:v((()=>[j(o,{color:"orange",rounded:""},{default:v((()=>[je])),_:1})])),_:1},8,["title"])])]),m("div",ke,[m("div",we,[j(r,{title:a.value?.clients?a.value?.clients:"0",subtitle:"Clients",center:""},{icon:v((()=>[j(o,{color:"blue",rounded:""},{default:v((()=>[xe])),_:1})])),_:1},8,["title"])])])]),j(r,{title:"Last Schedule Sent",subtitle:a.value.last_mail_sent?u(B)(a.value.last_mail_sent):"N/A"},{icon:v((()=>[j(o,{color:"success",rounded:""},{default:v((()=>[j(i,{icon:"lucide:clock"})])),_:1})])),action:v((()=>[j(n,{onClick:l,color:"warning",rounded:"",loading:t.value,elevated:""},{default:v((()=>[k(" Send Schedule ")])),_:1},8,["loading"])])),_:1},8,["subtitle"])])])])])]),m("div",Ce,[m("div",Se,[j(p)]),m("div",Pe,[j(h)]),m("div",Ae,[j(_)])])])}}}),Ie={class:"page-content-inner"},Te=l({__name:"index",setup(e){x();return W().setPageTitle("Ibex Builders Studios"),C((()=>({title:"Ibex Builders Studios"}))),(e,s)=>{const t=De;return c(),d("div",Ie,[j(t)])}}});export{Te as default};
