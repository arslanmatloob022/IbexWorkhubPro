import{_ as e}from"./VModal.vue_vue_type_style_index_0_lang-aa7b2f49.js";import{f as a,r as l,o as t,C as o,O as s,G as i,D as n,E as r,V as d,W as u,U as p,F as c,N as m,K as _,P as f,Q as y,R as v,S as g,s as b,b as h,j as k,B as w,I as C,L as T,X as V,m as I,J as P,aw as x,$ as S,Z as j,k as M,aS as U}from"./index-e765c558.js";import{_ as A}from"./VControl-920718a5.js";import{_ as q}from"./VRadio.vue_vue_type_style_index_0_lang-7e08172a.js";import{u as L}from"./useAPI-5fce6564.js";import{u as E}from"./useNotyf-28a154f6.js";import{u as R,_ as O,a as H}from"./CreateProposalTasksModal-e275181a.js";import{_ as D}from"./VTextarea.vue_vue_type_script_setup_true_lang-0b53b5ef.js";import{_ as G}from"./VCheckbox.vue_vue_type_style_index_0_lang-77c06e41.js";import{_ as B}from"./VField.vue_vue_type_script_setup_true_lang-f163a2a8.js";import{a as $,C as Z,d as N}from"./useSupportElement-cdbf1490.js";import{s as F,c as z}from"./costItems-85010378.js";import{_ as Q}from"./VInput.vue_vue_type_script_setup_true_lang-9f1677fe.js";import{_ as J}from"./VLabel.vue_vue_type_script_setup_true_lang-fee61721.js";import{_ as W}from"./V-Snack.vue_vue_type_style_index_0_lang-e7d003d8.js";import{_ as K}from"./VIcon.vue_vue_type_script_setup_true_lang-625efb2e.js";import{_ as X}from"./VFlexPagination.vue_vue_type_script_setup_true_lang-cc0dc51d.js";import{_ as Y,c as ee}from"./VFlexTable.vue_vue_type_style_index_0_lang-c7a661c0.js";import{_ as ae}from"./VTag.vue_vue_type_style_index_0_lang-01f0432e.js";import{_ as le}from"./VPlaceholderPage.vue_vue_type_style_index_0_lang-e36ed971.js";import{_ as te,a as oe}from"./search-4-dark-2b5b440c.js";import{_ as se}from"./VAvatar.vue_vue_type_style_index_0_lang-e5ba285e.js";const ie={key:0,class:"text-center py-4"},ne={key:1},re={class:"table is-striped is-fullwidth"},de=(e=>(y("data-v-6d29306e"),e=e(),v(),e))((()=>r("thead",null,[r("tr",null,[r("th",{scope:"col"},"Title"),r("th",{scope:"col"},"Amount"),r("th",{scope:"col"},"Cost Items"),r("th",{scope:"col"},"Approval Deadline"),r("th",{scope:"col"},"Status"),r("th",{scope:"col",class:"is-end"},[r("div",{class:"dark-inverted is-flex is-justify-content-flex-end"}," Select ")])])],-1))),ue={key:0},pe={class:"capitalize"},ce={class:"is-end"},me={class:"is-flex is-justify-content-flex-end"},_e=g(a({__name:"OpenTempalteModal",props:{openTemplate:{type:Boolean},proposalId:{},leadId:{}},emits:["update:modalHandler","update:OnSuccess"],setup(a,{emit:y}){const v=a,g=L(),b=E(),h=l([]),k=l(null),w=l(!1),C=()=>{y("update:modalHandler",!1)},T=async()=>{k.value?await V(k.value):b.error("Please select a template")},V=async e=>{try{const a=await g.post(`/api/lead-proposal/${e}/import-template/`,{existing_proposal:v.proposalId||"",lead:v.leadId});y("update:OnSuccess",a.data),console.log("test123"),b.success("Template imported successfully!"),C()}catch(a){console.error("Error importing template:",a),b.error("Something went wrong, try again")}};return t((()=>{(async()=>{w.value=!0;try{const e=await g.get("/api/lead-proposal/templates/");h.value=e.data}catch(e){b.error("Failed to fetch templates"),console.error(e)}finally{w.value=!1}})()})),(a,l)=>{const t=q,y=A,g=f,b=e;return o(),s(b,{open:v.openTemplate,size:"big",title:"Template List",actions:"right",onClose:C},{content:i((()=>[w.value?(o(),n("div",ie,"Loading...")):(o(),n("div",ne,[r("table",re,[de,h.value.length?(o(),n("tbody",ue,[(o(!0),n(d,null,u(h.value,(e=>(o(),n("tr",{key:e.id},[r("td",null,p(e.title),1),r("td",null,p(e.proposalAmount),1),r("td",null,p(e.cost_items),1),r("td",null,p(e.approval_deadline),1),r("td",pe,p(e.status),1),r("td",ce,[r("div",me,[c(y,{raw:"",subcontrol:""},{default:i((()=>[c(t,{modelValue:k.value,"onUpdate:modelValue":l[0]||(l[0]=e=>k.value=e),value:e.id,name:"templateSelection"},null,8,["modelValue","value"])])),_:2},1024)])])])))),128))])):m("",!0)])]))])),action:i((()=>[c(g,{color:"primary",raised:"",onClick:T},{default:i((()=>[_("Confirm")])),_:1})])),cancel:i((()=>[c(g,{color:"primary",style:{display:"none"},raised:""},{default:i((()=>[_("Close")])),_:1})])),_:1},8,["open"])}}}),[["__scopeId","data-v-6d29306e"]]),fe={class:"modal-form columns is-multiline"},ye={class:"column is-12"},ve={class:"columns is-multiline"},ge=r("label",null,"Title: *",-1),be={class:"control"},he=r("label",null,"Select Lead *",-1),ke={class:"multiselect-single-label"},we={class:"select-label-text"},Ce={class:"select-label-text"},Te={class:"column is-4"},Ve=r("label",null,"Approval Deadline *",-1),Ie={class:"control"},Pe={class:"field column is-2"},xe=r("label",null,"Attachments",-1),Se=r("div",{class:"file"},[r("label",{class:"file-label"},[r("input",{class:"file-input",type:"file",name:"resume",style:{width:"100%"}}),r("span",{class:"file-cta"},[r("span",{class:"file-icon"},[r("i",{class:"fas fa-cloud-upload-alt"})]),r("span",{class:"file-label"}," Choose a fileâ€¦ ")])])],-1),je={key:1,class:"column is-2"},Me={class:"field column is-2"},Ue={class:"column is-12"},Ae={class:"body-inner-content columns is-multiline"},qe={class:"field column is-12"},Le=r("label",{for:"",class:"label"},"Internal Notes",-1),Ee={class:"field column is-12 mb-0"},Re=r("label",{for:"",class:"label"},"Introductory Text",-1),Oe={class:"field column is-12 mb-0"},He=r("label",{for:"",class:"label"},"Closing Text",-1),De={class:"column is-12",id:"items-div"},Ge={key:0},Be=a({__name:"LeadProposalModal",props:{leadProposalModal:{type:Boolean},proposalId:{},leadId:{},createTemplate:{type:Boolean},getLeadsList:{type:Boolean}},emits:["update:modalHandler","update:OnSuccess","clearProposalId"],setup(a,{emit:d}){const u=a;R(),b(),h();const y=E(),v=L(),g=l(!1),x=l(!1),S=l(""),j=l([]),M=l({id:"",title:"",approval_deadline:"",internal_notes:"",introductory_text:null,closing_text:null,payment_status:"",worksheetItems:[],type:"proposal",project:"",is_template:!1,attachments:[],columns_to_show:[],status:"",created_at:"",updated_at:""}),U=l(!1),H=async(e=!1)=>{try{1==e?U.value=!0:g.value=!0,u.leadId&&(M.value.project=u.leadId),M.value.columns_to_show=JSON.stringify(F.value);const a=$(M.value,[]);if(u.proposalId||M.value.id){const e=await v.patch(`/api/lead-proposal/${u.proposalId?u.proposalId:M.value.id}/`,a);M.value=e.data,Z({object_type:"proposal",action:"UPDATE",performedOnName:"proposal",object_id:u.leadId||M.value.project,message:`updated proposal titled <a>${M.value.title}</a> information.`})}else{const e=await v.post("/api/lead-proposal/",a);M.value=e.data,Z({object_type:"proposal",action:"CREATE",performedOnName:"proposal",object_id:u.leadId||M.value.project,message:`created new proposal titled <a>${M.value.title}</a> information.`}),N(100)}1==e&&z(),y.success(`Proposal ${u.proposalId||M.value.id?"updated":"created"} successfully`)}catch(a){y.error("Something went wrong, try again")}finally{g.value=!1,U.value=!1}},N=(e=0)=>{const a=document.getElementById("items-div");if(a){const l=a.offsetTop-e;window.scrollTo({top:l,behavior:"smooth"})}},z=()=>{d("update:modalHandler",!1)},Q=l(!1),J=e=>{M.value=e,console.log("test12")};return t((async()=>{u.proposalId&&(async()=>{try{const e=await v.get(`/api/lead-proposal/${u.proposalId}/`);M.value=e.data,F.value=e.data.columns_to_show}catch(e){console.log(e)}})(),u.getLeadsList&&(async()=>{try{const e=await v.get("/api/project/projects-short-info/");j.value=e.data.map((e=>({value:e.id.toString(),name:e.title}))),S.value=u.leadId||""}catch{y.error("Invalid data")}finally{x.value=!1}})(),u.createTemplate&&(M.value.is_template=!0)})),k((()=>{d("clearProposalId",null),M.value={}})),(a,l)=>{const t=w("Multiselect"),d=A,y=B,v=q,b=f,h=G,k=D,x=O,S=_e,L=e;return o(),s(L,{is:"form",open:u.leadProposalModal,title:u.createTemplate?"Proposal Template":"Lead Proposal",size:"xl",actions:"right",onSubmit:P(H,["prevent"]),onClose:z},{content:i((()=>[r("div",fe,[r("div",ye,[r("div",ve,[r("div",{class:C(["field mb-0",u.leadId?"column is-12":"column is-6"])},[ge,r("div",be,[T(r("input",{type:"text",name:"title","onUpdate:modelValue":l[0]||(l[0]=e=>I(M).title=e),required:"",class:"input is-primary-focus is-primary-focus",placeholder:"Proposal Title"},null,512),[[V,I(M).title]])])],2),u.leadId||u.createTemplate?m("",!0):(o(),s(y,{key:0,class:"is-image-select has-curved-images column is-6"},{default:i((()=>[he,c(d,null,{default:i((()=>[c(t,{modelValue:I(M).project,"onUpdate:modelValue":l[1]||(l[1]=e=>I(M).project=e),placeholder:"Select a lead",label:"name",searchable:!0,"max-height":145,options:I(j)},{singlelabel:i((({value:e})=>[r("div",ke,[r("span",we,p(e.name),1)])])),option:i((({option:e})=>[r("span",Ce,p(e.name),1)])),_:1},8,["modelValue","options"])])),_:1})])),_:1})),r("div",Te,[c(y,{class:"m-0 p-0",label:"Type"},{default:i((()=>[c(d,{class:"m-0 p-0"},{default:i((()=>[c(v,{modelValue:I(M).type,"onUpdate:modelValue":l[2]||(l[2]=e=>I(M).type=e),value:"proposal",label:"Proposal",name:"solid_squared_radio",color:"primary",square:"",solid:""},null,8,["modelValue"]),c(v,{modelValue:I(M).type,"onUpdate:modelValue":l[3]||(l[3]=e=>I(M).type=e),value:"change_order",label:"Change Order",name:"solid_squared_radio",color:"info",square:"",solid:""},null,8,["modelValue"]),c(v,{modelValue:I(M).type,"onUpdate:modelValue":l[4]||(l[4]=e=>I(M).type=e),value:"draft",label:"Draft",name:"solid_squared_radio",color:"warning",square:"",solid:""},null,8,["modelValue"])])),_:1})])),_:1})]),r("div",{class:C(["field",(u.leadId||u.createTemplate,"column is-2")])},[Ve,r("div",Ie,[T(r("input",{type:"date",name:"firstName","onUpdate:modelValue":l[5]||(l[5]=e=>I(M).approval_deadline=e),required:"",class:"input is-primary-focus is-primary-focus",placeholder:"Proposal Approval deadline"},null,512),[[V,I(M).approval_deadline]])])],2),r("div",Pe,[xe,c(y,{grouped:"",class:""},{default:i((()=>[c(d,null,{default:i((()=>[Se])),_:1})])),_:1})]),u.createTemplate||I(M).id||u.proposalId?m("",!0):(o(),n("div",je,[c(b,{color:"primary",class:"mt-5",icon:"fas fa-file-import",onClick:l[6]||(l[6]=e=>Q.value=!I(Q)),style:{width:"100%"}},{default:i((()=>[_("Templates")])),_:1})])),r("div",Me,[c(y,{class:"is-flex mt-3"},{default:i((()=>[c(d,{raw:"",subcontrol:""},{default:i((()=>[c(h,{modelValue:I(M).is_template,"onUpdate:modelValue":l[7]||(l[7]=e=>I(M).is_template=e),label:"Create Template",color:"primary"},null,8,["modelValue"])])),_:1})])),_:1})]),r("div",Ue,[r("div",Ae,[r("div",qe,[Le,c(y,null,{default:i((()=>[c(d,null,{default:i((()=>[c(k,{modelValue:I(M).internal_notes,"onUpdate:modelValue":l[8]||(l[8]=e=>I(M).internal_notes=e),rows:"4",placeholder:"Internal notes..."},null,8,["modelValue"])])),_:1})])),_:1})]),r("div",Ee,[Re,c(y,null,{default:i((()=>[c(d,null,{default:i((()=>[c(k,{modelValue:I(M).introductory_text,"onUpdate:modelValue":l[9]||(l[9]=e=>I(M).introductory_text=e),rows:"3",placeholder:"Introductory Notes..."},null,8,["modelValue"])])),_:1})])),_:1})]),r("div",Oe,[He,c(y,null,{default:i((()=>[c(d,null,{default:i((()=>[c(k,{modelValue:I(M).closing_text,"onUpdate:modelValue":l[10]||(l[10]=e=>I(M).closing_text=e),rows:"2",placeholder:"Closing Text..."},null,8,["modelValue"])])),_:1})])),_:1})])])])])]),r("div",De,[I(M).id||u.proposalId?(o(),n("div",Ge,[c(x,{proposalId:I(M).id?I(M).id:u.proposalId,proposalData:I(M)},null,8,["proposalId","proposalData"])])):m("",!0)])]),I(Q)?(o(),s(S,{key:0,leadId:u.leadId||I(M).project,proposalId:u.proposalId,openTemplate:I(Q),"onUpdate:OnSuccess":J,"onUpdate:modalHandler":l[11]||(l[11]=e=>Q.value=!1)},null,8,["leadId","proposalId","openTemplate"])):m("",!0)])),action:i((()=>[u.createTemplate?(o(),s(b,{key:0,loading:I(g),type:"submit",color:"primary",raised:""},{default:i((()=>[_(p(u.proposalId||I(M).id?"Update Template":"Create Template"),1)])),_:1},8,["loading"])):(o(),s(b,{key:1,loading:I(g),type:"submit",color:"primary",raised:""},{default:i((()=>[_(p(u.proposalId||I(M).id?"Update Proposal":"Create Proposal"),1)])),_:1},8,["loading"])),c(b,{loading:I(U),onClick:l[12]||(l[12]=e=>H(!0)),color:"info",raised:""},{default:i((()=>[_(p(u.proposalId||I(M).id?"Update & Close":"Create & Close"),1)])),_:1},8,["loading"])])),cancel:i((()=>[c(b,{onClick:l[13]||(l[13]=e=>z()),raised:""},{default:i((()=>[_("Close")])),_:1})])),_:1},8,["open","title","onSubmit"])}}}),$e={class:"v-grid"},Ze=a({__name:"VGrid",props:{inline:{type:Boolean},gridTemplateColumns:{default:"none"},gridTemplateRows:{default:"none"},gridTemplateAreas:{default:"none"},columnGap:{default:"normal"},rowGap:{default:"normal"},justifyItems:{default:"initial"},alignItems:{default:"initial"},justifyContent:{default:"initial"},alignContent:{default:"initial"},placeContent:{default:"normal"},gridAutoColumns:{default:"auto"},gridAutoRows:{default:"auto"},gridAutoFlow:{default:"row"}},setup(e){const a=e;x((e=>({"36a9ff9c":I(l),"644edfcf":a.gridTemplateColumns,"13ee8f27":a.gridTemplateRows,"68f4ddf8":a.gridTemplateAreas,"3f6d0412":a.columnGap,"9b29192c":a.rowGap,"6ce21d44":a.justifyItems,"274efcee":a.alignItems,"5c2c4e97":a.justifyContent,"1a5afffc":a.alignContent,68195080:a.placeContent,d4bc820c:a.gridAutoColumns,"07161048":a.gridAutoRows,"0721119e":a.gridAutoFlow})));const l=S((()=>a.inline?"inline-grid":"grid"));return(e,a)=>(o(),n("div",$e,[j(e.$slots,"default")]))}}),Ne={class:"v-grid-item"},Fe=a({__name:"VGridItem",props:{gridColumnStart:{default:"auto"},gridColumnEnd:{default:"auto"},gridRowStart:{default:"auto"},gridRowEnd:{default:"auto"},justifySelf:{default:"auto"},alignSelf:{default:"auto"},placeSelf:{default:"auto"}},setup(e){const a=e;return x((e=>({"639fd2f2":a.gridColumnStart,"0928fb6b":a.gridColumnEnd,"58f2dc22":a.gridRowStart,"690c909b":a.gridRowEnd,"4e453368":a.justifySelf,"3160ef46":a.alignSelf,"2e640d42":a.placeSelf}))),(e,a)=>(o(),n("div",Ne,[j(e.$slots,"default")]))}}),ze={class:"columns is-multiline"},Qe={class:"column is-12"},Je=(e=>(y("data-v-9236e8e6"),e=e(),v(),e))((()=>r("div",{class:"column is-12 p-0 m-0"},[r("hr")],-1))),We={class:"column is-12"},Ke={class:"column is-12"},Xe={key:0,class:"column is-12"},Ye={class:"column is-12"},ea={class:"column is-12"},aa=g(a({__name:"MergeProposalModal",props:{groupProposalModal:{type:Boolean,default:!1},leadID:{default:""},selectedProposals:{default:[]}},emits:["update:modalHandler","update:OnSuccess","removeProposal"],setup(a,{emit:p}){const y=a,v=l(!1),g=L(),b=E(),h=l(!1),k=l([{value:"",label:""}]);l([{id:"",proposalAmount:0,title:"",approval_deadline:"",internal_notes:"",introductory_text:"",closing_text:"",payment_status:"",type:"",status:"",created_at:"",updated_at:"",job:""}]);const C=y.selectedProposals.map((e=>e.id)),T=l({title:"",type:"combined",description:"",proposals:C,trades:[],columns_to_show:[]}),V=()=>{p("update:modalHandler",!1)},x=async()=>{try{v.value=!0;let e=T.value;1==h.value?e.columns_to_show=JSON.stringify(T.value.columns_to_show):e.columns_to_show=[],e.proposals=JSON.stringify(T.value.proposals);const a=await g.post("/api/lead-proposal/merge-proposals/",e,{responseType:"blob"}),l=new Blob([a.data],{type:"application/pdf"}),t=window.URL.createObjectURL(l),o=document.createElement("a");o.href=t,o.download="Merged_Proposal.pdf",document.body.appendChild(o),o.click(),document.body.removeChild(o),window.URL.revokeObjectURL(t),V(),b.success("Proposal grouped successfully and saved in documents list")}catch(e){console.log("error found")}finally{v.value=!1}};return t((()=>{(async()=>{try{const e=await g.get("/api/cost-category/");k.value=e.data.map((e=>({value:e.id,label:e.name})))}catch(e){console.log(e)}})()})),(a,l)=>{const t=K,g=W,b=Fe,C=Ze,S=J,j=q,M=A,U=B,L=Q,E=w("Multiselect"),R=D,O=f,H=e;return o(),s(H,{is:"form",open:y.groupProposalModal,title:"Group Proposal",size:"large",actions:"right",onSubmit:P(x,["prevent"]),onClose:V},{content:i((()=>[r("div",ze,[r("div",Qe,[c(C,null,{default:i((()=>[c(b,null,{default:i((()=>[(o(!0),n(d,null,u(y.selectedProposals,(e=>(o(),s(g,{title:e.title,white:"",class:"m-1",icon:"lnir lnir-envelope"},{default:i((()=>[c(t,{onClick:a=>(e=>{p("removeProposal",e)})(e),icon:"lucide:x"},null,8,["onClick"])])),_:2},1032,["title"])))),256))])),_:1})])),_:1})]),Je,r("div",We,[c(U,null,{default:i((()=>[c(S,{style:{color:"var(--info) !important"}},{default:i((()=>[_("Select Group Type")])),_:1}),c(M,null,{default:i((()=>[c(j,{modelValue:I(T).type,"onUpdate:modelValue":l[0]||(l[0]=e=>I(T).type=e),value:"combined",label:"Combine Proposals",name:"outlined_squared_radio",color:"warning",square:""},null,8,["modelValue"]),c(j,{modelValue:I(T).type,"onUpdate:modelValue":l[1]||(l[1]=e=>I(T).type=e),value:"trade",label:"Trade Proposal",name:"outlined_squared_radio",color:"primary",square:""},null,8,["modelValue"]),c(j,{modelValue:I(T).type,"onUpdate:modelValue":l[2]||(l[2]=e=>I(T).type=e),value:"summary",label:"Summary Proposal",name:"outlined_squared_radio",color:"info",square:""},null,8,["modelValue"]),c(j,{modelValue:I(T).type,"onUpdate:modelValue":l[3]||(l[3]=e=>I(T).type=e),value:"report",label:"Report",name:"outlined_squared_radio",color:"success",square:""},null,8,["modelValue"])])),_:1})])),_:1})]),r("div",Ke,[c(U,{label:"Proposal Title *"},{default:i((()=>[c(M,null,{default:i((()=>[c(L,{modelValue:I(T).title,"onUpdate:modelValue":l[4]||(l[4]=e=>I(T).title=e),placeholder:"Enter Group Proposal Title",type:"text",name:"title",required:""},null,8,["modelValue"])])),_:1})])),_:1})]),I(h)?(o(),n("div",Xe,[c(U,{label:"Choose what to merge in show in group proposal"},{default:i((({id:e})=>[c(M,null,{default:i((()=>[c(E,{modelValue:I(T).columns_to_show,"onUpdate:modelValue":l[5]||(l[5]=e=>I(T).columns_to_show=e),attrs:{id:e},mode:"tags",searchable:!0,"create-tag":!0,options:I(z),placeholder:"Add columns"},null,8,["modelValue","attrs","options"])])),_:2},1024)])),_:1})])):m("",!0),r("div",Ye,["trade"==I(T).type?(o(),s(U,{key:0,label:"Select the trades to merge"},{default:i((({id:e})=>[c(M,null,{default:i((()=>[c(E,{modelValue:I(T).trades,"onUpdate:modelValue":l[6]||(l[6]=e=>I(T).trades=e),attrs:{id:e},mode:"tags",searchable:!0,"create-tag":!0,options:I(k),placeholder:"Select Trade"},null,8,["modelValue","attrs","options"])])),_:2},1024)])),_:1})):m("",!0)]),r("div",ea,[c(U,{label:"Group Description"},{default:i((()=>[c(M,null,{default:i((()=>[c(R,{modelValue:I(T).description,"onUpdate:modelValue":l[7]||(l[7]=e=>I(T).description=e),placeholder:"Enter Group Proposal Title",rows:"3",type:"text"},null,8,["modelValue"])])),_:1})])),_:1})])])])),action:i((()=>[c(O,{loading:I(v),type:"submit",color:"warning",raised:""},{default:i((()=>[_("Group Proposals")])),_:1},8,["loading"])])),_:1},8,["open","onSubmit"])}}}),[["__scopeId","data-v-9236e8e6"]]),la=e=>(y("data-v-1cbfdf6b"),e=e(),v(),e),ta={class:"columns is-multiline"},oa={class:"column is-12 is-flex space-between"},sa=la((()=>r("div",null,null,-1))),ia={class:"is-flex"},na={class:"column is-12"},ra={class:"flex-list-wrapper flex-list-v2"},da=la((()=>r("img",{class:"light-image",src:te,alt:""},null,-1))),ua=la((()=>r("img",{class:"dark-image",src:oe,alt:""},null,-1))),pa={class:"tab-content is-active"},ca={class:"item-name dark-inverted"},ma={class:"item-meta"},_a={class:"light-text"},fa=g(a({__name:"ProposalGroupModal",props:{leadProposalListModal:{type:Boolean},leadID:{default:""}},emits:["update:modalHandler","update:OnSuccess"],setup(a,{emit:y}){const v=a,g=l([{id:"",proposalAmount:0,title:"",approval_deadline:"",internal_notes:"",introductory_text:"",closing_text:"",payment_status:"",type:"",status:"",created_at:"",updated_at:"",job:""}]),b=l("combine"),h=l(!1),k=l("active"),C=L(),T=l([]),V=l([{value:"",label:""}]),P=l(!1),x=l([]);x.value.map((e=>e.id));const j=l(""),q={picture:{label:"Proposal",grow:!0,media:!0},customer:"Type",industry:"Amount",status:"Status",team:{label:"Payment"},actions:{label:"Select",align:"end"}},E=l(!1),R=e=>{const a=x.value.findIndex((a=>a.id===e.id));-1!==a?x.value.splice(a,1):x.value.push(e)},O=S((()=>{if(j.value){const e=new RegExp(j.value,"i");return g.value.filter((a=>a.title.match(e)||a.description.match(e)))}return g.value})),D=()=>{y("update:modalHandler",!1)};return t((()=>{(async()=>{try{h.value=!0;const e=await C.get(`/api/lead-proposal/by-project/${v.leadID}/`);g.value=e.data}catch(e){console.log(e)}finally{h.value=!1}})(),(async()=>{try{const e=await C.get("/api/cost-trade/");V.value=e.data.map((e=>({value:e.id,label:e.name})))}catch(e){console.log(e)}})()})),(a,l)=>{const t=w("Multiselect"),y=A,g=B,C=f,S=le,j=ee,L=ae,$=G,Z=Y,F=X,z=aa,Q=H,J=e;return o(),s(J,{is:"form",open:v.leadProposalListModal,title:"Proposal List",size:"xl",actions:"right",onClose:D},{content:i((()=>[r("div",ta,[r("div",oa,[sa,r("div",ia,["trade"==I(b)?(o(),s(g,{key:0,style:{width:"340px"}},{default:i((({id:e})=>[c(y,null,{default:i((()=>[c(t,{modelValue:I(T),"onUpdate:modelValue":l[0]||(l[0]=e=>M(T)?T.value=e:null),attrs:{id:e},mode:"tags",searchable:!0,"create-tag":!0,options:I(V),placeholder:"Select Trades"},null,8,["modelValue","attrs","options"])])),_:2},1024)])),_:1})):m("",!0),c(C,{class:"ml-2",onClick:l[1]||(l[1]=e=>P.value=!I(P)),raised:"",color:"warning",light:"",outlined:"",icon:"lnil lnil-files-alt",disabled:!I(x).length},{default:i((()=>[_(" Group Proposal ")])),_:1},8,["disabled"]),c(C,{class:"ml-2",raised:"",icon:"fas fa-envelope",color:"info",light:"",disabled:!I(x).length,outlined:"",onClick:l[2]||(l[2]=e=>{E.value=!E.value})},{default:i((()=>[_(" Send ")])),_:1},8,["disabled"])])]),r("div",na,[r("div",ra,["active"===I(k)&&0===I(O).length?(o(),s(S,{key:0,title:"We couldn't find any matching results.",subtitle:"Too bad. Looks like we couldn't find any matching results for the\n          search terms you've entered. Please try different search terms or\n          criteria.",larger:""},{image:i((()=>[da,ua])),_:1})):m("",!0),r("div",pa,[I(O).length?(o(),s(Z,{key:0,data:I(O),columns:q,rounded:""},{body:i((()=>[c(U,{name:"list",tag:"div",class:"flex-list-inner"},{default:i((()=>[(o(!0),n(d,null,u(I(O),(e=>(o(),n("div",{key:e.id,class:"flex-table-item"},[c(j,{column:{media:!0,grow:!0}},{default:i((()=>[r("div",null,[r("span",ca,p(e.title??"N/A"),1),r("span",ma,[r("span",null,p(I(N)(e.created_at)),1)])])])),_:2},1024),c(j,null,{default:i((()=>[c(L,null,{default:i((()=>[_(p(e.type),1)])),_:2},1024)])),_:2},1024),c(j,null,{default:i((()=>[r("span",_a,"$"+p(e.proposalAmount),1)])),_:2},1024),c(j,null,{default:i((()=>[c(L,{rounded:""},{default:i((()=>[_(p(e.status),1)])),_:2},1024)])),_:2},1024),c(j,null,{default:i((()=>[c(L,{rounded:""},{default:i((()=>[_(p(e.status),1)])),_:2},1024)])),_:2},1024),c(j,{column:{align:"end"}},{default:i((()=>[c(y,{raw:"",subcontrol:""},{default:i((()=>[c($,{onClick:()=>{R(e)},modelValue:e.payment_status,"onUpdate:modelValue":a=>e.payment_status=a,label:"",color:"primary"},null,8,["onClick","modelValue","onUpdate:modelValue"])])),_:2},1024)])),_:2},1024)])))),128))])),_:1})])),_:1},8,["data"])):m("",!0),I(O).length>5?(o(),s(F,{key:1,"item-per-page":10,"total-items":873,"current-page":42,"max-links-displayed":7})):m("",!0)])])]),I(P)?(o(),s(z,{key:0,groupProposalModal:I(P),selectedProposals:I(x),onRemoveProposal:R,"onUpdate:modalHandler":l[3]||(l[3]=e=>P.value=!I(P))},null,8,["groupProposalModal","selectedProposals"])):m("",!0),I(E)?(o(),s(Q,{key:1,proposalSenderModal:I(E),selectedProposalsIds:I(x),"onUpdate:modalHandler":l[4]||(l[4]=e=>E.value=!1)},null,8,["proposalSenderModal","selectedProposalsIds"])):m("",!0)])])),action:i((()=>[c(C,{loading:I(h),style:{display:"none"},color:"warning",raised:"",onClick:D},{default:i((()=>[_("Close")])),_:1},8,["loading"])])),_:1},8,["open"])}}}),[["__scopeId","data-v-1cbfdf6b"]]),ya=l([{id:"12347",title:"Electrical Wiring",cost_code:"040100",cost_type:"Material",unit_cost:20,quantity:500,unit:"meters",total_cost:1e4,price:750,markup:15,markup_type:"percentage",markup_value:1500,markup_amount:3e3,unit_price:50,tax_rate:7.5,client_price:12000.9,total_price:9e3,builder_cost:825,group_price:78987,grand_total:12325,total_markup:9874567,mark_as:"catalogue_item",description:"Electrical wiring and related materials.",internal_notes:"Include wiring for backup generator.",created_by:"user125",created_date:"2024-12-22T12:00:00Z",updated_by:"user125",updated_date:"2024-12-22T13:00:00Z",approved_by:"manager458",approval_date:"2024-12-22T18:00:00Z",status:"pending",category:"Electrical",tags:["wiring","electrical","materials"],attachments:[],visibility:{admin:!0,internal_only:!1,shared_with_client:!1},front_end_elements:{highlighted:!1,background_color:"#f0f0f0",font_color:"#000000",display_order:3,editable:!0}},{id:"56789",title:"Plumbing Fixtures",cost_code:"050200",cost_type:"Labor",unit_cost:45,quantity:200,unit:"hours",total_cost:9e3,price:1500,markup:20,markup_type:"percentage",markup_value:1800,markup_amount:3600,unit_price:75,tax_rate:8,client_price:12000.9,total_price:10800,builder_cost:950,group_price:67890,grand_total:13200,total_markup:1234567,mark_as:"custom_item",description:"Installation of plumbing fixtures.",internal_notes:"Check water pressure before installation.",created_by:"user456",created_date:"2024-11-30T09:00:00Z",updated_by:"user456",updated_date:"2024-12-01T10:00:00Z",approved_by:"manager123",approval_date:"2024-12-01T15:00:00Z",status:"approved",category:"Plumbing",tags:["plumbing","fixtures","labor"],attachments:[],visibility:{admin:!0,internal_only:!0,shared_with_client:!1},front_end_elements:{highlighted:!0,background_color:"#ffffff",font_color:"#333333",display_order:1,editable:!1}},{id:"90123",title:"HVAC Installation",cost_code:"070300",cost_type:"Service",unit_cost:75,quantity:50,unit:"units",total_cost:3750,client_price:12000.9,price:850,markup:10,markup_type:"fixed",markup_value:850,markup_amount:1700,unit_price:95,tax_rate:6.5,total_price:4200,builder_cost:1025,group_price:56789,grand_total:15500,total_markup:654321,mark_as:"service_item",description:"HVAC system installation and setup.",internal_notes:"Ensure proper duct sealing.",created_by:"user789",created_date:"2024-12-10T14:00:00Z",updated_by:"user789",updated_date:"2024-12-15T11:30:00Z",approved_by:"manager567",approval_date:"2024-12-16T09:00:00Z",status:"completed",category:"HVAC",tags:["HVAC","installation","service"],attachments:[],visibility:{admin:!0,internal_only:!1,shared_with_client:!0},front_end_elements:{highlighted:!0,background_color:"#e6e6e6",font_color:"#111111",display_order:2,editable:!0}},{id:"34567",title:"Roofing Materials",cost_code:"080500",cost_type:"Material",unit_cost:30,quantity:1e3,unit:"sheets",total_cost:3e4,client_price:12000.9,price:1200,markup:25,markup_type:"percentage",markup_value:3e3,markup_amount:7500,unit_price:90,tax_rate:9,total_price:32700,builder_cost:1125,group_price:43210,grand_total:37500,total_markup:98765,mark_as:"material_item",description:"High-quality roofing materials.",internal_notes:"Ensure weather-resistant properties.",created_by:"user321",created_date:"2024-12-05T08:00:00Z",updated_by:"user321",updated_date:"2024-12-06T12:00:00Z",approved_by:"manager789",approval_date:"2024-12-07T14:00:00Z",status:"pending",category:"Roofing",tags:["roofing","materials","construction"],attachments:[],visibility:{admin:!1,internal_only:!0,shared_with_client:!0},front_end_elements:{highlighted:!1,background_color:"#dddddd",font_color:"#444444",display_order:4,editable:!1}}]);l({CostCode:"Cost Code",Title:"Title",Unit:"Unit",Description:"Description",CostType:"Cost Type",MarkAs:"Mark As",Quantity:"Quantity",UnitCost:"Unit Cost",BuilderCost:"Builder Cost",Markup:"Markup",MarkupAmount:"Markup Amount",Status:"Status",ClientPrice:"Client Price",GroupPrice:"Group Price",TotalCost:"Total Cost",TotalMarkup:"Total Markup",Profit:"Profit",Notes:"Internal Notes",State:"State"}),l({CostCode:"cost_code",Title:"title",Unit:"unit",Description:"description",CostType:"cost_type",MarkAs:"mark_as",Quantity:"quantity",UnitCost:"unit_cost",ClientPrice:"total_price",BuilderCost:"builder_cost",Markup:"markup",Status:"status",GroupPrice:"group_amount",TotalMarkup:"total_markup",Profit:"profit",Notes:"internal_notes",MarkupAmount:"markup_amount"});const va={class:"columns is-multiline"},ga={class:"column is-12"},ba={class:"invoice-wrapper"},ha=r("div",{class:"invoice-header"},[r("div",{class:"left"},[r("h3",null,"Proposal-ID PD-456-14")]),r("div",{class:"right"},[r("div",{class:"controls"},[r("a",{class:"action"},[r("i",{"aria-hidden":"true",class:"iconify","data-icon":"feather:printer"})]),r("a",{class:"action"},[r("i",{"aria-hidden":"true",class:"iconify","data-icon":"feather:download-cloud"})]),r("a",{class:"action"},[r("i",{"aria-hidden":"true",class:"iconify","data-icon":"feather:mail"})])])])],-1),ka={class:"invoice-body"},wa={class:"invoice-card"},Ca={class:"invoice-section is-flex is-bordered"},Ta=r("div",{class:"meta"},null,-1),Va=r("div",{class:"end"},[r("span",null,"PO Box 242"),r("span",null,"Evergreen, CO 80437-0242"),r("span",null,"Phone: 720 272-9061"),r("span",null,"Premium Trades for Premier Builders")],-1),Ia=r("div",{class:"invoice-section is-flex is-bordered"},[r("div",{class:"meta"},[r("h3",null,"Client Name"),r("span",null,"Client Phone"),r("span",null,"25724 Independence Trail Evergreen, CO 80439")]),r("div",{class:"end is-left"},[r("h3",null,"Friday Jan 17, 2025"),r("p",null," Lorem ipsum dolor sit amet, consectetur adipiscing elit. Quod equidem non reprehendo. ")])],-1),Pa={key:0,class:"invoice-section"},xa={class:"responsive-table"},Sa=r("br",null,null,-1),ja=["innerHTML"],Ma={class:"invoice-section is-flex mt-0 pt-0"},Ua={class:"end is-left"},Aa={class:"text-right"},qa=r("p",null,"Mentioned price are final",-1),La=a({__name:"ProposalViewModal",props:{previewModal:{type:Boolean},columnsToShow:{default:!1},proposalId:{default:""}},emits:["update:modalHandler","update:OnSuccess"],setup(a,{emit:y}){const v=a,g=L();R();const b=l([{name:"Website Redesign",unit:"hrs",quantity:54,rate:24},{name:"Logo Design",unit:"hrs",quantity:12,rate:24},{name:"Custom Illustrations",unit:"hrs",quantity:7,rate:32}]);S((()=>{const e=b.value.reduce(((e,a)=>e+a.quantity*a.rate),0),a=.1*e;return[{label:"Subtotal",value:e},{label:"Taxes",value:a},{label:"Total",value:e+a}]}));const h=["Item","Description","Unit Cost","Qty","Unit","Builder Cost","Markup","Total Price"];l(""),l(!0),l(!0),l(!0),l(!0);const k=S((()=>ya.value.reduce(((e,a)=>e+a.price*a.quantity),0))),w=l(!1);l({id:"c897de41-609f-4a20-8d79-0537b6a873d6",title:"Test Lead's Proposal",approval_deadline:"2025-01-30",internal_notes:null,introductory_text:null,closing_text:null,payment_status:"Pending",type:"proposal",status:"pending",created_at:"2025-01-21T19:08:06.509861Z",updated_at:"2025-01-21T19:08:06.509875Z",job:"da0aa7c1-3744-4856-a637-e5a821f5ec7e"});const C=l([{id:"5e7d026a-b392-47e9-9d24-58fbc1de12c5",index:1,title:"Test Lead Proposal Item",description:"<p>Description</p>",type:"",quantity:100,unit:"Sq ft",unit_cost:"10.00",markup:"150.00",total_price:"1150.00",cost_code:"11012",cost_type:"material",builder_cost:"1000.00",margin:"1.00",profit:"0.00",internal_notes:"Internal notes",mark_as:"bid",state:"active",group_amount:"0.00",status:null,created_at:"2025-01-23T18:25:46.392750Z",proposal:"c897de41-609f-4a20-8d79-0537b6a873d6"}]),T=()=>{y("update:modalHandler",!1)},V=async()=>{try{const e=await g.get(`api/cost/by-proposal/${v.proposalId}/`);C.value=e.data}catch(e){console.log(e)}};return t((()=>{(async()=>{try{w.value=!0,await g.get(`/api/lead-proposal/${v.proposalId}/`),V()}catch(e){console.log(e)}finally{w.value=!1}})()})),(a,l)=>{const t=se,y=f,g=e;return o(),s(g,{is:"form",open:v.previewModal,title:"Cost Item ",size:"xl",actions:"right",onClose:T},{content:i((()=>[r("div",va,[r("div",ga,[r("div",ba,[ha,r("div",ka,[r("div",wa,[r("div",Ca,[c(t,{size:"xl",picture:"/logos/IbexFavicon.png"}),Ta,Va]),Ia,I(C).length?(o(),n("div",Pa,[r("table",xa,[r("thead",null,[(o(),n(d,null,u(h,((e,a)=>r("th",{key:a},p(e),1))),64))]),r("tbody",null,[(o(!0),n(d,null,u(I(C),((e,a)=>(o(),n("tr",{key:e.id},[r("td",null,[r("span",null,p(e.title),1),Sa,r("span",null,p(e.cost_code),1)]),r("td",null,[r("span",{innerHTML:e.description},null,8,ja)]),r("td",null,[r("span",null," $"+p(e.unit_cost),1)]),r("td",null,[r("span",null,p(e.quantity),1)]),r("td",null,[r("span",null,p(e.unit),1)]),r("td",null,[r("span",null," $"+p(e.builder_cost),1)]),r("td",null,[r("span",null," $"+p(e.markup),1)]),r("td",null,[r("span",null," $"+p(e.total_price),1)])])))),128))])])])):m("",!0),r("div",Ma,[r("div",Ua,[r("h3",Aa,"Total Price: $"+p(I(k)),1),qa])])])])])])])])),action:i((()=>[c(y,{loading:I(w),type:"submit",color:"warning",raised:"",onClick:T},{default:i((()=>[_("Close")])),_:1},8,["loading"])])),_:1},8,["open"])}}});export{Be as _,La as a,fa as b};
