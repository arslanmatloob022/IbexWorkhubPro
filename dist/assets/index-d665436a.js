import{e,r as l,o as a,M as t,y as s,z as i,C as n,K as o,A as u,B as d,l as r,J as c,D as m,Q as p,R as _,j as v,P as f,E as y,v as b,H as h,ak as g}from"./index-27d764e5.js";import{_ as V}from"./VInput.vue_vue_type_script_setup_true_lang-a57dc692.js";import{_ as x}from"./VTextarea.vue_vue_type_script_setup_true_lang-11e26c85.js";import{_ as k,a as j}from"./VOption.vue_vue_type_style_index_0_lang-5dba0267.js";import{_ as w}from"./VLabel.vue_vue_type_script_setup_true_lang-e1ba7993.js";import{_ as C}from"./VField.vue_vue_type_script_setup_true_lang-3883933c.js";import{_ as q}from"./VControl-0a369a39.js";import{_ as A}from"./VAvatar.vue_vue_type_style_index_0_lang-9e73993d.js";import{u as P}from"./useAPI-768a54f7.js";import{u as S}from"./useNotyf-e46165f1.js";import{a as I}from"./useSupportElement-e4f1f3f1.js";import{u as U}from"./viewWrapper-95f7ae4f.js";import{b as N}from"./route-block-83d24a4e.js";import"./useVFieldContext-e8870650.js";import"./userSession-7717da75.js";import"./notyf-6b1767ac.js";import"./useThemeColors-1b6e5c3d.js";const L={class:"banking-dashboard banking-dashboard-v1"},z={class:"columns is-multiline"},T={class:"column is-12"},Q={class:"columns is-multiline"},F={class:"column is-6"},J={class:"dashboard-card is-contacts"},O=n("div",{class:"title-wrap"},[n("h3",{class:"dark-inverted"},"Create link")],-1),B=["onSubmit"],M={class:"transfer-form"},$=n("label",{for:""}," Client",-1),D={class:"multiselect-single-label"},E={class:"select-label-text"},H={class:"select-label-text"},K={class:"field"},R=n("label",null,"Description* (Job Name, Invoice Number etc)",-1),W=["onSubmit"],G={class:"column is-12"},X={class:"columns is-multiple"},Y={class:"column is-12"},Z={class:"mb-2"},ee={class:"is-bold"},le=n("br",null,null,-1),ae={class:"submit-wrap mt-5"},te={class:"column is-6"},se={class:"dashboard-card"},ie=n("div",{class:"title-wrap"},[n("h3",{class:"dark-inverted"},"Payment links")],-1),ne={key:0,class:"context-text"},oe=e({__name:"IbexPaymentModule",setup(e){const b=P(),h=S();l(!1);const g=l(""),U=l([]),N=l(!1);l(!1);const oe=l(!1),ue=l({payment_method:"us_bank_account",description:"",client:"",enableTax:!1,itemsList:[]}),de=l({title:"",amount:0,quantity:0}),re=()=>{ue.value.itemsList.push(de.value),console.log("data",ue.value),de.value={title:"",amount:0,quantity:0}},ce=async()=>{try{oe.value=!0;const e=I(ue.value,[""]);e.append("itemsList",JSON.stringify(ue.value.itemsList));const l=await b.post("/api/paypal/stripe-session-new/",e);g.value=l.data.url,h.success("link Created")}catch(e){h.success("Something went wrong")}finally{oe.value=!1}};return a((()=>{(async()=>{try{N.value=!0;const e=await b.get("/api/users/by-role/client/",{});U.value=e.data.map((e=>({value:e.id,name:e.username,icon:e.avatar})))}catch(e){console.log(e)}finally{N.value=!1}})()})),(e,l)=>{const a=A,b=t("Multiselect"),P=q,S=C,I=w,N=k,me=j,pe=x,_e=V,ve=y;return s(),i("div",L,[n("div",z,[n("div",T,[n("div",Q,[n("div",F,[n("div",J,[O,n("form",{action:"",onSubmit:o(ce,["prevent"])},[n("div",M,[u(S,{class:"is-image-select has-curved-images"},{default:d((()=>[$,u(P,null,{default:d((()=>[u(b,{modelValue:r(ue).client,"onUpdate:modelValue":l[0]||(l[0]=e=>r(ue).client=e),placeholder:"Select a client",label:"name","max-height":145,options:r(U)},{singlelabel:d((({value:e})=>[n("div",D,[u(a,{class:"select-option-icon",size:"xs",squared:"",picture:e.icon},null,8,["picture"]),n("span",E,c(e.name),1)])])),option:d((({option:e})=>[u(a,{class:"select-option-icon",size:"xs",squared:"",picture:e.icon},null,8,["picture"]),n("span",H,c(e.name),1)])),_:1},8,["modelValue","options"])])),_:1})])),_:1}),u(S,{class:"field column is-12 p-0"},{default:d((()=>[u(I,{for:""},{default:d((()=>[m("Pay by")])),_:1}),u(me,{modelValue:r(ue).payment_method,"onUpdate:modelValue":l[1]||(l[1]=e=>r(ue).payment_method=e)},{default:d((()=>[u(N,{value:"us_bank_account"},{default:d((()=>[m("US Bank Account")])),_:1}),u(N,{value:"card"},{default:d((()=>[m("Credit Card")])),_:1}),u(N,{value:"both"},{default:d((()=>[m("Any")])),_:1})])),_:1},8,["modelValue"])])),_:1}),n("div",K,[R,u(S,null,{default:d((()=>[u(P,null,{default:d((()=>[u(pe,{required:"",modelValue:r(ue).description,"onUpdate:modelValue":l[2]||(l[2]=e=>r(ue).description=e),class:"is-primary-focus",rows:"2",placeholder:"Job Name: , Invoice Number:  "},null,8,["modelValue"])])),_:1})])),_:1})]),n("form",{action:"post",onSubmit:o(re,["prevent"])},[u(S,null,{default:d((()=>[u(I,null,{default:d((()=>[m("Title")])),_:1}),u(P,null,{default:d((()=>[u(_e,{required:"",modelValue:r(de).title,"onUpdate:modelValue":l[3]||(l[3]=e=>r(de).title=e),type:"text",placeholder:"Item title"},null,8,["modelValue"])])),_:1})])),_:1}),n("div",G,[n("div",X,[u(S,{class:"field column is-6 p-0"},{default:d((()=>[u(I,null,{default:d((()=>[m("Amount in ($)")])),_:1}),u(P,null,{default:d((()=>[u(_e,{required:"",modelValue:r(de).amount,"onUpdate:modelValue":l[4]||(l[4]=e=>r(de).amount=e),type:"text",placeholder:"Amount in $"},null,8,["modelValue"])])),_:1})])),_:1}),u(S,{class:"field column is-6 p-0"},{default:d((()=>[u(I,null,{default:d((()=>[m("Quantity")])),_:1}),u(P,null,{default:d((()=>[u(_e,{modelValue:r(de).quantity,"onUpdate:modelValue":l[5]||(l[5]=e=>r(de).quantity=e),type:"text",placeholder:"Quantity"},null,8,["modelValue"])])),_:1})])),_:1})])]),u(ve,{type:"submit",color:"info",size:"big",fullwidth:"",loading:r(oe),raised:"",bold:""},{default:d((()=>[m(" Add Item ")])),_:1},8,["loading"])],40,W),n("div",Y,[(s(!0),i(p,null,_(r(ue).itemsList,((e,l)=>(s(),i("div",Z,[n("p",ee,[n("span",null,c(l+1)+". ",1),n("span",null,c(e.title),1)]),n("p",null,[n("span",null,"Amount: $"+c(e.amount),1),le,n("span",null,"Quantity: "+c(e.quantity?e.quantity:""),1)])])))),256))]),n("div",ae,[u(ve,{type:"submit",color:"primary",size:"big",fullwidth:"",loading:r(oe),raised:"",bold:""},{default:d((()=>[m(" Create Payment link ")])),_:1},8,["loading"])])])],40,B)])]),n("div",te,[n("div",se,[ie,u(S,{label:"Checkout link",addons:""},{default:d((()=>[u(P,{expanded:""},{default:d((()=>[u(_e,{type:"text",modelValue:r(g),"onUpdate:modelValue":l[6]||(l[6]=e=>v(g)?g.value=e:null),class:"input",placeholder:"link..."},null,8,["modelValue"])])),_:1}),u(P,null,{default:d((()=>[u(ve,{icon:"fas fa-copy",onClick:l[7]||(l[7]=e=>{var l;(l=r(g))?navigator.clipboard.writeText(l).then((()=>{h.success("Link copied to clipboard!")})).catch((e=>{h.error("Failed to copy the link: ",e)})):h.error("No link to copy!")}),class:"cu-pointer",color:"primary"},{default:d((()=>[m(" Copy ")])),_:1})])),_:1})])),_:1}),r(g)?(s(),i("p",ne," payment link has been successfully created ")):f("",!0)])])])])])])}}}),ue={class:"page-content-inner"},de=n("div",{class:"lifestyle-dashboard-bg has-top-nav"},null,-1),re=e({__name:"index",setup:e=>(U().setPageTitle("Ibex Payment"),b({title:"Ibex Payment"}),(e,l)=>{const a=oe;return s(),i("div",ue,[(s(),h(g,{to:"[data-teleport-bg]"},[de])),u(a,{class:"has-navbar-spacing"})])})});"function"==typeof N&&N(re);export{re as default};
