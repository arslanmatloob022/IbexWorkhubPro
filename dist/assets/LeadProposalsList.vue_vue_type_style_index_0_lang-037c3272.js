import{_ as e,a,b as l}from"./ProposalViewModal.vue_vue_type_style_index_0_lang-dcd3801e.js";import{_ as t}from"./SweetAlert.vue_vue_type_style_index_0_lang-b953efb6.js";import{b as s,c as o,d as i,e as n,f as r,h as d}from"./CreateProposalTasksModal-618fc13b.js";import{_ as p}from"./VFlexPagination.vue_vue_type_script_setup_true_lang-664d4643.js";import{_ as u}from"./VPlaceholderPage.vue_vue_type_style_index_0_lang-56a84cd8.js";import{_ as c,c as m}from"./VFlexTable.vue_vue_type_style_index_0_lang-bc2b3f50.js";import{_ as v}from"./VDropdown.vue_vue_type_style_index_0_lang-b699a3cd.js";import{_}from"./VTag.vue_vue_type_style_index_0_lang-44f287a8.js";import{e as y,v as f,x as k,r as h,Z as g,o as b,au as w,B as C,C as x,l as P,E as A,D as I,F as S,K as O,W as j,j as M,J as T,N as $,M as U,U as V,V as L,aR as D,O as E,T as H}from"./index-1fb32d56.js";import{_ as F}from"./VControl-08451c2f.js";import{_ as N}from"./PlaceloadV1.vue_vue_type_style_index_0_lang-27f18ddd.js";import{_ as z,a as B}from"./search-4-dark-2b5b440c.js";import{u as J}from"./useAPI-33adf908.js";import{u as R}from"./useNotyf-fd26dfc5.js";import{f as Y}from"./useSupportElement-1b217a2b.js";const K={key:0},W={key:1},Z={class:"flex-toolbar is-reversed is-flex space-between my-4"},q={class:"flex-list-wrapper flex-list-v2"},G={class:"item-name dark-inverted show-text-250"},Q={class:"item-meta"},X=I("i",{"aria-hidden":"true",class:"iconify","data-icon":"feather:clock"},null,-1),ee={class:"item-name dark-inverted"},ae={class:"light-text"},le=["onClick"],te=[I("div",{class:"icon"},[I("i",{"aria-hidden":"true",class:"lnil lnil-pencil"})],-1),I("div",{class:"meta"},[I("span",null,"Edit"),I("span",null,"Edit Proposal Details")],-1)],se=["onClick"],oe=[I("div",{class:"icon"},[I("i",{"aria-hidden":"true",class:"lnil lnil-eye"})],-1),I("div",{class:"meta"},[I("span",null,"Preview"),I("span",null,"Preview proposal detail")],-1)],ie=["onClick"],ne=[I("div",{class:"icon"},[I("i",{class:"lnil lnil-calender-alt-1","aria-hidden":"true"})],-1),I("div",{class:"meta"},[I("span",null,"Create Tasks"),I("span",null,"Create tasks in chart ")],-1)],re=I("hr",{class:"dropdown-divider"},null,-1),de=["onClick"],pe=[I("div",{class:"icon"},[I("i",{class:"lnir lnir-round-box-check","aria-hidden":"true"})],-1),I("div",{class:"meta"},[I("span",null,"Mark Approved"),I("span",null,"Mark Proposal As Approved")],-1)],ue=["onClick"],ce=[I("div",{class:"icon"},[I("i",{"aria-hidden":"true",class:"lnil lnil-trash-can-alt"})],-1),I("div",{class:"meta"},[I("span",null,"Delete"),I("span",null,"Delete from list")],-1)],me=I("img",{class:"light-image",src:z,alt:""},null,-1),ve=I("img",{class:"dark-image",src:B,alt:""},null,-1),_e=y({__name:"LeadProposalsList",props:{activeTab:{default:"active"},leadId:{default:""},allProposal:{type:Boolean,default:!1}},emits:["updateCompany"],setup(y,{emit:z}){const B=y,_e=f();k();const ye=J(),fe=R(),ke=h(!1),he=h([]),ge=h(!1),be=h(""),we=h(!1),Ce=h(!1),xe=h(""),Pe=h("");h(B.activeTab);const Ae=h({title:"",subtitle:"test",isSweetAlertOpen:!1,btntext:"text"}),Ie=h({title:"",subtitle:"",isSweetAlertOpen:!1,btntext:""}),Se=async()=>{try{ke.value=!0;await ye.delete(`/api/lead-proposal/${Pe.value}/`);fe.success("Proposal delete successfully"),Le()}catch(e){fe.error(` ${e}, Proposal`),fe.error("Something went wrong please try later")}finally{ke.value=!1,Ae.value.isSweetAlertOpen=!1}},Oe={picture:{label:"Proposal",grow:!0,media:!0},industry:"Type",status:"Status",amount:{label:"Total Amount",media:!0},customer:"Calendar Tasks ",actions:{label:"Actions",align:"end"}},je=g((()=>{if(xe.value){const e=new RegExp(xe.value,"i");return he.value.filter((a=>a.title.match(e)||a.approval_deadline.match(e)))}return he.value})),Me=h(!1),Te=h(!1),$e=h(!1),Ue=h(""),Ve=e=>{_e.push(`/sidebar/dashboard/proposals/${e}`)},Le=()=>{1==B.allProposal?(async()=>{try{ke.value=!0;const e=await ye.get("/api/lead-proposal/");he.value=e.data}catch(e){fe.error(` ${e}, Lead`)}finally{ke.value=!1}})():B.leadId&&(async()=>{try{ke.value=!0;const e=await ye.get(`/api/lead-proposal/by-project/${B.leadId}/`);he.value=e.data}catch(e){fe.error(` ${e}, Lead`)}finally{ke.value=!1}})()};return b((()=>{Le()})),(y,f)=>{const k=N,h=F,g=E,b=m,J=_,R=v,_e=c,De=u,Ee=p,He=s,Fe=e,Ne=a,ze=o,Be=t,Je=l,Re=w("tooltip");return C(),x("div",null,[P(ke)?(C(),x("div",K,[A(k)])):(C(),x("div",W,[I("div",Z,[A(h,{icon:"feather:search"},{default:S((()=>[O(I("input",{"onUpdate:modelValue":f[0]||(f[0]=e=>M(xe)?xe.value=e:null),class:"input custom-text-filter",placeholder:"Search..."},null,512),[[j,P(xe)]])])),_:1}),I("div",null,[A(g,{color:"primary",onClick:f[1]||(f[1]=e=>ge.value=!P(ge)),icon:"fas fa-plus"},{default:S((()=>[T("Lead Proposal ")])),_:1}),B.leadId?(C(),$(g,{key:0,color:"warning",class:"ml-2",onClick:f[2]||(f[2]=e=>{Ce.value=!0}),icon:"fas fa-cogs"},{default:S((()=>[T("Proposals")])),_:1})):U("",!0)])]),I("div",q,[P(je).length>0&&P(he).length>0?(C(),$(_e,{key:0,data:P(je),columns:Oe,rounded:""},{body:S((()=>[A(D,{name:"list",tag:"div",class:"flex-list-inner"},{default:S((()=>[(C(!0),x(V,null,L(P(je),(e=>(C(),x("div",{key:e.id,class:"flex-table-item"},[A(b,{column:{media:!0,grow:!0},class:"cu-pointer",onClick:a=>Ve(e.id)},{default:S((()=>[O((C(),x("div",null,[I("span",G,H(e.title),1),I("span",Q,[I("span",null,[X,T(H(P(Y)(e.created_at)),1)])])])),[[Re,`${e.title}`,void 0,{rounded:!0,light:!0}]])])),_:2},1032,["onClick"]),A(b,{class:"cu-pointer",onClick:a=>Ve(e.id)},{default:S((()=>[A(J,{rounded:"",color:P(i)[e.type]},{default:S((()=>[T(H(P(n)[e.type]),1)])),_:2},1032,["color"])])),_:2},1032,["onClick"]),A(b,{class:"cu-pointer",onClick:a=>Ve(e.id)},{default:S((()=>[A(J,{class:"capitalized",rounded:"",color:P(r)[e.status]},{default:S((()=>[T(H(P(d)[e.status]),1)])),_:2},1032,["color"])])),_:2},1032,["onClick"]),A(b,{class:"cu-pointer",onClick:a=>Ve(e.id),column:{media:!0}},{default:S((()=>[I("div",null,[I("span",ee,"$"+H(e.proposalAmount),1),I("span",ae,H(e.payment_status),1)])])),_:2},1032,["onClick"]),A(b,{class:"cu-pointer",onClick:a=>Ve(e.id)},{default:S((()=>[A(J,{color:"purple",outlined:""},{default:S((()=>[T(H(e.is_task_created?"Created":"Not Created"),1)])),_:2},1024)])),_:2},1032,["onClick"]),A(b,{column:{align:"end"}},{default:S((()=>[A(R,{class:"is-pushed-mobile",icon:"feather:more-vertical",spaced:"",right:""},{content:S((()=>[I("a",{role:"menuitem",onClick:a=>{return l=e.id,be.value=l,void(ge.value=!0);var l},class:"dropdown-item is-media"},te,8,le),I("a",{disabled:"",role:"menuitem",onClick:a=>{return l=e.id,Te.value=l,void(Me.value=!Me.value);var l},class:"dropdown-item is-media"},oe,8,se),"approved"==e.status?(C(),x("a",{key:0,role:"menuitem",onClick:a=>{return l=e.id,be.value=l,void(we.value=!0);var l},class:"dropdown-item is-media"},ne,8,ie)):U("",!0),re,"approved"!=e.status?(C(),x("a",{key:1,role:"menuitem",onClick:a=>(async(e,a)=>{try{await ye.patch(`/api/lead-proposal/${a}/`,{status:e}),fe.success(`You have ${e} this proposal.`),"approved"==e&&z("updateCompany",null),Le()}catch(l){console.log(l)}})("approved",e.id),class:"dropdown-item is-media"},pe,8,de)):U("",!0),I("a",{role:"menuitem",onClick:a=>{return l=e.id,Pe.value=l,void(Ae.value={title:"Delete Proposal?",subtitle:"Are you sure to delete this proposal? After delete you will not be able to recover it again.",btntext:"Yes delete",isSweetAlertOpen:!0});var l},class:"dropdown-item is-media"},ce,8,ue)])),_:2},1024)])),_:2},1024)])))),128))])),_:1})])),_:1},8,["data"])):U("",!0),P(he).length<1&&0==P(je).length?(C(),$(De,{key:1,title:"There is no proposal created on this lead!",subtitle:"Too bad. Looks like we couldn't created any proposal on this Lead, please create proposal and release to the client",larger:""},{image:S((()=>[me,ve])),_:1})):U("",!0),P(je).length>5?(C(),$(Ee,{key:2,"item-per-page":10,"total-items":873,"current-page":42,"max-links-displayed":7})):U("",!0)]),P(we)?(C(),$(He,{key:0,createProposalTasksModal:P(we),proposalId:P(be),onCloseModalHandler:f[3]||(f[3]=e=>we.value=!1),"onUpdate:OnSuccess":Le},null,8,["createProposalTasksModal","proposalId"])):U("",!0),P(ge)?(C(),$(Fe,{key:1,leadId:B.leadId,proposalId:P(be),leadProposalModal:P(ge),"onUpdate:modalHandler":f[4]||(f[4]=e=>ge.value=!1),"onUpdate:OnSuccess":Le,onClearProposalId:f[5]||(f[5]=e=>be.value="")},null,8,["leadId","proposalId","leadProposalModal"])):U("",!0),P(Me)?(C(),$(Ne,{key:2,"preview-modal":P(Me),proposalId:P(Te),"onUpdate:modalHandler":f[6]||(f[6]=e=>Me.value=!1)},null,8,["preview-modal","proposalId"])):U("",!0),P($e)?(C(),$(ze,{key:3,costItemModal:P($e),proposalId:P(Ue),"onUpdate:modalHandler":f[7]||(f[7]=e=>$e.value=!1),"onUpdate:OnSuccess":Le},null,8,["costItemModal","proposalId"])):U("",!0),P(Ae).isSweetAlertOpen?(C(),$(Be,{key:4,isSweetAlertOpen:P(Ae).isSweetAlertOpen,title:P(Ae).title,subtitle:P(Ae).subtitle,btntext:P(Ae).btntext,onConfirm:Se,onCancel:()=>P(Ae).isSweetAlertOpen=!1},null,8,["isSweetAlertOpen","title","subtitle","btntext","onCancel"])):U("",!0),P(Ie).isSweetAlertOpen?(C(),$(Be,{key:5,isSweetAlertOpen:P(Ie).isSweetAlertOpen,title:P(Ie).title,subtitle:P(Ie).subtitle,btntext:P(Ie).btntext,onConfirm:Se,onCancel:()=>P(Ie).isSweetAlertOpen=!1},null,8,["isSweetAlertOpen","title","subtitle","btntext","onCancel"])):U("",!0),P(Ce)?(C(),$(Je,{key:6,leadProposalListModal:P(Ce),leadID:B.leadId,"group-proposal-modal":P(Ce),"onUpdate:modalHandler":f[8]||(f[8]=e=>Ce.value=!1)},null,8,["leadProposalListModal","leadID","group-proposal-modal"])):U("",!0)]))])}}});export{_e as _};
