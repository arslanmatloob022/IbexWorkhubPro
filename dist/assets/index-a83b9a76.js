import{_ as e}from"./SweetAlert.vue_vue_type_style_index_0_lang-776f3a3f.js";import{_ as t}from"./CompanyLargeModal-292c35ad.js";import{_ as s}from"./VFlexPagination.vue_vue_type_script_setup_true_lang-19353aec.js";import{_ as a}from"./VPlaceholderPage.vue_vue_type_style_index_0_lang-75564e1d.js";import{_ as l,c as i}from"./VFlexTable.vue_vue_type_style_index_0_lang-ab11cfa6.js";import{_ as n}from"./VDropdown.vue_vue_type_style_index_0_lang-dab44eb0.js";import{_ as o}from"./VAvatar.vue_vue_type_style_index_0_lang-584dd1be.js";import{_ as r}from"./PlaceloadV1.vue_vue_type_style_index_0_lang-203bc318.js";import{e as u,M as c,L as p,r as d,Z as m,o as _,K as v,v as g,x as y,A as f,y as h,z as b,R as x,S as k,B as j,F as C,O as w,l as V,P as O,Q as A,aR as S,j as P,C as T,a3 as I,H as M,V as B,W,J as z,t as N}from"./index-a3511ab8.js";import{_ as $}from"./VControl-f6dba4dd.js";import{_ as D,a as E}from"./projects-dark-4a371d8a.js";import{u as F}from"./company-ca9a809c.js";import{u as R}from"./useNotyf-bee6672a.js";import{u as U}from"./useAPI-2f913358.js";import{u as L}from"./viewWrapper-a34f2b5b.js";import"./VOption.vue_vue_type_style_index_0_lang-787ebf49.js";import"./useVFieldContext-f66aca7a.js";import"./VField.vue_vue_type_script_setup_true_lang-e06a2d38.js";import"./VLabel.vue_vue_type_script_setup_true_lang-dfa6e2cd.js";import"./VIconButton-87810f23.js";import"./upload-3-734dffd5.js";import"./useSupportElement-ec851bb5.js";import"./userSession-1e35e5f3.js";import"./VFlex.vue_vue_type_style_index_0_lang-2a70d1e0.js";import"./VIcon.vue_vue_type_script_setup_true_lang-639bef4b.js";import"./useDropdown-4068e34e.js";import"./VPlaceloadWrap-71c29bf4.js";import"./VPlaceloadText.vue_vue_type_style_index_0_lang-ab5188b6.js";import"./VPlaceloadAvatar.vue_vue_type_style_index_0_lang-66b5c7cb.js";import"./notyf-bdcd12d6.js";import"./useThemeColors-9cb1eefd.js";const Z=e=>(B("data-v-aeb7b07e"),e=e(),W(),e),Y=Z((()=>f("div",{class:"columns",style:{"justify-content":"end"}},null,-1))),q={class:"columns mt-5"},H={class:"column is-7"},G={class:"list-flex-toolbar mb-5",style:{"justify-content":"end"}},J={class:"flex-list-wrapper flex-list-v2 mt-5"},K={class:"user-meta"},Q={class:"item-name dark-inverted",style:{"margin-bottom":"6px !important",display:"flex","align-items":"center"}},X={key:0},ee={class:"item-meta"},te=Z((()=>f("i",{style:{width:"10px"},class:"iconify","data-icon":"feather:phone","aria-hidden":"true"},null,-1))),se={class:"item-meta"},ae={class:"light-text"},le=Z((()=>f("i",{class:"lnir lnir-control-panel","aria-hidden":"true"},null,-1))),ie={class:"light-text"},ne={class:"light-text"},oe={class:"light-text is-flex is-pointer",style:{position:"relative","align-items":"end",cursor:"pointer"}},re=Z((()=>f("div",{class:"icon"},[f("i",{"aria-hidden":"true",class:"lnil lnil-briefcase"})],-1))),ue=Z((()=>f("div",{class:"meta"},[f("span",null,"View"),f("span",null,"View business details")],-1))),ce=["onClick"],pe=[Z((()=>f("div",{class:"icon"},[f("i",{"aria-hidden":"true",class:"lnil lnil-pencil"})],-1))),Z((()=>f("div",{class:"meta"},[f("span",null,"Edit"),f("span",null,"Edit business details")],-1)))],de=Z((()=>f("hr",{class:"dropdown-divider"},null,-1))),me=["onClick"],_e=[Z((()=>f("div",{class:"icon"},[f("i",{"aria-hidden":"true",class:"lnil lnil-trash-can-alt"})],-1))),Z((()=>f("div",{class:"meta"},[f("span",null,"Delete"),f("span",null,"Delete from list")],-1)))],ve=Z((()=>f("img",{class:"light-image is-larger",src:D,alt:""},null,-1))),ge=Z((()=>f("img",{class:"dark-image is-larger",src:E,alt:""},null,-1))),ye=Z((()=>f("div",{class:"column is-5 mt-8 is-base-chart is-dark-bordered-12"},[f("div",{class:"content-box"},[f("h1",{class:"title is-5"},"Coverage Area"),f("div",{id:"myMap",style:{height:"550px",width:"550px","border-radius":"10px"}})])],-1))),fe=z(u({__name:"CustomerCompanies",setup(u){const B=L(),W=U(),z=c(),N=p(),D=F(),E=R(),Z=d(!1),fe=d(8),he=d(3),be=d("");d("add"),d(!1);const xe=d(""),ke=d(0),je=d(!1),Ce=d(0),we=d({title:"",subtitle:"test",isSweetAlertOpen:!1,btntext:"text"});let Ve={},Oe={};const Ae=d(!1),Se=[],Pe={registrationNumber:"Business Name",email:{label:"Reg# / UTR",align:"center"},relation:{label:"Business_Type",align:"center"},location:{label:"Location",align:"center"},actions:{label:"Actions",align:"end"}},Te=async()=>{Z.value=!0,Se.length=0;const e=await W.get(`/v3/api/customer-company/company/${D.loggedCompany.id}`);Se.push(...e.data),Ce.value=e.data.length,be.value="value",be.value="",Z.value=!1,$e(Se),B.setPageTitle(`Customers (${Ce?.value}) `)},Ie=m((()=>{let e=Se;if(be.value){const t=new RegExp(be.value,"i");e=Se.filter((e=>{const s=e.name&&e.name.match(t),a=e.email&&e.email.match(t);return s||a}))}return e})),Me=m((()=>{const e=(Be.value-1)*fe.value,t=e+fe.value;return Ie.value.slice(e,t)})),Be=m((()=>{let e=z.query.page;return e=null==e||"undefined"==e?1:z.query.page,Number.parseInt(z.query.page)||1})),We=(e=0)=>{xe.value=e,je.value=!0},ze=async()=>{try{we.value.isSweetAlertOpen=!1;await W.delete(`/v3/api/customer-company/${ke.value}/`,{});Te(),E.dismissAll(),E.success("Business Delete")}catch(e){console.error("ok",e)}};const Ne=e=>{e.latitude&&(Ve.panTo({lat:e.latitude,lng:e.longitude}),Ve.setZoom(8),function(e){const t=Oe[e];if(t){t.setOptions({strokeOpacity:.3}),t.setOptions({strokeWeight:50});for(const t in Oe)if(t!=e){const e=Oe[t];e&&(e.setOptions({strokeOpacity:.1}),e.setOptions({strokeWeight:20}))}}}(e.id))};function $e(e=Se){console.log("Map View:",e);Ve=new google.maps.Map(document.getElementById("myMap"),{center:{lat:51.4497984,lng:-.3464489},scrollwheel:!1,mapTypeId:google.maps.MapTypeId.Satellite,zoom:8}),e.forEach(((e,t)=>{if(!e.latitude)return;const s=new google.maps.Circle({strokeColor:e.color,strokeOpacity:.1,strokeWeight:25,fillColor:e.color,fillOpacity:.7,map:Ve,center:{lat:e.latitude,lng:e.longitude},radius:1e4*1.63});Oe[e.id]=s})),Ae.value=!1}const De=async e=>{try{const t=await W.get(`/v3/api/site/customer-company/${e}/`);console.log("customer site",t.data),$e(t.data)}catch(t){console.log(t)}};return _((()=>{B.setPageTitle(`Customers (${Ce?.value}) `),Te()})),(u,c)=>{const p=$,d=T,m=r,_=o,B=i,W=v("RouterLink"),z=n,D=l,E=a,F=s,R=t,U=e;return g(),y(O,null,[Y,f("div",q,[f("div",H,[f("div",null,[f("div",G,[h(p,{icon:"feather:search"},{default:b((()=>[x(f("input",{"onUpdate:modelValue":c[0]||(c[0]=e=>be.value=e),class:"input custom-text-filter",placeholder:"Search..."},null,512),[[k,be.value]])])),_:1}),h(d,{onClick:c[1]||(c[1]=e=>We()),class:"ml-2",color:"primary",icon:"fas fa-plus",elevated:""},{default:b((()=>[j(" New Business ")])),_:1})]),f("div",J,[Z.value?(g(),C(m,{key:0})):w("",!0),V(Me).length?(g(),C(D,{key:1,data:V(Me),columns:Pe,rounded:""},{body:b((()=>[h(S,{name:"list",tag:"div",class:"flex-list-inner"},{default:b((()=>[(g(!0),y(O,null,A(V(Me),((e,t)=>(g(),y("div",{key:e.id,class:"flex-table-item mt-1",style:I({backgroundImage:`linear-gradient(-175deg, white 50%, ${e.color}45)`})},[h(B,{column:{media:!0},onClick:t=>V(N).push({path:`/sidebar/company/business/${e.id}`,params:{id:e.id}})},{default:b((()=>[h(_,{size:"medium",picture:e.logo?e.logo:"/images/avatars/placeholder.jpg"},null,8,["picture"]),f("div",K,[f("span",Q,[j(M(e.name.slice(0,20))+" ",1),e.name.length>20?(g(),y("span",X,"...")):w("",!0)]),f("span",ee,[f("span",null,[te,j(" "+M(e.phone_number),1)])]),f("span",se,[f("span",ae,[le,j(" "+M(e.email?e.email.slice(0,12)+"..":"------"),1)])])])])),_:2},1032,["onClick"]),h(B,{column:{align:"center"},onClick:t=>De(e.id)},{default:b((()=>[f("span",ie,M(e.reg_no?e.reg_no.slice(0,20):"-------"),1)])),_:2},1032,["onClick"]),h(B,{column:{align:"center"},onClick:t=>De(e.id)},{default:b((()=>[f("span",ne,M(e.business_type?e.business_type.slice(0,20):"-------"),1)])),_:2},1032,["onClick"]),h(B,{onMouseleave:c[2]||(c[2]=e=>function(){Ve.setZoom(6);for(const e in Oe){const t=Oe[e];t&&(t.setOptions({strokeOpacity:.1}),t.setOptions({strokeWeight:20}))}}()),onMouseover:()=>Ne(e)},{default:b((()=>[f("div",oe,[f("div",null,[f("i",{class:"me-2 fa fa-map-marker mr-3",style:I({color:e?.color,fontSize:"30px"})},null,4),j(" "+M(e.address&&e.address.length>20?e.address.slice(0,20)+"...":e.address||"------------"),1)])])])),_:2},1032,["onMouseover"]),h(B,{column:{align:"end"}},{default:b((()=>[h(z,{style:{position:"relative"},class:"is-pushed-mobile",icon:"feather:more-vertical",spaced:"",right:""},{content:b((()=>[h(W,{role:"menuitem",href:"#",class:"dropdown-item is-media",to:{name:"/sidebar/company/business/[id]",params:{id:e.id}}},{default:b((()=>[re,ue])),_:2},1032,["to"]),f("a",{role:"menuitem",href:"#",class:"dropdown-item is-media",onClick:t=>We(e.id)},pe,8,ce),de,f("a",{role:"menuitem",href:"#",class:"dropdown-item is-media",onClick:t=>{return s=e.id,ke.value=s,void(we.value={title:"Are you sure?",subtitle:"You will not be able to recover this business!",btntext:"Yes, Delete it",isSweetAlertOpen:!0});var s}},_e,8,me)])),_:2},1024)])),_:2},1024)],4)))),128))])),_:1})])),_:1},8,["data"])):(g(),C(E,{key:2,title:"No service partners found.",subtitle:"It seems that you haven't connected with any service partners yet. As you begin to finalize projects, they will be displayed here."},{image:b((()=>[ve,ge])),_:1})),V(Ie).length>fe.value?(g(),C(F,{key:3,"item-per-page":fe.value,modelValue:V(Be),"onUpdate:modelValue":c[3]||(c[3]=e=>P(Be)?Be.value=e:null),"total-items":V(Ie).length,"current-page":V(Be),"max-links-displayed":he.value},null,8,["item-per-page","modelValue","total-items","current-page","max-links-displayed"])):w("",!0)])])]),ye]),je.value?(g(),C(R,{key:0,id:xe.value,openCustomCompany:je.value,"onUpdate:modalHandler":c[4]||(c[4]=e=>je.value=e),"onUpdate:OnSuccess":Te},null,8,["id","openCustomCompany"])):w("",!0),we.value.isSweetAlertOpen?(g(),C(U,{key:1,isSweetAlertOpen:we.value.isSweetAlertOpen,title:we.value.title,subtitle:we.value.subtitle,btntext:we.value.btntext,onConfirm:ze,onCancel:()=>we.value.isSweetAlertOpen=!1},null,8,["isSweetAlertOpen","title","subtitle","btntext","onCancel"])):w("",!0)],64)}}}),[["__scopeId","data-v-aeb7b07e"]]),he={class:"page-content-inner"},be=u({__name:"index",setup:e=>(L().setPageTitle("Customer Companies"),N({title:"Customer Companies - Arez"}),(e,t)=>{const s=fe;return g(),y("div",he,[h(s)])})});export{be as default};
