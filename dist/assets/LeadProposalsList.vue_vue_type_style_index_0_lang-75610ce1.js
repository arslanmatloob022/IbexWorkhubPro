import{_ as e}from"./VModal.vue_vue_type_style_index_0_lang-436e1f89.js";import{e as l,s as a,r as t,b as s,_ as o,o as n,i,B as d,N as r,F as u,D as p,H as c,l as m,G as v,C as _,K as f,W as y,E as g,M as b,J as h,T as k,I as w,O as x,A as P,j as C,R as V,Z as I,U as T,V as S,aR as A,P as j,Q as U,v as O,x as M}from"./index-c5eacac6.js";import{_ as q}from"./VTextarea.vue_vue_type_script_setup_true_lang-babbbab3.js";import{_ as D}from"./VInput.vue_vue_type_script_setup_true_lang-714bb8d5.js";import{_ as L}from"./VField.vue_vue_type_script_setup_true_lang-89a1ecaf.js";import{_ as $}from"./VControl-73271265.js";import{_ as H}from"./VRadio.vue_vue_type_style_index_0_lang-2b2809fc.js";import{u as E}from"./useAPI-026ef94e.js";import{u as R,s as W,_ as F,c as G,a as B}from"./WorksheetItems.vue_vue_type_script_setup_true_lang-1763129a.js";import{u as N}from"./useNotyf-29271abb.js";import{_ as z}from"./VFlexPagination.vue_vue_type_script_setup_true_lang-9894b9f4.js";import{_ as J,c as Z}from"./VFlexTable.vue_vue_type_style_index_0_lang-dc618d2c.js";import{_ as K}from"./VCheckbox.vue_vue_type_style_index_0_lang-7915ec6c.js";import{_ as Q}from"./VTag.vue_vue_type_style_index_0_lang-84118a5d.js";import{_ as Y}from"./VPlaceholderPage.vue_vue_type_style_index_0_lang-df0c06b0.js";import{_ as X,a as ee}from"./search-4-dark-2b5b440c.js";import{_ as le,a as ae}from"./projects-dark-4a371d8a.js";import{a as te,e as se,g as oe}from"./useSupportElement-fcd6e19c.js";import{_ as ne}from"./SweetAlert.vue_vue_type_style_index_0_lang-142709c4.js";import{_ as ie}from"./VAvatar.vue_vue_type_style_index_0_lang-0ceb3dc6.js";import{c as de}from"./proposalItems-0c14a59c.js";import{u as re}from"./userSession-333f1640.js";import{_ as ue}from"./VDropdown.vue_vue_type_style_index_0_lang-82539e0f.js";import{_ as pe}from"./PlaceloadV1.vue_vue_type_style_index_0_lang-ba577eeb.js";const ce={class:"modal-form columns is-multiline"},me={class:"tabs-wrapper column is-12 m-0"},ve={class:"tabs-inner"},_e={class:"tabs is-boxed"},fe=[p("span",null,"Proposal",-1)],ye=["disabled"],ge=[p("span",null,"Worksheet",-1)],be={key:0,class:"column is-12"},he={class:"columns is-multiline"},ke={class:"field column is-6 mb-0"},we=p("label",null,"Title: *",-1),xe={class:"control"},Pe={class:"column is-6"},Ce={class:"field column is-6"},Ve=p("label",null,"Approval Deadline *",-1),Ie={class:"control"},Te={class:"field column is-6"},Se=p("label",null,"Attachments",-1),Ae=p("div",{class:"file"},[p("label",{class:"file-label"},[p("input",{class:"file-input",type:"file",name:"resume"}),p("span",{class:"file-cta"},[p("span",{class:"file-icon"},[p("i",{class:"fas fa-cloud-upload-alt"})]),p("span",{class:"file-label"}," Choose a fileâ€¦ ")])])],-1),je={class:"column is-12"},Ue={class:"body-inner-content columns is-multiline"},Oe={class:"field column is-12"},Me=p("label",{for:"",class:"label"},"Internal Notes",-1),qe={class:"field column is-12 mb-0"},De=p("label",{for:"",class:"label"},"Introductory Text",-1),Le={class:"field column is-12 mb-0"},$e=p("label",{for:"",class:"label"},"Closing Text",-1),He={class:"column is-12"},Ee={key:0,class:"columns is-multiline"},Re=l({__name:"LeadProposalModal",props:{leadProposalModal:{type:Boolean},proposalId:{},leadId:{}},emits:["update:modalHandler","update:OnSuccess","clearProposalId"],setup(l,{emit:P}){const C=l;R();const V=a();re();const I=N(),T=E(),S=t(!1);t({}),t("");const A=t("general"),j=t({id:"",title:"",approval_deadline:"",internal_notes:"",introductory_text:null,closing_text:null,payment_status:"",worksheetItems:[],type:"proposal",job:"",attachments:[],columns_to_show:[],status:"",created_at:"",updated_at:""}),U=async(e=!0)=>{try{if(S.value=!0,!j.value.title&&!e)return;C.leadId&&(j.value.job=C.leadId),j.value.columns_to_show=JSON.stringify(W.value);const l=te(j.value,[]);if(C.proposalId||j.value.id){const e=await T.patch(`/api/lead-proposal/${C.proposalId?C.proposalId:j.value.id}/`,l);j.value=e.data}else{const e=await T.post("/api/lead-proposal/",l);j.value=e.data}M(),e&&I.success(`Proposal ${C.proposalId||j.value.id?"updated":"created"} successfully`)}catch(l){I.error("Something went wrong, try again")}finally{S.value=!1}},O=()=>{P("update:modalHandler",!1)},M=()=>{P("update:OnSuccess",null)},D=s((()=>o((()=>import("./ckeditor-6d8fc3b5.js").then((e=>e.c))),["assets/ckeditor-6d8fc3b5.js","assets/index-c5eacac6.js","assets/index-ce8747cd.css","assets/vue.runtime.esm-bundler-40e3d7c7.js"]).then((e=>e.default.component)))),G={fontFamily:{options:['"Montserrat", sans-serif','"Roboto", sans-serif']},height:"400px",minHeight:"400px"};return n((async()=>{V.value=await o((()=>import("./ckeditor-962b993d.js").then((e=>e.c))),["assets/ckeditor-962b993d.js","assets/index-c5eacac6.js","assets/index-ce8747cd.css"]).then((e=>e.default)),C.proposalId&&(async()=>{try{const e=await T.get(`/api/lead-proposal/${C.proposalId}/`);j.value=e.data,W.value=e.data.columns_to_show}catch(e){console.log(e)}})()})),i((()=>{P("clearProposalId",null),j.value={}})),(l,a)=>{const t=H,s=$,o=L,n=q,i=F,P=x,I=e;return d(),r(I,{is:"form",open:C.leadProposalModal,title:"Lead Proposal",size:"xl",actions:"right",onSubmit:w(U,["prevent"]),onClose:O},{content:u((()=>[p("div",ce,[p("div",me,[p("div",ve,[p("div",_e,[p("ul",null,[p("li",{class:c(["general"===m(A)?"is-active":"not-active"])},[p("a",{tabindex:"0",role:"button",onKeydown:a[0]||(a[0]=v(w((e=>A.value="general"),["prevent"]),["space"])),onClick:a[1]||(a[1]=e=>A.value="general")},fe,32)],2),p("li",{class:c(["CostWorksheet"===m(A)?"is-active":"not-active"])},[p("a",{tabindex:"0",role:"button",disabled:!!m(j).title,onKeydown:a[2]||(a[2]=v(w((e=>A.value="CostWorksheet"),["prevent"]),["space"])),onClick:a[3]||(a[3]=()=>{A.value="CostWorksheet",U(!1)})},ge,40,ye)],2)])])])]),"general"==m(A)?(d(),_("div",be,[p("div",he,[p("div",ke,[we,p("div",xe,[f(p("input",{type:"text",name:"title","onUpdate:modelValue":a[4]||(a[4]=e=>m(j).title=e),required:"",class:"input is-primary-focus is-primary-focus",placeholder:"Proposal Title"},null,512),[[y,m(j).title]])])]),p("div",Pe,[g(o,{class:"m-0 p-0",label:"Type"},{default:u((()=>[g(s,null,{default:u((()=>[g(t,{modelValue:m(j).type,"onUpdate:modelValue":a[5]||(a[5]=e=>m(j).type=e),value:"proposal",label:"Proposal",name:"solid_squared_radio",color:"primary",square:"",solid:""},null,8,["modelValue"]),g(t,{modelValue:m(j).type,"onUpdate:modelValue":a[6]||(a[6]=e=>m(j).type=e),value:"change_order",label:"Change Order",name:"solid_squared_radio",color:"info",square:"",solid:""},null,8,["modelValue"]),g(t,{modelValue:m(j).type,"onUpdate:modelValue":a[7]||(a[7]=e=>m(j).type=e),value:"draft",label:"Draft",name:"solid_squared_radio",color:"warning",square:"",solid:""},null,8,["modelValue"])])),_:1})])),_:1})]),p("div",Ce,[Ve,p("div",Ie,[f(p("input",{type:"date",name:"firstName","onUpdate:modelValue":a[8]||(a[8]=e=>m(j).approval_deadline=e),required:"",class:"input is-primary-focus is-primary-focus",placeholder:"Proposal Approval deadline"},null,512),[[y,m(j).approval_deadline]])])]),p("div",Te,[Se,g(o,{grouped:""},{default:u((()=>[g(s,null,{default:u((()=>[Ae])),_:1})])),_:1})]),p("div",je,[p("div",Ue,[p("div",Oe,[Me,g(o,null,{default:u((()=>[g(s,null,{default:u((()=>[g(n,{modelValue:m(j).internal_notes,"onUpdate:modelValue":a[9]||(a[9]=e=>m(j).internal_notes=e),rows:"4",placeholder:"Internal notes..."},null,8,["modelValue"])])),_:1})])),_:1})]),p("div",qe,[De,m(V)?(d(),r(m(D),{key:0,modelValue:m(j).introductory_text,"onUpdate:modelValue":a[10]||(a[10]=e=>m(j).introductory_text=e),editor:m(V),config:G},null,8,["modelValue","editor"])):b("",!0)]),p("div",Le,[$e,m(V)?(d(),r(m(D),{key:0,modelValue:m(j).closing_text,"onUpdate:modelValue":a[11]||(a[11]=e=>m(j).closing_text=e),editor:m(V),config:G},null,8,["modelValue","editor"])):b("",!0)])])])])])):b("",!0),p("div",He,["CostWorksheet"==m(A)?(d(),_("div",Ee,[g(i,{proposalId:m(j).id?m(j).id:C.proposalId,proposalData:m(j)},null,8,["proposalId","proposalData"])])):b("",!0)])])])),action:u((()=>[g(P,{loading:m(S),type:"submit",color:"primary",raised:""},{default:u((()=>[h(k(C.proposalId?"Update Proposal":"Create Proposal"),1)])),_:1},8,["loading"])])),cancel:u((()=>[g(P,{onClick:a[12]||(a[12]=e=>O()),raised:""},{default:u((()=>[h("Close")])),_:1})])),_:1},8,["open","onSubmit"])}}}),We={class:"columns is-multiline"},Fe={class:"column is-12"},Ge={class:"column is-12"},Be={class:"column is-12"},Ne={class:"column is-12"},ze={class:"column is-12"},Je={class:"column is-12"},Ze=V(l({__name:"MergeProposalModal",props:{groupProposalModal:{type:Boolean},leadID:{default:""},selectedProposals:{default:[]}},emits:["update:modalHandler","update:OnSuccess"],setup(l,{emit:a}){const s=l,o=N();t([{id:"",proposalAmount:0,title:"",approval_deadline:"",internal_notes:"",introductory_text:"",closing_text:"",payment_status:"",type:"",status:"",created_at:"",updated_at:"",job:""}]);const i=t({title:"",type:"combine",description:"",proposalsIds:[],trades:[]});t("combine");const c=t(!1);t("active"),E(),t([]),t([{value:"",label:""}]),t("");const v=t([{value:"",label:""}]);return n((()=>{})),(l,t)=>{const n=H,_=$,f=L,y=D,V=P("Multiselect"),I=q,T=x,S=e;return d(),r(S,{is:"form",open:s.groupProposalModal,title:"Group Proposal",size:"large",actions:"right",onSubmit:t[8]||(t[8]=w((e=>{o.success("Merging...")}),["prevent"])),onClose:t[9]||(t[9]=e=>{a("update:modalHandler",!1)})},{content:u((()=>[p("div",We,[p("div",Fe,"Length "+k(s.selectedProposals),1),p("div",Ge,[g(f,{label:"Select Group Type"},{default:u((()=>[g(_,null,{default:u((()=>[g(n,{modelValue:m(i).type,"onUpdate:modelValue":t[0]||(t[0]=e=>m(i).type=e),value:"combine",label:"Combine Proposals",name:"outlined_squared_radio",color:"warning",square:""},null,8,["modelValue"]),g(n,{modelValue:m(i).type,"onUpdate:modelValue":t[1]||(t[1]=e=>m(i).type=e),value:"trade",label:"Trade Proposal",name:"outlined_squared_radio",color:"primary",square:""},null,8,["modelValue"]),g(n,{modelValue:m(i).type,"onUpdate:modelValue":t[2]||(t[2]=e=>m(i).type=e),value:"summary",label:"Summary Proposal",name:"outlined_squared_radio",color:"info",square:""},null,8,["modelValue"]),g(n,{modelValue:m(i).type,"onUpdate:modelValue":t[3]||(t[3]=e=>m(i).type=e),value:"report",label:"Report",name:"outlined_squared_radio",color:"success",square:""},null,8,["modelValue"])])),_:1})])),_:1})]),p("div",Be,[g(f,{label:"Proposal Title"},{default:u((()=>[g(_,null,{default:u((()=>[g(y,{modelValue:m(i).title,"onUpdate:modelValue":t[4]||(t[4]=e=>m(i).title=e),placeholder:"Enter Group Proposal Title",type:"text",name:"title"},null,8,["modelValue"])])),_:1})])),_:1})]),p("div",Ne,[g(f,{label:"Choose what to show to recipients"},{default:u((({id:e})=>[g(_,null,{default:u((()=>[g(V,{modelValue:m(W),"onUpdate:modelValue":t[5]||(t[5]=e=>C(W)?W.value=e:null),attrs:{id:e},mode:"tags",searchable:!0,"create-tag":!0,options:m(G),placeholder:"Add columns"},null,8,["modelValue","attrs","options"])])),_:2},1024)])),_:1})]),p("div",ze,["trade"==m(i).type?(d(),r(f,{key:0,label:"Choose what to show to recipients"},{default:u((({id:e})=>[g(_,null,{default:u((()=>[g(V,{modelValue:m(i).trades,"onUpdate:modelValue":t[6]||(t[6]=e=>m(i).trades=e),attrs:{id:e},mode:"tags",searchable:!0,"create-tag":!0,options:m(v),placeholder:"Select Trade"},null,8,["modelValue","attrs","options"])])),_:2},1024)])),_:1})):b("",!0)]),p("div",Je,[g(f,{label:"Proposal Title"},{default:u((()=>[g(_,null,{default:u((()=>[g(I,{modelValue:m(i).description,"onUpdate:modelValue":t[7]||(t[7]=e=>m(i).description=e),placeholder:"Enter Group Proposal Title",rows:"3",type:"text"},null,8,["modelValue"])])),_:1})])),_:1})])])])),action:u((()=>[g(T,{loading:m(c),type:"submit",color:"warning",raised:""},{default:u((()=>[h("Group Proposals")])),_:1},8,["loading"])])),_:1},8,["open"])}}}),[["__scopeId","data-v-54987165"]]),Ke=e=>(j("data-v-55df1a6b"),e=e(),U(),e),Qe={class:"columns is-multiline"},Ye={class:"column is-12 is-flex space-between"},Xe=Ke((()=>p("div",null,null,-1))),el={class:"is-flex"},ll={class:"column is-12"},al={class:"flex-list-wrapper flex-list-v2"},tl=Ke((()=>p("img",{class:"light-image",src:X,alt:""},null,-1))),sl=Ke((()=>p("img",{class:"dark-image",src:ee,alt:""},null,-1))),ol={key:1,class:"tab-content is-active"},nl={class:"item-name dark-inverted"},il={class:"item-meta"},dl={class:"light-text"},rl={key:2,class:"tab-content is-active"},ul=Ke((()=>p("img",{class:"light-image is-larger",src:le,alt:""},null,-1))),pl=Ke((()=>p("img",{class:"dark-image is-larger",src:ae,alt:""},null,-1))),cl=V(l({__name:"ProposalGroupModal",props:{leadProposalListModal:{type:Boolean},leadID:{default:""}},emits:["update:modalHandler","update:OnSuccess"],setup(l,{emit:a}){const s=l,o=t([{id:"",proposalAmount:0,title:"",approval_deadline:"",internal_notes:"",introductory_text:"",closing_text:"",payment_status:"",type:"",status:"",created_at:"",updated_at:"",job:""}]),i=t("combine"),c=t(!1),v=t("active"),f=E(),y=t([]),w=t([{value:"",label:""}]),V=t(!1),j=t([]),U=t(""),O={picture:{label:"Proposal",grow:!0,media:!0},customer:"Type",industry:"Amount",status:"Status",team:{label:"Payment"},actions:{label:"Select",align:"end"}},M=I((()=>{if(U.value){const e=new RegExp(U.value,"i");return o.value.filter((l=>l.title.match(e)||l.description.match(e)))}return o.value})),q=()=>{a("update:modalHandler",!1)};return n((()=>{(async()=>{try{c.value=!0;const e=await f.get(`/api/lead-proposal/by-job/${s.leadID}/`);o.value=e.data}catch(e){console.log(e)}finally{c.value=!1}})(),(async()=>{try{const e=await f.get("/api/cost-trade/");w.value=e.data.map((e=>({value:e.id,label:e.name})))}catch(e){console.log(e)}})()})),(l,a)=>{const t=P("Multiselect"),o=$,n=L,f=x,I=Y,U=Z,D=Q,H=K,E=J,R=z,W=Ze,F=e;return d(),r(F,{is:"form",open:s.leadProposalListModal,title:"Proposal List",size:"xl",actions:"right",onClose:q},{content:u((()=>[p("div",Qe,[p("div",Ye,[Xe,p("div",el,["trade"==m(i)?(d(),r(n,{key:0,style:{width:"340px"}},{default:u((({id:e})=>[g(o,null,{default:u((()=>[g(t,{modelValue:m(y),"onUpdate:modelValue":a[0]||(a[0]=e=>C(y)?y.value=e:null),attrs:{id:e},mode:"tags",searchable:!0,"create-tag":!0,options:m(w),placeholder:"Select Trades"},null,8,["modelValue","attrs","options"])])),_:2},1024)])),_:1})):b("",!0),g(f,{class:"ml-2",onClick:a[1]||(a[1]=e=>V.value=!m(V)),raised:"",color:"warning",light:"",outlined:""},{default:u((()=>[h(" Group Proposal ")])),_:1}),g(f,{class:"ml-2",raised:"",icon:"fas fa-envelope",color:"info",light:"",outlined:""},{default:u((()=>[h(" Send ")])),_:1})])]),p("div",ll,[p("div",al,["active"===m(v)&&0===m(M).length?(d(),r(I,{key:0,title:"We couldn't find any matching results.",subtitle:"Too bad. Looks like we couldn't find any matching results for the\n          search terms you've entered. Please try different search terms or\n          criteria.",larger:""},{image:u((()=>[tl,sl])),_:1})):b("",!0),"active"===m(v)?(d(),_("div",ol,[m(M).length?(d(),r(E,{key:0,data:m(M),columns:O,rounded:""},{body:u((()=>[g(A,{name:"list",tag:"div",class:"flex-list-inner"},{default:u((()=>[(d(!0),_(T,null,S(m(M),(e=>(d(),_("div",{key:e.id,class:"flex-table-item"},[g(U,{column:{media:!0,grow:!0}},{default:u((()=>[p("div",null,[p("span",nl,k(e.title??"N/A"),1),p("span",il,[p("span",null,k(m(se)(e.created_at)),1)])])])),_:2},1024),g(U,null,{default:u((()=>[g(D,null,{default:u((()=>[h(k(e.type),1)])),_:2},1024)])),_:2},1024),g(U,null,{default:u((()=>[p("span",dl,"$"+k(e.proposalAmount),1)])),_:2},1024),g(U,null,{default:u((()=>[g(D,{rounded:""},{default:u((()=>[h(k(e.status),1)])),_:2},1024)])),_:2},1024),g(U,null,{default:u((()=>[g(D,{rounded:""},{default:u((()=>[h(k(e.status),1)])),_:2},1024)])),_:2},1024),g(U,{column:{align:"end"}},{default:u((()=>[g(o,{raw:"",subcontrol:""},{default:u((()=>[g(H,{onClick:()=>{m(j).push(e)},modelValue:e.payment_status,"onUpdate:modelValue":l=>e.payment_status=l,label:"",color:"primary"},null,8,["onClick","modelValue","onUpdate:modelValue"])])),_:2},1024)])),_:2},1024)])))),128))])),_:1})])),_:1},8,["data"])):b("",!0),m(M).length>5?(d(),r(R,{key:1,"item-per-page":10,"total-items":873,"current-page":42,"max-links-displayed":7})):b("",!0)])):"closed"===m(v)?(d(),_("div",rl,[g(I,{title:"No closed projects.",subtitle:"Looks like you don't have any closed project yet. When you'll\n              start closing off projects, they will be showing up in here."},{image:u((()=>[ul,pl])),_:1})])):b("",!0)])]),m(V)?(d(),r(W,{key:0,"group-proposal-modal":m(V),selectedProposals:m(j),"onUpdate:modalHandler":a[2]||(a[2]=e=>V.value=!1)},null,8,["group-proposal-modal","selectedProposals"])):b("",!0)])])),action:u((()=>[g(f,{loading:m(c),type:"submit",color:"warning",raised:"",onClick:q},{default:u((()=>[h("Close")])),_:1},8,["loading"])])),_:1},8,["open"])}}}),[["__scopeId","data-v-55df1a6b"]]),ml={class:"columns is-multiline"},vl={class:"column is-12"},_l={class:"invoice-wrapper"},fl=p("div",{class:"invoice-header"},[p("div",{class:"left"},[p("h3",null,"Proposal-ID PD-456-14")]),p("div",{class:"right"},[p("div",{class:"controls"},[p("a",{class:"action"},[p("i",{"aria-hidden":"true",class:"iconify","data-icon":"feather:printer"})]),p("a",{class:"action"},[p("i",{"aria-hidden":"true",class:"iconify","data-icon":"feather:download-cloud"})]),p("a",{class:"action"},[p("i",{"aria-hidden":"true",class:"iconify","data-icon":"feather:mail"})])])])],-1),yl={class:"invoice-body"},gl={class:"invoice-card"},bl={class:"invoice-section is-flex is-bordered"},hl=p("div",{class:"meta"},null,-1),kl=p("div",{class:"end"},[p("span",null,"PO Box 242"),p("span",null,"Evergreen, CO 80437-0242"),p("span",null,"Phone: 720 272-9061"),p("span",null,"Premium Trades for Premier Builders")],-1),wl=p("div",{class:"invoice-section is-flex is-bordered"},[p("div",{class:"meta"},[p("h3",null,"Client Name"),p("span",null,"Client Phone"),p("span",null,"25724 Independence Trail Evergreen, CO 80439")]),p("div",{class:"end is-left"},[p("h3",null,"Friday Jan 17, 2025"),p("p",null," Lorem ipsum dolor sit amet, consectetur adipiscing elit. Quod equidem non reprehendo. ")])],-1),xl={key:0,class:"invoice-section"},Pl={class:"responsive-table"},Cl=p("br",null,null,-1),Vl=["innerHTML"],Il={class:"invoice-section is-flex mt-0 pt-0"},Tl={class:"end is-left"},Sl={class:"text-right"},Al=p("p",null,"Mentioned price are final",-1),jl=l({__name:"ProposalViewModal",props:{previewModal:{type:Boolean},columnsToShow:{default:!1},proposalId:{default:""}},emits:["update:modalHandler","update:OnSuccess"],setup(l,{emit:a}){const s=l,o=E();R();const i=t([{name:"Website Redesign",unit:"hrs",quantity:54,rate:24},{name:"Logo Design",unit:"hrs",quantity:12,rate:24},{name:"Custom Illustrations",unit:"hrs",quantity:7,rate:32}]);I((()=>{const e=i.value.reduce(((e,l)=>e+l.quantity*l.rate),0),l=.1*e;return[{label:"Subtotal",value:e},{label:"Taxes",value:l},{label:"Total",value:e+l}]}));const c=["Item","Description","Unit Cost","Qty","Unit","Builder Cost","Markup","Total Price"];t(""),t(!0),t(!0),t(!0),t(!0);const v=I((()=>de.value.reduce(((e,l)=>e+l.price*l.quantity),0))),f=t(!1);t({id:"c897de41-609f-4a20-8d79-0537b6a873d6",title:"Test Lead's Proposal",approval_deadline:"2025-01-30",internal_notes:null,introductory_text:null,closing_text:null,payment_status:"Pending",type:"proposal",status:"pending",created_at:"2025-01-21T19:08:06.509861Z",updated_at:"2025-01-21T19:08:06.509875Z",job:"da0aa7c1-3744-4856-a637-e5a821f5ec7e"});const y=t([{id:"5e7d026a-b392-47e9-9d24-58fbc1de12c5",index:1,title:"Test Lead Proposal Item",description:"<p>Description</p>",type:"",quantity:100,unit:"Sq ft",unit_cost:"10.00",markup:"150.00",total_price:"1150.00",cost_code:"11012",cost_type:"material",builder_cost:"1000.00",margin:"1.00",profit:"0.00",internal_notes:"Internal notes",mark_as:"bid",state:"active",group_amount:"0.00",status:null,created_at:"2025-01-23T18:25:46.392750Z",proposal:"c897de41-609f-4a20-8d79-0537b6a873d6"}]),w=()=>{a("update:modalHandler",!1)},P=async()=>{try{const e=await o.get(`api/cost/by-proposal/${s.proposalId}/`);y.value=e.data}catch(e){console.log(e)}};return n((()=>{(async()=>{try{f.value=!0,await o.get(`/api/lead-proposal/${s.proposalId}/`),P()}catch(e){console.log(e)}finally{f.value=!1}})()})),(l,a)=>{const t=ie,o=x,n=e;return d(),r(n,{is:"form",open:s.previewModal,title:"Cost Item ",size:"xl",actions:"right",onClose:w},{content:u((()=>[p("div",ml,[p("div",vl,[p("div",_l,[fl,p("div",yl,[p("div",gl,[p("div",bl,[g(t,{size:"xl",picture:"/logos/IbexFavicon.png"}),hl,kl]),wl,m(y).length?(d(),_("div",xl,[p("table",Pl,[p("thead",null,[(d(),_(T,null,S(c,((e,l)=>p("th",{key:l},k(e),1))),64))]),p("tbody",null,[(d(!0),_(T,null,S(m(y),((e,l)=>(d(),_("tr",{key:e.id},[p("td",null,[p("span",null,k(e.title),1),Cl,p("span",null,k(e.cost_code),1)]),p("td",null,[p("span",{innerHTML:e.description},null,8,Vl)]),p("td",null,[p("span",null," $"+k(e.unit_cost),1)]),p("td",null,[p("span",null,k(e.quantity),1)]),p("td",null,[p("span",null,k(e.unit),1)]),p("td",null,[p("span",null," $"+k(e.builder_cost),1)]),p("td",null,[p("span",null," $"+k(e.markup),1)]),p("td",null,[p("span",null," $"+k(e.total_price),1)])])))),128))])])])):b("",!0),p("div",Il,[p("div",Tl,[p("h3",Sl,"Total Price: $"+k(m(v)),1),Al])])])])])])])])),action:u((()=>[g(o,{loading:m(f),type:"submit",color:"warning",raised:"",onClick:w},{default:u((()=>[h("Close")])),_:1},8,["loading"])])),_:1},8,["open"])}}}),Ul={onHold:"warning",open:"info",sold:"success",lost:"danger"},Ol={pending:"info",approve:"success",review:"warning",disapprove:"danger"},Ml={pending:"Pending",approve:"Approved",review:"Require Review",disapprove:"Disapproved"},ql={proposal:"primary",change_order:"warning",draft:"light"},Dl={proposal:"Proposal",change_order:"Change Order",draft:"Draft"},Ll=[{value:"call",label:"Phone Call"},{value:"email",label:"Email"},{value:"followup",label:"Follow Up"},{value:"visit",label:"Site Visit"},{value:"form",label:"Website Form"}],$l={class:"flex-toolbar is-reversed is-flex space-between my-4"},Hl={key:0},El={key:1,class:"flex-list-wrapper flex-list-v2"},Rl={class:"item-name dark-inverted"},Wl={class:"item-name dark-inverted"},Fl={class:"light-text"},Gl={class:"light-text"},Bl={class:"item-name dark-inverted"},Nl={class:"light-text"},zl=["onClick"],Jl=[p("div",{class:"icon"},[p("i",{"aria-hidden":"true",class:"lnil lnil-briefcase"})],-1),p("div",{class:"meta"},[p("span",null,"View Detail"),p("span",null,"View detail in page")],-1)],Zl=["onClick"],Kl=[p("div",{class:"icon"},[p("i",{"aria-hidden":"true",class:"lnil lnil-pencil"})],-1),p("div",{class:"meta"},[p("span",null,"Edit"),p("span",null,"Edit Proposal Details")],-1)],Ql=["onClick"],Yl=[p("div",{class:"icon"},[p("i",{"aria-hidden":"true",class:"lnil lnil-eye"})],-1),p("div",{class:"meta"},[p("span",null,"Preview"),p("span",null,"Preview proposal detail")],-1)],Xl=["onClick"],ea=[p("div",{class:"icon"},[p("i",{class:"lnil lnil-calender-alt-1","aria-hidden":"true"})],-1),p("div",{class:"meta"},[p("span",null,"Create Tasks"),p("span",null,"Create tasks in chart ")],-1)],la=["onClick"],aa=[p("div",{class:"icon"},[p("i",{"aria-hidden":"true",class:"lnil lnil-add-files"})],-1),p("div",{class:"meta"},[p("span",null,"Add Cost Item"),p("span",null,"Add a new cost item")],-1)],ta=p("hr",{class:"dropdown-divider"},null,-1),sa=["onClick"],oa=[p("div",{class:"icon"},[p("i",{"aria-hidden":"true",class:"lnil lnil-trash-can-alt"})],-1),p("div",{class:"meta"},[p("span",null,"Delete"),p("span",null,"Delete from list")],-1)],na=p("img",{class:"light-image",src:X,alt:""},null,-1),ia=p("img",{class:"dark-image",src:ee,alt:""},null,-1),da=l({__name:"LeadProposalsList",props:{activeTab:{default:"active"},leadId:{default:""},allProposal:{type:Boolean,default:!1}},setup(e){const l=e,a=O();M();const s=E(),o=N(),i=t(!1),c=t([]),v=t(!1),w=t(""),P=t(!1),V=t(""),j=t("");t(l.activeTab);const U=t({title:"",subtitle:"test",isSweetAlertOpen:!1,btntext:"text"}),q=t({title:"",subtitle:"",isSweetAlertOpen:!1,btntext:""}),D=async()=>{try{i.value=!0;const e=await s.delete(`/api/lead-proposal/${j.value}/`);c.value=e.data,o.success("Proposal delete successfully"),X()}catch(e){o.error(` ${e}, Proposal`),o.error("Something went wrong please try later")}finally{i.value=!1,U.value.isSweetAlertOpen=!1}},L={picture:{label:"Proposal",grow:!0,media:!0},customer:"Created At",industry:"Type",deadline:"Deadline",status:"Status",amount:{label:"Total Amount",media:!0},actions:{label:"Actions",align:"end"}},H=I((()=>{if(V.value){const e=new RegExp(V.value,"i");return c.value.filter((l=>l.title.match(e)||l.approval_deadline.match(e)))}return c.value})),R=t(!1),W=t(!1),F=t(!1),G=t(""),K=e=>{a.push(`/sidebar/dashboard/proposals/${e}`)},X=()=>{1==l.allProposal?(async()=>{try{i.value=!0;const e=await s.get("/api/lead-proposal/");c.value=e.data}catch(e){o.error(` ${e}, Lead`)}finally{i.value=!1}})():l.leadId&&(async()=>{try{i.value=!0;const e=await s.get(`/api/lead-proposal/by-job/${l.leadId}/`);c.value=e.data}catch(e){o.error(` ${e}, Lead`)}finally{i.value=!1}})()};return n((()=>{X()})),(e,a)=>{const t=$,s=x,o=pe,n=Z,I=Q,O=ue,M=J,E=Y,N=z,ee=Re,le=jl,ae=B,te=ne,ie=cl;return d(),_("div",null,[p("div",$l,[g(t,{icon:"feather:search"},{default:u((()=>[f(p("input",{"onUpdate:modelValue":a[0]||(a[0]=e=>C(V)?V.value=e:null),class:"input custom-text-filter",placeholder:"Search..."},null,512),[[y,m(V)]])])),_:1}),p("div",null,[g(s,{color:"primary",onClick:a[1]||(a[1]=e=>v.value=!m(v)),icon:"fas fa-plus"},{default:u((()=>[h("Lead Proposal")])),_:1}),l.leadId?(d(),r(s,{key:0,color:"warning",class:"ml-2",onClick:a[2]||(a[2]=e=>{P.value=!0}),icon:"fas fa-cogs"},{default:u((()=>[h("Proposals")])),_:1})):b("",!0)])]),m(i)?(d(),_("div",Hl,[g(o)])):(d(),_("div",El,[m(H).length>0&&m(c).length>0?(d(),r(M,{key:0,data:m(H),columns:L,rounded:""},{body:u((()=>[g(A,{name:"list",tag:"div",class:"flex-list-inner"},{default:u((()=>[(d(!0),_(T,null,S(m(H),(e=>(d(),_("div",{key:e.id,class:"flex-table-item"},[g(n,{column:{media:!0,grow:!0},class:"cu-pointer",onClick:l=>K(e.id)},{default:u((()=>[p("div",null,[p("span",Rl,k(e.title),1)])])),_:2},1032,["onClick"]),g(n,{column:{media:!0},class:"cu-pointer",onClick:l=>K(e.id)},{default:u((()=>[p("div",null,[p("span",Wl,k(m(se)(e.created_at)),1),p("span",Fl,k(m(oe)(e.created_at)),1)])])),_:2},1032,["onClick"]),g(n,{class:"cu-pointer",onClick:l=>K(e.id)},{default:u((()=>[g(I,{rounded:"",color:m(ql)[e.type]},{default:u((()=>[h(k(m(Dl)[e.type]),1)])),_:2},1032,["color"])])),_:2},1032,["onClick"]),g(n,{class:"cu-pointer",onClick:l=>K(e.id)},{default:u((()=>[p("span",Gl,k(e.approval_deadline),1)])),_:2},1032,["onClick"]),g(n,{class:"cu-pointer",onClick:l=>K(e.id)},{default:u((()=>[g(I,{class:"capitalized",rounded:"",color:m(Ol)[e.status]},{default:u((()=>[h(k(m(Ml)[e.status]),1)])),_:2},1032,["color"])])),_:2},1032,["onClick"]),g(n,{class:"cu-pointer",onClick:l=>K(e.id),column:{media:!0}},{default:u((()=>[p("div",null,[p("span",Bl,"$"+k(e.proposalAmount),1),p("span",Nl,k(e.payment_status),1)])])),_:2},1032,["onClick"]),g(n,{column:{align:"end"}},{default:u((()=>[g(O,{class:"is-pushed-mobile",icon:"feather:more-vertical",spaced:"",right:""},{content:u((()=>[p("a",{role:"menuitem",onClick:l=>K(e.id),class:"dropdown-item is-media"},Jl,8,zl),p("a",{role:"menuitem",onClick:l=>{return a=e.id,w.value=a,void(v.value=!0);var a},class:"dropdown-item is-media"},Kl,8,Zl),p("a",{disabled:"",role:"menuitem",onClick:l=>{return a=e.id,W.value=a,void(R.value=!R.value);var a},class:"dropdown-item is-media"},Yl,8,Ql),p("a",{disabled:"",role:"menuitem",onClick:l=>{return a=e.id,j.value=a,void(q.value={title:"Generate Tasks?",subtitle:"Tasks will be generated of all cost items are listed in this proposal.",btntext:"Yes Generate",isSweetAlertOpen:!0});var a},class:"dropdown-item is-media"},ea,8,Xl),p("a",{role:"menuitem",onClick:l=>{return a=e.id,G.value=a,void(F.value=!F.value);var a},class:"dropdown-item is-media"},aa,8,la),ta,p("a",{role:"menuitem",onClick:l=>{return a=e.id,j.value=a,void(U.value={title:"Delete Proposal?",subtitle:"Are you sure to delete this proposal? After delete you will not be able to recover it again.",btntext:"Yes delete",isSweetAlertOpen:!0});var a},class:"dropdown-item is-media"},oa,8,sa)])),_:2},1024)])),_:2},1024)])))),128))])),_:1})])),_:1},8,["data"])):b("",!0),m(c).length<1&&0==m(H).length?(d(),r(E,{key:1,title:"There is no proposal created on this lead!",subtitle:"Too bad. Looks like we couldn't created any proposal on this Lead, please create proposal and release to the client",larger:""},{image:u((()=>[na,ia])),_:1})):b("",!0),m(H).length>5?(d(),r(N,{key:2,"item-per-page":10,"total-items":873,"current-page":42,"max-links-displayed":7})):b("",!0)])),m(v)?(d(),r(ee,{key:2,leadId:l.leadId,proposalId:m(w),leadProposalModal:m(v),"onUpdate:modalHandler":a[3]||(a[3]=e=>v.value=!1),"onUpdate:OnSuccess":X,onClearProposalId:a[4]||(a[4]=e=>w.value="")},null,8,["leadId","proposalId","leadProposalModal"])):b("",!0),m(R)?(d(),r(le,{key:3,"preview-modal":m(R),proposalId:m(W),"onUpdate:modalHandler":a[5]||(a[5]=e=>R.value=!1)},null,8,["preview-modal","proposalId"])):b("",!0),m(F)?(d(),r(ae,{key:4,costItemModal:m(F),proposalId:m(G),"onUpdate:modalHandler":a[6]||(a[6]=e=>F.value=!1),"onUpdate:OnSuccess":X},null,8,["costItemModal","proposalId"])):b("",!0),m(U).isSweetAlertOpen?(d(),r(te,{key:5,isSweetAlertOpen:m(U).isSweetAlertOpen,title:m(U).title,subtitle:m(U).subtitle,btntext:m(U).btntext,onConfirm:D,onCancel:()=>m(U).isSweetAlertOpen=!1},null,8,["isSweetAlertOpen","title","subtitle","btntext","onCancel"])):b("",!0),m(q).isSweetAlertOpen?(d(),r(te,{key:6,isSweetAlertOpen:m(q).isSweetAlertOpen,title:m(q).title,subtitle:m(q).subtitle,btntext:m(q).btntext,onConfirm:D,onCancel:()=>m(q).isSweetAlertOpen=!1},null,8,["isSweetAlertOpen","title","subtitle","btntext","onCancel"])):b("",!0),m(P)?(d(),r(ie,{key:7,leadProposalListModal:m(P),leadID:l.leadId,"group-proposal-modal":m(P),"onUpdate:modalHandler":a[7]||(a[7]=e=>P.value=!1)},null,8,["leadProposalListModal","leadID","group-proposal-modal"])):b("",!0)])}}});export{Re as _,da as a,Ll as b,Ul as g};
