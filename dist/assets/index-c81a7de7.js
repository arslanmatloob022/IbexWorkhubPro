import{_ as e}from"./VAvatar.vue_vue_type_style_index_0_lang-baeb3a61.js";import{F as t}from"./FullCalendar-c58ce076.js";import{i as s}from"./index-04e05ac8.js";import{i as a}from"./index-5790eff9.js";import{f as o,b as r,r as i,o as l,B as n,C as c,D as d,m as u,O as p,G as v,E as m,U as h,V as g,W as y,F as f,N as b,S as _,s as j,T as x,A as k}from"./index-5abab93c.js";import{u as w}from"./useNotyf-d70c19fd.js";import{u as S}from"./useAPI-a1737641.js";import{u as T}from"./useThemeColors-d842ca37.js";import{A as C}from"./vue3-apexcharts.common-9bab9de5.js";import{_ as P}from"./VBlock.vue_vue_type_style_index_0_lang-21a39d16.js";import{_ as D}from"./VIconBox.vue_vue_type_style_index_0_lang-974239aa.js";import{u as A}from"./viewWrapper-4fb181d6.js";import{b as I}from"./route-block-83d24a4e.js";import"./index-37bedc79.js";import"./notyf-76e97137.js";import"./vue.runtime.esm-bundler-4ce259b7.js";const B={style:{display:"flex","border-radius":"6px","flex-wrap":"wrap","align-items":"center","justify-content":"space-between"}},F={onClick:()=>{},style:{"font-weight":"500","margin-bottom":"0px","padding-left":"10px"}},$={class:"avatars"},L=["src"],M={key:1,style:{width:"100%",height:"100%","background-color":"#292f3c",display:"flex","align-items":"center","justify-content":"center"}},W={class:"mb-0",style:{color:"white"}},O={class:"v-popover-content is-text"},V={class:"popover-head"},z={class:"dark-inverted"},E={class:"popover-body"},H=_(o({__name:"ProjectsDashboardCalendar",setup(o){const _=S(),j=r(),x=w(),k=i(!1),T=i(!1),C=i("");i(!1);const P=i([]),D=i({pending:"#8392ab",active:"#fbcf33",completed:"#82d616",canceled:"#344767"}),A=i({plugins:[s,a],schedulerLicenseKey:"0965592368-fcs-1694657447",initialView:"resourceTimelineMonth",height:"auto",resourceAreaWidth:"20%",selectable:!0,headerToolbar:{left:"today prev,next",center:"title",right:"resourceTimelineWeek,resourceTimelineMonth,resourceTimelineYear"},editable:!0,views:{resourceTimelineWeek:{slotDuration:{days:1,hours:1},slotLabelFormat:{weekday:"short",month:"numeric",day:"numeric",year:"numeric"}}},resourceAreaHeaderContent:"Projects",resources:[],eventClick:e=>{"manager"!==j.user.role||e.event.extendedProps.managers.some((e=>e.id===j.user.id))?(T.value=!0,C.value=e.event.id):x.success("You are not allowed to perform this action.")},eventDrop:e=>{let t=e.event.startStr,s=e.event.end.toISOString().substring(0,10);console.log("resource ids",e.event._def.resourceIds[0]),console.log(e.event.extendedProps.project),e.event.extendedProps.project===e.event._def.resourceIds[0]&&confirm(`Are you sure you want to update the project ${e.event.title} date from ${t} to ${s}?`)?H(e.event.id,t,s):e.revert()},eventResize:e=>{let t=e.event.startStr,s=e.event.end.toISOString().substring(0,10);console.log(e.event),confirm(`Are you sure you want to update the project ${e.event.title} date from ${t} to ${s}?`)?H(e.event.id,t,s):e.revert()}}),I=e=>{let t=new Date(e);return t.setDate(t.getDate()+1),t.toISOString().slice(0,10)},H=async(e,t,s)=>{try{let a=await _.patch(`/api/project/${e}/`,{startDate:t,endDate:s});console.log(a),x.success("Project updated successfully")}catch(a){x.error("Something went wrong"),console.log(a)}};return l((async()=>{await(async()=>{try{k.value=!0,console.log("inside all projects func");const e=await _.get("/api/project/",{});P.value=e.data,console.log("scratch projects",P.value),k.value=!1}catch(e){console.error(e),P.value=[],k.value=!1}})(),(()=>{console.log(P.value);const e=P.value.map((e=>({id:e.id,resourceId:e.id,project:e.id,start:e.startDate,end:I(e.endDate),title:e.title,description:e.description,total_tasks:e.total_tasks,managers:e.managers,borderColor:D[e.status]})));A.value.resources=P.value,A.value.events=e})(),console.log("projects",A.value)})),(s,a)=>{const o=e,r=n("Tippy");return c(),d("div",null,[u(k)?b("",!0):(c(),p(u(t),{key:0,options:u(A)},{eventContent:v((e=>[m("div",B,[m("div",null,[m("span",F,h(e.event.title),1),m("span",null," -- tasks ("+h(e.event.extendedProps.total_tasks)+")",1)]),m("div",$,[(c(!0),d(g,null,y(e.event.extendedProps.managers,(t=>(c(),d("div",{class:"avatars__item",key:t.id},[f(r,null,{content:v((()=>[m("div",O,[m("div",V,[f(o,{picture:t.avatar,size:"small"},null,8,["picture"]),m("h4",z,h(t.username?t.username:""),1)]),m("div",E,[m("p",null,h(e.event?.title),1)])])])),default:v((()=>[t.avatar?(c(),d("img",{key:0,src:t.avatar,alt:""},null,8,L)):(c(),d("div",M,[m("h6",W,h(t.username?t.username.slice(0,2):"AA"),1)]))])),_:2},1024)])))),128))])])])),_:1},8,["options"]))])}}}),[["__scopeId","data-v-eb14f759"]]),Y={class:"dashboard-card"},N=m("div",{class:"card-head"},[m("h3",{class:"dark-inverted"},"Task Completion")],-1),G=o({__name:"DashbaordTasksChart",setup(e){const t=S(),s=i(!1),a=T(),o=j({series:[],chart:{height:295,type:"area",toolbar:{show:!0}},colors:[a.accent,a.info,a.primary],legend:{position:"top"},dataLabels:{enabled:!1},stroke:{width:[2,3,5],curve:"smooth"},xaxis:{type:"date",categories:[]},tooltip:{x:{format:"dd/MM/yy HH:mm"}}});return l((()=>{(async()=>{try{s.value=!0;const e=(await t.get("/api/task/dashboard-analaytics/")).data;o.value.series=e.series,o.value.xaxis.categories=e.dates}catch(e){console.error(e)}finally{s.value=!1}})()})),(e,t)=>(c(),d("div",Y,[N,u(s)?b("",!0):(c(),p(u(C),{key:0,id:"completion-chart",height:u(o).chart.height,type:u(o).chart.type,series:u(o).series,options:u(o)},null,8,["height","type","series","options"]))]))}}),K={class:"dashboard-card"},R=m("div",{class:"card-head"},[m("h3",{class:"dark-inverted"},"Task Completion")],-1),U=o({__name:"DashBoardTasksPie",setup(e){const t=S(),s=i(!1),a=T(),o=j({height:695,type:"pie",series:[],colors:[a.accent,a.info,a.primary,a.purple,a.orange],labels:[],responsive:[{breakpoint:480,options:{chart:{width:315,toolbar:{show:!0}},legend:{position:"top"}}}],legend:{position:"right",horizontalAlign:"center"}});return l((()=>{(async()=>{try{s.value=!0;const e=(await t.get("/api/task/dashboard-analaytics/")).data.series;o.value.labels=e.map((e=>e.name)),console.log("chart",o.value.labels),o.value.series=e.map((e=>e.data.reduce(((e,t)=>e+t),0)))}catch(e){console.error(e)}finally{s.value=!1}})()})),(e,t)=>(c(),d("div",K,[R,u(s)?b("",!0):(c(),p(u(C),{key:0,id:"completion-chart",height:u(o).height,type:u(o).type,series:u(o).series,options:u(o)},null,8,["height","type","series","options"]))]))}}),X={class:"dashboard-card"},q=m("div",{class:"card-head"},[m("h3",{class:"dark-inverted"},"Projects Stats")],-1),J=o({__name:"ProjectsStatsChart",setup(e){const t=S(),s=i(!1),a=T(),o=i({series:[{name:"Projects",data:[]}],height:280,type:"bar",options:{chart:{toolbar:{show:!0}},plotOptions:{bar:{dataLabels:{position:"top"}}},dataLabels:{enabled:!0,offsetY:-20,style:{fontSize:"12px",colors:["#304758"]}},xaxis:{categories:[],position:"bottom",axisBorder:{show:!1},axisTicks:{show:!1},crosshairs:{fill:{type:"gradient",gradient:{colorFrom:"#D8E3F0",colorTo:"#BED1E6",stops:[0,100],opacityFrom:.4,opacityTo:.5}}},tooltip:{enabled:!0}},yaxis:{axisBorder:{show:!1},axisTicks:{show:!1},labels:{show:!1}},colors:[a.primary,a.secondary,a.orange],title:{text:"",align:"left"}}});return l((()=>{(async()=>{try{s.value=!0;const e=(await t.get("/api/project/project-analaytics/")).data;o.value.series[0].data=e.count,o.value.options.xaxis.categories=e.months}catch(e){console.error(e)}finally{s.value=!1}})()})),(e,t)=>(c(),d("div",X,[q,u(s)?b("",!0):(c(),p(u(C),{key:0,height:u(o).height,type:u(o).type,series:u(o).series,options:u(o).options},null,8,["height","type","series","options"]))]))}}),Q={class:"personal-dashboard personal-dashboard-v3"},Z={class:"columns is-multiline"},ee={class:"column is-12"},te={class:"columns is-multiline is-flex-tablet-p"},se={class:"column is-12"},ae={class:"stats-wrapper"},oe={class:"columns is-multiline is-flex-tablet-p"},re={class:"column is-3"},ie={class:"dashboard-card"},le=m("i",{class:"fas fa-cubes","aria-hidden":"true"},null,-1),ne={class:"column is-3"},ce={class:"dashboard-card"},de=m("i",{class:"fas fa-boxes","aria-hidden":"true"},null,-1),ue={class:"column is-3"},pe={class:"dashboard-card"},ve=m("i",{class:"fas fa-border-style","aria-hidden":"true"},null,-1),me={class:"column is-3"},he={class:"dashboard-card"},ge=m("i",{class:"fas fa-dice-d6","aria-hidden":"true"},null,-1),ye={class:"column is-3"},fe={class:"dashboard-card"},be=m("i",{class:"fas fa-hospital-user","aria-hidden":"true"},null,-1),_e={class:"column is-3"},je={class:"dashboard-card"},xe=m("i",{class:"fas fa-users","aria-hidden":"true"},null,-1),ke={class:"column is-3"},we={class:"dashboard-card"},Se=m("i",{class:"fas fa-user-tag","aria-hidden":"true"},null,-1),Te={class:"column is-3"},Ce={class:"dashboard-card"},Pe=m("i",{class:"fas fa-user-tie","aria-hidden":"true"},null,-1),De={class:"columns is-multiline"},Ae={class:"column is-8"},Ie={class:"column is-4"},Be={class:"column is-12"},Fe={class:"column is-12"},$e=o({__name:"IbexDashboard",setup(e){const t=S(),s=i(!1),a=i({all_project:0,active_projects:0,pending_projects:0,completed_projects:0,workers:0,managers:0,last_mail_sent:"",clients:0,contractors:0});return l((()=>{(async()=>{try{s.value=!0;const e=await t.get("/api/project/dashboard/",{});a.value=e.data,s.value=!1}catch(e){console.log(e)}finally{s.value=!1}})()})),(e,t)=>{const s=D,o=P,r=J,i=U,l=G,n=H;return c(),d("div",Q,[m("div",Z,[m("div",ee,[m("div",te,[m("div",se,[m("div",ae,[m("div",oe,[m("div",re,[m("div",ie,[f(o,{title:a.value?.all_project?a.value.all_project.toString():"0",subtitle:"All Projects",center:""},{icon:v((()=>[f(s,{color:"info",rounded:""},{default:v((()=>[le])),_:1})])),_:1},8,["title"])])]),m("div",ne,[m("div",ce,[f(o,{title:a.value?.active_projects?a.value?.active_projects.toString():"0",subtitle:"Active Projects",center:""},{icon:v((()=>[f(s,{color:"blue",rounded:""},{default:v((()=>[de])),_:1})])),_:1},8,["title"])])]),m("div",ue,[m("div",pe,[f(o,{title:a.value?.pending_projects?a.value?.pending_projects.toString():"0",subtitle:"Pre Construction",center:""},{icon:v((()=>[f(s,{color:"pink",rounded:""},{default:v((()=>[ve])),_:1})])),_:1},8,["title"])])]),m("div",me,[m("div",he,[f(o,{title:a.value?.completed_projects?a.value?.completed_projects.toString():"0",subtitle:"Completed",center:""},{icon:v((()=>[f(s,{color:"green",rounded:""},{default:v((()=>[ge])),_:1})])),_:1},8,["title"])])]),m("div",ye,[m("div",fe,[f(o,{title:a.value?.managers?a.value?.managers.toString():"0",subtitle:"Managers",center:""},{icon:v((()=>[f(s,{color:"yellow",rounded:""},{default:v((()=>[be])),_:1})])),_:1},8,["title"])])]),m("div",_e,[m("div",je,[f(o,{title:a.value?.workers?a.value?.workers.toString():"0",subtitle:"Workers",center:""},{icon:v((()=>[f(s,{color:"lime",rounded:""},{default:v((()=>[xe])),_:1})])),_:1},8,["title"])])]),m("div",ke,[m("div",we,[f(o,{title:a.value?.contractors?a.value?.contractors.toString():"0",subtitle:"Contractors",center:""},{icon:v((()=>[f(s,{color:"orange",rounded:""},{default:v((()=>[Se])),_:1})])),_:1},8,["title"])])]),m("div",Te,[m("div",Ce,[f(o,{title:a.value?.clients?a.value?.clients.toString():"0",subtitle:"Clients",center:""},{icon:v((()=>[f(s,{color:"blue",rounded:""},{default:v((()=>[Pe])),_:1})])),_:1},8,["title"])])])])])])])])]),m("div",De,[m("div",Ae,[f(r)]),m("div",Ie,[f(i,{style:{height:"360px"}})]),m("div",Be,[f(l)]),m("div",Fe,[f(n)])])])}}}),Le={class:"page-content-inner"},Me=o({__name:"index",setup(e){x();return A().setPageTitle("Ibex Builders Studios"),k((()=>({title:"Ibex Builders Studios"}))),(e,t)=>{const s=$e;return c(),d("div",Le,[f(s)])}}});"function"==typeof I&&I(Me);export{Me as default};
