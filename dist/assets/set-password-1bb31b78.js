import{f as e,r as a,v as s,x as l,y as o,o as t,A as i,B as d,C as r,D as u,E as n,F as m,G as c,H as p,m as v,I as _,J as h,K as f,k as g,Y as y,P as b,Q as w,R as k,S as V}from"./index-99e15d25.js";import{_ as x}from"./VCheckbox.vue_vue_type_style_index_0_lang-b94018db.js";import{_ as j}from"./VField.vue_vue_type_script_setup_true_lang-0a6f32d2.js";import{_ as P}from"./VControl-d58d6ce6.js";import{_ as C}from"./VInput.vue_vue_type_script_setup_true_lang-1069e5b5.js";import{_ as S}from"./VLabel.vue_vue_type_script_setup_true_lang-0d8baa39.js";import{_ as I}from"./AnimatedLogo-3b22be5f.js";import{_ as A}from"./station-d527b828.js";import{u as q}from"./useNotyf-b5c4c6a6.js";import{u as L}from"./useAPI-c55c1b44.js";import{u as R}from"./layoutSwitcher-c5c9c379.js";import"./useVFieldContext-c40a6a91.js";import"./notyf-4c2a0882.js";import"./useThemeColors-a20eef99.js";const U=e=>(w("data-v-e098089e"),e=e(),k(),e),B={class:"modern-login"},F=U((()=>n("div",{class:"underlay h-hidden-mobile h-hidden-tablet-p"},null,-1))),K={class:"columns is-gapless is-vcentered"},D=y('<div class="column is-relative is-8 h-hidden-mobile h-hidden-tablet-p" data-v-e098089e><div class="hero is-fullheight is-image" data-v-e098089e><div class="hero-body" data-v-e098089e><div class="container" data-v-e098089e><div class="columns" data-v-e098089e><div class="column" data-v-e098089e><img class="hero-image" src="'+A+'" alt="" data-v-e098089e></div></div></div></div></div></div>',1),H={class:"column is-4 is-relative"},T={class:"top-tools"},z={style:{width:"12rem",height:"12rem"}},E=["checked"],G=U((()=>n("span",null,null,-1))),J={class:"is-form"},N={class:"is-form-inner"},Q=[U((()=>n("h2",null,"Set Password",-1)))],W=["onSubmit"],Y={class:"button-wrap has-help"},M=V(e({__name:"set-password",setup(e){R();const y=a("login"),w=a(!1),k=s(),V=l(),A=o(),U=q(),M=L(),O=a(""),X=a(""),Z=a(""),$=a(""),ee=async()=>{if(!w.value){if(O.value!=X.value)return void U.error("Both password and confirm password  must be matched");w.value=!0;try{await M.post("/api/auth/set-password/",{email:$.value,password:O.value,token:Z.value,confirm_password:X.value});ae()}catch(e){w.value=!1,U.dismissAll(),U.error("Invalid link or expired, password update")}}},ae=()=>{w.value=!1,U.dismissAll(),U.success("Password updated successfully"),V.push("/auth/login")};t((()=>{Z.value=A.query.token,$.value=A.query.email})),i({title:"Reset Password - Ibex"});const se=a(!1),le=a("Password"),oe=()=>{le.value="Password"===le.value?"text":"Password"};return(e,a)=>{const s=I,l=d("RouterLink"),o=S,t=C,i=P,V=j,A=x,q=b;return r(),u("div",B,[F,n("div",K,[D,n("div",H,[n("div",T,[m(l,{to:"/",class:"top-logo"},{default:c((()=>[n("div",z,[m(s,{width:"38px",height:"38px"})])])),_:1}),n("label",{class:"dark-mode",tabindex:"0",role:"button",onKeydown:a[1]||(a[1]=p(h((e=>e.target.click()),["prevent"]),["space"]))},[n("input",{"data-cy":"dark-mode-toggle",type:"checkbox",checked:!v(k).isDark,onChange:a[0]||(a[0]=(...e)=>v(k).onChange&&v(k).onChange(...e))},null,40,E),G],32)]),n("div",J,[n("div",N,[n("div",{class:_(["form-text",["login"!==v(y)&&"is-hidden"]])},Q,2),n("form",{method:"post","data-cy":"login-form",class:_([["login"!==v(y)&&"is-hidden"],"login-wrapper"]),onSubmit:h(ee,["prevent"])},[m(V,null,{default:c((()=>[m(i,{icon:"lnil lnil-lock-alt autv-icon"},{default:c((()=>[m(o,{class:"auth-label"},{default:c((()=>[f(" Password ")])),_:1}),m(t,{modelValue:v(O),"onUpdate:modelValue":a[2]||(a[2]=e=>g(O)?O.value=e:null),type:v(le),required:"",minlength:"8"},null,8,["modelValue","type"])])),_:1})])),_:1}),m(V,null,{default:c((()=>[m(i,{icon:"lnil lnil-lock-alt autv-icon"},{default:c((()=>[m(o,{class:"auth-label"},{default:c((()=>[f(" Confirm Password ")])),_:1}),m(t,{modelValue:v(X),"onUpdate:modelValue":a[3]||(a[3]=e=>g(X)?X.value=e:null),required:"",type:v(le),minlength:"8"},null,8,["modelValue","type"])])),_:1})])),_:1}),m(V,null,{default:c((()=>[m(i,{class:"is-flex"},{default:c((()=>[m(i,{raw:"",subcontrol:""},{default:c((()=>[m(A,{modelValue:v(se),"onUpdate:modelValue":a[4]||(a[4]=e=>g(se)?se.value=e:null),label:"Show Password",color:"primary",onClick:oe},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),n("div",Y,[m(q,{id:"login-button",loading:v(w),color:"primary",type:"submit",size:"big",rounded:"",raised:"",bold:""},{default:c((()=>[f(" Submit ")])),_:1},8,["loading"])])],42,W)])])])])])}}}),[["__scopeId","data-v-e098089e"]]);export{M as default};
