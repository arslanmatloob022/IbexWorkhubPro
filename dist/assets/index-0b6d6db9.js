import{_ as e}from"./VField.vue_vue_type_script_setup_true_lang-65e70890.js";import{_ as t}from"./VControl-427c87b7.js";import{_ as a}from"./VInput.vue_vue_type_script_setup_true_lang-90ddbbe7.js";import{e as s,r,o,y as l,z as i,C as n,A as u,B as c,l as p,j as d,K as m,J as v,L as f,v as _,H as h,ak as y}from"./index-023a2237.js";import{F as j}from"./FullCalendar-6c94dac6.js";import{i as g}from"./index-f52ed8ce.js";import{i as b}from"./index-75e08f06.js";import{u as w}from"./userSession-1b1da0d4.js";import{u as k}from"./useNotyf-c16238a4.js";import{u as x}from"./useAPI-329c7502.js";import{u as I}from"./viewWrapper-7c308818.js";import"./VLabel.vue_vue_type_script_setup_true_lang-5a4cec82.js";import"./useVFieldContext-28aff213.js";import"./notyf-577918b8.js";import"./useThemeColors-f46d40e9.js";const C=["onSubmit"],T={class:"datatable-toolbar"},V={style:{display:"flex","flex-wrap":"wrap","align-items":"center","justify-content":"space-between"}},S={style:{"font-weight":"500","margin-bottom":"0px","padding-left":"10px"}},W=f(s({__name:"ProjectWorkerCalendar",setup(s){const f=x();w(),k();const _=r(!1);r(!1),r(""),r(!1),r("all");const h=r(""),y=r([]);r([]);const I=r([]);r(0),r(""),r("");const W=r(0),L=r(!0);r(!1),r(0),r({all:"all",active:"active",pending:"pending",completed:"completed"});const D=r({pending:"#8392ab",active:"#fbcf33",completed:"#82d616",canceled:"#344767"}),F=r({plugins:[g,b],schedulerLicenseKey:"0965592368-fcs-1694657447",initialView:"resourceTimelineMonth",height:"auto",themeSystem:"cerulean",resourceAreaWidth:"20%",resourceGroupField:"title",resourcesInitiallyExpanded:!1,selectable:!0,headerToolbar:{left:"today prev,next",center:"title",right:"resourceTimelineWeek,resourceTimelineMonth,resourceTimelineYear"},editable:!0,views:{resourceTimelineWeek:{slotDuration:{days:1,hours:1},slotLabelFormat:{weekday:"short",month:"numeric",day:"numeric",year:"numeric"}}},resourceAreaHeaderContent:"Workers",resources:[],resourceId:W.value}),P=e=>{let t=new Date(e);return t.setDate(t.getDate()+1),t.toISOString().slice(0,10)},A=()=>{let e=[],t=[];t=h.value?E.value.filter((e=>e.username.toLowerCase().includes(h.value.toLowerCase()))):E.value,t.forEach((t=>{e.push({id:t.id,title:t.username})})),F.value.resources=e},E=r([]),H=async()=>{try{_.value=!0,console.log("inside all projects func");const e=await f.get("/api/users/by-role/worker/",{});E.value=e.data,_.value=!1}catch(e){console.error(e),E.value=[],_.value=!1}},M=async()=>{try{const e=await f.get("/api/task/all-tasks/",{});y.value=e.data}catch(e){y.value=[]}};return o((async()=>{await Promise.all([H(),M()]),(()=>{console.log(I.value);const e=[],t=[];E.value.forEach((a=>{y.value.forEach((t=>{t.workers.includes(a.id)&&e.push({id:t.id,resourceId:a.id,project:t.project,start:t.startDate,end:P(t.endDate),title:t.title,color:t.color,description:t.description,borderColor:D[t.status],projectInfo:t.projectInfo})})),t.push({id:a.id,title:a.username})})),F.value.resources=t,F.value.events=[...e]})(),console.log("projects",F.value),L.value=!0})),(s,r)=>{const o=a,f=t,_=e;return l(),i("div",null,[n("form",{onSubmit:m(A,["prevent"])},[n("div",T,[u(_,{elevated:""},{default:c((()=>[u(f,{icon:"fas fa-search"},{default:c((()=>[u(o,{type:"text",placeholder:"Search worker...",modelValue:p(h),"onUpdate:modelValue":r[0]||(r[0]=e=>d(h)?h.value=e:null),onInput:r[1]||(r[1]=e=>A()),class:""},null,8,["modelValue"])])),_:1})])),_:1})])],40,C),u(p(j),{options:p(F)},{eventContent:c((e=>[n("div",V,[n("p",S," ("+v(e.event.extendedProps.projectInfo.title)+") "+v(e.event.title),1)])])),_:1},8,["options"])])}}}),[["__scopeId","data-v-bb268ff5"]]),L={class:"page-content-inner"},D=n("div",{class:"lifestyle-dashboard-bg has-top-nav"},null,-1),F=s({__name:"index",setup:e=>(I().setPageTitle("Workers Tasks"),_({title:"Workers tasks"}),(e,t)=>{const a=W;return l(),i("div",L,[(l(),h(y,{to:"[data-teleport-bg]"},[D])),u(a)])})});export{F as default};
