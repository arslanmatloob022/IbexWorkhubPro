import{_ as e,a,b as l}from"./ProposalViewModal.vue_vue_type_style_index_0_lang-0fb08c1b.js";import{_ as t}from"./SweetAlert.vue_vue_type_style_index_0_lang-39cd6681.js";import{b as s,c as o}from"./CreateProposalTasksModal-2a665597.js";import{_ as i}from"./VPlaceholderPage.vue_vue_type_style_index_0_lang-2957d35c.js";import{_ as n,c as r}from"./VFlexTable.vue_vue_type_style_index_0_lang-430f74cd.js";import{_ as d}from"./VDropdown.vue_vue_type_style_index_0_lang-0d9beffb.js";import{_ as p}from"./VTag.vue_vue_type_style_index_0_lang-5bf81608.js";import{f as u,x as c,y as m,r as v,$ as _,o as y,av as f,C as k,D as h,m as b,F as w,E as g,G as C,L as x,X as P,k as A,K as I,O as S,N as O,V as j,W as L,aS as T,P as M,U as $}from"./index-a6f90e95.js";import{_ as V}from"./VControl-2918d79c.js";import{_ as D}from"./PlaceloadV1.vue_vue_type_style_index_0_lang-a9cf8baf.js";import{_ as U,a as E}from"./search-4-dark-2b5b440c.js";import{u as H}from"./useAPI-a388d998.js";import{u as N}from"./useNotyf-18c8fac3.js";import{b as B}from"./useSupportElement-295717ea.js";import{a as F,b as Y,c as z,d as G}from"./estimatesScripts-f8c928ac.js";const K={key:0},R={key:1},W={class:"flex-toolbar is-reversed is-flex space-between my-4"},X={class:"flex-list-wrapper flex-list-v2"},q={class:"item-name dark-inverted show-text-250"},J={class:"item-meta"},Q=g("i",{"aria-hidden":"true",class:"iconify","data-icon":"feather:clock"},null,-1),Z={class:"item-name dark-inverted"},ee={class:"light-text"},ae=["onClick"],le=[g("div",{class:"icon"},[g("i",{"aria-hidden":"true",class:"lnil lnil-pencil"})],-1),g("div",{class:"meta"},[g("span",null,"Edit"),g("span",null,"Edit Proposal Details")],-1)],te=["onClick"],se=[g("div",{class:"icon"},[g("i",{"aria-hidden":"true",class:"lnil lnil-eye"})],-1),g("div",{class:"meta"},[g("span",null,"Preview"),g("span",null,"Preview proposal detail")],-1)],oe=["onClick"],ie=[g("div",{class:"icon"},[g("i",{class:"lnil lnil-calender-alt-1","aria-hidden":"true"})],-1),g("div",{class:"meta"},[g("span",null,"Create Tasks"),g("span",null,"Create tasks in chart ")],-1)],ne=g("hr",{class:"dropdown-divider"},null,-1),re=["onClick"],de=[g("div",{class:"icon"},[g("i",{class:"lnir lnir-round-box-check","aria-hidden":"true"})],-1),g("div",{class:"meta"},[g("span",null,"Mark Approved"),g("span",null,"Mark Proposal As Approved")],-1)],pe=["onClick"],ue=[g("div",{class:"icon"},[g("i",{"aria-hidden":"true",class:"lnil lnil-trash-can-alt"})],-1),g("div",{class:"meta"},[g("span",null,"Delete"),g("span",null,"Delete from list")],-1)],ce=g("img",{class:"light-image",src:U,alt:""},null,-1),me=g("img",{class:"dark-image",src:E,alt:""},null,-1),ve=u({__name:"LeadProposalsList",props:{activeTab:{default:"active"},leadId:{default:""},allProposal:{type:Boolean,default:!1}},emits:["updateCompany"],setup(u,{emit:U}){const E=u,ve=c();m();const _e=H(),ye=N(),fe=v(!1),ke=v([]),he=v(!1),be=v(""),we=v(!1),ge=v(!1),Ce=v(""),xe=v("");v(E.activeTab);const Pe=v({title:"",subtitle:"test",isSweetAlertOpen:!1,btntext:"text"}),Ae=v({title:"",subtitle:"",isSweetAlertOpen:!1,btntext:""}),Ie=async()=>{try{fe.value=!0;await _e.delete(`/api/lead-proposal/${xe.value}/`);ye.success("Proposal delete successfully"),Ve()}catch(e){ye.error(` ${e}, Proposal`),ye.error("Something went wrong please try later")}finally{fe.value=!1,Pe.value.isSweetAlertOpen=!1}},Se={picture:{label:"Proposal",grow:!0,media:!0},industry:"Type",status:"Status",amount:{label:"Total Amount",media:!0},customer:"Calendar Tasks ",actions:{label:"Actions",align:"end"}},Oe=_((()=>{if(Ce.value){const e=new RegExp(Ce.value,"i");return ke.value.filter((a=>a.title.match(e)||a.approval_deadline.match(e)))}return ke.value})),je=v(!1),Le=v(!1),Te=v(!1),Me=v(""),$e=e=>{ve.push(`/sidebar/dashboard/proposals/${e}`)},Ve=()=>{1==E.allProposal?(async()=>{try{fe.value=!0;const e=await _e.get("/api/lead-proposal/");ke.value=e.data}catch(e){ye.error(` ${e}, Lead`)}finally{fe.value=!1}})():E.leadId&&(async()=>{try{fe.value=!0;const e=await _e.get(`/api/lead-proposal/by-project/${E.leadId}/`);ke.value=e.data}catch(e){ye.error(` ${e}, Lead`)}finally{fe.value=!1}})()};return y((()=>{Ve()})),(u,c)=>{const m=D,v=V,_=M,y=r,H=p,N=d,ve=n,De=i,Ue=s,Ee=e,He=a,Ne=o,Be=t,Fe=l,Ye=f("tooltip");return k(),h("div",null,[b(fe)?(k(),h("div",K,[w(m)])):(k(),h("div",R,[g("div",W,[w(v,{icon:"feather:search"},{default:C((()=>[x(g("input",{"onUpdate:modelValue":c[0]||(c[0]=e=>A(Ce)?Ce.value=e:null),class:"input custom-text-filter",placeholder:"Search..."},null,512),[[P,b(Ce)]])])),_:1}),g("div",null,[w(_,{color:"primary",onClick:c[1]||(c[1]=e=>he.value=!b(he)),icon:"fas fa-plus"},{default:C((()=>[I("Lead Proposal ")])),_:1}),E.leadId?(k(),S(_,{key:0,color:"warning",class:"ml-2",onClick:c[2]||(c[2]=e=>{ge.value=!0}),icon:"fas fa-cogs"},{default:C((()=>[I("Proposals")])),_:1})):O("",!0)])]),g("div",X,[b(Oe).length>0&&b(ke).length>0?(k(),S(ve,{key:0,data:b(Oe),columns:Se,rounded:""},{body:C((()=>[w(T,{name:"list",tag:"div",class:"flex-list-inner"},{default:C((()=>[(k(!0),h(j,null,L(b(Oe),(e=>(k(),h("div",{key:e.id,class:"flex-table-item"},[w(y,{column:{media:!0,grow:!0},class:"cu-pointer",onClick:a=>$e(e.id)},{default:C((()=>[x((k(),h("div",null,[g("span",q,$(e.title),1),g("span",J,[g("span",null,[Q,I($(b(B)(e.created_at)),1)])])])),[[Ye,`${e.title}`,void 0,{rounded:!0,light:!0}]])])),_:2},1032,["onClick"]),w(y,{class:"cu-pointer",onClick:a=>$e(e.id)},{default:C((()=>[w(H,{rounded:"",color:b(F)[e.type]},{default:C((()=>[I($(b(Y)[e.type]),1)])),_:2},1032,["color"])])),_:2},1032,["onClick"]),w(y,{class:"cu-pointer",onClick:a=>$e(e.id)},{default:C((()=>[w(H,{class:"capitalized",rounded:"",color:b(z)[e.status]},{default:C((()=>[I($(b(G)[e.status]),1)])),_:2},1032,["color"])])),_:2},1032,["onClick"]),w(y,{class:"cu-pointer",onClick:a=>$e(e.id),column:{media:!0}},{default:C((()=>[g("div",null,[g("span",Z,"$"+$(e.proposalAmount),1),g("span",ee,$(e.payment_status),1)])])),_:2},1032,["onClick"]),w(y,{class:"cu-pointer",onClick:a=>$e(e.id)},{default:C((()=>[w(H,{color:"purple",outlined:""},{default:C((()=>[I($(e.is_task_created?"Created":"Not Created"),1)])),_:2},1024)])),_:2},1032,["onClick"]),w(y,{column:{align:"end"}},{default:C((()=>[w(N,{class:"is-pushed-mobile",icon:"feather:more-vertical",spaced:"",right:""},{content:C((()=>[g("a",{role:"menuitem",onClick:a=>{return l=e.id,be.value=l,void(he.value=!0);var l},class:"dropdown-item is-media"},le,8,ae),g("a",{disabled:"",role:"menuitem",onClick:a=>{return l=e.id,Le.value=l,void(je.value=!je.value);var l},class:"dropdown-item is-media"},se,8,te),"approved"==e.status?(k(),h("a",{key:0,role:"menuitem",onClick:a=>{return l=e.id,be.value=l,void(we.value=!0);var l},class:"dropdown-item is-media"},ie,8,oe)):O("",!0),ne,"approved"!=e.status?(k(),h("a",{key:1,role:"menuitem",onClick:a=>(async(e,a)=>{try{await _e.patch(`/api/lead-proposal/${a}/`,{status:e}),ye.success(`You have ${e} this proposal.`),"approved"==e&&U("updateCompany",null),Ve()}catch(l){console.log(l)}})("approved",e.id),class:"dropdown-item is-media"},de,8,re)):O("",!0),g("a",{role:"menuitem",onClick:a=>{return l=e.id,xe.value=l,void(Pe.value={title:"Delete Proposal?",subtitle:"Are you sure to delete this proposal? After delete you will not be able to recover it again.",btntext:"Yes delete",isSweetAlertOpen:!0});var l},class:"dropdown-item is-media"},ue,8,pe)])),_:2},1024)])),_:2},1024)])))),128))])),_:1})])),_:1},8,["data"])):O("",!0),b(ke).length<1&&0==b(Oe).length?(k(),S(De,{key:1,title:"There is no proposal created on this lead!",subtitle:"Too bad. Looks like we couldn't created any proposal on this Lead, please create proposal and release to the client",larger:""},{image:C((()=>[ce,me])),_:1})):O("",!0)]),b(we)?(k(),S(Ue,{key:0,createProposalTasksModal:b(we),proposalId:b(be),onCloseModalHandler:c[3]||(c[3]=e=>we.value=!1),"onUpdate:OnSuccess":c[4]||(c[4]=e=>Ve())},null,8,["createProposalTasksModal","proposalId"])):O("",!0),b(he)?(k(),S(Ee,{key:1,leadId:E.leadId,proposalId:b(be),leadProposalModal:b(he),getLeadsList:E.allProposal,"onUpdate:modalHandler":c[5]||(c[5]=()=>{Ve(),he.value=!1}),onClearProposalId:c[6]||(c[6]=e=>be.value="")},null,8,["leadId","proposalId","leadProposalModal","getLeadsList"])):O("",!0),b(je)?(k(),S(He,{key:2,"preview-modal":b(je),proposalId:b(Le),"onUpdate:modalHandler":c[7]||(c[7]=e=>je.value=!1)},null,8,["preview-modal","proposalId"])):O("",!0),b(Te)?(k(),S(Ne,{key:3,costItemModal:b(Te),proposalId:b(Me),"onUpdate:modalHandler":c[8]||(c[8]=e=>Te.value=!1),"onUpdate:OnSuccess":Ve},null,8,["costItemModal","proposalId"])):O("",!0),b(Pe).isSweetAlertOpen?(k(),S(Be,{key:4,isSweetAlertOpen:b(Pe).isSweetAlertOpen,title:b(Pe).title,subtitle:b(Pe).subtitle,btntext:b(Pe).btntext,onConfirm:Ie,onCancel:()=>b(Pe).isSweetAlertOpen=!1},null,8,["isSweetAlertOpen","title","subtitle","btntext","onCancel"])):O("",!0),b(Ae).isSweetAlertOpen?(k(),S(Be,{key:5,isSweetAlertOpen:b(Ae).isSweetAlertOpen,title:b(Ae).title,subtitle:b(Ae).subtitle,btntext:b(Ae).btntext,onConfirm:Ie,onCancel:()=>b(Ae).isSweetAlertOpen=!1},null,8,["isSweetAlertOpen","title","subtitle","btntext","onCancel"])):O("",!0),b(ge)?(k(),S(Fe,{key:6,leadProposalListModal:b(ge),leadID:E.leadId,"group-proposal-modal":b(ge),"onUpdate:modalHandler":c[9]||(c[9]=e=>ge.value=!1)},null,8,["leadProposalListModal","leadID","group-proposal-modal"])):O("",!0)]))])}}});export{ve as _};
