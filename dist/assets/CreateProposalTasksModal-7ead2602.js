import{e,s as l,r as a,Z as s,b as t,_ as o,o as n,A as i,B as d,N as r,F as u,D as c,E as p,K as _,W as m,l as v,C as f,V as b,U as h,J as y,M as I,j as g,T as w,I as C,O as k,a4 as V,a6 as P,a0 as x,X as D,P as S,Q as T,R as j,i as M,aR as O,H as A,G as U}from"./index-70af507c.js";import{_ as E}from"./VModal.vue_vue_type_style_index_0_lang-2bee2677.js";import{_ as H}from"./VInput.vue_vue_type_script_setup_true_lang-8c98f35b.js";import{_ as F}from"./VTextarea.vue_vue_type_script_setup_true_lang-e812f757.js";import{_ as L}from"./VField.vue_vue_type_script_setup_true_lang-f9f54325.js";import{_ as $}from"./VControl-a243656f.js";import{a as q,_ as R}from"./VOption.vue_vue_type_style_index_0_lang-f51655a1.js";import{u as B}from"./useAPI-7526ffb5.js";import{u as N}from"./useNotyf-98b938b1.js";import{a as z,e as W}from"./useSupportElement-6fb37513.js";import{u as G}from"./userSession-2550218b.js";import{_ as J}from"./VAvatar.vue_vue_type_style_index_0_lang-f1d074f0.js";import{g as K,a as Q,s as X,c as Y}from"./costItems-db4736e1.js";import{_ as Z}from"./SweetAlert.vue_vue_type_style_index_0_lang-d291204b.js";import{_ as ee}from"./VDropdown.vue_vue_type_style_index_0_lang-1d6d26a5.js";const le={class:"modal-form columns is-multiline"},ae={class:"columns is-multiline"},se={class:"field column is-12 mb-0"},te=c("label",null,"Title: ",-1),oe={class:"control"},ne=["disabled"],ie={class:"field column is-6"},de=c("label",{for:""},"Cost Type",-1),re={class:"field column is-3"},ue=c("label",{for:""},"Catalog",-1),ce={class:"field column is-3"},pe=c("label",{for:""},"Mark As",-1),_e={class:"field column is-6"},me=c("label",null,"Cost Code *",-1),ve={class:"field column is-6"},fe=c("label",{for:""},"Group Cost",-1),be={class:"field column is-12 mb-0"},he=c("label",{for:"",class:"label"},"Description",-1),ye={class:"field column is-12 mb-0"},Ie=c("label",{for:"",class:"label"},"Internal Notes",-1),ge={class:"columns is-multiline"},we={class:"field column is-6"},Ce=c("label",null,"Unit Cost",-1),ke={class:"field column is-6"},Ve=c("label",null,"Quantity",-1),Pe={class:"field column is-6"},xe=c("label",null,"Unit",-1),De={class:"field column is-6"},Se=c("label",null,"Builder Cost",-1),Te={class:"field column is-6"},je=c("label",null,"Markup (%)",-1),Me={class:"field column is-6"},Oe=c("label",null,"Client Price",-1),Ae={class:"field column is-6"},Ue=c("label",null,"Margin (%)",-1),Ee=e({__name:"EstimateCostItemModal",props:{costItemModal:{type:Boolean},proposalId:{},previousItemIndex:{},costItemId:{},previewCostItems:{type:Boolean}},emits:["update:modalHandler","update:OnSuccess"],setup(e,{emit:P}){const x=e,D=l();G();const S=N(),T=B(),j=a(!1);a([]),a([]);const M=a({previousItemIndex:0,index:0,id:"",type:"",total_price:0,cost_code:"",cost_type:"",builder_cost:0,internal_notes:"",mark_as:"",state:"",title:"",description:"",quantity:0,unit:"",unit_cost:0,markup:0,margin:0,profit:0,group:"",proposal:x.proposalId}),O=a([{value:"labour",label:"Labour"},{value:"material",label:"Material"},{value:"equipment",label:"Equipment"},{value:"subcontractor",label:"Subcontractor"},{value:"other",label:"Others"}]),A=a([{value:"11011",label:"Labour"},{value:"11012",label:"Material"},{value:"11013",label:"Equipment"},{value:"11014",label:"Subcontractor"},{value:"11015",label:"Others"}]),U=a([{value:"Tiling",label:"Tiling"},{value:"Material",label:"Material"},{value:"Paint",label:"Paint"},{value:"Carpenter",label:"Carpenter"}]),W=a([{value:"bid",label:"Bid"},{value:"allowance",label:"Allowance"}]);a([{value:"open",label:"Open"},{value:"inProgress",label:"In Progress"},{value:"onHold",label:"On Hold"},{value:"pending",label:"Pending"},{value:"lost",label:"Lost"},{value:"sold",label:"sold"},{value:"noOpportunity",label:"No Opportunity"}]);const J=async()=>{try{j.value=!0;const e=z(M.value,[]);if(x.costItemId){await T.patch(`/api/cost/${x.costItemId}/`,e)}else{await T.post("/api/cost/",e)}K(),Q(),S.success("Item added successfully.")}catch(e){S.error(` ${e}, New Worker`)}finally{j.value=!1}},K=()=>{P("update:modalHandler",!1)},Q=()=>{P("update:OnSuccess",null)};a(0),a(0);const X=s((()=>M.value.unit_cost*M.value.quantity));a(0),a(0);const Y=s((()=>M.value.markup>0?X.value+X.value*M.value.markup/100:M.value.margin>0?X.value/(1-M.value.margin/100):X.value));s((()=>(Y.value-X.value)/X.value*100)),s((()=>(Y.value-X.value)/Y.value*100));const Z=t((()=>o((()=>import("./ckeditor-dbf08bf4.js").then((e=>e.c))),["assets/ckeditor-dbf08bf4.js","assets/index-70af507c.js","assets/index-ce8747cd.css","assets/vue.runtime.esm-bundler-c9a83e39.js"]).then((e=>e.default.component)))),ee={fontFamily:{options:['"Montserrat", sans-serif','"Roboto", sans-serif']},height:"400px",minHeight:"400px"},Ee=a(!1),He=a(!1);return n((async()=>{D.value=await o((()=>import("./ckeditor-2554a6f6.js").then((e=>e.c))),["assets/ckeditor-2554a6f6.js","assets/index-70af507c.js","assets/index-ce8747cd.css"]).then((e=>e.default)),x.previousItemIndex&&(M.value.previousItemIndex=x.previousItemIndex),x.costItemId&&(async()=>{try{Ee.value=!0;const e=await T.get(`/api/cost/${x.costItemId}/`);M.value=e.data}catch(e){console.log(e)}finally{Ee.value=!1}})(),(async()=>{try{He.value=!0;const e=await T.get("/api/cost-code/");A.value=e.data.map((e=>({value:e.id,label:e.name})))}catch(e){console.log(e)}finally{He.value=!1}})()})),(e,l)=>{const a=R,s=q,t=$,o=L,n=k,P=i("Multiselect"),S=F,T=V,B=H,N=E;return d(),r(N,{is:"form",open:x.costItemModal,title:"Cost Item ",size:"xl",actions:"right",onSubmit:C(J,["prevent"]),onClose:K},{content:u((()=>[c("div",le,[p(T,{class:"column is-12"},{default:u((()=>[c("div",ae,[c("div",se,[te,c("div",oe,[_(c("input",{type:"text",name:"firstName","onUpdate:modelValue":l[0]||(l[0]=e=>v(M).title=e),required:"",disabled:x.previewCostItems,class:"input is-primary-focus is-primary-focus",placeholder:"Proposal Title"},null,8,ne),[[m,v(M).title]])])]),c("div",ie,[de,p(o,null,{default:u((()=>[p(t,null,{default:u((()=>[p(s,{modelValue:v(M).cost_type,"onUpdate:modelValue":l[1]||(l[1]=e=>v(M).cost_type=e),disabled:x.previewCostItems},{default:u((()=>[(d(!0),f(h,null,b(v(O),((e,l)=>(d(),r(a,{value:e.value},{default:u((()=>[y(w(e.label),1)])),_:2},1032,["value"])))),256))])),_:1},8,["modelValue","disabled"])])),_:1})])),_:1})]),c("div",re,[ue,c("div",null,[p(n,{color:"info",light:"",raised:"",size:"small"},{default:u((()=>[y("Add in Catalog")])),_:1})])]),c("div",ce,[pe,p(o,null,{default:u((()=>[p(t,null,{default:u((()=>[p(s,{modelValue:v(M).mark_as,"onUpdate:modelValue":l[2]||(l[2]=e=>v(M).mark_as=e),disabled:x.previewCostItems},{default:u((()=>[(d(!0),f(h,null,b(v(W),((e,l)=>(d(),r(a,{value:e.value},{default:u((()=>[y(w(e.label),1)])),_:2},1032,["value"])))),256))])),_:1},8,["modelValue","disabled"])])),_:1})])),_:1})]),c("div",_e,[me,p(o,null,{default:u((({id:e})=>[p(t,null,{default:u((()=>[p(P,{required:"",modelValue:v(M).cost_code,"onUpdate:modelValue":l[3]||(l[3]=e=>v(M).cost_code=e),disabled:x.previewCostItems,attrs:{id:e},searchable:!0,options:v(A),placeholder:"Select a cost code"},null,8,["modelValue","disabled","attrs","options"])])),_:2},1024)])),_:1})]),c("div",ve,[fe,p(o,null,{default:u((()=>[p(t,null,{default:u((()=>[p(s,{modelValue:v(M).group,"onUpdate:modelValue":l[4]||(l[4]=e=>v(M).group=e),disabled:x.previewCostItems},{default:u((()=>[(d(!0),f(h,null,b(v(U),((e,l)=>(d(),r(a,{value:e.value},{default:u((()=>[y(w(e.label),1)])),_:2},1032,["value"])))),256))])),_:1},8,["modelValue","disabled"])])),_:1})])),_:1})]),c("div",be,[he,v(D)?(d(),r(v(Z),{key:0,disabled:x.previewCostItems,modelValue:v(M).description,"onUpdate:modelValue":l[5]||(l[5]=e=>v(M).description=e),editor:v(D),config:ee},null,8,["disabled","modelValue","editor"])):I("",!0)]),c("div",ye,[Ie,p(o,null,{default:u((()=>[p(t,null,{default:u((()=>[p(S,{modelValue:v(M).internal_notes,"onUpdate:modelValue":l[6]||(l[6]=e=>v(M).internal_notes=e),disabled:x.previewCostItems,rows:"4",placeholder:"Internal notes..."},null,8,["modelValue","disabled"])])),_:1})])),_:1})])])])),_:1}),p(T,{class:"column is-12 mt-3"},{default:u((()=>[c("div",ge,[c("div",we,[Ce,p(o,null,{default:u((()=>[p(t,null,{default:u((()=>[p(B,{modelValue:v(M).unit_cost,"onUpdate:modelValue":l[7]||(l[7]=e=>v(M).unit_cost=e),disabled:x.previewCostItems,type:"number",name:"unitCost",step:"any",placeholder:"Unit cost"},null,8,["modelValue","disabled"])])),_:1})])),_:1})]),c("div",ke,[Ve,p(o,null,{default:u((()=>[p(t,null,{default:u((()=>[p(B,{modelValue:v(M).quantity,"onUpdate:modelValue":l[8]||(l[8]=e=>v(M).quantity=e),disabled:x.previewCostItems,type:"number",name:"quantity",step:"any",placeholder:"Quantity"},null,8,["modelValue","disabled"])])),_:1})])),_:1})]),c("div",Pe,[xe,p(o,null,{default:u((()=>[p(t,null,{default:u((()=>[p(B,{modelValue:v(M).unit,"onUpdate:modelValue":l[9]||(l[9]=e=>v(M).unit=e),disabled:x.previewCostItems,type:"text",name:"unit",placeholder:"Unit"},null,8,["modelValue","disabled"])])),_:1})])),_:1})]),c("div",De,[Se,p(o,null,{default:u((()=>[p(t,null,{default:u((()=>[p(B,{modelValue:v(X),"onUpdate:modelValue":l[10]||(l[10]=e=>g(X)?X.value=e:null),disabled:x.previewCostItems,type:"number",step:"any",name:"builderCost",placeholder:"Builder cost"},null,8,["modelValue","disabled"])])),_:1})])),_:1})]),c("div",Te,[je,p(o,null,{default:u((()=>[p(t,null,{default:u((()=>[p(B,{modelValue:v(M).markup,"onUpdate:modelValue":l[11]||(l[11]=e=>v(M).markup=e),disabled:x.previewCostItems,type:"number",name:"markup",step:"any",placeholder:"Markup"},null,8,["modelValue","disabled"])])),_:1})])),_:1})]),c("div",Me,[Oe,p(o,null,{default:u((()=>[p(t,null,{default:u((()=>[p(B,{modelValue:v(Y),"onUpdate:modelValue":l[12]||(l[12]=e=>g(Y)?Y.value=e:null),disabled:x.previewCostItems,type:"number",name:"markup",step:"any",placeholder:"Total Price"},null,8,["modelValue","disabled"])])),_:1})])),_:1})]),c("div",Ae,[Ue,p(o,null,{default:u((()=>[p(t,null,{default:u((()=>[p(B,{modelValue:v(M).margin,"onUpdate:modelValue":l[13]||(l[13]=e=>v(M).margin=e),disabled:x.previewCostItems,type:"number",name:"markup",step:"any",placeholder:"Margin"},null,8,["modelValue","disabled"])])),_:1})])),_:1})])])])),_:1})])])),action:u((()=>[p(n,{loading:v(j),type:"submit",color:"primary",icon:x.costItemId?"":"fas fa-plus",raised:""},{default:u((()=>[y(w(x.costItemId?"Update":"Add"),1)])),_:1},8,["loading","icon"])])),_:1},8,["open","onSubmit"])}}}),He=P("useProposal",(()=>{const e=a(!0),l=N(),s=B(),t=a("");a("");const o=a([]),n=a([]),i=a({id:"",jobInfo:{id:"",sales_people_info:[],clientInfo:{id:"",username:"",last_name:null,email:"",role:"",avatar:null},created_by_info:{id:"",username:"",last_name:null,email:"",role:"",avatar:null},managers_list:[],title:"",address:"",current_state:"",city:"",state:"",status:"",zip_code:"",confidence:"",sale_date:"",tags:[],estimated_from:"",estimated_to:"",sources:"",project_type:"",notes:"",attach_mail:"",latitude:0,longitude:0,created_at:"",updated_at:"",created_by:"",client:"",contractor:null,sales_people:[],managers:[]},proposalAmount:0,title:"",approval_deadline:"",internal_notes:"",introductory_text:"",closing_text:"",payment_status:"",type:"",status:"",columns_to_show:[],created_at:"",updated_at:"",job:""}),d=a([{id:"",index:0,title:"",description:"",type:"",quantity:0,unit:"",unit_cost:"",markup:"",total_price:"",cost_code:"",cost_type:"",builder_cost:"",margin:"",profit:"",internal_notes:"",mark_as:"",state:"",group_amount:"",status:null,created_at:"",proposal:""}]);return{loading:e,proposalCostItems:d,leadProposalFormData:i,companyProposalsList:o,leadProposalsList:n,getLeadProposals:async a=>{try{a.value=a,e.value=!0;const l=await s.get(`/api/lead-proposal/by-job/${a.value}/`);n.value=l.data}catch(t){l.error(` ${t}, Lead`)}finally{e.value=!1}},getProposalDetail:async e=>{try{const l=await s.get(`/api/lead-proposal/${e}/detail/`);i.value=l.data}catch(l){console.log(l)}},getCompanyProposals:async()=>{try{e.value=!0;const l=await s.get("/api/lead-proposal/");o.value=l.data}catch(a){l.error(` ${a}, Lead`)}finally{e.value=!1}},getProposalCostItems:async function(e){try{t.value=e;const l=await s.get(`/api/cost/by-proposal/${e}/`);d.value=l.data}catch(l){console.log(l)}},clearProposalId:function(){t.value="",d.value=[]}}})),Fe={class:"modal-form columns is-multiline"},Le={class:"column is-full"},$e={class:"field"},qe=c("label",{class:"label"},"Send To ",-1),Re={class:"control"},Be={class:"column is-full"},Ne={class:"field"},ze=c("label",{class:"label"},"Subject ",-1),We={class:"control"},Ge={class:"field column is-full mt-5"},Je=c("label",{class:"label"},"Message",-1),Ke=c("i",{class:"feather:mail"},null,-1),Qe=e({__name:"SendProposalEmailModal",props:{proposalSenderModal:{type:Boolean},proposalData:{},columnsToShow:{},selectedProposalsIds:{}},emits:["update:modalHandler","update:OnSuccess"],setup(e,{emit:s}){const i=e,b=He(),h=B(),g=N(),w=a(!1),V=l(),P=window.origin;a(`${P}/proposal-view/?proposal=${i.proposalData?.id}`);const D=()=>{s("update:modalHandler",!1)},S=i.selectedProposalsIds.map((e=>e.id)),T=S.map(((e,l)=>`<a href="${P}/proposal-view/?proposal=${e}" style="color: #007bff; text-decoration: none; font-weight: bold;">View Proposal ${l+1}</a>`)).join("<br>"),j=a({email:b.leadProposalFormData?.jobInfo?.clientInfo?.email?b.leadProposalFormData?.jobInfo?.clientInfo?.email:"N/A",subject:`Proposal ${b.leadProposalFormData?.jobInfo?.title} `,link:T,message:`${T}`,columns:["cost_code","title","description","unit_cost"],showClient:!0,proposal_ids:S}),M=async()=>{try{w.value=!0;const e=z(j.value,[]);await h.post("/api/lead-proposal/send-proposal-template/",e);g.success("Email sent to worker successfully"),D()}catch(e){console.log(e)}finally{w.value=!1}},O=t((()=>o((()=>import("./ckeditor-dbf08bf4.js").then((e=>e.c))),["assets/ckeditor-dbf08bf4.js","assets/index-70af507c.js","assets/index-ce8747cd.css","assets/vue.runtime.esm-bundler-c9a83e39.js"]).then((e=>e.default.component)))),A={fontFamily:{options:['"Montserrat", sans-serif','"Roboto", sans-serif']},height:"400px",minHeight:"400px",maxHeight:"600px"};return n((async()=>{V.value=await o((()=>import("./ckeditor-2554a6f6.js").then((e=>e.c))),["assets/ckeditor-2554a6f6.js","assets/index-70af507c.js","assets/index-ce8747cd.css"]).then((e=>e.default))})),(e,l)=>{const a=k,s=E;return d(),f("div",null,[p(x,{name:"fade-slow"},{default:u((()=>[p(s,{is:"form",open:i.proposalSenderModal,title:"Send Proposal",size:"large",actions:"right",onSubmit:C(M,["prevent"]),onClose:D},{content:u((()=>[c("div",Fe,[c("div",Le,[c("div",$e,[qe,c("div",Re,[_(c("input",{type:"email",required:"",class:"input",placeholder:"Enter Mail","onUpdate:modelValue":l[0]||(l[0]=e=>v(j).email=e)},null,512),[[m,v(j).email]])])])]),c("div",Be,[c("div",Ne,[ze,c("div",We,[_(c("input",{type:"text",required:"",class:"input",placeholder:"Enter mail subject","onUpdate:modelValue":l[1]||(l[1]=e=>v(j).subject=e)},null,512),[[m,v(j).subject]])])])]),c("div",Ge,[Je,v(V)?(d(),r(v(O),{key:0,modelValue:v(j).message,"onUpdate:modelValue":l[2]||(l[2]=e=>v(j).message=e),editor:v(V),config:A},null,8,["modelValue","editor"])):I("",!0)])])])),action:u((()=>[p(a,{type:"submit",color:"primary",loading:v(w),raised:""},{default:u((()=>[Ke,y(" Send Proposal")])),_:1},8,["loading"])])),cancel:u((()=>[p(a,{color:"light",onClick:D,raised:""},{default:u((()=>[y("Close ")])),_:1})])),_:1},8,["open","onSubmit"])])),_:1})])}}}),Xe=e=>(S("data-v-e5fe4934"),e=e(),T(),e),Ye={class:"columns is-multiline"},Ze=Xe((()=>c("div",{class:"column is-9"},[c("h1",{class:"title is-5 m-1 p-0"},"Preview Lead Proposal"),c("p",{class:"m-1"}," Below is a preview of the proposal that will be sent as a link to the email addresses on this client contact. The proposal can be accessed through the link while it is Released. ")],-1))),el={class:"column is-12"},ll={class:"invoice-wrapper"},al={class:"invoice-header"},sl={class:"left"},tl=Xe((()=>c("a",{class:"action"},[c("i",{"aria-hidden":"true",class:"iconify","data-icon":"feather:printer"})],-1))),ol=Xe((()=>c("a",{class:"action"},[c("i",{"aria-hidden":"true",class:"iconify","data-icon":"feather:download-cloud"})],-1))),nl=[Xe((()=>c("i",{"aria-hidden":"true",class:"iconify","data-icon":"feather:mail"},null,-1)))],il={class:"invoice-body"},dl={class:"invoice-card"},rl={class:"invoice-section is-flex is-bordered"},ul=Xe((()=>c("div",{class:"meta"},null,-1))),cl=Xe((()=>c("div",{class:"end is-right"},[c("span",null,"PO Box 242"),c("span",null,"Evergreen, CO 80437-0242"),c("span",null,"Phone: 720 272-9061"),c("span",null,"Premium Trades for Premier Builders")],-1))),pl={class:"invoice-section is-flex is-bordered"},_l={class:"meta"},ml={class:"end is-left"},vl={class:"invoice-section"},fl={class:"responsive-table"},bl=["innerHTML"],hl={key:1},yl={class:"invoice-section is-flex mt-0 pt-0"},Il={class:"end is-left"},gl={class:"text-right"},wl=D('<div class="invoice-section is-flex mt-0 pt-0" data-v-e5fe4934><div class="footer" data-v-e5fe4934><div class="footer-meta" data-v-e5fe4934><p data-v-e5fe4934>Signature:</p><div data-v-e5fe4934> ___________________________________________________________________________________ </div></div><div class="footer-meta" data-v-e5fe4934><p data-v-e5fe4934>Date:</p><div data-v-e5fe4934> ___________________________________________________________________________________ </div></div><div class="footer-meta" data-v-e5fe4934><p class="no-wrap" data-v-e5fe4934>Print Name:</p><div data-v-e5fe4934> ___________________________________________________________________________________ </div></div></div></div>',1),Cl=j(e({__name:"ProposalPreview",props:{columnsToShow:{},proposalData:{}},setup(e){const l=e,s=He(),t=a(!1),o=a([]),i=a([]),u=a({}),_=()=>{i.value.push(l.proposalData.id),u.value=l.proposalData,o.value=s.leadProposalFormData.columns_to_show,t.value=!t.value};return n((()=>{})),(e,a)=>{const o=J,n=Qe;return d(),f("div",Ye,[Ze,c("div",el,[c("div",ll,[c("div",al,[c("div",sl,[c("h3",null," Proposal-ID "+w(v(s).leadProposalFormData?.id.slice(1,8)),1)]),c("div",{class:"right"},[c("div",{class:"controls"},[tl,ol,c("a",{class:"action",onClick:_},nl)])])]),c("div",il,[c("div",dl,[c("div",rl,[p(o,{size:"xl",picture:"/logos/IbexFavicon.png"}),ul,cl]),c("div",pl,[c("div",_l,[c("h3",null,w(v(s).leadProposalFormData?.jobInfo?.clientInfo?.username??"N/A")+" "+w(v(s).leadProposalFormData?.jobInfo?.clientInfo?.last_name??""),1),c("span",null,w(v(s).leadProposalFormData?.jobInfo?.clientInfo?.email?v(s).leadProposalFormData?.jobInfo?.clientInfo?.email:"N/A"),1)]),c("div",ml,[c("h3",null,w(v(W)(v(s).leadProposalFormData?.created_at)),1),c("p",null," Job Address: "+w(v(s).leadProposalFormData?.jobInfo?.address??"N/A"),1)])]),c("div",vl,[c("table",fl,[c("thead",null,[(d(!0),f(h,null,b(v(s).leadProposalFormData.columns_to_show,((e,l)=>(d(),f("th",{key:l},w(v(K)[e]),1)))),128))]),c("tbody",null,[(d(!0),f(h,null,b(v(s).proposalCostItems,((e,l)=>(d(),f("tr",{key:e.id},[(d(!0),f(h,null,b(v(s).leadProposalFormData.columns_to_show,((l,a)=>(d(),f("td",{key:a},["Description"===l?(d(),f("div",{key:0,innerHTML:e[v(Q)[l]]},null,8,bl)):(d(),f("span",hl,w(e[v(Q)[l]]),1))])))),128))])))),128))])])]),c("div",yl,[c("div",Il,[c("h3",gl," Total Price: $"+w(v(s).leadProposalFormData?.proposalAmount),1)])]),wl])])])]),v(t)?(d(),r(n,{key:0,proposalSenderModal:v(t),selectedProposalsIds:v(i),proposalData:l.proposalData,columnsToShow:l.columnsToShow,"onUpdate:modalHandler":a[0]||(a[0]=e=>t.value=!1)},null,8,["proposalSenderModal","selectedProposalsIds","proposalData","columnsToShow"])):I("",!0)])}}}),[["__scopeId","data-v-e5fe4934"]]),kl=e=>(S("data-v-eafba95d"),e=e(),T(),e),Vl={class:"datatable-wrapper mt-0"},Pl={class:"table-container"},xl={class:"table datatable-table is-fullwidth",id:"external-events"},Dl=kl((()=>c("th",null,"Item#",-1))),Sl=kl((()=>c("th",null,"Actions",-1))),Tl=["data-event","onDragstart","onDrop"],jl={class:"is-relative"},Ml=["onClick"],Ol=kl((()=>c("i",{style:{cursor:"grab"},class:"lnir lnir-sort","aria-hidden":"true"},null,-1))),Al=["innerHTML"],Ul={key:1},El=["onClick"],Hl=[kl((()=>c("div",{class:"icon"},[c("i",{"aria-hidden":"true",class:"lnil lnil-eye"})],-1))),kl((()=>c("div",{class:"meta"},[c("span",null,"View"),c("span",null,"View user details")],-1)))],Fl=["onClick"],Ll=[kl((()=>c("div",{class:"icon"},[c("i",{"aria-hidden":"true",class:"lnil lnil-briefcase"})],-1))),kl((()=>c("div",{class:"meta"},[c("span",null,"Edit"),c("span",null,"Edit Cost Item")],-1)))],$l=kl((()=>c("hr",{class:"dropdown-divider"},null,-1))),ql=["onClick"],Rl=[kl((()=>c("div",{class:"icon"},[c("i",{"aria-hidden":"true",class:"lnil lnil-trash-can-alt"})],-1))),kl((()=>c("div",{class:"meta"},[c("span",null,"Remove"),c("span",null,"Remove from list")],-1)))],Bl=j(e({__name:"CostItemsTable",props:{columnsToShow:{},itemsList:{}},setup(e){const l=e,s=He(),t=N(),o=a({title:"",subtitle:"test",isSweetAlertOpen:!1,btntext:"text"}),i=B(),_=a(""),m=a(!1);a([]);const g=e=>{e.preventDefault()},k=e=>{e.preventDefault(),e.currentTarget?.classList.add("drag-over")},V=e=>{e.preventDefault(),e.currentTarget?.classList.remove("drag-over")},P=a(""),x=a(0),D=a(""),S=a(!1),T=a(!1),j=async()=>{try{T.value=!0;await i.delete(`/api/cost/${D.value}/`);O(),o.value.isSweetAlertOpen=!1,t.success("Cost item deleted")}catch(e){console.log(e)}finally{T.value=!1}},M=(e,l=!1)=>{D.value=e.id,S.value=l,P.value=e.proposal,m.value=!m.value},O=()=>{s.getProposalCostItems(P.value)};return n((()=>{})),(e,a)=>{const t=ee,n=Z,T=Ee;return d(),f("div",Vl,[c("div",Pl,[c("table",xl,[c("thead",null,[Dl,(d(!0),f(h,null,b(l.columnsToShow,((e,l)=>(d(),f("th",{key:l},w(v(K)[e]),1)))),128)),Sl]),c("tbody",null,[v(s).proposalCostItems.length>0?(d(!0),f(h,{key:0},b(v(s).proposalCostItems,((e,a)=>(d(),f("tr",{key:e.id,"data-event":JSON.stringify(e),draggable:"true",onDragstart:l=>{return a=e.id,_.value=a,void console.log("Drag started for ID:",a);var a},onDrop:l=>(e=>{console.log("Dropped on ID:",e);const l=s.proposalCostItems.find((e=>e.id===_.value)),a=s.proposalCostItems.find((l=>l.id===e));if(l&&a){i.post("/api/cost/drag-drop-items/",{dragged_item_id:l.id,dropped_item_id:a.id});const e=s.proposalCostItems.indexOf(l),t=s.proposalCostItems.indexOf(a);e>=0&&t>=0&&(s.proposalCostItems.splice(e,1),s.proposalCostItems.splice(t,0,l))}else console.error("Dragged or Dropped Item not found");_.value=null})(e.id),onDragover:g,onDragenter:k,onDragleave:V,class:"draggable-item events"},[c("td",jl,[c("i",{style:{position:"absolute",bottom:"-7px",left:"1px",cursor:"pointer","font-weight":"600"},onClick:l=>(e=>{P.value=e.proposal,x.value=e.index,m.value=!m.value})(e),class:"lnir lnir-circle-plus info-text","aria-hidden":"true"},null,8,Ml),Ol,y(" "+w(a+1),1)]),(d(!0),f(h,null,b(l.columnsToShow,((l,a)=>(d(),f("td",{key:a},["description"===l?(d(),f("div",{key:0,innerHTML:e[v(Q)[l]]},null,8,Al)):(d(),f("span",Ul,w(e[v(Q)[l]]),1))])))),128)),c("td",null,[p(t,{icon:"feather:more-vertical",class:"is-pushed-mobile",spaced:"",right:""},{content:u((({close:l})=>[c("a",{role:"menuitem",href:"#",class:"dropdown-item is-media",onClick:C((()=>{M(e,!0),l()}),["prevent"])},Hl,8,El),c("a",{role:"menuitem",href:"#",class:"dropdown-item is-media",onClick:C((()=>{M(e,!1),l()}),["prevent"])},Ll,8,Fl),$l,c("a",{role:"menuitem",href:"#",class:"dropdown-item is-media",onClick:C((()=>{(e=>{D.value=e.id,P.value=e.proposal,o.value={title:"Are you sure?",subtitle:"You will not be able to recover this cost item!",btntext:"Delete",isSweetAlertOpen:!0}})(e),l()}),["prevent"])},Rl,8,ql)])),_:2},1024)])],40,Tl)))),128)):I("",!0)])])]),v(o).isSweetAlertOpen?(d(),r(n,{key:0,isSweetAlertOpen:v(o).isSweetAlertOpen,title:v(o).title,subtitle:v(o).subtitle,btntext:v(o).btntext,onConfirm:j,onCancel:()=>v(o).isSweetAlertOpen=!1},null,8,["isSweetAlertOpen","title","subtitle","btntext","onCancel"])):I("",!0),v(m)?(d(),r(T,{key:1,costItemModal:v(m),proposalId:v(P),costItemId:v(D),previousItemIndex:v(x),previewCostItems:v(S),"onUpdate:modalHandler":a[0]||(a[0]=e=>m.value=!1),"onUpdate:OnSuccess":O},null,8,["costItemModal","proposalId","costItemId","previousItemIndex","previewCostItems"])):I("",!0)])}}}),[["__scopeId","data-v-eafba95d"]]),Nl={class:"columns is-multiline"},zl={class:"column is-12 is-flex space-between"},Wl=c("div",null,[c("h1",{class:"title is-4"},"Proposal Worksheet")],-1),Gl={key:0,class:"column is-12"},Jl={class:"tabs-wrapper column is-12 m-0"},Kl={class:"tabs-inner mt-4"},Ql={class:"tabs is-boxed"},Xl=[c("span",null,"Worksheet",-1)],Yl=[c("span",null,"Format",-1)],Zl=[c("span",null,"Preview",-1)],ea={key:0,class:"column is-12"},la={key:0,class:"column is-12"},aa={class:"columns is-multiline"},sa=c("div",{class:"column is-12",style:{"text-align":"center"}},[c("h1",{class:"title is-4"},"Connect your clients to their projects"),c("h1",{class:"title is-5"}," Create a client contact and assign them to jobs and lead opportunities effortlessly. ")],-1),ta={class:"column is-12"},oa={key:0,class:"column is-12"},na=e({__name:"WorksheetItems",props:{leadProposalModal:{type:Boolean},proposalId:{},proposalData:{}},emits:["update:modalHandler","update:OnSuccess"],setup(e,{emit:s}){const _=e,m=l(),b=He(),h=a(!1),w=a(!1),P=a("worksheet");t((()=>o((()=>import("./ckeditor-dbf08bf4.js").then((e=>e.c))),["assets/ckeditor-dbf08bf4.js","assets/index-70af507c.js","assets/index-ce8747cd.css","assets/vue.runtime.esm-bundler-c9a83e39.js"]).then((e=>e.default.component))));const x=async()=>{try{b.getProposalCostItems(_.proposalId)}catch(e){console.log(e)}};return n((async()=>{m.value=await o((()=>import("./ckeditor-2554a6f6.js").then((e=>e.c))),["assets/ckeditor-2554a6f6.js","assets/index-70af507c.js","assets/index-ce8747cd.css"]).then((e=>e.default)),_.proposalId&&(x(),b.getProposalDetail(_.proposalId))})),M((()=>{b.clearProposalId()})),(e,l)=>{const a=k,s=i("Multiselect"),t=$,o=L,n=Bl,m=V,b=Cl,D=Ee;return d(),f("div",null,[c("div",Nl,[c("div",zl,[Wl,c("div",null,[p(a,{size:"small",light:"",outlined:"",icon:"fas fa-cog",class:"mr-2",color:v(w)?"danger":"success",onClick:l[0]||(l[0]=e=>w.value=!v(w))},{default:u((()=>[y("Table")])),_:1},8,["color"]),p(a,{size:"small",light:"",outlined:"",class:"mr-2",color:"info",onClick:l[1]||(l[1]=e=>h.value=!v(h))},{default:u((()=>[y("Import")])),_:1}),p(a,{size:"small",light:"",outlined:"",class:"mr-2",color:"primary",onClick:l[2]||(l[2]=e=>h.value=!v(h))},{default:u((()=>[y("Add From")])),_:1}),p(a,{size:"small",light:"",outlined:"",color:"warning",onClick:l[3]||(l[3]=e=>h.value=!v(h))},{default:u((()=>[y("Add Item")])),_:1})])]),p(O,{class:"fade-slow",name:"fade-slow"},{default:u((()=>[v(w)?(d(),f("div",Gl,[p(o,{label:"Choose what to show to lead",class:"column is-12"},{default:u((({id:e})=>[p(t,null,{default:u((()=>[p(s,{modelValue:v(X),"onUpdate:modelValue":l[4]||(l[4]=e=>g(X)?X.value=e:null),attrs:{id:e},mode:"tags",searchable:!0,"create-tag":!0,options:v(Y),placeholder:"Add columns"},null,8,["modelValue","attrs","options"])])),_:2},1024)])),_:1})])):I("",!0)])),_:1}),c("div",Jl,[c("div",Kl,[c("div",Ql,[c("ul",null,[c("li",{class:A(["worksheet"===v(P)?"is-active":"not-active"])},[c("a",{tabindex:"0",role:"button",onKeydown:l[5]||(l[5]=U(C((e=>P.value="worksheet"),["prevent"]),["space"])),onClick:l[6]||(l[6]=e=>P.value="worksheet")},Xl,32)],2),c("li",{class:A(["format"===v(P)?"is-active":"not-active"])},[c("a",{tabindex:"0",role:"button",onKeydown:l[7]||(l[7]=U(C((e=>P.value="format"),["prevent"]),["space"])),onClick:l[8]||(l[8]=e=>P.value="format")},Yl,32)],2),c("li",{class:A(["preview"===v(P)?"is-active":"not-active"])},[c("a",{tabindex:"0",role:"button",onKeydown:l[9]||(l[9]=U(C((e=>P.value="preview"),["prevent"]),["space"])),onClick:l[10]||(l[10]=e=>P.value="preview")},Zl,32)],2)])])])]),p(O,{class:"fade-slow",name:"slide-x"},{default:u((()=>["worksheet"===v(P)?(d(),f("div",ea,[p(n,{columnsToShow:v(X),proposalId:_.proposalId},null,8,["columnsToShow","proposalId"])])):I("",!0)])),_:1}),p(O,{class:"fade-slow",name:"slide-x"},{default:u((()=>["format"===v(P)?(d(),f("div",la,[c("div",aa,[p(o,{label:"Choose what to show to lead",class:"column is-12"},{default:u((({id:e})=>[p(t,null,{default:u((()=>[p(s,{modelValue:v(X),"onUpdate:modelValue":l[11]||(l[11]=e=>g(X)?X.value=e:null),attrs:{id:e},mode:"tags",searchable:!0,"create-tag":!0,options:v(Y),placeholder:"Add tags"},null,8,["modelValue","attrs","options"])])),_:2},1024)])),_:1})]),p(m,{class:"columns is-multiline m-0"},{default:u((()=>[sa,c("div",ta,[p(n,{columnsToShow:v(X)},null,8,["columnsToShow"])])])),_:1})])):I("",!0)])),_:1}),p(O,{class:"fade-slow",name:"slide-x"},{default:u((()=>["preview"===v(P)?(d(),f("div",oa,[p(b,{proposalData:_.proposalData,columnsToShow:v(X)},null,8,["proposalData","columnsToShow"])])):I("",!0)])),_:1})]),v(h)?(d(),r(D,{key:0,costItemModal:v(h),proposalId:_.proposalId,"onUpdate:modalHandler":l[12]||(l[12]=e=>h.value=!1),"onUpdate:OnSuccess":x},null,8,["costItemModal","proposalId"])):I("",!0)])}}}),ia=e=>(S("data-v-0317543a"),e=e(),T(),e),da={class:"columns is-multiline"},ra=ia((()=>c("div",{class:"column is-2"},null,-1))),ua={class:"column is-8"},ca=ia((()=>c("div",{class:"column is-2"},null,-1))),pa=ia((()=>c("div",{class:"column is-2"},null,-1))),_a=ia((()=>c("div",{class:"column is-8"},[c("p",null," All the tasks will be generated and will start from the date you will put. ")],-1))),ma=ia((()=>c("div",{class:"column is-2"},null,-1))),va=j(e({__name:"CreateProposalTasksModal",props:{createProposalTasksModal:{type:Boolean,default:!1},proposalId:{default:""}},emits:["closeModalHandler","update:OnSuccess"],setup(e,{emit:l}){const s=e,t=N(),o=B(),i=a(""),_=a(!1),m=()=>{l("update:OnSuccess",null),l("closeModalHandler",!1)},f=async()=>{try{await o.post("/api/lead-proposal/create-tasks/",{start:i.value,proposal:s.proposalId});t.success("Tasks of this proposal are created in calendar successfully."),m()}catch(e){console.log(e),t.error("Something went wrong, please review the cost codes")}};return n((()=>{})),(e,l)=>{const a=H,t=$,o=L,n=k,b=E;return d(),r(b,{is:"form",open:s.createProposalTasksModal,title:"Generate Tasks",size:"small",actions:"center",onSubmit:C(f,["prevent"]),onClose:m},{content:u((()=>[c("div",da,[ra,c("div",ua,[p(o,{label:"Enter Tasks Starting Date"},{default:u((()=>[p(t,null,{default:u((()=>[p(a,{modelValue:v(i),"onUpdate:modelValue":l[0]||(l[0]=e=>g(i)?i.value=e:null),required:"",name:"startDate",type:"date"},null,8,["modelValue"])])),_:1})])),_:1})]),ca,pa,_a,ma])])),cancel:u((()=>[p(n,{light:"",onClick:l[1]||(l[1]=e=>m())},{default:u((()=>[y("Cancel")])),_:1})])),action:u((()=>[p(n,{loading:v(_),type:"submit",color:"info",light:"",raised:""},{default:u((()=>[y("Generate")])),_:1},8,["loading"])])),_:1},8,["open","onSubmit"])}}}),[["__scopeId","data-v-0317543a"]]);export{na as _,Qe as a,va as b,Ee as c,He as u};
