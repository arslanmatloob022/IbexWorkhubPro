import{_ as e}from"./LeadAddUpdateModal.vue_vue_type_style_index_0_lang-3f92a76d.js";import{c as t,_ as r}from"./VFlexTable.vue_vue_type_style_index_0_lang-99c8bbaf.js";import{_ as n}from"./VIconWrap.vue_vue_type_style_index_0_lang-75f81f52.js";import{_ as o}from"./VPlaceholderPage.vue_vue_type_style_index_0_lang-8c5e7b0f.js";import{_ as i}from"./VCheckbox.vue_vue_type_style_index_0_lang-38c5f9bd.js";import{_ as s}from"./VTextarea.vue_vue_type_script_setup_true_lang-8fa47c16.js";import{_ as a}from"./VField.vue_vue_type_script_setup_true_lang-ecacee0a.js";import{_ as l}from"./VInput.vue_vue_type_script_setup_true_lang-9ccb4bbf.js";import{_ as u}from"./VControl-8ec090b2.js";import{f as h,b as c,r as d,w as p,$ as m,o as g,av as f,C as y,D as w,E,F as v,G as R,K as S,U as T,L as C,X as b,N,aS as A,m as I,O,V as M,W as _,P as x,al as F,Q as P,R as V,S as H,I as D,x as U,H as k,J as B,B as W,k as G,aB as j,a as z,bq as $,Z as Y,n as X,y as K}from"./index-203aa1df.js";import{_ as q,a as Q}from"./search-4-dark-2b5b440c.js";import{u as Z}from"./useAPI-fb22fc83.js";import{u as J}from"./useNotyf-4bfde6a7.js";import{b as ee,a as te,C as re,f as ne}from"./useSupportElement-14efeaf4.js";import{_ as oe,a as ie}from"./ProjectFiles-9c3f7db3.js";import{u as se,_ as ae,a as le}from"./groupedCircleCharts-2a1d76b5.js";import{b as ue,u as he,a as ce,c as de,_ as pe}from"./groupedRadialCharts-689689df.js";import{_ as me}from"./SparkStatWidget.vue_vue_type_style_index_0_lang-288fb39c.js";import{A as ge}from"./vue3-apexcharts.common-6504eec7.js";import{u as fe}from"./salesSparksChart-50078f0c.js";import{u as ye}from"./revenueAreaChart-7599c658.js";import{_ as we}from"./VAvatar.vue_vue_type_style_index_0_lang-752f1522.js";import{h as Ee}from"./moment-1b9a430c.js";import{_ as ve}from"./FlexTableDropdown.vue_vue_type_script_setup_true_lang-03fa1d87.js";import{p as Re}from"./index-c1fc2d09.js";import{a as Se}from"./TaskInfoModal.vue_vue_type_script_setup_true_lang-65e8a2f4.js";import{_ as Te}from"./VPlaceloadAvatar.vue_vue_type_style_index_0_lang-b5ed4cdb.js";import{_ as Ce}from"./VPlaceloadText.vue_vue_type_style_index_0_lang-48dc4a05.js";import{o as be}from"./via-placeholder-24645670.js";import{_ as Ne}from"./JobLeadActivities.vue_vue_type_style_index_0_lang-04ad156e.js";import{_ as Ae}from"./VModal.vue_vue_type_style_index_0_lang-2551e5bf.js";import{_ as Ie}from"./VLabel.vue_vue_type_script_setup_true_lang-794f9aaf.js";import{_ as Oe}from"./VDropdown.vue_vue_type_style_index_0_lang-f055ca58.js";import{_ as Me}from"./PlaceloadV4.vue_vue_type_style_index_0_lang-c70384f8.js";import{f as _e}from"./index-5fa9b154.js";import{_ as xe}from"./UIWidget.vue_vue_type_style_index_0_lang-b9e0409f.js";import{_ as Le}from"./JobTodos.vue_vue_type_style_index_0_lang-cd8e60c9.js";import{_ as Fe}from"./UserCardDropdown-013a6bf1.js";import{_ as Pe}from"./VTag.vue_vue_type_style_index_0_lang-cb2a46f2.js";import{_ as Ve}from"./VIconBox.vue_vue_type_style_index_0_lang-6dec787f.js";import{_ as He}from"./LeadProposalsList.vue_vue_type_style_index_0_lang-79343d53.js";const De=e=>(P("data-v-08daf78f"),e=e(),V(),e),Ue={class:"column is-12"},ke={class:"list-flex-toolbar is-reversed"},Be={class:"columns is-multiline"},We={key:0,class:"column is-12 card p-4 curved mb-2"},Ge={class:"columns is-multiline"},je={class:"column is-10"},ze={class:"column is-2"},$e=De((()=>E("img",{class:"light-image",src:q,alt:""},null,-1))),Ye=De((()=>E("img",{class:"dark-image",src:Q,alt:""},null,-1))),Xe={class:"is-flex space-between mb-4 bottom-border"},Ke={class:"title is-5 m-0"},qe={class:"content"},Qe={class:"is-flex"},Ze={key:0,class:"columns is-multiline"},Je={class:"column is-6"},et={class:"column is-2"},tt={class:"column is-2"},rt={class:"column is-2"},nt={class:"column is-2"},ot={class:"column is-2"},it={class:"column is-2"},st={class:"column is-2"},at={class:"column is-2"},lt={class:"column is-2"},ut={class:"is-flex columns is-multiline"},ht=h({__name:"CalculationsList",props:{fetchAll:{},fetchTemplates:{},userId:{},objectId:{}},setup(e){const h=e;c();const L=Z(),P=J(),V=d(!1),H={username:{label:"Title",grow:!0},location:"Height",industry:"Width",unit:"Unit",contacts:"Unit Price",totalPrice:"Total Price",quantity:"Quantity",grandTotalPrice:"Grand Total Price",action:{label:"Action",align:"end"}},D=d(!1),U=d(!1),k=d([{id:"",title:"",is_template:!1,object:"",description:"",created_at:"",items:[{id:"cd65c781-5fd1-48d9-9d6c-7af86ec5a72f",title:"Item One Of Kitchen Tiling",height:0,width:0,item_area:0,unit:"Sq ft",item_unit_price:0,item_total_price:0,quantity:0,grand_total_price:0,additional_data:{},is_active:!0,created_at:"2025-03-23T10:25:29.447261Z",updated_at:"2025-03-23T10:25:29.447272Z",section:"bdff8ebb-a0f5-475a-bc48-a6c3699eb550"}]}]),B=d(""),W=d(""),G=d({id:"",title:"",height:0,width:0,item_area:0,unit:"",item_unit_price:0,item_total_price:0,quantity:0,grand_total_price:0,additional_data:{},is_active:!0,created_at:"",updated_at:"",section:""}),j=d({title:"",is_template:!1,object:h.objectId??"",description:""}),z=async()=>{try{const e=await L.get(`/api/calculation-section/?object=${h.objectId??""}&user_id=${h.userId??""}&is_template=${h.fetchTemplates??""}`);k.value=e.data}catch(e){console.error(e)}finally{V.value=!1}},$=async()=>{try{const e=j.value;await L.post("/api/calculation-section/",e);P.success("Section created successfully!"),z()}catch(e){console.error(e)}finally{V.value=!1}};p((()=>G.value.width),(()=>{let e=0;e=G.value.height*G.value.width,G.value.item_area=e.toFixed(2)})),p((()=>G.value.item_unit_price),(()=>{let e=0;e=G.value.item_area*G.value.item_unit_price,G.value.item_total_price=e.toFixed(2)})),p((()=>G.value.quantity),(()=>{let e=0;e=G.value.item_total_price*G.value.quantity,G.value.grand_total_price=e.toFixed(2)}));const Y=async()=>{try{const e=G.value;e.section=B.value;await L.post("/api/calculation-section-items/",e);P.success("Section created successfully!"),z()}catch(e){console.error(e)}finally{V.value=!1}},X=m((()=>{if(W.value){const e=new RegExp(W.value,"i");return k.value.filter((t=>t.title?.match(e)))}return k.value})),K=async e=>{try{await L.delete(`/api/calculation-section/${e}/`),P.success("Section deleted successfully!"),z()}catch(t){console.error(t),P.error("Failed to delete sheet.")}};return g((async()=>{await z(),await z()})),(e,h)=>{const c=x,d=F,p=u,m=l,g=a,L=s,P=i,V=o,k=n,z=t,q=r,Q=f("tooltip");return y(),w("div",Ue,[E("div",ke,[v(d,null,{default:R((()=>[v(c,{icon:U.value?"fas fa-window-close":"fas fa-plus",color:U.value?"warning":"primary",class:"ml-2",raised:"",onClick:h[0]||(h[0]=e=>U.value=!U.value)},{default:R((()=>[S(T(U.value?"Close":"Section"),1)])),_:1},8,["icon","color"]),v(c,{icon:"fas fa-file-import",color:"info",class:"ml-2",raised:"",onClick:h[1]||(h[1]=e=>U.value=!U.value)},{default:R((()=>[S("Import")])),_:1})])),_:1}),E("div",null,[v(p,{class:"mr-2 h-hidden-mobile",icon:"feather:search"},{default:R((()=>[C(E("input",{"onUpdate:modelValue":h[2]||(h[2]=e=>W.value=e),class:"input custom-text-filter",placeholder:"Search..."},null,512),[[b,W.value]])])),_:1})])]),E("div",Be,[v(A,{name:"translate-page-y"},{default:R((()=>[U.value?(y(),w("div",We,[E("div",Ge,[E("div",je,[v(g,null,{default:R((()=>[v(p,null,{default:R((()=>[v(m,{modelValue:j.value.title,"onUpdate:modelValue":h[3]||(h[3]=e=>j.value.title=e),type:"text",placeholder:"Section Title"},null,8,["modelValue"])])),_:1})])),_:1}),v(g,null,{default:R((()=>[v(p,null,{default:R((()=>[v(L,{modelValue:j.value.description,"onUpdate:modelValue":h[4]||(h[4]=e=>j.value.description=e),type:"text",rows:"2",placeholder:"Section Description"},null,8,["modelValue"])])),_:1})])),_:1})]),E("div",ze,[v(c,{color:"primary",outlined:"",light:"",bold:"",fullwidth:"",class:"ml-2",raised:"",onClick:$},{default:R((()=>[S(" Add Section")])),_:1}),v(p,{raw:"",subcontrol:""},{default:R((()=>[v(P,{modelValue:j.value.is_template,"onUpdate:modelValue":h[5]||(h[5]=e=>j.value.is_template=e),label:"Create Template",color:"info"},null,8,["modelValue"])])),_:1})])])])):N("",!0)])),_:1}),I(X).length?N("",!0):(y(),O(V,{key:0,title:"There is not custom calculations are added on this Job.",subtitle:"Too bad. Looks like we couldn't find any calculation and measurements for the\n          Job.",larger:""},{image:R((()=>[$e,Ye])),_:1})),v(A,{name:"from-bottom"},{default:R((()=>[I(X).length?(y(!0),w(M,{key:0},_(I(X),((e,t)=>(y(),w("div",{class:"column is-12 card p-4 curved mb-2",key:e.id},[E("div",Xe,[E("div",null,[E("h4",Ke,T(e.title),1),E("div",qe,[E("p",null,T(I(ee)(e.created_at)),1)])]),E("div",Qe,[v(k,{icon:"lucide:pen",color:"info",class:"cu-pointer","has-background":""}),C(v(k,{icon:"fas fa-plus",color:D.value?"dark":"primary",class:"cu-pointer ml-1",onClick:t=>(async e=>{B.value=e,D.value=!D.value,0==D.value&&(G.value={id:"",title:"",height:0,width:0,item_area:0,unit:"",item_unit_price:0,item_total_price:0,quantity:0,grand_total_price:0,additional_data:{},is_active:!0,created_at:"",updated_at:"",section:""})})(e.id),"has-background":""},null,8,["color","onClick"]),[[Q,"Add Item",void 0,{rounded:!0,primary:!0}]]),C(v(k,{onClick:t=>K(e.id),icon:"fas fa-copy",color:"warning","has-background":"",class:"cu-pointer ml-1"},null,8,["onClick"]),[[Q,"Create Template",void 0,{rounded:!0,warning:!0}]]),v(k,{onClick:t=>K(e.id),icon:"lucide:trash",color:"danger","has-background":"",class:"cu-pointer ml-1"},null,8,["onClick"])])]),D.value?(y(),w("div",Ze,[E("div",Je,[v(g,{label:"Title"},{default:R((()=>[v(p,null,{default:R((()=>[v(m,{modelValue:G.value.title,"onUpdate:modelValue":h[6]||(h[6]=e=>G.value.title=e),type:"text",placeholder:"Item Title"},null,8,["modelValue"])])),_:1})])),_:1})]),E("div",et,[v(g,{label:"Height"},{default:R((()=>[v(p,null,{default:R((()=>[v(m,{modelValue:G.value.height,"onUpdate:modelValue":h[7]||(h[7]=e=>G.value.height=e),type:"text",placeholder:"Height"},null,8,["modelValue"])])),_:1})])),_:1})]),E("div",tt,[v(g,{label:"Width"},{default:R((()=>[v(p,null,{default:R((()=>[v(m,{modelValue:G.value.width,"onUpdate:modelValue":h[8]||(h[8]=e=>G.value.width=e),type:"text",placeholder:"Width"},null,8,["modelValue"])])),_:1})])),_:1})]),E("div",rt,[v(g,{label:"Area"},{default:R((()=>[v(p,null,{default:R((()=>[v(m,{modelValue:G.value.item_area,"onUpdate:modelValue":h[9]||(h[9]=e=>G.value.item_area=e),type:"number",step:"2",placeholder:"Area"},null,8,["modelValue"])])),_:1})])),_:1})]),E("div",nt,[v(g,{label:"Unit"},{default:R((()=>[v(p,null,{default:R((()=>[v(m,{modelValue:G.value.unit,"onUpdate:modelValue":h[10]||(h[10]=e=>G.value.unit=e),type:"text",placeholder:"Unit"},null,8,["modelValue"])])),_:1})])),_:1})]),E("div",ot,[v(g,{label:"Unit Price"},{default:R((()=>[v(p,null,{default:R((()=>[v(m,{modelValue:G.value.item_unit_price,"onUpdate:modelValue":h[11]||(h[11]=e=>G.value.item_unit_price=e),type:"text",placeholder:"Unit price"},null,8,["modelValue"])])),_:1})])),_:1})]),E("div",it,[v(g,{label:"Total Price"},{default:R((()=>[v(p,null,{default:R((()=>[v(m,{modelValue:G.value.item_total_price,"onUpdate:modelValue":h[12]||(h[12]=e=>G.value.item_total_price=e),type:"text",placeholder:"Total price"},null,8,["modelValue"])])),_:1})])),_:1})]),E("div",st,[v(g,{label:"Quantity"},{default:R((()=>[v(p,null,{default:R((()=>[v(m,{modelValue:G.value.quantity,"onUpdate:modelValue":h[13]||(h[13]=e=>G.value.quantity=e),type:"text",placeholder:"Quantity"},null,8,["modelValue"])])),_:1})])),_:1})]),E("div",at,[v(g,{label:"Grand Total"},{default:R((()=>[v(p,null,{default:R((()=>[v(m,{modelValue:G.value.grand_total_price,"onUpdate:modelValue":h[14]||(h[14]=e=>G.value.grand_total_price=e),type:"text",placeholder:"Grand Total"},null,8,["modelValue"])])),_:1})])),_:1})]),E("div",lt,[v(c,{light:"",fullwidth:"",onClick:Y,color:"primary",outlined:"",class:"mt-5"},{default:R((()=>[S("Add Item")])),_:1})])])):N("",!0),E("div",ut,[e.items.length?(y(),O(q,{key:0,class:"column is-12",data:e.items,columns:H,compact:""},{body:R((()=>[v(A,{name:"list",tag:"div",class:"flex-list-inner"},{default:R((()=>[(y(!0),w(M,null,_(e.items,(e=>(y(),w("div",{key:e.id,class:"flex-table-item"},[v(z,{column:{grow:!0},"data-th":"Label"},{default:R((()=>[v(g,null,{default:R((()=>[v(p,null,{default:R((()=>[v(m,{modelValue:e.title,"onUpdate:modelValue":t=>e.title=t,type:"text",placeholder:"Title"},null,8,["modelValue","onUpdate:modelValue"])])),_:2},1024)])),_:2},1024)])),_:2},1024),v(z,null,{default:R((()=>[v(g,null,{default:R((()=>[v(p,null,{default:R((()=>[v(m,{modelValue:e.height,"onUpdate:modelValue":t=>e.height=t,type:"text",placeholder:"height"},null,8,["modelValue","onUpdate:modelValue"])])),_:2},1024)])),_:2},1024)])),_:2},1024),v(z,null,{default:R((()=>[v(g,null,{default:R((()=>[v(p,null,{default:R((()=>[v(m,{modelValue:e.width,"onUpdate:modelValue":t=>e.width=t,type:"text",placeholder:"width"},null,8,["modelValue","onUpdate:modelValue"])])),_:2},1024)])),_:2},1024)])),_:2},1024),v(z,null,{default:R((()=>[v(g,null,{default:R((()=>[v(p,null,{default:R((()=>[v(m,{modelValue:e.unit,"onUpdate:modelValue":t=>e.unit=t,type:"text",placeholder:"unit"},null,8,["modelValue","onUpdate:modelValue"])])),_:2},1024)])),_:2},1024)])),_:2},1024),v(z,null,{default:R((()=>[v(g,null,{default:R((()=>[v(p,null,{default:R((()=>[v(m,{modelValue:e.item_unit_price,"onUpdate:modelValue":t=>e.item_unit_price=t,type:"text",placeholder:"unit"},null,8,["modelValue","onUpdate:modelValue"])])),_:2},1024)])),_:2},1024)])),_:2},1024),v(z,null,{default:R((()=>[v(g,null,{default:R((()=>[v(p,null,{default:R((()=>[v(m,{modelValue:e.item_total_price,"onUpdate:modelValue":t=>e.item_total_price=t,type:"text",placeholder:"total price"},null,8,["modelValue","onUpdate:modelValue"])])),_:2},1024)])),_:2},1024)])),_:2},1024),v(z,null,{default:R((()=>[v(g,null,{default:R((()=>[v(p,null,{default:R((()=>[v(m,{modelValue:e.quantity,"onUpdate:modelValue":t=>e.quantity=t,type:"text",placeholder:"quantity"},null,8,["modelValue","onUpdate:modelValue"])])),_:2},1024)])),_:2},1024)])),_:2},1024),v(z,null,{default:R((()=>[v(g,null,{default:R((()=>[v(p,null,{default:R((()=>[v(m,{modelValue:e.grand_total_price,"onUpdate:modelValue":t=>e.grand_total_price=t,type:"text",placeholder:"quantity"},null,8,["modelValue","onUpdate:modelValue"])])),_:2},1024)])),_:2},1024)])),_:2},1024),v(z,{column:{align:"end"}},{default:R((()=>[v(k,{icon:"lucide:pen",color:"info",class:"cu-pointer"}),v(k,{icon:"lucide:trash",color:"danger",class:"cu-pointer ml-1"})])),_:1})])))),128))])),_:2},1024)])),_:2},1032,["data"])):N("",!0)])])))),128)):N("",!0)])),_:1})])])}}}),ct=H(ht,[["__scopeId","data-v-08daf78f"]]),dt={class:"columns is-multiline"},pt={class:"column is-3"},mt={class:"column is-3"},gt={class:"column is-3"},ft={class:"column is-3"},yt={class:"column is-6"},wt={class:"column is-6"},Et={class:"column is-6"},vt={class:"column is-6"},Rt={class:"column is-6"},St={class:"column is-6"},Tt=h({__name:"JobReport",setup(e){const{spark1:t,spark2:r,spark3:n,spark4:o}=fe(),{revenueOptions:i}=ye(),{lineStatsChartOptions:s}=ue(),{flexRadialChartCircleOptions:a}=he(),{flexRadialChartStripesOptions:l}=ce(),{widgetGaugeGroup1Options:u,widgetGaugeGroup2Options:h,widgetGaugeGroup3Options:c}=de(),{widgetRadialGroup1Options:d,widgetRadialGroup2Options:p,widgetRadialGroup3Options:m}=se();return(e,g)=>{const f=me,S=pe,T=ae,C=le;return y(),w("div",dt,[E("div",pt,[v(f,{straight:""},{default:R((()=>[v(I(ge),{id:"widget-spark1",height:I(t).chart.height,type:I(t).chart.type,series:I(t).series,options:I(t)},null,8,["height","type","series","options"])])),_:1})]),E("div",mt,[v(f,{straight:""},{default:R((()=>[v(I(ge),{id:"widget-spark2",height:I(r).chart.height,type:I(r).chart.type,series:I(r).series,options:I(r)},null,8,["height","type","series","options"])])),_:1})]),E("div",gt,[v(f,{straight:""},{default:R((()=>[v(I(ge),{id:"widget-spark3",height:I(n).chart.height,type:I(n).chart.type,series:I(n).series,options:I(n)},null,8,["height","type","series","options"])])),_:1})]),E("div",ft,[v(f,{straight:""},{default:R((()=>[v(I(ge),{id:"widget-spark4",height:I(o).chart.height,type:I(o).chart.type,series:I(o).series,options:I(o)},null,8,["height","type","series","options"])])),_:1})]),E("div",yt,[v(S,{title:"Revenue","current-label":"This Month","current-value":"$75,648.43","previous-label":"Last Month","previous-value":"$91,512.18",straight:""},{default:R((()=>[v(I(ge),{id:"line-stats-widget-chart",height:I(s).chart.height,type:I(s).chart.type,series:I(s).series,options:I(s)},null,8,["height","type","series","options"])])),_:1})]),E("div",wt,[v(S,{title:"Revenue","current-label":"This Month","current-value":"$75,648.43","previous-label":"Last Month","previous-value":"$91,512.18",straight:""},{default:R((()=>[v(I(ge),{id:"line-stats-area-chart",height:I(i).chart.height,type:I(i).chart.type,series:I(i).series,options:I(i)},null,8,["height","type","series","options"])])),_:1})]),E("div",Et,[v(T,{title:"Sales Revenue",straight:""},{default:R((()=>[v(I(ge),{id:"flex-stat-circle",height:I(a).chart.height,type:I(a).chart.type,series:I(a).series,options:I(a)},null,8,["height","type","series","options"])])),_:1})]),E("div",vt,[v(T,{title:"Sales Revenue",straight:""},{default:R((()=>[v(I(ge),{id:"flex-stat-radial",height:I(l).chart.height,type:I(l).chart.type,series:I(l).series,options:I(l)},null,8,["height","type","series","options"])])),_:1})]),E("div",Rt,[v(C,{title:"Additional Stats",values:["264","1,203","3,078"],labels:["New Deals","Proposals","Closed Deals"]},{chart1:R((()=>[v(I(ge),{id:"group-radial-1",height:I(d).chart.height,type:I(d).chart.type,series:I(d).series,options:I(d)},null,8,["height","type","series","options"])])),chart2:R((()=>[v(I(ge),{id:"group-radial-2",height:I(p).chart.height,type:I(p).chart.type,series:I(p).series,options:I(p)},null,8,["height","type","series","options"])])),chart3:R((()=>[v(I(ge),{id:"group-radial-3",height:I(m).chart.height,type:I(m).chart.type,series:I(m).series,options:I(m)},null,8,["height","type","series","options"])])),_:1})]),E("div",St,[v(C,{title:"Additional Stats",values:["264","1,203","3,078"],labels:["New Deals","Proposals","Closed Deals"],gauge:""},{chart1:R((()=>[v(I(ge),{id:"group-gauge-1",height:I(u).chart.height,type:I(u).chart.type,series:I(u).series,options:I(u)},null,8,["height","type","series","options"])])),chart2:R((()=>[v(I(ge),{id:"group-gauge-2",height:I(h).chart.height,type:I(h).chart.type,series:I(h).series,options:I(h)},null,8,["height","type","series","options"])])),chart3:R((()=>[v(I(ge),{id:"group-gauge-3",height:I(c).chart.height,type:I(c).chart.type,series:I(c).series,options:I(c)},null,8,["height","type","series","options"])])),_:1})])])}}}),Ct=e=>(P("data-v-1f68036b"),e=e(),V(),e),bt={class:"timeline-wrapper"},Nt=Ct((()=>E("div",{class:"timeline-header"},null,-1))),At={class:"timeline-wrapper-inner"},It={class:"timeline-container"},Ot={class:"timeline-item is-unread"},Mt={class:"date"},_t={class:"content-wrap"},xt={class:"content-box"},Lt=Ct((()=>E("div",{class:"status"},null,-1))),Ft={class:"box-text"},Pt={class:"meta-text"},Vt=["innerHTML"],Ht=H(h({__name:"JobActivities",props:{object_id:{},object_type:{}},setup(e){const t=e,r=Z(),n=d([{id:"06b62536-220c-4d54-b437-50f035677d17",action:"UPDATE",timestamp:"2025-02-21T18:09:11.830145Z",actor_info:{id:"0feda007-d8a0-4b96-acb7-d7763614854e",username:"Test &",last_name:"Dev",email:"test@dev.com",role:"admin",avatar:"https://ibex-documents.s3.us-east-2.amazonaws.com/public/static/users_avatars/Screenshot_from_2025-01-17_15-14-32.png"},message:"updated <b>HENNING</b> lead information.",object_id:"1be101da-7a93-43af-b3e3-d1ca908aa2c9",object_type:"lead",actor:"0feda007-d8a0-4b96-acb7-d7763614854e"}]),o={UPDATE:"is-info",RETRIEVE:"is-warning",DELETE:"is-danger",CREATE:"is-primary"};return g((()=>{(async()=>{try{const e=await r.get(`/api/activity-logs/?object_id=${t.object_id}`);n.value=e.data}catch(e){console.log(e)}})()})),(e,t)=>{const r=we;return y(),w("div",bt,[Nt,E("div",At,[E("div",It,[(y(!0),w(M,null,_(I(n),(e=>(y(),w("div",Ot,[E("div",Mt,[E("span",null,T(I(Ee)(e.timestamp).format("ddd, mm yyyy")),1)]),E("div",{class:D(["dot",o[e.action]])},null,2),E("div",_t,[E("div",xt,[Lt,v(r,{picture:e.actor_info?.avatar},null,8,["picture"]),E("div",Ft,[E("div",Pt,[E("p",null,[E("span",null,T(e.actor_info?.username??"N/A")+" "+T(e.actor_info?.last_name??"N/A"),1),E("span",{class:"log-message",innerHTML:e.message},null,8,Vt)]),E("span",null,T(I(Ee)(e.timestamp).format("hh:mm:ss")),1)])])])])])))),256))])])])}}}),[["__scopeId","data-v-1f68036b"]]),Dt={class:"table is-striped is-fullwidth"},Ut=E("thead",null,[E("tr",null,[E("th",{scope:"col"},"Job"),E("th",{scope:"col"},"ID"),E("th",{scope:"col"},"Title"),E("th",{scope:"col"},"Status"),E("th",{scope:"col"},"Total Price"),E("th",{scope:"col"},"Total Tax"),E("th",{scope:"col"},"Amount Paid"),E("th",{scope:"col"},"Balance"),E("th",{scope:"col"},"Deadline"),E("th",{scope:"col"},"Date Paid"),E("th",{scope:"col"},"Files"),E("th",{scope:"col",class:"is-end"},"Actions")])],-1),kt=E("td",null,"Tina",-1),Bt=E("td",null,"Bergmann",-1),Wt=E("td",null,"Sales",-1),Gt=E("td",null,"Tina",-1),jt=E("td",null,"Bergmann",-1),zt=E("td",null,"Sales",-1),$t=E("td",null,"Tina",-1),Yt=E("td",null,"Bergmann",-1),Xt=E("td",null,"Sales",-1),Kt=E("td",null,"Bergmann",-1),qt=E("td",null,"Sales",-1),Qt={class:"is-end"},Zt={class:"is-flex is-justify-content-flex-end"},Jt=E("td",null,"Tina",-1),er=E("td",null,"Bergmann",-1),tr=E("td",null,"Sales",-1),rr=E("td",null,"Tina",-1),nr=E("td",null,"Bergmann",-1),or=E("td",null,"Sales",-1),ir=E("td",null,"Tina",-1),sr=E("td",null,"Bergmann",-1),ar=E("td",null,"Sales",-1),lr=E("td",null,"Bergmann",-1),ur=E("td",null,"Sales",-1),hr={class:"is-end"},cr={class:"is-flex is-justify-content-flex-end"},dr=E("td",null,"Tina",-1),pr=E("td",null,"Bergmann",-1),mr=E("td",null,"Sales",-1),gr=E("td",null,"Tina",-1),fr=E("td",null,"Bergmann",-1),yr=E("td",null,"Sales",-1),wr=E("td",null,"Tina",-1),Er=E("td",null,"Bergmann",-1),vr=E("td",null,"Sales",-1),Rr=E("td",null,"Bergmann",-1),Sr=E("td",null,"Sales",-1),Tr={class:"is-end"},Cr={class:"is-flex is-justify-content-flex-end"},br=E("td",null,"Tina",-1),Nr=E("td",null,"Bergmann",-1),Ar=E("td",null,"Sales",-1),Ir=E("td",null,"Tina",-1),Or=E("td",null,"Bergmann",-1),Mr=E("td",null,"Sales",-1),_r=E("td",null,"Tina",-1),xr=E("td",null,"Bergmann",-1),Lr=E("td",null,"Sales",-1),Fr=E("td",null,"Bergmann",-1),Pr=E("td",null,"Sales",-1),Vr={class:"is-end"},Hr={class:"is-flex is-justify-content-flex-end"},Dr=h({__name:"JobInvoice",props:{activeTab:{default:"active"}},setup(e){const t=e,r=Re;U();const n=d("");return d(t.activeTab),m((()=>{if(n.value){const e=new RegExp(n.value,"i");return r.filter((t=>t.name.match(e)||t.customer.match(e)||t.industry.match(e)||t.status.match(e)||t.duration.match(e)))}return r})),(e,t)=>{const r=ve;return y(),w("table",Dt,[Ut,E("tbody",null,[E("tr",null,[kt,Bt,Wt,Gt,jt,zt,$t,Yt,Xt,Kt,qt,E("td",Qt,[E("div",Zt,[v(r)])])]),E("tr",null,[Jt,er,tr,rr,nr,or,ir,sr,ar,lr,ur,E("td",hr,[E("div",cr,[v(r)])])]),E("tr",null,[dr,pr,mr,gr,fr,yr,wr,Er,vr,Rr,Sr,E("td",Tr,[E("div",Cr,[v(r)])])]),E("tr",null,[br,Nr,Ar,Ir,Or,Mr,_r,xr,Lr,Fr,Pr,E("td",Vr,[E("div",Hr,[v(r)])])])])])}}}),Ur={class:"table is-striped is-fullwidth"},kr=E("thead",null,[E("tr",null,[E("th",{scope:"col"},"First Name"),E("th",{scope:"col"},"Last Name"),E("th",{scope:"col"},"Position"),E("th",{scope:"col",class:"is-end"},[E("div",{class:"dark-inverted is-flex is-justify-content-flex-end"}," Actions ")])])],-1),Br=E("td",null,"Tina",-1),Wr=E("td",null,"Bergmann",-1),Gr=E("td",null,"Head of Sales",-1),jr={class:"is-end"},zr={class:"is-flex is-justify-content-flex-end"},$r=E("td",null,"John",-1),Yr=E("td",null,"Wistmus",-1),Xr=E("td",null,"Senior Executive",-1),Kr={class:"is-end"},qr={class:"is-flex is-justify-content-flex-end"},Qr=E("td",null,"Sam",-1),Zr=E("td",null,"Watson",-1),Jr=E("td",null,"Software Engineer",-1),en={class:"is-end"},tn={class:"is-flex is-justify-content-flex-end"},rn=E("td",null,"Jolaine",-1),nn=E("td",null,"Joestar",-1),on=E("td",null,"HR Manager",-1),sn={class:"is-end"},an={class:"is-flex is-justify-content-flex-end"},ln=E("td",null,"Anders",-1),un=E("td",null,"Jensen",-1),hn=E("td",null,"Accountant",-1),cn={class:"is-end"},dn={class:"is-flex is-justify-content-flex-end"},pn=h({__name:"JobEstimates",props:{activeTab:{default:"active"}},setup(e){const t=e,r=Re;U();const n=d("");return d(t.activeTab),m((()=>{if(n.value){const e=new RegExp(n.value,"i");return r.filter((t=>t.name.match(e)||t.customer.match(e)||t.industry.match(e)||t.status.match(e)||t.duration.match(e)))}return r})),(e,t)=>{const r=ve;return y(),w("table",Ur,[kr,E("tbody",null,[E("tr",null,[Br,Wr,Gr,E("td",jr,[E("div",zr,[v(r)])])]),E("tr",null,[$r,Yr,Xr,E("td",Kr,[E("div",qr,[v(r)])])]),E("tr",null,[Qr,Zr,Jr,E("td",en,[E("div",tn,[v(r)])])]),E("tr",null,[rn,nn,on,E("td",sn,[E("div",an,[v(r)])])]),E("tr",null,[ln,un,hn,E("td",cn,[E("div",dn,[v(r)])])])])])}}}),mn={class:"columns is-multiline"},gn={class:"column is-12"},fn={class:"toolbar"},yn={class:"tabs-inner"},wn={class:"tabs"},En=[E("span",null,"Estimate",-1)],vn=[E("span",null,"Budget",-1)],Rn=[E("span",null,"Owner Invoice",-1)],Sn=E("li",{class:"tab-naver"},null,-1),Tn={key:0,class:"column is-12"},Cn={key:1,class:"column is-12"},bn={key:2,class:"column is-12"},Nn=h({__name:"JobFinance",props:{activeTab:{default:"active"}},setup(e){const t=Re;U();const r=d("estimate"),n=d("");return m((()=>{if(n.value){const e=new RegExp(n.value,"i");return t.filter((t=>t.name.match(e)||t.customer.match(e)||t.industry.match(e)||t.status.match(e)||t.duration.match(e)))}return t})),(e,t)=>{const n=pn,o=Dr;return y(),w("div",mn,[E("div",gn,[E("div",fn,[E("div",yn,[E("div",wn,[E("ul",null,[E("li",{class:D(["estimate"===I(r)&&"is-active"])},[E("a",{tabindex:"0",role:"button",onKeydown:t[0]||(t[0]=k(B((e=>r.value="estimate"),["prevent"]),["space"])),onClick:t[1]||(t[1]=e=>r.value="estimate")},En,32)],2),E("li",{class:D(["budget"===I(r)&&"is-active"])},[E("a",{tabindex:"0",role:"button",onKeydown:t[2]||(t[2]=k(B((e=>r.value="budget"),["prevent"]),["space"])),onClick:t[3]||(t[3]=e=>r.value="budget")},vn,32)],2),E("li",{class:D(["invoice"===I(r)&&"is-active"])},[E("a",{tabindex:"0",role:"button",onKeydown:t[4]||(t[4]=k(B((e=>r.value="invoice"),["prevent"]),["space"])),onClick:t[5]||(t[5]=e=>r.value="invoice")},Rn,32)],2),Sn])])])])]),"estimate"===I(r)?(y(),w("div",Tn,[v(n)])):N("",!0),"budget"===I(r)?(y(),w("div",Cn)):N("",!0),"invoice"===I(r)?(y(),w("div",bn,[v(o)])):N("",!0)])}}}),An={class:"user-grid-toolbar"},In=E("span",{class:"icon"},[E("i",{class:"fas fa-plus"})],-1),On=E("span",null,"Progress",-1),Mn={class:"user-grid user-grid-v1"},_n={class:"columns is-multiline"},xn={class:"grid-item"},Ln={class:"is-flex"},Fn=h({__name:"JobProgressLoader",setup(e){const t=d(""),r=d(0),n=["All","UI/UX Design","Web Development","Software Eng.","Business"];return(e,o)=>{const i=u,s=W("Multiselect"),l=a,h=x,c=F,d=j,p=Ce,m=Te;return y(),w("div",null,[E("div",An,[v(i,{icon:"feather:search"},{default:R((()=>[C(E("input",{"onUpdate:modelValue":o[0]||(o[0]=e=>G(t)?t.value=e:null),class:"input custom-text-filter",placeholder:"Search..."},null,512),[[b,I(t)]])])),_:1}),v(c,null,{default:R((()=>[v(l,{class:"h-hidden-mobile"},{default:R((()=>[v(i,null,{default:R((()=>[v(s,{modelValue:I(r),"onUpdate:modelValue":o[1]||(o[1]=e=>G(r)?r.value=e:null),options:n,"max-height":145,placeholder:"Select an option"},null,8,["modelValue"])])),_:1})])),_:1}),v(h,null,{default:R((()=>[In,On])),_:1})])),_:1})]),E("div",Mn,[E("div",_n,[(y(),w(M,null,_(20,(e=>E("div",{key:e,class:"column is-3"},[E("div",xn,[v(d,{height:"160px",centered:"",class:"mb-2"}),v(p,{class:"mb-5",width:"80%",lines:3,"last-line-width":"60%"}),E("div",Ln,[v(m,{size:"small",class:"mx-1"}),v(p,{class:"mb-4",width:"80%",lines:2,"last-line-width":"60%"})])])]))),64))])])])}}}),Pn={key:1},Vn={class:"card-grid-toolbar"},Hn={class:"buttons"},Dn=E("span",{class:"icon"},[E("i",{"aria-hidden":"true",class:"fas fa-plus"})],-1),Un=E("span",null,"Progress",-1),kn={class:"card-grid card-grid-v4"},Bn=E("img",{class:"light-image",src:q,alt:""},null,-1),Wn=E("img",{class:"dark-image",src:Q,alt:""},null,-1),Gn=["href","title"],jn=["src","alt"],zn={class:"card-grid-item-content"},$n={class:"dark-inverted"},Yn={key:0},Xn=E("summary",null,"Read More",-1),Kn={key:0,class:"card-grid-item-footer"},qn={class:"meta"},Qn={class:"dark-inverted"},Zn=h({__name:"JobProgress",props:{object:{},type:{},taskData:{}},setup(e){const t=e,r=Z(),n=d(""),i=d(!1),s=d(!1),l=d(0),h=["All Posts","Recent Posts","Older Posts","Popular Posts"],c=d([{id:"",uploaded_by_info:{id:"",username:"",last_name:"",email:"",role:"",avatar:""},file_info:{url:"",name:"",type:"",size:0},progress:0,title:"",description:"",created_at:"",file:"",job:"",task:"",uploaded_by:""}]),p=async()=>{try{i.value=!0;const e=await r.get(`/api/job-progress/by-job/${t.object}/`);c.value=e.data}catch(e){console.log(e)}finally{i.value=!1}};m((()=>c.value.map((e=>({src:e.file_info.url,thumbnail:e.file_info.url,w:1200,h:900,alt:e.file_info.name})))));const f=m((()=>{if(n.value){const e=new RegExp(n.value,"i");return console.log(e),c.value.filter((t=>t.title?.match(e)||t.created_at?.match(e)||t.uploaded_by_info?.username?.match(e)||t.uploaded_by_info?.email?.match(e)||t.uploaded_by_info?.last_name?.match(e)))}return c.value}));return g((()=>{"job"===t.type&&p()})),(e,r)=>{const c=Fn,d=u,m=W("Multiselect"),g=a,L=x,F=o,P=we,V=Se;return I(i)?(y(),O(c,{key:0})):(y(),w("div",Pn,[E("div",Vn,[v(d,{icon:"feather:search"},{default:R((()=>[C(E("input",{"onUpdate:modelValue":r[0]||(r[0]=e=>G(n)?n.value=e:null),class:"input custom-text-filter",placeholder:"Search..."},null,512),[[b,I(n)]])])),_:1}),E("div",Hn,[v(g,{class:"h-hidden-mobile"},{default:R((()=>[v(d,null,{default:R((()=>[v(m,{modelValue:I(l),"onUpdate:modelValue":r[1]||(r[1]=e=>G(l)?l.value=e:null),options:h,"max-height":145,placeholder:"Select an option"},null,8,["modelValue"])])),_:1})])),_:1}),v(L,{onClick:r[2]||(r[2]=e=>s.value=!I(s)),color:"primary",raised:""},{default:R((()=>[Dn,Un])),_:1})])]),E("div",kn,[v(F,{class:D([0!==I(f).length&&"is-hidden"]),title:"We couldn't find any matching results.",subtitle:"Too bad. Looks like we couldn't find any matching results for the\n          search terms you've entered. Please try different search terms or\n          criteria.",larger:""},{image:R((()=>[Bn,Wn])),_:1},8,["class"]),v(A,{name:"list",tag:"div",class:"columns is-multiline"},{default:R((()=>[(y(!0),w(M,null,_(I(f),(e=>(y(),w("div",{key:e.id,class:"column is-3"},[E("a",{href:e.file,title:e.title,itemprop:"contentUrl","data-pswp-width":"1200","data-pswp-height":"900",target:"_blank","data-cropped":"true",ref_for:!0,ref:"noreferrer",class:"card-grid-item"},[E("img",{src:e.file,alt:e.title,onErrorOnce:r[3]||(r[3]=e=>I(be)(400,300))},null,40,jn),E("div",zn,[E("h3",$n,T(e.title?e.title:"No Title"),1),E("p",null,[S(T(e.description?e.description.slice(0,34):"No Description")+" ",1),e.description.length>44?(y(),w("details",Yn,[Xn,S(" "+T(e.description?e.description:""),1)])):N("",!0)])]),e.uploaded_by_info?(y(),w("div",Kn,[v(P,{picture:e.uploaded_by_info.avatar,size:"small"},null,8,["picture"]),E("div",qn,[E("span",Qn,T(e.uploaded_by_info.username??"N/A")+" "+T(e.uploaded_by_info.last_name??""),1),E("span",null,T(I(ee)(e.created_at)),1)])])):N("",!0)],8,Gn)])))),128))])),_:1})]),I(s)?(y(),O(V,{key:0,job:t.object,openProgressModal:I(s),"onUpdate:OnSuccess":p,"onClose:ModalHandler":r[4]||(r[4]=e=>s.value=!1)},null,8,["job","openProgressModal"])):N("",!0)]))}}}),Jn={class:"modal-form columns is-multiline"},eo={class:"column is-full"},to={class:"field"},ro=E("label",{class:"label"},"Title ",-1),no={class:"control"},oo={class:"field column is-half"},io={class:"file"},so={class:"file-label"},ao={class:"file-cta"},lo=E("span",{class:"file-icon"},[E("i",{class:"fas fa-cloud-upload-alt"})],-1),uo={class:"file-label"},ho=h({__name:"UploadDocumentModal",props:{openFileModal:{type:Boolean},type:{},object:{}},emits:["close:ModalHandler","update:OnSuccess"],setup(e,{emit:t}){const r=e;d(null);const n=Z(),o=J(),i=d(!1),s=c(),l=()=>{t("close:ModalHandler",!1)},h=d({type:r.type,object:r.object,title:"",uploaded_by:s.user.id,file:null}),p=async()=>{try{i.value=!0;const e=te(h.value,["file"]);await n.post("/api/attachment/",e);re({object_type:"files",object_id:r.object,action:"CREATE",message:`Uploaded new file named <b>${h.value.title}</b>.`,performedOnName:"job"}),o.success("File uploaded successfully!"),t("update:OnSuccess",null),l()}catch(e){console.log(e)}finally{i.value=!1}},m=d(""),f=e=>{const t=e.target,r=t.files?.[0];t.value="",r&&(h.value.file=r,m.value=r.name)};return g((()=>{})),(e,t)=>{const n=u,o=a,s=x,c=Ae;return y(),O(c,{is:"form",open:r.openFileModal,title:"Add Progress",size:"medium",actions:"right",onSubmit:B(p,["prevent"]),onClose:l},{content:R((()=>[E("div",Jn,[E("div",eo,[E("div",to,[ro,E("div",no,[C(E("input",{type:"text",required:"",class:"input",placeholder:"Enter Title","onUpdate:modelValue":t[0]||(t[0]=e=>I(h).title=e)},null,512),[[b,I(h).title]])])])]),E("div",oo,[v(o,{grouped:""},{default:R((()=>[v(n,null,{default:R((()=>[E("div",io,[E("label",so,[E("input",{onChange:f,class:"file-input",type:"file",name:"resume"},null,32),E("span",ao,[lo,E("span",uo,T(I(m)?I(m):"Choose a file…"),1)])])])])),_:1})])),_:1})])])])),action:R((()=>[v(s,{type:"submit",color:"primary",loading:I(i),raised:""},{default:R((()=>[S(" Save")])),_:1},8,["loading"])])),cancel:R((()=>[v(s,{color:"light",onClick:l,raised:""},{default:R((()=>[S("Close ")])),_:1})])),_:1},8,["open","onSubmit"])}}});var co=function(e){return e&&e.Math===Math&&e},po=co("object"==typeof globalThis&&globalThis)||co("object"==typeof window&&window)||co("object"==typeof self&&self)||co("object"==typeof z&&z)||co("object"==typeof z&&z)||function(){return this}()||Function("return this")(),mo={},go=function(e){try{return!!e()}catch(t){return!0}},fo=!go((function(){return 7!==Object.defineProperty({},1,{get:function(){return 7}})[1]})),yo=!go((function(){var e=function(){}.bind();return"function"!=typeof e||e.hasOwnProperty("prototype")})),wo=yo,Eo=Function.prototype.call,vo=wo?Eo.bind(Eo):function(){return Eo.apply(Eo,arguments)},Ro={},So={}.propertyIsEnumerable,To=Object.getOwnPropertyDescriptor,Co=To&&!So.call({1:2},1);Ro.f=Co?function(e){var t=To(this,e);return!!t&&t.enumerable}:So;var bo,No,Ao=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}},Io=yo,Oo=Function.prototype,Mo=Oo.call,_o=Io&&Oo.bind.bind(Mo,Mo),xo=Io?_o:function(e){return function(){return Mo.apply(e,arguments)}},Lo=xo,Fo=Lo({}.toString),Po=Lo("".slice),Vo=function(e){return Po(Fo(e),8,-1)},Ho=go,Do=Vo,Uo=Object,ko=xo("".split),Bo=Ho((function(){return!Uo("z").propertyIsEnumerable(0)}))?function(e){return"String"===Do(e)?ko(e,""):Uo(e)}:Uo,Wo=function(e){return null==e},Go=Wo,jo=TypeError,zo=function(e){if(Go(e))throw new jo("Can't call method on "+e);return e},$o=Bo,Yo=zo,Xo=function(e){return $o(Yo(e))},Ko="object"==typeof document&&document.all,qo=void 0===Ko&&void 0!==Ko?function(e){return"function"==typeof e||e===Ko}:function(e){return"function"==typeof e},Qo=qo,Zo=function(e){return"object"==typeof e?null!==e:Qo(e)},Jo=po,ei=qo,ti=function(e,t){return arguments.length<2?(r=Jo[e],ei(r)?r:void 0):Jo[e]&&Jo[e][t];var r},ri=xo({}.isPrototypeOf),ni=po.navigator,oi=ni&&ni.userAgent,ii=oi?String(oi):"",si=po,ai=ii,li=si.process,ui=si.Deno,hi=li&&li.versions||ui&&ui.version,ci=hi&&hi.v8;ci&&(No=(bo=ci.split("."))[0]>0&&bo[0]<4?1:+(bo[0]+bo[1])),!No&&ai&&(!(bo=ai.match(/Edge\/(\d+)/))||bo[1]>=74)&&(bo=ai.match(/Chrome\/(\d+)/))&&(No=+bo[1]);var di=No,pi=go,mi=po.String,gi=!!Object.getOwnPropertySymbols&&!pi((function(){var e=Symbol("symbol detection");return!mi(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&di&&di<41})),fi=gi&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,yi=ti,wi=qo,Ei=ri,vi=Object,Ri=fi?function(e){return"symbol"==typeof e}:function(e){var t=yi("Symbol");return wi(t)&&Ei(t.prototype,vi(e))},Si=String,Ti=function(e){try{return Si(e)}catch(t){return"Object"}},Ci=qo,bi=Ti,Ni=TypeError,Ai=function(e){if(Ci(e))return e;throw new Ni(bi(e)+" is not a function")},Ii=Ai,Oi=Wo,Mi=function(e,t){var r=e[t];return Oi(r)?void 0:Ii(r)},_i=vo,xi=qo,Li=Zo,Fi=TypeError,Pi={exports:{}},Vi=po,Hi=Object.defineProperty,Di=function(e,t){try{Hi(Vi,e,{value:t,configurable:!0,writable:!0})}catch(r){Vi[e]=t}return t},Ui=po,ki=Di,Bi="__core-js_shared__",Wi=Pi.exports=Ui[Bi]||ki(Bi,{});(Wi.versions||(Wi.versions=[])).push({version:"3.41.0",mode:"global",copyright:"© 2014-2025 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.41.0/LICENSE",source:"https://github.com/zloirock/core-js"});var Gi=Pi.exports,ji=Gi,zi=function(e,t){return ji[e]||(ji[e]=t||{})},$i=zo,Yi=Object,Xi=function(e){return Yi($i(e))},Ki=Xi,qi=xo({}.hasOwnProperty),Qi=Object.hasOwn||function(e,t){return qi(Ki(e),t)},Zi=xo,Ji=0,es=Math.random(),ts=Zi(1..toString),rs=function(e){return"Symbol("+(void 0===e?"":e)+")_"+ts(++Ji+es,36)},ns=zi,os=Qi,is=rs,ss=gi,as=fi,ls=po.Symbol,us=ns("wks"),hs=as?ls.for||ls:ls&&ls.withoutSetter||is,cs=function(e){return os(us,e)||(us[e]=ss&&os(ls,e)?ls[e]:hs("Symbol."+e)),us[e]},ds=vo,ps=Zo,ms=Ri,gs=Mi,fs=function(e,t){var r,n;if("string"===t&&xi(r=e.toString)&&!Li(n=_i(r,e)))return n;if(xi(r=e.valueOf)&&!Li(n=_i(r,e)))return n;if("string"!==t&&xi(r=e.toString)&&!Li(n=_i(r,e)))return n;throw new Fi("Can't convert object to primitive value")},ys=TypeError,ws=cs("toPrimitive"),Es=function(e,t){if(!ps(e)||ms(e))return e;var r,n=gs(e,ws);if(n){if(void 0===t&&(t="default"),r=ds(n,e,t),!ps(r)||ms(r))return r;throw new ys("Can't convert object to primitive value")}return void 0===t&&(t="number"),fs(e,t)},vs=Ri,Rs=function(e){var t=Es(e,"string");return vs(t)?t:t+""},Ss=Zo,Ts=po.document,Cs=Ss(Ts)&&Ss(Ts.createElement),bs=function(e){return Cs?Ts.createElement(e):{}},Ns=bs,As=!fo&&!go((function(){return 7!==Object.defineProperty(Ns("div"),"a",{get:function(){return 7}}).a})),Is=fo,Os=vo,Ms=Ro,_s=Ao,xs=Xo,Ls=Rs,Fs=Qi,Ps=As,Vs=Object.getOwnPropertyDescriptor;mo.f=Is?Vs:function(e,t){if(e=xs(e),t=Ls(t),Ps)try{return Vs(e,t)}catch(r){}if(Fs(e,t))return _s(!Os(Ms.f,e,t),e[t])};var Hs={},Ds=fo&&go((function(){return 42!==Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype})),Us=Zo,ks=String,Bs=TypeError,Ws=function(e){if(Us(e))return e;throw new Bs(ks(e)+" is not an object")},Gs=fo,js=As,zs=Ds,$s=Ws,Ys=Rs,Xs=TypeError,Ks=Object.defineProperty,qs=Object.getOwnPropertyDescriptor,Qs="enumerable",Zs="configurable",Js="writable";Hs.f=Gs?zs?function(e,t,r){if($s(e),t=Ys(t),$s(r),"function"==typeof e&&"prototype"===t&&"value"in r&&Js in r&&!r[Js]){var n=qs(e,t);n&&n[Js]&&(e[t]=r.value,r={configurable:Zs in r?r[Zs]:n[Zs],enumerable:Qs in r?r[Qs]:n[Qs],writable:!1})}return Ks(e,t,r)}:Ks:function(e,t,r){if($s(e),t=Ys(t),$s(r),js)try{return Ks(e,t,r)}catch(n){}if("get"in r||"set"in r)throw new Xs("Accessors not supported");return"value"in r&&(e[t]=r.value),e};var ea=Hs,ta=Ao,ra=fo?function(e,t,r){return ea.f(e,t,ta(1,r))}:function(e,t,r){return e[t]=r,e},na={exports:{}},oa=fo,ia=Qi,sa=Function.prototype,aa=oa&&Object.getOwnPropertyDescriptor,la=ia(sa,"name"),ua={EXISTS:la,PROPER:la&&"something"===function(){}.name,CONFIGURABLE:la&&(!oa||oa&&aa(sa,"name").configurable)},ha=qo,ca=Gi,da=xo(Function.toString);ha(ca.inspectSource)||(ca.inspectSource=function(e){return da(e)});var pa,ma,ga,fa=ca.inspectSource,ya=qo,wa=po.WeakMap,Ea=ya(wa)&&/native code/.test(String(wa)),va=rs,Ra=zi("keys"),Sa=function(e){return Ra[e]||(Ra[e]=va(e))},Ta={},Ca=Ea,ba=po,Na=Zo,Aa=ra,Ia=Qi,Oa=Gi,Ma=Sa,_a=Ta,xa="Object already initialized",La=ba.TypeError,Fa=ba.WeakMap;if(Ca||Oa.state){var Pa=Oa.state||(Oa.state=new Fa);Pa.get=Pa.get,Pa.has=Pa.has,Pa.set=Pa.set,pa=function(e,t){if(Pa.has(e))throw new La(xa);return t.facade=e,Pa.set(e,t),t},ma=function(e){return Pa.get(e)||{}},ga=function(e){return Pa.has(e)}}else{var Va=Ma("state");_a[Va]=!0,pa=function(e,t){if(Ia(e,Va))throw new La(xa);return t.facade=e,Aa(e,Va,t),t},ma=function(e){return Ia(e,Va)?e[Va]:{}},ga=function(e){return Ia(e,Va)}}var Ha={set:pa,get:ma,has:ga,enforce:function(e){return ga(e)?ma(e):pa(e,{})},getterFor:function(e){return function(t){var r;if(!Na(t)||(r=ma(t)).type!==e)throw new La("Incompatible receiver, "+e+" required");return r}}},Da=xo,Ua=go,ka=qo,Ba=Qi,Wa=fo,Ga=ua.CONFIGURABLE,ja=fa,za=Ha.enforce,$a=Ha.get,Ya=String,Xa=Object.defineProperty,Ka=Da("".slice),qa=Da("".replace),Qa=Da([].join),Za=Wa&&!Ua((function(){return 8!==Xa((function(){}),"length",{value:8}).length})),Ja=String(String).split("String"),el=na.exports=function(e,t,r){"Symbol("===Ka(Ya(t),0,7)&&(t="["+qa(Ya(t),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),r&&r.getter&&(t="get "+t),r&&r.setter&&(t="set "+t),(!Ba(e,"name")||Ga&&e.name!==t)&&(Wa?Xa(e,"name",{value:t,configurable:!0}):e.name=t),Za&&r&&Ba(r,"arity")&&e.length!==r.arity&&Xa(e,"length",{value:r.arity});try{r&&Ba(r,"constructor")&&r.constructor?Wa&&Xa(e,"prototype",{writable:!1}):e.prototype&&(e.prototype=void 0)}catch(o){}var n=za(e);return Ba(n,"source")||(n.source=Qa(Ja,"string"==typeof t?t:"")),e};Function.prototype.toString=el((function(){return ka(this)&&$a(this).source||ja(this)}),"toString");var tl=na.exports,rl=qo,nl=Hs,ol=tl,il=Di,sl=function(e,t,r,n){n||(n={});var o=n.enumerable,i=void 0!==n.name?n.name:t;if(rl(r)&&ol(r,i,n),n.global)o?e[t]=r:il(t,r);else{try{n.unsafe?e[t]&&(o=!0):delete e[t]}catch(s){}o?e[t]=r:nl.f(e,t,{value:r,enumerable:!1,configurable:!n.nonConfigurable,writable:!n.nonWritable})}return e},al={},ll=Math.ceil,ul=Math.floor,hl=Math.trunc||function(e){var t=+e;return(t>0?ul:ll)(t)},cl=function(e){var t=+e;return t!=t||0===t?0:hl(t)},dl=cl,pl=Math.max,ml=Math.min,gl=cl,fl=Math.min,yl=function(e){var t=gl(e);return t>0?fl(t,9007199254740991):0},wl=function(e){return yl(e.length)},El=Xo,vl=function(e,t){var r=dl(e);return r<0?pl(r+t,0):ml(r,t)},Rl=wl,Sl=function(e){return function(t,r,n){var o=El(t),i=Rl(o);if(0===i)return!e&&-1;var s,a=vl(n,i);if(e&&r!=r){for(;i>a;)if((s=o[a++])!=s)return!0}else for(;i>a;a++)if((e||a in o)&&o[a]===r)return e||a||0;return!e&&-1}},Tl={includes:Sl(!0),indexOf:Sl(!1)},Cl=Qi,bl=Xo,Nl=Tl.indexOf,Al=Ta,Il=xo([].push),Ol=function(e,t){var r,n=bl(e),o=0,i=[];for(r in n)!Cl(Al,r)&&Cl(n,r)&&Il(i,r);for(;t.length>o;)Cl(n,r=t[o++])&&(~Nl(i,r)||Il(i,r));return i},Ml=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],_l=Ol,xl=Ml.concat("length","prototype");al.f=Object.getOwnPropertyNames||function(e){return _l(e,xl)};var Ll={};Ll.f=Object.getOwnPropertySymbols;var Fl=ti,Pl=al,Vl=Ll,Hl=Ws,Dl=xo([].concat),Ul=Fl("Reflect","ownKeys")||function(e){var t=Pl.f(Hl(e)),r=Vl.f;return r?Dl(t,r(e)):t},kl=Qi,Bl=Ul,Wl=mo,Gl=Hs,jl=function(e,t,r){for(var n=Bl(t),o=Gl.f,i=Wl.f,s=0;s<n.length;s++){var a=n[s];kl(e,a)||r&&kl(r,a)||o(e,a,i(t,a))}},zl=go,$l=qo,Yl=/#|\.prototype\./,Xl=function(e,t){var r=ql[Kl(e)];return r===Zl||r!==Ql&&($l(t)?zl(t):!!t)},Kl=Xl.normalize=function(e){return String(e).replace(Yl,".").toLowerCase()},ql=Xl.data={},Ql=Xl.NATIVE="N",Zl=Xl.POLYFILL="P",Jl=Xl,eu=po,tu=mo.f,ru=ra,nu=sl,ou=Di,iu=jl,su=Jl,au=function(e,t){var r,n,o,i,s,a=e.target,l=e.global,u=e.stat;if(r=l?eu:u?eu[a]||ou(a,{}):eu[a]&&eu[a].prototype)for(n in t){if(i=t[n],o=e.dontCallGetSet?(s=tu(r,n))&&s.value:r[n],!su(l?n:a+(u?".":"#")+n,e.forced)&&void 0!==o){if(typeof i==typeof o)continue;iu(i,o)}(e.sham||o&&o.sham)&&ru(i,"sham",!0),nu(r,n,i,e)}},lu=yo,uu=Function.prototype,hu=uu.apply,cu=uu.call,du="object"==typeof Reflect&&Reflect.apply||(lu?cu.bind(hu):function(){return cu.apply(hu,arguments)}),pu=xo,mu=Ai,gu=function(e,t,r){try{return pu(mu(Object.getOwnPropertyDescriptor(e,t)[r]))}catch(n){}},fu=Zo,yu=function(e){return fu(e)||null===e},wu=String,Eu=TypeError,vu=gu,Ru=Zo,Su=zo,Tu=function(e){if(yu(e))return e;throw new Eu("Can't set "+wu(e)+" as a prototype")},Cu=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,r={};try{(e=vu(Object.prototype,"__proto__","set"))(r,[]),t=r instanceof Array}catch(n){}return function(r,n){return Su(r),Tu(n),Ru(r)?(t?e(r,n):r.__proto__=n,r):r}}():void 0),bu=Hs.f,Nu=qo,Au=Zo,Iu=Cu,Ou={};Ou[cs("toStringTag")]="z";var Mu="[object z]"===String(Ou),_u=qo,xu=Vo,Lu=cs("toStringTag"),Fu=Object,Pu="Arguments"===xu(function(){return arguments}()),Vu=Mu?xu:function(e){var t,r,n;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(r=function(e,t){try{return e[t]}catch(r){}}(t=Fu(e),Lu))?r:Pu?xu(t):"Object"===(n=xu(t))&&_u(t.callee)?"Arguments":n},Hu=Vu,Du=String,Uu=function(e){if("Symbol"===Hu(e))throw new TypeError("Cannot convert a Symbol value to a string");return Du(e)},ku=Uu,Bu=Zo,Wu=ra,Gu=Error,ju=xo("".replace),zu=String(new Gu("zxcasd").stack),$u=/\n\s*at [^:]*:[^\n]*/,Yu=$u.test(zu),Xu=Ao,Ku=!go((function(){var e=new Error("a");return!("stack"in e)||(Object.defineProperty(e,"stack",Xu(1,7)),7!==e.stack)})),qu=ra,Qu=function(e,t){if(Yu&&"string"==typeof e&&!Gu.prepareStackTrace)for(;t--;)e=ju(e,$u,"");return e},Zu=Ku,Ju=Error.captureStackTrace,eh=ti,th=Qi,rh=ra,nh=ri,oh=Cu,ih=jl,sh=function(e,t,r){r in e||bu(e,r,{configurable:!0,get:function(){return t[r]},set:function(e){t[r]=e}})},ah=function(e,t,r){var n,o;return Iu&&Nu(n=t.constructor)&&n!==r&&Au(o=n.prototype)&&o!==r.prototype&&Iu(e,o),e},lh=function(e,t){return void 0===e?arguments.length<2?"":t:ku(e)},uh=function(e,t){Bu(t)&&"cause"in t&&Wu(e,"cause",t.cause)},hh=function(e,t,r,n){Zu&&(Ju?Ju(e,t):qu(e,"stack",Qu(r,n)))},ch=fo,dh=au,ph=du,mh=function(e,t,r,n){var o="stackTraceLimit",i=n?2:1,s=e.split("."),a=s[s.length-1],l=eh.apply(null,s);if(l){var u=l.prototype;if(th(u,"cause")&&delete u.cause,!r)return l;var h=eh("Error"),c=t((function(e,t){var r=lh(n?t:e,void 0),o=n?new l(e):new l;return void 0!==r&&rh(o,"message",r),hh(o,c,o.stack,2),this&&nh(u,this)&&ah(o,this,c),arguments.length>i&&uh(o,arguments[i]),o}));c.prototype=u,"Error"!==a?oh?oh(c,h):ih(c,h,{name:!0}):ch&&o in l&&(sh(c,l,o),sh(c,l,"prepareStackTrace")),ih(c,l);try{u.name!==a&&rh(u,"name",a),u.constructor=c}catch(d){}return c}},gh="WebAssembly",fh=po[gh],yh=7!==new Error("e",{cause:7}).cause,wh=function(e,t){var r={};r[e]=mh(e,t,yh),dh({global:!0,constructor:!0,arity:1,forced:yh},r)},Eh=function(e,t){if(fh&&fh[e]){var r={};r[e]=mh(gh+"."+e,t,yh),dh({target:gh,stat:!0,constructor:!0,arity:1,forced:yh},r)}};wh("Error",(function(e){return function(t){return ph(e,this,arguments)}})),wh("EvalError",(function(e){return function(t){return ph(e,this,arguments)}})),wh("RangeError",(function(e){return function(t){return ph(e,this,arguments)}})),wh("ReferenceError",(function(e){return function(t){return ph(e,this,arguments)}})),wh("SyntaxError",(function(e){return function(t){return ph(e,this,arguments)}})),wh("TypeError",(function(e){return function(t){return ph(e,this,arguments)}})),wh("URIError",(function(e){return function(t){return ph(e,this,arguments)}})),Eh("CompileError",(function(e){return function(t){return ph(e,this,arguments)}})),Eh("LinkError",(function(e){return function(t){return ph(e,this,arguments)}})),Eh("RuntimeError",(function(e){return function(t){return ph(e,this,arguments)}}));var vh=Vo,Rh=Array.isArray||function(e){return"Array"===vh(e)},Sh=fo,Th=Rh,Ch=TypeError,bh=Object.getOwnPropertyDescriptor,Nh=Sh&&!function(){if(void 0!==this)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(e){return e instanceof TypeError}}(),Ah=Nh?function(e,t){if(Th(e)&&!bh(e,"length").writable)throw new Ch("Cannot set read only .length");return e.length=t}:function(e,t){return e.length=t},Ih=TypeError,Oh=function(e){if(e>9007199254740991)throw Ih("Maximum allowed index exceeded");return e},Mh=au,_h=Xi,xh=wl,Lh=Ah,Fh=Oh,Ph=go((function(){return 4294967297!==[].push.call({length:4294967296},1)}))||!function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(e){return e instanceof TypeError}}();Mh({target:"Array",proto:!0,arity:1,forced:Ph},{push:function(e){var t=_h(this),r=xh(t),n=arguments.length;Fh(r+n);for(var o=0;o<n;o++)t[r]=arguments[o],r++;return Lh(t,r),r}});var Vh=xo,Hh=Set.prototype,Dh={Set:Set,add:Vh(Hh.add),has:Vh(Hh.has),remove:Vh(Hh.delete),proto:Hh},Uh=Dh.has,kh=function(e){return Uh(e),e},Bh=vo,Wh=function(e,t,r){for(var n,o,i=r?e:e.iterator,s=e.next;!(n=Bh(s,i)).done;)if(void 0!==(o=t(n.value)))return o},Gh=xo,jh=Wh,zh=Dh.Set,$h=Dh.proto,Yh=Gh($h.forEach),Xh=Gh($h.keys),Kh=Xh(new zh).next,qh=function(e,t,r){return r?jh({iterator:Xh(e),next:Kh},t):Yh(e,t)},Qh=qh,Zh=Dh.Set,Jh=Dh.add,ec=function(e){var t=new Zh;return Qh(e,(function(e){Jh(t,e)})),t},tc=gu(Dh.proto,"size","get")||function(e){return e.size},rc=function(e){return{iterator:e,next:e.next,done:!1}},nc=Ai,oc=Ws,ic=vo,sc=cl,ac=rc,lc="Invalid size",uc=RangeError,hc=TypeError,cc=Math.max,dc=function(e,t){this.set=e,this.size=cc(t,0),this.has=nc(e.has),this.keys=nc(e.keys)};dc.prototype={getIterator:function(){return ac(oc(ic(this.keys,this.set)))},includes:function(e){return ic(this.has,this.set,e)}};var pc=function(e){oc(e);var t=+e.size;if(t!=t)throw new hc(lc);var r=sc(t);if(r<0)throw new uc(lc);return new dc(e,r)},mc=kh,gc=ec,fc=tc,yc=pc,wc=qh,Ec=Wh,vc=Dh.has,Rc=Dh.remove,Sc=ti,Tc=function(e){return{size:e,has:function(){return!1},keys:function(){return{next:function(){return{done:!0}}}}}},Cc=function(e){return{size:e,has:function(){return!0},keys:function(){throw new Error("e")}}},bc=function(e,t){var r=Sc("Set");try{(new r)[e](Tc(0));try{return(new r)[e](Tc(-1)),!1}catch(o){if(!t)return!0;try{return(new r)[e](Cc(-1/0)),!1}catch(i){var n=new r;return n.add(1),n.add(2),t(n[e](Cc(1/0)))}}}catch(i){return!1}},Nc=function(e){var t=mc(this),r=yc(e),n=gc(t);return fc(t)<=r.size?wc(t,(function(e){r.includes(e)&&Rc(n,e)})):Ec(r.getIterator(),(function(e){vc(t,e)&&Rc(n,e)})),n};au({target:"Set",proto:!0,real:!0,forced:!bc("difference",(function(e){return 0===e.size}))},{difference:Nc});var Ac=kh,Ic=tc,Oc=pc,Mc=qh,_c=Wh,xc=Dh.Set,Lc=Dh.add,Fc=Dh.has,Pc=go,Vc=function(e){var t=Ac(this),r=Oc(e),n=new xc;return Ic(t)>r.size?_c(r.getIterator(),(function(e){Fc(t,e)&&Lc(n,e)})):Mc(t,(function(e){r.includes(e)&&Lc(n,e)})),n};au({target:"Set",proto:!0,real:!0,forced:!bc("intersection",(function(e){return 2===e.size&&e.has(1)&&e.has(2)}))||Pc((function(){return"3,2"!==String(Array.from(new Set([1,2,3]).intersection(new Set([3,2]))))}))},{intersection:Vc});var Hc=vo,Dc=Ws,Uc=Mi,kc=function(e,t,r){var n,o;Dc(e);try{if(!(n=Uc(e,"return"))){if("throw"===t)throw r;return r}n=Hc(n,e)}catch(i){o=!0,n=i}if("throw"===t)throw r;if(o)throw n;return Dc(n),r},Bc=kh,Wc=Dh.has,Gc=tc,jc=pc,zc=qh,$c=Wh,Yc=kc,Xc=function(e){var t=Bc(this),r=jc(e);if(Gc(t)<=r.size)return!1!==zc(t,(function(e){if(r.includes(e))return!1}),!0);var n=r.getIterator();return!1!==$c(n,(function(e){if(Wc(t,e))return Yc(n,"normal",!1)}))};au({target:"Set",proto:!0,real:!0,forced:!bc("isDisjointFrom",(function(e){return!e}))},{isDisjointFrom:Xc});var Kc=kh,qc=tc,Qc=qh,Zc=pc,Jc=function(e){var t=Kc(this),r=Zc(e);return!(qc(t)>r.size)&&!1!==Qc(t,(function(e){if(!r.includes(e))return!1}),!0)};au({target:"Set",proto:!0,real:!0,forced:!bc("isSubsetOf",(function(e){return e}))},{isSubsetOf:Jc});var ed=kh,td=Dh.has,rd=tc,nd=pc,od=Wh,id=kc,sd=function(e){var t=ed(this),r=nd(e);if(rd(t)<r.size)return!1;var n=r.getIterator();return!1!==od(n,(function(e){if(!td(t,e))return id(n,"normal",!1)}))};au({target:"Set",proto:!0,real:!0,forced:!bc("isSupersetOf",(function(e){return!e}))},{isSupersetOf:sd});var ad=kh,ld=ec,ud=pc,hd=Wh,cd=Dh.add,dd=Dh.has,pd=Dh.remove,md=function(e){var t=ad(this),r=ud(e).getIterator(),n=ld(t);return hd(r,(function(e){dd(t,e)?pd(n,e):cd(n,e)})),n};au({target:"Set",proto:!0,real:!0,forced:!bc("symmetricDifference")},{symmetricDifference:md});var gd=kh,fd=Dh.add,yd=ec,wd=pc,Ed=Wh,vd=function(e){var t=gd(this),r=wd(e).getIterator(),n=yd(t);return Ed(r,(function(e){fd(n,e)})),n};au({target:"Set",proto:!0,real:!0,forced:!bc("union")},{union:vd});var Rd=ri,Sd=TypeError,Td=!go((function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype})),Cd=Qi,bd=qo,Nd=Xi,Ad=Td,Id=Sa("IE_PROTO"),Od=Object,Md=Od.prototype,_d=Ad?Od.getPrototypeOf:function(e){var t=Nd(e);if(Cd(t,Id))return t[Id];var r=t.constructor;return bd(r)&&t instanceof r?r.prototype:t instanceof Od?Md:null},xd=tl,Ld=Hs,Fd=fo,Pd=Hs,Vd=Ao,Hd={},Dd=Ol,Ud=Ml,kd=Object.keys||function(e){return Dd(e,Ud)},Bd=fo,Wd=Ds,Gd=Hs,jd=Ws,zd=Xo,$d=kd;Hd.f=Bd&&!Wd?Object.defineProperties:function(e,t){jd(e);for(var r,n=zd(t),o=$d(t),i=o.length,s=0;i>s;)Gd.f(e,r=o[s++],n[r]);return e};var Yd,Xd=ti("document","documentElement"),Kd=Ws,qd=Hd,Qd=Ml,Zd=Ta,Jd=Xd,ep=bs,tp="prototype",rp="script",np=Sa("IE_PROTO"),op=function(){},ip=function(e){return"<"+rp+">"+e+"</"+rp+">"},sp=function(e){e.write(ip("")),e.close();var t=e.parentWindow.Object;return e=null,t},ap=function(){try{Yd=new ActiveXObject("htmlfile")}catch(o){}var e,t,r;ap="undefined"!=typeof document?document.domain&&Yd?sp(Yd):(t=ep("iframe"),r="java"+rp+":",t.style.display="none",Jd.appendChild(t),t.src=String(r),(e=t.contentWindow.document).open(),e.write(ip("document.F=Object")),e.close(),e.F):sp(Yd);for(var n=Qd.length;n--;)delete ap[tp][Qd[n]];return ap()};Zd[np]=!0;var lp,up,hp,cp=Object.create||function(e,t){var r;return null!==e?(op[tp]=Kd(e),r=new op,op[tp]=null,r[np]=e):r=ap(),void 0===t?r:qd.f(r,t)},dp=go,pp=qo,mp=Zo,gp=_d,fp=sl,yp=cs("iterator"),wp=!1;[].keys&&("next"in(hp=[].keys())?(up=gp(gp(hp)))!==Object.prototype&&(lp=up):wp=!0);var Ep=!mp(lp)||dp((function(){var e={};return lp[yp].call(e)!==e}));Ep&&(lp={}),pp(lp[yp])||fp(lp,yp,(function(){return this}));var vp={IteratorPrototype:lp,BUGGY_SAFARI_ITERATORS:wp},Rp=au,Sp=po,Tp=function(e,t){if(Rd(t,e))return e;throw new Sd("Incorrect invocation")},Cp=Ws,bp=qo,Np=_d,Ap=function(e,t,r){return r.get&&xd(r.get,t,{getter:!0}),r.set&&xd(r.set,t,{setter:!0}),Ld.f(e,t,r)},Ip=function(e,t,r){Fd?Pd.f(e,t,Vd(0,r)):e[t]=r},Op=go,Mp=Qi,_p=vp.IteratorPrototype,xp=fo,Lp="constructor",Fp="Iterator",Pp=cs("toStringTag"),Vp=TypeError,Hp=Sp[Fp],Dp=!bp(Hp)||Hp.prototype!==_p||!Op((function(){Hp({})})),Up=function(){if(Tp(this,_p),Np(this)===_p)throw new Vp("Abstract class Iterator not directly constructable")},kp=function(e,t){xp?Ap(_p,e,{configurable:!0,get:function(){return t},set:function(t){if(Cp(this),this===_p)throw new Vp("You can't redefine this property");Mp(this,e)?this[e]=t:Ip(this,e,t)}}):_p[e]=t};Mp(_p,Pp)||kp(Pp,Fp),!Dp&&Mp(_p,Lp)&&_p[Lp]!==Object||kp(Lp,Up),Up.prototype=_p,Rp({global:!0,constructor:!0,forced:Dp},{Iterator:Up});var Bp=sl,Wp=vo,Gp=cp,jp=ra,zp=function(e,t,r){for(var n in t)Bp(e,n,t[n],r);return e},$p=Ha,Yp=Mi,Xp=vp.IteratorPrototype,Kp=function(e,t){return{value:e,done:t}},qp=kc,Qp=cs("toStringTag"),Zp="IteratorHelper",Jp="WrapForValidIterator",em=$p.set,tm=function(e){var t=$p.getterFor(e?Jp:Zp);return zp(Gp(Xp),{next:function(){var r=t(this);if(e)return r.nextHandler();if(r.done)return Kp(void 0,!0);try{var n=r.nextHandler();return r.returnHandlerResult?n:Kp(n,r.done)}catch(o){throw r.done=!0,o}},return:function(){var r=t(this),n=r.iterator;if(r.done=!0,e){var o=Yp(n,"return");return o?Wp(o,n):Kp(void 0,!0)}if(r.inner)try{qp(r.inner.iterator,"normal")}catch(i){return qp(n,"throw",i)}return n&&qp(n,"normal"),Kp(void 0,!0)}})},rm=tm(!0),nm=tm(!1);jp(nm,Qp,"Iterator Helper");var om=function(e,t,r){var n=function(n,o){o?(o.iterator=n.iterator,o.next=n.next):o=n,o.type=t?Jp:Zp,o.returnHandlerResult=!!r,o.nextHandler=e,o.counter=0,o.done=!1,em(this,o)};return n.prototype=t?rm:nm,n},im=Ws,sm=kc,am=function(e,t,r,n){try{return n?t(im(r)[0],r[1]):t(r)}catch(o){sm(e,"throw",o)}},lm=au,um=vo,hm=Ai,cm=Ws,dm=rc,pm=am,mm=om((function(){for(var e,t,r=this.iterator,n=this.predicate,o=this.next;;){if(e=cm(um(o,r)),this.done=!!e.done)return;if(t=e.value,pm(r,n,[t,this.counter++],!0))return t}}));lm({target:"Iterator",proto:!0,real:!0,forced:false},{filter:function(e){return cm(this),hm(e),new mm(dm(this),{predicate:e})}});var gm=Vo,fm=xo,ym=function(e){if("Function"===gm(e))return fm(e)},wm=Ai,Em=yo,vm=ym(ym.bind),Rm=function(e,t){return wm(e),void 0===t?e:Em?vm(e,t):function(){return e.apply(t,arguments)}},Sm={},Tm=Sm,Cm=cs("iterator"),bm=Array.prototype,Nm=Vu,Am=Mi,Im=Wo,Om=Sm,Mm=cs("iterator"),_m=function(e){if(!Im(e))return Am(e,Mm)||Am(e,"@@iterator")||Om[Nm(e)]},xm=vo,Lm=Ai,Fm=Ws,Pm=Ti,Vm=_m,Hm=TypeError,Dm=Rm,Um=vo,km=Ws,Bm=Ti,Wm=function(e){return void 0!==e&&(Tm.Array===e||bm[Cm]===e)},Gm=wl,jm=ri,zm=function(e,t){var r=arguments.length<2?Vm(e):t;if(Lm(r))return Fm(xm(r,e));throw new Hm(Pm(e)+" is not iterable")},$m=_m,Ym=kc,Xm=TypeError,Km=function(e,t){this.stopped=e,this.result=t},qm=Km.prototype,Qm=function(e,t,r){var n,o,i,s,a,l,u,h=r&&r.that,c=!(!r||!r.AS_ENTRIES),d=!(!r||!r.IS_RECORD),p=!(!r||!r.IS_ITERATOR),m=!(!r||!r.INTERRUPTED),g=Dm(t,h),f=function(e){return n&&Ym(n,"normal",e),new Km(!0,e)},y=function(e){return c?(km(e),m?g(e[0],e[1],f):g(e[0],e[1])):m?g(e,f):g(e)};if(d)n=e.iterator;else if(p)n=e;else{if(!(o=$m(e)))throw new Xm(Bm(e)+" is not iterable");if(Wm(o)){for(i=0,s=Gm(e);s>i;i++)if((a=y(e[i]))&&jm(qm,a))return a;return new Km(!1)}n=zm(e,o)}for(l=d?e.next:n.next;!(u=Um(l,n)).done;){try{a=y(u.value)}catch(w){Ym(n,"throw",w)}if("object"==typeof a&&a&&jm(qm,a))return a}return new Km(!1)},Zm=Qm,Jm=Ai,eg=Ws,tg=rc;au({target:"Iterator",proto:!0,real:!0},{forEach:function(e){eg(this),Jm(e);var t=tg(this),r=0;Zm(t,(function(t){e(t,r++)}),{IS_RECORD:!0})}});var rg=vo,ng=Ai,og=Ws,ig=rc,sg=am,ag=om((function(){var e=this.iterator,t=og(rg(this.next,e));if(!(this.done=!!t.done))return sg(e,this.mapper,[t.value,this.counter++],!0)}));au({target:"Iterator",proto:!0,real:!0,forced:false},{map:function(e){return og(this),ng(e),new ag(ig(this),{mapper:e})}});var lg,ug,hg,cg,dg=xo([].slice),pg=TypeError,mg=function(e,t){if(e<t)throw new pg("Not enough arguments");return e},gg=/(?:ipad|iphone|ipod).*applewebkit/i.test(ii),fg=po,yg=ii,wg=Vo,Eg=function(e){return yg.slice(0,e.length)===e},vg=Eg("Bun/")?"BUN":Eg("Cloudflare-Workers")?"CLOUDFLARE":Eg("Deno/")?"DENO":Eg("Node.js/")?"NODE":fg.Bun&&"string"==typeof Bun.version?"BUN":fg.Deno&&"object"==typeof Deno.version?"DENO":"process"===wg(fg.process)?"NODE":fg.window&&fg.document?"BROWSER":"REST",Rg=po,Sg=du,Tg=Rm,Cg=qo,bg=Qi,Ng=go,Ag=Xd,Ig=dg,Og=bs,Mg=mg,_g=gg,xg="NODE"===vg,Lg=Rg.setImmediate,Fg=Rg.clearImmediate,Pg=Rg.process,Vg=Rg.Dispatch,Hg=Rg.Function,Dg=Rg.MessageChannel,Ug=Rg.String,kg=0,Bg={},Wg="onreadystatechange";Ng((function(){lg=Rg.location}));var Gg=function(e){if(bg(Bg,e)){var t=Bg[e];delete Bg[e],t()}},jg=function(e){return function(){Gg(e)}},zg=function(e){Gg(e.data)},$g=function(e){Rg.postMessage(Ug(e),lg.protocol+"//"+lg.host)};Lg&&Fg||(Lg=function(e){Mg(arguments.length,1);var t=Cg(e)?e:Hg(e),r=Ig(arguments,1);return Bg[++kg]=function(){Sg(t,void 0,r)},ug(kg),kg},Fg=function(e){delete Bg[e]},xg?ug=function(e){Pg.nextTick(jg(e))}:Vg&&Vg.now?ug=function(e){Vg.now(jg(e))}:Dg&&!_g?(cg=(hg=new Dg).port2,hg.port1.onmessage=zg,ug=Tg(cg.postMessage,cg)):Rg.addEventListener&&Cg(Rg.postMessage)&&!Rg.importScripts&&lg&&"file:"!==lg.protocol&&!Ng($g)?(ug=$g,Rg.addEventListener("message",zg,!1)):ug=Wg in Og("script")?function(e){Ag.appendChild(Og("script"))[Wg]=function(){Ag.removeChild(this),Gg(e)}}:function(e){setTimeout(jg(e),0)});var Yg={set:Lg,clear:Fg},Xg=Yg.clear;au({global:!0,bind:!0,enumerable:!0,forced:po.clearImmediate!==Xg},{clearImmediate:Xg});var Kg=po,qg=du,Qg=qo,Zg=vg,Jg=ii,ef=dg,tf=mg,rf=Kg.Function,nf=/MSIE .\./.test(Jg)||"BUN"===Zg&&function(){var e=Kg.Bun.version.split(".");return e.length<3||"0"===e[0]&&(e[1]<3||"3"===e[1]&&"0"===e[2])}(),of=au,sf=po,af=Yg.set,lf=function(e,t){var r=t?2:1;return nf?function(n,o){var i=tf(arguments.length,1)>r,s=Qg(n)?n:rf(n),a=i?ef(arguments,r):[],l=i?function(){qg(s,this,a)}:s;return t?e(l,o):e(l)}:e},uf=sf.setImmediate?lf(af,!1):af;of({global:!0,bind:!0,enumerable:!0,forced:sf.setImmediate!==uf},{setImmediate:uf});
/*! @license DOMPurify 3.2.4 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.2.4/LICENSE */
const{entries:hf,setPrototypeOf:cf,isFrozen:df,getPrototypeOf:pf,getOwnPropertyDescriptor:mf}=Object;let{freeze:gf,seal:ff,create:yf}=Object,{apply:wf,construct:Ef}="undefined"!=typeof Reflect&&Reflect;gf||(gf=function(e){return e}),ff||(ff=function(e){return e}),wf||(wf=function(e,t,r){return e.apply(t,r)}),Ef||(Ef=function(e,t){return new e(...t)});const vf=Pf(Array.prototype.forEach),Rf=Pf(Array.prototype.lastIndexOf),Sf=Pf(Array.prototype.pop),Tf=Pf(Array.prototype.push),Cf=Pf(Array.prototype.splice),bf=Pf(String.prototype.toLowerCase),Nf=Pf(String.prototype.toString),Af=Pf(String.prototype.match),If=Pf(String.prototype.replace),Of=Pf(String.prototype.indexOf),Mf=Pf(String.prototype.trim),_f=Pf(Object.prototype.hasOwnProperty),xf=Pf(RegExp.prototype.test),Lf=(Ff=TypeError,function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return Ef(Ff,t)});var Ff;function Pf(e){return function(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];return wf(e,t,n)}}function Vf(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:bf;cf&&cf(e,null);let n=t.length;for(;n--;){let o=t[n];if("string"==typeof o){const e=r(o);e!==o&&(df(t)||(t[n]=e),o=e)}e[o]=!0}return e}function Hf(e){for(let t=0;t<e.length;t++){_f(e,t)||(e[t]=null)}return e}function Df(e){const t=yf(null);for(const[r,n]of hf(e)){_f(e,r)&&(Array.isArray(n)?t[r]=Hf(n):n&&"object"==typeof n&&n.constructor===Object?t[r]=Df(n):t[r]=n)}return t}function Uf(e,t){for(;null!==e;){const r=mf(e,t);if(r){if(r.get)return Pf(r.get);if("function"==typeof r.value)return Pf(r.value)}e=pf(e)}return function(){return null}}const kf=gf(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),Bf=gf(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),Wf=gf(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),Gf=gf(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),jf=gf(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),zf=gf(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),$f=gf(["#text"]),Yf=gf(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),Xf=gf(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),Kf=gf(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),qf=gf(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),Qf=ff(/\{\{[\w\W]*|[\w\W]*\}\}/gm),Zf=ff(/<%[\w\W]*|[\w\W]*%>/gm),Jf=ff(/\$\{[\w\W]*/gm),ey=ff(/^data-[\-\w.\u00B7-\uFFFF]+$/),ty=ff(/^aria-[\-\w]+$/),ry=ff(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),ny=ff(/^(?:\w+script|data):/i),oy=ff(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),iy=ff(/^html$/i),sy=ff(/^[a-z][.\w]*(-[.\w]+)+$/i);var ay=Object.freeze({__proto__:null,ARIA_ATTR:ty,ATTR_WHITESPACE:oy,CUSTOM_ELEMENT:sy,DATA_ATTR:ey,DOCTYPE_NAME:iy,ERB_EXPR:Zf,IS_ALLOWED_URI:ry,IS_SCRIPT_OR_DATA:ny,MUSTACHE_EXPR:Qf,TMPLIT_EXPR:Jf});const ly=1,uy=3,hy=7,cy=8,dy=9,py=function(){return"undefined"==typeof window?null:window};var my=function e(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:py();const r=t=>e(t);if(r.version="3.2.4",r.removed=[],!t||!t.document||t.document.nodeType!==dy||!t.Element)return r.isSupported=!1,r;let{document:n}=t;const o=n,i=o.currentScript,{DocumentFragment:s,HTMLTemplateElement:a,Node:l,Element:u,NodeFilter:h,NamedNodeMap:c=t.NamedNodeMap||t.MozNamedAttrMap,HTMLFormElement:d,DOMParser:p,trustedTypes:m}=t,g=u.prototype,f=Uf(g,"cloneNode"),y=Uf(g,"remove"),w=Uf(g,"nextSibling"),E=Uf(g,"childNodes"),v=Uf(g,"parentNode");if("function"==typeof a){const e=n.createElement("template");e.content&&e.content.ownerDocument&&(n=e.content.ownerDocument)}let R,S="";const{implementation:T,createNodeIterator:C,createDocumentFragment:b,getElementsByTagName:N}=n,{importNode:A}=o;let I={afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]};r.isSupported="function"==typeof hf&&"function"==typeof v&&T&&void 0!==T.createHTMLDocument;const{MUSTACHE_EXPR:O,ERB_EXPR:M,TMPLIT_EXPR:_,DATA_ATTR:x,ARIA_ATTR:L,IS_SCRIPT_OR_DATA:F,ATTR_WHITESPACE:P,CUSTOM_ELEMENT:V}=ay;let{IS_ALLOWED_URI:H}=ay,D=null;const U=Vf({},[...kf,...Bf,...Wf,...jf,...$f]);let k=null;const B=Vf({},[...Yf,...Xf,...Kf,...qf]);let W=Object.seal(yf(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),G=null,j=null,z=!0,$=!0,Y=!1,X=!0,K=!1,q=!0,Q=!1,Z=!1,J=!1,ee=!1,te=!1,re=!1,ne=!0,oe=!1,ie=!0,se=!1,ae={},le=null;const ue=Vf({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let he=null;const ce=Vf({},["audio","video","img","source","image","track"]);let de=null;const pe=Vf({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),me="http://www.w3.org/1998/Math/MathML",ge="http://www.w3.org/2000/svg",fe="http://www.w3.org/1999/xhtml";let ye=fe,we=!1,Ee=null;const ve=Vf({},[me,ge,fe],Nf);let Re=Vf({},["mi","mo","mn","ms","mtext"]),Se=Vf({},["annotation-xml"]);const Te=Vf({},["title","style","font","a","script"]);let Ce=null;const be=["application/xhtml+xml","text/html"];let Ne=null,Ae=null;const Ie=n.createElement("form"),Oe=function(e){return e instanceof RegExp||e instanceof Function},Me=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!Ae||Ae!==e){if(e&&"object"==typeof e||(e={}),e=Df(e),Ce=-1===be.indexOf(e.PARSER_MEDIA_TYPE)?"text/html":e.PARSER_MEDIA_TYPE,Ne="application/xhtml+xml"===Ce?Nf:bf,D=_f(e,"ALLOWED_TAGS")?Vf({},e.ALLOWED_TAGS,Ne):U,k=_f(e,"ALLOWED_ATTR")?Vf({},e.ALLOWED_ATTR,Ne):B,Ee=_f(e,"ALLOWED_NAMESPACES")?Vf({},e.ALLOWED_NAMESPACES,Nf):ve,de=_f(e,"ADD_URI_SAFE_ATTR")?Vf(Df(pe),e.ADD_URI_SAFE_ATTR,Ne):pe,he=_f(e,"ADD_DATA_URI_TAGS")?Vf(Df(ce),e.ADD_DATA_URI_TAGS,Ne):ce,le=_f(e,"FORBID_CONTENTS")?Vf({},e.FORBID_CONTENTS,Ne):ue,G=_f(e,"FORBID_TAGS")?Vf({},e.FORBID_TAGS,Ne):{},j=_f(e,"FORBID_ATTR")?Vf({},e.FORBID_ATTR,Ne):{},ae=!!_f(e,"USE_PROFILES")&&e.USE_PROFILES,z=!1!==e.ALLOW_ARIA_ATTR,$=!1!==e.ALLOW_DATA_ATTR,Y=e.ALLOW_UNKNOWN_PROTOCOLS||!1,X=!1!==e.ALLOW_SELF_CLOSE_IN_ATTR,K=e.SAFE_FOR_TEMPLATES||!1,q=!1!==e.SAFE_FOR_XML,Q=e.WHOLE_DOCUMENT||!1,ee=e.RETURN_DOM||!1,te=e.RETURN_DOM_FRAGMENT||!1,re=e.RETURN_TRUSTED_TYPE||!1,J=e.FORCE_BODY||!1,ne=!1!==e.SANITIZE_DOM,oe=e.SANITIZE_NAMED_PROPS||!1,ie=!1!==e.KEEP_CONTENT,se=e.IN_PLACE||!1,H=e.ALLOWED_URI_REGEXP||ry,ye=e.NAMESPACE||fe,Re=e.MATHML_TEXT_INTEGRATION_POINTS||Re,Se=e.HTML_INTEGRATION_POINTS||Se,W=e.CUSTOM_ELEMENT_HANDLING||{},e.CUSTOM_ELEMENT_HANDLING&&Oe(e.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(W.tagNameCheck=e.CUSTOM_ELEMENT_HANDLING.tagNameCheck),e.CUSTOM_ELEMENT_HANDLING&&Oe(e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(W.attributeNameCheck=e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),e.CUSTOM_ELEMENT_HANDLING&&"boolean"==typeof e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements&&(W.allowCustomizedBuiltInElements=e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),K&&($=!1),te&&(ee=!0),ae&&(D=Vf({},$f),k=[],!0===ae.html&&(Vf(D,kf),Vf(k,Yf)),!0===ae.svg&&(Vf(D,Bf),Vf(k,Xf),Vf(k,qf)),!0===ae.svgFilters&&(Vf(D,Wf),Vf(k,Xf),Vf(k,qf)),!0===ae.mathMl&&(Vf(D,jf),Vf(k,Kf),Vf(k,qf))),e.ADD_TAGS&&(D===U&&(D=Df(D)),Vf(D,e.ADD_TAGS,Ne)),e.ADD_ATTR&&(k===B&&(k=Df(k)),Vf(k,e.ADD_ATTR,Ne)),e.ADD_URI_SAFE_ATTR&&Vf(de,e.ADD_URI_SAFE_ATTR,Ne),e.FORBID_CONTENTS&&(le===ue&&(le=Df(le)),Vf(le,e.FORBID_CONTENTS,Ne)),ie&&(D["#text"]=!0),Q&&Vf(D,["html","head","body"]),D.table&&(Vf(D,["tbody"]),delete G.tbody),e.TRUSTED_TYPES_POLICY){if("function"!=typeof e.TRUSTED_TYPES_POLICY.createHTML)throw Lf('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if("function"!=typeof e.TRUSTED_TYPES_POLICY.createScriptURL)throw Lf('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');R=e.TRUSTED_TYPES_POLICY,S=R.createHTML("")}else void 0===R&&(R=function(e,t){if("object"!=typeof e||"function"!=typeof e.createPolicy)return null;let r=null;const n="data-tt-policy-suffix";t&&t.hasAttribute(n)&&(r=t.getAttribute(n));const o="dompurify"+(r?"#"+r:"");try{return e.createPolicy(o,{createHTML:e=>e,createScriptURL:e=>e})}catch(i){return console.warn("TrustedTypes policy "+o+" could not be created."),null}}(m,i)),null!==R&&"string"==typeof S&&(S=R.createHTML(""));gf&&gf(e),Ae=e}},_e=Vf({},[...Bf,...Wf,...Gf]),xe=Vf({},[...jf,...zf]),Le=function(e){Tf(r.removed,{element:e});try{v(e).removeChild(e)}catch(t){y(e)}},Fe=function(e,t){try{Tf(r.removed,{attribute:t.getAttributeNode(e),from:t})}catch(n){Tf(r.removed,{attribute:null,from:t})}if(t.removeAttribute(e),"is"===e)if(ee||te)try{Le(t)}catch(n){}else try{t.setAttribute(e,"")}catch(n){}},Pe=function(e){let t=null,r=null;if(J)e="<remove></remove>"+e;else{const t=Af(e,/^[\r\n\t ]+/);r=t&&t[0]}"application/xhtml+xml"===Ce&&ye===fe&&(e='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+e+"</body></html>");const o=R?R.createHTML(e):e;if(ye===fe)try{t=(new p).parseFromString(o,Ce)}catch(s){}if(!t||!t.documentElement){t=T.createDocument(ye,"template",null);try{t.documentElement.innerHTML=we?S:o}catch(s){}}const i=t.body||t.documentElement;return e&&r&&i.insertBefore(n.createTextNode(r),i.childNodes[0]||null),ye===fe?N.call(t,Q?"html":"body")[0]:Q?t.documentElement:i},Ve=function(e){return C.call(e.ownerDocument||e,e,h.SHOW_ELEMENT|h.SHOW_COMMENT|h.SHOW_TEXT|h.SHOW_PROCESSING_INSTRUCTION|h.SHOW_CDATA_SECTION,null)},He=function(e){return e instanceof d&&("string"!=typeof e.nodeName||"string"!=typeof e.textContent||"function"!=typeof e.removeChild||!(e.attributes instanceof c)||"function"!=typeof e.removeAttribute||"function"!=typeof e.setAttribute||"string"!=typeof e.namespaceURI||"function"!=typeof e.insertBefore||"function"!=typeof e.hasChildNodes)},De=function(e){return"function"==typeof l&&e instanceof l};function Ue(e,t,n){vf(e,(e=>{e.call(r,t,n,Ae)}))}const ke=function(e){let t=null;if(Ue(I.beforeSanitizeElements,e,null),He(e))return Le(e),!0;const n=Ne(e.nodeName);if(Ue(I.uponSanitizeElement,e,{tagName:n,allowedTags:D}),e.hasChildNodes()&&!De(e.firstElementChild)&&xf(/<[/\w]/g,e.innerHTML)&&xf(/<[/\w]/g,e.textContent))return Le(e),!0;if(e.nodeType===hy)return Le(e),!0;if(q&&e.nodeType===cy&&xf(/<[/\w]/g,e.data))return Le(e),!0;if(!D[n]||G[n]){if(!G[n]&&We(n)){if(W.tagNameCheck instanceof RegExp&&xf(W.tagNameCheck,n))return!1;if(W.tagNameCheck instanceof Function&&W.tagNameCheck(n))return!1}if(ie&&!le[n]){const t=v(e)||e.parentNode,r=E(e)||e.childNodes;if(r&&t){for(let n=r.length-1;n>=0;--n){const o=f(r[n],!0);o.__removalCount=(e.__removalCount||0)+1,t.insertBefore(o,w(e))}}}return Le(e),!0}return e instanceof u&&!function(e){let t=v(e);t&&t.tagName||(t={namespaceURI:ye,tagName:"template"});const r=bf(e.tagName),n=bf(t.tagName);return!!Ee[e.namespaceURI]&&(e.namespaceURI===ge?t.namespaceURI===fe?"svg"===r:t.namespaceURI===me?"svg"===r&&("annotation-xml"===n||Re[n]):Boolean(_e[r]):e.namespaceURI===me?t.namespaceURI===fe?"math"===r:t.namespaceURI===ge?"math"===r&&Se[n]:Boolean(xe[r]):e.namespaceURI===fe?!(t.namespaceURI===ge&&!Se[n])&&!(t.namespaceURI===me&&!Re[n])&&!xe[r]&&(Te[r]||!_e[r]):!("application/xhtml+xml"!==Ce||!Ee[e.namespaceURI]))}(e)?(Le(e),!0):"noscript"!==n&&"noembed"!==n&&"noframes"!==n||!xf(/<\/no(script|embed|frames)/i,e.innerHTML)?(K&&e.nodeType===uy&&(t=e.textContent,vf([O,M,_],(e=>{t=If(t,e," ")})),e.textContent!==t&&(Tf(r.removed,{element:e.cloneNode()}),e.textContent=t)),Ue(I.afterSanitizeElements,e,null),!1):(Le(e),!0)},Be=function(e,t,r){if(ne&&("id"===t||"name"===t)&&(r in n||r in Ie))return!1;if($&&!j[t]&&xf(x,t));else if(z&&xf(L,t));else if(!k[t]||j[t]){if(!(We(e)&&(W.tagNameCheck instanceof RegExp&&xf(W.tagNameCheck,e)||W.tagNameCheck instanceof Function&&W.tagNameCheck(e))&&(W.attributeNameCheck instanceof RegExp&&xf(W.attributeNameCheck,t)||W.attributeNameCheck instanceof Function&&W.attributeNameCheck(t))||"is"===t&&W.allowCustomizedBuiltInElements&&(W.tagNameCheck instanceof RegExp&&xf(W.tagNameCheck,r)||W.tagNameCheck instanceof Function&&W.tagNameCheck(r))))return!1}else if(de[t]);else if(xf(H,If(r,P,"")));else if("src"!==t&&"xlink:href"!==t&&"href"!==t||"script"===e||0!==Of(r,"data:")||!he[e]){if(Y&&!xf(F,If(r,P,"")));else if(r)return!1}else;return!0},We=function(e){return"annotation-xml"!==e&&Af(e,V)},Ge=function(e){Ue(I.beforeSanitizeAttributes,e,null);const{attributes:t}=e;if(!t||He(e))return;const n={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:k,forceKeepAttr:void 0};let o=t.length;for(;o--;){const s=t[o],{name:a,namespaceURI:l,value:u}=s,h=Ne(a);let c="value"===a?u:Mf(u);if(n.attrName=h,n.attrValue=c,n.keepAttr=!0,n.forceKeepAttr=void 0,Ue(I.uponSanitizeAttribute,e,n),c=n.attrValue,!oe||"id"!==h&&"name"!==h||(Fe(a,e),c="user-content-"+c),q&&xf(/((--!?|])>)|<\/(style|title)/i,c)){Fe(a,e);continue}if(n.forceKeepAttr)continue;if(Fe(a,e),!n.keepAttr)continue;if(!X&&xf(/\/>/i,c)){Fe(a,e);continue}K&&vf([O,M,_],(e=>{c=If(c,e," ")}));const d=Ne(e.nodeName);if(Be(d,h,c)){if(R&&"object"==typeof m&&"function"==typeof m.getAttributeType)if(l);else switch(m.getAttributeType(d,h)){case"TrustedHTML":c=R.createHTML(c);break;case"TrustedScriptURL":c=R.createScriptURL(c)}try{l?e.setAttributeNS(l,a,c):e.setAttribute(a,c),He(e)?Le(e):Sf(r.removed)}catch(i){}}}Ue(I.afterSanitizeAttributes,e,null)},je=function e(t){let r=null;const n=Ve(t);for(Ue(I.beforeSanitizeShadowDOM,t,null);r=n.nextNode();)Ue(I.uponSanitizeShadowNode,r,null),ke(r),Ge(r),r.content instanceof s&&e(r.content);Ue(I.afterSanitizeShadowDOM,t,null)};return r.sanitize=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=null,i=null,a=null,u=null;if(we=!e,we&&(e="\x3c!--\x3e"),"string"!=typeof e&&!De(e)){if("function"!=typeof e.toString)throw Lf("toString is not a function");if("string"!=typeof(e=e.toString()))throw Lf("dirty is not a string, aborting")}if(!r.isSupported)return e;if(Z||Me(t),r.removed=[],"string"==typeof e&&(se=!1),se){if(e.nodeName){const t=Ne(e.nodeName);if(!D[t]||G[t])throw Lf("root node is forbidden and cannot be sanitized in-place")}}else if(e instanceof l)n=Pe("\x3c!----\x3e"),i=n.ownerDocument.importNode(e,!0),i.nodeType===ly&&"BODY"===i.nodeName||"HTML"===i.nodeName?n=i:n.appendChild(i);else{if(!ee&&!K&&!Q&&-1===e.indexOf("<"))return R&&re?R.createHTML(e):e;if(n=Pe(e),!n)return ee?null:re?S:""}n&&J&&Le(n.firstChild);const h=Ve(se?e:n);for(;a=h.nextNode();)ke(a),Ge(a),a.content instanceof s&&je(a.content);if(se)return e;if(ee){if(te)for(u=b.call(n.ownerDocument);n.firstChild;)u.appendChild(n.firstChild);else u=n;return(k.shadowroot||k.shadowrootmode)&&(u=A.call(o,u,!0)),u}let c=Q?n.outerHTML:n.innerHTML;return Q&&D["!doctype"]&&n.ownerDocument&&n.ownerDocument.doctype&&n.ownerDocument.doctype.name&&xf(iy,n.ownerDocument.doctype.name)&&(c="<!DOCTYPE "+n.ownerDocument.doctype.name+">\n"+c),K&&vf([O,M,_],(e=>{c=If(c,e," ")})),R&&re?R.createHTML(c):c},r.setConfig=function(){Me(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),Z=!0},r.clearConfig=function(){Ae=null,Z=!1},r.isValidAttribute=function(e,t,r){Ae||Me({});const n=Ne(e),o=Ne(t);return Be(n,o,r)},r.addHook=function(e,t){"function"==typeof t&&Tf(I[e],t)},r.removeHook=function(e,t){if(void 0!==t){const r=Rf(I[e],t);return-1===r?void 0:Cf(I[e],r,1)[0]}return Sf(I[e])},r.removeHooks=function(e){I[e]=[]},r.removeAllHooks=function(){I={afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}},r}();function gy(e,t){const r=t.length;let n=0;for(;n<r;)e.push(t[n]),n+=1}function fy(e){const t=[];if(!e||0===e.length||!e[0]||0===e[0].length)return t;const r=e.length,n=e[0].length;for(let o=0;o<r;o++)for(let r=0;r<n;r++)t[r]||(t[r]=[]),t[r][o]=e[o][r];return t}function yy(e,t,r,n){let o=-1,i=e,s=r;Array.isArray(e)||(i=Array.from(e));const a=i.length;for(n&&a&&(o+=1,s=i[o]),o+=1;o<a;)s=t(s,i[o],o,i),o+=1;return s}function wy(e,t){let r=0,n=e;Array.isArray(e)||(n=Array.from(e));const o=n.length,i=[];let s=-1;for(;r<o;){const e=n[r];t(e,r,n)&&(s+=1,i[s]=e),r+=1}return i}function Ey(e,t){let r=0,n=e;Array.isArray(e)||(n=Array.from(e));const o=n.length,i=[];let s=-1;for(;r<o;){const e=n[r];s+=1,i[s]=t(e,r,n),r+=1}return i}function vy(e,t){let r=0,n=e;Array.isArray(e)||(n=Array.from(e));const o=n.length;for(;r<o&&!1!==t(n[r],r,n);)r+=1;return e}function Ry(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];const[n,...o]=[...t];let i=n;return vy(o,(e=>{i=i.filter((t=>!e.includes(t)))})),i}function Sy(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:" ";return e.split(t)}function Ty(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];const o=yy(e,((e,t,n)=>e+t.replace(/\r?\n\s*/g,"")+(r[n]?r[n]:"")),"");return o.trim()}function Cy(e){let t;switch(typeof e){case"string":case"number":t=`${e}`;break;case"object":t=null===e?"":e.toString();break;case"undefined":t="";break;default:t=e.toString()}return t}function by(e){return void 0!==e}function Ny(e){return void 0===e}function Ay(e){return null===e||""===e||Ny(e)}const Iy="length",Oy=e=>parseInt(e,16),My=e=>parseInt(e,10),_y=(e,t,r)=>e.substr(t,r),xy=e=>e.codePointAt(0)-65,Ly=e=>`${e}`.replace(/\-/g,""),Fy=e=>Oy(_y(Ly(e),Oy("12"),xy("F")))/(Oy(_y(Ly(e),xy("B"),~~![][Iy]))||9),Py=()=>"undefined"!=typeof location&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host);let Vy=!1;const Hy={invalid:()=>Ty`
    The license key for Handsontable is invalid.\x20
    If you need any help, contact us at support@handsontable.com.`,expired:e=>{let{keyValidityDate:t,hotVersion:r}=e;return Ty`
    The license key for Handsontable expired on ${t}, and is not valid for the installed\x20
    version ${r}. Renew your license key at handsontable.com or downgrade to a version released prior\x20
    to ${t}. If you need any help, contact us at sales@handsontable.com.`},missing:()=>Ty`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\x20
    us at support@handsontable.com.`,non_commercial:()=>""},Dy={invalid:()=>Ty`
    The license key for Handsontable is invalid.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,expired:e=>{let{keyValidityDate:t,hotVersion:r}=e;return Ty`
    The license key for Handsontable expired on ${t}, and is not valid for the installed\x20
    version ${r}. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\x20
    license key or downgrade to a version released prior to ${t}. If you need any\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`},missing:()=>Ty`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,non_commercial:()=>""};function Uy(e,t){const r=!Ay(e),n="string"==typeof e&&"non-commercial-and-evaluation"===e.toLowerCase(),o="15.2.0";let i,s="invalid",a="invalid";const l=function(e){let t=[][Iy],r=t;if(e[Iy]!==xy("Z"))return!1;for(let n="",o="B<H4P+".split(""),i=xy(o.shift());i;i=xy(o.shift()||"A"))--i<""[Iy]?r|=(My(`${My(Oy(n)+(Oy(_y(e,Math.abs(i),2))+[]).padStart(2,"0"))}`)%97||2)>>1:n=_y(e,i,i?1===o[Iy]?9:8:6);return r===t}(e=Ly(e||""));if(r||n||l)if(l){const t=Ee("19/03/2025","DD/MM/YYYY"),r=Math.floor(t.toDate().getTime()/864e5),n=Fy(e);i=Ee(864e5*(n+1),"x").format("MMMM DD, YYYY"),r>n?(s="expired",a="expired"):(s="valid",a="valid")}else n?(s="non_commercial",a="valid"):(s="invalid",a="invalid");else s="missing",a="missing";if(Py()&&(s="valid",a="valid"),!Vy&&"valid"!==s){Hy[s]({keyValidityDate:i,hotVersion:o})&&console["non_commercial"===s?"info":"warn"](Hy[s]({keyValidityDate:i,hotVersion:o})),Vy=!0}if("valid"!==a&&t.parentNode){if(Dy[a]({keyValidityDate:i,hotVersion:o})){const e=document.createElement("div");e.className="handsontable hot-display-license-info",e.innerHTML=Dy[a]({keyValidityDate:i,hotVersion:o}),t.parentNode.insertBefore(e,t.nextSibling)}}}function ky(e){return e[0].toUpperCase()+e.substr(1)}function By(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+e()+e()}const Wy=e=>["tabindex",e],Gy=()=>["role","presentation"],jy=()=>["aria-hidden","true"],zy=e=>["aria-rowcount",e],$y=e=>["aria-colcount",e],Yy=e=>["aria-rowindex",e],Xy=e=>["aria-colindex",e],Ky=()=>["aria-readonly","true"],qy=()=>["aria-invalid","true"];function Qy(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=-1,n=null,o=e;for(;null!==o;){if(r===t){n=o;break}o.host&&o.nodeType===Node.DOCUMENT_FRAGMENT_NODE?o=o.host:(r+=1,o=o.parentNode)}return n}function Zy(e){return function(e){return Object.getPrototypeOf(e.parent)&&e.frameElement}(e)&&e.parent}function Jy(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0;const{ELEMENT_NODE:n,DOCUMENT_FRAGMENT_NODE:o}=Node;let i=e;for(;null!=i&&i!==r;){const{nodeType:e,nodeName:r}=i;if(e===n&&(t.includes(r)||t.includes(i)))return i;const{host:s}=i;i=s&&e===o?s:i.parentNode}return null}function ew(e,t,r){const n=[];let o=e;for(;o&&(o=Jy(o,t,r),o&&(!r||r.contains(o)));)n.push(o),o=o.host&&o.nodeType===Node.DOCUMENT_FRAGMENT_NODE?o.host:o.parentNode;const i=n.length;return i?n[i-1]:null}function tw(e,t){let r=e.parentNode,n=[];for("string"==typeof t?n=e.defaultView?Array.prototype.slice.call(e.querySelectorAll(t),0):Array.prototype.slice.call(e.ownerDocument.querySelectorAll(t),0):n.push(t);null!==r;){if(n.indexOf(r)>-1)return!0;r=r.parentNode}return!1}function rw(e,t,r){const n=r.parentElement.querySelector(`.ht_clone_${e}`);return n?n.contains(t):null}function nw(e){return e&&e.length?e.filter((e=>!!e)):[]}function ow(e,t){if(!e||!e.length)return t?{regexFree:[],regexes:[]}:[];const r=[],n=[];return n.push(...e.filter((e=>{const n=e instanceof RegExp;return n&&t&&r.push(e),!n}))),t?{regexFree:n,regexes:r}:n}function iw(e,t){return void 0!==e.classList&&"string"==typeof t&&""!==t&&e.classList.contains(t)}function sw(e,t){"string"==typeof t&&(t=t.split(" ")),(t=nw(t)).length>0&&e.classList.add(...t)}function aw(e,t){"string"==typeof t?t=t.split(" "):t instanceof RegExp&&(t=[t]);let{regexFree:r,regexes:n}=ow(t,!0);r=nw(r),r.length>0&&e.classList.remove(...r),n.forEach((t=>{e.classList.forEach((r=>{t.test(r)&&e.classList.remove(r)}))}))}function lw(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0;Array.isArray(t)||(t=[[t,r]]),t.forEach((t=>{Array.isArray(t)&&""!==t[0]&&e.setAttribute(...t)}))}function uw(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];"string"==typeof t?t=t.split(" "):t instanceof RegExp&&(t=[t]);const{regexFree:r,regexes:n}=ow(t,!0);r.forEach((t=>{""!==t&&e.removeAttribute(t)})),n.forEach((t=>{e.getAttributeNames().forEach((r=>{t.test(r)&&e.removeAttribute(r)}))}))}function hw(e){if(3===e.nodeType)e.parentNode.removeChild(e);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(e.nodeName)>-1){const t=e.childNodes;for(let e=t.length-1;e>=0;e--)hw(t[e])}}function cw(e){let t;for(;t=e.lastChild;)e.removeChild(t)}const dw=/(<(.*)>|&(.*);)/;function pw(e,t){let r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];var n,o;dw.test(t)?e.innerHTML=r?(n=t,my.sanitize(n,o)):t:mw(e,t)}function mw(e,t){const r=e.firstChild;r&&3===r.nodeType&&null===r.nextSibling?r.textContent=t:(cw(e),e.appendChild(e.ownerDocument.createTextNode(t)))}function gw(e){const t=e.ownerDocument.documentElement,r=e.ownerDocument.defaultView;let n=e;for(;n!==t;){if(null===n)return!1;if(n.nodeType===Node.DOCUMENT_FRAGMENT_NODE){if(n.host){if(n.host.impl)return gw(n.host.impl);if(n.host)return gw(n.host);throw new Error("Lost in Web Components world")}return!1}if("none"===r.getComputedStyle(n).display)return!1;n=n.parentNode}return!0}function fw(e){const t=e.ownerDocument,r=t.defaultView,n=t.documentElement;let o,i,s,a=e;for(o=a.offsetLeft,i=a.offsetTop,s=a;(a=a.offsetParent)&&a!==t.body&&"offsetLeft"in a;)o+=a.offsetLeft,i+=a.offsetTop,s=a;return s&&"fixed"===s.style.position&&(o+=r.pageXOffset||n.scrollLeft,i+=r.pageYOffset||n.scrollTop),{left:o,top:i}}function yw(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:window).scrollY}function ww(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:window).scrollX}function Ew(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;return e===t?yw(t):e.scrollTop}function vw(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;return e===t?ww(t):e.scrollLeft}function Rw(e){let t=e.ownerDocument,r=t?t.defaultView:void 0;t||(t=e.document?e.document:e,r=t.defaultView);const n=["auto","scroll"];let o=e.parentNode;for(;o&&o.style&&t.body!==o;){let{overflow:e,overflowX:t,overflowY:i}=o.style;if([e,t,i].includes("scroll"))return o;if(({overflow:e,overflowX:t,overflowY:i}=r.getComputedStyle(o)),n.includes(e)||n.includes(t)||n.includes(i))return o;if(o.clientHeight<=o.scrollHeight+1&&(n.includes(i)||n.includes(e)))return o;if(o.clientWidth<=o.scrollWidth+1&&(n.includes(t)||n.includes(e)))return o;o=o.parentNode}return r}function Sw(e){const t=e.ownerDocument,r=t.defaultView;let n=e.parentNode;for(;n&&n.style&&t.body!==n;){if("visible"!==n.style.overflow&&""!==n.style.overflow)return n;const e=r.getComputedStyle(n),t=["scroll","hidden","auto"],o=e.getPropertyValue("overflow"),i=e.getPropertyValue("overflow-y"),s=e.getPropertyValue("overflow-x");if(t.includes(o)||t.includes(i)||t.includes(s))return n;n=n.parentNode}return r}function Tw(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:window;if(!e)return;if(e===r)return"width"===t?`${r.innerWidth}px`:"height"===t?`${r.innerHeight}px`:void 0;const n=e.style[t];if(""!==n&&void 0!==n)return n;const o=r.getComputedStyle(e);return""!==o[t]&&void 0!==o[t]?o[t]:void 0}function Cw(e){return e.offsetWidth}function bw(e){return e.offsetHeight}function Nw(e){return e.clientHeight||e.innerHeight}function Aw(e){return e.clientWidth||e.innerWidth}function Iw(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window;e.getSelection&&(e.getSelection().empty?e.getSelection().empty():e.getSelection().removeAllRanges&&e.getSelection().removeAllRanges())}function Ow(e,t,r){if(void 0===r&&(r=t),e.setSelectionRange){e.focus();try{e.setSelectionRange(t,r)}catch(n){const o=e.parentNode,i=o.style.display;o.style.display="block",e.setSelectionRange(t,r),o.style.display=i}}}let Mw;function _w(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document;return void 0===Mw&&(Mw=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document;const t=e.createElement("div");t.style.height="200px",t.style.width="100%";const r=e.createElement("div");r.style.boxSizing="content-box",r.style.height="150px",r.style.left="0px",r.style.overflow="hidden",r.style.position="absolute",r.style.top="0px",r.style.width="200px",r.style.visibility="hidden",r.appendChild(t),(e.body||e.documentElement).appendChild(r);const n=t.offsetWidth;r.style.overflow="scroll";let o=t.offsetWidth;return n===o&&(o=r.clientWidth),(e.body||e.documentElement).removeChild(r),n-o}(e)),Mw}function xw(e,t,r){e.style.transform=`translate3d(${t},${r},0)`}function Lw(e){e.style.transform&&""!==e.style.transform&&(e.style.transform="")}function Fw(e){return e&&(["INPUT","SELECT","TEXTAREA"].indexOf(e.nodeName)>-1||"true"===e.contentEditable)}function Pw(e){return Fw(e)&&!1===e.hasAttribute("data-hot-input")}function Vw(e){var t;const r=null==e||null===(t=e.ownerDocument)||void 0===t?void 0:t.defaultView.Element;return!!(r&&null!==r&&e instanceof r)}function Hw(e){return"function"==typeof e}function Dw(e,t,r,n,o,i,s,a){return by(a)?e.call(t,r,n,o,i,s,a):by(s)?e.call(t,r,n,o,i,s):by(i)?e.call(t,r,n,o,i):by(o)?e.call(t,r,n,o):by(n)?e.call(t,r,n):by(r)?e.call(t,r):e.call(t)}var Uw=Rh,kw=qo,Bw=Vo,Ww=Uu,Gw=xo([].push),jw=au,zw=ti,$w=du,Yw=vo,Xw=xo,Kw=go,qw=qo,Qw=Ri,Zw=dg,Jw=function(e){if(kw(e))return e;if(Uw(e)){for(var t=e.length,r=[],n=0;n<t;n++){var o=e[n];"string"==typeof o?Gw(r,o):"number"!=typeof o&&"Number"!==Bw(o)&&"String"!==Bw(o)||Gw(r,Ww(o))}var i=r.length,s=!0;return function(e,t){if(s)return s=!1,t;if(Uw(this))return t;for(var n=0;n<i;n++)if(r[n]===e)return t}}},eE=gi,tE=String,rE=zw("JSON","stringify"),nE=Xw(/./.exec),oE=Xw("".charAt),iE=Xw("".charCodeAt),sE=Xw("".replace),aE=Xw(1..toString),lE=/[\uD800-\uDFFF]/g,uE=/^[\uD800-\uDBFF]$/,hE=/^[\uDC00-\uDFFF]$/,cE=!eE||Kw((function(){var e=zw("Symbol")("stringify detection");return"[null]"!==rE([e])||"{}"!==rE({a:e})||"{}"!==rE(Object(e))})),dE=Kw((function(){return'"\\udf06\\ud834"'!==rE("\udf06\ud834")||'"\\udead"'!==rE("\udead")})),pE=function(e,t){var r=Zw(arguments),n=Jw(t);if(qw(n)||void 0!==e&&!Qw(e))return r[1]=function(e,t){if(qw(n)&&(t=Yw(n,this,tE(e),t)),!Qw(t))return t},$w(rE,null,r)},mE=function(e,t,r){var n=oE(r,t-1),o=oE(r,t+1);return nE(uE,e)&&!nE(hE,o)||nE(hE,e)&&!nE(uE,n)?"\\u"+aE(iE(e,0),16):e};function gE(e){let t;return Array.isArray(e)?t=e.length?new Array(e.length).fill(null):[]:(t={},TE(e,((e,r)=>{"__children"!==r&&(e&&"object"==typeof e&&!Array.isArray(e)?t[r]=gE(e):Array.isArray(e)?e.length&&"object"==typeof e[0]&&!Array.isArray(e[0])?t[r]=[gE(e[0])]:t[r]=[]:t[r]=null)}))),t}function fE(e,t,r){const n=Array.isArray(r);return TE(t,((t,o)=>{(!1===n||r.includes(o))&&(e[o]=t)})),e}function yE(e,t){TE(t,((r,n)=>{t[n]&&"object"==typeof t[n]?(e[n]||(Array.isArray(t[n])?e[n]=[]:"[object Date]"===Object.prototype.toString.call(t[n])?e[n]=t[n]:e[n]={}),yE(e[n],t[n])):e[n]=t[n]}))}function wE(e){return"object"==typeof e?JSON.parse(JSON.stringify(e)):e}function EE(e){e.MIXINS||(e.MIXINS=[]);for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return vy(r,(t=>{e.MIXINS.push(t.MIXIN_NAME),TE(t,((t,r)=>{if(void 0!==e.prototype[r])throw new Error(`Mixin conflict. Property '${r}' already exist and cannot be overwritten.`);if("function"==typeof t)e.prototype[r]=t;else{const n=function(e,t){const r=`_${e}`;return function(){return void 0===this[r]&&(this[r]=(e=>{let t=e;return(Array.isArray(t)||RE(t))&&(t=wE(t)),t})(t)),this[r]}},o=function(e){const t=`_${e}`;return function(e){this[t]=e}};Object.defineProperty(e.prototype,r,{get:n(r,t),set:o(r),configurable:!0})}}))})),e}function vE(e,t){return JSON.stringify(e)===JSON.stringify(t)}function RE(e){return"[object Object]"===Object.prototype.toString.call(e)}function SE(e,t,r,n){n.value=r,n.writable=!1!==n.writable,n.enumerable=!1!==n.enumerable,n.configurable=!1!==n.configurable,Object.defineProperty(e,t,n)}function TE(e,t){for(const r in e)if((!e.hasOwnProperty||e.hasOwnProperty&&Object.prototype.hasOwnProperty.call(e,r))&&!1===t(e[r],r,e))break;return e}function CE(e,t,r){const n=t.split(".");let o=e;n.forEach(((e,t)=>{"__proto__"!==e&&"constructor"!==e&&"prototype"!==e&&(t!==n.length-1?(AE(o,e)||(o[e]={}),o=o[e]):o[e]=r)}))}function bE(e){if(!RE(e))return 0;const t=function(e){let r=0;return RE(e)?TE(e,((e,n)=>{"__children"!==n&&(r+=t(e))})):r+=1,r};return t(e)}function NE(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"value";const r=`_${t}`,n={_touched:!1,[r]:e,isTouched(){return this._touched}};return Object.defineProperty(n,t,{get(){return this[r]},set(e){this._touched=!0,this[r]=e},enumerable:!0,configurable:!0}),n}function AE(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function IE(e){return window.requestAnimationFrame(e)}rE&&jw({target:"JSON",stat:!0,arity:3,forced:cE||dE},{stringify:function(e,t,r){var n=Zw(arguments),o=$w(cE?pE:rE,null,n);return dE&&"string"==typeof o?sE(o,lE,mE):o}});const OE=e=>{const t={value:!1,test:(r,n)=>{t.value=e(r,n)}};return t},ME={chrome:OE(((e,t)=>/Chrome/.test(e)&&/Google/.test(t))),chromeWebKit:OE((e=>/CriOS/.test(e))),edge:OE((e=>/Edge/.test(e))),edgeWebKit:OE((e=>/EdgiOS/.test(e))),firefox:OE((e=>/Firefox/.test(e))),firefoxWebKit:OE((e=>/FxiOS/.test(e))),mobile:OE((e=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(e))),safari:OE(((e,t)=>/Safari/.test(e)&&/Apple Computer/.test(t)))},_E={mac:OE((e=>/^Mac/.test(e))),win:OE((e=>/^Win/.test(e))),linux:OE((e=>/^Linux/.test(e))),ios:OE((e=>/iPhone|iPad|iPod/i.test(e)))};function xE(){return ME.firefox.value}function LE(){return ME.mobile.value}function FE(){return _E.ios.value}function PE(){return _E.mac.value}"undefined"!=typeof window&&(function(){let{userAgent:e=navigator.userAgent,vendor:t=navigator.vendor}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};TE(ME,(r=>{let{test:n}=r;n(e,t)}))}(),function(){let{platform:e=navigator.platform}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};TE(_E,(t=>{let{test:r}=t;r(e)}))}());const VE={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:xE()?182:174,AUDIO_MUTE:xE()?181:173,AUDIO_UP:xE()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},HE=[VE.ALT,VE.ARROW_DOWN,VE.ARROW_LEFT,VE.ARROW_RIGHT,VE.ARROW_UP,VE.AUDIO_DOWN,VE.AUDIO_MUTE,VE.AUDIO_UP,VE.BACKSPACE,VE.CAPS_LOCK,VE.DELETE,VE.END,VE.ENTER,VE.ESCAPE,VE.F1,VE.F2,VE.F3,VE.F4,VE.F5,VE.F6,VE.F7,VE.F8,VE.F9,VE.F10,VE.F11,VE.F12,VE.F13,VE.F14,VE.F15,VE.F16,VE.F17,VE.F18,VE.F19,VE.HOME,VE.INSERT,VE.MEDIA_NEXT,VE.MEDIA_PLAY_PAUSE,VE.MEDIA_PREV,VE.MEDIA_STOP,VE.NULL,VE.NUM_LOCK,VE.PAGE_DOWN,VE.PAGE_UP,VE.PAUSE,VE.SCROLL_LOCK,VE.SHIFT,VE.TAB];function DE(e){e.isImmediatePropagationEnabled=!1,e.cancelBubble=!0}function UE(e){return!1===e.isImmediatePropagationEnabled}function kE(e){return 2===e.button}function BE(e){return 0===e.button}function WE(){by(console)&&console.warn(...arguments)}const GE=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","beforeViewportScrollVertically","beforeViewportScrollHorizontally","beforeViewportScroll","afterScrollHorizontally","afterScrollVertically","afterScroll","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSelectionFocusSet","beforeSelectColumns","afterSelectColumns","beforeSelectRows","afterSelectRows","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterSetTheme","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeRowWrap","beforeColumnWrap","beforeSetCellMeta","beforeSelectionFocusSet","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeSelectionHighlightSet","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyFiltersMultiSelectValue","modifyFocusedElement","modifyRowHeader","modifyRowHeight","modifyRowHeightByOverlayName","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","modifyGetCoordsElement","modifyFocusOnTabNavigation","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformFocus","modifyTransformStart","modifyTransformEnd","afterModifyTransformFocus","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","beforeBeginEditing","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],jE=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),zE=new Map([[]]);var $E=wl,YE=po,XE=cs,KE=cp,qE=Hs.f,QE=XE("unscopables"),ZE=Array.prototype;void 0===ZE[QE]&&qE(ZE,QE,{configurable:!0,value:KE(null)});var JE=function(e){ZE[QE][e]=!0},ev=au,tv=Ai,rv=Xo,nv=function(e,t,r){for(var n=0,o=arguments.length>2?r:$E(t),i=new e(o);o>n;)i[n]=t[n++];return i},ov=function(e,t){var r=YE[e],n=r&&r.prototype;return n&&n[t]},iv=JE,sv=Array,av=xo(ov("Array","sort"));ev({target:"Array",proto:!0},{toSorted:function(e){void 0!==e&&tv(e);var t=rv(this),r=nv(sv,t);return av(r,e)}}),iv("toSorted");var lv=Qm,uv=Ai,hv=Ws,cv=rc;function dv(e,t,r){pv(e,t),t.set(e,r)}function pv(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function mv(e,t,r){return e.set(fv(e,t),r),r}function gv(e,t){return e.get(fv(e,t))}function fv(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}au({target:"Iterator",proto:!0,real:!0},{find:function(e){hv(this),uv(e);var t=cv(this),r=0;return lv(t,(function(t,n){if(e(t,r++))return n(t)}),{IS_RECORD:!0,INTERRUPTED:!0}).result}});var yv=new WeakMap,wv=new WeakMap,Ev=new WeakMap,vv=new WeakSet;class Rv{constructor(){var e,t;pv(e=this,t=vv),t.add(e),dv(this,yv,new Map),dv(this,wv,new Map),dv(this,Ev,new Set),GE.forEach((e=>fv(vv,this,Sv).call(this,e)))}getHooks(e){var t;return null!==(t=gv(yv,this).get(e))&&void 0!==t?t:[]}add(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};gv(yv,this).has(e)||(fv(vv,this,Sv).call(this,e),GE.push(e));const n=gv(yv,this).get(e);if(n.find((e=>e.callback===t)))return;const o=Number.isInteger(r.orderIndex)?r.orderIndex:0,i=!!r.runOnce,s=!!r.initialHook;let a=!1;if(s){const e=n.find((e=>e.initialHook));e&&(e.callback=t,a=!0)}if(!a){n.push({callback:t,orderIndex:o,runOnce:i,initialHook:s,skip:!1});let r=gv(Ev,this).has(e);r||0===o||(r=!0,gv(Ev,this).add(e)),r&&n.length>1&&gv(yv,this).set(e,n.toSorted(((e,t)=>e.orderIndex-t.orderIndex)))}}has(e){return gv(yv,this).has(e)&&gv(yv,this).get(e).length>0}remove(e,t){if(!gv(yv,this).has(e))return!1;const r=gv(yv,this).get(e),n=r.find((e=>e.callback===t));if(n){let t=gv(wv,this).get(e);return n.skip=!0,t+=1,t>100&&(gv(yv,this).set(e,r.filter((e=>!e.skip))),t=0),gv(wv,this).set(e,t),!0}return!1}destroy(){gv(yv,this).clear(),gv(wv,this).clear(),mv(yv,this,null),mv(wv,this,null)}}function Sv(e){gv(yv,this).set(e,[]),gv(wv,this).set(e,0)}function Tv(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const Cv=Ty`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\x20
  learn about the migration path.`;class bv{constructor(){Tv(this,"globalBucket",new Rv)}static getSingleton(){return Nv}getBucket(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return e?(e.pluginHookBucket||(e.pluginHookBucket=new Rv),e.pluginHookBucket):this.globalBucket}add(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3?arguments[3]:void 0;return Array.isArray(t)?vy(t,(t=>this.add(e,t,r))):(jE.has(e)&&WE(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return`${e}`.replace(/(?:\\)?\[([^[\]]+)]/g,((e,r)=>"\\"===e.charAt(0)?e.substr(1,e.length-1):void 0===t[r]?"":t[r]))}(Cv,{hookName:e,removedInVersion:jE.get(e)})),zE.has(e)&&WE(zE.get(e)),this.getBucket(r).add(e,t,{orderIndex:n,runOnce:!1})),this}once(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3?arguments[3]:void 0;return Array.isArray(t)?vy(t,(t=>this.once(e,t,r))):this.getBucket(r).add(e,t,{orderIndex:n,runOnce:!0}),this}addAsFixed(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return Array.isArray(t)?vy(t,(t=>this.addAsFixed(e,t,r))):this.getBucket(r).add(e,t,{initialHook:!0}),this}remove(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return this.getBucket(r).remove(e,t)}has(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this.getBucket(t).has(e)}run(e,t,r,n,o,i,s,a){{const l=this.getBucket().getHooks(t),u=l?l.length:0;let h=0;if(u)for(;h<u;){if(!l[h]||l[h].skip){h+=1;continue}const u=Dw(l[h].callback,e,r,n,o,i,s,a);void 0!==u&&(r=u),l[h]&&l[h].runOnce&&this.remove(t,l[h].callback),h+=1}}{const l=this.getBucket(e).getHooks(t),u=l?l.length:0;let h=0;if(u)for(;h<u;){if(!l[h]||l[h].skip){h+=1;continue}const u=Dw(l[h].callback,e,r,n,o,i,s,a);void 0!==u&&(r=u),l[h]&&l[h].runOnce&&this.remove(t,l[h].callback,e),h+=1}}return r}destroy(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.getBucket(e).destroy()}register(e){this.isRegistered(e)||GE.push(e)}deregister(e){this.isRegistered(e)&&GE.splice(GE.indexOf(e),1)}isDeprecated(e){return zE.has(e)||jE.has(e)}isRegistered(e){return GE.indexOf(e)>=0}getRegistered(){return GE}}const Nv=new bv;const Av=new Map;function Iv(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"common";Av.has(e)||Av.set(e,new Map);const t=Av.get(e);return{register:function(e,r){t.set(e,r)},getItem:function(e){return t.get(e)},hasItem:function(e){return t.has(e)},getNames:function(){return[...t.keys()]},getValues:function(){return[...t.values()]}}}const Ov=new WeakMap,{register:Mv,getItem:_v,hasItem:xv,getNames:Lv,getValues:Fv}=Iv("editors");function Pv(e){const t={},r=e;this.getConstructor=function(){return e},this.getInstance=function(e){return e.guid in t||(t[e.guid]=new r(e)),t[e.guid]},bv.getSingleton().add("afterDestroy",(function(){t[this.guid]=null}))}function Vv(e){if("function"==typeof e)return e;if(!xv(e))throw Error(`No registered editor found under "${e}" name`);return _v(e).getConstructor()}function Hv(e,t){e&&"string"!=typeof e&&(e=(t=e).EDITOR_TYPE);const r=new Pv(t);"string"==typeof e&&Mv(e,r),Ov.set(t,r)}function Dv(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const Uv=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;Dv(this,"context",void 0),this.context=e||this,this.context.eventListeners||(this.context.eventListeners=[])}addEventListener(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];function o(e){r.call(this,function(e){const t=e.stopImmediatePropagation;return e.stopImmediatePropagation=function(){t.apply(this),DE(this)},e}(e))}return this.context.eventListeners.push({element:e,event:t,callback:r,callbackProxy:o,options:n,eventManager:this}),e.addEventListener(t,o,n),()=>{this.removeEventListener(e,t,r)}}removeEventListener(e,t,r){let n,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=this.context.eventListeners.length;for(;i;)if(i-=1,n=this.context.eventListeners[i],n.event===t&&n.element===e){if(r&&r!==n.callback)continue;if(o&&n.eventManager!==this)continue;this.context.eventListeners.splice(i,1),n.element.removeEventListener(n.event,n.callbackProxy,n.options)}}clearEvents(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.context)return;let t=this.context.eventListeners.length;for(;t;){t-=1;const r=this.context.eventListeners[t];e&&r.eventManager!==this||(this.context.eventListeners.splice(t,1),r.element.removeEventListener(r.event,r.callbackProxy,r.options))}}clear(){this.clearEvents()}destroy(){this.clearEvents(),this.context=null}destroyWithOwnEventsOnly(){this.clearEvents(!0),this.context=null}fireEvent(e,t){let r=e.document,n=e;r||(r=e.ownerDocument?e.ownerDocument:e,n=r.defaultView);const o={bubbles:!0,cancelable:"mousemove"!==t,view:n,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0};let i;r.createEvent?(i=r.createEvent("MouseEvents"),i.initMouseEvent(t,o.bubbles,o.cancelable,o.view,o.detail,o.screenX,o.screenY,o.clientX,o.clientY,o.ctrlKey,o.altKey,o.shiftKey,o.metaKey,o.button,r.body.parentNode)):i=r.createEventObject(),e.dispatchEvent?e.dispatchEvent(i):e.fireEvent(`on${t}`,i)}};function kv(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function Bv(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Wv(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var Gv=new WeakSet;class jv{constructor(e,t,r){kv(this,Gv),Bv(this,"hot",void 0),Bv(this,"tableMeta",void 0),Bv(this,"selection",void 0),Bv(this,"eventManager",void 0),Bv(this,"destroyed",!1),Bv(this,"activeEditor",void 0),Bv(this,"cellProperties",void 0),this.hot=e,this.tableMeta=t,this.selection=r,this.eventManager=new Uv(e),this.hot.addHook("afterDocumentKeyDown",(e=>Wv(Gv,this,zv).call(this,e))),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"compositionstart",(e=>{!this.destroyed&&this.hot.isListening()&&this.openEditor("",e)})),this.hot.view._wt.update("onCellDblClick",((e,t,r)=>Wv(Gv,this,$v).call(this,e,t,r)))}getActiveEditor(){return this.activeEditor}prepareEditor(){var e;if(this.activeEditor&&this.activeEditor.isWaiting())return void this.closeEditor(!1,!1,(e=>{e&&this.prepareEditor()}));const t=null===(e=this.hot.getSelectedRangeLast())||void 0===e?void 0:e.highlight;if(!t||t.isHeader())return;const{row:r,col:n}=t,o=this.hot.runHooks("modifyGetCellCoords",r,n,!1,"meta");let i=r,s=n;if(Array.isArray(o)&&([i,s]=o),this.cellProperties=this.hot.getCellMeta(i,s),!this.isCellEditable())return void this.clearActiveEditor();const a=this.hot.getCell(r,n,!0);if(a){const e=this.hot.getCellEditor(this.cellProperties),t=this.hot.colToProp(s),o=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(i),s);this.activeEditor=function(e,t){let r;if("function"==typeof e)Ov.get(e)||Hv(null,e),r=Ov.get(e);else{if("string"!=typeof e)throw Error('Only strings and functions can be passed as "editor" parameter');r=_v(e)}if(!r)throw Error(`No editor registered under name "${e}"`);return r.getInstance(t)}(e,this.hot),this.activeEditor.prepare(r,n,t,a,o,this.cellProperties)}}isEditorOpened(){return this.activeEditor&&this.activeEditor.isOpened()}openEditor(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!this.isCellEditable())return void this.clearActiveEditor();const n=this.hot.getSelectedRangeLast();let o=this.hot.runHooks("beforeBeginEditing",n.highlight.row,n.highlight.col,e,t,r);t instanceof MouseEvent&&"boolean"!=typeof o&&(o=0===this.hot.selection.getLayerLevel()&&n.isSingle()),!1!==o?(this.activeEditor||(this.hot.scrollToFocusedCell(),this.prepareEditor()),this.activeEditor&&(r&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(e,t))):this.clearActiveEditor()}closeEditor(e,t,r){this.activeEditor?this.activeEditor.finishEditing(e,t,r):r&&r(!1)}closeEditorAndSaveChanges(e){this.closeEditor(!1,e)}closeEditorAndRestoreOriginalValue(e){this.closeEditor(!0,e)}clearActiveEditor(){this.activeEditor=void 0}isCellEditable(){const e=this.hot.getSelectedRangeLast();if(!e)return!1;const t=this.hot.getCellEditor(this.cellProperties),{row:r,col:n}=e.highlight,{rowIndexMapper:o,columnIndexMapper:i}=this.hot,s=o.isHidden(this.hot.toPhysicalRow(r))||i.isHidden(this.hot.toPhysicalColumn(n));return!(this.cellProperties.readOnly||!t||s)}moveSelectionAfterEnter(e){const t={..."function"==typeof this.tableMeta.enterMoves?this.tableMeta.enterMoves(e):this.tableMeta.enterMoves};e.shiftKey&&(t.row=-t.row,t.col=-t.col),this.hot.selection.isMultiple()?this.selection.transformFocus(t.row,t.col):this.selection.transformStart(t.row,t.col,!0)}destroy(){this.destroyed=!0,this.eventManager.destroy()}}function zv(e){const t=this.hot.getSelectedRangeLast();if(!this.hot.isListening()||!t||t.highlight.isHeader()||UE(e))return;const{keyCode:r}=e,n=(e.ctrlKey||e.metaKey)&&!e.altKey;(!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&(function(e){return HE.includes(e)}(r)||function(e){return[VE.CONTROL,VE.COMMAND_LEFT,VE.COMMAND_RIGHT,VE.COMMAND_FIREFOX].includes(e)}(r)||n||this.isEditorOpened()||this.openEditor("",e))}function $v(e,t){t.isCell()&&this.openEditor(null,e,!0)}const Yv=new WeakMap;jv.getInstance=function(e,t,r){let n=Yv.get(e);return n||(n=new jv(e,t,r),Yv.set(e,n)),n};const Xv=jv;function Kv(e,t,r){qv(e,t),t.set(e,r)}function qv(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Qv(e,t){return e.get(Jv(e,t))}function Zv(e,t,r){return e.set(Jv(e,t),r),r}function Jv(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}const eR=Object.freeze({CELL:"cell",MIXED:"mixed"});var tR=new WeakMap,rR=new WeakMap,nR=new WeakMap,oR=new WeakMap,iR=new WeakMap,sR=new WeakSet;class aR{constructor(e){var t,r,n=this;qv(t=this,r=sR),r.add(t),Kv(this,tR,void 0),Kv(this,rR,void 0),Kv(this,nR,1),Kv(this,oR,null),Kv(this,iR,new Map);const o=e.getSettings();Zv(tR,this,e),Zv(rR,this,o.imeFastEdit?eR.MIXED:eR.CELL),Qv(tR,this).addHook("afterUpdateSettings",(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return Jv(sR,n,cR).call(n,...t)})),Qv(tR,this).addHook("afterSelection",(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return Jv(sR,n,uR).call(n,...t)})),Qv(tR,this).addHook("afterSelectionFocusSet",(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return Jv(sR,n,uR).call(n,...t)})),Qv(tR,this).addHook("afterSelectionEnd",(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return Jv(sR,n,hR).call(n,...t)}))}getFocusMode(){return Qv(rR,this)}setFocusMode(e){Object.values(eR).includes(e)?Zv(rR,this,e):WE(`"${e}" is not a valid focus mode.`)}getRefocusDelay(){return Qv(nR,this)}setRefocusDelay(e){Zv(nR,this,e)}setRefocusElementGetter(e){Zv(oR,this,e)}getRefocusElement(){var e;return"function"==typeof Qv(oR,this)?Qv(oR,this).call(this):null===(e=Qv(tR,this).getActiveEditor())||void 0===e?void 0:e.TEXTAREA}focusOnHighlightedCell(e){const t=e=>{var t,r;const n=null===(t=Qv(tR,this).getSelectedRangeLast())||void 0===t?void 0:t.highlight;if(!n)return;let o=Qv(tR,this).runHooks("modifyFocusedElement",n.row,n.col,e);Vw(o)||(o=e),!o||null!==(r=Qv(tR,this).getActiveEditor())&&void 0!==r&&r.isOpened()||o.focus({preventScroll:!0})};e?t(e):Jv(sR,this,lR).call(this,(e=>t(e)))}refocusToEditorTextarea(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Qv(nR,this);var r,n;!Qv(tR,this).getSettings().imeFastEdit||null!==(e=Qv(tR,this).getActiveEditor())&&void 0!==e&&e.isOpened()||(null===(r=Qv(tR,this).getActiveEditor())||void 0===r||null===(n=r.refreshValue)||void 0===n||n.call(r),Qv(iR,this).has(t)||Qv(iR,this).set(t,function(e){let t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,n=null;return function(){for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return n&&clearTimeout(n),n=setTimeout((()=>{t=e.apply(this,i)}),r),t}}((()=>{var e;null===(e=this.getRefocusElement())||void 0===e||e.select()}),t)),Qv(iR,this).get(t)())}}function lR(e){var t;const r=null===(t=Qv(tR,this).getSelectedRangeLast())||void 0===t?void 0:t.highlight;if(!r||!Qv(tR,this).selection.isCellVisible(r))return void e(null);const n=Qv(tR,this).getCell(r.row,r.col,!0);null===n?Qv(tR,this).addHookOnce("afterScroll",(()=>{e(Qv(tR,this).getCell(r.row,r.col,!0))})):e(n)}function uR(){Jv(sR,this,lR).call(this,(e=>{const{activeElement:t}=Qv(tR,this).rootDocument;t&&Pw(t)&&t.blur(),this.focusOnHighlightedCell(e)}))}function hR(){Jv(sR,this,lR).call(this,(e=>{this.getFocusMode()===eR.MIXED&&"TD"===(null==e?void 0:e.nodeName)&&this.refocusToEditorTextarea()}))}function cR(e){"boolean"==typeof e.imeFastEdit&&this.setFocusMode(e.imeFastEdit?eR.MIXED:eR.CELL)}var dR=Zo,pR=Vo,mR=cs("match"),gR=Ws,fR=vo,yR=Qi,wR=ri,ER=function(){var e=gR(this),t="";return e.hasIndices&&(t+="d"),e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.unicodeSets&&(t+="v"),e.sticky&&(t+="y"),t},vR=RegExp.prototype,RR=xo,SR=Xi,TR=Math.floor,CR=RR("".charAt),bR=RR("".replace),NR=RR("".slice),AR=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,IR=/\$([$&'`]|\d{1,2})/g,OR=au,MR=vo,_R=xo,xR=zo,LR=qo,FR=Wo,PR=function(e){var t;return dR(e)&&(void 0!==(t=e[mR])?!!t:"RegExp"===pR(e))},VR=Uu,HR=Mi,DR=function(e){var t=e.flags;return void 0!==t||"flags"in vR||yR(e,"flags")||!wR(vR,e)?t:fR(ER,e)},UR=function(e,t,r,n,o,i){var s=r+e.length,a=n.length,l=IR;return void 0!==o&&(o=SR(o),l=AR),bR(i,l,(function(i,l){var u;switch(CR(l,0)){case"$":return"$";case"&":return e;case"`":return NR(t,0,r);case"'":return NR(t,s);case"<":u=o[NR(l,1,-1)];break;default:var h=+l;if(0===h)return i;if(h>a){var c=TR(h/10);return 0===c?i:c<=a?void 0===n[c-1]?CR(l,1):n[c-1]+CR(l,1):i}u=n[h-1]}return void 0===u?"":u}))},kR=cs("replace"),BR=TypeError,WR=_R("".indexOf);_R("".replace);var GR=_R("".slice),jR=Math.max;OR({target:"String",proto:!0},{replaceAll:function(e,t){var r,n,o,i,s,a,l,u,h,c=xR(this),d=0,p="";if(!FR(e)){if(PR(e)&&(r=VR(xR(DR(e))),!~WR(r,"g")))throw new BR("`.replaceAll` does not allow non-global regexes");if(n=HR(e,kR))return MR(n,e,c,t)}for(o=VR(c),i=VR(e),(s=LR(t))||(t=VR(t)),a=i.length,l=jR(1,a),u=WR(o,i);-1!==u;)h=s?VR(t(i,u,o)):UR(i,o,u,[],void 0,t),p+=GR(o,d,u)+h,d=u+a,u=u+l>o.length?-1:WR(o,i,u+l);return d<o.length&&(p+=GR(o,d)),p}});var zR=Qm,$R=Ai,YR=Ws,XR=rc,KR=TypeError;au({target:"Iterator",proto:!0,real:!0},{reduce:function(e){YR(this),$R(e);var t=XR(this),r=arguments.length<2,n=r?void 0:arguments[1],o=0;if(zR(t,(function(t){r?(r=!1,n=t):n=e(n,t,o),o++}),{IS_RECORD:!0}),r)throw new KR("Reduce of empty iterator with no initial value");return n}});function qR(e){const t=e.hasColHeaders(),r=e.hasRowHeaders(),n=[t?-1:0,r?-1:0,e.countRows()-1,e.countCols()-1],o=e.getData(...n),i=o.length,s=i>0?o[0].length:0,a=["<table>","</table>"],l=t?["<thead>","</thead>"]:[],u=["<tbody>","</tbody>"],h=r?1:0,c=t?1:0;for(let d=0;d<i;d+=1){const n=t&&0===d,i=[];for(let t=0;t<s;t+=1){const s=!n&&r&&0===t;let a="";if(n)a=`<th>${e.getColHeader(t-h)}</th>`;else if(s)a=`<th>${e.getRowHeader(d-c)}</th>`;else{const r=o[d][t],{hidden:n,rowspan:i,colspan:s}=e.getCellMeta(d-c,t-h);if(!n){const e=[];if(i&&e.push(`rowspan="${i}"`),s&&e.push(`colspan="${s}"`),Ay(r))a=`<td ${e.join(" ")}></td>`;else{const t=r.toString().replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,"<br>\r\n").replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");a=`<td ${e.join(" ")}>${t}</td>`}}}i.push(a)}const a=["<tr>",...i,"</tr>"].join("");n?l.splice(1,0,a):u.splice(-1,0,a)}return a.splice(1,0,l.join(""),u.join("")),a.join("")}function QR(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];const r=typeof e;if("number"===r)return!isNaN(e)&&isFinite(e);if("string"===r){if(0===e.length)return!1;if(1===e.length)return/\d/.test(e);const r=Array.from(new Set([".",...t])).map((e=>`\\${e}`)).join("|");return new RegExp(`^[+-]?(((${r})?\\d+((${r})\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$`,"i").test(e.trim())}return"object"===r&&!(!e||"number"!=typeof e.valueOf()||e instanceof Date)}function ZR(e,t,r){let n=-1;for("function"==typeof t?(r=t,t=e):n=e-1;++n<=t&&!1!==r(n););}function JR(e,t,r){let n=e+1;for("function"==typeof t&&(r=t,t=0);--n>=t&&!1!==r(n););}function eS(e,t,r){return Math.min(e,t)===e?t:Math.max(e,r)===e?r:e}new RegExp(Object.keys({"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"}).map((e=>`(${e})`)).join("|"),"gi");const tS="asc",rS=new Map([[tS,[-1,1]],["desc",[1,-1]]]),nS=e=>`The priority '${e}' is already declared in a map.`,oS=e=>`The priority '${e}' is not a number.`;const iS=e=>`The id '${e}' is already declared in a map.`;function sS(){let{errorIdExists:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=new Map;function r(){return[...t]}function n(e){return t.has(e)}return e=Hw(e)?e:iS,{addItem:function(r,o){if(n(r))throw new Error(e(r));t.set(r,o)},clear:function(){t.clear()},getId:function(e){const[t]=r().find((t=>{let[r,n]=t;return e===n&&r}))||[null];return t},getItem:function(e){return t.get(e)},getItems:r,hasItem:n,removeItem:function(e){return t.delete(e)}}}const aS=e=>`'${e}' value is already declared in a unique set.`;const lS=e=>`There is already registered "${e}" plugin.`,uS=function(){let{errorPriorityExists:e,errorPriorityNaN:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const r=new Map;return e=Hw(e)?e:nS,t=Hw(t)?t:oS,{addItem:function(n,o){if(!QR(n))throw new Error(t(n));if(r.has(n))throw new Error(e(n));r.set(n,o)},getItems:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:tS;const[t,n]=rS.get(e)||rS.get(tS);return[...r].sort(((e,r)=>e[0]<r[0]?t:n)).map((e=>e[1]))}}}({errorPriorityExists:e=>`There is already registered plugin on priority "${e}".`,errorPriorityNaN:e=>`The priority "${e}" is not a number.`}),hS=function(){let{errorItemExists:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=new Set;return e=Hw(e)?e:aS,{addItem:function(r){if(t.has(r))throw new Error(e(r));t.add(r)},clear:function(){t.clear()},getItems:function(){return[...t]}}}({errorItemExists:lS}),cS=sS({errorIdExists:lS});const{register:dS,getItem:pS,hasItem:mS,getNames:gS,getValues:fS}=Iv("renderers");function yS(e){if("function"==typeof e)return e;if(!mS(e))throw Error(`No registered renderer found under "${e}" name`);return pS(e)}const{register:wS,getItem:ES,hasItem:vS,getNames:RS,getValues:SS}=Iv("validators");var TS=Xi,CS=wl,bS=cl,NS=JE;au({target:"Array",proto:!0},{at:function(e){var t=TS(this),r=CS(t),n=bS(e),o=n>=0?n:r+n;return o<0||o>=r?void 0:t[o]}}),NS("at");var AS=au,IS=zo,OS=cl,MS=Uu,_S=go,xS=xo("".charAt);function LS(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}AS({target:"String",proto:!0,forced:_S((function(){return"\ud842"!=="𠮷".at(-2)}))},{at:function(e){var t=MS(IS(this)),r=t.length,n=OS(e),o=n>=0?n:r+n;return o<0||o>=r?void 0:xS(t,o)}});class FS{constructor(){LS(this,"count",0),LS(this,"startColumn",null),LS(this,"endColumn",null),LS(this,"startPosition",null),LS(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,t){const{totalCalculatedWidth:r,zeroBasedScrollOffset:n,viewportWidth:o,columnWidth:i}=t;r>=n&&r+i<=n+(n>0?o+1:o)&&(null!==this.startColumn&&void 0!==this.startColumn||(this.startColumn=e),this.endColumn=e)}finalize(e){var t;const{scrollOffset:r,viewportWidth:n,inlineStartOffset:o,zeroBasedScrollOffset:i,totalColumns:s,needReverse:a,startPositions:l,columnWidth:u}=e;if(this.endColumn===s-1&&a)for(this.startColumn=this.endColumn;this.startColumn>0;){const e=l[this.endColumn]+u-l[this.startColumn-1];if(e<=n&&(this.startColumn-=1),e>=n)break}this.startPosition=null!==(t=l[this.startColumn])&&void 0!==t?t:null;const h=r+n-(i>0?n+1:n),c=null===this.startColumn?0:e.getColumnWidth(this.startColumn);h<-1*o||r>l.at(-1)||-1*r-n>-1*c?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,s<this.endColumn&&(this.endColumn=s-1),null!==this.startColumn&&(this.count=this.endColumn-this.startColumn+1)}}function PS(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class VS{constructor(){PS(this,"count",0),PS(this,"startRow",null),PS(this,"endRow",null),PS(this,"startPosition",null),PS(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,t){const{totalCalculatedHeight:r,zeroBasedScrollOffset:n,innerViewportHeight:o,rowHeight:i}=t;r>=n&&r+i<=o&&(null===this.startRow&&(this.startRow=e),this.endRow=e)}finalize(e){var t;const{scrollOffset:r,viewportHeight:n,horizontalScrollbarHeight:o,totalRows:i,needReverse:s,startPositions:a,rowHeight:l}=e;if(this.endRow===i-1&&s)for(this.startRow=this.endRow;this.startRow>0;){const e=a[this.endRow]+l-a[this.startRow-1];if(e<=n-o&&(this.startRow-=1),e>=n-o)break}this.startPosition=null!==(t=a[this.startRow])&&void 0!==t?t:null;r+n-o<(null===this.startRow?0:e.getRowHeight(this.startRow))||r>a.at(-1)?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,i<this.endRow&&(this.endRow=i-1),null!==this.startRow&&(this.count=this.endRow-this.startRow+1)}}function HS(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class DS{constructor(){HS(this,"count",0),HS(this,"startColumn",null),HS(this,"endColumn",null),HS(this,"startPosition",null),HS(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,t){const{totalCalculatedWidth:r,zeroBasedScrollOffset:n,viewportWidth:o}=t;r<=n&&(this.startColumn=e);r>=n&&r<=n+(n>0?o+1:o)&&(null!==this.startColumn&&void 0!==this.startColumn||(this.startColumn=e)),this.endColumn=e}finalize(e){var t;const{scrollOffset:r,viewportWidth:n,inlineStartOffset:o,zeroBasedScrollOffset:i,totalColumns:s,needReverse:a,startPositions:l,columnWidth:u}=e;if(this.endColumn===s-1&&a)for(this.startColumn=this.endColumn;this.startColumn>0;){const e=l[this.endColumn]+u-l[this.startColumn-1];if(this.startColumn-=1,e>n)break}this.startPosition=null!==(t=l[this.startColumn])&&void 0!==t?t:null;r+n-(i>0?n+1:n)<-1*o||r>l.at(-1)+u||-1*r-n>0?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,s<this.endColumn&&(this.endColumn=s-1),null!==this.startColumn&&(this.count=this.endColumn-this.startColumn+1)}}function US(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class kS{constructor(){US(this,"count",0),US(this,"startRow",null),US(this,"endRow",null),US(this,"startPosition",null),US(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,t){const{totalCalculatedHeight:r,zeroBasedScrollOffset:n,innerViewportHeight:o}=t;r<=n&&(this.startRow=e),r>=n&&r<=o&&null===this.startRow&&(this.startRow=e),this.endRow=e}finalize(e){var t;const{scrollOffset:r,viewportHeight:n,horizontalScrollbarHeight:o,totalRows:i,needReverse:s,startPositions:a,rowHeight:l}=e;if(this.endRow===i-1&&s)for(this.startRow=this.endRow;this.startRow>0;){const e=a[this.endRow]+l-a[this.startRow-1];if(this.startRow-=1,e>=n-o)break}this.startPosition=null!==(t=a[this.startRow])&&void 0!==t?t:null;r+n-o<0||r>a.at(-1)+l?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,i<this.endRow&&(this.endRow=i-1),null!==this.startRow&&(this.count=this.endRow-this.startRow+1)}}function BS(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class WS{constructor(){BS(this,"count",0),BS(this,"startColumn",0),BS(this,"endColumn",0),BS(this,"startPosition",0),BS(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalColumns:t}=e;this.count=t,this.endColumn=this.count-1}process(){}finalize(){}}function GS(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class jS{constructor(){GS(this,"count",0),GS(this,"startRow",0),GS(this,"endRow",0),GS(this,"startPosition",0),GS(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalRows:t}=e;this.count=t,this.endRow=this.count-1}process(){}finalize(){}}function zS(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class $S extends DS{constructor(){super(...arguments),zS(this,"columnStartOffset",0),zS(this,"columnEndOffset",0)}finalize(e){var t;super.finalize(e);const{overrideFn:r,totalColumns:n,startPositions:o}=e;if(null!==this.startColumn&&"function"==typeof r){const e=this.startColumn,t=this.endColumn;r(this),this.columnStartOffset=e-this.startColumn,this.columnEndOffset=this.endColumn-t}this.startColumn<0&&(this.startColumn=0),this.startPosition=null!==(t=o[this.startColumn])&&void 0!==t?t:null,n<this.endColumn&&(this.endColumn=n-1),null!==this.startColumn&&(this.count=this.endColumn-this.startColumn+1)}}function YS(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class XS extends kS{constructor(){super(...arguments),YS(this,"rowStartOffset",0),YS(this,"rowEndOffset",0)}finalize(e){var t;super.finalize(e);const{overrideFn:r,totalRows:n,startPositions:o}=e;if(null!==this.startRow&&"function"==typeof r){const e=this.startRow,t=this.endRow;r(this),this.rowStartOffset=e-this.startRow,this.rowEndOffset=this.endRow-t}this.startRow<0&&(this.startRow=0),this.startPosition=null!==(t=o[this.startRow])&&void 0!==t?t:null,n<this.endRow&&(this.endRow=n-1),null!==this.startRow&&(this.count=this.endRow-this.startRow+1)}}function KS(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class qS{constructor(e){KS(this,"calculationTypes",[]),KS(this,"calculationResults",new Map),this.calculationTypes=e}_initialize(e){this.calculationTypes.forEach((t=>{let[r,n]=t;this.calculationResults.set(r,n),n.initialize(e)}))}_process(e,t){this.calculationTypes.forEach((r=>{let[,n]=r;return n.process(e,t)}))}_finalize(e){this.calculationTypes.forEach((t=>{let[,r]=t;return r.finalize(e)}))}getResultsFor(e){return this.calculationResults.get(e)}}function QS(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const ZS=50;class JS extends qS{constructor(e){let{calculationTypes:t,viewportWidth:r,scrollOffset:n,totalColumns:o,columnWidthFn:i,overrideFn:s,inlineStartOffset:a}=e;super(t),QS(this,"viewportWidth",0),QS(this,"scrollOffset",0),QS(this,"zeroBasedScrollOffset",0),QS(this,"totalColumns",0),QS(this,"columnWidthFn",null),QS(this,"columnWidth",0),QS(this,"overrideFn",null),QS(this,"inlineStartOffset",0),QS(this,"totalCalculatedWidth",0),QS(this,"startPositions",[]),QS(this,"needReverse",!0),this.viewportWidth=r,this.scrollOffset=n,this.zeroBasedScrollOffset=Math.max(n,0),this.totalColumns=o,this.columnWidthFn=i,this.overrideFn=s,this.inlineStartOffset=a,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalColumns;e++)if(this.columnWidth=this.getColumnWidth(e),this._process(e,this),this.startPositions.push(this.totalCalculatedWidth),this.totalCalculatedWidth+=this.columnWidth,this.totalCalculatedWidth>=this.zeroBasedScrollOffset+this.viewportWidth){this.needReverse=!1;break}this._finalize(this)}getColumnWidth(e){const t=this.columnWidthFn(e);return isNaN(t)?ZS:t}}function eT(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class tT extends qS{constructor(e){let{calculationTypes:t,viewportHeight:r,scrollOffset:n,totalRows:o,defaultRowHeight:i,rowHeightFn:s,overrideFn:a,horizontalScrollbarHeight:l}=e;super(t),eT(this,"viewportHeight",0),eT(this,"scrollOffset",0),eT(this,"zeroBasedScrollOffset",0),eT(this,"totalRows",0),eT(this,"rowHeightFn",null),eT(this,"rowHeight",0),eT(this,"overrideFn",null),eT(this,"horizontalScrollbarHeight",0),eT(this,"innerViewportHeight",0),eT(this,"totalCalculatedHeight",0),eT(this,"startPositions",[]),eT(this,"needReverse",!0),this.defaultHeight=i,this.viewportHeight=r,this.scrollOffset=n,this.zeroBasedScrollOffset=Math.max(n,0),this.totalRows=o,this.rowHeightFn=s,this.overrideFn=a,this.horizontalScrollbarHeight=null!=l?l:0,this.innerViewportHeight=this.zeroBasedScrollOffset+this.viewportHeight-this.horizontalScrollbarHeight,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalRows;e++)if(this.rowHeight=this.getRowHeight(e),this._process(e,this),this.startPositions.push(this.totalCalculatedHeight),this.totalCalculatedHeight+=this.rowHeight,this.totalCalculatedHeight>=this.innerViewportHeight){this.needReverse=!1;break}this._finalize(this)}getRowHeight(e){const t=this.rowHeightFn(e);return isNaN(t)?this.defaultHeight:t}}function rT(e,t,r){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,r)}function nT(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function oT(e,t){return e.get(sT(e,t))}function iT(e,t,r){return e.set(sT(e,t),r),r}function sT(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var aT=new WeakMap;class lT{constructor(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];nT(this,"row",null),nT(this,"col",null),rT(this,aT,!1),iT(aT,this,r),void 0!==e&&void 0!==t&&(this.row=e,this.col=t)}isValid(e){const{countRows:t,countCols:r,countRowHeaders:n,countColHeaders:o}={countRows:0,countCols:0,countRowHeaders:0,countColHeaders:0,...e};return!(!Number.isInteger(this.row)||!Number.isInteger(this.col))&&(!(this.row<-o||this.col<-n)&&!(this.row>=t||this.col>=r))}isEqual(e){return e===this||this.row===e.row&&this.col===e.col}isHeader(){return!this.isCell()}isCell(){return this.row>=0&&this.col>=0}isRtl(){return oT(aT,this)}isSouthEastOf(e){return this.row>=e.row&&(oT(aT,this)?this.col<=e.col:this.col>=e.col)}isNorthWestOf(e){return this.row<=e.row&&(oT(aT,this)?this.col>=e.col:this.col<=e.col)}isSouthWestOf(e){return this.row>=e.row&&(oT(aT,this)?this.col>=e.col:this.col<=e.col)}isNorthEastOf(e){return this.row<=e.row&&(oT(aT,this)?this.col<=e.col:this.col>=e.col)}normalize(){return this.row=null===this.row?this.row:Math.max(this.row,0),this.col=null===this.col?this.col:Math.max(this.col,0),this}assign(e){return Number.isInteger(null==e?void 0:e.row)&&(this.row=e.row),Number.isInteger(null==e?void 0:e.col)&&(this.col=e.col),e instanceof lT&&iT(aT,this,e.isRtl()),this}clone(){return new lT(this.row,this.col,oT(aT,this))}toObject(){return{row:this.row,col:this.col}}}const uT=lT;function hT(e,t,r){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,r)}function cT(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function dT(e,t){return e.get(pT(e,t))}function pT(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var mT=new WeakMap;class gT{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e,n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];var o,i,s;cT(this,"highlight",null),cT(this,"from",null),cT(this,"to",null),hT(this,mT,!1),this.highlight=e.clone(),this.from=t.clone(),this.to=r.clone(),i=this,s=n,(o=mT).set(pT(o,i),s)}setHighlight(e){return this.highlight=e.clone(),this}setFrom(e){return this.from=e.clone(),this}setTo(e){return this.to=e.clone(),this}isValid(e){return this.from.isValid(e)&&this.to.isValid(e)}isSingle(){return this.isSingleCell()||this.isSingleHeader()}isSingleCell(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}isSingleHeader(){return(this.from.row<0||this.from.col<0)&&this.from.row===this.to.row&&this.from.col===this.to.col}isHeader(){return!(!this.from.isHeader()||!this.to.isHeader())||(this.from.col<0&&this.to.col<0||this.from.row<0&&this.to.row<0)}containsHeaders(){return this.from.isHeader()||this.to.isHeader()}getOuterHeight(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}getOuterWidth(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}getHeight(){if(this.from.row<0&&this.to.row<0)return 0;const e=Math.max(this.from.row,0),t=Math.max(this.to.row,0);return Math.max(e,t)-Math.min(e,t)+1}getWidth(){if(this.from.col<0&&this.to.col<0)return 0;const e=Math.max(this.from.col,0),t=Math.max(this.to.col,0);return Math.max(e,t)-Math.min(e,t)+1}getCellsCount(){return this.getWidth()*this.getHeight()}includes(e){const{row:t,col:r}=e,n=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner();return n.row<=t&&o.row>=t&&n.col<=r&&o.col>=r}includesRange(e){return this.includes(e.getOuterTopStartCorner())&&this.includes(e.getOuterBottomEndCorner())}isEqual(e){return Math.min(this.from.row,this.to.row)===Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(e.from.col,e.to.col)}overlaps(e){return e.isSouthEastOf(this.getOuterTopLeftCorner())&&e.isNorthWestOf(this.getOuterBottomRightCorner())}isSouthEastOf(e){return this.getOuterTopLeftCorner().isSouthEastOf(e)||this.getOuterBottomRightCorner().isSouthEastOf(e)}isNorthWestOf(e){return this.getOuterTopLeftCorner().isNorthWestOf(e)||this.getOuterBottomRightCorner().isNorthWestOf(e)}isOverlappingHorizontally(e){return this.getOuterTopEndCorner().col>=e.getOuterTopStartCorner().col&&this.getOuterTopEndCorner().col<=e.getOuterTopEndCorner().col||this.getOuterTopStartCorner().col<=e.getOuterTopEndCorner().col&&this.getOuterTopStartCorner().col>=e.getOuterTopStartCorner().col}isOverlappingVertically(e){return this.getOuterBottomStartCorner().row>=e.getOuterTopRightCorner().row&&this.getOuterBottomStartCorner().row<=e.getOuterBottomStartCorner().row||this.getOuterTopEndCorner().row<=e.getOuterBottomStartCorner().row&&this.getOuterTopEndCorner().row>=e.getOuterTopRightCorner().row}expand(e){const t=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner();return(e.row<t.row||e.col<t.col||e.row>r.row||e.col>r.col)&&(this.from=this._createCellCoords(Math.min(t.row,e.row),Math.min(t.col,e.col)),this.to=this._createCellCoords(Math.max(r.row,e.row),Math.max(r.col,e.col)),!0)}expandByRange(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.includesRange(e)||!this.overlaps(e))return!1;const r=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),o=this.getDirection(),i=e.getOuterTopStartCorner(),s=e.getOuterBottomEndCorner(),a=Math.min(r.row,i.row),l=Math.min(r.col,i.col),u=Math.max(n.row,s.row),h=Math.max(n.col,s.col),c=this._createCellCoords(a,l),d=this._createCellCoords(u,h);return this.from=c,this.to=d,this.setDirection(o),t&&(this.highlight.row===this.getOuterBottomRightCorner().row&&"N-S"===this.getVerticalDirection()&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&"W-E"===this.getHorizontalDirection()&&this.flipDirectionHorizontally()),!0}getDirection(){return this.from.isNorthWestOf(this.to)?"NW-SE":this.from.isNorthEastOf(this.to)?"NE-SW":this.from.isSouthEastOf(this.to)?"SE-NW":this.from.isSouthWestOf(this.to)?"SW-NE":void 0}setDirection(e){switch(e){case"NW-SE":[this.from,this.to]=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];break;case"NE-SW":[this.from,this.to]=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];break;case"SE-NW":[this.from,this.to]=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];break;case"SW-NE":[this.from,this.to]=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()]}}getVerticalDirection(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}getHorizontalDirection(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}flipDirectionVertically(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE")}}flipDirectionHorizontally(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW")}}getTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getTopLeftCorner(){return dT(mT,this)?this.getTopEndCorner():this.getTopStartCorner()}getBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getBottomRightCorner(){return dT(mT,this)?this.getBottomStartCorner():this.getBottomEndCorner()}getTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getTopRightCorner(){return dT(mT,this)?this.getTopStartCorner():this.getTopEndCorner()}getBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getBottomLeftCorner(){return dT(mT,this)?this.getBottomEndCorner():this.getBottomStartCorner()}getOuterTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterTopLeftCorner(){return dT(mT,this)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}getOuterBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterBottomRightCorner(){return dT(mT,this)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}getOuterTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterTopRightCorner(){return dT(mT,this)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}getOuterBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterBottomLeftCorner(){return dT(mT,this)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}isCorner(e){return e.isEqual(this.getOuterTopLeftCorner())||e.isEqual(this.getOuterTopRightCorner())||e.isEqual(this.getOuterBottomLeftCorner())||e.isEqual(this.getOuterBottomRightCorner())}getOppositeCorner(e){return e instanceof uT&&(e.isEqual(this.getOuterBottomEndCorner())?this.getOuterTopStartCorner():e.isEqual(this.getOuterTopStartCorner())?this.getOuterBottomEndCorner():e.isEqual(this.getOuterTopEndCorner())?this.getOuterBottomStartCorner():e.isEqual(this.getOuterBottomStartCorner())?this.getOuterTopEndCorner():void 0)}getBordersSharedWith(e){if(!this.includesRange(e))return[];const t=Math.min(this.from.row,this.to.row),r=Math.max(this.from.row,this.to.row),n=Math.min(this.from.col,this.to.col),o=Math.max(this.from.col,this.to.col),i=Math.min(e.from.row,e.to.row),s=Math.max(e.from.row,e.to.row),a=Math.min(e.from.col,e.to.col),l=Math.max(e.from.col,e.to.col),u=[];return t===i&&u.push("top"),o===l&&u.push(dT(mT,this)?"left":"right"),r===s&&u.push("bottom"),n===a&&u.push(dT(mT,this)?"right":"left"),u}getInner(){const e=this.getOuterTopStartCorner(),t=this.getOuterBottomEndCorner(),r=[];for(let n=e.row;n<=t.row;n++)for(let o=e.col;o<=t.col;o++)this.from.row===n&&this.from.col===o||this.to.row===n&&this.to.col===o||r.push(this._createCellCoords(n,o));return r}getAll(){const e=this.getOuterTopStartCorner(),t=this.getOuterBottomEndCorner(),r=[];for(let n=e.row;n<=t.row;n++)for(let o=e.col;o<=t.col;o++)e.row===n&&e.col===o?r.push(e):t.row===n&&t.col===o?r.push(t):r.push(this._createCellCoords(n,o));return r}forAll(e){const t=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner();for(let n=t.row;n<=r.row;n++)for(let o=t.col;o<=r.col;o++){if(!1===e(n,o))return}}clone(){return new gT(this.highlight,this.from,this.to,dT(mT,this))}toObject(){return{from:this.from.toObject(),to:this.to.toObject()}}_createCellCoords(e,t){return new uT(e,t,dT(mT,this))}}const fT=gT;function yT(e,t,r){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,r)}function wT(e,t){return e.get(vT(e,t))}function ET(e,t,r){return e.set(vT(e,t),r),r}function vT(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var RT=new WeakMap,ST=new WeakMap,TT=new WeakMap,CT=new WeakMap,bT=new WeakMap,NT=new WeakMap,AT=new WeakMap,IT=new WeakMap,OT=new WeakMap,MT=new WeakMap;const _T=class{constructor(e,t,r,n,o,i){let s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;yT(this,RT,void 0),yT(this,ST,void 0),yT(this,TT,void 0),yT(this,CT,void 0),yT(this,bT,void 0),yT(this,NT,void 0),yT(this,AT,void 0),yT(this,IT,void 0),yT(this,OT,[null,null]),yT(this,MT,[null,null]),ET(RT,this,r),ET(ST,this,t),ET(TT,this,o),ET(CT,this,i),ET(bT,this,s),ET(NT,this,n),ET(AT,this,e),this.registerEvents()}registerEvents(){wT(NT,this).addEventListener(wT(TT,this).holder,"contextmenu",(e=>this.onContextMenu(e))),wT(NT,this).addEventListener(wT(TT,this).TABLE,"mouseover",(e=>this.onMouseOver(e))),wT(NT,this).addEventListener(wT(TT,this).TABLE,"mouseout",(e=>this.onMouseOut(e)));const e=()=>{wT(NT,this).addEventListener(wT(TT,this).holder,"touchstart",(e=>this.onTouchStart(e))),wT(NT,this).addEventListener(wT(TT,this).holder,"touchend",(e=>this.onTouchEnd(e))),this.momentumScrolling||(this.momentumScrolling={}),wT(NT,this).addEventListener(wT(TT,this).holder,"scroll",(()=>{clearTimeout(this.momentumScrolling._timeout),this.momentumScrolling.ongoing||wT(RT,this).getSetting("onBeforeTouchScroll"),this.momentumScrolling.ongoing=!0,this.momentumScrolling._timeout=setTimeout((()=>{this.touchApplied||(this.momentumScrolling.ongoing=!1,wT(RT,this).getSetting("onAfterMomentumScroll"))}),200)}))},t=()=>{wT(NT,this).addEventListener(wT(TT,this).holder,"mouseup",(e=>this.onMouseUp(e))),wT(NT,this).addEventListener(wT(TT,this).holder,"mousedown",(e=>this.onMouseDown(e)))};LE()?e():("ontouchstart"in window&&e(),t())}selectedCellWasTouched(e){const t=this.parentCell(e).coords;if(wT(IT,this)&&t){const[e,r]=[t.row,wT(IT,this).from.row],[n,o]=[t.col,wT(IT,this).from.col];return e===r&&n===o}return!1}parentCell(e){const t={},r=ew(e,["TD","TH"],wT(TT,this).TABLE);return r?(t.coords=wT(TT,this).getCoords(r),t.TD=r):iw(e,"wtBorder")&&iw(e,"current")?(t.coords=wT(CT,this).getFocusSelection().cellRange.highlight,t.TD=wT(TT,this).getCell(t.coords)):iw(e,"wtBorder")&&iw(e,"area")&&wT(CT,this).getAreaSelection().cellRange&&(t.coords=wT(CT,this).getAreaSelection().cellRange.to,t.TD=wT(TT,this).getCell(t.coords)),t}onMouseDown(e){const t=wT(ST,this).rootDocument.activeElement,r=function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e.apply(this,r.concat(n))}}(Qy,e.target),n=e.target;if(!["TD","TH"].includes(t.nodeName)&&(n===t||r(0)===t||r(1)===t))return;const o=this.parentCell(n);iw(n,"corner")?wT(RT,this).getSetting("onCellCornerMouseDown",e,n):o.TD&&wT(RT,this).has("onCellMouseDown")&&this.callListener("onCellMouseDown",e,o.coords,o.TD),(0===e.button||this.touchApplied)&&o.TD&&(wT(MT,this)[0]=o.TD,clearTimeout(wT(OT,this)[0]),wT(OT,this)[0]=setTimeout((()=>{wT(MT,this)[0]=null}),1e3))}onContextMenu(e){if(wT(RT,this).has("onCellContextMenu")){const t=this.parentCell(e.target);t.TD&&this.callListener("onCellContextMenu",e,t.coords,t.TD)}}onMouseOver(e){if(!wT(RT,this).has("onCellMouseOver"))return;const t=wT(TT,this).TABLE,r=ew(e.target,["TD","TH"],t),n=wT(bT,this)||this;r&&r!==n.lastMouseOver&&tw(r,t)&&(n.lastMouseOver=r,this.callListener("onCellMouseOver",e,wT(TT,this).getCoords(r),r))}onMouseOut(e){if(!wT(RT,this).has("onCellMouseOut"))return;const t=wT(TT,this).TABLE,r=ew(e.target,["TD","TH"],t),n=ew(e.relatedTarget,["TD","TH"],t),o=wT(bT,this)||this;r&&r!==n&&tw(r,t)&&(this.callListener("onCellMouseOut",e,wT(TT,this).getCoords(r),r),null===n&&(o.lastMouseOver=null))}onMouseUp(e){const t=this.parentCell(e.target);t.TD&&wT(RT,this).has("onCellMouseUp")&&this.callListener("onCellMouseUp",e,t.coords,t.TD),(0===e.button||this.touchApplied)&&(t.TD===wT(MT,this)[0]&&t.TD===wT(MT,this)[1]?(iw(e.target,"corner")?this.callListener("onCellCornerDblClick",e,t.coords,t.TD):this.callListener("onCellDblClick",e,t.coords,t.TD),wT(MT,this)[0]=null,wT(MT,this)[1]=null):t.TD===wT(MT,this)[0]&&(wT(MT,this)[1]=t.TD,clearTimeout(wT(OT,this)[1]),wT(OT,this)[1]=setTimeout((()=>{wT(MT,this)[1]=null}),500)))}onTouchStart(e){ET(IT,this,wT(CT,this).getFocusSelection().cellRange),this.touchApplied=!0,this.onMouseDown(e)}onTouchEnd(e){var t;const r=e.target,n=null===(t=this.parentCell(r))||void 0===t?void 0:t.coords,o=by(n)&&n.row>=0&&n.col>=0;if(e.cancelable&&o&&wT(RT,this).getSetting("isDataViewInstance")){const t=["A","BUTTON","INPUT"];FE()&&(ME.chromeWebKit.value||ME.firefoxWebKit.value)&&this.selectedCellWasTouched(r)&&!t.includes(r.tagName)?e.preventDefault():this.selectedCellWasTouched(r)||e.preventDefault()}this.onMouseUp(e),this.touchApplied=!1}callListener(e,t,r,n){const o=wT(RT,this).getSettingPure(e);o&&o(t,r,n,wT(AT,this).call(this))}destroy(){clearTimeout(wT(OT,this)[0]),clearTimeout(wT(OT,this)[1]),wT(NT,this).destroy()}};function xT(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const LT=class{constructor(e,t,r){xT(this,"offset",void 0),xT(this,"total",void 0),xT(this,"countTH",void 0),this.offset=e,this.total=t,this.countTH=r}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleRowHeadedColumnToSourceColumn(e){return this.renderedToSource(this.offsettedTH(e))}sourceColumnToVisibleRowHeadedColumn(e){return this.unOffsettedTH(this.sourceToRendered(e))}};function FT(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const PT=class{constructor(e,t,r){FT(this,"offset",void 0),FT(this,"total",void 0),FT(this,"countTH",void 0),this.offset=e,this.total=t,this.countTH=r}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleColHeadedRowToSourceRow(e){return this.renderedToSource(this.offsettedTH(e))}sourceRowToVisibleColHeadedRow(e){return this.unOffsettedTH(this.sourceToRendered(e))}};function VT(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class HT{constructor(){VT(this,"currentSize",0),VT(this,"nextSize",0),VT(this,"currentOffset",0),VT(this,"nextOffset",0)}setSize(e){this.currentSize=this.nextSize,this.nextSize=e}setOffset(e){this.currentOffset=this.nextOffset,this.nextOffset=e}}function DT(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class UT{constructor(){DT(this,"size",new HT),DT(this,"workingSpace",0),DT(this,"sharedSize",null)}setSize(e){this.size.setSize(e)}setOffset(e){this.size.setOffset(e)}getViewSize(){return this.size}isShared(){return null!==this.sharedSize}isPlaceOn(e){return this.workingSpace===e}append(e){this.workingSpace=1,e.workingSpace=2,this.sharedSize=e.getViewSize()}prepend(e){this.workingSpace=2,e.workingSpace=1,this.sharedSize=e.getViewSize()}}var kT=Ti,BT=TypeError,WT=au,GT=Xi,jT=wl,zT=Ah,$T=function(e,t){if(!delete e[t])throw new BT("Cannot delete property "+kT(t)+" of "+kT(e))},YT=Oh,XT=1!==[].unshift(0)||!function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(e){return e instanceof TypeError}}();function KT(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}WT({target:"Array",proto:!0,arity:1,forced:XT},{unshift:function(e){var t=GT(this),r=jT(t),n=arguments.length;if(n){YT(r+n);for(var o=r;o--;){var i=o+n;o in t?t[i]=t[o]:$T(t,i)}for(var s=0;s<n;s++)t[s]=arguments[s]}return zT(t,r+n)}});class qT{constructor(e,t){KT(this,"order",[]),this.order=[...Array(t).keys()].map((t=>e+t))}get length(){return this.order.length}has(e){return this.order.indexOf(e)>-1}get(e){return e<this.order.length?this.order[e]:-1}remove(e){this.order.splice(this.order.indexOf(e),1)}prepend(e){return this.order.unshift(e),this.order.pop()}}function QT(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class ZT{constructor(e){QT(this,"sizeSet",void 0),this.sizeSet=e}diff(){const{sizeSet:e}=this,{currentSize:t,nextSize:r}=e.getViewSize();let n=Math.max(r,t);if(0===n)return[];const{currentOffset:o,nextOffset:i}=e.getViewSize(),s=new qT(o,t),a=new qT(i,r),l=[];for(let u=0;u<n;u++){const t=s.get(u),o=a.get(u);if(-1===o)l.push(["remove",t]);else if(-1===t)!e.isShared()||e.isShared()&&e.isPlaceOn(2)?l.push(["append",o]):l.push(["prepend",o]);else if(o>t)s.has(o)&&(s.remove(o),r<=s.length&&(n-=1)),l.push(["replace",o,t]);else if(o<t){const e=s.prepend(o);l.push(["insert_before",o,t,e])}else l.push(["none",o])}return l}}function JT(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class eC{constructor(e,t){JT(this,"rootNode",void 0),JT(this,"nodesPool",void 0),JT(this,"sizeSet",new UT),JT(this,"collectedNodes",[]),JT(this,"viewDiffer",new ZT(this.sizeSet)),JT(this,"leads",[]),this.rootNode=e,this.nodesPool=t}setSize(e){return this.sizeSet.setSize(e),this}setOffset(e){return this.sizeSet.setOffset(e),this}isSharedViewSet(){return this.sizeSet.isShared()}getNode(e){return e<this.collectedNodes.length?this.collectedNodes[e]:null}getCurrentNode(){const e=this.collectedNodes.length;return e>0?this.collectedNodes[e-1]:null}applyCommand(e){const{rootNode:t}=this,[r,n,o,i]=e,s=this.nodesPool(n);switch(this.collectedNodes.push(s),r){case"prepend":t.insertBefore(s,t.firstChild);break;case"append":t.appendChild(s);break;case"insert_before":t.insertBefore(s,this.nodesPool(o)),t.removeChild(this.nodesPool(i));break;case"replace":t.replaceChild(s,this.nodesPool(o));break;case"remove":t.removeChild(s)}}start(){this.collectedNodes.length=0,this.leads=this.viewDiffer.diff()}render(){this.leads.length>0&&this.applyCommand(this.leads.shift())}end(){for(;this.leads.length>0;)this.applyCommand(this.leads.shift())}}class tC extends eC{prependView(e){return this.sizeSet.prepend(e.sizeSet),e.sizeSet.append(this.sizeSet),this}appendView(e){return this.sizeSet.append(e.sizeSet),e.sizeSet.prepend(this.sizeSet),this}}function rC(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class nC{constructor(e){rC(this,"nodeType",void 0),rC(this,"pool",new Map),this.nodeType=e.toUpperCase()}setRootDocument(e){this.rootDocument=e}obtain(e,t){const r="number"==typeof t?`${e}x${t}`:e.toString();if(this.pool.has(r))return this.pool.get(r);const n=this.rootDocument.createElement(this.nodeType);return this.pool.set(r,n),n}}function oC(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class iC{constructor(e,t){oC(this,"nodesPool",null),oC(this,"nodeType",void 0),oC(this,"rootNode",void 0),oC(this,"table",null),oC(this,"renderedNodes",0),this.nodesPool="string"==typeof e?new nC(e):null,this.nodeType=e,this.rootNode=t}setTable(e){this.nodesPool&&this.nodesPool.setRootDocument(e.rootDocument),this.table=e}adjust(){}render(){}}function sC(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class aC extends iC{constructor(){super("TH"),sC(this,"orderViews",new WeakMap),sC(this,"sourceRowIndex",0)}obtainOrderView(e){let t;return this.orderViews.has(e)?t=this.orderViews.get(e):(t=new tC(e,(e=>this.nodesPool.obtain(this.sourceRowIndex,e))),this.orderViews.set(e,t)),t}render(){const{rowsToRender:e,rowHeaderFunctions:t,rowHeadersCount:r,rows:n,cells:o}=this.table;for(let i=0;i<e;i++){const e=this.table.renderedRowToSource(i),s=n.getRenderedNode(i);this.sourceRowIndex=e;const a=this.obtainOrderView(s),l=o.obtainOrderView(s);a.appendView(l).setSize(r).setOffset(0).start();for(let n=0;n<r;n++){a.render();const r=a.getCurrentNode();r.className="",r.removeAttribute("style"),uw(r,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&lw(r,[["role","rowheader"],["scope","row"],Xy(n+1),Wy(-1)]),t[n](e,r,n)}a.end()}}}class lC extends iC{constructor(e){super(null,e)}adjust(){const{columnHeadersCount:e,rowHeadersCount:t}=this.table;let r=this.rootNode.firstChild;if(e){const{columnsToRender:n}=this.table,o=n+t;for(let t=0,s=e;t<s;t++){for(r=this.rootNode.childNodes[t],r||(r=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(r)),this.renderedNodes=r.childNodes.length;this.renderedNodes<o;)r.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>o;)r.removeChild(r.lastChild),this.renderedNodes-=1}const i=this.rootNode.childNodes.length;if(i>e)for(let t=e;t<i;t++)this.rootNode.removeChild(this.rootNode.lastChild)}else r&&cw(r)}render(){const{columnHeadersCount:e}=this.table;this.table.isAriaEnabled()&&lw(this.rootNode,[["role","rowgroup"]]);for(let t=0;t<e;t+=1){const{columnHeaderFunctions:e,columnsToRender:r,rowHeadersCount:n}=this.table,o=this.rootNode.childNodes[t];this.table.isAriaEnabled()&&lw(o,[["role","row"],Yy(t+1)]);for(let i=-1*n;i<r;i+=1){const r=this.table.renderedColumnToSource(i),s=o.childNodes[i+n];s.className="",s.removeAttribute("style"),uw(s,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&lw(s,[Xy(i+1+this.table.rowHeadersCount),Wy(-1),["role","columnheader"],...i>=0?[["scope","col"]]:[["role","row"]]]),e[t](r,s,t)}}}}let uC=!1;class hC extends iC{constructor(e){super(null,e)}adjust(){const{columnsToRender:e,rowHeadersCount:t}=this.table,r=e+t;for(;this.renderedNodes<r;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>r;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}render(){this.adjust();const{columnsToRender:e,rowHeadersCount:t}=this.table;!uC&&e>1e3&&(uC=!0,WE(Ty`Performance tip: Handsontable rendered more than 1000 visible columns.\x20
        Consider limiting the number of rendered columns by specifying the table width and/or\x20
        turning off the "renderAllColumns" option.`));for(let n=0;n<t;n++){const e=this.table.renderedColumnToSource(n),t=this.table.columnUtils.getHeaderWidth(e);this.rootNode.childNodes[n].style.width=`${t}px`}for(let n=0;n<e;n++){const e=this.table.renderedColumnToSource(n),r=this.table.columnUtils.getWidth(e);this.rootNode.childNodes[n+t].style.width=`${r}px`}const r=this.rootNode.firstChild;r&&sw(r,"rowHeader")}}function cC(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const dC="ht__row_even",pC="ht__row_odd";let mC=!1;class gC extends iC{constructor(e){super("TR",e),cC(this,"orderView",void 0),this.orderView=new eC(e,(e=>this.nodesPool.obtain(e)))}getRenderedNode(e){return this.orderView.getNode(e)}hasStaleContent(e){return this.orderView.hasStaleContent(e)}render(){const{rowsToRender:e}=this.table;!mC&&e>1e3&&(mC=!0,WE(Ty`Performance tip: Handsontable rendered more than 1000 visible rows.\x20
        Consider limiting the number of rendered rows by specifying the table height and/or\x20
        turning off the "renderAllRows" option.`)),this.table.isAriaEnabled()&&lw(this.rootNode,[["role","rowgroup"]]),this.orderView.setSize(e).setOffset(this.table.renderedRowToSource(0)).start();for(let n=0;n<e;n++){this.orderView.render();const e=this.orderView.getCurrentNode(),o=this.table.renderedRowToSource(n);var t,r;if(this.table.isAriaEnabled())lw(e,[["role","row"],Yy(o+(null!==(t=null===(r=this.table.rowUtils)||void 0===r||null===(r=r.dataAccessObject)||void 0===r?void 0:r.columnHeaders.length)&&void 0!==t?t:0)+1)]);(o+1)%2==0?iw(e,dC)||(aw(e,pC),sw(e,dC)):iw(e,pC)||(aw(e,dC),sw(e,pC))}this.orderView.end()}}function fC(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class yC extends iC{constructor(){super("TD"),fC(this,"orderViews",new WeakMap),fC(this,"sourceRowIndex",0)}obtainOrderView(e){let t;return this.orderViews.has(e)?t=this.orderViews.get(e):(t=new tC(e,(e=>this.nodesPool.obtain(this.sourceRowIndex,e)),this.nodeType),this.orderViews.set(e,t)),t}render(){const{rowsToRender:e,columnsToRender:t,rows:r,rowHeaders:n}=this.table;for(let s=0;s<e;s++){const e=this.table.renderedRowToSource(s),a=r.getRenderedNode(s);this.sourceRowIndex=e;const l=this.obtainOrderView(a),u=n.obtainOrderView(a);l.prependView(u).setSize(t).setOffset(0).start();for(let r=0;r<t;r++){l.render();const t=this.table.renderedColumnToSource(r),n=l.getCurrentNode();var o,i;if(iw(n,"hide")||(n.className=""),n.removeAttribute("style"),n.removeAttribute("dir"),uw(n,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.cellRenderer(e,t,n),this.table.isAriaEnabled())lw(n,[...n.hasAttribute("role")?[]:[["role","gridcell"]],Wy(-1),Xy(t+(null!==(o=null===(i=this.table.rowUtils)||void 0===i||null===(i=i.dataAccessObject)||void 0===i?void 0:i.rowHeaders.length)&&void 0!==o?o:0)+1)])}l.end()}}}function wC(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class EC{constructor(e){let{cellRenderer:t,stylesHandler:r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};wC(this,"rootNode",void 0),wC(this,"rootDocument",void 0),wC(this,"rowHeaders",null),wC(this,"columnHeaders",null),wC(this,"colGroup",null),wC(this,"rows",null),wC(this,"cells",null),wC(this,"rowFilter",null),wC(this,"columnFilter",null),wC(this,"rowUtils",null),wC(this,"columnUtils",null),wC(this,"rowsToRender",0),wC(this,"columnsToRender",0),wC(this,"rowHeaderFunctions",[]),wC(this,"rowHeadersCount",0),wC(this,"columnHeaderFunctions",[]),wC(this,"columnHeadersCount",0),wC(this,"cellRenderer",void 0),wC(this,"activeOverlayName",void 0),wC(this,"stylesHandler",void 0),this.rootNode=e,this.rootDocument=this.rootNode.ownerDocument,this.cellRenderer=t,this.stylesHandler=r}setActiveOverlayName(e){this.activeOverlayName=e}setAxisUtils(e,t){this.rowUtils=e,this.columnUtils=t}setViewportSize(e,t){this.rowsToRender=e,this.columnsToRender=t}setFilters(e,t){this.rowFilter=e,this.columnFilter=t}setHeaderContentRenderers(e,t){this.rowHeaderFunctions=e,this.rowHeadersCount=e.length,this.columnHeaderFunctions=t,this.columnHeadersCount=t.length}setRenderers(){let{rowHeaders:e,columnHeaders:t,colGroup:r,rows:n,cells:o}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.setTable(this),t.setTable(this),r.setTable(this),n.setTable(this),o.setTable(this),this.rowHeaders=e,this.columnHeaders=t,this.colGroup=r,this.rows=n,this.cells=o}renderedRowToSource(e){return this.rowFilter.renderedToSource(e)}renderedColumnToSource(e){return this.columnFilter.renderedToSource(e)}isAriaEnabled(){return this.rowUtils.wtSettings.getSetting("ariaTags")}render(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();const{rowsToRender:e,rows:t}=this;for(let r=0;r<e;r++){const e=t.getRenderedNode(r),n=this.rowUtils;if(e.firstChild){const t=this.renderedRowToSource(r),o=n.getHeightByOverlayName(t,this.activeOverlayName),i=this.stylesHandler.areCellsBorderBox()?0:1;e.firstChild.style.height=o?o-i+"px":""}}}}class vC{constructor(){let{TABLE:e,THEAD:t,COLGROUP:r,TBODY:n,rowUtils:o,columnUtils:i,cellRenderer:s,stylesHandler:a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.renderer=new EC(e,{cellRenderer:s,stylesHandler:a}),this.renderer.setRenderers({rowHeaders:new aC,columnHeaders:new lC(t),colGroup:new hC(r),rows:new gC(n),cells:new yC}),this.renderer.setAxisUtils(o,i)}setActiveOverlayName(e){return this.renderer.setActiveOverlayName(e),this}setFilters(e,t){return this.renderer.setFilters(e,t),this}setViewportSize(e,t){return this.renderer.setViewportSize(e,t),this}setHeaderContentRenderers(e,t){return this.renderer.setHeaderContentRenderers(e,t),this}adjust(){this.renderer.adjust()}render(){this.renderer.render()}}function RC(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class SC{constructor(e,t){RC(this,"dataAccessObject",void 0),RC(this,"wtSettings",void 0),RC(this,"headerWidths",new Map),this.dataAccessObject=e,this.wtSettings=t}getWidth(e){return this.wtSettings.getSetting("columnWidth",e)||this.wtSettings.getSetting("defaultColumnWidth")}getHeaderHeight(e){let t=this.dataAccessObject.stylesHandler.getDefaultRowHeight();const r=this.dataAccessObject.wtViewport.oversizedColumnHeaders[e];return void 0!==r&&(t=t?Math.max(t,r):r),t}getHeaderWidth(e){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(e))}calculateWidths(){const{wtSettings:e}=this;let t=e.getSetting("rowHeaderWidth");if(t=e.getSetting("onModifyRowHeaderWidth",t),null!=t){const r=e.getSetting("rowHeaders").length,n=e.getSetting("defaultColumnWidth");for(let e=0;e<r;e++){let r=Array.isArray(t)?t[e]:t;r=null==r?n:r,this.headerWidths.set(e,r)}}}}function TC(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class CC{constructor(e,t){TC(this,"dataAccessObject",void 0),TC(this,"wtSettings",void 0),this.dataAccessObject=e,this.wtSettings=t}getHeight(e){let t=this.wtSettings.getSetting("rowHeight",e);const r=this.dataAccessObject.wtViewport.oversizedRows[e];return void 0!==r&&(t=void 0===t?r:Math.max(t,r)),t}getHeightByOverlayName(e,t){let r=this.wtSettings.getSetting("rowHeightByOverlayName",e,t);const n=this.dataAccessObject.wtViewport.oversizedRows[e];return void 0!==n&&(r=void 0===r?n:Math.max(r,n)),r}}function bC(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const NC=class{constructor(e,t,r,n,o){bC(this,"wtSettings",null),bC(this,"domBindings",void 0),bC(this,"TBODY",null),bC(this,"THEAD",null),bC(this,"COLGROUP",null),bC(this,"hasTableHeight",!0),bC(this,"hasTableWidth",!0),bC(this,"isTableVisible",!1),bC(this,"tableOffset",0),bC(this,"holderOffset",0),this.domBindings=r,this.isMaster="master"===o,this.name=o,this.dataAccessObject=e,this.facadeGetter=t,this.wtSettings=n,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=r.rootTable,hw(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;const i=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",(()=>this._modifyRowHeaderWidth(i))),this.rowUtils=new CC(this.dataAccessObject,this.wtSettings),this.columnUtils=new SC(this.dataAccessObject,this.wtSettings),this.tableRenderer=new vC({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer"),stylesHandler:this.dataAccessObject.stylesHandler})}is(e){return this.name===e}fixTableDomTree(){const e=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=e.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=e.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=e.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}createSpreader(e){const t=e.parentNode;let r;return t&&t.nodeType===Node.ELEMENT_NODE&&iw(t,"wtHolder")||(r=this.domBindings.rootDocument.createElement("div"),r.className="wtSpreader",t&&t.insertBefore(r,e),r.appendChild(e)),r.style.position="relative",this.wtSettings.getSetting("ariaTags")&&lw(r,[Gy()]),r}createHider(e){const t=e.parentNode;let r;return t&&t.nodeType===Node.ELEMENT_NODE&&iw(t,"wtHolder")||(r=this.domBindings.rootDocument.createElement("div"),r.className="wtHider",t&&t.insertBefore(r,e),r.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&lw(r,[Gy()]),r}createHolder(e){const t=e.parentNode;let r;return t&&t.nodeType===Node.ELEMENT_NODE&&iw(t,"wtHolder")||(r=this.domBindings.rootDocument.createElement("div"),r.style.position="relative",r.className="wtHolder",lw(r,[Wy(-1)]),t&&t.insertBefore(r,e),this.isMaster&&(r.parentNode.className+="ht_master handsontable",r.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr"),this.wtSettings.getSetting("ariaTags")&&lw(r.parentNode,[Gy()])),r.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&lw(r,[Gy()]),r}draw(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const{wtSettings:t}=this,{wtOverlays:r,wtViewport:n}=this.dataAccessObject,o=t.getSetting("totalRows"),i=t.getSetting("totalColumns"),s=t.getSetting("rowHeaders"),a=s.length,l=t.getSetting("columnHeaders"),u=l.length;let h=e;if(this.isMaster&&(r.beforeDraw(),this.holderOffset=fw(this.holder),h=n.createCalculators(h),a&&!t.getSetting("fixedColumnsStart"))){const e=r.inlineStartOverlay.getScrollPosition(),t=this.correctHeaderWidth;this.correctHeaderWidth=0!==e,t!==this.correctHeaderWidth&&(h=!1)}if(h)this.isMaster&&r.refresh(!0);else{this.isMaster?this.tableOffset=fw(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;const e=o>0?this.getFirstRenderedRow():0,t=i>0?this.getFirstRenderedColumn():0;this.rowFilter=new PT(e,o,u),this.columnFilter=new LT(t,i,a);let h=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();const e={};this.wtSettings.getSetting("beforeDraw",!0,e),h=!0!==e.skipRender}h&&(this.tableRenderer.setHeaderContentRenderers(s,l),(this.is(FC)||this.is(HC))&&this.tableRenderer.setHeaderContentRenderers(s,[]),this.resetOversizedRows(),this.tableRenderer.setActiveOverlayName(this.name).setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render(),this.isMaster&&this.markOversizedColumnHeaders(),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(FC))&&this.markOversizedRows(),this.isMaster?(this.wtSettings.getSetting("externalRowCalculator")||n.createVisibleCalculators(),r.refresh(!1),r.applyToDOM(),this.wtSettings.getSetting("onDraw",!0)):this.is(FC)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize())}let c=!1;return this.isMaster&&(c=r.topOverlay.resetFixedPosition(),r.bottomOverlay.clone&&(c=r.bottomOverlay.resetFixedPosition()||c),c=r.inlineStartOverlay.resetFixedPosition()||c,r.topInlineStartCornerOverlay&&r.topInlineStartCornerOverlay.resetFixedPosition(),r.bottomInlineStartCornerOverlay&&r.bottomInlineStartCornerOverlay.clone&&r.bottomInlineStartCornerOverlay.resetFixedPosition()),c?(r.refreshAll(),r.adjustElementsSize()):this.dataAccessObject.selectionManager.setActiveOverlay(this.facadeGetter()).render(h),this.isMaster&&r.afterDraw(),this.dataAccessObject.drawn=!0,this}markIfOversizedColumnHeader(e){const t=this.columnFilter.renderedToSource(e);let r=this.wtSettings.getSetting("columnHeaders").length;const n=this.dataAccessObject.stylesHandler.getDefaultRowHeight();let o,i,s;const a=this.wtSettings.getSetting("columnHeaderHeight")||[];for(;r;)r-=1,o=this.getColumnHeaderHeight(r),i=this.getColumnHeader(t,r),i&&(s=Nw(i),(!o&&n<s||o<s)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=s),Array.isArray(a)?null!==a[r]&&void 0!==a[r]&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=a[r]):isNaN(a)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=a),this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]<(a[r]||a)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=a[r]||a))}adjustColumnHeaderHeights(){const{wtSettings:e}=this,t=this.THEAD.childNodes,r=this.dataAccessObject.wtViewport.oversizedColumnHeaders;for(let n=0,o=e.getSetting("columnHeaders").length;n<o;n++)if(r[n]){if(!t[n]||0===t[n].childNodes.length)return;t[n].childNodes[0].style.height=`${r[n]}px`}}resetOversizedRows(){const{wtSettings:e}=this,{wtViewport:t}=this.dataAccessObject;if((this.isMaster||this.is(FC))&&!e.getSetting("externalRowCalculator")){const e=this.getRenderedRowsCount();for(let r=0;r<e;r++){const e=this.rowFilter.renderedToSource(r);t.oversizedRows&&t.oversizedRows[e]&&(t.oversizedRows[e]=void 0)}}}getCell(e){let t=e.row,r=e.col;const n=this.wtSettings.getSetting("onModifyGetCellCoords",t,r,!this.isMaster,"render");if(n&&Array.isArray(n)&&([t,r]=n),this.isRowBeforeRenderedRows(t))return-1;if(this.isRowAfterRenderedRows(t))return-2;if(this.isColumnBeforeRenderedColumns(r))return-3;if(this.isColumnAfterRenderedColumns(r))return-4;const o=this.getRow(t);if(!o&&t>=0)throw new Error("TR was expected to be rendered but is not");const i=o.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(r)];if(!i&&r>=0)throw new Error("TD or TH was expected to be rendered but is not");return i}getRow(e){let t=null,r=null;var n,o;e<0?(t=null===(n=this.rowFilter)||void 0===n?void 0:n.sourceRowToVisibleColHeadedRow(e),r=this.THEAD):(t=null===(o=this.rowFilter)||void 0===o?void 0:o.sourceToRendered(e),r=this.TBODY);return void 0!==t&&void 0!==r&&(!(r.childNodes.length<t+1)&&r.childNodes[t])}getColumnHeader(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const r=this.THEAD.childNodes[t];return null==r?void 0:r.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]}getColumnHeaders(e){const t=[],r=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e);return this.THEAD.childNodes.forEach((e=>{const n=e.childNodes[r];n&&t.push(n)})),t}getRowHeader(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(t>=this.wtSettings.getSetting("rowHeaders").length)return;const r=this.rowFilter.sourceToRendered(e),n=r<0?this.rowFilter.sourceRowToVisibleColHeadedRow(e):r,o=(r<0?this.THEAD:this.TBODY).childNodes[n];return null==o?void 0:o.childNodes[t]}getRowHeaders(e){const t=[],r=this.wtSettings.getSetting("rowHeaders").length;for(let n=0;n<r;n++){const r=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)],o=null==r?void 0:r.childNodes[n];o&&t.push(o)}return t}getCoords(e){let t=e;if("TD"!==t.nodeName&&"TH"!==t.nodeName&&(t=Jy(t,["TD","TH"])),null===t)return null;const r=t.parentNode,n=r.parentNode;let o=function(e){let t=0,r=e;if(r.previousSibling)for(;r=r.previousSibling;)t+=1;return t}(r),i=t.cellIndex;if(rw(VC,t,this.wtRootElement)||rw(LC,t,this.wtRootElement))"THEAD"===n.nodeName&&(o-=n.childNodes.length);else if(rw(HC,t,this.wtRootElement)||rw(FC,t,this.wtRootElement)){o=this.wtSettings.getSetting("totalRows")-n.childNodes.length+o}else n===this.THEAD?o=this.rowFilter.visibleColHeadedRowToSourceRow(o):this.rowFilter&&(o=this.rowFilter.renderedToSource(o));rw(VC,t,this.wtRootElement)||rw(PC,t,this.wtRootElement)||rw(HC,t,this.wtRootElement)?i=this.columnFilter.offsettedTH(i):this.columnFilter&&(i=this.columnFilter.visibleRowHeadedColumnToSourceColumn(i));const s=this.wtSettings.getSetting("onModifyGetCoordsElement",o,i);return s&&Array.isArray(s)&&([o,i]=s),this.wot.createCellCoords(o,i)}markOversizedRows(){if(this.wtSettings.getSetting("externalRowCalculator"))return;let e=this.TBODY.childNodes.length;const t=e*this.dataAccessObject.stylesHandler.getDefaultRowHeight(),r=Nw(this.TBODY)-1,n=this.wot.stylesHandler.areCellsBorderBox(),o=n?bw:Nw,i=n?0:1,s=n?1:0;let a,l,u,h,c;if(t!==r||this.wtSettings.getSetting("fixedRowsBottom"))for(;e;){e-=1,u=this.rowFilter.renderedToSource(e),a=this.getRowHeight(u),h=this.getTrForRow(u),c=h.querySelector("th");const t=0===u?s:0;l=c?o(c):o(h)-i,(!a&&this.dataAccessObject.stylesHandler.getDefaultRowHeight()<l-t||a<l)&&(n||(l+=1),this.dataAccessObject.wtViewport.oversizedRows[u]=l)}}getTrForRow(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]}isColumnHeaderRendered(e){if(e>=0)return!1;const t=this.wtSettings.getSetting("rowHeaders").length;return Math.abs(e)<=t}isRowHeaderRendered(e){if(e>=0)return!1;const t=this.wtSettings.getSetting("columnHeaders").length;return Math.abs(e)<=t}isRowBeforeRenderedRows(e){const t=this.getFirstRenderedRow();return e<0&&t<=0?!this.isRowHeaderRendered(e):e<t}isRowAfterRenderedRows(e){return e>this.getLastRenderedRow()}isColumnBeforeRenderedColumns(e){const t=this.getFirstRenderedColumn();return e<0&&t<=0?!this.isColumnHeaderRendered(e):e<t}isColumnAfterRenderedColumns(e){return this.columnFilter&&e>this.getLastRenderedColumn()}isColumnAfterViewport(e){return this.columnFilter&&e>this.getLastVisibleColumn()}isRowAfterViewport(e){return this.rowFilter&&e>this.getLastVisibleRow()}isColumnBeforeViewport(e){return this.columnFilter&&this.columnFilter.sourceToRendered(e)<0&&e>=0}isLastRowFullyVisible(){return this.getLastVisibleRow()===this.getLastRenderedRow()}isLastColumnFullyVisible(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}allRowsInViewport(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}allColumnsInViewport(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}getRowHeight(e){return this.rowUtils.getHeight(e)}getColumnHeaderHeight(e){return this.columnUtils.getHeaderHeight(e)}getColumnWidth(e){return this.columnUtils.getWidth(e)}hasDefinedSize(){return this.hasTableHeight&&this.hasTableWidth}getWidth(){return Cw(this.TABLE)}getHeight(){return bw(this.TABLE)}getTotalWidth(){const e=Cw(this.hider);return 0!==e?e:this.getWidth()}getTotalHeight(){const e=bw(this.hider);return 0!==e?e:this.getHeight()}isVisible(){return gw(this.TABLE)}_modifyRowHeaderWidth(e){let t=Hw(e)?e():null;return Array.isArray(t)?(t=[...t],t[t.length-1]=this._correctRowHeaderWidth(t[t.length-1])):t=this._correctRowHeaderWidth(t),t}_correctRowHeaderWidth(e){let t=e;return"number"!=typeof e&&(t=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(t+=1),t}},AC={getFirstRenderedRow(){const e=this.wtSettings.getSetting("totalRows"),t=this.wtSettings.getSetting("fixedRowsBottom"),r=e-t;return 0===e||0===t?-1:r<0?0:r},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){const e=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsBottom"),e)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount:()=>0};SE(AC,"MIXIN_NAME","stickyRowsBottom",{writable:!1,enumerable:!1});const IC=AC,OC={getFirstRenderedColumn(){return 0===this.wtSettings.getSetting("totalColumns")?-1:0},getFirstVisibleColumn(){return this.getFirstRenderedColumn()},getFirstPartiallyVisibleColumn(){return this.getFirstRenderedColumn()},getLastRenderedColumn(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn(){return this.getLastRenderedColumn()},getLastPartiallyVisibleColumn(){return this.getLastRenderedColumn()},getRenderedColumnsCount(){const e=this.wtSettings.getSetting("totalColumns");return Math.min(this.wtSettings.getSetting("fixedColumnsStart"),e)},getVisibleColumnsCount(){return this.getRenderedColumnsCount()},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};SE(OC,"MIXIN_NAME","stickyColumnsStart",{writable:!1,enumerable:!1});const MC=OC;class _C extends NC{constructor(e,t,r,n){super(e,t,r,n,HC)}}EE(_C,IC),EE(_C,MC);const xC=_C,LC="top",FC="bottom",PC="inline_start",VC="top_inline_start_corner",HC="bottom_inline_start_corner",DC=[LC,FC,PC,VC,HC],UC=new Map([[LC,`ht_clone_${LC}`],[FC,`ht_clone_${FC}`],[PC,`ht_clone_${PC} ht_clone_left`],[VC,`ht_clone_${VC} ht_clone_top_left_corner`],[HC,`ht_clone_${HC} ht_clone_bottom_left_corner`]]);function kC(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function BC(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function WC(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var GC=new WeakSet;function jC(e){const{wtSettings:t,inlineStartOverlay:r,wtTable:n,wtViewport:o,totalColumns:i,rootWindow:s}=this.dataAccessObject;if(r.mainTableScrollableElement===s){let a=null;if(t.getSetting("rtlMode")){const e=n.TABLE.getBoundingClientRect(),t=this.dataAccessObject.rootWindow.document.documentElement.offsetWidth;a=Math.abs(e.right-t)}else{a=fw(n.wtRootElement).left}const l=Math.abs(vw(s,s));if(a>l){const t=Aw(s);let n=o.getRowHeaderWidth();for(let o=1;o<=i;o++)if(n+=r.sumCellSizes(o-1,o),a+n-l>=t){e=o-2;break}}}return e}function zC(e){const{topOverlay:t,wtTable:r,wtViewport:n,totalRows:o,rootWindow:i}=this.dataAccessObject;if(t.mainTableScrollableElement===i){const s=fw(r.wtRootElement),a=Ew(i,i);if(s.top>a){const r=Nw(i);let l=n.getColumnHeaderHeight();for(let n=1;n<=o;n++)if(l+=t.sumCellSizes(n-1,n),s.top+l-a>=r){e=n-2;break}}}return e}const $C=class{constructor(e){kC(this,GC),BC(this,"dataAccessObject",void 0),this.dataAccessObject=e}scrollViewport(e,t,r){if(e.col<0||e.row<0)return!1;const n=this.scrollViewportHorizontally(e.col,t),o=this.scrollViewportVertically(e.row,r);return n||o}scrollViewportHorizontally(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"auto";const{drawn:r,totalColumns:n}=this.dataAccessObject;if(!r)return!1;const o=NE(t);if(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollHorizontally",e,o),!Number.isInteger(e)||e<0||e>n)return!1;t=o.value;const{fixedColumnsStart:i,inlineStartOverlay:s}=this.dataAccessObject,a="auto"===t;if(a&&e<i)return!1;const l=this.getFirstVisibleColumn(),u=this.getLastVisibleColumn();let h=!1;return(a&&(e<l||e>u)||!a)&&(h=s.scrollTo(e,a?e>=this.getLastPartiallyVisibleColumn():"end"===t)),h}scrollViewportVertically(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"auto";const{drawn:r,totalRows:n}=this.dataAccessObject;if(!r)return!1;const o=NE(t);if(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollVertically",e,o),!Number.isInteger(e)||e<0||e>n)return!1;t=o.value;const{fixedRowsBottom:i,fixedRowsTop:s,topOverlay:a}=this.dataAccessObject,l="auto"===t;if(l&&(e<s||e>n-i-1))return!1;const u=this.getFirstVisibleRow(),h=this.getLastVisibleRow();let c=!1;return(l&&(e<u||e>h)||!l)&&(c=a.scrollTo(e,l?e>=this.getLastPartiallyVisibleRow():"bottom"===t)),c}getFirstVisibleRow(){return this.dataAccessObject.wtTable.getFirstVisibleRow()}getLastVisibleRow(){return WC(GC,this,zC).call(this,this.dataAccessObject.wtTable.getLastVisibleRow())}getFirstPartiallyVisibleRow(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleRow()}getLastPartiallyVisibleRow(){return WC(GC,this,zC).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleRow())}getFirstVisibleColumn(){return this.dataAccessObject.wtTable.getFirstVisibleColumn()}getLastVisibleColumn(){return WC(GC,this,jC).call(this,this.dataAccessObject.wtTable.getLastVisibleColumn())}getFirstPartiallyVisibleColumn(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleColumn()}getLastPartiallyVisibleColumn(){return WC(GC,this,jC).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleColumn())}};function YC(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class XC{get eventManager(){return new Uv(this)}constructor(e,t){YC(this,"wtTable",void 0),YC(this,"wtScroll",void 0),YC(this,"wtViewport",void 0),YC(this,"wtOverlays",void 0),YC(this,"selectionManager",void 0),YC(this,"wtEvent",void 0),YC(this,"guid",`wt_${By()}`),YC(this,"drawInterrupted",!1),YC(this,"drawn",!1),YC(this,"activeOverlayName","master"),YC(this,"domBindings",void 0),YC(this,"wtSettings",void 0),this.domBindings={rootTable:e,rootDocument:e.ownerDocument,rootWindow:e.ownerDocument.defaultView},this.wtSettings=t,this.wtScroll=new $C(this.createScrollDao())}findOriginalHeaders(){const e=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(let t=0,r=this.wtTable.THEAD.childNodes[0].childNodes.length;t<r;t++)e.push(this.wtTable.THEAD.childNodes[0].childNodes[t].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(t,r){mw(r,e[t])}])}}createCellCoords(e,t){return new uT(e,t,this.wtSettings.getSetting("rtlMode"))}createCellRange(e,t,r){return new fT(e,t,r,this.wtSettings.getSetting("rtlMode"))}draw(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.drawInterrupted=!1,this.wtTable.isVisible()?this.wtTable.draw(e):this.drawInterrupted=!0,this}getCell(e){if(!(arguments.length>1&&void 0!==arguments[1]&&arguments[1]))return this.wtTable.getCell(e);const t=this.wtSettings.getSetting("totalRows"),r=this.wtSettings.getSetting("fixedRowsTop"),n=this.wtSettings.getSetting("fixedRowsBottom"),o=this.wtSettings.getSetting("fixedColumnsStart");if(e.row<r&&e.col<o)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(e);if(e.row<r)return this.wtOverlays.topOverlay.clone.wtTable.getCell(e);if(e.col<o&&e.row>=t-n){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(e)}else{if(e.col<o)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(e);if(e.row<t&&e.row>=t-n&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(e)}return this.wtTable.getCell(e)}scrollViewport(e,t,r){return this.wtScroll.scrollViewport(e,t,r)}scrollViewportHorizontally(e,t){return this.wtScroll.scrollViewportHorizontally(e,t)}scrollViewportVertically(e,t){return this.wtScroll.scrollViewportVertically(e,t)}getViewport(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}destroy(){this.wtOverlays.destroy(),this.wtEvent.destroy()}createScrollDao(){const e=this;return{get drawn(){return e.drawn},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get wtTable(){return e.wtTable},get wtViewport(){return e.wtViewport},get wtSettings(){return e.wtSettings},get rootWindow(){return e.domBindings.rootWindow},get totalRows(){return e.wtSettings.getSetting("totalRows")},get totalColumns(){return e.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return e.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return e.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return e.wtSettings.getSetting("fixedColumnsStart")}}}getTableDao(){const e=this;return{get wot(){return e},get parentTableOffset(){return e.cloneSource.wtTable.tableOffset},get cloneSource(){return e.cloneSource},get workspaceWidth(){return e.wtViewport.getWorkspaceWidth()},get wtViewport(){return e.wtViewport},get wtOverlays(){return e.wtOverlays},get selectionManager(){return e.selectionManager},get stylesHandler(){return e.stylesHandler},get drawn(){return e.drawn},set drawn(t){e.drawn=t},get wtTable(){return e.wtTable},get startColumnRendered(){return e.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return e.wtViewport.columnsVisibleCalculator.startColumn},get startColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.startColumn},get endColumnRendered(){return e.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return e.wtViewport.columnsVisibleCalculator.endColumn},get endColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.endColumn},get countColumnsRendered(){return e.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return e.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return e.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return e.wtViewport.rowsVisibleCalculator.startRow},get startRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.startRow},get endRowRendered(){return e.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return e.wtViewport.rowsVisibleCalculator.endRow},get endRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.endRow},get countRowsRendered(){return e.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return e.wtViewport.rowsVisibleCalculator.count},get columnHeaders(){return e.wtSettings.getSetting("columnHeaders")},get rowHeaders(){return e.wtSettings.getSetting("rowHeaders")}}}}function KC(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class qC extends XC{constructor(e,t,r){super(e,t),KC(this,"cloneSource",void 0),KC(this,"cloneOverlay",void 0);const n=this.wtSettings.getSetting("facade",this);this.cloneSource=r.source,this.cloneOverlay=r.overlay,this.stylesHandler=r.stylesHandler,this.wtTable=this.cloneOverlay.createTable(this.getTableDao(),n,this.domBindings,this.wtSettings),this.wtViewport=r.viewport,this.selectionManager=r.selectionManager,this.wtEvent=new _T(n,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager,r.event),this.findOriginalHeaders()}}function QC(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class ZC{constructor(e,t,r,n,o){QC(this,"wtSettings",null),SE(this,"wot",e,{writable:!1}),this.domBindings=o,this.facadeGetter=t,this.wtSettings=n;const{TABLE:i,hider:s,spreader:a,holder:l,wtRootElement:u}=this.wot.wtTable;this.instance=this.wot,this.type=r,this.mainTableScrollableElement=null,this.TABLE=i,this.hider=s,this.spreader=a,this.holder=l,this.wtRootElement=u,this.trimmingContainer=Sw(this.hider.parentNode.parentNode),this.needFullRender=this.shouldBeRendered(),this.clone=this.makeClone()}hasRenderingStateChanged(){return this.needFullRender!==this.shouldBeRendered()}updateStateOfRendering(e){"before"===e&&this.shouldBeRendered()?this.needFullRender=!0:"after"!==e||this.shouldBeRendered()||(this.needFullRender=!1)}shouldBeRendered(){return!0}updateTrimmingContainer(){this.trimmingContainer=Sw(this.hider.parentNode.parentNode)}updateMainScrollableElement(){const{wtTable:e}=this.wot,{rootWindow:t}=this.domBindings;"hidden"===t.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=Rw(e.TABLE)}getRelativeCellPosition(e,t,r){if(!1===this.clone.wtTable.holder.contains(e))return void WE(`The provided element is not a child of the ${this.type} overlay`);const n=this.mainTableScrollableElement===this.domBindings.rootWindow,o=r<this.wtSettings.getSetting("fixedColumnsStart"),i=t<this.wtSettings.getSetting("fixedRowsTop"),s=t>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),a=this.clone.wtTable.spreader,l={start:this.getRelativeStartPosition(a),top:a.offsetTop},u={start:this.getRelativeStartPosition(e),top:e.offsetTop};let h=null;return h=n?this.getRelativeCellPositionWithinWindow(i,o,u,l):this.getRelativeCellPositionWithinHolder(i,s,o,u,l),h}getRelativeStartPosition(e){return this.isRtl()?e.offsetParent.offsetWidth-e.offsetLeft-e.offsetWidth:e.offsetLeft}getRelativeCellPositionWithinWindow(e,t,r,n){const o=this.wot.wtTable.wtRootElement.getBoundingClientRect();let i=0,s=0;if(t){let e=o.left;this.isRtl()&&(e=this.domBindings.rootWindow.innerWidth-(o.left+o.width+_w())),i=e<=0?-1*e:0}else i=n.start;if(e){s=this.clone.wtTable.TABLE.getBoundingClientRect().top-o.top}else s=n.top;return{start:r.start+i,top:r.top+s}}getRelativeCellPositionWithinHolder(e,t,r,n,o){const i=this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),s=this.wot.wtOverlays.topOverlay.getScrollPosition();let a=0,l=0;if(r||(a=i-o.start),t){const e=this.wot.wtTable.wtRootElement.getBoundingClientRect();l=-1*this.clone.wtTable.TABLE.getBoundingClientRect().top+e.top}else e||(l=s-o.top);return{start:n.start-a,top:n.top-l}}makeClone(){if(-1===DC.indexOf(this.type))throw new Error(`Clone type "${this.type}" is not supported.`);const{wtTable:e,wtSettings:t}=this.wot,{rootDocument:r,rootWindow:n}=this.domBindings,o=r.createElement("div"),i=r.createElement("table"),s=e.wtRootElement.parentNode;o.className=`${UC.get(this.type)} handsontable`,o.setAttribute("dir",this.isRtl()?"rtl":"ltr"),o.style.position="absolute",o.style.top=0,o.style.overflow="visible",this.isRtl()?o.style.right=0:o.style.left=0,t.getSetting("ariaTags")&&lw(o,[Gy()]),i.className=e.TABLE.className;e.TABLE.getAttribute("role")&&i.setAttribute("role",e.TABLE.getAttribute("role")),o.appendChild(i),s.appendChild(o);const a=this.wtSettings.getSetting("preventOverflow");return!0===a||"horizontal"===a&&this.type===LC||"vertical"===a&&this.type===PC?this.mainTableScrollableElement=n:"hidden"===n.getComputedStyle(s).getPropertyValue("overflow")?this.mainTableScrollableElement=e.holder:this.mainTableScrollableElement=Rw(e.TABLE),new qC(i,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selectionManager:this.wot.selectionManager,stylesHandler:this.wot.stylesHandler})}refresh(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.needFullRender){const t=this.clone.cloneSource;t.activeOverlayName=this.clone.wtTable.name,this.clone.draw(e),t.activeOverlayName="master"}}reset(){const e=this.clone.wtTable.holder,t=this.clone.wtTable.hider;[e.style,t.style,e.parentNode.style].forEach((e=>{e.width="",e.height=""}))}isRtl(){return this.wtSettings.getSetting("rtlMode")}destroy(){this.clone.eventManager.destroy()}}class JC extends ZC{constructor(e,t,r,n,o,i){super(e,t,HC,r,n),this.bottomOverlay=o,this.inlineStartOverlay=i}createTable(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return new xC(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wot:e}=this;if(this.updateTrimmingContainer(),!e.wtTable.holder.parentNode)return!1;const t=this.clone.wtTable.holder.parentNode;if(t.style.top="",this.trimmingContainer===this.domBindings.rootWindow){const e=this.inlineStartOverlay.getOverlayOffset(),r=this.bottomOverlay.getOverlayOffset();t.style[this.isRtl()?"right":"left"]=`${e}px`,t.style.bottom=`${r}px`}else Lw(t),this.repositionOverlay();let r=bw(this.clone.wtTable.TABLE);const n=Cw(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(r=0),t.style.height=`${r}px`,t.style.width=`${n}px`,!1}repositionOverlay(){const{wtTable:e,wtViewport:t}=this.wot,{rootDocument:r}=this.domBindings,n=this.clone.wtTable.holder.parentNode;let o=0;t.hasVerticalScroll()||(o+=t.getWorkspaceHeight()-e.getTotalHeight()),t.hasVerticalScroll()&&t.hasHorizontalScroll()&&(o+=_w(r)),n.style.bottom=`${o}px`}}const eb={getFirstRenderedColumn(){const e=this.dataAccessObject.startColumnRendered;return null===e?-1:e},getFirstVisibleColumn(){const e=this.dataAccessObject.startColumnVisible;return null===e?-1:e},getFirstPartiallyVisibleColumn(){const e=this.dataAccessObject.startColumnPartiallyVisible;return null===e?-1:e},getLastRenderedColumn(){const e=this.dataAccessObject.endColumnRendered;return null===e?-1:e},getLastVisibleColumn(){const e=this.dataAccessObject.endColumnVisible;return null===e?-1:e},getLastPartiallyVisibleColumn(){const e=this.dataAccessObject.endColumnPartiallyVisible;return null===e?-1:e},getRenderedColumnsCount(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount(){return this.dataAccessObject.countColumnsVisible},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};SE(eb,"MIXIN_NAME","calculatedColumns",{writable:!1,enumerable:!1});const tb=eb;class rb extends NC{constructor(e,t,r,n){super(e,t,r,n,FC)}}EE(rb,IC),EE(rb,tb);const nb=rb;function ob(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class ib extends ZC{constructor(e,t,r,n){super(e,t,FC,r,n),ob(this,"cachedFixedRowsBottom",-1),this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom")}createTable(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return new nb(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const{rootWindow:e}=this.domBindings,t=this.clone.wtTable.holder.parentNode;t.style.top="";let r=0;const n=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer!==e||n&&"vertical"===n?(r=this.getScrollPosition(),this.repositionOverlay()):(r=this.getOverlayOffset(),t.style.bottom=`${r}px`);const o=this.adjustHeaderBordersPosition(r);return this.adjustElementsSize(),o}repositionOverlay(){const{wtTable:e,wtViewport:t}=this.wot,{rootDocument:r}=this.domBindings,n=this.clone.wtTable.holder.parentNode;let o=0;t.hasVerticalScroll()||(o+=t.getWorkspaceHeight()-e.getTotalHeight()),t.hasVerticalScroll()&&t.hasHorizontalScroll()&&(o+=_w(r)),n.style.bottom=`${o}px`}setScrollPosition(e){const{rootWindow:t}=this.domBindings;let r=!1;return this.mainTableScrollableElement===t?(t.scrollTo(ww(t),e),r=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,r=!0),r}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,t){const{wtTable:r,stylesHandler:n}=this.wot,o=n.getDefaultRowHeight();let i=e,s=0;for(;i<t;){const e=r.getRowHeight(i);s+=void 0===e?o:e,i+=1}return s}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:t}=this.wot,{rootDocument:r,rootWindow:n}=this.domBindings,o=this.clone.wtTable.holder.parentNode.style,i=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==n||"horizontal"===i){let n=t.getWorkspaceWidth();t.hasVerticalScroll()&&(n-=_w(r)),n=Math.min(n,e.wtRootElement.scrollWidth),o.width=`${n}px`}else o.width="";this.clone.wtTable.holder.style.width=o.width;let s=bw(this.clone.wtTable.TABLE);e.hasDefinedSize()||(s=0),o.height=`${s}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=e.parentNode.style.height}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if("number"==typeof this.wot.wtViewport.rowsRenderCalculator.startPosition)this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else{if(0!==e)throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.top="0"}this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:t}=this.clone.wtTable;"number"==typeof this.wot.wtViewport.columnsRenderCalculator.startPosition?t.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:t.style[e]=""}scrollTo(e,t){let r=this.getTableParentOffset();const n=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let o=0;t&&n.offsetHeight!==n.clientHeight&&(o=_w(this.domBindings.rootDocument)),t?(r+=this.sumCellSizes(0,e+1),r-=this.wot.wtViewport.getViewportHeight(),r+=1):r+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),e),r+=o,this.setScrollPosition(r)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return Ew(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,t=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!t||"vertical"!==t)){const e=this.wot.wtTable.getTotalHeight(),t=e-this.clone.wtTable.getTotalHeight(),n=this.domBindings.rootDocument.documentElement.clientHeight;r=Math.max(this.getTableParentOffset()-this.getScrollPosition()-n+e,0),r>t&&(r=0)}return r}adjustHeaderBordersPosition(e){const t=this.wtSettings.getSetting("fixedRowsBottom"),r=this.cachedFixedRowsBottom!==t,n=this.wtSettings.getSetting("columnHeaders");let o=!1;if((r||0===t)&&n.length>0){const t=this.wot.wtTable.holder.parentNode,r=iw(t,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),e||0===this.wtSettings.getSetting("totalRows")?(sw(t,"innerBorderBottom"),o=!r):(aw(t,"innerBorderBottom"),o=r)}return o}}const sb={getFirstRenderedRow(){const e=this.dataAccessObject.startRowRendered;return null===e?-1:e},getFirstVisibleRow(){const e=this.dataAccessObject.startRowVisible;return null===e?-1:e},getFirstPartiallyVisibleRow(){const e=this.dataAccessObject.startRowPartiallyVisible;return null===e?-1:e},getLastRenderedRow(){const e=this.dataAccessObject.endRowRendered;return null===e?-1:e},getLastVisibleRow(){const e=this.dataAccessObject.endRowVisible;return null===e?-1:e},getLastPartiallyVisibleRow(){const e=this.dataAccessObject.endRowPartiallyVisible;return null===e?-1:e},getRenderedRowsCount(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount(){return this.dataAccessObject.countRowsVisible},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};SE(sb,"MIXIN_NAME","calculatedRows",{writable:!1,enumerable:!1});const ab=sb;class lb extends NC{constructor(e,t,r,n){super(e,t,r,n,PC)}}EE(lb,ab),EE(lb,MC);const ub=lb,hb={_localHooks:Object.create(null),addLocalHook(e,t){return this._localHooks[e]||(this._localHooks[e]=[]),this._localHooks[e].push(t),this},runLocalHooks(e,t,r,n,o,i,s){if(this._localHooks[e]){const a=this._localHooks[e].length;for(let l=0;l<a;l++)Dw(this._localHooks[e][l],this,t,r,n,o,i,s)}},clearLocalHooks(){return this._localHooks={},this}};SE(hb,"MIXIN_NAME","localHooks",{writable:!1,enumerable:!1});const cb=hb;let db=class{constructor(e,t){this.settings=e,this.cellRange=t||null}isEmpty(){return null===this.cellRange}add(e){return this.isEmpty()?this.cellRange=this.settings.createCellRange(e):this.cellRange.expand(e),this}replace(e,t){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=t,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=t,!0}return!1}clear(){return this.cellRange=null,this}getCorners(){const e=this.cellRange.getOuterTopStartCorner(),t=this.cellRange.getOuterBottomEndCorner();return[e.row,e.col,t.row,t.col]}destroy(){this.runLocalHooks("destroy")}};EE(db,cb);const pb=db,mb="header",gb="area",fb="focus",yb=e=>{const t=e.stylesHandler;if(t.isClassicTheme())return Object.freeze({width:6,height:6,borderWidth:1,borderStyle:"solid",borderColor:"#FFF"});const r=t.getCSSVariableValue("cell-autofill-size"),n=t.getCSSVariableValue("cell-autofill-border-width"),o=t.getCSSVariableValue("cell-autofill-border-color");return Object.freeze({width:r,height:r,borderWidth:n,borderStyle:"solid",borderColor:o})};function wb(e,t,r){Eb(e,t),t.set(e,r)}function Eb(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function vb(e,t){return e.get(Sb(e,t))}function Rb(e,t,r){return e.set(Sb(e,t),r),r}function Sb(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}JE("flat");var Tb=new WeakMap,Cb=new WeakMap,bb=new WeakSet;class Nb{constructor(){var e,t;Eb(e=this,t=bb),t.add(e),wb(this,Tb,void 0),wb(this,Cb,void 0)}setActiveOverlay(e){return Rb(Cb,this,e),this}setActiveSelection(e){return Rb(Tb,this,e),this}scan(){const e=vb(Tb,this).settings.selectionType,t=new Set;return"active-header"===e?(this.scanColumnsInHeadersRange((e=>t.add(e))),this.scanRowsInHeadersRange((e=>t.add(e)))):"area"===e?this.scanCellsRange((e=>t.add(e))):"focus"===e?(this.scanColumnsInHeadersRange((e=>t.add(e))),this.scanRowsInHeadersRange((e=>t.add(e))),this.scanCellsRange((e=>t.add(e)))):"fill"===e?this.scanCellsRange((e=>t.add(e))):"header"===e?(this.scanColumnsInHeadersRange((e=>t.add(e))),this.scanRowsInHeadersRange((e=>t.add(e)))):"row"===e?(this.scanRowsInHeadersRange((e=>t.add(e))),this.scanRowsInCellsRange((e=>t.add(e)))):"column"===e&&(this.scanColumnsInHeadersRange((e=>t.add(e))),this.scanColumnsInCellsRange((e=>t.add(e)))),t}scanColumnsInHeadersRange(e){const[t,r,n,o]=vb(Tb,this).getCorners(),{wtTable:i}=vb(Cb,this),s=i.getRenderedColumnsCount(),a=i.getColumnHeadersCount();let l=0;for(let u=-i.getRowHeadersCount();u<s;u++){const s=i.columnFilter.renderedToSource(u);if(!(s<r||s>o)){for(let u=-a;u<0;u++){if(u<t||u>n)continue;const h=u+a;let c=i.getColumnHeader(s,h);const d=vb(Cb,this).getSetting("onBeforeHighlightingColumnHeader",s,h,{selectionType:vb(Tb,this).settings.selectionType,columnCursor:l,selectionWidth:o-r+1});null!==d&&(d!==s&&(c=i.getColumnHeader(d,h)),e(c))}l+=1}}}scanRowsInHeadersRange(e){const[t,r,n,o]=vb(Tb,this).getCorners(),{wtTable:i}=vb(Cb,this),s=i.getRenderedRowsCount(),a=i.getRowHeadersCount();let l=0;for(let u=-i.getColumnHeadersCount();u<s;u++){const s=i.rowFilter.renderedToSource(u);if(!(s<t||s>n)){for(let u=-a;u<0;u++){if(u<r||u>o)continue;const h=u+a;let c=i.getRowHeader(s,h);const d=vb(Cb,this).getSetting("onBeforeHighlightingRowHeader",s,h,{selectionType:vb(Tb,this).settings.selectionType,rowCursor:l,selectionHeight:n-t+1});null!==d&&(d!==s&&(c=i.getRowHeader(d,h)),e(c))}l+=1}}}scanCellsRange(e){const{wtTable:t}=vb(Cb,this);Sb(bb,this,Ab).call(this,((r,n)=>{const o=t.getCell(vb(Cb,this).createCellCoords(r,n)),i=vb(Cb,this).getSetting("onAfterDrawSelection",r,n,vb(Tb,this).settings.layerLevel);"string"==typeof i&&sw(o,i),e(o)}))}scanRowsInCellsRange(e){const[t,,r]=vb(Tb,this).getCorners(),{wtTable:n}=vb(Cb,this);Sb(bb,this,Ib).call(this,((o,i)=>{if(o>=t&&o<=r){const t=n.getCell(vb(Cb,this).createCellCoords(o,i));e(t)}}))}scanColumnsInCellsRange(e){const[,t,,r]=vb(Tb,this).getCorners(),{wtTable:n}=vb(Cb,this);Sb(bb,this,Ib).call(this,((o,i)=>{if(i>=t&&i<=r){const t=n.getCell(vb(Cb,this).createCellCoords(o,i));e(t)}}))}}function Ab(e){let[t,r,n,o]=vb(Tb,this).getCorners();if(t<0&&n<0||r<0&&o<0)return;const{wtTable:i}=vb(Cb,this),s=t!==n||r!==o;if(r=Math.max(r,0),o=Math.max(o,0),t=Math.max(t,0),n=Math.max(n,0),s){if(r=Math.max(r,i.getFirstRenderedColumn()),o=Math.min(o,i.getLastRenderedColumn()),t=Math.max(t,i.getFirstRenderedRow()),n=Math.min(n,i.getLastRenderedRow()),o<r||n<t)return}else{if(!Vw(i.getCell(vb(Cb,this).createCellCoords(t,r))))return}for(let a=t;a<=n;a+=1)for(let t=r;t<=o;t+=1)e(a,t)}function Ib(e){const{wtTable:t}=vb(Cb,this),r=t.getRenderedRowsCount(),n=t.getRenderedColumnsCount();for(let o=0;o<r;o+=1){const r=t.rowFilter.renderedToSource(o);for(let o=0;o<n;o+=1)e(r,t.columnFilter.renderedToSource(o))}}const Ob=class{constructor(e,t){t&&(this.eventManager=e.eventManager,this.instance=e,this.wot=e,this.settings=t,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle=yb(this.instance),this.cornerCenterPointOffset=-Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(t),this.registerListeners())}registerListeners(){const e=this.wot.rootDocument.body;this.eventManager.addEventListener(e,"mousedown",(()=>this.onMouseDown())),this.eventManager.addEventListener(e,"mouseup",(()=>this.onMouseUp()));for(let t=0,r=this.main.childNodes.length;t<r;t++){const e=this.main.childNodes[t];this.eventManager.addEventListener(e,"mouseenter",(e=>this.onMouseEnter(e,this.main.childNodes[t])))}}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onMouseEnter(e,t){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;e.preventDefault(),DE(e);const r=this,n=this.wot.rootDocument.body,o=t.getBoundingClientRect();t.style.display="none",this.eventManager.addEventListener(n,"mousemove",(function e(i){var s;((s=i).clientY<Math.floor(o.top)||s.clientY>Math.ceil(o.top+o.height)||s.clientX<Math.floor(o.left)||s.clientX>Math.ceil(o.left+o.width))&&(r.eventManager.removeEventListener(n,"mousemove",e),t.style.display="block")}))}createBorders(e){const{rootDocument:t}=this.wot;this.main=t.createElement("div");const r=["top","start","bottom","end","corner"];let n=this.main.style;n.position="absolute",n.top=0,n.left=0;for(let s=0;s<5;s++){const o=r[s],i=t.createElement("div");i.className=`wtBorder ${this.settings.className||""}`,this.settings[o]&&this.settings[o].hide&&(i.className+=" hidden"),n=i.style,n.backgroundColor=this.settings[o]&&this.settings[o].color?this.settings[o].color:e.border.color,n.height=this.settings[o]&&this.settings[o].width?`${this.settings[o].width}px`:`${e.border.width}px`,n.width=this.settings[o]&&this.settings[o].width?`${this.settings[o].width}px`:`${e.border.width}px`,this.main.appendChild(i)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=`${this.cornerDefaultStyle.width}px`,this.cornerStyle.height=`${this.cornerDefaultStyle.height}px`,this.cornerStyle.border=[`${this.cornerDefaultStyle.borderWidth}px`,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),LE()&&this.instance.getSetting("isDataViewInstance")&&this.createMultipleSelectorHandles(),this.disappear();const{wtTable:o}=this.wot;let i=o.bordersHolder;i||(i=t.createElement("div"),i.className="htBorders",o.bordersHolder=i,o.spreader.appendChild(i)),i.appendChild(this.main)}createMultipleSelectorHandles(){const{rootDocument:e,stylesHandler:t}=this.wot,r=t.getCSSVariableValue("cell-mobile-handle-size"),n=t.getCSSVariableValue("cell-mobile-handle-border-radius"),o=t.getCSSVariableValue("cell-mobile-handle-background-color"),i=t.getCSSVariableValue("cell-mobile-handle-border-width"),s=t.getCSSVariableValue("cell-mobile-handle-border-color");this.selectionHandles={top:e.createElement("DIV"),topHitArea:e.createElement("DIV"),bottom:e.createElement("DIV"),bottomHitArea:e.createElement("DIV")};this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};TE({position:"absolute",height:"40px",width:"40px","border-radius":`${parseInt(40/1.5,10)}px`},((e,t)=>{this.selectionHandles.styles.bottomHitArea[t]=e,this.selectionHandles.styles.topHitArea[t]=e}));TE(t.isClassicTheme()?{position:"absolute",height:"10px",width:"10px","border-radius":`${parseInt(10/1.5,10)}px`,background:"#F5F5FF",border:"1px solid #4285c8"}:{position:"absolute",height:`${r}px`,width:`${r}px`,"border-radius":`${n}px`,background:`${o}`,border:`${i}px solid ${s}`},((e,t)=>{this.selectionHandles.styles.bottom[t]=e,this.selectionHandles.styles.top[t]=e})),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}isPartRange(e,t){const r=this.wot.selectionManager.getAreaSelection();return!(!r.cellRange||e===r.cellRange.to.row&&t===r.cellRange.to.col)}updateMultipleSelectionHandlesPosition(e,t,r,n,o,i){const s=this.wot.wtSettings.getSetting("rtlMode")?"right":"left",{top:a,topHitArea:l,bottom:u,bottomHitArea:h}=this.selectionHandles.styles,c=parseInt(a.borderWidth,10),d=parseInt(a.width,10),p=parseInt(l.width,10),m=this.wot.wtTable.getWidth(),g=this.wot.wtTable.getHeight();a.top=`${parseInt(r-d-1,10)}px`,a[s]=`${parseInt(n-d-1,10)}px`,l.top=`${parseInt(r-p/4*3,10)}px`,l[s]=`${parseInt(n-p/4*3,10)}px`;const f=Math.min(parseInt(n+o,10),m-d-2*c),y=Math.min(parseInt(n+o-p/4,10),m-p-2*c);u[s]=`${f}px`,h[s]=`${y}px`;const w=Math.min(parseInt(r+i,10),g-d-2*c),E=Math.min(parseInt(r+i-p/4,10),g-p-2*c);u.top=`${w}px`,h.top=`${E}px`,this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(a.display="block",l.display="block",this.isPartRange(e,t)?(u.display="none",h.display="none"):(u.display="block",h.display="block")):(a.display="none",u.display="none",l.display="none",h.display="none"),e===this.wot.wtSettings.getSetting("fixedRowsTop")||t===this.wot.wtSettings.getSetting("fixedColumnsStart")?(a.zIndex="9999",l.zIndex="9999"):(a.zIndex="",l.zIndex="")}appear(e){if(this.disabled)return;let[t,r,n,o]=e;if(t<0&&n<0||r<0&&o<0)return void this.disappear();const{wtTable:i,rootDocument:s,rootWindow:a}=this.wot,l=t!==n||r!==o,u=i.getFirstRenderedRow(),h=i.getLastRenderedRow(),c=i.getFirstRenderedColumn(),d=i.getLastRenderedColumn();let p;if(l){if(r=Math.max(r,c),o=Math.min(o,d),t=Math.max(t,u),n=Math.min(n,h),o<r||n<t)return void this.disappear();p=i.getCell(this.wot.createCellCoords(t,r))}else if(p=i.getCell(this.wot.createCellCoords(t,r)),!Vw(p))return void this.disappear();const m=l?i.getCell(this.wot.createCellCoords(n,o)):p,g=fw(p),f=l?fw(m):g,y=fw(i.TABLE),w=g.top,E=g.left,v=this.wot.wtSettings.getSetting("rtlMode");let R=0,S=0;if(v){const e=Cw(i.TABLE),t=Cw(p),r=a.innerWidth-y.left-e;S=E+t-f.left,R=a.innerWidth-E-t-r-1}else S=f.left+Cw(m)-E,R=E-y.left-1;if(this.isEntireColumnSelected(t,n)){const e=t,n=this.getDimensionsFromHeader("columns",r,o,e,y);let i=null;n&&([i,R,S]=n),i&&(p=i)}let T=w-y.top-1,C=f.top+bw(m)-w;if(this.isEntireRowSelected(r,o)){const e=r,o=this.getDimensionsFromHeader("rows",t,n,e,y);let i=null;o&&([i,T,C]=o),i&&(p=i)}const b=a.getComputedStyle(p);parseInt(b.borderTopWidth,10)>0&&(T+=1,C=C>0?C-1:0),parseInt(b[v?"borderRightWidth":"borderLeftWidth"],10)>0&&(R+=1,S=S>0?S-1:0);const N=v?"right":"left";this.topStyle.top=`${T}px`,this.topStyle[N]=`${R}px`,this.topStyle.width=`${S}px`,this.topStyle.display="block",this.startStyle.top=`${T}px`,this.startStyle[N]=`${R}px`,this.startStyle.height=`${C}px`,this.startStyle.display="block";const A=Math.floor(this.settings.border.width/2);this.bottomStyle.top=T+C-A+"px",this.bottomStyle[N]=`${R}px`,this.bottomStyle.width=`${S}px`,this.bottomStyle.display="block",this.endStyle.top=`${T}px`,this.endStyle[N]=R+S-A+"px",this.endStyle.height=`${C+1}px`,this.endStyle.display="block";let I=this.settings.border.cornerVisible;I="function"==typeof I?I(this.settings.layerLevel):I;const O=this.wot.getSetting("onModifyGetCellCoords",n,o,!1,"render");let[M,_]=[n,o];if(O&&Array.isArray(O)&&([,,M,_]=O),LE()||!I||this.isPartRange(M,_))this.cornerStyle.display="none";else{this.cornerStyle.top=T+C+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth+"px",this.cornerStyle[N]=R+S+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth+"px",this.cornerStyle.borderRightWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderLeftWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderBottomWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";let e=Sw(i.TABLE);const t=e===a;t&&(e=s.documentElement);const r=parseInt(this.cornerDefaultStyle.borderWidth,10)-1,l=Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),u=Math.ceil(parseInt(this.cornerDefaultStyle.height,10)/2);if(o===this.wot.getSetting("totalColumns")-1){const n=t?m.getBoundingClientRect().left:m.offsetLeft;let o=!1,i=0;v?(i=n-parseInt(this.cornerDefaultStyle.width,10)/2,o=i<0):(i=n+Cw(m)+parseInt(this.cornerDefaultStyle.width,10)/2,o=i>=Aw(e)),o&&(this.cornerStyle[N]=`${Math.floor(R+S+this.cornerCenterPointOffset-l-r)}px`,this.cornerStyle[v?"borderLeftWidth":"borderRightWidth"]=0)}if(n===this.wot.getSetting("totalRows")-1){const n=(t?m.getBoundingClientRect().top:m.offsetTop)+bw(m)+parseInt(this.cornerDefaultStyle.height,10)/2>=Nw(e),o=this.wot.stylesHandler.isClassicTheme();if(n){const e=Math.floor(T+C+this.cornerCenterPointOffset-u-r);o?(this.cornerStyle.top=`${e}px`,this.cornerStyle.borderBottomWidth=0):this.cornerStyle.top=e-1+"px"}}this.cornerStyle.display="block"}LE()&&this.instance.getSetting("isDataViewInstance")&&this.updateMultipleSelectionHandlesPosition(n,o,T,R,S,C)}isEntireColumnSelected(e,t){return e===this.wot.wtTable.getFirstRenderedRow()&&t===this.wot.wtTable.getLastRenderedRow()}isEntireRowSelected(e,t){return e===this.wot.wtTable.getFirstRenderedColumn()&&t===this.wot.wtTable.getLastRenderedColumn()}getDimensionsFromHeader(e,t,r,n,o){const{wtTable:i}=this.wot,s=i.wtRootElement.parentNode;let a=null,l=null,u=null,h=null,c=null,d=null,p=null,m=null;switch(e){case"rows":a=function(){return i.getRowHeader(...arguments)},l=function(){return bw(...arguments)},u="ht__selection--rows",d="top";break;case"columns":a=function(){return i.getColumnHeader(...arguments)},l=function(){return Cw(...arguments)},u="ht__selection--columns",d="left"}if(s.classList.contains(u)){const e=this.wot.getSetting("columnHeaders").length;if(p=a(t,e-n),m=a(r,e-n),!p||!m)return!1;const i=fw(p),s=fw(m);return p&&m&&(h=i[d]-o[d]-1,c=s[d]+l(m)-i[d]),[p,h,c]}return!1}changeBorderStyle(e,t){const r=this[e].style,n=t[e];!n||n.hide?sw(this[e],"hidden"):(iw(this[e],"hidden")&&aw(this[e],"hidden"),r.backgroundColor=n.color,"top"!==e&&"bottom"!==e||(r.height=`${n.width}px`),"start"!==e&&"end"!==e||(r.width=`${n.width}px`))}changeBorderToDefaultStyle(e){const t=1,r="#000",n=this[e].style;n.backgroundColor=r,n.width=`${t}px`,n.height=`${t}px`}toggleHiddenClass(e,t){this.changeBorderToDefaultStyle(e),t?sw(this[e],"hidden"):aw(this[e],"hidden")}disappear(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",LE()&&this.instance.getSetting("isDataViewInstance")&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}destroy(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}};function Mb(e,t,r){_b(e,t),t.set(e,r)}function _b(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xb(e,t){return e.get(Fb(e,t))}function Lb(e,t,r){return e.set(Fb(e,t),r),r}function Fb(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var Pb=new WeakMap,Vb=new WeakMap,Hb=new WeakMap,Db=new WeakMap,Ub=new WeakMap,kb=new WeakMap,Bb=new WeakSet;class Wb{constructor(e){var t,r;_b(t=this,r=Bb),r.add(t),Mb(this,Pb,void 0),Mb(this,Vb,void 0),Mb(this,Hb,new Nb),Mb(this,Db,new WeakMap),Mb(this,Ub,new WeakSet),Mb(this,kb,new Map),Lb(Vb,this,e)}setActiveOverlay(e){return Lb(Pb,this,e),xb(Hb,this).setActiveOverlay(xb(Pb,this)),xb(Db,this).has(xb(Pb,this))||xb(Db,this).set(xb(Pb,this),new Set),this}getFocusSelection(){return null!==xb(Vb,this)?xb(Vb,this).getFocus():null}getAreaSelection(){return null!==xb(Vb,this)?xb(Vb,this).createLayeredArea():null}getBorderInstance(e){if(!e.settings.border)return null;if(xb(kb,this).has(e)){const t=xb(kb,this).get(e);if(t.has(xb(Pb,this)))return t.get(xb(Pb,this));const r=new Ob(xb(Pb,this),e.settings);return t.set(xb(Pb,this),r),r}const t=new Ob(xb(Pb,this),e.settings);return xb(kb,this).set(e,new Map([[xb(Pb,this),t]])),t}getBorderInstances(e){var t,r;return Array.from(null!==(t=null===(r=xb(kb,this).get(e))||void 0===r?void 0:r.values())&&void 0!==t?t:[])}destroyBorders(e){xb(kb,this).get(e).forEach((e=>e.destroy())),xb(kb,this).delete(e)}render(e){if(null===xb(Vb,this))return;e&&Fb(Bb,this,Gb).call(this);const t=Array.from(xb(Vb,this)),r=new Map,n=new Map;for(let o=0;o<t.length;o++){const e=t[o],{className:i,headerAttributes:s,createLayers:a,selectionType:l}=e.settings;xb(Ub,this).has(e)||(xb(Ub,this).add(e),e.addLocalHook("destroy",(()=>this.destroyBorders(e))));const u=this.getBorderInstance(e);if(e.isEmpty()){null==u||u.disappear();continue}if(i){xb(Hb,this).setActiveSelection(e).scan().forEach((e=>{if(r.has(e)){const t=r.get(e);t.has(i)&&!0===a?t.set(i,t.get(i)+1):t.set(i,1)}else r.set(e,new Map([[i,1]]));s&&(n.has(e)||n.set(e,[]),"TH"===e.nodeName&&n.get(e).push(...s))}))}const h=e.getCorners();xb(Pb,this).getSetting("onBeforeDrawBorders",h,l),null==u||u.appear(h)}r.forEach(((e,t)=>{var r;const n=Array.from(e).map((e=>{let[t,r]=e;return 1===r?t:[t,...Array.from({length:r-1},((e,r)=>`${t}-${r+1}`))]})).flat();n.forEach((e=>xb(Db,this).get(xb(Pb,this)).add(e))),sw(t,n),"TD"===t.nodeName&&Array.isArray(null===(r=xb(Vb,this).options)||void 0===r?void 0:r.cellAttributes)&&lw(t,xb(Vb,this).options.cellAttributes)})),Array.from(n.keys()).forEach((e=>{lw(e,[...n.get(e)])}))}}function Gb(){const e=xb(Db,this).get(xb(Pb,this)),t=xb(Pb,this).wtSettings.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(t))for(let r=0;r<t.length;r++)e.add(t[r]);e.forEach((e=>{var t,r;const n=xb(Pb,this).wtTable.TABLE.querySelectorAll(`.${e}`);let o=[];Array.isArray(null===(t=xb(Vb,this).options)||void 0===t?void 0:t.cellAttributes)&&(o=xb(Vb,this).options.cellAttributes.map((e=>e[0]))),Array.isArray(null===(r=xb(Vb,this).options)||void 0===r?void 0:r.headerAttributes)&&(o=[...o,...xb(Vb,this).options.headerAttributes.map((e=>e[0]))]);for(let i=0,s=n.length;i<s;i++)aw(n[i],e),uw(n[i],o)})),e.clear()}class jb extends ZC{constructor(e,t,r,n){super(e,t,PC,r,n)}createTable(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return new ub(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wtTable:e}=this.wot;if(!this.needFullRender||!this.shouldBeRendered()||!e.holder.parentNode)return!1;const{rootWindow:t}=this.domBindings,r=this.clone.wtTable.holder.parentNode,n=this.wtSettings.getSetting("preventOverflow");let o=0;this.trimmingContainer!==t||n&&"horizontal"===n?(o=this.getScrollPosition(),Lw(r)):(o=this.getOverlayOffset()*(this.isRtl()?-1:1),xw(r,`${o}px`,"0px"));const i=this.adjustHeaderBordersPosition(o);return this.adjustElementsSize(),i}setScrollPosition(e){const{rootWindow:t}=this.domBindings;let r=!1;return this.isRtl()&&(e=-e),this.mainTableScrollableElement===t&&t.scrollX!==e?(t.scrollTo(e,yw(t)),r=!0):this.mainTableScrollableElement.scrollLeft!==e&&(this.mainTableScrollableElement.scrollLeft=e,r=!0),r}onScroll(){this.wtSettings.getSetting("onScrollVertically")}sumCellSizes(e,t){const r=this.wtSettings.getSetting("defaultColumnWidth");let n=e,o=0;for(;n<t;)o+=this.wot.wtTable.getColumnWidth(n)||r,n+=1;return o}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:t}=this.wot,{rootDocument:r,rootWindow:n}=this.domBindings,o=this.clone.wtTable.holder.parentNode.style,i=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==n||"vertical"===i){let n=t.getWorkspaceHeight();t.hasHorizontalScroll()&&(n-=_w(r)),n=Math.min(n,e.wtRootElement.scrollHeight),o.height=`${n}px`}else o.height="";this.clone.wtTable.holder.style.height=o.height;const s=Cw(this.clone.wtTable.TABLE);o.width=`${s}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,t=yb(this.wot),r=this.wot.selectionManager.getFocusSelection()?parseInt(t.width,10)/2:0;this.clone.wtTable.hider.style.height=this.hider.style.height,e.style.height=e.parentNode.style.height,e.style.width=`${parseInt(e.parentNode.style.width,10)+r}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalColumns"),t=this.isRtl()?"right":"left";if("number"==typeof this.wot.wtViewport.columnsRenderCalculator.startPosition)this.spreader.style[t]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`;else{if(0!==e)throw new Error("Incorrect value of the columnsRenderCalculator");this.spreader.style[t]="0"}this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){"number"==typeof this.wot.wtViewport.rowsRenderCalculator.startPosition?this.clone.wtTable.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`:this.clone.wtTable.spreader.style.top=""}scrollTo(e,t){const{wtSettings:r}=this,n=r.getSetting("rowHeaders"),o=r.getSetting("fixedColumnsStart"),i=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,s=0===o&&n.length>0&&!iw(i.parentNode,"innerBorderInlineStart")?1:0;let a=this.getTableParentOffset(),l=0;if(t){this.wot.wtTable.getColumnWidth(e)>this.wot.wtViewport.getViewportWidth()&&(t=!1)}var u;return t&&i.offsetWidth!==i.clientWidth&&(l=_w(this.domBindings.rootDocument)),t?(a+=this.sumCellSizes(0,e+1),a-=this.wot.wtViewport.getViewportWidth(),a+=s):a+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),e),a+=l,(u=this.mainTableScrollableElement).scrollWidth-u.clientWidth==a-s&&s>0&&this.wot.wtOverlays.expandHiderHorizontallyBy(s),this.setScrollPosition(a)}getTableParentOffset(){let e=0;return this.wtSettings.getSetting("preventOverflow")||this.trimmingContainer!==this.domBindings.rootWindow||(e=this.wot.wtTable.holderOffset.left),e}getScrollPosition(){return Math.abs(vw(this.mainTableScrollableElement,this.domBindings.rootWindow))}getOverlayOffset(){const{rootWindow:e}=this.domBindings,t=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!t||"horizontal"!==t)){r=this.isRtl()?Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);r>this.wot.wtTable.getTotalWidth()-this.clone.wtTable.getTotalWidth()&&(r=0)}return r}adjustHeaderBordersPosition(e){const{wtSettings:t}=this,r=this.wot.wtTable.holder.parentNode,n=t.getSetting("rowHeaders"),o=t.getSetting("fixedColumnsStart"),i=t.getSetting("totalRows"),s="vertical"===t.getSetting("preventOverflow");i?aw(r,"emptyRows"):sw(r,"emptyRows");let a=!1;if(!s)if(o&&!n.length)sw(r,"innerBorderLeft innerBorderInlineStart");else if(!o&&n.length){const t=iw(r,"innerBorderInlineStart");e?(sw(r,"innerBorderLeft innerBorderInlineStart"),a=!t):(aw(r,"innerBorderLeft innerBorderInlineStart"),a=t)}return a}}const zb={getFirstRenderedRow(){return 0===this.wtSettings.getSetting("totalRows")?-1:0},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){const e=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsTop"),e)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};SE(zb,"MIXIN_NAME","stickyRowsTop",{writable:!1,enumerable:!1});const $b=zb;class Yb extends NC{constructor(e,t,r,n){super(e,t,r,n,VC)}}EE(Yb,$b),EE(Yb,MC);const Xb=Yb;function Kb(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class qb extends ZC{constructor(e,t,r,n,o,i){super(e,t,VC,r,n),Kb(this,"topOverlay",void 0),Kb(this,"inlineStartOverlay",void 0),this.topOverlay=o,this.inlineStartOverlay=i}createTable(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return new Xb(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){xw(e,`${this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1)}px`,`${this.topOverlay.getOverlayOffset()}px`)}else Lw(e);let t=bw(this.clone.wtTable.TABLE);const r=Cw(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(t=0),e.style.height=`${t}px`,e.style.width=`${r}px`,!1}}class Qb extends NC{constructor(e,t,r,n){super(e,t,r,n,LC)}}EE(Qb,$b),EE(Qb,tb);const Zb=Qb;function Jb(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class eN extends ZC{constructor(e,t,r,n){super(e,t,LC,r,n),Jb(this,"cachedFixedRowsTop",-1),this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop")}createTable(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return new Zb(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode,{rootWindow:t}=this.domBindings,r=this.wtSettings.getSetting("preventOverflow");let n=0,o=!1;if(this.trimmingContainer!==t||r&&"vertical"===r)n=this.getScrollPosition(),Lw(e);else{const{wtTable:t}=this.wot,r=t.hider.getBoundingClientRect();o=Math.ceil(r.bottom)===e.offsetHeight,n=this.getOverlayOffset(),xw(e,"0px",`${n}px`)}const i=this.adjustHeaderBordersPosition(n,o);return this.adjustElementsSize(),i}setScrollPosition(e){const t=this.domBindings.rootWindow;let r=!1;return this.mainTableScrollableElement===t&&t.scrollY!==e?(t.scrollTo(ww(t),e),r=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,r=!0),r}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,t){const r=this.wot.stylesHandler.getDefaultRowHeight();let n=e,o=0;for(;n<t;){const e=this.wot.wtTable.getRowHeight(n);o+=void 0===e?r:e,n+=1}return o}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:t}=this.wot,{rootDocument:r,rootWindow:n}=this.domBindings,o=this.clone.wtTable.holder.parentNode.style,i=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==n||"horizontal"===i){let n=t.getWorkspaceWidth();t.hasVerticalScroll()&&(n-=_w(r)),n=Math.min(n,e.wtRootElement.scrollWidth),o.width=`${n}px`}else o.width="";this.clone.wtTable.holder.style.width=o.width;let s=bw(this.clone.wtTable.TABLE);e.hasDefinedSize()||(s=0),o.height=`${s}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,t=yb(this.wot),r=this.wot.selectionManager.getFocusSelection()?parseInt(t.height,10)/2:0;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=`${parseInt(e.parentNode.style.height,10)+r}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if("number"==typeof this.wot.wtViewport.rowsRenderCalculator.startPosition)this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else{if(0!==e)throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.top="0"}this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:t}=this.clone.wtTable;"number"==typeof this.wot.wtViewport.columnsRenderCalculator.startPosition?t.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:t.style[e]=""}scrollTo(e,t){const{wot:r,wtSettings:n}=this,o=(r.cloneSource?r.cloneSource:r).wtTable.holder,i=n.getSetting("columnHeaders"),s=0===n.getSetting("fixedRowsTop")&&i.length>0&&!iw(o.parentNode,"innerBorderTop")?1:0;let a=this.getTableParentOffset(),l=0;if(t){this.wot.wtTable.getRowHeight(e)>this.wot.wtViewport.getViewportHeight()&&(t=!1)}if(t&&o.offsetHeight!==o.clientHeight&&(l=_w(this.domBindings.rootDocument)),t){const t=n.getSetting("fixedRowsBottom"),o=n.getSetting("totalRows");a+=this.sumCellSizes(0,e+1),a-=r.wtViewport.getViewportHeight()-this.sumCellSizes(o-t,o),a+=1,a+=s}else a+=this.sumCellSizes(n.getSetting("fixedRowsTop"),e);var u;return a+=l,(u=this.mainTableScrollableElement).scrollHeight-u.clientHeight==a-s&&s>0&&this.wot.wtOverlays.expandHiderVerticallyBy(s),this.setScrollPosition(a)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return Ew(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,t=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!t||"vertical"!==t)){const e=this.wot.wtTable.getTotalHeight()-this.clone.wtTable.getTotalHeight();r=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),r>e&&(r=0)}return r}adjustHeaderBordersPosition(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const{wtSettings:r}=this,n=this.wot.wtTable.holder.parentNode,o=r.getSetting("totalColumns"),i="horizontal"===r.getSetting("preventOverflow");o?aw(n,"emptyColumns"):sw(n,"emptyColumns");let s=!1;if(!t&&!i){const t=r.getSetting("fixedRowsTop"),o=this.cachedFixedRowsTop!==t,i=r.getSetting("columnHeaders");if((o||0===t)&&i.length>0){const t=iw(n,"innerBorderTop");this.cachedFixedRowsTop=r.getSetting("fixedRowsTop"),e||0===r.getSetting("totalRows")?(sw(n,"innerBorderTop"),s=!t):(aw(n,"innerBorderTop"),s=t)}}return s}}function tN(e,t,r){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,r)}function rN(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function nN(e,t,r){return e.set(iN(e,t),r),r}function oN(e,t){return e.get(iN(e,t))}function iN(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var sN=new WeakMap,aN=new WeakMap,lN=new WeakMap,uN=new WeakMap;const hN=class{constructor(e,t,r,n,o,i){rN(this,"wot",null),tN(this,sN,[]),rN(this,"topOverlay",null),rN(this,"bottomOverlay",null),rN(this,"inlineStartOverlay",null),rN(this,"topInlineStartCornerOverlay",null),rN(this,"bottomInlineStartCornerOverlay",null),rN(this,"browserLineHeight",void 0),rN(this,"wtSettings",null),tN(this,aN,!1),tN(this,lN,0),tN(this,uN,null),rN(this,"resizeObserver",new ResizeObserver((e=>{IE((()=>{Array.isArray(e)&&e.length&&(nN(lN,this,oN(lN,this)+1),100===oN(lN,this)&&(WE("The ResizeObserver callback was fired too many times in direct succession.\nThis may be due to an infinite loop caused by setting a dynamic height/width (for example, with the `dvh` units) to a Handsontable container's parent. \nThe observer will be disconnected."),this.resizeObserver.disconnect()),null!==oN(uN,this)&&clearTimeout(oN(uN,this)),nN(uN,this,setTimeout((()=>{nN(lN,this,0)}),100)),this.wtSettings.getSetting("onContainerElementResize"))}))}))),this.wot=e,this.wtSettings=n,this.domBindings=r,this.facadeGetter=t,this.wtTable=i;const{rootDocument:s,rootWindow:a}=this.domBindings;this.instance=this.wot,this.eventManager=o,this.scrollbarSize=_w(s);const l="hidden"===a.getComputedStyle(i.wtRootElement.parentNode).getPropertyValue("overflow");this.scrollableElement=l?i.holder:Rw(i.TABLE),this.initOverlays(),this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=a.scrollX,this.lastScrollY=a.scrollY}getOverlays(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t=[...oN(sN,this)];return e&&t.push(this.wtTable),t}initBrowserLineHeight(){const{rootWindow:e,rootDocument:t}=this.domBindings,r=e.getComputedStyle(t.body),n=parseInt(r.lineHeight,10),o=1.2*parseInt(r.fontSize,10);this.browserLineHeight=n||o}initOverlays(){const e=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=new eN(...e),this.bottomOverlay=new ib(...e),this.inlineStartOverlay=new jb(...e),this.topInlineStartCornerOverlay=new qb(...e,this.topOverlay,this.inlineStartOverlay),this.bottomInlineStartCornerOverlay=new JC(...e,this.bottomOverlay,this.inlineStartOverlay),nN(sN,this,[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay])}beforeDraw(){nN(aN,this,oN(sN,this).reduce(((e,t)=>t.hasRenderingStateChanged()||e),!1)),oN(sN,this).forEach((e=>e.updateStateOfRendering("before")))}afterDraw(){this.syncScrollWithMaster(),oN(sN,this).forEach((e=>{const t=e.hasRenderingStateChanged();e.updateStateOfRendering("after"),t&&!e.needFullRender&&e.reset()}))}refreshAll(){this.wot.drawn&&(this.wtTable.holder.parentNode?(this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1):this.destroy())}registerListeners(){const{rootDocument:e,rootWindow:t}=this.domBindings,{mainTableScrollableElement:r}=this.topOverlay,{mainTableScrollableElement:n}=this.inlineStartOverlay;this.eventManager.addEventListener(e.documentElement,"keydown",(e=>this.onKeyDown(e))),this.eventManager.addEventListener(e.documentElement,"keyup",(()=>this.onKeyUp())),this.eventManager.addEventListener(e,"visibilitychange",(()=>this.onKeyUp())),this.eventManager.addEventListener(r,"scroll",(e=>this.onTableScroll(e)),{passive:!0}),r!==n&&this.eventManager.addEventListener(n,"scroll",(e=>this.onTableScroll(e)),{passive:!0});const o=t.devicePixelRatio&&t.devicePixelRatio>1,i=this.scrollableElement===t,s=this.wtSettings.getSetting("preventWheel"),a={passive:i};(s||o||!ME.chrome.value)&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",(e=>this.onCloneWheel(e,s)),a);let l;[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay].forEach((e=>{this.eventManager.addEventListener(e.clone.wtTable.holder,"wheel",(e=>this.onCloneWheel(e,s)),a)})),this.eventManager.addEventListener(t,"resize",(()=>{IE((()=>{clearTimeout(l),this.wtSettings.getSetting("onWindowResize"),l=setTimeout((()=>{nN(lN,this,0)}),200)}))})),i||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}onTableScroll(e){const t=this.domBindings.rootWindow,r=this.inlineStartOverlay.mainTableScrollableElement,n=this.topOverlay.mainTableScrollableElement,o=e.target;this.keyPressed&&(n!==t&&o!==t&&!e.target.contains(n)||r!==t&&o!==t&&!e.target.contains(r))||this.syncScrollPositions(e)}onCloneWheel(e,t){const{rootWindow:r}=this.domBindings,n=this.inlineStartOverlay.mainTableScrollableElement,o=this.topOverlay.mainTableScrollableElement,i=e.target,s=o!==r&&i!==r&&!i.contains(o),a=n!==r&&i!==r&&!i.contains(n);if(this.keyPressed&&(s||a)||this.scrollableElement===r)return;const l=this.translateMouseWheelToScroll(e);(t||this.scrollableElement!==r&&l)&&e.preventDefault()}onKeyDown(e){this.keyPressed=function(e,t){const r=t.split("|");let n=!1;return vy(r,(t=>{if(e===VE[t])return n=!0,!1})),n}(e.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}onKeyUp(){this.keyPressed=!1}translateMouseWheelToScroll(e){let t=isNaN(e.deltaY)?-1*e.wheelDeltaY:e.deltaY,r=isNaN(e.deltaX)?-1*e.wheelDeltaX:e.deltaX;1===e.deltaMode&&(r+=r*this.browserLineHeight,t+=t*this.browserLineHeight);const n=this.scrollVertically(t),o=this.scrollHorizontally(r);return n||o}scrollVertically(e){const t=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=e,t!==this.scrollableElement.scrollTop}scrollHorizontally(e){const t=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=e,t!==this.scrollableElement.scrollLeft}syncScrollPositions(){if(this.destroyed)return;const{rootWindow:e}=this.domBindings,t=this.topOverlay.clone.wtTable.holder,r=this.inlineStartOverlay.clone.wtTable.holder,[n,o]=[this.scrollableElement.scrollLeft,this.scrollableElement.scrollTop];if(this.horizontalScrolling=t.scrollLeft!==n||this.lastScrollX!==e.scrollX,this.verticalScrolling=r.scrollTop!==o||this.lastScrollY!==e.scrollY,this.lastScrollX=e.scrollX,this.lastScrollY=e.scrollY,this.horizontalScrolling){t.scrollLeft=n;const e=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;e&&(e.scrollLeft=n)}this.verticalScrolling&&(r.scrollTop=o),this.refreshAll()}syncScrollWithMaster(){if(!oN(aN,this))return;const e=this.topOverlay.mainTableScrollableElement,{scrollLeft:t,scrollTop:r}=e;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=t),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=t),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=r),nN(aN,this,!1)}updateMainScrollableElements(){this.eventManager.clearEvents(!0),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();const{wtTable:e}=this,{rootWindow:t}=this.domBindings;"hidden"===t.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")?this.scrollableElement=e.holder:this.scrollableElement=Rw(e.TABLE),this.registerListeners()}destroy(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}refresh(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.updateLastSpreaderSize()&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(e),this.inlineStartOverlay.refresh(e),this.topOverlay.refresh(e),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(e),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(e)}updateLastSpreaderSize(){const e=this.wtTable.spreader,t=e.clientWidth,r=e.clientHeight,n=t!==this.spreaderLastSize.width||r!==this.spreaderLastSize.height;return n&&(this.spreaderLastSize.width=t,this.spreaderLastSize.height=r),n}adjustElementsSize(){const{wtViewport:e}=this.wot,{wtTable:t}=this,{rootWindow:r}=this.domBindings,n=this.scrollableElement===r,o=this.wtSettings.getSetting("totalColumns"),i=this.wtSettings.getSetting("totalRows"),s=e.getRowHeaderWidth(),a=e.getColumnHeaderHeight()+this.topOverlay.sumCellSizes(0,i)+1,l=s+this.inlineStartOverlay.sumCellSizes(0,o),u=t.hider.style,h=(()=>!n&&this.scrollableElement.scrollTop>Math.max(0,a-t.holder.clientHeight))()?1:0,c=(()=>!n&&this.scrollableElement.scrollLeft>Math.max(0,l-t.holder.clientWidth))()?1:0;u.width=`${l+c}px`,u.height=`${a+h}px`,this.topOverlay.adjustElementsSize(),this.inlineStartOverlay.adjustElementsSize(),this.bottomOverlay.adjustElementsSize()}expandHiderVerticallyBy(e){const{wtTable:t}=this;t.hider.style.height=`${parseInt(t.hider.style.height,10)+e}px`}expandHiderHorizontallyBy(e){const{wtTable:t}=this;t.hider.style.width=`${parseInt(t.hider.style.width,10)+e}px`}applyToDOM(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}getParentOverlay(e){if(!e)return null;const t=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];let r=null;return vy(t,(t=>{t&&t.clone&&t.clone.wtTable.TABLE.contains(e)&&(r=t.clone)})),r}syncOverlayTableClassNames(){const e=this.wtTable.TABLE;vy([this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay],(t=>{t&&(t.clone.wtTable.TABLE.className=e.className)}))}};function cN(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class dN{constructor(e){cN(this,"settings",{}),cN(this,"defaults",Object.freeze(this.getDefaults())),TE(this.defaults,((t,r)=>{if(void 0!==e[r])this.settings[r]=e[r];else{if(void 0===t)throw new Error(`A required setting "${r}" was not provided`);this.settings[r]=t}}))}getDefaults(){return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,currentRowClassName:null,currentColumnClassName:null,preventOverflow:()=>!1,preventWheel:!1,data:void 0,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:()=>this.getSetting("fixedColumnsStart")>0||this.getSetting("rowHeaders").length>0,shouldRenderTopOverlay:()=>this.getSetting("fixedRowsTop")>0||this.getSetting("columnHeaders").length>0,shouldRenderBottomOverlay:()=>this.getSetting("fixedRowsBottom")>0,minSpareRows:0,rowHeaders:()=>[],columnHeaders:()=>[],totalRows:void 0,totalColumns:void 0,cellRenderer:(e,t,r)=>{const n=this.getSetting("data",e,t);mw(r,null==n?"":n)},columnWidth(){},rowHeight(){},rowHeightByOverlayName(){},defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,viewportRowRenderingThreshold:null,viewportColumnRenderingThreshold:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onBeforeViewportScrollHorizontally:e=>e,onBeforeViewportScrollVertically:e=>e,onScrollHorizontally:null,onScrollVertically:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onModifyGetCoordsElement:null,onModifyGetCoords:null,onBeforeHighlightingRowHeader:e=>e,onBeforeHighlightingColumnHeader:e=>e,onWindowResize:null,onContainerElementResize:null,renderAllColumns:!1,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1,ariaTags:!0}}update(e,t){return void 0===t?TE(e,((e,t)=>{this.settings[t]=e})):this.settings[e]=t,this}getSetting(e,t,r,n,o){return"function"==typeof this.settings[e]?this.settings[e](t,r,n,o):void 0!==t&&Array.isArray(this.settings[e])?this.settings[e][t]:this.settings[e]}getSettingPure(e){return this.settings[e]}has(e){return!!this.settings[e]}}class pN extends NC{constructor(e,t,r,n){super(e,t,r,n,"master")}alignOverlaysWithTrimmingContainer(){const e=Sw(this.wtRootElement),{rootWindow:t}=this.domBindings;if(e===t){this.wtSettings.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible")}else{const r=e.parentElement,n=Tw(e,"height",t),o=Tw(e,"overflow",t),i=this.holder.style,{scrollWidth:s,scrollHeight:a}=e;let l=e.offsetWidth,u=e.offsetHeight;if(r&&["auto","hidden","scroll"].includes(o)){const n=e.cloneNode(!1);n.style.overflow="auto",n.style.position="absolute",e.nextElementSibling?r.insertBefore(n,e.nextElementSibling):r.appendChild(n);const o=parseInt(t.getComputedStyle(n).height,10);r.removeChild(n),0===o&&(u=0)}u=Math.min(u,a),i.height="auto"===n?"auto":`${u}px`,l=Math.min(l,s),i.width=`${l}px`,i.overflow="",this.hasTableHeight="auto"===i.height||u>0,this.hasTableWidth=l>0}this.isTableVisible=gw(this.TABLE)}markOversizedColumnHeaders(){const{wtSettings:e}=this,{wtViewport:t}=this.dataAccessObject,r="master",n=e.getSetting("columnHeaders").length;if(n&&!t.hasOversizedColumnHeadersMarked[r]){const o=e.getSetting("rowHeaders").length,i=this.getRenderedColumnsCount();for(let e=0;e<n;e++)for(let t=-1*o;t<i;t++)this.markIfOversizedColumnHeader(t);t.hasOversizedColumnHeadersMarked[r]=!0}}}EE(pN,ab),EE(pN,tb);const mN=pN;const gN=class{constructor(e,t,r,n,o){this.dataAccessObject=e,this.wot=e.wot,this.instance=this.wot,this.domBindings=t,this.wtSettings=r,this.wtTable=o,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.rowsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllRows")?new jS:new XS],["fullyVisible",()=>new VS],["partiallyVisible",()=>new kS]]),this.columnsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllColumns")?new WS:new $S],["fullyVisible",()=>new FS],["partiallyVisible",()=>new DS]]),this.eventManager=n,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",(()=>{this.clientHeight=this.getWorkspaceHeight()}))}getWorkspaceHeight(){const e=this.domBindings.rootDocument,t=this.dataAccessObject.topOverlayTrimmingContainer;let r=0;if(t===this.domBindings.rootWindow)r=e.documentElement.clientHeight;else{r=bw(t)>0&&t.clientHeight>0?t.clientHeight:1/0}return r}getViewportHeight(){let e=this.getWorkspaceHeight();if(e===1/0)return e;const t=this.getColumnHeaderHeight();return t>0&&(e-=t),e}getWorkspaceWidth(){const{rootDocument:e,rootWindow:t}=this.domBindings,r=this.dataAccessObject.inlineStartOverlayTrimmingContainer;let n;if(r===t){const t=this.wtSettings.getSetting("totalColumns");n=this.wtTable.holder.offsetWidth,this.getRowHeaderWidth()+this.sumColumnWidths(0,t)>n&&(n=e.documentElement.clientWidth)}else n=r.clientWidth;return n}getViewportWidth(){const e=this.getWorkspaceWidth();if(e===1/0)return e;const t=this.getRowHeaderWidth();return t>0?e-t:e}hasVerticalScroll(){if(this.isVerticallyScrollableByWindow()){const e=this.domBindings.rootDocument.documentElement;return e.scrollHeight>e.clientHeight}const{holder:e,hider:t}=this.wtTable,r=e.clientHeight,n=t.offsetHeight;return r<n||n>this.getWorkspaceHeight()}hasHorizontalScroll(){if(this.isVerticallyScrollableByWindow()){const e=this.domBindings.rootDocument.documentElement;return e.scrollWidth>e.clientWidth}const{holder:e,hider:t}=this.wtTable,r=e.clientWidth,n=t.offsetWidth;return r<n||n>this.getWorkspaceWidth()}isVerticallyScrollableByWindow(){return this.dataAccessObject.topOverlayTrimmingContainer===this.domBindings.rootWindow}isHorizontallyScrollableByWindow(){return this.dataAccessObject.inlineStartOverlayTrimmingContainer===this.domBindings.rootWindow}sumColumnWidths(e,t){let r=0,n=e;for(;n<t;)r+=this.wtTable.getColumnWidth(n),n+=1;return r}getWorkspaceOffset(){return fw(this.wtTable.holder)}getColumnHeaderHeight(){return this.wtSettings.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=bw(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}getRowHeaderWidth(){const e=this.wtSettings.getSetting("rowHeaderWidth"),t=this.wtSettings.getSetting("rowHeaders");if(e){this.rowHeaderWidth=0;for(let r=0,n=t.length;r<n;r++)this.rowHeaderWidth+=e[r]||e}if(isNaN(this.rowHeaderWidth))if(t.length){let e=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(let r=0,n=t.length;r<n;r++)e?(this.rowHeaderWidth+=Cw(e),e=e.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}createRowsCalculator(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:t,wtTable:r}=this;let n,o,i=this.getViewportHeight();this.rowHeaderWidth=NaN;let s=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset;const a=t.getSetting("fixedRowsTop"),l=t.getSetting("fixedRowsBottom"),u=t.getSetting("totalRows");return a&&s>=0&&(o=this.dataAccessObject.topOverlay.sumCellSizes(0,a),s+=o,i-=o),l&&this.dataAccessObject.bottomOverlay.clone&&(o=this.dataAccessObject.bottomOverlay.sumCellSizes(u-l,u),i-=o),n=r.holder.clientHeight===r.holder.offsetHeight?0:_w(this.domBindings.rootDocument),new tT({calculationTypes:e.map((e=>[e,this.rowsCalculatorTypes.get(e)()])),viewportHeight:i,scrollOffset:s,totalRows:t.getSetting("totalRows"),defaultRowHeight:this.instance.stylesHandler.getDefaultRowHeight(),rowHeightFn:e=>r.getRowHeight(e),overrideFn:t.getSettingPure("viewportRowCalculatorOverride"),horizontalScrollbarHeight:n})}createColumnsCalculator(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:t,wtTable:r}=this;let n=this.getViewportWidth(),o=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;const i=t.getSetting("fixedColumnsStart");if(i&&o>=0){const e=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,i);o+=e,n-=e}return r.holder.clientWidth!==r.holder.offsetWidth&&(n-=_w(this.domBindings.rootDocument)),new JS({calculationTypes:e.map((e=>[e,this.columnsCalculatorTypes.get(e)()])),viewportWidth:n,scrollOffset:o,totalColumns:t.getSetting("totalColumns"),columnWidthFn:e=>r.getColumnWidth(e),overrideFn:t.getSettingPure("viewportColumnCalculatorOverride"),inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}createCalculators(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const{wtSettings:t}=this,r=this.createRowsCalculator(),n=this.createColumnsCalculator();if(e&&!t.getSetting("renderAllRows")){const t=r.getResultsFor("fullyVisible");e=this.areAllProposedVisibleRowsAlreadyRendered(t)}if(e&&!t.getSetting("renderAllColumns")){const t=n.getResultsFor("fullyVisible");e=this.areAllProposedVisibleColumnsAlreadyRendered(t)}return e||(this.rowsRenderCalculator=r.getResultsFor("rendered"),this.columnsRenderCalculator=n.getResultsFor("rendered")),this.rowsVisibleCalculator=r.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=n.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=r.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=n.getResultsFor("partiallyVisible"),e}createVisibleCalculators(){const e=this.createRowsCalculator(["fullyVisible","partiallyVisible"]),t=this.createColumnsCalculator(["fullyVisible","partiallyVisible"]);this.rowsVisibleCalculator=e.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=t.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=e.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=t.getResultsFor("partiallyVisible")}areAllProposedVisibleRowsAlreadyRendered(e){if(!this.rowsVisibleCalculator)return!1;let{startRow:t,endRow:r}=e;if(null===t&&null===r){if(!e.isVisibleInTrimmingContainer)return!0;t=this.rowsPartiallyVisibleCalculator.startRow,r=this.rowsPartiallyVisibleCalculator.endRow}const{startRow:n,endRow:o,rowStartOffset:i,rowEndOffset:s}=this.rowsRenderCalculator,a=this.wtSettings.getSetting("totalRows")-1,l=this.wtSettings.getSetting("viewportRowRenderingThreshold");return Number.isInteger(l)&&l>0?(t=Math.max(0,t-Math.min(i,l)),r=Math.min(a,r+Math.min(s,l))):"auto"===l&&(t=Math.max(0,t-Math.ceil(i/2)),r=Math.min(a,r+Math.ceil(s/2))),!(t<n||t===n&&t>0)&&!(r>o||r===o&&r<a)}areAllProposedVisibleColumnsAlreadyRendered(e){if(!this.columnsVisibleCalculator)return!1;let{startColumn:t,endColumn:r}=e;if(null===t&&null===r){if(!e.isVisibleInTrimmingContainer)return!0;t=this.columnsPartiallyVisibleCalculator.startColumn,r=this.columnsPartiallyVisibleCalculator.endColumn}const{startColumn:n,endColumn:o,columnStartOffset:i,columnEndOffset:s}=this.columnsRenderCalculator,a=this.wtSettings.getSetting("totalColumns")-1,l=this.wtSettings.getSetting("viewportColumnRenderingThreshold");return Number.isInteger(l)&&l>0?(t=Math.max(0,t-Math.min(i,l)),r=Math.min(a,r+Math.min(s,l))):"auto"===l&&(t=Math.max(0,t-Math.ceil(i/2)),r=Math.min(a,r+Math.ceil(s/2))),!(t<n||t===n&&t>0)&&!(r>o||r===o&&r<a)}resetHasOversizedColumnHeadersMarked(){TE(this.hasOversizedColumnHeadersMarked,((e,t,r)=>{r[t]=void 0}))}};function fN(e,t,r){yN(e,t),t.set(e,r)}function yN(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function wN(e,t){return e.get(vN(e,t))}function EN(e,t,r){return e.set(vN(e,t),r),r}function vN(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var RN=new WeakMap,SN=new WeakMap,TN=new WeakMap,CN=new WeakMap,bN=new WeakMap,NN=new WeakMap,AN=new WeakMap,IN=new WeakSet;class ON{constructor(e){var t,r;yN(t=this,r=IN),r.add(t),fN(this,RN,void 0),fN(this,SN,void 0),fN(this,TN,void 0),fN(this,CN,void 0),fN(this,bN,!0),fN(this,NN,{}),fN(this,AN,{}),EN(SN,this,e.rootTable.parentElement.parentElement),EN(CN,this,e.rootDocument)}isClassicTheme(){return wN(bN,this)}getCSSVariableValue(e){var t;if(wN(bN,this))return null;if(wN(NN,this)[`--ht-${e}`])return wN(NN,this)[`--ht-${e}`];const r=null!==(t=vN(IN,this,FN).call(this,`--ht-${e}`))&&void 0!==t?t:vN(IN,this,PN).call(this,`--ht-${e}`);return null!==r?(wN(NN,this)[`--ht-${e}`]=r,r):void 0}getStyleForTD(e){var t;return null===(t=wN(AN,this))||void 0===t?void 0:t.td[e]}getDefaultRowHeight(){if(wN(bN,this))return 23;const e=vN(IN,this,MN).call(this);return!e&&iw(wN(SN,this),"ht-wrapper")?(WE(`The "${wN(RN,this)}" theme is enabled, but its stylesheets are missing or not imported correctly. Import the correct CSS files in order to use that theme.`),EN(bN,this,!0),this.useTheme(),23):e}areCellsBorderBox(){return"border-box"===this.getStyleForTD("box-sizing")}useTheme(e){if(!e)return vN(IN,this,xN).call(this),EN(bN,this,!0),void EN(RN,this,e||void 0);e&&e!==wN(RN,this)&&(wN(RN,this)&&vN(IN,this,VN).call(this),EN(RN,this,e),EN(bN,this,!1),vN(IN,this,_N).call(this),vN(IN,this,xN).call(this))}getThemeName(){return wN(RN,this)}removeClassNames(){iw(wN(SN,this),wN(RN,this))&&aw(wN(SN,this),wN(RN,this))}}function MN(){const e=this.getCSSVariableValue("line-height"),t=this.getCSSVariableValue("cell-vertical-padding"),r=Math.ceil(parseFloat(this.getStyleForTD("border-bottom-width")));return null===e||null===t||isNaN(r)?null:e+2*t+r}function _N(){aw(wN(SN,this),/ht-theme-.*/g),sw(wN(SN,this),wN(RN,this))}function xN(){this.isClassicTheme()||EN(TN,this,getComputedStyle(wN(SN,this)));const e=vN(IN,this,LN).call(this,["box-sizing","border-bottom-width"]);wN(AN,this).td={...wN(AN,this).td,"box-sizing":e["box-sizing"],"border-bottom-width":e["border-bottom-width"]}}function LN(e){const t=wN(CN,this),r=wN(SN,this),n=t.createElement("table"),o=t.createElement("tbody"),i=t.createElement("tr"),s=t.createElement("tr"),a=t.createElement("td");s.appendChild(a),o.appendChild(i),o.appendChild(s),n.appendChild(o),r.appendChild(n);const l=getComputedStyle(a),u={};return e.forEach((e=>{u[e]=l.getPropertyValue(e)})),r.removeChild(n),u}function FN(e){const t=Math.ceil(parseFloat(vN(IN,this,PN).call(this,e)));return Number.isNaN(t)?null:t}function PN(e){const t=wN(TN,this).getPropertyValue(e);return""===t?null:t}function VN(){EN(AN,this,{}),EN(NN,this,{}),EN(bN,this,!0)}class HN extends XC{constructor(e,t){super(e,new dN(t)),this.stylesHandler=new ON(this.domBindings);const r=this.wtSettings.getSetting("facade",this);this.wtTable=new mN(this.getTableDao(),r,this.domBindings,this.wtSettings),this.wtViewport=new gN(this.getViewportDao(),this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.selectionManager=new Wb(this.wtSettings.getSetting("selections")),this.wtEvent=new _T(r,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager),this.wtOverlays=new hN(this,r,this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.exportSettingsAsClassNames(),this.findOriginalHeaders()}exportSettingsAsClassNames(){const e=[],t=[];TE({rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},((r,n)=>{this.wtSettings.getSetting(n).length&&t.push(r),e.push(r)})),aw(this.wtTable.wtRootElement.parentNode,e),sw(this.wtTable.wtRootElement.parentNode,t)}getOverlayByName(e){var t;if(!DC.includes(e))return null;const r=e.replace(/_([a-z])/g,(e=>e[1].toUpperCase()));return null!==(t=this.wtOverlays[`${r}Overlay`])&&void 0!==t?t:null}getViewportDao(){const e=this;return{get wot(){return e},get topOverlayTrimmingContainer(){return e.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return e.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return e.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return e.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return e.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return e.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get bottomOverlay(){return e.wtOverlays.bottomOverlay}}}}class DN{constructor(e){e instanceof XC?this._wot=e:this._initFromSettings(e)}_initFromSettings(e){e.facade=e=>{const t=new DN(e);return()=>t},this._wot=new HN(e.table,e)}get guid(){return this._wot.guid}get rootDocument(){return this._wot.domBindings.rootDocument}get rootWindow(){return this._wot.domBindings.rootWindow}get wtSettings(){return this._wot.wtSettings}get cloneSource(){return this._wot.cloneSource}get cloneOverlay(){return this._wot.cloneOverlay}get selectionManager(){return this._wot.selectionManager}get wtViewport(){return this._wot.wtViewport}get wtOverlays(){return this._wot.wtOverlays}get wtTable(){return this._wot.wtTable}get wtEvent(){return this._wot.wtEvent}get wtScroll(){return this._wot.wtScroll}get drawn(){return this._wot.drawn}set drawn(e){this._wot.drawn=e}get activeOverlayName(){return this._wot.activeOverlayName}get drawInterrupted(){return this._wot.drawInterrupted}set drawInterrupted(e){this._wot.drawInterrupted=e}get lastMouseOver(){return this._wot.lastMouseOver}set lastMouseOver(e){this._wot.lastMouseOver=e}get momentumScrolling(){return this._wot.momentumScrolling}set momentumScrolling(e){this._wot.momentumScrolling=e}get touchApplied(){return this._wot.touchApplied}set touchApplied(e){this._wot.touchApplied=e}get domBindings(){return this._wot.domBindings}get eventListeners(){return this._wot.eventListeners}set eventListeners(e){this._wot.eventListeners=e}get eventManager(){return this._wot.eventManager}get stylesHandler(){return this._wot.stylesHandler}createCellCoords(e,t){return this._wot.createCellCoords(e,t)}createCellRange(e,t,r){return this._wot.createCellRange(e,t,r)}draw(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this._wot.draw(e),this}getCell(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this._wot.getCell(e,t)}scrollViewport(e,t,r){return this._wot.scrollViewport(e,t,r)}scrollViewportHorizontally(e,t){return this._wot.scrollViewportHorizontally(e,t)}scrollViewportVertically(e,t){return this._wot.scrollViewportVertically(e,t)}getViewport(){return this._wot.getViewport()}getOverlayName(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}getOverlayByName(e){return this._wot.getOverlayByName(e)}exportSettingsAsClassNames(){return this._wot.exportSettingsAsClassNames()}update(e,t){return this._wot.wtSettings.update(e,t),this}getSetting(e,t,r,n,o){return this._wot.wtSettings.getSetting(e,t,r,n,o)}hasSetting(e){return this._wot.wtSettings.hasSetting(e)}destroy(){this._wot.destroy()}}function UN(e){let{isShiftKey:t,isLeftClick:r,isRightClick:n,coords:o,selection:i,controller:s,cellCoordsFactory:a}=e;const l=i.isSelected()?i.getSelectedRange().current():null,u=i.isSelectedByCorner(),h=i.isSelectedByRowHeader();if(i.markSource("mouse"),t&&l)o.row>=0&&o.col>=0&&!s.cell?i.setRangeEnd(o):(u||h)&&o.row>=0&&o.col>=0&&!s.cell?i.setRangeEnd(a(o.row,o.col)):u&&o.row<0&&!s.column?i.setRangeEnd(a(l.to.row,o.col)):h&&o.col<0&&!s.row?i.setRangeEnd(a(o.row,l.to.col)):(!u&&!h&&o.col<0||u&&o.col<0)&&!s.row?i.selectRows(Math.max(l.from.row,0),o.row,o.col):(!u&&!h&&o.row<0||h&&o.row<0)&&!s.column&&i.selectColumns(Math.max(l.from.col,0),o.col,o.row);else{const e=!i.inInSelection(o),t=r||n&&e;o.row<0&&o.col>=0&&!s.column?t&&i.selectColumns(o.col,o.col,o.row):o.col<0&&o.row>=0&&!s.row?t&&i.selectRows(o.row,o.row,o.col):o.col>=0&&o.row>=0&&!s.cell?t&&i.setRangeStart(o):o.col<0&&o.row<0&&i.selectAll(!0,!0,{disableHeadersHighlight:!0,focusPosition:{row:0,col:0}})}i.markEndSource()}const kN=new Map([["mousedown",UN],["mouseover",function(e){let{isLeftClick:t,coords:r,selection:n,controller:o,cellCoordsFactory:i}=e;if(!t)return;const s=n.isSelectedByRowHeader(),a=n.isSelectedByColumnHeader(),l=n.tableProps.countCols(),u=n.tableProps.countRows();n.markSource("mouse"),a&&!o.column?n.setRangeEnd(i(u-1,r.col)):s&&!o.row?n.setRangeEnd(i(r.row,l-1)):o.cell||n.setRangeEnd(r),n.markEndSource()}],["touchstart",UN]]);function BN(e,t){let{coords:r,selection:n,controller:o,cellCoordsFactory:i}=t;kN.get(e.type)({coords:r,selection:n,controller:o,cellCoordsFactory:i,isShiftKey:e.shiftKey,isLeftClick:BE(e)||"touchstart"===e.type,isRightClick:kE(e)})}const WN=new WeakMap,GN=Symbol("rootInstance");function jN(e){return e===GN}function zN(e){return WN.has(e)}function $N(e,t,r){YN(e,t),t.set(e,r)}function YN(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function XN(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function KN(e,t){return e.get(QN(e,t))}function qN(e,t,r){return e.set(QN(e,t),r),r}function QN(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var ZN=new WeakMap,JN=new WeakMap,eA=new WeakMap,tA=new WeakMap,rA=new WeakMap,nA=new WeakMap,oA=new WeakMap,iA=new WeakMap,sA=new WeakSet;function aA(){return parseInt(this.hot.rootElement.getAttribute($y()[0]),10)}function lA(e){const t=QN(sA,this,aA).call(this)+e;lw(this.hot.rootElement,...$y(t))}function uA(){const e=this.hot.rootElement;this.hasVerticalScroll()?sw(e,"htHasScrollY"):aw(e,"htHasScrollY"),this.hasHorizontalScroll()?sw(e,"htHasScrollX"):aw(e,"htHasScrollX")}const hA=class{constructor(e){var t,r;YN(t=this,r=sA),r.add(t),XN(this,"hot",void 0),XN(this,"eventManager",void 0),XN(this,"settings",void 0),XN(this,"THEAD",void 0),XN(this,"TBODY",void 0),XN(this,"_wt",void 0),XN(this,"activeWt",void 0),$N(this,ZN,0),$N(this,JN,0),XN(this,"postponedAdjustElementsSize",!1),$N(this,eA,!1),$N(this,tA,void 0),$N(this,rA,void 0),$N(this,nA,0),$N(this,oA,0),$N(this,iA,null),this.hot=e,this.eventManager=new Uv(this.hot),this.settings=this.hot.getSettings(),this.createElements(),this.registerEvents(),this.initializeWalkontable()}render(){this.hot.isRenderSuspended()||(this.hot.runHooks("beforeRender",this.hot.forceFullRender),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize()),this._wt.draw(!this.hot.forceFullRender),QN(sA,this,uA).call(this),this.hot.runHooks("afterRender",this.hot.forceFullRender),this.hot.forceFullRender=!1,this.hot.renderCall=!1)}adjustElementsSize(){this.hot.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize()}getCellAtCoords(e,t){const r=this._wt.getCell(e,t);return r<0?null:r}scrollViewport(e,t,r){return this._wt.scrollViewport(e,t,r)}scrollViewportHorizontally(e,t){return this._wt.scrollViewportHorizontally(e,t)}scrollViewportVertically(e,t){return this._wt.scrollViewportVertically(e,t)}createElements(){const{rootElement:e,rootDocument:t}=this.hot,r=e.getAttribute("style");r&&e.setAttribute("data-originalstyle",r),sw(e,"handsontable"),qN(rA,this,t.createElement("TABLE")),sw(KN(rA,this),"htCore"),this.hot.getSettings().tableClassName&&sw(KN(rA,this),this.hot.getSettings().tableClassName),this.settings.ariaTags&&(lw(KN(rA,this),[Gy()]),lw(e,[["role","treegrid"],zy(-1),$y(this.hot.countCols()),["aria-multiselectable","true"]])),this.THEAD=t.createElement("THEAD"),KN(rA,this).appendChild(this.THEAD),this.TBODY=t.createElement("TBODY"),KN(rA,this).appendChild(this.TBODY),this.hot.table=KN(rA,this),this.hot.container.insertBefore(KN(rA,this),this.hot.container.firstChild)}registerEvents(){const{rootElement:e,rootDocument:t,selection:r,rootWindow:n}=this.hot,o=t.documentElement;this.eventManager.addEventListener(e,"mousedown",(e=>{qN(eA,this,!0),this.isTextSelectionAllowed(e.target)||(Iw(n),e.preventDefault(),n.focus())})),this.eventManager.addEventListener(e,"mouseup",(()=>{qN(eA,this,!1)})),this.eventManager.addEventListener(e,"mousemove",(e=>{KN(eA,this)&&!this.isTextSelectionAllowed(e.target)&&(this.settings.fragmentSelection&&Iw(n),e.preventDefault())})),this.eventManager.addEventListener(o,"keyup",(e=>{r.isInProgress()&&!e.shiftKey&&r.finish()})),this.eventManager.addEventListener(o,"mouseup",(n=>{r.isInProgress()&&BE(n)&&r.finish(),qN(tA,this,!1);const o=Pw(t.activeElement);Fw(t.activeElement)&&!o||!o&&(r.isSelected()||r.isSelectedByAnyHeader()||e.contains(n.target)||kE(n))||this.hot.unlisten()})),this.eventManager.addEventListener(o,"contextmenu",(e=>{r.isInProgress()&&kE(e)&&(r.finish(),qN(tA,this,!1))})),this.eventManager.addEventListener(o,"touchend",(()=>{r.isInProgress()&&r.finish(),qN(tA,this,!1)})),this.eventManager.addEventListener(o,"mousedown",(r=>{const n=r.target,i=r.x||r.clientX,s=r.y||r.clientY;let a=r.target;if(KN(tA,this)||!e||!this.hot.view)return;const{holder:l}=this._wt.wtTable;if(a===l){const e=_w(t);if(t.elementFromPoint(i+e,s)!==l||t.elementFromPoint(i,s+e)!==l)return}else for(;a!==o;){if(null===a){if(r.isTargetWebComponent)break;return}if(a===e)return;a=a.parentNode}("function"==typeof this.settings.outsideClickDeselects?this.settings.outsideClickDeselects(n):this.settings.outsideClickDeselects)?this.hot.deselectCell():this.hot.destroyEditor(!1,!1)}));let i=Zy(n);for(;null!==i;)this.eventManager.addEventListener(i.document.documentElement,"click",(()=>{this.hot.unlisten()})),i=Zy(i);this.eventManager.addEventListener(KN(rA,this),"selectstart",(e=>{this.settings.fragmentSelection||Fw(e.target)||e.preventDefault()}))}translateFromRenderableToVisualCoords(e){let{row:t,col:r}=e;return this.hot._createCellCoords(...this.translateFromRenderableToVisualIndex(t,r))}translateFromRenderableToVisualIndex(e,t){let r=e>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(e):e,n=t>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(t):t;return null===r&&(r=e),null===n&&(n=t),[r,n]}countRenderableIndexes(e,t){const r=Math.min(e.getNotTrimmedIndexesLength(),t),n=e.getNearestNotHiddenIndex(r-1,-1);return null===n?0:e.getRenderableFromVisualIndex(n)+1}countRenderableColumns(){return this.countRenderableIndexes(this.hot.columnIndexMapper,this.settings.maxCols)}countRenderableRows(){return this.countRenderableIndexes(this.hot.rowIndexMapper,this.settings.maxRows)}countNotHiddenRowIndexes(e,t){return this.countNotHiddenIndexes(e,t,this.hot.rowIndexMapper,this.countRenderableRows())}countNotHiddenColumnIndexes(e,t){return this.countNotHiddenIndexes(e,t,this.hot.columnIndexMapper,this.countRenderableColumns())}countNotHiddenIndexes(e,t,r,n){if(isNaN(e)||e<0)return 0;const o=r.getNearestNotHiddenIndex(e,t),i=r.getRenderableFromVisualIndex(o);if(!Number.isInteger(i))return 0;let s=0;return t<0?s=i+1:t>0&&(s=n-i),s}countNotHiddenFixedColumnsStart(){const e=this.hot.countCols(),t=Math.min(parseInt(this.settings.fixedColumnsStart,10),e)-1;return this.countNotHiddenColumnIndexes(t,-1)}countNotHiddenFixedRowsTop(){const e=this.hot.countRows(),t=Math.min(parseInt(this.settings.fixedRowsTop,10),e)-1;return this.countNotHiddenRowIndexes(t,-1)}countNotHiddenFixedRowsBottom(){const e=this.hot.countRows(),t=Math.max(e-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(t,1)}countRenderableColumnsInRange(e,t){let r=0;for(let n=e;n<=t;n++)null!==this.hot.columnIndexMapper.getRenderableFromVisualIndex(n)&&(r+=1);return r}countRenderableRowsInRange(e,t){let r=0;for(let n=e;n<=t;n++)null!==this.hot.rowIndexMapper.getRenderableFromVisualIndex(n)&&(r+=1);return r}getStylesHandler(){return this._wt.stylesHandler}getDefaultRowHeight(){return this._wt.stylesHandler.getDefaultRowHeight()}addClassNameToLicenseElement(e){var t;const r=null===(t=this.hot.rootElement.parentNode)||void 0===t?void 0:t.querySelector(".hot-display-license-info");r&&sw(r,e)}removeClassNameFromLicenseElement(e){var t;const r=null===(t=this.hot.rootElement.parentNode)||void 0===t?void 0:t.querySelector(".hot-display-license-info");r&&aw(r,e)}isMainTableNotFullyCoveredByOverlays(){const e=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),t=this.countNotHiddenFixedColumnsStart();return this.hot.countRenderedRows()>e&&this.hot.countRenderedCols()>t}initializeWalkontable(){const e={ariaTags:this.settings.ariaTags,rtlMode:this.hot.isRtl(),externalRowCalculator:this.hot.getPlugin("autoRowSize")&&this.hot.getPlugin("autoRowSize").isEnabled(),table:KN(rA,this),isDataViewInstance:()=>zN(this.hot),preventOverflow:()=>this.settings.preventOverflow,preventWheel:()=>this.settings.preventWheel,viewportColumnRenderingThreshold:()=>this.settings.viewportColumnRenderingThreshold,viewportRowRenderingThreshold:()=>this.settings.viewportRowRenderingThreshold,data:(e,t)=>this.hot.getDataAtCell(...this.translateFromRenderableToVisualIndex(e,t)),totalRows:()=>this.countRenderableRows(),totalColumns:()=>this.countRenderableColumns(),fixedColumnsStart:()=>this.countNotHiddenFixedColumnsStart(),fixedRowsTop:()=>this.countNotHiddenFixedRowsTop(),fixedRowsBottom:()=>this.countNotHiddenFixedRowsBottom(),shouldRenderInlineStartOverlay:()=>this.settings.fixedColumnsStart>0||e.rowHeaders().length>0,shouldRenderTopOverlay:()=>this.settings.fixedRowsTop>0||e.columnHeaders().length>0,shouldRenderBottomOverlay:()=>this.settings.fixedRowsBottom>0,minSpareRows:()=>this.settings.minSpareRows,renderAllRows:this.settings.renderAllRows,renderAllColumns:this.settings.renderAllColumns,rowHeaders:()=>{const e=[];return this.hot.hasRowHeaders()&&e.push(((e,t)=>{const r=e>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(e):e;this.appendRowHeader(r,t)})),this.hot.runHooks("afterGetRowHeaderRenderers",e),qN(JN,this,e.length),this.hot.getSettings().ariaTags&&QN(sA,this,aA).call(this)===this.hot.countCols()&&QN(sA,this,lA).call(this,KN(JN,this)),e},columnHeaders:()=>{const e=[];return this.hot.hasColHeaders()&&e.push(((e,t)=>{const r=e>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(e):e;this.appendColHeader(r,t)})),this.hot.runHooks("afterGetColumnHeaderRenderers",e),qN(ZN,this,e.length),e},columnWidth:e=>{const t=this.hot.columnIndexMapper.getVisualFromRenderableIndex(e);return this.hot.getColWidth(null===t?e:t)},rowHeight:e=>{const t=this.hot.rowIndexMapper.getVisualFromRenderableIndex(e);return this.hot.getRowHeight(null===t?e:t)},rowHeightByOverlayName:(e,t)=>{const r=this.hot.rowIndexMapper.getVisualFromRenderableIndex(e),n=null===r?e:r;return this.hot.runHooks("modifyRowHeightByOverlayName",this.hot.getRowHeight(n),n,t)},cellRenderer:(e,t,r)=>{const[n,o]=this.translateFromRenderableToVisualIndex(e,t),i=this.hot.runHooks("modifyGetCellCoords",n,o,!1,"meta");let s=n,a=o;Array.isArray(i)&&([s,a]=i);const l=this.hot.getCellMeta(s,a),u=this.hot.colToProp(a);let h=this.hot.getDataAtRowProp(s,u);this.hot.hasHook("beforeValueRender")&&(h=this.hot.runHooks("beforeValueRender",h,l)),this.hot.runHooks("beforeRenderer",r,n,o,u,h,l),this.hot.getCellRenderer(l)(this.hot,r,n,o,u,h,l),this.hot.runHooks("afterRenderer",r,n,o,u,h,l)},selections:this.hot.selection.highlight,hideBorderOnMouseDownOver:()=>this.settings.fragmentSelection,onWindowResize:()=>{this.hot&&!this.hot.isDestroyed&&this.hot.refreshDimensions()},onContainerElementResize:()=>{this.hot&&!this.hot.isDestroyed&&gw(this.hot.rootElement)&&this.hot.refreshDimensions()},onCellMouseDown:(e,t,r,n)=>{const o=this.translateFromRenderableToVisualCoords(t),i={row:!1,column:!1,cell:!1};this.hot.listen(),this.activeWt=n,qN(tA,this,!0),qN(iA,this,{x:e.clientX,y:e.clientY}),this.hot.runHooks("beforeOnCellMouseDown",e,o,r,i),UE(e)||(BN(e,{coords:o,selection:this.hot.selection,controller:i,cellCoordsFactory:(e,t)=>this.hot._createCellCoords(e,t)}),this.hot.runHooks("afterOnCellMouseDown",e,o,r),this.activeWt=this._wt)},onCellContextMenu:(e,t,r,n)=>{const o=this.translateFromRenderableToVisualCoords(t);this.activeWt=n,qN(tA,this,!1),this.hot.selection.isInProgress()&&this.hot.selection.finish(),this.hot.runHooks("beforeOnCellContextMenu",e,o,r),UE(e)||(this.hot.runHooks("afterOnCellContextMenu",e,o,r),this.activeWt=this._wt)},onCellMouseOut:(e,t,r,n)=>{const o=this.translateFromRenderableToVisualCoords(t);this.activeWt=n,this.hot.runHooks("beforeOnCellMouseOut",e,o,r),UE(e)||(this.hot.runHooks("afterOnCellMouseOut",e,o,r),this.activeWt=this._wt)},onCellMouseOver:(e,t,r,n)=>{const o=this.translateFromRenderableToVisualCoords(t),i={row:!1,column:!1,cell:!1};this.activeWt=n,this.hot.runHooks("beforeOnCellMouseOver",e,o,r,i),UE(e)||(!KN(tA,this)||KN(iA,this)&&KN(iA,this).x===e.clientX&&KN(iA,this).y===e.clientY||BN(e,{coords:o,selection:this.hot.selection,controller:i,cellCoordsFactory:(e,t)=>this.hot._createCellCoords(e,t)}),this.hot.runHooks("afterOnCellMouseOver",e,o,r),this.activeWt=this._wt,qN(iA,this,null))},onCellMouseUp:(e,t,r,n)=>{const o=this.translateFromRenderableToVisualCoords(t);this.activeWt=n,this.hot.runHooks("beforeOnCellMouseUp",e,o,r),UE(e)||this.hot.isDestroyed||(this.hot.runHooks("afterOnCellMouseUp",e,o,r),this.activeWt=this._wt)},onCellCornerMouseDown:e=>{e.preventDefault(),this.hot.runHooks("afterOnCellCornerMouseDown",e)},onCellCornerDblClick:e=>{e.preventDefault(),this.hot.runHooks("afterOnCellCornerDblClick",e)},beforeDraw:(e,t)=>this.beforeRender(e,t),onDraw:e=>this.afterRender(e),onBeforeViewportScrollVertically:(e,t)=>{const r=this.hot.rowIndexMapper,n=e<0;let o=e;return n||(o=r.getVisualFromRenderableIndex(e),null!==o)?(o=this.hot.runHooks("beforeViewportScrollVertically",o,t),this.hot.runHooks("beforeViewportScroll"),n?o:r.getRenderableFromVisualIndex(o)):e},onBeforeViewportScrollHorizontally:(e,t)=>{const r=this.hot.columnIndexMapper,n=e<0;let o=e;return n||(o=r.getVisualFromRenderableIndex(e),null!==o)?(o=this.hot.runHooks("beforeViewportScrollHorizontally",o,t),this.hot.runHooks("beforeViewportScroll"),n?o:r.getRenderableFromVisualIndex(o)):e},onScrollVertically:()=>{this.hot.runHooks("afterScrollVertically"),this.hot.runHooks("afterScroll")},onScrollHorizontally:()=>{this.hot.runHooks("afterScrollHorizontally"),this.hot.runHooks("afterScroll")},onBeforeRemoveCellClassNames:()=>this.hot.runHooks("beforeRemoveCellClassNames"),onBeforeHighlightingRowHeader:(e,t,r)=>{const n=this.hot.rowIndexMapper,o=e<0;let i=e;o||(i=n.getVisualFromRenderableIndex(e));const s=this.hot.runHooks("beforeHighlightingRowHeader",i,t,r);return o?s:n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(s,1))},onBeforeHighlightingColumnHeader:(e,t,r)=>{const n=this.hot.columnIndexMapper,o=e<0;let i=e;o||(i=n.getVisualFromRenderableIndex(e));const s=this.hot.runHooks("beforeHighlightingColumnHeader",i,t,r);return o?s:n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(s,1))},onAfterDrawSelection:(e,t,r)=>{let n;const[o,i]=this.translateFromRenderableToVisualIndex(e,t),s=this.hot.selection.getSelectedRange();if(s.size()>0){const e=s.peekByIndex(null!=r?r:0);n=[e.from.row,e.from.col,e.to.row,e.to.col]}return this.hot.runHooks("afterDrawSelection",o,i,n,r)},onBeforeDrawBorders:(e,t)=>{const[r,n,o,i]=e,s=[this.hot.rowIndexMapper.getVisualFromRenderableIndex(r),this.hot.columnIndexMapper.getVisualFromRenderableIndex(n),this.hot.rowIndexMapper.getVisualFromRenderableIndex(o),this.hot.columnIndexMapper.getVisualFromRenderableIndex(i)];return this.hot.runHooks("beforeDrawBorders",s,t)},onBeforeTouchScroll:()=>this.hot.runHooks("beforeTouchScroll"),onAfterMomentumScroll:()=>this.hot.runHooks("afterMomentumScroll"),onModifyRowHeaderWidth:e=>this.hot.runHooks("modifyRowHeaderWidth",e),onModifyGetCellCoords:(e,t,r,n)=>{const o=this.hot.rowIndexMapper,i=this.hot.columnIndexMapper,s=t>=0?i.getVisualFromRenderableIndex(t):t,a=e>=0?o.getVisualFromRenderableIndex(e):e,l=this.hot.runHooks("modifyGetCellCoords",a,s,r,n);if(Array.isArray(l)){const[e,t,r,n]=l;return[e>=0?o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(e,1)):e,t>=0?i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(t,1)):t,r>=0?o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(r,-1)):r,n>=0?i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(n,-1)):n]}},onModifyGetCoordsElement:(e,t)=>{const r=this.hot.rowIndexMapper,n=this.hot.columnIndexMapper,o=t>=0?n.getVisualFromRenderableIndex(t):t,i=e>=0?r.getVisualFromRenderableIndex(e):e,s=this.hot.runHooks("modifyGetCoordsElement",i,o);if(Array.isArray(s)){const[e,t]=s;return[e>=0?r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(e,1)):e,t>=0?n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(t,1)):t]}},viewportRowCalculatorOverride:e=>{let t=this.settings.viewportRowRenderingOffset;if("auto"===t&&this.settings.fixedRowsTop&&(t=10),t>0||"auto"===t){const r=this.countRenderableRows(),n=e.startRow,o=e.endRow;if("number"==typeof t)e.startRow=Math.max(n-t,0),e.endRow=Math.min(o+t,r-1);else if("auto"===t){const t=Math.max(1,Math.ceil(o/r*12));e.startRow=Math.max(n-t,0),e.endRow=Math.min(o+t,r-1)}}this.hot.runHooks("afterViewportRowCalculatorOverride",e)},viewportColumnCalculatorOverride:e=>{let t=this.settings.viewportColumnRenderingOffset;if("auto"===t&&this.settings.fixedColumnsStart&&(t=10),t>0||"auto"===t){const r=this.countRenderableColumns(),n=e.startColumn,o=e.endColumn;if("number"==typeof t&&(e.startColumn=Math.max(n-t,0),e.endColumn=Math.min(o+t,r-1)),"auto"===t){const t=Math.max(1,Math.ceil(o/r*6));e.startColumn=Math.max(n-t,0),e.endColumn=Math.min(o+t,r-1)}}this.hot.runHooks("afterViewportColumnCalculatorOverride",e)},rowHeaderWidth:()=>this.settings.rowHeaderWidth,columnHeaderHeight:()=>{const e=this.hot.runHooks("modifyColumnHeaderHeight");return this.settings.columnHeaderHeight||e}};this.hot.runHooks("beforeInitWalkontable",e),this._wt=new DN(e),this.activeWt=this._wt;const t=this._wt.wtTable.spreader,{width:r,height:n}=this.hot.rootElement.getBoundingClientRect();this.setLastSize(r,n),this.eventManager.addEventListener(t,"mousedown",(e=>{e.target===t&&3===e.which&&e.stopPropagation()})),this.eventManager.addEventListener(t,"contextmenu",(e=>{e.target===t&&3===e.which&&e.stopPropagation()})),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"click",(()=>{this.settings.observeDOMVisibility&&this._wt.drawInterrupted&&(this.hot.forceFullRender=!0,this.render())}))}isTextSelectionAllowed(e){if(Fw(e))return!0;const t=tw(e,this._wt.wtTable.spreader);return!(!0!==this.settings.fragmentSelection||!t)||(!("cell"!==this.settings.fragmentSelection||!this.isSelectedOnlyCell()||!t)||!(this.settings.fragmentSelection||!this.isCellEdited()||!this.isSelectedOnlyCell()))}isMouseDown(){return KN(tA,this)}isSelectedOnlyCell(){var e,t;return null!==(e=null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.isSingleCell())&&void 0!==e&&e}isCellEdited(){const e=this.hot.getActiveEditor();return e&&e.isOpened()}beforeRender(e,t){e&&this.hot.runHooks("beforeViewRender",this.hot.forceFullRender,t)}afterRender(e){e&&this.hot.runHooks("afterViewRender",this.hot.forceFullRender)}appendRowHeader(e,t){if(t.firstChild){const r=t.firstChild;if(!iw(r,"relative"))return cw(t),void this.appendRowHeader(e,t);this.updateCellHeader(r.querySelector(".rowHeader"),e,this.hot.getRowHeader)}else{const{rootDocument:r,getRowHeader:n}=this.hot,o=r.createElement("div"),i=r.createElement("span");o.className="relative",i.className="rowHeader",this.updateCellHeader(i,e,n),o.appendChild(i),t.appendChild(o)}this.hot.runHooks("afterGetRowHeader",e,t)}appendColHeader(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.hot.getColHeader,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;const o=()=>{const t=e>=0?this.hot.getColumnMeta(e).headerClassName:null;return t?t.split(" "):[]};if(t.firstChild){const i=t.firstChild;iw(i,"relative")?(this.updateCellHeader(i.querySelector(".colHeader"),e,r,n),i.className="",sw(i,["relative",...o()])):(cw(t),this.appendColHeader(e,t,r,n))}else{const{rootDocument:i}=this.hot,s=i.createElement("div"),a=i.createElement("span"),l=o();s.classList.add("relative",...l),a.className="colHeader",this.settings.ariaTags&&(lw(s,...Gy()),lw(a,...Gy())),this.updateCellHeader(a,e,r,n),s.appendChild(a),t.appendChild(s)}this.hot.runHooks("afterGetColHeader",e,t,n)}updateCellHeader(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=t;const i=this._wt.wtOverlays.getParentOverlay(e)||this._wt;e.parentNode&&(iw(e,"colHeader")?o=i.wtTable.columnFilter.sourceToRendered(t):iw(e,"rowHeader")&&(o=i.wtTable.rowFilter.sourceToRendered(t))),o>-1?pw(e,r(t,n)):(mw(e,String.fromCharCode(160)),sw(e,"cornerHeader"))}maximumVisibleElementWidth(e){const t=this._wt.wtViewport.getWorkspaceWidth()-e;return t>0?t:0}maximumVisibleElementHeight(e){const t=this._wt.wtViewport.getWorkspaceHeight()-e;return t>0?t:0}setLastSize(e,t){qN(nA,this,e),qN(oA,this,t)}getLastSize(){return{width:KN(nA,this),height:KN(oA,this)}}getFirstRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;const e=this.hot.rowIndexMapper,t=e.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedRow());return e.getNearestNotHiddenIndex(null!=t?t:0,1)}getLastRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;const e=this.hot.rowIndexMapper,t=e.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedRow());return e.getNearestNotHiddenIndex(null!=t?t:this.hot.countRows()-1,-1)}getFirstRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;const e=this.hot.columnIndexMapper,t=e.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedColumn());return e.getNearestNotHiddenIndex(null!=t?t:0,1)}getLastRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;const e=this.hot.columnIndexMapper,t=e.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedColumn());return e.getNearestNotHiddenIndex(null!=t?t:this.hot.countCols()-1,-1)}getFirstFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleRow())}getLastFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleRow())}getFirstFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleColumn())}getLastFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleColumn())}getFirstPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleRow())}getLastPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleRow())}getFirstPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleColumn())}getLastPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleColumn())}getColumnHeadersCount(){return KN(ZN,this)}getRowHeadersCount(){return KN(JN,this)}getViewportWidth(){return this._wt.wtViewport.getViewportWidth()}getWorkspaceWidth(){return this._wt.wtViewport.getWorkspaceWidth()}getViewportHeight(){return this._wt.wtViewport.getViewportHeight()}getWorkspaceHeight(){return this._wt.wtViewport.getWorkspaceHeight()}getElementOverlayName(e){var t;return(null!==(t=this._wt.wtOverlays.getParentOverlay(e))&&void 0!==t?t:this._wt).wtTable.name}getOverlayByName(e){return this._wt.getOverlayByName(e)}getActiveOverlayName(){return this._wt.activeOverlayName}isVisible(){return this._wt.wtTable.isVisible()}hasVerticalScroll(){return this._wt.wtViewport.hasVerticalScroll()}hasHorizontalScroll(){return this._wt.wtViewport.hasHorizontalScroll()}getTableWidth(){return this._wt.wtTable.getWidth()}getTableHeight(){return this._wt.wtTable.getHeight()}getTableOffset(){return this._wt.wtViewport.getWorkspaceOffset()}getRowHeaderWidth(){return this._wt.wtViewport.getRowHeaderWidth()}getColumnHeaderHeight(){return this._wt.wtViewport.getColumnHeaderHeight()}isVerticallyScrollableByWindow(){return this._wt.wtViewport.isVerticallyScrollableByWindow()}isHorizontallyScrollableByWindow(){return this._wt.wtViewport.isHorizontallyScrollableByWindow()}destroy(){this._wt.destroy(),this.eventManager.destroy()}};var cA=Qm,dA=Ai,pA=Ws,mA=rc;au({target:"Iterator",proto:!0,real:!0},{every:function(e){pA(this),dA(e);var t=mA(this),r=0;return!cA(t,(function(t,n){if(!e(t,r++))return n()}),{IS_RECORD:!0,INTERRUPTED:!0}).stopped}});const gA=26;function fA(e){let t=0;return Array.isArray(e)&&(e[0]&&Array.isArray(e[0])?t=e[0].length:e[0]&&RE(e[0])&&(t=bE(e[0]))),t}function yA(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const wA=class{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];yA(this,"hot",void 0),yA(this,"data",void 0),yA(this,"dataType","array"),yA(this,"colToProp",(()=>{})),yA(this,"propToCol",(()=>{})),this.hot=e,this.data=t}modifyRowData(e){let t;return this.hot.hasHook("modifyRowData")&&(t=this.hot.runHooks("modifyRowData",e)),void 0===t||Number.isInteger(t)?this.data[e]:t}getData(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.data&&0!==this.data.length?this.getByRange(null,null,e):this.data}setData(e){this.data=e}getAtColumn(e){const t=[];return vy(this.data,((r,n)=>{const o=this.getAtCell(n,e);t.push(o)})),t}getAtRow(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const o=void 0===t&&void 0===r,{dataDotNotation:i}=this.hot.getSettings();let s=null,a=null;if(s=this.modifyRowData(e),Array.isArray(s))a=[],o?s.forEach(((t,r)=>{a[r]=this.getAtPhysicalCell(e,r,s)})):ZR(t,r,(r=>{a[r-t]=this.getAtPhysicalCell(e,r,s)}));else if(RE(s)||Hw(s))if(a=n?[]:{},!o||n){const o=0,l=this.countFirstRowKeys()-1;ZR(o,l,(u=>{const h=this.colToProp(u);if(u>=(t||o)&&u<=(r||l)&&!Number.isInteger(h)){const t=this.getAtPhysicalCell(e,h,s);n?a.push(t):i?CE(a,h,t):a[h]=t}}))}else TE(s,((t,r)=>{const n=this.getAtPhysicalCell(e,r,s);i?CE(a,r,n):a[r]=n}));return a}setAtCell(e,t,r){if(!(e>=this.countRows()||t>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){const n=NE(r);this.hot.runHooks("modifySourceData",e,t,n,"set"),n.isTouched()&&(r=n.value)}["__proto__","constructor","prototype"].includes(e)||(Number.isInteger(t)?this.data[e][t]=r:CE(this.data[e],t,r))}}getAtPhysicalCell(e,t,r){let n=null;if(r)if("string"==typeof t){const{dataDotNotation:e}=this.hot.getSettings();n=e?function(e,t){const r=t.split(".");let n=e;return TE(r,(e=>{if(n=n[e],void 0===n)return n=void 0,!1})),n}(r,t):r[t]}else n="function"==typeof t?t(r):r[t];if(this.hot.hasHook("modifySourceData")){const r=NE(n);this.hot.runHooks("modifySourceData",e,t,r,"get"),r.isTouched()&&(n=r.value)}return n}getAtCell(e,t){const r=this.modifyRowData(e);return this.getAtPhysicalCell(e,this.colToProp(t),r)}getByRange(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=!1,o=null,i=null,s=null,a=null;null===e||null===t?(n=!0,o=0,s=this.countRows()-1):(o=Math.min(e.row,t.row),i=Math.min(e.col,t.col),s=Math.max(e.row,t.row),a=Math.max(e.col,t.col));const l=[];return ZR(o,s,(e=>{l.push(n?this.getAtRow(e,void 0,void 0,r):this.getAtRow(e,i,a,r))})),l}countRows(){if(this.hot.hasHook("modifySourceLength")){const e=this.hot.runHooks("modifySourceLength");if(Number.isInteger(e))return e}return this.data.length}countFirstRowKeys(){return fA(this.data)}destroy(){this.data=null,this.hot=null}};var EA=Qm,vA=Ai,RA=Ws,SA=rc;function TA(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}au({target:"Iterator",proto:!0,real:!0},{some:function(e){RA(this),vA(e);var t=SA(this),r=0;return EA(t,(function(t,n){if(e(t,r++))return n()}),{IS_RECORD:!0,INTERRUPTED:!0}).stopped}});class CA{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;TA(this,"indexedValues",[]),TA(this,"initValueOrFn",void 0),this.initValueOrFn=e}getValues(){return this.indexedValues}getValueAtIndex(e){const t=this.indexedValues;if(e<t.length)return t[e]}setValues(e){this.indexedValues=e.slice(),this.runLocalHooks("change")}setValueAtIndex(e,t){return e<this.indexedValues.length&&(this.indexedValues[e]=t,this.runLocalHooks("change"),!0)}clear(){this.setDefaultValues()}getLength(){return this.getValues().length}setDefaultValues(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,Hw(this.initValueOrFn)?ZR(e-1,(e=>this.indexedValues.push(this.initValueOrFn(e)))):ZR(e-1,(()=>this.indexedValues.push(this.initValueOrFn))),this.runLocalHooks("change")}init(e){return this.setDefaultValues(e),this.runLocalHooks("init"),this}insert(){this.runLocalHooks("change")}remove(){this.runLocalHooks("change")}destroy(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}function bA(e,t,r,n){const o=r.length?r[0]:void 0;return[...e.slice(0,o),...r.map(((e,t)=>Hw(n)?n(e,t):n)),...void 0===o?[]:e.slice(o)]}function NA(e,t){return wy(e,((e,r)=>!1===t.includes(r)))}EE(CA,cb);class AA extends CA{insert(e,t){this.indexedValues=bA(this.indexedValues,0,t,this.initValueOrFn),super.insert(e,t)}remove(e){this.indexedValues=NA(this.indexedValues,e),super.remove(e)}}class IA extends AA{constructor(){super(arguments.length>0&&void 0!==arguments[0]&&arguments[0])}getHiddenIndexes(){return yy(this.getValues(),((e,t,r)=>(t&&e.push(r),e)),[])}}function OA(e,t,r){return[...e.slice(0,t),...r,...e.slice(t)]}function MA(e,t){return wy(e,(e=>!1===t.includes(e)))}function _A(e,t){return Ey(e,(e=>e-t.filter((t=>t<e)).length))}function xA(e,t){const r=t[0],n=t.length;return Ey(e,(e=>e>=r?e+n:e))}function LA(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class FA extends AA{constructor(){super(arguments.length>0&&void 0!==arguments[0]&&arguments[0])}getTrimmedIndexes(){return yy(this.getValues(),((e,t,r)=>(t&&e.push(r),e)),[])}}class PA extends CA{constructor(){super((e=>e))}insert(e,t){const r=xA(this.indexedValues,t);this.indexedValues=OA(r,e,t),super.insert(e,t)}remove(e){const t=MA(this.indexedValues,e);this.indexedValues=_A(t,e),super.remove(e)}}const VA=new Map([["hiding",IA],["index",CA],["linkedPhysicalIndexToValue",class extends CA{constructor(){super(...arguments),LA(this,"orderOfIndexes",[])}getValues(){return this.orderOfIndexes.map((e=>this.indexedValues[e]))}setValues(e){this.orderOfIndexes=[...Array(e.length).keys()],super.setValues(e)}setValueAtIndex(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.orderOfIndexes.length;return e<this.indexedValues.length&&(this.indexedValues[e]=t,!1===this.orderOfIndexes.includes(e)&&this.orderOfIndexes.splice(r,0,e),this.runLocalHooks("change"),!0)}clearValue(e){this.orderOfIndexes=MA(this.orderOfIndexes,[e]),Hw(this.initValueOrFn)?super.setValueAtIndex(e,this.initValueOrFn(e)):super.setValueAtIndex(e,this.initValueOrFn)}getLength(){return this.orderOfIndexes.length}setDefaultValues(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,super.setDefaultValues(e)}insert(e,t){this.indexedValues=bA(this.indexedValues,0,t,this.initValueOrFn),this.orderOfIndexes=xA(this.orderOfIndexes,t),super.insert(e,t)}remove(e){this.indexedValues=NA(this.indexedValues,e),this.orderOfIndexes=MA(this.orderOfIndexes,e),this.orderOfIndexes=_A(this.orderOfIndexes,e),super.remove(e)}getEntries(){return this.orderOfIndexes.map((e=>[e,this.getValueAtIndex(e)]))}}],["physicalIndexToValue",AA],["trimming",FA]]);function HA(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class DA{constructor(){HA(this,"collection",new Map)}register(e,t){!1===this.collection.has(e)&&(this.collection.set(e,t),t.addLocalHook("change",(()=>this.runLocalHooks("change",t))))}unregister(e){const t=this.collection.get(e);by(t)&&(t.destroy(),this.collection.delete(e),this.runLocalHooks("change",t))}unregisterAll(){this.collection.forEach(((e,t)=>this.unregister(t))),this.collection.clear()}get(e){return Ny(e)?Array.from(this.collection.values()):this.collection.get(e)}getLength(){return this.collection.size}removeFromEvery(e){this.collection.forEach((t=>{t.remove(e)}))}insertToEvery(e,t){this.collection.forEach((r=>{r.insert(e,t)}))}initEvery(e){this.collection.forEach((t=>{t.init(e)}))}}function UA(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}EE(DA,cb);class kA extends DA{constructor(e,t){super(),UA(this,"mergedValuesCache",[]),UA(this,"aggregationFunction",void 0),UA(this,"fallbackValue",void 0),this.aggregationFunction=e,this.fallbackValue=t}getMergedValues(){if(!0===(!(arguments.length>0&&void 0!==arguments[0])||arguments[0]))return this.mergedValuesCache;if(0===this.getLength())return[];const e=Ey(this.get(),(e=>e.getValues())),t=[],r=by(e[0])&&e[0].length||0;for(let n=0;n<r;n+=1){const r=[];for(let t=0;t<this.getLength();t+=1)r.push(e[t][n]);t.push(r)}return Ey(t,this.aggregationFunction)}getMergedValueAtIndex(e,t){const r=this.getMergedValues(t)[e];return by(r)?r:this.fallbackValue}updateCache(){this.mergedValuesCache=this.getMergedValues(!1)}}function BA(e,t,r){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,r)}function WA(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var GA=new WeakMap;class jA{constructor(){BA(this,GA,[])}subscribe(e){var t,r;return this.addLocalHook("change",e),this._write((r=this,(t=GA).get(WA(t,r)))),this}unsubscribe(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}_write(e){return e.length>0&&this.runLocalHooks("change",e),this}_writeInitialChanges(e){var t,r,n;r=this,n=e,(t=GA).set(WA(t,r),n)}}function zA(e,t){const r=[];let n=0,o=0;for(;n<e.length&&o<t.length;n++,o++)e[n]!==t[o]&&r.push({op:"replace",index:o,oldValue:e[n],newValue:t[o]});for(;n<t.length;n++)r.push({op:"insert",index:n,oldValue:void 0,newValue:t[n]});for(;o<e.length;o++)r.push({op:"remove",index:o,oldValue:e[o],newValue:void 0});return r}function $A(e,t,r){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,r)}function YA(e,t){return e.get(KA(e,t))}function XA(e,t,r){return e.set(KA(e,t),r),r}function KA(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}EE(jA,cb);var qA=new WeakMap,QA=new WeakMap,ZA=new WeakMap,JA=new WeakMap,eI=new WeakMap;class tI{constructor(){let{initialIndexValue:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};$A(this,qA,new Set),$A(this,QA,[]),$A(this,ZA,[]),$A(this,JA,!1),$A(this,eI,!1),XA(eI,this,null!=e&&e)}createObserver(){const e=new jA;return YA(qA,this).add(e),e.addLocalHook("unsubscribe",(()=>{YA(qA,this).delete(e)})),e._writeInitialChanges(zA(YA(QA,this),YA(ZA,this))),e}emit(e){let t=YA(ZA,this);YA(JA,this)&&YA(QA,this).length===e.length||(0===e.length?e=new Array(t.length).fill(YA(eI,this)):XA(QA,this,new Array(e.length).fill(YA(eI,this))),YA(JA,this)||(XA(JA,this,!0),t=YA(QA,this)));const r=zA(t,e);YA(qA,this).forEach((e=>e._write(r))),XA(ZA,this,e)}}function rI(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class nI{constructor(){rI(this,"indexesSequence",new PA),rI(this,"trimmingMapsCollection",new kA((e=>e.some((e=>!0===e))),!1)),rI(this,"hidingMapsCollection",new kA((e=>e.some((e=>!0===e))),!1)),rI(this,"variousMapsCollection",new DA),rI(this,"hidingChangesObservable",new tI({initialIndexValue:!1})),rI(this,"notTrimmedIndexesCache",[]),rI(this,"notHiddenIndexesCache",[]),rI(this,"isBatched",!1),rI(this,"indexesSequenceChanged",!1),rI(this,"indexesChangeSource",void 0),rI(this,"trimmedIndexesChanged",!1),rI(this,"hiddenIndexesChanged",!1),rI(this,"renderablePhysicalIndexesCache",[]),rI(this,"fromPhysicalToVisualIndexesCache",new Map),rI(this,"fromVisualToRenderableIndexesCache",new Map),this.indexesSequence.addLocalHook("change",(()=>{this.indexesSequenceChanged=!0,this.updateCache(),this.runLocalHooks("indexesSequenceChange",this.indexesChangeSource),this.runLocalHooks("change",this.indexesSequence,null)})),this.trimmingMapsCollection.addLocalHook("change",(e=>{this.trimmedIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.trimmingMapsCollection)})),this.hidingMapsCollection.addLocalHook("change",(e=>{this.hiddenIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.hidingMapsCollection)})),this.variousMapsCollection.addLocalHook("change",(e=>{this.runLocalHooks("change",e,this.variousMapsCollection)}))}suspendOperations(){this.isBatched=!0}resumeOperations(){this.isBatched=!1,this.updateCache()}createChangesObserver(e){if("hiding"!==e)throw new Error(`Unsupported index map type "${e}".`);return this.hidingChangesObservable.createObserver()}createAndRegisterIndexMap(e,t,r){return this.registerMap(e,function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!VA.has(e))throw new Error(`The provided map type ("${e}") does not exist.`);return new(VA.get(e))(t)}(t,r))}registerMap(e,t){if(this.trimmingMapsCollection.get(e)||this.hidingMapsCollection.get(e)||this.variousMapsCollection.get(e))throw Error(`Map with name "${e}" has been already registered.`);t instanceof FA?this.trimmingMapsCollection.register(e,t):t instanceof IA?this.hidingMapsCollection.register(e,t):this.variousMapsCollection.register(e,t);const r=this.getNumberOfIndexes();return r>0&&t.init(r),t}unregisterMap(e){this.trimmingMapsCollection.unregister(e),this.hidingMapsCollection.unregister(e),this.variousMapsCollection.unregister(e)}unregisterAll(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}getPhysicalFromVisualIndex(e){const t=this.notTrimmedIndexesCache[e];return by(t)?t:null}getPhysicalFromRenderableIndex(e){const t=this.renderablePhysicalIndexesCache[e];return by(t)?t:null}getVisualFromPhysicalIndex(e){const t=this.fromPhysicalToVisualIndexesCache.get(e);return by(t)?t:null}getVisualFromRenderableIndex(e){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(e))}getRenderableFromVisualIndex(e){const t=this.fromVisualToRenderableIndexesCache.get(e);return by(t)?t:null}getNearestNotHiddenIndex(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(null===this.getPhysicalFromVisualIndex(e))return null;if(this.fromVisualToRenderableIndexesCache.has(e))return e;const n=Array.from(this.fromVisualToRenderableIndexesCache.keys());let o=-1;return o=t>0?n.findIndex((t=>t>e)):n.reverse().findIndex((t=>t<e)),-1===o?r?this.getNearestNotHiddenIndex(e,-t,!1):null:n[o]}initToLength(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=[...new Array(e).keys()],this.notHiddenIndexesCache=[...new Array(e).keys()],this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(e),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(e),this.variousMapsCollection.initEvery(e),this.resumeOperations(),this.runLocalHooks("init")}fitToLength(e){const t=this.getNumberOfIndexes();if(e<t){const t=[...Array(this.getNumberOfIndexes()-e).keys()].map((t=>t+e));this.removeIndexes(t)}else this.insertIndexes(t,e-t)}getIndexesSequence(){return this.indexesSequence.getValues()}setIndexesSequence(e){void 0===this.indexesChangeSource&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(e),"update"===this.indexesChangeSource&&(this.indexesChangeSource=void 0)}getNotTrimmedIndexes(){if(!0===(!(arguments.length>0&&void 0!==arguments[0])||arguments[0]))return this.notTrimmedIndexesCache;return this.getIndexesSequence().filter((e=>!1===this.isTrimmed(e)))}getNotTrimmedIndexesLength(){return this.getNotTrimmedIndexes().length}getNotHiddenIndexes(){if(!0===(!(arguments.length>0&&void 0!==arguments[0])||arguments[0]))return this.notHiddenIndexesCache;return this.getIndexesSequence().filter((e=>!1===this.isHidden(e)))}getNotHiddenIndexesLength(){return this.getNotHiddenIndexes().length}getRenderableIndexes(){if(!0===(!(arguments.length>0&&void 0!==arguments[0])||arguments[0]))return this.renderablePhysicalIndexesCache;return this.getNotTrimmedIndexes().filter((e=>!1===this.isHidden(e)))}getRenderableIndexesLength(){return this.getRenderableIndexes().length}getNumberOfIndexes(){return this.getIndexesSequence().length}moveIndexes(e,t){"number"==typeof e&&(e=[e]);const r=Ey(e,(e=>this.getPhysicalFromVisualIndex(e))),n=this.getNotTrimmedIndexesLength(),o=e.length,i=MA(this.getIndexesSequence(),r),s=i.filter((e=>!1===this.isTrimmed(e)));let a=i.indexOf(s[s.length-1])+1;if(t+o<n){const e=s[t];a=i.indexOf(e)}this.indexesChangeSource="move",this.setIndexesSequence(OA(i,a,r)),this.indexesChangeSource=void 0}isTrimmed(e){return this.trimmingMapsCollection.getMergedValueAtIndex(e)}isHidden(e){return this.hidingMapsCollection.getMergedValueAtIndex(e)}insertIndexes(e,t){const r=this.getNotTrimmedIndexes()[e],n=by(r)?r:this.getNumberOfIndexes(),o=this.getIndexesSequence().includes(r)?this.getIndexesSequence().indexOf(r):this.getNumberOfIndexes(),i=Ey(new Array(t).fill(n),((e,t)=>e+t));this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(o,i),this.indexesChangeSource=void 0,this.trimmingMapsCollection.insertToEvery(o,i),this.hidingMapsCollection.insertToEvery(o,i),this.variousMapsCollection.insertToEvery(o,i),this.resumeOperations()}removeIndexes(e){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(e),this.hidingMapsCollection.removeFromEvery(e),this.variousMapsCollection.removeFromEvery(e),this.resumeOperations()}updateCache(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(!0===e||!1===this.isBatched&&!0===t)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}cacheFromPhysicalToVisualIndexes(){const e=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(let t=0;t<e;t+=1){const e=this.getPhysicalFromVisualIndex(t);this.fromPhysicalToVisualIndexesCache.set(e,t)}}cacheFromVisualToRenderableIndexes(){const e=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(let t=0;t<e;t+=1){const e=this.getPhysicalFromRenderableIndex(t),r=this.getVisualFromPhysicalIndex(e);this.fromVisualToRenderableIndexesCache.set(r,t)}}}function oI(e){const t=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(e);return t?`${t[1].toLowerCase()}-${t[2].toUpperCase()}`:e}function iI(e){by(e)&&function(){by(console)&&console.error(...arguments)}(Ty`Language with code "${e}" was not found. You should register particular language\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`)}EE(nI,cb);const{register:sI,getValues:aI}=Iv("phraseFormatters");sI("pluralize",(function(e,t){return Array.isArray(e)&&Number.isInteger(t)?e[t]:e}));const lI="ContextMenu:items",uI=`${lI}.noItems`,hI=`${lI}.insertRowAbove`,cI=`${lI}.insertRowBelow`,dI=`${lI}.insertColumnOnTheLeft`,pI=`${lI}.insertColumnOnTheRight`,mI=`${lI}.removeRow`,gI=`${lI}.removeColumn`,fI=`${lI}.undo`,yI=`${lI}.redo`,wI=`${lI}.readOnly`,EI=`${lI}.clearColumn`,vI=`${lI}.copy`,RI=`${lI}.copyWithHeaders`,SI=`${lI}.copyWithGroupHeaders`,TI=`${lI}.copyHeadersOnly`,CI=`${lI}.cut`,bI=`${lI}.freezeColumn`,NI=`${lI}.unfreezeColumn`,AI=`${lI}.mergeCells`,II=`${lI}.unmergeCells`,OI=`${lI}.addComment`,MI=`${lI}.editComment`,_I=`${lI}.removeComment`,xI=`${lI}.readOnlyComment`,LI=`${lI}.align`,FI=`${lI}.align.left`,PI=`${lI}.align.center`,VI=`${lI}.align.right`,HI=`${lI}.align.justify`,DI=`${lI}.align.top`,UI=`${lI}.align.middle`,kI=`${lI}.align.bottom`,BI=`${lI}.borders`,WI=`${lI}.borders.top`,GI=`${lI}.borders.right`,jI=`${lI}.borders.bottom`,zI=`${lI}.borders.left`,$I=`${lI}.borders.remove`,YI=`${lI}.nestedHeaders.insertChildRow`,XI=`${lI}.nestedHeaders.detachFromParent`,KI=`${lI}.hideColumn`,qI=`${lI}.showColumn`,QI=`${lI}.hideRow`,ZI=`${lI}.showRow`,JI="Filters:",eO=`${JI}conditions`,tO=`${eO}.none`,rO=`${eO}.isEmpty`,nO=`${eO}.isNotEmpty`,oO=`${eO}.isEqualTo`,iO=`${eO}.isNotEqualTo`,sO=`${eO}.beginsWith`,aO=`${eO}.endsWith`,lO=`${eO}.contains`,uO=`${eO}.doesNotContain`,hO=`${eO}.byValue`,cO=`${eO}.greaterThan`,dO=`${eO}.greaterThanOrEqualTo`,pO=`${eO}.lessThan`,mO=`${eO}.lessThanOrEqualTo`,gO=`${eO}.isBetween`,fO=`${eO}.isNotBetween`,yO=`${eO}.after`,wO=`${eO}.before`,EO=`${eO}.today`,vO=`${eO}.tomorrow`,RO=`${eO}.yesterday`,SO=`${JI}labels.filterByCondition`,TO=`${JI}labels.filterByValue`,CO=`${JI}labels.conjunction`,bO=`${JI}labels.disjunction`,NO=`${JI}values.blankCells`,AO=`${JI}buttons.selectAll`,IO=`${JI}buttons.clear`,OO=`${JI}buttons.ok`,MO=`${JI}buttons.cancel`,_O=`${JI}buttons.placeholder.search`,xO=`${JI}buttons.placeholder.value`,LO=`${JI}buttons.placeholder.secondValue`,FO="CheckboxRenderer:",PO=`${FO}checked`,VO=`${FO}unchecked`,HO={languageCode:"en-US",[uI]:"No available options",[hI]:"Insert row above",[cI]:"Insert row below",[dI]:"Insert column left",[pI]:"Insert column right",[mI]:["Remove row","Remove rows"],[gI]:["Remove column","Remove columns"],[fI]:"Undo",[yI]:"Redo",[wI]:"Read only",[EI]:"Clear column",[LI]:"Alignment",[FI]:"Left",[PI]:"Center",[VI]:"Right",[HI]:"Justify",[DI]:"Top",[UI]:"Middle",[kI]:"Bottom",[bI]:"Freeze column",[NI]:"Unfreeze column",[BI]:"Borders",[WI]:"Top",[GI]:"Right",[jI]:"Bottom",[zI]:"Left",[$I]:"Remove border(s)",[OI]:"Add comment",[MI]:"Edit comment",[_I]:"Delete comment",[xI]:"Read-only comment",[AI]:"Merge cells",[II]:"Unmerge cells",[vI]:"Copy",[RI]:["Copy with header","Copy with headers"],[SI]:["Copy with group header","Copy with group headers"],[TI]:["Copy header only","Copy headers only"],[CI]:"Cut",[YI]:"Insert child row",[XI]:"Detach from parent",[KI]:["Hide column","Hide columns"],[qI]:["Show column","Show columns"],[QI]:["Hide row","Hide rows"],[ZI]:["Show row","Show rows"],[tO]:"None",[rO]:"Is empty",[nO]:"Is not empty",[oO]:"Is equal to",[iO]:"Is not equal to",[sO]:"Begins with",[aO]:"Ends with",[lO]:"Contains",[uO]:"Does not contain",[cO]:"Greater than",[dO]:"Greater than or equal to",[pO]:"Less than",[mO]:"Less than or equal to",[gO]:"Is between",[fO]:"Is not between",[yO]:"After",[wO]:"Before",[EO]:"Today",[vO]:"Tomorrow",[RO]:"Yesterday",[NO]:"Blank cells",[SO]:"Filter by condition",[TO]:"Filter by value",[CO]:"And",[bO]:"Or",[AO]:"Select all",[IO]:"Clear",[OO]:"OK",[MO]:"Cancel",[_O]:"Search",[xO]:"Value",[LO]:"Second value",[PO]:"Checked",[VO]:"Unchecked"},DO=Object.freeze(Object.defineProperty({__proto__:null,CHECKBOX_CHECKED:PO,CHECKBOX_RENDERER_NAMESPACE:FO,CHECKBOX_UNCHECKED:VO,CONTEXTMENU_ITEMS_ADD_COMMENT:OI,CONTEXTMENU_ITEMS_ALIGNMENT:LI,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:kI,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:PI,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:HI,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:FI,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:UI,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:VI,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:DI,CONTEXTMENU_ITEMS_BORDERS:BI,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:jI,CONTEXTMENU_ITEMS_BORDERS_LEFT:zI,CONTEXTMENU_ITEMS_BORDERS_RIGHT:GI,CONTEXTMENU_ITEMS_BORDERS_TOP:WI,CONTEXTMENU_ITEMS_CLEAR_COLUMN:EI,CONTEXTMENU_ITEMS_COPY:vI,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:TI,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:SI,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:RI,CONTEXTMENU_ITEMS_CUT:CI,CONTEXTMENU_ITEMS_EDIT_COMMENT:MI,CONTEXTMENU_ITEMS_FREEZE_COLUMN:bI,CONTEXTMENU_ITEMS_HIDE_COLUMN:KI,CONTEXTMENU_ITEMS_HIDE_ROW:QI,CONTEXTMENU_ITEMS_INSERT_LEFT:dI,CONTEXTMENU_ITEMS_INSERT_RIGHT:pI,CONTEXTMENU_ITEMS_MERGE_CELLS:AI,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:XI,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:YI,CONTEXTMENU_ITEMS_NO_ITEMS:uI,CONTEXTMENU_ITEMS_READ_ONLY:wI,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:xI,CONTEXTMENU_ITEMS_REDO:yI,CONTEXTMENU_ITEMS_REMOVE_BORDERS:$I,CONTEXTMENU_ITEMS_REMOVE_COLUMN:gI,CONTEXTMENU_ITEMS_REMOVE_COMMENT:_I,CONTEXTMENU_ITEMS_REMOVE_ROW:mI,CONTEXTMENU_ITEMS_ROW_ABOVE:hI,CONTEXTMENU_ITEMS_ROW_BELOW:cI,CONTEXTMENU_ITEMS_SHOW_COLUMN:qI,CONTEXTMENU_ITEMS_SHOW_ROW:ZI,CONTEXTMENU_ITEMS_UNDO:fI,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:NI,CONTEXTMENU_ITEMS_UNMERGE_CELLS:II,CONTEXT_MENU_ITEMS_NAMESPACE:lI,FILTERS_BUTTONS_CANCEL:MO,FILTERS_BUTTONS_CLEAR:IO,FILTERS_BUTTONS_OK:OO,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:_O,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:LO,FILTERS_BUTTONS_PLACEHOLDER_VALUE:xO,FILTERS_BUTTONS_SELECT_ALL:AO,FILTERS_CONDITIONS_AFTER:yO,FILTERS_CONDITIONS_BEFORE:wO,FILTERS_CONDITIONS_BEGINS_WITH:sO,FILTERS_CONDITIONS_BETWEEN:gO,FILTERS_CONDITIONS_BY_VALUE:hO,FILTERS_CONDITIONS_CONTAINS:lO,FILTERS_CONDITIONS_EMPTY:rO,FILTERS_CONDITIONS_ENDS_WITH:aO,FILTERS_CONDITIONS_EQUAL:oO,FILTERS_CONDITIONS_GREATER_THAN:cO,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:dO,FILTERS_CONDITIONS_LESS_THAN:pO,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:mO,FILTERS_CONDITIONS_NAMESPACE:eO,FILTERS_CONDITIONS_NONE:tO,FILTERS_CONDITIONS_NOT_BETWEEN:fO,FILTERS_CONDITIONS_NOT_CONTAIN:uO,FILTERS_CONDITIONS_NOT_EMPTY:nO,FILTERS_CONDITIONS_NOT_EQUAL:iO,FILTERS_CONDITIONS_TODAY:EO,FILTERS_CONDITIONS_TOMORROW:vO,FILTERS_CONDITIONS_YESTERDAY:RO,FILTERS_DIVS_FILTER_BY_CONDITION:SO,FILTERS_DIVS_FILTER_BY_VALUE:TO,FILTERS_LABELS_CONJUNCTION:CO,FILTERS_LABELS_DISJUNCTION:bO,FILTERS_NAMESPACE:JI,FILTERS_VALUES_BLANK_CELLS:NO},Symbol.toStringTag,{value:"Module"})),UO=HO.languageCode,{register:kO,getItem:BO,hasItem:WO,getValues:GO}=Iv("languagesDictionaries");function jO(e,t){let r=e,n=t;return RE(e)&&(n=e,r=n.languageCode),function(e,t){e!==UO&&(r=t,TE(BO(UO),((e,t)=>{Ny(r[t])&&(r[t]=e)})));var r}(r,n),kO(r,wE(n)),wE(n)}function zO(e){return $O(e)?wE(BO(e)):null}function $O(e){return WO(e)}function YO(e,t,r){const n=zO(e);if(null===n)return null;const o=n[t];if(Ny(o))return null;const i=function(e,t){let r=e;return vy(function(){return aI()}(),(n=>{r=n(e,t)})),r}(o,r);return Array.isArray(i)?i[0]:i}function XO(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}jO(HO);const KO=class extends pb{constructor(e,t){super(e,null),XO(this,"visualCellRange",null),this.visualCellRange=t||null,this.commit()}add(e){return null===this.visualCellRange?this.visualCellRange=this.settings.createCellRange(e):this.visualCellRange.expand(e),this}clear(){return this.visualCellRange=null,super.clear()}trimToVisibleCellsRangeOnly(e){let{from:t,to:r}=e,n=this.getNearestNotHiddenCoords(t,1),o=this.getNearestNotHiddenCoords(r,-1);return null===n||null===o?null:((n.row>o.row||n.col>o.col)&&(n=t,o=r),this.settings.createCellRange(n,n,o))}getNearestNotHiddenCoords(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t;const n=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper,e.row,t);if(null===n)return null;const o=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper,e.col,r);return null===o?null:this.settings.createCellCoords(n,o)}getNearestNotHiddenIndex(e,t,r){return t<0?t:e.getNearestNotHiddenIndex(t,r)}commit(){if(null===this.visualCellRange)return this;const e=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return this.cellRange=null===e?null:this.createRenderableCellRange(e.from,e.to),this}syncWith(e){const t=e.from.clone().normalize(),r="N-S"===e.getVerticalDirection()?1:-1,n="W-E"===e.getHorizontalDirection()?1:-1,o=this.settings.visualToRenderableCoords(this.visualCellRange.highlight);let i=null;if(null!==o&&null!==o.col&&null!==o.row||(i=this.getNearestNotHiddenCoords(t,r,n)),null!==i&&e.overlaps(i)){const t=e.highlight.clone();if(t.row>=0&&(t.row=i.row),t.col>=0&&(t.col=i.col),null===this.cellRange){const e=this.settings.visualToRenderableCoords(t);this.cellRange=this.settings.createCellRange(e)}e.setHighlight(t)}return"focus"===this.settings.selectionType&&null!==o&&null===i&&e.setHighlight(this.visualCellRange.highlight),this}getCorners(){const{from:e,to:t}=this.cellRange;return[Math.min(e.row,t.row),Math.min(e.col,t.col),Math.max(e.row,t.row),Math.max(e.col,t.col)]}getVisualCorners(){const e=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),t=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[e.row,e.col,t.row,t.col]}createRenderableCellRange(e,t){const r=this.settings.visualToRenderableCoords(e),n=this.settings.visualToRenderableCoords(t);return null===r.row||null===r.col||null===n.row||null===n.col?null:this.settings.createCellRange(r,r,n)}};function qO(e){let{activeHeaderClassName:t,...r}=e;return new KO({className:t,...r,selectionType:"active-header"})}function QO(e){let{areaCornerVisible:t,...r}=e;return new KO({className:"area",createLayers:!0,border:{width:1,color:"#4b89ff",cornerVisible:t},...r,selectionType:gb})}function ZO(e){let{...t}=e;return new KO({className:"highlight",...t,selectionType:gb})}function JO(e){let{columnClassName:t,...r}=e;return new KO({className:t,...r,selectionType:"column"})}function eM(e){let{headerClassName:t,...r}=e;return new KO({className:t,...r,selectionType:mb})}function tM(e){let{rowClassName:t,...r}=e;return new KO({className:t,...r,selectionType:"row"})}function rM(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function nM(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function oM(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var iM=new WeakSet;class sM{constructor(e){rM(this,iM),nM(this,"options",void 0),nM(this,"layerLevel",0),nM(this,"focus",void 0),nM(this,"fill",void 0),nM(this,"layeredAreas",new Map),nM(this,"areas",new Map),nM(this,"rowHeaders",new Map),nM(this,"columnHeaders",new Map),nM(this,"activeRowHeaders",new Map),nM(this,"activeColumnHeaders",new Map),nM(this,"activeCornerHeaders",new Map),nM(this,"rowHighlights",new Map),nM(this,"columnHighlights",new Map),nM(this,"customSelections",[]),this.options=e,this.focus=function(e){let{cellCornerVisible:t,...r}=e;return new KO({className:"current",headerAttributes:[["aria-selected","true"]],border:{width:2,color:"#4b89ff",cornerVisible:t},...r,selectionType:fb})}(e),this.fill=function(e){let{...t}=e;return new KO({className:"fill",border:{width:1,color:"#ff0000"},...t,selectionType:"fill"})}(e)}isEnabledFor(e,t){let r=e;e===fb&&(r="current");let n=this.options.disabledCellSelection(t.row,t.col);return"string"==typeof n&&(n=[n]),!1===n||Array.isArray(n)&&!n.includes(r)}useLayerLevel(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.layerLevel=e,this}getFocus(){return this.focus}getFill(){return this.fill}createLayeredArea(){return oM(iM,this,aM).call(this,this.layeredAreas,QO)}getLayeredAreas(){return[...this.layeredAreas.values()]}createArea(){return oM(iM,this,aM).call(this,this.areas,ZO)}getAreas(){return[...this.areas.values()]}createRowHeader(){return oM(iM,this,aM).call(this,this.rowHeaders,eM)}getRowHeaders(){return[...this.rowHeaders.values()]}createColumnHeader(){return oM(iM,this,aM).call(this,this.columnHeaders,eM)}getColumnHeaders(){return[...this.columnHeaders.values()]}createActiveRowHeader(){return oM(iM,this,aM).call(this,this.activeRowHeaders,qO)}getActiveRowHeaders(){return[...this.activeRowHeaders.values()]}createActiveColumnHeader(){return oM(iM,this,aM).call(this,this.activeColumnHeaders,qO)}getActiveColumnHeaders(){return[...this.activeColumnHeaders.values()]}createActiveCornerHeader(){return oM(iM,this,aM).call(this,this.activeCornerHeaders,qO)}getActiveCornerHeaders(){return[...this.activeCornerHeaders.values()]}createRowHighlight(){return oM(iM,this,aM).call(this,this.rowHighlights,tM)}getRowHighlights(){return[...this.rowHighlights.values()]}createColumnHighlight(){return oM(iM,this,aM).call(this,this.columnHighlights,JO)}getColumnHighlights(){return[...this.columnHighlights.values()]}getCustomSelections(){return[...this.customSelections.values()]}addCustomSelection(e){this.customSelections.push(function(e){let{border:t,visualCellRange:r,...n}=e;return new KO({...t,...n,selectionType:"custom-selection"},r)}({...this.options,...e}))}clear(){this.focus.clear(),this.fill.clear(),vy(this.areas.values(),(e=>{e.clear()})),vy(this.layeredAreas.values(),(e=>{e.clear()})),vy(this.rowHeaders.values(),(e=>{e.clear()})),vy(this.columnHeaders.values(),(e=>{e.clear()})),vy(this.activeRowHeaders.values(),(e=>{e.clear()})),vy(this.activeColumnHeaders.values(),(e=>{e.clear()})),vy(this.activeCornerHeaders.values(),(e=>{e.clear()})),vy(this.rowHighlights.values(),(e=>{e.clear()})),vy(this.columnHighlights.values(),(e=>{e.clear()}))}[Symbol.iterator](){return[this.focus,this.fill,...this.areas.values(),...this.layeredAreas.values(),...this.rowHeaders.values(),...this.columnHeaders.values(),...this.activeRowHeaders.values(),...this.activeColumnHeaders.values(),...this.activeCornerHeaders.values(),...this.rowHighlights.values(),...this.columnHighlights.values(),...this.customSelections][Symbol.iterator]()}}function aM(e,t){const r=this.layerLevel;if(e.has(r))return e.get(r);const n=t({layerLevel:r,...this.options});return e.set(r,n),n}const lM=sM;function uM(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class hM{constructor(e){uM(this,"ranges",[]),uM(this,"createCellRange",void 0),this.createCellRange=e}isEmpty(){return 0===this.size()}set(e){return this.clear(),this.ranges.push(this.createCellRange(e)),this}add(e){return this.ranges.push(this.createCellRange(e)),this}pop(){return this.ranges.pop(),this}current(){return this.peekByIndex(this.size()-1)}previous(){return this.peekByIndex(this.size()-2)}includes(e){return this.ranges.some((t=>t.includes(e)))}clear(){return this.ranges.length=0,this}size(){return this.ranges.length}peekByIndex(){let e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return t>=0&&t<this.size()&&(e=this.ranges[t]),e}[Symbol.iterator](){return this.ranges[Symbol.iterator]()}}const cM=hM;function dM(e,t,r){pM(e,t),t.set(e,r)}function pM(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function mM(e,t){return e.get(fM(e,t))}function gM(e,t,r){return e.set(fM(e,t),r),r}function fM(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var yM=new WeakMap,wM=new WeakMap,EM=new WeakMap,vM=new WeakSet;class RM{constructor(e,t){var r,n;pM(r=this,n=vM),n.add(r),dM(this,yM,void 0),dM(this,wM,void 0),dM(this,EM,{x:0,y:0}),gM(yM,this,e),gM(wM,this,t)}transformStart(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const n=mM(wM,this).createCellCoords(e,t);let o=mM(yM,this).current().highlight;const i=mM(wM,this).visualToRenderableCoords(o);let s=0,a=0;if(this.runLocalHooks("beforeTransformStart",n),null!==i.row&&null!==i.col){const{width:e,height:t}=fM(vM,this,TM).call(this),{row:i,col:l}=fM(vM,this,NM).call(this,o),u=mM(wM,this).fixedRowsBottom(),h=mM(wM,this).minSpareRows(),c=mM(wM,this).minSpareCols(),d=mM(wM,this).autoWrapRow(),p=mM(wM,this).autoWrapCol(),m=mM(wM,this).createCellCoords(i+n.row,l+n.col);if(m.row>=t){const n=NE(r&&h>0&&0===u),o=m.col+1,i=mM(wM,this).createCellCoords(m.row-t,o>=e?o-e:o);this.runLocalHooks("beforeColumnWrap",n,fM(vM,this,AM).call(this,i),o>=e),n.value?this.runLocalHooks("insertRowRequire",mM(wM,this).countRenderableRows()):p&&m.assign(i)}else if(m.row<0){const r=NE(p),n=m.col-1,o=mM(wM,this).createCellCoords(t+m.row,n<0?e+n:n);this.runLocalHooks("beforeColumnWrap",r,fM(vM,this,AM).call(this,o),n<0),p&&m.assign(o)}if(m.col>=e){const n=NE(r&&c>0),o=m.row+1,i=mM(wM,this).createCellCoords(o>=t?o-t:o,m.col-e);this.runLocalHooks("beforeRowWrap",n,fM(vM,this,AM).call(this,i),o>=t),n.value?this.runLocalHooks("insertColRequire",mM(wM,this).countRenderableColumns()):d&&m.assign(i)}else if(m.col<0){const r=NE(d),n=m.row-1,o=mM(wM,this).createCellCoords(n<0?t+n:n,e+m.col);this.runLocalHooks("beforeRowWrap",r,fM(vM,this,AM).call(this,o),n<0),d&&m.assign(o)}const{rowDir:g,colDir:f}=fM(vM,this,SM).call(this,m);s=g,a=f,o=fM(vM,this,AM).call(this,m)}return this.runLocalHooks("afterTransformStart",o,s,a),o}transformEnd(e,t){const r=mM(wM,this).createCellCoords(e,t),n=mM(yM,this).current(),o=mM(wM,this).visualToRenderableCoords(n.highlight),i=fM(vM,this,CM).call(this,n.to.row,n.from.row),s=fM(vM,this,bM).call(this,n.to.col,n.from.col),a=n.to.clone();let l=0,u=0;if(this.runLocalHooks("beforeTransformEnd",r),null!==o.row&&null!==o.col&&null!==i&&null!==s){const{row:e,col:t}=fM(vM,this,NM).call(this,n.highlight),o=mM(wM,this).createCellCoords(i+r.row,s+r.col),h=n.getTopStartCorner(),c=n.getTopEndCorner(),d=n.getBottomEndCorner();if(r.col<0&&s>=t&&o.col<t){const e=o.col-t;o.col=fM(vM,this,bM).call(this,h.col,c.col)+e}else if(r.col>0&&s<=t&&o.col>t){const e=fM(vM,this,bM).call(this,c.col,h.col),t=Math.max(o.col-e,1);o.col=e+t}if(r.row<0&&i>=e&&o.row<e){const t=o.row-e;o.row=fM(vM,this,CM).call(this,h.row,d.row)+t}else if(r.row>0&&i<=e&&o.row>e){const e=fM(vM,this,CM).call(this,d.row,h.row),t=Math.max(o.row-e,1);o.row=e+t}const{rowDir:p,colDir:m}=fM(vM,this,SM).call(this,o);l=p,u=m;const g=fM(vM,this,AM).call(this,o);0===r.row&&0!==r.col?a.col=g.col:0!==r.row&&0===r.col?a.row=g.row:(a.row=g.row,a.col=g.col)}return this.runLocalHooks("afterTransformEnd",a,l,u),a}setOffsetSize(e){let{x:t,y:r}=e;gM(EM,this,{x:t,y:r})}resetOffsetSize(){gM(EM,this,{x:0,y:0})}}function SM(e){const{width:t,height:r}=fM(vM,this,TM).call(this);let n=0,o=0;return e.row<0?(n=-1,e.row=0):e.row>0&&e.row>=r&&(n=1,e.row=r-1),e.col<0?(o=-1,e.col=0):e.col>0&&e.col>=t&&(o=1,e.col=t-1),{rowDir:n,colDir:o}}function TM(){return{width:mM(EM,this).x+mM(wM,this).countRenderableColumns(),height:mM(EM,this).y+mM(wM,this).countRenderableRows()}}function CM(e,t){const r=mM(wM,this).findFirstNonHiddenRenderableRow(e,t);return null===r?null:mM(EM,this).y+r}function bM(e,t){const r=mM(wM,this).findFirstNonHiddenRenderableColumn(e,t);return null===r?null:mM(EM,this).x+r}function NM(e){const{row:t,col:r}=mM(wM,this).visualToRenderableCoords(e);if(null===t||null===r)throw new Error("Renderable coords are not visible.");return mM(wM,this).createCellCoords(mM(EM,this).y+t,mM(EM,this).x+r)}function AM(e){const t=e.clone();return t.col=e.col-mM(EM,this).x,t.row=e.row-mM(EM,this).y,mM(wM,this).renderableToVisualCoords(t)}EE(RM,cb);const IM=RM,OM=[3,2],MM=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],_M=Symbol("root"),xM=Symbol("child");function LM(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:_M;if(t!==_M&&t!==xM)throw new Error("The second argument is used internally only and cannot be overwritten.");const r=Array.isArray(e),n=t===_M;let o=0;if(r){const t=e[0];if(0===e.length)o=1;else if(n&&t instanceof fT)o=3;else if(n&&Array.isArray(t))o=LM(t,xM);else if(e.length>=2&&e.length<=4){const t=!e.some(((e,t)=>!MM[t].includes(typeof e)));t&&(o=2)}}return o}function FM(e,t,r){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,r)}function PM(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function VM(e,t){return e.get(DM(e,t))}function HM(e,t,r){return e.set(DM(e,t),r),r}function DM(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var UM=new WeakMap,kM=new WeakMap,BM=new WeakMap,WM=new WeakMap,GM=new WeakMap,jM=new WeakMap;class zM{constructor(e,t){var r=this;PM(this,"settings",void 0),PM(this,"tableProps",void 0),PM(this,"inProgress",!1),PM(this,"selectedRange",new cM(((e,t,r)=>this.tableProps.createCellRange(e,t,r)))),PM(this,"highlight",void 0),FM(this,UM,void 0),FM(this,kM,void 0),PM(this,"selectedByRowHeader",new Set),PM(this,"selectedByColumnHeader",new Set),FM(this,BM,!1),FM(this,WM,!1),FM(this,GM,"unknown"),FM(this,jM,-1),this.settings=e,this.tableProps=t,this.highlight=new lM({headerClassName:e.currentHeaderClassName,activeHeaderClassName:e.activeHeaderClassName,rowClassName:e.currentRowClassName,columnClassName:e.currentColClassName,cellAttributes:[["aria-selected","true"]],rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,disabledCellSelection:(e,t)=>this.tableProps.isDisabledCellSelection(e,t),cellCornerVisible:function(){return r.isCellCornerVisible(...arguments)},areaCornerVisible:function(){return r.isAreaCornerVisible(...arguments)},visualToRenderableCoords:e=>this.tableProps.visualToRenderableCoords(e),renderableToVisualCoords:e=>this.tableProps.renderableToVisualCoords(e),createCellCoords:(e,t)=>this.tableProps.createCellCoords(e,t),createCellRange:(e,t,r)=>this.tableProps.createCellRange(e,t,r)}),HM(UM,this,new IM(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>this.tableProps.countRenderableRows(),countRenderableColumns:()=>this.tableProps.countRenderableColumns(),visualToRenderableCoords:e=>this.tableProps.visualToRenderableCoords(e),renderableToVisualCoords:e=>this.tableProps.renderableToVisualCoords(e),findFirstNonHiddenRenderableRow:function(){return r.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return r.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(e,t)=>this.tableProps.createCellCoords(e,t),fixedRowsBottom:()=>e.fixedRowsBottom,minSpareRows:()=>e.minSpareRows,minSpareCols:()=>e.minSpareCols,autoWrapRow:()=>e.autoWrapRow,autoWrapCol:()=>e.autoWrapCol})),HM(kM,this,new IM(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>{const e=this.selectedRange.current();return this.tableProps.countRenderableRowsInRange(0,e.getOuterBottomEndCorner().row)},countRenderableColumns:()=>{const e=this.selectedRange.current();return this.tableProps.countRenderableColumnsInRange(0,e.getOuterBottomEndCorner().col)},visualToRenderableCoords:e=>this.tableProps.visualToRenderableCoords(e),renderableToVisualCoords:e=>this.tableProps.renderableToVisualCoords(e),findFirstNonHiddenRenderableRow:function(){return r.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return r.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(e,t)=>this.tableProps.createCellCoords(e,t),fixedRowsBottom:()=>0,minSpareRows:()=>0,minSpareCols:()=>0,autoWrapRow:()=>!0,autoWrapCol:()=>!0})),VM(UM,this).addLocalHook("beforeTransformStart",(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.runLocalHooks("beforeModifyTransformStart",...t)})),VM(UM,this).addLocalHook("afterTransformStart",(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.runLocalHooks("afterModifyTransformStart",...t)})),VM(UM,this).addLocalHook("beforeTransformEnd",(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.runLocalHooks("beforeModifyTransformEnd",...t)})),VM(UM,this).addLocalHook("afterTransformEnd",(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.runLocalHooks("afterModifyTransformEnd",...t)})),VM(UM,this).addLocalHook("insertRowRequire",(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.runLocalHooks("insertRowRequire",...t)})),VM(UM,this).addLocalHook("insertColRequire",(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.runLocalHooks("insertColRequire",...t)})),VM(UM,this).addLocalHook("beforeRowWrap",(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.runLocalHooks("beforeRowWrap",...t)})),VM(UM,this).addLocalHook("beforeColumnWrap",(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.runLocalHooks("beforeColumnWrap",...t)})),VM(kM,this).addLocalHook("beforeTransformStart",(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.runLocalHooks("beforeModifyTransformFocus",...t)})),VM(kM,this).addLocalHook("afterTransformStart",(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.runLocalHooks("afterModifyTransformFocus",...t)}))}getSelectedRange(){return this.selectedRange}markSource(e){HM(GM,this,e)}markEndSource(){HM(GM,this,"unknown")}getSelectionSource(){return VM(GM,this)}setExpectedLayers(e){HM(jM,this,e)}begin(){this.inProgress=!0}finish(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1,HM(jM,this,-1)}isInProgress(){return this.inProgress}setRangeStart(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e;const o="multiple"===this.settings.selectionMode,i=Ny(t)?this.tableProps.getShortcutManager().isCtrlPressed():t,s=e.clone();HM(BM,this,!1),this.runLocalHooks("beforeSetRangeStart"+(r?"Only":""),s),(!o||o&&!i&&Ny(t))&&this.selectedRange.clear(),this.selectedRange.add(s).current().setHighlight(n.clone()),0===this.getLayerLevel()&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),r||this.setRangeEnd(e)}setRangeStartOnly(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e;this.setRangeStart(e,t,!0,r)}setRangeEnd(e){if(this.selectedRange.isEmpty())return;const t=e.clone(),r=this.tableProps.countRows(),n=this.tableProps.countCols(),o=this.selectedRange.current().clone().setTo(e).isSingleHeader();if((r>0||n>0)&&(0===r&&t.col<0&&!o||0===n&&t.row<0&&!o))return;this.runLocalHooks("beforeSetRangeEnd",t),this.begin();const i=this.selectedRange.current();if(this.settings.navigableHeaders||i.highlight.normalize(),"single"===this.settings.selectionMode)i.setFrom(i.highlight),i.setTo(i.highlight);else{const e=i.getHorizontalDirection(),r=i.getVerticalDirection(),n=this.isMultiple();i.setTo(t),n&&(e!==i.getHorizontalDirection()||1===i.getWidth()&&!i.includes(i.highlight))&&i.from.assign({col:i.highlight.col}),n&&(r!==i.getVerticalDirection()||1===i.getHeight()&&!i.includes(i.highlight))&&i.from.assign({row:i.highlight.row})}r>0&&n>0&&(!this.settings.navigableHeaders||this.settings.navigableHeaders&&!i.isSingleHeader())&&i.to.normalize(),this.runLocalHooks("beforeHighlightSet"),this.setRangeFocus(this.selectedRange.current().highlight),this.applyAndCommit();const s=-1===VM(jM,this)||this.selectedRange.size()===VM(jM,this);this.runLocalHooks("afterSetRangeEnd",e,s)}applyAndCommit(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.selectedRange.current(),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.getLayerLevel();const r=this.tableProps.countRows(),n=this.tableProps.countCols();t<this.highlight.layerLevel&&(vy(this.highlight.getAreas(),(e=>{e.clear()})),vy(this.highlight.getLayeredAreas(),(e=>{e.clear()})),vy(this.highlight.getRowHeaders(),(e=>{e.clear()})),vy(this.highlight.getColumnHeaders(),(e=>{e.clear()})),vy(this.highlight.getActiveRowHeaders(),(e=>{e.clear()})),vy(this.highlight.getActiveColumnHeaders(),(e=>{e.clear()})),vy(this.highlight.getActiveCornerHeaders(),(e=>{e.clear()})),vy(this.highlight.getRowHighlights(),(e=>{e.clear()})),vy(this.highlight.getColumnHighlights(),(e=>{e.clear()}))),this.highlight.useLayerLevel(t);const o=this.highlight.createArea(),i=this.highlight.createLayeredArea(),s=this.highlight.createRowHeader(),a=this.highlight.createColumnHeader(),l=this.highlight.createActiveRowHeader(),u=this.highlight.createActiveColumnHeader(),h=this.highlight.createActiveCornerHeader(),c=this.highlight.createRowHighlight(),d=this.highlight.createColumnHighlight();if(o.clear(),i.clear(),s.clear(),a.clear(),l.clear(),u.clear(),h.clear(),c.clear(),d.clear(),this.highlight.isEnabledFor(gb,e.highlight)&&(this.isMultiple()||t>=1)&&(o.add(e.from).add(e.to).commit(),i.add(e.from).add(e.to).commit(),1===t)){const e=this.selectedRange.previous();this.highlight.useLayerLevel(t-1),this.highlight.createArea().add(e.from).commit().syncWith(e),this.highlight.createLayeredArea().add(e.from).commit().syncWith(e),this.highlight.useLayerLevel(t)}if(this.highlight.isEnabledFor(mb,e.highlight)){if(!e.isSingleHeader()){const t=this.tableProps.createCellCoords(Math.max(e.from.row,0),-1),r=this.tableProps.createCellCoords(e.to.row,-1),n=this.tableProps.createCellCoords(-1,Math.max(e.from.col,0)),o=this.tableProps.createCellCoords(-1,e.to.col);"single"===this.settings.selectionMode?(s.add(t).commit(),a.add(n).commit(),c.add(t).commit(),d.add(n).commit()):(s.add(t).add(r).commit(),a.add(n).add(o).commit(),c.add(t).add(r).commit(),d.add(n).add(o).commit())}const t=!VM(WM,this)&&this.isEntireRowSelected()&&(n>0&&n===e.getWidth()||0===n&&this.isSelectedByRowHeader()),o=!VM(WM,this)&&this.isEntireColumnSelected()&&(r>0&&r===e.getHeight()||0===r&&this.isSelectedByColumnHeader());t&&l.add(this.tableProps.createCellCoords(Math.max(e.from.row,0),Math.min(-this.tableProps.countRowHeaders(),-1))).add(this.tableProps.createCellCoords(Math.max(e.to.row,0),-1)).commit(),o&&u.add(this.tableProps.createCellCoords(Math.min(-this.tableProps.countColHeaders(),-1),Math.max(e.from.col,0))).add(this.tableProps.createCellCoords(-1,Math.max(e.to.col,0))).commit(),t&&o&&h.add(this.tableProps.createCellCoords(-this.tableProps.countColHeaders(),-this.tableProps.countRowHeaders())).add(this.tableProps.createCellCoords(-1,-1)).commit()}}setRangeFocus(e){if(this.selectedRange.isEmpty())return;const t=this.selectedRange.current();this.inProgress||this.runLocalHooks("beforeSetFocus",e);const r=this.highlight.getFocus();r.clear(),t.setHighlight(e),this.inProgress||this.runLocalHooks("beforeHighlightSet"),this.highlight.isEnabledFor(fb,t.highlight)&&r.add(t.highlight).commit().syncWith(t),this.inProgress||(HM(BM,this,!0),this.runLocalHooks("afterSetFocus",t.highlight))}transformStart(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.settings.navigableHeaders?VM(UM,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):VM(UM,this).resetOffsetSize(),this.setRangeStart(VM(UM,this).transformStart(e,t,r))}transformEnd(e,t){this.settings.navigableHeaders?VM(UM,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):VM(UM,this).resetOffsetSize(),this.setRangeEnd(VM(UM,this).transformEnd(e,t))}transformFocus(e,t){const r=this.selectedRange.current(),{row:n,col:o}=r.getOuterTopStartCorner(),i=this.tableProps.countRenderableColumnsInRange(0,o-1),s=this.tableProps.countRenderableRowsInRange(0,n-1);r.highlight.isHeader()?VM(kM,this).setOffsetSize({x:o<0?Math.abs(o):-i,y:n<0?Math.abs(n):-s}):VM(kM,this).setOffsetSize({x:o<0?0:-i,y:n<0?0:-s});const a=VM(kM,this).transformStart(e,t);this.setRangeFocus(a.normalize())}shiftRows(e,t){if(!this.isSelected())return;const r=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByColumnHeader()||r.getOuterTopStartCorner().row>=e){const{from:n,to:o,highlight:i}=r,s=this.tableProps.countRows(),a=this.isSelectedByRowHeader(),l=this.isSelectedByColumnHeader(),u=l?-1:0,h=l?0:t;this.getSelectedRange().pop();const c=this.tableProps.createCellCoords(eS(n.row+h,u,s-1),n.col),d=this.tableProps.createCellCoords(eS(o.row+t,u,s-1),o.col);this.markSource("shift"),i.row>=e?this.setRangeStartOnly(c,!0,this.tableProps.createCellCoords(eS(i.row+t,0,s-1),i.col)):this.setRangeStartOnly(c,!0),a&&this.selectedByRowHeader.add(this.getLayerLevel()),l&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(d),this.markEndSource()}}shiftColumns(e,t){if(!this.isSelected())return;const r=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByRowHeader()||r.getOuterTopStartCorner().col>=e){const{from:n,to:o,highlight:i}=r,s=this.tableProps.countCols(),a=this.isSelectedByRowHeader(),l=this.isSelectedByColumnHeader(),u=a?-1:0,h=a?0:t;this.getSelectedRange().pop();const c=this.tableProps.createCellCoords(n.row,eS(n.col+h,u,s-1)),d=this.tableProps.createCellCoords(o.row,eS(o.col+t,u,s-1));this.markSource("shift"),i.col>=e?this.setRangeStartOnly(c,!0,this.tableProps.createCellCoords(i.row,eS(i.col+t,0,s-1))):this.setRangeStartOnly(c,!0),a&&this.selectedByRowHeader.add(this.getLayerLevel()),l&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(d),this.markEndSource()}}getLayerLevel(){return this.selectedRange.size()-1}isSelected(){return!this.selectedRange.isEmpty()}isMultiple(){if(!this.isSelected())return!1;const e=NE(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",e),e.value}isFocusSelectionChanged(){return this.isSelected()&&VM(BM,this)}isSelectedByRowHeader(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(e)&&(-1===e?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(e))}isEntireRowSelected(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();const t=e=>{const{col:t}=e.getOuterTopStartCorner(),r=this.tableProps.countRowHeaders(),n=this.tableProps.countCols();return(r>0&&t<0||0===r)&&e.getWidth()===n};if(-1===e)return Array.from(this.selectedRange).some((e=>t(e)));const r=this.selectedRange.peekByIndex(e);return!!r&&t(r)}isSelectedByColumnHeader(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&(-1===e?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(e))}isEntireColumnSelected(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();const t=e=>{const{row:t}=e.getOuterTopStartCorner(),r=this.tableProps.countColHeaders(),n=this.tableProps.countRows();return(r>0&&t<0||0===r)&&e.getHeight()===n};if(-1===e)return Array.from(this.selectedRange).some((e=>t(e)));const r=this.selectedRange.peekByIndex(e);return!!r&&t(r)}isSelectedByAnyHeader(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}isSelectedByCorner(){return this.selectedByColumnHeader.has(this.getLayerLevel())&&this.selectedByRowHeader.has(this.getLayerLevel())}inInSelection(e){return this.selectedRange.includes(e)}isCellCornerVisible(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}isCellVisible(e){const t=this.tableProps.visualToRenderableCoords(e);return null!==t.row&&null!==t.col}isAreaCornerVisible(e){return(!Number.isInteger(e)||e===this.getLayerLevel())&&(this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple())}clear(){this.selectedRange.clear(),this.highlight.clear()}deselect(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}selectAll(){var e;let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{focusPosition:!1,disableHeadersHighlight:!1};const o=this.tableProps.countRows(),i=this.tableProps.countCols(),s=this.tableProps.countRowHeaders(),a=this.tableProps.countColHeaders(),l=r?-a:0,u=t?-s:0;if(0===l&&0===u&&(0===o||0===i))return;let h=null===(e=this.getSelectedRange().current())||void 0===e?void 0:e.highlight;const{focusPosition:c,disableHeadersHighlight:d}=n;HM(WM,this,d),c&&Number.isInteger(null==c?void 0:c.row)&&Number.isInteger(null==c?void 0:c.col)&&(h=this.tableProps.createCellCoords(eS(c.row,l,o-1),eS(c.col,u,i-1)));const p=this.tableProps.createCellCoords(l,u),m=this.tableProps.createCellCoords(o-1,i-1);this.clear(),this.setRangeStartOnly(p,void 0,h),u<0&&this.selectedByRowHeader.add(this.getLayerLevel()),l<0&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(m),this.finish(),HM(WM,this,!1)}selectCells(e){var t=this;const r=LM(e);if(1===r)return!1;if(0===r)throw new Error(Ty`Unsupported format of the selection ranges was passed. To select cells pass\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`);const n=function(e){let{createCellCoords:t,createCellRange:r,keepDirection:n=!1,propToCol:o}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!OM.includes(e))throw new Error("Unsupported selection ranges schema type was provided.");return function(i){const s=3===e;let a=s?i.from.row:i[0],l=s?i.from.col:i[1],u=s?i.to.row:i[2],h=s?i.to.col:i[3];if("function"==typeof o&&("string"==typeof l&&(l=o(l)),"string"==typeof h&&(h=o(h))),Ny(u)&&(u=a),Ny(h)&&(h=l),!n){const e=a,t=l,r=u,n=h;a=Math.min(e,r),l=Math.min(t,n),u=Math.max(e,r),h=Math.max(t,n)}const c=t(a,l),d=t(u,h);return r(c,c,d)}}(r,{createCellCoords:function(){return t.tableProps.createCellCoords(...arguments)},createCellRange:function(){return t.tableProps.createCellRange(...arguments)},propToCol:e=>this.tableProps.propToCol(e),keepDirection:!0}),o=this.settings.navigableHeaders,i={countRows:this.tableProps.countRows(),countCols:this.tableProps.countCols(),countRowHeaders:o?this.tableProps.countRowHeaders():0,countColHeaders:o?this.tableProps.countColHeaders():0},s=!e.some((e=>{const t=n(e),r=t.isValid(i);return!(r&&!t.containsHeaders()||r&&t.containsHeaders()&&t.isSingleHeader())}));return s&&(this.clear(),this.setExpectedLayers(e.length),vy(e,(e=>{const{from:t,to:r}=n(e);this.setRangeStartOnly(t.clone(),!1),this.setRangeEnd(r.clone())})),this.finish()),s}selectColumns(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const n="string"==typeof e?this.tableProps.propToCol(e):e,o="string"==typeof t?this.tableProps.propToCol(t):t,i=this.tableProps.countRows(),s=this.tableProps.countCols(),a=this.tableProps.countColHeaders(),l=0===a?0:-a,u=this.tableProps.createCellCoords(l,n),h=this.tableProps.createCellCoords(i-1,o),c=this.tableProps.createCellRange(u,u,h).isValid({countRows:i,countCols:s,countRowHeaders:0,countColHeaders:a});if(c){let e=0,t=0;Number.isInteger(null==r?void 0:r.row)&&Number.isInteger(null==r?void 0:r.col)?(e=eS(r.row,l,i-1),t=eS(r.col,Math.min(n,o),Math.max(n,o))):(e=eS(r,l,i-1),t=n);const s=this.tableProps.createCellCoords(e,t),u=0===a?0:eS(s.row,l,-1),h=i-1,c=this.tableProps.createCellCoords(u,n),d=this.tableProps.createCellCoords(h,o);this.runLocalHooks("beforeSelectColumns",c,d,s),c.row=u,d.row=h,this.setRangeStartOnly(c,void 0,s),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(d),this.runLocalHooks("afterSelectColumns",c,d,s),this.finish()}return c}selectRows(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const n=this.tableProps.countRows(),o=this.tableProps.countCols(),i=this.tableProps.countRowHeaders(),s=0===i?0:-i,a=this.tableProps.createCellCoords(e,s),l=this.tableProps.createCellCoords(t,o-1),u=this.tableProps.createCellRange(a,a,l).isValid({countRows:n,countCols:o,countRowHeaders:i,countColHeaders:0});if(u){let n=0,a=0;Number.isInteger(null==r?void 0:r.row)&&Number.isInteger(null==r?void 0:r.col)?(n=eS(r.row,Math.min(e,t),Math.max(e,t)),a=eS(r.col,s,o-1)):(n=e,a=eS(r,s,o-1));const l=this.tableProps.createCellCoords(n,a),u=0===i?0:eS(l.col,s,-1),h=o-1,c=this.tableProps.createCellCoords(e,u),d=this.tableProps.createCellCoords(t,h);this.runLocalHooks("beforeSelectRows",c,d,l),c.col=u,d.col=h,this.setRangeStartOnly(c,void 0,l),this.selectedByRowHeader.add(this.getLayerLevel()),this.setRangeEnd(d),this.runLocalHooks("afterSelectRows",c,d,l),this.finish()}return u}refresh(){if(!this.isSelected())return;const e=this.tableProps.countRows(),t=this.tableProps.countCols();if(0===e||0===t)return void this.deselect();const r=this.selectedRange.peekByIndex(this.selectedRange.size()-1),{from:n,to:o,highlight:i}=r;this.clear(),i.assign({row:eS(i.row,-1/0,e-1),col:eS(i.col,-1/0,t-1)}),n.assign({row:eS(n.row,-1/0,e-1),col:eS(n.col,-1/0,t-1)}),o.assign({row:eS(o.row,0,e-1),col:eS(o.col,0,t-1)}),this.selectedRange.ranges.push(r),this.highlight.getFocus().add(i).commit().syncWith(r),this.applyAndCommit(r)}commit(){if(this.highlight.getCustomSelections().forEach((e=>{e.commit()})),!this.isSelected())return;const e=this.getLayerLevel(),t=this.selectedRange.current();this.highlight.isEnabledFor(fb,t.highlight)&&this.highlight.getFocus().commit().syncWith(t);for(let r=0;r<this.selectedRange.size();r+=1){this.highlight.useLayerLevel(r);const e=this.highlight.createArea(),t=this.highlight.createLayeredArea(),n=this.highlight.createRowHeader(),o=this.highlight.createColumnHeader(),i=this.highlight.createActiveRowHeader(),s=this.highlight.createActiveColumnHeader(),a=this.highlight.createActiveCornerHeader(),l=this.highlight.createRowHighlight(),u=this.highlight.createColumnHighlight();e.commit(),t.commit(),n.commit(),o.commit(),i.commit(),s.commit(),a.commit(),l.commit(),u.commit()}this.highlight.useLayerLevel(e)}}EE(zM,cb);const $M=zM;function YM(e){let t,r,n,o,i,s="";for(t=0,r=e.length;t<r;t+=1){for(o=e[t].length,n=0;n<o;n+=1)n>0&&(s+="\t"),i=e[t][n],"string"==typeof i?i.indexOf("\n")>-1?s+=`"${i.replace(/"/g,'""')}"`:s+=i:s+=null==i?"":i;t!==r-1&&(s+="\n")}return s}function XM(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class KM{static get DESTINATION_RENDERER(){return 1}static get DESTINATION_CLIPBOARD_GENERATOR(){return 2}constructor(e,t,r){XM(this,"hot",void 0),XM(this,"metaManager",void 0),XM(this,"tableMeta",void 0),XM(this,"dataSource",void 0),XM(this,"duckSchema",void 0),XM(this,"colToPropCache",void 0),XM(this,"propToColCache",void 0),this.hot=e,this.metaManager=r,this.tableMeta=r.getTableMeta(),this.dataSource=t,this.refreshDuckSchema(),this.createMap()}createMap(){const e=this.getSchema();if(void 0===e)throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");const t=this.tableMeta.columns;let r;if(this.colToPropCache=[],this.propToColCache=new Map,t){let n=0,o=0,i=!1;if("function"==typeof t){const t=bE(e);n=t>0?t:this.countFirstRowKeys(),i=!0}else{const e=this.tableMeta.maxCols;n=Math.min(e,t.length)}for(r=0;r<n;r++){const e=i?t(r):t[r];if(RE(e)){if(void 0!==e.data){const t=i?o:r;this.colToPropCache[t]=e.data,this.propToColCache.set(e.data,t)}o+=1}}}else this.recursiveDuckColumns(e)}countFirstRowKeys(){return fA(this.dataSource)}recursiveDuckColumns(e,t,r){let n,o=t,i=r;return void 0===o&&(o=0,i=""),"object"!=typeof e||Array.isArray(e)||TE(e,((e,t)=>{null===e?(n=i+t,this.colToPropCache.push(n),this.propToColCache.set(n,o),o+=1):o=this.recursiveDuckColumns(e,o,`${t}.`)})),o}colToProp(e){if(!1===Number.isInteger(e))return e;const t=this.hot.toPhysicalColumn(e);return null===t?e:this.colToPropCache&&by(this.colToPropCache[t])?this.colToPropCache[t]:t}propToCol(e){const t=this.propToColCache.get(e);if(by(t))return this.hot.toVisualColumn(t);const r=this.hot.toVisualColumn(e);return null===r?e:r}getSchema(){const e=this.tableMeta.dataSchema;return e?"function"==typeof e?e():e:this.duckSchema}createDuckSchema(){return this.dataSource&&this.dataSource[0]?gE(this.dataSource[0]):{}}refreshDuckSchema(){this.duckSchema=this.createDuckSchema()}createRow(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,{source:r,mode:n="above"}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const o=this.hot.countSourceRows();let i=o,s=0,a=e;("number"!=typeof a||a>=o)&&(a=o),a<this.hot.countRows()&&(i=this.hot.toPhysicalRow(a));if(!1===this.hot.runHooks("beforeCreateRow",a,t,r)||null===i)return{delta:0};const l=this.tableMeta.maxRows,u=this.getSchema().length,h=[];for(;s<t&&o+s<l;){let e=null;"array"===this.hot.dataType?this.tableMeta.dataSchema?e=wE(this.getSchema()):(e=[],ZR(u-1,(()=>e.push(null)))):"function"===this.hot.dataType?e=this.tableMeta.dataSchema(a+s):(e={},yE(e,this.getSchema())),h.push(e),s+=1}this.hot.rowIndexMapper.insertIndexes(a,s),"below"===n&&(i=Math.min(i+1,o)),this.spliceData(i,0,h);const c=this.hot.toVisualRow(i);return this.hot.countSourceRows()===h.length&&this.hot.columnIndexMapper.initToLength(this.hot.getInitialColumnCount()),s>0&&(null==e?this.metaManager.createRow(null,s):"auto"!==r&&this.metaManager.createRow(i,t)),this.hot.runHooks("afterCreateRow",c,s,r),this.hot.forceFullRender=!0,{delta:s,startPhysicalIndex:i}}createCol(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,{source:r,mode:n="start"}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!this.hot.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");const o=this.dataSource,i=this.tableMeta.maxCols,s=this.hot.countSourceCols();let a=e;("number"!=typeof a||a>=s)&&(a=s);if(!1===this.hot.runHooks("beforeCreateCol",a,t,r))return{delta:0};let l=s;a<this.hot.countCols()&&(l=this.hot.toPhysicalColumn(a));const u=this.hot.countSourceRows();let h=this.hot.countCols(),c=0,d=l;"end"===n&&(d=Math.min(d+1,s));const p=d;for(;c<t&&h<i;){if("number"!=typeof a||a>=h)if(u>0)for(let e=0;e<u;e+=1)void 0===o[e]&&(o[e]=[]),o[e].push(null);else o.push([null]);else for(let e=0;e<u;e++)o[e].splice(d,0,null);c+=1,d+=1,h+=1}this.hot.columnIndexMapper.insertIndexes(a,c),c>0&&(null==e?this.metaManager.createColumn(null,c):"auto"!==r&&this.metaManager.createColumn(p,t));const m=this.hot.toVisualColumn(p);return this.hot.runHooks("afterCreateCol",m,c,r),this.hot.forceFullRender=!0,this.refreshDuckSchema(),{delta:c,startPhysicalIndex:p}}removeRow(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0,n=Number.isInteger(e)?e:-t;const o=this.visualRowsToPhysical(n,t),i=this.hot.countSourceRows();n=(i+n)%i;if(!1===this.hot.runHooks("beforeRemoveRow",n,o.length,o,r))return!1;const s=o.length;if(this.filterData(n,s,o),n<this.hot.countRows()){this.hot.rowIndexMapper.removeIndexes(o);const e=by(this.tableMeta.columns)||by(this.tableMeta.dataSchema)||this.tableMeta.colHeaders;0!==this.hot.rowIndexMapper.getNotTrimmedIndexesLength()||e||this.hot.columnIndexMapper.setIndexesSequence([])}return o.slice(0).sort(((e,t)=>t-e)).forEach((e=>{this.metaManager.removeRow(e,1)})),this.hot.runHooks("afterRemoveRow",n,s,o,r),this.hot.forceFullRender=!0,!0}removeCol(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0;if("object"===this.hot.dataType||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");let n="number"!=typeof e?-t:e;n=(this.hot.countCols()+n)%this.hot.countCols();const o=this.visualColumnsToPhysical(n,t),i=o.slice(0).sort(((e,t)=>t-e));if(!1===this.hot.runHooks("beforeRemoveCol",n,t,o,r))return!1;let s=!0;const a=i.length,l=this.dataSource;for(let u=0;u<a;u++)s&&o[0]!==o[u]-u&&(s=!1);if(s)for(let u=0,h=this.hot.countSourceRows();u<h;u++)l[u].splice(o[0],t),0===u&&this.metaManager.removeColumn(o[0],t);else for(let u=0,h=this.hot.countSourceRows();u<h;u++)for(let e=0;e<a;e++)l[u].splice(i[e],1),0===u&&this.metaManager.removeColumn(i[e],1);return n<this.hot.countCols()&&(this.hot.columnIndexMapper.removeIndexes(o),this.tableMeta.rowHeaders||0!==this.hot.columnIndexMapper.getNotTrimmedIndexesLength()||this.hot.rowIndexMapper.setIndexesSequence([])),this.hot.runHooks("afterRemoveCol",n,t,o,r),this.hot.forceFullRender=!0,this.refreshDuckSchema(),!0}spliceCol(e,t,r){const n=this.hot.getDataAtCol(e),o=n.slice(t,t+r),i=n.slice(t+r);for(var s=arguments.length,a=new Array(s>3?s-3:0),l=3;l<s;l++)a[l-3]=arguments[l];gy(a,i);let u=0;for(;u<r;)a.push(null),u+=1;return function(e){const t=e.length;let r=0;for(;r<t;)e[r]=[e[r]],r+=1}(a),this.hot.populateFromArray(t,e,a,null,null,"spliceCol"),o}spliceRow(e,t,r){const n=this.hot.getSourceDataAtRow(e),o=n.slice(t,t+r),i=n.slice(t+r);for(var s=arguments.length,a=new Array(s>3?s-3:0),l=3;l<s;l++)a[l-3]=arguments[l];gy(a,i);let u=0;for(;u<r;)a.push(null),u+=1;return this.hot.populateFromArray(e,t,[a],null,null,"spliceRow"),o}spliceData(e,t,r){if(!1!==this.hot.runHooks("beforeDataSplice",e,t,r)){const t=[...this.dataSource.slice(0,e),...r,...this.dataSource.slice(e)];this.dataSource.length=0,t.forEach((e=>this.dataSource.push(e)))}}filterData(e,t,r){let n=this.hot.runHooks("filterData",e,t,r);!1===Array.isArray(n)&&(n=this.dataSource.filter(((e,t)=>-1===r.indexOf(t)))),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,n)}get(e,t){const r=this.hot.toPhysicalRow(e);let n=this.dataSource[r];const o=this.hot.runHooks("modifyRowData",r);n=isNaN(o)?o:n;const{dataDotNotation:i}=this.hot.getSettings();let s=null;if(n&&n.hasOwnProperty&&AE(n,t))s=n[t];else if(i&&"string"==typeof t&&t.indexOf(".")>-1){let e=n;if(!e)return null;const r=t.split(".");for(let t=0,n=r.length;t<n;t++)if(e=e[r[t]],void 0===e)return null;s=e}else"function"==typeof t&&(s=t(this.dataSource.slice(r,r+1)[0]));if(this.hot.hasHook("modifyData")){const e=NE(s);this.hot.runHooks("modifyData",r,this.propToCol(t),e,"get"),e.isTouched()&&(s=e.value)}return s}getCopyable(e,t){return this.hot.getCellMeta(e,this.propToCol(t)).copyable?this.get(e,t):""}set(e,t,r){const n=this.hot.toPhysicalRow(e);let o=r,i=this.dataSource[n];const s=this.hot.runHooks("modifyRowData",n);if(i=isNaN(s)?s:i,this.hot.hasHook("modifyData")){const e=NE(o);this.hot.runHooks("modifyData",n,this.propToCol(t),e,"set"),e.isTouched()&&(o=e.value)}const{dataDotNotation:a}=this.hot.getSettings();if(i&&i.hasOwnProperty&&AE(i,t))i[t]=o;else if(a&&"string"==typeof t&&t.indexOf(".")>-1){let e,r=i,n=0;const s=t.split(".");for(n=0,e=s.length-1;n<e;n++){if("__proto__"===s[n]||"constructor"===s[n]||"prototype"===s[n])return;void 0===r[s[n]]&&(r[s[n]]={}),r=r[s[n]]}r[s[n]]=o}else if("function"==typeof t)t(this.dataSource.slice(n,n+1)[0],o);else{if("__proto__"===t||"constructor"===t||"prototype"===t)return;i[t]=o}}visualRowsToPhysical(e,t){const r=this.hot.countSourceRows(),n=[];let o,i=(r+e)%r,s=t;for(;i<r&&s;)o=this.hot.toPhysicalRow(i),n.push(o),s-=1,i+=1;return n}visualColumnsToPhysical(e,t){const r=this.hot.countCols(),n=[];let o=(r+e)%r,i=t;for(;o<r&&i;){const e=this.hot.toPhysicalColumn(o);n.push(e),i-=1,o+=1}return n}clear(){for(let e=0;e<this.hot.countSourceRows();e++)for(let t=0;t<this.hot.countCols();t++)this.set(e,this.colToProp(t),"")}getLength(){const e=this.tableMeta.maxRows;let t;t=e<0||0===e?0:e||1/0;const r=this.hot.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(r,t)}getAll(){const e={row:0,col:0},t={row:Math.max(this.hot.countRows()-1,0),col:Math.max(this.hot.countCols()-1,0)};return e.row-t.row!=0||this.hot.countSourceRows()?this.getRange(e,t,KM.DESTINATION_RENDERER):[]}countCachedColumns(){return this.colToPropCache.length}getRange(e,t,r){const n=[];let o,i,s;const a=this.tableMeta.maxRows,l=this.tableMeta.maxCols;if(0===a||0===l)return[];const u=r===KM.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,h=Math.min(Math.max(a-1,0),Math.max(e.row,t.row)),c=Math.min(Math.max(l-1,0),Math.max(e.col,t.col));for(o=Math.min(e.row,t.row);o<=h;o++){s=[];const r=o>=0?this.hot.toPhysicalRow(o):o;for(i=Math.min(e.col,t.col);i<=c&&null!==r;i++)s.push(u.call(this,o,this.colToProp(i)));null!==r&&n.push(s)}return n}getText(e,t){return YM(this.getRange(e,t,KM.DESTINATION_RENDERER))}getCopyableText(e,t){return YM(this.getRange(e,t,KM.DESTINATION_CLIPBOARD_GENERATOR))}destroy(){this.hot=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}const qM=KM,{register:QM,getItem:ZM,hasItem:JM,getNames:e_,getValues:t_}=Iv("cellTypes");function r_(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e;const n="string"==typeof t.type?function(e){if(!JM(e))throw Error(`You declared cell type "${e}" as a string that is not mapped to a known object.\n                 Cell type must be an object or a string mapped to an object registered by\n                 "Handsontable.cellTypes.registerCellType" method`);return ZM(e)}(t.type):t.type;if(e._automaticallyAssignedMetaProps&&TE(t,((t,r)=>{e._automaticallyAssignedMetaProps.delete(r)})),!RE(n))return;r!==e||e._automaticallyAssignedMetaProps||(e._automaticallyAssignedMetaProps=new Set);const o={};TE(n,((t,n)=>{var i;(function(e,t){var r;return"CELL_TYPE"!==e&&((null===(r=t._automaticallyAssignedMetaProps)||void 0===r?void 0:r.has(e))||!AE(t,e))})(n,r)&&(o[n]=t,null===(i=e._automaticallyAssignedMetaProps)||void 0===i||i.add(n))})),fE(e,o)}function n_(e){return Number.isInteger(e)&&e>=0}function o_(e,t){if(!e())throw new Error(`Assertion failed: ${t}`)}function i_(e){return null==e}const s_=()=>({_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,ariaTags:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataDotNotation:!0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",timeFormat:"h:mm:ss a",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,headerClassName:void 0,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",imeFastEdit:!1,isEmptyCol(e){let t,r,n;for(t=0,r=this.countRows();t<r;t++)if(n=this.getDataAtCell(t,e),!1===Ay(n))return!1;return!0},isEmptyRow(e){let t,r,n,o;for(t=0,r=this.countCols();t<r;t++)if(n=this.getDataAtCell(e,t),!1===Ay(n))return"object"==typeof n&&(o=this.getCellMeta(e,t),vE(this.getSchema()[o.prop],n));return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,navigableHeaders:!1,tabNavigation:!0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:!1,renderAllColumns:!1,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,themeName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:!0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",viewportColumnRenderingThreshold:0,viewportRowRenderingThreshold:0,visibleRows:10,width:void 0,wordWrap:!0});function a_(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class l_{constructor(e){a_(this,"metaCtor",class{}),a_(this,"meta",void 0),this.meta=this.metaCtor.prototype,fE(this.meta,s_()),this.meta.instance=e}getMetaConstructor(){return this.metaCtor}getMeta(){return this.meta}updateMeta(e){var t;fE(this.meta,e),r_(this.meta,{...e,type:null!==(t=e.type)&&void 0!==t?t:this.meta.type},e)}}function u_(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class h_{constructor(e){u_(this,"meta",void 0);const t=e.getMetaConstructor();this.meta=new t}getMeta(){return this.meta}updateMeta(e){fE(this.meta,e),r_(this.meta,e,e)}}function c_(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class d_{constructor(e){c_(this,"valueFactory",void 0),c_(this,"data",[]),c_(this,"index",[]),c_(this,"holes",new Set),this.valueFactory=e}obtain(e){o_((()=>n_(e)),"Expecting an unsigned number.");const t=this._getStorageIndexByKey(e);let r;if(t>=0)r=this.data[t],void 0===r&&(r=this.valueFactory(e),this.data[t]=r);else if(r=this.valueFactory(e),this.holes.size>0){const t=this.holes.values().next().value;this.holes.delete(t),this.data[t]=r,this.index[e]=t}else this.data.push(r),this.index[e]=this.data.length-1;return r}insert(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;o_((()=>n_(e)||i_(e)),"Expecting an unsigned number or null/undefined argument.");const r=[],n=this.data.length;for(let i=0;i<t;i++)r.push(n+i),this.data.push(void 0);const o=i_(e)?this.index.length:e;this.index=[...this.index.slice(0,o),...r,...this.index.slice(o)]}remove(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;o_((()=>n_(e)||i_(e)),"Expecting an unsigned number or null/undefined argument.");const r=this.index.splice(i_(e)?this.index.length-t:e,t);for(let n=0;n<r.length;n++){const e=r[n];"number"==typeof e&&this.holes.add(e)}}size(){return this.data.length-this.holes.size}values(){return this.data.filter(((e,t)=>void 0!==e&&!this.holes.has(t)))[Symbol.iterator]()}entries(){const e=[];for(let r=0;r<this.data.length;r++){const t=this._getKeyByStorageIndex(r);-1!==t&&void 0!==this.data[r]&&e.push([t,this.data[r]])}let t=0;return{next:()=>{if(t<e.length){const r=e[t];return t+=1,{value:r,done:!1}}return{done:!0}}}}clear(){this.data=[],this.index=[],this.holes.clear()}_getStorageIndexByKey(e){return this.index.length>e?this.index[e]:-1}_getKeyByStorageIndex(e){return this.index.indexOf(e)}[Symbol.iterator](){return this.entries()}}function p_(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const m_=["data","width"];class g_{constructor(e){p_(this,"globalMeta",void 0),p_(this,"metas",new d_((()=>this._createMeta()))),this.globalMeta=e,this.metas=new d_((()=>this._createMeta()))}updateMeta(e,t){const r=this.getMeta(e);fE(r,t),r_(r,t)}createColumn(e,t){this.metas.insert(e,t)}removeColumn(e,t){this.metas.remove(e,t)}getMeta(e){return this.metas.obtain(e)}getMetaConstructor(e){return this.metas.obtain(e).constructor}clearCache(){this.metas.clear()}_createMeta(){return function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];function r(){}var n,o;n=r,(o=e).prototype.constructor=o,n.prototype=new o,n.prototype.constructor=n;for(let i=0;i<t.length;i++)r.prototype[t[i]]=void 0;return r}(this.globalMeta.getMetaConstructor(),m_).prototype}}function f_(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class y_{constructor(e){f_(this,"columnMeta",void 0),f_(this,"metas",new d_((()=>this._createRow()))),this.columnMeta=e}updateMeta(e,t,r){const n=this.getMeta(e,t);fE(n,r),r_(n,r)}createRow(e,t){this.metas.insert(e,t)}createColumn(e,t){for(let r=0;r<this.metas.size();r++)this.metas.obtain(r).insert(e,t)}removeRow(e,t){this.metas.remove(e,t)}removeColumn(e,t){for(let r=0;r<this.metas.size();r++)this.metas.obtain(r).remove(e,t)}getMeta(e,t,r){const n=this.metas.obtain(e).obtain(t);return void 0===r?n:n[r]}setMeta(e,t,r,n){var o;const i=this.metas.obtain(e).obtain(t);null===(o=i._automaticallyAssignedMetaProps)||void 0===o||o.delete(r),i[r]=n}removeMeta(e,t,r){delete this.metas.obtain(e).obtain(t)[r]}getMetas(){const e=[],t=Array.from(this.metas.values());for(let r=0;r<t.length;r++)by(t[r])&&e.push(...t[r].values());return e}getMetasAtRow(e){o_((()=>n_(e)),"Expecting an unsigned number.");const t=new Map(this.metas);return t.has(e)?Array.from(t.get(e).values()):[]}clearCache(){this.metas.clear()}_createRow(){return new d_((e=>this._createMeta(e)))}_createMeta(e){return new(this.columnMeta.getMetaConstructor(e))}}class w_{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];this.hot=e,this.globalMeta=new l_(e),this.tableMeta=new h_(this.globalMeta),this.columnMeta=new g_(this.globalMeta),this.cellMeta=new y_(this.columnMeta),r.forEach((e=>new e(this))),this.globalMeta.updateMeta(t)}getGlobalMeta(){return this.globalMeta.getMeta()}updateGlobalMeta(e){this.globalMeta.updateMeta(e)}getTableMeta(){return this.tableMeta.getMeta()}updateTableMeta(e){this.tableMeta.updateMeta(e)}getColumnMeta(e){return this.columnMeta.getMeta(e)}updateColumnMeta(e,t){this.columnMeta.updateMeta(e,t)}getCellMeta(e,t,r){let{visualRow:n,visualColumn:o}=r;const i=this.cellMeta.getMeta(e,t);return i.visualRow=n,i.visualCol=o,i.row=e,i.col=t,this.runLocalHooks("afterGetCellMeta",i),i}getCellMetaKeyValue(e,t,r){if("string"!=typeof r)throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(e,t,r)}setCellMeta(e,t,r,n){this.cellMeta.setMeta(e,t,r,n)}updateCellMeta(e,t,r){this.cellMeta.updateMeta(e,t,r)}removeCellMeta(e,t,r){this.cellMeta.removeMeta(e,t,r)}getCellsMeta(){return this.cellMeta.getMetas()}getCellsMetaAtRow(e){return this.cellMeta.getMetasAtRow(e)}createRow(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.createRow(e,t)}removeRow(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.removeRow(e,t)}createColumn(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.createColumn(e,t),this.columnMeta.createColumn(e,t)}removeColumn(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.removeColumn(e,t),this.columnMeta.removeColumn(e,t)}clearCellsCache(){this.cellMeta.clearCache()}clearCache(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}function E_(e,t,r,n){const{hotInstance:o,dataMap:i,dataSource:s,internalSource:a,source:l,metaManager:u,firstRun:h}=n,c=ky(a),d=o.getSettings();Array.isArray(d.dataSchema)?o.dataType="array":Hw(d.dataSchema)?o.dataType="function":o.dataType="object",i&&i.destroy(),e=o.runHooks(`before${c}`,e,h,l);const p=new qM(o,e,u);if(t(p),"object"==typeof e&&null!==e)e.push&&e.splice||(e=[e]);else{if(null!==e)throw new Error(`${a} only accepts array of objects or array of arrays (${typeof e} given)`);{const t=p.getSchema();let r;e=[];let n=0,i=0;for(n=0,i=d.startRows;n<i;n++)if("object"!==o.dataType&&"function"!==o.dataType||!d.dataSchema)if("array"===o.dataType)r=wE(t[0]),e.push(r);else{r=[];for(let e=0,t=d.startCols;e<t;e++)r.push(null);e.push(r)}else r=wE(t),e.push(r)}}Array.isArray(e[0])&&(o.dataType="array"),d.data=e,p.dataSource=e,s.data=e,s.dataType=o.dataType,s.colToProp=p.colToProp.bind(p),s.propToCol=p.propToCol.bind(p),s.countCachedColumns=p.countCachedColumns.bind(p),r(p),o.runHooks(`after${c}`,e,h,l),h||(o.runHooks("afterChange",null,a),o.render()),o.getSettings().ariaTags&&lw(o.rootElement,[zy(-1),$y(o.countCols()+(o.view?o.countRowHeaders():0))])}function v_(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}EE(w_,cb);class R_{constructor(e){v_(this,"metaManager",void 0),v_(this,"metaSyncMemo",new Map),this.metaManager=e,e.addLocalHook("afterGetCellMeta",(e=>this.extendCellMeta(e))),bv.getSingleton().add("beforeRender",(e=>{e&&this.metaSyncMemo.clear()}),this.metaManager.hot)}extendCellMeta(e){var t;const{row:r,col:n}=e;if(null!==(t=this.metaSyncMemo.get(r))&&void 0!==t&&t.has(n))return;const{visualRow:o,visualCol:i}=e,s=this.metaManager.hot,a=s.colToProp(i);e.prop=a,s.runHooks("beforeGetCellMeta",o,i,e);const l=AE(e,"type")?e.type:null;let u=Hw(e.cells)?e.cells(r,n,a):null;var h;l&&(u?u.type=null!==(h=u.type)&&void 0!==h?h:l:u={type:l});u&&this.metaManager.updateCellMeta(r,n,u),s.runHooks("afterGetCellMeta",o,i,e),this.metaSyncMemo.has(r)||this.metaSyncMemo.set(r,new Set),this.metaSyncMemo.get(r).add(n)}}function S_(e,t,r){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,r)}function T_(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function C_(e,t){return e.get(function(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}(e,t))}var b_=new WeakMap;class N_{constructor(e){T_(this,"metaManager",void 0),T_(this,"usageTracker",new Set),T_(this,"propDescriptors",new Map([["ariaTags",{initOnly:!0}],["fixedColumnsLeft",{target:"fixedColumnsStart",onChange(e){if(this.metaManager.hot.isRtl()&&"fixedColumnsLeft"===e)throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{initOnly:!0}],["renderAllColumns",{initOnly:!0}],["renderAllRows",{initOnly:!0}]])),S_(this,b_,((e,t,r)=>{if(!r)throw new Error(`The \`${e}\` option can not be updated after the Handsontable is initialized.`)})),this.metaManager=e,this.extendMetaProps()}extendMetaProps(){this.propDescriptors.forEach(((e,t)=>{const{initOnly:r,target:n,onChange:o}=e,i="string"==typeof n,s=i?n:t,a=`_${s}`;this.metaManager.globalMeta.meta[a]=this.metaManager.globalMeta.meta[s],o?(this.installPropWatcher(t,a,o),i&&this.installPropWatcher(n,a,o)):r&&(this.installPropWatcher(t,a,C_(b_,this)),this.metaManager.globalMeta.meta._initOnlySettings||(this.metaManager.globalMeta.meta._initOnlySettings=[]),this.metaManager.globalMeta.meta._initOnlySettings.push(t))}))}installPropWatcher(e,t,r){const n=this;Object.defineProperty(this.metaManager.globalMeta.meta,e,{get(){return this[t]},set(o){const i=!n.usageTracker.has(e);n.usageTracker.add(e),r.call(n,e,o,i),this[t]=o},enumerable:!0,configurable:!0})}}const A_="gridDefault",I_="editorManager.handlingEditor",O_={name:"editorCloseAndSave",callback(e){e._getEditorManager().closeEditorAndSaveChanges()}},M_={_hooksStorage:Object.create(null),addHook(e,t){return this._hooksStorage[e]||(this._hooksStorage[e]=[]),this.hot.addHook(e,t),this._hooksStorage[e].push(t),this},removeHooksByKey(e){vy(this._hooksStorage[e]||[],(t=>{this.hot.removeHook(e,t)}))},clearHooks(){TE(this._hooksStorage,((e,t)=>this.removeHooksByKey(t))),this._hooksStorage={}}};SE(M_,"MIXIN_NAME","hooksRefRegisterer",{writable:!1,enumerable:!1});const __=M_;function x_(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const L_=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"});class F_{static get EDITOR_TYPE(){return"base"}constructor(e){x_(this,"hot",void 0),x_(this,"state",L_.VIRGIN),x_(this,"_opened",!1),x_(this,"_fullEditMode",!1),x_(this,"_closeCallback",null),x_(this,"TD",null),x_(this,"row",null),x_(this,"col",null),x_(this,"prop",null),x_(this,"originalValue",null),x_(this,"cellProperties",null),this.hot=e,this.init()}_fireCallbacks(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)}init(){}getValue(){throw Error("Editor getValue() method unimplemented")}setValue(){throw Error("Editor setValue() method unimplemented")}open(){throw Error("Editor open() method unimplemented")}close(){throw Error("Editor close() method unimplemented")}prepare(e,t,r,n,o,i){this.TD=n,this.row=e,this.col=t,this.prop=r,this.originalValue=o,this.cellProperties=i,this.state=this.isOpened()?this.state:L_.VIRGIN}extend(){return class extends this.constructor{}}saveValue(e,t){let r,n,o,i;if(t){const e=this.hot.getSelectedLast();r=Math.max(Math.min(e[0],e[2]),0),n=Math.max(Math.min(e[1],e[3]),0),o=Math.max(e[0],e[2]),i=Math.max(e[1],e[3])}else[r,n,o,i]=[this.row,this.col,null,null];const s=this.hot.runHooks("modifyGetCellCoords",r,n,!1,"meta");Array.isArray(s)&&([r,n]=s),this.hot.populateFromArray(r,n,e,o,i,"edit")}beginEditing(e,t){if(this.state!==L_.VIRGIN)return;const r=this.hot,n=r.rowIndexMapper.getRenderableFromVisualIndex(this.row),o=r.columnIndexMapper.getRenderableFromVisualIndex(this.col),i=()=>{if(this.state=L_.EDITING,this.isInFullEditMode()){const t="string"==typeof e?e:Cy(this.originalValue);this.setValue(t)}this.open(t),this._opened=!0,this.focus(),r.view.render(),r.runHooks("afterBeginEditing",this.row,this.col)};this.hot.addHookOnce("afterScroll",i);r.view.scrollViewport(r._createCellCoords(n,o))||(this.hot.removeHook("afterScroll",i),i())}finishEditing(e,t,r){let n;if(r){const e=this._closeCallback;this._closeCallback=t=>{e&&e(t),r(t),this.hot.view.render()}}if(!this.isWaiting())if(this.state!==L_.VIRGIN){if(this.state===L_.EDITING){if(e)return this.cancelChanges(),void this.hot.view.render();const r=this.getValue();n=this.cellProperties.trimWhitespace?[["string"==typeof r?String.prototype.trim.call(r||""):r]]:[[r]],this.state=L_.WAITING,this.saveValue(n,t),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",(e=>{this.state=L_.FINISHED,this.discardEditor(e)})):(this.state=L_.FINISHED,this.discardEditor(!0))}}else this.hot._registerTimeout((()=>{this._fireCallbacks(!0)}))}cancelChanges(){this.state=L_.FINISHED,this.discardEditor()}discardEditor(e){if(this.state===L_.FINISHED)if(!1===e&&!0!==this.cellProperties.allowInvalid)this.hot.selectCell(this.row,this.col),this.focus(),this.state=L_.EDITING,this._fireCallbacks(!1);else{this.close(),this._opened=!1,this._fullEditMode=!1,this.state=L_.VIRGIN,this._fireCallbacks(!0);this.hot.getShortcutManager().setActiveContextName("grid")}}enableFullEditMode(){this._fullEditMode=!0}isInFullEditMode(){return this._fullEditMode}isOpened(){return this._opened}isWaiting(){return this.state===L_.WAITING}getEditedCellRect(){var e;const t=this.getEditedCell();if(!t)return;const{wtOverlays:r,wtViewport:n}=this.hot.view._wt,o=this.hot.rootWindow,i=fw(t),s=Cw(t),a=fw(this.hot.rootElement),l=Cw(this.hot.rootElement),u=r.topOverlay.holder,h=r.inlineStartOverlay.holder,c=u!==o?u.scrollTop:0,d=h!==o?h.scrollLeft:0,p=o.innerWidth-a.left-l,{wtTable:m}=null!==(e=r.getParentOverlay(t))&&void 0!==e?e:this.hot.view._wt,g=m.name,f=["master","inline_start"].includes(g)?c:0,y=["master","top","bottom"].includes(g)?d:0,w=i.top===a.top?0:1;let E=i.top-a.top-w-f,v=0;v=this.hot.isRtl()?o.innerWidth-i.left-s-p-1+y:i.left-a.left-1-y,["top","top_inline_start_corner"].includes(g)&&(E+=r.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(g)&&(v+=Math.abs(r.inlineStartOverlay.getOverlayOffset()));const R=this.hot.hasColHeaders(),S=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),T=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),C=this.hot.rowIndexMapper.getRenderableIndexesLength()-this.hot.view._wt.getSetting("fixedRowsBottom");(R&&S<=0||S===C)&&(E+=1),T<=0&&(v+=1);const b=n.rowsRenderCalculator.startPosition,N=n.columnsRenderCalculator.startPosition,A=Math.abs(r.inlineStartOverlay.getScrollPosition()),I=r.topOverlay.getScrollPosition(),O=_w(this.hot.rootDocument);let M=t.offsetTop;if(["inline_start","master"].includes(g)&&(M+=b-I),["bottom","bottom_inline_start_corner"].includes(g)){const{wtViewport:e,wtTable:t}=r.bottomOverlay.clone;M+=e.getWorkspaceHeight()-t.getHeight()-O}let _=t.offsetLeft;this.hot.isRtl()?(_=_>=0?m.getWidth()-t.offsetLeft:Math.abs(_),_+=N-A-s):["top","master","bottom"].includes(g)&&(_+=N-A);const x=o.getComputedStyle(this.TD),L=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",F=parseInt(x[L],10)>0?0:1,P=parseInt(x.borderTopWidth,10)>0?0:1,V=Cw(t)+F,H=bw(t)+P,D=((U=u)instanceof Window?U.document.body.scrollHeight>U.innerHeight:U.offsetWidth!==U.clientWidth)?O:0;var U;const k=function(e){return e instanceof Window?e.document.body.scrollWidth>e.innerWidth:e.offsetHeight!==e.clientHeight}(h)?O:0,B=this.hot.view.maximumVisibleElementWidth(_)-D+F;return{top:E,start:v,height:H,maxHeight:Math.max(this.hot.view.maximumVisibleElementHeight(M)-k+P,this.hot.view.getDefaultRowHeight()),width:V,maxWidth:B}}getEditedCellsLayerClass(){switch(this.checkEditorSection()){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}getEditedCell(){return this.hot.getCell(this.row,this.col,!0)}checkEditorSection(){const e=this.hot.countRows();let t="";return this.row<this.hot.getSettings().fixedRowsTop?t=this.col<this.hot.getSettings().fixedColumnsStart?"top-inline-start-corner":"top":this.hot.getSettings().fixedRowsBottom&&this.row>=e-this.hot.getSettings().fixedRowsBottom?t=this.col<this.hot.getSettings().fixedColumnsStart?"bottom-inline-start-corner":"bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(t="inline-start"),t}}EE(F_,__);const P_={name:"editorCloseAndSaveByArrowKeys",callback(e,t,r){const n=e._getEditorManager(),o=n.getActiveEditor();o.isInFullEditMode()&&o.state===L_.EDITING||(n.closeEditorAndSaveChanges(),e.getSelected()&&(r.includes("arrowdown")?e.selection.transformStart(1,0):r.includes("arrowup")?e.selection.transformStart(-1,0):r.includes("arrowleft")?e.selection.transformStart(0,-1*e.getDirectionFactor()):r.includes("arrowright")&&e.selection.transformStart(0,e.getDirectionFactor())),t.preventDefault())}},V_={name:"editorOpen",callback(e,t,r){const n=e._getEditorManager(),o=e.getSelectedRangeLast(),{highlight:i}=o;if(e.selection.isMultiple()&&!o.isHeader()&&e.countRenderedCols()>0&&e.countRenderedRows()>0){const n=e.getSettings(),o="function"==typeof n.enterMoves?n.enterMoves(t):n.enterMoves;r.includes("shift")?e.selection.transformFocus(-o.row,-o.col):e.selection.transformFocus(o.row,o.col)}else i.isHeader()||(e.getSettings().enterBeginsEditing?n.cellProperties.readOnly?n.moveSelectionAfterEnter(t):n.openEditor(null,t,!0):n.moveSelectionAfterEnter(t),DE(t))}};const H_=[O_,P_,{name:"editorCloseAndSaveByEnter",callback(e,t){const r=e._getEditorManager();r.closeEditorAndSaveChanges(t.ctrlKey||t.metaKey),r.moveSelectionAfterEnter(t)}},{name:"editorCloseWithoutSaving",callback(e){const t=e._getEditorManager();t.closeEditorAndRestoreOriginalValue(e.getShortcutManager().isCtrlPressed()),t.activeEditor.focus()}},{name:"editorFastOpen",callback(e,t){const{highlight:r}=e.getSelectedRangeLast();r.isHeader()||e._getEditorManager().openEditor(null,t,!0)}},V_,{name:"extendCellsSelectionDown",callback(e){const{highlight:t}=e.getSelectedRangeLast();e.selection.isSelectedByColumnHeader()||e.selection.isSelectedByCorner()||!(t.isCell()||t.isHeader()&&e.selection.isSelectedByRowHeader())||e.selection.transformEnd(1,0)}},{name:"extendCellsSelectionDownByViewportHeight",callback(e){const{to:t}=e.getSelectedRangeLast(),r=Math.min(t.row+e.countVisibleRows(),e.countRows()-1),n=e.rowIndexMapper.getNearestNotHiddenIndex(r,-1);if(null!==n){const r=e._createCellCoords(n,t.col),o=t.row-e.getFirstFullyVisibleRow(),i=Math.min(r.row-o,e.countRows()-1);e.selection.setRangeEnd(r),e.scrollViewportTo({row:i,verticalSnap:"top",horizontalSnap:"start"})}}},{name:"extendCellsSelectionLeft",callback(e){const{highlight:t}=e.getSelectedRangeLast();e.selection.isSelectedByRowHeader()||e.selection.isSelectedByCorner()||!(t.isCell()||t.isHeader()&&e.selection.isSelectedByColumnHeader())||e.selection.transformEnd(0,-1*e.getDirectionFactor())}},{name:"extendCellsSelectionRight",callback(e){const{highlight:t}=e.getSelectedRangeLast();e.selection.isSelectedByRowHeader()||e.selection.isSelectedByCorner()||!(t.isCell()||t.isHeader()&&e.selection.isSelectedByColumnHeader())||e.selection.transformEnd(0,e.getDirectionFactor())}},{name:"extendCellsSelectionToColumns",callback(e){const{highlight:t,from:r,to:n}=e.getSelectedRangeLast();e.selection.isSelectedByRowHeader()?e.selection.selectAll(!0,!0):e.selectColumns(r.col,n.col,t)}},{name:"extendCellsSelectionToMostBottom",callback(e){const{selection:t,rowIndexMapper:r}=e,{highlight:n,from:o,to:i}=e.getSelectedRangeLast(),s=n.isHeader()&&e.selection.isSelectedByRowHeader();if(n.isCell()||s){const a=r.getNearestNotHiddenIndex(e.countRows()-1,-1),l=o.clone();l.row=n.row,t.setRangeStart(l,void 0,!1,n.clone()),s&&t.selectedByRowHeader.add(t.getLayerLevel()),t.setRangeEnd(e._createCellCoords(a,i.col))}}},{name:"extendCellsSelectionToMostInlineEnd",callback(e){const{selection:t,columnIndexMapper:r}=e,{highlight:n,from:o,to:i}=e.getSelectedRangeLast();if(!e.selection.isSelectedByRowHeader()&&!e.selection.isSelectedByCorner()&&n.isCell()){const s=r.getNearestNotHiddenIndex(e.countCols()-1,-1),a=o.clone();a.col=n.col,t.setRangeStart(a,void 0,!1,n.clone()),t.setRangeEnd(e._createCellCoords(i.row,s))}}},{name:"extendCellsSelectionToMostInlineStart",callback(e){const{selection:t,columnIndexMapper:r}=e,{highlight:n,from:o,to:i}=e.getSelectedRangeLast();if(!e.selection.isSelectedByRowHeader()&&!e.selection.isSelectedByCorner()&&n.isCell()){const s=parseInt(e.getSettings().fixedColumnsStart,10),a=r.getNearestNotHiddenIndex(s,1),l=o.clone();l.col=n.col,t.setRangeStart(l,void 0,!1,n.clone()),t.setRangeEnd(e._createCellCoords(i.row,a))}}},{name:"extendCellsSelectionToMostLeft",callback(e){const{selection:t,columnIndexMapper:r}=e,{highlight:n,from:o,to:i}=e.getSelectedRangeLast(),s=n.isHeader()&&e.selection.isSelectedByColumnHeader();if(n.isCell()||s){const a=r.getNearestNotHiddenIndex(...e.isRtl()?[e.countCols()-1,-1]:[0,1]),l=o.clone();l.col=n.col,t.setRangeStart(l,void 0,!1,n.clone()),s&&t.selectedByColumnHeader.add(t.getLayerLevel()),t.setRangeEnd(e._createCellCoords(i.row,a))}}},{name:"extendCellsSelectionToMostRight",callback(e){const{selection:t,columnIndexMapper:r}=e,{highlight:n,from:o,to:i}=e.getSelectedRangeLast(),s=n.isHeader()&&e.selection.isSelectedByColumnHeader();if(n.isCell()||s){const a=r.getNearestNotHiddenIndex(...e.isRtl()?[0,1]:[e.countCols()-1,-1]),l=o.clone();l.col=n.col,t.setRangeStart(l,void 0,!1,n.clone()),s&&t.selectedByColumnHeader.add(t.getLayerLevel()),t.setRangeEnd(e._createCellCoords(i.row,a))}}},{name:"extendCellsSelectionToMostTop",callback(e){const{selection:t,rowIndexMapper:r}=e,{highlight:n,from:o,to:i}=e.getSelectedRangeLast(),s=n.isHeader()&&e.selection.isSelectedByRowHeader();if(n.isCell()||s){const a=r.getNearestNotHiddenIndex(0,1),l=o.clone();l.row=n.row,t.setRangeStart(l,void 0,!1,n.clone()),s&&t.selectedByRowHeader.add(t.getLayerLevel()),t.setRangeEnd(e._createCellCoords(a,i.col))}}},{name:"extendCellsSelectionToRows",callback(e){const{highlight:t,from:r,to:n}=e.getSelectedRangeLast();e.selection.isSelectedByColumnHeader()?e.selection.selectAll(!0,!0):e.selectRows(r.row,n.row,t)}},{name:"extendCellsSelectionUp",callback(e){const{highlight:t}=e.getSelectedRangeLast();e.selection.isSelectedByColumnHeader()||e.selection.isSelectedByCorner()||!(t.isCell()||t.isHeader()&&e.selection.isSelectedByRowHeader())||e.selection.transformEnd(-1,0)}},{name:"extendCellsSelectionUpByViewportHeight",callback(e){const{to:t}=e.getSelectedRangeLast(),r=Math.max(t.row-e.countVisibleRows(),0),n=e.rowIndexMapper.getNearestNotHiddenIndex(r,1);if(null!==n){const r=e._createCellCoords(n,t.col),o=t.row-e.getFirstFullyVisibleRow(),i=Math.max(r.row-o,0);e.selection.setRangeEnd(r),e.scrollViewportTo({row:i,verticalSnap:"top",horizontalSnap:"start"})}}},{name:"moveCellSelectionDown",callback(e){let{selection:t}=e;t.transformStart(1,0)}},{name:"moveCellSelectionDownByViewportHeight",callback(e){const{navigableHeaders:t}=e.getSettings(),r=t?e.countColHeaders():0,{row:n}=e.getSelectedRangeLast().highlight;let o=e.countVisibleRows()+r;o=0===o?1:o,n===e.countRows()-1?o=1:n+o>e.countRows()&&(o=e.countRows()-n-1),e.selection.transformStart(o,0),e.getSelectedRangeLast().highlight.row<0&&e.scrollViewportTo({row:0})}},{name:"moveCellSelectionInlineEnd",callback(e,t){const r=e.getSettings(),n=e.getSelectedRangeLast(),o="function"==typeof r.tabMoves?r.tabMoves(t):r.tabMoves;e.selection.isMultiple()&&!n.isHeader()&&e.countRenderedCols()>0&&e.countRenderedRows()>0?e.selection.transformFocus(-o.row,-o.col):e.selection.transformStart(-o.row,-o.col)}},{name:"moveCellSelectionInlineStart",callback(e,t){const r=e.getSettings(),n=e.getSelectedRangeLast(),o="function"==typeof r.tabMoves?r.tabMoves(t):r.tabMoves;e.selection.isMultiple()&&!n.isHeader()&&e.countRenderedCols()>0&&e.countRenderedRows()>0?e.selection.transformFocus(o.row,o.col):e.selection.transformStart(o.row,o.col)}},{name:"moveCellSelectionLeft",callback(e){e.selection.transformStart(0,-1*e.getDirectionFactor())}},{name:"moveCellSelectionRight",callback(e){e.selection.transformStart(0,e.getDirectionFactor())}},{name:"moveCellSelectionToMostBottom",callback(e){const{col:t}=e.getSelectedRangeLast().highlight;let r=e.rowIndexMapper.getNearestNotHiddenIndex(e.countRows()-1,-1);null===r&&(r=-1),e.selection.setRangeStart(e._createCellCoords(r,t))}},{name:"moveCellSelectionToMostBottomInlineEnd",callback(e){const{selection:t,rowIndexMapper:r,columnIndexMapper:n}=e,o=parseInt(e.getSettings().fixedRowsBottom,10),i=r.getNearestNotHiddenIndex(e.countRows()-o-1,-1),s=n.getNearestNotHiddenIndex(e.countCols()-1,-1);t.setRangeStart(e._createCellCoords(i,s))}},{name:"moveCellSelectionToMostInlineEnd",callback(e){const{selection:t,columnIndexMapper:r}=e;t.setRangeStart(e._createCellCoords(e.getSelectedRangeLast().highlight.row,r.getNearestNotHiddenIndex(e.countCols()-1,-1)))}},{name:"moveCellSelectionToMostInlineStart",callback(e){const{selection:t,columnIndexMapper:r}=e,n=parseInt(e.getSettings().fixedColumnsStart,10),o=e.getSelectedRangeLast().highlight.row,i=r.getNearestNotHiddenIndex(n,1);t.setRangeStart(e._createCellCoords(o,i))}},{name:"moveCellSelectionToMostLeft",callback(e){const{selection:t,columnIndexMapper:r}=e,n=e.getSelectedRangeLast().highlight.row;let o=r.getNearestNotHiddenIndex(...e.isRtl()?[e.countCols()-1,-1]:[0,1]);null===o&&(o=e.isRtl()?-1:-e.countRowHeaders()),t.setRangeStart(e._createCellCoords(n,o))}},{name:"moveCellSelectionToMostRight",callback(e){const{selection:t,columnIndexMapper:r}=e,{row:n}=e.getSelectedRangeLast().highlight;let o=r.getNearestNotHiddenIndex(...e.isRtl()?[0,1]:[e.countCols()-1,-1]);null===o&&(o=e.isRtl()?-e.countRowHeaders():-1),t.setRangeStart(e._createCellCoords(n,o))}},{name:"moveCellSelectionToMostTop",callback(e){const{col:t}=e.getSelectedRangeLast().highlight;let r=e.rowIndexMapper.getNearestNotHiddenIndex(0,1);null===r&&(r=-e.countColHeaders()),e.selection.setRangeStart(e._createCellCoords(r,t))}},{name:"moveCellSelectionToMostTopInlineStart",callback(e){const{selection:t,rowIndexMapper:r,columnIndexMapper:n}=e,o=parseInt(e.getSettings().fixedRowsTop,10),i=parseInt(e.getSettings().fixedColumnsStart,10),s=r.getNearestNotHiddenIndex(o,1),a=n.getNearestNotHiddenIndex(i,1);t.setRangeStart(e._createCellCoords(s,a))}},{name:"moveCellSelectionUp",callback(e){let{selection:t}=e;t.transformStart(-1,0)}},{name:"moveCellSelectionUpByViewportHight",callback(e){const{navigableHeaders:t}=e.getSettings(),r=t?e.countColHeaders():0,{row:n}=e.getSelectedRangeLast().highlight;let o=e.countVisibleRows()+r;o=0===o?-1:-o,n===-r?o=-1:n+o<r&&(o=-(n+r)),e.selection.transformStart(o,0),e.getSelectedRangeLast().highlight.row<0&&e.scrollViewportTo({row:0})}},{name:"emptySelectedCells",callback(e){e.emptySelectedCells(),e._getEditorManager().prepareEditor()}},{name:"scrollToFocusedCell",callback(e){const{highlight:t}=e.getSelectedRangeLast(),r=e.getFirstFullyVisibleRow()-1,n=e.getFirstFullyVisibleColumn()-1,o=e.getLastFullyVisibleRow()+1,i=e.getLastFullyVisibleColumn()+1,s=e._createCellCoords(r,n),a=e._createCellCoords(o,i);if(!e._createCellRange(s,s,a).includes(t)&&(t.row>=0||t.col>=0)){const r={};if(t.col>=0){const n=Math.floor(e.countVisibleCols()/2);r.col=Math.max(t.col-n,0)}if(t.row>=0){const n=Math.floor(e.countVisibleRows()/2);r.row=Math.max(t.row-n,0)}e.scrollViewportTo({...r,verticalSnap:"top",horizontalSnap:"start"})}}},{name:"selectAllCells",callback(e){e.selection.selectAll(!0,!0,{disableHeadersHighlight:!0})}},{name:"selectAllCellsAndHeaders",callback(e){e.selection.selectAll(!0,!0,{disableHeadersHighlight:!1})}},{name:"populateSelectedCellsData",callback(e){const t=e.getSelectedRange(),{row:r,col:n}=t[t.length-1].highlight.normalize(),o=e.getDataAtCell(r,n),i=new Map;for(let s=0;s<t.length;s++)t[s].forAll(((t,s)=>{if(t>=0&&s>=0&&(t!==r||s!==n)){const{readOnly:r}=e.getCellMeta(t,s);r||i.set(`${t}x${s}`,[t,s,o])}}));e.setDataAtCell(Array.from(i.values()))}}];function D_(e){const t={};return H_.forEach((r=>{let{name:n,callback:o}=r;t[n]=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return o(e,...r)}})),t}function U_(e){const t=e.getShortcutManager().addContext("editor"),r=D_(e),n={group:I_};t.addShortcuts([{keys:[["Enter"],["Enter","Shift"]],callback:(e,t)=>r.editorCloseAndSaveByEnter(e,t)},{keys:[["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],captureCtrl:!0,callback:(e,t)=>r.editorCloseAndSaveByEnter(e,t)},{keys:[["Tab"],["Tab","Shift"],["PageDown"],["PageUp"]],forwardToContext:e.getShortcutManager().getContext("grid"),callback:(e,t)=>r.editorCloseAndSave(e,t)},{keys:[["ArrowDown"],["ArrowUp"],["ArrowLeft"],["ArrowRight"]],preventDefault:!1,callback:(e,t)=>r.editorCloseAndSaveByArrowKeys(e,t)},{keys:[["Escape"],["Escape","Control/Meta"]],callback:()=>r.editorCloseWithoutSaving()}],n)}function k_(e){const t=e.getShortcutManager().addContext("grid"),r=D_(e),n={runOnlyIf:()=>{const{navigableHeaders:t}=e.getSettings();return by(e.getSelected())&&(t||!t&&e.countRenderedRows()>0&&e.countRenderedCols()>0)},group:A_};t.addShortcuts([{keys:[["F2"]],callback:e=>r.editorFastOpen(e)},{keys:[["Enter"],["Enter","Shift"]],callback:(e,t)=>r.editorOpen(e,t)},{keys:[["Backspace"],["Delete"]],callback:()=>r.emptySelectedCells()}],{group:I_,runOnlyIf:()=>by(e.getSelected())}),t.addShortcuts([{keys:[["Control/Meta","A"]],callback:()=>r.selectAllCells(),runOnlyIf:()=>{var t;return!(null!==(t=e.getSelectedRangeLast())&&void 0!==t&&t.highlight.isHeader())}},{keys:[["Control/Meta","A"]],callback:()=>{},runOnlyIf:()=>{var t;return null===(t=e.getSelectedRangeLast())||void 0===t?void 0:t.highlight.isHeader()},preventDefault:!0},{keys:[["Control/Meta","Shift","Space"]],callback:()=>r.selectAllCellsAndHeaders()},{keys:[["Control/Meta","Enter"]],callback:()=>r.populateSelectedCellsData(),runOnlyIf:()=>{var t,r;return!(null!==(t=e.getSelectedRangeLast())&&void 0!==t&&t.highlight.isHeader())&&(null===(r=e.getSelectedRangeLast())||void 0===r?void 0:r.getCellsCount())>1}},{keys:[["Control","Space"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToColumns()},{keys:[["Shift","Space"]],stopPropagation:!0,callback:()=>r.extendCellsSelectionToRows()},{keys:[["ArrowUp"]],callback:()=>r.moveCellSelectionUp()},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostTop()},{keys:[["ArrowUp","Shift"]],callback:()=>r.extendCellsSelectionUp()},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToMostTop(),runOnlyIf:()=>!(e.selection.isSelectedByCorner()||e.selection.isSelectedByColumnHeader())},{keys:[["ArrowDown"]],callback:()=>r.moveCellSelectionDown()},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostBottom()},{keys:[["ArrowDown","Shift"]],callback:()=>r.extendCellsSelectionDown()},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToMostBottom(),runOnlyIf:()=>!(e.selection.isSelectedByCorner()||e.selection.isSelectedByColumnHeader())},{keys:[["ArrowLeft"]],callback:()=>r.moveCellSelectionLeft()},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostLeft()},{keys:[["ArrowLeft","Shift"]],callback:()=>r.extendCellsSelectionLeft()},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToMostLeft(),runOnlyIf:()=>!(e.selection.isSelectedByCorner()||e.selection.isSelectedByRowHeader())},{keys:[["ArrowRight"]],callback:()=>r.moveCellSelectionRight()},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostRight()},{keys:[["ArrowRight","Shift"]],callback:()=>r.extendCellsSelectionRight()},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToMostRight(),runOnlyIf:()=>!(e.selection.isSelectedByCorner()||e.selection.isSelectedByRowHeader())},{keys:[["Home"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostInlineStart(),runOnlyIf:()=>e.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["Home","Shift"]],callback:()=>r.extendCellsSelectionToMostInlineStart()},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostTopInlineStart(),runOnlyIf:()=>e.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostInlineEnd(),runOnlyIf:()=>e.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End","Shift"]],callback:()=>r.extendCellsSelectionToMostInlineEnd()},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostBottomInlineEnd(),runOnlyIf:()=>e.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["PageUp"]],callback:()=>r.moveCellSelectionUpByViewportHight()},{keys:[["PageUp","Shift"]],callback:()=>r.extendCellsSelectionUpByViewportHeight()},{keys:[["PageDown"]],callback:()=>r.moveCellSelectionDownByViewportHeight()},{keys:[["PageDown","Shift"]],callback:()=>r.extendCellsSelectionDownByViewportHeight()},{keys:[["Tab"]],preventDefault:!1,callback:e=>r.moveCellSelectionInlineStart(e)},{keys:[["Shift","Tab"]],preventDefault:!1,callback:e=>r.moveCellSelectionInlineEnd(e)},{keys:[["Control/Meta","Backspace"]],callback:()=>r.scrollToFocusedCell()}],n)}function B_(e){const t=e.rootDocument.createElement("input");return t.type="text",t.name="__htFocusCatcher",t.classList.add("htFocusCatcher"),e.getSettings().ariaTags&&lw(t,[Gy(),jy()]),t}function W_(e){const t=function(e){return t=>{if(!t)return null;const r=G_(e),n=j_(e);return t.col<r.col&&(t.col=r.col),t.col>n.col&&(t.col=n.col),t.row<r.row&&(t.row=r.row),t.row>n.row&&(t.row=n.row),t}}(e);let r;const{activate:n,deactivate:o}=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r=e.rootElement,n=B_(e),o=B_(e);return n.addEventListener("focus",(()=>null==t?void 0:t.onFocusFromTop())),o.addEventListener("focus",(()=>null==t?void 0:t.onFocusFromBottom())),r.firstChild.before(n),r.lastChild.after(o),{activate(){e._registerTimeout((()=>{n.tabIndex=0,o.tabIndex=0}),10)},deactivate(){e._registerTimeout((()=>{n.tabIndex=-1,o.tabIndex=-1}),10)}}}(e,{onFocusFromTop(){var n;const o=null!==(n=t(r))&&void 0!==n?n:G_(e);o&&(e.runHooks("modifyFocusOnTabNavigation","from_above",o),e.selectCell(o.row,o.col)),e.listen()},onFocusFromBottom(){var n;const o=null!==(n=t(r))&&void 0!==n?n:j_(e);o&&(e.runHooks("modifyFocusOnTabNavigation","from_below",o),e.selectCell(o.row,o.col)),e.listen()}}),i={wrapped:!1,flipped:!1};let s=!0,a=!1,l=!1;e.addHook("afterListen",(()=>o())),e.addHook("afterUnlisten",(()=>n())),e.addHook("afterSelection",((t,n,o,u,h)=>{var c;(a&&(i.wrapped&&i.flipped||l)&&(l=!1,h.value=!0),s)&&(r=null===(c=e.getSelectedRangeLast())||void 0===c?void 0:c.highlight)})),e.addHook("beforeRowWrap",((e,t,r)=>{i.wrapped=!0,i.flipped=r}));const u={keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:A_,group:"focusCatcher"};e.getShortcutManager().getContext("grid").addShortcuts([{...u,callback:()=>{const{tabNavigation:t}=e.getSettings();a=!0,e.getSelectedRangeLast()&&!t&&(s=!1),t||(l=!0)},position:"before"},{...u,callback:t=>{const{tabNavigation:n,autoWrapRow:o}=e.getSettings();if(a=!1,s=!0,!n||!e.selection.isSelected()||o&&i.wrapped&&i.flipped||!o&&i.wrapped)return o&&i.wrapped&&i.flipped&&(r=t.shiftKey?G_(e):j_(e)),i.wrapped=!1,i.flipped=!1,e.deselectCell(),e.unlisten(),!1;t.preventDefault()},position:"after"}])}function G_(e){const{rowIndexMapper:t,columnIndexMapper:r}=e,{navigableHeaders:n}=e.getSettings();let o=n&&e.countColHeaders()>0?-e.countColHeaders():0,i=n&&e.countRowHeaders()>0?-e.countRowHeaders():0;return 0===o&&(o=t.getVisualFromRenderableIndex(o)),0===i&&(i=r.getVisualFromRenderableIndex(i)),null===o||null===i?null:e._createCellCoords(o,i)}function j_(e){var t,r;const{rowIndexMapper:n,columnIndexMapper:o}=e,{navigableHeaders:i}=e.getSettings();let s=n.getRenderableIndexesLength()-1,a=o.getRenderableIndexesLength()-1;if(s<0){if(!i||0===e.countColHeaders())return null;s=-1}if(a<0){if(!i||0===e.countColHeaders())return null;a=-1}return e._createCellCoords(null!==(t=n.getVisualFromRenderableIndex(s))&&void 0!==t?t:s,null!==(r=o.getVisualFromRenderableIndex(a))&&void 0!==r?r:a)}const z_=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),$_=e=>e.map((e=>{const t=e.toLowerCase();return z_.has(t)?z_.get(t):t})).sort().join("+"),Y_=new Map([[96,"numpad0"],[97,"numpad1"],[98,"numpad2"],[99,"numpad3"],[100,"numpad4"],[101,"numpad5"],[102,"numpad6"],[103,"numpad7"],[104,"numpad8"],[105,"numpad9"],[106,"multiply"],[107,"add"],[108,"decimal"],[109,"subtract"],[110,"decimal"],[111,"divide"],[112,"f1"],[113,"f2"],[114,"f3"],[115,"f4"],[116,"f5"],[117,"f6"],[118,"f7"],[119,"f8"],[120,"f9"],[121,"f10"],[122,"f11"],[123,"f12"],[186,"semicolon"],[187,"equal"],[188,"comma"],[189,"minus"],[190,"period"],[191,"slash"],[192,"backquote"],[219,"bracketleft"],[220,"backslash"],[221,"bracketright"],[222,"quote"]]),X_=e=>{let{which:t,key:r}=e;if(Y_.has(t))return Y_.get(t);const n=String.fromCharCode(t).toLowerCase();return/^[a-z0-9]$/.test(n)?n:r.toLowerCase()},K_=Symbol("shortcut-context");function q_(e){return RE(e)&&e.__kindOf===K_}const Q_=["meta","alt","shift","control"],Z_=function(){const e=new Set;return{press(t){e.add(t)},release(t){e.delete(t)},releaseAll(){e.clear()},isPressed:t=>e.has(t)}}(),J_=[];let ex=0;const tx=e=>{let{ownerWindow:t,handleEvent:r,beforeKeyDown:n,afterKeyDown:o}=e;const i=sS({errorIdExists:e=>`The "${e}" context name is already registered.`});let s="grid";const a=()=>s,l=e=>i.getItem(e);let u=!1;const h=function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:a();const n=q_(r)?r:l(r);let o=!1;if(!n.hasShortcut(t))return o;const i=n.getShortcuts(t);for(let s=0;s<i.length;s++){const{callback:r,runOnlyIf:n,preventDefault:a,stopPropagation:l,captureCtrl:c,forwardToContext:d}=i[s];if(!0===n(e)){if(u=c,o=!1===r(e,t),u=!1,a&&e.preventDefault(),l&&(DE(e),e.stopPropagation()),o)break;d&&h(e,t,d)}}return o},c=function(e,t,r,n,o){const i=e=>Q_.includes(e),s=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const r=[];return e.altKey&&r.push("alt"),t&&(e.ctrlKey||e.metaKey)?r.push("control/meta"):(e.ctrlKey&&r.push("control"),e.metaKey&&r.push("meta")),e.shiftKey&&r.push("shift"),r},a=e=>{if(!1===t(e))return;if(!1===r(e)||229===e.keyCode||"string"!=typeof e.key||UE(e))return;const a=X_(e);let l=[];i(a)||(l=s(e));const u=[a].concat(l);!o(e,u)&&(PE()&&l.includes("meta")||!PE()&&l.includes("control"))&&o(e,[a].concat(s(e,!0))),n(e)},l=e=>{if("string"==typeof e.key){const t=X_(e);i(t)&&Z_.press(t)}},u=e=>{if("string"==typeof e.key){const t=X_(e);i(t)&&Z_.release(t)}},h=()=>{Z_.releaseAll()};return{mount:()=>{let t=e;for(ex+=1;t;)1===ex&&(t.document.documentElement.addEventListener("keydown",l),J_.push({event:"keydown",listener:l}),t.document.documentElement.addEventListener("keyup",u),J_.push({event:"keyup",listener:u})),t.document.documentElement.addEventListener("keydown",a),t.document.documentElement.addEventListener("blur",h),t=Zy(t)},unmount:()=>{let t=e;for(ex-=1;t;){if(0===ex){for(let e=0;e<J_.length;e++){const{event:r,listener:n}=J_[e];t.document.documentElement.removeEventListener(r,n)}J_.length=0}t.document.documentElement.removeEventListener("keydown",a),t.document.documentElement.removeEventListener("blur",h),t=Zy(t)}},isPressed:e=>Z_.isPressed(e),releasePressedKeys:()=>Z_.releaseAll()}}(t,r,n,o,h);return c.mount(),{addContext:e=>{const t=(e=>{const t=sS({errorIdExists:t=>`The "${t}" shortcut is already registered in the "${e}" context.`}),r=function(){let{keys:e,callback:r,group:n,runOnlyIf:o=(()=>!0),captureCtrl:i=!1,preventDefault:s=!0,stopPropagation:a=!1,relativeToGroup:l,position:u,forwardToContext:h}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(Ny(n))throw new Error("You need to define the shortcut's group.");if(!1===Hw(r))throw new Error("The shortcut's callback needs to be a function.");if(!1===Array.isArray(e))throw new Error(Ty`Pass the shortcut\'s keys as an array of arrays,\x20
      using the KeyboardEvent.key properties:\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`);const c={callback:r,group:n,runOnlyIf:o,captureCtrl:i,preventDefault:s,stopPropagation:a};by(l)&&(c.relativeToGroup=l,c.position=u),q_(h)&&(c.forwardToContext=h),e.forEach((e=>{const r=$_(e);if(t.hasItem(r)){const e=t.getItem(r);let n=e.findIndex((e=>e.group===l));-1!==n?"before"===u?n-=1:n+=1:n=e.length,e.splice(n,0,c)}else t.addItem(r,[c])}))},n=e=>{const r=$_(e);t.removeItem(r)};return{__kindOf:K_,addShortcut:r,addShortcuts:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e.forEach((e=>{TE(t,((r,n)=>{!1===Object.prototype.hasOwnProperty.call(e,n)&&(e[n]=t[n])})),r(e)}))},getShortcuts:e=>{const r=$_(e),n=t.getItem(r);return by(n)?n.slice():[]},hasShortcut:e=>{const r=$_(e);return t.hasItem(r)},removeShortcutsByKeys:n,removeShortcutsByGroup:e=>{t.getItems().forEach((t=>{let[r,o]=t;const i=o.filter((t=>t.group!==e));0===i.length?n((e=>e.split("+"))(r)):(o.length=0,o.push(...i))}))}}})(e);return i.addItem(e,t),t},getActiveContextName:a,getContext:l,setActiveContextName:e=>{if(!i.hasItem(e))throw new Error(Ty`You've tried to activate the "${e}" shortcut context\x20
        that does not exist. Before activation, register the context using the "addContext" method.`);s=e},isCtrlPressed:()=>!u&&(c.isPressed("control")||c.isPressed("meta")),releasePressedKeys:()=>c.releasePressedKeys(),destroy:()=>c.unmount()}};function rx(e){const{classNames:t}=function(e,t){const r={element:void 0,classNames:[]};let n=e;for(;null!==n&&n!==e.ownerDocument.documentElement&&!r.element;){if("string"==typeof t&&n.classList.contains(t))r.element=n,r.classNames.push(t);else if(t instanceof RegExp){const e=Array.from(n.classList).filter((e=>t.test(e)));e.length&&(r.element=n,r.classNames.push(...e))}n=n.parentElement}return r}(e,/ht-theme-[a-zA-Z0-9_-]+/);return t.pop()}let nx=null;const ox=new Map;function ix(e,t){var r,n=this;let o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=this;const s=new Uv(i);let a,l,u,h,c,d,p=!0;var m;jN(o)&&(m=this,WN.set(m,!0)),this.rootElement=e,this.rootDocument=e.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;const g=null!==(r=null==t?void 0:t.layoutDirection)&&void 0!==r?r:"inherit",f=["rtl","ltr"].includes(g)?g:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",f),this.isRtl=function(){return"rtl"===f},this.isLtr=function(){return!i.isRtl()},this.getDirectionFactor=function(){return i.isLtr()?1:-1},t.language=function(e){let t=oI(e);return $O(t)||(t=UO,iI(e)),t}(t.language);const y=new w_(i,t,[R_,N_]),w=y.getTableMeta(),E=y.getGlobalMeta(),v=sS();this.container=this.rootDocument.createElement("div"),this.renderCall=!1,e.insertBefore(this.container,e.firstChild),zN(this)&&(Uy(t.licenseKey,e),sw(e,"ht-wrapper")),this.guid=`ht_${By()}`,ox.set(this.guid,this),this.columnIndexMapper=new nI,this.rowIndexMapper=new nI,this.columnIndexMapper.addLocalHook("indexesSequenceChange",(e=>{i.runHooks("afterColumnSequenceChange",e)})),this.rowIndexMapper.addLocalHook("indexesSequenceChange",(e=>{i.runHooks("afterRowSequenceChange",e)})),l=new wA(i),this.rootElement.id&&"ht_"!==this.rootElement.id.substring(0,3)||(this.rootElement.id=this.guid);let R=new $M(w,{rowIndexMapper:i.rowIndexMapper,columnIndexMapper:i.columnIndexMapper,countCols:()=>i.countCols(),countRows:()=>i.countRows(),propToCol:e=>a.propToCol(e),isEditorOpened:()=>!!i.getActiveEditor()&&i.getActiveEditor().isOpened(),countRenderableColumns:()=>this.view.countRenderableColumns(),countRenderableRows:()=>this.view.countRenderableRows(),countRowHeaders:()=>this.countRowHeaders(),countColHeaders:()=>this.countColHeaders(),countRenderableRowsInRange:function(){return n.view.countRenderableRowsInRange(...arguments)},countRenderableColumnsInRange:function(){return n.view.countRenderableColumnsInRange(...arguments)},getShortcutManager:()=>i.getShortcutManager(),createCellCoords:(e,t)=>i._createCellCoords(e,t),createCellRange:(e,t,r)=>i._createCellRange(e,t,r),visualToRenderableCoords:e=>{const{row:t,col:r}=e;return i._createCellCoords(t>=0?i.rowIndexMapper.getRenderableFromVisualIndex(t):t,r>=0?i.columnIndexMapper.getRenderableFromVisualIndex(r):r)},renderableToVisualCoords:e=>{const{row:t,col:r}=e;return i._createCellCoords(t>=0?i.rowIndexMapper.getVisualFromRenderableIndex(t):t,r>=0?i.columnIndexMapper.getVisualFromRenderableIndex(r):r)},findFirstNonHiddenRenderableRow:(e,t)=>{const r=t>e?1:-1,n=Math.min(e,t),o=Math.max(e,t),s=i.rowIndexMapper.getNearestNotHiddenIndex(e,r);return null===s||1===r&&s>o||-1===r&&s<n?null:s>=0?i.rowIndexMapper.getRenderableFromVisualIndex(s):s},findFirstNonHiddenRenderableColumn:(e,t)=>{const r=t>e?1:-1,n=Math.min(e,t),o=Math.max(e,t),s=i.columnIndexMapper.getNearestNotHiddenIndex(e,r);return null===s||1===r&&s>o||-1===r&&s<n?null:s>=0?i.columnIndexMapper.getRenderableFromVisualIndex(s):s},isDisabledCellSelection:(e,t)=>e<0||t<0?i.getSettings().disableVisualSelection:i.getCellMeta(e,t).disableVisualSelection});this.selection=R;const S=e=>{let{hiddenIndexesChanged:t}=e;t&&this.selection.commit()};function T(e){const t=oI(e);$O(t)?(i.runHooks("beforeLanguageChange",t),E.language=t,i.runHooks("afterLanguageChange",t)):iI(e)}function C(e,t){const r="className"===e?i.rootElement:i.table;if(p)sw(r,t);else{let n=[],o=[];E[e]&&(n=Array.isArray(E[e])?E[e]:Sy(E[e])),t&&(o=Array.isArray(t)?t:Sy(t));const i=Ry(n,o),s=Ry(o,n);i.length&&aw(r,i),s.length&&sw(r,s)}E[e]=t}function b(){let e=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue(){this.validatorsInQueue+=1,e=!1},removeValidatorFormQueue(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty(){},checkIfQueueIsEmpty(){0===this.validatorsInQueue&&!1===e&&(e=!0,this.onQueueEmpty(this.valid))}}}function N(e){const t=e.replace(",",".");return!1===isNaN(parseFloat(t))?parseFloat(t):e}function A(e,t,r){if(!e.length)return void r();const n=i.getActiveEditor(),o=new b;let s=!0;o.onQueueEmpty=()=>{n&&s&&n.cancelChanges(),r()};for(let l=e.length-1;l>=0;l--){const[r,n]=e[l],u=a.propToCol(n);let h;h=Number.isInteger(u)?i.getCellMeta(r,u):{...Object.getPrototypeOf(w),...w},i.getCellValidator(h)&&(o.addValidatorToQueue(),i.validateCell(e[l][3],h,function(t,r){return function(n){if("boolean"!=typeof n)throw new Error("Validation error: result is not boolean");!1===n&&!1===r.allowInvalid&&(s=!1,e.splice(t,1),r.valid=!0),o.removeValidatorFormQueue()}}(l,h),t))}o.checkIfQueueIsEmpty()}function I(e,t){for(let n=e.length-1;n>=0;n--){let t=!1;if(null!==e[n]){if(null!==e[n][2]&&void 0!==e[n][2]||null!==e[n][3]&&void 0!==e[n][3]){if(w.allowInsertRow)for(;e[n][0]>i.countRows()-1;){const{delta:e}=a.createRow(void 0,void 0,{source:"auto"});if(0===e){t=!0;break}}if("array"===i.dataType&&(!w.columns||0===w.columns.length)&&w.allowInsertColumn)for(;a.propToCol(e[n][1])>i.countCols()-1;){const{delta:e}=a.createCol(void 0,void 0,{source:"auto"});if(0===e){t=!0;break}}t||a.set(e[n][0],e[n][1],e[n][3])}}else e.splice(n,1)}const r=e.length>0;if(i.forceFullRender=!0,r){u.adjustRowsAndCols(),i.runHooks("beforeChangeRender",e,t),h.closeEditor(),i.view.render(),h.prepareEditor(),i.view.adjustElementsSize(),i.runHooks("afterChange",e,t||"edit");const r=i.getActiveEditor();r&&by(r.refreshValue)&&r.refreshValue()}else i.view.render()}function O(e,t,r){return Array.isArray(e)?e:[[e,t,r]]}function M(e,t){const r=i.runHooks("beforeChange",e,t||"edit"),n=e.filter((e=>null!==e));var o;if(!1===r||0===n.length)return null===(o=i.getActiveEditor())||void 0===o||o.cancelChanges(),[];for(let s=n.length-1;s>=0;s--){const[e,t,,r]=n[s],o=a.propToCol(t);let l;l=Number.isInteger(o)?i.getCellMeta(e,o):{...Object.getPrototypeOf(w),...w},"numeric"===l.type&&"string"==typeof r&&QR(r,[","])&&(n[s][3]=N(r))}return n}this.columnIndexMapper.addLocalHook("cacheUpdated",S),this.rowIndexMapper.addLocalHook("cacheUpdated",S),this.selection.addLocalHook("afterSetRangeEnd",((e,t)=>{const r=NE(!1),n=this.selection.getSelectedRange(),{from:o,to:s}=n.current(),a=n.size()-1;this.runHooks("afterSelection",o.row,o.col,s.row,s.col,r,a),this.runHooks("afterSelectionByProp",o.row,i.colToProp(o.col),s.row,i.colToProp(s.col),r,a),t&&(!r.isTouched()||r.isTouched()&&!r.value)&&d.scrollTo(e);const l=R.isSelectedByRowHeader(),u=R.isSelectedByColumnHeader();l&&u?sw(this.rootElement,["ht__selection--rows","ht__selection--columns"]):l?(aw(this.rootElement,"ht__selection--columns"),sw(this.rootElement,"ht__selection--rows")):u?(aw(this.rootElement,"ht__selection--rows"),sw(this.rootElement,"ht__selection--columns")):aw(this.rootElement,["ht__selection--rows","ht__selection--columns"]),"shift"!==R.getSelectionSource()&&h.closeEditor(null),i.view.render(),h.prepareEditor()})),this.selection.addLocalHook("beforeSetFocus",(e=>{this.runHooks("beforeSelectionFocusSet",e.row,e.col)})),this.selection.addLocalHook("afterSetFocus",(e=>{const t=NE(!1);this.runHooks("afterSelectionFocusSet",e.row,e.col,t),(!t.isTouched()||t.isTouched()&&!t.value)&&d.scrollTo(e),h.closeEditor(),i.view.render(),h.prepareEditor()})),this.selection.addLocalHook("afterSelectionFinished",(e=>{const t=e.length-1,{from:r,to:n}=e[t];this.runHooks("afterSelectionEnd",r.row,r.col,n.row,n.col,t),this.runHooks("afterSelectionEndByProp",r.row,i.colToProp(r.col),n.row,i.colToProp(n.col),t)})),this.selection.addLocalHook("afterIsMultipleSelection",(e=>{const t=this.runHooks("afterIsMultipleSelection",e.value);e.value&&(e.value=t)})),this.selection.addLocalHook("afterDeselect",(()=>{h.closeEditor(),i.view.render(),aw(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this.runHooks("afterDeselect")})),this.selection.addLocalHook("beforeHighlightSet",(()=>this.runHooks("beforeSelectionHighlightSet"))).addLocalHook("beforeSetRangeStart",(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.runHooks("beforeSetRangeStart",...t)})).addLocalHook("beforeSetRangeStartOnly",(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.runHooks("beforeSetRangeStartOnly",...t)})).addLocalHook("beforeSetRangeEnd",(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.runHooks("beforeSetRangeEnd",...t)})).addLocalHook("beforeSelectColumns",(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.runHooks("beforeSelectColumns",...t)})).addLocalHook("afterSelectColumns",(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.runHooks("afterSelectColumns",...t)})).addLocalHook("beforeSelectRows",(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.runHooks("beforeSelectRows",...t)})).addLocalHook("afterSelectRows",(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.runHooks("afterSelectRows",...t)})).addLocalHook("beforeModifyTransformStart",(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.runHooks("modifyTransformStart",...t)})).addLocalHook("afterModifyTransformStart",(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.runHooks("afterModifyTransformStart",...t)})).addLocalHook("beforeModifyTransformFocus",(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.runHooks("modifyTransformFocus",...t)})).addLocalHook("afterModifyTransformFocus",(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.runHooks("afterModifyTransformFocus",...t)})).addLocalHook("beforeModifyTransformEnd",(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.runHooks("modifyTransformEnd",...t)})).addLocalHook("afterModifyTransformEnd",(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.runHooks("afterModifyTransformEnd",...t)})).addLocalHook("beforeRowWrap",(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.runHooks("beforeRowWrap",...t)})).addLocalHook("beforeColumnWrap",(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.runHooks("beforeColumnWrap",...t)})).addLocalHook("insertRowRequire",(e=>this.alter("insert_row_above",e,1,"auto"))).addLocalHook("insertColRequire",(e=>this.alter("insert_col_start",e,1,"auto"))),u={alter(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=arguments.length>3?arguments[3]:void 0,o=arguments.length>4?arguments[4]:void 0;const s=e=>{if(0===e.length)return[];const t=[...e];t.sort(((e,t)=>{let[r]=e,[n]=t;return r===n?0:r>n?1:-1}));return yy(t,((e,t)=>{let[r,n]=t;const o=e[e.length-1],[i,s]=o,a=i+s;if(r<=a){const e=Math.max(n-(a-r),0);o[1]+=e}else e.push([r,n]);return e}),[t[0]])};switch(e){case"insert_row_below":case"insert_row_above":const o=i.countSourceRows();if(w.maxRows===o)return;const l="insert_row_below"===e?"below":"above";t=null!=t?t:"below"===l?o:0;const{delta:u,startPhysicalIndex:c}=a.createRow(t,r,{source:n,mode:l});R.shiftRows(i.toVisualRow(c),u);break;case"insert_col_start":case"insert_col_end":const d="insert_col_end"===e?"end":"start";t=null!=t?t:"end"===d?i.countSourceCols():0;const{delta:p,startPhysicalIndex:m}=a.createCol(t,r,{source:n,mode:d});if(p){if(Array.isArray(w.colHeaders)){const e=[i.toVisualColumn(m),0];e.length+=p,Array.prototype.splice.apply(w.colHeaders,e)}R.shiftColumns(i.toVisualColumn(m),p)}break;case"remove_row":const g=e=>{let t=0;vy(e,(e=>{let[r,o]=e;const s=Ay(r)?i.countRows()-1:Math.max(r-t,0);Number.isInteger(r)&&(r=Math.max(r-t,0));if(!a.removeRow(r,o,n))return;if(R.isSelected()){const{row:e}=i.getSelectedRangeLast().highlight;e>=r&&e<=r+o-1&&h.closeEditor(!0)}const l=i.countRows();0===l?R.deselect():"ContextMenu.removeRow"===n?R.refresh():R.shiftRows(r,-o);const u=w.fixedRowsTop;u>=s+1&&(w.fixedRowsTop-=Math.min(o,u-s));const c=w.fixedRowsBottom;c&&s>=l-c&&(w.fixedRowsBottom-=Math.min(o,c)),t+=o}))};Array.isArray(t)?g(s(t)):g([[t,r]]);break;case"remove_col":const f=e=>{let t=0;vy(e,(e=>{let[r,o]=e;const s=Ay(r)?i.countCols()-1:Math.max(r-t,0);let l=i.toPhysicalColumn(s);Number.isInteger(r)&&(r=Math.max(r-t,0));if(!a.removeCol(r,o,n))return;if(R.isSelected()){const{col:e}=i.getSelectedRangeLast().highlight;e>=r&&e<=r+o-1&&h.closeEditor(!0)}0===i.countCols()?R.deselect():"ContextMenu.removeColumn"===n?R.refresh():R.shiftColumns(r,-o);const u=w.fixedColumnsStart;u>=s+1&&(w.fixedColumnsStart-=Math.min(o,u-s)),Array.isArray(w.colHeaders)&&(void 0===l&&(l=-1),w.colHeaders.splice(l,o)),t+=o}))};Array.isArray(t)?f(s(t)):f([[t,r]]);break;default:throw new Error(`There is no such action "${e}"`)}o||u.adjustRowsAndCols(),i.view.render(),i.view.adjustElementsSize()},adjustRowsAndCols(){const e=w.minRows,t=w.minSpareRows,r=w.minCols,n=w.minSpareCols;if(e){const t=i.countRows();t<e&&a.createRow(t,e-t,{source:"auto"})}if(t){const e=i.countEmptyRows(!0);if(e<t){const r=t-e,n=Math.min(r,w.maxRows-i.countSourceRows());a.createRow(i.countRows(),n,{source:"auto"})}}{let e;(r||n)&&(e=i.countEmptyCols(!0));let t=i.countCols();if(r&&!w.columns&&t<r){const n=r-t;e+=n,a.createCol(t,n,{source:"auto"})}if(n&&!w.columns&&"array"===i.dataType&&e<n){t=i.countCols();const r=n-e,o=Math.min(r,w.maxCols-t);a.createCol(t,o,{source:"auto"})}}},populateFromArray(e,t,r,n,o){let s,a,l,u;const h=[],c={},d=[],p=e.row,m=e.col;if(a=t.length,0===a)return!1;let g=0,f=0;switch(RE(r)&&(g=r.col-m+1,f=r.row-p+1),o){case"shift_down":const o=fy(t),y=o.length,E=Math.max(y,g),v=i.getData().slice(p),R=fy(v).slice(m,m+E);for(l=0;l<E;l+=1)if(l<y){for(s=0,a=o[l].length;s<f-a;s+=1)o[l].push(o[l][s%a]);l<R.length?d.push(o[l].concat(R[l])):d.push(o[l].concat(new Array(v.length).fill(null)))}else d.push(o[l%y].concat(R[l]));i.populateFromArray(p,m,fy(d));break;case"shift_right":const S=t.length,T=Math.max(S,f),C=i.getData().slice(p).map((e=>e.slice(m)));for(s=0;s<T;s+=1)if(s<S){for(l=0,u=t[s].length;l<g-u;l+=1)t[s].push(t[s][l%u]);if(s<C.length)for(let e=0;e<C[s].length;e+=1)t[s].push(C[s][e]);else t[s].push(...new Array(C[0].length).fill(null))}else t.push(t[s%a].slice(0,T).concat(C[s]));i.populateFromArray(p,m,t);break;default:c.row=e.row,c.col=e.col;let b,N=0,A=0,I=!0;const O=function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const n=t[e%t.length];return null!==r?n[r%n.length]:n},M=t.length,_=r?r.row-e.row+1:0;for(a=r?_:Math.max(M,_),s=0;s<a&&!(r&&c.row>r.row&&_>M||!w.allowInsertRow&&c.row>i.countRows()-1||c.row>=w.maxRows);s++){const t=s-N,o=O(t).length,d=r?r.col-e.col+1:0;if(u=r?d:Math.max(o,d),c.col=e.col,b=i.getCellMeta(c.row,c.col),"CopyPaste.paste"!==n&&"Autofill.fill"!==n||!b.skipRowOnPaste){for(A=0,l=0;l<u&&!(r&&c.col>r.col&&d>o||!w.allowInsertColumn&&c.col>i.countCols()-1||c.col>=w.maxCols);l++){if(b=i.getCellMeta(c.row,c.col),("CopyPaste.paste"===n||"Autofill.fill"===n)&&b.skipColumnOnPaste){A+=1,c.col+=1,u+=1;continue}if(b.readOnly&&"UndoRedo.undo"!==n){c.col+=1;continue}let e=O(t,l-A),r=i.getDataAtCell(c.row,c.col);if(null!==e&&"object"==typeof e)if(Array.isArray(e)&&null===r&&(r=[]),null===r||"object"!=typeof r)I=!1;else{const t=gE(Array.isArray(r)?r:r[0]||r),n=gE(Array.isArray(e)?e:e[0]||e);vE(t,n)||Array.isArray(t)&&Array.isArray(n)?e=wE(e):I=!1}else null!==r&&"object"==typeof r&&(I=!1);I&&h.push([c.row,c.col,e]),I=!0,c.col+=1}c.row+=1}else N+=1,c.row+=1,a+=1}i.setDataAtCell(h,null,null,n||"populateFromArray")}}},this.init=function(){l.setData(w.data),i.runHooks("beforeInit"),(LE()||function(){let{maxTouchPoints:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:navigator;return e>2&&_E.mac.value}())&&sw(i.rootElement,"mobile"),this.updateSettings(w,!0),this.view=new hA(this);const e=w.themeName||rx(i.rootElement);i.useTheme(e),i.view.addClassNameToLicenseElement(i.getCurrentThemeName()),h=Xv.getInstance(i,w,R),d=function(e){const{selection:t}=e;let r=!1,n=!1;return{resume(){n=!1},suspend(){n=!0},skipNextScrollCycle(){r=!0},scrollTo(o){var i;if(r||n)return void(r=!1);let s;t.isFocusSelectionChanged()?s=function(e){return t=>{e.scrollViewportTo(t.toObject())}}(e):t.isSelectedByCorner()?s=()=>{}:t.isSelectedByRowHeader()?s=function(e){return t=>{let{row:r}=t;e.scrollViewportTo({row:r})}}(e):t.isSelectedByColumnHeader()?s=function(e){return t=>{let{col:r}=t;e.scrollViewportTo({col:r})}}(e):1===t.getSelectedRange().size()&&t.isMultiple()?s=function(e){return t=>{e.scrollViewportTo(t.toObject())}}(e):1!==t.getSelectedRange().size()||t.isMultiple()?t.getSelectedRange().size()>1&&(s=function(e){return t=>{e.scrollViewportTo(t.toObject())}}(e)):s=function(e){return t=>{const r=e.selection.getSelectionSource(),{row:n,col:o}=t;if(n<0&&o>=0)e.scrollViewportTo({col:o});else if(o<0&&n>=0)e.scrollViewportTo({row:n});else{if("mouse"===r&&(o===e.view.getLastPartiallyVisibleColumn()||n===e.view.getLastPartiallyVisibleRow()))return;e.scrollViewportTo({row:n,col:o})}}}(e),null===(i=s)||void 0===i||i(o)}}}(i),c=new aR(i),zN(this)&&W_(i),i.runHooks("init"),this.forceFullRender=!0,this.view.render(),p&&null===i.rootElement.offsetParent&&function(e,t){const r=new IntersectionObserver(((r,n)=>{r.forEach((r=>{r.isIntersecting&&null!==e.offsetParent&&(t(),n.unobserve(e))}))}),{root:e.ownerDocument.body});r.observe(e)}(i.rootElement,(()=>{i.view._wt.wtOverlays.updateLastSpreaderSize(),i.render(),i.view.adjustElementsSize()})),"object"==typeof p&&(i.runHooks("afterChange",p[0],p[1]),p=!1),i.runHooks("afterInit")},this._createCellCoords=function(e,t){return i.view._wt.createCellCoords(e,t)},this._createCellRange=function(e,t,r){return i.view._wt.createCellRange(e,t,r)},this.validateCell=function(e,t,r,n){let o=i.getCellValidator(t);function s(e){if(!(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])||!0===t.hidden)return void r(e);const n=t.visualCol,o=t.visualRow,s=i.getCell(o,n,!0);if(s&&"TH"!==s.nodeName){const e=i.rowIndexMapper.getRenderableFromVisualIndex(o),t=i.columnIndexMapper.getRenderableFromVisualIndex(n);i.view._wt.getSetting("cellRenderer",e,t,s)}r(e)}var a,l;l=o,"[object RegExp]"===Object.prototype.toString.call(l)&&(a=o,o=function(e,t){t(a.test(e))}),Hw(o)?(e=i.runHooks("beforeValidate",e,t.visualRow,t.prop,n),i._registerImmediate((()=>{o.call(t,e,(r=>{i&&(r=i.runHooks("afterValidate",r,e,t.visualRow,t.prop,n),t.valid=r,s(r),i.runHooks("postAfterValidate",r,e,t.visualRow,t.prop,n))}))}))):i._registerImmediate((()=>{t.valid=!0,s(t.valid,!1)}))},this.setDataAtCell=function(e,t,r,n){const o=O(e,t,r),s=[];let u,h,c,d=n;for(u=0,h=o.length;u<h;u++){if("object"!=typeof o[u])throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if("number"!=typeof o[u][1])throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");c=o[u][1]>=this.countCols()?o[u][1]:a.colToProp(o[u][1]),s.push([o[u][0],c,l.getAtCell(this.toPhysicalRow(o[u][0]),o[u][1]),o[u][2]])}d||"object"!=typeof e||(d=t);const p=M(s,d);i.runHooks("afterSetDataAtCell",p,d),A(p,d,(()=>{I(p,d)}))},this.setDataAtRowProp=function(e,t,r,n){const o=O(e,t,r),s=[];let a,u,h=n;for(a=0,u=o.length;a<u;a++)s.push([o[a][0],o[a][1],l.getAtCell(this.toPhysicalRow(o[a][0]),o[a][1]),o[a][2]]);h||"object"!=typeof e||(h=t);const c=M(s,n);i.runHooks("afterSetDataAtRowProp",c,h),A(c,h,(()=>{I(c,h)}))},this.listen=function(){i&&!i.isListening()&&(ox.forEach((e=>{i!==e&&e.unlisten()})),nx=i.guid,i.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(nx=null,i.runHooks("afterUnlisten"))},this.isListening=function(){return nx===i.guid},this.destroyEditor=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];h.closeEditor(e),i.view.render(),t&&R.isSelected()&&h.prepareEditor()},this.populateFromArray=function(e,t,r,n,o,s,a){if("object"!=typeof r||"object"!=typeof r[0])throw new Error("populateFromArray parameter `input` must be an array of arrays");const l="number"==typeof n?i._createCellCoords(n,o):null;return u.populateFromArray(i._createCellCoords(e,t),r,l,s,a)},this.spliceCol=function(e,t,r){for(var n=arguments.length,o=new Array(n>3?n-3:0),i=3;i<n;i++)o[i-3]=arguments[i];return a.spliceCol(e,t,r,...o)},this.spliceRow=function(e,t,r){for(var n=arguments.length,o=new Array(n>3?n-3:0),i=3;i<n;i++)o[i-3]=arguments[i];return a.spliceRow(e,t,r,...o)},this.getSelected=function(){if(R.isSelected())return Ey(R.getSelectedRange(),(e=>{let{from:t,to:r}=e;return[t.row,t.col,r.row,r.col]}))},this.getSelectedLast=function(){const e=this.getSelected();let t;return e&&e.length>0&&(t=e[e.length-1]),t},this.getSelectedRange=function(){if(R.isSelected())return Array.from(R.getSelectedRange())},this.getSelectedRangeLast=function(){const e=this.getSelectedRange();let t;return e&&e.length>0&&(t=e[e.length-1]),t},this.emptySelectedCells=function(e){if(!R.isSelected()||0===this.countRows()||0===this.countCols())return;const t=[];vy(R.getSelectedRange(),(e=>{if(e.isSingleHeader())return;const r=e.getTopStartCorner(),n=e.getBottomEndCorner();ZR(r.row,n.row,(e=>{ZR(r.col,n.col,(r=>{this.getCellMeta(e,r).readOnly||t.push([e,r,null])}))}))})),t.length>0&&this.setDataAtCell(t,e)},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){const e=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(e,0),this.isRenderSuspended()||e!==this.renderSuspendedCounter||(this.renderCall?this.render():i.view.render())},this.render=function(){this.view&&(this.renderCall=!0,this.forceFullRender=!0,this.isRenderSuspended()||i.view.render())},this.batchRender=function(e){this.suspendRender();const t=e();return this.resumeRender(),t},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(t,0),(!this.isExecutionSuspended()&&t===this.executionSuspendedCounter||e)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.suspendExecution();const r=e();return this.resumeExecution(t),r},this.batch=function(e){this.suspendRender(),this.suspendExecution();const t=e();return this.resumeExecution(),this.resumeRender(),t},this.refreshDimensions=function(){if(!i.view)return;const e=i.view,{width:t,height:r}=e.getLastSize(),{width:n,height:o}=i.rootElement.getBoundingClientRect(),s=n!==t||o!==r;!1===i.runHooks("beforeRefreshDimensions",{width:t,height:r},{width:n,height:o},s)||((s||e._wt.wtOverlays.scrollableElement===i.rootWindow)&&(e.setLastSize(n,o),i.render(),e.adjustElementsSize()),i.runHooks("afterRefreshDimensions",{width:t,height:r},{width:n,height:o},s))},this.updateData=function(e,t){E_(e,(e=>{a=e}),(e=>{a=e,i.columnIndexMapper.fitToLength(this.getInitialColumnCount()),i.rowIndexMapper.fitToLength(this.countSourceRows()),u.adjustRowsAndCols(),R.refresh()}),{hotInstance:i,dataMap:a,dataSource:l,internalSource:"updateData",source:t,metaManager:y,firstRun:p})},this.loadData=function(e,t){E_(e,(e=>{a=e}),(()=>{y.clearCellsCache(),i.initIndexMappers(),u.adjustRowsAndCols(),R.refresh(),p&&(p=[null,"loadData"])}),{hotInstance:i,dataMap:a,dataSource:l,internalSource:"loadData",source:t,metaManager:y,firstRun:p})},this.getInitialColumnCount=function(){const e=w.columns;let t=0;if(Array.isArray(e))t=e.length;else if(Hw(e))if("array"===i.dataType){const r=this.countSourceCols();for(let n=0;n<r;n+=1)e(n)&&(t+=1)}else"object"!==i.dataType&&"function"!==i.dataType||(t=a.colToPropCache.length);else if(by(w.dataSchema)){const e=a.getSchema();t=Array.isArray(e)?e.length:bE(e)}else t=this.countSourceCols();return t},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(e,t,r,n){return Ny(e)?a.getAll():a.getRange(i._createCellCoords(e,t),i._createCellCoords(r,n),a.DESTINATION_RENDERER)},this.getCopyableText=function(e,t,r,n){return a.getCopyableText(i._createCellCoords(e,t),i._createCellCoords(r,n))},this.getCopyableData=function(e,t){return a.getCopyable(e,a.colToProp(t))},this.getSchema=function(){return a.getSchema()},this.updateSettings=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const r=(p?i.loadData:i.updateData).bind(this);let n,o,s=!1;if(by(e.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(by(e.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(by(e.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');for(n in e)"data"===n||("language"===n?T(e.language):"className"===n?C("className",e.className):"tableClassName"===n&&i.table?(C("tableClassName",e.tableClassName),i.view._wt.wtOverlays.syncOverlayTableClassNames()):bv.getSingleton().isRegistered(n)||bv.getSingleton().isDeprecated(n)?Hw(e[n])?bv.getSingleton().addAsFixed(n,e[n],i):Array.isArray(e[n])&&bv.getSingleton().add(n,e[n],i):!t&&AE(e,n)&&(E[n]=e[n]));void 0===e.data&&void 0===w.data?r(null,"updateSettings"):void 0!==e.data?r(e.data,"updateSettings"):void 0!==e.columns&&(a.createMap(),i.initIndexMappers());const l=i.countCols(),h=w.columns;if(h&&Hw(h)&&(s=!0),void 0===e.cell&&void 0===e.cells&&void 0===e.columns||y.clearCache(),l>0)for(n=0,o=0;n<l;n++){if(h){const e=s?h(n):h[o];e&&y.updateColumnMeta(o,e)}o+=1}by(e.cell)&&TE(e.cell,(e=>{i.setCellMetaObject(e.row,e.col,e)})),i.runHooks("afterCellMetaReset");let c=i.rootElement.style.height;""!==c&&(c=parseInt(i.rootElement.style.height,10));let d=e.height;if(Hw(d)&&(d=d()),t){i.rootElement.getAttribute("style")&&i.rootElement.setAttribute("data-initialstyle",i.rootElement.getAttribute("style"))}if(null===d){const e=i.rootElement.getAttribute("data-initialstyle");e&&(e.indexOf("height")>-1||e.indexOf("overflow")>-1)?i.rootElement.setAttribute("style",e):(i.rootElement.style.height="",i.rootElement.style.overflow="")}else void 0!==d&&(i.rootElement.style.height=isNaN(d)?`${d}`:`${d}px`,i.rootElement.style.overflow="hidden");if(void 0!==e.width){let t=e.width;Hw(t)&&(t=t()),i.rootElement.style.width=isNaN(t)?`${t}`:`${t}px`}if(!t){if(i.view){i.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),i.view._wt.exportSettingsAsClassNames();const t=i.getCurrentThemeName(),r=AE(e,"themeName");t&&r&&t!==e.themeName&&(i.view.getStylesHandler().removeClassNames(),i.view.removeClassNameFromLicenseElement(t));const n=r&&e.themeName||rx(i.rootElement);i.useTheme(n),i.view.addClassNameToLicenseElement(i.getCurrentThemeName())}i.runHooks("afterUpdateSettings",e)}u.adjustRowsAndCols(),i.view&&!p&&(i.forceFullRender=!0,i.view.render(),i.view._wt.wtOverlays.adjustElementsSize()),t||!i.view||""!==c&&""!==d&&void 0!==d||c===d||i.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){const e=i.getSelectedLast();if(w.getValue){if(Hw(w.getValue))return w.getValue.call(i);if(e)return i.getData()[e[0][0]][w.getValue]}else if(e)return i.getDataAtCell(e[0],e[1])},this.getSettings=function(){return w},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(e,t,r,n,o){u.alter(e,t,r,n,o)},this.getCell=function(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=t,o=e;if(t>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(t)))return null;n=this.columnIndexMapper.getRenderableFromVisualIndex(t)}if(e>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(e)))return null;o=this.rowIndexMapper.getRenderableFromVisualIndex(e)}return null===o||null===n||void 0===o||void 0===n?null:i.view.getCellAtCoords(i._createCellCoords(o,n),r)},this.getCoords=function(e){const t=this.view._wt.wtTable.getCoords(e);if(null===t)return null;const{row:r,col:n}=t;let o=r,s=n;return r>=0&&(o=this.rowIndexMapper.getVisualFromRenderableIndex(r)),n>=0&&(s=this.columnIndexMapper.getVisualFromRenderableIndex(n)),i._createCellCoords(o,s)},this.colToProp=function(e){return a.colToProp(e)},this.propToCol=function(e){return a.propToCol(e)},this.toVisualRow=e=>this.rowIndexMapper.getVisualFromPhysicalIndex(e),this.toVisualColumn=e=>this.columnIndexMapper.getVisualFromPhysicalIndex(e),this.toPhysicalRow=e=>this.rowIndexMapper.getPhysicalFromVisualIndex(e),this.toPhysicalColumn=e=>this.columnIndexMapper.getPhysicalFromVisualIndex(e),this.getDataAtCell=function(e,t){return a.get(e,a.colToProp(t))},this.getDataAtRowProp=function(e,t){return a.get(e,t)},this.getDataAtCol=function(e){const t=[],r=a.getRange(i._createCellCoords(0,e),i._createCellCoords(w.data.length-1,e),a.DESTINATION_RENDERER);for(let n=0;n<r.length;n+=1)for(let e=0;e<r[n].length;e+=1)t.push(r[n][e]);return t},this.getDataAtProp=function(e){const t=[],r=a.getRange(i._createCellCoords(0,a.propToCol(e)),i._createCellCoords(w.data.length-1,a.propToCol(e)),a.DESTINATION_RENDERER);for(let n=0;n<r.length;n+=1)for(let e=0;e<r[n].length;e+=1)t.push(r[n][e]);return t},this.getSourceData=function(e,t,r,n){let o;return o=void 0===e?l.getData():l.getByRange(i._createCellCoords(e,t),i._createCellCoords(r,n)),o},this.getSourceDataArray=function(e,t,r,n){let o;return o=void 0===e?l.getData(!0):l.getByRange(i._createCellCoords(e,t),i._createCellCoords(r,n),!0),o},this.getSourceDataAtCol=function(e){return l.getAtColumn(e)},this.setSourceDataAtCell=function(e,t,r,n){const o=O(e,t,r),s=this.hasHook("afterSetSourceDataAtCell"),a=[];s&&vy(o,(e=>{let[t,r,n]=e;a.push([t,r,l.getAtCell(t,r),n])})),vy(o,(e=>{let[t,r,n]=e;l.setAtCell(t,r,n)})),s&&this.runHooks("afterSetSourceDataAtCell",a,n),this.render();const u=i.getActiveEditor();u&&by(u.refreshValue)&&u.refreshValue()},this.getSourceDataAtRow=function(e){return l.getAtRow(e)},this.getSourceDataAtCell=function(e,t){return l.getAtCell(e,t)},this.getDataAtRow=function(e){return a.getRange(i._createCellCoords(e,0),i._createCellCoords(e,this.countCols()-1),a.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(e,t,r,n){const o=void 0===e?[0,0,this.countRows(),this.countCols()]:[e,t,r,n],[i,s]=o;let[,,a,l]=o,u=null,h=null;void 0===a&&(a=i),void 0===l&&(l=s);let c="mixed";return ZR(Math.max(Math.min(i,a),0),Math.max(i,a),(e=>{let t=!0;return ZR(Math.max(Math.min(s,l),0),Math.max(s,l),(r=>{const n=this.getCellMeta(e,r);return h=n.type,u?t=u===h:u=h,t})),c=t?h:"mixed",t})),c},this.removeCellMeta=function(e,t,r){const[n,o]=[this.toPhysicalRow(e),this.toPhysicalColumn(t)];let s=y.getCellMetaKeyValue(n,o,r);!1!==i.runHooks("beforeRemoveCellMeta",e,t,r,s)&&(y.removeCellMeta(n,o,r),i.runHooks("afterRemoveCellMeta",e,t,r,s)),s=null},this.spliceCellsMeta=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;for(var r=arguments.length,n=new Array(r>2?r-2:0),o=2;o<r;o++)n[o-2]=arguments[o];if(n.length>0&&!Array.isArray(n[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");t>0&&y.removeRow(this.toPhysicalRow(e),t),n.length>0&&vy(n.reverse(),(t=>{y.createRow(this.toPhysicalRow(e)),vy(t,((t,r)=>this.setCellMetaObject(e,r,t)))})),i.render()},this.setCellMetaObject=function(e,t,r){"object"==typeof r&&TE(r,((r,n)=>{this.setCellMeta(e,t,n,r)}))},this.setCellMeta=function(e,t,r,n){if(!1===i.runHooks("beforeSetCellMeta",e,t,r,n))return;let o=e,s=t;e<this.countRows()&&(o=this.toPhysicalRow(e)),t<this.countCols()&&(s=this.toPhysicalColumn(t)),y.setCellMeta(o,s,r,n),i.runHooks("afterSetCellMeta",e,t,r,n)},this.getCellsMeta=function(){return y.getCellsMeta()},this.getCellMeta=function(e,t){let r=this.toPhysicalRow(e),n=this.toPhysicalColumn(t);return null===r&&(r=e),null===n&&(n=t),y.getCellMeta(r,n,{visualRow:e,visualColumn:t})},this.getColumnMeta=function(e){return y.getColumnMeta(this.toPhysicalColumn(e))},this.getCellMetaAtRow=function(e){return y.getCellsMetaAtRow(e)},this.isColumnModificationAllowed=function(){return!("object"===i.dataType||w.columns)},this.getCellRenderer=function(e,t){const r="number"==typeof e?i.getCellMeta(e,t).renderer:e.renderer;return"string"==typeof r?yS(r):Ny(r)?yS("text"):r},this.getCellEditor=function(e,t){const r="number"==typeof e?i.getCellMeta(e,t).editor:e.editor;return"string"==typeof r?Vv(r):Ny(r)?Vv("text"):r},this.getCellValidator=function(e,t){const r="number"==typeof e?i.getCellMeta(e,t).validator:e.validator;return"string"==typeof r?function(e){if("function"==typeof e)return e;if(!vS(e))throw Error(`No registered validator found under "${e}" name`);return ES(e)}(r):r},this.validateCells=function(e){this._validateCells(e)},this.validateRows=function(e,t){if(!Array.isArray(e))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(t,e)},this.validateColumns=function(e,t){if(!Array.isArray(e))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(t,void 0,e)},this._validateCells=function(e,t,r){const n=new b;e&&(n.onQueueEmpty=e);let o=i.countRows()-1;for(;o>=0;){if(void 0!==t&&-1===t.indexOf(o)){o-=1;continue}let e=i.countCols()-1;for(;e>=0;)void 0===r||-1!==r.indexOf(e)?(n.addValidatorToQueue(),i.validateCell(i.getDataAtCell(o,e),i.getCellMeta(o,e),(e=>{if("boolean"!=typeof e)throw new Error("Validation error: result is not boolean");!1===e&&(n.valid=!1),n.removeValidatorFormQueue()}),"validateCells"),e-=1):e-=1;o-=1}n.checkIfQueueIsEmpty()},this.getRowHeader=function(e){let t=w.rowHeaders,r=e;return void 0!==r&&(r=i.runHooks("modifyRowHeader",r)),void 0===r?(t=[],ZR(i.countRows()-1,(e=>{t.push(i.getRowHeader(e))}))):Array.isArray(t)&&void 0!==t[r]?t=t[r]:Hw(t)?t=t(r):t&&"string"!=typeof t&&"number"!=typeof t&&(t=r+1),t},this.hasRowHeaders=function(){return!!w.rowHeaders},this.hasColHeaders=function(){if(void 0!==w.colHeaders&&null!==w.colHeaders)return!!w.colHeaders;for(let e=0,t=i.countCols();e<t;e++)if(i.getColHeader(e))return!0;return!1},this.getColHeader=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;const r=i.runHooks("modifyColHeader",e);if(void 0===r){const e=[],t=i.countCols();for(let r=0;r<t;r++)e.push(i.getColHeader(r));return e}let n=w.colHeaders;const o=i.toPhysicalColumn(r),s=function(e){const t=[],r=i.countCols();let n=0;for(;n<r;n++)Hw(w.columns)&&w.columns(n)&&t.push(n);return t[e]}(o);return!1===w.colHeaders?n=null:w.columns&&Hw(w.columns)&&w.columns(s)&&w.columns(s).title?n=w.columns(s).title:w.columns&&w.columns[o]&&w.columns[o].title?n=w.columns[o].title:Array.isArray(w.colHeaders)&&void 0!==w.colHeaders[o]?n=w.colHeaders[o]:Hw(w.colHeaders)?n=w.colHeaders(o):w.colHeaders&&"string"!=typeof w.colHeaders&&"number"!=typeof w.colHeaders&&(n=function(e){let t,r=e+1,n="";for(;r>0;)t=(r-1)%gA,n=String.fromCharCode(65+t)+n,r=parseInt((r-t)/gA,10);return n}(r)),n=i.runHooks("modifyColumnHeaderValue",n,e,t),n},this._getColWidthFromSettings=function(e){let t;if(e>=0){t=i.getCellMeta(0,e).width}if(void 0!==t&&t!==w.width||(t=w.colWidths),null!=t){switch(typeof t){case"object":t=t[e];break;case"function":t=t(e)}"string"==typeof t&&(t=parseInt(t,10))}return t},this.getColWidth=function(e,t){let r=i._getColWidthFromSettings(e);return r=i.runHooks("modifyColWidth",r,e,t),void 0===r&&(r=ZS),r},this._getRowHeightFromSettings=function(e){const t=this.view.getDefaultRowHeight();let r=w.rowHeights;if(null!=r){switch(typeof r){case"object":r=r[e];break;case"function":r=r(e)}"string"==typeof r&&(r=parseInt(r,10))}return null!=r&&r<t?t:r},this.getRowHeight=function(e,t){let r=i._getRowHeightFromSettings(e);return r=i.runHooks("modifyRowHeight",r,e,t),r},this.countSourceRows=function(){return l.countRows()},this.countSourceCols=function(){return l.countFirstRowKeys()},this.countRows=function(){return a.getLength()},this.countCols=function(){const e=w.maxCols,t=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(e,t)},this.countRenderedRows=function(){return i.view._wt.drawn?i.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return i.view._wt.drawn?i.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return i.view._wt.drawn?i.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return i.view._wt.drawn?i.view._wt.wtTable.getVisibleColumnsCount():-1},this.countRowHeaders=function(){return this.view.getRowHeadersCount()},this.countColHeaders=function(){return this.view.getColumnHeadersCount()},this.countEmptyRows=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=0;return JR(i.countRows()-1,(r=>{if(i.isEmptyRow(r))t+=1;else if(!0===e)return!1})),t},this.countEmptyCols=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=0;return JR(i.countCols()-1,(r=>{if(i.isEmptyCol(r))t+=1;else if(!0===e)return!1})),t},this.isEmptyRow=function(e){return w.isEmptyRow.call(i,e)},this.isEmptyCol=function(e){return w.isEmptyCol.call(i,e)},this.selectCell=function(e,t,r,n){let o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],i=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];return!Ny(e)&&!Ny(t)&&this.selectCells([[e,t,r,n]],o,i)},this.selectCells=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[[]],t=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];!1===(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&d.suspend();const r=R.selectCells(e);return r&&t&&i.listen(),d.resume(),r},this.selectColumns=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,r=arguments.length>2?arguments[2]:void 0;return R.selectColumns(e,t,r)},this.selectRows=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,r=arguments.length>2?arguments[2]:void 0;return R.selectRows(e,t,r)},this.deselectCell=function(){R.deselect()},this.selectAll=function(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,r=arguments.length>2?arguments[2]:void 0;d.skipNextScrollCycle(),R.selectAll(e,t,r)};const _=(e,t)=>e.getNearestNotHiddenIndex(t,1,!0);this.scrollViewportTo=function(e){var t;"number"==typeof e&&(e={row:arguments[0],col:arguments[1],verticalSnap:arguments[2]?"bottom":"top",horizontalSnap:arguments[3]?"end":"start",considerHiddenIndexes:null===(t=arguments[4])||void 0===t||t});const{row:r,col:n,considerHiddenIndexes:o}=null!=e?e:{};let s=r,a=n;if(void 0===o||o){const e=Number.isInteger(r)&&r>=0,t=Number.isInteger(n)&&n>=0,o=e?_(this.rowIndexMapper,r):void 0,l=t?_(this.columnIndexMapper,n):void 0;if(null===o||null===l)return!1;s=e?i.rowIndexMapper.getRenderableFromVisualIndex(o):r,a=t?i.columnIndexMapper.getRenderableFromVisualIndex(l):n}const l=Number.isInteger(s),u=Number.isInteger(a);return l&&s>=0&&u&&a>=0?i.view.scrollViewport(i._createCellCoords(s,a),e.horizontalSnap,e.verticalSnap):l&&s>=0&&(u&&a<0||!u)?i.view.scrollViewportVertically(s,e.verticalSnap):!!(u&&a>=0&&(l&&s<0||!l))&&i.view.scrollViewportHorizontally(a,e.horizontalSnap)},this.scrollToFocusedCell=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:()=>{};if(!this.selection.isSelected())return;this.addHookOnce("afterScroll",e);const{highlight:t}=this.getSelectedRangeLast();this.scrollViewportTo(t.toObject())?this.view.render():(this.removeHook("afterScroll",e),this._registerImmediate((()=>e())))},this.destroy=function(){if(i._clearTimeouts(),i._clearImmediates(),i.view&&i.view.destroy(),l&&l.destroy(),l=null,this.getShortcutManager().destroy(),y.clearCache(),ox.delete(this.guid),zN(i)){const e=this.rootDocument.querySelector(".hot-display-license-info");e&&e.parentNode.removeChild(e)}cw(i.rootElement),s.destroy(),h&&h.destroy(),i.batchExecution((()=>{i.rowIndexMapper.unregisterAll(),i.columnIndexMapper.unregisterAll(),v.getItems().forEach((e=>{let[,t]=e;t.destroy()})),v.clear(),i.runHooks("afterDestroy")}),!0),bv.getSingleton().destroy(i),TE(i,((e,t,r)=>{var n;Hw(e)?r[t]=(n=t,()=>{throw new Error(`The "${n}" method cannot be called because this Handsontable instance has been destroyed`)}):"guid"!==t&&(r[t]=null)})),i.isDestroyed=!0,a&&a.destroy(),a=null,u=null,R=null,h=null,i=null},this.getActiveEditor=function(){return h.getActiveEditor()},this.getFirstRenderedVisibleRow=function(){return i.view.getFirstRenderedVisibleRow()},this.getLastRenderedVisibleRow=function(){return i.view.getLastRenderedVisibleRow()},this.getFirstRenderedVisibleColumn=function(){return i.view.getFirstRenderedVisibleColumn()},this.getLastRenderedVisibleColumn=function(){return i.view.getLastRenderedVisibleColumn()},this.getFirstFullyVisibleRow=function(){return i.view.getFirstFullyVisibleRow()},this.getLastFullyVisibleRow=function(){return i.view.getLastFullyVisibleRow()},this.getFirstFullyVisibleColumn=function(){return i.view.getFirstFullyVisibleColumn()},this.getLastFullyVisibleColumn=function(){return i.view.getLastFullyVisibleColumn()},this.getFirstPartiallyVisibleRow=function(){return i.view.getFirstPartiallyVisibleRow()},this.getLastPartiallyVisibleRow=function(){return i.view.getLastPartiallyVisibleRow()},this.getFirstPartiallyVisibleColumn=function(){return i.view.getFirstPartiallyVisibleColumn()},this.getLastPartiallyVisibleColumn=function(){return i.view.getLastPartiallyVisibleColumn()},this.getPlugin=function(e){return v.getItem(ky(e))},this.getPluginName=function(e){return e===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:v.getId(e)},this.getInstance=function(){return i},this.addHook=function(e,t,r){bv.getSingleton().add(e,t,i,r)},this.hasHook=function(e){return bv.getSingleton().has(e,i)||bv.getSingleton().has(e)},this.addHookOnce=function(e,t,r){bv.getSingleton().once(e,t,i,r)},this.removeHook=function(e,t){bv.getSingleton().remove(e,t,i)},this.runHooks=function(e,t,r,n,o,s,a){return bv.getSingleton().run(i,e,t,r,n,o,s,a)},this.getTranslatedPhrase=function(e,t){return YO(w.language,e,t)},this.toHTML=()=>qR(this),this.toTableElement=()=>{const e=this.rootDocument.createElement("div");return e.insertAdjacentHTML("afterbegin",qR(this)),e.firstElementChild},this.timeouts=[],this.useTheme=e=>{this.view.getStylesHandler().useTheme(e),this.runHooks("afterSetTheme",e,!!p)},this.getCurrentThemeName=()=>this.view.getStylesHandler().getThemeName(),this._registerTimeout=function(e){let t=e;"function"==typeof t&&(t=setTimeout(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0)),this.timeouts.push(t)},this._clearTimeouts=function(){vy(this.timeouts,(e=>{clearTimeout(e)}))},this.immediates=[],this._registerImmediate=function(e){this.immediates.push(setImmediate(e))},this._clearImmediates=function(){vy(this.immediates,(e=>{clearImmediate(e)}))},this._getEditorManager=function(){return h};const x=tx({handleEvent:()=>i.isListening(),beforeKeyDown:e=>this.runHooks("beforeKeyDown",e),afterKeyDown:e=>{this.isDestroyed||i.runHooks("afterDocumentKeyDown",e)},ownerWindow:this.rootWindow});var L;this.addHook("beforeOnCellMouseDown",(e=>{!1===e.ctrlKey&&!1===e.metaKey&&x.releasePressedKeys()})),this.getShortcutManager=function(){return x},this.getFocusManager=function(){return c},[...uS.getItems(),...hS.getItems()].forEach((e=>{const t=function(e){const t=ky(e);return cS.getItem(t)}(e);v.addItem(e,new t(this))})),L=i,[k_,U_].forEach((e=>e(L))),x.setActiveContextName("grid"),bv.getSingleton().run(i,"construct")}function sx(e,t,r){e.addEventListener(t,r,!1)}function ax(e,t,r){e.removeEventListener(t,r,!1)}function lx(e){return e.ownerDocument.defaultView.getComputedStyle(e)}function ux(e){const t={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300,textContent:e=>e.value,...arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}},r=e.body,n=e.createTextNode(""),o=e.createElement("span");let i;function s(){var e,s;n.textContent=t.textContent(i),o.style.position="absolute",o.style.fontSize=lx(i).fontSize,o.style.fontFamily=lx(i).fontFamily,o.style.whiteSpace="pre",r.appendChild(o);const a=parseInt((null===(e=lx(i))||void 0===e?void 0:e.paddingInlineStart)||0,10),l=parseInt((null===(s=lx(i))||void 0===s?void 0:s.paddingInlineEnd)||0,10),u=o.clientWidth+a+l+1;r.removeChild(o);const h=i.style;h.height=`${t.minHeight}px`,t.minWidth>u?h.width=`${t.minWidth}px`:u>t.maxWidth?h.width=`${t.maxWidth}px`:h.width=`${u}px`;const c=i.scrollHeight?i.scrollHeight-1:0;t.minHeight>c?h.height=`${t.minHeight}px`:t.maxHeight<c?(h.height=`${t.maxHeight}px`,h.overflowY="visible"):h.height=`${c}px`}function a(){e.defaultView.setTimeout(s,0)}return{init:function(e,r){let l=arguments.length>2&&void 0!==arguments[2]&&arguments[2];i=e,function(e){if(e&&e.minHeight)if("inherit"===e.minHeight)t.minHeight=i.clientHeight;else{const r=parseInt(e.minHeight,10);isNaN(r)||(t.minHeight=r)}if(e&&e.maxHeight)if("inherit"===e.maxHeight)t.maxHeight=i.clientHeight;else{const r=parseInt(e.maxHeight,10);isNaN(r)||(t.maxHeight=r)}if(e&&e.minWidth)if("inherit"===e.minWidth)t.minWidth=i.clientWidth;else{const r=parseInt(e.minWidth,10);isNaN(r)||(t.minWidth=r)}if(e&&e.maxWidth)if("inherit"===e.maxWidth)t.maxWidth=i.clientWidth;else{const r=parseInt(e.maxWidth,10);isNaN(r)||(t.maxWidth=r)}o.firstChild||(o.className="autoResize",o.style.display="inline-block",o.appendChild(n))}(r),"TEXTAREA"===i.nodeName&&(i.style.resize="none",i.style.height=`${t.minHeight}px`,i.style.minWidth=`${t.minWidth}px`,i.style.maxWidth=`${t.maxWidth}px`,i.style.overflowY="hidden"),l&&(sx(i,"input",s),sx(i,"keydown",a)),s()},resize:s,unObserve(){ax(i,"input",s),ax(i,"keydown",a)}}}function hx(e,t){const r=(n=t).selectionStart?n.selectionStart:0;var n;const o=t.value.split("\n");let i=r,s=0;for(let a=0;a<o.length;a++){const t=o[a];0!==a&&(s+=o[a-1].length+1);const n=s+t.length;if("home"===e?i=s:"end"===e&&(i=n),r<=n)break}Ow(t,i)}function cx(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const dx="ht_editor_hidden",px="textEditor";function mx(e,t,r,n,o,i,s){const a=s.ariaTags,l=[],u=[],h=[],c=[];s.className&&sw(t,s.className),s.readOnly?(l.push(s.readOnlyCellClassName),a&&c.push(Ky())):a&&h.push(Ky()[0]),!1===s.valid&&s.invalidCellClassName?(l.push(s.invalidCellClassName),a&&c.push(qy())):(u.push(s.invalidCellClassName),a&&h.push(qy()[0])),!1===s.wordWrap&&s.noWordWrapClassName&&l.push(s.noWordWrapClassName),!i&&s.placeholder&&l.push(s.placeholderCellClassName),aw(t,u),sw(t,l),uw(t,h),lw(t,c)}mx.RENDERER_TYPE="base";function gx(e,t,r,n,o,i,s){mx.apply(this,[e,t,r,n,o,i,s]);let a=i;!a&&s.placeholder&&(a=s.placeholder),a=Cy(a),s.trimWhitespace&&(a=a.trim()),mw(t,a)}gx.RENDERER_TYPE="text";const fx={CELL_TYPE:"text",editor:class extends F_{static get EDITOR_TYPE(){return"text"}constructor(e){super(e),cx(this,"eventManager",new Uv(this)),cx(this,"autoResize",ux(this.hot.rootDocument)),cx(this,"TEXTAREA",void 0),cx(this,"textareaStyle",void 0),cx(this,"TEXTAREA_PARENT",void 0),cx(this,"textareaParentStyle",void 0),cx(this,"layerClass",void 0),this.eventManager=new Uv(this),this.createElements(),this.bindEvents(),this.hot.addHookOnce("afterDestroy",(()=>this.destroy()))}getValue(){return this.TEXTAREA.value}setValue(e){this.TEXTAREA.value=e}open(){this.refreshDimensions(),this.showEditableElement(),this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this.autoResize.unObserve(),function(e,t){const r=e.closest(".handsontable");return!!r&&(r.parentNode===t||r===t)}(this.hot.rootDocument.activeElement,this.hot.rootElement)&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts()}prepare(e,t,r,n,o,i){const s=this.state;if(super.prepare(e,t,r,n,o,i),!i.readOnly){this.refreshDimensions(!0);const{allowInvalid:e}=i;e&&!this.isOpened()&&(this.TEXTAREA.value=""),s===L_.FINISHED||this.isOpened()||this.hideEditableElement()}}beginEditing(e,t){this.state===L_.VIRGIN&&(this.TEXTAREA.value="",super.beginEditing(e,t))}focus(){this.TEXTAREA.select(),Ow(this.TEXTAREA,this.TEXTAREA.value.length)}createElements(){const{rootDocument:e}=this.hot;this.TEXTAREA=e.createElement("TEXTAREA"),lw(this.TEXTAREA,[["data-hot-input",""],Wy(-1)]),sw(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=e.createElement("DIV"),sw(this.TEXTAREA_PARENT,"handsontableInputHolder"),iw(this.TEXTAREA_PARENT,this.layerClass)&&aw(this.TEXTAREA_PARENT,this.layerClass),sw(this.TEXTAREA_PARENT,dx),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}hideEditableElement(){ME.edge.value&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",aw(this.TEXTAREA_PARENT,this.layerClass),sw(this.TEXTAREA_PARENT,dx)}showEditableElement(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="";const e=this.TEXTAREA_PARENT.childNodes;let t=!1;ZR(e.length-1,(r=>{if(iw(e[r],"handsontableEditor"))return t=!0,!1})),iw(this.TEXTAREA_PARENT,dx)&&aw(this.TEXTAREA_PARENT,dx),t?(this.layerClass="ht_editor_visible",sw(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),sw(this.TEXTAREA_PARENT,this.layerClass))}refreshValue(){const e=this.hot.toPhysicalRow(this.row),t=this.hot.getSourceDataAtCell(e,this.col);this.originalValue=t,this.setValue(t),this.refreshDimensions()}refreshDimensions(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.state!==L_.EDITING&&!e)return;if(this.TD=this.getEditedCell(),!this.TD)return void(e||this.close());const{top:t,start:r,width:n,maxWidth:o,height:i,maxHeight:s}=this.getEditedCellRect();this.textareaParentStyle.top=`${t}px`,this.textareaParentStyle[this.hot.isRtl()?"right":"left"]=`${r}px`,this.showEditableElement();const a=this.hot.rootWindow.getComputedStyle(this.TD);this.TEXTAREA.style.fontSize=a.fontSize,this.TEXTAREA.style.fontFamily=a.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor,this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(n,o),minHeight:Math.min(i,s),maxWidth:o,maxHeight:s},!0)}bindEvents(){FE()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",(()=>this.finishEditing(!1))),this.addHook("afterScrollHorizontally",(()=>this.refreshDimensions())),this.addHook("afterScrollVertically",(()=>this.refreshDimensions())),this.addHook("afterColumnResize",(()=>{this.refreshDimensions(),this.state===L_.EDITING&&this.focus()})),this.addHook("afterRowResize",(()=>{this.refreshDimensions(),this.state===L_.EDITING&&this.focus()}))}allowKeyEventPropagation(){}destroy(){this.eventManager.destroy(),this.clearHooks()}registerShortcuts(){const e=this.hot.getShortcutManager().getContext("editor"),t={runOnlyIf:()=>by(this.hot.getSelected()),group:px},r=()=>{this.hot.rootDocument.execCommand("insertText",!1,"\n")};e.addShortcuts([{keys:[["Control","Enter"]],callback:()=>(r(),!1),runOnlyIf:e=>!this.hot.selection.isMultiple()&&!e.altKey},{keys:[["Meta","Enter"]],callback:()=>(r(),!1),runOnlyIf:()=>!this.hot.selection.isMultiple()},{keys:[["Alt","Enter"]],callback:()=>(r(),!1)},{keys:[["Home"]],callback:(e,t)=>{let[r]=t;hx(r,this.TEXTAREA)}},{keys:[["End"]],callback:(e,t)=>{let[r]=t;hx(r,this.TEXTAREA)}}],t)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(px)}},renderer:gx};function yx(e,t){const r=new ix(e,t||{},GN);return r.init(),r}function wx(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ex(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function vx(e){return vx="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},vx(e)}!function(e,t){"string"!=typeof e&&(e=(t=e).CELL_TYPE);const{editor:r,renderer:n,validator:o}=t;r&&Hv(e,r),n&&function(e,t){"string"!=typeof e&&(e=(t=e).RENDERER_TYPE),dS(e,t)}(e,n),o&&function(e,t){"string"!=typeof e&&(e=(t=e).VALIDATOR_TYPE),wS(e,t)}(e,o),QM(e,t)}(fx),yx.editors={BaseEditor:F_},yx.Core=function(e){return new ix(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},GN)},yx.DefaultSettings=s_(),yx.hooks=bv.getSingleton(),yx.CellCoords=uT,yx.CellRange=fT,yx.packageName="handsontable",yx.buildDate="19/03/2025 09:41:52",yx.version="15.2.0",yx.languages={dictionaryKeys:DO,getLanguageDictionary:zO,getLanguagesDictionaries:function(){return GO()},registerLanguageDictionary:jO,getTranslatedPhrase:YO};var Rx=Symbol("unassigned");function Sx(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function Tx(e){var t=yx.hooks.getRegistered(),r={};for(var n in Object.assign(r,yx.DefaultSettings),r)r[n]={default:Rx};for(var o=0;o<t.length;o++)r[t[o]]={default:Rx};return r.settings={default:Rx},"HotTable"===e&&(r.id={type:String,default:"hot-".concat(Math.random().toString(36).substring(5))}),r}function Cx(e){var t={},r=e.settings;if(r!==Rx)for(var n in r)Sx(r,n)&&r[n]!==Rx&&(t[n]=r[n]);for(var o in e)Sx(e,o)&&"settings"!==o&&e[o]!==Rx&&(t[o]=e[o]);return t}function bx(e,t){var r=Cx(e),n=e.settings?e.settings:r,o=e.settings?r:null,i={};for(var s in n)!Sx(n,s)||void 0===n[s]||t&&"data"!==s&&Nx(t[s],n[s])||(i[s]=n[s]);for(var a in o)!Sx(o,a)||"id"===a||"settings"===a||void 0===o[a]||t&&"data"!==a&&Nx(t[a],o[a])||(i[a]=o[a]);return i}function Nx(e,t){var r=function(e){var t,r=(t=new WeakSet,function(e,r){if("object"===vx(r)&&null!==r){if(t.has(r))return;t.add(r)}return r});return JSON.stringify(e,r)};return"function"==typeof e&&"function"==typeof t?e.toString()===t.toString():vx(e)===vx(t)&&r(e)===r(t)}var Ax,Ix,Ox=h({name:"HotTable",props:Tx("HotTable"),provide:function(){return{columnsCache:this.columnsCache}},watch:{$props:{handler:function(e){var t=bx(e,this.hotInstance?this.hotInstance.getSettings():void 0);this.hotInstance&&void 0!==t&&(t.data&&(this.hotInstance.isColumnModificationAllowed()||!this.hotInstance.isColumnModificationAllowed()&&this.hotInstance.countSourceCols()===this.miscCache.currentSourceColumns)&&(this.matchHotMappersSize(),delete t.data),Object.keys(t).length?this.hotInstance.updateSettings(t):this.hotInstance.render(),this.miscCache.currentSourceColumns=this.hotInstance.countSourceCols())},deep:!0,immediate:!0}},data:function(){return{__hotInstance:null,miscCache:{currentSourceColumns:null},columnSettings:null,columnsCache:new Map,get hotInstance(){return!this.__hotInstance||this.__hotInstance&&!this.__hotInstance.isDestroyed?this.__hotInstance:(console.warn("The Handsontable instance bound to this component was destroyed and cannot be used properly."),null)},set hotInstance(e){this.__hotInstance=e}}},methods:{hotInit:function(){var e=bx(this.$props);e.columns=this.columnSettings?this.columnSettings:e.columns,this.hotInstance=$(new yx.Core(this.$el,e)),this.hotInstance.init(),this.miscCache.currentSourceColumns=this.hotInstance.countSourceCols()},matchHotMappersSize:function(){var e=this;if(this.hotInstance){var t,r=this.hotInstance.getSourceData(),n=[],o=[],i=this.hotInstance.rowIndexMapper.getNumberOfIndexes(),s=this.hotInstance.isColumnModificationAllowed(),a=0;if(r&&r.length!==i&&r.length<i)for(var l=r.length;l<i;l++)n.push(l);if(s)if(a=this.hotInstance.columnIndexMapper.getNumberOfIndexes(),r&&r[0]&&(null===(t=r[0])||void 0===t?void 0:t.length)!==a&&r[0].length<a)for(var u=r[0].length;u<a;u++)o.push(u);this.hotInstance.batch((function(){n.length>0?e.hotInstance.rowIndexMapper.removeIndexes(n):e.hotInstance.rowIndexMapper.insertIndexes(i-1,r.length-i),s&&0!==r.length&&(o.length>0?e.hotInstance.columnIndexMapper.removeIndexes(o):e.hotInstance.columnIndexMapper.insertIndexes(a-1,r[0].length-a))}))}},getColumnSettings:function(){var e=Array.from(this.columnsCache.values());return e.length?e:void 0}},mounted:function(){this.columnSettings=this.getColumnSettings(),this.hotInit()},beforeUnmount:function(){this.hotInstance&&this.hotInstance.destroy()},version:"15.2.0"}),Mx=["id"];Ox.render=function(e,t,r,n,o,i){return y(),w("div",{id:e.id},[Y(e.$slots,"default")],8,Mx)},Ox.__file="src/HotTable.vue",h({name:"HotColumn",props:Tx("HotColumn"),inject:["columnsCache"],methods:{createColumnSettings:function(){var e=Cx(this.$props),t=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ex(Object(r),!0).forEach((function(t){wx(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ex(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},e);e.renderer&&(t.renderer=e.renderer),e.editor&&(t.editor=e.editor),this.columnsCache.set(this,t)}},mounted:function(){this.createColumnSettings()},unmounted:function(){this.columnsCache.delete(this)},render:function(){return null}}).__file="src/HotColumn.vue",function(e){e.RELATIVE="RELATIVE",e.ABSOLUTE="ABSOLUTE"}(Ax||(Ax={}));class _x{constructor(e,t,r){this.type=e,this.col=t,this.sheet=r}static absolute(e,t){return new _x(Ax.ABSOLUTE,e,t)}static relative(e,t){return new _x(Ax.RELATIVE,e,t)}static compareByAbsoluteAddress(e){return(t,r)=>t.toSimpleColumnAddress(e).col-r.toSimpleColumnAddress(e).col}isColumnAbsolute(){return this.type===Ax.ABSOLUTE}isColumnRelative(){return this.type===Ax.RELATIVE}isAbsolute(){return this.type===Ax.ABSOLUTE&&void 0!==this.sheet}moved(e,t,r){const n=void 0===this.sheet?void 0:e;return new _x(this.type,this.col+t,n)}shiftedByColumns(e){return new _x(this.type,this.col+e,this.sheet)}toSimpleColumnAddress(e){const t=Tk(this,e);let r=this.col;return this.isColumnRelative()&&(r=e.col+this.col),fk(t,r)}shiftRelativeDimensions(e,t){const r=this.isColumnRelative()?this.col+e:this.col;return new _x(this.type,r,this.sheet)}shiftAbsoluteDimensions(e,t){const r=this.isColumnAbsolute()?this.col+e:this.col;return new _x(this.type,r,this.sheet)}withSheet(e){return new _x(this.type,this.col,e)}isInvalid(e){return this.toSimpleColumnAddress(e).col<0}hash(e){const t=e&&void 0!==this.sheet?`#${this.sheet}`:"";switch(this.type){case Ax.RELATIVE:return`${t}#COLR${this.col}`;case Ax.ABSOLUTE:return`${t}#COLA${this.col}`}}unparse(e){const t=this.toSimpleColumnAddress(e);if(yk(t))return;const r=oL(t.col);return`${this.type===Ax.ABSOLUTE?"$":""}${r}`}exceedsSheetSizeLimits(e){return this.col>=e}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class xx{constructor(e,t,r){this.type=e,this.row=t,this.sheet=r}static absolute(e,t){return new xx(Ax.ABSOLUTE,e,t)}static relative(e,t){return new xx(Ax.RELATIVE,e,t)}static compareByAbsoluteAddress(e){return(t,r)=>t.toSimpleRowAddress(e).row-r.toSimpleRowAddress(e).row}isRowAbsolute(){return this.type===Ax.ABSOLUTE}isRowRelative(){return this.type===Ax.RELATIVE}isAbsolute(){return this.type===Ax.ABSOLUTE&&void 0!==this.sheet}moved(e,t,r){const n=void 0===this.sheet?void 0:e;return new xx(this.type,this.row+r,n)}shiftedByRows(e){return new xx(this.type,this.row+e,this.sheet)}toSimpleRowAddress(e){const t=Tk(this,e);let r=this.row;return this.isRowRelative()&&(r=e.row+this.row),mk(t,r)}shiftRelativeDimensions(e,t){const r=this.isRowRelative()?this.row+t:this.row;return new xx(this.type,r,this.sheet)}shiftAbsoluteDimensions(e,t){const r=this.isRowAbsolute()?this.row+t:this.row;return new xx(this.type,r,this.sheet)}withSheet(e){return new xx(this.type,this.row,e)}isInvalid(e){return this.toSimpleRowAddress(e).row<0}hash(e){const t=e&&void 0!==this.sheet?`#${this.sheet}`:"";switch(this.type){case Ax.RELATIVE:return`${t}#ROWR${this.row}`;case Ax.ABSOLUTE:return`${t}#ROWA${this.row}`}}unparse(e){const t=this.toSimpleRowAddress(e);if(gk(t))return;return`${this.type===Ax.ABSOLUTE?"$":""}${t.row+1}`}exceedsSheetSizeLimits(e){return this.row>=e}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */!function(e){e.CELL_REFERENCE_RELATIVE="CELL_REFERENCE",e.CELL_REFERENCE_ABSOLUTE="CELL_REFERENCE_ABSOLUTE",e.CELL_REFERENCE_ABSOLUTE_COL="CELL_REFERENCE_ABSOLUTE_COL",e.CELL_REFERENCE_ABSOLUTE_ROW="CELL_REFERENCE_ABSOLUTE_ROW"}(Ix||(Ix={}));class Lx{constructor(e,t,r,n){this.col=e,this.row=t,this.type=r,this.sheet=n}static fromColAndRow(e,t,r){return(e.isColumnAbsolute()&&t.isRowAbsolute()?Lx.absolute.bind(this):e.isColumnAbsolute()?Lx.absoluteCol.bind(this):t.isRowAbsolute()?Lx.absoluteRow.bind(this):Lx.relative.bind(this))(e.col,t.row,r)}static relative(e,t,r){return new Lx(e,t,Ix.CELL_REFERENCE_RELATIVE,r)}static absolute(e,t,r){return new Lx(e,t,Ix.CELL_REFERENCE_ABSOLUTE,r)}static absoluteCol(e,t,r){return new Lx(e,t,Ix.CELL_REFERENCE_ABSOLUTE_COL,r)}static absoluteRow(e,t,r){return new Lx(e,t,Ix.CELL_REFERENCE_ABSOLUTE_ROW,r)}toSimpleCellAddress(e){const t=Tk(this,e);return this.type===Ix.CELL_REFERENCE_ABSOLUTE?wk(t,this.col,this.row):this.type===Ix.CELL_REFERENCE_ABSOLUTE_ROW?wk(t,e.col+this.col,this.row):this.type===Ix.CELL_REFERENCE_ABSOLUTE_COL?wk(t,this.col,e.row+this.row):wk(t,e.col+this.col,e.row+this.row)}toColumnAddress(){const e=this.isColumnRelative()?Ax.RELATIVE:Ax.ABSOLUTE;return new _x(e,this.col,this.sheet)}toRowAddress(){const e=this.isRowRelative()?Ax.RELATIVE:Ax.ABSOLUTE;return new xx(e,this.row,this.sheet)}toSimpleColumnAddress(e){const t=Tk(this,e);let r=this.col;return this.isColumnRelative()&&(r+=e.col),fk(t,r)}toSimpleRowAddress(e){const t=Tk(this,e);let r=this.row;return this.isRowRelative()&&(r+=e.row),mk(t,r)}isRowAbsolute(){return this.type===Ix.CELL_REFERENCE_ABSOLUTE||this.type===Ix.CELL_REFERENCE_ABSOLUTE_ROW}isColumnAbsolute(){return this.type===Ix.CELL_REFERENCE_ABSOLUTE||this.type===Ix.CELL_REFERENCE_ABSOLUTE_COL}isColumnRelative(){return this.type===Ix.CELL_REFERENCE_RELATIVE||this.type===Ix.CELL_REFERENCE_ABSOLUTE_ROW}isRowRelative(){return this.type===Ix.CELL_REFERENCE_RELATIVE||this.type===Ix.CELL_REFERENCE_ABSOLUTE_COL}isAbsolute(){return this.type===Ix.CELL_REFERENCE_ABSOLUTE&&void 0!==this.sheet}shiftedByRows(e){return new Lx(this.col,this.row+e,this.type,this.sheet)}shiftedByColumns(e){return new Lx(this.col+e,this.row,this.type,this.sheet)}moved(e,t,r){const n=void 0===this.sheet?void 0:e;return new Lx(this.col+t,this.row+r,this.type,n)}withSheet(e){return new Lx(this.col,this.row,this.type,e)}isInvalid(e){return Ek(this.toSimpleCellAddress(e))}shiftRelativeDimensions(e,t){const r=this.isColumnAbsolute()?this.col:this.col+e,n=this.isRowAbsolute()?this.row:this.row+t;return new Lx(r,n,this.type,this.sheet)}shiftAbsoluteDimensions(e,t){const r=this.isColumnRelative()?this.col:this.col+e,n=this.isRowRelative()?this.row:this.row+t;return new Lx(r,n,this.type,this.sheet)}hash(e){const t=e&&void 0!==this.sheet?`#${this.sheet}`:"";switch(this.type){case Ix.CELL_REFERENCE_RELATIVE:return`${t}#${this.row}R${this.col}`;case Ix.CELL_REFERENCE_ABSOLUTE:return`${t}#${this.row}A${this.col}`;case Ix.CELL_REFERENCE_ABSOLUTE_COL:return`${t}#${this.row}AC${this.col}`;case Ix.CELL_REFERENCE_ABSOLUTE_ROW:return`${t}#${this.row}AR${this.col}`}}unparse(e){const t=this.toSimpleCellAddress(e);if(Ek(t))return;const r=oL(t.col),n=this.type===Ix.CELL_REFERENCE_ABSOLUTE||this.type===Ix.CELL_REFERENCE_ABSOLUTE_ROW?"$":"";return`${this.type===Ix.CELL_REFERENCE_ABSOLUTE||this.type===Ix.CELL_REFERENCE_ABSOLUTE_COL?"$":""}${r}${n}${t.row+1}`}exceedsSheetSizeLimits(e,t){return this.row>=t||this.col>=e}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */const Fx=":",Px="$",Vx="A-Za-zÀ-ʯ",Hx=`${Vx}0-9_.`,Dx=`[${Vx}0-9_]+`,Ux=`(${Dx}|'(((?!').|'')*)')!`,kx=`(${Ux})?\\${Px}?[A-Za-z]+\\${Px}?[0-9]+`,Bx=`(${Ux})?\\${Px}?[A-Za-z]+`,Wx=`(${Ux})?\\${Px}?[0-9]+`,Gx="[rR][0-9]*[cC][0-9]*",jx=`(${kx})[^${Hx}]`,zx=`[${Vx}_][${Hx}]*`,$x=["0","1","2","3","4","5","6","7","8","9"],Yx=[...Array.from(Array(26)).map(((e,t)=>t+"A".charCodeAt(0))),...Array.from(Array(26)).map(((e,t)=>t+"a".charCodeAt(0))),...Array.from(Array(496)).map(((e,t)=>t+192))].map((e=>String.fromCharCode(e))),Xx=new RegExp(`^(${Ux})?(\\${Px}?)([A-Za-z]+)(\\${Px}?)([0-9]+)$`),Kx=new RegExp(`^(${Ux})?(\\${Px}?)([A-Za-z]+)$`),qx=new RegExp(`^(${Ux})?(\\${Px}?)([0-9]+)$`),Qx=new RegExp(`^${Dx}$`),Zx=(e,t,r)=>{const n=Xx.exec(t),o=nL(n[6]);let i=sL(n,e);if(void 0===i)return;null===i&&(i=void 0);const s=Number(n[8])-1;return n[5]===Px&&n[7]===Px?Lx.absolute(o,s,i):n[5]===Px?Lx.absoluteCol(o,s-r.row,i):n[7]===Px?Lx.absoluteRow(o-r.col,s,i):Lx.relative(o-r.col,s-r.row,i)},Jx=(e,t,r)=>{const n=Kx.exec(t);let o=sL(n,e);if(void 0===o)return;null===o&&(o=void 0);const i=nL(n[6]);return n[5]===Px?_x.absolute(i,o):_x.relative(i-r.col,o)},eL=(e,t,r)=>{const n=qx.exec(t);let o=sL(n,e);if(void 0===o)return;null===o&&(o=void 0);const i=Number(n[6])-1;return n[5]===Px?xx.absolute(i,o):xx.relative(i-r.row,o)},tL=(e,t,r)=>{const n=Xx.exec(t);if(!n)return;const o=nL(n[6]);let i=sL(n,e);if(void 0===i)return;null===i&&(i=r);const s=Number(n[8])-1;return wk(i,o,s)},rL=(e,t,r)=>{const n=oL(t.col),o=iL(t.sheet,e);if(void 0!==o)return r!==t.sheet?`${o}!${n}${t.row+1}`:`${n}${t.row+1}`};function nL(e){return 1===e.length?e.toUpperCase().charCodeAt(0)-65:e.split("").reduce(((e,t)=>26*e+(t.toUpperCase().charCodeAt(0)-64)),0)-1}function oL(e){let t="";for(;e>=0;)t=String.fromCharCode(e%26+97)+t,e=Math.floor(e/26)-1;return t.toUpperCase()}function iL(e,t){let r=t(e);if(void 0!==r)return Qx.test(r)?r:(r=r.replace(/'/g,"''"),`'${r}'`)}function sL(e,t){var r;let n=null!==(r=e[3])&&void 0!==r?r:e[2];return n?(n=n.replace(/''/g,"'"),t(n)):null}function aL(e){return e&&0===e.length}function lL(e){return null==e?[]:Object.keys(e)}function uL(e){for(var t=[],r=Object.keys(e),n=0;n<r.length;n++)t.push(e[r[n]]);return t}function hL(e,t){for(var r=[],n=0;n<e.length;n++)r.push(t.call(null,e[n],n));return r}function cL(e){for(var t=[],r=0;r<e.length;r++){var n=e[r];Array.isArray(n)?t=t.concat(cL(n)):t.push(n)}return t}function dL(e){return aL(e)?void 0:e[0]}function pL(e){var t=e&&e.length;return t?e[t-1]:void 0}function mL(e,t){if(Array.isArray(e))for(var r=0;r<e.length;r++)t.call(null,e[r],r);else{if(!LL(e))throw Error("non exhaustive match");var n=lL(e);for(r=0;r<n.length;r++){var o=n[r],i=e[o];t.call(null,i,o)}}}function gL(e){return"string"==typeof e}function fL(e){return void 0===e}function yL(e){return e instanceof Function}function wL(e,t){return void 0===t&&(t=1),e.slice(t,e.length)}function EL(e,t){return void 0===t&&(t=1),e.slice(0,e.length-t)}function vL(e,t){var r=[];if(Array.isArray(e))for(var n=0;n<e.length;n++){var o=e[n];t.call(null,o)&&r.push(o)}return r}function RL(e,t){return vL(e,(function(e){return!t(e)}))}function SL(e,t){for(var r=Object.keys(e),n={},o=0;o<r.length;o++){var i=r[o],s=e[i];t(s)&&(n[i]=s)}return n}function TL(e,t){return!!LL(e)&&e.hasOwnProperty(t)}function CL(e,t){return void 0!==AL(e,(function(e){return e===t}))}function bL(e){for(var t=[],r=0;r<e.length;r++)t.push(e[r]);return t}function NL(e){var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}function AL(e,t){for(var r=0;r<e.length;r++){var n=e[r];if(t.call(null,n))return n}}function IL(e,t,r){for(var n=Array.isArray(e),o=n?e:uL(e),i=n?[]:lL(e),s=r,a=0;a<o.length;a++)s=t.call(null,s,o[a],n?a:i[a]);return s}function OL(e){return RL(e,(function(e){return null==e}))}function ML(e,t){void 0===t&&(t=function(e){return e});var r=[];return IL(e,(function(e,n){var o=t(n);return CL(r,o)?e:(r.push(o),e.concat(n))}),[])}function _L(e){return Array.isArray(e)}function xL(e){return e instanceof RegExp}function LL(e){return e instanceof Object}function FL(e,t){for(var r=0;r<e.length;r++)if(!t(e[r],r))return!1;return!0}function PL(e,t){return RL(e,(function(e){return CL(t,e)}))}function VL(e,t){for(var r=0;r<e.length;r++)if(t(e[r]))return!0;return!1}function HL(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];for(var n=0;n<t.length;n++)for(var o=t[n],i=lL(o),s=0;s<i.length;s++){var a=i[s];e[a]=o[a]}return e}function DL(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];for(var n=0;n<t.length;n++){var o=t[n];if(!fL(o))for(var i=lL(o),s=0;s<i.length;s++){var a=i[s];TL(e,a)||(e[a]=o[a])}}return e}function UL(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return DL.apply(null,[{}].concat(e))}function kL(e,t){var r={};return mL(e,(function(e){var n=t(e),o=r[n];o?o.push(e):r[n]=[e]})),r}function BL(e,t){for(var r=NL(e),n=lL(t),o=0;o<n.length;o++){var i=n[o],s=t[i];r[i]=s}return r}function WL(){}function GL(e){return e}function jL(e){console&&console.error&&console.error("Error: "+e)}function zL(e){console&&console.warn&&console.warn("Warning: "+e)}function $L(){return"function"==typeof Map}function YL(e){function t(){}t.prototype=e;var r=new t;function n(){return typeof r.bar}return n(),n(),e}function XL(e){return e[e.length-1]}function KL(e){var t=(new Date).getTime(),r=e();return{time:(new Date).getTime()-t,value:r}}var qL,QL,ZL,JL={exports:{}};qL=JL,QL="undefined"!=typeof self?self:z,ZL=function(){function e(){}e.prototype.saveState=function(){return{idx:this.idx,input:this.input,groupIdx:this.groupIdx}},e.prototype.restoreState=function(e){this.idx=e.idx,this.input=e.input,this.groupIdx=e.groupIdx},e.prototype.pattern=function(e){this.idx=0,this.input=e,this.groupIdx=0,this.consumeChar("/");var t=this.disjunction();this.consumeChar("/");for(var r={type:"Flags",global:!1,ignoreCase:!1,multiLine:!1,unicode:!1,sticky:!1};this.isRegExpFlag();)switch(this.popChar()){case"g":a(r,"global");break;case"i":a(r,"ignoreCase");break;case"m":a(r,"multiLine");break;case"u":a(r,"unicode");break;case"y":a(r,"sticky")}if(this.idx!==this.input.length)throw Error("Redundant input: "+this.input.substring(this.idx));return{type:"Pattern",flags:r,value:t}},e.prototype.disjunction=function(){var e=[];for(e.push(this.alternative());"|"===this.peekChar();)this.consumeChar("|"),e.push(this.alternative());return{type:"Disjunction",value:e}},e.prototype.alternative=function(){for(var e=[];this.isTerm();)e.push(this.term());return{type:"Alternative",value:e}},e.prototype.term=function(){return this.isAssertion()?this.assertion():this.atom()},e.prototype.assertion=function(){switch(this.popChar()){case"^":return{type:"StartAnchor"};case"$":return{type:"EndAnchor"};case"\\":switch(this.popChar()){case"b":return{type:"WordBoundary"};case"B":return{type:"NonWordBoundary"}}throw Error("Invalid Assertion Escape");case"(":var e;switch(this.consumeChar("?"),this.popChar()){case"=":e="Lookahead";break;case"!":e="NegativeLookahead"}l(e);var t=this.disjunction();return this.consumeChar(")"),{type:e,value:t}}!function(){throw Error("Internal Error - Should never get here!")}()},e.prototype.quantifier=function(e){var t;switch(this.popChar()){case"*":t={atLeast:0,atMost:1/0};break;case"+":t={atLeast:1,atMost:1/0};break;case"?":t={atLeast:0,atMost:1};break;case"{":var r=this.integerIncludingZero();switch(this.popChar()){case"}":t={atLeast:r,atMost:r};break;case",":t=this.isDigit()?{atLeast:r,atMost:this.integerIncludingZero()}:{atLeast:r,atMost:1/0},this.consumeChar("}")}if(!0===e&&void 0===t)return;l(t)}if(!0!==e||void 0!==t)return l(t),"?"===this.peekChar(0)?(this.consumeChar("?"),t.greedy=!1):t.greedy=!0,t.type="Quantifier",t},e.prototype.atom=function(){var e;switch(this.peekChar()){case".":e=this.dotAll();break;case"\\":e=this.atomEscape();break;case"[":e=this.characterClass();break;case"(":e=this.group()}return void 0===e&&this.isPatternCharacter()&&(e=this.patternCharacter()),l(e),this.isQuantifier()&&(e.quantifier=this.quantifier()),e},e.prototype.dotAll=function(){return this.consumeChar("."),{type:"Set",complement:!0,value:[i("\n"),i("\r"),i("\u2028"),i("\u2029")]}},e.prototype.atomEscape=function(){switch(this.consumeChar("\\"),this.peekChar()){case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":return this.decimalEscapeAtom();case"d":case"D":case"s":case"S":case"w":case"W":return this.characterClassEscape();case"f":case"n":case"r":case"t":case"v":return this.controlEscapeAtom();case"c":return this.controlLetterEscapeAtom();case"0":return this.nulCharacterAtom();case"x":return this.hexEscapeSequenceAtom();case"u":return this.regExpUnicodeEscapeSequenceAtom();default:return this.identityEscapeAtom()}},e.prototype.decimalEscapeAtom=function(){return{type:"GroupBackReference",value:this.positiveInteger()}},e.prototype.characterClassEscape=function(){var e,t=!1;switch(this.popChar()){case"d":e=u;break;case"D":e=u,t=!0;break;case"s":e=c;break;case"S":e=c,t=!0;break;case"w":e=h;break;case"W":e=h,t=!0}return l(e),{type:"Set",value:e,complement:t}},e.prototype.controlEscapeAtom=function(){var e;switch(this.popChar()){case"f":e=i("\f");break;case"n":e=i("\n");break;case"r":e=i("\r");break;case"t":e=i("\t");break;case"v":e=i("\v")}return l(e),{type:"Character",value:e}},e.prototype.controlLetterEscapeAtom=function(){this.consumeChar("c");var e=this.popChar();if(!1===/[a-zA-Z]/.test(e))throw Error("Invalid ");return{type:"Character",value:e.toUpperCase().charCodeAt(0)-64}},e.prototype.nulCharacterAtom=function(){return this.consumeChar("0"),{type:"Character",value:i("\0")}},e.prototype.hexEscapeSequenceAtom=function(){return this.consumeChar("x"),this.parseHexDigits(2)},e.prototype.regExpUnicodeEscapeSequenceAtom=function(){return this.consumeChar("u"),this.parseHexDigits(4)},e.prototype.identityEscapeAtom=function(){return{type:"Character",value:i(this.popChar())}},e.prototype.classPatternCharacterAtom=function(){switch(this.peekChar()){case"\n":case"\r":case"\u2028":case"\u2029":case"\\":case"]":throw Error("TBD");default:return{type:"Character",value:i(this.popChar())}}},e.prototype.characterClass=function(){var e=[],t=!1;for(this.consumeChar("["),"^"===this.peekChar(0)&&(this.consumeChar("^"),t=!0);this.isClassAtom();){var r=this.classAtom();if("Character"===r.type&&this.isRangeDash()){this.consumeChar("-");var n=this.classAtom();if("Character"===n.type){if(n.value<r.value)throw Error("Range out of order in character class");e.push({from:r.value,to:n.value})}else s(r.value,e),e.push(i("-")),s(n.value,e)}else s(r.value,e)}return this.consumeChar("]"),{type:"Set",complement:t,value:e}},e.prototype.classAtom=function(){switch(this.peekChar()){case"]":case"\n":case"\r":case"\u2028":case"\u2029":throw Error("TBD");case"\\":return this.classEscape();default:return this.classPatternCharacterAtom()}},e.prototype.classEscape=function(){switch(this.consumeChar("\\"),this.peekChar()){case"b":return this.consumeChar("b"),{type:"Character",value:i("\b")};case"d":case"D":case"s":case"S":case"w":case"W":return this.characterClassEscape();case"f":case"n":case"r":case"t":case"v":return this.controlEscapeAtom();case"c":return this.controlLetterEscapeAtom();case"0":return this.nulCharacterAtom();case"x":return this.hexEscapeSequenceAtom();case"u":return this.regExpUnicodeEscapeSequenceAtom();default:return this.identityEscapeAtom()}},e.prototype.group=function(){var e=!0;this.consumeChar("("),"?"===this.peekChar(0)?(this.consumeChar("?"),this.consumeChar(":"),e=!1):this.groupIdx++;var t=this.disjunction();this.consumeChar(")");var r={type:"Group",capturing:e,value:t};return e&&(r.idx=this.groupIdx),r},e.prototype.positiveInteger=function(){var e=this.popChar();if(!1===o.test(e))throw Error("Expecting a positive integer");for(;n.test(this.peekChar(0));)e+=this.popChar();return parseInt(e,10)},e.prototype.integerIncludingZero=function(){var e=this.popChar();if(!1===n.test(e))throw Error("Expecting an integer");for(;n.test(this.peekChar(0));)e+=this.popChar();return parseInt(e,10)},e.prototype.patternCharacter=function(){var e=this.popChar();switch(e){case"\n":case"\r":case"\u2028":case"\u2029":case"^":case"$":case"\\":case".":case"*":case"+":case"?":case"(":case")":case"[":case"|":throw Error("TBD");default:return{type:"Character",value:i(e)}}},e.prototype.isRegExpFlag=function(){switch(this.peekChar(0)){case"g":case"i":case"m":case"u":case"y":return!0;default:return!1}},e.prototype.isRangeDash=function(){return"-"===this.peekChar()&&this.isClassAtom(1)},e.prototype.isDigit=function(){return n.test(this.peekChar(0))},e.prototype.isClassAtom=function(e){switch(void 0===e&&(e=0),this.peekChar(e)){case"]":case"\n":case"\r":case"\u2028":case"\u2029":return!1;default:return!0}},e.prototype.isTerm=function(){return this.isAtom()||this.isAssertion()},e.prototype.isAtom=function(){if(this.isPatternCharacter())return!0;switch(this.peekChar(0)){case".":case"\\":case"[":case"(":return!0;default:return!1}},e.prototype.isAssertion=function(){switch(this.peekChar(0)){case"^":case"$":return!0;case"\\":switch(this.peekChar(1)){case"b":case"B":return!0;default:return!1}case"(":return"?"===this.peekChar(1)&&("="===this.peekChar(2)||"!"===this.peekChar(2));default:return!1}},e.prototype.isQuantifier=function(){var e=this.saveState();try{return void 0!==this.quantifier(!0)}catch(t){return!1}finally{this.restoreState(e)}},e.prototype.isPatternCharacter=function(){switch(this.peekChar()){case"^":case"$":case"\\":case".":case"*":case"+":case"?":case"(":case")":case"[":case"|":case"/":case"\n":case"\r":case"\u2028":case"\u2029":return!1;default:return!0}},e.prototype.parseHexDigits=function(e){for(var t="",n=0;n<e;n++){var o=this.popChar();if(!1===r.test(o))throw Error("Expecting a HexDecimal digits");t+=o}return{type:"Character",value:parseInt(t,16)}},e.prototype.peekChar=function(e){return void 0===e&&(e=0),this.input[this.idx+e]},e.prototype.popChar=function(){var e=this.peekChar(0);return this.consumeChar(),e},e.prototype.consumeChar=function(e){if(void 0!==e&&this.input[this.idx]!==e)throw Error("Expected: '"+e+"' but found: '"+this.input[this.idx]+"' at offset: "+this.idx);if(this.idx>=this.input.length)throw Error("Unexpected end of input");this.idx++};var t,r=/[0-9a-fA-F]/,n=/[0-9]/,o=/[1-9]/;function i(e){return e.charCodeAt(0)}function s(e,t){void 0!==e.length?e.forEach((function(e){t.push(e)})):t.push(e)}function a(e,t){if(!0===e[t])throw"duplicate flag "+t;e[t]=!0}function l(e){if(void 0===e)throw Error("Internal Error - Should never get here!")}var u=[];for(t=i("0");t<=i("9");t++)u.push(t);var h=[i("_")].concat(u);for(t=i("a");t<=i("z");t++)h.push(t);for(t=i("A");t<=i("Z");t++)h.push(t);var c=[i(" "),i("\f"),i("\n"),i("\r"),i("\t"),i("\v"),i("\t"),i(" "),i(" "),i(" "),i(" "),i(" "),i(" "),i(" "),i(" "),i(" "),i(" "),i(" "),i(" "),i(" "),i("\u2028"),i("\u2029"),i(" "),i(" "),i("　"),i("\ufeff")];function d(){}return d.prototype.visitChildren=function(e){for(var t in e){var r=e[t];e.hasOwnProperty(t)&&(void 0!==r.type?this.visit(r):Array.isArray(r)&&r.forEach((function(e){this.visit(e)}),this))}},d.prototype.visit=function(e){switch(e.type){case"Pattern":this.visitPattern(e);break;case"Flags":this.visitFlags(e);break;case"Disjunction":this.visitDisjunction(e);break;case"Alternative":this.visitAlternative(e);break;case"StartAnchor":this.visitStartAnchor(e);break;case"EndAnchor":this.visitEndAnchor(e);break;case"WordBoundary":this.visitWordBoundary(e);break;case"NonWordBoundary":this.visitNonWordBoundary(e);break;case"Lookahead":this.visitLookahead(e);break;case"NegativeLookahead":this.visitNegativeLookahead(e);break;case"Character":this.visitCharacter(e);break;case"Set":this.visitSet(e);break;case"Group":this.visitGroup(e);break;case"GroupBackReference":this.visitGroupBackReference(e);break;case"Quantifier":this.visitQuantifier(e)}this.visitChildren(e)},d.prototype.visitPattern=function(e){},d.prototype.visitFlags=function(e){},d.prototype.visitDisjunction=function(e){},d.prototype.visitAlternative=function(e){},d.prototype.visitStartAnchor=function(e){},d.prototype.visitEndAnchor=function(e){},d.prototype.visitWordBoundary=function(e){},d.prototype.visitNonWordBoundary=function(e){},d.prototype.visitLookahead=function(e){},d.prototype.visitNegativeLookahead=function(e){},d.prototype.visitCharacter=function(e){},d.prototype.visitSet=function(e){},d.prototype.visitGroup=function(e){},d.prototype.visitGroupBackReference=function(e){},d.prototype.visitQuantifier=function(e){},{RegExpParser:e,BaseRegExpVisitor:d,VERSION:"0.4.0"}},qL.exports?qL.exports=ZL():QL.regexpToAst=ZL();var eF=JL.exports,tF={},rF=new eF.RegExpParser;function nF(e){var t=e.toString();if(tF.hasOwnProperty(t))return tF[t];var r=rF.pattern(t);return tF[t]=r,r}var oF,iF=(oF=function(e,t){return oF=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},oF(e,t)},function(e,t){function r(){this.constructor=e}oF(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),sF="Complement Sets are not supported for first char optimization",aF='Unable to use "first char" lexer optimizations:\n';function lF(e,t){void 0===t&&(t=!1);try{var r=nF(e);return uF(r.value,{},r.flags.ignoreCase)}catch(o){if(o.message===sF)t&&zL(aF+"\tUnable to optimize: < "+e.toString()+" >\n\tComplement Sets cannot be automatically optimized.\n\tThis will disable the lexer's first char optimizations.\n\tSee: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#COMPLEMENT for details.");else{var n="";t&&(n="\n\tThis will disable the lexer's first char optimizations.\n\tSee: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#REGEXP_PARSING for details."),jL(aF+"\n\tFailed parsing: < "+e.toString()+" >\n\tUsing the regexp-to-ast library version: "+eF.VERSION+"\n\tPlease open an issue at: https://github.com/bd82/regexp-to-ast/issues"+n)}}return[]}function uF(e,t,r){switch(e.type){case"Disjunction":for(var n=0;n<e.value.length;n++)uF(e.value[n],t,r);break;case"Alternative":var o=e.value;for(n=0;n<o.length;n++){var i=o[n];switch(i.type){case"EndAnchor":case"GroupBackReference":case"Lookahead":case"NegativeLookahead":case"StartAnchor":case"WordBoundary":case"NonWordBoundary":continue}var s=i;switch(s.type){case"Character":hF(s.value,t,r);break;case"Set":if(!0===s.complement)throw Error(sF);mL(s.value,(function(e){if("number"==typeof e)hF(e,t,r);else{var n=e;if(!0===r)for(var o=n.from;o<=n.to;o++)hF(o,t,r);else{for(o=n.from;o<=n.to&&o<LF;o++)hF(o,t,r);if(n.to>=LF)for(var i=n.from>=LF?n.from:LF,s=n.to,a=FF(i),l=FF(s),u=a;u<=l;u++)t[u]=u}}}));break;case"Group":uF(s.value,t,r);break;default:throw Error("Non Exhaustive Match")}var a=void 0!==s.quantifier&&0===s.quantifier.atLeast;if("Group"===s.type&&!1===dF(s)||"Group"!==s.type&&!1===a)break}break;default:throw Error("non exhaustive match!")}return uL(t)}function hF(e,t,r){var n=FF(e);t[n]=n,!0===r&&function(e,t){var r=String.fromCharCode(e),n=r.toUpperCase();if(n!==r){t[o=FF(n.charCodeAt(0))]=o}else{var o,i=r.toLowerCase();if(i!==r)t[o=FF(i.charCodeAt(0))]=o}}(e,t)}function cF(e,t){return AL(e.value,(function(e){if("number"==typeof e)return CL(t,e);var r=e;return void 0!==AL(t,(function(e){return r.from<=e&&e<=r.to}))}))}function dF(e){return!(!e.quantifier||0!==e.quantifier.atLeast)||!!e.value&&(_L(e.value)?FL(e.value,dF):dF(e.value))}var pF=function(e){function t(t){var r=e.call(this)||this;return r.targetCharCodes=t,r.found=!1,r}return iF(t,e),t.prototype.visitChildren=function(t){if(!0!==this.found){switch(t.type){case"Lookahead":return void this.visitLookahead(t);case"NegativeLookahead":return void this.visitNegativeLookahead(t)}e.prototype.visitChildren.call(this,t)}},t.prototype.visitCharacter=function(e){CL(this.targetCharCodes,e.value)&&(this.found=!0)},t.prototype.visitSet=function(e){e.complement?void 0===cF(e,this.targetCharCodes)&&(this.found=!0):void 0!==cF(e,this.targetCharCodes)&&(this.found=!0)},t}(eF.BaseRegExpVisitor);function mF(e,t){if(t instanceof RegExp){var r=nF(t),n=new pF(e);return n.visit(r),n.found}return void 0!==AL(t,(function(t){return CL(e,t.charCodeAt(0))}))}var gF=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},e(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),fF="PATTERN",yF="defaultMode",wF="modes",EF="boolean"==typeof new RegExp("(?:)").sticky;function vF(e,t){var r,n=(t=UL(t,{useSticky:EF,debug:!1,safeMode:!1,positionTracking:"full",lineTerminatorCharacters:["\r","\n"],tracer:function(e,t){return t()}})).tracer;n("initCharCodeToOptimizedIndexMap",(function(){!function(){if(aL(PF)){PF=new Array(65536);for(var e=0;e<65536;e++)PF[e]=e>255?255+~~(e/255):e}}()})),n("Reject Lexer.NA",(function(){r=RL(e,(function(e){return e[fF]===YF.NA}))}));var o,i,s,a,l,u,h,c,d,p,m,g=!1;n("Transform Patterns",(function(){g=!1,o=hL(r,(function(e){var r=e[fF];if(xL(r)){var n=r.source;return 1===n.length&&"^"!==n&&"$"!==n&&"."!==n?n:2!==n.length||"\\"!==n[0]||CL(["d","D","s","S","t","r","n","t","0","c","b","B","f","v","w","W"],n[1])?t.useSticky?bF(r):CF(r):n[1]}if(yL(r))return g=!0,{exec:r};if(TL(r,"exec"))return g=!0,r;if("string"==typeof r){if(1===r.length)return r;var o=r.replace(/[\\^$.*+?()[\]{}|]/g,"\\$&"),i=new RegExp(o);return t.useSticky?bF(i):CF(i)}throw Error("non exhaustive match")}))})),n("misc mapping",(function(){i=hL(r,(function(e){return e.tokenTypeIdx})),s=hL(r,(function(e){var t=e.GROUP;if(t!==YF.SKIPPED){if(gL(t))return t;if(fL(t))return!1;throw Error("non exhaustive match")}})),a=hL(r,(function(e){var t=e.LONGER_ALT;if(t)return function(e,t){for(var r=0;r<e.length;r++)if(e[r]===t)return r;return-1}(r,t)})),l=hL(r,(function(e){return e.PUSH_MODE})),u=hL(r,(function(e){return TL(e,"POP_MODE")}))})),n("Line Terminator Handling",(function(){var e=_F(t.lineTerminatorCharacters);h=hL(r,(function(e){return!1})),"onlyOffset"!==t.positionTracking&&(h=hL(r,(function(t){return TL(t,"LINE_BREAKS")?t.LINE_BREAKS:!1===MF(t,e)?mF(e,t.PATTERN):void 0})))})),n("Misc Mapping #2",(function(){c=hL(r,AF),d=hL(o,IF),p=IL(r,(function(e,t){var r=t.GROUP;return gL(r)&&r!==YF.SKIPPED&&(e[r]=[]),e}),{}),m=hL(o,(function(e,t){return{pattern:o[t],longerAlt:a[t],canLineTerminator:h[t],isCustom:c[t],short:d[t],group:s[t],push:l[t],pop:u[t],tokenTypeIdx:i[t],tokenType:r[t]}}))}));var f=!0,y=[];return t.safeMode||n("First Char Optimization",(function(){y=IL(r,(function(e,r,n){if("string"==typeof r.PATTERN){var o=FF(r.PATTERN.charCodeAt(0));xF(e,o,m[n])}else if(_L(r.START_CHARS_HINT)){var i;mL(r.START_CHARS_HINT,(function(t){var r=FF("string"==typeof t?t.charCodeAt(0):t);i!==r&&(i=r,xF(e,r,m[n]))}))}else if(xL(r.PATTERN))if(r.PATTERN.unicode)f=!1,t.ensureOptimizations&&jL(aF+"\tUnable to analyze < "+r.PATTERN.toString()+" > pattern.\n\tThe regexp unicode flag is not currently supported by the regexp-to-ast library.\n\tThis will disable the lexer's first char optimizations.\n\tFor details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#UNICODE_OPTIMIZE");else{var s=lF(r.PATTERN,t.ensureOptimizations);aL(s)&&(f=!1),mL(s,(function(t){xF(e,t,m[n])}))}else t.ensureOptimizations&&jL(aF+"\tTokenType: <"+r.name+"> is using a custom token pattern without providing <start_chars_hint> parameter.\n\tThis will disable the lexer's first char optimizations.\n\tFor details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#CUSTOM_OPTIMIZE"),f=!1;return e}),[])})),n("ArrayPacking",(function(){y=function(e){for(var t=[],r=0;r<e.length;r++){var n=e[r];t.push(void 0!==n?n:void 0)}return t}(y)})),{emptyGroups:p,patternIdxToConfig:m,charCodeToPatternIdxToConfig:y,hasCustom:g,canBeOptimized:f}}function RF(e,t){var r=[],n=function(e){var t=vL(e,(function(e){return!TL(e,fF)})),r=hL(t,(function(e){return{message:"Token Type: ->"+e.name+"<- missing static 'PATTERN' property",type:zF.MISSING_PATTERN,tokenTypes:[e]}})),n=PL(e,t);return{errors:r,valid:n}}(e);r=r.concat(n.errors);var o=function(e){var t=vL(e,(function(e){var t=e[fF];return!(xL(t)||yL(t)||TL(t,"exec")||gL(t))})),r=hL(t,(function(e){return{message:"Token Type: ->"+e.name+"<- static 'PATTERN' can only be a RegExp, a Function matching the {CustomPatternMatcherFunc} type or an Object matching the {ICustomPattern} interface.",type:zF.INVALID_PATTERN,tokenTypes:[e]}})),n=PL(e,t);return{errors:r,valid:n}}(n.valid),i=o.valid;return r=(r=r.concat(o.errors)).concat(function(e){var t=[],r=vL(e,(function(e){return xL(e[fF])}));return t=t.concat(function(e){var t=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.found=!1,t}return gF(t,e),t.prototype.visitEndAnchor=function(e){this.found=!0},t}(eF.BaseRegExpVisitor),r=vL(e,(function(e){var r=e[fF];try{var n=nF(r),o=new t;return o.visit(n),o.found}catch(i){return SF.test(r.source)}})),n=hL(r,(function(e){return{message:"Unexpected RegExp Anchor Error:\n\tToken Type: ->"+e.name+"<- static 'PATTERN' cannot contain end of input anchor '$'\n\tSee sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#ANCHORS\tfor details.",type:zF.EOI_ANCHOR_FOUND,tokenTypes:[e]}}));return n}(r)),t=t.concat(function(e){var t=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.found=!1,t}return gF(t,e),t.prototype.visitStartAnchor=function(e){this.found=!0},t}(eF.BaseRegExpVisitor),r=vL(e,(function(e){var r=e[fF];try{var n=nF(r),o=new t;return o.visit(n),o.found}catch(i){return TF.test(r.source)}})),n=hL(r,(function(e){return{message:"Unexpected RegExp Anchor Error:\n\tToken Type: ->"+e.name+"<- static 'PATTERN' cannot contain start of input anchor '^'\n\tSee https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#ANCHORS\tfor details.",type:zF.SOI_ANCHOR_FOUND,tokenTypes:[e]}}));return n}(r)),t=t.concat(function(e){var t=vL(e,(function(e){var t=e[fF];return t instanceof RegExp&&(t.multiline||t.global)})),r=hL(t,(function(e){return{message:"Token Type: ->"+e.name+"<- static 'PATTERN' may NOT contain global('g') or multiline('m')",type:zF.UNSUPPORTED_FLAGS_FOUND,tokenTypes:[e]}}));return r}(r)),t=t.concat(function(e){var t=[],r=hL(e,(function(r){return IL(e,(function(e,n){return r.PATTERN.source!==n.PATTERN.source||CL(t,n)||n.PATTERN===YF.NA||(t.push(n),e.push(n)),e}),[])})),n=hL(vL(r=OL(r),(function(e){return e.length>1})),(function(e){var t=hL(e,(function(e){return e.name}));return{message:"The same RegExp pattern ->"+dL(e).PATTERN+"<-has been used in all of the following Token Types: "+t.join(", ")+" <-",type:zF.DUPLICATE_PATTERNS_FOUND,tokenTypes:e}}));return n}(r)),t=t.concat(function(e){var t=vL(e,(function(e){return e[fF].test("")})),r=hL(t,(function(e){return{message:"Token Type: ->"+e.name+"<- static 'PATTERN' must not match an empty string",type:zF.EMPTY_MATCH_PATTERN,tokenTypes:[e]}}));return r}(r)),t}(i)),r=r.concat(function(e){var t=vL(e,(function(e){if(!TL(e,"GROUP"))return!1;var t=e.GROUP;return t!==YF.SKIPPED&&t!==YF.NA&&!gL(t)})),r=hL(t,(function(e){return{message:"Token Type: ->"+e.name+"<- static 'GROUP' can only be Lexer.SKIPPED/Lexer.NA/A String",type:zF.INVALID_GROUP_TYPE_FOUND,tokenTypes:[e]}}));return r}(i)),r=r.concat(function(e,t){var r=vL(e,(function(e){return void 0!==e.PUSH_MODE&&!CL(t,e.PUSH_MODE)})),n=hL(r,(function(e){return{message:"Token Type: ->"+e.name+"<- static 'PUSH_MODE' value cannot refer to a Lexer Mode ->"+e.PUSH_MODE+"<-which does not exist",type:zF.PUSH_MODE_DOES_NOT_EXIST,tokenTypes:[e]}}));return n}(i,t)),r=r.concat(function(e){var t=[],r=IL(e,(function(e,t,r){var n,o=t.PATTERN;return o===YF.NA||(gL(o)?e.push({str:o,idx:r,tokenType:t}):xL(o)&&(n=o,void 0===AL([".","\\","[","]","|","^","$","(",")","?","*","+","{"],(function(e){return-1!==n.source.indexOf(e)})))&&e.push({str:o.source,idx:r,tokenType:t})),e}),[]);return mL(e,(function(e,n){mL(r,(function(r){var o=r.str,i=r.idx,s=r.tokenType;if(n<i&&function(e,t){if(xL(t)){var r=t.exec(e);return null!==r&&0===r.index}if(yL(t))return t(e,0,[],{});if(TL(t,"exec"))return t.exec(e,0,[],{});if("string"==typeof t)return t===e;throw Error("non exhaustive match")}(o,e.PATTERN)){var a="Token: ->"+s.name+"<- can never be matched.\nBecause it appears AFTER the Token Type ->"+e.name+"<-in the lexer's definition.\nSee https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#UNREACHABLE";t.push({message:a,type:zF.UNREACHABLE_PATTERN,tokenTypes:[e,s]})}}))})),t}(i)),r}var SF=/[^\\][\$]/;var TF=/[^\\[][\^]|^\^/;function CF(e){var t=e.ignoreCase?"i":"";return new RegExp("^(?:"+e.source+")",t)}function bF(e){var t=e.ignoreCase?"iy":"y";return new RegExp(""+e.source,t)}function NF(e,t,r){var n=[],o=!1,i=RL(OL(cL(function(e,t){for(var r=[],n=lL(e),o=0;o<n.length;o++){var i=n[o];r.push(t.call(null,e[i],i))}return r}(e.modes,(function(e){return e})))),(function(e){return e[fF]===YF.NA})),s=_F(r);return t&&mL(i,(function(e){var t=MF(e,s);if(!1!==t){var r=function(e,t){if(t.issue===zF.IDENTIFY_TERMINATOR)return"Warning: unable to identify line terminator usage in pattern.\n\tThe problem is in the <"+e.name+"> Token Type\n\t Root cause: "+t.errMsg+".\n\tFor details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#IDENTIFY_TERMINATOR";if(t.issue===zF.CUSTOM_LINE_BREAK)return"Warning: A Custom Token Pattern should specify the <line_breaks> option.\n\tThe problem is in the <"+e.name+"> Token Type\n\tFor details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#CUSTOM_LINE_BREAK";throw Error("non exhaustive match")}(e,t),i={message:r,type:t.issue,tokenType:e};n.push(i)}else TL(e,"LINE_BREAKS")?!0===e.LINE_BREAKS&&(o=!0):mF(s,e.PATTERN)&&(o=!0)})),t&&!o&&n.push({message:"Warning: No LINE_BREAKS Found.\n\tThis Lexer has been defined to track line and column information,\n\tBut none of the Token Types can be identified as matching a line terminator.\n\tSee https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#LINE_BREAKS \n\tfor details.",type:zF.NO_LINE_BREAKS_FLAGS}),n}function AF(e){var t=e.PATTERN;if(xL(t))return!1;if(yL(t))return!0;if(TL(t,"exec"))return!0;if(gL(t))return!1;throw Error("non exhaustive match")}function IF(e){return!(!gL(e)||1!==e.length)&&e.charCodeAt(0)}var OF={test:function(e){for(var t=e.length,r=this.lastIndex;r<t;r++){var n=e.charCodeAt(r);if(10===n)return this.lastIndex=r+1,!0;if(13===n)return 10===e.charCodeAt(r+1)?this.lastIndex=r+2:this.lastIndex=r+1,!0}return!1},lastIndex:0};function MF(e,t){if(TL(e,"LINE_BREAKS"))return!1;if(xL(e.PATTERN)){try{mF(t,e.PATTERN)}catch(r){return{issue:zF.IDENTIFY_TERMINATOR,errMsg:r.message}}return!1}if(gL(e.PATTERN))return!1;if(AF(e))return{issue:zF.CUSTOM_LINE_BREAK};throw Error("non exhaustive match")}function _F(e){return hL(e,(function(e){return gL(e)&&e.length>0?e.charCodeAt(0):e}))}function xF(e,t,r){void 0===e[t]?e[t]=[r]:e[t].push(r)}var LF=256;function FF(e){return e<LF?e:PF[e]}var PF=[];function VF(e,t){var r=e.tokenTypeIdx;return r===t.tokenTypeIdx||!0===t.isParent&&!0===t.categoryMatchesMap[r]}function HF(e,t){return e.tokenTypeIdx===t.tokenTypeIdx}var DF=1,UF={};function kF(e){var t=function(e){var t=bL(e),r=e,n=!0;for(;n;){var o=PL(r=OL(cL(hL(r,(function(e){return e.CATEGORIES})))),t);t=t.concat(o),aL(o)?n=!1:r=o}return t}(e);!function(e){mL(e,(function(e){WF(e)||(UF[DF]=e,e.tokenTypeIdx=DF++),GF(e)&&!_L(e.CATEGORIES)&&(e.CATEGORIES=[e.CATEGORIES]),GF(e)||(e.CATEGORIES=[]),TL(e,"categoryMatches")||(e.categoryMatches=[]),function(e){return TL(e,"categoryMatchesMap")}(e)||(e.categoryMatchesMap={})}))}(t),function(e){mL(e,(function(e){BF([],e)}))}(t),function(e){mL(e,(function(e){e.categoryMatches=[],mL(e.categoryMatchesMap,(function(t,r){e.categoryMatches.push(UF[r].tokenTypeIdx)}))}))}(t),mL(t,(function(e){e.isParent=e.categoryMatches.length>0}))}function BF(e,t){mL(e,(function(e){t.categoryMatchesMap[e.tokenTypeIdx]=!0})),mL(t.CATEGORIES,(function(r){var n=e.concat(t);CL(n,r)||BF(n,r)}))}function WF(e){return TL(e,"tokenTypeIdx")}function GF(e){return TL(e,"CATEGORIES")}function jF(e){return TL(e,"tokenTypeIdx")}var zF;!function(e){e[e.MISSING_PATTERN=0]="MISSING_PATTERN",e[e.INVALID_PATTERN=1]="INVALID_PATTERN",e[e.EOI_ANCHOR_FOUND=2]="EOI_ANCHOR_FOUND",e[e.UNSUPPORTED_FLAGS_FOUND=3]="UNSUPPORTED_FLAGS_FOUND",e[e.DUPLICATE_PATTERNS_FOUND=4]="DUPLICATE_PATTERNS_FOUND",e[e.INVALID_GROUP_TYPE_FOUND=5]="INVALID_GROUP_TYPE_FOUND",e[e.PUSH_MODE_DOES_NOT_EXIST=6]="PUSH_MODE_DOES_NOT_EXIST",e[e.MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE=7]="MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE",e[e.MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY=8]="MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY",e[e.MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST=9]="MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST",e[e.LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED=10]="LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED",e[e.SOI_ANCHOR_FOUND=11]="SOI_ANCHOR_FOUND",e[e.EMPTY_MATCH_PATTERN=12]="EMPTY_MATCH_PATTERN",e[e.NO_LINE_BREAKS_FLAGS=13]="NO_LINE_BREAKS_FLAGS",e[e.UNREACHABLE_PATTERN=14]="UNREACHABLE_PATTERN",e[e.IDENTIFY_TERMINATOR=15]="IDENTIFY_TERMINATOR",e[e.CUSTOM_LINE_BREAK=16]="CUSTOM_LINE_BREAK"}(zF||(zF={}));var $F={deferDefinitionErrorsHandling:!1,positionTracking:"full",lineTerminatorsPattern:/\n|\r\n?/g,lineTerminatorCharacters:["\n","\r"],ensureOptimizations:!1,safeMode:!1,errorMessageProvider:{buildUnableToPopLexerModeMessage:function(e){return"Unable to pop Lexer Mode after encountering Token ->"+e.image+"<- The Mode Stack is empty"},buildUnexpectedCharactersMessage:function(e,t,r,n,o){return"unexpected character: ->"+e.charAt(t)+"<- at offset: "+t+", skipped "+r+" characters."}},traceInitPerf:!1,skipValidations:!1};Object.freeze($F);var YF=function(){function e(e,t){var r=this;if(void 0===t&&(t=$F),this.lexerDefinition=e,this.lexerDefinitionErrors=[],this.lexerDefinitionWarning=[],this.patternIdxToConfig={},this.charCodeToPatternIdxToConfig={},this.modes=[],this.emptyGroups={},this.config=void 0,this.trackStartLines=!0,this.trackEndLines=!0,this.hasCustom=!1,this.canModeBeOptimized={},"boolean"==typeof t)throw Error("The second argument to the Lexer constructor is now an ILexerConfig Object.\na boolean 2nd argument is no longer supported");this.config=BL($F,t);var n=this.config.traceInitPerf;!0===n?(this.traceInitMaxIdent=1/0,this.traceInitPerf=!0):"number"==typeof n&&(this.traceInitMaxIdent=n,this.traceInitPerf=!0),this.traceInitIndent=-1,this.TRACE_INIT("Lexer Constructor",(function(){var n,o=!0;r.TRACE_INIT("Lexer Config handling",(function(){if(r.config.lineTerminatorsPattern===$F.lineTerminatorsPattern)r.config.lineTerminatorsPattern=OF;else if(r.config.lineTerminatorCharacters===$F.lineTerminatorCharacters)throw Error("Error: Missing <lineTerminatorCharacters> property on the Lexer config.\n\tFor details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#MISSING_LINE_TERM_CHARS");if(t.safeMode&&t.ensureOptimizations)throw Error('"safeMode" and "ensureOptimizations" flags are mutually exclusive.');r.trackStartLines=/full|onlyStart/i.test(r.config.positionTracking),r.trackEndLines=/full/i.test(r.config.positionTracking),_L(e)?((n={modes:{}}).modes[yF]=bL(e),n[yF]=yF):(o=!1,n=NL(e))})),!1===r.config.skipValidations&&(r.TRACE_INIT("performRuntimeChecks",(function(){r.lexerDefinitionErrors=r.lexerDefinitionErrors.concat(function(e,t,r){var n=[];return TL(e,yF)||n.push({message:"A MultiMode Lexer cannot be initialized without a <"+yF+"> property in its definition\n",type:zF.MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE}),TL(e,wF)||n.push({message:"A MultiMode Lexer cannot be initialized without a <modes> property in its definition\n",type:zF.MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY}),TL(e,wF)&&TL(e,yF)&&!TL(e.modes,e.defaultMode)&&n.push({message:"A MultiMode Lexer cannot be initialized with a "+yF+": <"+e.defaultMode+">which does not exist\n",type:zF.MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST}),TL(e,wF)&&mL(e.modes,(function(e,t){mL(e,(function(e,r){fL(e)&&n.push({message:"A Lexer cannot be initialized using an undefined Token Type. Mode:<"+t+"> at index: <"+r+">\n",type:zF.LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED})}))})),n}(n,r.trackStartLines,r.config.lineTerminatorCharacters))})),r.TRACE_INIT("performWarningRuntimeChecks",(function(){r.lexerDefinitionWarning=r.lexerDefinitionWarning.concat(NF(n,r.trackStartLines,r.config.lineTerminatorCharacters))}))),n.modes=n.modes?n.modes:{},mL(n.modes,(function(e,t){n.modes[t]=RL(e,(function(e){return fL(e)}))}));var i=lL(n.modes);if(mL(n.modes,(function(e,n){r.TRACE_INIT("Mode: <"+n+"> processing",(function(){var o;(r.modes.push(n),!1===r.config.skipValidations&&r.TRACE_INIT("validatePatterns",(function(){r.lexerDefinitionErrors=r.lexerDefinitionErrors.concat(RF(e,i))})),aL(r.lexerDefinitionErrors))&&(kF(e),r.TRACE_INIT("analyzeTokenTypes",(function(){o=vF(e,{lineTerminatorCharacters:r.config.lineTerminatorCharacters,positionTracking:t.positionTracking,ensureOptimizations:t.ensureOptimizations,safeMode:t.safeMode,tracer:r.TRACE_INIT.bind(r)})})),r.patternIdxToConfig[n]=o.patternIdxToConfig,r.charCodeToPatternIdxToConfig[n]=o.charCodeToPatternIdxToConfig,r.emptyGroups=BL(r.emptyGroups,o.emptyGroups),r.hasCustom=o.hasCustom||r.hasCustom,r.canModeBeOptimized[n]=o.canBeOptimized)}))})),r.defaultMode=n.defaultMode,!aL(r.lexerDefinitionErrors)&&!r.config.deferDefinitionErrorsHandling){var s=hL(r.lexerDefinitionErrors,(function(e){return e.message})),a=s.join("-----------------------\n");throw new Error("Errors detected in definition of Lexer:\n"+a)}mL(r.lexerDefinitionWarning,(function(e){zL(e.message)})),r.TRACE_INIT("Choosing sub-methods implementations",(function(){if(EF?(r.chopInput=GL,r.match=r.matchWithTest):(r.updateLastIndex=WL,r.match=r.matchWithExec),o&&(r.handleModes=WL),!1===r.trackStartLines&&(r.computeNewColumn=GL),!1===r.trackEndLines&&(r.updateTokenEndLineColumnLocation=WL),/full/i.test(r.config.positionTracking))r.createTokenInstance=r.createFullToken;else if(/onlyStart/i.test(r.config.positionTracking))r.createTokenInstance=r.createStartOnlyToken;else{if(!/onlyOffset/i.test(r.config.positionTracking))throw Error('Invalid <positionTracking> config option: "'+r.config.positionTracking+'"');r.createTokenInstance=r.createOffsetOnlyToken}r.hasCustom?(r.addToken=r.addTokenUsingPush,r.handlePayload=r.handlePayloadWithCustom):(r.addToken=r.addTokenUsingMemberAccess,r.handlePayload=r.handlePayloadNoCustom)})),r.TRACE_INIT("Failed Optimization Warnings",(function(){var e=IL(r.canModeBeOptimized,(function(e,t,r){return!1===t&&e.push(r),e}),[]);if(t.ensureOptimizations&&!aL(e))throw Error("Lexer Modes: < "+e.join(", ")+' > cannot be optimized.\n\t Disable the "ensureOptimizations" lexer config flag to silently ignore this and run the lexer in an un-optimized mode.\n\t Or inspect the console log for details on how to resolve these issues.')})),r.TRACE_INIT("clearRegExpParserCache",(function(){tF={}})),r.TRACE_INIT("toFastProperties",(function(){YL(r)}))}))}return e.prototype.tokenize=function(e,t){if(void 0===t&&(t=this.defaultMode),!aL(this.lexerDefinitionErrors)){var r=hL(this.lexerDefinitionErrors,(function(e){return e.message})),n=r.join("-----------------------\n");throw new Error("Unable to Tokenize because Errors detected in definition of Lexer:\n"+n)}return this.tokenizeInternal(e,t)},e.prototype.tokenizeInternal=function(e,t){var r,n,o,i,s,a,l,u,h,c,d,p,m,g,f,y,w=this,E=e,v=E.length,R=0,S=0,T=this.hasCustom?0:Math.floor(e.length/10),C=new Array(T),b=[],N=this.trackStartLines?1:void 0,A=this.trackStartLines?1:void 0,I=(f=this.emptyGroups,y={},mL(lL(f),(function(e){if(!_L(f[e]))throw Error("non exhaustive match");y[e]=[]})),y),O=this.trackStartLines,M=this.config.lineTerminatorsPattern,_=0,x=[],L=[],F=[],P=[];Object.freeze(P);var V=void 0;function H(){return x}function D(e){var t=FF(e),r=L[t];return void 0===r?P:r}var U,k=function(e){if(1===F.length&&void 0===e.tokenType.PUSH_MODE){var t=w.config.errorMessageProvider.buildUnableToPopLexerModeMessage(e);b.push({offset:e.startOffset,line:void 0!==e.startLine?e.startLine:void 0,column:void 0!==e.startColumn?e.startColumn:void 0,length:e.image.length,message:t})}else{F.pop();var r=pL(F);x=w.patternIdxToConfig[r],L=w.charCodeToPatternIdxToConfig[r],_=x.length;var n=w.canModeBeOptimized[r]&&!1===w.config.safeMode;V=L&&n?D:H}};function B(e){F.push(e),L=this.charCodeToPatternIdxToConfig[e],x=this.patternIdxToConfig[e],_=x.length,_=x.length;var t=this.canModeBeOptimized[e]&&!1===this.config.safeMode;V=L&&t?D:H}for(B.call(this,t);R<v;){s=null;var W=E.charCodeAt(R),G=V(W),j=G.length;for(r=0;r<j;r++){var z=(U=G[r]).pattern;if(a=null,!1!==(te=U.short)?W===te&&(s=z):!0===U.isCustom?null!==(g=z.exec(E,R,C,I))?(s=g[0],void 0!==g.payload&&(a=g.payload)):s=null:(this.updateLastIndex(z,R),s=this.match(z,e,R)),null!==s){if(void 0!==(i=U.longerAlt)){var $=x[i],Y=$.pattern;l=null,!0===$.isCustom?null!==(g=Y.exec(E,R,C,I))?(o=g[0],void 0!==g.payload&&(l=g.payload)):o=null:(this.updateLastIndex(Y,R),o=this.match(Y,e,R)),o&&o.length>s.length&&(s=o,a=l,U=$)}break}}if(null!==s){if(u=s.length,void 0!==(h=U.group)&&(c=U.tokenTypeIdx,d=this.createTokenInstance(s,R,c,U.tokenType,N,A,u),this.handlePayload(d,a),!1===h?S=this.addToken(C,S,d):I[h].push(d)),e=this.chopInput(e,u),R+=u,A=this.computeNewColumn(A,u),!0===O&&!0===U.canLineTerminator){var X=0,K=void 0,q=void 0;M.lastIndex=0;do{!0===(K=M.test(s))&&(q=M.lastIndex-1,X++)}while(!0===K);0!==X&&(N+=X,A=u-q,this.updateTokenEndLineColumnLocation(d,h,q,X,N,A,u))}this.handleModes(U,k,B,d)}else{for(var Q=R,Z=N,J=A,ee=!1;!ee&&R<v;)for(E.charCodeAt(R),e=this.chopInput(e,1),R++,n=0;n<_;n++){var te,re=x[n];z=re.pattern;if(!1!==(te=re.short)?E.charCodeAt(R)===te&&(ee=!0):!0===re.isCustom?ee=null!==z.exec(E,R,C,I):(this.updateLastIndex(z,R),ee=null!==z.exec(e)),!0===ee)break}p=R-Q,m=this.config.errorMessageProvider.buildUnexpectedCharactersMessage(E,Q,p,Z,J),b.push({offset:Q,line:Z,column:J,length:p,message:m})}}return this.hasCustom||(C.length=S),{tokens:C,groups:I,errors:b}},e.prototype.handleModes=function(e,t,r,n){if(!0===e.pop){var o=e.push;t(n),void 0!==o&&r.call(this,o)}else void 0!==e.push&&r.call(this,e.push)},e.prototype.chopInput=function(e,t){return e.substring(t)},e.prototype.updateLastIndex=function(e,t){e.lastIndex=t},e.prototype.updateTokenEndLineColumnLocation=function(e,t,r,n,o,i,s){var a,l;void 0!==t&&(l=(a=r===s-1)?-1:0,1===n&&!0===a||(e.endLine=o+l,e.endColumn=i-1-l))},e.prototype.computeNewColumn=function(e,t){return e+t},e.prototype.createTokenInstance=function(){return null},e.prototype.createOffsetOnlyToken=function(e,t,r,n){return{image:e,startOffset:t,tokenTypeIdx:r,tokenType:n}},e.prototype.createStartOnlyToken=function(e,t,r,n,o,i){return{image:e,startOffset:t,startLine:o,startColumn:i,tokenTypeIdx:r,tokenType:n}},e.prototype.createFullToken=function(e,t,r,n,o,i,s){return{image:e,startOffset:t,endOffset:t+s-1,startLine:o,endLine:o,startColumn:i,endColumn:i+s-1,tokenTypeIdx:r,tokenType:n}},e.prototype.addToken=function(e,t,r){return 666},e.prototype.addTokenUsingPush=function(e,t,r){return e.push(r),t},e.prototype.addTokenUsingMemberAccess=function(e,t,r){return e[t]=r,++t},e.prototype.handlePayload=function(e,t){},e.prototype.handlePayloadNoCustom=function(e,t){},e.prototype.handlePayloadWithCustom=function(e,t){null!==t&&(e.payload=t)},e.prototype.match=function(e,t,r){return null},e.prototype.matchWithTest=function(e,t,r){return!0===e.test(t)?t.substring(r,e.lastIndex):null},e.prototype.matchWithExec=function(e,t){var r=e.exec(t);return null!==r?r[0]:r},e.prototype.TRACE_INIT=function(e,t){if(!0===this.traceInitPerf){this.traceInitIndent++;var r=new Array(this.traceInitIndent+1).join("\t");this.traceInitIndent<this.traceInitMaxIdent&&console.log(r+"--\x3e <"+e+">");var n=KL(t),o=n.time,i=n.value,s=o>10?console.warn:console.log;return this.traceInitIndent<this.traceInitMaxIdent&&s(r+"<-- <"+e+"> time: "+o+"ms"),this.traceInitIndent--,i}return t()},e.SKIPPED="This marks a skipped Token pattern, this means each token identified by it willbe consumed and then thrown into oblivion, this can be used to for example to completely ignore whitespace.",e.NA=/NOT_APPLICABLE/,e}();function XF(e){return KF(e)?e.LABEL:e.name}function KF(e){return gL(e.LABEL)&&""!==e.LABEL}var qF="parent",QF="categories",ZF="label",JF="group",eP="push_mode",tP="pop_mode",rP="longer_alt",nP="line_breaks",oP="start_chars_hint";function iP(e){return function(e){var t=e.pattern,r={};r.name=e.name,fL(t)||(r.PATTERN=t);if(TL(e,qF))throw"The parent property is no longer supported.\nSee: https://github.com/SAP/chevrotain/issues/564#issuecomment-349062346 for details.";TL(e,QF)&&(r.CATEGORIES=e[QF]);kF([r]),TL(e,ZF)&&(r.LABEL=e[ZF]);TL(e,JF)&&(r.GROUP=e[JF]);TL(e,tP)&&(r.POP_MODE=e[tP]);TL(e,eP)&&(r.PUSH_MODE=e[eP]);TL(e,rP)&&(r.LONGER_ALT=e[rP]);TL(e,nP)&&(r.LINE_BREAKS=e[nP]);TL(e,oP)&&(r.START_CHARS_HINT=e[oP]);return r}(e)}var sP=iP({name:"EOF",pattern:YF.NA});function aP(e,t,r,n,o,i,s,a){return{image:t,startOffset:r,endOffset:n,startLine:o,endLine:i,startColumn:s,endColumn:a,tokenTypeIdx:e.tokenTypeIdx,tokenType:e}}function lP(e,t){return VF(e,t)}kF([sP]);var uP=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},e(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),hP=function(){function e(e){this.definition=e}return e.prototype.accept=function(e){e.visit(this),mL(this.definition,(function(t){t.accept(e)}))},e}(),cP=function(e){function t(t){var r=e.call(this,[])||this;return r.idx=1,HL(r,SL(t,(function(e){return void 0!==e}))),r}return uP(t,e),Object.defineProperty(t.prototype,"definition",{get:function(){return void 0!==this.referencedRule?this.referencedRule.definition:[]},set:function(e){},enumerable:!0,configurable:!0}),t.prototype.accept=function(e){e.visit(this)},t}(hP),dP=function(e){function t(t){var r=e.call(this,t.definition)||this;return r.orgText="",HL(r,SL(t,(function(e){return void 0!==e}))),r}return uP(t,e),t}(hP),pP=function(e){function t(t){var r=e.call(this,t.definition)||this;return r.ignoreAmbiguities=!1,HL(r,SL(t,(function(e){return void 0!==e}))),r}return uP(t,e),t}(hP),mP=function(e){function t(t){var r=e.call(this,t.definition)||this;return r.idx=1,HL(r,SL(t,(function(e){return void 0!==e}))),r}return uP(t,e),t}(hP),gP=function(e){function t(t){var r=e.call(this,t.definition)||this;return r.idx=1,HL(r,SL(t,(function(e){return void 0!==e}))),r}return uP(t,e),t}(hP),fP=function(e){function t(t){var r=e.call(this,t.definition)||this;return r.idx=1,HL(r,SL(t,(function(e){return void 0!==e}))),r}return uP(t,e),t}(hP),yP=function(e){function t(t){var r=e.call(this,t.definition)||this;return r.idx=1,HL(r,SL(t,(function(e){return void 0!==e}))),r}return uP(t,e),t}(hP),wP=function(e){function t(t){var r=e.call(this,t.definition)||this;return r.idx=1,HL(r,SL(t,(function(e){return void 0!==e}))),r}return uP(t,e),t}(hP),EP=function(e){function t(t){var r=e.call(this,t.definition)||this;return r.idx=1,r.ignoreAmbiguities=!1,r.hasPredicates=!1,HL(r,SL(t,(function(e){return void 0!==e}))),r}return uP(t,e),t}(hP),vP=function(){function e(e){this.idx=1,HL(this,SL(e,(function(e){return void 0!==e})))}return e.prototype.accept=function(e){e.visit(this)},e}();function RP(e){function t(e){return hL(e,RP)}if(e instanceof cP)return{type:"NonTerminal",name:e.nonTerminalName,idx:e.idx};if(e instanceof pP)return{type:"Flat",definition:t(e.definition)};if(e instanceof mP)return{type:"Option",idx:e.idx,definition:t(e.definition)};if(e instanceof gP)return{type:"RepetitionMandatory",name:e.name,idx:e.idx,definition:t(e.definition)};if(e instanceof fP)return{type:"RepetitionMandatoryWithSeparator",name:e.name,idx:e.idx,separator:RP(new vP({terminalType:e.separator})),definition:t(e.definition)};if(e instanceof wP)return{type:"RepetitionWithSeparator",name:e.name,idx:e.idx,separator:RP(new vP({terminalType:e.separator})),definition:t(e.definition)};if(e instanceof yP)return{type:"Repetition",name:e.name,idx:e.idx,definition:t(e.definition)};if(e instanceof EP)return{type:"Alternation",name:e.name,idx:e.idx,definition:t(e.definition)};if(e instanceof vP){var r={type:"Terminal",name:e.terminalType.name,label:XF(e.terminalType),idx:e.idx},n=e.terminalType.PATTERN;return e.terminalType.PATTERN&&(r.pattern=xL(n)?n.source:n),r}if(e instanceof dP)return{type:"Rule",name:e.name,orgText:e.orgText,definition:t(e.definition)};throw Error("non exhaustive match")}var SP=function(){function e(){}return e.prototype.walk=function(e,t){var r=this;void 0===t&&(t=[]),mL(e.definition,(function(n,o){var i=wL(e.definition,o+1);if(n instanceof cP)r.walkProdRef(n,i,t);else if(n instanceof vP)r.walkTerminal(n,i,t);else if(n instanceof pP)r.walkFlat(n,i,t);else if(n instanceof mP)r.walkOption(n,i,t);else if(n instanceof gP)r.walkAtLeastOne(n,i,t);else if(n instanceof fP)r.walkAtLeastOneSep(n,i,t);else if(n instanceof wP)r.walkManySep(n,i,t);else if(n instanceof yP)r.walkMany(n,i,t);else{if(!(n instanceof EP))throw Error("non exhaustive match");r.walkOr(n,i,t)}}))},e.prototype.walkTerminal=function(e,t,r){},e.prototype.walkProdRef=function(e,t,r){},e.prototype.walkFlat=function(e,t,r){var n=t.concat(r);this.walk(e,n)},e.prototype.walkOption=function(e,t,r){var n=t.concat(r);this.walk(e,n)},e.prototype.walkAtLeastOne=function(e,t,r){var n=[new mP({definition:e.definition})].concat(t,r);this.walk(e,n)},e.prototype.walkAtLeastOneSep=function(e,t,r){var n=TP(e,t,r);this.walk(e,n)},e.prototype.walkMany=function(e,t,r){var n=[new mP({definition:e.definition})].concat(t,r);this.walk(e,n)},e.prototype.walkManySep=function(e,t,r){var n=TP(e,t,r);this.walk(e,n)},e.prototype.walkOr=function(e,t,r){var n=this,o=t.concat(r);mL(e.definition,(function(e){var t=new pP({definition:[e]});n.walk(t,o)}))},e}();function TP(e,t,r){return[new mP({definition:[new vP({terminalType:e.separator})].concat(e.definition)})].concat(t,r)}var CP=function(){function e(){}return e.prototype.visit=function(e){var t=e;switch(t.constructor){case cP:return this.visitNonTerminal(t);case pP:return this.visitFlat(t);case mP:return this.visitOption(t);case gP:return this.visitRepetitionMandatory(t);case fP:return this.visitRepetitionMandatoryWithSeparator(t);case wP:return this.visitRepetitionWithSeparator(t);case yP:return this.visitRepetition(t);case EP:return this.visitAlternation(t);case vP:return this.visitTerminal(t);case dP:return this.visitRule(t);default:throw Error("non exhaustive match")}},e.prototype.visitNonTerminal=function(e){},e.prototype.visitFlat=function(e){},e.prototype.visitOption=function(e){},e.prototype.visitRepetition=function(e){},e.prototype.visitRepetitionMandatory=function(e){},e.prototype.visitRepetitionMandatoryWithSeparator=function(e){},e.prototype.visitRepetitionWithSeparator=function(e){},e.prototype.visitAlternation=function(e){},e.prototype.visitTerminal=function(e){},e.prototype.visitRule=function(e){},e}(),bP=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},e(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();function NP(e,t){return void 0===t&&(t=[]),!!(e instanceof mP||e instanceof yP||e instanceof wP)||(e instanceof EP?VL(e.definition,(function(e){return NP(e,t)})):!(e instanceof cP&&CL(t,e))&&(e instanceof hP&&(e instanceof cP&&t.push(e),FL(e.definition,(function(e){return NP(e,t)})))))}function AP(e){if(e instanceof cP)return"SUBRULE";if(e instanceof mP)return"OPTION";if(e instanceof EP)return"OR";if(e instanceof gP)return"AT_LEAST_ONE";if(e instanceof fP)return"AT_LEAST_ONE_SEP";if(e instanceof wP)return"MANY_SEP";if(e instanceof yP)return"MANY";if(e instanceof vP)return"CONSUME";throw Error("non exhaustive match")}var IP=new(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.separator="-",t.dslMethods={option:[],alternation:[],repetition:[],repetitionWithSeparator:[],repetitionMandatory:[],repetitionMandatoryWithSeparator:[]},t}return bP(t,e),t.prototype.reset=function(){this.dslMethods={option:[],alternation:[],repetition:[],repetitionWithSeparator:[],repetitionMandatory:[],repetitionMandatoryWithSeparator:[]}},t.prototype.visitTerminal=function(e){var t=e.terminalType.name+this.separator+"Terminal";TL(this.dslMethods,t)||(this.dslMethods[t]=[]),this.dslMethods[t].push(e)},t.prototype.visitNonTerminal=function(e){var t=e.nonTerminalName+this.separator+"Terminal";TL(this.dslMethods,t)||(this.dslMethods[t]=[]),this.dslMethods[t].push(e)},t.prototype.visitOption=function(e){this.dslMethods.option.push(e)},t.prototype.visitRepetitionWithSeparator=function(e){this.dslMethods.repetitionWithSeparator.push(e)},t.prototype.visitRepetitionMandatory=function(e){this.dslMethods.repetitionMandatory.push(e)},t.prototype.visitRepetitionMandatoryWithSeparator=function(e){this.dslMethods.repetitionMandatoryWithSeparator.push(e)},t.prototype.visitRepetition=function(e){this.dslMethods.repetition.push(e)},t.prototype.visitAlternation=function(e){this.dslMethods.alternation.push(e)},t}(CP));function OP(e){if(e instanceof cP)return OP(e.referencedRule);if(e instanceof vP)return[e.terminalType];if(function(e){return e instanceof pP||e instanceof mP||e instanceof yP||e instanceof gP||e instanceof fP||e instanceof wP||e instanceof vP||e instanceof dP}(e))return function(e){var t,r=[],n=e.definition,o=0,i=n.length>o,s=!0;for(;i&&s;)s=NP(t=n[o]),r=r.concat(OP(t)),o+=1,i=n.length>o;return ML(r)}(e);if(function(e){return e instanceof EP}(e))return function(e){var t=hL(e.definition,(function(e){return OP(e)}));return ML(cL(t))}(e);throw Error("non exhaustive match")}var MP="_~IN~_",_P=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},e(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),xP=function(e){function t(t){var r=e.call(this)||this;return r.topProd=t,r.follows={},r}return _P(t,e),t.prototype.startWalking=function(){return this.walk(this.topProd),this.follows},t.prototype.walkTerminal=function(e,t,r){},t.prototype.walkProdRef=function(e,t,r){var n,o,i=(n=e.referencedRule,o=e.idx,n.name+o+MP+this.topProd.name),s=t.concat(r),a=OP(new pP({definition:s}));this.follows[i]=a},t}(SP);var LP=256,FP=512,PP=768,VP=1024,HP=1280,DP=1536;function UP(e,t,r){return r|t|e}function kP(e,t,r,n){var o=n+1<<24;return UP(e,t,r)|o}var BP=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},e(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();function WP(e,t){!0===isNaN(e.startOffset)?(e.startOffset=t.startOffset,e.endOffset=t.endOffset):e.endOffset<t.endOffset==!0&&(e.endOffset=t.endOffset)}function GP(e,t){!0===isNaN(e.startOffset)?(e.startOffset=t.startOffset,e.startColumn=t.startColumn,e.startLine=t.startLine,e.endOffset=t.endOffset,e.endColumn=t.endColumn,e.endLine=t.endLine):e.endOffset<t.endOffset==!0&&(e.endOffset=t.endOffset,e.endColumn=t.endColumn,e.endLine=t.endLine)}function jP(e,t,r){void 0===e.children[t]?e.children[t]=[r]:e.children[t].push(r)}var zP=function(e){function t(t){var r=e.call(this)||this;return r.result=[],r.ruleIdx=t,r}return BP(t,e),t.prototype.collectNamedDSLMethod=function(e,t,r){if(!fL(e.name)){var n=void 0;if(e instanceof mP||e instanceof yP||e instanceof gP||e instanceof EP)n=new t({definition:e.definition,idx:e.idx});else{if(!(e instanceof fP||e instanceof wP))throw Error("non exhaustive match");n=new t({definition:e.definition,idx:e.idx,separator:e.separator})}var o=[n],i=UP(this.ruleIdx,r,e.idx);this.result.push({def:o,key:i,name:e.name,orgProd:e})}},t.prototype.visitOption=function(e){this.collectNamedDSLMethod(e,mP,FP)},t.prototype.visitRepetition=function(e){this.collectNamedDSLMethod(e,yP,PP)},t.prototype.visitRepetitionMandatory=function(e){this.collectNamedDSLMethod(e,gP,VP)},t.prototype.visitRepetitionMandatoryWithSeparator=function(e){this.collectNamedDSLMethod(e,fP,DP)},t.prototype.visitRepetitionWithSeparator=function(e){this.collectNamedDSLMethod(e,wP,HP)},t.prototype.visitAlternation=function(e){var t=this;this.collectNamedDSLMethod(e,EP,LP);var r=e.definition.length>1;mL(e.definition,(function(n,o){if(!fL(n.name)){var i=n.definition;i=r?[new mP({definition:n.definition})]:n.definition;var s=kP(t.ruleIdx,LP,e.idx,o);t.result.push({def:i,key:s,name:n.name,orgProd:n})}}))},t}(CP);var $P=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},e(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),YP=function(e){function t(t,r){var n=e.call(this,t,r)||this;return n.path=r,n.nextTerminalName="",n.nextTerminalOccurrence=0,n.nextTerminalName=n.path.lastTok.name,n.nextTerminalOccurrence=n.path.lastTokOccurrence,n}return $P(t,e),t.prototype.walkTerminal=function(e,t,r){if(this.isAtEndOfPath&&e.terminalType.name===this.nextTerminalName&&e.idx===this.nextTerminalOccurrence&&!this.found){var n=t.concat(r),o=new pP({definition:n});this.possibleTokTypes=OP(o),this.found=!0}},t}(function(e){function t(t,r){var n=e.call(this)||this;return n.topProd=t,n.path=r,n.possibleTokTypes=[],n.nextProductionName="",n.nextProductionOccurrence=0,n.found=!1,n.isAtEndOfPath=!1,n}return $P(t,e),t.prototype.startWalking=function(){if(this.found=!1,this.path.ruleStack[0]!==this.topProd.name)throw Error("The path does not start with the walker's top Rule!");return this.ruleStack=bL(this.path.ruleStack).reverse(),this.occurrenceStack=bL(this.path.occurrenceStack).reverse(),this.ruleStack.pop(),this.occurrenceStack.pop(),this.updateExpectedNext(),this.walk(this.topProd),this.possibleTokTypes},t.prototype.walk=function(t,r){void 0===r&&(r=[]),this.found||e.prototype.walk.call(this,t,r)},t.prototype.walkProdRef=function(e,t,r){if(e.referencedRule.name===this.nextProductionName&&e.idx===this.nextProductionOccurrence){var n=t.concat(r);this.updateExpectedNext(),this.walk(e.referencedRule,n)}},t.prototype.updateExpectedNext=function(){aL(this.ruleStack)?(this.nextProductionName="",this.nextProductionOccurrence=0,this.isAtEndOfPath=!0):(this.nextProductionName=this.ruleStack.pop(),this.nextProductionOccurrence=this.occurrenceStack.pop())},t}(SP)),XP=function(e){function t(t,r){var n=e.call(this)||this;return n.topRule=t,n.occurrence=r,n.result={token:void 0,occurrence:void 0,isEndOfRule:void 0},n}return $P(t,e),t.prototype.startWalking=function(){return this.walk(this.topRule),this.result},t}(SP),KP=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return $P(t,e),t.prototype.walkMany=function(t,r,n){if(t.idx===this.occurrence){var o=dL(r.concat(n));this.result.isEndOfRule=void 0===o,o instanceof vP&&(this.result.token=o.terminalType,this.result.occurrence=o.idx)}else e.prototype.walkMany.call(this,t,r,n)},t}(XP),qP=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return $P(t,e),t.prototype.walkManySep=function(t,r,n){if(t.idx===this.occurrence){var o=dL(r.concat(n));this.result.isEndOfRule=void 0===o,o instanceof vP&&(this.result.token=o.terminalType,this.result.occurrence=o.idx)}else e.prototype.walkManySep.call(this,t,r,n)},t}(XP),QP=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return $P(t,e),t.prototype.walkAtLeastOne=function(t,r,n){if(t.idx===this.occurrence){var o=dL(r.concat(n));this.result.isEndOfRule=void 0===o,o instanceof vP&&(this.result.token=o.terminalType,this.result.occurrence=o.idx)}else e.prototype.walkAtLeastOne.call(this,t,r,n)},t}(XP),ZP=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return $P(t,e),t.prototype.walkAtLeastOneSep=function(t,r,n){if(t.idx===this.occurrence){var o=dL(r.concat(n));this.result.isEndOfRule=void 0===o,o instanceof vP&&(this.result.token=o.terminalType,this.result.occurrence=o.idx)}else e.prototype.walkAtLeastOneSep.call(this,t,r,n)},t}(XP);function JP(e,t,r){void 0===r&&(r=[]),r=bL(r);var n=[],o=0;function i(i){var s=JP(i.concat(wL(e,o+1)),t,r);return n.concat(s)}for(;r.length<t&&o<e.length;){var s=e[o];if(s instanceof pP)return i(s.definition);if(s instanceof cP)return i(s.definition);if(s instanceof mP)n=i(s.definition);else{if(s instanceof gP)return i(a=s.definition.concat([new yP({definition:s.definition})]));if(s instanceof fP)return i(a=[new pP({definition:s.definition}),new yP({definition:[new vP({terminalType:s.separator})].concat(s.definition)})]);if(s instanceof wP){var a=s.definition.concat([new yP({definition:[new vP({terminalType:s.separator})].concat(s.definition)})]);n=i(a)}else if(s instanceof yP){a=s.definition.concat([new yP({definition:s.definition})]);n=i(a)}else{if(s instanceof EP)return mL(s.definition,(function(e){n=i(e.definition)})),n;if(!(s instanceof vP))throw Error("non exhaustive match");r.push(s.terminalType)}}o++}return n.push({partialPath:r,suffixDef:wL(e,o)}),n}function eV(e,t,r,n){var o="EXIT_NONE_TERMINAL",i=[o],s="EXIT_ALTERNATIVE",a=!1,l=t.length,u=l-n-1,h=[],c=[];for(c.push({idx:-1,def:e,ruleStack:[],occurrenceStack:[]});!aL(c);){var d=c.pop();if(d!==s){var p=d.def,m=d.idx,g=d.ruleStack,f=d.occurrenceStack;if(!aL(p)){var y=p[0];if(y===o){var w={idx:m,def:wL(p),ruleStack:EL(g),occurrenceStack:EL(f)};c.push(w)}else if(y instanceof vP)if(m<l-1){var E=m+1;if(r(t[E],y.terminalType)){w={idx:E,def:wL(p),ruleStack:g,occurrenceStack:f};c.push(w)}}else{if(m!==l-1)throw Error("non exhaustive match");h.push({nextTokenType:y.terminalType,nextTokenOccurrence:y.idx,ruleStack:g,occurrenceStack:f}),a=!0}else if(y instanceof cP){var v=bL(g);v.push(y.nonTerminalName);var R=bL(f);R.push(y.idx);w={idx:m,def:y.definition.concat(i,wL(p)),ruleStack:v,occurrenceStack:R};c.push(w)}else if(y instanceof mP){var S={idx:m,def:wL(p),ruleStack:g,occurrenceStack:f};c.push(S),c.push(s);var T={idx:m,def:y.definition.concat(wL(p)),ruleStack:g,occurrenceStack:f};c.push(T)}else if(y instanceof gP){var C=new yP({definition:y.definition,idx:y.idx});w={idx:m,def:y.definition.concat([C],wL(p)),ruleStack:g,occurrenceStack:f};c.push(w)}else if(y instanceof fP){var b=new vP({terminalType:y.separator});C=new yP({definition:[b].concat(y.definition),idx:y.idx}),w={idx:m,def:y.definition.concat([C],wL(p)),ruleStack:g,occurrenceStack:f};c.push(w)}else if(y instanceof wP){S={idx:m,def:wL(p),ruleStack:g,occurrenceStack:f};c.push(S),c.push(s);b=new vP({terminalType:y.separator});var N=new yP({definition:[b].concat(y.definition),idx:y.idx});T={idx:m,def:y.definition.concat([N],wL(p)),ruleStack:g,occurrenceStack:f};c.push(T)}else if(y instanceof yP){S={idx:m,def:wL(p),ruleStack:g,occurrenceStack:f};c.push(S),c.push(s);N=new yP({definition:y.definition,idx:y.idx}),T={idx:m,def:y.definition.concat([N],wL(p)),ruleStack:g,occurrenceStack:f};c.push(T)}else if(y instanceof EP)for(var A=y.definition.length-1;A>=0;A--){var I={idx:m,def:y.definition[A].definition.concat(wL(p)),ruleStack:g,occurrenceStack:f};c.push(I),c.push(s)}else if(y instanceof pP)c.push({idx:m,def:y.definition.concat(wL(p)),ruleStack:g,occurrenceStack:f});else{if(!(y instanceof dP))throw Error("non exhaustive match");c.push(tV(y,m,g,f))}}}else a&&pL(c).idx<=u&&c.pop()}return h}function tV(e,t,r,n){var o=bL(r);o.push(e.name);var i=bL(n);return i.push(1),{idx:t,def:e.definition,ruleStack:o,occurrenceStack:i}}var rV,nV=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},e(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();!function(e){e[e.OPTION=0]="OPTION",e[e.REPETITION=1]="REPETITION",e[e.REPETITION_MANDATORY=2]="REPETITION_MANDATORY",e[e.REPETITION_MANDATORY_WITH_SEPARATOR=3]="REPETITION_MANDATORY_WITH_SEPARATOR",e[e.REPETITION_WITH_SEPARATOR=4]="REPETITION_WITH_SEPARATOR",e[e.ALTERNATION=5]="ALTERNATION"}(rV||(rV={}));var oV=function(e){function t(t,r,n){var o=e.call(this)||this;return o.topProd=t,o.targetOccurrence=r,o.targetProdType=n,o}return nV(t,e),t.prototype.startWalking=function(){return this.walk(this.topProd),this.restDef},t.prototype.checkIsTarget=function(e,t,r,n){return e.idx===this.targetOccurrence&&this.targetProdType===t&&(this.restDef=r.concat(n),!0)},t.prototype.walkOption=function(t,r,n){this.checkIsTarget(t,rV.OPTION,r,n)||e.prototype.walkOption.call(this,t,r,n)},t.prototype.walkAtLeastOne=function(t,r,n){this.checkIsTarget(t,rV.REPETITION_MANDATORY,r,n)||e.prototype.walkOption.call(this,t,r,n)},t.prototype.walkAtLeastOneSep=function(t,r,n){this.checkIsTarget(t,rV.REPETITION_MANDATORY_WITH_SEPARATOR,r,n)||e.prototype.walkOption.call(this,t,r,n)},t.prototype.walkMany=function(t,r,n){this.checkIsTarget(t,rV.REPETITION,r,n)||e.prototype.walkOption.call(this,t,r,n)},t.prototype.walkManySep=function(t,r,n){this.checkIsTarget(t,rV.REPETITION_WITH_SEPARATOR,r,n)||e.prototype.walkOption.call(this,t,r,n)},t}(SP),iV=function(e){function t(t,r,n){var o=e.call(this)||this;return o.targetOccurrence=t,o.targetProdType=r,o.targetRef=n,o.result=[],o}return nV(t,e),t.prototype.checkIsTarget=function(e,t){e.idx!==this.targetOccurrence||this.targetProdType!==t||void 0!==this.targetRef&&e!==this.targetRef||(this.result=e.definition)},t.prototype.visitOption=function(e){this.checkIsTarget(e,rV.OPTION)},t.prototype.visitRepetition=function(e){this.checkIsTarget(e,rV.REPETITION)},t.prototype.visitRepetitionMandatory=function(e){this.checkIsTarget(e,rV.REPETITION_MANDATORY)},t.prototype.visitRepetitionMandatoryWithSeparator=function(e){this.checkIsTarget(e,rV.REPETITION_MANDATORY_WITH_SEPARATOR)},t.prototype.visitRepetitionWithSeparator=function(e){this.checkIsTarget(e,rV.REPETITION_WITH_SEPARATOR)},t.prototype.visitAlternation=function(e){this.checkIsTarget(e,rV.ALTERNATION)},t}(CP);function sV(e){for(var t=new Array(e),r=0;r<e;r++)t[r]=[];return t}function aV(e){for(var t=[""],r=0;r<e.length;r++){for(var n=e[r],o=[],i=0;i<t.length;i++){var s=t[i];o.push(s+"_"+n.tokenTypeIdx);for(var a=0;a<n.categoryMatches.length;a++){var l="_"+n.categoryMatches[a];o.push(s+l)}}t=o}return t}function lV(e,t,r){for(var n=0;n<e.length;n++)if(n!==r)for(var o=e[n],i=0;i<t.length;i++){if(!0===o[t[i]])return!1}return!0}function uV(e,t){for(var r=hL(e,(function(e){return JP([e],1)})),n=sV(r.length),o=hL(r,(function(e){var t={};return mL(e,(function(e){mL(aV(e.partialPath),(function(e){t[e]=!0}))})),t})),i=r,s=1;s<=t;s++){var a=i;i=sV(a.length);for(var l=function(e){for(var r=a[e],l=0;l<r.length;l++){var u=r[l].partialPath,h=r[l].suffixDef,c=aV(u);if(lV(o,c,e)||aL(h)||u.length===t){var d=n[e];if(!1===dV(d,u)){d.push(u);for(var p=0;p<c.length;p++){var m=c[p];o[e][m]=!0}}}else{var g=JP(h,s+1,u);i[e]=i[e].concat(g),mL(g,(function(t){mL(aV(t.partialPath),(function(t){o[e][t]=!0}))}))}}},u=0;u<a.length;u++)l(u)}return n}function hV(e,t,r,n){var o=new iV(e,rV.ALTERNATION,n);return t.accept(o),uV(o.result,r)}function cV(e,t,r,n){var o=new iV(e,r);t.accept(o);var i=o.result,s=new oV(t,e,r).startWalking();return uV([new pP({definition:i}),new pP({definition:s})],n)}function dV(e,t){e:for(var r=0;r<e.length;r++){var n=e[r];if(n.length===t.length){for(var o=0;o<n.length;o++){var i=t[o],s=n[o];if(!1===(i===s||void 0!==s.categoryMatchesMap[i.tokenTypeIdx]))continue e}return!0}}return!1}function pV(e){return FL(e,(function(e){return FL(e,(function(e){return FL(e,(function(e){return aL(e.categoryMatches)}))}))}))}var mV=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},e(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();function gV(e,t,r,n,o,i){var s=hL(e,(function(e){return function(e,t){var r=new wV;e.accept(r);var n=r.allProductions,o=hL(uL(SL(kL(n,fV),(function(e){return e.length>1}))),(function(r){var n=dL(r),o=t.buildDuplicateFoundError(e,r),i=AP(n),s={message:o,type:vH.DUPLICATE_PRODUCTIONS,ruleName:e.name,dslName:i,occurrence:n.idx},a=yV(n);return a&&(s.parameter=a),s}));return o}(e,o)})),a=hL(e,(function(e){return RV(e,e,o)})),l=[],u=[],h=[];FL(a,aL)&&(l=hL(e,(function(e){return function(e,t){var r=new TV;e.accept(r);var n=IL(r.alternations,(function(r,n){var o=hL(EL(n.definition),(function(r,o){return aL(eV([r],[],null,1))?{message:t.buildEmptyAlternationError({topLevelRule:e,alternation:n,emptyChoiceIdx:o}),type:vH.NONE_LAST_EMPTY_ALT,ruleName:e.name,occurrence:n.idx,alternative:o+1}:null}));return r.concat(OL(o))}),[]);return n}(e,o)})),u=hL(e,(function(e){return function(e,t,r,n){var o=new TV;e.accept(o);var i=o.alternations,s=r[e.name];s&&(i=RL(i,(function(e){return s[AP(e)+(0===e.idx?"":e.idx)]})));var a=IL(i=RL(i,(function(e){return!0===e.ignoreAmbiguities})),(function(r,o){var i=o.idx,s=o.maxLookahead||t,a=hV(i,e,s,o),l=function(e,t,r,n){var o=[],i=IL(e,(function(r,n,i){return!0===t.definition[i].ignoreAmbiguities||mL(n,(function(n){var s=[i];mL(e,(function(e,r){i!==r&&dV(e,n)&&!0!==t.definition[r].ignoreAmbiguities&&s.push(r)})),s.length>1&&!dV(o,n)&&(o.push(n),r.push({alts:s,path:n}))})),r}),[]),s=hL(i,(function(e){var o=hL(e.alts,(function(e){return e+1}));return{message:n.buildAlternationAmbiguityError({topLevelRule:r,alternation:t,ambiguityIndices:o,prefixPath:e.path}),type:vH.AMBIGUOUS_ALTS,ruleName:r.name,occurrence:t.idx,alternatives:[e.alts]}}));return s}(a,o,e,n),u=function(e,t,r,n){var o=[],i=IL(e,(function(e,t,r){var n=hL(t,(function(e){return{idx:r,path:e}}));return e.concat(n)}),[]);return mL(i,(function(e){if(!0!==t.definition[e.idx].ignoreAmbiguities){var s=e.idx,a=e.path,l=hL(function(e,t){for(var r=[],n=0;n<e.length;n++){var o=e[n];t.call(null,o)&&r.push(o)}return r}(i,(function(e){return!0!==t.definition[e.idx].ignoreAmbiguities&&e.idx<s&&(r=e.path,n=a,r.length<n.length&&FL(r,(function(e,t){var r=n[t];return e===r||r.categoryMatchesMap[e.tokenTypeIdx]})));var r,n})),(function(e){var o=[e.idx+1,s+1],i=0===t.idx?"":t.idx;return{message:n.buildAlternationPrefixAmbiguityError({topLevelRule:r,alternation:t,ambiguityIndices:o,prefixPath:e.path}),type:vH.AMBIGUOUS_PREFIX_ALTS,ruleName:r.name,occurrence:i,alternatives:o}}));o=o.concat(l)}})),o}(a,o,e,n);return r.concat(l,u)}),[]);return a}(e,t,n,o)})),h=function(e,t,r){var n=[];return mL(e,(function(e){var o=new CV;e.accept(o),mL(o.allProductions,(function(o){var i=function(e){if(e instanceof mP)return rV.OPTION;if(e instanceof yP)return rV.REPETITION;if(e instanceof gP)return rV.REPETITION_MANDATORY;if(e instanceof fP)return rV.REPETITION_MANDATORY_WITH_SEPARATOR;if(e instanceof wP)return rV.REPETITION_WITH_SEPARATOR;if(e instanceof EP)return rV.ALTERNATION;throw Error("non exhaustive match")}(o),s=o.maxLookahead||t;if(aL(cL(cV(o.idx,e,i,s)[0]))){var a=r.buildEmptyRepetitionError({topLevelRule:e,repetition:o});n.push({message:a,type:vH.NO_NON_EMPTY_LOOKAHEAD,ruleName:e.name})}}))})),n}(e,t,o));var c=function(e,t,r){var n=[],o=hL(t,(function(e){return e.name}));return mL(e,(function(e){var t=e.name;if(CL(o,t)){var i=r.buildNamespaceConflictError(e);n.push({message:i,type:vH.CONFLICT_TOKENS_RULES_NAMESPACE,ruleName:t})}})),n}(e,r,o),d=hL(r,(function(e){return function(e,t){var r=[];e.name.match(EV)||r.push({message:t.buildTokenNameError({tokenType:e,expectedPattern:EV}),type:vH.INVALID_TOKEN_NAME});return r}(e,o)})),p=function(e,t){var r=[];return mL(e,(function(e){var n=new zP("");e.accept(n);var o=hL(n.result,(function(e){return e.orgProd}));r.push(hL(o,(function(r){return function(e,t,r){var n,o=[];t.name.match(vV)||(n=r.buildInvalidNestedRuleNameError(e,t),o.push({message:n,type:vH.INVALID_NESTED_RULE_NAME,ruleName:e.name}));return o}(e,r,t)})))})),cL(r)}(e,o),m=function(e,t){var r=[];return mL(e,(function(e){var n=new zP("");e.accept(n),mL(uL(SL(kL(n.result,(function(e){return e.name})),(function(e){return e.length>1}))),(function(n){var o=hL(n,(function(e){return e.orgProd})),i=t.buildDuplicateNestedRuleNameError(e,o);r.push({message:i,type:vH.DUPLICATE_NESTED_NAME,ruleName:e.name})}))})),r}(e,o),g=hL(e,(function(e){return function(e,t){var r=new TV;e.accept(r);var n=IL(r.alternations,(function(r,n){return n.definition.length>255&&r.push({message:t.buildTooManyAlternativesError({topLevelRule:e,alternation:n}),type:vH.TOO_MANY_ALTS,ruleName:e.name,occurrence:n.idx}),r}),[]);return n}(e,o)})),f=hL(e,(function(e){return function(e,t){var r=[],n=e.name;n.match(EV)||r.push({message:t.buildInvalidRuleNameError({topLevelRule:e,expectedPattern:EV}),type:vH.INVALID_RULE_NAME,ruleName:n});return r}(e,o)})),y=hL(e,(function(t){return function(e,t,r,n){var o=[],i=IL(t,(function(t,r){return r.name===e.name?t+1:t}),0);if(i>1){var s=n.buildDuplicateRuleNameError({topLevelRule:e,grammarName:r});o.push({message:s,type:vH.DUPLICATE_RULE_NAME,ruleName:e.name})}return o}(t,e,i,o)}));return cL(s.concat(d,p,m,h,a,l,u,c,g,f,y))}function fV(e){return AP(e)+"_#_"+e.idx+"_#_"+yV(e)}function yV(e){return e instanceof vP?e.terminalType.name:e instanceof cP?e.nonTerminalName:""}var wV=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.allProductions=[],t}return mV(t,e),t.prototype.visitNonTerminal=function(e){this.allProductions.push(e)},t.prototype.visitOption=function(e){this.allProductions.push(e)},t.prototype.visitRepetitionWithSeparator=function(e){this.allProductions.push(e)},t.prototype.visitRepetitionMandatory=function(e){this.allProductions.push(e)},t.prototype.visitRepetitionMandatoryWithSeparator=function(e){this.allProductions.push(e)},t.prototype.visitRepetition=function(e){this.allProductions.push(e)},t.prototype.visitAlternation=function(e){this.allProductions.push(e)},t.prototype.visitTerminal=function(e){this.allProductions.push(e)},t}(CP),EV=/^[a-zA-Z_]\w*$/,vV=new RegExp(EV.source.replace("^","^\\$"));function RV(e,t,r,n){void 0===n&&(n=[]);var o=[],i=SV(t.definition);if(aL(i))return[];var s=e.name;CL(i,e)&&o.push({message:r.buildLeftRecursionError({topLevelRule:e,leftRecursionPath:n}),type:vH.LEFT_RECURSION,ruleName:s});var a=hL(PL(i,n.concat([e])),(function(t){var o=bL(n);return o.push(t),RV(e,t,r,o)}));return o.concat(cL(a))}function SV(e){var t=[];if(aL(e))return t;var r=dL(e);if(r instanceof cP)t.push(r.referencedRule);else if(r instanceof pP||r instanceof mP||r instanceof gP||r instanceof fP||r instanceof wP||r instanceof yP)t=t.concat(SV(r.definition));else if(r instanceof EP)t=cL(hL(r.definition,(function(e){return SV(e.definition)})));else if(!(r instanceof vP))throw Error("non exhaustive match");var n=NP(r),o=e.length>1;if(n&&o){var i=wL(e);return t.concat(SV(i))}return t}var TV=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.alternations=[],t}return mV(t,e),t.prototype.visitAlternation=function(e){this.alternations.push(e)},t}(CP);var CV=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.allProductions=[],t}return mV(t,e),t.prototype.visitRepetitionWithSeparator=function(e){this.allProductions.push(e)},t.prototype.visitRepetitionMandatory=function(e){this.allProductions.push(e)},t.prototype.visitRepetitionMandatoryWithSeparator=function(e){this.allProductions.push(e)},t.prototype.visitRepetition=function(e){this.allProductions.push(e)},t}(CP);var bV={buildMismatchTokenMessage:function(e){var t=e.expected,r=e.actual;return e.previous,e.ruleName,"Expecting "+(KF(t)?"--\x3e "+XF(t)+" <--":"token of type --\x3e "+t.name+" <--")+" but found --\x3e '"+r.image+"' <--"},buildNotAllInputParsedMessage:function(e){var t=e.firstRedundant;return e.ruleName,"Redundant input, expecting EOF but found: "+t.image},buildNoViableAltMessage:function(e){var t=e.expectedPathsPerAlt,r=e.actual;e.previous;var n=e.customUserDescription;e.ruleName;var o="Expecting: ",i="\nbut found: '"+dL(r).image+"'";if(n)return o+n+i;var s=hL(IL(t,(function(e,t){return e.concat(t)}),[]),(function(e){return"["+hL(e,(function(e){return XF(e)})).join(", ")+"]"}));return o+("one of these possible Token sequences:\n"+hL(s,(function(e,t){return"  "+(t+1)+". "+e})).join("\n"))+i},buildEarlyExitMessage:function(e){var t=e.expectedIterationPaths,r=e.actual,n=e.customUserDescription;e.ruleName;var o="Expecting: ",i="\nbut found: '"+dL(r).image+"'";return n?o+n+i:o+("expecting at least one iteration which starts with one of these possible Token sequences::\n  <"+hL(t,(function(e){return"["+hL(e,(function(e){return XF(e)})).join(",")+"]"})).join(" ,")+">")+i}};Object.freeze(bV);var NV={buildRuleNotFoundError:function(e,t){return"Invalid grammar, reference to a rule which is not defined: ->"+t.nonTerminalName+"<-\ninside top level rule: ->"+e.name+"<-"}},AV={buildDuplicateFoundError:function(e,t){var r,n=e.name,o=dL(t),i=o.idx,s=AP(o),a=(r=o)instanceof vP?r.terminalType.name:r instanceof cP?r.nonTerminalName:"",l="->"+s+(i>0?i:"")+"<- "+(a?"with argument: ->"+a+"<-":"")+"\n                  appears more than once ("+t.length+" times) in the top level rule: ->"+n+"<-.                  \n                  For further details see: https://sap.github.io/chevrotain/docs/FAQ.html#NUMERICAL_SUFFIXES \n                  ";return l=(l=l.replace(/[ \t]+/g," ")).replace(/\s\s+/g,"\n")},buildInvalidNestedRuleNameError:function(e,t){return"Invalid nested rule name: ->"+t.name+"<- inside rule: ->"+e.name+"<-\nit must match the pattern: ->"+vV.toString()+"<-.\nNote that this means a nested rule name must start with the '$'(dollar) sign."},buildDuplicateNestedRuleNameError:function(e,t){return"Duplicate nested rule name: ->"+dL(t).name+"<- inside rule: ->"+e.name+"<-\nA nested name must be unique in the scope of a top level grammar rule."},buildNamespaceConflictError:function(e){return"Namespace conflict found in grammar.\nThe grammar has both a Terminal(Token) and a Non-Terminal(Rule) named: <"+e.name+">.\nTo resolve this make sure each Terminal and Non-Terminal names are unique\nThis is easy to accomplish by using the convention that Terminal names start with an uppercase letter\nand Non-Terminal names start with a lower case letter."},buildAlternationPrefixAmbiguityError:function(e){var t=hL(e.prefixPath,(function(e){return XF(e)})).join(", "),r=0===e.alternation.idx?"":e.alternation.idx;return"Ambiguous alternatives: <"+e.ambiguityIndices.join(" ,")+"> due to common lookahead prefix\nin <OR"+r+"> inside <"+e.topLevelRule.name+"> Rule,\n<"+t+"> may appears as a prefix path in all these alternatives.\nSee: https://sap.github.io/chevrotain/docs/guide/resolving_grammar_errors.html#COMMON_PREFIX\nFor Further details."},buildAlternationAmbiguityError:function(e){var t=hL(e.prefixPath,(function(e){return XF(e)})).join(", "),r=0===e.alternation.idx?"":e.alternation.idx,n="Ambiguous Alternatives Detected: <"+e.ambiguityIndices.join(" ,")+"> in <OR"+r+"> inside <"+e.topLevelRule.name+"> Rule,\n<"+t+"> may appears as a prefix path in all these alternatives.\n";return n+="See: https://sap.github.io/chevrotain/docs/guide/resolving_grammar_errors.html#AMBIGUOUS_ALTERNATIVES\nFor Further details."},buildEmptyRepetitionError:function(e){var t=AP(e.repetition);return 0!==e.repetition.idx&&(t+=e.repetition.idx),"The repetition <"+t+"> within Rule <"+e.topLevelRule.name+"> can never consume any tokens.\nThis could lead to an infinite loop."},buildTokenNameError:function(e){return"Invalid Grammar Token name: ->"+e.tokenType.name+"<- it must match the pattern: ->"+e.expectedPattern.toString()+"<-"},buildEmptyAlternationError:function(e){return"Ambiguous empty alternative: <"+(e.emptyChoiceIdx+1)+"> in <OR"+e.alternation.idx+"> inside <"+e.topLevelRule.name+"> Rule.\nOnly the last alternative may be an empty alternative."},buildTooManyAlternativesError:function(e){return"An Alternation cannot have more than 256 alternatives:\n<OR"+e.alternation.idx+"> inside <"+e.topLevelRule.name+"> Rule.\n has "+(e.alternation.definition.length+1)+" alternatives."},buildLeftRecursionError:function(e){var t=e.topLevelRule.name;return"Left Recursion found in grammar.\nrule: <"+t+"> can be invoked from itself (directly or indirectly)\nwithout consuming any Tokens. The grammar path that causes this is: \n "+(t+" --\x3e "+hL(e.leftRecursionPath,(function(e){return e.name})).concat([t]).join(" --\x3e "))+"\n To fix this refactor your grammar to remove the left recursion.\nsee: https://en.wikipedia.org/wiki/LL_parser#Left_Factoring."},buildInvalidRuleNameError:function(e){return"Invalid grammar rule name: ->"+e.topLevelRule.name+"<- it must match the pattern: ->"+e.expectedPattern.toString()+"<-"},buildDuplicateRuleNameError:function(e){return"Duplicate definition, rule: ->"+(e.topLevelRule instanceof dP?e.topLevelRule.name:e.topLevelRule)+"<- is already defined in the grammar: ->"+e.grammarName+"<-"}},IV=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},e(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();var OV=function(e){function t(t,r){var n=e.call(this)||this;return n.nameToTopRule=t,n.errMsgProvider=r,n.errors=[],n}return IV(t,e),t.prototype.resolveRefs=function(){var e=this;mL(uL(this.nameToTopRule),(function(t){e.currTopLevel=t,t.accept(e)}))},t.prototype.visitNonTerminal=function(e){var t=this.nameToTopRule[e.nonTerminalName];if(t)e.referencedRule=t;else{var r=this.errMsgProvider.buildRuleNotFoundError(this.currTopLevel,e);this.errors.push({message:r,type:vH.UNRESOLVED_SUBRULE_REF,ruleName:this.currTopLevel.name,unresolvedRefName:e.nonTerminalName})}},t}(CP);function MV(e){e=UL(e,{errMsgProvider:NV});var t,r,n,o={};return mL(e.rules,(function(e){o[e.name]=e})),t=o,r=e.errMsgProvider,(n=new OV(t,r)).resolveRefs(),n.errors}var _V="MismatchedTokenException",xV="NoViableAltException",LV="EarlyExitException",FV="NotAllInputParsedException",PV=[_V,xV,LV,FV];function VV(e){return CL(PV,e.name)}function HV(e,t,r){this.name=_V,this.message=e,this.token=t,this.previousToken=r,this.resyncedTokens=[]}function DV(e,t,r){this.name=xV,this.message=e,this.token=t,this.previousToken=r,this.resyncedTokens=[]}function UV(e,t){this.name=FV,this.message=e,this.token=t,this.resyncedTokens=[]}function kV(e,t,r){this.name=LV,this.message=e,this.token=t,this.previousToken=r,this.resyncedTokens=[]}Object.freeze(PV),HV.prototype=Error.prototype,DV.prototype=Error.prototype,UV.prototype=Error.prototype,kV.prototype=Error.prototype;var BV={},WV="InRuleRecoveryException";function GV(e){this.name=WV,this.message=e}GV.prototype=Error.prototype;var jV=function(){function e(){}return e.prototype.initRecoverable=function(e){this.firstAfterRepMap={},this.resyncFollows={},this.recoveryEnabled=TL(e,"recoveryEnabled")?e.recoveryEnabled:RH.recoveryEnabled,this.recoveryEnabled&&(this.attemptInRepetitionRecovery=zV)},e.prototype.getTokenToInsert=function(e){var t=aP(e,"",NaN,NaN,NaN,NaN,NaN,NaN);return t.isInsertedInRecovery=!0,t},e.prototype.canTokenTypeBeInsertedInRecovery=function(e){return!0},e.prototype.tryInRepetitionRecovery=function(e,t,r,n){for(var o=this,i=this.findReSyncTokenType(),s=this.exportLexerState(),a=[],l=!1,u=this.LA(1),h=this.LA(1),c=function(){var e=o.LA(0),t=new HV(o.errorMessageProvider.buildMismatchTokenMessage({expected:n,actual:u,previous:e,ruleName:o.getCurrRuleFullName()}),u,o.LA(0));t.resyncedTokens=EL(a),o.SAVE_ERROR(t)};!l;){if(this.tokenMatcher(h,n))return void c();if(r.call(this))return c(),void e.apply(this,t);this.tokenMatcher(h,i)?l=!0:(h=this.SKIP_TOKEN(),this.addToResyncTokens(h,a))}this.importLexerState(s)},e.prototype.shouldInRepetitionRecoveryBeTried=function(e,t,r){return!1!==r&&(void 0!==e&&void 0!==t&&(!this.tokenMatcher(this.LA(1),e)&&(!this.isBackTracking()&&!this.canPerformInRuleRecovery(e,this.getFollowsForInRuleRecovery(e,t)))))},e.prototype.getFollowsForInRuleRecovery=function(e,t){var r=this.getCurrentGrammarPath(e,t);return this.getNextPossibleTokenTypes(r)},e.prototype.tryInRuleRecovery=function(e,t){if(this.canRecoverWithSingleTokenInsertion(e,t))return this.getTokenToInsert(e);if(this.canRecoverWithSingleTokenDeletion(e)){var r=this.SKIP_TOKEN();return this.consumeToken(),r}throw new GV("sad sad panda")},e.prototype.canPerformInRuleRecovery=function(e,t){return this.canRecoverWithSingleTokenInsertion(e,t)||this.canRecoverWithSingleTokenDeletion(e)},e.prototype.canRecoverWithSingleTokenInsertion=function(e,t){var r=this;if(!this.canTokenTypeBeInsertedInRecovery(e))return!1;if(aL(t))return!1;var n=this.LA(1);return void 0!==AL(t,(function(e){return r.tokenMatcher(n,e)}))},e.prototype.canRecoverWithSingleTokenDeletion=function(e){return this.tokenMatcher(this.LA(2),e)},e.prototype.isInCurrentRuleReSyncSet=function(e){var t=this.getCurrFollowKey();return CL(this.getFollowSetFromFollowKey(t),e)},e.prototype.findReSyncTokenType=function(){for(var e=this.flattenFollowSet(),t=this.LA(1),r=2;;){var n=t.tokenType;if(CL(e,n))return n;t=this.LA(r),r++}},e.prototype.getCurrFollowKey=function(){if(1===this.RULE_STACK.length)return BV;var e=this.getLastExplicitRuleShortName(),t=this.getLastExplicitRuleOccurrenceIndex(),r=this.getPreviousExplicitRuleShortName();return{ruleName:this.shortRuleNameToFullName(e),idxInCallingRule:t,inRule:this.shortRuleNameToFullName(r)}},e.prototype.buildFullFollowKeyStack=function(){var e=this,t=this.RULE_STACK,r=this.RULE_OCCURRENCE_STACK;return aL(this.LAST_EXPLICIT_RULE_STACK)||(t=hL(this.LAST_EXPLICIT_RULE_STACK,(function(t){return e.RULE_STACK[t]})),r=hL(this.LAST_EXPLICIT_RULE_STACK,(function(t){return e.RULE_OCCURRENCE_STACK[t]}))),hL(t,(function(n,o){return 0===o?BV:{ruleName:e.shortRuleNameToFullName(n),idxInCallingRule:r[o],inRule:e.shortRuleNameToFullName(t[o-1])}}))},e.prototype.flattenFollowSet=function(){var e=this;return cL(hL(this.buildFullFollowKeyStack(),(function(t){return e.getFollowSetFromFollowKey(t)})))},e.prototype.getFollowSetFromFollowKey=function(e){if(e===BV)return[sP];var t=e.ruleName+e.idxInCallingRule+MP+e.inRule;return this.resyncFollows[t]},e.prototype.addToResyncTokens=function(e,t){return this.tokenMatcher(e,sP)||t.push(e),t},e.prototype.reSyncTo=function(e){for(var t=[],r=this.LA(1);!1===this.tokenMatcher(r,e);)r=this.SKIP_TOKEN(),this.addToResyncTokens(r,t);return EL(t)},e.prototype.attemptInRepetitionRecovery=function(e,t,r,n,o,i,s){},e.prototype.getCurrentGrammarPath=function(e,t){return{ruleStack:this.getHumanReadableRuleStack(),occurrenceStack:bL(this.RULE_OCCURRENCE_STACK),lastTok:e,lastTokOccurrence:t}},e.prototype.getHumanReadableRuleStack=function(){var e=this;return aL(this.LAST_EXPLICIT_RULE_STACK)?hL(this.RULE_STACK,(function(t){return e.shortRuleNameToFullName(t)})):hL(this.LAST_EXPLICIT_RULE_STACK,(function(t){return e.shortRuleNameToFullName(e.RULE_STACK[t])}))},e}();function zV(e,t,r,n,o,i,s){var a=this.getKeyForAutomaticLookahead(n,o),l=this.firstAfterRepMap[a];if(void 0===l){var u=this.getCurrRuleFullName();l=new i(this.getGAstProductions()[u],o).startWalking(),this.firstAfterRepMap[a]=l}var h=l.token,c=l.occurrence,d=l.isEndOfRule;1===this.RULE_STACK.length&&d&&void 0===h&&(h=sP,c=1),this.shouldInRepetitionRecoveryBeTried(h,c,s)&&this.tryInRepetitionRecovery(e,t,r,h)}var $V=function(){function e(){}return e.prototype.initLooksAhead=function(e){this.dynamicTokensEnabled=TL(e,"dynamicTokensEnabled")?e.dynamicTokensEnabled:RH.dynamicTokensEnabled,this.maxLookahead=TL(e,"maxLookahead")?e.maxLookahead:RH.maxLookahead,this.lookAheadFuncsCache=$L()?new Map:[],$L()?(this.getLaFuncFromCache=this.getLaFuncFromMap,this.setLaFuncCache=this.setLaFuncCacheUsingMap):(this.getLaFuncFromCache=this.getLaFuncFromObj,this.setLaFuncCache=this.setLaFuncUsingObj)},e.prototype.preComputeLookaheadFunctions=function(e){var t=this;mL(e,(function(e){t.TRACE_INIT(e.name+" Rule Lookahead",(function(){var r=function(e){IP.reset(),e.accept(IP);var t=IP.dslMethods;return IP.reset(),t}(e),n=r.alternation,o=r.repetition,i=r.option,s=r.repetitionMandatory,a=r.repetitionMandatoryWithSeparator,l=r.repetitionWithSeparator;mL(n,(function(r){var n=0===r.idx?"":r.idx;t.TRACE_INIT(""+AP(r)+n,(function(){var n,o,i,s,a,l,u,h=(n=r.idx,o=e,i=r.maxLookahead||t.maxLookahead,s=r.hasPredicates,a=t.dynamicTokensEnabled,l=t.lookAheadBuilderForAlternatives,u=hV(n,o,i),l(u,s,pV(u)?HF:VF,a)),c=UP(t.fullRuleNameToShort[e.name],LP,r.idx);t.setLaFuncCache(c,h)}))})),mL(o,(function(r){t.computeLookaheadFunc(e,r.idx,PP,rV.REPETITION,r.maxLookahead,AP(r))})),mL(i,(function(r){t.computeLookaheadFunc(e,r.idx,FP,rV.OPTION,r.maxLookahead,AP(r))})),mL(s,(function(r){t.computeLookaheadFunc(e,r.idx,VP,rV.REPETITION_MANDATORY,r.maxLookahead,AP(r))})),mL(a,(function(r){t.computeLookaheadFunc(e,r.idx,DP,rV.REPETITION_MANDATORY_WITH_SEPARATOR,r.maxLookahead,AP(r))})),mL(l,(function(r){t.computeLookaheadFunc(e,r.idx,HP,rV.REPETITION_WITH_SEPARATOR,r.maxLookahead,AP(r))}))}))}))},e.prototype.computeLookaheadFunc=function(e,t,r,n,o,i){var s=this;this.TRACE_INIT(""+i+(0===t?"":t),(function(){var i=function(e,t,r,n,o,i){var s=cV(e,t,o,r),a=pV(s)?HF:VF;return i(s[0],a,n)}(t,e,o||s.maxLookahead,s.dynamicTokensEnabled,n,s.lookAheadBuilderForOptional),a=UP(s.fullRuleNameToShort[e.name],r,t);s.setLaFuncCache(a,i)}))},e.prototype.lookAheadBuilderForOptional=function(e,t,r){return function(e,t,r){var n=FL(e,(function(e){return 1===e.length})),o=e.length;if(n&&!r){var i=cL(e);if(1===i.length&&aL(i[0].categoryMatches)){var s=i[0].tokenTypeIdx;return function(){return this.LA(1).tokenTypeIdx===s}}var a=IL(i,(function(e,t,r){return e[t.tokenTypeIdx]=!0,mL(t.categoryMatches,(function(t){e[t]=!0})),e}),[]);return function(){var e=this.LA(1);return!0===a[e.tokenTypeIdx]}}return function(){e:for(var r=0;r<o;r++){for(var n=e[r],i=n.length,s=0;s<i;s++){var a=this.LA(s+1);if(!1===t(a,n[s]))continue e}return!0}return!1}}(e,t,r)},e.prototype.lookAheadBuilderForAlternatives=function(e,t,r,n){return function(e,t,r,n){var o=e.length,i=FL(e,(function(e){return FL(e,(function(e){return 1===e.length}))}));if(t)return function(t){for(var n=hL(t,(function(e){return e.GATE})),i=0;i<o;i++){var s=e[i],a=s.length,l=n[i];if(void 0===l||!1!==l.call(this))e:for(var u=0;u<a;u++){for(var h=s[u],c=h.length,d=0;d<c;d++){var p=this.LA(d+1);if(!1===r(p,h[d]))continue e}return i}}};if(i&&!n){var s=IL(hL(e,(function(e){return cL(e)})),(function(e,t,r){return mL(t,(function(t){TL(e,t.tokenTypeIdx)||(e[t.tokenTypeIdx]=r),mL(t.categoryMatches,(function(t){TL(e,t)||(e[t]=r)}))})),e}),[]);return function(){var e=this.LA(1);return s[e.tokenTypeIdx]}}return function(){for(var t=0;t<o;t++){var n=e[t],i=n.length;e:for(var s=0;s<i;s++){for(var a=n[s],l=a.length,u=0;u<l;u++){var h=this.LA(u+1);if(!1===r(h,a[u]))continue e}return t}}}}(e,t,r,n)},e.prototype.getKeyForAutomaticLookahead=function(e,t){return UP(this.getLastExplicitRuleShortName(),e,t)},e.prototype.getLaFuncFromCache=function(e){},e.prototype.getLaFuncFromMap=function(e){return this.lookAheadFuncsCache.get(e)},e.prototype.getLaFuncFromObj=function(e){return this.lookAheadFuncsCache[e]},e.prototype.setLaFuncCache=function(e,t){},e.prototype.setLaFuncCacheUsingMap=function(e,t){this.lookAheadFuncsCache.set(e,t)},e.prototype.setLaFuncUsingObj=function(e,t){this.lookAheadFuncsCache[e]=t},e}();var YV,XV=/^\s*function\s*(\S*)\s*\(/,KV="name";function qV(e){var t=e.name;return t||e.toString().match(XV)[1]}function QV(e,t){var r=Object.getOwnPropertyDescriptor(e,KV);return!(!fL(r)&&!r.configurable)&&(Object.defineProperty(e,KV,{enumerable:!1,configurable:!0,writable:!1,value:t}),!0)}function ZV(e,t){for(var r=lL(e),n=r.length,o=0;o<n;o++)for(var i=e[r[o]],s=i.length,a=0;a<s;a++){var l=i[a];void 0===l.tokenTypeIdx&&(void 0!==l.fullName?this[l.fullName](l.children,t):this[l.name](l.children,t))}}function JV(e,t){var r=function(){};QV(r,e+"BaseSemantics");var n={visit:function(e,t){if(_L(e)&&(e=e[0]),!fL(e))return void 0!==e.fullName?this[e.fullName](e.children,t):this[e.name](e.children,t)},validateVisitor:function(){var e=function(e,t){var r=function(e,t){var r=hL(t,(function(t){if(!yL(e[t]))return{msg:"Missing visitor method: <"+t+"> on "+qV(e.constructor)+" CST Visitor.",type:YV.MISSING_METHOD,methodName:t}}));return OL(r)}(e,t),n=function(e,t){var r=[];for(var n in e)EV.test(n)&&yL(e[n])&&!CL(eH,n)&&!CL(t,n)&&r.push({msg:"Redundant visitor method: <"+n+"> on "+qV(e.constructor)+" CST Visitor\nThere is no Grammar Rule corresponding to this method's name.\nFor utility methods on visitor classes use methods names that do not match /"+EV.source+"/.",type:YV.REDUNDANT_METHOD,methodName:n});return r}(e,t);return r.concat(n)}(this,t);if(!aL(e)){var r=hL(e,(function(e){return e.msg}));throw Error("Errors Detected in CST Visitor <"+qV(this.constructor)+">:\n\t"+r.join("\n\n").replace(/\n/g,"\n\t"))}}};return(r.prototype=n).constructor=r,r._RULE_NAMES=t,r}!function(e){e[e.REDUNDANT_METHOD=0]="REDUNDANT_METHOD",e[e.MISSING_METHOD=1]="MISSING_METHOD"}(YV||(YV={}));var eH=["constructor","visit","validateVisitor"];var tH=function(){function e(){}return e.prototype.initTreeBuilder=function(e){if(this.LAST_EXPLICIT_RULE_STACK=[],this.CST_STACK=[],this.outputCst=TL(e,"outputCst")?e.outputCst:RH.outputCst,this.nodeLocationTracking=TL(e,"nodeLocationTracking")?e.nodeLocationTracking:RH.nodeLocationTracking,this.outputCst)if(/full/i.test(this.nodeLocationTracking))this.recoveryEnabled?(this.setNodeLocationFromToken=GP,this.setNodeLocationFromNode=GP,this.cstPostRule=WL,this.setInitialNodeLocation=this.setInitialNodeLocationFullRecovery):(this.setNodeLocationFromToken=WL,this.setNodeLocationFromNode=WL,this.cstPostRule=this.cstPostRuleFull,this.setInitialNodeLocation=this.setInitialNodeLocationFullRegular);else if(/onlyOffset/i.test(this.nodeLocationTracking))this.recoveryEnabled?(this.setNodeLocationFromToken=WP,this.setNodeLocationFromNode=WP,this.cstPostRule=WL,this.setInitialNodeLocation=this.setInitialNodeLocationOnlyOffsetRecovery):(this.setNodeLocationFromToken=WL,this.setNodeLocationFromNode=WL,this.cstPostRule=this.cstPostRuleOnlyOffset,this.setInitialNodeLocation=this.setInitialNodeLocationOnlyOffsetRegular);else{if(!/none/i.test(this.nodeLocationTracking))throw Error('Invalid <nodeLocationTracking> config option: "'+e.nodeLocationTracking+'"');this.setNodeLocationFromToken=WL,this.setNodeLocationFromNode=WL,this.cstPostRule=WL,this.setInitialNodeLocation=WL}else this.cstInvocationStateUpdate=WL,this.cstFinallyStateUpdate=WL,this.cstPostTerminal=WL,this.cstPostNonTerminal=WL,this.cstPostRule=WL,this.getLastExplicitRuleShortName=this.getLastExplicitRuleShortNameNoCst,this.getPreviousExplicitRuleShortName=this.getPreviousExplicitRuleShortNameNoCst,this.getLastExplicitRuleOccurrenceIndex=this.getLastExplicitRuleOccurrenceIndexNoCst,this.manyInternal=this.manyInternalNoCst,this.orInternal=this.orInternalNoCst,this.optionInternal=this.optionInternalNoCst,this.atLeastOneInternal=this.atLeastOneInternalNoCst,this.manySepFirstInternal=this.manySepFirstInternalNoCst,this.atLeastOneSepFirstInternal=this.atLeastOneSepFirstInternalNoCst},e.prototype.setInitialNodeLocationOnlyOffsetRecovery=function(e){e.location={startOffset:NaN,endOffset:NaN}},e.prototype.setInitialNodeLocationOnlyOffsetRegular=function(e){e.location={startOffset:this.LA(1).startOffset,endOffset:NaN}},e.prototype.setInitialNodeLocationFullRecovery=function(e){e.location={startOffset:NaN,startLine:NaN,startColumn:NaN,endOffset:NaN,endLine:NaN,endColumn:NaN}},e.prototype.setInitialNodeLocationFullRegular=function(e){var t=this.LA(1);e.location={startOffset:t.startOffset,startLine:t.startLine,startColumn:t.startColumn,endOffset:NaN,endLine:NaN,endColumn:NaN}},e.prototype.cstNestedInvocationStateUpdate=function(e,t){var r={name:e,fullName:this.shortRuleNameToFull[this.getLastExplicitRuleShortName()]+e,children:{}};this.setInitialNodeLocation(r),this.CST_STACK.push(r)},e.prototype.cstInvocationStateUpdate=function(e,t){this.LAST_EXPLICIT_RULE_STACK.push(this.RULE_STACK.length-1);var r={name:e,children:{}};this.setInitialNodeLocation(r),this.CST_STACK.push(r)},e.prototype.cstFinallyStateUpdate=function(){this.LAST_EXPLICIT_RULE_STACK.pop(),this.CST_STACK.pop()},e.prototype.cstNestedFinallyStateUpdate=function(){var e=this.CST_STACK.pop();this.cstPostRule(e)},e.prototype.cstPostRuleFull=function(e){var t=this.LA(0),r=e.location;r.startOffset<=t.startOffset==!0?(r.endOffset=t.endOffset,r.endLine=t.endLine,r.endColumn=t.endColumn):(r.startOffset=NaN,r.startLine=NaN,r.startColumn=NaN)},e.prototype.cstPostRuleOnlyOffset=function(e){var t=this.LA(0),r=e.location;r.startOffset<=t.startOffset==!0?r.endOffset=t.endOffset:r.startOffset=NaN},e.prototype.cstPostTerminal=function(e,t){var r,n,o,i=this.CST_STACK[this.CST_STACK.length-1];n=t,o=e,void 0===(r=i).children[o]?r.children[o]=[n]:r.children[o].push(n),this.setNodeLocationFromToken(i.location,t)},e.prototype.cstPostNonTerminal=function(e,t){if(!0!==this.isBackTracking()){var r=this.CST_STACK[this.CST_STACK.length-1];jP(r,t,e),this.setNodeLocationFromNode(r.location,e.location)}},e.prototype.getBaseCstVisitorConstructor=function(){if(fL(this.baseCstVisitorConstructor)){var e=JV(this.className,this.allRuleNames);return this.baseCstVisitorConstructor=e,e}return this.baseCstVisitorConstructor},e.prototype.getBaseCstVisitorConstructorWithDefaults=function(){if(fL(this.baseCstVisitorWithDefaultsConstructor)){var e=function(e,t,r){var n=function(){};QV(n,e+"BaseSemanticsWithDefaults");var o=Object.create(r.prototype);return mL(t,(function(e){o[e]=ZV})),(n.prototype=o).constructor=n,n}(this.className,this.allRuleNames,this.getBaseCstVisitorConstructor());return this.baseCstVisitorWithDefaultsConstructor=e,e}return this.baseCstVisitorWithDefaultsConstructor},e.prototype.nestedRuleBeforeClause=function(e,t){var r;return void 0!==e.NAME?(r=e.NAME,this.nestedRuleInvocationStateUpdate(r,t),r):void 0},e.prototype.nestedAltBeforeClause=function(e,t,r,n){var o,i=kP(this.getLastExplicitRuleShortName(),r,t,n);return void 0!==e.NAME?(o=e.NAME,this.nestedRuleInvocationStateUpdate(o,i),{shortName:i,nestedName:o}):void 0},e.prototype.nestedRuleFinallyClause=function(e,t){var r=this.CST_STACK,n=r[r.length-1];this.nestedRuleFinallyStateUpdate();var o=r[r.length-1];jP(o,t,n),this.setNodeLocationFromNode(o.location,n.location)},e.prototype.getLastExplicitRuleShortName=function(){var e=this.LAST_EXPLICIT_RULE_STACK[this.LAST_EXPLICIT_RULE_STACK.length-1];return this.RULE_STACK[e]},e.prototype.getLastExplicitRuleShortNameNoCst=function(){var e=this.RULE_STACK;return e[e.length-1]},e.prototype.getPreviousExplicitRuleShortName=function(){var e=this.LAST_EXPLICIT_RULE_STACK[this.LAST_EXPLICIT_RULE_STACK.length-2];return this.RULE_STACK[e]},e.prototype.getPreviousExplicitRuleShortNameNoCst=function(){var e=this.RULE_STACK;return e[e.length-2]},e.prototype.getLastExplicitRuleOccurrenceIndex=function(){var e=this.LAST_EXPLICIT_RULE_STACK[this.LAST_EXPLICIT_RULE_STACK.length-1];return this.RULE_OCCURRENCE_STACK[e]},e.prototype.getLastExplicitRuleOccurrenceIndexNoCst=function(){var e=this.RULE_OCCURRENCE_STACK;return e[e.length-1]},e.prototype.nestedRuleInvocationStateUpdate=function(e,t){this.RULE_OCCURRENCE_STACK.push(1),this.RULE_STACK.push(t),this.cstNestedInvocationStateUpdate(e,t)},e.prototype.nestedRuleFinallyStateUpdate=function(){this.RULE_STACK.pop(),this.RULE_OCCURRENCE_STACK.pop(),this.cstNestedFinallyStateUpdate()},e}(),rH=function(){function e(){}return e.prototype.initLexerAdapter=function(){this.tokVector=[],this.tokVectorLength=0,this.currIdx=-1},Object.defineProperty(e.prototype,"input",{get:function(){return this.tokVector},set:function(e){if(!0!==this.selfAnalysisDone)throw Error("Missing <performSelfAnalysis> invocation at the end of the Parser's constructor.");this.reset(),this.tokVector=e,this.tokVectorLength=e.length},enumerable:!0,configurable:!0}),e.prototype.SKIP_TOKEN=function(){return this.currIdx<=this.tokVector.length-2?(this.consumeToken(),this.LA(1)):EH},e.prototype.LA=function(e){var t=this.currIdx+e;return t<0||this.tokVectorLength<=t?EH:this.tokVector[t]},e.prototype.consumeToken=function(){this.currIdx++},e.prototype.exportLexerState=function(){return this.currIdx},e.prototype.importLexerState=function(e){this.currIdx=e},e.prototype.resetLexerState=function(){this.currIdx=-1},e.prototype.moveToTerminatedState=function(){this.currIdx=this.tokVector.length-1},e.prototype.getLexerPosition=function(){return this.exportLexerState()},e}(),nH=function(){function e(){}return e.prototype.ACTION=function(e){return e.call(this)},e.prototype.consume=function(e,t,r){return this.consumeInternal(t,e,r)},e.prototype.subrule=function(e,t,r){return this.subruleInternal(t,e,r)},e.prototype.option=function(e,t){return this.optionInternal(t,e)},e.prototype.or=function(e,t){return this.orInternal(t,e)},e.prototype.many=function(e,t){return this.manyInternal(e,t)},e.prototype.atLeastOne=function(e,t){return this.atLeastOneInternal(e,t)},e.prototype.CONSUME=function(e,t){return this.consumeInternal(e,0,t)},e.prototype.CONSUME1=function(e,t){return this.consumeInternal(e,1,t)},e.prototype.CONSUME2=function(e,t){return this.consumeInternal(e,2,t)},e.prototype.CONSUME3=function(e,t){return this.consumeInternal(e,3,t)},e.prototype.CONSUME4=function(e,t){return this.consumeInternal(e,4,t)},e.prototype.CONSUME5=function(e,t){return this.consumeInternal(e,5,t)},e.prototype.CONSUME6=function(e,t){return this.consumeInternal(e,6,t)},e.prototype.CONSUME7=function(e,t){return this.consumeInternal(e,7,t)},e.prototype.CONSUME8=function(e,t){return this.consumeInternal(e,8,t)},e.prototype.CONSUME9=function(e,t){return this.consumeInternal(e,9,t)},e.prototype.SUBRULE=function(e,t){return this.subruleInternal(e,0,t)},e.prototype.SUBRULE1=function(e,t){return this.subruleInternal(e,1,t)},e.prototype.SUBRULE2=function(e,t){return this.subruleInternal(e,2,t)},e.prototype.SUBRULE3=function(e,t){return this.subruleInternal(e,3,t)},e.prototype.SUBRULE4=function(e,t){return this.subruleInternal(e,4,t)},e.prototype.SUBRULE5=function(e,t){return this.subruleInternal(e,5,t)},e.prototype.SUBRULE6=function(e,t){return this.subruleInternal(e,6,t)},e.prototype.SUBRULE7=function(e,t){return this.subruleInternal(e,7,t)},e.prototype.SUBRULE8=function(e,t){return this.subruleInternal(e,8,t)},e.prototype.SUBRULE9=function(e,t){return this.subruleInternal(e,9,t)},e.prototype.OPTION=function(e){return this.optionInternal(e,0)},e.prototype.OPTION1=function(e){return this.optionInternal(e,1)},e.prototype.OPTION2=function(e){return this.optionInternal(e,2)},e.prototype.OPTION3=function(e){return this.optionInternal(e,3)},e.prototype.OPTION4=function(e){return this.optionInternal(e,4)},e.prototype.OPTION5=function(e){return this.optionInternal(e,5)},e.prototype.OPTION6=function(e){return this.optionInternal(e,6)},e.prototype.OPTION7=function(e){return this.optionInternal(e,7)},e.prototype.OPTION8=function(e){return this.optionInternal(e,8)},e.prototype.OPTION9=function(e){return this.optionInternal(e,9)},e.prototype.OR=function(e){return this.orInternal(e,0)},e.prototype.OR1=function(e){return this.orInternal(e,1)},e.prototype.OR2=function(e){return this.orInternal(e,2)},e.prototype.OR3=function(e){return this.orInternal(e,3)},e.prototype.OR4=function(e){return this.orInternal(e,4)},e.prototype.OR5=function(e){return this.orInternal(e,5)},e.prototype.OR6=function(e){return this.orInternal(e,6)},e.prototype.OR7=function(e){return this.orInternal(e,7)},e.prototype.OR8=function(e){return this.orInternal(e,8)},e.prototype.OR9=function(e){return this.orInternal(e,9)},e.prototype.MANY=function(e){this.manyInternal(0,e)},e.prototype.MANY1=function(e){this.manyInternal(1,e)},e.prototype.MANY2=function(e){this.manyInternal(2,e)},e.prototype.MANY3=function(e){this.manyInternal(3,e)},e.prototype.MANY4=function(e){this.manyInternal(4,e)},e.prototype.MANY5=function(e){this.manyInternal(5,e)},e.prototype.MANY6=function(e){this.manyInternal(6,e)},e.prototype.MANY7=function(e){this.manyInternal(7,e)},e.prototype.MANY8=function(e){this.manyInternal(8,e)},e.prototype.MANY9=function(e){this.manyInternal(9,e)},e.prototype.MANY_SEP=function(e){this.manySepFirstInternal(0,e)},e.prototype.MANY_SEP1=function(e){this.manySepFirstInternal(1,e)},e.prototype.MANY_SEP2=function(e){this.manySepFirstInternal(2,e)},e.prototype.MANY_SEP3=function(e){this.manySepFirstInternal(3,e)},e.prototype.MANY_SEP4=function(e){this.manySepFirstInternal(4,e)},e.prototype.MANY_SEP5=function(e){this.manySepFirstInternal(5,e)},e.prototype.MANY_SEP6=function(e){this.manySepFirstInternal(6,e)},e.prototype.MANY_SEP7=function(e){this.manySepFirstInternal(7,e)},e.prototype.MANY_SEP8=function(e){this.manySepFirstInternal(8,e)},e.prototype.MANY_SEP9=function(e){this.manySepFirstInternal(9,e)},e.prototype.AT_LEAST_ONE=function(e){this.atLeastOneInternal(0,e)},e.prototype.AT_LEAST_ONE1=function(e){return this.atLeastOneInternal(1,e)},e.prototype.AT_LEAST_ONE2=function(e){this.atLeastOneInternal(2,e)},e.prototype.AT_LEAST_ONE3=function(e){this.atLeastOneInternal(3,e)},e.prototype.AT_LEAST_ONE4=function(e){this.atLeastOneInternal(4,e)},e.prototype.AT_LEAST_ONE5=function(e){this.atLeastOneInternal(5,e)},e.prototype.AT_LEAST_ONE6=function(e){this.atLeastOneInternal(6,e)},e.prototype.AT_LEAST_ONE7=function(e){this.atLeastOneInternal(7,e)},e.prototype.AT_LEAST_ONE8=function(e){this.atLeastOneInternal(8,e)},e.prototype.AT_LEAST_ONE9=function(e){this.atLeastOneInternal(9,e)},e.prototype.AT_LEAST_ONE_SEP=function(e){this.atLeastOneSepFirstInternal(0,e)},e.prototype.AT_LEAST_ONE_SEP1=function(e){this.atLeastOneSepFirstInternal(1,e)},e.prototype.AT_LEAST_ONE_SEP2=function(e){this.atLeastOneSepFirstInternal(2,e)},e.prototype.AT_LEAST_ONE_SEP3=function(e){this.atLeastOneSepFirstInternal(3,e)},e.prototype.AT_LEAST_ONE_SEP4=function(e){this.atLeastOneSepFirstInternal(4,e)},e.prototype.AT_LEAST_ONE_SEP5=function(e){this.atLeastOneSepFirstInternal(5,e)},e.prototype.AT_LEAST_ONE_SEP6=function(e){this.atLeastOneSepFirstInternal(6,e)},e.prototype.AT_LEAST_ONE_SEP7=function(e){this.atLeastOneSepFirstInternal(7,e)},e.prototype.AT_LEAST_ONE_SEP8=function(e){this.atLeastOneSepFirstInternal(8,e)},e.prototype.AT_LEAST_ONE_SEP9=function(e){this.atLeastOneSepFirstInternal(9,e)},e.prototype.RULE=function(e,t,r){if(void 0===r&&(r=SH),CL(this.definedRulesNames,e)){var n={message:AV.buildDuplicateRuleNameError({topLevelRule:e,grammarName:this.className}),type:vH.DUPLICATE_RULE_NAME,ruleName:e};this.definitionErrors.push(n)}this.definedRulesNames.push(e);var o=this.defineRule(e,t,r);return this[e]=o,o},e.prototype.OVERRIDE_RULE=function(e,t,r){void 0===r&&(r=SH);var n,o,i,s,a,l=[];l=l.concat((n=e,o=this.definedRulesNames,i=this.className,a=[],CL(o,n)||(s="Invalid rule override, rule: ->"+n+"<- cannot be overridden in the grammar: ->"+i+"<-as it is not defined in any of the super grammars ",a.push({message:s,type:vH.INVALID_RULE_OVERRIDE,ruleName:n})),a)),this.definitionErrors.push.apply(this.definitionErrors,l);var u=this.defineRule(e,t,r);return this[e]=u,u},e.prototype.BACKTRACK=function(e,t){return function(){this.isBackTrackingStack.push(1);var r=this.saveRecogState();try{return e.apply(this,t),!0}catch(n){if(VV(n))return!1;throw n}finally{this.reloadRecogState(r),this.isBackTrackingStack.pop()}}},e.prototype.getGAstProductions=function(){return this.gastProductionsCache},e.prototype.getSerializedGastProductions=function(){return hL(uL(this.gastProductionsCache),RP)},e}(),oH=function(){function e(){}return e.prototype.initRecognizerEngine=function(e,t){if(this.className=qV(this.constructor),this.shortRuleNameToFull={},this.fullRuleNameToShort={},this.ruleShortNameIdx=256,this.tokenMatcher=HF,this.definedRulesNames=[],this.tokensMap={},this.allRuleNames=[],this.isBackTrackingStack=[],this.RULE_STACK=[],this.RULE_OCCURRENCE_STACK=[],this.gastProductionsCache={},TL(t,"serializedGrammar"))throw Error("The Parser's configuration can no longer contain a <serializedGrammar> property.\n\tSee: https://sap.github.io/chevrotain/docs/changes/BREAKING_CHANGES.html#_6-0-0\n\tFor Further details.");if(_L(e)){if(aL(e))throw Error("A Token Vocabulary cannot be empty.\n\tNote that the first argument for the parser constructor\n\tis no longer a Token vector (since v4.0).");if("number"==typeof e[0].startOffset)throw Error("The Parser constructor no longer accepts a token vector as the first argument.\n\tSee: https://sap.github.io/chevrotain/docs/changes/BREAKING_CHANGES.html#_4-0-0\n\tFor Further details.")}if(_L(e))this.tokensMap=IL(e,(function(e,t){return e[t.name]=t,e}),{});else if(TL(e,"modes")&&FL(cL(uL(e.modes)),jF)){var r=ML(cL(uL(e.modes)));this.tokensMap=IL(r,(function(e,t){return e[t.name]=t,e}),{})}else{if(!LL(e))throw new Error("<tokensDictionary> argument must be An Array of Token constructors, A dictionary of Token constructors or an IMultiModeLexerDefinition");this.tokensMap=NL(e)}this.tokensMap.EOF=sP;var n=FL(uL(e),(function(e){return aL(e.categoryMatches)}));this.tokenMatcher=n?HF:VF,kF(uL(this.tokensMap))},e.prototype.defineRule=function(e,t,r){if(this.selfAnalysisDone)throw Error("Grammar rule <"+e+"> may not be defined after the 'performSelfAnalysis' method has been called'\nMake sure that all grammar rule definitions are done before 'performSelfAnalysis' is called.");var n,o=TL(r,"resyncEnabled")?r.resyncEnabled:SH.resyncEnabled,i=TL(r,"recoveryValueFunc")?r.recoveryValueFunc:SH.recoveryValueFunc,s=this.ruleShortNameIdx<<12;function a(e){try{if(!0===this.outputCst){t.apply(this,e);var r=this.CST_STACK[this.CST_STACK.length-1];return this.cstPostRule(r),r}return t.apply(this,e)}catch(n){return this.invokeRuleCatch(n,o,i)}finally{this.ruleFinallyStateUpdate()}}this.ruleShortNameIdx++,this.shortRuleNameToFull[s]=e,this.fullRuleNameToShort[e]=s;return(n=function(t,r){return void 0===t&&(t=0),this.ruleInvocationStateUpdate(s,e,t),a.call(this,r)}).ruleName=e,n.originalGrammarAction=t,n},e.prototype.invokeRuleCatch=function(e,t,r){var n=1===this.RULE_STACK.length,o=t&&!this.isBackTracking()&&this.recoveryEnabled;if(VV(e)){var i=e;if(o){var s,a=this.findReSyncTokenType();if(this.isInCurrentRuleReSyncSet(a))return i.resyncedTokens=this.reSyncTo(a),this.outputCst?((s=this.CST_STACK[this.CST_STACK.length-1]).recoveredNode=!0,s):r();throw this.outputCst&&((s=this.CST_STACK[this.CST_STACK.length-1]).recoveredNode=!0,i.partialCstResult=s),i}if(n)return this.moveToTerminatedState(),r();throw i}throw e},e.prototype.optionInternal=function(e,t){var r=this.getKeyForAutomaticLookahead(FP,t),n=this.nestedRuleBeforeClause(e,r);try{return this.optionInternalLogic(e,t,r)}finally{void 0!==n&&this.nestedRuleFinallyClause(r,n)}},e.prototype.optionInternalNoCst=function(e,t){var r=this.getKeyForAutomaticLookahead(FP,t);return this.optionInternalLogic(e,t,r)},e.prototype.optionInternalLogic=function(e,t,r){var n,o,i=this,s=this.getLaFuncFromCache(r);if(void 0!==e.DEF){if(n=e.DEF,void 0!==(o=e.GATE)){var a=s;s=function(){return o.call(i)&&a.call(i)}}}else n=e;if(!0===s.call(this))return n.call(this)},e.prototype.atLeastOneInternal=function(e,t){var r=this.getKeyForAutomaticLookahead(VP,e),n=this.nestedRuleBeforeClause(t,r);try{return this.atLeastOneInternalLogic(e,t,r)}finally{void 0!==n&&this.nestedRuleFinallyClause(r,n)}},e.prototype.atLeastOneInternalNoCst=function(e,t){var r=this.getKeyForAutomaticLookahead(VP,e);this.atLeastOneInternalLogic(e,t,r)},e.prototype.atLeastOneInternalLogic=function(e,t,r){var n,o,i=this,s=this.getLaFuncFromCache(r);if(void 0!==t.DEF){if(n=t.DEF,void 0!==(o=t.GATE)){var a=s;s=function(){return o.call(i)&&a.call(i)}}}else n=t;if(!0!==s.call(this))throw this.raiseEarlyExitException(e,rV.REPETITION_MANDATORY,t.ERR_MSG);for(var l=this.doSingleRepetition(n);!0===s.call(this)&&!0===l;)l=this.doSingleRepetition(n);this.attemptInRepetitionRecovery(this.atLeastOneInternal,[e,t],s,VP,e,QP)},e.prototype.atLeastOneSepFirstInternal=function(e,t){var r=this.getKeyForAutomaticLookahead(DP,e),n=this.nestedRuleBeforeClause(t,r);try{this.atLeastOneSepFirstInternalLogic(e,t,r)}finally{void 0!==n&&this.nestedRuleFinallyClause(r,n)}},e.prototype.atLeastOneSepFirstInternalNoCst=function(e,t){var r=this.getKeyForAutomaticLookahead(DP,e);this.atLeastOneSepFirstInternalLogic(e,t,r)},e.prototype.atLeastOneSepFirstInternalLogic=function(e,t,r){var n=this,o=t.DEF,i=t.SEP;if(!0!==this.getLaFuncFromCache(r).call(this))throw this.raiseEarlyExitException(e,rV.REPETITION_MANDATORY_WITH_SEPARATOR,t.ERR_MSG);o.call(this);for(var s=function(){return n.tokenMatcher(n.LA(1),i)};!0===this.tokenMatcher(this.LA(1),i);)this.CONSUME(i),o.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,i,s,o,ZP],s,DP,e,ZP)},e.prototype.manyInternal=function(e,t){var r=this.getKeyForAutomaticLookahead(PP,e),n=this.nestedRuleBeforeClause(t,r);try{return this.manyInternalLogic(e,t,r)}finally{void 0!==n&&this.nestedRuleFinallyClause(r,n)}},e.prototype.manyInternalNoCst=function(e,t){var r=this.getKeyForAutomaticLookahead(PP,e);return this.manyInternalLogic(e,t,r)},e.prototype.manyInternalLogic=function(e,t,r){var n,o,i=this,s=this.getLaFuncFromCache(r);if(void 0!==t.DEF){if(n=t.DEF,void 0!==(o=t.GATE)){var a=s;s=function(){return o.call(i)&&a.call(i)}}}else n=t;for(var l=!0;!0===s.call(this)&&!0===l;)l=this.doSingleRepetition(n);this.attemptInRepetitionRecovery(this.manyInternal,[e,t],s,PP,e,KP,l)},e.prototype.manySepFirstInternal=function(e,t){var r=this.getKeyForAutomaticLookahead(HP,e),n=this.nestedRuleBeforeClause(t,r);try{this.manySepFirstInternalLogic(e,t,r)}finally{void 0!==n&&this.nestedRuleFinallyClause(r,n)}},e.prototype.manySepFirstInternalNoCst=function(e,t){var r=this.getKeyForAutomaticLookahead(HP,e);this.manySepFirstInternalLogic(e,t,r)},e.prototype.manySepFirstInternalLogic=function(e,t,r){var n=this,o=t.DEF,i=t.SEP;if(!0===this.getLaFuncFromCache(r).call(this)){o.call(this);for(var s=function(){return n.tokenMatcher(n.LA(1),i)};!0===this.tokenMatcher(this.LA(1),i);)this.CONSUME(i),o.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,i,s,o,qP],s,HP,e,qP)}},e.prototype.repetitionSepSecondInternal=function(e,t,r,n,o){for(;r();)this.CONSUME(t),n.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,t,r,n,o],r,DP,e,o)},e.prototype.doSingleRepetition=function(e){var t=this.getLexerPosition();return e.call(this),this.getLexerPosition()>t},e.prototype.orInternalNoCst=function(e,t){var r=_L(e)?e:e.DEF,n=this.getKeyForAutomaticLookahead(LP,t),o=this.getLaFuncFromCache(n).call(this,r);if(void 0!==o)return r[o].ALT.call(this);this.raiseNoAltException(t,e.ERR_MSG)},e.prototype.orInternal=function(e,t){var r=this.getKeyForAutomaticLookahead(LP,t),n=this.nestedRuleBeforeClause(e,r);try{var o=_L(e)?e:e.DEF,i=this.getLaFuncFromCache(r).call(this,o);if(void 0!==i){var s=o[i],a=this.nestedAltBeforeClause(s,t,LP,i);try{return s.ALT.call(this)}finally{void 0!==a&&this.nestedRuleFinallyClause(a.shortName,a.nestedName)}}this.raiseNoAltException(t,e.ERR_MSG)}finally{void 0!==n&&this.nestedRuleFinallyClause(r,n)}},e.prototype.ruleFinallyStateUpdate=function(){if(this.RULE_STACK.pop(),this.RULE_OCCURRENCE_STACK.pop(),this.cstFinallyStateUpdate(),0===this.RULE_STACK.length&&!1===this.isAtEndOfInput()){var e=this.LA(1),t=this.errorMessageProvider.buildNotAllInputParsedMessage({firstRedundant:e,ruleName:this.getCurrRuleFullName()});this.SAVE_ERROR(new UV(t,e))}},e.prototype.subruleInternal=function(e,t,r){var n;try{var o=void 0!==r?r.ARGS:void 0;return n=e.call(this,t,o),this.cstPostNonTerminal(n,void 0!==r&&void 0!==r.LABEL?r.LABEL:e.ruleName),n}catch(i){this.subruleInternalError(i,r,e.ruleName)}},e.prototype.subruleInternalError=function(e,t,r){throw VV(e)&&void 0!==e.partialCstResult&&(this.cstPostNonTerminal(e.partialCstResult,void 0!==t&&void 0!==t.LABEL?t.LABEL:r),delete e.partialCstResult),e},e.prototype.consumeInternal=function(e,t,r){var n;try{var o=this.LA(1);!0===this.tokenMatcher(o,e)?(this.consumeToken(),n=o):this.consumeInternalError(e,o,r)}catch(i){n=this.consumeInternalRecovery(e,t,i)}return this.cstPostTerminal(void 0!==r&&void 0!==r.LABEL?r.LABEL:e.name,n),n},e.prototype.consumeInternalError=function(e,t,r){var n,o=this.LA(0);throw n=void 0!==r&&r.ERR_MSG?r.ERR_MSG:this.errorMessageProvider.buildMismatchTokenMessage({expected:e,actual:t,previous:o,ruleName:this.getCurrRuleFullName()}),this.SAVE_ERROR(new HV(n,t,o))},e.prototype.consumeInternalRecovery=function(e,t,r){if(!this.recoveryEnabled||"MismatchedTokenException"!==r.name||this.isBackTracking())throw r;var n=this.getFollowsForInRuleRecovery(e,t);try{return this.tryInRuleRecovery(e,n)}catch(o){throw o.name===WV?r:o}},e.prototype.saveRecogState=function(){var e=this.errors,t=bL(this.RULE_STACK);return{errors:e,lexerState:this.exportLexerState(),RULE_STACK:t,CST_STACK:this.CST_STACK,LAST_EXPLICIT_RULE_STACK:this.LAST_EXPLICIT_RULE_STACK}},e.prototype.reloadRecogState=function(e){this.errors=e.errors,this.importLexerState(e.lexerState),this.RULE_STACK=e.RULE_STACK},e.prototype.ruleInvocationStateUpdate=function(e,t,r){this.RULE_OCCURRENCE_STACK.push(r),this.RULE_STACK.push(e),this.cstInvocationStateUpdate(t,e)},e.prototype.isBackTracking=function(){return 0!==this.isBackTrackingStack.length},e.prototype.getCurrRuleFullName=function(){var e=this.getLastExplicitRuleShortName();return this.shortRuleNameToFull[e]},e.prototype.shortRuleNameToFullName=function(e){return this.shortRuleNameToFull[e]},e.prototype.isAtEndOfInput=function(){return this.tokenMatcher(this.LA(1),sP)},e.prototype.reset=function(){this.resetLexerState(),this.isBackTrackingStack=[],this.errors=[],this.RULE_STACK=[],this.LAST_EXPLICIT_RULE_STACK=[],this.CST_STACK=[],this.RULE_OCCURRENCE_STACK=[]},e}(),iH=function(){function e(){}return e.prototype.initErrorHandler=function(e){this._errors=[],this.errorMessageProvider=UL(e.errorMessageProvider,RH.errorMessageProvider)},e.prototype.SAVE_ERROR=function(e){if(VV(e))return e.context={ruleStack:this.getHumanReadableRuleStack(),ruleOccurrenceStack:bL(this.RULE_OCCURRENCE_STACK)},this._errors.push(e),e;throw Error("Trying to save an Error which is not a RecognitionException")},Object.defineProperty(e.prototype,"errors",{get:function(){return bL(this._errors)},set:function(e){this._errors=e},enumerable:!0,configurable:!0}),e.prototype.raiseEarlyExitException=function(e,t,r){for(var n=this.getCurrRuleFullName(),o=cV(e,this.getGAstProductions()[n],t,this.maxLookahead)[0],i=[],s=1;s<=this.maxLookahead;s++)i.push(this.LA(s));var a=this.errorMessageProvider.buildEarlyExitMessage({expectedIterationPaths:o,actual:i,previous:this.LA(0),customUserDescription:r,ruleName:n});throw this.SAVE_ERROR(new kV(a,this.LA(1),this.LA(0)))},e.prototype.raiseNoAltException=function(e,t){for(var r=this.getCurrRuleFullName(),n=hV(e,this.getGAstProductions()[r],this.maxLookahead),o=[],i=1;i<=this.maxLookahead;i++)o.push(this.LA(i));var s=this.LA(0),a=this.errorMessageProvider.buildNoViableAltMessage({expectedPathsPerAlt:n,actual:o,previous:s,customUserDescription:t,ruleName:this.getCurrRuleFullName()});throw this.SAVE_ERROR(new DV(a,this.LA(1),s))},e}(),sH=function(){function e(){}return e.prototype.initContentAssist=function(){},e.prototype.computeContentAssist=function(e,t){var r=this.gastProductionsCache[e];if(fL(r))throw Error("Rule ->"+e+"<- does not exist in this grammar.");return eV([r],t,this.tokenMatcher,this.maxLookahead)},e.prototype.getNextPossibleTokenTypes=function(e){var t=dL(e.ruleStack),r=this.getGAstProductions()[t];return new YP(r,e).startWalking()},e}(),aH={description:"This Object indicates the Parser is during Recording Phase"};Object.freeze(aH);var lH=Math.pow(2,8)-1,uH=iP({name:"RECORDING_PHASE_TOKEN",pattern:YF.NA});kF([uH]);var hH=aP(uH,"This IToken indicates the Parser is in Recording Phase\n\tSee: https://sap.github.io/chevrotain/docs/guide/internals.html#grammar-recording for details",-1,-1,-1,-1,-1,-1);Object.freeze(hH);var cH={name:"This CSTNode indicates the Parser is in Recording Phase\n\tSee: https://sap.github.io/chevrotain/docs/guide/internals.html#grammar-recording for details",children:{}},dH=function(){function e(){}return e.prototype.initGastRecorder=function(e){this.recordingProdStack=[],this.RECORDING_PHASE=!1},e.prototype.enableRecording=function(){var e=this;this.RECORDING_PHASE=!0,this.TRACE_INIT("Enable Recording",(function(){for(var t=function(t){var r=t>0?t:"";e["CONSUME"+r]=function(e,r){return this.consumeInternalRecord(e,t,r)},e["SUBRULE"+r]=function(e,r){return this.subruleInternalRecord(e,t,r)},e["OPTION"+r]=function(e){return this.optionInternalRecord(e,t)},e["OR"+r]=function(e){return this.orInternalRecord(e,t)},e["MANY"+r]=function(e){this.manyInternalRecord(t,e)},e["MANY_SEP"+r]=function(e){this.manySepFirstInternalRecord(t,e)},e["AT_LEAST_ONE"+r]=function(e){this.atLeastOneInternalRecord(t,e)},e["AT_LEAST_ONE_SEP"+r]=function(e){this.atLeastOneSepFirstInternalRecord(t,e)}},r=0;r<10;r++)t(r);e.consume=function(e,t,r){return this.consumeInternalRecord(t,e,r)},e.subrule=function(e,t,r){return this.subruleInternalRecord(t,e,r)},e.option=function(e,t){return this.optionInternalRecord(t,e)},e.or=function(e,t){return this.orInternalRecord(t,e)},e.many=function(e,t){this.manyInternalRecord(e,t)},e.atLeastOne=function(e,t){this.atLeastOneInternalRecord(e,t)},e.ACTION=e.ACTION_RECORD,e.BACKTRACK=e.BACKTRACK_RECORD,e.LA=e.LA_RECORD}))},e.prototype.disableRecording=function(){var e=this;this.RECORDING_PHASE=!1,this.TRACE_INIT("Deleting Recording methods",(function(){for(var t=0;t<10;t++){var r=t>0?t:"";delete e["CONSUME"+r],delete e["SUBRULE"+r],delete e["OPTION"+r],delete e["OR"+r],delete e["MANY"+r],delete e["MANY_SEP"+r],delete e["AT_LEAST_ONE"+r],delete e["AT_LEAST_ONE_SEP"+r]}delete e.consume,delete e.subrule,delete e.option,delete e.or,delete e.many,delete e.atLeastOne,delete e.ACTION,delete e.BACKTRACK,delete e.LA}))},e.prototype.ACTION_RECORD=function(e){},e.prototype.BACKTRACK_RECORD=function(e,t){return function(){return!0}},e.prototype.LA_RECORD=function(e){return EH},e.prototype.topLevelRuleRecord=function(e,t){try{var r=new dP({definition:[],name:e});return r.name=e,this.recordingProdStack.push(r),t.call(this),this.recordingProdStack.pop(),r}catch(n){if(!0!==n.KNOWN_RECORDER_ERROR)try{n.message=n.message+'\n\t This error was thrown during the "grammar recording phase" For more info see:\n\thttps://sap.github.io/chevrotain/docs/guide/internals.html#grammar-recording'}catch(o){throw n}throw n}},e.prototype.optionInternalRecord=function(e,t){return pH.call(this,mP,e,t)},e.prototype.atLeastOneInternalRecord=function(e,t){pH.call(this,gP,t,e)},e.prototype.atLeastOneSepFirstInternalRecord=function(e,t){pH.call(this,fP,t,e,true)},e.prototype.manyInternalRecord=function(e,t){pH.call(this,yP,t,e)},e.prototype.manySepFirstInternalRecord=function(e,t){pH.call(this,wP,t,e,true)},e.prototype.orInternalRecord=function(e,t){return mH.call(this,e,t)},e.prototype.subruleInternalRecord=function(e,t,r){if(fH(t),!e||!1===TL(e,"ruleName")){var n=new Error("<SUBRULE"+gH(t)+"> argument is invalid expecting a Parser method reference but got: <"+JSON.stringify(e)+">\n inside top level rule: <"+this.recordingProdStack[0].name+">");throw n.KNOWN_RECORDER_ERROR=!0,n}var o=XL(this.recordingProdStack),i=e.ruleName,s=new cP({idx:t,nonTerminalName:i,referencedRule:void 0});return o.definition.push(s),this.outputCst?cH:aH},e.prototype.consumeInternalRecord=function(e,t,r){if(fH(t),!WF(e)){var n=new Error("<CONSUME"+gH(t)+"> argument is invalid expecting a TokenType reference but got: <"+JSON.stringify(e)+">\n inside top level rule: <"+this.recordingProdStack[0].name+">");throw n.KNOWN_RECORDER_ERROR=!0,n}var o=XL(this.recordingProdStack),i=new vP({idx:t,terminalType:e});return o.definition.push(i),hH},e}();function pH(e,t,r,n){void 0===n&&(n=!1),fH(r);var o=XL(this.recordingProdStack),i=yL(t)?t:t.DEF,s=new e({definition:[],idx:r});return TL(t,"NAME")&&(s.name=t.NAME),n&&(s.separator=t.SEP),TL(t,"MAX_LOOKAHEAD")&&(s.maxLookahead=t.MAX_LOOKAHEAD),this.recordingProdStack.push(s),i.call(this),o.definition.push(s),this.recordingProdStack.pop(),aH}function mH(e,t){var r=this;fH(t);var n=XL(this.recordingProdStack),o=!1===_L(e),i=!1===o?e:e.DEF,s=new EP({definition:[],idx:t,ignoreAmbiguities:o&&!0===e.IGNORE_AMBIGUITIES});TL(e,"NAME")&&(s.name=e.NAME),TL(e,"MAX_LOOKAHEAD")&&(s.maxLookahead=e.MAX_LOOKAHEAD);var a=VL(i,(function(e){return yL(e.GATE)}));return s.hasPredicates=a,n.definition.push(s),mL(i,(function(e){var t=new pP({definition:[]});s.definition.push(t),TL(e,"NAME")&&(t.name=e.NAME),TL(e,"IGNORE_AMBIGUITIES")?t.ignoreAmbiguities=e.IGNORE_AMBIGUITIES:TL(e,"GATE")&&(t.ignoreAmbiguities=!0),r.recordingProdStack.push(t),e.ALT.call(r),r.recordingProdStack.pop()})),aH}function gH(e){return 0===e?"":""+e}function fH(e){if(e<0||e>lH){var t=new Error("Invalid DSL Method idx value: <"+e+">\n\tIdx value must be a none negative value smaller than "+(lH+1));throw t.KNOWN_RECORDER_ERROR=!0,t}}var yH=function(){function e(){}return e.prototype.initPerformanceTracer=function(e){if(TL(e,"traceInitPerf")){var t=e.traceInitPerf,r="number"==typeof t;this.traceInitMaxIdent=r?t:1/0,this.traceInitPerf=r?t>0:t}else this.traceInitMaxIdent=0,this.traceInitPerf=RH.traceInitPerf;this.traceInitIndent=-1},e.prototype.TRACE_INIT=function(e,t){if(!0===this.traceInitPerf){this.traceInitIndent++;var r=new Array(this.traceInitIndent+1).join("\t");this.traceInitIndent<this.traceInitMaxIdent&&console.log(r+"--\x3e <"+e+">");var n=KL(t),o=n.time,i=n.value,s=o>10?console.warn:console.log;return this.traceInitIndent<this.traceInitMaxIdent&&s(r+"<-- <"+e+"> time: "+o+"ms"),this.traceInitIndent--,i}return t()},e}(),wH=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},e(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),EH=aP(sP,"",NaN,NaN,NaN,NaN,NaN,NaN);Object.freeze(EH);var vH,RH=Object.freeze({recoveryEnabled:!1,maxLookahead:4,ignoredIssues:{},dynamicTokensEnabled:!1,outputCst:!0,errorMessageProvider:bV,nodeLocationTracking:"none",traceInitPerf:!1,skipValidations:!1}),SH=Object.freeze({recoveryValueFunc:function(){},resyncEnabled:!0});!function(e){e[e.INVALID_RULE_NAME=0]="INVALID_RULE_NAME",e[e.DUPLICATE_RULE_NAME=1]="DUPLICATE_RULE_NAME",e[e.INVALID_RULE_OVERRIDE=2]="INVALID_RULE_OVERRIDE",e[e.DUPLICATE_PRODUCTIONS=3]="DUPLICATE_PRODUCTIONS",e[e.UNRESOLVED_SUBRULE_REF=4]="UNRESOLVED_SUBRULE_REF",e[e.LEFT_RECURSION=5]="LEFT_RECURSION",e[e.NONE_LAST_EMPTY_ALT=6]="NONE_LAST_EMPTY_ALT",e[e.AMBIGUOUS_ALTS=7]="AMBIGUOUS_ALTS",e[e.CONFLICT_TOKENS_RULES_NAMESPACE=8]="CONFLICT_TOKENS_RULES_NAMESPACE",e[e.INVALID_TOKEN_NAME=9]="INVALID_TOKEN_NAME",e[e.INVALID_NESTED_RULE_NAME=10]="INVALID_NESTED_RULE_NAME",e[e.DUPLICATE_NESTED_NAME=11]="DUPLICATE_NESTED_NAME",e[e.NO_NON_EMPTY_LOOKAHEAD=12]="NO_NON_EMPTY_LOOKAHEAD",e[e.AMBIGUOUS_PREFIX_ALTS=13]="AMBIGUOUS_PREFIX_ALTS",e[e.TOO_MANY_ALTS=14]="TOO_MANY_ALTS"}(vH||(vH={}));var TH,CH=function(){function e(e,t){void 0===t&&(t=RH),this.ignoredIssues=RH.ignoredIssues,this.definitionErrors=[],this.selfAnalysisDone=!1;var r=this;r.initErrorHandler(t),r.initLexerAdapter(),r.initLooksAhead(t),r.initRecognizerEngine(e,t),r.initRecoverable(t),r.initTreeBuilder(t),r.initContentAssist(),r.initGastRecorder(t),r.initPerformanceTracer(t),TL(t,"ignoredIssues")&&t.ignoredIssues!==RH.ignoredIssues&&zL("The <ignoredIssues> IParserConfig property is soft-deprecated and will be removed in future versions.\n\tPlease use the <IGNORE_AMBIGUITIES> flag on the relevant DSL method instead."),this.ignoredIssues=TL(t,"ignoredIssues")?t.ignoredIssues:RH.ignoredIssues,this.skipValidations=TL(t,"skipValidations")?t.skipValidations:RH.skipValidations}return e.performSelfAnalysis=function(e){e.performSelfAnalysis()},e.prototype.performSelfAnalysis=function(){var t=this;this.TRACE_INIT("performSelfAnalysis",(function(){var r;t.selfAnalysisDone=!0;var n=t.className;t.TRACE_INIT("toFastProps",(function(){YL(t)})),t.TRACE_INIT("Grammar Recording",(function(){try{t.enableRecording(),mL(t.definedRulesNames,(function(e){var r=t[e].originalGrammarAction,n=void 0;t.TRACE_INIT(e+" Rule",(function(){n=t.topLevelRuleRecord(e,r)})),t.gastProductionsCache[e]=n}))}finally{t.disableRecording()}}));var o=[];if(t.TRACE_INIT("Grammar Resolving",(function(){o=MV({rules:uL(t.gastProductionsCache)}),t.definitionErrors.push.apply(t.definitionErrors,o)})),t.TRACE_INIT("Grammar Validations",(function(){if(aL(o)&&!1===t.skipValidations){var e=gV((r=UL(r={rules:uL(t.gastProductionsCache),maxLookahead:t.maxLookahead,tokenTypes:uL(t.tokensMap),ignoredIssues:t.ignoredIssues,errMsgProvider:AV,grammarName:n},{errMsgProvider:AV,ignoredIssues:{}})).rules,r.maxLookahead,r.tokenTypes,r.ignoredIssues,r.errMsgProvider,r.grammarName);t.definitionErrors.push.apply(t.definitionErrors,e)}var r})),aL(t.definitionErrors)&&(t.recoveryEnabled&&t.TRACE_INIT("computeAllProdsFollows",(function(){var e,r,n=(e=uL(t.gastProductionsCache),r={},mL(e,(function(e){var t=new xP(e).startWalking();HL(r,t)})),r);t.resyncFollows=n})),t.TRACE_INIT("ComputeLookaheadFunctions",(function(){t.preComputeLookaheadFunctions(uL(t.gastProductionsCache))}))),t.TRACE_INIT("expandAllNestedRuleNames",(function(){var e,r,n,o=(e=uL(t.gastProductionsCache),r=t.fullRuleNameToShort,n={allRuleNames:[]},mL(e,(function(e){var t=r[e.name];n.allRuleNames.push(e.name);var o=new zP(t);e.accept(o),mL(o.result,(function(t){t.def,t.key;var r=t.name;n.allRuleNames.push(e.name+r)}))})),n);t.allRuleNames=o.allRuleNames})),!e.DEFER_DEFINITION_ERRORS_HANDLING&&!aL(t.definitionErrors))throw r=hL(t.definitionErrors,(function(e){return e.message})),new Error("Parser Definition Errors detected:\n "+r.join("\n-------------------------------\n"))}))},e.DEFER_DEFINITION_ERRORS_HANDLING=!1,e}();TH=CH,[jV,$V,tH,rH,oH,nH,iH,sH,dH,yH].forEach((function(e){var t=e.prototype;Object.getOwnPropertyNames(t).forEach((function(r){if("constructor"!==r){var n=Object.getOwnPropertyDescriptor(t,r);n&&(n.get||n.set)?Object.defineProperty(TH.prototype,r,n):TH.prototype[r]=e.prototype[r]}}))})),function(e){function t(t,r){void 0===r&&(r=RH);var n=NL(r);return n.outputCst=!0,e.call(this,t,n)||this}wH(t,e)}(CH);var bH=function(e){function t(t,r){void 0===r&&(r=RH);var n=NL(r);return n.outputCst=!1,e.call(this,t,n)||this}return wH(t,e),t}(CH);
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */const NH=(e,t)=>({type:e,message:t});var AH,IH,OH;!function(e){e.LexingError="LexingError",e.ParserError="ParsingError",e.StaticOffsetError="StaticOffsetError",e.StaticOffsetOutOfRangeError="StaticOffsetOutOfRangeError",e.RangeOffsetNotAllowed="RangeOffsetNotAllowed",e.InvalidRangeSize="InvalidRangeSize"}(AH||(AH={})),function(e){e.EMPTY="EMPTY",e.NUMBER="NUMBER",e.STRING="STRING",e.MINUS_UNARY_OP="MINUS_UNARY_OP",e.PLUS_UNARY_OP="PLUS_UNARY_OP",e.PERCENT_OP="PERCENT_OP",e.CONCATENATE_OP="CONCATENATE_OP",e.EQUALS_OP="EQUALS_OP",e.NOT_EQUAL_OP="NOT_EQUAL_OP",e.GREATER_THAN_OP="GREATER_THAN_OP",e.LESS_THAN_OP="LESS_THAN_OP",e.GREATER_THAN_OR_EQUAL_OP="GREATER_THAN_OR_EQUAL_OP",e.LESS_THAN_OR_EQUAL_OP="LESS_THAN_OR_EQUAL_OP",e.PLUS_OP="PLUS_OP",e.MINUS_OP="MINUS_OP",e.TIMES_OP="TIMES_OP",e.DIV_OP="DIV_OP",e.POWER_OP="POWER_OP",e.FUNCTION_CALL="FUNCTION_CALL",e.NAMED_EXPRESSION="NAMED_EXPRESSION",e.PARENTHESIS="PARENTHESES",e.CELL_REFERENCE="CELL_REFERENCE",e.CELL_RANGE="CELL_RANGE",e.COLUMN_RANGE="COLUMN_RANGE",e.ROW_RANGE="ROW_RANGE",e.ERROR="ERROR",e.ERROR_WITH_RAW_INPUT="ERROR_WITH_RAW_INPUT",e.ARRAY="ARRAY"}(IH||(IH={})),function(e){e[e.RELATIVE=0]="RELATIVE",e[e.START_ABSOLUTE=1]="START_ABSOLUTE",e[e.BOTH_ABSOLUTE=2]="BOTH_ABSOLUTE"}(OH||(OH={}));const MH=(e,t)=>({type:IH.CELL_REFERENCE,reference:e,leadingWhitespace:null==t?void 0:t.image}),_H=(e,t,r,n)=>(VH(e,t,r),{type:IH.CELL_RANGE,start:e,end:t,sheetReferenceType:r,leadingWhitespace:n}),xH=(e,t,r)=>({type:IH.ARRAY,args:e,leadingWhitespace:null==t?void 0:t.image,internalWhitespace:null==r?void 0:r.image}),LH=(e,t)=>({type:IH.ERROR,error:e,leadingWhitespace:null==t?void 0:t.image}),FH=(e,t,r)=>({type:IH.ERROR_WITH_RAW_INPUT,error:t,rawInput:e,leadingWhitespace:null==r?void 0:r.image}),PH=()=>({type:IH.ERROR,error:pk.parsingError()});function VH(e,t,r){if(void 0!==e.sheet&&void 0===t.sheet||void 0===e.sheet&&void 0!==t.sheet)throw new Error("Start address inconsistent with end address");if(void 0===e.sheet&&r!==OH.RELATIVE||void 0!==e.sheet&&r===OH.RELATIVE)throw new Error("Sheet address inconsistent with sheet reference type")}function HH(e,t){return(null!=t?t:"")+e}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */const DH={[IH.PLUS_OP]:"+",[IH.MINUS_OP]:"-",[IH.TIMES_OP]:"*",[IH.DIV_OP]:"/",[IH.CONCATENATE_OP]:"&",[IH.POWER_OP]:"^",[IH.EQUALS_OP]:"=",[IH.NOT_EQUAL_OP]:"<>",[IH.GREATER_THAN_OP]:">",[IH.GREATER_THAN_OR_EQUAL_OP]:">=",[IH.LESS_THAN_OP]:"<",[IH.LESS_THAN_OR_EQUAL_OP]:"<="};
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class UH{constructor(e){this.functionRegistry=e,this.cache=new Map}set(e,t){const r=((e,t,r,n)=>({ast:e,relativeDependencies:t,hasVolatileFunction:r,hasStructuralChangeFunction:n}))(t,bD(t,this.functionRegistry),kH(t,this.functionRegistry.isFunctionVolatile),kH(t,this.functionRegistry.isFunctionDependentOnSheetStructureChange));return this.cache.set(e,r),r}get(e){return this.cache.get(e)}maybeSetAndThenGet(e,t){const r=this.cache.get(e);return void 0!==r?r.ast:(this.set(e,t),t)}}const kH=(e,t)=>{switch(e.type){case IH.EMPTY:case IH.NUMBER:case IH.STRING:case IH.ERROR:case IH.ERROR_WITH_RAW_INPUT:case IH.CELL_REFERENCE:case IH.CELL_RANGE:case IH.COLUMN_RANGE:case IH.ROW_RANGE:case IH.NAMED_EXPRESSION:return!1;case IH.PERCENT_OP:case IH.PLUS_UNARY_OP:case IH.MINUS_UNARY_OP:return kH(e.value,t);case IH.CONCATENATE_OP:case IH.EQUALS_OP:case IH.NOT_EQUAL_OP:case IH.LESS_THAN_OP:case IH.GREATER_THAN_OP:case IH.LESS_THAN_OR_EQUAL_OP:case IH.GREATER_THAN_OR_EQUAL_OP:case IH.MINUS_OP:case IH.PLUS_OP:case IH.TIMES_OP:case IH.DIV_OP:case IH.POWER_OP:return kH(e.left,t)||kH(e.right,t);case IH.PARENTHESIS:return kH(e.expression,t);case IH.FUNCTION_CALL:return!!t(e.procedureName)||e.args.some((e=>kH(e,t)));case IH.ARRAY:return e.args.some((e=>e.some((e=>kH(e,t)))))}};
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class BH{}BH.DistinctSigns="Distinct signs.",BH.WrongArgNumber="Wrong number of arguments.",BH.EmptyArg="Empty function argument.",BH.EmptyArray="Empty array not allowed.",BH.ArrayDimensions="Array dimensions are not compatible.",BH.NoSpaceForArrayResult="No space for array result.",BH.ValueSmall="Value too small.",BH.ValueLarge="Value too large.",BH.BadCriterion="Incorrect criterion.",BH.RangeManySheets="Range spans more than one sheet.",BH.CellRangeExpected="Cell range expected.",BH.WrongDimension="Wrong range dimension.",BH.ScalarExpected="Cell range not allowed.",BH.NumberCoercion="Value cannot be coerced to number.",BH.NumberExpected="Number argument expected.",BH.IntegerExpected="Value needs to be an integer.",BH.BadMode="Mode not recognized.",BH.DateBounds="Date outside of bounds.",BH.OutOfSheet="Resulting reference is out of the sheet.",BH.WrongType="Wrong type of argument.",BH.NaN="NaN or infinite value encountered.",BH.EqualLength="Ranges need to be of equal length.",BH.Negative="Value cannot be negative.",BH.NotBinary="String does not represent a binary number.",BH.NotOctal="String does not represent an octal number.",BH.NotHex="String does not represent a hexadecimal number.",BH.EndStartPeriod="End period needs to be at least start period.",BH.CellRefExpected="Cell reference expected.",BH.EmptyRange="Empty range not allowed.",BH.BadRef="Address is not correct.",BH.NumberRange="Number-only range expected.",BH.ValueNotFound="Value not found.",BH.ValueBaseLarge="Value in base too large.",BH.ValueBaseSmall="Value in base too small.",BH.ValueBaseLong="Value in base too long.",BH.NegativeLength="Length cannot be negative.",BH.PatternNotFound="Pattern not found.",BH.OneValue="Needs at least one value.",BH.TwoValues="Range needs to contain at least two elements.",BH.ThreeValues="Range needs to contain at least three elements.",BH.IndexBounds="Index out of bounds.",BH.IndexLarge="Index too large.",BH.Formula="Expected formula.",BH.NegativeCount="Count cannot be negative.",BH.ParseError="Parsing error.",BH.SheetRef="Sheet does not exist.",BH.PeriodLong="Period number cannot exceed life length.",BH.InvalidDate="Invalid date.",BH.BitshiftLong="Result of bitshift is too long.",BH.EmptyString="Empty-string argument not allowed.",BH.LengthBounds="Length out of bounds.",BH.NegativeTime="Time cannot be negative.",BH.NoDefault="No default option.",BH.NoConditionMet="None of the conditions were met.",BH.Selector="Selector cannot exceed the number of arguments.",BH.StartEndDate="Start date needs to be earlier than end date.",BH.IncorrectDateTime="String does not represent correct DateTime.",BH.CharacterCodeBounds="Character code out of bounds.",BH.NonZero="Argument cannot be 0.",BH.LessThanOne="Argument cannot be less than 1.",BH.WeekendString="Incorrect weekend bitmask string.",BH.InvalidRoman="Invalid roman numeral.",BH.WrongOrder="Wrong order of values.",BH.ComplexNumberExpected="Complex number expected.",BH.ShouldBeIorJ="Should be 'i' or 'j'.",BH.SizeMismatch="Array dimensions mismatched.",BH.FunctionName=e=>`Function name ${e} not recognized.`,BH.NamedExpressionName=e=>`Named expression ${e} not recognized.`,BH.LicenseKey=e=>`License key is ${e}.`
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */;
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
const WH=iP({name:"AdditionOp",pattern:YF.NA}),GH=iP({name:"PlusOp",pattern:/\+/,categories:WH}),jH=iP({name:"MinusOp",pattern:/-/,categories:WH}),zH=iP({name:"MultiplicationOp",pattern:YF.NA}),$H=iP({name:"TimesOp",pattern:/\*/,categories:zH}),YH=iP({name:"DivOp",pattern:/\//,categories:zH}),XH=iP({name:"PowerOp",pattern:/\^/}),KH=iP({name:"PercentOp",pattern:/%/}),qH=iP({name:"BooleanOp",pattern:YF.NA}),QH=iP({name:"EqualsOp",pattern:/=/,categories:qH}),ZH=iP({name:"NotEqualOp",pattern:/<>/,categories:qH}),JH=iP({name:"GreaterThanOp",pattern:/>/,categories:qH}),eD=iP({name:"LessThanOp",pattern:/</,categories:qH}),tD=iP({name:"GreaterThanOrEqualOp",pattern:/>=/,categories:qH}),rD=iP({name:"LessThanOrEqualOp",pattern:/<=/,categories:qH}),nD=iP({name:"ConcatenateOp",pattern:/&/}),oD=iP({name:"LParen",pattern:/\(/}),iD=iP({name:"RParen",pattern:/\)/}),sD=iP({name:"ArrayLParen",pattern:/{/}),aD=iP({name:"ArrayRParen",pattern:/}/}),lD=iP({name:"StringLiteral",pattern:/"([^"\\]*(\\.[^"\\]*)*)"/}),uD=iP({name:"ErrorLiteral",pattern:/#[A-Za-z0-9\/]+[?!]?/}),hD=iP({name:"RangeSeparator",pattern:new RegExp(Fx)}),cD=iP({name:"ColumnRange",pattern:new RegExp(`${Bx}${Fx}${Bx}`)}),dD=iP({name:"RowRange",pattern:new RegExp(`${Wx}${Fx}${Wx}`)}),pD=iP({name:"ProcedureName",pattern:new RegExp(`([${Vx}][${Hx}]*)\\(`)}),mD=new class{constructor(){this.POSSIBLE_START_CHARACTERS=[...Yx,...$x,Px,"'","_"],this.cellReferenceRegexp=new RegExp(jx,"y")}match(e,t){this.cellReferenceRegexp.lastIndex=t;const r=this.cellReferenceRegexp.exec(e+"@");return null==r||null==r[1]?null:(r[0]=r[1],r)}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */,gD=iP({name:"CellReference",pattern:mD.match.bind(mD),start_chars_hint:mD.POSSIBLE_START_CHARACTERS,line_breaks:!1}),fD=new class{constructor(){this.POSSIBLE_START_CHARACTERS=[...Yx,"_"],this.namedExpressionRegexp=new RegExp(zx,"y"),this.r1c1CellRefRegexp=new RegExp(`^${Gx}$`)}match(e,t){this.namedExpressionRegexp.lastIndex=t;const r=this.namedExpressionRegexp.exec(e);return null==r||null==r[0]||this.r1c1CellRefRegexp.test(r[0])?null:r}},yD=iP({name:"NamedExpression",pattern:fD.match.bind(fD),start_chars_hint:fD.POSSIBLE_START_CHARACTERS,line_breaks:!1}),wD=e=>{const t=e.translationPackage.getFunctionTranslation("OFFSET"),r=e.errorMapping,n=e.translationPackage.buildFunctionMapping(),o=iP({name:"WhiteSpace",pattern:new RegExp("standard"===e.ignoreWhiteSpace?"[ \\t\\n\\r]+":"\\s+")}),i=iP({name:"ArrayRowSep",pattern:e.arrayRowSeparator}),s=iP({name:"ArrayColSep",pattern:e.arrayColumnSeparator}),a=iP({name:"NumberLiteral",pattern:new RegExp(`(([${e.decimalSeparator}]\\d+)|(\\d+([${e.decimalSeparator}]\\d*)?))(e[+-]?\\d+)?`)}),l=iP({name:"OffsetProcedureName",pattern:new RegExp(t,"i")});let u,h;e.functionArgSeparator===e.arrayColumnSeparator?(u=s,h=[]):e.functionArgSeparator===e.arrayRowSeparator?(u=i,h=[]):(u=iP({name:"ArgSeparator",pattern:e.functionArgSeparator}),h=[u]);return{ArgSeparator:u,NumberLiteral:a,OffsetProcedureName:l,ArrayRowSeparator:i,ArrayColSeparator:s,WhiteSpace:o,allTokens:[o,GH,jH,$H,YH,XH,QH,ZH,KH,tD,rD,JH,eD,oD,iD,sD,aD,l,pD,hD,...h,cD,dD,a,lD,uD,nD,qH,WH,zH,gD,yD,i,s],errorMapping:r,functionMapping:n,decimalSeparator:e.decimalSeparator,maxColumns:e.maxColumns,maxRows:e.maxRows}};
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
class ED extends bH{constructor(e,t){super(e.allTokens,{outputCst:!1,maxLookahead:7}),this.booleanExpressionOrEmpty=this.RULE("booleanExpressionOrEmpty",(()=>{return this.OR([{ALT:()=>this.SUBRULE(this.booleanExpression)},{ALT:(e={type:IH.EMPTY,leadingWhitespace:null==t?void 0:t.image},void 0===e&&(e=void 0),function(){return e})}]);var e,t})),this.procedureExpression=this.RULE("procedureExpression",(()=>{var e;const t=this.CONSUME(pD),r=t.image.toUpperCase().slice(0,-1),n=null!==(e=this.lexerConfig.functionMapping[r])&&void 0!==e?e:r,o=[];let i=this.SUBRULE(this.booleanExpressionOrEmpty);this.MANY((()=>{var e;const t=this.CONSUME(this.lexerConfig.ArgSeparator);i.type===IH.EMPTY&&(i.leadingWhitespace=null===(e=t.leadingWhitespace)||void 0===e?void 0:e.image),o.push(i),i=this.SUBRULE2(this.booleanExpressionOrEmpty)})),o.push(i),1===o.length&&o[0].type===IH.EMPTY&&(o.length=0);const s=this.CONSUME(iD);return((e,t,r,n,o)=>({type:IH.FUNCTION_CALL,procedureName:e,args:t,leadingWhitespace:null==r?void 0:r.image,internalWhitespace:null==n?void 0:n.image,hyperlink:o}))(n,o,t.leadingWhitespace,s.leadingWhitespace)})),this.namedExpressionExpression=this.RULE("namedExpressionExpression",(()=>{const e=this.CONSUME(yD);return t=e.image,r=e.leadingWhitespace,{type:IH.NAMED_EXPRESSION,expressionName:t,leadingWhitespace:null==r?void 0:r.image};var t,r})),this.offsetProcedureExpression=this.RULE("offsetProcedureExpression",(()=>{const e=[];return this.CONSUME(this.lexerConfig.OffsetProcedureName),this.CONSUME(oD),this.MANY_SEP({SEP:this.lexerConfig.ArgSeparator,DEF:()=>{e.push(this.SUBRULE(this.booleanExpression))}}),this.CONSUME(iD),this.handleOffsetHeuristic(e)})),this.columnRangeExpression=this.RULE("columnRangeExpression",(()=>{const e=this.CONSUME(cD),[t,r]=e.image.split(":"),n=this.ACTION((()=>Jx(this.sheetMapping,t,this.formulaAddress))),o=this.ACTION((()=>Jx(this.sheetMapping,r,this.formulaAddress)));if(void 0===n||void 0===o)return LH(new pk(XU.REF));if(n.exceedsSheetSizeLimits(this.lexerConfig.maxColumns)||o.exceedsSheetSizeLimits(this.lexerConfig.maxColumns))return FH(e.image,new pk(XU.NAME),e.leadingWhitespace);if(void 0===n.sheet&&void 0!==o.sheet)return this.parsingError(AH.ParserError,"Malformed range expression");const{firstEnd:i,secondEnd:s,sheetRefType:a}=ED.fixSheetIdsForRangeEnds(n,o);return l=i,u=s,h=a,c=e.leadingWhitespace,VH(l,u,h),{type:IH.COLUMN_RANGE,start:l,end:u,sheetReferenceType:h,leadingWhitespace:null==c?void 0:c.image};var l,u,h,c})),this.rowRangeExpression=this.RULE("rowRangeExpression",(()=>{const e=this.CONSUME(dD),[t,r]=e.image.split(":"),n=this.ACTION((()=>eL(this.sheetMapping,t,this.formulaAddress))),o=this.ACTION((()=>eL(this.sheetMapping,r,this.formulaAddress)));if(void 0===n||void 0===o)return LH(new pk(XU.REF));if(n.exceedsSheetSizeLimits(this.lexerConfig.maxRows)||o.exceedsSheetSizeLimits(this.lexerConfig.maxRows))return FH(e.image,new pk(XU.NAME),e.leadingWhitespace);if(void 0===n.sheet&&void 0!==o.sheet)return this.parsingError(AH.ParserError,"Malformed range expression");const{firstEnd:i,secondEnd:s,sheetRefType:a}=ED.fixSheetIdsForRangeEnds(n,o);return l=i,u=s,h=a,c=e.leadingWhitespace,VH(l,u,h),{type:IH.ROW_RANGE,start:l,end:u,sheetReferenceType:h,leadingWhitespace:null==c?void 0:c.image};var l,u,h,c})),this.cellReference=this.RULE("cellReference",(()=>{const e=this.CONSUME(gD),t=this.ACTION((()=>Zx(this.sheetMapping,e.image,this.formulaAddress)));return void 0===t?FH(e.image,new pk(XU.REF),e.leadingWhitespace):t.exceedsSheetSizeLimits(this.lexerConfig.maxColumns,this.lexerConfig.maxRows)?FH(e.image,new pk(XU.NAME),e.leadingWhitespace):MH(t,e.leadingWhitespace)})),this.endRangeReference=this.RULE("endRangeReference",(e=>{var t;const r=this.CONSUME(gD),n=this.ACTION((()=>Zx(this.sheetMapping,e.image,this.formulaAddress))),o=this.ACTION((()=>Zx(this.sheetMapping,r.image,this.formulaAddress)));return void 0===n||void 0===o?this.ACTION((()=>FH(`${e.image}:${r.image}`,new pk(XU.REF),e.leadingWhitespace))):n.exceedsSheetSizeLimits(this.lexerConfig.maxColumns,this.lexerConfig.maxRows)||o.exceedsSheetSizeLimits(this.lexerConfig.maxColumns,this.lexerConfig.maxRows)?this.ACTION((()=>FH(`${e.image}:${r.image}`,new pk(XU.NAME),e.leadingWhitespace))):this.buildCellRange(n,o,null===(t=e.leadingWhitespace)||void 0===t?void 0:t.image)})),this.endOfRangeExpression=this.RULE("endOfRangeExpression",(e=>this.OR([{ALT:()=>this.SUBRULE(this.endRangeReference,{ARGS:[e]})},{ALT:()=>{var t;const r=this.SUBRULE(this.offsetProcedureExpression),n=this.ACTION((()=>Zx(this.sheetMapping,e.image,this.formulaAddress)));return void 0===n?LH(new pk(XU.REF)):r.type===IH.CELL_REFERENCE?this.buildCellRange(n,r.reference,null===(t=e.leadingWhitespace)||void 0===t?void 0:t.image):this.parsingError(AH.RangeOffsetNotAllowed,"Range offset not allowed here")}}]))),this.cellRangeExpression=this.RULE("cellRangeExpression",(()=>{const e=this.CONSUME(gD);return this.CONSUME2(hD),this.SUBRULE(this.endOfRangeExpression,{ARGS:[e]})})),this.endRangeWithOffsetStartReference=this.RULE("endRangeWithOffsetStartReference",(e=>{const t=this.CONSUME(gD),r=this.ACTION((()=>Zx(this.sheetMapping,t.image,this.formulaAddress)));return void 0===r?this.ACTION((()=>LH(new pk(XU.REF)))):this.buildCellRange(e.reference,r,e.leadingWhitespace)})),this.endOfRangeWithOffsetStartExpression=this.RULE("endOfRangeWithOffsetStartExpression",(e=>this.OR([{ALT:()=>this.SUBRULE(this.endRangeWithOffsetStartReference,{ARGS:[e]})},{ALT:()=>{const t=this.SUBRULE(this.offsetProcedureExpression);return t.type===IH.CELL_REFERENCE?this.buildCellRange(e.reference,t.reference,e.leadingWhitespace):this.parsingError(AH.RangeOffsetNotAllowed,"Range offset not allowed here")}}]))),this.offsetExpression=this.RULE("offsetExpression",(()=>{const e=this.SUBRULE(this.offsetProcedureExpression);let t;return this.OPTION((()=>{this.CONSUME(hD),t=e.type===IH.CELL_RANGE?this.parsingError(AH.RangeOffsetNotAllowed,"Range offset not allowed here"):this.SUBRULE(this.endOfRangeWithOffsetStartExpression,{ARGS:[e]})})),void 0!==t?t:e})),this.insideArrayExpression=this.RULE("insideArrayExpression",(()=>{const e=[[]];return e[e.length-1].push(this.SUBRULE(this.booleanExpression)),this.MANY((()=>{this.OR([{ALT:()=>{this.CONSUME(this.lexerConfig.ArrayColSeparator),e[e.length-1].push(this.SUBRULE2(this.booleanExpression))}},{ALT:()=>{this.CONSUME(this.lexerConfig.ArrayRowSeparator),e.push([]),e[e.length-1].push(this.SUBRULE3(this.booleanExpression))}}])})),xH(e)})),this.parenthesisExpression=this.RULE("parenthesisExpression",(()=>{const e=this.CONSUME(oD),t=this.SUBRULE(this.booleanExpression),r=this.CONSUME(iD);return((e,t,r)=>({type:IH.PARENTHESIS,expression:e,leadingWhitespace:null==t?void 0:t.image,internalWhitespace:null==r?void 0:r.image}))(t,e.leadingWhitespace,r.leadingWhitespace)})),this.arrayExpression=this.RULE("arrayExpression",(()=>this.OR([{ALT:()=>{const e=this.CONSUME(sD),t=this.SUBRULE(this.insideArrayExpression),r=this.CONSUME(aD);return xH(t.args,e.leadingWhitespace,r.leadingWhitespace)}},{ALT:()=>this.SUBRULE(this.parenthesisExpression)}]))),this.numericStringToNumber=e=>{const t=e.replace(this.lexerConfig.decimalSeparator,".");return Number(t)},this.positiveAtomicExpression=this.RULE("positiveAtomicExpression",(()=>{var e;return this.OR(null!==(e=this.atomicExpCache)&&void 0!==e?e:this.atomicExpCache=[{ALT:()=>this.SUBRULE(this.arrayExpression)},{ALT:()=>this.SUBRULE(this.cellRangeExpression)},{ALT:()=>this.SUBRULE(this.columnRangeExpression)},{ALT:()=>this.SUBRULE(this.rowRangeExpression)},{ALT:()=>this.SUBRULE(this.offsetExpression)},{ALT:()=>this.SUBRULE(this.cellReference)},{ALT:()=>this.SUBRULE(this.procedureExpression)},{ALT:()=>this.SUBRULE(this.namedExpressionExpression)},{ALT:()=>{const e=this.CONSUME(this.lexerConfig.NumberLiteral);return t=this.numericStringToNumber(e.image),r=e.leadingWhitespace,{type:IH.NUMBER,value:t,leadingWhitespace:null==r?void 0:r.image};var t,r}},{ALT:()=>(e=>{var t;return{type:IH.STRING,value:e.image.slice(1,-1),leadingWhitespace:null===(t=e.leadingWhitespace)||void 0===t?void 0:t.image}})(this.CONSUME(lD))},{ALT:()=>{const e=this.CONSUME(uD),t=e.image.toUpperCase(),r=this.lexerConfig.errorMapping[t];return r?LH(new pk(r),e.leadingWhitespace):this.parsingError(AH.ParserError,"Unknown error literal")}}])})),this.rightUnaryOpAtomicExpression=this.RULE("rightUnaryOpAtomicExpression",(()=>{const e=this.SUBRULE(this.positiveAtomicExpression),t=this.OPTION((()=>this.CONSUME(KH)));return t?(r=e,n=t.leadingWhitespace,{type:IH.PERCENT_OP,value:r,leadingWhitespace:null==n?void 0:n.image}):e;var r,n})),this.atomicExpression=this.RULE("atomicExpression",(()=>this.OR([{ALT:()=>{const e=this.CONSUME(WH),t=this.SUBRULE(this.atomicExpression);return lP(e,GH)?((e,t)=>({type:IH.PLUS_UNARY_OP,value:e,leadingWhitespace:null==t?void 0:t.image}))(t,e.leadingWhitespace):lP(e,jH)?((e,t)=>({type:IH.MINUS_UNARY_OP,value:e,leadingWhitespace:null==t?void 0:t.image}))(t,e.leadingWhitespace):(this.customParsingError=NH(AH.ParserError,"Mismatched token type"),this.customParsingError)}},{ALT:()=>this.SUBRULE2(this.rightUnaryOpAtomicExpression)}]))),this.powerExpression=this.RULE("powerExpression",(()=>{let e=this.SUBRULE(this.atomicExpression);return this.MANY((()=>{const t=this.CONSUME(XH),r=this.SUBRULE2(this.atomicExpression);var n,o,i;lP(t,XH)?(n=e,o=r,i=t.leadingWhitespace,e={type:IH.POWER_OP,left:n,right:o,leadingWhitespace:null==i?void 0:i.image}):this.ACTION((()=>{throw Error("Operator not supported")}))})),e})),this.multiplicationExpression=this.RULE("multiplicationExpression",(()=>{let e=this.SUBRULE(this.powerExpression);return this.MANY((()=>{const t=this.CONSUME(zH),r=this.SUBRULE2(this.powerExpression);var n,o,i;lP(t,$H)?(n=e,o=r,i=t.leadingWhitespace,e={type:IH.TIMES_OP,left:n,right:o,leadingWhitespace:null==i?void 0:i.image}):lP(t,YH)?e=((e,t,r)=>({type:IH.DIV_OP,left:e,right:t,leadingWhitespace:null==r?void 0:r.image}))(e,r,t.leadingWhitespace):this.ACTION((()=>{throw Error("Operator not supported")}))})),e})),this.additionExpression=this.RULE("additionExpression",(()=>{let e=this.SUBRULE(this.multiplicationExpression);return this.MANY((()=>{const t=this.CONSUME(WH),r=this.SUBRULE2(this.multiplicationExpression);var n,o,i;lP(t,GH)?(n=e,o=r,i=t.leadingWhitespace,e={type:IH.PLUS_OP,left:n,right:o,leadingWhitespace:null==i?void 0:i.image}):lP(t,jH)?e=((e,t,r)=>({type:IH.MINUS_OP,left:e,right:t,leadingWhitespace:null==r?void 0:r.image}))(e,r,t.leadingWhitespace):this.ACTION((()=>{throw Error("Operator not supported")}))})),e})),this.concatenateExpression=this.RULE("concatenateExpression",(()=>{let e=this.SUBRULE(this.additionExpression);return this.MANY((()=>{const t=this.CONSUME(nD),r=this.SUBRULE2(this.additionExpression);var n,o,i;n=e,o=r,i=t.leadingWhitespace,e={type:IH.CONCATENATE_OP,left:n,right:o,leadingWhitespace:null==i?void 0:i.image}})),e})),this.booleanExpression=this.RULE("booleanExpression",(()=>{let e=this.SUBRULE(this.concatenateExpression);return this.MANY((()=>{const t=this.CONSUME(qH),r=this.SUBRULE2(this.concatenateExpression);var n,o,i;lP(t,QH)?(n=e,o=r,i=t.leadingWhitespace,e={type:IH.EQUALS_OP,left:n,right:o,leadingWhitespace:null==i?void 0:i.image}):lP(t,ZH)?e=((e,t,r)=>({type:IH.NOT_EQUAL_OP,left:e,right:t,leadingWhitespace:null==r?void 0:r.image}))(e,r,t.leadingWhitespace):lP(t,JH)?e=((e,t,r)=>({type:IH.GREATER_THAN_OP,left:e,right:t,leadingWhitespace:null==r?void 0:r.image}))(e,r,t.leadingWhitespace):lP(t,eD)?e=((e,t,r)=>({type:IH.LESS_THAN_OP,left:e,right:t,leadingWhitespace:null==r?void 0:r.image}))(e,r,t.leadingWhitespace):lP(t,tD)?e=((e,t,r)=>({type:IH.GREATER_THAN_OR_EQUAL_OP,left:e,right:t,leadingWhitespace:null==r?void 0:r.image}))(e,r,t.leadingWhitespace):lP(t,rD)?e=((e,t,r)=>({type:IH.LESS_THAN_OR_EQUAL_OP,left:e,right:t,leadingWhitespace:null==r?void 0:r.image}))(e,r,t.leadingWhitespace):this.ACTION((()=>{throw Error("Operator not supported")}))})),e})),this.formula=this.RULE("formula",(()=>(this.CONSUME(QH),this.SUBRULE(this.booleanExpression)))),this.lexerConfig=e,this.sheetMapping=t,this.formulaAddress=wk(0,0,0),this.performSelfAnalysis()}parseFromTokens(e,t){this.input=e;let r=this.formulaWithContext(t),n=[];return this.customParsingError&&n.push(this.customParsingError),n=n.concat(this.errors.map((e=>({type:AH.ParserError,message:e.message})))),n.length>0&&(r=PH()),{ast:r,errors:n}}reset(){super.reset(),this.customParsingError=void 0}formulaWithContext(e){return this.formulaAddress=e,this.formula()}buildCellRange(e,t,r){if(void 0===e.sheet&&void 0!==t.sheet)return this.parsingError(AH.ParserError,"Malformed range expression");const{firstEnd:n,secondEnd:o,sheetRefType:i}=ED.fixSheetIdsForRangeEnds(e,t);return _H(n,o,i,r)}static fixSheetIdsForRangeEnds(e,t){const r=ED.rangeSheetReferenceType(e.sheet,t.sheet);return{firstEnd:e,secondEnd:void 0!==e.sheet&&void 0===t.sheet?t.withSheet(e.sheet):t,sheetRefType:r}}handleOffsetHeuristic(e){const t=e[0];if(t.type!==IH.CELL_REFERENCE)return this.parsingError(AH.StaticOffsetError,"First argument to OFFSET is not a reference");const r=e[1];let n;if(r.type===IH.NUMBER&&Number.isInteger(r.value))n=r.value;else if(r.type===IH.PLUS_UNARY_OP&&r.value.type===IH.NUMBER&&Number.isInteger(r.value.value))n=r.value.value;else{if(r.type!==IH.MINUS_UNARY_OP||r.value.type!==IH.NUMBER||!Number.isInteger(r.value.value))return this.parsingError(AH.StaticOffsetError,"Second argument to OFFSET is not a static number");n=-r.value.value}const o=e[2];let i;if(o.type===IH.NUMBER&&Number.isInteger(o.value))i=o.value;else if(o.type===IH.PLUS_UNARY_OP&&o.value.type===IH.NUMBER&&Number.isInteger(o.value.value))i=o.value.value;else{if(o.type!==IH.MINUS_UNARY_OP||o.value.type!==IH.NUMBER||!Number.isInteger(o.value.value))return this.parsingError(AH.StaticOffsetError,"Third argument to OFFSET is not a static number");i=-o.value.value}const s=e[3];let a;if(void 0===s)a=1;else{if(s.type!==IH.NUMBER)return this.parsingError(AH.StaticOffsetError,"Fourth argument to OFFSET is not a static number");if(a=s.value,a<1)return this.parsingError(AH.StaticOffsetError,"Fourth argument to OFFSET is too small number");if(!Number.isInteger(a))return this.parsingError(AH.StaticOffsetError,"Fourth argument to OFFSET is not integer")}const l=e[4];let u;if(void 0===l)u=1;else{if(l.type!==IH.NUMBER)return this.parsingError(AH.StaticOffsetError,"Fifth argument to OFFSET is not a static number");if(u=l.value,u<1)return this.parsingError(AH.StaticOffsetError,"Fifth argument to OFFSET is too small number");if(!Number.isInteger(u))return this.parsingError(AH.StaticOffsetError,"Fifth argument to OFFSET is not integer")}const h=new Lx(t.reference.col+i,t.reference.row+n,t.reference.type);let c=h.col,d=h.row;if(t.reference.type!==Ix.CELL_REFERENCE_RELATIVE&&t.reference.type!==Ix.CELL_REFERENCE_ABSOLUTE_COL||(d+=this.formulaAddress.row),t.reference.type!==Ix.CELL_REFERENCE_RELATIVE&&t.reference.type!==Ix.CELL_REFERENCE_ABSOLUTE_ROW||(c+=this.formulaAddress.col),c<0||d<0)return LH(new pk(XU.REF,BH.OutOfSheet));if(1===u&&1===a)return MH(h);{const e=new Lx(h.col+u-1,h.row+a-1,h.type);return _H(h,e,OH.RELATIVE)}}parsingError(e,t){return this.customParsingError=NH(e,t),PH()}static rangeSheetReferenceType(e,t){return void 0===e?OH.RELATIVE:void 0===t?OH.START_ABSOLUTE:OH.BOTH_ABSOLUTE}}class vD{constructor(e){this.lexerConfig=e,this.lexer=new YF(e.allTokens,{ensureOptimizations:!0})}tokenizeFormula(e){const t=this.lexer.tokenize(e);let r=t.tokens;return r=this.trimTrailingWhitespaces(r),r=this.skipWhitespacesInsideRanges(r),r=this.skipWhitespacesBeforeArgSeparators(r),t.tokens=r,t}skipWhitespacesInsideRanges(e){return vD.filterTokensByNeighbors(e,((e,t,r)=>(lP(e,gD)||lP(e,hD))&&lP(t,this.lexerConfig.WhiteSpace)&&(lP(r,gD)||lP(r,hD))))}skipWhitespacesBeforeArgSeparators(e){return vD.filterTokensByNeighbors(e,((e,t,r)=>!lP(e,this.lexerConfig.ArgSeparator)&&lP(t,this.lexerConfig.WhiteSpace)&&lP(r,this.lexerConfig.ArgSeparator)))}static filterTokensByNeighbors(e,t){if(e.length<3)return e;let r=0;const n=[e[r++]];for(;r<e.length-1;)t(e[r-1],e[r],e[r+1])||n.push(e[r]),++r;return n.push(e[r]),n}trimTrailingWhitespaces(e){return e.length>0&&lP(e[e.length-1],this.lexerConfig.WhiteSpace)&&e.pop(),e}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class RD{constructor(e,t,r,n){this.config=e,this.lexerConfig=t,this.sheetMappingFn=r,this.namedExpressions=n}unparse(e,t){return"="+this.unparseAst(e,t)}unparseAst(e,t){var r,n;switch(e.type){case IH.EMPTY:return HH("",e.leadingWhitespace);case IH.NUMBER:return HH(SD(e.value,this.config.decimalSeparator),e.leadingWhitespace);case IH.STRING:return HH('"'+e.value+'"',e.leadingWhitespace);case IH.FUNCTION_CALL:{const r=e.args.map((e=>void 0!==e?this.unparseAst(e,t):"")).join(this.config.functionArgSeparator),n=(this.config.translationPackage.isFunctionTranslated(e.procedureName)?this.config.translationPackage.getFunctionTranslation(e.procedureName):e.procedureName)+"("+r+HH(")",e.internalWhitespace);return HH(n,e.leadingWhitespace)}case IH.NAMED_EXPRESSION:return HH((null===(r=this.namedExpressions.nearestNamedExpression(e.expressionName,t.sheet))||void 0===r?void 0:r.displayName)||e.expressionName,e.leadingWhitespace);case IH.CELL_REFERENCE:{let r;return r=void 0!==e.reference.sheet?this.unparseSheetName(e.reference.sheet)+"!":"",r+=null!==(n=e.reference.unparse(t))&&void 0!==n?n:this.config.translationPackage.getErrorTranslation(XU.REF),HH(r,e.leadingWhitespace)}case IH.COLUMN_RANGE:case IH.ROW_RANGE:case IH.CELL_RANGE:return HH(this.formatRange(e,t),e.leadingWhitespace);case IH.PLUS_UNARY_OP:{const r=this.unparseAst(e.value,t);return HH("+",e.leadingWhitespace)+r}case IH.MINUS_UNARY_OP:{const r=this.unparseAst(e.value,t);return HH("-",e.leadingWhitespace)+r}case IH.PERCENT_OP:return this.unparseAst(e.value,t)+HH("%",e.leadingWhitespace);case IH.ERROR:return HH(this.config.translationPackage.getErrorTranslation(e.error?e.error.type:XU.ERROR),e.leadingWhitespace);case IH.ERROR_WITH_RAW_INPUT:return HH(e.rawInput,e.leadingWhitespace);case IH.PARENTHESIS:{const r="("+this.unparseAst(e.expression,t)+HH(")",e.internalWhitespace);return HH(r,e.leadingWhitespace)}case IH.ARRAY:{const r="{"+e.args.map((e=>e.map((e=>this.unparseAst(e,t))).join(this.config.arrayColumnSeparator))).join(this.config.arrayRowSeparator)+HH("}",e.internalWhitespace);return HH(r,e.leadingWhitespace)}default:{const r=this.unparseAst(e.left,t),n=this.unparseAst(e.right,t);return r+HH(DH[e.type],e.leadingWhitespace)+n}}}unparseSheetName(e){const t=iL(e,this.sheetMappingFn);if(void 0===t)throw new QD(e);return t}formatRange(e,t){let r="",n="";void 0!==e.start.sheet&&e.sheetReferenceType!==OH.RELATIVE&&(r=this.unparseSheetName(e.start.sheet)+"!"),void 0!==e.end.sheet&&e.sheetReferenceType===OH.BOTH_ABSOLUTE&&(n=this.unparseSheetName(e.end.sheet)+"!");const o=e.start.unparse(t),i=e.end.unparse(t);return void 0===o||void 0===i?this.config.translationPackage.getErrorTranslation(XU.REF):`${r}${o}:${n}${i}`}}function SD(e,t){return e.toString().replace(".",t)}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class TD{constructor(e,t,r){this.config=e,this.functionRegistry=t,this.sheetMapping=r,this.statsCacheUsed=0,this.lexerConfig=wD(e),this.lexer=new vD(this.lexerConfig),this.formulaParser=new ED(this.lexerConfig,this.sheetMapping),this.cache=new UH(this.functionRegistry)}parse(e,t){this.formulaAddress=t;const r=this.tokenizeFormula(e);if(r.errors.length>0){const e=r.errors.map((e=>({type:AH.LexingError,message:e.message})));return{ast:PH(),errors:e,hasVolatileFunction:!1,hasStructuralChangeFunction:!1,dependencies:[]}}const n=this.computeHashFromTokens(r.tokens,t);let o=this.cache.get(n);if(void 0!==o)++this.statsCacheUsed;else{const e=this.bindWhitespacesToTokens(r.tokens),i=this.formulaParser.parseFromTokens(e,t);if(i.errors.length>0)return Object.assign(Object.assign({},i),{hasVolatileFunction:!1,hasStructuralChangeFunction:!1,dependencies:[]});o=this.cache.set(n,i.ast)}const{ast:i,hasVolatileFunction:s,hasStructuralChangeFunction:a}=o,l=this.convertReversedRangesToRegularRanges(i);return{ast:l,errors:[],hasVolatileFunction:s,hasStructuralChangeFunction:a,dependencies:bD(l,this.functionRegistry)}}convertReversedRangesToRegularRanges(e){switch(e.type){case IH.EMPTY:case IH.NUMBER:case IH.STRING:case IH.ERROR:case IH.ERROR_WITH_RAW_INPUT:case IH.CELL_REFERENCE:case IH.NAMED_EXPRESSION:return e;case IH.CELL_RANGE:{const{start:t,end:r}=e,n=this.orderCellRangeEnds(t,r);return Object.assign(Object.assign({},e),{start:n.start,end:n.end})}case IH.COLUMN_RANGE:{const{start:t,end:r}=e,n=this.orderColumnRangeEnds(t,r);return Object.assign(Object.assign({},e),{start:n.start,end:n.end})}case IH.ROW_RANGE:{const{start:t,end:r}=e,n=this.orderRowRangeEnds(t,r);return Object.assign(Object.assign({},e),{start:n.start,end:n.end})}case IH.PERCENT_OP:case IH.PLUS_UNARY_OP:case IH.MINUS_UNARY_OP:{const t=this.convertReversedRangesToRegularRanges(e.value);return Object.assign(Object.assign({},e),{value:t})}case IH.CONCATENATE_OP:case IH.EQUALS_OP:case IH.NOT_EQUAL_OP:case IH.LESS_THAN_OP:case IH.GREATER_THAN_OP:case IH.LESS_THAN_OR_EQUAL_OP:case IH.GREATER_THAN_OR_EQUAL_OP:case IH.MINUS_OP:case IH.PLUS_OP:case IH.TIMES_OP:case IH.DIV_OP:case IH.POWER_OP:{const t=this.convertReversedRangesToRegularRanges(e.left),r=this.convertReversedRangesToRegularRanges(e.right);return Object.assign(Object.assign({},e),{left:t,right:r})}case IH.PARENTHESIS:{const t=this.convertReversedRangesToRegularRanges(e.expression);return Object.assign(Object.assign({},e),{expression:t})}case IH.FUNCTION_CALL:{const t=e.args.map((e=>this.convertReversedRangesToRegularRanges(e)));return Object.assign(Object.assign({},e),{args:t})}case IH.ARRAY:{const t=e.args.map((e=>e.map((e=>this.convertReversedRangesToRegularRanges(e)))));return Object.assign(Object.assign({},e),{args:t})}}}orderCellRangeEnds(e,t){const r=[e,t],[n,o]=r.map((e=>e.toColumnAddress())).sort(_x.compareByAbsoluteAddress(this.formulaAddress)),[i,s]=r.map((e=>e.toRowAddress())).sort(xx.compareByAbsoluteAddress(this.formulaAddress)),[a,l]=r.map((e=>e.sheet)).sort(TD.compareSheetIds.bind(this));return{start:Lx.fromColAndRow(n,i,a),end:Lx.fromColAndRow(o,s,l)}}orderColumnRangeEnds(e,t){const r=[e,t],[n,o]=r.sort(_x.compareByAbsoluteAddress(this.formulaAddress)),[i,s]=r.map((e=>e.sheet)).sort(TD.compareSheetIds.bind(this));return{start:new _x(n.type,n.col,i),end:new _x(o.type,o.col,s)}}orderRowRangeEnds(e,t){const r=[e,t],[n,o]=r.sort(xx.compareByAbsoluteAddress(this.formulaAddress)),[i,s]=r.map((e=>e.sheet)).sort(TD.compareSheetIds.bind(this));return{start:new xx(n.type,n.row,i),end:new xx(o.type,o.row,s)}}static compareSheetIds(e,t){return(e=null!=e?e:1/0)-(t=null!=t?t:1/0)}fetchCachedResultForAst(e){const t=this.computeHashFromAst(e);return this.fetchCachedResult(t)}fetchCachedResult(e){const t=this.cache.get(e);if(void 0===t)throw new Error("There is no AST with such key in the cache");{const{ast:e,hasVolatileFunction:r,hasStructuralChangeFunction:n,relativeDependencies:o}=t;return{ast:e,errors:[],hasVolatileFunction:r,hasStructuralChangeFunction:n,dependencies:o}}}computeHashFromTokens(e,t){var r;let n="",o=0;for(;o<e.length;){const i=e[o];if(lP(i,gD)){const e=Zx(this.sheetMapping,i.image,t);n=void 0===e?n.concat(i.image):n.concat(e.hash(!0))}else if(lP(i,pD)){const e=i.image.toUpperCase().slice(0,-1),t=null!==(r=this.lexerConfig.functionMapping[e])&&void 0!==r?r:e;n=n.concat(t,"(")}else if(lP(i,cD)){const[e,r]=i.image.split(":"),o=Jx(this.sheetMapping,e,t),s=Jx(this.sheetMapping,r,t);n=void 0===o||void 0===s?n.concat("!REF"):n.concat(o.hash(!0),":",s.hash(!0))}else if(lP(i,dD)){const[e,r]=i.image.split(":"),o=eL(this.sheetMapping,e,t),s=eL(this.sheetMapping,r,t);n=void 0===o||void 0===s?n.concat("!REF"):n.concat(o.hash(!0),":",s.hash(!0))}else n=n.concat(i.image);o++}return n}rememberNewAst(e){const t=this.computeHashFromAst(e);return this.cache.maybeSetAndThenGet(t,e)}computeHashFromAst(e){return"="+this.computeHashOfAstNode(e)}computeHashOfAstNode(e){switch(e.type){case IH.EMPTY:return e.leadingWhitespace||"";case IH.NUMBER:return HH(SD(e.value,this.config.decimalSeparator),e.leadingWhitespace);case IH.STRING:return HH('"'+e.value+'"',e.leadingWhitespace);case IH.NAMED_EXPRESSION:return HH(e.expressionName,e.leadingWhitespace);case IH.FUNCTION_CALL:{const t=e.args.map((e=>this.computeHashOfAstNode(e))).join(this.config.functionArgSeparator),r=e.procedureName+"("+t+HH(")",e.internalWhitespace);return HH(r,e.leadingWhitespace)}case IH.CELL_REFERENCE:return HH(e.reference.hash(!0),e.leadingWhitespace);case IH.COLUMN_RANGE:case IH.ROW_RANGE:case IH.CELL_RANGE:return HH(e.start.hash(e.sheetReferenceType!==OH.RELATIVE)+":"+e.end.hash(e.sheetReferenceType===OH.BOTH_ABSOLUTE),e.leadingWhitespace);case IH.MINUS_UNARY_OP:return HH("-"+this.computeHashOfAstNode(e.value),e.leadingWhitespace);case IH.PLUS_UNARY_OP:return HH("+"+this.computeHashOfAstNode(e.value),e.leadingWhitespace);case IH.PERCENT_OP:return this.computeHashOfAstNode(e.value)+HH("%",e.leadingWhitespace);case IH.ERROR:return HH(this.config.translationPackage.getErrorTranslation(e.error?e.error.type:XU.ERROR),e.leadingWhitespace);case IH.ERROR_WITH_RAW_INPUT:return HH(e.rawInput,e.leadingWhitespace);case IH.ARRAY:return HH("{"+e.args.map((e=>e.map((e=>this.computeHashOfAstNode(e))).join(","))).join(";")+HH("}",e.internalWhitespace),e.leadingWhitespace);case IH.PARENTHESIS:{const t="("+this.computeHashOfAstNode(e.expression)+HH(")",e.internalWhitespace);return HH(t,e.leadingWhitespace)}default:return this.computeHashOfAstNode(e.left)+HH(DH[e.type],e.leadingWhitespace)+this.computeHashOfAstNode(e.right)}}bindWhitespacesToTokens(e){const t=[],r=e[0];lP(r,this.lexerConfig.WhiteSpace)||t.push(r);for(let n=1;n<e.length;++n){const r=e[n];if(lP(r,this.lexerConfig.WhiteSpace))continue;const o=e[n-1];lP(o,this.lexerConfig.WhiteSpace)&&(r.leadingWhitespace=o),t.push(r)}return t}tokenizeFormula(e){return this.lexer.tokenizeFormula(e)}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */const CD=(e,t,r,n)=>{switch(e.type){case IH.EMPTY:case IH.NUMBER:case IH.STRING:case IH.ERROR:return;case IH.NAMED_EXPRESSION:return void(n&&r.push(new MD(e.expressionName)));case IH.CELL_REFERENCE:return void(n&&r.push(new ND(e.reference)));case IH.CELL_RANGE:return void(n&&e.start.sheet===e.end.sheet&&r.push(new AD(e.start,e.end)));case IH.COLUMN_RANGE:return void(n&&e.start.sheet===e.end.sheet&&r.push(new ID(e.start,e.end)));case IH.ROW_RANGE:return void(n&&e.start.sheet===e.end.sheet&&r.push(new OD(e.start,e.end)));case IH.PERCENT_OP:case IH.PLUS_UNARY_OP:case IH.MINUS_UNARY_OP:return void CD(e.value,t,r,!0);case IH.CONCATENATE_OP:case IH.EQUALS_OP:case IH.NOT_EQUAL_OP:case IH.LESS_THAN_OP:case IH.GREATER_THAN_OP:case IH.LESS_THAN_OR_EQUAL_OP:case IH.GREATER_THAN_OR_EQUAL_OP:case IH.MINUS_OP:case IH.PLUS_OP:case IH.TIMES_OP:case IH.DIV_OP:case IH.POWER_OP:return CD(e.left,t,r,!0),void CD(e.right,t,r,!0);case IH.PARENTHESIS:return void CD(e.expression,t,r,n);case IH.FUNCTION_CALL:{const n=!t.doesFunctionNeedArgumentToBeComputed(e.procedureName);return void e.args.forEach((e=>CD(e,t,r,n)))}}},bD=(e,t)=>{const r=new Array;return CD(e,t,r,!0),r};
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
class ND{constructor(e){this.dependency=e}absolutize(e){return this.dependency.toSimpleCellAddress(e)}}class AD{constructor(e,t){this.start=e,this.end=t}absolutize(e){return new Ak(this.start.toSimpleCellAddress(e),this.end.toSimpleCellAddress(e))}}class ID{constructor(e,t){this.start=e,this.end=t}absolutize(e){const t=this.start.toSimpleColumnAddress(e),r=this.end.toSimpleColumnAddress(e);return new Ik(t.sheet,t.col,r.col)}}class OD{constructor(e,t){this.start=e,this.end=t}absolutize(e){const t=this.start.toSimpleRowAddress(e),r=this.end.toSimpleRowAddress(e);return new Ok(t.sheet,t.row,r.row)}}class MD{constructor(e){this.name=e}absolutize(e){return this}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */const _D=(e,t)=>e.map((e=>e.absolutize(t))),xD=Symbol("Empty value");function LD(e){return e instanceof FD?e.val:e}class FD{constructor(e,t){this.val=e,this.format=t}fromNumber(e){return new this.constructor(e)}}function PD(e,t){if("number"==typeof e)return t;{const r=e.fromNumber(t);return r.format=e.format,r}}class VD extends FD{getDetailedType(){return WD.NUMBER_DATE}}class HD extends FD{getDetailedType(){return WD.NUMBER_CURRENCY}}class DD extends FD{getDetailedType(){return WD.NUMBER_TIME}}class UD extends FD{getDetailedType(){return WD.NUMBER_DATETIME}}class kD extends FD{getDetailedType(){return WD.NUMBER_PERCENT}}function BD(e){return"number"==typeof e||e instanceof FD}var WD,GD;function jD(e){return e instanceof FD?{type:e.getDetailedType(),format:e.format}:{type:WD.NUMBER_RAW}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */!function(e){e.NUMBER_RAW="NUMBER_RAW",e.NUMBER_DATE="NUMBER_DATE",e.NUMBER_TIME="NUMBER_TIME",e.NUMBER_DATETIME="NUMBER_DATETIME",e.NUMBER_CURRENCY="NUMBER_CURRENCY",e.NUMBER_PERCENT="NUMBER_PERCENT"}(WD||(WD={}));class zD{constructor(e,t,r,n){this._data=e,this.range=t,this.dependencyGraph=r,this._hasOnlyNumbers=n,this.size=void 0===e?new Jk(t.effectiveWidth(r),t.effectiveHeight(r)):new Jk(e[0].length,e.length)}get data(){return this.ensureThatComputed(),this._data}static fromRange(e,t,r){return new zD(e,t,r,!0)}static onlyNumbers(e){return new zD(e,void 0,void 0,!0)}static onlyValues(e){return new zD(e,void 0,void 0,void 0)}static onlyRange(e,t){return new zD(void 0,e,t,void 0)}static fromScalar(e){return new zD([[e]],void 0,void 0,void 0)}isAdHoc(){return void 0===this.range}width(){return this.size.width}height(){return this.size.height}valuesFromTopLeftCorner(){this.ensureThatComputed();const e=[];for(let t=0;t<this._data.length;t++)for(let r=0;r<this._data[0].length;r++)e.push(this._data[t][r]);return e}*effectiveAddressesFromData(e){for(let t=0;t<this.data.length;++t){const r=this.data[t];for(let n=0;n<r.length;++n)yield wk(e.sheet,e.col+n,e.row+t)}}*entriesFromTopLeftCorner(e){this.ensureThatComputed();for(let t=0;t<this.size.height;++t)for(let r=0;r<this.size.width;++r)yield[this._data[t][r],wk(e.sheet,e.col+r,e.row+t)]}*iterateValuesFromTopLeftCorner(){yield*this.valuesFromTopLeftCorner()}numberOfElements(){return this.size.width*this.size.height}hasOnlyNumbers(){if(void 0===this._hasOnlyNumbers){this._hasOnlyNumbers=!0;for(const e of this.data)for(const t of e)if("number"!=typeof t)return this._hasOnlyNumbers=!1,!1}return this._hasOnlyNumbers}rawNumbers(){return this._data}rawData(){var e;return this.ensureThatComputed(),null!==(e=this._data)&&void 0!==e?e:[]}sameDimensionsAs(e){return this.width()===e.width()&&this.height()===e.height()}ensureThatComputed(){void 0===this._data&&(this._hasOnlyNumbers=!0,this._data=this.range.addressesArrayMap(this.dependencyGraph,(e=>{const t=this.dependencyGraph.getCellValue(e);return t instanceof zD?(this._hasOnlyNumbers=!1,new pk(XU.VALUE,BH.ScalarExpected)):(BD(t)||(this._hasOnlyNumbers=!1),t)})))}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class $D{constructor(){this.changes=new Map}static empty(){return new $D}addAll(e){for(const t of e.changes.values())this.add(t.address,t);return this}addChange(e,t,r){this.addInterpreterValue(e,t,r)}exportChanges(e){let t=[];return this.changes.forEach((r=>{const n=e.exportChange(r);Array.isArray(n)?t=t.concat(n):t.push(n)})),t}getChanges(){return Array.from(this.changes.values())}isEmpty(){return 0===this.changes.size}add(e,t){const r=t.value;if(r instanceof zD)for(const n of r.effectiveAddressesFromData(e))this.changes.delete(Rk(n));this.changes.set(Rk(e),t)}addInterpreterValue(e,t,r){this.add(t,{address:t,value:e,oldValue:r})}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class YD{constructor(e,t,r){if(this.sheet=e,this.rowStart=t,this.rowEnd=r,t<0)throw Error("Starting row cant be less than 0");if(r<t)throw Error("Row span cant end before start")}get numberOfRows(){return this.rowEnd-this.rowStart+1}get start(){return this.rowStart}get end(){return this.rowEnd}static fromNumberOfRows(e,t,r){return new YD(e,t,t+r-1)}static fromRowStartAndEnd(e,t,r){return new YD(e,t,r)}*rows(){for(let e=this.rowStart;e<=this.rowEnd;++e)yield e}intersect(e){if(this.sheet!==e.sheet)throw Error("Can't intersect spans from different sheets");const t=Math.max(this.rowStart,e.rowStart),r=Math.min(this.rowEnd,e.rowEnd);return t>r?null:new YD(this.sheet,t,r)}firstRow(){return new YD(this.sheet,this.rowStart,this.rowStart)}}class XD{constructor(e,t,r){if(this.sheet=e,this.columnStart=t,this.columnEnd=r,t<0)throw Error("Starting column cant be less than 0");if(r<t)throw Error("Column span cant end before start")}get numberOfColumns(){return this.columnEnd-this.columnStart+1}get start(){return this.columnStart}get end(){return this.columnEnd}static fromNumberOfColumns(e,t,r){return new XD(e,t,t+r-1)}static fromColumnStartAndEnd(e,t,r){return new XD(e,t,r)}*columns(){for(let e=this.columnStart;e<=this.columnEnd;++e)yield e}intersect(e){if(this.sheet!==e.sheet)throw Error("Can't intersect spans from different sheets");const t=Math.max(this.columnStart,e.columnStart),r=Math.min(this.columnEnd,e.columnEnd);return t>r?null:new XD(this.sheet,t,r)}firstColumn(){return new XD(this.sheet,this.columnStart,this.columnStart)}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */!function(e){e.BUILD_ENGINE_TOTAL="BUILD_ENGINE_TOTAL",e.PARSER="PARSER",e.GRAPH_BUILD="GRAPH_BUILD",e.COLLECT_DEPENDENCIES="COLLECT_DEPENDENCIES",e.PROCESS_DEPENDENCIES="PROCESS_DEPENDENCIES",e.TOP_SORT="TOP_SORT",e.BUILD_COLUMN_INDEX="BUILD_COLUMN_INDEX",e.EVALUATION="EVALUATION",e.VLOOKUP="VLOOKUP",e.TRANSFORM_ASTS="TRANSFORM_ASTS",e.TRANSFORM_ASTS_POSTPONED="TRANSFORM_ASTS_POSTPONED",e.ADJUSTING_ADDRESS_MAPPING="ADJUSTING_ADDRESS_MAPPING",e.ADJUSTING_ARRAY_MAPPING="ADJUSTING_ARRAY_MAPPING",e.ADJUSTING_RANGES="ADJUSTING_RANGES",e.ADJUSTING_GRAPH="ADJUSTING_GRAPH",e.CRITERION_FUNCTION_FULL_CACHE_USED="CRITERION_FUNCTION_FULL_CACHE_USED",e.CRITERION_FUNCTION_PARTIAL_CACHE_USED="CRITERION_FUNCTION_PARTIAL_CACHE_USED"}(GD||(GD={}));
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
class KD{constructor(){this.stats=new Map([[GD.CRITERION_FUNCTION_FULL_CACHE_USED,0],[GD.CRITERION_FUNCTION_PARTIAL_CACHE_USED,0]]),this.startTimes=new Map}incrementCriterionFunctionFullCacheUsed(){var e;const t=(null!==(e=this.stats.get(GD.CRITERION_FUNCTION_FULL_CACHE_USED))&&void 0!==e?e:0)+1;this.stats.set(GD.CRITERION_FUNCTION_FULL_CACHE_USED,t)}incrementCriterionFunctionPartialCacheUsed(){var e;const t=(null!==(e=this.stats.get(GD.CRITERION_FUNCTION_PARTIAL_CACHE_USED))&&void 0!==e?e:0)+1;this.stats.set(GD.CRITERION_FUNCTION_PARTIAL_CACHE_USED,t)}reset(){this.stats.clear(),this.startTimes.clear(),this.stats.set(GD.CRITERION_FUNCTION_FULL_CACHE_USED,0),this.stats.set(GD.CRITERION_FUNCTION_PARTIAL_CACHE_USED,0)}start(e){if(this.startTimes.get(e))throw Error(`Statistics ${e} already started`);this.startTimes.set(e,Date.now())}end(e){var t;const r=Date.now(),n=this.startTimes.get(e);if(!n)throw Error(`Statistics ${e} not started`);{let o=null!==(t=this.stats.get(e))&&void 0!==t?t:0;o+=r-n,this.stats.set(e,o),this.startTimes.delete(e)}}measure(e,t){this.start(e);const r=t();return this.end(e),r}snapshot(){return new Map(this.stats)}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class qD extends KD{incrementCriterionFunctionFullCacheUsed(){}incrementCriterionFunctionPartialCacheUsed(){}start(e){}end(e){}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class QD extends Error{constructor(e){super(`There's no sheet with id = ${e}`)}}class ZD extends Error{constructor(e){super(`There's no sheet with name '${e}'`)}}class JD extends Error{constructor(e){super(`Sheet with name ${e} already exists`)}}class eU extends Error{constructor(){super("Sheet size limit exceeded")}}class tU extends Error{constructor(){super("This is not a formula")}}class rU extends Error{constructor(e){super(`Address (row = ${e.row}, col = ${e.col}) is invalid`)}}class nU extends Error{constructor(e){super(`Invalid arguments, expected ${e}`)}}class oU extends Error{constructor(e,t){super(`Sheets ${e} and ${t} are not equal.`)}}class iU extends Error{constructor(e){super(`Name of Named Expression '${e}' is already present`)}}class sU extends Error{constructor(e){super(`Name of Named Expression '${e}' is invalid`)}}class aU extends Error{constructor(e){super(`Named Expression '${e}' does not exist`)}}class lU extends Error{constructor(){super("There is no operation to undo")}}class uU extends Error{constructor(){super("There is no operation to redo")}}class hU extends Error{constructor(){super("There is nothing to paste")}}function cU(e,t){switch(typeof t){case"function":case"symbol":return t.toString();case"bigint":return"BigInt("+t.toString()+")";default:return t instanceof RegExp?"RegExp("+t.toString()+")":t}}class dU extends Error{constructor(e){super(`Unable to parse value: ${JSON.stringify(e,cU,4)}`)}}class pU extends Error{constructor(e,t){super(`Expected value of type: ${e} for config parameter: ${t}`)}}class mU extends Error{constructor(e){super(`Config parameter ${e} cannot be empty.`)}}class gU extends Error{constructor(e,t){super(`Config parameter ${e} should be at least ${t}`)}}class fU extends Error{constructor(e,t){super(`Config parameter ${e} should be at most ${t}`)}}class yU extends Error{constructor(e,t){super(`Expected one of ${e} for config parameter: ${t}`)}}class wU extends Error{constructor(){super("Computations are suspended")}}class EU extends Error{constructor(e){super(`Translation for ${e} is missing in the translation package you're using.`)}}class vU extends Error{constructor(e){super(`Cannot register translation for function with id: ${e}`)}}class RU extends Error{constructor(){super("Language not registered.")}}class SU extends Error{constructor(){super("Language already registered.")}}class TU extends Error{static functionNotDeclaredInPlugin(e,t){return new TU(`Function with id ${e} not declared in plugin ${t}`)}static functionMethodNotFound(e,t){return new TU(`Function method ${e} not found in plugin ${t}`)}}class CU extends Error{static cannotRegisterFunctionWithId(e){return new CU(`Cannot register function with id ${e}`)}static cannotUnregisterFunctionWithId(e){return new CU(`Cannot unregister function with id ${e}`)}static cannotUnregisterProtectedPlugin(){return new CU("Cannot unregister protected plugin")}}class bU extends Error{constructor(){super("Cannot perform this operation, source location has an array inside.")}}class NU extends Error{constructor(){super("Cannot perform this operation, target location has an array inside.")}}class AU extends Error{constructor(){super("Relative addresses not allowed in named expressions.")}}class IU extends Error{constructor(e,t){super(`Alias id ${e} in plugin ${t} already defined as a function or alias.`)}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class OU{constructor(e){this.policy=e,this.mapping=new Map}getCell(e){const t=this.mapping.get(e.sheet);if(void 0===t)throw new QD(e.sheet);return t.getCell(e)}fetchCell(e){const t=this.mapping.get(e.sheet);if(void 0===t)throw new QD(e.sheet);const r=t.getCell(e);if(!r)throw Error("Vertex for address missing in AddressMapping");return r}strategyFor(e){const t=this.mapping.get(e);if(void 0===t)throw new QD(e);return t}addSheet(e,t){if(this.mapping.has(e))throw Error("Sheet already added");this.mapping.set(e,t)}autoAddSheet(e,t){const{height:r,width:n,fill:o}=t,i=this.policy.call(o);this.addSheet(e,new i(n,r))}getCellValue(e){const t=this.getCell(e);return void 0===t?xD:t instanceof PU?t.getArrayCellValue(e):t.getCellValue()}getRawValue(e){const t=this.getCell(e);return t instanceof tk?t.getValues().rawValue:t instanceof PU?t.getArrayCellRawValue(e):null}setCell(e,t){const r=this.mapping.get(e.sheet);if(!r)throw Error("Sheet not initialized");r.setCell(e,t)}moveCell(e,t){const r=this.mapping.get(e.sheet);if(!r)throw Error("Sheet not initialized.");if(e.sheet!==t.sheet)throw Error("Cannot move cells between sheets.");if(r.has(t))throw new Error("Cannot move cell. Destination already occupied.");const n=r.getCell(e);if(void 0===n)throw new Error("Cannot move cell. No cell with such address.");this.setCell(t,n),this.removeCell(e)}removeCell(e){const t=this.mapping.get(e.sheet);if(!t)throw Error("Sheet not initialized");t.removeCell(e)}has(e){const t=this.mapping.get(e.sheet);return void 0!==t&&t.has(e)}getHeight(e){const t=this.mapping.get(e);if(void 0===t)throw new QD(e);return t.getHeight()}getWidth(e){const t=this.mapping.get(e);if(!t)throw new QD(e);return t.getWidth()}addRows(e,t,r){const n=this.mapping.get(e);if(void 0===n)throw new QD(e);n.addRows(t,r)}removeRows(e){const t=this.mapping.get(e.sheet);if(void 0===t)throw new QD(e.sheet);t.removeRows(e)}removeSheet(e){this.mapping.delete(e)}addColumns(e,t,r){const n=this.mapping.get(e);if(void 0===n)throw new QD(e);n.addColumns(t,r)}removeColumns(e){const t=this.mapping.get(e.sheet);if(void 0===t)throw new QD(e.sheet);t.removeColumns(e)}*verticesFromRowsSpan(e){yield*this.mapping.get(e.sheet).verticesFromRowsSpan(e)}*verticesFromColumnsSpan(e){yield*this.mapping.get(e.sheet).verticesFromColumnsSpan(e)}*entriesFromRowsSpan(e){yield*this.mapping.get(e.sheet).entriesFromRowsSpan(e)}*entriesFromColumnsSpan(e){yield*this.mapping.get(e.sheet).entriesFromColumnsSpan(e)}*entries(){for(const[e,t]of this.mapping.entries())yield*t.getEntries(e)}*sheetEntries(e){const t=this.mapping.get(e);if(void 0===t)throw new QD(e);yield*t.getEntries(e)}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class MU{constructor(){this.arrayMapping=new Map}getArray(e){const t=this.getArrayByCorner(e.start);if(null==t?void 0:t.getRange().sameAs(e))return t}getArrayByCorner(e){return this.arrayMapping.get(Rk(e))}setArray(e,t){this.arrayMapping.set(Rk(e.start),t)}removeArray(e){"string"==typeof e?this.arrayMapping.delete(e):this.arrayMapping.delete(Rk(e.start))}count(){return this.arrayMapping.size}*arraysInRows(e){for(const[t,r]of this.arrayMapping.entries())r.spansThroughSheetRows(e.sheet,e.rowStart,e.rowEnd)&&(yield[t,r])}*arraysInCols(e){for(const[t,r]of this.arrayMapping.entries())r.spansThroughSheetColumn(e.sheet,e.columnStart,e.columnEnd)&&(yield[t,r])}isFormulaArrayInRow(e,t){for(const r of this.arrayMapping.values())if(r.spansThroughSheetRows(e,t))return!0;return!1}isFormulaArrayInAllRows(e){let t=!0;for(const r of e.rows())this.isFormulaArrayInRow(e.sheet,r)||(t=!1);return t}isFormulaArrayInColumn(e,t){for(const r of this.arrayMapping.values())if(r.spansThroughSheetColumn(e,t))return!0;return!1}isFormulaArrayInAllColumns(e){let t=!0;for(const r of e.columns())this.isFormulaArrayInColumn(e.sheet,r)||(t=!1);return t}isFormulaArrayInRange(e){for(const t of this.arrayMapping.values())if(t.getRange().doesOverlap(e))return!0;return!1}isFormulaArrayAtAddress(e){for(const t of this.arrayMapping.values())if(t.getRange().addressInRange(e))return!0;return!1}moveArrayVerticesAfterRowByRows(e,t,r){this.updateArrayVerticesInSheet(e,((e,n)=>{const o=n.getRange();return t<=o.start.row?[o.shifted(0,r),n]:void 0}))}moveArrayVerticesAfterColumnByColumns(e,t,r){this.updateArrayVerticesInSheet(e,((e,n)=>{const o=n.getRange();return t<=o.start.col?[o.shifted(r,0),n]:void 0}))}updateArrayVerticesInSheet(e,t){const r=Array();for(const[n,o]of this.arrayMapping.entries()){if(o.sheet!==e)continue;const i=t(n,o);void 0!==i&&(this.removeArray(n),r.push(i))}r.forEach((([e,t])=>{this.setArray(e,t)}))}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class _U{constructor(e){this.size=e}width(){return this.size.width}height(){return this.size.height}get(e,t){throw Error("Array not computed yet.")}simpleRangeValue(){throw Error("Array not computed yet.")}}class xU{constructor(e){if(this.size=new Jk(e.length>0?e[0].length:0,e.length),this.array=e,this.size.width<=0||this.size.height<=0)throw Error("Incorrect array size")}static fromInterpreterValue(e){return new xU(e instanceof zD?e.data:[[e]])}simpleRangeValue(){return zD.onlyValues(this.array)}addRows(e,t){this.array.splice(e,0,...this.nullArrays(t,this.width())),this.size.height+=t}addColumns(e,t){for(let r=0;r<this.height();r++)this.array[r].splice(e,0,...new Array(t).fill(xD));this.size.width+=t}removeRows(e,t){if(this.outOfBound(0,e)||this.outOfBound(0,t))throw Error("Array index out of bound");const r=t-e+1;this.array.splice(e,r),this.size.height-=r}removeColumns(e,t){if(this.outOfBound(e,0)||this.outOfBound(t,0))throw Error("Array index out of bound");const r=t-e+1;for(const n of this.array)n.splice(e,r);this.size.width-=r}nullArrays(e,t){const r=[];for(let n=0;n<e;++n)r.push(new Array(t).fill(xD));return r}get(e,t){if(this.outOfBound(e,t))throw Error("Array index out of bound");return this.array[t][e]}set(e,t,r){if(this.outOfBound(e,t))throw Error("Array index out of bound");this.array[t][e]=r}width(){return this.size.width}height(){return this.size.height}raw(){return this.array}resize(e){if(this.height()<e.height&&isFinite(e.height)&&this.addRows(this.height(),e.height-this.height()),this.height()>e.height)throw Error("Resizing to smaller array");if(this.width()<e.width&&isFinite(e.width)&&this.addColumns(this.width(),e.width-this.width()),this.width()>e.width)throw Error("Resizing to smaller array")}outOfBound(e,t){return e<0||t<0||t>this.size.height-1||e>this.size.width-1}}class LU{constructor(e,t){this.error=e,this.size=t}get(e,t){return this.error}width(){return this.size.width}height(){return this.size.height}simpleRangeValue(){return this.error}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class FU{constructor(e,t,r){this.formula=e,this.cellAddress=t,this.version=r}get width(){return 1}get height(){return 1}static fromAst(e,t,r,n){return r.isScalar()?new VU(e,t,n):new PU(e,t,r,n)}getFormula(e){return this.ensureRecentData(e),this.formula}ensureRecentData(e){if(this.version!=e.version()){const[t,r,n]=e.applyTransformations(this.formula,this.cellAddress,this.version);this.formula=t,this.cellAddress=r,this.version=n}}getAddress(e){return this.ensureRecentData(e),this.cellAddress}}class PU extends FU{constructor(e,t,r,n=0){super(e,t,n),r.isRef?this.array=new LU(new pk(XU.REF,BH.NoSpaceForArrayResult),Jk.error()):this.array=new _U(r)}get width(){return this.array.width()}get height(){return this.array.height()}get sheet(){return this.cellAddress.sheet}get leftCorner(){return this.cellAddress}setCellValue(e){if(e instanceof pk)return this.setErrorValue(e),e;const t=xU.fromInterpreterValue(e);return t.resize(this.array.size),this.array=t,e}getCellValue(){if(this.array instanceof _U)throw Error("Array not computed yet.");return this.array.simpleRangeValue()}valueOrUndef(){if(!(this.array instanceof _U))return this.array.simpleRangeValue()}getArrayCellValue(e){const t=e.col-this.cellAddress.col,r=e.row-this.cellAddress.row;try{return this.array.get(t,r)}catch(n){return new pk(XU.REF)}}getArrayCellRawValue(e){const t=this.getArrayCellValue(e);return t instanceof pk||t===xD?void 0:LD(t)}setArrayCellValue(e,t){const r=e.col-this.cellAddress.col,n=e.row-this.cellAddress.row;this.array instanceof xU&&this.array.set(r,n,t)}setNoSpace(){return this.array=new LU(new pk(XU.SPILL,BH.NoSpaceForArrayResult),Jk.error()),this.getCellValue()}getRange(){return Ak.spanFrom(this.cellAddress,this.width,this.height)}getRangeOrUndef(){return Ak.spanFromOrUndef(this.cellAddress,this.width,this.height)}setAddress(e){this.cellAddress=e}setFormula(e){this.formula=e}spansThroughSheetRows(e,t,r=t){return this.cellAddress.sheet===e&&this.cellAddress.row<=r&&t<this.cellAddress.row+this.height}spansThroughSheetColumn(e,t,r=t){return this.cellAddress.sheet===e&&this.cellAddress.col<=r&&t<this.cellAddress.col+this.width}isComputed(){return!(this.array instanceof _U)}columnsFromArray(){return XD.fromNumberOfColumns(this.cellAddress.sheet,this.cellAddress.col,this.width)}rowsFromArray(){return YD.fromNumberOfRows(this.cellAddress.sheet,this.cellAddress.row,this.height)}ensureRecentData(e){}isLeftCorner(e){return Ck(this.cellAddress,e)}setErrorValue(e){this.array=new LU(e,this.array.size)}}class VU extends FU{constructor(e,t,r){super(e,t,r)}valueOrUndef(){return this.cachedCellValue}setCellValue(e){return this.cachedCellValue=e,this.cachedCellValue}getCellValue(){if(void 0!==this.cachedCellValue)return this.cachedCellValue;throw Error("Value of the formula cell is not computed.")}isComputed(){return void 0!==this.cachedCellValue}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class HU{constructor(e){this.range=e,this.functionCache=new Map,this.criterionFunctionCache=new Map,this.dependentCacheRanges=new Set,this.bruteForce=!1}get start(){return this.range.start}get end(){return this.range.end}get sheet(){return this.range.start.sheet}getFunctionValue(e){return this.functionCache.get(e)}setFunctionValue(e,t){this.functionCache.set(e,t)}getCriterionFunctionValue(e,t){var r;return null===(r=this.getCriterionFunctionValues(e).get(t))||void 0===r?void 0:r[0]}getCriterionFunctionValues(e){var t;return null!==(t=this.criterionFunctionCache.get(e))&&void 0!==t?t:new Map}setCriterionFunctionValues(e,t){this.criterionFunctionCache.set(e,t)}addDependentCacheRange(e){e!==this&&this.dependentCacheRanges.add(e)}clearCache(){this.functionCache.clear(),this.criterionFunctionCache.clear(),this.dependentCacheRanges.forEach((e=>e.criterionFunctionCache.clear())),this.dependentCacheRanges.clear()}getStart(){return this.start}getEnd(){return this.end}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */const DU=(e,t,r,n,o)=>{if(t instanceof HU){const e=t.range.intersectionWith(r);return void 0!==e?Array.from(e.addresses(o)):[]}let i,s;return t instanceof FU?(i=t.getFormula(n),s=t.getAddress(n),bD(i,e).filter((e=>e instanceof ND)).map((e=>e.dependency.toSimpleCellAddress(s))).filter((e=>r.addressInRange(e)))):[]};
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */var UU;!function(e){e[e.ON_STACK=0]="ON_STACK",e[e.PROCESSED=1]="PROCESSED",e[e.POPPED=2]="POPPED"}(UU||(UU={}));class kU{constructor(e=[],t=[]){this.nodesSparseArray=e,this.edgesSparseArray=t,this.entranceTime=[],this.low=[],this.parent=[],this.inSCC=[],this.nodeStatus=[],this.order=[],this.sccNonSingletons=[],this.timeCounter=0}getTopSortedWithSccSubgraphFrom(e,t,r){const n=e.reverse();return n.forEach((e=>this.runDFS(e))),this.postprocess(n,r,t)}getAdjacentNodeIds(e){return this.edgesSparseArray[e].filter((e=>void 0!==e&&this.nodesSparseArray[e]))}runDFS(e){if(void 0!==this.nodeStatus[e])return;this.nodeStatus[e]=UU.ON_STACK;const t=[e],r=[];for(;t.length>0;){const e=t[t.length-1];switch(this.nodeStatus[e]){case UU.ON_STACK:this.handleOnStack(e,r,t);break;case UU.PROCESSED:this.handleProcessed(e,r,t);break;case UU.POPPED:t.pop()}}}handleOnStack(e,t,r){this.entranceTime[e]=this.timeCounter,this.low[e]=this.timeCounter,this.timeCounter++,t.push(e),this.getAdjacentNodeIds(e).forEach((t=>{void 0===this.entranceTime[t]&&(r.push(t),this.parent[t]=e,this.nodeStatus[t]=UU.ON_STACK)})),this.nodeStatus[e]=UU.PROCESSED}handleProcessed(e,t,r){let n=this.entranceTime[e];if(this.getAdjacentNodeIds(e).forEach((t=>{this.inSCC[t]||(n=this.parent[t]===e?Math.min(n,this.low[t]):Math.min(n,this.entranceTime[t]))})),this.low[e]=n,n===this.entranceTime[e]){const r=[];do{r.push(t[t.length-1]),t.pop()}while(r[r.length-1]!==e);r.forEach((e=>{this.inSCC[e]=!0})),this.order.push(...r),r.length>1&&r.forEach((e=>{this.sccNonSingletons[e]=!0}))}r.pop(),this.nodeStatus[e]=UU.POPPED}postprocess(e,t,r){const n=[];e.forEach((e=>{n[e]=!0}));const o=[],i=[];return this.order.reverse(),this.order.forEach((e=>{const s=this.getAdjacentNodeIds(e);this.sccNonSingletons[e]||s.includes(e)?(i.push(this.nodesSparseArray[e]),t(this.nodesSparseArray[e]),s.forEach((e=>n[e]=!0))):(o.push(this.nodesSparseArray[e]),n[e]&&r(this.nodesSparseArray[e])&&s.forEach((e=>n[e]=!0)))})),{sorted:o,cycled:i}}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class BU{constructor(e,t){this.rawValue=e,this.processFn=t,this.processedValue=null}getProcessedValue(){return null===this.processedValue&&(this.processedValue=this.processFn(this.rawValue)),this.processedValue}markAsModified(){this.processedValue=null}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class WU{constructor(e){this.dependencyQuery=e,this.nodesSparseArray=[],this.edgesSparseArray=[],this.nodesIds=new Map,this.dirtyAndVolatileNodeIds=new BU({dirty:[],volatile:[]},(e=>this.processDirtyAndVolatileNodeIds(e))),this.infiniteRangeIds=new Set,this.changingWithStructureNodeIds=[],this.nextId=0}getNodes(){return this.nodesSparseArray.filter((e=>void 0!==e))}hasNode(e){return this.nodesIds.has(e)}existsEdge(e,t){const r=this.getNodeId(e),n=this.getNodeId(t);return void 0!==r&&void 0!==n&&this.edgesSparseArray[r].includes(n)}adjacentNodes(e){const t=this.getNodeId(e);if(void 0===t)throw this.missingNodeError(e);return new Set(this.edgesSparseArray[t].filter((e=>void 0!==e)).map((e=>this.nodesSparseArray[e])))}adjacentNodesCount(e){const t=this.getNodeId(e);if(void 0===t)throw this.missingNodeError(e);return this.fixEdgesArrayForNode(t).length}addNodeAndReturnId(e){const t=this.nodesIds.get(e);if(void 0!==t)return t;const r=this.nextId;return this.nextId++,this.nodesSparseArray[r]=e,this.edgesSparseArray[r]=[],this.nodesIds.set(e,r),r}addEdge(e,t){const r=this.getNodeIdIfNotNumber(e),n=this.getNodeIdIfNotNumber(t);if(void 0===r)throw this.missingNodeError(e);if(void 0===n)throw this.missingNodeError(t);this.edgesSparseArray[r].includes(n)||this.edgesSparseArray[r].push(n)}removeNode(e){const t=this.getNodeId(e);if(void 0===t)throw this.missingNodeError(e);this.edgesSparseArray[t].length>0&&(this.edgesSparseArray[t].forEach((e=>this.dirtyAndVolatileNodeIds.rawValue.dirty.push(e))),this.dirtyAndVolatileNodeIds.markAsModified());const r=this.removeDependencies(e);return delete this.nodesSparseArray[t],delete this.edgesSparseArray[t],this.infiniteRangeIds.delete(t),this.nodesIds.delete(e),r}removeEdge(e,t){const r=this.getNodeIdIfNotNumber(e),n=this.getNodeIdIfNotNumber(t);if(void 0===r)throw this.missingNodeError(e);if(void 0===n)throw this.missingNodeError(t);const o=this.edgesSparseArray[r].indexOf(n);if(-1===o)throw new Error("Edge does not exist");delete this.edgesSparseArray[r][o]}removeEdgeIfExists(e,t){const r=this.getNodeId(e),n=this.getNodeId(t);if(void 0===r)return;if(void 0===n)return;const o=this.edgesSparseArray[r].indexOf(n);-1!==o&&delete this.edgesSparseArray[r][o]}topSortWithScc(){return this.getTopSortedWithSccSubgraphFrom(this.getNodes(),(()=>!0),(()=>{}))}getTopSortedWithSccSubgraphFrom(e,t,r){const n=new kU(this.nodesSparseArray,this.edgesSparseArray),o=e.map((e=>this.getNodeId(e))).filter((e=>void 0!==e));return n.getTopSortedWithSccSubgraphFrom(o,t,r)}markNodeAsVolatile(e){const t=this.getNodeId(e);void 0!==t&&(this.dirtyAndVolatileNodeIds.rawValue.volatile.push(t),this.dirtyAndVolatileNodeIds.markAsModified())}markNodeAsDirty(e){const t=this.getNodeId(e);void 0!==t&&(this.dirtyAndVolatileNodeIds.rawValue.dirty.push(t),this.dirtyAndVolatileNodeIds.markAsModified())}getDirtyAndVolatileNodes(){return this.dirtyAndVolatileNodeIds.getProcessedValue()}clearDirtyNodes(){this.dirtyAndVolatileNodeIds.rawValue.dirty=[],this.dirtyAndVolatileNodeIds.markAsModified()}markNodeAsChangingWithStructure(e){const t=this.getNodeId(e);void 0!==t&&this.changingWithStructureNodeIds.push(t)}markChangingWithStructureNodesAsDirty(){this.changingWithStructureNodeIds.length<=0||(this.dirtyAndVolatileNodeIds.rawValue.dirty=[...this.dirtyAndVolatileNodeIds.rawValue.dirty,...this.changingWithStructureNodeIds],this.dirtyAndVolatileNodeIds.markAsModified())}markNodeAsInfiniteRange(e){const t=this.getNodeIdIfNotNumber(e);void 0!==t&&this.infiniteRangeIds.add(t)}getInfiniteRanges(){return[...this.infiniteRangeIds].map((e=>({node:this.nodesSparseArray[e],id:e})))}getNodeId(e){return this.nodesIds.get(e)}getNodeIdIfNotNumber(e){return"number"==typeof e?e:this.nodesIds.get(e)}fixEdgesArrayForNode(e){const t=this.edgesSparseArray[e];return this.edgesSparseArray[e]=t.filter((e=>void 0!==e&&this.nodesSparseArray[e])),this.edgesSparseArray[e]}removeDependencies(e){const t=this.dependencyQuery(e);return t.forEach((([t,r])=>{this.removeEdgeIfExists(r,e)})),t}processDirtyAndVolatileNodeIds({dirty:e,volatile:t}){return[...new Set([...e,...t])].map((e=>this.nodesSparseArray[e])).filter((e=>void 0!==e))}missingNodeError(e){return new Error(`Unknown node ${e}`)}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class GU{constructor(){this.rangeMapping=new Map}getMappingSize(e){var t,r;return null!==(r=null===(t=this.rangeMapping.get(e))||void 0===t?void 0:t.size)&&void 0!==r?r:0}setRange(e){let t=this.rangeMapping.get(e.getStart().sheet);void 0===t&&(t=new Map,this.rangeMapping.set(e.getStart().sheet,t));const r=jU(e.getStart(),e.getEnd());t.set(r,e)}removeRange(e){const t=e.getStart().sheet,r=this.rangeMapping.get(t);if(void 0===r)return;const n=jU(e.getStart(),e.getEnd());r.delete(n),0===r.size&&this.rangeMapping.delete(t)}getRange(e,t){const r=this.rangeMapping.get(e.sheet),n=jU(e,t);return null==r?void 0:r.get(n)}fetchRange(e,t){const r=this.getRange(e,t);if(!r)throw Error("Range does not exist");return r}truncateRanges(e,t){const r=Array(),n=Array(),o=Array(),i=e.sheet;for(const[l,u]of this.entriesFromSheet(e.sheet)){const s=u.range;e.start<=t(u.range.end)&&(s.removeSpan(e),s.shouldBeRemoved()?(this.removeByKey(i,l),r.push(u)):n.push([l,u]),o.push(u))}const s=[];n.sort(((e,r)=>zU(e[1],r[1],t)));for(const[l,u]of n){const e=jU((a=u.range).start,a.end);if(e===l)continue;const t=this.getByKey(i,e);this.removeByKey(i,l),void 0!==t&&u!=t?s.push([t,u]):this.setRange(u)}var a;return{verticesToRemove:r,verticesToMerge:s,verticesWithChangedSize:o}}moveAllRangesInSheetAfterRowByRows(e,t,r){return this.updateVerticesFromSheet(e,((e,n)=>t<=n.start.row?(n.range.shiftByRows(r),{changedSize:!1,vertex:n}):t>n.start.row&&t<=n.end.row?(n.range.expandByRows(r),{changedSize:!0,vertex:n}):void 0))}moveAllRangesInSheetAfterColumnByColumns(e,t,r){return this.updateVerticesFromSheet(e,((e,n)=>t<=n.start.col?(n.range.shiftByColumns(r),{changedSize:!1,vertex:n}):t>n.start.col&&t<=n.end.col?(n.range.expandByColumns(r),{changedSize:!0,vertex:n}):void 0))}moveRangesInsideSourceRange(e,t,r,n){this.updateVerticesFromSheet(e.sheet,((o,i)=>e.containsRange(i.range)?(i.range.shiftByColumns(t),i.range.shiftByRows(r),i.range.moveToSheet(n),{changedSize:!1,vertex:i}):void 0))}removeRangesInSheet(e){if(this.rangeMapping.has(e)){const t=this.rangeMapping.get(e).values();return this.rangeMapping.delete(e),t}return[][Symbol.iterator]()}*rangesInSheet(e){const t=this.rangeMapping.get(e);t&&(yield*t.values())}*rangeVerticesContainedInRange(e){for(const t of this.rangesInSheet(e.sheet))e.containsRange(t.range)&&(yield t)}findSmallerRange(e){if(e.height()>1&&Number.isFinite(e.height())){const t=wk(e.end.sheet,e.end.col,e.end.row-1),r=this.getRange(e.start,t);if(void 0!==r){return{smallerRangeVertex:r,restRange:Ak.fromSimpleCellAddresses(wk(e.start.sheet,e.start.col,e.end.row),e.end)}}}return{restRange:e}}*entriesFromSheet(e){const t=this.rangeMapping.get(e);t&&(yield*t.entries())}removeByKey(e,t){this.rangeMapping.get(e).delete(t)}getByKey(e,t){var r;return null===(r=this.rangeMapping.get(e))||void 0===r?void 0:r.get(t)}updateVerticesFromSheet(e,t){const r=Array();for(const[n,o]of this.entriesFromSheet(e)){const i=t(n,o);void 0!==i&&(this.removeByKey(e,n),r.push(i))}return r.forEach((e=>{this.setRange(e.vertex)})),{verticesWithChangedSize:r.filter((e=>e.changedSize)).map((e=>e.vertex))}}}function jU(e,t){return`${e.col},${e.row},${t.col},${t.row}`}const zU=(e,t,r)=>{const n=r(e.range.start),o=r(e.range.start);if(n===o){return r(e.range.end)-r(t.range.end)}return n-o};
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class $U{constructor(e,t,r){this.functions=e,this.errors=t,this.ui=r,this._protectedTranslations={VERSION:"VERSION"},this.checkUI(),this.checkErrors(),this.checkFunctionTranslations(this.functions),Object.assign(this.functions,this._protectedTranslations)}extendFunctions(e){this.checkFunctionTranslations(e),Object.assign(this.functions,e)}buildFunctionMapping(){return Object.keys(this.functions).reduce(((e,t)=>(e[this.functions[t]]=t,e)),{})}buildErrorMapping(){return Object.keys(this.errors).reduce(((e,t)=>(e[this.errors[t]]=t,e)),{})}isFunctionTranslated(e){return void 0!==this.functions[e]}getFunctionTranslations(e){const t=[];for(const r of e)this.isFunctionTranslated(r)&&t.push(this.functions[r]);return t}getFunctionTranslation(e){const t=this.functions[e];if(void 0===t)throw new EU(`functions.${e}`);return t}getMaybeFunctionTranslation(e){return this.functions[e]}getErrorTranslation(e){if(e===XU.LIC)return`#${XU.LIC}!`;const t=this.errors[e];if(void 0===t)throw new EU(`errors.${e}`);return t}getUITranslation(e){const t=this.ui[e];if(void 0===t)throw new EU(`ui.${e}`);return t}checkUI(){for(const e of Object.values(YU))if(!(e in this.ui))throw new EU(`ui.${e}`)}checkErrors(){for(const e of Object.values(XU))if(!(e in this.errors)&&e!==XU.LIC)throw new EU(`errors.${e}`)}checkFunctionTranslations(e){const t=new Set(Object.getOwnPropertyNames(e));for(const r of Object.getOwnPropertyNames(this._protectedTranslations))if(t.has(r))throw new vU(r)}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
var YU,XU,KU;
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
function qU(e){return e.toLowerCase()}!function(e){e.NEW_SHEET_PREFIX="NEW_SHEET_PREFIX"}(YU||(YU={}));class QU{constructor(e,t){this.id=e,this.displayName=t}get canonicalName(){return qU(this.displayName)}}class ZU{constructor(e){this.languages=e,this.mappingFromCanonicalName=new Map,this.mappingFromId=new Map,this.lastSheetId=-1,this.fetch=e=>{const t=this.mappingFromCanonicalName.get(qU(e));if(void 0===t)throw new ZD(e);return t.id},this.get=e=>{var t;return null===(t=this.mappingFromCanonicalName.get(qU(e)))||void 0===t?void 0:t.id},this.fetchDisplayName=e=>this.fetchSheetById(e).displayName,this.sheetNamePrefix=e.getUITranslation(YU.NEW_SHEET_PREFIX)}addSheet(e=`${this.sheetNamePrefix}${this.lastSheetId+2}`){const t=qU(e);if(this.mappingFromCanonicalName.has(t))throw new JD(e);this.lastSheetId++;const r=new QU(this.lastSheetId,e);return this.store(r),r.id}removeSheet(e){const t=this.fetchSheetById(e);e==this.lastSheetId&&--this.lastSheetId,this.mappingFromCanonicalName.delete(t.canonicalName),this.mappingFromId.delete(t.id)}getDisplayName(e){var t;return null===(t=this.mappingFromId.get(e))||void 0===t?void 0:t.displayName}*displayNames(){for(const e of this.mappingFromCanonicalName.values())yield e.displayName}numberOfSheets(){return this.mappingFromCanonicalName.size}hasSheetWithId(e){return this.mappingFromId.has(e)}hasSheetWithName(e){return this.mappingFromCanonicalName.has(qU(e))}renameSheet(e,t){const r=this.fetchSheetById(e),n=r.displayName;if(n===t)return;const o=this.mappingFromCanonicalName.get(qU(t));if(void 0!==o&&o.id!==r.id)throw new JD(t);const i=r.canonicalName;return this.mappingFromCanonicalName.delete(i),r.displayName=t,this.store(r),n}sheetNames(){return Array.from(this.mappingFromId.values()).map((e=>e.displayName))}store(e){this.mappingFromId.set(e.id,e),this.mappingFromCanonicalName.set(e.canonicalName,e)}fetchSheetById(e){const t=this.mappingFromId.get(e);if(void 0===t)throw new QD(e);return t}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class JU{constructor(e,t,r,n,o,i,s,a){this.addressMapping=e,this.rangeMapping=t,this.sheetMapping=r,this.arrayMapping=n,this.stats=o,this.lazilyTransformingAstService=i,this.functionRegistry=s,this.namedExpressions=a,this.changes=$D.empty(),this.dependencyQueryAddresses=e=>{if(e instanceof HU)return this.rangeDependencyQuery(e).map((([e,t])=>e));{const t=this.formulaDependencyQuery(e);if(void 0!==t){const[e,r]=t;return r.map((t=>t instanceof MD?this.namedExpressions.namedExpressionOrPlaceholder(t.name,e.sheet).address:Sk(t)?t:Nk(t.start,t.end)))}return[]}},this.dependencyQueryVertices=e=>{if(e instanceof HU)return this.rangeDependencyQuery(e);{const t=this.formulaDependencyQuery(e);if(void 0!==t){const[e,r]=t;return r.map((t=>{if(t instanceof Ak)return[t.start,this.rangeMapping.fetchRange(t.start,t.end)];if(t instanceof MD){const r=this.namedExpressions.namedExpressionOrPlaceholder(t.name,e.sheet);return[r.address,this.addressMapping.fetchCell(r.address)]}return[t,this.addressMapping.fetchCell(t)]}))}return[]}},this.rangeDependencyQuery=e=>{const t=[],{smallerRangeVertex:r,restRange:n}=this.rangeMapping.findSmallerRange(e.range);let o;void 0!==r&&this.graph.adjacentNodes(r).has(e)?(o=n,t.push([new Ak(r.start,r.end),r])):o=e.range;for(const i of o.addresses(this)){const e=this.addressMapping.getCell(i);void 0!==e&&t.push([i,e])}return t},this.formulaDependencyQuery=e=>{let t,r;if(!(e instanceof FU))return;r=e.getAddress(this.lazilyTransformingAstService),t=e.getFormula(this.lazilyTransformingAstService);const n=bD(t,this.functionRegistry);return[r,_D(n,r)]},this.graph=new WU(this.dependencyQueryVertices)}static buildEmpty(e,t,r,n,o){return new JU(new OU(t.chooseAddressMappingPolicy),new GU,new ZU(t.translationPackage),new MU,o,e,r,n)}setFormulaToCell(e,t,r,n,o,i){const s=FU.fromAst(t,e,n,this.lazilyTransformingAstService.version());return this.exchangeOrAddFormulaVertex(s),this.processCellDependencies(r,s),this.graph.markNodeAsDirty(s),o&&this.markAsVolatile(s),i&&this.markAsDependentOnStructureChange(s),this.correctInfiniteRangesDependency(e),this.getAndClearContentChanges()}setParsingErrorToCell(e,t){const r=this.shrinkPossibleArrayAndGetCell(e);return this.exchangeOrAddGraphNode(r,t),this.addressMapping.setCell(e,t),this.graph.markNodeAsDirty(t),this.correctInfiniteRangesDependency(e),this.getAndClearContentChanges()}setValueToCell(e,t){const r=this.shrinkPossibleArrayAndGetCell(e);if(r instanceof PU&&this.arrayMapping.removeArray(r.getRange()),r instanceof tk){r.getValues().rawValue!==t.rawValue&&(r.setValues(t),this.graph.markNodeAsDirty(r))}else{const n=new tk(t.parsedValue,t.rawValue);this.exchangeOrAddGraphNode(r,n),this.addressMapping.setCell(e,n),this.graph.markNodeAsDirty(n)}return this.correctInfiniteRangesDependency(e),this.getAndClearContentChanges()}setCellEmpty(e){const t=this.shrinkPossibleArrayAndGetCell(e);if(void 0===t)return $D.empty();if(this.graph.adjacentNodes(t).size>0){const r=new ek;this.exchangeGraphNode(t,r),0===this.graph.adjacentNodesCount(r)?(this.removeVertex(r),this.addressMapping.removeCell(e)):(this.graph.markNodeAsDirty(r),this.addressMapping.setCell(e,r))}else this.removeVertex(t),this.addressMapping.removeCell(e);return this.getAndClearContentChanges()}clearDirtyVertices(){this.graph.clearDirtyNodes()}verticesToRecompute(){return this.graph.getDirtyAndVolatileNodes()}processCellDependencies(e,t){const r=this.graph.getNodeId(t);e.forEach((e=>{if(e instanceof Ak){const t=e;let n=this.getRange(t.start,t.end);void 0===n&&(n=new HU(t),this.rangeMapping.setRange(n)),this.graph.addNodeAndReturnId(n);const o=this.graph.getNodeId(n);t.isFinite()||this.graph.markNodeAsInfiniteRange(o);const{smallerRangeVertex:i,restRange:s}=this.rangeMapping.findSmallerRange(t);if(void 0!==i){if(this.graph.addEdge(i,o),n.bruteForce){n.bruteForce=!1;for(const e of t.addresses(this))this.graph.removeEdge(this.fetchCell(e),o)}}else n.bruteForce=!0;const a=this.arrayMapping.getArray(s);if(void 0!==a)this.graph.addEdge(a,o);else for(const e of s.addresses(this)){const{vertex:t,id:r}=this.fetchCellOrCreateEmpty(e);this.graph.addEdge(null!=r?r:t,o)}this.graph.addEdge(o,r),t.isFinite()&&this.correctInfiniteRangesDependenciesByRangeVertex(n)}else if(e instanceof MD){const n=t.getAddress(this.lazilyTransformingAstService).sheet,{vertex:o,id:i}=this.fetchNamedExpressionVertex(e.name,n);this.graph.addEdge(null!=i?i:o,r)}else{const{vertex:t,id:n}=this.fetchCellOrCreateEmpty(e);this.graph.addEdge(null!=n?n:t,r)}}))}fetchNamedExpressionVertex(e,t){const r=this.namedExpressions.namedExpressionOrPlaceholder(e,t);return this.fetchCellOrCreateEmpty(r.address)}exchangeNode(e,t){const r=this.fetchCellOrCreateEmpty(e).vertex,n=this.fetchCellOrCreateEmpty(t).vertex;this.addressMapping.removeCell(e),this.exchangeGraphNode(r,n)}fetchCellOrCreateEmpty(e){const t=this.addressMapping.getCell(e);if(void 0!==t)return{vertex:t,id:void 0};const r=new ek,n=this.graph.addNodeAndReturnId(r);return this.addressMapping.setCell(e,r),{vertex:r,id:n}}removeRows(e){this.stats.measure(GD.ADJUSTING_GRAPH,(()=>{for(const[t,r]of this.addressMapping.entriesFromRowsSpan(e)){for(const e of this.graph.adjacentNodes(r))this.graph.markNodeAsDirty(e);if(r instanceof PU){if(!r.isLeftCorner(t))continue;this.shrinkArrayToCorner(r),this.arrayMapping.removeArray(r.getRange())}this.removeVertex(r)}})),this.stats.measure(GD.ADJUSTING_ADDRESS_MAPPING,(()=>{this.addressMapping.removeRows(e)}));const t=this.stats.measure(GD.ADJUSTING_RANGES,(()=>{const t=this.truncateRanges(e,(e=>e.row));return this.getArrayVerticesRelatedToRanges(t)}));return this.stats.measure(GD.ADJUSTING_ARRAY_MAPPING,(()=>{this.fixArraysAfterRemovingRows(e.sheet,e.rowStart,e.numberOfRows)})),this.addStructuralNodesToChangeSet(),{affectedArrays:t,contentChanges:this.getAndClearContentChanges()}}removeSheet(e){this.clearSheet(e);for(const[t,r]of this.addressMapping.sheetEntries(e)){for(const e of this.graph.adjacentNodes(r))this.graph.markNodeAsDirty(e);this.removeVertex(r),this.addressMapping.removeCell(t)}this.stats.measure(GD.ADJUSTING_RANGES,(()=>{const t=this.rangeMapping.removeRangesInSheet(e);for(const e of t)this.removeVertex(e);this.stats.measure(GD.ADJUSTING_ADDRESS_MAPPING,(()=>{this.addressMapping.removeSheet(e)}))}))}clearSheet(e){const t=new Set;for(const[r,n]of this.addressMapping.sheetEntries(e))n instanceof PU?t.add(n):this.setCellEmpty(r);for(const r of t.values())this.setArrayEmpty(r);this.addStructuralNodesToChangeSet()}removeColumns(e){this.stats.measure(GD.ADJUSTING_GRAPH,(()=>{for(const[t,r]of this.addressMapping.entriesFromColumnsSpan(e)){for(const e of this.graph.adjacentNodes(r))this.graph.markNodeAsDirty(e);if(r instanceof PU){if(!r.isLeftCorner(t))continue;this.shrinkArrayToCorner(r),this.arrayMapping.removeArray(r.getRange())}this.removeVertex(r)}})),this.stats.measure(GD.ADJUSTING_ADDRESS_MAPPING,(()=>{this.addressMapping.removeColumns(e)}));const t=this.stats.measure(GD.ADJUSTING_RANGES,(()=>{const t=this.truncateRanges(e,(e=>e.col));return this.getArrayVerticesRelatedToRanges(t)}));return this.stats.measure(GD.ADJUSTING_ARRAY_MAPPING,(()=>this.fixArraysAfterRemovingColumns(e.sheet,e.columnStart,e.numberOfColumns))),this.addStructuralNodesToChangeSet(),{affectedArrays:t,contentChanges:this.getAndClearContentChanges()}}addRows(e){this.stats.measure(GD.ADJUSTING_ADDRESS_MAPPING,(()=>{this.addressMapping.addRows(e.sheet,e.rowStart,e.numberOfRows)}));const t=this.stats.measure(GD.ADJUSTING_RANGES,(()=>{const t=this.rangeMapping.moveAllRangesInSheetAfterRowByRows(e.sheet,e.rowStart,e.numberOfRows);return this.fixRangesWhenAddingRows(e.sheet,e.rowStart,e.numberOfRows),this.getArrayVerticesRelatedToRanges(t.verticesWithChangedSize)}));this.stats.measure(GD.ADJUSTING_ARRAY_MAPPING,(()=>{this.fixArraysAfterAddingRow(e.sheet,e.rowStart,e.numberOfRows)}));for(const r of this.addressMapping.verticesFromRowsSpan(e))this.graph.markNodeAsDirty(r);return this.addStructuralNodesToChangeSet(),{affectedArrays:t}}addColumns(e){this.stats.measure(GD.ADJUSTING_ADDRESS_MAPPING,(()=>{this.addressMapping.addColumns(e.sheet,e.columnStart,e.numberOfColumns)}));const t=this.stats.measure(GD.ADJUSTING_RANGES,(()=>{const t=this.rangeMapping.moveAllRangesInSheetAfterColumnByColumns(e.sheet,e.columnStart,e.numberOfColumns);return this.fixRangesWhenAddingColumns(e.sheet,e.columnStart,e.numberOfColumns),this.getArrayVerticesRelatedToRanges(t.verticesWithChangedSize)}));this.stats.measure(GD.ADJUSTING_ARRAY_MAPPING,(()=>this.fixArraysAfterAddingColumn(e.sheet,e.columnStart,e.numberOfColumns)));for(const r of this.addressMapping.verticesFromColumnsSpan(e))this.graph.markNodeAsDirty(r);return this.addStructuralNodesToChangeSet(),{affectedArrays:t,contentChanges:this.getAndClearContentChanges()}}isThereSpaceForArray(e){const t=e.getRangeOrUndef();if(void 0===t)return!1;for(const r of t.addresses(this)){const t=this.addressMapping.getCell(r);if(void 0!==t&&!(t instanceof ek)&&t!==e)return!1}return!0}moveCells(e,t,r,n){for(const o of e.addressesWithDirection(t,r,this)){const i=wk(n,o.col+t,o.row+r);let s=this.addressMapping.getCell(o);const a=this.addressMapping.getCell(i);if(this.addressMapping.removeCell(o),void 0!==s){let t;this.graph.markNodeAsDirty(s),this.addressMapping.setCell(i,s);for(const r of this.graph.adjacentNodes(s))r instanceof HU&&!e.containsRange(r.range)&&(t=null!=t?t:this.fetchCellOrCreateEmpty(o).vertex,this.graph.addEdge(t,r),this.graph.removeEdge(s,r));t&&(this.graph.markNodeAsDirty(t),this.addressMapping.setCell(o,t))}if(void 0!==a){void 0===s&&this.addressMapping.removeCell(i);for(const e of this.graph.adjacentNodes(a))s=null!=s?s:this.fetchCellOrCreateEmpty(i).vertex,this.graph.addEdge(s,e),this.graph.markNodeAsDirty(s);this.removeVertex(a)}}for(const o of this.rangeMapping.rangeVerticesContainedInRange(e))for(const t of this.graph.adjacentNodes(o))if(t instanceof HU&&!e.containsRange(t.range)){this.graph.removeEdge(o,t);for(const e of o.range.addresses(this)){const{vertex:r,id:n}=this.fetchCellOrCreateEmpty(e);this.graph.addEdge(null!=n?n:r,t),this.addressMapping.setCell(e,r),this.graph.markNodeAsDirty(r)}}this.rangeMapping.moveRangesInsideSourceRange(e,t,r,n)}setArrayEmpty(e){const t=Ak.spanFrom(e.getAddress(this.lazilyTransformingAstService),e.width,e.height),r=this.graph.adjacentNodes(e);for(const n of t.addresses(this))this.addressMapping.removeCell(n);for(const n of r.values()){const t=DU(this.functionRegistry,n,e.getRange(),this.lazilyTransformingAstService,this);for(const e of t){const{vertex:t,id:r}=this.fetchCellOrCreateEmpty(e);this.graph.addEdge(null!=r?r:t,n)}t.length>0&&this.graph.markNodeAsDirty(n)}this.removeVertex(e),this.arrayMapping.removeArray(e.getRange())}addVertex(e,t){this.graph.addNodeAndReturnId(t),this.addressMapping.setCell(e,t)}addArrayVertex(e,t){this.graph.addNodeAndReturnId(t),this.setAddressMappingForArrayVertex(t,e)}*arrayFormulaNodes(){for(const e of this.graph.getNodes())e instanceof PU&&(yield e)}*entriesFromRowsSpan(e){yield*this.addressMapping.entriesFromRowsSpan(e)}*entriesFromColumnsSpan(e){yield*this.addressMapping.entriesFromColumnsSpan(e)}fetchCell(e){return this.addressMapping.fetchCell(e)}getCell(e){return this.addressMapping.getCell(e)}getCellValue(e){return this.addressMapping.getCellValue(e)}getRawValue(e){return this.addressMapping.getRawValue(e)}getScalarValue(e){const t=this.addressMapping.getCellValue(e);return t instanceof zD?new pk(XU.VALUE,BH.ScalarExpected):t}existsEdge(e,t){return this.graph.existsEdge(e,t)}getSheetId(e){return this.sheetMapping.fetch(e)}getSheetHeight(e){return this.addressMapping.getHeight(e)}getSheetWidth(e){return this.addressMapping.getWidth(e)}getArray(e){return this.arrayMapping.getArray(e)}getRange(e,t){return this.rangeMapping.getRange(e,t)}topSortWithScc(){return this.graph.topSortWithScc()}markAsVolatile(e){this.graph.markNodeAsVolatile(e)}markAsDependentOnStructureChange(e){this.graph.markNodeAsChangingWithStructure(e)}forceApplyPostponedTransformations(){for(const e of this.graph.getNodes())e instanceof VU&&e.ensureRecentData(this.lazilyTransformingAstService)}*rawValuesFromRange(e){for(const t of e.addresses(this)){const e=this.getScalarValue(t);e!==xD&&(yield[LD(e),t])}}computeListOfValuesInRange(e){const t=[];for(const r of e.addresses(this)){const e=this.getScalarValue(r);t.push(e)}return t}shrinkArrayToCorner(e){this.cleanAddressMappingUnderArray(e);for(const t of this.adjacentArrayVertices(e)){let r;r=t instanceof FU?this.formulaDirectDependenciesToArray(t,e):this.rangeDirectDependenciesToArray(t,e);let n=!1;for(const[o,i]of r)e.isLeftCorner(o)&&(n=!0),this.graph.addEdge(i,t),this.graph.markNodeAsDirty(i);n||this.graph.removeEdge(e,t)}this.graph.markNodeAsDirty(e)}isArrayInternalCell(e){const t=this.getCell(e);return t instanceof PU&&!t.isLeftCorner(e)}getAndClearContentChanges(){const e=this.changes;return this.changes=$D.empty(),e}getAdjacentNodesAddresses(e){const t=this.graph.adjacentNodes(e),r=[];return t.forEach((e=>{const t=e;t instanceof HU?r.push(Nk(t.start,t.end)):r.push(t.getAddress(this.lazilyTransformingAstService))})),r}exchangeGraphNode(e,t){this.graph.addNodeAndReturnId(t);const r=this.graph.adjacentNodes(e);this.removeVertex(e),r.forEach((e=>{this.graph.hasNode(e)&&this.graph.addEdge(t,e)}))}setArray(e,t){this.arrayMapping.setArray(e,t)}correctInfiniteRangesDependency(e){const t=this.graph.getInfiniteRanges().filter((({node:t})=>t.range.addressInRange(e)));if(t.length<=0)return;const{vertex:r,id:n}=this.fetchCellOrCreateEmpty(e),o=null!=n?n:this.graph.getNodeId(r);t.forEach((({id:e})=>{this.graph.addEdge(o,e)}))}exchangeOrAddGraphNode(e,t){e?this.exchangeGraphNode(e,t):this.graph.addNodeAndReturnId(t)}getArrayVerticesRelatedToRanges(e){const t=new Set;return e.forEach((e=>{this.graph.hasNode(e)&&this.graph.adjacentNodes(e).forEach((e=>{e instanceof PU&&t.add(e)}))})),t}correctInfiniteRangesDependenciesByRangeVertex(e){this.graph.getInfiniteRanges().forEach((({id:t,node:r})=>{const n=e.range.intersectionWith(r.range);void 0!==n&&n.addresses(this).forEach((e=>{const{vertex:r,id:n}=this.fetchCellOrCreateEmpty(e);this.graph.addEdge(null!=n?n:r,t)}))}))}cleanAddressMappingUnderArray(e){const t=e.getRange();for(const r of t.addresses(this)){const t=e.getArrayCellValue(r);this.getCell(r)===e?e.isLeftCorner(r)?this.changes.addChange(new pk(XU.REF),r,t):(this.addressMapping.removeCell(r),this.changes.addChange(xD,r,t)):this.changes.addChange(xD,r,t)}}*formulaDirectDependenciesToArray(e,t){var r;const[,n]=null!==(r=this.formulaDependencyQuery(e))&&void 0!==r?r:[];if(void 0!==n)for(const o of n)if(!(o instanceof MD||o instanceof Ak)&&t.getRange().addressInRange(o)){const e=this.fetchCellOrCreateEmpty(o).vertex;yield[o,e]}}*rangeDirectDependenciesToArray(e,t){const{restRange:r}=this.rangeMapping.findSmallerRange(e.range);for(const n of r.addresses(this))if(t.getRange().addressInRange(n)){const e=this.fetchCellOrCreateEmpty(n).vertex;yield[n,e]}}*adjacentArrayVertices(e){const t=this.graph.adjacentNodes(e);for(const r of t)(r instanceof FU||r instanceof HU)&&(yield r)}addStructuralNodesToChangeSet(){this.graph.markChangingWithStructureNodesAsDirty()}fixRangesWhenAddingRows(e,t,r){const n=Array.from(this.rangeMapping.rangesInSheet(e));for(const o of n)if(o.range.includesRow(t+r))if(o.bruteForce){const e=o.range.rangeWithSameWidth(t,r);for(const t of e.addresses(this)){const{vertex:e,id:r}=this.fetchCellOrCreateEmpty(t);this.graph.addEdge(null!=r?r:e,o)}}else{let e=o,t=this.rangeMapping.findSmallerRange(e.range);if(void 0!==t.smallerRangeVertex)continue;for(;void 0===t.smallerRangeVertex;){const r=new HU(Ak.spanFrom(e.range.start,e.range.width(),e.range.height()-1));this.rangeMapping.setRange(r),this.graph.addNodeAndReturnId(r);const n=new Ak(wk(e.range.start.sheet,e.range.start.col,e.range.end.row),e.range.end);this.addAllFromRange(n,e),this.graph.addEdge(r,e),e=r,t=this.rangeMapping.findSmallerRange(e.range)}this.graph.addEdge(t.smallerRangeVertex,e),this.addAllFromRange(t.restRange,e),this.graph.removeEdge(t.smallerRangeVertex,o)}}addAllFromRange(e,t){for(const r of e.addresses(this)){const{vertex:e,id:n}=this.fetchCellOrCreateEmpty(r);this.graph.addEdge(null!=n?n:e,t)}}fixRangesWhenAddingColumns(e,t,r){for(const n of this.rangeMapping.rangesInSheet(e))if(n.range.includesColumn(t+r)){let o;o=n.bruteForce?n.range.rangeWithSameHeight(t,r):Ak.spanFrom(wk(e,t,n.range.end.row),r,1);for(const e of o.addresses(this)){const{vertex:t,id:r}=this.fetchCellOrCreateEmpty(e);this.graph.addEdge(null!=r?r:t,n)}}}exchangeOrAddFormulaVertex(e){const t=e.getAddress(this.lazilyTransformingAstService),r=Ak.spanFrom(t,e.width,e.height),n=this.shrinkPossibleArrayAndGetCell(t);if(e instanceof PU&&this.setArray(r,e),this.exchangeOrAddGraphNode(n,e),this.addressMapping.setCell(t,e),e instanceof PU){if(!this.isThereSpaceForArray(e))return;for(const t of r.addresses(this)){if(e.isLeftCorner(t))continue;const r=this.getCell(t);this.exchangeOrAddGraphNode(r,e)}}for(const o of r.addresses(this))this.addressMapping.setCell(o,e)}setAddressMappingForArrayVertex(e,t){if(this.addressMapping.setCell(t,e),!(e instanceof PU))return;const r=Ak.spanFromOrUndef(t,e.width,e.height);if(void 0!==r&&(this.setArray(r,e),this.isThereSpaceForArray(e)))for(const n of r.addresses(this))this.addressMapping.setCell(n,e)}truncateRanges(e,t){const{verticesToRemove:r,verticesToMerge:n,verticesWithChangedSize:o}=this.rangeMapping.truncateRanges(e,t);for(const[i,s]of n)this.mergeRangeVertices(i,s);for(const i of r)this.removeVertexAndCleanupDependencies(i);return o}fixArraysAfterAddingRow(e,t,r){if(this.arrayMapping.moveArrayVerticesAfterRowByRows(e,t,r),!(t<=0))for(const[,n]of this.arrayMapping.arraysInRows(YD.fromRowStartAndEnd(e,t-1,t-1))){const o=n.getRange();for(let i=o.start.col;i<=o.end.col;++i)for(let s=t;s<=o.end.row;++s){const t=wk(e,i,s),o=wk(e,i,s+r),a=n.getArrayCellValue(t);this.addressMapping.moveCell(o,t),this.changes.addChange(xD,o,a)}}}fixArraysAfterRemovingRows(e,t,r){if(this.arrayMapping.moveArrayVerticesAfterRowByRows(e,t,-r),!(t<=0))for(const[,n]of this.arrayMapping.arraysInRows(YD.fromRowStartAndEnd(e,t-1,t-1)))if(this.isThereSpaceForArray(n))for(const e of n.getRange().addresses(this))this.addressMapping.setCell(e,n);else this.setNoSpaceIfArray(n)}fixArraysAfterAddingColumn(e,t,r){if(this.arrayMapping.moveArrayVerticesAfterColumnByColumns(e,t,r),!(t<=0))for(const[,n]of this.arrayMapping.arraysInCols(XD.fromColumnStartAndEnd(e,t-1,t-1))){const o=n.getRange();for(let i=o.start.row;i<=o.end.row;++i)for(let s=t;s<=o.end.col;++s){const t=wk(e,s,i),o=wk(e,s+r,i),a=n.getArrayCellValue(t);this.addressMapping.moveCell(o,t),this.changes.addChange(xD,o,a)}}}fixArraysAfterRemovingColumns(e,t,r){if(this.arrayMapping.moveArrayVerticesAfterColumnByColumns(e,t,-r),!(t<=0))for(const[,n]of this.arrayMapping.arraysInCols(XD.fromColumnStartAndEnd(e,t-1,t-1)))if(this.isThereSpaceForArray(n))for(const e of n.getRange().addresses(this))this.addressMapping.setCell(e,n);else this.setNoSpaceIfArray(n)}shrinkPossibleArrayAndGetCell(e){const t=this.getCell(e);return t instanceof PU?(this.setNoSpaceIfArray(t),this.getCell(e)):t}setNoSpaceIfArray(e){e instanceof PU&&(this.shrinkArrayToCorner(e),e.setNoSpace())}removeVertex(e){this.removeVertexAndCleanupDependencies(e),e instanceof HU&&this.rangeMapping.removeRange(e)}mergeRangeVertices(e,t){const r=this.graph.adjacentNodes(t);this.removeVertexAndCleanupDependencies(t),this.graph.removeEdgeIfExists(e,t),r.forEach((t=>{this.graph.hasNode(t)&&this.graph.addEdge(e,t)}))}removeVertexAndCleanupDependencies(e){const t=new Set(this.graph.removeNode(e));for(;t.size>0;){const e=t.values().next().value;t.delete(e);const[r,n]=e;this.graph.hasNode(n)&&0===this.graph.adjacentNodesCount(n)&&((n instanceof HU||n instanceof ek)&&this.graph.removeNode(n).forEach((e=>t.add(e))),n instanceof HU?this.rangeMapping.removeRange(n):n instanceof ek&&this.addressMapping.removeCell(r))}}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class ek{constructor(){}getCellValue(){return xD}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class tk{constructor(e,t){this.parsedValue=e,this.rawValue=t}getValues(){return{parsedValue:this.parsedValue,rawValue:this.rawValue}}setValues(e){this.parsedValue=e.parsedValue,this.rawValue=e.rawValue}getCellValue(){return this.parsedValue}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class rk{constructor(e,t){this.errors=e,this.rawInput=t}getCellValue(){const e=this.errors.map((e=>e.message)).find((e=>e));return pk.parsingError(e)}getFormula(){return this.rawInput}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class nk{constructor(e,t){this.width=e,this.height=t,this.mapping=new Map}getCell(e){var t;return null===(t=this.mapping.get(e.col))||void 0===t?void 0:t.get(e.row)}setCell(e,t){this.width=Math.max(this.width,e.col+1),this.height=Math.max(this.height,e.row+1);let r=this.mapping.get(e.col);r||(r=new Map,this.mapping.set(e.col,r)),r.set(e.row,t)}has(e){var t;return!!(null===(t=this.mapping.get(e.col))||void 0===t?void 0:t.get(e.row))}getHeight(){return this.height}getWidth(){return this.width}removeCell(e){var t;null===(t=this.mapping.get(e.col))||void 0===t||t.delete(e.row)}addRows(e,t){this.mapping.forEach((r=>{const n=new Map;r.forEach(((o,i)=>{i>=e&&(n.set(i+t,o),r.delete(i))})),n.forEach(((e,t)=>{r.set(t,e)}))})),this.height+=t}addColumns(e,t){const r=new Map;this.mapping.forEach(((n,o)=>{o>=e&&(r.set(o+t,n),this.mapping.delete(o))})),r.forEach(((e,t)=>{this.mapping.set(t,e)})),this.width+=t}removeRows(e){this.mapping.forEach((t=>{const r=new Map;t.forEach(((n,o)=>{o>=e.rowStart&&(t.delete(o),o>e.rowEnd&&r.set(o-e.numberOfRows,n))})),r.forEach(((e,r)=>{t.set(r,e)}))}));const t=Math.min(this.height-1,e.rowEnd),r=Math.max(0,t-e.rowStart+1);this.height=Math.max(0,this.height-r)}removeColumns(e){const t=new Map;this.mapping.forEach(((r,n)=>{n>=e.columnStart&&(this.mapping.delete(n),n>e.columnEnd&&t.set(n-e.numberOfColumns,r))})),t.forEach(((e,t)=>{this.mapping.set(t,e)}));const r=Math.min(this.width-1,e.columnEnd),n=Math.max(0,r-e.columnStart+1);this.width=Math.max(0,this.width-n)}*getEntries(e){for(const[t,r]of this.mapping)for(const[n,o]of r)yield[wk(e,t,n),o]}*verticesFromColumn(e){const t=this.mapping.get(e);if(void 0!==t)for(const[r,n]of t)yield n}*verticesFromRow(e){for(const t of this.mapping.values()){const r=t.get(e);void 0!==r&&(yield r)}}*verticesFromColumnsSpan(e){for(const t of e.columns()){const e=this.mapping.get(t);if(void 0!==e)for(const[t,r]of e)yield r}}*verticesFromRowsSpan(e){for(const t of this.mapping.values())for(const r of e.rows()){const e=t.get(r);void 0!==e&&(yield e)}}*entriesFromRowsSpan(e){for(const[t,r]of this.mapping.entries())for(const n of e.rows()){const o=r.get(n);void 0!==o&&(yield[wk(e.sheet,t,n),o])}}*entriesFromColumnsSpan(e){for(const t of e.columns()){const r=this.mapping.get(t);if(void 0!==r)for(const[n,o]of r.entries())yield[wk(e.sheet,t,n),o]}}*vertices(){for(const[e,t]of this.mapping)for(const[r,n]of t)void 0!==n&&(yield n)}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class ok{constructor(e,t){this.width=e,this.height=t,this.mapping=new Array(t);for(let r=0;r<t;r++)this.mapping[r]=new Array(e)}getCell(e){return this.getCellVertex(e.col,e.row)}setCell(e,t){this.width=Math.max(this.width,e.col+1),this.height=Math.max(this.height,e.row+1);this.mapping[e.row]||(this.mapping[e.row]=new Array(this.width)),this.mapping[e.row][e.col]=t}has(e){const t=this.mapping[e.row];return!!t&&!!t[e.col]}getHeight(){return this.height}getWidth(){return this.width}removeCell(e){void 0!==this.mapping[e.row]&&delete this.mapping[e.row][e.col]}addRows(e,t){const r=[];for(let n=0;n<t;n++)r.push(new Array(this.width));this.mapping.splice(e,0,...r),this.height+=t}addColumns(e,t){for(let r=0;r<this.height;r++)void 0!==this.mapping[r]&&this.mapping[r].splice(e,0,...new Array(t));this.width+=t}removeRows(e){this.mapping.splice(e.rowStart,e.numberOfRows);const t=Math.min(this.height-1,e.rowEnd),r=Math.max(0,t-e.rowStart+1);this.height=Math.max(0,this.height-r)}removeColumns(e){for(let n=0;n<this.height;n++)void 0!==this.mapping[n]&&this.mapping[n].splice(e.columnStart,e.numberOfColumns);const t=Math.min(this.width-1,e.columnEnd),r=Math.max(0,t-e.columnStart+1);this.width=Math.max(0,this.width-r)}*getEntries(e){for(let t=0;t<this.height;++t)for(let r=0;r<this.width;++r){const n=this.getCellVertex(r,t);n&&(yield[wk(e,r,t),n])}}*verticesFromColumn(e){for(let t=0;t<this.height;++t){const r=this.getCellVertex(e,t);r&&(yield r)}}*verticesFromRow(e){for(let t=0;t<this.width;++t){const r=this.getCellVertex(t,e);r&&(yield r)}}*verticesFromColumnsSpan(e){for(let t=e.columnStart;t<=e.columnEnd;++t)for(let e=0;e<this.height;++e){const r=this.getCellVertex(t,e);r&&(yield r)}}*verticesFromRowsSpan(e){for(let t=0;t<this.width;++t)for(let r=e.rowStart;r<=e.rowEnd;++r){const e=this.getCellVertex(t,r);e&&(yield e)}}*entriesFromRowsSpan(e){for(let t=0;t<this.width;++t)for(let r=e.rowStart;r<=e.rowEnd;++r){const n=this.getCellVertex(t,r);n&&(yield[wk(e.sheet,t,r),n])}}*entriesFromColumnsSpan(e){for(let t=e.columnStart;t<=e.columnEnd;++t)for(let r=0;r<this.height;++r){const n=this.getCellVertex(t,r);n&&(yield[wk(e.sheet,t,r),n])}}*vertices(){for(let e=0;e<this.height;++e)for(let t=0;t<this.width;++t){const r=this.getCellVertex(t,e);r&&(yield r)}}getCellVertex(e,t){var r;return null===(r=this.mapping[t])||void 0===r?void 0:r[e]}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */!function(e){e.DIV_BY_ZERO="DIV_BY_ZERO",e.NAME="NAME",e.VALUE="VALUE",e.NUM="NUM",e.NA="NA",e.CYCLE="CYCLE",e.REF="REF",e.SPILL="SPILL",e.LIC="LIC",e.ERROR="ERROR"}(XU||(XU={})),function(e){e.FORMULA="FORMULA",e.VALUE="VALUE",e.ARRAY="ARRAY",e.EMPTY="EMPTY",e.ARRAYFORMULA="ARRAYFORMULA"}(KU||(KU={}));var ik,sk;!function(e){e.EMPTY="EMPTY",e.NUMBER="NUMBER",e.STRING="STRING",e.BOOLEAN="BOOLEAN",e.ERROR="ERROR"}(ik||(ik={})),function(e){e.NUMBER="NUMBER"}(sk||(sk={}));const ak=Object.assign(Object.assign({},ik),sk),lk=Object.assign(Object.assign({},ik),WD),uk=e=>{switch(e){case ak.EMPTY:return 0;case ak.NUMBER:return 1;case ak.STRING:return 2;case ak.BOOLEAN:return 3;case ak.ERROR:return 4}throw new Error("Cell value not computed")},hk=e=>{if(e===xD)return ak.EMPTY;if(e instanceof pk||e instanceof zD)return ak.ERROR;if("string"==typeof e)return ak.STRING;if(BD(e))return ak.NUMBER;if("boolean"==typeof e)return ak.BOOLEAN;throw new Error("Cell value not computed")},ck=e=>{return BD(e)?(t=e)instanceof FD?t.getDetailedType():WD.NUMBER_RAW:hk(e);var t},dk=e=>{return BD(e)&&(t=e)instanceof FD?t.format:void 0;var t};class pk{constructor(e,t,r){this.type=e,this.message=t,this.root=r}static parsingError(e){return new pk(XU.ERROR,`${BH.ParseError}${e?" "+e:""}`)}attachRootVertex(e){return void 0===this.root?new pk(this.type,this.message,e):this}}const mk=(e,t)=>({sheet:e,row:t}),gk=e=>e.row<0,fk=(e,t)=>({sheet:e,col:t}),yk=e=>e.col<0,wk=(e,t,r)=>({sheet:e,col:t,row:r}),Ek=e=>e.col<0||e.row<0,vk=(e,t,r,n)=>wk(t,e.col+r,e.row+n),Rk=e=>`${e.sheet},${e.row},${e.col}`;function Sk(e){var t,r,n;return e&&("object"==typeof e||"function"==typeof e)&&"number"==typeof(null===(t=e)||void 0===t?void 0:t.sheet)&&"number"==typeof(null===(r=e)||void 0===r?void 0:r.col)&&"number"==typeof(null===(n=e)||void 0===n?void 0:n.row)}const Tk=(e,t)=>{var r;return null!==(r=e.sheet)&&void 0!==r?r:t.sheet},Ck=(e,t)=>e.sheet===t.sheet&&e.col===t.col&&e.row===t.row;function bk(e){return!(!e||"object"!=typeof e&&"function"!=typeof e)&&("start"in e&&Sk(e.start)&&"end"in e&&Sk(e.end))}const Nk=(e,t)=>({start:e,end:t});class Ak{constructor(e,t){if(e.sheet!==t.sheet)throw new oU(e.sheet,t.sheet);this.start=wk(e.sheet,e.col,e.row),this.end=wk(t.sheet,t.col,t.row)}get sheet(){return this.start.sheet}static fromSimpleCellAddresses(e,t){if(e.sheet!==t.sheet)throw new oU(e.sheet,t.sheet);const r=t.col-e.col,n=t.row-e.row;return Number.isFinite(n)&&Number.isFinite(r)?new Ak(e,t):Number.isFinite(n)?new Ok(e.sheet,e.row,t.row):new Ik(e.sheet,e.col,t.col)}static fromAst(e,t){return e.type===IH.CELL_RANGE?Ak.fromCellRange(e,t):e.type===IH.COLUMN_RANGE?Ik.fromColumnRange(e,t):Ok.fromRowRangeAst(e,t)}static fromAstOrUndef(e,t){try{return Ak.fromAst(e,t)}catch(r){return}}static fromCellRange(e,t){return new Ak(e.start.toSimpleCellAddress(t),e.end.toSimpleCellAddress(t))}static spanFrom(e,t,r){const n=Ak.spanFromOrUndef(e,t,r);if(void 0===n)throw new Error("AbsoluteCellRange: Wrong range size");return n}static spanFromOrUndef(e,t,r){if(!Number.isFinite(t)&&Number.isFinite(r)){if(0!==e.col)return;return new Ok(e.sheet,e.row,e.row+r-1)}if(!Number.isFinite(r)&&Number.isFinite(t)){if(0!==e.row)return;return new Ik(e.sheet,e.col,e.col+t-1)}if(Number.isFinite(r)&&Number.isFinite(t))return new Ak(e,wk(e.sheet,e.col+t-1,e.row+r-1))}static fromCoordinates(e,t,r,n,o){return new Ak(wk(e,t,r),wk(e,n,o))}isFinite(){return Number.isFinite(this.size())}doesOverlap(e){return this.start.sheet==e.start.sheet&&(!(this.end.row<e.start.row||this.start.row>e.end.row)&&!(this.end.col<e.start.col||this.start.col>e.end.col))}addressInRange(e){return this.sheet===e.sheet&&(this.start.row<=e.row&&this.end.row>=e.row&&this.start.col<=e.col&&this.end.col>=e.col)}columnInRange(e){return this.sheet===e.sheet&&(this.start.col<=e.col&&this.end.col>=e.col)}rowInRange(e){return this.sheet===e.sheet&&(this.start.row<=e.row&&this.end.row>=e.row)}containsRange(e){return this.addressInRange(e.start)&&this.addressInRange(e.end)}intersectionWith(e){if(this.sheet!==e.start.sheet)return;const t=Math.max(this.start.row,e.start.row),r=Math.min(this.end.row,e.end.row),n=Math.max(this.start.col,e.start.col),o=Math.min(this.end.col,e.end.col);return t>r||n>o?void 0:new Ak(wk(this.sheet,n,t),wk(this.sheet,o,r))}includesRow(e){return this.start.row<e&&this.end.row>=e}includesColumn(e){return this.start.col<e&&this.end.col>=e}shiftByRows(e){this.start.row+=e,this.end.row+=e}expandByRows(e){this.end.row+=e}shiftByColumns(e){this.start.col+=e,this.end.col+=e}shifted(e,t){return Ak.spanFrom(wk(this.sheet,this.start.col+e,this.start.row+t),this.width(),this.height())}expandByColumns(e){this.end.col+=e}moveToSheet(e){this.start.sheet=e,this.end.sheet=e}removeSpan(e){e instanceof YD?this.removeRows(e.start,e.end):this.removeColumns(e.start,e.end)}shouldBeRemoved(){return this.width()<=0||this.height()<=0}rangeWithSameWidth(e,t){return Ak.spanFrom(wk(this.sheet,this.start.col,e),this.width(),t)}rangeWithSameHeight(e,t){return Ak.spanFrom(wk(this.sheet,e,this.start.row),t,this.height())}toString(){return`${this.start.sheet},${this.start.col},${this.start.row},${this.end.col},${this.end.row}`}width(){return this.end.col-this.start.col+1}height(){return this.end.row-this.start.row+1}size(){return this.height()*this.width()}arrayOfAddressesInRange(){const e=[];for(let t=0;t<this.height();++t){e[t]=[];for(let r=0;r<this.width();++r){const n=wk(this.sheet,this.start.col+r,this.start.row+t);e[t].push(n)}}return e}withStart(e){return new Ak(e,this.end)}sameDimensionsAs(e){return this.width()===e.width()&&this.height()===e.height()}sameAs(e){return Ck(this.start,e.start)&&Ck(this.end,e.end)}addressesArrayMap(e,t){const r=[];let n=this.start.row;for(;n<=this.effectiveEndRow(e);){let o=this.start.col;const i=[];for(;o<=this.effectiveEndColumn(e);)i.push(t(wk(this.start.sheet,o,n))),o++;r.push(i),n++}return r}addresses(e){const t=[];let r=this.start.row;const n=this.effectiveEndRow(e),o=this.effectiveEndColumn(e);for(;r<=n;){let e=this.start.col;for(;e<=o;)t.push(wk(this.start.sheet,e,r)),e++;r++}return t}*addressesWithDirection(e,t,r){if(e>0)if(t>0){let e=this.effectiveEndRow(r);for(;e>=this.start.row;){let t=this.effectiveEndColumn(r);for(;t>=this.start.col;)yield wk(this.start.sheet,t,e),t-=1;e-=1}}else{let e=this.start.row;for(;e<=this.effectiveEndRow(r);){let t=this.effectiveEndColumn(r);for(;t>=this.start.col;)yield wk(this.start.sheet,t,e),t-=1;e+=1}}else if(t>0){let e=this.effectiveEndRow(r);for(;e>=this.start.row;){let t=this.start.col;for(;t<=this.effectiveEndColumn(r);)yield wk(this.start.sheet,t,e),t+=1;e-=1}}else{let e=this.start.row;for(;e<=this.effectiveEndRow(r);){let t=this.start.col;for(;t<=this.effectiveEndColumn(r);)yield wk(this.start.sheet,t,e),t+=1;e+=1}}}getAddress(e,t){if(e<0||t<0||t>this.height()-1||e>this.width()-1)throw Error("Index out of bound");return wk(this.start.sheet,this.start.col+e,this.start.row+t)}exceedsSheetSizeLimits(e,t){return this.end.col>=e||this.end.row>=t}effectiveEndColumn(e){return this.end.col}effectiveEndRow(e){return this.end.row}effectiveWidth(e){return this.width()}effectiveHeight(e){return this.height()}removeRows(e,t){if(!(e>this.end.row)){if(t<this.start.row){const r=t-e+1;return this.shiftByRows(-r)}e<=this.start.row&&(this.start.row=e),this.end.row-=Math.min(t,this.end.row)-e+1}}removeColumns(e,t){if(!(e>this.end.col)){if(t<this.start.col){const r=t-e+1;return this.shiftByColumns(-r)}e<=this.start.col&&(this.start.col=e),this.end.col-=Math.min(t,this.end.col)-e+1}}}class Ik extends Ak{constructor(e,t,r){super(wk(e,t,0),wk(e,r,Number.POSITIVE_INFINITY))}static fromColumnRange(e,t){const r=e.start.toSimpleColumnAddress(t),n=e.end.toSimpleColumnAddress(t);if(r.sheet!==n.sheet)throw new oU(r.sheet,n.sheet);return new Ik(r.sheet,r.col,n.col)}shouldBeRemoved(){return this.width()<=0}shiftByRows(e){}expandByRows(e){}shifted(e,t){return new Ik(this.sheet,this.start.col+e,this.end.col+e)}rangeWithSameHeight(e,t){return new Ik(this.sheet,e,e+t-1)}exceedsSheetSizeLimits(e,t){return this.end.col>=e}effectiveEndRow(e){return this.effectiveHeight(e)-1}effectiveHeight(e){return e.getSheetHeight(this.sheet)}removeRows(e,t){}}class Ok extends Ak{constructor(e,t,r){super(wk(e,0,t),wk(e,Number.POSITIVE_INFINITY,r))}static fromRowRangeAst(e,t){const r=e.start.toSimpleRowAddress(t),n=e.end.toSimpleRowAddress(t);if(r.sheet!==n.sheet)throw new oU(r.sheet,n.sheet);return new Ok(r.sheet,r.row,n.row)}shouldBeRemoved(){return this.height()<=0}shiftByColumns(e){}expandByColumns(e){}shifted(e,t){return new Ok(this.sheet,this.start.row+t,this.end.row+t)}rangeWithSameWidth(e,t){return new Ok(this.sheet,e,e+t-1)}exceedsSheetSizeLimits(e,t){return this.end.row>=t}effectiveEndColumn(e){return this.effectiveWidth(e)-1}effectiveWidth(e){return e.getSheetWidth(this.sheet)}removeColumns(e,t){}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class Mk{constructor(e,t,r){this.formulaAddress=e,this.arraysFlag=t,this.formulaVertex=r}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
const _k=/^\s*([+-]?)\s*(([\d\.,]+(e[+-]?\d+)?)\s*([ij]?)|([ij]))\s*(([+-])\s*([+-]?)\s*(([\d\.,]+(e[+-]?\d+)?)\s*([ij]?)|([ij])))?$/;class xk{constructor(e,t,r){this.config=e,this.dateTimeHelper=t,this.numberLiteralsHelper=r,this.lt=(e,t)=>this.compare(e,t)<0,this.leq=(e,t)=>this.compare(e,t)<=0,this.gt=(e,t)=>this.compare(e,t)>0,this.geq=(e,t)=>this.compare(e,t)>=0,this.eq=(e,t)=>0===this.compare(e,t),this.neq=(e,t)=>0!==this.compare(e,t),this.pow=(e,t)=>Math.pow(LD(e),LD(t)),this.addWithEpsilonRaw=(e,t)=>{const r=e+t;return Math.abs(r)<this.actualEps*Math.abs(e)?0:r},this.addWithEpsilon=(e,t)=>{const r=$k(e,t);return this.ExtendedNumberFactory(this.addWithEpsilonRaw(LD(e),LD(t)),r)},this.unaryMinus=e=>PD(e,-LD(e)),this.unaryPlus=e=>e,this.unaryPercent=e=>new kD(LD(e)/100),this.concat=(e,t)=>e.concat(t),this.nonstrictadd=(e,t)=>e instanceof pk?e:t instanceof pk?t:"number"==typeof e?"number"==typeof t?this.addWithEpsilonRaw(e,t):e:"number"==typeof t?t:0,this.subtract=(e,t)=>{const r=$k(e,t),n=LD(e);let o=n-LD(t);return Math.abs(o)<this.actualEps*Math.abs(n)&&(o=0),this.ExtendedNumberFactory(o,r)},this.divide=(e,t)=>{const r=LD(e),n=LD(t);if(0===n)return new pk(XU.DIV_BY_ZERO);{const o=Yk(e,t);return this.ExtendedNumberFactory(r/n,o)}},this.multiply=(e,t)=>{const r=Yk(e,t);return this.ExtendedNumberFactory(LD(e)*LD(t),r)},this.manyToExactComplex=e=>{const t=[];for(const r of e){if(r instanceof pk)return r;if(BD(r)||"string"==typeof r){const e=this.coerceScalarToComplex(r);e instanceof pk||t.push(e)}}return t},this.coerceNumbersExactRanges=e=>this.manyToNumbers(e,this.manyToExactNumbers),this.coerceNumbersCoerceRangesDropNulls=e=>this.manyToNumbers(e,this.manyToCoercedNumbersDropNulls),this.manyToExactNumbers=e=>{const t=[];for(const r of e){if(r instanceof pk)return r;BD(r)&&t.push(LD(r))}return t},this.manyToOnlyNumbersDropNulls=e=>{const t=[];for(const r of e){if(r instanceof pk)return r;if(BD(r))t.push(LD(r));else if(r!==xD)return new pk(XU.VALUE,BH.NumberExpected)}return t},this.manyToCoercedNumbersDropNulls=e=>{const t=[];for(const r of e){if(r instanceof pk)return r;if(r===xD)continue;const e=this.coerceScalarToNumberOrError(r);BD(e)&&t.push(LD(e))}return t},this.collator=function(e){const t=e.caseSensitive?e.accentSensitive?"variant":"case":e.accentSensitive?"accent":"base",r=e.caseFirst,n=e.ignorePunctuation;return new Intl.Collator(e.localeLang,{sensitivity:t,caseFirst:r,ignorePunctuation:n})}(e),this.actualEps=e.smartRounding?e.precisionEpsilon:0}eqMatcherFunction(e){const t=this.buildRegex(e);return e=>"string"==typeof e&&t.test(this.normalizeString(e))}neqMatcherFunction(e){const t=this.buildRegex(e);return e=>!("string"==typeof e&&t.test(this.normalizeString(e)))}searchString(e,t){var r;const n=this.buildRegex(e,!1).exec(t);return null!==(r=null==n?void 0:n.index)&&void 0!==r?r:-1}requiresRegex(e){if(!this.config.useRegularExpressions&&!this.config.useWildcards)return!this.config.matchWholeCell;for(let t=0;t<e.length;t++){const r=e.charAt(t);if(Gk(r)||this.config.useRegularExpressions&&zk(r))return!0}return!1}floatCmp(e,t){const r=LD(e),n=LD(t),o=1+this.actualEps;return n>=0&&r*o>=n&&r<=n*o||n<=0&&r*o<=n&&r>=n*o?0:r>n?1:-1}coerceScalarToNumberOrError(e){var t;return e instanceof pk?e:null!==(t=this.coerceToMaybeNumber(e))&&void 0!==t?t:new pk(XU.VALUE,BH.NumberCoercion)}coerceToMaybeNumber(e){var t;return null!==(t=this.coerceNonDateScalarToMaybeNumber(e))&&void 0!==t?t:"string"==typeof e?this.dateTimeHelper.dateStringToDateNumber(e):void 0}coerceNonDateScalarToMaybeNumber(e){if(e===xD)return 0;if("string"==typeof e){if(""===e)return 0;const t=this.coerceStringToMaybePercentNumber(e);if(void 0!==t)return t;const r=this.coerceStringToMaybeCurrencyNumber(e);return void 0!==r?r:this.numberLiteralsHelper.numericStringToMaybeNumber(e.trim())}return BD(e)?e:"boolean"==typeof e?Number(e):void 0}coerceStringToMaybePercentNumber(e){const t=e.trim();if(t.endsWith("%")){const e=t.slice(0,t.length-1).trim(),r=this.numberLiteralsHelper.numericStringToMaybeNumber(e);if(void 0!==r)return new kD(r/100)}}coerceStringToMaybeCurrencyNumber(e){const t=this.currencyMatcher(e.trim());if(void 0!==t){const[e,r]=t,n=this.numberLiteralsHelper.numericStringToMaybeNumber(r);if(void 0!==n)return new HD(n,e)}}currencyMatcher(e){for(const t of this.config.currencySymbol){if(e.startsWith(t))return[t,e.slice(t.length).trim()];if(e.endsWith(t))return[t,e.slice(0,e.length-t.length).trim()]}}coerceComplexExactRanges(e){const t=[];for(const n of e)if(n instanceof zD)t.push(n);else if(n!==xD){const e=this.coerceScalarToComplex(n);if(e instanceof pk)return e;t.push(e)}const r=[];for(const n of t)if(n instanceof zD){const e=this.manyToExactComplex(n.valuesFromTopLeftCorner());if(e instanceof pk)return e;r.push(...e)}else r.push(n);return r}coerceScalarToComplex(e){return e instanceof pk?e:e===xD?[0,0]:BD(e)?[LD(e),0]:"string"==typeof e?this.coerceStringToComplex(e):new pk(XU.NUM,BH.ComplexNumberExpected)}ExtendedNumberFactory(e,t){const{type:r,format:n}=t;switch(r){case WD.NUMBER_RAW:return e;case WD.NUMBER_CURRENCY:return new HD(e,null!=n?n:this.config.currencySymbol[0]);case WD.NUMBER_DATE:return new VD(e,n);case WD.NUMBER_DATETIME:return new UD(e,n);case WD.NUMBER_TIME:return new DD(e,n);case WD.NUMBER_PERCENT:return new kD(e,n)}}buildRegex(e,t=!0){let r;e=this.normalizeString(e);let n=this.config.useWildcards,o=this.config.useRegularExpressions;if(o)try{RegExp(e)}catch(i){o=!1,n=!1}return r=o?function(e,t){let r="";for(let n=0;n<e.length;n++){const o=e.charAt(n);Gk(o)||zk(o)?r+=o:r+=t?o:o.toLowerCase()}return r}(e,this.config.caseSensitive):n?function(e,t){let r="";for(let n=0;n<e.length;n++){const o=e.charAt(n);if("~"===o){if(n==e.length-1){r+="~";continue}const t=e.charAt(n+1);Gk(t)||zk(t)?(r+="\\"+t,n++):(r+=t,n++)}else Gk(o)?r+="."+o:zk(o)?r+="\\"+o:r+=t?o:o.toLowerCase()}return r}(e,this.config.caseSensitive):function(e,t){let r="";for(let n=0;n<e.length;n++){const o=e.charAt(n);Gk(o)||zk(o)?r+="\\"+o:r+=t?o:o.toLowerCase()}return r}(e,this.config.caseSensitive),this.config.matchWholeCell&&t?RegExp("^("+r+")$"):RegExp(r)}normalizeString(e){return this.config.caseSensitive||(e=e.toLowerCase()),this.config.accentSensitive||(e=qk(e,"nfd").replace(/[\u0300-\u036f]/g,"")),e}compare(e,t){if("string"==typeof e||"string"==typeof t){const r="string"==typeof e?this.dateTimeHelper.dateStringToDateNumber(e):e,n="string"==typeof t?this.dateTimeHelper.dateStringToDateNumber(t):t;if(BD(r)&&BD(n))return this.floatCmp(r,n)}return e===xD?e=Vk(t):t===xD&&(t=Vk(e)),"string"==typeof e&&"string"==typeof t?this.stringCmp(e,t):"boolean"==typeof e&&"boolean"==typeof t?kk(Pk(e),Pk(t)):BD(e)&&BD(t)?this.floatCmp(e,t):e===xD&&t===xD?0:kk(uk(hk(e)),uk(hk(t)))}stringCmp(e,t){return this.collator.compare(e,t)}manyToNumbers(e,t){const r=[];for(const o of e)if(o instanceof zD)r.push(o);else{const e=LD(this.coerceScalarToNumberOrError(o));if(e instanceof pk)return e;r.push(e)}const n=[];for(const o of r)if(o instanceof zD){const e=t(o.valuesFromTopLeftCorner());if(e instanceof pk)return e;n.push(...e)}else n.push(o);return n}coerceStringToComplex(e){const t=_k.exec(e);if(null===t)return new pk(XU.NUM,BH.ComplexNumberExpected);let r,n;return r=void 0!==t[6]?"-"===t[1]?[0,-1]:[0,1]:this.parseComplexToken(t[1]+t[3],t[5]),r instanceof pk||void 0===t[8]?r:(n=void 0!==t[14]?"-"===t[9]?[0,-1]:[0,1]:this.parseComplexToken(t[9]+t[11],t[13]),n instanceof pk?n:""!==t[5]||""===t[13]?new pk(XU.NUM,BH.ComplexNumberExpected):"+"===t[8]?[r[0]+n[0],r[1]+n[1]]:[r[0]-n[0],r[1]-n[1]])}parseComplexToken(e,t){const r=LD(this.coerceNonDateScalarToMaybeNumber(e));return void 0===r?new pk(XU.NUM,BH.ComplexNumberExpected):""===t?[r,0]:[0,r]}}function Lk([e,t],r){if(!isFinite(e)||!isFinite(t))return new pk(XU.NUM,BH.NaN);if(r=null!=r?r:"i",0===t)return`${e}`;const n=`${-1===t||1===t?"":Math.abs(t)}${r}`;return 0===e?`${t<0?"-":""}${n}`:`${e}${t<0?"-":"+"}${n}`}function Fk(e){return e instanceof zD?e:zD.fromScalar(e)}function Pk(e){return Number(e)}function Vk(e){return"string"==typeof e?"":BD(e)?0:"boolean"!=typeof e&&xD}function Hk(e){if(e instanceof pk||"boolean"==typeof e)return e;if(e===xD)return!1;if(BD(e))return 0!==LD(e);{const t=e.toUpperCase();return"TRUE"===t||"FALSE"!==t&&(""!==t&&void 0)}}function Dk(e){return e instanceof pk||"string"==typeof e?e:e===xD?"":BD(e)?LD(e).toString():e?"TRUE":"FALSE"}function Uk(e){return e===xD?0:e}function kk(e,t){const r=LD(e),n=LD(t);return r>n?1:r<n?-1:0}function Bk(e){return isNaN(e)||e===1/0||e===-1/0}function Wk(e){return 0===e?0:e}function Gk(e){return["*","?"].includes(e)}const jk=["{","}","[","]","(",")","<",">","=",".","+","-",",","\\","$","^","!"];function zk(e){return jk.includes(e)}function $k(e,t){const{type:r,format:n}=jD(e),{type:o,format:i}=jD(t);if(r===WD.NUMBER_RAW)return{type:o,format:i};if(o===WD.NUMBER_RAW)return{type:r,format:n};if(!(r!==WD.NUMBER_DATETIME&&r!==WD.NUMBER_DATE||o!==WD.NUMBER_DATETIME&&o!==WD.NUMBER_DATE))return{type:WD.NUMBER_RAW};if(r===WD.NUMBER_TIME){if(o===WD.NUMBER_DATE)return{type:WD.NUMBER_DATETIME,format:`${i} ${n}`};if(o===WD.NUMBER_DATETIME)return{type:WD.NUMBER_DATETIME,format:i}}if(o===WD.NUMBER_TIME){if(r===WD.NUMBER_DATE)return{type:WD.NUMBER_DATETIME,format:`${n} ${i}`};if(r===WD.NUMBER_DATETIME)return{type:WD.NUMBER_DATETIME,format:n}}return{type:r,format:n}}function Yk(e,t){let{type:r,format:n}=jD(e),{type:o,format:i}=jD(t);return r===WD.NUMBER_PERCENT&&(r=WD.NUMBER_RAW,n=void 0),o===WD.NUMBER_PERCENT&&(o=WD.NUMBER_RAW,i=void 0),r===WD.NUMBER_RAW?{type:o,format:i}:o===WD.NUMBER_RAW?{type:r,format:n}:{type:WD.NUMBER_RAW}}function Xk(e){return qk(e.toLowerCase(),"nfd").replace(/[\u0300-\u036f]/g,"")}function Kk(e,t){var r;if(e.isAdHoc())return null===(r=e.data[0])||void 0===r?void 0:r[0];const n=e.range;if(t.formulaAddress.sheet===n.sheet)if(1===n.width()){const r=t.formulaAddress.row-n.start.row;if(r>=0&&r<n.height())return e.data[r][0]}else if(1===n.height()){const r=t.formulaAddress.col-n.start.col;if(r>=0&&r<n.width())return e.data[0][r]}}function qk(e,t){return e.normalize(t.toUpperCase())}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */var Qk;!function(e){e.STRING="STRING",e.NUMBER="NUMBER",e.BOOLEAN="BOOLEAN",e.SCALAR="SCALAR",e.NOERROR="NOERROR",e.RANGE="RANGE",e.INTEGER="INTEGER",e.COMPLEX="COMPLEX",e.ANY="ANY"}(Qk||(Qk={}));class Zk{constructor(e){this.coerceScalarToNumberOrError=e=>this.arithmeticHelper.coerceScalarToNumberOrError(e),this.runFunction=(e,t,r,n)=>{const o=this.evaluateArguments(e,t,r),i=o.map((([e,t])=>e)),s=o.map((([e,t])=>t)),a=this.buildMetadataForEachArgumentValue(i.length,r),l=t.arraysFlag&&!r.vectorizationForbidden;if(!this.isNumberOfArgumentValuesValid(a,i.length))return new pk(XU.NA,BH.WrongArgNumber);const[u,h]=l?this.calculateSizeOfVectorizedResultArray(i,a):[1,1];if(1===u&&1===h){const e=this.vectorizeAndBroadcastArgumentsIfNecessary(l,i,a,0,0);return this.calculateSingleCellOfResultArray(t,e,a,s,n,r.returnNumberType)}const c=[...Array(u).keys()].map((e=>[...Array(h).keys()].map((o=>{const u=this.vectorizeAndBroadcastArgumentsIfNecessary(l,i,a,e,o),h=this.calculateSingleCellOfResultArray(t,u,a,s,n,r.returnNumberType);if(h instanceof zD)throw new Error("Function returning array cannot be vectorized.");return h}))));return zD.onlyValues(c)},this.runFunctionWithReferenceArgument=(e,t,r,n,o,i=(()=>new pk(XU.NA,BH.CellRefExpected)))=>{if(0===e.length)return this.returnNumberWrapper(n(),r.returnNumberType);if(e.length>1)return new pk(XU.NA,BH.WrongArgNumber);let s,a=e[0];for(;a.type===IH.PARENTHESIS;)a=a.expression;if(a.type===IH.CELL_REFERENCE)s=a.reference.toSimpleCellAddress(t.formulaAddress);else if(a.type===IH.CELL_RANGE||a.type===IH.COLUMN_RANGE||a.type===IH.ROW_RANGE)try{s=Ak.fromAst(a,t.formulaAddress).start}catch(l){return new pk(XU.REF,BH.CellRefExpected)}return void 0!==s?this.returnNumberWrapper(o(s),r.returnNumberType):this.runFunction(e,t,r,i)},this.interpreter=e,this.dependencyGraph=e.dependencyGraph,this.columnSearch=e.columnSearch,this.config=e.config,this.serialization=e.serialization,this.arraySizePredictor=e.arraySizePredictor,this.dateTimeHelper=e.dateTimeHelper,this.arithmeticHelper=e.arithmeticHelper}evaluateAst(e,t){return this.interpreter.evaluateAst(e,t)}arraySizeForAst(e,t){return this.arraySizePredictor.checkArraySizeForAst(e,t)}listOfScalarValues(e,t){const r=[];for(const n of e){const e=this.evaluateAst(n,t);if(e instanceof zD)for(const t of e.valuesFromTopLeftCorner())r.push([t,!0]);else r.push([e,!1])}return r}coerceToType(e,t,r){let n;if(e instanceof zD)switch(t.argumentType){case Qk.RANGE:case Qk.ANY:n=e;break;default:{const t=Kk(e,r);if(void 0===t)return;e=t}}if(!(e instanceof zD))switch(t.argumentType){case Qk.INTEGER:case Qk.NUMBER:const r=this.coerceScalarToNumberOrError(e);if(!BD(r)){n=r;break}const o=LD(r);if(void 0!==t.maxValue&&o>t.maxValue)return new pk(XU.NUM,BH.ValueLarge);if(void 0!==t.minValue&&o<t.minValue)return new pk(XU.NUM,BH.ValueSmall);if(void 0!==t.lessThan&&o>=t.lessThan)return new pk(XU.NUM,BH.ValueLarge);if(void 0!==t.greaterThan&&o<=t.greaterThan)return new pk(XU.NUM,BH.ValueSmall);if(t.argumentType===Qk.INTEGER&&!Number.isInteger(o))return new pk(XU.NUM,BH.IntegerExpected);n=r;break;case Qk.STRING:n=Dk(e);break;case Qk.BOOLEAN:n=Hk(e);break;case Qk.SCALAR:case Qk.NOERROR:case Qk.ANY:n=e;break;case Qk.RANGE:if(e instanceof pk)return e;n=Fk(e);break;case Qk.COMPLEX:return this.arithmeticHelper.coerceScalarToComplex(LD(e))}return t.passSubtype||void 0===n?n:LD(n)}calculateSingleCellOfResultArray(e,t,r,n,o,i){const s=this.coerceArgumentsToRequiredTypes(e,t,r,n);if(s instanceof pk)return s;const a=o(...s);return this.returnNumberWrapper(a,i)}coerceArgumentsToRequiredTypes(e,t,r,n){const o=[];for(let i=0;i<r.length;i++){const s=r[i],a=void 0!==t[i]?t[i]:null==s?void 0:s.defaultValue;if(void 0===a){o.push(void 0);continue}const l=this.coerceToType(a,s,e);if(void 0===l&&!n[i])return new pk(XU.VALUE,BH.WrongType);if(l instanceof pk&&s.argumentType!==Qk.SCALAR)return l;o.push(l)}return o}vectorizeAndBroadcastArgumentsIfNecessary(e,t,r,n,o){return t.map(((t,i)=>e&&this.isRangePassedAsAScalarArgument(t,r[i])?this.vectorizeAndBroadcastRangeArgument(t,n,o):t))}vectorizeAndBroadcastRangeArgument(e,t,r){var n;const o=1===e.height()?0:t,i=1===e.width()?0:r;return null===(n=e.data[o])||void 0===n?void 0:n[i]}evaluateArguments(e,t,r){return r.expandRanges?this.listOfScalarValues(e,t):e.map((e=>[this.evaluateAst(e,t),!1]))}buildMetadataForEachArgumentValue(e,t){const r=t.parameters?[...t.parameters]:[];if(void 0!==t.repeatLastArgs&&Number.isInteger(t.repeatLastArgs)&&t.repeatLastArgs>0)for(;e>r.length;)r.push(...r.slice(r.length-t.repeatLastArgs));return r}isNumberOfArgumentValuesValid(e,t){if(t>e.length)return!1;if(t<e.length){return e.slice(t).every((e=>(null==e?void 0:e.optionalArg)||void 0!==(null==e?void 0:e.defaultValue)))}return!0}calculateSizeOfVectorizedResultArray(e,t){const r=e.filter(((e,r)=>this.isRangePassedAsAScalarArgument(e,t[r])));return[Math.max(1,...r.map((e=>e.height()))),Math.max(1,...r.map((e=>e.width())))]}isRangePassedAsAScalarArgument(e,t){return null!=e&&null!=t&&(e instanceof zD&&![Qk.RANGE,Qk.ANY].includes(t.argumentType))}metadata(e){const t=this.constructor.implementedFunctions[e];if(void 0!==t)return t;throw new Error(`No metadata for function ${e}.`)}returnNumberWrapper(e,t,r){return void 0!==t&&BD(e)?this.arithmeticHelper.ExtendedNumberFactory(LD(e),{type:t,format:r}):e}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class Jk{constructor(e,t,r=!1){this.width=e,this.height=t,this.isRef=r}static error(){return new Jk(1,1,!0)}static scalar(){return new Jk(1,1,!1)}isScalar(){return 1===this.width&&1===this.height||this.isRef}}class eB{constructor(e,t){this.config=e,this.functionRegistry=t}checkArraySize(e,t){return this.checkArraySizeForAst(e,{formulaAddress:t,arraysFlag:this.config.useArrayArithmetic})}checkArraySizeForAst(e,t){switch(e.type){case IH.FUNCTION_CALL:return this.checkArraySizeForFunction(e,t);case IH.COLUMN_RANGE:case IH.ROW_RANGE:case IH.CELL_RANGE:{const r=Ak.fromAstOrUndef(e,t.formulaAddress);return void 0===r?Jk.error():new Jk(r.width(),r.height(),!0)}case IH.ARRAY:{const r=[],n=[];for(const s of e.args){const e=s.map((e=>this.checkArraySizeForAst(e,t))),o=Math.min(...e.map((e=>e.height))),i=e.reduce(((e,t)=>e+t.width),0);r.push(o),n.push(i)}const o=r.reduce(((e,t)=>e+t),0),i=Math.min(...n);return new Jk(i,o)}case IH.STRING:case IH.NUMBER:return Jk.scalar();case IH.CELL_REFERENCE:return new Jk(1,1,!0);case IH.DIV_OP:case IH.CONCATENATE_OP:case IH.EQUALS_OP:case IH.GREATER_THAN_OP:case IH.GREATER_THAN_OR_EQUAL_OP:case IH.LESS_THAN_OP:case IH.LESS_THAN_OR_EQUAL_OP:case IH.MINUS_OP:case IH.NOT_EQUAL_OP:case IH.PLUS_OP:case IH.POWER_OP:case IH.TIMES_OP:{const r=this.checkArraySizeForAst(e.left,t),i=this.checkArraySizeForAst(e.right,t);return!t.arraysFlag&&(r.height>1||r.width>1||i.height>1||i.width>1)?Jk.error():(n=r,o=i,new Jk(Math.max(n.width,o.width),Math.max(n.height,o.height)))}case IH.MINUS_UNARY_OP:case IH.PLUS_UNARY_OP:case IH.PERCENT_OP:{const n=this.checkArraySizeForAst(e.value,t);return!t.arraysFlag&&(n.height>1||n.width>1)?Jk.error():new Jk((r=n).width,r.height)}case IH.PARENTHESIS:return this.checkArraySizeForAst(e.expression,t);case IH.EMPTY:default:return Jk.error()}var r,n,o}checkArraySizeForFunction(e,t){const r=this.functionRegistry.getArraySizeFunction(e.procedureName);if(void 0!==r)return r(e,t);const n=this.functionRegistry.getMetadata(e.procedureName);if(void 0===n||n.expandRanges||!t.arraysFlag||n.vectorizationForbidden||void 0===n.parameters)return new Jk(1,1);const o=e.args.map((e=>{var r;return this.checkArraySizeForAst(e,new Mk(t.formulaAddress,t.arraysFlag||null!==(r=null==n?void 0:n.arrayFunction)&&void 0!==r&&r))})),i=[...n.parameters];if(void 0!==n.repeatLastArgs&&i.length<o.length&&(o.length-i.length)%n.repeatLastArgs!=0)return Jk.error();for(;i.length<o.length;){if(void 0===n.repeatLastArgs)return Jk.error();i.push(...i.slice(i.length-n.repeatLastArgs))}let s=1,a=1;for(let l=0;l<o.length;l++)i[l].argumentType!==Qk.RANGE&&i[l].argumentType!==Qk.ANY&&(a=Math.max(a,o[l].height),s=Math.max(s,o[l].width));return new Jk(s,a)}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class tB{constructor(e,t,r){var n;this.value=t,this.address=r,this.type=e.type,this.message=null!==(n=e.message)&&void 0!==n?n:""}toString(){return this.value}valueOf(){return this.value}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */function rB(e,t,r){if(void 0===e)return DG.defaultConfig[r];if("string"==typeof t){if(typeof e===t)return e;throw new pU(t,r)}if(t.includes(e))return e;throw new yU(t.map((e=>`'${e}'`)).join(" "),r)}function nB(e,t,r){if(e<r)throw new gU(t,r)}function oB(e,t,r,n){if(t(e))return e;if(void 0===e)return DG.defaultConfig[n];throw new pU(r,n)}function iB(...e){const t=new Map;e.forEach((e=>{const r=t.get(e.value)||[];r.push(e.name),t.set(e.value,r)}));const r=[];for(const n of t.values())n.length>1&&r.push(n);if(r.length>0){r.forEach((e=>e.sort()));const e=r.map((e=>`[${e}]`)).join("; ");throw new Error(`Config initialization failed. Parameters in conflict: ${e}`)}}function sB(e,t,r){if(typeof e!==t)throw new pU(t,r)}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */const aB=new RegExp("^ss(\\.(s+|0+))?$"),lB=new RegExp("^[0-9/.\\-: ]+[ap]?m?$"),uB=new RegExp("\\s+"),hB=new RegExp("[ /.-]"),cB=1e3,dB=fB((function(e){const t=e.toLowerCase().trim(),r=(t.endsWith("am/pm")?t.substring(0,t.length-5):t.endsWith("a/p")?t.substring(0,e.length-3):t).trim().split(":");return{itemsCount:r.length,hourItem:r.indexOf("hh"),minuteItem:r.indexOf("mm"),secondItem:r.findIndex((e=>aB.test(e)))}})),pB=fB((function(e){const t=e.toLowerCase().trim().split(hB);return{itemsCount:t.length,dayItem:t.indexOf("dd"),monthItem:t.indexOf("mm"),shortYearItem:t.indexOf("yy"),longYearItem:t.indexOf("yyyy")}}));function mB(e,t){var r,n,o;if(void 0===t)return;const{itemsCount:i,hourItem:s,minuteItem:a,secondItem:l}=dB(t);let u;if("am"===e[e.length-1]||"a"===e[e.length-1]?(u=!1,e.pop()):"pm"!==e[e.length-1]&&"p"!==e[e.length-1]||(u=!0,e.pop()),e.length!==i)return;const h=Number(null!==(r=e[l])&&void 0!==r?r:"0");if(!Number.isFinite(h))return;const c=Math.round(h*cB)/cB,d=Number(null!==(n=e[a])&&void 0!==n?n:"0");if(!Number.isFinite(d)||!Number.isInteger(d))return;const p=Number(null!==(o=e[s])&&void 0!==o?o:"0");if(!Number.isFinite(p)||!Number.isInteger(p))return;if(void 0!==u&&(p<0||p>12))return;return{hours:void 0!==u?p%12+(u?12:0):p,minutes:d,seconds:c}}function gB(e,t){var r;if(void 0===t)return;const{itemsCount:n,dayItem:o,monthItem:i,shortYearItem:s,longYearItem:a}=pB(t);if(e.length!==n)return;const l=Number(e[o]);if(!Number.isFinite(l)||!Number.isInteger(l))return;const u=Number(e[i]);if(!Number.isFinite(u)||!Number.isInteger(u))return;if(e[a]&&e[s])return;const h=Number(null!==(r=e[a])&&void 0!==r?r:e[s]);return Number.isFinite(h)&&Number.isInteger(h)&&!(e[a]&&(h<1e3||h>9999)||e[s]&&(h<0||h>99))?{year:h,month:u,day:l}:void 0}function fB(e){const t={};return r=>{const n=t[r];if(void 0!==n)return n;const o=e(r);return t[r]=o,o}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */const yB=[31,28,31,30,31,30,31,31,30,31,30,31],wB=[0,31,59,90,120,151,181,212,243,273,304,334],EB=60,vB=60,RB=24;function SB(e){return!(!e||"object"!=typeof e&&"function"!=typeof e)&&("year"in e&&"number"==typeof e.year&&"month"in e&&"number"==typeof e.month&&"day"in e&&"number"==typeof e.day)}function TB(e){return!(!e||"object"!=typeof e&&"function"!=typeof e)&&("hours"in e&&"number"==typeof e.hours&&"minutes"in e&&"number"==typeof e.minutes&&"seconds"in e&&"number"==typeof e.seconds)}const CB={year:9999,month:12,day:31};class bB{constructor(e){this.config=e,this.minDateAbsoluteValue=this.dateToNumberFromZero(e.nullDate),this.maxDateValue=this.dateToNumber(CB),this.leapYear1900=e.leapYear1900,!this.leapYear1900&&0<=this.dateToNumber({year:1900,month:2,day:28})?this.epochYearZero=this.numberToSimpleDate(2).year:this.epochYearZero=this.numberToSimpleDate(1).year,this.parseDateTime=e.parseDateTime}getWithinBounds(e){return e<=this.maxDateValue&&e>=0?e:void 0}dateStringToDateNumber(e){const{dateTime:t,dateFormat:r="",timeFormat:n=""}=this.parseDateTimeFromConfigFormats(e);if(void 0!==t)return TB(t)?SB(t)?new UD(OB(t)+this.dateToNumber(t),r+" "+n):new DD(OB(t),n):SB(t)?new VD(this.dateToNumber(t),r):0}parseDateTimeFromConfigFormats(e){return this.parseDateTimeFromFormats(e,this.config.dateFormats,this.config.timeFormats)}getNullYear(){return this.config.nullYear}getEpochYearZero(){return this.epochYearZero}isValidDate(e){return!(isNaN(e.year)||isNaN(e.month)||isNaN(e.day))&&(e.day===Math.round(e.day)&&e.month===Math.round(e.month)&&e.year===Math.round(e.year)&&(!(e.year<1582)&&(!(e.month<1||e.month>12)&&(!(e.day<1)&&(this.isLeapYear(e.year)&&2===e.month?e.day<=29:e.day<=yB[e.month-1])))))}dateToNumber(e){return this.dateToNumberFromZero(e)-this.minDateAbsoluteValue}relativeNumberToAbsoluteNumber(e){return e+this.minDateAbsoluteValue-(this.leapYear1900?1:0)}numberToSimpleDate(e){const t=Math.floor(e)+this.minDateAbsoluteValue;let r=Math.floor(t/365.2425);this.dateToNumberFromZero({year:r+1,month:1,day:1})<=t?r++:this.dateToNumberFromZero({year:r-1,month:1,day:1})>t&&r--;const n=t-this.dateToNumberFromZero({year:r,month:1,day:1}),o=function(e){let t=0;wB[t+6]<=e&&(t+=6);wB[t+3]<=e&&(t+=3);wB[t+2]<=e?t+=2:wB[t+1]<=e&&(t+=1);return t}(n-(this.isLeapYear(r)&&n>=59?1:0));return{year:r,month:o+1,day:n-wB[o]-(this.isLeapYear(r)&&o>1?1:0)+1}}numberToSimpleDateTime(e){const t=IB(e%1),r=Math.floor(t.hours/RB);t.hours=t.hours%RB;const n=this.numberToSimpleDate(Math.floor(e)+r);return Object.assign(Object.assign({},n),t)}leapYearsCount(e){return Math.floor(e/4)-Math.floor(e/100)+Math.floor(e/400)+(this.config.leapYear1900&&e>=1900?1:0)}daysInMonth(e,t){return this.isLeapYear(e)&&2===t?29:yB[t-1]}endOfMonth(e){return{year:e.year,month:e.month,day:this.daysInMonth(e.year,e.month)}}toBasisUS(e,t){return 31===e.day&&(e.day=30),30===e.day&&31===t.day&&(t.day=30),2===e.month&&e.day===this.daysInMonth(e.year,e.month)&&(e.day=30,2===t.month&&t.day===this.daysInMonth(t.year,t.month)&&(t.day=30)),[e,t]}yearLengthForBasis(e,t){return e.year!==t.year?e.year+1!==t.year||e.month<t.month||e.month===t.month&&e.day<t.day?(this.leapYearsCount(t.year)-this.leapYearsCount(e.year-1))/(t.year-e.year+1)+365:this.countLeapDays(t)!==this.countLeapDays({year:e.year,month:e.month,day:e.day-1})?366:365:this.isLeapYear(e.year)?366:365}parseSingleFormat(e,t,r){const n=this.parseDateTime(e,t,r);if(!SB(n)||(n.year>=0&&n.year<100&&(n.year<this.getNullYear()?n.year+=2e3:n.year+=1900),this.isValidDate(n)))return n}parseDateTimeFromFormats(e,t,r){const n=0===t.length?[void 0]:t,o=0===r.length?[void 0]:r;for(const i of n)for(const t of o){const r=this.parseSingleFormat(e,i,t);if(void 0!==r)return{dateTime:r,timeFormat:t,dateFormat:i}}return{}}countLeapDays(e){return e.month>2||2===e.month&&e.day>=29?this.leapYearsCount(e.year):this.leapYearsCount(e.year-1)}dateToNumberFromZero(e){return 365*e.year+wB[e.month-1]+e.day-1+(e.month<=2?this.leapYearsCount(e.year-1):this.leapYearsCount(e.year))}isLeapYear(e){return!(e%4)&&(!!(e%100)||(!(e%400)||1900===e&&this.config.leapYear1900))}}function NB(e,t){const r=12*e.year+e.month-1+t;return{year:Math.floor(r/12),month:r%12+1,day:e.day}}function AB(e){return Math.round(3600*e*24)/86400}function IB(e){const t=e*RB*vB*EB,r=function(e,t=1){return Math.round(e*t)/t}(t%EB,1e5)%EB,n=(t-r)/EB,o=Math.round(n%vB)%vB,i=(n-o)/vB;return{hours:Math.round(i),minutes:o,seconds:r}}function OB(e){return((e.seconds/60+e.minutes)/60+e.hours)/24}function MB(e){return{year:e.year,month:e.month,day:Math.min(30,e.day)}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
const _B=/(\\.|dd|DD|d|D|mm|MM|m|M|YYYY|YY|yyyy|yy|HH|hh|H|h|ss(\.(0+|s+))?|s|AM\/PM|am\/pm|A\/P|a\/p|\[mm]|\[MM]|\[hh]|\[HH])/g,xB=/(\\.|[#0]+(\.[#0]*)?)/g;var LB,FB;function PB(e,t){return{type:e,value:t}}function VB(e,t){const r=[];let n=0;for(let i=0;i<e.length;++i){const o=e[i];if(o.index!==n){const e=t.substr(n,o.index-n);r.push(PB(LB.FREE_TEXT,e))}o[0].startsWith("\\")?r.push(PB(LB.FREE_TEXT,o[0])):r.push(PB(LB.FORMAT,o[0])),n=o.index+o[0].length}const o=e[e.length-1];if(o.index+o[0].length<t.length){const e=t.substr(o.index+o[0].length,t.length);r.push(PB(LB.FREE_TEXT,e))}return r}function HB(e){const t=function(e){_B.lastIndex=0;const t=[];let r;do{r=_B.exec(e),null!==r&&t.push(r)}while(r);return t}(e);return t.every((e=>UB(e)))?void 0:{type:FB.DATE,tokens:VB(t,e)}}function DB(e){const t=function(e){xB.lastIndex=0;const t=xB.exec(e);return null!==t?[t]:[]}(e);return t.every((e=>UB(e)))?void 0:{type:FB.NUMBER,tokens:VB(t,e)}}function UB(e){return e[0].startsWith("\\")}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */function kB(e,t,r,n){const o=r.stringifyDateTime(n.numberToSimpleDateTime(e),t);if(void 0!==o)return o;const i=r.stringifyDuration(IB(e),t);if(void 0!==i)return i;const s=DB(t);return void 0!==s?function(e,t){let r="";for(let n=0;n<e.length;++n){const o=e[n];if(o.type===LB.FREE_TEXT){r+=o.value;continue}const i=o.value.split("."),s=i[0],a=i[1]||"",l=i[1]?".":"",u=Number(t.toFixed(a.length)).toString().split(".");let h=u[0]||"",c=u[1]||"";if(s.length>h.length){h=BB(h,GB(s.substr(0,s.length-h.length),"0")+h.length)}c=WB(c,GB(a.substr(c.length,a.length-c.length),"0")+c.length),r+=h+l+c}return r}(s.tokens,e):t}function BB(e,t){let r=`${e}`;for(;r.length<t;)r="0"+r;return r}function WB(e,t){let r=`${e}`;for(;r.length<t;)r+="0";return r}function GB(e,t){return e.split(t).length-1}!function(e){e.FORMAT="FORMAT",e.FREE_TEXT="FREE_TEXT"}(LB||(LB={})),function(e){e.DATE="DATE",e.NUMBER="NUMBER",e.STRING="STRING"}(FB||(FB={}));
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
const jB="length",zB=e=>parseInt(e,16),$B=e=>parseInt(e,10),YB=e=>(e+"").replace(/\-/g,""),XB=(e,t,r)=>e.substr(t,r),KB=e=>e.codePointAt(0)-65;
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
const qB={invalid:()=>"The license key for HyperFormula is invalid.",expired:({keyValidityDate:e})=>`The license key for HyperFormula expired on ${e}, and is not valid for the installed version.`,missing:()=>"The license key for HyperFormula is missing."};let QB=!1;function ZB(e){const t={template:"missing",vars:{}};if("gpl-v3"===e||"internal-use-in-handsontable"===e)t.template="valid";else if("string"==typeof e&&function(e){if((e=(e+"").replace(/\-/g,""))[jB]!==KB("Z"))return!1;let t=0;return[[0,KB("G")+1],[KB("H"),KB("H")-1],[KB("G")+KB("H"),KB("G")]].reduce(((r,[n,o],i)=>(r|=($B(`${$B(zB(XB(e,t+n-(0===i?0:2),o+(i?2:0)))+(zB(XB(e,t+n+o,2))+[]).padStart(2,"0"))}`)%97||2)>>1,t+=2,r)),KB("A"))===[]+1>>1}(e)){const[n,o,i]="14/01/2025".split("/"),s=Math.floor(new Date(`${o}/${n}/${i}`).getTime()/864e5),a=25===YB(r=e)[jB]?zB(XB(YB(r),zB("12"),KB("F")))/(zB(XB(YB(r),KB("C"),KB("Y")>>4))||1+(~~![][jB]<<3)):0;t.vars.keyValidityDate=function(e){const t=["January","February","March","April","May","June","July","August","September","October","November","December"][e.getMonth()],r=e.getDate(),n=e.getFullYear();return`${t} ${r}, ${n}`}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */(new Date(864e5*(a+1))),t.template=s>a?"expired":"valid"}else""!==e&&(t.template="invalid");var r;return QB||"valid"===t.template||(console.warn(qB[t.template](t.vars)),QB=!0),t.template}var JB,eW,tW;!function(e){e.Number=class{constructor(e){this.value=e,this.value=PD(this.value,Wk(LD(this.value)))}};e.String=class{constructor(e){this.value=e}};e.Boolean=class{constructor(e){this.value=e}};class t{static getSingletonInstance(){return t.instance||(t.instance=new t),t.instance}}e.Empty=t;e.Formula=class{constructor(e){this.formula=e}};e.Error=class{constructor(e,t){this.value=new pk(e,t)}}}(JB||(JB={}));class rW{constructor(e,t,r){this.config=e,this.dateHelper=t,this.numberLiteralsHelper=r}parse(e){if(null==e)return JB.Empty.getSingletonInstance();if("number"==typeof e)return Bk(e)?new JB.Error(XU.NUM,BH.ValueLarge):new JB.Number(e);if("boolean"==typeof e)return new JB.Boolean(e);if(e instanceof Date){const t=this.dateHelper.dateToNumber({day:e.getDate(),month:e.getMonth()+1,year:e.getFullYear()})+OB({hours:e.getHours(),minutes:e.getMinutes(),seconds:e.getSeconds()+e.getMilliseconds()/1e3});return t<0?new JB.Error(XU.NUM,BH.DateBounds):t%1==0?new JB.Number(new VD(t,"Date()")):t<1?new JB.Number(new DD(t,"Date()")):new JB.Number(new UD(t,"Date()"))}if("string"==typeof e){if(function(e){const t=e.toLowerCase();return"true"===t||"false"===t}(e))return new JB.Boolean("true"===e.toLowerCase());if(function(e){return e.startsWith("=")}(e))return new JB.Formula(e);if(function(e,t){const r=e.toUpperCase();return/#[A-Za-z0-9\/]+[?!]?/.test(r)&&Object.prototype.hasOwnProperty.call(t,r)}(e,this.config.errorMapping))return new JB.Error(this.config.errorMapping[e.toUpperCase()]);{let t,r=e.trim(),n=0;if(r.endsWith("%"))n=1,r=r.slice(0,r.length-1);else{const e=this.currencyMatcher(r);void 0!==e&&(n=2,[t,r]=e)}const o=this.numberLiteralsHelper.numericStringToMaybeNumber(r);if(void 0!==o){let e;return e=1===n?new kD(o/100):2===n?new HD(o,t):o,new JB.Number(e)}const i=this.dateHelper.dateStringToDateNumber(r);return void 0!==i?new JB.Number(i):new JB.String(e.startsWith("'")?e.slice(1):e)}}throw new dU(e)}currencyMatcher(e){for(const t of this.config.currencySymbol){if(e.startsWith(t))return[t,e.slice(t.length)];if(e.endsWith(t))return[t,e.slice(0,e.length-t.length)]}}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */!function(e){e[e.COPY=0]="COPY",e[e.CUT=1]="CUT"}(eW||(eW={})),function(e){e[e.VALUE=0]="VALUE",e[e.EMPTY=1]="EMPTY",e[e.FORMULA=2]="FORMULA",e[e.PARSING_ERROR=3]="PARSING_ERROR"}(tW||(tW={}));class nW{constructor(e,t,r,n,o){this.sourceLeftCorner=e,this.width=t,this.height=r,this.type=n,this.content=o}*getContent(e){if(void 0!==this.content)for(let t=0;t<this.height;++t)for(let r=0;r<this.width;++r)yield[wk(e.sheet,e.col+r,e.row+t),this.content[t][r]]}}class oW{constructor(e,t,r){this.dependencyGraph=t,this.operations=r,this.maxRows=e.maxRows,this.maxColumns=e.maxColumns}cut(e,t,r){this.clipboard=new nW(e,t,r,eW.CUT)}copy(e,t,r){const n=[];for(let o=0;o<r;++o){n[o]=[];for(let r=0;r<t;++r){const t=this.operations.getClipboardCell(wk(e.sheet,e.col+r,e.row+o));n[o].push(t)}}this.clipboard=new nW(e,t,r,eW.COPY,n)}abortCut(){this.clipboard&&this.clipboard.type===eW.CUT&&this.clear()}clear(){this.clipboard=void 0}ensureItIsPossibleToCopyPaste(e){if(void 0===this.clipboard)return;if(Ek(e)||!this.dependencyGraph.sheetMapping.hasSheetWithId(e.sheet))throw new nU("a valid target address.");const t=Ak.spanFrom(e,this.clipboard.width,this.clipboard.height);if(t.exceedsSheetSizeLimits(this.maxColumns,this.maxRows))throw new eU;if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(t))throw new Error("It is not possible to paste onto an array")}isCutClipboard(){return void 0!==this.clipboard&&this.clipboard.type===eW.CUT}isCopyClipboard(){return void 0!==this.clipboard&&this.clipboard.type===eW.COPY}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class iW{constructor(e,t,r,n){this.displayName=e,this.address=t,this.added=r,this.options=n}normalizeExpressionName(){return this.displayName.toLowerCase()}copy(){return new iW(this.displayName,this.address,this.added,this.options)}}class sW{constructor(){this.mapping=new Map}has(e){return this.mapping.has(this.normalizeExpressionName(e))}isNameAvailable(e){const t=this.normalizeExpressionName(e),r=this.mapping.get(t);return!(r&&r.added)}add(e){this.mapping.set(e.normalizeExpressionName(),e)}get(e){return this.mapping.get(this.normalizeExpressionName(e))}getExisting(e){const t=this.mapping.get(this.normalizeExpressionName(e));return t&&t.added?t:void 0}remove(e){const t=this.normalizeExpressionName(e),r=this.mapping.get(t);r&&(r.added=!1)}getAllNamedExpressions(){return Array.from(this.mapping.values()).filter((e=>e.added))}normalizeExpressionName(e){return e.toLowerCase()}}class aW{constructor(){this.mapping=new Map}add(e){this.mapping.set(this.normalizeExpressionName(e.displayName),e)}get(e){return this.mapping.get(this.normalizeExpressionName(e))}has(e){return this.mapping.has(this.normalizeExpressionName(e))}getAllNamedExpressions(){return Array.from(this.mapping.values()).filter((e=>e.added))}isNameAvailable(e){const t=this.normalizeExpressionName(e);return!this.mapping.has(t)}remove(e){const t=this.normalizeExpressionName(e);this.mapping.get(t)&&this.mapping.delete(t)}normalizeExpressionName(e){return e.toLowerCase()}}class lW{constructor(){this.nextNamedExpressionRow=0,this.workbookStore=new sW,this.worksheetStores=new Map,this.addressCache=new Map}isNameAvailable(e,t){var r,n;return void 0===t?this.workbookStore.isNameAvailable(e):null===(n=null===(r=this.worksheetStore(t))||void 0===r?void 0:r.isNameAvailable(e))||void 0===n||n}namedExpressionInAddress(e){const t=this.addressCache.get(e);return t&&t.added?t:void 0}namedExpressionForScope(e,t){var r;return void 0===t?this.workbookStore.getExisting(e):null===(r=this.worksheetStore(t))||void 0===r?void 0:r.get(e)}nearestNamedExpression(e,t){var r,n;return null!==(n=null===(r=this.worksheetStore(t))||void 0===r?void 0:r.get(e))&&void 0!==n?n:this.workbookStore.getExisting(e)}isExpressionInScope(e,t){var r,n;return null!==(n=null===(r=this.worksheetStore(t))||void 0===r?void 0:r.has(e))&&void 0!==n&&n}isNameValid(e){const t=new RegExp(`^${kx}$`),r=new RegExp(`^${Gx}$`),n=new RegExp(`^${zx}$`);return!t.test(e)&&!r.test(e)&&n.test(e)}addNamedExpression(e,t,r){const n=void 0===t?this.workbookStore:this.worksheetStoreOrCreate(t);let o=n.get(e);return void 0!==o?(o.added=!0,o.displayName=e,o.options=r):(o=new iW(e,this.nextAddress(),!0,r),n.add(o)),this.addressCache.set(o.address.row,o),o}restoreNamedExpression(e,t){const r=void 0===t?this.workbookStore:this.worksheetStoreOrCreate(t);return e.added=!0,r.add(e),this.addressCache.set(e.address.row,e),e}namedExpressionOrPlaceholder(e,t){var r;return null!==(r=this.worksheetStoreOrCreate(t).get(e))&&void 0!==r?r:this.workbookNamedExpressionOrPlaceholder(e)}workbookNamedExpressionOrPlaceholder(e){let t=this.workbookStore.get(e);return void 0===t&&(t=new iW(e,this.nextAddress(),!1),this.workbookStore.add(t)),t}remove(e,t){let r;r=void 0===t?this.workbookStore:this.worksheetStore(t);const n=null==r?void 0:r.get(e);if(void 0===r||void 0===n||!n.added)throw Error("Named expression does not exist");r.remove(e),r instanceof aW&&0===r.mapping.size&&this.worksheetStores.delete(t),this.addressCache.delete(n.address.row)}getAllNamedExpressionsNamesInScope(e){return this.getAllNamedExpressions().filter((({scope:t})=>t===e)).map((e=>e.expression.displayName))}getAllNamedExpressionsNames(){return this.getAllNamedExpressions().map((e=>e.expression.displayName))}getAllNamedExpressions(){const e=[];return this.workbookStore.getAllNamedExpressions().forEach((t=>{e.push({expression:t,scope:void 0})})),this.worksheetStores.forEach(((t,r)=>{t.getAllNamedExpressions().forEach((t=>{e.push({expression:t,scope:r})}))})),e}getAllNamedExpressionsForScope(e){var t,r;return void 0===e?this.workbookStore.getAllNamedExpressions():null!==(r=null===(t=this.worksheetStores.get(e))||void 0===t?void 0:t.getAllNamedExpressions())&&void 0!==r?r:[]}worksheetStoreOrCreate(e){let t=this.worksheetStores.get(e);return t||(t=new aW,this.worksheetStores.set(e,t)),t}worksheetStore(e){return this.worksheetStores.get(e)}nextAddress(){return wk(lW.SHEET_FOR_WORKBOOK_EXPRESSIONS,0,this.nextNamedExpressionRow++)}}lW.SHEET_FOR_WORKBOOK_EXPRESSIONS=-1;const uW=e=>{switch(e.type){case IH.EMPTY:case IH.NUMBER:case IH.STRING:case IH.ERROR:case IH.ERROR_WITH_RAW_INPUT:return!1;case IH.CELL_REFERENCE:return!e.reference.isAbsolute();case IH.CELL_RANGE:case IH.COLUMN_RANGE:case IH.ROW_RANGE:return!e.start.isAbsolute();case IH.NAMED_EXPRESSION:return!1;case IH.PERCENT_OP:case IH.PLUS_UNARY_OP:case IH.MINUS_UNARY_OP:return uW(e.value);case IH.CONCATENATE_OP:case IH.EQUALS_OP:case IH.NOT_EQUAL_OP:case IH.LESS_THAN_OP:case IH.GREATER_THAN_OP:case IH.LESS_THAN_OR_EQUAL_OP:case IH.GREATER_THAN_OR_EQUAL_OP:case IH.MINUS_OP:case IH.PLUS_OP:case IH.TIMES_OP:case IH.DIV_OP:case IH.POWER_OP:return uW(e.left)||uW(e.right);case IH.PARENTHESIS:return uW(e.expression);case IH.FUNCTION_CALL:return e.args.some((e=>uW(e)));case IH.ARRAY:return e.args.some((e=>e.some((e=>uW(e)))))}};
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class hW{performEagerTransformations(e,t){for(const r of e.arrayFormulaNodes()){const[n,o]=this.transformSingleAst(r.getFormula(e.lazilyTransformingAstService),r.getAddress(e.lazilyTransformingAstService)),i=t.rememberNewAst(n);r.setFormula(i),r.setAddress(o)}}transformSingleAst(e,t){return[this.transformAst(e,t),this.fixNodeAddress(t)]}transformAst(e,t){switch(e.type){case IH.CELL_REFERENCE:return this.transformCellReferenceAst(e,t);case IH.CELL_RANGE:return this.transformCellRangeAst(e,t);case IH.COLUMN_RANGE:return this.transformColumnRangeAst(e,t);case IH.ROW_RANGE:return this.transformRowRangeAst(e,t);case IH.EMPTY:case IH.ERROR:case IH.NUMBER:case IH.NAMED_EXPRESSION:case IH.ERROR_WITH_RAW_INPUT:case IH.STRING:return e;case IH.PERCENT_OP:case IH.MINUS_UNARY_OP:case IH.PLUS_UNARY_OP:return Object.assign(Object.assign({},e),{value:this.transformAst(e.value,t)});case IH.FUNCTION_CALL:return Object.assign(Object.assign({},e),{procedureName:e.procedureName,args:e.args.map((e=>this.transformAst(e,t)))});case IH.PARENTHESIS:return Object.assign(Object.assign({},e),{expression:this.transformAst(e.expression,t)});case IH.ARRAY:return Object.assign(Object.assign({},e),{args:e.args.map((e=>e.map((e=>this.transformAst(e,t)))))});default:return Object.assign(Object.assign({},e),{left:this.transformAst(e.left,t),right:this.transformAst(e.right,t)})}}transformCellReferenceAst(e,t){const r=this.transformCellAddress(e.reference,t);return r instanceof Lx?Object.assign(Object.assign({},e),{reference:r}):r===XU.REF?LH(new pk(XU.REF)):e}transformCellRangeAst(e,t){const r=this.transformCellRange(e.start,e.end,t);return Array.isArray(r)?Object.assign(Object.assign({},e),{start:r[0],end:r[1]}):r===XU.REF?LH(new pk(XU.REF)):e}transformColumnRangeAst(e,t){const r=this.transformColumnRange(e.start,e.end,t);return Array.isArray(r)?Object.assign(Object.assign({},e),{start:r[0],end:r[1]}):r===XU.REF?LH(new pk(XU.REF)):e}transformRowRangeAst(e,t){const r=this.transformRowRange(e.start,e.end,t);return Array.isArray(r)?Object.assign(Object.assign({},e),{start:r[0],end:r[1]}):r===XU.REF?LH(new pk(XU.REF)):e}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class cW extends hW{constructor(e){super(),this.columnsSpan=e}get sheet(){return this.columnsSpan.sheet}isIrreversible(){return!1}transformRowRangeAst(e,t){return e}transformCellRange(e,t,r){return this.transformRange(e,t,r)}transformRowRange(e,t,r){throw Error("Not implemented")}transformColumnRange(e,t,r){return this.transformRange(e,t,r)}transformCellAddress(e,t){const r=Tk(e,t);if(r!==this.columnsSpan.sheet&&t.sheet!==this.columnsSpan.sheet)return!1;const n=e.toSimpleColumnAddress(t);if(r===this.columnsSpan.sheet&&t.sheet!==this.columnsSpan.sheet)return this.columnsSpan.columnStart<=n.col&&e.shiftedByColumns(this.columnsSpan.numberOfColumns);if(t.sheet===this.columnsSpan.sheet&&r!==this.columnsSpan.sheet)return!e.isColumnAbsolute()&&(!(t.col<this.columnsSpan.columnStart)&&e.shiftedByColumns(-this.columnsSpan.numberOfColumns));if(e.isColumnAbsolute())return!(e.col<this.columnsSpan.columnStart)&&e.shiftedByColumns(this.columnsSpan.numberOfColumns);return e.toSimpleColumnAddress(t).col<this.columnsSpan.columnStart?!(t.col<this.columnsSpan.columnStart)&&e.shiftedByColumns(-this.columnsSpan.numberOfColumns):t.col<this.columnsSpan.columnStart&&e.shiftedByColumns(this.columnsSpan.numberOfColumns)}fixNodeAddress(e){return this.columnsSpan.sheet===e.sheet&&this.columnsSpan.columnStart<=e.col?Object.assign(Object.assign({},e),{col:e.col+this.columnsSpan.numberOfColumns}):e}transformRange(e,t,r){const n=this.transformCellAddress(e,r),o=this.transformCellAddress(t,r);return n===XU.REF||o===XU.REF?XU.REF:!(!n&&!o)&&[n||e,o||t]}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class dW extends hW{constructor(e){super(),this.rowsSpan=e}get sheet(){return this.rowsSpan.sheet}isIrreversible(){return!1}transformColumnRangeAst(e,t){return e}transformCellRange(e,t,r){return this.transformRange(e,t,r)}transformRowRange(e,t,r){return this.transformRange(e,t,r)}transformColumnRange(e,t,r){throw Error("Not implemented")}transformCellAddress(e,t){const r=Tk(e,t);if(r!==this.rowsSpan.sheet&&t.sheet!==this.rowsSpan.sheet)return!1;const n=e.toSimpleRowAddress(t);return r===this.rowsSpan.sheet&&t.sheet!==this.rowsSpan.sheet?this.rowsSpan.rowStart<=n.row&&e.shiftedByRows(this.rowsSpan.numberOfRows):t.sheet===this.rowsSpan.sheet&&r!==this.rowsSpan.sheet?!e.isRowAbsolute()&&(!(t.row<this.rowsSpan.rowStart)&&e.shiftedByRows(-this.rowsSpan.numberOfRows)):e.isRowAbsolute()?!(e.row<this.rowsSpan.rowStart)&&e.shiftedByRows(this.rowsSpan.numberOfRows):n.row<this.rowsSpan.rowStart?!(t.row<this.rowsSpan.rowStart)&&e.shiftedByRows(-this.rowsSpan.numberOfRows):t.row<this.rowsSpan.rowStart&&e.shiftedByRows(this.rowsSpan.numberOfRows)}fixNodeAddress(e){return this.rowsSpan.sheet===e.sheet&&this.rowsSpan.rowStart<=e.row?Object.assign(Object.assign({},e),{row:e.row+this.rowsSpan.numberOfRows}):e}transformRange(e,t,r){const n=this.transformCellAddress(e,r),o=this.transformCellAddress(t,r);return n===XU.REF||o===XU.REF?XU.REF:!(!n&&!o)&&[n||e,o||t]}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class pW extends hW{constructor(e){super(),this.sheet=e}isIrreversible(){return!0}fixNodeAddress(e){return e}transformCellAddress(e,t){return!!e.isInvalid(t)&&XU.REF}transformCellRange(e,t,r){return!(!e.isInvalid(r)&&!t.isInvalid(r))&&XU.REF}transformColumnRange(e,t,r){return!(!e.isInvalid(r)&&!t.isInvalid(r))&&XU.REF}transformRowRange(e,t,r){return!(!e.isInvalid(r)&&!t.isInvalid(r))&&XU.REF}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class mW extends hW{constructor(e,t,r,n){super(),this.sourceRange=e,this.toRight=t,this.toBottom=r,this.toSheet=n,this.dependentFormulaTransformer=new gW(e,t,r,n)}get sheet(){return this.sourceRange.sheet}isIrreversible(){return!0}transformSingleAst(e,t){if(this.sourceRange.addressInRange(t)){return[this.transformAst(e,t),this.fixNodeAddress(t)]}return this.dependentFormulaTransformer.transformSingleAst(e,t)}fixNodeAddress(e){return wk(this.toSheet,e.col+this.toRight,e.row+this.toBottom)}transformCellAddress(e,t){return this.transformAddress(e,t)}transformCellRange(e,t,r){return this.transformRange(e,t,r)}transformColumnRange(e,t,r){return this.transformRange(e,t,r)}transformRowRange(e,t,r){return this.transformRange(e,t,r)}transformAddress(e,t){const r=this.sourceRange;if(e instanceof Lx){const n=e.toSimpleCellAddress(t);if(r.addressInRange(n))return e.shiftAbsoluteDimensions(this.toRight,this.toBottom)}return e.shiftRelativeDimensions(-this.toRight,-this.toBottom)}transformRange(e,t,r){const n=this.sourceRange;if(e instanceof Lx&&t instanceof Lx){const o=e.toSimpleCellAddress(r),i=t.toSimpleCellAddress(r);if(n.addressInRange(o)&&n.addressInRange(i))return[e.shiftAbsoluteDimensions(this.toRight,this.toBottom),t.shiftAbsoluteDimensions(this.toRight,this.toBottom)]}return[e.shiftRelativeDimensions(-this.toRight,-this.toBottom),t.shiftRelativeDimensions(-this.toRight,-this.toBottom)]}}class gW extends hW{constructor(e,t,r,n){super(),this.sourceRange=e,this.toRight=t,this.toBottom=r,this.toSheet=n}get sheet(){return this.sourceRange.sheet}isIrreversible(){return!0}fixNodeAddress(e){return e}transformCellAddress(e,t){return!!this.shouldMove(e,t)&&e.moved(this.toSheet,this.toRight,this.toBottom)}transformCellRange(e,t,r){return this.transformRange(e,t,r)}transformColumnRange(e,t,r){return this.transformRange(e,t,r)}transformRowRange(e,t,r){return this.transformRange(e,t,r)}shouldMove(e,t){return e instanceof Lx?this.sourceRange.addressInRange(e.toSimpleCellAddress(t)):e instanceof xx?this.sourceRange.rowInRange(e.toSimpleRowAddress(t))&&!this.sourceRange.isFinite():this.sourceRange.columnInRange(e.toSimpleColumnAddress(t))&&!this.sourceRange.isFinite()}transformRange(e,t,r){const n=this.transformCellAddress(e,r),o=this.transformCellAddress(t,r);return!(!n||!o)&&[n,o]}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class fW extends hW{constructor(e){super(),this.columnsSpan=e}get sheet(){return this.columnsSpan.sheet}isIrreversible(){return!0}transformRowRangeAst(e,t){return e}transformCellRange(e,t,r){return this.transformRange(e,t,r)}transformRowRange(e,t,r){throw Error("Not implemented")}transformColumnRange(e,t,r){return this.transformRange(e,t,r)}transformCellAddress(e,t){const r=Tk(e,t);if(this.columnsSpan.sheet!==t.sheet&&this.columnsSpan.sheet!==r)return!1;if(this.columnsSpan.sheet!==t.sheet&&this.columnsSpan.sheet===r){const r=e.toSimpleColumnAddress(t);if(r.col<this.columnsSpan.columnStart)return!1;if(r.col>this.columnsSpan.columnEnd)return e.shiftedByColumns(-this.columnsSpan.numberOfColumns)}if(this.columnsSpan.sheet===t.sheet&&this.columnsSpan.sheet!==r){if(e.isColumnAbsolute())return!1;if(t.col<this.columnsSpan.columnStart)return!1;if(t.col>this.columnsSpan.columnEnd)return e.shiftedByColumns(this.columnsSpan.numberOfColumns)}if(this.columnsSpan.sheet===t.sheet&&this.columnsSpan.sheet===r)if(e.isColumnAbsolute()){if(e.col<this.columnsSpan.columnStart)return!1;if(e.col>this.columnsSpan.columnEnd)return e.shiftedByColumns(-this.columnsSpan.numberOfColumns)}else{const r=e.toSimpleColumnAddress(t);if(r.col<this.columnsSpan.columnStart){if(t.col<this.columnsSpan.columnStart)return!1;if(t.col>this.columnsSpan.columnEnd)return e.shiftedByColumns(this.columnsSpan.numberOfColumns)}else if(r.col>this.columnsSpan.columnEnd){if(t.col<this.columnsSpan.columnStart)return e.shiftedByColumns(-this.columnsSpan.numberOfColumns);if(t.col>this.columnsSpan.columnEnd)return!1}}return XU.REF}fixNodeAddress(e){return this.columnsSpan.sheet===e.sheet&&this.columnsSpan.columnStart<=e.col?Object.assign(Object.assign({},e),{col:e.col-this.columnsSpan.numberOfColumns}):e}transformRange(e,t,r){const n=Tk(e,r);let o=e,i=t;if(this.columnsSpan.sheet===n){const n=e.toSimpleColumnAddress(r),s=t.toSimpleColumnAddress(r);if(this.columnsSpan.columnStart<=n.col&&this.columnsSpan.columnEnd>=s.col)return XU.REF;n.col>=this.columnsSpan.columnStart&&n.col<=this.columnsSpan.columnEnd&&(o=e.shiftedByColumns(this.columnsSpan.columnEnd-n.col+1)),s.col>=this.columnsSpan.columnStart&&s.col<=this.columnsSpan.columnEnd&&(i=t.shiftedByColumns(-(s.col-this.columnsSpan.columnStart+1)))}const s=this.transformCellAddress(o,r),a=this.transformCellAddress(i,r);if(!1===s&&!1===a)return[o,i];if(s===XU.REF||a===XU.REF)throw Error("Cannot happen");return[s||o,a||i]}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class yW extends hW{constructor(e){super(),this.rowsSpan=e}get sheet(){return this.rowsSpan.sheet}isIrreversible(){return!0}transformColumnRangeAst(e,t){return e}transformCellAddress(e,t){const r=Tk(e,t);if(this.rowsSpan.sheet!==t.sheet&&this.rowsSpan.sheet!==r)return!1;if(this.rowsSpan.sheet!==t.sheet&&this.rowsSpan.sheet===r){const r=e.toSimpleRowAddress(t);if(r.row<this.rowsSpan.rowStart)return!1;if(r.row>this.rowsSpan.rowEnd)return e.shiftedByRows(-this.rowsSpan.numberOfRows)}if(this.rowsSpan.sheet===t.sheet&&this.rowsSpan.sheet!==r){if(e.isRowAbsolute())return!1;if(t.row<this.rowsSpan.rowStart)return!1;if(t.row>this.rowsSpan.rowEnd)return e.shiftedByRows(this.rowsSpan.numberOfRows)}if(this.rowsSpan.sheet===t.sheet&&this.rowsSpan.sheet===r)if(e.isRowAbsolute()){if(e.row<this.rowsSpan.rowStart)return!1;if(e.row>this.rowsSpan.rowEnd)return e.shiftedByRows(-this.rowsSpan.numberOfRows)}else{const r=e.toSimpleRowAddress(t);if(r.row<this.rowsSpan.rowStart){if(t.row<this.rowsSpan.rowStart)return!1;if(t.row>this.rowsSpan.rowEnd)return e.shiftedByRows(this.rowsSpan.numberOfRows)}else if(r.row>this.rowsSpan.rowEnd){if(t.row<this.rowsSpan.rowStart)return e.shiftedByRows(-this.rowsSpan.numberOfRows);if(t.row>this.rowsSpan.rowEnd)return!1}}return XU.REF}transformCellRange(e,t,r){return this.transformRange(e,t,r)}transformRowRange(e,t,r){return this.transformRange(e,t,r)}transformColumnRange(e,t,r){throw Error("Not implemented")}fixNodeAddress(e){return this.rowsSpan.sheet===e.sheet&&this.rowsSpan.rowStart<=e.row?Object.assign(Object.assign({},e),{row:e.row-this.rowsSpan.numberOfRows}):e}transformRange(e,t,r){const n=Tk(e,r);let o=e,i=t;if(this.rowsSpan.sheet===n){const n=e.toSimpleRowAddress(r),s=t.toSimpleRowAddress(r);if(this.rowsSpan.rowStart<=n.row&&this.rowsSpan.rowEnd>=s.row)return XU.REF;n.row>=this.rowsSpan.rowStart&&n.row<=this.rowsSpan.rowEnd&&(o=e.shiftedByRows(this.rowsSpan.rowEnd-n.row+1)),s.row>=this.rowsSpan.rowStart&&s.row<=this.rowsSpan.rowEnd&&(i=t.shiftedByRows(-(s.row-this.rowsSpan.rowStart+1)))}const s=this.transformCellAddress(o,r),a=this.transformCellAddress(i,r);return!1===s&&!1===a?[o,i]:s===XU.REF||a===XU.REF?XU.REF:[s||o,a||i]}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class wW extends hW{constructor(e){super(),this.sheet=e}isIrreversible(){return!0}performEagerTransformations(e,t){for(const r of e.arrayFormulaNodes()){const[t]=this.transformSingleAst(r.getFormula(e.lazilyTransformingAstService),r.getAddress(e.lazilyTransformingAstService));r.setFormula(t)}}fixNodeAddress(e){return e}transformCellAddress(e,t){return this.transformAddress(e)}transformCellRange(e,t,r){return this.transformAddress(e)}transformColumnRange(e,t,r){return this.transformAddress(e)}transformRowRange(e,t,r){return this.transformAddress(e)}transformAddress(e){return e.sheet===this.sheet&&XU.REF}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */function EW(e){if(!Array.isArray(e))throw new nU("an array of arrays.");for(let t=0;t<e.length;t++)if(!Array.isArray(e[t]))throw new nU("an array of arrays.")}function vW(e){let t=0,r=0,n=0;for(let i=0;i<e.length;i++){let o=0;for(let t=0;t<e[i].length;t++){const r=e[i][t];null!=r&&(o=t+1,++n)}t=Math.max(t,o),o>0&&(r=i+1)}const o=t*r;return{height:r,width:t,fill:0===o?0:n/o}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class RW{constructor(e,t){this.sheet=e,this.indexes=t}normalizedIndexes(){return NW(this.indexes)}rowsSpans(){return this.normalizedIndexes().map((e=>YD.fromNumberOfRows(this.sheet,e[0],e[1])))}}class SW{constructor(e,t){this.sheet=e,this.indexes=t}normalizedIndexes(){return AW(this.indexes)}rowsSpans(){return this.normalizedIndexes().map((e=>YD.fromNumberOfRows(this.sheet,e[0],e[1])))}}class TW{constructor(e,t){this.sheet=e,this.indexes=t}normalizedIndexes(){return AW(this.indexes)}columnsSpans(){return this.normalizedIndexes().map((e=>XD.fromNumberOfColumns(this.sheet,e[0],e[1])))}}class CW{constructor(e,t){this.sheet=e,this.indexes=t}normalizedIndexes(){return NW(this.indexes)}columnsSpans(){return this.normalizedIndexes().map((e=>XD.fromNumberOfColumns(this.sheet,e[0],e[1])))}}class bW{constructor(e,t,r,n,o,i,s,a,l){this.dependencyGraph=t,this.columnSearch=r,this.cellContentParser=n,this.parser=o,this.stats=i,this.lazilyTransformingAstService=s,this.namedExpressions=a,this.arraySizePredictor=l,this.changes=$D.empty(),this.allocateNamedExpressionAddressSpace(),this.maxColumns=e.maxColumns,this.maxRows=e.maxRows}get sheetMapping(){return this.dependencyGraph.sheetMapping}get addressMapping(){return this.dependencyGraph.addressMapping}removeRows(e){const t=[];for(const r of e.rowsSpans()){const e=this.doRemoveRows(r);e&&t.push(e)}return t}addRows(e){for(const t of e.rowsSpans())this.doAddRows(t)}addColumns(e){for(const t of e.columnsSpans())this.doAddColumns(t)}removeColumns(e){const t=[];for(const r of e.columnsSpans()){const e=this.doRemoveColumns(r);e&&t.push(e)}return t}removeSheet(e){this.dependencyGraph.removeSheet(e);let t=0;this.stats.measure(GD.TRANSFORM_ASTS,(()=>{const r=new wW(e);r.performEagerTransformations(this.dependencyGraph,this.parser),t=this.lazilyTransformingAstService.addTransformation(r)})),this.sheetMapping.removeSheet(e),this.columnSearch.removeSheet(e);const r=this.namedExpressions.getAllNamedExpressionsForScope(e).map((t=>this.removeNamedExpression(t.normalizeExpressionName(),e)));return{version:t,scopedNamedExpressions:r}}removeSheetByName(e){const t=this.sheetMapping.fetch(e);return this.removeSheet(t)}clearSheet(e){this.dependencyGraph.clearSheet(e),this.columnSearch.removeSheet(e)}addSheet(e){const t=this.sheetMapping.addSheet(e);return this.dependencyGraph.addressMapping.autoAddSheet(t,vW([])),this.sheetMapping.fetchDisplayName(t)}renameSheet(e,t){return this.sheetMapping.renameSheet(e,t)}moveRows(e,t,r,n){const o=YD.fromNumberOfRows(e,n,r);this.lazilyTransformingAstService.beginCombinedMode(e),this.doAddRows(o),n<t&&(t+=r);const i=wk(e,0,t),s=wk(e,0,n);this.moveCells(i,Number.POSITIVE_INFINITY,r,s);const a=YD.fromNumberOfRows(e,t,r);return this.doRemoveRows(a),this.lazilyTransformingAstService.commitCombinedMode()}moveColumns(e,t,r,n){const o=XD.fromNumberOfColumns(e,n,r);this.lazilyTransformingAstService.beginCombinedMode(e),this.doAddColumns(o),n<t&&(t+=r);const i=wk(e,t,0),s=wk(e,n,0);this.moveCells(i,r,Number.POSITIVE_INFINITY,s);const a=XD.fromNumberOfColumns(e,t,r);return this.doRemoveColumns(a),this.lazilyTransformingAstService.commitCombinedMode()}moveCells(e,t,r,n){this.ensureItIsPossibleToMoveCells(e,t,r,n);const o=Ak.spanFrom(e,t,r),i=Ak.spanFrom(n,t,r),s=n.col-e.col,a=n.row-e.row,l=n.sheet,u=this.getRangeClipboardCells(i),h=this.dependencyGraph.rawValuesFromRange(i);this.columnSearch.removeValues(h);const c=this.dependencyGraph.rawValuesFromRange(o);this.columnSearch.moveValues(c,s,a,l);let d=0;this.stats.measure(GD.TRANSFORM_ASTS,(()=>{const e=new mW(o,s,a,l);e.performEagerTransformations(this.dependencyGraph,this.parser),d=this.lazilyTransformingAstService.addTransformation(e)})),this.dependencyGraph.moveCells(o,s,a,l);const p=this.updateNamedExpressionsForMovedCells(e,t,r,n);return{version:d,overwrittenCellsData:u,addedGlobalNamedExpressions:p}}setRowOrder(e,t){const r=[];let n=[];for(const[o,i]of t)if(o!==i){const t=Ak.spanFrom({sheet:e,col:0,row:o},1/0,1),s=this.getRangeClipboardCells(t);n=n.concat(s),r.push(s.map((([{sheet:e,col:t},r])=>[{sheet:e,col:t,row:i},r])))}return r.forEach((t=>this.restoreClipboardCells(e,t.values()))),n}setColumnOrder(e,t){const r=[];let n=[];for(const[o,i]of t)if(o!==i){const t=Ak.spanFrom({sheet:e,col:o,row:0},1,1/0),s=this.getRangeClipboardCells(t);n=n.concat(s),r.push(s.map((([{sheet:e,col:t,row:r},n])=>[{sheet:e,col:i,row:r},n])))}return r.forEach((t=>this.restoreClipboardCells(e,t.values()))),n}addNamedExpression(e,t,r,n){const o=this.namedExpressions.addNamedExpression(e,r,n);this.storeNamedExpressionInCell(o.address,t),this.adjustNamedExpressionEdges(o,e,r)}restoreNamedExpression(e,t,r){const n=e.displayName;this.restoreCell(e.address,t);const o=this.namedExpressions.restoreNamedExpression(e,r);this.adjustNamedExpressionEdges(o,n,r)}changeNamedExpressionExpression(e,t,r,n){const o=this.namedExpressions.namedExpressionForScope(e,r);if(!o)throw new aU(e);const i=o.copy();o.options=n;const s=this.getClipboardCell(o.address);return this.storeNamedExpressionInCell(o.address,t),[i,s]}removeNamedExpression(e,t){const r=this.namedExpressions.namedExpressionForScope(e,t);if(!r)throw new aU(e);this.namedExpressions.remove(r.displayName,t);const n=this.getClipboardCell(r.address);if(void 0!==t){const t=this.namedExpressions.workbookNamedExpressionOrPlaceholder(e);this.dependencyGraph.exchangeNode(r.address,t.address)}else this.dependencyGraph.setCellEmpty(r.address);return[r,n]}ensureItIsPossibleToMoveCells(e,t,r,n){if(Ek(e)||!(IW(t)&&IW(r)||function(e,t,r){return 0===e.row&&IW(t)&&r===Number.POSITIVE_INFINITY||0===e.col&&IW(r)&&t===Number.POSITIVE_INFINITY}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */(e,t,r))||Ek(n)||!this.sheetMapping.hasSheetWithId(e.sheet)||!this.sheetMapping.hasSheetWithId(n.sheet))throw new nU("a valid range of cells to move.");const o=Ak.spanFrom(e,t,r),i=Ak.spanFrom(n,t,r);if(i.exceedsSheetSizeLimits(this.maxColumns,this.maxRows))throw new eU;if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(o))throw new bU;if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(i))throw new NU}restoreClipboardCells(e,t){const r=[];for(const[n,o]of t)if(this.restoreCell(n,o),o.type===tW.FORMULA){const{dependencies:t}=this.parser.fetchCachedResult(o.hash);r.push(...this.updateNamedExpressionsForTargetAddress(e,n,t))}return r}restoreCell(e,t){switch(t.type){case tW.VALUE:this.setValueToCell(t,e);break;case tW.FORMULA:this.setFormulaToCellFromCache(t.hash,e);break;case tW.EMPTY:this.setCellEmpty(e);break;case tW.PARSING_ERROR:this.setParsingErrorToCell(t.rawInput,t.errors,e)}}getOldContent(e){const t=this.dependencyGraph.getCell(e);if(void 0===t||t instanceof ek)return[e,{type:tW.EMPTY}];if(t instanceof tk)return[e,Object.assign({type:tW.VALUE},t.getValues())];if(t instanceof FU)return[t.getAddress(this.lazilyTransformingAstService),{type:tW.FORMULA,hash:this.parser.computeHashFromAst(t.getFormula(this.lazilyTransformingAstService))}];if(t instanceof rk)return[e,{type:tW.PARSING_ERROR,rawInput:t.rawInput,errors:t.errors}];throw Error("Trying to copy unsupported type")}getClipboardCell(e){const t=this.dependencyGraph.getCell(e);if(void 0===t||t instanceof ek)return{type:tW.EMPTY};if(t instanceof tk)return Object.assign({type:tW.VALUE},t.getValues());if(t instanceof PU){const r=t.getArrayCellValue(e);return r===xD?{type:tW.EMPTY}:{type:tW.VALUE,parsedValue:r,rawValue:t.getArrayCellRawValue(e)}}if(t instanceof VU)return{type:tW.FORMULA,hash:this.parser.computeHashFromAst(t.getFormula(this.lazilyTransformingAstService))};if(t instanceof rk)return{type:tW.PARSING_ERROR,rawInput:t.rawInput,errors:t.errors};throw Error("Trying to copy unsupported type")}getSheetClipboardCells(e){const t=this.dependencyGraph.getSheetHeight(e),r=this.dependencyGraph.getSheetWidth(e),n=new Array(t);for(let o=0;o<t;o++){n[o]=new Array(r);for(let t=0;t<r;t++){const r=wk(e,t,o);n[o][t]=this.getClipboardCell(r)}}return n}getRangeClipboardCells(e){const t=[];for(const r of e.addresses(this.dependencyGraph))t.push([r,this.getClipboardCell(r)]);return t}setCellContent(e,t){const r=this.cellContentParser.parse(t),n=this.getOldContent(e);if(r instanceof JB.Formula){const t=this.parser.parse(r.formula,e),{ast:n,errors:i}=t;if(i.length>0)this.setParsingErrorToCell(r.formula,i,e);else try{const r=this.arraySizePredictor.checkArraySize(n,e);if(r.width<=0||r.height<=0)throw Error("Incorrect array size");this.setFormulaToCell(e,r,t)}catch(o){if(!o.message)throw o;const t={type:AH.InvalidRangeSize,message:"Invalid range size."};this.setParsingErrorToCell(r.formula,[t],e)}}else r instanceof JB.Empty?this.setCellEmpty(e):this.setValueToCell({parsedValue:r.value,rawValue:t},e);return n}setSheetContent(e,t){this.clearSheet(e);for(let r=0;r<t.length;r++)for(let n=0;n<t[r].length;n++){const o=wk(e,n,r);this.setCellContent(o,t[r][n])}}setParsingErrorToCell(e,t,r){const n=this.dependencyGraph.getCellValue(r),o=new rk(t,e),i=this.dependencyGraph.setParsingErrorToCell(r,o);this.columnSearch.remove(LD(n),r),this.columnSearch.applyChanges(i.getChanges()),this.changes.addAll(i),this.changes.addChange(o.getCellValue(),r)}setFormulaToCell(e,t,{ast:r,hasVolatileFunction:n,hasStructuralChangeFunction:o,dependencies:i}){const s=this.dependencyGraph.getCellValue(e),a=this.dependencyGraph.setFormulaToCell(e,r,_D(i,e),t,n,o);this.columnSearch.remove(LD(s),e),this.columnSearch.applyChanges(a.getChanges()),this.changes.addAll(a)}setValueToCell(e,t){const r=this.dependencyGraph.getCellValue(t),n=this.dependencyGraph.setValueToCell(t,e);this.columnSearch.change(LD(r),LD(e.parsedValue),t),this.columnSearch.applyChanges(n.getChanges().filter((e=>!Ck(e.address,t)))),this.changes.addAll(n),this.changes.addChange(e.parsedValue,t)}setCellEmpty(e){if(this.dependencyGraph.isArrayInternalCell(e))return;const t=this.dependencyGraph.getCellValue(e),r=this.dependencyGraph.setCellEmpty(e);this.columnSearch.remove(LD(t),e),this.columnSearch.applyChanges(r.getChanges()),this.changes.addAll(r),this.changes.addChange(xD,e)}setFormulaToCellFromCache(e,t){const{ast:r,hasVolatileFunction:n,hasStructuralChangeFunction:o,dependencies:i}=this.parser.fetchCachedResult(e),s=_D(i,t),[a]=new pW(t.sheet).transformSingleAst(r,t);this.parser.rememberNewAst(a);const l=s.filter((e=>e instanceof MD||(e instanceof Ak?!(Ek(e.start)||Ek(e.end)):!Ek(e))));const u=this.arraySizePredictor.checkArraySize(r,t);this.dependencyGraph.setFormulaToCell(t,a,l,u,n,o)}rowEffectivelyNotInSheet(e,t){return e>=this.dependencyGraph.addressMapping.getHeight(t)}getAndClearContentChanges(){const e=this.changes;return this.changes=$D.empty(),e}forceApplyPostponedTransformations(){this.dependencyGraph.forceApplyPostponedTransformations()}doRemoveRows(e){if(this.rowEffectivelyNotInSheet(e.rowStart,e.sheet))return;const t=[];for(const[i]of this.dependencyGraph.entriesFromRowsSpan(e))t.push({address:i,cellType:this.getClipboardCell(i)});const{affectedArrays:r,contentChanges:n}=this.dependencyGraph.removeRows(e);this.columnSearch.applyChanges(n.getChanges());let o=0;return this.stats.measure(GD.TRANSFORM_ASTS,(()=>{const t=new yW(e);t.performEagerTransformations(this.dependencyGraph,this.parser),o=this.lazilyTransformingAstService.addTransformation(t)})),this.rewriteAffectedArrays(r),{version:o,removedCells:t,rowFrom:e.rowStart,rowCount:e.numberOfRows}}doRemoveColumns(e){if(this.columnEffectivelyNotInSheet(e.columnStart,e.sheet))return;const t=[];for(const[i]of this.dependencyGraph.entriesFromColumnsSpan(e))t.push({address:i,cellType:this.getClipboardCell(i)});const{affectedArrays:r,contentChanges:n}=this.dependencyGraph.removeColumns(e);this.columnSearch.applyChanges(n.getChanges()),this.columnSearch.removeColumns(e);let o=0;return this.stats.measure(GD.TRANSFORM_ASTS,(()=>{const t=new fW(e);t.performEagerTransformations(this.dependencyGraph,this.parser),o=this.lazilyTransformingAstService.addTransformation(t)})),this.rewriteAffectedArrays(r),{version:o,removedCells:t,columnFrom:e.columnStart,columnCount:e.numberOfColumns}}doAddRows(e){if(this.rowEffectivelyNotInSheet(e.rowStart,e.sheet))return;const{affectedArrays:t}=this.dependencyGraph.addRows(e);this.stats.measure(GD.TRANSFORM_ASTS,(()=>{const t=new dW(e);t.performEagerTransformations(this.dependencyGraph,this.parser),this.lazilyTransformingAstService.addTransformation(t)})),this.rewriteAffectedArrays(t)}rewriteAffectedArrays(e){for(const t of e.values()){if(t.array.size.isRef)continue;const e=t.getFormula(this.lazilyTransformingAstService),r=t.getAddress(this.lazilyTransformingAstService),n=this.parser.computeHashFromAst(e);this.setFormulaToCellFromCache(n,r)}}doAddColumns(e){if(this.columnEffectivelyNotInSheet(e.columnStart,e.sheet))return;const{affectedArrays:t,contentChanges:r}=this.dependencyGraph.addColumns(e);this.columnSearch.addColumns(e),this.columnSearch.applyChanges(r.getChanges()),this.stats.measure(GD.TRANSFORM_ASTS,(()=>{const t=new cW(e);t.performEagerTransformations(this.dependencyGraph,this.parser),this.lazilyTransformingAstService.addTransformation(t)})),this.rewriteAffectedArrays(t)}columnEffectivelyNotInSheet(e,t){return e>=this.dependencyGraph.addressMapping.getWidth(t)}adjustNamedExpressionEdges(e,t,r){if(void 0===r)return;const{vertex:n,id:o}=this.dependencyGraph.fetchCellOrCreateEmpty(e.address),i=null!=o?o:this.dependencyGraph.graph.getNodeId(n),s=this.namedExpressions.workbookNamedExpressionOrPlaceholder(t),{vertex:a,id:l}=this.dependencyGraph.fetchCellOrCreateEmpty(s.address),u=null!=l?l:this.dependencyGraph.graph.getNodeId(a);for(const h of this.dependencyGraph.graph.adjacentNodes(a))if(h instanceof VU&&h.getAddress(this.lazilyTransformingAstService).sheet===r){const t=h.getFormula(this.lazilyTransformingAstService),r=h.getAddress(this.lazilyTransformingAstService),{dependencies:n}=this.parser.fetchCachedResultForAst(t);for(const o of _D(n,r))o instanceof MD&&o.name.toLowerCase()===e.displayName.toLowerCase()&&(this.dependencyGraph.graph.removeEdge(u,h),this.dependencyGraph.graph.addEdge(i,h))}}storeNamedExpressionInCell(e,t){const r=this.cellContentParser.parse(t);if(r instanceof JB.Formula){const t=this.parser.parse(r.formula,wk(-1,0,0));if(uW(t.ast))throw new AU;const{ast:n,hasVolatileFunction:o,hasStructuralChangeFunction:i,dependencies:s}=t;this.dependencyGraph.setFormulaToCell(e,n,_D(s,e),Jk.scalar(),o,i)}else r instanceof JB.Empty?this.setCellEmpty(e):this.setValueToCell({parsedValue:r.value,rawValue:t},e)}updateNamedExpressionsForMovedCells(e,t,r,n){if(e.sheet===n.sheet)return[];const o=[],i=Ak.spanFrom(n,t,r);for(const s of i.addresses(this.dependencyGraph)){const t=this.addressMapping.fetchCell(s);if(t instanceof VU&&s.sheet!==e.sheet){const r=t.getFormula(this.lazilyTransformingAstService),{dependencies:n}=this.parser.fetchCachedResultForAst(r);o.push(...this.updateNamedExpressionsForTargetAddress(e.sheet,s,n))}}return o}updateNamedExpressionsForTargetAddress(e,t,r){if(e===t.sheet)return[];const n=[],o=this.addressMapping.fetchCell(t);for(const i of _D(r,t)){if(!(i instanceof MD))continue;const r=i.name,s=this.dependencyGraph.fetchNamedExpressionVertex(r,e).vertex,a=this.namedExpressions.isExpressionInScope(r,t.sheet)?this.dependencyGraph.fetchNamedExpressionVertex(r,t.sheet).vertex:this.copyOrFetchGlobalNamedExpressionVertex(r,s,n);a!==s&&(this.dependencyGraph.graph.removeEdgeIfExists(s,o),this.dependencyGraph.graph.addEdge(a,o))}return n}allocateNamedExpressionAddressSpace(){this.dependencyGraph.addressMapping.addSheet(lW.SHEET_FOR_WORKBOOK_EXPRESSIONS,new nk(0,0))}copyOrFetchGlobalNamedExpressionVertex(e,t,r){let n=this.namedExpressions.namedExpressionForScope(e);if(void 0===n)if(n=this.namedExpressions.addNamedExpression(e),r.push(n.normalizeExpressionName()),t instanceof VU){const e=this.parser.fetchCachedResultForAst(t.getFormula(this.lazilyTransformingAstService)),{ast:r,hasVolatileFunction:o,hasStructuralChangeFunction:i,dependencies:s}=e;this.dependencyGraph.setFormulaToCell(n.address,r,_D(s,n.address),Jk.scalar(),o,i)}else t instanceof ek?this.setCellEmpty(n.address):t instanceof tk&&this.setValueToCell(t.getValues(),n.address);return this.dependencyGraph.fetchCellOrCreateEmpty(n.address).vertex}}function NW(e){if(e.length<=1)return e;const t=[...e].sort((([e],[t])=>e-t)),r=t.reduce(((e,[t,r])=>{const n=e[e.length-1],o=n[0]+n[1];return t<=o?n[1]+=Math.max(0,r-(o-t)):e.push([t,r]),e}),[t[0]]);let n=0;for(let o=0;o<r.length;++o)r[o][0]-=n,n+=r[o][1];return r}function AW(e){if(e.length<=1)return e;const t=[...e].sort((([e],[t])=>e-t)),r=t.reduce(((e,[t,r])=>{const n=e[e.length-1];return t===n[0]?n[1]=Math.max(n[1],r):e.push([t,r]),e}),[t[0]]);let n=0;for(let o=0;o<r.length;++o)r[o][0]+=n,n+=r[o][1];return r}function IW(e){return Number.isInteger(e)&&e>0}class OW{}class MW extends OW{constructor(e,t){super(),this.command=e,this.rowsRemovals=t}doUndo(e){e.undoRemoveRows(this)}doRedo(e){e.redoRemoveRows(this)}}class _W extends OW{constructor(e,t,r,n,o,i,s){super(),this.sourceLeftCorner=e,this.width=t,this.height=r,this.destinationLeftCorner=n,this.overwrittenCellsData=o,this.addedGlobalNamedExpressions=i,this.version=s}doUndo(e){e.undoMoveCells(this)}doRedo(e){e.redoMoveCells(this)}}class xW extends OW{constructor(e){super(),this.command=e}doUndo(e){e.undoAddRows(this)}doRedo(e){e.redoAddRows(this)}}class LW extends OW{constructor(e,t,r){super(),this.sheetId=e,this.rowMapping=t,this.oldContent=r}doUndo(e){e.undoSetRowOrder(this)}doRedo(e){e.redoSetRowOrder(this)}}class FW extends OW{constructor(e,t,r){super(),this.sheetId=e,this.columnMapping=t,this.oldContent=r}doUndo(e){e.undoSetColumnOrder(this)}doRedo(e){e.redoSetColumnOrder(this)}}class PW extends OW{constructor(e,t,r){super(),this.sheetId=e,this.oldSheetContent=t,this.newSheetContent=r}doUndo(e){e.undoSetSheetContent(this)}doRedo(e){e.redoSetSheetContent(this)}}class VW extends OW{constructor(e,t,r,n,o){super(),this.sheet=e,this.startRow=t,this.numberOfRows=r,this.targetRow=n,this.version=o,this.undoStart=this.startRow<this.targetRow?this.targetRow-this.numberOfRows:this.targetRow,this.undoEnd=this.startRow>this.targetRow?this.startRow+this.numberOfRows:this.startRow}doUndo(e){e.undoMoveRows(this)}doRedo(e){e.redoMoveRows(this)}}class HW extends OW{constructor(e,t,r,n,o){super(),this.sheet=e,this.startColumn=t,this.numberOfColumns=r,this.targetColumn=n,this.version=o,this.undoStart=this.startColumn<this.targetColumn?this.targetColumn-this.numberOfColumns:this.targetColumn,this.undoEnd=this.startColumn>this.targetColumn?this.startColumn+this.numberOfColumns:this.startColumn}doUndo(e){e.undoMoveColumns(this)}doRedo(e){e.redoMoveColumns(this)}}class DW extends OW{constructor(e){super(),this.command=e}doUndo(e){e.undoAddColumns(this)}doRedo(e){e.redoAddColumns(this)}}class UW extends OW{constructor(e,t){super(),this.command=e,this.columnsRemovals=t}doUndo(e){e.undoRemoveColumns(this)}doRedo(e){e.redoRemoveColumns(this)}}class kW extends OW{constructor(e){super(),this.sheetName=e}doUndo(e){e.undoAddSheet(this)}doRedo(e){e.redoAddSheet(this)}}class BW extends OW{constructor(e,t,r,n,o){super(),this.sheetName=e,this.sheetId=t,this.oldSheetContent=r,this.scopedNamedExpressions=n,this.version=o}doUndo(e){e.undoRemoveSheet(this)}doRedo(e){e.redoRemoveSheet(this)}}class WW extends OW{constructor(e,t,r){super(),this.sheetId=e,this.oldName=t,this.newName=r}doUndo(e){e.undoRenameSheet(this)}doRedo(e){e.redoRenameSheet(this)}}class GW extends OW{constructor(e,t){super(),this.sheetId=e,this.oldSheetContent=t}doUndo(e){e.undoClearSheet(this)}doRedo(e){e.redoClearSheet(this)}}class jW extends OW{constructor(e){super(),this.cellContents=e}doUndo(e){e.undoSetCellContents(this)}doRedo(e){e.redoSetCellContents(this)}}class zW extends OW{constructor(e,t,r,n){super(),this.targetLeftCorner=e,this.oldContent=t,this.newContent=r,this.addedGlobalNamedExpressions=n}doUndo(e){e.undoPaste(this)}doRedo(e){e.redoPaste(this)}}class $W extends OW{constructor(e,t,r,n){super(),this.name=e,this.newContent=t,this.scope=r,this.options=n}doUndo(e){e.undoAddNamedExpression(this)}doRedo(e){e.redoAddNamedExpression(this)}}class YW extends OW{constructor(e,t,r){super(),this.namedExpression=e,this.content=t,this.scope=r}doUndo(e){e.undoRemoveNamedExpression(this)}doRedo(e){e.redoRemoveNamedExpression(this)}}class XW extends OW{constructor(e,t,r,n,o){super(),this.namedExpression=e,this.newContent=t,this.oldContent=r,this.scope=n,this.options=o}doUndo(e){e.undoChangeNamedExpression(this)}doRedo(e){e.redoChangeNamedExpression(this)}}class KW extends OW{constructor(){super(...arguments),this.operations=[]}add(e){this.operations.push(e)}*reversedOperations(){for(let e=this.operations.length-1;e>=0;e--)yield this.operations[e]}doUndo(e){e.undoBatch(this)}doRedo(e){e.redoBatch(this)}}class qW{constructor(e,t){this.operations=t,this.oldData=new Map,this.undoStack=[],this.redoStack=[],this.undoLimit=e.undoLimit}saveOperation(e){void 0!==this.batchUndoEntry?this.batchUndoEntry.add(e):this.addUndoEntry(e)}beginBatchMode(){this.batchUndoEntry=new KW}commitBatchMode(){if(void 0===this.batchUndoEntry)throw Error("Batch mode wasn't started");this.addUndoEntry(this.batchUndoEntry),this.batchUndoEntry=void 0}storeDataForVersion(e,t,r){this.oldData.has(e)||this.oldData.set(e,[]);this.oldData.get(e).push([t,r])}clearRedoStack(){this.redoStack=[]}clearUndoStack(){this.undoStack=[]}isUndoStackEmpty(){return 0===this.undoStack.length}isRedoStackEmpty(){return 0===this.redoStack.length}undo(){const e=this.undoStack.pop();if(!e)throw Error("Attempted to undo without operation on stack");this.undoEntry(e),this.redoStack.push(e)}undoBatch(e){for(const t of e.reversedOperations())this.undoEntry(t)}undoRemoveRows(e){this.operations.forceApplyPostponedTransformations();const{command:{sheet:t},rowsRemovals:r}=e;for(let n=r.length-1;n>=0;--n){const e=r[n];this.operations.addRows(new SW(t,[[e.rowFrom,e.rowCount]]));for(const{address:t,cellType:r}of e.removedCells)this.operations.restoreCell(t,r);this.restoreOldDataFromVersion(e.version-1)}}undoRemoveColumns(e){this.operations.forceApplyPostponedTransformations();const{command:{sheet:t},columnsRemovals:r}=e;for(let n=r.length-1;n>=0;--n){const e=r[n];this.operations.addColumns(new TW(t,[[e.columnFrom,e.columnCount]]));for(const{address:t,cellType:r}of e.removedCells)this.operations.restoreCell(t,r);this.restoreOldDataFromVersion(e.version-1)}}undoAddRows(e){const t=e.command.rowsSpans();for(let r=t.length-1;r>=0;--r){const n=t[r];this.operations.removeRows(new RW(e.command.sheet,[[n.rowStart,n.numberOfRows]]))}}undoAddColumns(e){const t=e.command.columnsSpans();for(let r=t.length-1;r>=0;--r){const n=t[r];this.operations.removeColumns(new CW(e.command.sheet,[[n.columnStart,n.numberOfColumns]]))}}undoSetCellContents(e){for(const t of e.cellContents){const e=t.address,[r,n]=t.oldContent;Ck(e,r)||this.operations.setCellEmpty(e),this.operations.restoreCell(r,n)}}undoPaste(e){this.restoreOperationOldContent(e.oldContent);for(const t of e.addedGlobalNamedExpressions)this.operations.removeNamedExpression(t)}undoMoveRows(e){const{sheet:t}=e;this.operations.moveRows(t,e.undoStart,e.numberOfRows,e.undoEnd),this.restoreOldDataFromVersion(e.version-1)}undoMoveColumns(e){const{sheet:t}=e;this.operations.moveColumns(t,e.undoStart,e.numberOfColumns,e.undoEnd),this.restoreOldDataFromVersion(e.version-1)}undoMoveCells(e){this.operations.forceApplyPostponedTransformations(),this.operations.moveCells(e.destinationLeftCorner,e.width,e.height,e.sourceLeftCorner),this.restoreOperationOldContent(e.overwrittenCellsData),this.restoreOldDataFromVersion(e.version-1);for(const t of e.addedGlobalNamedExpressions)this.operations.removeNamedExpression(t)}undoAddSheet(e){const{sheetName:t}=e;this.operations.removeSheetByName(t)}undoRemoveSheet(e){this.operations.forceApplyPostponedTransformations();const{oldSheetContent:t,sheetId:r}=e;this.operations.addSheet(e.sheetName);for(let n=0;n<t.length;n++){const e=t[n];for(let t=0;t<e.length;t++){const o=e[t],i=wk(r,t,n);this.operations.restoreCell(i,o)}}for(const[n,o]of e.scopedNamedExpressions)this.operations.restoreNamedExpression(n,o,r);this.restoreOldDataFromVersion(e.version-1)}undoRenameSheet(e){this.operations.renameSheet(e.sheetId,e.oldName)}undoClearSheet(e){const{oldSheetContent:t,sheetId:r}=e;for(let n=0;n<t.length;n++){const e=t[n];for(let t=0;t<e.length;t++){const o=e[t],i=wk(r,t,n);this.operations.restoreCell(i,o)}}}undoSetSheetContent(e){const{oldSheetContent:t,sheetId:r}=e;this.operations.clearSheet(r);for(let n=0;n<t.length;n++){const e=t[n];for(let t=0;t<e.length;t++){const o=e[t],i=wk(r,t,n);this.operations.restoreCell(i,o)}}}undoAddNamedExpression(e){this.operations.removeNamedExpression(e.name,e.scope)}undoRemoveNamedExpression(e){this.operations.restoreNamedExpression(e.namedExpression,e.content,e.scope)}undoChangeNamedExpression(e){this.operations.restoreNamedExpression(e.namedExpression,e.oldContent,e.scope)}undoSetRowOrder(e){this.restoreOperationOldContent(e.oldContent)}undoSetColumnOrder(e){this.restoreOperationOldContent(e.oldContent)}redo(){const e=this.redoStack.pop();if(!e)throw Error("Attempted to redo without operation on stack");this.redoEntry(e),this.undoStack.push(e)}redoBatch(e){for(const t of e.operations)this.redoEntry(t)}redoRemoveRows(e){this.operations.removeRows(e.command)}redoMoveCells(e){this.operations.moveCells(e.sourceLeftCorner,e.width,e.height,e.destinationLeftCorner)}redoRemoveColumns(e){this.operations.removeColumns(e.command)}redoPaste(e){const{targetLeftCorner:t,newContent:r}=e,n=r.length,o=r[0].length;for(let i=0;i<n;++i)for(let e=0;e<o;++e){const n=wk(t.sheet,t.col+e,t.row+i);this.operations.restoreCell(n,r[i][e])}}redoSetCellContents(e){for(const t of e.cellContents)this.operations.setCellContent(t.address,t.newContent)}redoAddRows(e){this.operations.addRows(e.command)}redoAddColumns(e){this.operations.addColumns(e.command)}redoRemoveSheet(e){this.operations.removeSheetByName(e.sheetName)}redoAddSheet(e){this.operations.addSheet(e.sheetName)}redoRenameSheet(e){this.operations.renameSheet(e.sheetId,e.newName)}redoMoveRows(e){this.operations.moveRows(e.sheet,e.startRow,e.numberOfRows,e.targetRow)}redoMoveColumns(e){this.operations.moveColumns(e.sheet,e.startColumn,e.numberOfColumns,e.targetColumn)}redoClearSheet(e){this.operations.clearSheet(e.sheetId)}redoSetSheetContent(e){const{sheetId:t,newSheetContent:r}=e;this.operations.setSheetContent(t,r)}redoAddNamedExpression(e){this.operations.addNamedExpression(e.name,e.newContent,e.scope,e.options)}redoRemoveNamedExpression(e){this.operations.removeNamedExpression(e.namedExpression.displayName,e.scope)}redoChangeNamedExpression(e){this.operations.changeNamedExpressionExpression(e.namedExpression.displayName,e.newContent,e.scope,e.options)}redoSetRowOrder(e){this.operations.setRowOrder(e.sheetId,e.rowMapping)}redoSetColumnOrder(e){this.operations.setColumnOrder(e.sheetId,e.columnMapping)}addUndoEntry(e){this.undoStack.push(e),this.undoStack.splice(0,Math.max(0,this.undoStack.length-this.undoLimit))}undoEntry(e){e.doUndo(this)}restoreOperationOldContent(e){for(const[t,r]of e)this.operations.restoreCell(t,r)}redoEntry(e){e.doRedo(this)}restoreOldDataFromVersion(e){const t=this.oldData.get(e)||[];for(const r of t){const[e,t]=r;this.operations.setFormulaToCellFromCache(t,e)}}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class QW{constructor(e,t,r,n,o,i,s,a,l,u){this.operations=t,this.undoRedo=r,this.clipboardOperations=n,this.dependencyGraph=o,this.columnSearch=i,this.parser=s,this.cellContentParser=a,this.lazilyTransformingAstService=l,this.namedExpressions=u,this.maxRows=e.maxRows,this.maxColumns=e.maxColumns}get sheetMapping(){return this.dependencyGraph.sheetMapping}addRows(e,...t){const r=new SW(e,t);this.ensureItIsPossibleToAddRows(e,...t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.operations.addRows(r),this.undoRedo.saveOperation(new xW(r))}removeRows(e,...t){const r=new RW(e,t);this.ensureItIsPossibleToRemoveRows(e,...t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const n=this.operations.removeRows(r);this.undoRedo.saveOperation(new MW(r,n))}addColumns(e,...t){const r=new TW(e,t);this.ensureItIsPossibleToAddColumns(e,...t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.operations.addColumns(r),this.undoRedo.saveOperation(new DW(r))}removeColumns(e,...t){const r=new CW(e,t);this.ensureItIsPossibleToRemoveColumns(e,...t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const n=this.operations.removeColumns(r);this.undoRedo.saveOperation(new UW(r,n))}moveCells(e,t,r,n){this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const{version:o,overwrittenCellsData:i,addedGlobalNamedExpressions:s}=this.operations.moveCells(e,t,r,n);this.undoRedo.saveOperation(new _W(e,t,r,n,i,s,o))}moveRows(e,t,r,n){this.ensureItIsPossibleToMoveRows(e,t,r,n),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const o=this.operations.moveRows(e,t,r,n);this.undoRedo.saveOperation(new VW(e,t,r,n,o))}moveColumns(e,t,r,n){this.ensureItIsPossibleToMoveColumns(e,t,r,n),this.undoRedo.clearRedoStack();const o=this.operations.moveColumns(e,t,r,n);this.undoRedo.saveOperation(new HW(e,t,r,n,o))}cut(e,t,r){this.clipboardOperations.cut(e,t,r)}ensureItIsPossibleToCopy(e,t,r){if(!ZW(t))throw new nU("width to be positive integer.");if(!ZW(r))throw new nU("height to be positive integer.")}copy(e,t,r){this.ensureItIsPossibleToCopy(e,t,r),this.clipboardOperations.copy(e,t,r)}paste(e){const t=this.clipboardOperations.clipboard;if(void 0===t)throw new hU;if(this.clipboardOperations.isCutClipboard())this.moveCells(t.sourceLeftCorner,t.width,t.height,e);else if(this.clipboardOperations.isCopyClipboard()){this.clipboardOperations.ensureItIsPossibleToCopyPaste(e);const r=Ak.spanFrom(e,t.width,t.height),n=this.operations.getRangeClipboardCells(r);this.undoRedo.clearRedoStack();const o=this.operations.restoreClipboardCells(t.sourceLeftCorner.sheet,t.getContent(e));this.undoRedo.saveOperation(new zW(e,n,t.content,o))}}beginUndoRedoBatchMode(){this.undoRedo.beginBatchMode()}commitUndoRedoBatchMode(){this.undoRedo.commitBatchMode()}isClipboardEmpty(){return void 0===this.clipboardOperations.clipboard}clearClipboard(){this.clipboardOperations.clear()}addSheet(e){void 0!==e&&this.ensureItIsPossibleToAddSheet(e),this.undoRedo.clearRedoStack();const t=this.operations.addSheet(e);return this.undoRedo.saveOperation(new kW(t)),t}removeSheet(e){this.ensureScopeIdIsValid(e),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const t=this.sheetMapping.fetchDisplayName(e),r=this.operations.getSheetClipboardCells(e),{version:n,scopedNamedExpressions:o}=this.operations.removeSheet(e);this.undoRedo.saveOperation(new BW(t,e,r,o,n))}renameSheet(e,t){this.ensureItIsPossibleToRenameSheet(e,t);const r=this.operations.renameSheet(e,t);return void 0!==r&&(this.undoRedo.clearRedoStack(),this.undoRedo.saveOperation(new WW(e,r,t))),r}clearSheet(e){this.ensureScopeIdIsValid(e),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const t=this.operations.getSheetClipboardCells(e);this.operations.clearSheet(e),this.undoRedo.saveOperation(new GW(e,t))}setCellContents(e,t){if(t instanceof Array){for(let n=0;n<t.length;n++)if(!(t[n]instanceof Array))throw new nU("an array of arrays or a raw cell value.")}else t=[[t]];this.ensureItIsPossibleToChangeCellContents(e,t),this.undoRedo.clearRedoStack();const r=[];for(let n=0;n<t.length;n++)for(let o=0;o<t[n].length;o++){const i={sheet:e.sheet,row:e.row+n,col:e.col+o},s=t[n][o];this.clipboardOperations.abortCut();const a=this.operations.setCellContent(i,s);r.push({address:i,newContent:s,oldContent:a})}this.undoRedo.saveOperation(new jW(r))}setSheetContent(e,t){this.ensureScopeIdIsValid(e),this.ensureItIsPossibleToChangeSheetContents(e,t),EW(t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const r=this.operations.getSheetClipboardCells(e);this.operations.setSheetContent(e,t),this.undoRedo.saveOperation(new PW(e,r,t))}setRowOrder(e,t){this.validateSwapRowIndexes(e,t),this.testRowOrderForArrays(e,t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const r=this.operations.setRowOrder(e,t);this.undoRedo.saveOperation(new LW(e,t,r))}validateSwapRowIndexes(e,t){if(!this.sheetMapping.hasSheetWithId(e))throw new QD(e);this.validateRowOrColumnMapping(e,t,"row")}testColumnOrderForArrays(e,t){for(const[r,n]of t)if(r!==n){const t=Ak.spanFrom({sheet:e,col:r,row:0},1,1/0);if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(t))throw new bU}}setColumnOrder(e,t){this.validateSwapColumnIndexes(e,t),this.testColumnOrderForArrays(e,t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const r=this.operations.setColumnOrder(e,t);this.undoRedo.saveOperation(new FW(e,t,r))}validateSwapColumnIndexes(e,t){if(!this.sheetMapping.hasSheetWithId(e))throw new QD(e);this.validateRowOrColumnMapping(e,t,"column")}testRowOrderForArrays(e,t){for(const[r,n]of t)if(r!==n){const t=Ak.spanFrom({sheet:e,col:0,row:r},1/0,1);if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(t))throw new bU}}mappingFromOrder(e,t,r){if(!this.sheetMapping.hasSheetWithId(e))throw new QD(e);const n="row"===r?this.dependencyGraph.getSheetHeight(e):this.dependencyGraph.getSheetWidth(e);if(t.length!==n)throw new nU(`number of ${r}s provided to be sheet ${"row"===r?"height":"width"}.`);const o=[];for(let i=0;i<n;i++)t[i]!==i&&o.push([i,t[i]]);return o}undo(){if(this.undoRedo.isUndoStackEmpty())throw new lU;this.clipboardOperations.abortCut(),this.undoRedo.undo()}redo(){if(this.undoRedo.isRedoStackEmpty())throw new uU;this.clipboardOperations.abortCut(),this.undoRedo.redo()}addNamedExpression(e,t,r,n){this.ensureItIsPossibleToAddNamedExpression(e,t,r),this.operations.addNamedExpression(e,t,r,n),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.undoRedo.saveOperation(new $W(e,t,r,n))}changeNamedExpressionExpression(e,t,r,n){this.ensureItIsPossibleToChangeNamedExpression(e,r,t);const[o,i]=this.operations.changeNamedExpressionExpression(e,r,t,n);this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.undoRedo.saveOperation(new XW(o,r,i,t,n))}removeNamedExpression(e,t){this.ensureScopeIdIsValid(t);const[r,n]=this.operations.removeNamedExpression(e,t);return this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.undoRedo.saveOperation(new YW(r,n,t)),r}ensureItIsPossibleToAddNamedExpression(e,t,r){this.ensureScopeIdIsValid(r),this.ensureNamedExpressionNameIsValid(e,r),this.ensureNamedExpressionIsValid(t)}ensureItIsPossibleToChangeNamedExpression(e,t,r){if(this.ensureScopeIdIsValid(r),void 0===this.namedExpressions.namedExpressionForScope(e,r))throw new aU(e);this.ensureNamedExpressionIsValid(t)}isItPossibleToRemoveNamedExpression(e,t){if(this.ensureScopeIdIsValid(t),void 0===this.namedExpressions.namedExpressionForScope(e,t))throw new aU(e)}ensureItIsPossibleToAddRows(e,...t){if(!this.sheetMapping.hasSheetWithId(e))throw new QD(e);const r=this.dependencyGraph.getSheetHeight(e),n=t.map((e=>e[1])).reduce(((e,t)=>e+t),0);if(r+n>this.maxRows)throw new eU;for(const[o,i]of t)if(!JW(o)||!ZW(i))throw new nU("row number to be nonnegative and number of rows to add to be positive.")}ensureItIsPossibleToRemoveRows(e,...t){for(const[r,n]of t){const t=r+n-1;if(!JW(r)||!JW(t))throw new nU("starting and ending row to be nonnegative.");if(t<r)throw new nU("starting row to be smaller than the ending row.");if(!this.sheetMapping.hasSheetWithId(e))throw new QD(e)}}ensureItIsPossibleToAddColumns(e,...t){if(!this.sheetMapping.hasSheetWithId(e))throw new QD(e);const r=this.dependencyGraph.getSheetWidth(e),n=t.map((e=>e[1])).reduce(((e,t)=>e+t),0);if(r+n>this.maxColumns)throw new eU;for(const[o,i]of t)if(!JW(o)||!ZW(i))throw new nU("column number to be nonnegative and number of columns to add to be positive.")}ensureItIsPossibleToRemoveColumns(e,...t){for(const[r,n]of t){const t=r+n-1;if(!JW(r)||!JW(t))throw new nU("starting and ending column to be nonnegative.");if(t<r)throw new nU("starting column to be smaller than the ending column.");if(!this.sheetMapping.hasSheetWithId(e))throw new QD(e)}}ensureItIsPossibleToMoveRows(e,t,r,n){this.ensureItIsPossibleToAddRows(e,[n,r]);const o=wk(e,0,t),i=wk(e,0,n);if(!this.sheetMapping.hasSheetWithId(e)||Ek(o)||Ek(i)||!ZW(r)||n<=t+r&&n>=t)throw new nU("a valid range of rows to move.");const s=this.dependencyGraph.getSheetWidth(e),a=Ak.spanFrom(o,s,r);if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(a))throw new bU;if(n>0&&this.dependencyGraph.arrayMapping.isFormulaArrayInAllRows(YD.fromNumberOfRows(e,n-1,2)))throw new NU}ensureItIsPossibleToMoveColumns(e,t,r,n){this.ensureItIsPossibleToAddColumns(e,[n,r]);const o=wk(e,t,0),i=wk(e,n,0);if(!this.sheetMapping.hasSheetWithId(e)||Ek(o)||Ek(i)||!ZW(r)||n<=t+r&&n>=t)throw new nU("a valid range of columns to move.");const s=this.dependencyGraph.getSheetHeight(e),a=Ak.spanFrom(o,r,s);if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(a))throw new bU;if(n>0&&this.dependencyGraph.arrayMapping.isFormulaArrayInAllColumns(XD.fromNumberOfColumns(e,n-1,2)))throw new NU}ensureItIsPossibleToAddSheet(e){if(this.sheetMapping.hasSheetWithName(e))throw new JD(e)}ensureItIsPossibleToRenameSheet(e,t){if(!this.sheetMapping.hasSheetWithId(e))throw new QD(e);const r=this.sheetMapping.get(t);if(void 0!==r&&r!==e)throw new JD(t)}ensureItIsPossibleToChangeContent(e){if(Ek(e))throw new rU(e);if(!this.sheetMapping.hasSheetWithId(e.sheet))throw new QD(e.sheet)}ensureItIsPossibleToChangeCellContents(e,t){const r=vW(t),n=Ak.spanFrom(e,r.width,r.height);this.ensureRangeInSizeLimits(n);for(const o of n.addresses(this.dependencyGraph))this.ensureItIsPossibleToChangeContent(o)}ensureItIsPossibleToChangeSheetContents(e,t){const r=vW(t),n=Ak.spanFrom(wk(e,0,0),r.width,r.height);this.ensureRangeInSizeLimits(n)}ensureRangeInSizeLimits(e){if(e.exceedsSheetSizeLimits(this.maxColumns,this.maxRows))throw new eU}isThereSomethingToUndo(){return!this.undoRedo.isUndoStackEmpty()}isThereSomethingToRedo(){return!this.undoRedo.isRedoStackEmpty()}getAndClearContentChanges(){return this.operations.getAndClearContentChanges()}ensureScopeIdIsValid(e){if(void 0!==e&&!this.sheetMapping.hasSheetWithId(e))throw new QD(e)}validateRowOrColumnMapping(e,t,r){const n="row"===r?this.dependencyGraph.getSheetHeight(e):this.dependencyGraph.getSheetWidth(e),o=t.map((([e,t])=>e)).sort(((e,t)=>e-t)),i=t.map((([e,t])=>t)).sort(((e,t)=>e-t));for(let s=0;s<o.length;s++){if(!JW(o[s])||o[s]>=n)throw new nU(`${r} numbers to be nonnegative integers and less than sheet ${"row"===r?"height":"width"}.`);if(o[s]===o[s+1])throw new nU(`source ${r} numbers to be unique.`);if(o[s]!==i[s])throw new nU(`target ${r} numbers to be permutation of source ${r} numbers.`)}}ensureNamedExpressionNameIsValid(e,t){if(!this.namedExpressions.isNameValid(e))throw new sU(e);if(!this.namedExpressions.isNameAvailable(e,t))throw new iU(e)}ensureNamedExpressionIsValid(e){const t=this.cellContentParser.parse(e);if(t instanceof JB.Formula){const e=this.parser.parse(t.formula,wk(-1,0,0));if(uW(e.ast))throw new AU}}}function ZW(e){return Number.isInteger(e)&&e>0}function JW(e){return Number.isInteger(e)&&e>=0}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class eG{constructor(e,t,r,n,o,i){this.config=e,this.stats=t,this.interpreter=r,this.lazilyTransformingAstService=n,this.dependencyGraph=o,this.columnSearch=i}run(){this.stats.start(GD.TOP_SORT);const{sorted:e,cycled:t}=this.dependencyGraph.topSortWithScc();this.stats.end(GD.TOP_SORT),this.stats.measure(GD.EVALUATION,(()=>{this.recomputeFormulas(t,e)}))}partialRun(e){const t=$D.empty();return this.stats.measure(GD.EVALUATION,(()=>{this.dependencyGraph.graph.getTopSortedWithSccSubgraphFrom(e,(e=>{if(e instanceof FU){const r=e.isComputed()?e.getCellValue():void 0,n=this.recomputeFormulaVertexValue(e);if(n!==r){const o=e.getAddress(this.lazilyTransformingAstService);return t.addChange(n,o),this.columnSearch.change(LD(r),LD(n),o),!0}return!1}return!(e instanceof HU)||(e.clearCache(),!0)}),(e=>{if(e instanceof HU)e.clearCache();else if(e instanceof FU){const r=e.getAddress(this.lazilyTransformingAstService);this.columnSearch.remove(LD(e.valueOrUndef()),r);const n=new pk(XU.CYCLE,void 0,e);e.setCellValue(n),t.addChange(n,r)}}))})),t}runAndForget(e,t,r){const n=[];for(const i of _D(r,t))if(i instanceof Ak){const e=i;if(void 0===this.dependencyGraph.getRange(e.start,e.end)){const t=new HU(e);this.dependencyGraph.rangeMapping.setRange(t),n.push(t)}}const o=this.evaluateAstToCellValue(e,new Mk(t,this.config.useArrayArithmetic));return n.forEach((e=>{this.dependencyGraph.rangeMapping.removeRange(e)})),o}recomputeFormulas(e,t){e.forEach((e=>{e instanceof FU&&e.setCellValue(new pk(XU.CYCLE,void 0,e))})),t.forEach((e=>{if(e instanceof FU){const t=this.recomputeFormulaVertexValue(e),r=e.getAddress(this.lazilyTransformingAstService);this.columnSearch.add(LD(t),r)}else e instanceof HU&&e.clearCache()}))}recomputeFormulaVertexValue(e){const t=e.getAddress(this.lazilyTransformingAstService);if(e instanceof PU&&(e.array.size.isRef||!this.dependencyGraph.isThereSpaceForArray(e)))return e.setNoSpace();{const r=e.getFormula(this.lazilyTransformingAstService),n=this.evaluateAstToCellValue(r,new Mk(t,this.config.useArrayArithmetic,e));return e.setCellValue(n)}}evaluateAstToCellValue(e,t){const r=this.interpreter.evaluateAst(e,t);return r instanceof zD?r:r===xD&&this.config.evaluateNullToZero?0:r}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class tG{constructor(e,t){this.address=e,this.newValue=t}get col(){return this.address.col}get row(){return this.address.row}get sheet(){return this.address.sheet}get value(){return this.newValue}}class rG{constructor(e,t){this.name=e,this.newValue=t}}class nG{constructor(e,t,r,n){this.config=e,this.namedExpressions=t,this.sheetIndexMapping=r,this.lazilyTransformingService=n}exportChange(e){const t=e.value,r=e.address;if(r.sheet===lW.SHEET_FOR_WORKBOOK_EXPRESSIONS){const e=this.namedExpressions.namedExpressionInAddress(r.row);if(!e)throw new Error("Missing named expression");return new rG(e.displayName,this.exportScalarOrRange(t))}if(t instanceof zD){const e=[];for(const[n,o]of t.entriesFromTopLeftCorner(r))e.push(new tG(o,this.exportValue(n)));return e}return new tG(r,this.exportValue(t))}exportValue(e){return e instanceof zD?this.detailedError(new pk(XU.VALUE,BH.ScalarExpected)):this.config.smartRounding&&BD(e)?this.cellValueRounding(LD(e)):e instanceof pk?this.detailedError(e):e===xD?null:LD(e)}exportScalarOrRange(e){return e instanceof zD?e.rawData().map((e=>e.map((e=>this.exportValue(e))))):this.exportValue(e)}detailedError(e){var t,r;let n;const o=null===(t=e.root)||void 0===t?void 0:t.getAddress(this.lazilyTransformingService);return void 0!==o&&(n=o.sheet===lW.SHEET_FOR_WORKBOOK_EXPRESSIONS?null===(r=this.namedExpressions.namedExpressionInAddress(o.row))||void 0===r?void 0:r.displayName:rL(this.sheetIndexMapping,o,-1)),new tB(e,this.config.translationPackage.getErrorTranslation(e.type),n)}cellValueRounding(e){if(0===e)return e;const t=Math.floor(Math.log10(Math.abs(e))),r=Math.pow(10,this.config.precisionRounding-t);return e<0?-Math.round(-e*r)/r:Math.round(e*r)/r}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class oG{constructor(e,t,r,n,o,i){this.dependencyGraph=e,this.columnSearch=t,this.parser=r,this.cellContentParser=n,this.stats=o,this.arraySizePredictor=i,this.buildStrategy=new iG(e,t,r,o,n,i)}buildGraph(e,t){const r=t.measure(GD.COLLECT_DEPENDENCIES,(()=>this.buildStrategy.run(e)));this.dependencyGraph.getAndClearContentChanges(),t.measure(GD.PROCESS_DEPENDENCIES,(()=>this.processDependencies(r)))}processDependencies(e){e.forEach(((e,t)=>{this.dependencyGraph.processCellDependencies(e,t)}))}}class iG{constructor(e,t,r,n,o,i){this.dependencyGraph=e,this.columnIndex=t,this.parser=r,this.stats=n,this.cellContentParser=o,this.arraySizePredictor=i}run(e){const t=new Map;for(const r in e){const n=this.dependencyGraph.getSheetId(r),o=e[r];for(let e=0;e<o.length;++e){const r=o[e];for(let o=0;o<r.length;++o){const i=r[o],s=wk(n,o,e),a=this.cellContentParser.parse(i);if(a instanceof JB.Formula){const e=this.stats.measure(GD.PARSER,(()=>this.parser.parse(a.formula,s)));if(e.errors.length>0){this.shrinkArrayIfNeeded(s);const t=new rk(e.errors,a.formula);this.dependencyGraph.addVertex(s,t)}else{this.shrinkArrayIfNeeded(s);const r=this.arraySizePredictor.checkArraySize(e.ast,s);if(r.isScalar()){const r=new VU(e.ast,s,0);t.set(r,_D(e.dependencies,s)),this.dependencyGraph.addVertex(s,r),e.hasVolatileFunction&&this.dependencyGraph.markAsVolatile(r),e.hasStructuralChangeFunction&&this.dependencyGraph.markAsDependentOnStructureChange(r)}else{const n=new PU(e.ast,s,new Jk(r.width,r.height));t.set(n,_D(e.dependencies,s)),this.dependencyGraph.addArrayVertex(s,n)}}}else if(a instanceof JB.Empty);else{this.shrinkArrayIfNeeded(s);const e=new tk(a.value,i);this.columnIndex.add(LD(a.value),s),this.dependencyGraph.addVertex(s,e)}}}}return t}shrinkArrayIfNeeded(e){const t=this.dependencyGraph.getCell(e);t instanceof PU&&this.dependencyGraph.shrinkArrayToCorner(t)}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */const sG=new Map([["gpl-v3",1],["missing",2],["invalid",3],["expired",4]]);class aG extends Zk{version(e,t){return this.runFunction(e.args,t,this.metadata("VERSION"),(()=>{const{licenseKeyValidityState:e,licenseKey:t}=this.config;let r;return sG.has(t)?r=sG.get(t):sG.has(e)?r=sG.get(e):"valid"===e&&(r=t.slice(-5)),`HyperFormula v${VG.version}, ${r}`}))}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
function lG(e,t){var r;let n=t.implementedFunctions[e];const o=null===(r=t.aliases)||void 0===r?void 0:r[e];if(void 0!==o){if(void 0!==n)throw new IU(e,t.name);n=t.implementedFunctions[o]}if(void 0===n)throw TU.functionNotDeclaredInPlugin(e,t.name);return n}aG.implementedFunctions={VERSION:{method:"version",parameters:[]}};class uG{constructor(e){if(this.config=e,this.functions=new Map,this.arraySizeFunctions=new Map,this.volatileFunctions=new Set,this.arrayFunctions=new Set,this.structuralChangeFunctions=new Set,this.functionsWhichDoesNotNeedArgumentsToBeComputed=new Set,this.functionsMetadata=new Map,this.doesFunctionNeedArgumentToBeComputed=e=>this.functionsWhichDoesNotNeedArgumentsToBeComputed.has(e),this.isFunctionVolatile=e=>this.volatileFunctions.has(e),this.isArrayFunction=e=>this.arrayFunctions.has(e),this.isFunctionDependentOnSheetStructureChange=e=>this.structuralChangeFunctions.has(e),e.functionPlugins.length>0){this.instancePlugins=new Map;for(const t of e.functionPlugins)uG.loadPluginFunctions(t,this.instancePlugins)}else this.instancePlugins=new Map(uG.plugins);for(const[t,r]of uG.protectedFunctions())uG.loadFunctionUnprotected(r,t,this.instancePlugins);for(const[t,r]of this.instancePlugins.entries())this.categorizeFunction(t,lG(t,r))}static registerFunctionPlugin(e,t){this.loadPluginFunctions(e,this.plugins),void 0!==t&&this.loadTranslations(t)}static registerFunction(e,t,r){this.loadPluginFunction(t,e,this.plugins),void 0!==r&&this.loadTranslations(r)}static unregisterFunction(e){if(this.functionIsProtected(e))throw CU.cannotUnregisterFunctionWithId(e);this.plugins.delete(e)}static unregisterFunctionPlugin(e){for(const t of this.protectedPlugins())if(t===e)throw CU.cannotUnregisterProtectedPlugin();for(const[t,r]of this.plugins.entries())r===e&&this.plugins.delete(t)}static unregisterAll(){this.plugins.clear()}static getRegisteredFunctionIds(){return[...Array.from(this.plugins.keys()),...Array.from(this._protectedPlugins.keys())]}static getPlugins(){return Array.from(new Set(this.plugins.values()).values())}static getFunctionPlugin(e){return this.functionIsProtected(e)?void 0:this.plugins.get(e)}static functionIsProtected(e){return this._protectedPlugins.has(e)}static loadTranslations(e){const t=new Set(VG.getRegisteredLanguagesCodes());Object.keys(e).forEach((r=>{t.has(r)&&VG.getLanguage(r).extendFunctions(e[r])}))}static loadPluginFunctions(e,t){Object.keys(e.implementedFunctions).forEach((r=>{this.loadPluginFunction(e,r,t)})),void 0!==e.aliases&&Object.keys(e.aliases).forEach((r=>{this.loadPluginFunction(e,r,t)}))}static loadPluginFunction(e,t,r){if(this.functionIsProtected(t))throw CU.cannotRegisterFunctionWithId(t);this.loadFunctionUnprotected(e,t,r)}static loadFunctionUnprotected(e,t,r){const n=lG(t,e).method;if(!Object.prototype.hasOwnProperty.call(e.prototype,n))throw TU.functionMethodNotFound(n,e.name);r.set(t,e)}static*protectedFunctions(){for(const[e,t]of this._protectedPlugins)void 0!==t&&(yield[e,t])}static*protectedPlugins(){for(const[,e]of this._protectedPlugins)void 0!==e&&(yield e)}initializePlugins(e){const t=[];for(const[r,n]of this.instancePlugins.entries()){let o=t.find((e=>e instanceof n));void 0===o&&(o=new n(e),t.push(o));const i=lG(r,n),s=i.method;this.functions.set(r,[s,o]);const a=i.arraySizeMethod;void 0!==a&&this.arraySizeFunctions.set(r,[a,o])}}getFunctionPlugin(e){if(!uG.functionIsProtected(e))return this.instancePlugins.get(e)}getFunction(e){const t=this.functions.get(e);if(void 0!==t&&this.config.translationPackage.isFunctionTranslated(e)){const[e,r]=t;return(t,n)=>r[e](t,n)}}getArraySizeFunction(e){const t=this.arraySizeFunctions.get(e);if(void 0!==t&&this.config.translationPackage.isFunctionTranslated(e)){const[e,r]=t;return(t,n)=>r[e](t,n)}}getMetadata(e){return this.functionsMetadata.get(e)}getPlugins(){const e=new Set;for(const[t,r]of this.instancePlugins)uG.functionIsProtected(t)||e.add(r);return Array.from(e)}getRegisteredFunctionIds(){return Array.from(this.functions.keys())}categorizeFunction(e,t){t.isVolatile&&this.volatileFunctions.add(e),t.arrayFunction&&this.arrayFunctions.add(e),t.doesNotNeedArgumentsToBeComputed&&this.functionsWhichDoesNotNeedArgumentsToBeComputed.add(e),t.isDependentOnSheetStructureChange&&this.structuralChangeFunctions.add(e),this.functionsMetadata.set(e,t)}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
var hG;uG.plugins=new Map,uG._protectedPlugins=new Map([["VERSION",aG],["OFFSET",void 0]]),function(e){e.GREATER_THAN="GREATER_THAN",e.GREATER_THAN_OR_EQUAL="GREATER_THAN_OR_EQUAL",e.LESS_THAN="LESS_THAN",e.LESS_THAN_OR_EQUAL="LESS_THAN_OR_EQUAL",e.NOT_EQUAL="NOT_EQUAL",e.EQUAL="EQUAL"}(hG||(hG={}));const cG=(e,t)=>({operator:e,value:t});class dG{constructor(e){var t,r,n,o;this.trueString=null!==(r=null===(t=e.translationPackage.getMaybeFunctionTranslation("TRUE"))||void 0===t?void 0:t.toLowerCase())&&void 0!==r?r:"true",this.falseString=null!==(o=null===(n=e.translationPackage.getMaybeFunctionTranslation("FALSE"))||void 0===n?void 0:n.toLowerCase())&&void 0!==o?o:"false"}fromCellValue(e,t){if("string"!=typeof e&&"boolean"!=typeof e&&"number"!=typeof e)return;const r=this.parseCriterion(e,t);return void 0!==r?{raw:e,lambda:mG(r,t)}:void 0}parseCriterion(e,t){if("number"==typeof e||"boolean"==typeof e)return cG(hG.EQUAL,e);if("string"==typeof e){const r=pG.exec(e);let n,o;r?(o=function(e){switch(e){case">":return hG.GREATER_THAN;case">=":return hG.GREATER_THAN_OR_EQUAL;case"<":return hG.LESS_THAN;case"<=":return hG.LESS_THAN_OR_EQUAL;case"<>":return hG.NOT_EQUAL;case"=":return hG.EQUAL;default:return}}(r[1]),n=r[2]):(o=hG.EQUAL,n=e);const i=t.coerceToMaybeNumber(n),s=n.toLowerCase()===this.trueString||n.toLowerCase()!==this.falseString&&void 0;if(void 0===o)return;if(""===n)return cG(o,null);if(void 0!==i)return cG(o,LD(i));if(o===hG.EQUAL||o===hG.NOT_EQUAL)return cG(o,null!=s?s:n)}}}const pG=/([<>=]+)(.*)/;const mG=(e,t)=>{switch(e.operator){case hG.GREATER_THAN:return"number"==typeof e.value?r=>"number"==typeof r&&t.floatCmp(r,e.value)>0:e=>!1;case hG.GREATER_THAN_OR_EQUAL:return"number"==typeof e.value?r=>"number"==typeof r&&t.floatCmp(r,e.value)>=0:e=>!1;case hG.LESS_THAN:return"number"==typeof e.value?r=>"number"==typeof r&&t.floatCmp(r,e.value)<0:e=>!1;case hG.LESS_THAN_OR_EQUAL:return"number"==typeof e.value?r=>"number"==typeof r&&t.floatCmp(r,e.value)<=0:e=>!1;case hG.EQUAL:return"number"==typeof e.value?r=>{if("number"==typeof r)return 0===t.floatCmp(r,e.value);if("string"==typeof r){if(""===r)return!1;const n=t.coerceToMaybeNumber(r);return void 0!==n&&0===t.floatCmp(n,e.value)}return!1}:"string"==typeof e.value?t.eqMatcherFunction(e.value):"boolean"==typeof e.value?t=>"boolean"==typeof t&&t===e.value:e=>e===xD;case hG.NOT_EQUAL:return"number"==typeof e.value?r=>{if("number"==typeof r)return 0!==t.floatCmp(r,e.value);if("string"==typeof r){if(""===r)return!0;const n=t.coerceToMaybeNumber(r);return void 0===n||0!==t.floatCmp(n,e.value)}return!0}:"string"==typeof e.value?t.neqMatcherFunction(e.value):"boolean"==typeof e.value?t=>"boolean"!=typeof t||t!==e.value:e=>e!==xD}};
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class gG{constructor(e,t,r,n,o,i,s,a,l,u){this.config=e,this.dependencyGraph=t,this.columnSearch=r,this.stats=n,this.arithmeticHelper=o,this.functionRegistry=i,this.namedExpressions=s,this.serialization=a,this.arraySizePredictor=l,this.dateTimeHelper=u,this.equalOp=(e,t)=>yG(this.arithmeticHelper.eq,e,t),this.notEqualOp=(e,t)=>yG(this.arithmeticHelper.neq,e,t),this.greaterThanOp=(e,t)=>yG(this.arithmeticHelper.gt,e,t),this.lessThanOp=(e,t)=>yG(this.arithmeticHelper.lt,e,t),this.greaterThanOrEqualOp=(e,t)=>yG(this.arithmeticHelper.geq,e,t),this.lessThanOrEqualOp=(e,t)=>yG(this.arithmeticHelper.leq,e,t),this.concatOp=(e,t)=>yG(this.arithmeticHelper.concat,Dk(e),Dk(t)),this.plusOp=(e,t)=>yG(this.arithmeticHelper.addWithEpsilon,this.arithmeticHelper.coerceScalarToNumberOrError(e),this.arithmeticHelper.coerceScalarToNumberOrError(t)),this.minusOp=(e,t)=>yG(this.arithmeticHelper.subtract,this.arithmeticHelper.coerceScalarToNumberOrError(e),this.arithmeticHelper.coerceScalarToNumberOrError(t)),this.timesOp=(e,t)=>yG(this.arithmeticHelper.multiply,this.arithmeticHelper.coerceScalarToNumberOrError(e),this.arithmeticHelper.coerceScalarToNumberOrError(t)),this.powerOp=(e,t)=>yG(this.arithmeticHelper.pow,this.arithmeticHelper.coerceScalarToNumberOrError(e),this.arithmeticHelper.coerceScalarToNumberOrError(t)),this.divOp=(e,t)=>yG(this.arithmeticHelper.divide,this.arithmeticHelper.coerceScalarToNumberOrError(e),this.arithmeticHelper.coerceScalarToNumberOrError(t)),this.unaryMinusOp=e=>fG(this.arithmeticHelper.unaryMinus,this.arithmeticHelper.coerceScalarToNumberOrError(e)),this.percentOp=e=>fG(this.arithmeticHelper.unaryPercent,this.arithmeticHelper.coerceScalarToNumberOrError(e)),this.unaryPlusOp=e=>this.arithmeticHelper.unaryPlus(e),this.functionRegistry.initializePlugins(this),this.criterionBuilder=new dG(e)}evaluateAst(e,t){let r=this.evaluateAstWithoutPostprocessing(e,t);if(BD(r)){if(Bk(LD(r)))return new pk(XU.NUM,BH.NaN);r=PD(r,Wk(LD(r)))}return r instanceof zD&&1===r.height()&&1===r.width()&&([[r]]=r.data),function(e,t){if(e instanceof pk&&void 0!==t)return e.attachRootVertex(t);return e}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */(r,t.formulaVertex)}evaluateAstWithoutPostprocessing(e,t){switch(e.type){case IH.EMPTY:return xD;case IH.CELL_REFERENCE:{const r=e.reference.toSimpleCellAddress(t.formulaAddress);return Ek(r)?new pk(XU.REF,BH.BadRef):this.dependencyGraph.getCellValue(r)}case IH.NUMBER:case IH.STRING:return e.value;case IH.CONCATENATE_OP:{const r=this.evaluateAst(e.left,t),n=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.concatOp,r,n,t)}case IH.EQUALS_OP:{const r=this.evaluateAst(e.left,t),n=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.equalOp,r,n,t)}case IH.NOT_EQUAL_OP:{const r=this.evaluateAst(e.left,t),n=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.notEqualOp,r,n,t)}case IH.GREATER_THAN_OP:{const r=this.evaluateAst(e.left,t),n=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.greaterThanOp,r,n,t)}case IH.LESS_THAN_OP:{const r=this.evaluateAst(e.left,t),n=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.lessThanOp,r,n,t)}case IH.GREATER_THAN_OR_EQUAL_OP:{const r=this.evaluateAst(e.left,t),n=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.greaterThanOrEqualOp,r,n,t)}case IH.LESS_THAN_OR_EQUAL_OP:{const r=this.evaluateAst(e.left,t),n=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.lessThanOrEqualOp,r,n,t)}case IH.PLUS_OP:{const r=this.evaluateAst(e.left,t),n=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.plusOp,r,n,t)}case IH.MINUS_OP:{const r=this.evaluateAst(e.left,t),n=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.minusOp,r,n,t)}case IH.TIMES_OP:{const r=this.evaluateAst(e.left,t),n=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.timesOp,r,n,t)}case IH.POWER_OP:{const r=this.evaluateAst(e.left,t),n=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.powerOp,r,n,t)}case IH.DIV_OP:{const r=this.evaluateAst(e.left,t),n=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.divOp,r,n,t)}case IH.PLUS_UNARY_OP:{const r=this.evaluateAst(e.value,t);return this.unaryRangeWrapper(this.unaryPlusOp,r,t)}case IH.MINUS_UNARY_OP:{const r=this.evaluateAst(e.value,t);return this.unaryRangeWrapper(this.unaryMinusOp,r,t)}case IH.PERCENT_OP:{const r=this.evaluateAst(e.value,t);return this.unaryRangeWrapper(this.percentOp,r,t)}case IH.FUNCTION_CALL:{if("valid"!==this.config.licenseKeyValidityState&&!uG.functionIsProtected(e.procedureName))return new pk(XU.LIC,BH.LicenseKey(this.config.licenseKeyValidityState));const r=this.functionRegistry.getFunction(e.procedureName);return void 0!==r?r(e,new Mk(t.formulaAddress,t.arraysFlag||this.functionRegistry.isArrayFunction(e.procedureName),t.formulaVertex)):new pk(XU.NAME,BH.FunctionName(e.procedureName))}case IH.NAMED_EXPRESSION:{const r=this.namedExpressions.nearestNamedExpression(e.expressionName,t.formulaAddress.sheet);return r?this.dependencyGraph.getCellValue(r.address):new pk(XU.NAME,BH.NamedExpressionName(e.expressionName))}case IH.CELL_RANGE:{if(!this.rangeSpansOneSheet(e))return new pk(XU.REF,BH.RangeManySheets);const r=Ak.fromCellRange(e,t.formulaAddress),n=this.dependencyGraph.getArray(r);if(n){const e=n.array;if(e instanceof _U)throw new Error("Array should be already computed");if(e instanceof pk)return e;if(e instanceof xU)return zD.fromRange(e.raw(),r,this.dependencyGraph);throw new Error("Unknown array")}return zD.onlyRange(r,this.dependencyGraph)}case IH.COLUMN_RANGE:{if(!this.rangeSpansOneSheet(e))return new pk(XU.REF,BH.RangeManySheets);const r=Ik.fromColumnRange(e,t.formulaAddress);return zD.onlyRange(r,this.dependencyGraph)}case IH.ROW_RANGE:{if(!this.rangeSpansOneSheet(e))return new pk(XU.REF,BH.RangeManySheets);const r=Ok.fromRowRangeAst(e,t.formulaAddress);return zD.onlyRange(r,this.dependencyGraph)}case IH.PARENTHESIS:return this.evaluateAst(e.expression,t);case IH.ARRAY:{let r;const n=[];for(const o of e.args){let e;const i=[];for(const r of o){const n=Fk(this.evaluateAst(r,t)),o=n.height();if(void 0===e)e=o,i.push(...n.data);else{if(e!==o)return new pk(XU.REF,BH.SizeMismatch);for(let e=0;e<o;e++)i[e].push(...n.data[e])}}const s=i[0].length;if(void 0===r)r=s,n.push(...i);else{if(r!==s)return new pk(XU.REF,BH.SizeMismatch);n.push(...i)}}return zD.onlyValues(n)}case IH.ERROR_WITH_RAW_INPUT:case IH.ERROR:return e.error}}rangeSpansOneSheet(e){return e.start.sheet===e.end.sheet}unaryRangeWrapper(e,t,r){var n;if(t instanceof zD&&!r.arraysFlag&&(t=null!==(n=Kk(t,r))&&void 0!==n?n:new pk(XU.VALUE,BH.ScalarExpected)),t instanceof pk)return t;if(t instanceof zD){const r=t.data.map((t=>t.map(e)));return zD.onlyValues(r)}return e(t)}binaryRangeWrapper(e,t,r,n){var o,i;if(t instanceof zD&&!n.arraysFlag&&(t=null!==(o=Kk(t,n))&&void 0!==o?o:new pk(XU.VALUE,BH.ScalarExpected)),t instanceof pk)return t;if(r instanceof zD&&!n.arraysFlag&&(r=null!==(i=Kk(r,n))&&void 0!==i?i:new pk(XU.VALUE,BH.ScalarExpected)),r instanceof pk)return r;if(t instanceof zD||r instanceof zD){if(!(t instanceof zD)){if(r.isAdHoc()){const n=r.data;for(let r=0;r<n.length;r++)for(let o=0;o<n[0].length;o++)n[r][o]=e(t,n[r][o]);return zD.onlyValues(n)}t=zD.fromScalar(t)}if(!(r instanceof zD)){if(t.isAdHoc()){const n=t.data;for(let t=0;t<n.length;t++)for(let o=0;o<n[0].length;o++)n[t][o]=e(n[t][o],r);return zD.onlyValues(n)}r=zD.fromScalar(r)}if(t.width()===r.width()&&t.height()===r.height()){if(t.isAdHoc()){const n=t.data,o=r.data;for(let t=0;t<n.length;t++)for(let r=0;r<n[0].length;r++)n[t][r]=e(n[t][r],o[t][r]);return zD.onlyValues(n)}if(r.isAdHoc()){const n=t.data,o=r.data;for(let t=0;t<n.length;t++)for(let r=0;r<n[0].length;r++)o[t][r]=e(n[t][r],o[t][r]);return zD.onlyValues(o)}}const n=Math.max(t.width(),r.width()),o=Math.max(t.height(),r.height()),i=Array(o);for(let e=0;e<o;e++)i[e]=Array(n);for(let s=0;s<o;s++){const o=1!==t.height()?s:0,a=1!==r.height()?s:0;for(let l=0;l<n;l++){const n=1!==t.width()?l:0,u=1!==r.width()?l:0;o<t.height()&&a<r.height()&&n<t.width()&&u<r.width()?i[s][l]=e(t.data[o][n],r.data[a][u]):i[s][l]=new pk(XU.NA)}}return zD.onlyValues(i)}return e(t,r)}}function fG(e,t){return t instanceof pk?t:e(t)}function yG(e,t,r){return t instanceof pk?t:r instanceof pk?r:e(t,r)}class wG{constructor(e){this.sheet=e,this.transformations=[]}add(e){this.transformations.push(e)}performEagerTransformations(e,t){this.transformations.forEach((r=>r.performEagerTransformations(e,t)))}transformSingleAst(e,t){let[r,n]=[e,t];return this.transformations.forEach((e=>{[r,n]=e.transformSingleAst(r,n)})),[r,n]}isIrreversible(){return!0}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class EG{constructor(e){this.stats=e,this.transformations=[]}version(){return this.transformations.length}addTransformation(e){return void 0!==this.combinedTransformer?this.combinedTransformer.add(e):this.transformations.push(e),this.version()}beginCombinedMode(e){this.combinedTransformer=new wG(e)}commitCombinedMode(){if(void 0===this.combinedTransformer)throw Error("Combined mode wasn't started");return this.transformations.push(this.combinedTransformer),this.combinedTransformer=void 0,this.version()}applyTransformations(e,t,r){this.stats.start(GD.TRANSFORM_ASTS_POSTPONED);for(let o=r;o<this.transformations.length;o++){const r=this.transformations[o];r.isIrreversible()&&(this.undoRedo.storeDataForVersion(o,t,this.parser.computeHashFromAst(e)),this.parser.rememberNewAst(e));const[n,i]=r.transformSingleAst(e,t);e=n,t=i}const n=this.parser.rememberNewAst(e);return this.stats.end(GD.TRANSFORM_ASTS_POSTPONED),[n,t,this.transformations.length]}*getTransformationsFrom(e,t){for(let r=e;r<this.transformations.length;r++){const e=this.transformations[r];t&&!t(e)||(yield e)}}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */const vG=-1;function RG(e,t,{searchCoordinate:r,orderingDirection:n,ifNoMatch:o},i){const s=t.start[r],a="col"===r?t.effectiveEndColumn(i):t.effectiveEndRow(i),l="col"===r?e=>LD(i.getCellValue(wk(t.sheet,e,t.start.row))):e=>LD(i.getCellValue(wk(t.sheet,t.start.col,e))),u="asc"===n?(e,t)=>SG(e,t):(e,t)=>-SG(e,t),h=function(e,t,r){let n=t,o=r;for(;n<o;){const t=Math.ceil((n+o)/2);e(t)?n=t:o=t-1}if(n===o&&e(n))return n;return vG}((t=>u(e,l(t))>=0),s,a),c=l(h);if(c===e)return h-s;if("returnLowerBound"===o){if(h===vG)return"asc"===n?vG:0;if(typeof c!=typeof e)return vG;if("asc"===n)return h-s;const t=h+1;return t<=a?t-s:vG}if("returnUpperBound"===o){if(h===vG)return"asc"===n?0:vG;if(typeof c!=typeof e)return vG;if("desc"===n)return h-s;const t=h+1;return t<=a?t-s:vG}return vG}function SG(e,t){return typeof e==typeof t?e===xD?0:e<t?-1:e>t?1:0:e===xD?-1:t===xD?1:t instanceof pk||"number"==typeof e&&"string"==typeof t||"number"==typeof e&&"boolean"==typeof t?-1:"string"==typeof e&&"number"==typeof t?1:"string"==typeof e&&"boolean"==typeof t?-1:1}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class TG{constructor(e){this.dependencyGraph=e}advancedFind(e,t,{returnOccurrence:r}={returnOccurrence:"first"}){const n=t.range,o=void 0===n?t.valuesFromTopLeftCorner():this.dependencyGraph.computeListOfValuesInRange(n),i="first"===r?e=>e<o.length:e=>e>=0,s="first"===r?e=>e+1:e=>e-1;for(let a="first"===r?0:o.length-1;i(a);a=s(a))if(e(LD(o[a])))return a;return-1}basicFind(e,t,r,{ordering:n,ifNoMatch:o,returnOccurrence:i}){const s="string"==typeof e?Xk(e):e,a=t.range;return void 0===a?this.findNormalizedValue(s,t.valuesFromTopLeftCorner(),o,i):"none"===n?this.findNormalizedValue(s,this.dependencyGraph.computeListOfValuesInRange(a),o,i):RG(s,a,{searchCoordinate:r,orderingDirection:n,ifNoMatch:o},this.dependencyGraph)}findNormalizedValue(e,t,r="returnNotFound",n="first"){const o=t.map(LD).map((e=>"string"==typeof e?Xk(e):e));if("returnNotFound"===r)return"first"===n?o.indexOf(e):o.lastIndexOf(e);const i="returnLowerBound"===r?(e,t)=>SG(e,t):(e,t)=>-SG(e,t);let s="returnLowerBound"===r?-1/0:1/0,a=-1;const l="first"===n?e=>e<o.length:e=>e>=0,u="first"===n?e=>e+1:e=>e-1;for(let h="first"===n?0:o.length-1;l(h);h=u(h)){const t=o[h];if(t===e)return h;i(t,e)>0||i(s,t)<0&&(s=t,a=h)}return a}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class CG extends TG{constructor(e){super(e),this.dependencyGraph=e}add(e,t){}remove(e,t){}change(e,t,r){}applyChanges(e){}addColumns(e){}removeColumns(e){}removeSheet(e){}moveValues(e,t,r,n){}removeValues(e){}find(e,t,r){return this.basicFind(e,t,"row",r)}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class bG{constructor(e,t,r){this.dependencyGraph=e,this.config=t,this.stats=r,this.index=new Map,this.transformingService=this.dependencyGraph.lazilyTransformingAstService,this.binarySearchStrategy=new CG(e)}add(e,t){if(!(e===xD||e instanceof pk))if(e instanceof zD)for(const[r,n]of e.entriesFromTopLeftCorner(t))this.addSingleCellValue(LD(r),n);else this.addSingleCellValue(e,t)}remove(e,t){if(void 0!==e)if(e instanceof zD)for(const[r,n]of e.entriesFromTopLeftCorner(t))this.removeSingleValue(LD(r),n);else this.removeSingleValue(e,t)}change(e,t,r){e!==t&&(this.remove(e,r),this.add(t,r))}applyChanges(e){for(const t of e)void 0!==t.oldValue&&this.change(LD(t.oldValue),LD(t.value),t.address)}moveValues(e,t,r,n){for(const[o,i]of e){const e=vk(i,n,t,r);this.remove(o,i),this.add(o,e)}}removeValues(e){for(const[t,r]of e)this.remove(t,r)}find(e,t,{ordering:r,ifNoMatch:n,returnOccurrence:o}){null==o&&(o="none"===r?"first":"last");const i=this.findUsingColumnIndex(e,t,o);return void 0!==i?i:this.binarySearchStrategy.find(e,t,{ordering:r,ifNoMatch:n,returnOccurrence:o})}findUsingColumnIndex(e,t,r){const n=t.range;if(void 0===n)return;this.ensureRecentData(n.sheet,n.start.col,e);const o=this.getColumnMap(n.sheet,n.start.col);if(!o)return-1;const i="string"==typeof e?Xk(e):e,s=o.get(i);if(!s||!s.index||0===s.index.length)return;const a=bG.findRowBelongingToRange(s,n,r);return void 0!==a?a-n.start.row:void 0}static findRowBelongingToRange(e,t,r){const n=t.start.row,o=t.end.row,i="first"===r?NG(n,e.index,"upperBound"):NG(o,e.index,"lowerBound");if(-1===i)return;const s=e.index[i];return s>=n&&s<=o?s:void 0}advancedFind(e,t,r={returnOccurrence:"first"}){return this.binarySearchStrategy.advancedFind(e,t,r)}addColumns(e){const t=this.index.get(e.sheet);t&&t.splice(e.columnStart,0,...Array(e.numberOfColumns))}removeColumns(e){const t=this.index.get(e.sheet);t&&t.splice(e.columnStart,e.numberOfColumns)}removeSheet(e){this.index.delete(e)}getColumnMap(e,t){this.index.has(e)||this.index.set(e,[]);const r=this.index.get(e);let n=r[t];return n||(n=new Map,r[t]=n),n}getValueIndex(e,t,r){const n=this.getColumnMap(e,t);let o=this.getColumnMap(e,t).get(r);return o||(o={version:this.transformingService.version(),index:[]},n.set(r,o)),o}ensureRecentData(e,t,r){const n=this.getValueIndex(e,t,r),o=this.transformingService.version();if(n.version===o)return;const i=this.transformingService.getTransformationsFrom(n.version,(t=>t.sheet===e&&(t instanceof dW||t instanceof yW)));for(const s of i)s instanceof dW?this.addRows(t,s.rowsSpan,r):s instanceof yW&&this.removeRows(t,s.rowsSpan,r);n.version=o}addSingleCellValue(e,t){this.stats.measure(GD.BUILD_COLUMN_INDEX,(()=>{this.ensureRecentData(t.sheet,t.col,e),"string"==typeof e&&(e=Xk(e));const r=this.getValueIndex(t.sheet,t.col,e);bG.addValue(r,t.row)}))}removeSingleValue(e,t){this.stats.measure(GD.BUILD_COLUMN_INDEX,(()=>{this.ensureRecentData(t.sheet,t.col,e);const r=this.getColumnMap(t.sheet,t.col);"string"==typeof e&&(e=Xk(e));const n=r.get(e);if(!n)return;const o=NG(t.row,n.index);o>-1&&n.index.splice(o,1),0===n.index.length&&r.delete(e),0===r.size&&delete this.index.get(t.sheet)[t.col]}))}addRows(e,t,r){const n=this.getValueIndex(t.sheet,e,r);bG.shiftRows(n,t.rowStart,t.numberOfRows)}removeRows(e,t,r){const n=this.getValueIndex(t.sheet,e,r);bG.removeRowsFromValues(n,t),bG.shiftRows(n,t.rowEnd+1,-t.numberOfRows)}static addValue(e,t){const r=NG(t,e.index,"lowerBound");e.index[r]===t||e.index.splice(r+1,0,t)}static removeRowsFromValues(e,t){const r=NG(t.rowStart,e.index,"upperBound"),n=NG(t.rowEnd,e.index,"lowerBound");r>-1&&n>-1&&r<=n&&e.index[r]<=t.rowEnd&&e.index.splice(r,n-r+1)}static shiftRows(e,t,r){const n=NG(t,e.index,"upperBound");if(-1!==n)for(let o=n;o<e.index.length;++o)e.index[o]+=r}}function NG(e,t,r="upperBound"){let n=0,o=t.length-1;for(;n<=o;){const r=Math.floor((n+o)/2);if(e>t[r])n=r+1;else{if(!(e<t[r]))return r;o=r-1}}const i="lowerBound"===r?o:n;return i>=0&&i<=t.length?i:-1}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
class AG{constructor(e){this.config=e;const t="."===this.config.thousandSeparator?`\\${this.config.thousandSeparator}`:this.config.thousandSeparator,r="."===this.config.decimalSeparator?`\\${this.config.decimalSeparator}`:this.config.decimalSeparator;this.numberPattern=new RegExp(`^([+-]?((${r}\\d+)|(\\d+(${t}\\d{3,})*(${r}\\d*)?)))(e[+-]?\\d+)?$`),this.allThousandSeparatorsRegex=new RegExp(`${t}`,"g")}numericStringToMaybeNumber(e){if(this.numberPattern.test(e)){const t=this.numericStringToNumber(e);if(isNaN(t))return;return t}}numericStringToNumber(e){const t=e.replace(this.allThousandSeparatorsRegex,"").replace(this.config.decimalSeparator,".");return Number(t)}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class IG{constructor(e,t,r){this.dependencyGraph=e,this.unparser=t,this.exporter=r}getCellHyperlink(e){const t=this.dependencyGraph.getCell(e);if(t instanceof VU){const e=t.getFormula(this.dependencyGraph.lazilyTransformingAstService);if("HYPERLINK"===e.procedureName)return e.hyperlink}}getCellFormula(e,t){const r=this.dependencyGraph.getCell(e);if(r instanceof VU){const n=r.getFormula(this.dependencyGraph.lazilyTransformingAstService);return t=null!=t?t:e,this.unparser.unparse(n,t)}if(r instanceof PU){const n=r.getAddress(this.dependencyGraph.lazilyTransformingAstService);if(n.row!==e.row||n.col!==e.col||n.sheet!==e.sheet)return;t=null!=t?t:e;const o=r.getFormula(this.dependencyGraph.lazilyTransformingAstService);if(void 0!==o)return this.unparser.unparse(o,t)}else if(r instanceof rk)return r.getFormula()}getCellSerialized(e,t){var r;return null!==(r=this.getCellFormula(e,t))&&void 0!==r?r:this.getRawValue(e)}getCellValue(e){return this.exporter.exportValue(this.dependencyGraph.getScalarValue(e))}getRawValue(e){return this.dependencyGraph.getRawValue(e)}getSheetValues(e){return this.genericSheetGetter(e,(e=>this.getCellValue(e)))}getSheetFormulas(e){return this.genericSheetGetter(e,(e=>this.getCellFormula(e)))}genericSheetGetter(e,t){const r=this.dependencyGraph.getSheetHeight(e),n=this.dependencyGraph.getSheetWidth(e),o=new Array(r);for(let i=0;i<r;i++){o[i]=new Array(n);for(let r=0;r<n;r++){const n=wk(e,r,i);o[i][r]=t(n)}for(let e=n-1;e>=0&&(null===o[i][e]||void 0===o[i][e]);e--)o[i].pop()}for(let i=r-1;i>=0&&0===o[i].length;i--)o.pop();return o}genericAllSheetsGetter(e){const t={};for(const r of this.dependencyGraph.sheetMapping.displayNames()){const n=this.dependencyGraph.sheetMapping.fetch(r);t[r]=e(n)}return t}getSheetSerialized(e){return this.genericSheetGetter(e,(e=>this.getCellSerialized(e)))}getAllSheetsValues(){return this.genericAllSheetsGetter((e=>this.getSheetValues(e)))}getAllSheetsFormulas(){return this.genericAllSheetsGetter((e=>this.getSheetFormulas(e)))}getAllSheetsSerialized(){return this.genericAllSheetsGetter((e=>this.getSheetSerialized(e)))}getAllNamedExpressionsSerialized(){const e=[];let t=0;for(const r of this.dependencyGraph.sheetMapping.displayNames()){const n=this.dependencyGraph.sheetMapping.fetch(r);e[n]=t,t++}return this.dependencyGraph.namedExpressions.getAllNamedExpressions().map((t=>({name:t.expression.displayName,expression:this.getCellSerialized(t.expression.address),scope:void 0!==t.scope?e[t.scope]:void 0,options:t.expression.options})))}withNewConfig(e,t){const r=new RD(e,wD(e),this.dependencyGraph.sheetMapping.fetchDisplayName,t);return new IG(this.dependencyGraph,r,this.exporter)}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class OG{static buildFromSheets(e,t={},r=[]){const n=new DG(t);return this.buildEngine(n,e,r)}static buildFromSheet(e,t={},r=[]){const n=new DG(t),o=n.translationPackage.getUITranslation(YU.NEW_SHEET_PREFIX)+"1";return this.buildEngine(n,{[o]:e},r)}static buildEmpty(e={},t=[]){return this.buildEngine(new DG(e),{},t)}static rebuildWithConfig(e,t,r,n){return this.buildEngine(e,t,r,n)}static buildEngine(e,t={},r=[],n=(e.useStats?new KD:new qD)){n.start(GD.BUILD_ENGINE_TOTAL);const o=new lW,i=new uG(e),s=new EG(n),a=JU.buildEmpty(s,e,i,o,n),l=function(e,t,r){return t.useColumnIndex?new bG(e,t,r):new CG(e)}(a,e,n),u=a.sheetMapping,h=a.addressMapping;for(const N in t)if(Object.prototype.hasOwnProperty.call(t,N)){const r=t[N];EW(r);const n=vW(r);if(n.height>e.maxRows||n.width>e.maxColumns)throw new eU;const o=u.addSheet(N);h.autoAddSheet(o,n)}const c=new TD(e,i,u.get);s.parser=c;const d=new RD(e,wD(e),u.fetchDisplayName,o),p=new bB(e),m=new AG(e),g=new xk(e,p,m),f=new rW(e,p,m),y=new eB(e,i),w=new bW(e,a,l,f,c,n,s,o,y),E=new qW(e,w);s.undoRedo=E;const v=new oW(e,a,w),R=new QW(e,w,E,v,a,l,c,f,s,o);r.forEach((e=>{R.ensureItIsPossibleToAddNamedExpression(e.name,e.expression,e.scope),R.operations.addNamedExpression(e.name,e.expression,e.scope,e.options)}));const S=new nG(e,o,u.fetchDisplayName,s),T=new IG(a,d,S),C=new gG(e,a,l,n,g,i,o,T,y,p);n.measure(GD.GRAPH_BUILD,(()=>{new oG(a,l,c,f,n,y).buildGraph(t,n)}));const b=new eG(e,n,C,s,a,l);return b.run(),n.end(GD.BUILD_ENGINE_TOTAL),{config:e,stats:n,dependencyGraph:a,columnSearch:l,parser:c,unparser:d,cellContentParser:f,evaluator:b,lazilyTransformingAstService:s,crudOperations:R,exporter:S,namedExpressions:o,serialization:T,functionRegistry:i}}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */function MG(e){return()=>{throw new Error(`The "${e}" method cannot be called because this HyperFormula instance has been destroyed`)}}var _G={exports:{}};function xG(){}xG.prototype={on:function(e,t,r){var n=this.e||(this.e={});return(n[e]||(n[e]=[])).push({fn:t,ctx:r}),this},once:function(e,t,r){var n=this;function o(){n.off(e,o),t.apply(r,arguments)}return o._=t,this.on(e,o,r)},emit:function(e){for(var t=[].slice.call(arguments,1),r=((this.e||(this.e={}))[e]||[]).slice(),n=0,o=r.length;n<o;n++)r[n].fn.apply(r[n].ctx,t);return this},off:function(e,t){var r=this.e||(this.e={}),n=r[e],o=[];if(n&&t)for(var i=0,s=n.length;i<s;i++)n[i].fn!==t&&n[i].fn._!==t&&o.push(n[i]);return o.length?r[e]=o:delete r[e],this}},_G.exports=xG;var LG,FG=_G.exports.TinyEmitter=xG;
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */!function(e){e.SheetAdded="sheetAdded",e.SheetRemoved="sheetRemoved",e.SheetRenamed="sheetRenamed",e.NamedExpressionAdded="namedExpressionAdded",e.NamedExpressionRemoved="namedExpressionRemoved",e.ValuesUpdated="valuesUpdated",e.EvaluationSuspended="evaluationSuspended",e.EvaluationResumed="evaluationResumed"}(LG||(LG={}));class PG extends FG{emit(e,...t){return super.emit(e,...t),this}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class VG{constructor(e,t,r,n,o,i,s,a,l,u,h,c,d,p){this._config=e,this._stats=t,this._dependencyGraph=r,this._columnSearch=n,this._parser=o,this._unparser=i,this._cellContentParser=s,this._evaluator=a,this._lazilyTransformingAstService=l,this._crudOperations=u,this._exporter=h,this._namedExpressions=c,this._serialization=d,this._functionRegistry=p,this._emitter=new PG,this._evaluationSuspended=!1}static get defaultConfig(){return UG({})}get graph(){return this.dependencyGraph.graph}get rangeMapping(){return this.dependencyGraph.rangeMapping}get arrayMapping(){return this.dependencyGraph.arrayMapping}get sheetMapping(){return this.dependencyGraph.sheetMapping}get addressMapping(){return this.dependencyGraph.addressMapping}get dependencyGraph(){return this._dependencyGraph}get evaluator(){return this._evaluator}get columnSearch(){return this._columnSearch}get lazilyTransformingAstService(){return this._lazilyTransformingAstService}get licenseKeyValidityState(){return this._config.licenseKeyValidityState}static buildFromArray(e,t={},r=[]){return this.buildFromEngineState(OG.buildFromSheet(e,t,r))}static buildFromSheets(e,t={},r=[]){return this.buildFromEngineState(OG.buildFromSheets(e,t,r))}static buildEmpty(e={},t=[]){return this.buildFromEngineState(OG.buildEmpty(e,t))}static getLanguage(e){sB(e,"string","languageCode");const t=this.registeredLanguages.get(e);if(void 0===t)throw new RU;return t}static registerLanguage(e,t){if(sB(e,"string","languageCode"),this.registeredLanguages.has(e))throw new SU;var r;this.registeredLanguages.set(e,(r=t,new $U(Object.assign({},r.functions),Object.assign({},r.errors),Object.assign({},r.ui))))}static unregisterLanguage(e){if(sB(e,"string","languageCode"),!this.registeredLanguages.has(e))throw new RU;this.registeredLanguages.delete(e)}static getRegisteredLanguagesCodes(){return Array.from(this.registeredLanguages.keys())}static registerFunctionPlugin(e,t){uG.registerFunctionPlugin(e,t)}static unregisterFunctionPlugin(e){uG.unregisterFunctionPlugin(e)}static registerFunction(e,t,r){sB(e,"string","functionId"),uG.registerFunction(e,t,r)}static unregisterFunction(e){sB(e,"string","functionId"),uG.unregisterFunction(e)}static unregisterAllFunctions(){uG.unregisterAll()}static getRegisteredFunctionNames(e){sB(e,"string","code");const t=uG.getRegisteredFunctionIds();return this.getLanguage(e).getFunctionTranslations(t)}static getFunctionPlugin(e){return sB(e,"string","functionId"),uG.getFunctionPlugin(e)}static getAllFunctionPlugins(){return uG.getPlugins()}static buildFromEngineState(e){return new VG(e.config,e.stats,e.dependencyGraph,e.columnSearch,e.parser,e.unparser,e.cellContentParser,e.evaluator,e.lazilyTransformingAstService,e.crudOperations,e.exporter,e.namedExpressions,e.serialization,e.functionRegistry)}getCellValue(e){if(!Sk(e))throw new pU("SimpleCellAddress","cellAddress");return this.ensureEvaluationIsNotSuspended(),this._serialization.getCellValue(e)}getCellFormula(e){if(!Sk(e))throw new pU("SimpleCellAddress","cellAddress");return this._serialization.getCellFormula(e)}getCellHyperlink(e){if(!Sk(e))throw new pU("SimpleCellAddress","cellAddress");return this.ensureEvaluationIsNotSuspended(),this._serialization.getCellHyperlink(e)}getCellSerialized(e){if(!Sk(e))throw new pU("SimpleCellAddress","cellAddress");return this.ensureEvaluationIsNotSuspended(),this._serialization.getCellSerialized(e)}getSheetValues(e){return sB(e,"number","sheetId"),this.ensureEvaluationIsNotSuspended(),this._serialization.getSheetValues(e)}getSheetFormulas(e){return sB(e,"number","sheetId"),this._serialization.getSheetFormulas(e)}getSheetSerialized(e){return sB(e,"number","sheetId"),this.ensureEvaluationIsNotSuspended(),this._serialization.getSheetSerialized(e)}getAllSheetsDimensions(){return this._serialization.genericAllSheetsGetter((e=>this.getSheetDimensions(e)))}getSheetDimensions(e){return sB(e,"number","sheetId"),{width:this.dependencyGraph.getSheetWidth(e),height:this.dependencyGraph.getSheetHeight(e)}}getAllSheetsValues(){return this.ensureEvaluationIsNotSuspended(),this._serialization.getAllSheetsValues()}getAllSheetsFormulas(){return this._serialization.getAllSheetsFormulas()}getAllSheetsSerialized(){return this.ensureEvaluationIsNotSuspended(),this._serialization.getAllSheetsSerialized()}updateConfig(e){Object.entries(e).every((([e,t])=>this._config[e]===t))||this.rebuildWithConfig(e)}getConfig(){return this._config.getConfig()}rebuildAndRecalculate(){this.rebuildWithConfig({})}getStats(){return this._stats.snapshot()}undo(){return this._crudOperations.undo(),this.recomputeIfDependencyGraphNeedsIt()}redo(){return this._crudOperations.redo(),this.recomputeIfDependencyGraphNeedsIt()}isThereSomethingToUndo(){return this._crudOperations.isThereSomethingToUndo()}isThereSomethingToRedo(){return this._crudOperations.isThereSomethingToRedo()}isItPossibleToSetCellContents(e){let t;if(Sk(e))t=new Ak(e,e);else{if(!bk(e))throw new pU("SimpleCellAddress | SimpleCellRange","address");t=new Ak(e.start,e.end)}try{this._crudOperations.ensureRangeInSizeLimits(t);for(const e of t.addresses(this._dependencyGraph))this._crudOperations.ensureItIsPossibleToChangeContent(e)}catch(r){return!1}return!0}setCellContents(e,t){return this._crudOperations.setCellContents(e,t),this.recomputeIfDependencyGraphNeedsIt()}swapRowIndexes(e,t){return sB(e,"number","sheetId"),this._crudOperations.setRowOrder(e,t),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToSwapRowIndexes(e,t){sB(e,"number","sheetId");try{return this._crudOperations.validateSwapRowIndexes(e,t),this._crudOperations.testRowOrderForArrays(e,t),!0}catch(r){return!1}}setRowOrder(e,t){sB(e,"number","sheetId");const r=this._crudOperations.mappingFromOrder(e,t,"row");return this.swapRowIndexes(e,r)}isItPossibleToSetRowOrder(e,t){sB(e,"number","sheetId");try{const r=this._crudOperations.mappingFromOrder(e,t,"row");return this._crudOperations.validateSwapRowIndexes(e,r),this._crudOperations.testRowOrderForArrays(e,r),!0}catch(r){return!1}}swapColumnIndexes(e,t){return sB(e,"number","sheetId"),this._crudOperations.setColumnOrder(e,t),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToSwapColumnIndexes(e,t){sB(e,"number","sheetId");try{return this._crudOperations.validateSwapColumnIndexes(e,t),this._crudOperations.testColumnOrderForArrays(e,t),!0}catch(r){return!1}}setColumnOrder(e,t){sB(e,"number","sheetId");const r=this._crudOperations.mappingFromOrder(e,t,"column");return this.swapColumnIndexes(e,r)}isItPossibleToSetColumnOrder(e,t){sB(e,"number","sheetId");try{const r=this._crudOperations.mappingFromOrder(e,t,"column");return this._crudOperations.validateSwapColumnIndexes(e,r),this._crudOperations.testColumnOrderForArrays(e,r),!0}catch(r){return!1}}isItPossibleToAddRows(e,...t){sB(e,"number","sheetId");const r=AW(t);try{return this._crudOperations.ensureItIsPossibleToAddRows(e,...r),!0}catch(n){return!1}}addRows(e,...t){return sB(e,"number","sheetId"),this._crudOperations.addRows(e,...t),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToRemoveRows(e,...t){sB(e,"number","sheetId");const r=NW(t);try{return this._crudOperations.ensureItIsPossibleToRemoveRows(e,...r),!0}catch(n){return!1}}removeRows(e,...t){return sB(e,"number","sheetId"),this._crudOperations.removeRows(e,...t),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToAddColumns(e,...t){sB(e,"number","sheetId");const r=AW(t);try{return this._crudOperations.ensureItIsPossibleToAddColumns(e,...r),!0}catch(n){return!1}}addColumns(e,...t){return sB(e,"number","sheetId"),this._crudOperations.addColumns(e,...t),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToRemoveColumns(e,...t){sB(e,"number","sheetId");const r=NW(t);try{return this._crudOperations.ensureItIsPossibleToRemoveColumns(e,...r),!0}catch(n){return!1}}removeColumns(e,...t){return sB(e,"number","sheetId"),this._crudOperations.removeColumns(e,...t),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToMoveCells(e,t){if(!Sk(t))throw new pU("SimpleCellAddress","destinationLeftCorner");if(!bk(e))throw new pU("SimpleCellRange","source");try{const r=new Ak(e.start,e.end);return this._crudOperations.operations.ensureItIsPossibleToMoveCells(r.start,r.width(),r.height(),t),!0}catch(r){return!1}}moveCells(e,t){if(!Sk(t))throw new pU("SimpleCellAddress","destinationLeftCorner");if(!bk(e))throw new pU("SimpleCellRange","source");const r=new Ak(e.start,e.end);return this._crudOperations.moveCells(r.start,r.width(),r.height(),t),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToMoveRows(e,t,r,n){sB(e,"number","sheetId"),sB(t,"number","startRow"),sB(r,"number","numberOfRows"),sB(n,"number","targetRow");try{return this._crudOperations.ensureItIsPossibleToMoveRows(e,t,r,n),!0}catch(o){return!1}}moveRows(e,t,r,n){return sB(e,"number","sheetId"),sB(t,"number","startRow"),sB(r,"number","numberOfRows"),sB(n,"number","targetRow"),this._crudOperations.moveRows(e,t,r,n),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToMoveColumns(e,t,r,n){sB(e,"number","sheetId"),sB(t,"number","startColumn"),sB(r,"number","numberOfColumns"),sB(n,"number","targetColumn");try{return this._crudOperations.ensureItIsPossibleToMoveColumns(e,t,r,n),!0}catch(o){return!1}}moveColumns(e,t,r,n){return sB(e,"number","sheetId"),sB(t,"number","startColumn"),sB(r,"number","numberOfColumns"),sB(n,"number","targetColumn"),this._crudOperations.moveColumns(e,t,r,n),this.recomputeIfDependencyGraphNeedsIt()}copy(e){if(!bk(e))throw new pU("SimpleCellRange","source");const t=new Ak(e.start,e.end);return this._crudOperations.copy(t.start,t.width(),t.height()),this.getRangeValues(e)}cut(e){if(!bk(e))throw new pU("SimpleCellRange","source");const t=new Ak(e.start,e.end);return this._crudOperations.cut(t.start,t.width(),t.height()),this.getRangeValues(e)}paste(e){if(!Sk(e))throw new pU("SimpleCellAddress","targetLeftCorner");return this.ensureEvaluationIsNotSuspended(),this._crudOperations.paste(e),this.recomputeIfDependencyGraphNeedsIt()}isClipboardEmpty(){return this._crudOperations.isClipboardEmpty()}clearClipboard(){this._crudOperations.clearClipboard()}clearRedoStack(){this._crudOperations.undoRedo.clearRedoStack()}clearUndoStack(){this._crudOperations.undoRedo.clearUndoStack()}getRangeValues(e){if(!bk(e))throw new pU("SimpleCellRange","source");return new Ak(e.start,e.end).arrayOfAddressesInRange().map((e=>e.map((e=>this.getCellValue(e)))))}getRangeFormulas(e){if(!bk(e))throw new pU("SimpleCellRange","source");return new Ak(e.start,e.end).arrayOfAddressesInRange().map((e=>e.map((e=>this.getCellFormula(e)))))}getRangeSerialized(e){if(!bk(e))throw new pU("SimpleCellRange","source");return new Ak(e.start,e.end).arrayOfAddressesInRange().map((e=>e.map((e=>this.getCellSerialized(e)))))}getFillRangeData(e,t,r=!1){if(!bk(e))throw new pU("SimpleCellRange","source");if(!bk(t))throw new pU("SimpleCellRange","target");const n=new Ak(e.start,e.end),o=new Ak(t.start,t.end);return this.ensureEvaluationIsNotSuspended(),o.arrayOfAddressesInRange().map((o=>o.map((o=>{const i=((o.row-(r?t:e).start.row)%n.height()+n.height())%n.height()+e.start.row,s=((o.col-(r?t:e).start.col)%n.width()+n.width())%n.width()+e.start.col;return this._serialization.getCellSerialized({row:i,col:s,sheet:n.sheet},o)}))))}isItPossibleToAddSheet(e){sB(e,"string","sheetName");try{return this._crudOperations.ensureItIsPossibleToAddSheet(e),!0}catch(t){return!1}}addSheet(e){void 0!==e&&sB(e,"string","sheetName");const t=this._crudOperations.addSheet(e);return this._emitter.emit(LG.SheetAdded,t),t}isItPossibleToRemoveSheet(e){sB(e,"number","sheetId");try{return this._crudOperations.ensureScopeIdIsValid(e),!0}catch(t){return!1}}removeSheet(e){sB(e,"number","sheetId");const t=this.sheetMapping.getDisplayName(e);this._crudOperations.removeSheet(e);const r=this.recomputeIfDependencyGraphNeedsIt();return this._emitter.emit(LG.SheetRemoved,t,r),r}isItPossibleToClearSheet(e){sB(e,"number","sheetId");try{return this._crudOperations.ensureScopeIdIsValid(e),!0}catch(t){return!1}}clearSheet(e){return sB(e,"number","sheetId"),this._crudOperations.clearSheet(e),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToReplaceSheetContent(e,t){sB(e,"number","sheetId");try{return this._crudOperations.ensureScopeIdIsValid(e),this._crudOperations.ensureItIsPossibleToChangeSheetContents(e,t),!0}catch(r){return!1}}setSheetContent(e,t){return sB(e,"number","sheetId"),this._crudOperations.setSheetContent(e,t),this.recomputeIfDependencyGraphNeedsIt()}simpleCellAddressFromString(e,t){return sB(e,"string","cellAddress"),sB(t,"number","sheetId"),tL(this.sheetMapping.get,e,t)}simpleCellRangeFromString(e,t){return sB(e,"string","cellRange"),sB(t,"number","sheetId"),((e,t,r)=>{const n=t.split(Fx);if(2!==n.length)return;const[o,i]=n,s=tL(e,o,r);if(void 0===s)return;const a=tL(e,i,s.sheet);return void 0!==a&&s.sheet===a.sheet?Nk(s,a):void 0})(this.sheetMapping.get,e,t)}simpleCellAddressToString(e,t={}){if(!Sk(e))throw new pU("SimpleCellAddress","cellAddress");const r="number"==typeof t?t:t.includeSheetName?e.sheet+1:e.sheet;return rL(this.sheetMapping.fetchDisplayName,e,r)}simpleCellRangeToString(e,t={}){if(!bk(e))throw new pU("SimpleCellRange","cellRange");const r="number"==typeof t?t:t.includeSheetName?e.start.sheet+e.end.sheet+1:e.start.sheet;return((e,t,r)=>{const n=rL(e,t.start,r),o=rL(e,t.end,t.start.sheet);return void 0===n||void 0===o?void 0:`${n}${Fx}${o}`})(this.sheetMapping.fetchDisplayName,e,r)}getCellDependents(e){let t;if(Sk(e))t=this._dependencyGraph.addressMapping.getCell(e);else{if(!bk(e))throw new pU("SimpleCellAddress | SimpleCellRange",e);t=this._dependencyGraph.rangeMapping.getRange(e.start,e.end)}return void 0===t?[]:this._dependencyGraph.getAdjacentNodesAddresses(t)}getCellPrecedents(e){let t;if(Sk(e))t=this._dependencyGraph.addressMapping.getCell(e);else{if(!bk(e))throw new pU("SimpleCellAddress | SimpleCellRange",e);t=this._dependencyGraph.rangeMapping.getRange(e.start,e.end)}return void 0===t?[]:this._dependencyGraph.dependencyQueryAddresses(t)}getSheetName(e){return sB(e,"number","sheetId"),this.sheetMapping.getDisplayName(e)}getSheetNames(){return this.sheetMapping.sheetNames()}getSheetId(e){return sB(e,"string","sheetName"),this.sheetMapping.get(e)}doesSheetExist(e){return sB(e,"string","sheetName"),this.sheetMapping.hasSheetWithName(e)}getCellType(e){if(!Sk(e))throw new pU("SimpleCellAddress","cellAddress");return((e,t)=>e instanceof PU?e.isLeftCorner(t)?KU.ARRAYFORMULA:KU.ARRAY:e instanceof VU||e instanceof rk?KU.FORMULA:e instanceof tk?KU.VALUE:KU.EMPTY)(this.dependencyGraph.getCell(e),e)}doesCellHaveSimpleValue(e){if(!Sk(e))throw new pU("SimpleCellAddress","cellAddress");return this.getCellType(e)===KU.VALUE}doesCellHaveFormula(e){if(!Sk(e))throw new pU("SimpleCellAddress","cellAddress");const t=this.getCellType(e);return t===KU.FORMULA||t===KU.ARRAYFORMULA}isCellEmpty(e){if(!Sk(e))throw new pU("SimpleCellAddress","cellAddress");return this.getCellType(e)===KU.EMPTY}isCellPartOfArray(e){if(!Sk(e))throw new pU("SimpleCellAddress","cellAddress");const t=this.getCellType(e);return t===KU.ARRAY||t===KU.ARRAYFORMULA}getCellValueType(e){if(!Sk(e))throw new pU("SimpleCellAddress","cellAddress");this.ensureEvaluationIsNotSuspended();const t=this.dependencyGraph.getCellValue(e);return hk(t)}getCellValueDetailedType(e){if(!Sk(e))throw new pU("SimpleCellAddress","cellAddress");this.ensureEvaluationIsNotSuspended();const t=this.dependencyGraph.getCellValue(e);return ck(t)}getCellValueFormat(e){if(!Sk(e))throw new pU("SimpleCellAddress","cellAddress");this.ensureEvaluationIsNotSuspended();const t=this.dependencyGraph.getCellValue(e);return dk(t)}countSheets(){return this.sheetMapping.numberOfSheets()}isItPossibleToRenameSheet(e,t){sB(e,"number","sheetId"),sB(t,"string","newName");try{return this._crudOperations.ensureItIsPossibleToRenameSheet(e,t),!0}catch(r){return!1}}renameSheet(e,t){sB(e,"number","sheetId"),sB(t,"string","newName");const r=this._crudOperations.renameSheet(e,t);void 0!==r&&this._emitter.emit(LG.SheetRenamed,r,t)}batch(e){this.suspendEvaluation(),this._crudOperations.beginUndoRedoBatchMode();try{e()}catch(t){throw this._crudOperations.commitUndoRedoBatchMode(),this.resumeEvaluation(),t}return this._crudOperations.commitUndoRedoBatchMode(),this.resumeEvaluation()}suspendEvaluation(){this._evaluationSuspended=!0,this._emitter.emit(LG.EvaluationSuspended)}resumeEvaluation(){this._evaluationSuspended=!1;const e=this.recomputeIfDependencyGraphNeedsIt();return this._emitter.emit(LG.EvaluationResumed,e),e}isEvaluationSuspended(){return this._evaluationSuspended}isItPossibleToAddNamedExpression(e,t,r){sB(e,"string","expressionName"),void 0!==r&&sB(r,"number","scope");try{return this._crudOperations.ensureItIsPossibleToAddNamedExpression(e,t,r),!0}catch(n){return!1}}addNamedExpression(e,t,r,n){sB(e,"string","expressionName"),void 0!==r&&sB(r,"number","scope"),this._crudOperations.addNamedExpression(e,t,r,n);const o=this.recomputeIfDependencyGraphNeedsIt();return this._emitter.emit(LG.NamedExpressionAdded,e,o),o}getNamedExpressionValue(e,t){sB(e,"string","expressionName"),void 0!==t&&sB(t,"number","scope"),this.ensureEvaluationIsNotSuspended(),this._crudOperations.ensureScopeIdIsValid(t);const r=this._namedExpressions.namedExpressionForScope(e,t);return r?this._serialization.getCellValue(r.address):void 0}getNamedExpressionFormula(e,t){sB(e,"string","expressionName"),void 0!==t&&sB(t,"number","scope"),this._crudOperations.ensureScopeIdIsValid(t);const r=this._namedExpressions.namedExpressionForScope(e,t);return void 0===r?void 0:this._serialization.getCellFormula(r.address)}getNamedExpression(e,t){sB(e,"string","expressionName"),void 0!==t&&sB(t,"number","scope");const r=this._namedExpressions.namedExpressionForScope(e,t);if(void 0===r)return;return{name:e,scope:t,expression:this._serialization.getCellFormula(r.address),options:r.options}}isItPossibleToChangeNamedExpression(e,t,r){sB(e,"string","expressionName"),void 0!==r&&sB(r,"number","scope");try{return this._crudOperations.ensureItIsPossibleToChangeNamedExpression(e,t,r),!0}catch(n){return!1}}changeNamedExpression(e,t,r,n){return sB(e,"string","expressionName"),void 0!==r&&sB(r,"number","scope"),this._crudOperations.changeNamedExpressionExpression(e,r,t,n),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToRemoveNamedExpression(e,t){sB(e,"string","expressionName"),void 0!==t&&sB(t,"number","scope");try{return this._crudOperations.isItPossibleToRemoveNamedExpression(e,t),!0}catch(r){return!1}}removeNamedExpression(e,t){sB(e,"string","expressionName"),void 0!==t&&sB(t,"number","scope");const r=this._crudOperations.removeNamedExpression(e,t);if(r){const e=this.recomputeIfDependencyGraphNeedsIt();return this._emitter.emit(LG.NamedExpressionRemoved,r.displayName,e),e}return[]}listNamedExpressions(e){return void 0!==e&&sB(e,"number","scope"),this._crudOperations.ensureScopeIdIsValid(e),this._namedExpressions.getAllNamedExpressionsNamesInScope(e)}getAllNamedExpressionsSerialized(){return this._serialization.getAllNamedExpressionsSerialized()}normalizeFormula(e){sB(e,"string","formulaString");const{ast:t,address:r}=this.extractTemporaryFormula(e);if(void 0===t)throw new tU;return this._unparser.unparse(t,r)}calculateFormula(e,t){sB(e,"string","formulaString"),sB(t,"number","sheetId"),this._crudOperations.ensureScopeIdIsValid(t);const{ast:r,address:n,dependencies:o}=this.extractTemporaryFormula(e,t);if(void 0===r)throw new tU;const i=this.evaluator.runAndForget(r,n,o);return this._exporter.exportScalarOrRange(i)}getNamedExpressionsFromFormula(e){sB(e,"string","formulaString");const{ast:t,dependencies:r}=this.extractTemporaryFormula(e);if(void 0===t)throw new tU;const n=r.filter((e=>e instanceof MD)).map((e=>e.name));return[...new Set(n)]}validateFormula(e){sB(e,"string","formulaString");const{ast:t}=this.extractTemporaryFormula(e);return void 0!==t}getRegisteredFunctionNames(){return VG.getLanguage(this._config.language).getFunctionTranslations(this._functionRegistry.getRegisteredFunctionIds())}getFunctionPlugin(e){return sB(e,"string","functionId"),this._functionRegistry.getFunctionPlugin(e)}getAllFunctionPlugins(){return this._functionRegistry.getPlugins()}numberToDateTime(e){return sB(e,"number","val"),this._evaluator.interpreter.dateTimeHelper.numberToSimpleDateTime(e)}numberToDate(e){return sB(e,"number","val"),this._evaluator.interpreter.dateTimeHelper.numberToSimpleDate(e)}numberToTime(e){return sB(e,"number","val"),IB(e)}on(e,t){this._emitter.on(e,t)}once(e,t){this._emitter.once(e,t)}off(e,t){this._emitter.off(e,t)}destroy(){!function(e){for(const[t,r]of Object.entries(e))r instanceof Function?e[t]=MG(r):delete e[t]}(this)}ensureEvaluationIsNotSuspended(){if(this._evaluationSuspended)throw new wU}extractTemporaryFormula(e,t=1){const r=this._cellContentParser.parse(e),n={sheet:t,col:0,row:0};if(!(r instanceof JB.Formula))return{address:n,dependencies:[]};const{ast:o,errors:i,dependencies:s}=this._parser.parse(r.formula,n);return i.length>0?{address:n,dependencies:[]}:{ast:o,address:n,dependencies:s}}rebuildWithConfig(e){const t=this._config.mergeConfig(e),r=this._config.mergeConfig({language:e.language}),n=this._serialization.withNewConfig(r,this._namedExpressions).getAllSheetsSerialized(),o=this._serialization.getAllNamedExpressionsSerialized(),i=OG.rebuildWithConfig(t,n,o,this._stats);this._config=i.config,this._stats=i.stats,this._dependencyGraph=i.dependencyGraph,this._columnSearch=i.columnSearch,this._parser=i.parser,this._unparser=i.unparser,this._cellContentParser=i.cellContentParser,this._evaluator=i.evaluator,this._lazilyTransformingAstService=i.lazilyTransformingAstService,this._crudOperations=i.crudOperations,this._exporter=i.exporter,this._namedExpressions=i.namedExpressions,this._serialization=i.serialization,this._functionRegistry=i.functionRegistry}recomputeIfDependencyGraphNeedsIt(){if(this._evaluationSuspended)return[];{const e=this._crudOperations.getAndClearContentChanges(),t=this.dependencyGraph.verticesToRecompute();this.dependencyGraph.clearDirtyVertices(),t.length>0&&e.addAll(this.evaluator.partialRun(t));const r=e.exportChanges(this._exporter);return e.isEmpty()||this._emitter.emit(LG.ValuesUpdated,r),r}}}VG.version="3.0.0",VG.buildDate="14/01/2025 11:44:17",VG.releaseDate="14/01/2025",VG.languages={},VG.registeredLanguages=new Map;
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
const HG=new WeakMap;class DG{constructor(e={},t=!0){const{accentSensitive:r,caseSensitive:n,caseFirst:o,chooseAddressMappingPolicy:i,context:s,currencySymbol:a,dateFormats:l,decimalSeparator:u,evaluateNullToZero:h,functionArgSeparator:c,functionPlugins:d,ignorePunctuation:p,leapYear1900:m,localeLang:g,language:f,ignoreWhiteSpace:y,licenseKey:w,matchWholeCell:E,arrayColumnSeparator:v,arrayRowSeparator:R,maxRows:S,maxColumns:T,nullYear:C,nullDate:b,parseDateTime:N,precisionEpsilon:A,precisionRounding:I,stringifyDateTime:O,stringifyDuration:M,smartRounding:_,timeFormats:x,thousandSeparator:L,useArrayArithmetic:F,useStats:P,undoLimit:V,useColumnIndex:H,useRegularExpressions:D,useWildcards:U}=e;this.useArrayArithmetic=rB(F,"boolean","useArrayArithmetic"),this.accentSensitive=rB(r,"boolean","accentSensitive"),this.caseSensitive=rB(n,"boolean","caseSensitive"),this.caseFirst=rB(o,["upper","lower","false"],"caseFirst"),this.ignorePunctuation=rB(p,"boolean","ignorePunctuation"),this.chooseAddressMappingPolicy=null!=i?i:DG.defaultConfig.chooseAddressMappingPolicy,this.dateFormats=[...oB(l,Array.isArray,"array","dateFormats")],this.timeFormats=[...oB(x,Array.isArray,"array","timeFormats")],this.functionArgSeparator=rB(c,"string","functionArgSeparator"),this.decimalSeparator=rB(u,[".",","],"decimalSeparator"),this.language=rB(f,"string","language"),this.ignoreWhiteSpace=rB(y,["standard","any"],"ignoreWhiteSpace"),this.licenseKey=rB(w,"string","licenseKey"),this.thousandSeparator=rB(L,["",","," ","."],"thousandSeparator"),this.arrayColumnSeparator=rB(v,[",",";"],"arrayColumnSeparator"),this.arrayRowSeparator=rB(R,[";","|"],"arrayRowSeparator"),this.localeLang=rB(g,"string","localeLang"),this.functionPlugins=[...null!=d?d:DG.defaultConfig.functionPlugins],this.smartRounding=rB(_,"boolean","smartRounding"),this.evaluateNullToZero=rB(h,"boolean","evaluateNullToZero"),this.nullYear=rB(C,"number","nullYear"),nB(this.nullYear,"nullYear",0),function(e,t,r){if(e>r)throw new fU(t,r)}(this.nullYear,"nullYear",100),this.precisionRounding=rB(I,"number","precisionRounding"),nB(this.precisionRounding,"precisionRounding",0),this.precisionEpsilon=rB(A,"number","precisionEpsilon"),nB(this.precisionEpsilon,"precisionEpsilon",0),this.useColumnIndex=rB(H,"boolean","useColumnIndex"),this.useStats=rB(P,"boolean","useStats"),this.parseDateTime=rB(N,"function","parseDateTime"),this.stringifyDateTime=rB(O,"function","stringifyDateTime"),this.stringifyDuration=rB(M,"function","stringifyDuration"),this.translationPackage=VG.getLanguage(this.language),this.errorMapping=this.translationPackage.buildErrorMapping(),this.nullDate=oB(b,SB,"IDate","nullDate"),this.leapYear1900=rB(m,"boolean","leapYear1900"),this.undoLimit=rB(V,"number","undoLimit"),this.useRegularExpressions=rB(D,"boolean","useRegularExpressions"),this.useWildcards=rB(U,"boolean","useWildcards"),this.matchWholeCell=rB(E,"boolean","matchWholeCell"),nB(this.undoLimit,"undoLimit",0),this.maxRows=rB(S,"number","maxRows"),nB(this.maxRows,"maxRows",1),this.maxColumns=rB(T,"number","maxColumns"),this.currencySymbol=this.setupCurrencySymbol(a),nB(this.maxColumns,"maxColumns",1),this.context=s,HG.set(this,{licenseKeyValidityState:ZB(this.licenseKey)}),iB({value:this.decimalSeparator,name:"decimalSeparator"},{value:this.functionArgSeparator,name:"functionArgSeparator"},{value:this.thousandSeparator,name:"thousandSeparator"}),iB({value:this.arrayRowSeparator,name:"arrayRowSeparator"},{value:this.arrayColumnSeparator,name:"arrayColumnSeparator"})}setupCurrencySymbol(e){const t=[...oB(e,Array.isArray,"array","currencySymbol")];return t.forEach((e=>{if("string"!=typeof e)throw new pU("string[]","currencySymbol");if(""===e)throw new mU("currencySymbol")})),t}get licenseKeyValidityState(){return HG.get(this).licenseKeyValidityState}getConfig(){return UG(this)}mergeConfig(e){const t=Object.assign({},this.getConfig(),e);return new DG(t,!1)}static warnDeprecatedOptions(e){}static warnDeprecatedIfUsed(e,t,r,n){void 0!==e&&(void 0===n?console.warn(`${t} option is deprecated since ${r}`):console.warn(`${t} option is deprecated since ${r}, please use ${n}`))}}function UG(e){var t;const r={};for(const n in DG.defaultConfig){const o=null!==(t=e[n])&&void 0!==t?t:DG.defaultConfig[n];Array.isArray(o)?r[n]=[...o]:r[n]=o}return r}DG.defaultConfig={accentSensitive:!1,currencySymbol:["$"],caseSensitive:!1,caseFirst:"lower",context:void 0,chooseAddressMappingPolicy:new class{call(){return ok}},dateFormats:["DD/MM/YYYY","DD/MM/YY"],decimalSeparator:".",evaluateNullToZero:!1,functionArgSeparator:",",functionPlugins:[],ignorePunctuation:!1,language:"enGB",ignoreWhiteSpace:"standard",licenseKey:"",leapYear1900:!1,localeLang:"en",matchWholeCell:!0,arrayColumnSeparator:",",arrayRowSeparator:";",maxRows:4e4,maxColumns:18278,nullYear:30,nullDate:{year:1899,month:12,day:30},parseDateTime:function(e,t,r){if(void 0===t&&void 0===r)return;let n=e.replace(uB," ").trim().toLowerCase();if(!function(e){return lB.test(e)}(n))return;let o=n.substring(n.length-2);"am"===o||"pm"===o?n=n.substring(0,n.length-2).trim():(o=n.substring(n.length-1),"a"===o||"p"===o?n=n.substring(0,n.length-1).trim():o=void 0);const i=n.split(hB);i.length>=2&&i[i.length-2].includes(":")&&(i[i.length-2]=i[i.length-2]+"."+i[i.length-1],i.pop());const s=i[i.length-1].split(":");if(void 0!==o&&s.push(o),1===i.length)return mB(s,r);if(1===s.length)return gB(i,t);const a=gB(i.slice(0,i.length-1),t),l=mB(s,r);return void 0===a||void 0===l?void 0:Object.assign(Object.assign({},a),l)},precisionEpsilon:1e-13,precisionRounding:10,smartRounding:!0,stringifyDateTime:function(e,t){const r=HB(t);if(void 0===r)return;const n=r.tokens;let o="",i=!1;const s=n.some((e=>e.type===LB.FORMAT&&("a/p"===e.value||"A/P"===e.value||"am/pm"===e.value||"AM/PM"===e.value)));for(let a=0;a<n.length;a++){const t=n[a];if(t.type!==LB.FREE_TEXT)switch(t.value.toLowerCase()){case"h":case"hh":i=!0,o+=BB(s?(e.hours+11)%12+1:e.hours,t.value.length);break;case"d":case"dd":o+=BB(e.day,t.value.length);break;case"s":case"ss":o+=BB(Math.floor(e.seconds),t.value.length);break;case"m":case"mm":a+1<n.length&&n[a+1].value.startsWith(":")&&(i=!0),o+=BB(i?e.minutes:e.month,t.value.length),i=!0;break;case"yy":o+=BB(e.year%100,t.value.length);break;case"yyyy":o+=e.year;break;case"am/pm":case"a/p":{const[r,n]=t.value.split("/");o+=e.hours<12?r:n;break}default:if(aB.test(t.value)){const r=t.value.length-3;o+=`${e.seconds<10?"0":""}${Math.floor(e.seconds*Math.pow(10,r))/Math.pow(10,r)}`;continue}return}else o+=t.value}return o},stringifyDuration:function(e,t){const r=HB(t);if(void 0===r)return;const n=r.tokens;let o="";for(const i of n)if(i.type!==LB.FREE_TEXT)switch(i.value.toLowerCase()){case"h":case"hh":o+=BB(e.hours,i.value.length),e.hours=0;break;case"[hh]":o+=BB(e.hours,i.value.length-2),e.hours=0;break;case"m":case"mm":o+=BB(e.minutes,i.value.length),e.minutes=0;break;case"[mm]":o+=BB(e.minutes+60*e.hours,i.value.length-2),e.minutes=0,e.hours=0;break;case"s":case"ss":o+=BB(Math.floor(e.seconds),i.value.length);break;default:if(aB.test(i.value)){const t=Math.max(i.value.length-3,0);o+=`${e.seconds<10?"0":""}${Math.floor(e.seconds*Math.pow(10,t))/Math.pow(10,t)}`;continue}return}else o+=i.value;return o},timeFormats:["hh:mm","hh:mm:ss.sss"],thousandSeparator:"",undoLimit:20,useRegularExpressions:!1,useWildcards:!0,useColumnIndex:!1,useStats:!1,useArrayArithmetic:!1};
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
const kG={errors:{CYCLE:"#CYCLE!",DIV_BY_ZERO:"#DIV/0!",ERROR:"#ERROR!",NA:"#N/A",NAME:"#NAME?",NUM:"#NUM!",REF:"#REF!",SPILL:"#SPILL!",VALUE:"#VALUE!"},functions:{FILTER:"FILTER",ADDRESS:"ADDRESS",ARRAY_CONSTRAIN:"ARRAY_CONSTRAIN",ARRAYFORMULA:"ARRAYFORMULA",ABS:"ABS",ACOS:"ACOS",ACOSH:"ACOSH",ACOT:"ACOT",ACOTH:"ACOTH",AND:"AND",ARABIC:"ARABIC",ASIN:"ASIN",ASINH:"ASINH",ATAN2:"ATAN2",ATAN:"ATAN",ATANH:"ATANH",AVERAGE:"AVERAGE",AVERAGEA:"AVERAGEA",AVERAGEIF:"AVERAGEIF",BASE:"BASE",BIN2DEC:"BIN2DEC",BIN2HEX:"BIN2HEX",BIN2OCT:"BIN2OCT",BITAND:"BITAND",BITLSHIFT:"BITLSHIFT",BITOR:"BITOR",BITRSHIFT:"BITRSHIFT",BITXOR:"BITXOR",CEILING:"CEILING",CHAR:"CHAR",CHOOSE:"CHOOSE",CLEAN:"CLEAN",CODE:"CODE",COLUMN:"COLUMN",COLUMNS:"COLUMNS",CONCATENATE:"CONCATENATE",CORREL:"CORREL",COS:"COS",COSH:"COSH",COT:"COT",COTH:"COTH",COUNT:"COUNT",COUNTA:"COUNTA",COUNTBLANK:"COUNTBLANK",COUNTIF:"COUNTIF",COUNTIFS:"COUNTIFS",COUNTUNIQUE:"COUNTUNIQUE",CSC:"CSC",CSCH:"CSCH",CUMIPMT:"CUMIPMT",CUMPRINC:"CUMPRINC",DATE:"DATE",DATEDIF:"DATEDIF",DATEVALUE:"DATEVALUE",DAY:"DAY",DAYS360:"DAYS360",DAYS:"DAYS",DB:"DB",DDB:"DDB",DEC2BIN:"DEC2BIN",DEC2HEX:"DEC2HEX",DEC2OCT:"DEC2OCT",DECIMAL:"DECIMAL",DEGREES:"DEGREES",DELTA:"DELTA",DOLLARDE:"DOLLARDE",DOLLARFR:"DOLLARFR",EDATE:"EDATE",EFFECT:"EFFECT",EOMONTH:"EOMONTH",ERF:"ERF",ERFC:"ERFC",EVEN:"EVEN",EXACT:"EXACT",EXP:"EXP",FALSE:"FALSE",FIND:"FIND",FORMULATEXT:"FORMULATEXT",FV:"FV",FVSCHEDULE:"FVSCHEDULE",HEX2BIN:"HEX2BIN",HEX2DEC:"HEX2DEC",HEX2OCT:"HEX2OCT",HLOOKUP:"HLOOKUP",HOUR:"HOUR",HYPERLINK:"HYPERLINK",IF:"IF",IFERROR:"IFERROR",IFNA:"IFNA",IFS:"IFS",INDEX:"INDEX",INT:"INT",INTERVAL:"INTERVAL",IPMT:"IPMT",ISBINARY:"ISBINARY",ISBLANK:"ISBLANK",ISERR:"ISERR",ISERROR:"ISERROR",ISEVEN:"ISEVEN",ISFORMULA:"ISFORMULA",ISLOGICAL:"ISLOGICAL",ISNA:"ISNA",ISNONTEXT:"ISNONTEXT",ISNUMBER:"ISNUMBER",ISODD:"ISODD",ISOWEEKNUM:"ISOWEEKNUM",ISPMT:"ISPMT",ISREF:"ISREF",ISTEXT:"ISTEXT",LEFT:"LEFT",LEN:"LEN",LN:"LN",LOG10:"LOG10",LOG:"LOG",LOWER:"LOWER",MATCH:"MATCH",MAX:"MAX",MAXA:"MAXA",MAXIFS:"MAXIFS",MAXPOOL:"MAXPOOL",MEDIAN:"MEDIAN",MEDIANPOOL:"MEDIANPOOL",MID:"MID",MIN:"MIN",MINA:"MINA",MINIFS:"MINIFS",MINUTE:"MINUTE",MIRR:"MIRR",MMULT:"MMULT",MOD:"MOD",MONTH:"MONTH",NA:"NA",NETWORKDAYS:"NETWORKDAYS","NETWORKDAYS.INTL":"NETWORKDAYS.INTL",NOMINAL:"NOMINAL",NOT:"NOT",NOW:"NOW",NPER:"NPER",NPV:"NPV",OCT2BIN:"OCT2BIN",OCT2DEC:"OCT2DEC",OCT2HEX:"OCT2HEX",ODD:"ODD",OFFSET:"OFFSET",OR:"OR",PI:"PI",PMT:"PMT",PDURATION:"PDURATION",PRODUCT:"PRODUCT",POWER:"POWER",PPMT:"PPMT",PROPER:"PROPER",PV:"PV",RADIANS:"RADIANS",RAND:"RAND",RATE:"RATE",REPLACE:"REPLACE",REPT:"REPT",RIGHT:"RIGHT",ROMAN:"ROMAN",ROUND:"ROUND",ROUNDDOWN:"ROUNDDOWN",ROUNDUP:"ROUNDUP",ROW:"ROW",ROWS:"ROWS",RRI:"RRI",SEARCH:"SEARCH",SEC:"SEC",SECH:"SECH",SECOND:"SECOND",SHEET:"SHEET",SHEETS:"SHEETS",SIN:"SIN",SINH:"SINH",SLN:"SLN",SPLIT:"SPLIT",SQRT:"SQRT",STDEVA:"STDEVA","STDEV.P":"STDEV.P",STDEVPA:"STDEVPA","STDEV.S":"STDEV.S",SUBSTITUTE:"SUBSTITUTE",SUBTOTAL:"SUBTOTAL",SUM:"SUM",SUMIF:"SUMIF",SUMIFS:"SUMIFS",SUMPRODUCT:"SUMPRODUCT",SUMSQ:"SUMSQ",SWITCH:"SWITCH",SYD:"SYD",T:"T",TAN:"TAN",TANH:"TANH",TBILLEQ:"TBILLEQ",TBILLPRICE:"TBILLPRICE",TBILLYIELD:"TBILLYIELD",TEXT:"TEXT",TIME:"TIME",TIMEVALUE:"TIMEVALUE",TODAY:"TODAY",TRANSPOSE:"TRANSPOSE",TRIM:"TRIM",TRUE:"TRUE",TRUNC:"TRUNC",UNICHAR:"UNICHAR",UNICODE:"UNICODE",UPPER:"UPPER",VARA:"VARA","VAR.P":"VAR.P",VARPA:"VARPA","VAR.S":"VAR.S",VLOOKUP:"VLOOKUP",WEEKDAY:"WEEKDAY",WEEKNUM:"WEEKNUM",WORKDAY:"WORKDAY","WORKDAY.INTL":"WORKDAY.INTL",XNPV:"XNPV",XOR:"XOR",XLOOKUP:"XLOOKUP",YEAR:"YEAR",YEARFRAC:"YEARFRAC","HF.ADD":"HF.ADD","HF.CONCAT":"HF.CONCAT","HF.DIVIDE":"HF.DIVIDE","HF.EQ":"HF.EQ","HF.GT":"HF.GT","HF.GTE":"HF.GTE","HF.LT":"HF.LT","HF.LTE":"HF.LTE","HF.MINUS":"HF.MINUS","HF.MULTIPLY":"HF.MULTIPLY","HF.NE":"HF.NE","HF.POW":"HF.POW","HF.UMINUS":"HF.UMINUS","HF.UNARY_PERCENT":"HF.UNARY_PERCENT","HF.UPLUS":"HF.UPLUS",VARP:"VARP",VAR:"VAR",STDEVP:"STDEVP",STDEV:"STDEV","EXPON.DIST":"EXPON.DIST",FISHER:"FISHER",FISHERINV:"FISHERINV",GAMMA:"GAMMA","GAMMA.DIST":"GAMMA.DIST",GAMMALN:"GAMMALN","GAMMALN.PRECISE":"GAMMALN.PRECISE","GAMMA.INV":"GAMMA.INV",GAUSS:"GAUSS",FACT:"FACT",FACTDOUBLE:"FACTDOUBLE",COMBIN:"COMBIN",COMBINA:"COMBINA",GCD:"GCD",LCM:"LCM",MROUND:"MROUND",MULTINOMIAL:"MULTINOMIAL",QUOTIENT:"QUOTIENT",RANDBETWEEN:"RANDBETWEEN",SERIESSUM:"SERIESSUM",SIGN:"SIGN",SQRTPI:"SQRTPI",SUMX2MY2:"SUMX2MY2",SUMX2PY2:"SUMX2PY2",SUMXMY2:"SUMXMY2",EXPONDIST:"EXPONDIST",GAMMADIST:"GAMMADIST",GAMMAINV:"GAMMAINV","BETA.DIST":"BETA.DIST",BETADIST:"BETADIST","BETA.INV":"BETA.INV",BETAINV:"BETAINV","BINOM.DIST":"BINOM.DIST",BINOMDIST:"BINOMDIST","BINOM.INV":"BINOM.INV",BESSELI:"BESSELI",BESSELJ:"BESSELJ",BESSELK:"BESSELK",BESSELY:"BESSELY","CHISQ.DIST":"CHISQ.DIST","CHISQ.DIST.RT":"CHISQ.DIST.RT","CHISQ.INV":"CHISQ.INV","CHISQ.INV.RT":"CHISQ.INV.RT",CHIDIST:"CHIDIST",CHIINV:"CHIINV","F.DIST":"F.DIST","F.DIST.RT":"F.DIST.RT","F.INV":"F.INV","F.INV.RT":"F.INV.RT",FDIST:"FDIST",FINV:"FINV",WEIBULL:"WEIBULL","WEIBULL.DIST":"WEIBULL.DIST",POISSON:"POISSON","POISSON.DIST":"POISSON.DIST","HYPGEOM.DIST":"HYPGEOM.DIST",HYPGEOMDIST:"HYPGEOMDIST","T.DIST":"T.DIST","T.DIST.2T":"T.DIST.2T","T.DIST.RT":"T.DIST.RT","T.INV":"T.INV","T.INV.2T":"T.INV.2T",TDIST:"TDIST",TINV:"TINV",LOGINV:"LOGINV","LOGNORM.DIST":"LOGNORM.DIST","LOGNORM.INV":"LOGNORM.INV",LOGNORMDIST:"LOGNORMDIST","NORM.DIST":"NORM.DIST","NORM.INV":"NORM.INV","NORM.S.DIST":"NORM.S.DIST","NORM.S.INV":"NORM.S.INV",NORMDIST:"NORMDIST",NORMINV:"NORMINV",NORMSDIST:"NORMSDIST",NORMSINV:"NORMSINV",PHI:"PHI","NEGBINOM.DIST":"NEGBINOM.DIST",NEGBINOMDIST:"NEGBINOMDIST",COMPLEX:"COMPLEX",IMABS:"IMABS",IMAGINARY:"IMAGINARY",IMARGUMENT:"IMARGUMENT",IMCONJUGATE:"IMCONJUGATE",IMCOS:"IMCOS",IMCOSH:"IMCOSH",IMCOT:"IMCOT",IMCSC:"IMCSC",IMCSCH:"IMCSCH",IMDIV:"IMDIV",IMEXP:"IMEXP",IMLN:"IMLN",IMLOG10:"IMLOG10",IMLOG2:"IMLOG2",IMPOWER:"IMPOWER",IMPRODUCT:"IMPRODUCT",IMREAL:"IMREAL",IMSEC:"IMSEC",IMSECH:"IMSECH",IMSIN:"IMSIN",IMSINH:"IMSINH",IMSQRT:"IMSQRT",IMSUB:"IMSUB",IMSUM:"IMSUM",IMTAN:"IMTAN",LARGE:"LARGE",SMALL:"SMALL",AVEDEV:"AVEDEV",CONFIDENCE:"CONFIDENCE","CONFIDENCE.NORM":"CONFIDENCE.NORM","CONFIDENCE.T":"CONFIDENCE.T",DEVSQ:"DEVSQ",GEOMEAN:"GEOMEAN",HARMEAN:"HARMEAN",CRITBINOM:"CRITBINOM","COVARIANCE.P":"COVARIANCE.P","COVARIANCE.S":"COVARIANCE.S",COVAR:"COVAR",PEARSON:"PEARSON",RSQ:"RSQ",STANDARDIZE:"STANDARDIZE","Z.TEST":"Z.TEST",ZTEST:"ZTEST","F.TEST":"F.TEST",FTEST:"FTEST",STEYX:"STEYX",SLOPE:"SLOPE","CHISQ.TEST":"CHISQ.TEST",CHITEST:"CHITEST","T.TEST":"T.TEST",TTEST:"TTEST",SKEW:"SKEW","SKEW.P":"SKEW.P",WEIBULLDIST:"WEIBULLDIST",VARS:"VARS",TINV2T:"TINV2T",TDISTRT:"TDISTRT",TDIST2T:"TDIST2T",STDEVS:"STDEVS",FINVRT:"FINVRT",FDISTRT:"FDISTRT",CHIDISTRT:"CHIDISTRT",CHIINVRT:"CHIINVRT",COVARIANCEP:"COVARIANCEP",COVARIANCES:"COVARIANCES",LOGNORMINV:"LOGNORMINV",POISSONDIST:"POISSONDIST",SKEWP:"SKEWP","CEILING.MATH":"CEILING.MATH",FLOOR:"FLOOR","FLOOR.MATH":"FLOOR.MATH","CEILING.PRECISE":"CEILING.PRECISE","FLOOR.PRECISE":"FLOOR.PRECISE","ISO.CEILING":"ISO.CEILING"},langCode:"enGB",ui:{NEW_SHEET_PREFIX:"Sheet"}};
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */var BG;!function(e){e[e.FullyAbsolute=1]="FullyAbsolute",e[e.RowAbsoluteColRelative=2]="RowAbsoluteColRelative",e[e.RowRelativeColAbsolute=3]="RowRelativeColAbsolute",e[e.FullyRelative=4]="FullyRelative"}(BG||(BG={}));class WG extends Zk{verifyAddressArguments(e,t,r,n){if(n){if(e<1||t<1)return new pk(XU.VALUE,BH.LessThanOne)}else if(BG.FullyAbsolute==r){if(e<1||t<1)return new pk(XU.VALUE,BH.LessThanOne)}else if(BG.RowAbsoluteColRelative==r){if(e<1)return new pk(XU.VALUE,BH.LessThanOne)}else if(BG.RowRelativeColAbsolute==r&&t<1)return new pk(XU.VALUE,BH.LessThanOne)}address(e,t){return this.runFunction(e.args,t,this.metadata("ADDRESS"),((e,t,r,n,o)=>{const i=this.verifyAddressArguments(e,t,r,n);if(void 0!==i)return i;const s=oL(t-1);let a="";null!=o&&(a=`${o}!`);const l=0==t?"C":`C[${t}]`,u=0==e?"R":`R[${e}]`;return BG.FullyRelative==r?n?`${a}${s}${e}`:`${a}${u}${l}`:BG.RowRelativeColAbsolute==r?n?`${a}$${s}${e}`:`${a}${u}C${t}`:BG.RowAbsoluteColRelative==r?n?`${a}${s}$${e}`:`${a}R${e}${l}`:n?`${a}$${s}$${e}`:`${a}R${e}C${t}`}))}}WG.implementedFunctions={ADDRESS:{method:"address",parameters:[{argumentType:Qk.NUMBER},{argumentType:Qk.NUMBER},{argumentType:Qk.NUMBER,optionalArg:!0,defaultValue:1,minValue:1,maxValue:4},{argumentType:Qk.BOOLEAN,optionalArg:!0,defaultValue:!0},{argumentType:Qk.STRING,optionalArg:!0}]}};
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
class GG extends Zk{arrayformula(e,t){return this.runFunction(e.args,t,this.metadata("ARRAYFORMULA"),(e=>e))}arrayformulaArraySize(e,t){if(1!==e.args.length)return Jk.error();const r=this.metadata("ARRAYFORMULA");return e.args.map((e=>{var n;return this.arraySizeForAst(e,new Mk(t.formulaAddress,t.arraysFlag||null!==(n=null==r?void 0:r.arrayFunction)&&void 0!==n&&n))}))[0]}arrayconstrain(e,t){return this.runFunction(e.args,t,this.metadata("ARRAY_CONSTRAIN"),((e,t,r)=>{t=Math.min(t,e.height()),r=Math.min(r,e.width());const n=e.data,o=[];for(let i=0;i<t;i++)o.push(n[i].slice(0,r));return zD.onlyValues(o)}))}arrayconstrainArraySize(e,t){if(3!==e.args.length)return Jk.error();const r=this.metadata("ARRAY_CONSTRAIN"),n=e.args.map((e=>{var n;return this.arraySizeForAst(e,new Mk(t.formulaAddress,t.arraysFlag||null!==(n=null==r?void 0:r.arrayFunction)&&void 0!==n&&n))}));let{height:o,width:i}=n[0];return e.args[1].type===IH.NUMBER&&(o=Math.min(o,e.args[1].value)),e.args[2].type===IH.NUMBER&&(i=Math.min(i,e.args[2].value)),o<1||i<1||!Number.isInteger(o)||!Number.isInteger(i)?Jk.error():new Jk(i,o)}filter(e,t){return this.runFunction(e.args,t,this.metadata("FILTER"),((e,...t)=>{for(const o of t)if(e.width()!==o.width()||e.height()!==o.height())return new pk(XU.NA,BH.EqualLength);if(e.width()>1&&e.height()>1)return new pk(XU.NA,BH.WrongDimension);const r=e.data,n=[];for(let o=0;o<e.height();o++){const i=[];for(let n=0;n<e.width();n++){let e=!0;for(const r of t){if(!0!==Hk(r.data[o][n])){e=!1;break}}e&&i.push(r[o][n])}i.length>0&&n.push(i)}return n.length>0?zD.onlyValues(n):new pk(XU.NA,BH.EmptyRange)}))}filterArraySize(e,t){if(e.args.length<=1)return Jk.error();const r=this.metadata("FILTER"),n=e.args.map((e=>{var n;return this.arraySizeForAst(e,new Mk(t.formulaAddress,t.arraysFlag||null!==(n=null==r?void 0:r.arrayFunction)&&void 0!==n&&n))})),o=Math.max(...n.map((e=>e.width))),i=Math.max(...n.map((e=>e.height)));return new Jk(o,i)}}GG.implementedFunctions={ARRAYFORMULA:{method:"arrayformula",arraySizeMethod:"arrayformulaArraySize",arrayFunction:!0,parameters:[{argumentType:Qk.ANY}]},ARRAY_CONSTRAIN:{method:"arrayconstrain",arraySizeMethod:"arrayconstrainArraySize",parameters:[{argumentType:Qk.RANGE},{argumentType:Qk.INTEGER,minValue:1},{argumentType:Qk.INTEGER,minValue:1}],vectorizationForbidden:!0},FILTER:{method:"filter",arraySizeMethod:"filterArraySize",arrayFunction:!0,parameters:[{argumentType:Qk.RANGE},{argumentType:Qk.RANGE}],repeatLastArgs:1}};
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
class jG extends Zk{abs(e,t){return this.runFunction(e.args,t,this.metadata("ABS"),Math.abs)}}jG.implementedFunctions={ABS:{method:"abs",parameters:[{argumentType:Qk.NUMBER}]}};
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
const zG=0xffffffffffff;class $G extends Zk{bitlshift(e,t){return this.runFunction(e.args,t,this.metadata("BITLSHIFT"),YG)}bitrshift(e,t){return this.runFunction(e.args,t,this.metadata("BITRSHIFT"),XG)}}function YG(e,t){return t<0?XG(e,-t):KG(e*Math.pow(2,t))}function XG(e,t){return t<0?YG(e,-t):KG(Math.floor(e/Math.pow(2,t)))}function KG(e){return e>zG?new pk(XU.NUM,BH.BitshiftLong):e}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */$G.implementedFunctions={BITLSHIFT:{method:"bitlshift",parameters:[{argumentType:Qk.INTEGER,minValue:0},{argumentType:Qk.INTEGER,minValue:-53,maxValue:53}]},BITRSHIFT:{method:"bitrshift",parameters:[{argumentType:Qk.INTEGER,minValue:0},{argumentType:Qk.INTEGER,minValue:-53,maxValue:53}]}};class qG extends Zk{bitand(e,t){return this.runFunction(e.args,t,this.metadata("BITAND"),((e,t)=>e&t))}bitor(e,t){return this.runFunction(e.args,t,this.metadata("BITOR"),((e,t)=>e|t))}bitxor(e,t){return this.runFunction(e.args,t,this.metadata("BITXOR"),((e,t)=>e^t))}}qG.implementedFunctions={BITAND:{method:"bitand",parameters:[{argumentType:Qk.INTEGER,minValue:0},{argumentType:Qk.INTEGER,minValue:0}]},BITOR:{method:"bitor",parameters:[{argumentType:Qk.INTEGER,minValue:0},{argumentType:Qk.INTEGER,minValue:0}]},BITXOR:{method:"bitxor",parameters:[{argumentType:Qk.INTEGER,minValue:0},{argumentType:Qk.INTEGER,minValue:0}]}};
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
class QG extends Zk{literalTrue(e,t){return this.runFunction(e.args,t,this.metadata("TRUE"),(()=>!0))}literalFalse(e,t){return this.runFunction(e.args,t,this.metadata("FALSE"),(()=>!1))}conditionalIf(e,t){return this.runFunction(e.args,t,this.metadata("IF"),((e,t,r)=>e?t:r))}ifs(e,t){return this.runFunction(e.args,t,this.metadata("IFS"),((...e)=>{for(let t=0;t<e.length;t+=2)if(e[t])return e[t+1];return new pk(XU.NA,BH.NoConditionMet)}))}and(e,t){return this.runFunction(e.args,t,this.metadata("AND"),((...e)=>e.filter((e=>void 0!==e)).every((e=>!!e))))}or(e,t){return this.runFunction(e.args,t,this.metadata("OR"),((...e)=>e.filter((e=>void 0!==e)).some((e=>e))))}not(e,t){return this.runFunction(e.args,t,this.metadata("NOT"),(e=>!e))}xor(e,t){return this.runFunction(e.args,t,this.metadata("XOR"),((...e)=>{let t=0;return e.filter((e=>void 0!==e)).forEach((e=>{e&&t++})),t%2==1}))}switch(e,t){return this.runFunction(e.args,t,this.metadata("SWITCH"),((e,...t)=>{const r=t.length;let n=0;for(;n+1<r;n+=2)if(!(t[n]instanceof pk)&&this.arithmeticHelper.eq(e,t[n]))return t[n+1];return n<r?t[n]:new pk(XU.NA,BH.NoDefault)}))}iferror(e,t){return this.runFunction(e.args,t,this.metadata("IFERROR"),((e,t)=>e instanceof pk?t:e))}ifna(e,t){return this.runFunction(e.args,t,this.metadata("IFNA"),((e,t)=>e instanceof pk&&e.type===XU.NA?t:e))}choose(e,t){return this.runFunction(e.args,t,this.metadata("CHOOSE"),((e,...t)=>e>t.length?new pk(XU.NUM,BH.Selector):t[e-1]))}}QG.implementedFunctions={TRUE:{method:"literalTrue",parameters:[]},FALSE:{method:"literalFalse",parameters:[]},IF:{method:"conditionalIf",parameters:[{argumentType:Qk.BOOLEAN},{argumentType:Qk.SCALAR,passSubtype:!0},{argumentType:Qk.SCALAR,defaultValue:!1,passSubtype:!0}]},IFS:{method:"ifs",parameters:[{argumentType:Qk.BOOLEAN},{argumentType:Qk.SCALAR,passSubtype:!0}],repeatLastArgs:2},AND:{method:"and",parameters:[{argumentType:Qk.BOOLEAN}],repeatLastArgs:1,expandRanges:!0},OR:{method:"or",parameters:[{argumentType:Qk.BOOLEAN}],repeatLastArgs:1,expandRanges:!0},XOR:{method:"xor",parameters:[{argumentType:Qk.BOOLEAN}],repeatLastArgs:1,expandRanges:!0},NOT:{method:"not",parameters:[{argumentType:Qk.BOOLEAN}]},SWITCH:{method:"switch",parameters:[{argumentType:Qk.NOERROR},{argumentType:Qk.SCALAR,passSubtype:!0},{argumentType:Qk.SCALAR,passSubtype:!0}],repeatLastArgs:1},IFERROR:{method:"iferror",parameters:[{argumentType:Qk.SCALAR,passSubtype:!0},{argumentType:Qk.SCALAR,passSubtype:!0}]},IFNA:{method:"ifna",parameters:[{argumentType:Qk.SCALAR,passSubtype:!0},{argumentType:Qk.SCALAR,passSubtype:!0}]},CHOOSE:{method:"choose",parameters:[{argumentType:Qk.INTEGER,minValue:1},{argumentType:Qk.SCALAR,passSubtype:!0}],repeatLastArgs:1}};
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
class ZG extends Zk{char(e,t){return this.runFunction(e.args,t,this.metadata("CHAR"),(e=>e<1||e>=256?new pk(XU.VALUE,BH.CharacterCodeBounds):String.fromCharCode(Math.trunc(e))))}unichar(e,t){return this.runFunction(e.args,t,this.metadata("CHAR"),(e=>e<1||e>=1114112?new pk(XU.VALUE,BH.CharacterCodeBounds):String.fromCodePoint(Math.trunc(e))))}}ZG.implementedFunctions={CHAR:{method:"char",parameters:[{argumentType:Qk.NUMBER}]},UNICHAR:{method:"unichar",parameters:[{argumentType:Qk.NUMBER}]}};
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
class JG extends Zk{code(e,t){return this.runFunction(e.args,t,this.metadata("CODE"),(e=>0===e.length?new pk(XU.VALUE,BH.EmptyString):e.charCodeAt(0)))}unicode(e,t){return this.runFunction(e.args,t,this.metadata("UNICODE"),(e=>{var t;return null!==(t=e.codePointAt(0))&&void 0!==t?t:new pk(XU.VALUE,BH.EmptyString)}))}}JG.implementedFunctions={CODE:{method:"code",parameters:[{argumentType:Qk.STRING}]},UNICODE:{method:"unicode",parameters:[{argumentType:Qk.STRING}]}};
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
class ej extends Zk{countblank(e,t){return this.runFunction(e.args,t,this.metadata("COUNTBLANK"),((...e)=>{let t=0;return e.forEach((e=>{e===xD&&t++})),t}))}}ej.implementedFunctions={COUNTBLANK:{method:"countblank",parameters:[{argumentType:Qk.SCALAR}],repeatLastArgs:1,expandRanges:!0}};
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
class tj extends Zk{countunique(e,t){return this.runFunction(e.args,t,this.metadata("COUNTUNIQUE"),((...e)=>{const t=new Set,r=new Set;for(const n of e)n instanceof pk?r.add(n.type):""!==n&&t.add(n);return t.size+r.size}))}}tj.implementedFunctions={COUNTUNIQUE:{method:"countunique",parameters:[{argumentType:Qk.SCALAR}],repeatLastArgs:1,expandRanges:!0}};
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
class rj extends Zk{constructor(){super(...arguments),this.isoweeknumCore=e=>{const t=Math.floor(this.dateTimeHelper.relativeNumberToAbsoluteNumber(e)),r=this.dateTimeHelper.numberToSimpleDate(e),n=this.dateTimeHelper.dateToNumber({year:r.year,month:1,day:1}),o=this.dateTimeHelper.relativeNumberToAbsoluteNumber(n),i=o+((4-o)%7+7)%7,s=Math.floor((t-1)/7)-Math.floor((i-1)/7)+1;return 0===s?this.isoweeknumCore(e-7)+1:s},this.days360Core=(e,t,r)=>{const n=this.dateTimeHelper.numberToSimpleDate(e),o=this.dateTimeHelper.numberToSimpleDate(t);let i,s;return r?(i=MB(n),s=MB(o)):[i,s]=this.dateTimeHelper.toBasisUS(n,o),360*(s.year-i.year)+30*(s.month-i.month)+s.day-i.day}}date(e,t){return this.runFunction(e.args,t,this.metadata("DATE"),((e,t,r)=>{const n=Math.trunc(r);let o=Math.trunc(t),i=Math.trunc(e);i<this.dateTimeHelper.getEpochYearZero()&&(i+=this.dateTimeHelper.getEpochYearZero());const s=Math.floor((o-1)/12);i+=s,o-=12*s;const a={year:i,month:o,day:1};if(this.dateTimeHelper.isValidDate(a)){let e=this.dateTimeHelper.dateToNumber(a)+(n-1);return e=this.dateTimeHelper.getWithinBounds(e),void 0===e?new pk(XU.NUM,BH.DateBounds):e}return new pk(XU.VALUE,BH.InvalidDate)}))}time(e,t){return this.runFunction(e.args,t,this.metadata("TIME"),((e,t,r)=>{const n=OB({hours:Math.trunc(e),minutes:Math.trunc(t),seconds:Math.trunc(r)});return n<0?new pk(XU.NUM,BH.NegativeTime):n%1}))}eomonth(e,t){return this.runFunction(e.args,t,this.metadata("EOMONTH"),((e,t)=>{const r=this.dateTimeHelper.numberToSimpleDate(e);let n=this.dateTimeHelper.dateToNumber(this.dateTimeHelper.endOfMonth(NB(r,t)));return n=this.dateTimeHelper.getWithinBounds(n),void 0===n?new pk(XU.NUM,BH.DateBounds):n}))}day(e,t){return this.runFunction(e.args,t,this.metadata("DAY"),(e=>this.dateTimeHelper.numberToSimpleDate(e).day))}days(e,t){return this.runFunction(e.args,t,this.metadata("DAYS"),((e,t)=>Math.trunc(e)-Math.trunc(t)))}month(e,t){return this.runFunction(e.args,t,this.metadata("MONTH"),(e=>this.dateTimeHelper.numberToSimpleDate(e).month))}year(e,t){return this.runFunction(e.args,t,this.metadata("YEAR"),(e=>this.dateTimeHelper.numberToSimpleDate(e).year))}hour(e,t){return this.runFunction(e.args,t,this.metadata("HOUR"),(e=>IB(AB(e)%1).hours))}minute(e,t){return this.runFunction(e.args,t,this.metadata("MINUTE"),(e=>IB(AB(e)%1).minutes))}second(e,t){return this.runFunction(e.args,t,this.metadata("SECOND"),(e=>IB(AB(e)%1).seconds))}text(e,t){return this.runFunction(e.args,t,this.metadata("TEXT"),((e,t)=>kB(e,t,this.config,this.dateTimeHelper)))}weekday(e,t){return this.runFunction(e.args,t,this.metadata("WEEKDAY"),((e,t)=>{const r=Math.floor(this.dateTimeHelper.relativeNumberToAbsoluteNumber(e));if(3===t)return(r-1)%7;const n=ij.get(t);return void 0===n?new pk(XU.NUM,BH.BadMode):(r-n)%7+1}))}weeknum(e,t){return this.runFunction(e.args,t,this.metadata("WEEKNUM"),((e,t)=>{const r=Math.floor(this.dateTimeHelper.relativeNumberToAbsoluteNumber(e)),n=this.dateTimeHelper.numberToSimpleDate(e),o=this.dateTimeHelper.dateToNumber({year:n.year,month:1,day:1}),i=this.dateTimeHelper.relativeNumberToAbsoluteNumber(o);if(21===t)return this.isoweeknumCore(e);const s=ij.get(t);return void 0===s?new pk(XU.NUM,BH.BadMode):Math.floor((r-s)/7)-Math.floor((i-s)/7)+1}))}isoweeknum(e,t){return this.runFunction(e.args,t,this.metadata("ISOWEEKNUM"),this.isoweeknumCore)}datevalue(e,t){return this.runFunction(e.args,t,this.metadata("DATEVALUE"),(e=>{const{dateTime:t}=this.dateTimeHelper.parseDateTimeFromConfigFormats(e);return void 0===t?new pk(XU.VALUE,BH.IncorrectDateTime):SB(t)?(TB(t)?Math.trunc(OB(t)):0)+this.dateTimeHelper.dateToNumber(t):0}))}timevalue(e,t){return this.runFunction(e.args,t,this.metadata("TIMEVALUE"),(e=>{const t=this.dateTimeHelper.dateStringToDateNumber(e);return void 0===t?new pk(XU.VALUE,BH.IncorrectDateTime):LD(t)%1}))}now(e,t){return this.runFunction(e.args,t,this.metadata("NOW"),(()=>{const e=new Date(Date.now());return OB({hours:e.getHours(),minutes:e.getMinutes(),seconds:e.getSeconds()})+this.dateTimeHelper.dateToNumber({year:e.getFullYear(),month:e.getMonth()+1,day:e.getDate()})}))}today(e,t){return this.runFunction(e.args,t,this.metadata("TODAY"),(()=>{const e=new Date(Date.now());return this.dateTimeHelper.dateToNumber({year:e.getFullYear(),month:e.getMonth()+1,day:e.getDate()})}))}edate(e,t){return this.runFunction(e.args,t,this.metadata("EDATE"),((e,t)=>{const r=function(e){return{year:e.year,month:e.month,day:Math.min(e.day,yB[e.month-1])}}(NB(this.dateTimeHelper.numberToSimpleDate(e),t));let n=this.dateTimeHelper.dateToNumber(r);return n=this.dateTimeHelper.getWithinBounds(n),void 0===n?new pk(XU.NUM,BH.DateBounds):n}))}datedif(e,t){return this.runFunction(e.args,t,this.metadata("DATEDIF"),((e,t,r)=>{if(e>t)return new pk(XU.NUM,BH.StartEndDate);if("D"===r)return Math.floor(t)-Math.floor(e);const n=this.dateTimeHelper.numberToSimpleDate(e),o=this.dateTimeHelper.numberToSimpleDate(t);switch(r){case"M":return 12*(o.year-n.year)+(o.month-n.month)-(o.day<n.day?1:0);case"YM":return(o.month-n.month+12-(o.day<n.day?1:0))%12;case"Y":return o.month>n.month||o.month===n.month&&o.day>=n.day?o.year-n.year:o.year-n.year-1;case"MD":if(o.day>=n.day)return o.day-n.day;{const e=1===o.month?12:o.month-1,t=1===o.month?o.year-1:o.year;return this.dateTimeHelper.daysInMonth(t,e)+o.day-n.day}case"YD":return o.month>n.month||o.month===n.month&&o.day>=n.day?Math.floor(t)-this.dateTimeHelper.dateToNumber({year:o.year,month:n.month,day:n.day}):Math.floor(t)-Math.floor(e)-365*(o.year-n.year-1)-this.dateTimeHelper.leapYearsCount(o.year-1)+this.dateTimeHelper.leapYearsCount(n.year);default:return new pk(XU.NUM,BH.BadMode)}}))}days360(e,t){return this.runFunction(e.args,t,this.metadata("DAYS360"),this.days360Core)}yearfrac(e,t){return this.runFunction(e.args,t,this.metadata("YEARFRAC"),((e,t,r)=>{switch((e=Math.trunc(e))>(t=Math.trunc(t))&&([e,t]=[t,e]),r){case 0:return this.days360Core(e,t,!1)/360;case 1:return(t-e)/this.dateTimeHelper.yearLengthForBasis(this.dateTimeHelper.numberToSimpleDate(e),this.dateTimeHelper.numberToSimpleDate(t));case 2:return(t-e)/360;case 3:return(t-e)/365;case 4:return this.days360Core(e,t,!0)/360}throw new Error("Should not be reachable.")}))}interval(e,t){return this.runFunction(e.args,t,this.metadata("INTERVAL"),(e=>{const t=(e=Math.trunc(e))%60,r=(e=Math.trunc(e/60))%60,n=(e=Math.trunc(e/60))%24,o=(e=Math.trunc(e/24))%30,i=(e=Math.trunc(e/30))%12,s=Math.trunc(e/12);return"P"+(s>0?`${s}Y`:"")+(i>0?`${i}M`:"")+(o>0?`${o}D`:"")+"T"+(n>0?`${n}H`:"")+(r>0?`${r}M`:"")+(t>0?`${t}S`:"")}))}networkdays(e,t){return this.runFunction(e.args,t,this.metadata("NETWORKDAYS"),((e,t,r)=>this.networkdayscore(e,t,1,r)))}networkdaysintl(e,t){return this.runFunction(e.args,t,this.metadata("NETWORKDAYS.INTL"),((e,t,r,n)=>this.networkdayscore(e,t,r,n)))}workday(e,t){return this.runFunction(e.args,t,this.metadata("WORKDAY"),((e,t,r)=>this.workdaycore(e,t,1,r)))}workdayintl(e,t){return this.runFunction(e.args,t,this.metadata("WORKDAY.INTL"),((e,t,r,n)=>this.workdaycore(e,t,r,n)))}networkdayscore(e,t,r,n){let o=1;(e=Math.trunc(e))>(t=Math.trunc(t))&&([e,t]=[t,e],o=-1);const i=oj(r);if(i instanceof pk)return i;const s=this.simpleRangeToFilteredHolidays(i,n);return s instanceof pk?s:o*this.countWorkdays(e,t,i,s)}workdaycore(e,t,r,n){e=Math.trunc(e),t=Math.trunc(t);const o=oj(r);if(o instanceof pk)return o;const i=this.simpleRangeToFilteredHolidays(o,n);if(i instanceof pk)return i;if(t>0){let r=1;for(;this.countWorkdays(e+1,e+r,o,i)<t;)r*=2;let n=1;for(;n+1<r;){const s=Math.trunc((n+r)/2);this.countWorkdays(e+1,e+s,o,i)<t?n=s:r=s}return e+r}if(t<0){t*=-1;let r=1;for(;this.countWorkdays(e-r,e-1,o,i)<t;)r*=2;let n=1;for(;n+1<r;){const s=Math.trunc((n+r)/2);this.countWorkdays(e-s,e-1,o,i)<t?n=s:r=s}return e-r}return e}countWorkdays(e,t,r,n){const o=Math.floor(this.dateTimeHelper.relativeNumberToAbsoluteNumber(t)),i=Math.floor(this.dateTimeHelper.relativeNumberToAbsoluteNumber(e));let s=0;for(let a=0;a<7;a++)"0"===r.charAt(a)&&(s+=Math.floor((o+6-a)/7),s-=Math.floor((i-1+6-a)/7));return s-=nj(t+1,n)-nj(e,n),s}simpleRangeToFilteredHolidays(e,t){var r;const n=null!==(r=null==t?void 0:t.valuesFromTopLeftCorner())&&void 0!==r?r:[];for(const i of n)if(i instanceof pk)return i;const o=[];for(const i of n)if(i!==xD){if(!BD(i))return new pk(XU.VALUE,BH.WrongType);o.push(Math.trunc(LD(i)))}return[...new Set(o)].sort(((e,t)=>e-t)).filter((t=>{const r=(this.dateTimeHelper.relativeNumberToAbsoluteNumber(t)-1)%7;return"0"===e.charAt(r)}))}}function nj(e,t){if(0===t.length)return 0;if(e<=t[0])return 0;if(t[t.length-1]<e)return t.length;let r=0,n=t.length-1;for(;r+1<n;){const o=Math.floor((n+r)/2);t[o]>=e?n=o:r=o}return n}function oj(e){var t;return"number"!=typeof e&&"string"!=typeof e?new pk(XU.VALUE,BH.WrongType):"string"==typeof e?7===e.length&&/^(0|1)*$/.test(e)&&"1111111"!==e?e:new pk(XU.NUM,BH.WeekendString):null!==(t=sj.get(e))&&void 0!==t?t:new pk(XU.NUM,BH.BadMode)}rj.implementedFunctions={DATE:{method:"date",parameters:[{argumentType:Qk.NUMBER},{argumentType:Qk.NUMBER},{argumentType:Qk.NUMBER}],returnNumberType:WD.NUMBER_DATE},TIME:{method:"time",parameters:[{argumentType:Qk.NUMBER},{argumentType:Qk.NUMBER},{argumentType:Qk.NUMBER}],returnNumberType:WD.NUMBER_TIME},MONTH:{method:"month",parameters:[{argumentType:Qk.NUMBER,minValue:0}]},YEAR:{method:"year",parameters:[{argumentType:Qk.NUMBER,minValue:0}]},HOUR:{method:"hour",parameters:[{argumentType:Qk.NUMBER,minValue:0}]},MINUTE:{method:"minute",parameters:[{argumentType:Qk.NUMBER,minValue:0}]},SECOND:{method:"second",parameters:[{argumentType:Qk.NUMBER,minValue:0}]},TEXT:{method:"text",parameters:[{argumentType:Qk.NUMBER},{argumentType:Qk.STRING}]},EOMONTH:{method:"eomonth",parameters:[{argumentType:Qk.NUMBER,minValue:0},{argumentType:Qk.NUMBER}],returnNumberType:WD.NUMBER_DATE},DAY:{method:"day",parameters:[{argumentType:Qk.NUMBER,minValue:0}]},DAYS:{method:"days",parameters:[{argumentType:Qk.NUMBER,minValue:0},{argumentType:Qk.NUMBER,minValue:0}]},WEEKDAY:{method:"weekday",parameters:[{argumentType:Qk.NUMBER,minValue:0},{argumentType:Qk.NUMBER,defaultValue:1}]},WEEKNUM:{method:"weeknum",parameters:[{argumentType:Qk.NUMBER,minValue:0},{argumentType:Qk.NUMBER,defaultValue:1}]},ISOWEEKNUM:{method:"isoweeknum",parameters:[{argumentType:Qk.NUMBER,minValue:0}]},DATEVALUE:{method:"datevalue",parameters:[{argumentType:Qk.STRING}],returnNumberType:WD.NUMBER_DATE},TIMEVALUE:{method:"timevalue",parameters:[{argumentType:Qk.STRING}],returnNumberType:WD.NUMBER_TIME},NOW:{method:"now",parameters:[],isVolatile:!0,returnNumberType:WD.NUMBER_DATETIME},TODAY:{method:"today",parameters:[],isVolatile:!0,returnNumberType:WD.NUMBER_DATE},EDATE:{method:"edate",parameters:[{argumentType:Qk.NUMBER,minValue:0},{argumentType:Qk.NUMBER}],returnNumberType:WD.NUMBER_DATE},DAYS360:{method:"days360",parameters:[{argumentType:Qk.NUMBER,minValue:0},{argumentType:Qk.NUMBER,minValue:0},{argumentType:Qk.BOOLEAN,defaultValue:!1}]},DATEDIF:{method:"datedif",parameters:[{argumentType:Qk.NUMBER,minValue:0},{argumentType:Qk.NUMBER,minValue:0},{argumentType:Qk.STRING}]},YEARFRAC:{method:"yearfrac",parameters:[{argumentType:Qk.NUMBER,minValue:0},{argumentType:Qk.NUMBER,minValue:0},{argumentType:Qk.INTEGER,defaultValue:0,minValue:0,maxValue:4}]},INTERVAL:{method:"interval",parameters:[{argumentType:Qk.NUMBER,minValue:0}]},NETWORKDAYS:{method:"networkdays",parameters:[{argumentType:Qk.NUMBER,minValue:0},{argumentType:Qk.NUMBER,minValue:0},{argumentType:Qk.RANGE,optionalArg:!0}]},"NETWORKDAYS.INTL":{method:"networkdaysintl",parameters:[{argumentType:Qk.NUMBER,minValue:0},{argumentType:Qk.NUMBER,minValue:0},{argumentType:Qk.NOERROR,defaultValue:1},{argumentType:Qk.RANGE,optionalArg:!0}]},WORKDAY:{method:"workday",parameters:[{argumentType:Qk.NUMBER,minValue:0},{argumentType:Qk.NUMBER},{argumentType:Qk.RANGE,optionalArg:!0}]},"WORKDAY.INTL":{method:"workdayintl",parameters:[{argumentType:Qk.NUMBER,minValue:0},{argumentType:Qk.NUMBER},{argumentType:Qk.NOERROR,defaultValue:1},{argumentType:Qk.RANGE,optionalArg:!0}]}};const ij=new Map([[1,0],[2,1],[11,1],[12,2],[13,3],[14,4],[15,5],[16,6],[17,0]]),sj=new Map([[1,"0000011"],[2,"1000001"],[3,"1100000"],[4,"0110000"],[5,"0011000"],[6,"0001100"],[7,"0000110"],[11,"0000001"],[12,"1000000"],[13,"0100000"],[14,"0010000"],[15,"0001000"],[16,"0000100"],[17,"0000010"]]);
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
class aj extends Zk{degrees(e,t){return this.runFunction(e.args,t,this.metadata("DEGREES"),(e=>e*(180/Math.PI)))}}aj.implementedFunctions={DEGREES:{method:"degrees",parameters:[{argumentType:Qk.NUMBER}]}};
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
class lj extends Zk{delta(e,t){return this.runFunction(e.args,t,this.metadata("DELTA"),((e,t)=>e===t?1:0))}}lj.implementedFunctions={DELTA:{method:"delta",parameters:[{argumentType:Qk.NUMBER},{argumentType:Qk.NUMBER,defaultValue:0}]}};
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
class uj extends Zk{exp(e,t){return this.runFunction(e.args,t,this.metadata("EXP"),Math.exp)}}uj.implementedFunctions={EXP:{method:"exp",parameters:[{argumentType:Qk.NUMBER}]}};
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
class hj extends Zk{pmt(e,t){return this.runFunction(e.args,t,this.metadata("PMT"),cj)}ipmt(e,t){return this.runFunction(e.args,t,this.metadata("IPMT"),dj)}ppmt(e,t){return this.runFunction(e.args,t,this.metadata("PPMT"),mj)}fv(e,t){return this.runFunction(e.args,t,this.metadata("FV"),pj)}cumipmt(e,t){return this.runFunction(e.args,t,this.metadata("CUMIPMT"),((e,t,r,n,o,i)=>{if(n>o)return new pk(XU.NUM,BH.EndStartPeriod);let s=0;for(let a=n;a<=o;a++)s+=dj(e,a,t,r,0,i);return s}))}cumprinc(e,t){return this.runFunction(e.args,t,this.metadata("CUMPRINC"),((e,t,r,n,o,i)=>{if(n>o)return new pk(XU.NUM,BH.EndStartPeriod);let s=0;for(let a=n;a<=o;a++)s+=mj(e,a,t,r,0,i);return s}))}db(e,t){return this.runFunction(e.args,t,this.metadata("DB"),((e,t,r,n,o)=>{if(12===o&&n>r||n>r+1)return new pk(XU.NUM,BH.PeriodLong);if(t>=e)return 0;const i=Math.round(1e3*(1-Math.pow(t/e,1/r)))/1e3,s=e*i*o/12;if(1===n)return s;let a=s;for(let l=0;l<n-2;l++)a+=(e-a)*i;return n===r+1?(e-a)*i*(12-o)/12:(e-a)*i}))}ddb(e,t){return this.runFunction(e.args,t,this.metadata("DDB"),((e,t,r,n,o)=>{if(n>r)return new pk(XU.NUM);let i,s=o/r;s>=1?(s=1,i=1===n?e:0):i=e*Math.pow(1-s,n-1);const a=e*Math.pow(1-s,n);return Math.max(i-Math.max(t,a),0)}))}dollarde(e,t){return this.runFunction(e.args,t,this.metadata("DOLLARDE"),((e,t)=>{if(t<1)return new pk(XU.DIV_BY_ZERO);for(t=Math.trunc(t);t>10;)t/=10;return Math.trunc(e)+10*(e-Math.trunc(e))/t}))}dollarfr(e,t){return this.runFunction(e.args,t,this.metadata("DOLLARFR"),((e,t)=>{if(t<1)return new pk(XU.DIV_BY_ZERO);for(t=Math.trunc(t);t>10;)t/=10;return Math.trunc(e)+(e-Math.trunc(e))*t/10}))}effect(e,t){return this.runFunction(e.args,t,this.metadata("EFFECT"),((e,t)=>(t=Math.trunc(t),Math.pow(1+e/t,t)-1)))}ispmt(e,t){return this.runFunction(e.args,t,this.metadata("ISPMT"),((e,t,r,n)=>0===r?new pk(XU.DIV_BY_ZERO):n*e*(t/r-1)))}nominal(e,t){return this.runFunction(e.args,t,this.metadata("NOMINAL"),((e,t)=>(t=Math.trunc(t),(Math.pow(e+1,1/t)-1)*t)))}nper(e,t){return this.runFunction(e.args,t,this.metadata("NPER"),((e,t,r,n,o)=>0===e?0===t?new pk(XU.DIV_BY_ZERO):(-r-n)/t:(o&&(t*=1+e),Math.log((t-n*e)/(r*e+t))/Math.log(1+e))))}rate(e,t){return this.runFunction(e.args,t,this.metadata("RATE"),((e,t,r,n,o,i)=>{if(i<=-1)return new pk(XU.VALUE);const s=1e-7;let a=i;o=o?1:0;for(let l=0;l<50;l++){if(a<=-1)return new pk(XU.NUM);let i,l;if(Math.abs(a)<s)i=r*(1+e*a)+t*(1+a*o)*e+n;else{const s=Math.pow(1+a,e);i=r*s+t*(1/a+o)*(s-1)+n}if(Math.abs(i)<s)return a;if(Math.abs(a)<s)l=r*e+t*o*e;else{const n=Math.pow(1+a,e),i=e*Math.pow(1+a,e-1);l=r*i+t*(1/a+o)*i+t*(-1/(a*a))*(n-1)}a-=i/l}return new pk(XU.NUM)}))}pv(e,t){return this.runFunction(e.args,t,this.metadata("PV"),((e,t,r,n,o)=>(o=o?1:0,-1===e?new pk(0===t?XU.NUM:XU.DIV_BY_ZERO):0===e?-r*t-n:((1-Math.pow(1+e,t))*r*(1+e*o)/e-n)/Math.pow(1+e,t))))}rri(e,t){return this.runFunction(e.args,t,this.metadata("RRI"),((e,t,r)=>0===t||r<0&&t>0||r>0&&t<0?new pk(XU.NUM):Math.pow(r/t,1/e)-1))}sln(e,t){return this.runFunction(e.args,t,this.metadata("SLN"),((e,t,r)=>0===r?new pk(XU.DIV_BY_ZERO):(e-t)/r))}syd(e,t){return this.runFunction(e.args,t,this.metadata("SYD"),((e,t,r,n)=>n>r?new pk(XU.NUM):(e-t)*(r-n+1)*2/(r*(r+1))))}tbilleq(e,t){return this.runFunction(e.args,t,this.metadata("TBILLEQ"),((e,t,r)=>{if((e=Math.round(e))>=(t=Math.round(t)))return new pk(XU.NUM);const n=this.dateTimeHelper.numberToSimpleDate(e),o=this.dateTimeHelper.numberToSimpleDate(t);if(o.year>n.year+1||o.year===n.year+1&&(o.month>n.month||o.month===n.month&&o.day>n.day))return new pk(XU.NUM);const i=360-r*(t-e);return 0===i?0:i<0?new pk(XU.NUM):365*r/i}))}tbillprice(e,t){return this.runFunction(e.args,t,this.metadata("TBILLPRICE"),((e,t,r)=>{if((e=Math.round(e))>=(t=Math.round(t)))return new pk(XU.NUM);const n=this.dateTimeHelper.numberToSimpleDate(e),o=this.dateTimeHelper.numberToSimpleDate(t);if(o.year>n.year+1||o.year===n.year+1&&(o.month>n.month||o.month===n.month&&o.day>n.day))return new pk(XU.NUM);const i=360-r*(t-e);return 0===i?0:i<0?new pk(XU.NUM):100*(1-r*(t-e)/360)}))}tbillyield(e,t){return this.runFunction(e.args,t,this.metadata("TBILLYIELD"),((e,t,r)=>{if((e=Math.round(e))>=(t=Math.round(t)))return new pk(XU.NUM);const n=this.dateTimeHelper.numberToSimpleDate(e),o=this.dateTimeHelper.numberToSimpleDate(t);return o.year>n.year+1||o.year===n.year+1&&(o.month>n.month||o.month===n.month&&o.day>n.day)?new pk(XU.NUM):360*(100-r)/(r*(t-e))}))}fvschedule(e,t){return this.runFunction(e.args,t,this.metadata("FVSCHEDULE"),((e,t)=>{const r=t.valuesFromTopLeftCorner();for(const n of r)if(n instanceof pk)return n;for(const n of r)if(BD(n))e*=1+LD(n);else if(n!==xD)return new pk(XU.VALUE,BH.NumberExpected);return e}))}npv(e,t){return this.runFunction(e.args,t,this.metadata("NPV"),((e,...t)=>{const r=this.arithmeticHelper.coerceNumbersExactRanges(t);return r instanceof pk?r:gj(e,r)}))}mirr(e,t){return this.runFunction(e.args,t,this.metadata("MIRR"),((e,t,r)=>{const n=this.arithmeticHelper.manyToExactNumbers(e.valuesFromTopLeftCorner());if(n instanceof pk)return n;let o=!1,i=!1;const s=[],a=[];for(const c of n)c>0?(o=!0,s.push(c),a.push(0)):c<0?(i=!0,a.push(c),s.push(0)):(a.push(0),s.push(0));if(!o||!i)return new pk(XU.DIV_BY_ZERO);const l=n.length,u=gj(r,s);if(u instanceof pk)return u;const h=gj(t,a);return h instanceof pk?h:Math.pow(-u*Math.pow(1+r,l)/h/(1+t),1/(l-1))-1}))}pduration(e,t){return this.runFunction(e.args,t,this.metadata("PDURATION"),((e,t,r)=>(Math.log(r)-Math.log(t))/Math.log(1+e)))}xnpv(e,t){return this.runFunction(e.args,t,this.metadata("XNPV"),((e,t,r)=>{const n=t.valuesFromTopLeftCorner();for(const u of n)if("number"!=typeof u)return new pk(XU.VALUE,BH.NumberExpected);const o=n,i=r.valuesFromTopLeftCorner();for(const u of i)if("number"!=typeof u)return new pk(XU.VALUE,BH.NumberExpected);const s=i;if(s.length!==o.length)return new pk(XU.NUM,BH.EqualLength);const a=s.length;let l=0;if(s[0]<0)return new pk(XU.NUM,BH.ValueSmall);for(let u=0;u<a;u++){if(s[u]=Math.floor(s[u]),s[u]<s[0])return new pk(XU.NUM,BH.ValueSmall);l+=o[u]/Math.pow(1+e,(s[u]-s[0])/365)}return l}))}}function cj(e,t,r,n,o){if(0===e)return(-r-n)/t;{const i=Math.pow(1+e,t);return(n*e+r*e*i)*(o?1/(1+e):1)/(1-i)}}function dj(e,t,r,n,o,i){const s=cj(e,r,n,o,i);return 1===t?e*(i?0:-n):e*(i?pj(e,t-2,s,n,i)-s:pj(e,t-1,s,n,i))}function pj(e,t,r,n,o){if(0===e)return-n-r*t;{const i=Math.pow(1+e,t);return r*(o?1+e:1)*(1-i)/e-n*i}}function mj(e,t,r,n,o,i){return cj(e,r,n,o,i)-dj(e,t,r,n,o,i)}function gj(e,t){let r=0;for(let n=t.length-1;n>=0;n--){if(r+=t[n],-1===e){if(0===r)continue;return new pk(XU.DIV_BY_ZERO)}r/=1+e}return r}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */hj.implementedFunctions={PMT:{method:"pmt",parameters:[{argumentType:Qk.NUMBER},{argumentType:Qk.NUMBER},{argumentType:Qk.NUMBER},{argumentType:Qk.NUMBER,defaultValue:0},{argumentType:Qk.NUMBER,defaultValue:0}],returnNumberType:WD.NUMBER_CURRENCY},IPMT:{method:"ipmt",parameters:[{argumentType:Qk.NUMBER},{argumentType:Qk.NUMBER},{argumentType:Qk.NUMBER},{argumentType:Qk.NUMBER},{argumentType:Qk.NUMBER,defaultValue:0},{argumentType:Qk.NUMBER,defaultValue:0}],returnNumberType:WD.NUMBER_CURRENCY},PPMT:{method:"ppmt",parameters:[{argumentType:Qk.NUMBER},{argumentType:Qk.NUMBER},{argumentType:Qk.NUMBER},{argumentType:Qk.NUMBER},{argumentType:Qk.NUMBER,defaultValue:0},{argumentType:Qk.NUMBER,defaultValue:0}],returnNumberType:WD.NUMBER_CURRENCY},FV:{method:"fv",parameters:[{argumentType:Qk.NUMBER},{argumentType:Qk.NUMBER},{argumentType:Qk.NUMBER},{argumentType:Qk.NUMBER,defaultValue:0},{argumentType:Qk.NUMBER,defaultValue:0}],returnNumberType:WD.NUMBER_CURRENCY},CUMIPMT:{method:"cumipmt",parameters:[{argumentType:Qk.NUMBER,greaterThan:0},{argumentType:Qk.NUMBER,greaterThan:0},{argumentType:Qk.NUMBER,greaterThan:0},{argumentType:Qk.INTEGER,minValue:1},{argumentType:Qk.INTEGER,minValue:1},{argumentType:Qk.INTEGER,minValue:0,maxValue:1}],returnNumberType:WD.NUMBER_CURRENCY},CUMPRINC:{method:"cumprinc",parameters:[{argumentType:Qk.NUMBER,greaterThan:0},{argumentType:Qk.NUMBER,greaterThan:0},{argumentType:Qk.NUMBER,greaterThan:0},{argumentType:Qk.INTEGER,minValue:1},{argumentType:Qk.INTEGER,minValue:1},{argumentType:Qk.INTEGER,minValue:0,maxValue:1}],returnNumberType:WD.NUMBER_CURRENCY},DB:{method:"db",parameters:[{argumentType:Qk.NUMBER,minValue:0},{argumentType:Qk.NUMBER,minValue:0},{argumentType:Qk.INTEGER,minValue:0},{argumentType:Qk.INTEGER,minValue:0},{argumentType:Qk.INTEGER,minValue:1,maxValue:12,defaultValue:12}],returnNumberType:WD.NUMBER_CURRENCY},DDB:{method:"ddb",parameters:[{argumentType:Qk.NUMBER,minValue:0},{argumentType:Qk.NUMBER,minValue:0},{argumentType:Qk.INTEGER,minValue:0},{argumentType:Qk.NUMBER,minValue:0},{argumentType:Qk.NUMBER,greaterThan:0,defaultValue:2}],returnNumberType:WD.NUMBER_CURRENCY},DOLLARDE:{method:"dollarde",parameters:[{argumentType:Qk.NUMBER},{argumentType:Qk.NUMBER,minValue:0}]},DOLLARFR:{method:"dollarfr",parameters:[{argumentType:Qk.NUMBER},{argumentType:Qk.NUMBER,minValue:0}]},EFFECT:{method:"effect",parameters:[{argumentType:Qk.NUMBER,minValue:0},{argumentType:Qk.NUMBER,minValue:1}],returnNumberType:WD.NUMBER_PERCENT},ISPMT:{method:"ispmt",parameters:[{argumentType:Qk.NUMBER},{argumentType:Qk.NUMBER},{argumentType:Qk.NUMBER},{argumentType:Qk.NUMBER}]},NOMINAL:{method:"nominal",parameters:[{argumentType:Qk.NUMBER,minValue:0},{argumentType:Qk.NUMBER,minValue:1}],returnNumberType:WD.NUMBER_PERCENT},NPER:{method:"nper",parameters:[{argumentType:Qk.NUMBER},{argumentType:Qk.NUMBER},{argumentType:Qk.NUMBER},{argumentType:Qk.NUMBER,defaultValue:0},{argumentType:Qk.NUMBER,defaultValue:0}]},PV:{method:"pv",parameters:[{argumentType:Qk.NUMBER},{argumentType:Qk.NUMBER},{argumentType:Qk.NUMBER},{argumentType:Qk.NUMBER,defaultValue:0},{argumentType:Qk.NUMBER,defaultValue:0}],returnNumberType:WD.NUMBER_CURRENCY},RATE:{method:"rate",parameters:[{argumentType:Qk.NUMBER,greaterThan:0},{argumentType:Qk.NUMBER},{argumentType:Qk.NUMBER},{argumentType:Qk.NUMBER,defaultValue:0},{argumentType:Qk.NUMBER,defaultValue:0},{argumentType:Qk.NUMBER,defaultValue:.1}],returnNumberType:WD.NUMBER_PERCENT},RRI:{method:"rri",parameters:[{argumentType:Qk.NUMBER,greaterThan:0},{argumentType:Qk.NUMBER},{argumentType:Qk.NUMBER}],returnNumberType:WD.NUMBER_PERCENT},SLN:{method:"sln",parameters:[{argumentType:Qk.NUMBER},{argumentType:Qk.NUMBER},{argumentType:Qk.NUMBER}],returnNumberType:WD.NUMBER_CURRENCY},SYD:{method:"syd",parameters:[{argumentType:Qk.NUMBER},{argumentType:Qk.NUMBER},{argumentType:Qk.NUMBER,greaterThan:0},{argumentType:Qk.NUMBER,greaterThan:0}],returnNumberType:WD.NUMBER_CURRENCY},TBILLEQ:{method:"tbilleq",parameters:[{argumentType:Qk.NUMBER,minValue:0},{argumentType:Qk.NUMBER,minValue:0},{argumentType:Qk.NUMBER,greaterThan:0}],returnNumberType:WD.NUMBER_PERCENT},TBILLPRICE:{method:"tbillprice",parameters:[{argumentType:Qk.NUMBER,minValue:0},{argumentType:Qk.NUMBER,minValue:0},{argumentType:Qk.NUMBER,greaterThan:0}],returnNumberType:WD.NUMBER_CURRENCY},TBILLYIELD:{method:"tbillyield",parameters:[{argumentType:Qk.NUMBER,minValue:0},{argumentType:Qk.NUMBER,minValue:0},{argumentType:Qk.NUMBER,greaterThan:0}],returnNumberType:WD.NUMBER_PERCENT},FVSCHEDULE:{method:"fvschedule",parameters:[{argumentType:Qk.NUMBER},{argumentType:Qk.RANGE}],returnNumberType:WD.NUMBER_CURRENCY},NPV:{method:"npv",parameters:[{argumentType:Qk.NUMBER},{argumentType:Qk.ANY}],repeatLastArgs:1,returnNumberType:WD.NUMBER_CURRENCY},MIRR:{method:"mirr",parameters:[{argumentType:Qk.RANGE},{argumentType:Qk.NUMBER},{argumentType:Qk.NUMBER}],returnNumberType:WD.NUMBER_PERCENT},PDURATION:{method:"pduration",parameters:[{argumentType:Qk.NUMBER,greaterThan:0},{argumentType:Qk.NUMBER,greaterThan:0},{argumentType:Qk.NUMBER,greaterThan:0}]},XNPV:{method:"xnpv",parameters:[{argumentType:Qk.NUMBER,greaterThan:-1},{argumentType:Qk.RANGE},{argumentType:Qk.RANGE}]}};class fj extends Zk{formulatext(e,t){return this.runFunctionWithReferenceArgument(e.args,t,this.metadata("FORMULATEXT"),(()=>new pk(XU.NA,BH.WrongArgNumber)),(e=>{var t;return null!==(t=this.serialization.getCellFormula(e))&&void 0!==t?t:new pk(XU.NA,BH.Formula)}))}}fj.implementedFunctions={FORMULATEXT:{method:"formulatext",parameters:[{argumentType:Qk.NOERROR}],doesNotNeedArgumentsToBeComputed:!0,isDependentOnSheetStructureChange:!0,vectorizationForbidden:!0}};
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
class yj extends Zk{hyperlink(e,t){return this.runFunction(e.args,t,this.metadata("HYPERLINK"),((t,r)=>(e.hyperlink=t,null!=r?r:t)))}}yj.implementedFunctions={HYPERLINK:{method:"hyperlink",parameters:[{argumentType:Qk.STRING},{argumentType:Qk.STRING,optionalArg:!0}]}};
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
class wj extends Zk{isbinary(e,t){return this.runFunction(e.args,t,this.metadata("ISBINARY"),(e=>/^[01]{1,10}$/.test(e)))}iserr(e,t){return this.runFunction(e.args,t,this.metadata("ISERR"),(e=>e instanceof pk&&e.type!==XU.NA))}iserror(e,t){return this.runFunction(e.args,t,this.metadata("ISERROR"),(e=>e instanceof pk))}isformula(e,t){return this.runFunctionWithReferenceArgument(e.args,t,this.metadata("ISFORMULA"),(()=>new pk(XU.NA,BH.WrongArgNumber)),(e=>this.dependencyGraph.addressMapping.getCell(e)instanceof FU))}isblank(e,t){return this.runFunction(e.args,t,this.metadata("ISBLANK"),(e=>e===xD))}isna(e,t){return this.runFunction(e.args,t,this.metadata("ISNA"),(e=>e instanceof pk&&e.type==XU.NA))}isnumber(e,t){return this.runFunction(e.args,t,this.metadata("ISNUMBER"),BD)}islogical(e,t){return this.runFunction(e.args,t,this.metadata("ISLOGICAL"),(e=>"boolean"==typeof e))}isref(e,t){return this.runFunction(e.args,t,this.metadata("ISREF"),(e=>e instanceof pk&&(e.type==XU.REF||e.type==XU.CYCLE)))}istext(e,t){return this.runFunction(e.args,t,this.metadata("ISTEXT"),(e=>"string"==typeof e))}isnontext(e,t){return this.runFunction(e.args,t,this.metadata("ISNONTEXT"),(e=>!("string"==typeof e)))}column(e,t){return this.runFunctionWithReferenceArgument(e.args,t,this.metadata("COLUMN"),(()=>t.formulaAddress.col+1),(e=>e.col+1))}columns(e,t){if(1!==e.args.length)return new pk(XU.NA,BH.WrongArgNumber);if(e.args.some((e=>e.type===IH.EMPTY)))return new pk(XU.NUM,BH.EmptyArg);let r=e.args[0];for(;r.type===IH.PARENTHESIS;)r=r.expression;if(r.type===IH.CELL_RANGE||r.type===IH.COLUMN_RANGE)return r.end.col-r.start.col+1;if(r.type===IH.CELL_REFERENCE)return 1;if(r.type===IH.ROW_RANGE)return this.config.maxColumns;{const e=this.evaluateAst(r,t);return e instanceof zD?e.width():e instanceof pk?e:1}}row(e,t){return this.runFunctionWithReferenceArgument(e.args,t,this.metadata("ROW"),(()=>t.formulaAddress.row+1),(e=>e.row+1))}rows(e,t){if(1!==e.args.length)return new pk(XU.NA,BH.WrongArgNumber);if(e.args.some((e=>e.type===IH.EMPTY)))return new pk(XU.NUM,BH.EmptyArg);let r=e.args[0];for(;r.type===IH.PARENTHESIS;)r=r.expression;if(r.type===IH.CELL_RANGE||r.type===IH.ROW_RANGE)return r.end.row-r.start.row+1;if(r.type===IH.CELL_REFERENCE)return 1;if(r.type===IH.COLUMN_RANGE)return this.config.maxRows;{const e=this.evaluateAst(r,t);return e instanceof zD?e.height():e instanceof pk?e:1}}index(e,t){return this.runFunction(e.args,t,this.metadata("INDEX"),((e,t,r)=>{var n,o,i,s,a,l;return r<1||t<1?new pk(XU.VALUE,BH.LessThanOne):r>e.width()||t>e.height()?new pk(XU.NUM,BH.ValueLarge):null!==(l=null!==(i=null===(o=null===(n=null==e?void 0:e.data)||void 0===n?void 0:n[t-1])||void 0===o?void 0:o[r-1])&&void 0!==i?i:null===(a=null===(s=null==e?void 0:e.data)||void 0===s?void 0:s[0])||void 0===a?void 0:a[0])&&void 0!==l?l:new pk(XU.VALUE,BH.CellRangeExpected)}))}na(e,t){return new pk(XU.NA)}sheet(e,t){return this.runFunctionWithReferenceArgument(e.args,t,this.metadata("SHEET"),(()=>t.formulaAddress.sheet+1),(e=>e.sheet+1),(e=>{const t=this.dependencyGraph.sheetMapping.get(e);return void 0!==t?t+1:new pk(XU.NA,BH.SheetRef)}))}sheets(e,t){return this.runFunctionWithReferenceArgument(e.args,t,this.metadata("SHEETS"),(()=>this.dependencyGraph.sheetMapping.numberOfSheets()),(()=>1),(()=>new pk(XU.VALUE,BH.CellRefExpected)))}}wj.implementedFunctions={COLUMN:{method:"column",parameters:[{argumentType:Qk.NOERROR,optionalArg:!0}],isDependentOnSheetStructureChange:!0,doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},COLUMNS:{method:"columns",parameters:[{argumentType:Qk.RANGE}],isDependentOnSheetStructureChange:!0,doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},ISBINARY:{method:"isbinary",parameters:[{argumentType:Qk.STRING}]},ISERR:{method:"iserr",parameters:[{argumentType:Qk.SCALAR}]},ISFORMULA:{method:"isformula",parameters:[{argumentType:Qk.NOERROR}],doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},ISNA:{method:"isna",parameters:[{argumentType:Qk.SCALAR}]},ISREF:{method:"isref",parameters:[{argumentType:Qk.SCALAR}],vectorizationForbidden:!0},ISERROR:{method:"iserror",parameters:[{argumentType:Qk.SCALAR}]},ISBLANK:{method:"isblank",parameters:[{argumentType:Qk.SCALAR}]},ISNUMBER:{method:"isnumber",parameters:[{argumentType:Qk.SCALAR}]},ISLOGICAL:{method:"islogical",parameters:[{argumentType:Qk.SCALAR}]},ISTEXT:{method:"istext",parameters:[{argumentType:Qk.SCALAR}]},ISNONTEXT:{method:"isnontext",parameters:[{argumentType:Qk.SCALAR}]},INDEX:{method:"index",parameters:[{argumentType:Qk.RANGE},{argumentType:Qk.NUMBER},{argumentType:Qk.NUMBER,defaultValue:1}]},NA:{method:"na",parameters:[]},ROW:{method:"row",parameters:[{argumentType:Qk.NOERROR,optionalArg:!0}],isDependentOnSheetStructureChange:!0,doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},ROWS:{method:"rows",parameters:[{argumentType:Qk.RANGE}],isDependentOnSheetStructureChange:!0,doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},SHEET:{method:"sheet",parameters:[{argumentType:Qk.STRING}],doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},SHEETS:{method:"sheets",parameters:[{argumentType:Qk.STRING}],doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0}};
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
class Ej extends Zk{iseven(e,t){return this.runFunction(e.args,t,this.metadata("ISEVEN"),(e=>e%2==0))}}Ej.implementedFunctions={ISEVEN:{method:"iseven",parameters:[{argumentType:Qk.NUMBER}]}};
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
class vj extends Zk{isodd(e,t){return this.runFunction(e.args,t,this.metadata("ISODD"),(e=>e%2==1))}}vj.implementedFunctions={ISODD:{method:"isodd",parameters:[{argumentType:Qk.NUMBER}]}};
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
class Rj extends Zk{log10(e,t){return this.runFunction(e.args,t,this.metadata("LOG10"),Math.log10)}log(e,t){return this.runFunction(e.args,t,this.metadata("LOG"),((e,t)=>Math.log(e)/Math.log(t)))}ln(e,t){return this.runFunction(e.args,t,this.metadata("LN"),Math.log)}}Rj.implementedFunctions={LOG10:{method:"log10",parameters:[{argumentType:Qk.NUMBER}]},LOG:{method:"log",parameters:[{argumentType:Qk.NUMBER,greaterThan:0},{argumentType:Qk.NUMBER,defaultValue:10,greaterThan:0}]},LN:{method:"ln",parameters:[{argumentType:Qk.NUMBER}]}};
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
const Sj=parseFloat(Math.PI.toFixed(14));class Tj extends Zk{pi(e,t){return this.runFunction(e.args,t,this.metadata("PI"),(()=>Sj))}sqrtpi(e,t){return this.runFunction(e.args,t,this.metadata("SQRTPI"),(e=>Math.sqrt(Sj*e)))}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
function Cj(e,t){return new Jk(t.width,e.height)}function bj(e,t,r){return new Jk(1+(e.width-t)/r,1+(e.height-t)/r)}Tj.implementedFunctions={PI:{method:"pi",parameters:[]},SQRTPI:{method:"sqrtpi",parameters:[{argumentType:Qk.NUMBER,minValue:0}]}};class Nj extends Zk{mmult(e,t){return this.runFunction(e.args,t,this.metadata("MMULT"),((e,t)=>{if(!e.hasOnlyNumbers()||!t.hasOnlyNumbers())return new pk(XU.VALUE,BH.NumberRange);if(t.height()!==e.width())return new pk(XU.VALUE,BH.ArrayDimensions);const r=Cj(e.size,t.size),n=this.createKernel((function(e,t,r){let n=0;for(let o=0;o<r;++o)n+=e[this.thread.y][o]*t[o][this.thread.x];return n}),r)(e.rawNumbers(),t.rawNumbers(),e.width());return zD.onlyNumbers(n)}))}mmultArraySize(e,t){if(2!==e.args.length)return Jk.error();const r=this.metadata("MMULT"),n=e.args.map((e=>{var n;return this.arraySizeForAst(e,new Mk(t.formulaAddress,t.arraysFlag||null!==(n=null==r?void 0:r.arrayFunction)&&void 0!==n&&n))})),[o,i]=n;return Cj(o,i)}maxpool(e,t){return this.runFunction(e.args,t,this.metadata("MAXPOOL"),((e,t,r=t)=>{if(!e.hasOnlyNumbers())return new pk(XU.VALUE,BH.NumberRange);const n=bj(e.size,t,r),o=this.createKernel((function(e,t,r){const n=this.thread.x*r,o=this.thread.y*r;let i=e[o][n];for(let s=0;s<t;s++)for(let r=0;r<t;r++)i=Math.max(i,e[o+s][n+r]);return i}),n)(e.rawNumbers(),t,r);return zD.onlyNumbers(o)}))}medianpool(e,t){return this.runFunction(e.args,t,this.metadata("MEDIANPOOL"),((e,t,r=t)=>{if(!e.hasOnlyNumbers())return new pk(XU.VALUE,BH.NumberRange);const n=bj(e.size,t,r),o=this.createKernel((function(e,t,r){const n=this.thread.x*r,o=this.thread.y*r;let i=e[o][n];for(let c=0;c<t;c++)for(let r=0;r<t;r++)i=Math.max(i,e[o+c][n+r]);let s=e[o][n];for(let c=0;c<t;c++)for(let r=0;r<t;r++)s=Math.min(s,e[o+c][n+r]);const a=t*t;let l=s,u=i,h=42;for(let c=0;c<32;c++){const r=(l+u)/2;let i=0;for(let s=0;s<t;s++)for(let a=0;a<t;a++)e[o+s][n+a]>r&&i++;if(t%2==0){if(i===a/2){h=r;break}i>a/2?l=r:u=r}else{if(i===(a-1)/2){h=r;break}i>(a-1)/2?l=r:u=r}}return h}),n)(e.rawNumbers(),t,r);return zD.onlyNumbers(o)}))}maxpoolArraySize(e,t){if(e.args.length<2||e.args.length>3)return Jk.error();const r=this.metadata("MAXPOOL"),n=e.args.map((e=>{var n;return this.arraySizeForAst(e,new Mk(t.formulaAddress,t.arraysFlag||null!==(n=null==r?void 0:r.arrayFunction)&&void 0!==n&&n))}))[0],o=e.args[1];let i;i=o.type===IH.NUMBER?o.value:1;let s=i;if(3===e.args.length){const t=e.args[2];s=t.type===IH.NUMBER?t.value:1}return i>n.width||i>n.height||s>i||(n.width-i)%s!=0||(n.height-i)%s!=0?Jk.error():bj(n,i,s)}medianpoolArraySize(e,t){return this.maxpoolArraySize(e,t)}transpose(e,t){return this.runFunction(e.args,t,this.metadata("TRANSPOSE"),(e=>{const t=e.rawData(),r=e.size,n=[];for(let o=0;o<r.width;++o){n[o]=[];for(let e=0;e<r.height;++e)n[o][e]=t[e][o]}return zD.onlyValues(n)}))}transposeArraySize(e,t){if(1!==e.args.length)return Jk.error();const r=this.metadata("TRANSPOSE"),n=e.args.map((e=>{var n;return this.arraySizeForAst(e,new Mk(t.formulaAddress,t.arraysFlag||null!==(n=null==r?void 0:r.arrayFunction)&&void 0!==n&&n))})),[o]=n;return new Jk(o.height,o.width)}createKernel(e,t){return function(...r){const n=[];for(let o=0;o<t.height;++o){n.push([]);for(let i=0;i<t.width;++i)n[o][i]=e.apply({thread:{x:i,y:o}},r)}return n}}}Nj.implementedFunctions={MMULT:{method:"mmult",arraySizeMethod:"mmultArraySize",parameters:[{argumentType:Qk.RANGE},{argumentType:Qk.RANGE}],vectorizationForbidden:!0},TRANSPOSE:{method:"transpose",arraySizeMethod:"transposeArraySize",parameters:[{argumentType:Qk.RANGE}],vectorizationForbidden:!0},MAXPOOL:{method:"maxpool",arraySizeMethod:"maxpoolArraySize",parameters:[{argumentType:Qk.RANGE},{argumentType:Qk.NUMBER},{argumentType:Qk.NUMBER,optionalArg:!0}],vectorizationForbidden:!0},MEDIANPOOL:{method:"medianpool",arraySizeMethod:"medianpoolArraySize",parameters:[{argumentType:Qk.RANGE},{argumentType:Qk.NUMBER},{argumentType:Qk.NUMBER,optionalArg:!0}],vectorizationForbidden:!0}};
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
class Aj extends Zk{median(e,t){return this.runFunction(e.args,t,this.metadata("MEDIAN"),((...e)=>{const t=this.arithmeticHelper.coerceNumbersExactRanges(e);return t instanceof pk?t:0===t.length?new pk(XU.NUM,BH.OneValue):(t.sort(((e,t)=>e-t)),t.length%2==0?(t[t.length/2-1]+t[t.length/2])/2:t[Math.floor(t.length/2)])}))}large(e,t){return this.runFunction(e.args,t,this.metadata("LARGE"),((e,t)=>{const r=this.arithmeticHelper.manyToExactNumbers(e.valuesFromTopLeftCorner());return r instanceof pk?r:(r.sort(((e,t)=>e-t)),(t=Math.trunc(t))>r.length?new pk(XU.NUM,BH.ValueLarge):r[r.length-t])}))}small(e,t){return this.runFunction(e.args,t,this.metadata("SMALL"),((e,t)=>{const r=this.arithmeticHelper.manyToExactNumbers(e.valuesFromTopLeftCorner());return r instanceof pk?r:(r.sort(((e,t)=>e-t)),(t=Math.trunc(t))>r.length?new pk(XU.NUM,BH.ValueLarge):r[t-1])}))}}Aj.implementedFunctions={MEDIAN:{method:"median",parameters:[{argumentType:Qk.ANY}],repeatLastArgs:1},LARGE:{method:"large",parameters:[{argumentType:Qk.RANGE},{argumentType:Qk.NUMBER,minValue:1}]},SMALL:{method:"small",parameters:[{argumentType:Qk.RANGE},{argumentType:Qk.NUMBER,minValue:1}]}};
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
class Ij extends Zk{mod(e,t){return this.runFunction(e.args,t,this.metadata("MOD"),((e,t)=>0===t?new pk(XU.DIV_BY_ZERO):e%t))}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
function Oj(e){return BD(e)&&!Number.isFinite(LD(e))?0:e}Ij.implementedFunctions={MOD:{method:"mod",parameters:[{argumentType:Qk.NUMBER},{argumentType:Qk.NUMBER}]}};class Mj{constructor(e,t,r){this.sumsq=e,this.sum=t,this.count=r}static single(e){return new Mj(e*e,e,1)}compose(e){return new Mj(this.sumsq+e.sumsq,this.sum+e.sum,this.count+e.count)}averageValue(){return this.count>0?this.sum/this.count:void 0}varSValue(){return this.count>1?(this.sumsq-this.sum*this.sum/this.count)/(this.count-1):void 0}varPValue(){return this.count>0?(this.sumsq-this.sum*this.sum/this.count)/this.count:void 0}}Mj.empty=new Mj(0,0,0);class _j extends Zk{constructor(){super(...arguments),this.addWithEpsilonRaw=(e,t)=>this.arithmeticHelper.addWithEpsilonRaw(e,t)}sum(e,t){return this.doSum(e.args,t)}sumsq(e,t){return this.reduce(e.args,t,0,"SUMSQ",this.addWithEpsilonRaw,(e=>Math.pow(LD(e),2)),xj)}max(e,t){return this.doMax(e.args,t)}maxa(e,t){return Oj(this.reduce(e.args,t,Number.NEGATIVE_INFINITY,"MAXA",((e,t)=>Math.max(e,t)),LD,Lj))}min(e,t){return this.doMin(e.args,t)}mina(e,t){return Oj(this.reduce(e.args,t,Number.POSITIVE_INFINITY,"MINA",((e,t)=>Math.min(e,t)),LD,Lj))}count(e,t){return this.doCount(e.args,t)}counta(e,t){return this.doCounta(e.args,t)}average(e,t){return this.doAverage(e.args,t)}averagea(e,t){var r;const n=this.reduce(e.args,t,Mj.empty,"_AGGREGATE_A",((e,t)=>e.compose(t)),(e=>Mj.single(LD(e))),Lj);return n instanceof pk?n:null!==(r=n.averageValue())&&void 0!==r?r:new pk(XU.DIV_BY_ZERO)}vars(e,t){return this.doVarS(e.args,t)}varp(e,t){return this.doVarP(e.args,t)}vara(e,t){var r;const n=this.reduceAggregateA(e.args,t);return n instanceof pk?n:null!==(r=n.varSValue())&&void 0!==r?r:new pk(XU.DIV_BY_ZERO)}varpa(e,t){var r;const n=this.reduceAggregateA(e.args,t);return n instanceof pk?n:null!==(r=n.varPValue())&&void 0!==r?r:new pk(XU.DIV_BY_ZERO)}stdevs(e,t){return this.doStdevS(e.args,t)}stdevp(e,t){return this.doStdevP(e.args,t)}stdeva(e,t){const r=this.reduceAggregateA(e.args,t);if(r instanceof pk)return r;{const e=r.varSValue();return void 0===e?new pk(XU.DIV_BY_ZERO):Math.sqrt(e)}}stdevpa(e,t){const r=this.reduceAggregateA(e.args,t);if(r instanceof pk)return r;{const e=r.varPValue();return void 0===e?new pk(XU.DIV_BY_ZERO):Math.sqrt(e)}}product(e,t){return this.doProduct(e.args,t)}subtotal(e,t){if(e.args.length<2)return new pk(XU.NA,BH.WrongArgNumber);const r=this.coerceToType(this.evaluateAst(e.args[0],t),{argumentType:Qk.NUMBER},t),n=e.args.slice(1);switch(r){case 1:case 101:return this.doAverage(n,t);case 2:case 102:return this.doCount(n,t);case 3:case 103:return this.doCounta(n,t);case 4:case 104:return this.doMax(n,t);case 5:case 105:return this.doMin(n,t);case 6:case 106:return this.doProduct(n,t);case 7:case 107:return this.doStdevS(n,t);case 8:case 108:return this.doStdevP(n,t);case 9:case 109:return this.doSum(n,t);case 10:case 110:return this.doVarS(n,t);case 11:case 111:return this.doVarP(n,t);default:return new pk(XU.VALUE,BH.BadMode)}}reduceAggregate(e,t){return this.reduce(e,t,Mj.empty,"_AGGREGATE",((e,t)=>e.compose(t)),(e=>Mj.single(LD(e))),xj)}reduceAggregateA(e,t){return this.reduce(e,t,Mj.empty,"_AGGREGATE_A",((e,t)=>e.compose(t)),(e=>Mj.single(LD(e))),Lj)}doAverage(e,t){var r;const n=this.reduceAggregate(e,t);return n instanceof pk?n:null!==(r=n.averageValue())&&void 0!==r?r:new pk(XU.DIV_BY_ZERO)}doVarS(e,t){var r;const n=this.reduceAggregate(e,t);return n instanceof pk?n:null!==(r=n.varSValue())&&void 0!==r?r:new pk(XU.DIV_BY_ZERO)}doVarP(e,t){var r;const n=this.reduceAggregate(e,t);return n instanceof pk?n:null!==(r=n.varPValue())&&void 0!==r?r:new pk(XU.DIV_BY_ZERO)}doStdevS(e,t){const r=this.reduceAggregate(e,t);if(r instanceof pk)return r;{const e=r.varSValue();return void 0===e?new pk(XU.DIV_BY_ZERO):Math.sqrt(e)}}doStdevP(e,t){const r=this.reduceAggregate(e,t);if(r instanceof pk)return r;{const e=r.varPValue();return void 0===e?new pk(XU.DIV_BY_ZERO):Math.sqrt(e)}}doCount(e,t){return this.reduce(e,t,0,"COUNT",((e,t)=>e+t),LD,(e=>BD(e)?1:0))}doCounta(e,t){return this.reduce(e,t,0,"COUNTA",((e,t)=>e+t),LD,(e=>e===xD?0:1))}doMax(e,t){return Oj(this.reduce(e,t,Number.NEGATIVE_INFINITY,"MAX",((e,t)=>Math.max(e,t)),LD,xj))}doMin(e,t){return Oj(this.reduce(e,t,Number.POSITIVE_INFINITY,"MIN",((e,t)=>Math.min(e,t)),LD,xj))}doSum(e,t){return this.reduce(e,t,0,"SUM",this.addWithEpsilonRaw,LD,xj)}doProduct(e,t){return this.reduce(e,t,1,"PRODUCT",((e,t)=>e*t),LD,xj)}reduce(e,t,r,n,o,i,s){return e.length<1?new pk(XU.NA,BH.WrongArgNumber):e.reduce(((e,a)=>{if(e instanceof pk)return e;if(a.type===IH.CELL_RANGE||a.type===IH.COLUMN_RANGE||a.type===IH.ROW_RANGE){const l=this.evaluateRange(a,t,r,n,o,i,s);return l instanceof pk?l:o(l,e)}let l;if(l=this.evaluateAst(a,t),l instanceof zD){const t=Array.from(l.valuesFromTopLeftCorner()).map(s).filter((e=>void 0!==e));return t.map((e=>e instanceof pk?e:i(e))).reduce(((e,t)=>e instanceof pk?e:t instanceof pk?t:o(e,t)),e)}if(a.type===IH.CELL_REFERENCE){if(l=s(l),void 0===l)return e}else if(l=this.coerceScalarToNumberOrError(l),l=s(l),void 0===l)return e;return l instanceof pk?l:o(e,i(l))}),r)}evaluateRange(e,t,r,n,o,i,s){let a;try{a=Ak.fromAst(e,t.formulaAddress)}catch(h){if(h instanceof oU)return new pk(XU.REF,BH.RangeManySheets);throw h}const l=this.dependencyGraph.getRange(a.start,a.end);if(void 0===l)throw new Error("Range does not exists in graph");let u=l.getFunctionValue(n);if(void 0===u){u=this.getRangeValues(n,a,l,i,s).reduce(((e,t)=>e instanceof pk?e:t instanceof pk?t:o(e,t)),r),l.setFunctionValue(n,u)}return u}getRangeValues(e,t,r,n,o){const i=[],{smallerRangeVertex:s,restRange:a}=this.dependencyGraph.rangeMapping.findSmallerRange(t);let l;if(void 0!==s&&this.dependencyGraph.existsEdge(s,r)){const t=s.getFunctionValue(e);if(void 0!==t)i.push(t);else for(const e of s.range.addresses(this.dependencyGraph)){const t=o(this.dependencyGraph.getScalarValue(e));t instanceof pk?i.push(t):void 0!==t&&i.push(n(t))}l=a}else l=t;for(const u of l.addresses(this.dependencyGraph)){const e=o(this.dependencyGraph.getScalarValue(u));e instanceof pk?i.push(e):void 0!==e&&i.push(n(e))}return i}}function xj(e){return BD(e)||e instanceof pk?e:void 0}function Lj(e){return"boolean"==typeof e?Pk(e):BD(e)||e instanceof pk?e:"string"==typeof e?0:void 0}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */_j.implementedFunctions={SUM:{method:"sum",parameters:[{argumentType:Qk.ANY}],repeatLastArgs:1},SUMSQ:{method:"sumsq",parameters:[{argumentType:Qk.ANY}],repeatLastArgs:1},MAX:{method:"max",parameters:[{argumentType:Qk.ANY}],repeatLastArgs:1},MIN:{method:"min",parameters:[{argumentType:Qk.ANY}],repeatLastArgs:1},MAXA:{method:"maxa",parameters:[{argumentType:Qk.ANY}],repeatLastArgs:1},MINA:{method:"mina",parameters:[{argumentType:Qk.ANY}],repeatLastArgs:1},COUNT:{method:"count",parameters:[{argumentType:Qk.ANY}],repeatLastArgs:1},COUNTA:{method:"counta",parameters:[{argumentType:Qk.ANY}],repeatLastArgs:1},AVERAGE:{method:"average",parameters:[{argumentType:Qk.ANY}],repeatLastArgs:1},AVERAGEA:{method:"averagea",parameters:[{argumentType:Qk.ANY}],repeatLastArgs:1},PRODUCT:{method:"product",parameters:[{argumentType:Qk.ANY}],repeatLastArgs:1},"VAR.S":{method:"vars",parameters:[{argumentType:Qk.ANY}],repeatLastArgs:1},"VAR.P":{method:"varp",parameters:[{argumentType:Qk.ANY}],repeatLastArgs:1},VARA:{method:"vara",parameters:[{argumentType:Qk.ANY}],repeatLastArgs:1},VARPA:{method:"varpa",parameters:[{argumentType:Qk.ANY}],repeatLastArgs:1},"STDEV.S":{method:"stdevs",parameters:[{argumentType:Qk.ANY}],repeatLastArgs:1},"STDEV.P":{method:"stdevp",parameters:[{argumentType:Qk.ANY}],repeatLastArgs:1},STDEVA:{method:"stdeva",parameters:[{argumentType:Qk.ANY}],repeatLastArgs:1},STDEVPA:{method:"stdevpa",parameters:[{argumentType:Qk.ANY}],repeatLastArgs:1},SUBTOTAL:{method:"subtotal",parameters:[{argumentType:Qk.NUMBER},{argumentType:Qk.ANY}],repeatLastArgs:1}},_j.aliases={VAR:"VAR.S",VARP:"VAR.P",STDEV:"STDEV.S",STDEVP:"STDEV.P",VARS:"VAR.S",STDEVS:"STDEV.S"};class Fj extends Zk{power(e,t){return this.runFunction(e.args,t,this.metadata("POWER"),Math.pow)}}Fj.implementedFunctions={POWER:{method:"power",parameters:[{argumentType:Qk.NUMBER},{argumentType:Qk.NUMBER}]}};
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
class Pj extends Zk{radians(e,t){return this.runFunction(e.args,t,this.metadata("RADIANS"),(e=>e*(Math.PI/180)))}}Pj.implementedFunctions={RADIANS:{method:"radians",parameters:[{argumentType:Qk.NUMBER}]}};
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
const Vj=10;class Hj extends Zk{dec2bin(e,t){return this.runFunction(e.args,t,this.metadata("DEC2BIN"),((e,t)=>Uj(e,2,t)))}dec2oct(e,t){return this.runFunction(e.args,t,this.metadata("DEC2OCT"),((e,t)=>Uj(e,8,t)))}dec2hex(e,t){return this.runFunction(e.args,t,this.metadata("DEC2HEX"),((e,t)=>Uj(e,16,t)))}bin2dec(e,t){return this.runFunction(e.args,t,this.metadata("BIN2DEC"),(e=>{const t=Dj(e,2,Vj);return void 0===t?new pk(XU.NUM,BH.NotBinary):Gj(t,2)}))}bin2oct(e,t){return this.runFunction(e.args,t,this.metadata("BIN2OCT"),((e,t)=>{const r=Dj(e,2,Vj);return void 0===r?new pk(XU.NUM,BH.NotBinary):Uj(Gj(r,2),8,t)}))}bin2hex(e,t){return this.runFunction(e.args,t,this.metadata("BIN2HEX"),((e,t)=>{const r=Dj(e,2,Vj);return void 0===r?new pk(XU.NUM,BH.NotBinary):Uj(Gj(r,2),16,t)}))}oct2dec(e,t){return this.runFunction(e.args,t,this.metadata("OCT2DEC"),(e=>{const t=Dj(e,8,Vj);return void 0===t?new pk(XU.NUM,BH.NotOctal):Gj(t,8)}))}oct2bin(e,t){return this.runFunction(e.args,t,this.metadata("OCT2BIN"),((e,t)=>{const r=Dj(e,8,Vj);return void 0===r?new pk(XU.NUM,BH.NotOctal):Uj(Gj(r,8),2,t)}))}oct2hex(e,t){return this.runFunction(e.args,t,this.metadata("OCT2HEX"),((e,t)=>{const r=Dj(e,8,Vj);return void 0===r?new pk(XU.NUM,BH.NotOctal):Uj(Gj(r,8),16,t)}))}hex2dec(e,t){return this.runFunction(e.args,t,this.metadata("HEX2DEC"),(e=>{const t=Dj(e,16,Vj);return void 0===t?new pk(XU.NUM,BH.NotHex):Gj(t,16)}))}hex2bin(e,t){return this.runFunction(e.args,t,this.metadata("HEX2BIN"),((e,t)=>{const r=Dj(e,16,Vj);return void 0===r?new pk(XU.NUM,BH.NotHex):Uj(Gj(r,16),2,t)}))}hex2oct(e,t){return this.runFunction(e.args,t,this.metadata("HEX2OCT"),((e,t)=>{const r=Dj(e,16,Vj);return void 0===r?new pk(XU.NUM,BH.NotHex):Uj(Gj(r,16),8,t)}))}base(e,t){return this.runFunction(e.args,t,this.metadata("BASE"),Bj)}decimal(e,t){return this.runFunction(e.args,t,this.metadata("DECIMAL"),((e,t)=>{const r=Dj(e,t,255);return void 0===r?new pk(XU.NUM,BH.NotHex):parseInt(r,t)}))}}function Dj(e,t,r){const n="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ".substr(0,t),o=new RegExp(`^[${n}]+$`);if(!(e.length>r)&&o.test(e))return e}function Uj(e,t,r){if(e>function(e){return-kj(e)-1}(t))return new pk(XU.NUM,BH.ValueBaseLarge);if(e<kj(t))return new pk(XU.NUM,BH.ValueBaseSmall);const n=Wj(e,t);return void 0===r||e<0?n:n.length>r?new pk(XU.NUM,BH.ValueBaseLong):BB(n,r)}function kj(e){return-Math.pow(e,Vj)/2}function Bj(e,t,r){const n=Wj(e,t);return void 0!==r&&r>n.length?BB(n,r):n}function Wj(e,t){return(e+(e<0?Math.pow(t,Vj):0)).toString(t).toUpperCase()}function Gj(e,t){const r=parseInt(e,t),n=Math.pow(t,Vj);return r>=n/2?r-n:r}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */Hj.implementedFunctions={DEC2BIN:{method:"dec2bin",parameters:[{argumentType:Qk.NUMBER},{argumentType:Qk.NUMBER,optionalArg:!0,minValue:1,maxValue:10}]},DEC2OCT:{method:"dec2oct",parameters:[{argumentType:Qk.NUMBER},{argumentType:Qk.NUMBER,optionalArg:!0,minValue:1,maxValue:10}]},DEC2HEX:{method:"dec2hex",parameters:[{argumentType:Qk.NUMBER},{argumentType:Qk.NUMBER,optionalArg:!0,minValue:1,maxValue:10}]},BIN2DEC:{method:"bin2dec",parameters:[{argumentType:Qk.STRING}]},BIN2OCT:{method:"bin2oct",parameters:[{argumentType:Qk.STRING},{argumentType:Qk.NUMBER,optionalArg:!0,minValue:0,maxValue:Vj}]},BIN2HEX:{method:"bin2hex",parameters:[{argumentType:Qk.STRING},{argumentType:Qk.NUMBER,optionalArg:!0,minValue:0,maxValue:Vj}]},OCT2DEC:{method:"oct2dec",parameters:[{argumentType:Qk.STRING}]},OCT2BIN:{method:"oct2bin",parameters:[{argumentType:Qk.STRING},{argumentType:Qk.NUMBER,optionalArg:!0,minValue:0,maxValue:Vj}]},OCT2HEX:{method:"oct2hex",parameters:[{argumentType:Qk.STRING},{argumentType:Qk.NUMBER,optionalArg:!0,minValue:0,maxValue:Vj}]},HEX2DEC:{method:"hex2dec",parameters:[{argumentType:Qk.STRING}]},HEX2BIN:{method:"hex2bin",parameters:[{argumentType:Qk.STRING},{argumentType:Qk.NUMBER,optionalArg:!0,minValue:0,maxValue:Vj}]},HEX2OCT:{method:"hex2oct",parameters:[{argumentType:Qk.STRING},{argumentType:Qk.NUMBER,optionalArg:!0,minValue:0,maxValue:Vj}]},DECIMAL:{method:"decimal",parameters:[{argumentType:Qk.STRING},{argumentType:Qk.NUMBER,minValue:2,maxValue:36}]},BASE:{method:"base",parameters:[{argumentType:Qk.NUMBER,minValue:0},{argumentType:Qk.NUMBER,minValue:2,maxValue:36},{argumentType:Qk.NUMBER,optionalArg:!0,minValue:0,maxValue:255}]}};class jj extends Zk{rand(e,t){return this.runFunction(e.args,t,this.metadata("RAND"),Math.random)}randbetween(e,t){return this.runFunction(e.args,t,this.metadata("RANDBETWEEN"),((e,t)=>t<e?new pk(XU.NUM,BH.WrongOrder):((e=Math.ceil(e))===(t=Math.floor(t)+1)&&(t+=1),e+Math.floor(Math.random()*(t-e)))))}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
function zj(e){const t=Math.ceil(e);return t%2==1?t:t+1}function $j(e){const t=Math.ceil(e);return t%2==0?t:t+1}jj.implementedFunctions={RAND:{method:"rand",parameters:[],isVolatile:!0},RANDBETWEEN:{method:"randbetween",parameters:[{argumentType:Qk.NUMBER},{argumentType:Qk.NUMBER}],isVolatile:!0}};class Yj extends Zk{roundup(e,t){return this.runFunction(e.args,t,this.metadata("ROUNDDOWN"),((e,t)=>{const r=Math.pow(10,t);return e<0?-Math.ceil(-e*r)/r:Math.ceil(e*r)/r}))}rounddown(e,t){return this.runFunction(e.args,t,this.metadata("ROUNDDOWN"),((e,t)=>{const r=Math.pow(10,t);return e<0?-Math.floor(-e*r)/r:Math.floor(e*r)/r}))}round(e,t){return this.runFunction(e.args,t,this.metadata("ROUND"),((e,t)=>{const r=Math.pow(10,t);return e<0?-Math.round(-e*r)/r:Math.round(e*r)/r}))}intFunc(e,t){return this.runFunction(e.args,t,this.metadata("INT"),(e=>e<0?-Math.floor(-e):Math.floor(e)))}even(e,t){return this.runFunction(e.args,t,this.metadata("EVEN"),(e=>e<0?-$j(-e):$j(e)))}odd(e,t){return this.runFunction(e.args,t,this.metadata("ODD"),(e=>e<0?-zj(-e):zj(e)))}ceilingmath(e,t){return this.runFunction(e.args,t,this.metadata("CEILING.MATH"),((e,t,r)=>0===t||0===e?0:(t=Math.abs(t),1===r&&e<0&&(t=-t),Math.ceil(e/t)*t)))}ceiling(e,t){return this.runFunction(e.args,t,this.metadata("CEILING"),((e,t)=>0===e?0:0===t?new pk(XU.DIV_BY_ZERO):e>0&&t<0?new pk(XU.NUM,BH.DistinctSigns):Math.ceil(e/t)*t))}ceilingprecise(e,t){return this.runFunction(e.args,t,this.metadata("CEILING.PRECISE"),((e,t)=>0===t||0===e?0:(t=Math.abs(t),Math.ceil(e/t)*t)))}floormath(e,t){return this.runFunction(e.args,t,this.metadata("FLOOR.MATH"),((e,t,r)=>0===t||0===e?0:(t=Math.abs(t),1===r&&e<0&&(t*=-1),Math.floor(e/t)*t)))}floor(e,t){return this.runFunction(e.args,t,this.metadata("FLOOR"),((e,t)=>0===e?0:0===t?new pk(XU.DIV_BY_ZERO):e>0&&t<0?new pk(XU.NUM,BH.DistinctSigns):Math.floor(e/t)*t))}floorprecise(e,t){return this.runFunction(e.args,t,this.metadata("FLOOR.PRECISE"),((e,t)=>0===t||0===e?0:(t=Math.abs(t),Math.floor(e/t)*t)))}}Yj.implementedFunctions={ROUNDUP:{method:"roundup",parameters:[{argumentType:Qk.NUMBER},{argumentType:Qk.NUMBER,defaultValue:0}]},ROUNDDOWN:{method:"rounddown",parameters:[{argumentType:Qk.NUMBER},{argumentType:Qk.NUMBER,defaultValue:0}]},ROUND:{method:"round",parameters:[{argumentType:Qk.NUMBER},{argumentType:Qk.NUMBER,defaultValue:0}]},INT:{method:"intFunc",parameters:[{argumentType:Qk.NUMBER}]},EVEN:{method:"even",parameters:[{argumentType:Qk.NUMBER}]},ODD:{method:"odd",parameters:[{argumentType:Qk.NUMBER}]},"CEILING.MATH":{method:"ceilingmath",parameters:[{argumentType:Qk.NUMBER},{argumentType:Qk.NUMBER,defaultValue:1},{argumentType:Qk.NUMBER,defaultValue:0}]},CEILING:{method:"ceiling",parameters:[{argumentType:Qk.NUMBER},{argumentType:Qk.NUMBER}]},"CEILING.PRECISE":{method:"ceilingprecise",parameters:[{argumentType:Qk.NUMBER},{argumentType:Qk.NUMBER,defaultValue:1}]},"FLOOR.MATH":{method:"floormath",parameters:[{argumentType:Qk.NUMBER},{argumentType:Qk.NUMBER,defaultValue:1},{argumentType:Qk.NUMBER,defaultValue:0}]},FLOOR:{method:"floor",parameters:[{argumentType:Qk.NUMBER},{argumentType:Qk.NUMBER}]},"FLOOR.PRECISE":{method:"floorprecise",parameters:[{argumentType:Qk.NUMBER},{argumentType:Qk.NUMBER,defaultValue:1}]}},Yj.aliases={"ISO.CEILING":"CEILING.PRECISE",TRUNC:"ROUNDDOWN"};
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
class Xj extends Zk{sqrt(e,t){return this.runFunction(e.args,t,this.metadata("SQRT"),Math.sqrt)}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
function*Kj(){}function qj(e){const t=e[Symbol.iterator](),{done:r,value:n}=t.next();return r?{rest:Kj()}:{value:n,rest:t}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */Xj.implementedFunctions={SQRT:{method:"sqrt",parameters:[{argumentType:Qk.NUMBER}]}};class Qj{constructor(e,t,r,n,o){this.interpreter=e,this.cacheKey=t,this.reduceInitialValue=r,this.composeFunction=n,this.mapFunction=o,this.dependencyGraph=this.interpreter.dependencyGraph}compute(e,t){for(const o of t)if(!o.conditionRange.sameDimensionsAs(e))return new pk(XU.VALUE,BH.EqualLength);const r=this.tryToGetRangeVertexForRangeValue(e),n=t.map((e=>this.tryToGetRangeVertexForRangeValue(e.conditionRange)));if(r&&n.every((e=>void 0!==e))){const o=t.map((e=>e.criterionPackage.raw)).join(","),i=this.findAlreadyComputedValueInCache(r,this.cacheKey(t),o);if(void 0!==i)return this.interpreter.stats.incrementCriterionFunctionFullCacheUsed(),i;const s=this.buildNewCriterionCache(this.cacheKey(t),t.map((e=>e.conditionRange.range)),e.range);return s.has(o)||s.set(o,[this.evaluateRangeValue(e,t),t.map((e=>e.criterionPackage.lambda))]),r.setCriterionFunctionValues(this.cacheKey(t),s),n.forEach((e=>{void 0!==e&&e.addDependentCacheRange(r)})),s.get(o)[0]}return this.evaluateRangeValue(e,t)}tryToGetRangeVertexForRangeValue(e){const t=e.range;return void 0===t?void 0:this.dependencyGraph.getRange(t.start,t.end)}reduceFunction(e){let t=this.reduceInitialValue;for(const r of e)t=this.composeFunction(t,r);return t}findAlreadyComputedValueInCache(e,t,r){return e.getCriterionFunctionValue(t,r)}evaluateRangeValue(e,t){const r=t.map((e=>e.criterionPackage.lambda)),n=Array.from(e.valuesFromTopLeftCorner()).map(this.mapFunction)[Symbol.iterator](),o=ez(r,t.map((e=>e.conditionRange.iterateValuesFromTopLeftCorner())),n);return this.reduceFunction(o)}buildNewCriterionCache(e,t,r){const n=this.dependencyGraph.getRange(r.start,r.end),{smallerRangeVertex:o,restConditionRanges:i,restValuesRange:s}=((e,t,r)=>{if(r.end.row>r.start.row){const n=wk(r.end.sheet,r.end.col,r.end.row-1),o=e.getRange(r.start,n);if(void 0!==o)return{smallerRangeVertex:o,restValuesRange:r.withStart(wk(r.start.sheet,r.start.col,r.end.row)),restConditionRanges:t.map((e=>e.withStart(wk(e.start.sheet,e.start.col,e.end.row))))}}return{restValuesRange:r,restConditionRanges:t}})(this.dependencyGraph,t,r);let a;a=void 0!==o&&this.dependencyGraph.existsEdge(o,n)?o.getCriterionFunctionValues(e):new Map;const l=new Map;return a.forEach((([e,t],r)=>{const n=ez(t,i.map((e=>Jj(this.dependencyGraph,e))),Array.from(Jj(this.dependencyGraph,s)).map(this.mapFunction)[Symbol.iterator]()),o=this.composeFunction(e,this.reduceFunction(n));this.interpreter.stats.incrementCriterionFunctionPartialCacheUsed(),l.set(r,[o,t])})),l}}class Zj{constructor(e,t){this.conditionRange=e,this.criterionPackage=t}}function*Jj(e,t){for(const r of t.addresses(e))yield LD(e.getScalarValue(r))}function*ez(e,t,r){for(const n of r){const r=t.map((e=>qj(e)));if(!r.every((e=>Object.prototype.hasOwnProperty.call(e,"value"))))return;tz(r.map((e=>LD(e.value))),e).every((([e,t])=>t(e)))&&(yield n),t=r.map((e=>e.rest))}}function tz(e,t){const r=[];for(let n=0;n<Math.min(e.length,t.length);n++)r.push([e[n],t[n]]);return r}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class rz{constructor(e,t){this.sum=e,this.count=t}static single(e){return new rz(e,1)}compose(e){return new rz(this.sum+e.sum,this.count+e.count)}averageValue(){return this.count>0?this.sum/this.count:void 0}}function nz(e){return BD(e)&&!Number.isFinite(LD(e))?0:e}function oz(e){return e instanceof pk?e:BD(e)?LD(e):void 0}rz.empty=new rz(0,0);class iz extends Zk{sumif(e,t){const r="SUMIF";return this.runFunction(e.args,t,this.metadata(r),((e,t,n)=>this.computeConditionalAggregationFunction(null!=n?n:e,[e,t],r,0,((e,t)=>this.arithmeticHelper.nonstrictadd(e,t)),oz)))}sumifs(e,t){const r="SUMIFS";return this.runFunction(e.args,t,this.metadata(r),((e,...t)=>this.computeConditionalAggregationFunction(e,t,r,0,((e,t)=>this.arithmeticHelper.nonstrictadd(e,t)),oz)))}averageif(e,t){const r="AVERAGEIF";return this.runFunction(e.args,t,this.metadata(r),((e,t,n)=>{const o=this.computeConditionalAggregationFunction(null!=n?n:e,[e,t],r,rz.empty,((e,t)=>e.compose(t)),(e=>BD(e)?rz.single(LD(e)):rz.empty));return o instanceof pk?o:o.averageValue()||new pk(XU.DIV_BY_ZERO)}))}countif(e,t){const r="COUNTIF";return this.runFunction(e.args,t,this.metadata(r),((e,t)=>this.computeConditionalAggregationFunction(e,[e,t],r,0,((e,t)=>e+t),(()=>1))))}countifs(e,t){const r="COUNTIFS";return this.runFunction(e.args,t,this.metadata(r),((...e)=>this.computeConditionalAggregationFunction(e[0],e,r,0,((e,t)=>e+t),(()=>1))))}minifs(e,t){const r="MINIFS",n=(e,t)=>void 0===t||void 0===e?void 0===t?e:t:Math.min(e,t);return this.runFunction(e.args,t,this.metadata(r),((e,...t)=>nz(this.computeConditionalAggregationFunction(e,t,r,Number.POSITIVE_INFINITY,n,oz))))}maxifs(e,t){const r="MAXIFS",n=(e,t)=>void 0===t||void 0===e?void 0===t?e:t:Math.max(e,t);return this.runFunction(e.args,t,this.metadata(r),((e,...t)=>nz(this.computeConditionalAggregationFunction(e,t,r,Number.NEGATIVE_INFINITY,n,oz))))}computeConditionalAggregationFunction(e,t,r,n,o,i){const s=[];for(let a=0;a<t.length;a+=2){const e=t[a],r=this.interpreter.criterionBuilder.fromCellValue(t[a+1],this.arithmeticHelper);if(void 0===r)return new pk(XU.VALUE,BH.BadCriterion);s.push(new Zj(e,r))}return new Qj(this.interpreter,function(e){return t=>{const r=t.map((e=>`${e.conditionRange.range.sheet},${e.conditionRange.range.start.col},${e.conditionRange.range.start.row}`));return[e,...r].join(",")}}(r),n,o,i).compute(e,s)}}iz.implementedFunctions={SUMIF:{method:"sumif",parameters:[{argumentType:Qk.RANGE},{argumentType:Qk.NOERROR},{argumentType:Qk.RANGE,optionalArg:!0}]},COUNTIF:{method:"countif",parameters:[{argumentType:Qk.RANGE},{argumentType:Qk.NOERROR}]},AVERAGEIF:{method:"averageif",parameters:[{argumentType:Qk.RANGE},{argumentType:Qk.NOERROR},{argumentType:Qk.RANGE,optionalArg:!0}]},SUMIFS:{method:"sumifs",parameters:[{argumentType:Qk.RANGE},{argumentType:Qk.RANGE},{argumentType:Qk.NOERROR}],repeatLastArgs:2},COUNTIFS:{method:"countifs",parameters:[{argumentType:Qk.RANGE},{argumentType:Qk.NOERROR}],repeatLastArgs:2},MINIFS:{method:"minifs",parameters:[{argumentType:Qk.RANGE},{argumentType:Qk.RANGE},{argumentType:Qk.NOERROR}],repeatLastArgs:2},MAXIFS:{method:"maxifs",parameters:[{argumentType:Qk.RANGE},{argumentType:Qk.RANGE},{argumentType:Qk.NOERROR}],repeatLastArgs:2}};
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
class sz extends Zk{sumproduct(e,t){return this.runFunction(e.args,t,this.metadata("SUMPRODUCT"),((...e)=>{const t=e[0].width(),r=e[0].height();for(const i of e)if(i.width()!==t||i.height()!==r)return new pk(XU.VALUE,BH.EqualLength);let n=0;const o=e.map((e=>e.iterateValuesFromTopLeftCorner()));for(let i=0;i<t*r;i++){let e=1;for(const t of o){const r=t.next().value;if(r instanceof pk)return r;const n=this.coerceScalarToNumberOrError(r);BD(n)?e*=LD(n):e=0}n+=e}return n}))}}sz.implementedFunctions={SUMPRODUCT:{method:"sumproduct",parameters:[{argumentType:Qk.RANGE}],repeatLastArgs:1}};
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
class az extends Zk{concatenate(e,t){return this.runFunction(e.args,t,this.metadata("CONCATENATE"),((...e)=>"".concat(...e)))}split(e,t){return this.runFunction(e.args,t,this.metadata("SPLIT"),((e,t)=>{const r=e.split(" ");return t>=r.length||t<0?new pk(XU.VALUE,BH.IndexBounds):r[t]}))}len(e,t){return this.runFunction(e.args,t,this.metadata("LEN"),(e=>e.length))}lower(e,t){return this.runFunction(e.args,t,this.metadata("LOWER"),(e=>e.toLowerCase()))}trim(e,t){return this.runFunction(e.args,t,this.metadata("TRIM"),(e=>e.replace(/^ +| +$/g,"").replace(/ +/g," ")))}proper(e,t){return this.runFunction(e.args,t,this.metadata("PROPER"),(e=>e.replace(/\p{L}+/gu,(e=>e.charAt(0).toUpperCase()+e.substring(1).toLowerCase()))))}clean(e,t){return this.runFunction(e.args,t,this.metadata("CLEAN"),(e=>e.replace(/[\u0000-\u001F]/g,"")))}exact(e,t){return this.runFunction(e.args,t,this.metadata("EXACT"),((e,t)=>e===t))}rept(e,t){return this.runFunction(e.args,t,this.metadata("REPT"),((e,t)=>t<0?new pk(XU.VALUE,BH.NegativeCount):e.repeat(t)))}right(e,t){return this.runFunction(e.args,t,this.metadata("RIGHT"),((e,t)=>t<0?new pk(XU.VALUE,BH.NegativeLength):0===t?"":e.slice(-t)))}left(e,t){return this.runFunction(e.args,t,this.metadata("LEFT"),((e,t)=>t<0?new pk(XU.VALUE,BH.NegativeLength):e.slice(0,t)))}mid(e,t){return this.runFunction(e.args,t,this.metadata("MID"),((e,t,r)=>t<1?new pk(XU.VALUE,BH.LessThanOne):r<0?new pk(XU.VALUE,BH.NegativeLength):e.substring(t-1,t+r-1)))}replace(e,t){return this.runFunction(e.args,t,this.metadata("REPLACE"),((e,t,r,n)=>t<1?new pk(XU.VALUE,BH.LessThanOne):r<0?new pk(XU.VALUE,BH.NegativeLength):e.substring(0,t-1)+n+e.substring(t+r-1)))}search(e,t){return this.runFunction(e.args,t,this.metadata("SEARCH"),((e,t,r)=>{if(r<1||r>t.length)return new pk(XU.VALUE,BH.LengthBounds);const n=e.toLowerCase(),o=t.substring(r-1).toLowerCase(),i=this.arithmeticHelper.requiresRegex(n)?this.arithmeticHelper.searchString(n,o):o.indexOf(n);return i>-1?i+r:new pk(XU.VALUE,BH.PatternNotFound)}))}substitute(e,t){return this.runFunction(e.args,t,this.metadata("SUBSTITUTE"),((e,t,r,n)=>{const o=this.escapeRegExpSpecialCharacters(t),i=new RegExp(o,"g");if(void 0===n)return e.replace(i,r);if(n<1)return new pk(XU.VALUE,BH.LessThanOne);let s,a=0;for(;null!==(s=i.exec(e));)if(n===++a)return e.substring(0,s.index)+r+e.substring(i.lastIndex);return e}))}find(e,t){return this.runFunction(e.args,t,this.metadata("FIND"),((e,t,r)=>{if(r<1||r>t.length)return new pk(XU.VALUE,BH.IndexBounds);const n=t.substring(r-1).indexOf(e)+r;return n>0?n:new pk(XU.VALUE,BH.PatternNotFound)}))}t(e,t){return this.runFunction(e.args,t,this.metadata("T"),(e=>e instanceof pk||"string"==typeof e?e:""))}upper(e,t){return this.runFunction(e.args,t,this.metadata("UPPER"),(e=>e.toUpperCase()))}escapeRegExpSpecialCharacters(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}}az.implementedFunctions={CONCATENATE:{method:"concatenate",parameters:[{argumentType:Qk.STRING}],repeatLastArgs:1,expandRanges:!0},EXACT:{method:"exact",parameters:[{argumentType:Qk.STRING},{argumentType:Qk.STRING}]},SPLIT:{method:"split",parameters:[{argumentType:Qk.STRING},{argumentType:Qk.NUMBER}]},LEN:{method:"len",parameters:[{argumentType:Qk.STRING}]},LOWER:{method:"lower",parameters:[{argumentType:Qk.STRING}]},MID:{method:"mid",parameters:[{argumentType:Qk.STRING},{argumentType:Qk.NUMBER},{argumentType:Qk.NUMBER}]},TRIM:{method:"trim",parameters:[{argumentType:Qk.STRING}]},T:{method:"t",parameters:[{argumentType:Qk.SCALAR}]},PROPER:{method:"proper",parameters:[{argumentType:Qk.STRING}]},CLEAN:{method:"clean",parameters:[{argumentType:Qk.STRING}]},REPT:{method:"rept",parameters:[{argumentType:Qk.STRING},{argumentType:Qk.NUMBER}]},RIGHT:{method:"right",parameters:[{argumentType:Qk.STRING},{argumentType:Qk.NUMBER,defaultValue:1}]},LEFT:{method:"left",parameters:[{argumentType:Qk.STRING},{argumentType:Qk.NUMBER,defaultValue:1}]},REPLACE:{method:"replace",parameters:[{argumentType:Qk.STRING},{argumentType:Qk.NUMBER},{argumentType:Qk.NUMBER},{argumentType:Qk.STRING}]},SEARCH:{method:"search",parameters:[{argumentType:Qk.STRING},{argumentType:Qk.STRING},{argumentType:Qk.NUMBER,defaultValue:1}]},SUBSTITUTE:{method:"substitute",parameters:[{argumentType:Qk.STRING},{argumentType:Qk.STRING},{argumentType:Qk.STRING},{argumentType:Qk.NUMBER,optionalArg:!0}]},FIND:{method:"find",parameters:[{argumentType:Qk.STRING},{argumentType:Qk.STRING},{argumentType:Qk.NUMBER,defaultValue:1}]},UPPER:{method:"upper",parameters:[{argumentType:Qk.STRING}]}};
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
class lz extends Zk{acos(e,t){return this.runFunction(e.args,t,this.metadata("ACOS"),Math.acos)}asin(e,t){return this.runFunction(e.args,t,this.metadata("ASIN"),Math.asin)}cos(e,t){return this.runFunction(e.args,t,this.metadata("COS"),Math.cos)}sin(e,t){return this.runFunction(e.args,t,this.metadata("SIN"),Math.sin)}tan(e,t){return this.runFunction(e.args,t,this.metadata("TAN"),Math.tan)}atan(e,t){return this.runFunction(e.args,t,this.metadata("ATAN"),Math.atan)}atan2(e,t){return this.runFunction(e.args,t,this.metadata("ATAN2"),((e,t)=>0===e&&0===t?new pk(XU.DIV_BY_ZERO):Math.atan2(t,e)))}cot(e,t){return this.runFunction(e.args,t,this.metadata("COT"),(e=>0===e?new pk(XU.DIV_BY_ZERO):1/Math.tan(e)))}acot(e,t){return this.runFunction(e.args,t,this.metadata("ACOT"),(e=>0===e?Sj/2:Math.atan(1/e)))}sec(e,t){return this.runFunction(e.args,t,this.metadata("SEC"),(e=>1/Math.cos(e)))}csc(e,t){return this.runFunction(e.args,t,this.metadata("CSC"),(e=>0===e?new pk(XU.DIV_BY_ZERO):1/Math.sin(e)))}sinh(e,t){return this.runFunction(e.args,t,this.metadata("SINH"),Math.sinh)}asinh(e,t){return this.runFunction(e.args,t,this.metadata("ASINH"),Math.asinh)}cosh(e,t){return this.runFunction(e.args,t,this.metadata("COSH"),Math.cosh)}acosh(e,t){return this.runFunction(e.args,t,this.metadata("ACOSH"),Math.acosh)}tanh(e,t){return this.runFunction(e.args,t,this.metadata("TANH"),Math.tanh)}atanh(e,t){return this.runFunction(e.args,t,this.metadata("ATANH"),Math.atanh)}coth(e,t){return this.runFunction(e.args,t,this.metadata("COTH"),(e=>0===e?new pk(XU.DIV_BY_ZERO):1/Math.tanh(e)))}acoth(e,t){return this.runFunction(e.args,t,this.metadata("ACOTH"),(e=>0===e?new pk(XU.NUM,BH.NonZero):Math.atanh(1/e)))}sech(e,t){return this.runFunction(e.args,t,this.metadata("SECH"),(e=>1/Math.cosh(e)))}csch(e,t){return this.runFunction(e.args,t,this.metadata("CSCH"),(e=>0===e?new pk(XU.DIV_BY_ZERO):1/Math.sinh(e)))}}lz.implementedFunctions={ACOS:{method:"acos",parameters:[{argumentType:Qk.NUMBER}]},ASIN:{method:"asin",parameters:[{argumentType:Qk.NUMBER}]},COS:{method:"cos",parameters:[{argumentType:Qk.NUMBER}]},SIN:{method:"sin",parameters:[{argumentType:Qk.NUMBER}]},TAN:{method:"tan",parameters:[{argumentType:Qk.NUMBER}]},ATAN:{method:"atan",parameters:[{argumentType:Qk.NUMBER}]},ATAN2:{method:"atan2",parameters:[{argumentType:Qk.NUMBER},{argumentType:Qk.NUMBER}]},COT:{method:"cot",parameters:[{argumentType:Qk.NUMBER}]},SEC:{method:"sec",parameters:[{argumentType:Qk.NUMBER}]},CSC:{method:"csc",parameters:[{argumentType:Qk.NUMBER}]},SINH:{method:"sinh",parameters:[{argumentType:Qk.NUMBER}]},COSH:{method:"cosh",parameters:[{argumentType:Qk.NUMBER}]},TANH:{method:"tanh",parameters:[{argumentType:Qk.NUMBER}]},COTH:{method:"coth",parameters:[{argumentType:Qk.NUMBER}]},SECH:{method:"sech",parameters:[{argumentType:Qk.NUMBER}]},CSCH:{method:"csch",parameters:[{argumentType:Qk.NUMBER}]},ACOT:{method:"acot",parameters:[{argumentType:Qk.NUMBER}]},ASINH:{method:"asinh",parameters:[{argumentType:Qk.NUMBER}]},ACOSH:{method:"acosh",parameters:[{argumentType:Qk.NUMBER}]},ATANH:{method:"atanh",parameters:[{argumentType:Qk.NUMBER}]},ACOTH:{method:"acoth",parameters:[{argumentType:Qk.NUMBER}]}};
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
class uz extends TG{constructor(e){super(e),this.dependencyGraph=e}find(e,t,r){return this.basicFind(e,t,"col",r)}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class hz extends Zk{constructor(){super(...arguments),this.rowSearch=new uz(this.dependencyGraph)}vlookup(e,t){return this.runFunction(e.args,t,this.metadata("VLOOKUP"),((e,t,r,n)=>{const o=t.range;if(void 0===o)return new pk(XU.VALUE,BH.WrongType);if(r<1)return new pk(XU.VALUE,BH.LessThanOne);if(r>o.width())return new pk(XU.REF,BH.IndexLarge);const i={ordering:n?"asc":"none",ifNoMatch:n?"returnLowerBound":"returnNotFound"};return this.doVlookup(Uk(e),t,r-1,i)}))}hlookup(e,t){return this.runFunction(e.args,t,this.metadata("HLOOKUP"),((e,t,r,n)=>{const o=t.range;if(void 0===o)return new pk(XU.VALUE,BH.WrongType);if(r<1)return new pk(XU.VALUE,BH.LessThanOne);if(r>o.height())return new pk(XU.REF,BH.IndexLarge);const i={ordering:n?"asc":"none",ifNoMatch:n?"returnLowerBound":"returnNotFound"};return this.doHlookup(Uk(e),t,r-1,i)}))}xlookup(e,t){return this.runFunction(e.args,t,this.metadata("XLOOKUP"),((e,t,r,n,o,i)=>{if(![0,-1,1,2].includes(o))return new pk(XU.VALUE,BH.BadMode);if(![1,-1,2,-2].includes(i))return new pk(XU.VALUE,BH.BadMode);const s=t instanceof zD?t:zD.fromScalar(t),a=r instanceof zD?r:zD.fromScalar(r),l=2===o,u={ordering:2===i?"asc":-2===i?"desc":"none",returnOccurrence:-1===i?"last":"first",ifNoMatch:-1===o?"returnLowerBound":1===o?"returnUpperBound":"returnNotFound"};return this.doXlookup(Uk(e),s,a,n,l,u)}))}xlookupArraySize(e){var t,r;const n=null===(t=null==e?void 0:e.args)||void 0===t?void 0:t[1],o=null===(r=null==e?void 0:e.args)||void 0===r?void 0:r[2];if(null==(null==n?void 0:n.start)||null==(null==n?void 0:n.end)||null==(null==o?void 0:o.start)||null==(null==o?void 0:o.end))return Jk.error();const i=n.end.row-n.start.row+1,s=n.end.col-n.start.col+1,a=o.end.row-o.start.row+1,l=o.end.col-o.start.col+1,u=1===s&&a===i;return u||1===i&&l===s?u?new Jk(l,1):new Jk(1,a):Jk.error()}match(e,t){return this.runFunction(e.args,t,this.metadata("MATCH"),((e,t,r)=>this.doMatch(Uk(e),t,r)))}searchInRange(e,t,r,n,o){return r&&"string"==typeof e&&this.arithmeticHelper.requiresRegex(e)?o.advancedFind(this.arithmeticHelper.eqMatcherFunction(e),t,{returnOccurrence:n.returnOccurrence}):o.find(e,t,n)}doVlookup(e,t,r,n){this.dependencyGraph.stats.start(GD.VLOOKUP);const o=t.range;let i;i=void 0===o?zD.onlyValues(t.data.map((e=>[e[0]]))):zD.onlyRange(Ak.spanFrom(o.start,1,o.height()),this.dependencyGraph);const s=this.searchInRange(e,i,"none"===n.ordering,n,this.columnSearch);if(this.dependencyGraph.stats.end(GD.VLOOKUP),-1===s)return new pk(XU.NA,BH.ValueNotFound);let a;if(void 0===o)a=t.data[s][r];else{const e=wk(o.sheet,o.start.col+r,o.start.row+s);a=this.dependencyGraph.getCellValue(e)}return a instanceof zD?new pk(XU.VALUE,BH.WrongType):a}doHlookup(e,t,r,n){const o=t.range;let i;i=void 0===o?zD.onlyValues([t.data[0]]):zD.onlyRange(Ak.spanFrom(o.start,o.width(),1),this.dependencyGraph);const s=this.searchInRange(e,i,"none"===n.ordering,n,this.rowSearch);if(-1===s)return new pk(XU.NA,BH.ValueNotFound);let a;if(void 0===o)a=t.data[r][s];else{const e=wk(o.sheet,o.start.col+s,o.start.row+r);a=this.dependencyGraph.getCellValue(e)}return a instanceof zD?new pk(XU.VALUE,BH.WrongType):a}doXlookup(e,t,r,n,o,i){const s=1===t.width()&&r.height()===t.height(),a=1===t.height()&&r.width()===t.width();if(!s&&!a)return new pk(XU.VALUE,BH.WrongDimension);const l=s?this.columnSearch:this.rowSearch,u=this.searchInRange(e,t,o,i,l);if(-1===u)return n==XU.NA?new pk(XU.NA,BH.ValueNotFound):n;const h=s?[r.data[u]]:r.data.map((e=>[e[u]]));return zD.onlyValues(h)}doMatch(e,t,r){if(![-1,0,1].includes(r))return new pk(XU.VALUE,BH.BadMode);if(t.width()>1&&t.height()>1)return new pk(XU.NA);const n=0===r?{ordering:"none",ifNoMatch:"returnNotFound"}:{ordering:-1===r?"desc":"asc",ifNoMatch:-1===r?"returnUpperBound":"returnLowerBound"},o=(1===t.width()?this.columnSearch:this.rowSearch).find(e,t,n);return-1===o?new pk(XU.NA,BH.ValueNotFound):o+1}}hz.implementedFunctions={VLOOKUP:{method:"vlookup",parameters:[{argumentType:Qk.NOERROR},{argumentType:Qk.RANGE},{argumentType:Qk.NUMBER},{argumentType:Qk.BOOLEAN,defaultValue:!0}]},HLOOKUP:{method:"hlookup",parameters:[{argumentType:Qk.NOERROR},{argumentType:Qk.RANGE},{argumentType:Qk.NUMBER},{argumentType:Qk.BOOLEAN,defaultValue:!0}]},XLOOKUP:{method:"xlookup",arraySizeMethod:"xlookupArraySize",parameters:[{argumentType:Qk.NOERROR},{argumentType:Qk.RANGE},{argumentType:Qk.RANGE},{argumentType:Qk.SCALAR,optionalArg:!0,defaultValue:XU.NA},{argumentType:Qk.NUMBER,optionalArg:!0,defaultValue:0},{argumentType:Qk.NUMBER,optionalArg:!0,defaultValue:1}]},MATCH:{method:"match",parameters:[{argumentType:Qk.NOERROR},{argumentType:Qk.RANGE},{argumentType:Qk.NUMBER,defaultValue:1}]}};
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
class cz extends Zk{roman(e,t){return this.runFunction(e.args,t,this.metadata("ROMAN"),((e,t)=>(e=Math.trunc(e),!1===t?t=4:!0===t&&(t=0),(t=LD(this.coerceScalarToNumberOrError(t)))instanceof pk?t:(t=Math.trunc(t))<0?new pk(XU.VALUE,BH.ValueSmall):t>4?new pk(XU.VALUE,BH.ValueLarge):function(e,t){const r={val:e%1e3,acc:"M".repeat(Math.floor(e/1e3))};4===t&&(pz(r,"IM",999,1e3),pz(r,"ID",499,500));t>=3&&(pz(r,"VM",995,1e3),pz(r,"VD",495,500));t>=2&&(pz(r,"XM",990,1e3),pz(r,"XD",490,500));t>=1&&(pz(r,"LM",950,1e3),pz(r,"LD",450,500));pz(r,"CM",900,1e3),pz(r,"CD",400,500),pz(r,"D",500,900),r.acc+="C".repeat(Math.floor(r.val/100)),r.val%=100,t>=2&&(pz(r,"IC",99,100),pz(r,"IL",49,50));t>=1&&(pz(r,"VC",95,100),pz(r,"VL",45,50));return pz(r,"XC",90,100),pz(r,"XL",40,50),pz(r,"L",50,90),r.acc+="X".repeat(Math.floor(r.val/10)),r.val%=10,pz(r,"IX",9,10),pz(r,"IV",4,5),pz(r,"V",5,9),r.acc+="I".repeat(r.val),r.acc}(e,t))))}arabic(e,t){return this.runFunction(e.args,t,this.metadata("ARABIC"),(e=>{let t=!1;if((e=e.trim().toUpperCase()).startsWith("-")&&(t=!0,""===(e=e.slice(1))))return new pk(XU.VALUE,BH.InvalidRoman);const r={input:e,acc:0};return dz(r,{token:"MMM",val:3e3},{token:"MM",val:2e3},{token:"M",val:1e3}),dz(r,{token:"IM",val:999},{token:"VM",val:995},{token:"XM",val:990},{token:"LM",val:950},{token:"CM",val:900}),dz(r,{token:"D",val:500},{token:"ID",val:499},{token:"VD",val:495},{token:"XD",val:490},{token:"LD",val:450},{token:"CD",val:400}),dz(r,{token:"CCC",val:300},{token:"CC",val:200},{token:"C",val:100}),dz(r,{token:"IC",val:99},{token:"VC",val:95},{token:"XC",val:90}),dz(r,{token:"L",val:50},{token:"IL",val:49},{token:"VL",val:45},{token:"XL",val:40}),dz(r,{token:"XXX",val:30},{token:"XX",val:20},{token:"X",val:10}),dz(r,{token:"IX",val:9}),dz(r,{token:"V",val:5},{token:"IV",val:4}),dz(r,{token:"III",val:3},{token:"II",val:2},{token:"I",val:1}),""!==r.input?new pk(XU.VALUE,BH.InvalidRoman):t?-r.acc:r.acc}))}}function dz(e,...t){for(const r of t)if(e.input.startsWith(r.token)){e.input=e.input.slice(r.token.length),e.acc+=r.val;break}}function pz(e,t,r,n){e.val>=r&&e.val<n&&(e.val-=r,e.acc+=t)}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */cz.implementedFunctions={ROMAN:{method:"roman",parameters:[{argumentType:Qk.NUMBER,minValue:1,lessThan:4e3},{argumentType:Qk.NOERROR,optionalArg:!0,defaultValue:0}]},ARABIC:{method:"arabic",parameters:[{argumentType:Qk.STRING}]}};class mz extends Zk{add(e,t){return this.runFunction(e.args,t,this.metadata("HF.ADD"),this.arithmeticHelper.addWithEpsilon)}concat(e,t){return this.runFunction(e.args,t,this.metadata("HF.CONCAT"),this.arithmeticHelper.concat)}divide(e,t){return this.runFunction(e.args,t,this.metadata("HF.DIVIDE"),this.arithmeticHelper.divide)}eq(e,t){return this.runFunction(e.args,t,this.metadata("HF.EQ"),this.arithmeticHelper.eq)}gt(e,t){return this.runFunction(e.args,t,this.metadata("HF.GT"),this.arithmeticHelper.gt)}gte(e,t){return this.runFunction(e.args,t,this.metadata("HF.GTE"),this.arithmeticHelper.geq)}lt(e,t){return this.runFunction(e.args,t,this.metadata("HF.LT"),this.arithmeticHelper.lt)}lte(e,t){return this.runFunction(e.args,t,this.metadata("HF.LTE"),this.arithmeticHelper.leq)}minus(e,t){return this.runFunction(e.args,t,this.metadata("HF.MINUS"),this.arithmeticHelper.subtract)}multiply(e,t){return this.runFunction(e.args,t,this.metadata("HF.MULTIPLY"),this.arithmeticHelper.multiply)}ne(e,t){return this.runFunction(e.args,t,this.metadata("HF.NE"),this.arithmeticHelper.neq)}pow(e,t){return this.runFunction(e.args,t,this.metadata("HF.POW"),this.arithmeticHelper.pow)}uminus(e,t){return this.runFunction(e.args,t,this.metadata("HF.UMINUS"),this.arithmeticHelper.unaryMinus)}upercent(e,t){return this.runFunction(e.args,t,this.metadata("HF.UNARY_PERCENT"),this.arithmeticHelper.unaryPercent)}uplus(e,t){return this.runFunction(e.args,t,this.metadata("HF.UPLUS"),this.arithmeticHelper.unaryPlus)}}mz.implementedFunctions={"HF.ADD":{method:"add",parameters:[{argumentType:Qk.NUMBER,passSubtype:!0},{argumentType:Qk.NUMBER,passSubtype:!0}]},"HF.CONCAT":{method:"concat",parameters:[{argumentType:Qk.STRING,passSubtype:!0},{argumentType:Qk.STRING,passSubtype:!0}]},"HF.DIVIDE":{method:"divide",parameters:[{argumentType:Qk.NUMBER,passSubtype:!0},{argumentType:Qk.NUMBER,passSubtype:!0}]},"HF.EQ":{method:"eq",parameters:[{argumentType:Qk.NOERROR,passSubtype:!0},{argumentType:Qk.NOERROR,passSubtype:!0}]},"HF.GT":{method:"gt",parameters:[{argumentType:Qk.NOERROR,passSubtype:!0},{argumentType:Qk.NOERROR,passSubtype:!0}]},"HF.GTE":{method:"gte",parameters:[{argumentType:Qk.NOERROR,passSubtype:!0},{argumentType:Qk.NOERROR,passSubtype:!0}]},"HF.LT":{method:"lt",parameters:[{argumentType:Qk.NOERROR,passSubtype:!0},{argumentType:Qk.NOERROR,passSubtype:!0}]},"HF.LTE":{method:"lte",parameters:[{argumentType:Qk.NOERROR,passSubtype:!0},{argumentType:Qk.NOERROR,passSubtype:!0}]},"HF.MINUS":{method:"minus",parameters:[{argumentType:Qk.NUMBER,passSubtype:!0},{argumentType:Qk.NUMBER,passSubtype:!0}]},"HF.MULTIPLY":{method:"multiply",parameters:[{argumentType:Qk.NUMBER,passSubtype:!0},{argumentType:Qk.NUMBER,passSubtype:!0}]},"HF.NE":{method:"ne",parameters:[{argumentType:Qk.NOERROR,passSubtype:!0},{argumentType:Qk.NOERROR,passSubtype:!0}]},"HF.POW":{method:"pow",parameters:[{argumentType:Qk.NUMBER,passSubtype:!0},{argumentType:Qk.NUMBER,passSubtype:!0}]},"HF.UMINUS":{method:"uminus",parameters:[{argumentType:Qk.NUMBER,passSubtype:!0}]},"HF.UNARY_PERCENT":{method:"upercent",parameters:[{argumentType:Qk.NUMBER,passSubtype:!0}]},"HF.UPLUS":{method:"uplus",parameters:[{argumentType:Qk.NUMBER,passSubtype:!0}]}};
/**
 * @license
 bessel.js (C) 2013-present SheetJS -- http://sheetjs.com

 Apache License
 Version 2.0, January 2004
 http://www.apache.org/licenses/

 TERMS AND CONDITIONS FOR USE, REPRODUCTION, AND DISTRIBUTION

 1. Definitions.

 "License" shall mean the terms and conditions for use, reproduction,
 and distribution as defined by Sections 1 through 9 of this document.

 "Licensor" shall mean the copyright owner or entity authorized by
 the copyright owner that is granting the License.

 "Legal Entity" shall mean the union of the acting entity and all
 other entities that control, are controlled by, or are under common
 control with that entity. For the purposes of this definition,
 "control" means (i) the power, direct or indirect, to cause the
 direction or management of such entity, whether by contract or
 otherwise, or (ii) ownership of fifty percent (50%) or more of the
 outstanding shares, or (iii) beneficial ownership of such entity.

 "You" (or "Your") shall mean an individual or Legal Entity
 exercising permissions granted by this License.

 "Source" form shall mean the preferred form for making modifications,
 including but not limited to software source code, documentation
 source, and configuration files.

 "Object" form shall mean any form resulting from mechanical
 transformation or translation of a Source form, including but
 not limited to compiled object code, generated documentation,
 and conversions to other media types.

 "Work" shall mean the work of authorship, whether in Source or
 Object form, made available under the License, as indicated by a
 copyright notice that is included in or attached to the work
 (an example is provided in the Appendix below).

 "Derivative Works" shall mean any work, whether in Source or Object
 form, that is based on (or derived from) the Work and for which the
 editorial revisions, annotations, elaborations, or other modifications
 represent, as a whole, an original work of authorship. For the purposes
 of this License, Derivative Works shall not include works that remain
 separable from, or merely link (or bind by name) to the interfaces of,
 the Work and Derivative Works thereof.

 "Contribution" shall mean any work of authorship, including
 the original version of the Work and any modifications or additions
 to that Work or Derivative Works thereof, that is intentionally
 submitted to Licensor for inclusion in the Work by the copyright owner
 or by an individual or Legal Entity authorized to submit on behalf of
 the copyright owner. For the purposes of this definition, "submitted"
 means any form of electronic, verbal, or written communication sent
 to the Licensor or its representatives, including but not limited to
 communication on electronic mailing lists, source code control systems,
 and issue tracking systems that are managed by, or on behalf of, the
 Licensor for the purpose of discussing and improving the Work, but
 excluding communication that is conspicuously marked or otherwise
 designated in writing by the copyright owner as "Not a Contribution."

 "Contributor" shall mean Licensor and any individual or Legal Entity
 on behalf of whom a Contribution has been received by Licensor and
 subsequently incorporated within the Work.

 2. Grant of Copyright License. Subject to the terms and conditions of
 this License, each Contributor hereby grants to You a perpetual,
 worldwide, non-exclusive, no-charge, royalty-free, irrevocable
 copyright license to reproduce, prepare Derivative Works of,
 publicly display, publicly perform, sublicense, and distribute the
 Work and such Derivative Works in Source or Object form.

 3. Grant of Patent License. Subject to the terms and conditions of
 this License, each Contributor hereby grants to You a perpetual,
 worldwide, non-exclusive, no-charge, royalty-free, irrevocable
 (except as stated in this section) patent license to make, have made,
 use, offer to sell, sell, import, and otherwise transfer the Work,
 where such license applies only to those patent claims licensable
 by such Contributor that are necessarily infringed by their
 Contribution(s) alone or by combination of their Contribution(s)
 with the Work to which such Contribution(s) was submitted. If You
 institute patent litigation against any entity (including a
 cross-claim or counterclaim in a lawsuit) alleging that the Work
 or a Contribution incorporated within the Work constitutes direct
 or contributory patent infringement, then any patent licenses
 granted to You under this License for that Work shall terminate
 as of the date such litigation is filed.

 4. Redistribution. You may reproduce and distribute copies of the
 Work or Derivative Works thereof in any medium, with or without
 modifications, and in Source or Object form, provided that You
 meet the following conditions:

 (a) You must give any other recipients of the Work or
 Derivative Works a copy of this License; and

 (b) You must cause any modified files to carry prominent notices
 stating that You changed the files; and

 (c) You must retain, in the Source form of any Derivative Works
 that You distribute, all copyright, patent, trademark, and
 attribution notices from the Source form of the Work,
 excluding those notices that do not pertain to any part of
 the Derivative Works; and

 (d) If the Work includes a "NOTICE" text file as part of its
 distribution, then any Derivative Works that You distribute must
 include a readable copy of the attribution notices contained
 within such NOTICE file, excluding those notices that do not
 pertain to any part of the Derivative Works, in at least one
 of the following places: within a NOTICE text file distributed
 as part of the Derivative Works; within the Source form or
 documentation, if provided along with the Derivative Works; or,
 within a display generated by the Derivative Works, if and
 wherever such third-party notices normally appear. The contents
 of the NOTICE file are for informational purposes only and
 do not modify the License. You may add Your own attribution
 notices within Derivative Works that You distribute, alongside
 or as an addendum to the NOTICE text from the Work, provided
 that such additional attribution notices cannot be construed
 as modifying the License.

 You may add Your own copyright statement to Your modifications and
 may provide additional or different license terms and conditions
 for use, reproduction, or distribution of Your modifications, or
 for any such Derivative Works as a whole, provided Your use,
 reproduction, and distribution of the Work otherwise complies with
 the conditions stated in this License.

 5. Submission of Contributions. Unless You explicitly state otherwise,
 any Contribution intentionally submitted for inclusion in the Work
 by You to the Licensor shall be under the terms and conditions of
 this License, without any additional terms or conditions.
 Notwithstanding the above, nothing herein shall supersede or modify
 the terms of any separate license agreement you may have executed
 with Licensor regarding such Contributions.

 6. Trademarks. This License does not grant permission to use the trade
 names, trademarks, service marks, or product names of the Licensor,
 except as required for reasonable and customary use in describing the
 origin of the Work and reproducing the content of the NOTICE file.

 7. Disclaimer of Warranty. Unless required by applicable law or
 agreed to in writing, Licensor provides the Work (and each
 Contributor provides its Contributions) on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or
 implied, including, without limitation, any warranties or conditions
 of TITLE, NON-INFRINGEMENT, MERCHANTABILITY, or FITNESS FOR A
 PARTICULAR PURPOSE. You are solely responsible for determining the
 appropriateness of using or redistributing the Work and assume any
 risks associated with Your exercise of permissions under this License.

 8. Limitation of Liability. In no event and under no legal theory,
 whether in tort (including negligence), contract, or otherwise,
 unless required by applicable law (such as deliberate and grossly
 negligent acts) or agreed to in writing, shall any Contributor be
 liable to You for damages, including any direct, indirect, special,
 incidental, or consequential damages of any character arising as a
 result of this License or out of the use or inability to use the
 Work (including but not limited to damages for loss of goodwill,
 work stoppage, computer failure or malfunction, or any and all
 other commercial damages or losses), even if such Contributor
 has been advised of the possibility of such damages.

 9. Accepting Warranty or Additional Liability. While redistributing
 the Work or Derivative Works thereof, You may choose to offer,
 and charge a fee for, acceptance of support, warranty, indemnity,
 or other liability obligations and/or rights consistent with this
 License. However, in accepting such obligations, You may act only
 on Your own behalf and on Your sole responsibility, not on behalf
 of any other Contributor, and only if You agree to indemnify,
 defend, and hold each Contributor harmless for any liability
 incurred by, or claims asserted against, such Contributor by reason
 of your accepting any such warranty or additional liability.

 END OF TERMS AND CONDITIONS

 APPENDIX: How to apply the Apache License to your work.

 To apply the Apache License to your work, attach the following
 boilerplate notice, with the fields enclosed by brackets "{}"
 replaced with your own identifying information. (Don't include
 the brackets!)  The text should be enclosed in the appropriate
 comment syntax for the file format. We also recommend that a
 file or class name and description of purpose be included on the
 same "printed page" as the copyright notice for easier
 identification within third-party archives.

 Copyright (C) 2013-present   SheetJS LLC

 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

 http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 */
var gz=Math;function fz(e,t){for(var r=0,n=0;r<e.length;++r)n=t*n+e[r];return n}function yz(e,t,r,n,o){if(0===t)return r;if(1===t)return n;for(var i=2/e,s=n,a=1;a<t;++a)s=n*a*i+o*r,r=n,n=s;return s}function wz(e,t,r,n,o){return function(r,i){if(n){if(0===r)return 1==n?-1/0:1/0;if(r<0)return NaN}return 0===i?e(r):1===i?t(r):i<0?NaN:yz(r,i|=0,e(r),t(r),o)}}var Ez,vz,Rz,Sz,Tz,Cz,bz,Nz,Az,Iz,Oz,Mz,_z,xz=function(){var e=.636619772,t=[57568490574,-13362590354,651619640.7,-11214424.18,77392.33017,-184.9052456].reverse(),r=[57568490411,1029532985,9494680.718,59272.64853,267.8532712,1].reverse(),n=[1,-.001098628627,2734510407e-14,-2073370639e-15,2.093887211e-7].reverse(),o=[-.01562499995,.0001430488765,-6911147651e-15,7.621095161e-7,-9.34935152e-8].reverse();function i(i){var s=0,a=0,l=0,u=i*i;if(i<8)s=(a=fz(t,u))/(l=fz(r,u));else{var h=i-.785398164;a=fz(n,u=64/u),l=fz(o,u),s=gz.sqrt(e/i)*(gz.cos(h)*a-gz.sin(h)*l*8/i)}return s}var s=[72362614232,-7895059235,242396853.1,-2972611.439,15704.4826,-30.16036606].reverse(),a=[144725228442,2300535178,18583304.74,99447.43394,376.9991397,1].reverse(),l=[1,.00183105,-3516396496e-14,2457520174e-15,-2.40337019e-7].reverse(),u=[.04687499995,-.0002002690873,8449199096e-15,-8.8228987e-7,1.05787412e-7].reverse();function h(t){var r=0,n=0,o=0,i=t*t,h=gz.abs(t)-2.356194491;return Math.abs(t)<8?r=(n=t*fz(s,i))/(o=fz(a,i)):(n=fz(l,i=64/i),o=fz(u,i),r=gz.sqrt(e/gz.abs(t))*(gz.cos(h)*n-gz.sin(h)*o*8/gz.abs(t)),t<0&&(r=-r)),r}return function e(t,r){if(r=Math.round(r),!isFinite(t))return isNaN(t)?t:0;if(r<0)return(r%2?-1:1)*e(t,-r);if(t<0)return(r%2?-1:1)*e(-t,r);if(0===r)return i(t);if(1===r)return h(t);if(0===t)return 0;var n=0;if(t>r)n=yz(t,r,i(t),h(t),-1);else{for(var o=!1,s=0,a=0,l=1,u=0,c=2/t,d=2*gz.floor((r+gz.floor(gz.sqrt(40*r)))/2);d>0;d--)u=d*c*l-s,s=l,l=u,gz.abs(l)>1e10&&(l*=1e-10,s*=1e-10,n*=1e-10,a*=1e-10),o&&(a+=l),o=!o,d==r&&(n=s);n/=a=2*a-l}return n}}(),Lz=(Ez=.636619772,vz=[-2957821389,7062834065,-512359803.6,10879881.29,-86327.92757,228.4622733].reverse(),Rz=[40076544269,745249964.8,7189466.438,47447.2647,226.1030244,1].reverse(),Sz=[1,-.001098628627,2734510407e-14,-2073370639e-15,2.093887211e-7].reverse(),Tz=[-.01562499995,.0001430488765,-6911147651e-15,7.621095161e-7,-9.34945152e-8].reverse(),Cz=[-4900604943e3,127527439e4,-51534381390,734926455.1,-4237922.726,8511.937935].reverse(),bz=[249958057e5,424441966400,3733650367,22459040.02,102042.605,354.9632885,1].reverse(),Nz=[1,.00183105,-3516396496e-14,2457520174e-15,-2.40337019e-7].reverse(),Az=[.04687499995,-.0002002690873,8449199096e-15,-8.8228987e-7,1.05787412e-7].reverse(),wz((function(e){var t=0,r=0,n=0,o=e*e,i=e-.785398164;return e<8?t=(r=fz(vz,o))/(n=fz(Rz,o))+Ez*xz(e,0)*gz.log(e):(r=fz(Sz,o=64/o),n=fz(Tz,o),t=gz.sqrt(Ez/e)*(gz.sin(i)*r+gz.cos(i)*n*8/e)),t}),(function(e){var t=0,r=0,n=0,o=e*e,i=e-2.356194491;return e<8?t=(r=e*fz(Cz,o))/(n=fz(bz,o))+Ez*(xz(e,1)*gz.log(e)-1/e):(r=fz(Nz,o=64/o),n=fz(Az,o),t=gz.sqrt(Ez/e)*(gz.sin(i)*r+gz.cos(i)*n*8/e)),t}),0,1,-1)),Fz=(Iz=[1,3.5156229,3.0899424,1.2067492,.2659732,.0360768,.0045813].reverse(),Oz=[.39894228,.01328592,.00225319,-.00157565,.00916281,-.02057706,.02635537,-.01647633,.00392377].reverse(),Mz=[.5,.87890594,.51498869,.15084934,.02658733,.00301532,32411e-8].reverse(),_z=[.39894228,-.03988024,-.00362018,.00163801,-.01031555,.02282967,-.02895312,.01787654,-.00420059].reverse(),function e(t,r){if(0===(r=Math.round(r)))return function(e){return e<=3.75?fz(Iz,e*e/14.0625):gz.exp(gz.abs(e))/gz.sqrt(gz.abs(e))*fz(Oz,3.75/gz.abs(e))}(t);if(1===r)return function(e){return e<3.75?e*fz(Mz,e*e/14.0625):(e<0?-1:1)*gz.exp(gz.abs(e))/gz.sqrt(gz.abs(e))*fz(_z,3.75/gz.abs(e))}(t);if(r<0)return NaN;if(0===gz.abs(t))return 0;if(t==1/0)return 1/0;var n,o=0,i=2/gz.abs(t),s=0,a=1,l=0;for(n=2*gz.round((r+gz.round(gz.sqrt(40*r)))/2);n>0;n--)l=n*i*a+s,s=a,a=l,gz.abs(a)>1e10&&(a*=1e-10,s*=1e-10,o*=1e-10),n==r&&(o=s);return o*=e(t,0)/a,t<0&&r%2?-o:o}),Pz=function(){var e=[-.57721566,.4227842,.23069756,.0348859,.00262698,1075e-7,74e-7].reverse(),t=[1.25331414,-.07832358,.02189568,-.01062446,.00587872,-.0025154,53208e-8].reverse();var r=[1,.15443144,-.67278579,-.18156897,-.01919402,-.00110404,-4686e-8].reverse(),n=[1.25331414,.23498619,-.0365562,.01504268,-.00780353,.00325614,-68245e-8].reverse();return wz((function(r){return r<=2?-gz.log(r/2)*Fz(r,0)+fz(e,r*r/4):gz.exp(-r)/gz.sqrt(r)*fz(t,2/r)}),(function(e){return e<=2?gz.log(e/2)*Fz(e,1)+1/e*fz(r,e*e/4):gz.exp(-e)/gz.sqrt(e)*fz(n,2/e)}),0,2,1)}();
/**
 * @license
 Copyright (c) 2013 jStat

 Permission is hereby granted, free of charge, to any person obtaining a copy
 of this software and associated documentation files (the "Software"), to deal
 in the Software without restriction, including without limitation the rights
 to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 copies of the Software, and to permit persons to whom the Software is
 furnished to do so, subject to the following conditions:

 The above copyright notice and this permission notice shall be included in
 all copies or substantial portions of the Software.

 THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 THE SOFTWARE.
 */
function Vz(e){const t=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-.000946595344482036,.000366839497852761,42523324806907e-18,-20278578112534e-18,-1624290004647e-18,130365583558e-17,1.5626441722e-8,-8.5238095915e-8,6.529054439e-9,5.059343495e-9,-9.91364156e-10,-2.27365122e-10,96467911e-18,2394038e-18,-6886027e-18,894487e-18,313092e-18,-112708e-18,381e-18,7106e-18,-1523e-18,-94e-18,121e-18,-28e-18];let r,n,o,i,s=t.length-1,a=!1,l=0,u=0;if(0===e)return 0;for(e<0&&(e=-e,a=!0),r=2/(2+e),n=4*r-2;s>0;s--)o=l,l=n*l-u+t[s],u=o;return i=r*Math.exp(-e*e+.5*(t[0]+n*l)-u),a?i-1:1-i}function Hz(e){return 1-Vz(e)}function Dz(e){let t,r,n,o,i=0;if(e>=2)return-100;if(e<=0)return 100;for(o=e<1?e:2-e,n=Math.sqrt(-2*Math.log(o/2)),t=-.70711*((2.30753+.27061*n)/(1+n*(.99229+.04481*n))-n);i<2;i++)r=Hz(t)-o,t+=r/(1.1283791670955126*Math.exp(-t*t)-t*r);return e<1?t:-t}const Uz=(e,t)=>e<0?0:t*Math.exp(-t*e),kz=(e,t)=>e<0?0:1-Math.exp(-t*e);function Bz(e){const t=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],r=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535];let n,o,i,s,a=!1,l=0,u=0,h=0,c=e;if(e>171.6243769536076)return 1/0;if(c<=0){if(s=c%1,!s)return 1/0;a=(1&c?-1:1)*Math.PI/Math.sin(Math.PI*s),c=1-c}for(i=c,o=c<1?c++:(c-=l=(0|c)-1)-1,n=0;n<8;++n)h=(h+t[n])*o,u=u*o+r[n];if(s=h/u+1,i<c)s/=i;else if(i>c)for(n=0;n<l;++n)s*=c,c++;return a&&(s=a/s),s}const Wz=function(e,t,r){return e<0?0:0===e&&1===t?1/r:Math.exp((t-1)*Math.log(e)-e/r-zz(t)-t*Math.log(r))},Gz=function(e,t,r){return e<0?0:$z(t,e/r)},jz=function(e,t,r){return Yz(e,t)*r};function zz(e){let t=0;const r=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18];let n,o,i,s=1.000000000190015;for(i=(o=n=e)+5.5,i-=(n+.5)*Math.log(i);t<6;t++)s+=r[t]/++o;return Math.log(2.5066282746310007*s/n)-i}function $z(e,t){const r=zz(e);let n=e,o=1/e,i=o,s=t+1-e,a=1/1e-30,l=1/s,u=l,h=1;const c=-~(8.5*Math.log(e>=1?e:1/e)+.4*e+17);let d;if(t<0||e<=0)return NaN;if(t<e+1){for(;h<=c;h++)o+=i*=t/++n;return o*Math.exp(-t+e*Math.log(t)-r)}for(;h<=c;h++)d=-h*(h-e),s+=2,l=d*l+s,a=s+d/a,l=1/l,u*=l*a;return 1-u*Math.exp(-t+e*Math.log(t)-r)}function Yz(e,t){let r=0;const n=t-1,o=zz(t);let i,s,a,l,u,h,c;if(e>=1)return Math.max(100,t+100*Math.sqrt(t));if(e<=0)return 0;for(t>1?(h=Math.log(n),c=Math.exp(n*(h-1)-o),u=e<.5?e:1-e,a=Math.sqrt(-2*Math.log(u)),i=(2.30753+.27061*a)/(1+a*(.99229+.04481*a))-a,e<.5&&(i=-i),i=Math.max(.001,t*Math.pow(1-1/(9*t)-i/(3*Math.sqrt(t)),3))):(a=1-t*(.253+.12*t),i=e<a?Math.pow(e/a,1/t):1-Math.log(1-(e-a)/(1-a)));r<12;r++){if(i<=0)return 0;if(s=$z(t,i)-e,a=t>1?c*Math.exp(-(i-n)+n*(Math.log(i)-h)):Math.exp(-i+n*Math.log(i)-o),l=s/a,i-=a=l/(1-.5*Math.min(1,l*((t-1)/i-1))),i<=0&&(i=.5*(i+a)),Math.abs(a)<1e-8*i)break}return i}const Xz=function(e,t,r){return Math.exp(-.5*Math.log(2*Math.PI)-Math.log(r)-Math.pow(e-t,2)/(2*r*r))},Kz=function(e,t,r){return.5*(1+Vz((e-t)/Math.sqrt(2*r*r)))},qz=function(e,t,r){return-1.4142135623730951*r*Dz(2*e)+t},Qz=function(e,t,r){return e>1||e<0?0:1==t&&1==r?1:t<512&&r<512?Math.pow(e,t-1)*Math.pow(1-e,r-1)/e$(t,r):Math.exp((t-1)*Math.log(e)+(r-1)*Math.log(1-e)-t$(t,r))},Zz=function(e,t,r){return e>1||e<0?+(e>1):n$(e,t,r)},Jz=function(e,t,r){return r$(e,t,r)};function e$(e,t){if(!(e<=0||t<=0))return e+t>170?Math.exp(t$(e,t)):Bz(e)*Bz(t)/Bz(e+t)}function t$(e,t){return zz(e)+zz(t)-zz(e+t)}function r$(e,t,r){var n,o,i,s,a,l,u,h,c,d,p=t-1,m=r-1,g=0;if(e<=0)return 0;if(e>=1)return 1;for(t>=1&&r>=1?(i=e<.5?e:1-e,l=(2.30753+.27061*(s=Math.sqrt(-2*Math.log(i))))/(1+s*(.99229+.04481*s))-s,e<.5&&(l=-l),u=(l*l-3)/6,h=2/(1/(2*t-1)+1/(2*r-1)),c=l*Math.sqrt(u+h)/h-(1/(2*r-1)-1/(2*t-1))*(u+5/6-2/(3*h)),l=t/(t+r*Math.exp(2*c))):(n=Math.log(t/(t+r)),o=Math.log(r/(t+r)),l=e<(s=Math.exp(t*n)/t)/(c=s+(a=Math.exp(r*o)/r))?Math.pow(t*c*e,1/t):1-Math.pow(r*c*(1-e),1/r)),d=-zz(t)-zz(r)+zz(t+r);g<10;g++){if(0===l||1===l)return l;if((l-=s=(a=(n$(l,t,r)-e)/(s=Math.exp(p*Math.log(l)+m*Math.log(1-l)+d)))/(1-.5*Math.min(1,a*(p/l-m/(1-l)))))<=0&&(l=.5*(l+s)),l>=1&&(l=.5*(l+s+1)),Math.abs(s)<1e-8*l&&g>0)break}return l}function n$(e,t,r){var n=0===e||1===e?0:Math.exp(zz(t+r)-zz(t)-zz(r)+t*Math.log(e)+r*Math.log(1-e));return!(e<0||e>1)&&(e<(t+1)/(t+r+2)?n*o$(e,t,r)/t:1-n*o$(1-e,r,t)/r)}function o$(e,t,r){var n,o,i,s,a=1e-30,l=1,u=t+r,h=t+1,c=t-1,d=1,p=1-u*e/h;for(Math.abs(p)<a&&(p=a),s=p=1/p;l<=100&&(p=1+(o=l*(r-l)*e/((c+(n=2*l))*(t+n)))*p,Math.abs(p)<a&&(p=a),d=1+o/d,Math.abs(d)<a&&(d=a),s*=(p=1/p)*d,p=1+(o=-(t+l)*(u+l)*e/((t+n)*(h+n)))*p,Math.abs(p)<a&&(p=a),d=1+o/d,Math.abs(d)<a&&(d=a),s*=i=(p=1/p)*d,!(Math.abs(i-1)<3e-7));l++);return s}const i$=function(e,t,r){return 0===r||1===r?t*r===e?1:0:l$(t,e)*Math.pow(r,e)*Math.pow(1-r,t-e)},s$=function(e,t,r){var n,o=1e-10;if(e<0)return 0;if(e>=t)return 1;if(r<0||r>1||t<=0)return NaN;var i=r,s=(e=Math.floor(e))+1,a=t-e,l=s+a,u=Math.exp(zz(l)-zz(a)-zz(s)+s*Math.log(i)+a*Math.log(1-i));return n=i<(s+1)/(l+2)?u*a$(i,s,a,o):1-u*a$(1-i,a,s,o),Math.round(1/o*(1-n))/(1/o)};function a$(e,t,r,n){for(var o,i=0,s=1,a=1,l=1,u=0,h=0;Math.abs((a-h)/a)>n;)h=a,s=l+(o=-(t+u)*(t+r+u)*e/(t+2*u)/(t+2*u+1))*s,a=(i=a+o*i)+(o=(u+=1)*(r-u)*e/(t+2*u-1)/(t+2*u))*a,i/=l=s+o*l,s/=l,a/=l,l=1;return a/t}function l$(e,t){return e>170||t>170?Math.exp(function(e,t){return u$(e)-u$(t)-u$(e-t)}(e,t)):h$(e)/h$(t)/h$(e-t)}function u$(e){return e<0?NaN:zz(e+1)}function h$(e){return e<0?NaN:Bz(e+1)}const c$=function(e,t){return e<0?0:0===e&&2===t?.5:Math.exp((t/2-1)*Math.log(e)-e/2-t/2*Math.log(2)-zz(t/2))},d$=function(e,t){return e<0?0:$z(t/2,e/2)},p$=function(e,t){return 2*Yz(e,.5*t)},m$=function(e,t,r){return e<0?0:t<=2?0===e&&t<2?1/0:0===e&&2===t?1:1/e$(t/2,r/2)*Math.pow(t/r,t/2)*Math.pow(e,t/2-1)*Math.pow(1+t/r*e,-(t+r)/2):t*(r/(r+e*t))/2*i$((t-2)/2,(t+r-2)/2,t*e/(r+e*t))},g$=function(e,t,r){return e<0?0:n$(t*e/(t*e+r),t/2,r/2)},f$=function(e,t,r){return r/(t*(1/r$(e,t/2,r/2)-1))},y$=function(e,t,r){return e<0||t<0||r<0?0:r/t*Math.pow(e/t,r-1)*Math.exp(-Math.pow(e/t,r))},w$=function(e,t,r){return e<0?0:1-Math.exp(-Math.pow(e/t,r))},E$={pdf:function(e,t){return t<0||e%1!=0||e<0?0:Math.pow(t,e)*Math.exp(-t)/h$(e)},cdf:function(e,t){var r=0;if(e<0)return 0;for(var n=0;r<=e;r++)n+=E$.pdf(r,t);return n}},v$={pdf:function(e,t,r,n){if(e<0||e<r-(t-n))return 0;if(e>n||e>r)return 0;if(2*r>t)return 2*n>t?v$.pdf(t-r-n+e,t,t-r,t-n):v$.pdf(n-e,t,t-r,n);if(2*n>t)return v$.pdf(r-e,t,r,t-n);if(r<n)return v$.pdf(e,t,n,r);for(var o=1,i=0,s=0;s<e;s++){for(;o>1&&i<n;)o*=1-r/(t-i),i++;o*=(n-s)*(r-s)/((s+1)*(t-r-n+s+1))}for(;i<n;i++)o*=1-r/(t-i);return Math.min(1,Math.max(0,o))},cdf:function e(t,r,n,o){if(t<0||t<n-(r-o))return 0;if(t>=o||t>=n)return 1;if(2*n>r)return 2*o>r?e(r-n-o+t,r,r-n,r-o):1-v$.cdf(o-t-1,r,r-n,o);if(2*o>r)return 1-v$.cdf(n-t-1,r,n,r-o);if(n<o)return v$.cdf(t,r,o,n);for(var i=1,s=1,a=0,l=0;l<t;l++){for(;i>1&&a<o;){var u=1-n/(r-a);s*=u,i*=u,a++}i+=s*=(o-l)*(n-l)/((l+1)*(r-n-o+l+1))}for(;a<o;a++)i*=1-n/(r-a);return Math.min(1,Math.max(0,i))}},R$=function(e,t){return t=t>1e100?1e100:t,1/(Math.sqrt(t)*e$(.5,t/2))*Math.pow(1+e*e/t,-(t+1)/2)},S$=function(e,t){var r=t/2;return n$((e+Math.sqrt(e*e+t))/(2*Math.sqrt(e*e+t)),r,r)},T$=function(e,t){var r=r$(2*Math.min(e,1-e),.5*t,.5);return r=Math.sqrt(t*(1-r)/r),e>.5?r:-r},C$=function(e,t,r){return e<=0?0:Math.exp(-Math.log(e)-.5*Math.log(2*Math.PI)-Math.log(r)-Math.pow(Math.log(e)-t,2)/(2*r*r))},b$=function(e,t,r){return e<0?0:.5+.5*Vz((Math.log(e)-t)/Math.sqrt(2*r*r))},N$=function(e,t,r){return Math.exp(-1.4142135623730951*r*Dz(2*e)+t)},A$={pdf:function(e,t,r){return e===e>>>0&&(e<0?0:l$(e+t-1,t-1)*Math.pow(1-r,e)*Math.pow(r,t))},cdf:function(e,t,r){var n=0,o=0;if(e<0)return 0;for(;o<=e;o++)n+=A$.pdf(o,t,r);return n}};function I$(e){for(var t=0,r=e.length;--r>=0;)t+=e[r];return t}function O$(e){return I$(e)/e.length}function M$(e){for(var t,r=O$(e),n=0,o=e.length;--o>=0;)n+=(t=e[o]-r)*t;return n}function _$(e,t){return M$(e)/(e.length-(t?1:0))}function x$(e,t){return Math.sqrt(_$(e,t))}function L$(e,t){var r,n=O$(e),o=O$(t),i=e.length,s=new Array(i);for(r=0;r<i;r++)s[r]=(e[r]-n)*(t[r]-o);return I$(s)/(i-1)}function F$(e,t){return L$(e,t)/x$(e,1)/x$(t,1)}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class P$ extends Zk{erf(e,t){return this.runFunction(e.args,t,this.metadata("ERF"),((e,t)=>void 0===t?Vz(e):Vz(t)-Vz(e)))}erfc(e,t){return this.runFunction(e.args,t,this.metadata("ERFC"),Hz)}expondist(e,t){return this.runFunction(e.args,t,this.metadata("EXPON.DIST"),((e,t,r)=>r?kz(e,t):Uz(e,t)))}fisher(e,t){return this.runFunction(e.args,t,this.metadata("FISHER"),(e=>Math.log((1+e)/(1-e))/2))}fisherinv(e,t){return this.runFunction(e.args,t,this.metadata("FISHERINV"),(e=>1-2/(Math.exp(2*e)+1)))}gamma(e,t){return this.runFunction(e.args,t,this.metadata("GAMMA"),Bz)}gammadist(e,t){return this.runFunction(e.args,t,this.metadata("GAMMA.DIST"),((e,t,r,n)=>n?Gz(e,t,r):Wz(e,t,r)))}gammaln(e,t){return this.runFunction(e.args,t,this.metadata("GAMMALN"),zz)}gammainv(e,t){return this.runFunction(e.args,t,this.metadata("GAMMA.INV"),jz)}gauss(e,t){return this.runFunction(e.args,t,this.metadata("GAUSS"),(e=>Kz(e,0,1)-.5))}betadist(e,t){return this.runFunction(e.args,t,this.metadata("BETA.DIST"),((e,t,r,n,o,i)=>e<=o?new pk(XU.NUM,BH.ValueSmall):e>=i?new pk(XU.NUM,BH.ValueLarge):(e=(e-o)/(i-o),n?Zz(e,t,r):Qz(e,t,r))))}betainv(e,t){return this.runFunction(e.args,t,this.metadata("BETA.INV"),((e,t,r,n,o)=>n>=o?new pk(XU.NUM,BH.WrongOrder):Jz(e,t,r)*(o-n)+n))}binomialdist(e,t){return this.runFunction(e.args,t,this.metadata("BINOM.DIST"),((e,t,r,n)=>e>t?new pk(XU.NUM,BH.WrongOrder):(e=Math.trunc(e),t=Math.trunc(t),n?s$(e,t,r):i$(e,t,r))))}binomialinv(e,t){return this.runFunction(e.args,t,this.metadata("BINOM.INV"),((e,t,r)=>{let n=-1,o=e=Math.trunc(e);for(;o>n+1;){const i=Math.trunc((n+o)/2);s$(i,e,t)>=r?o=i:n=i}return o}))}besselifn(e,t){return this.runFunction(e.args,t,this.metadata("BESSELI"),((e,t)=>Fz(e,Math.trunc(t))))}besseljfn(e,t){return this.runFunction(e.args,t,this.metadata("BESSELJ"),((e,t)=>xz(e,Math.trunc(t))))}besselkfn(e,t){return this.runFunction(e.args,t,this.metadata("BESSELK"),((e,t)=>Pz(e,Math.trunc(t))))}besselyfn(e,t){return this.runFunction(e.args,t,this.metadata("BESSELY"),((e,t)=>Lz(e,Math.trunc(t))))}chisqdist(e,t){return this.runFunction(e.args,t,this.metadata("CHISQ.DIST"),((e,t,r)=>(t=Math.trunc(t),r?d$(e,t):c$(e,t))))}chisqdistrt(e,t){return this.runFunction(e.args,t,this.metadata("CHISQ.DIST.RT"),((e,t)=>1-d$(e,Math.trunc(t))))}chisqinv(e,t){return this.runFunction(e.args,t,this.metadata("CHISQ.INV"),((e,t)=>p$(e,Math.trunc(t))))}chisqinvrt(e,t){return this.runFunction(e.args,t,this.metadata("CHISQ.INV.RT"),((e,t)=>p$(1-e,Math.trunc(t))))}fdist(e,t){return this.runFunction(e.args,t,this.metadata("F.DIST"),((e,t,r,n)=>(t=Math.trunc(t),r=Math.trunc(r),n?g$(e,t,r):m$(e,t,r))))}fdistrt(e,t){return this.runFunction(e.args,t,this.metadata("F.DIST.RT"),((e,t,r)=>1-g$(e,Math.trunc(t),Math.trunc(r))))}finv(e,t){return this.runFunction(e.args,t,this.metadata("F.INV"),((e,t,r)=>f$(e,Math.trunc(t),Math.trunc(r))))}finvrt(e,t){return this.runFunction(e.args,t,this.metadata("F.INV.RT"),((e,t,r)=>f$(1-e,Math.trunc(t),Math.trunc(r))))}weibulldist(e,t){return this.runFunction(e.args,t,this.metadata("WEIBULL.DIST"),((e,t,r,n)=>n?w$(e,r,t):y$(e,r,t)))}poissondist(e,t){return this.runFunction(e.args,t,this.metadata("POISSON.DIST"),((e,t,r)=>(e=Math.trunc(e),r?E$.cdf(e,t):E$.pdf(e,t))))}hypgeomdist(e,t){return this.runFunction(e.args,t,this.metadata("HYPGEOM.DIST"),((e,t,r,n,o)=>e>t||e>r||t>n||r>n||e+n<r+t?new pk(XU.NUM,BH.ValueLarge):(e=Math.trunc(e),t=Math.trunc(t),r=Math.trunc(r),n=Math.trunc(n),o?v$.cdf(e,n,r,t):v$.pdf(e,n,r,t))))}tdist(e,t){return this.runFunction(e.args,t,this.metadata("T.DIST"),((e,t,r)=>(t=Math.trunc(t),r?S$(e,t):R$(e,t))))}tdist2t(e,t){return this.runFunction(e.args,t,this.metadata("T.DIST.2T"),((e,t)=>2*(1-S$(e,Math.trunc(t)))))}tdistrt(e,t){return this.runFunction(e.args,t,this.metadata("T.DIST.RT"),((e,t)=>1-S$(e,Math.trunc(t))))}tdistold(e,t){return this.runFunction(e.args,t,this.metadata("TDIST"),((e,t,r)=>r*(1-S$(e,Math.trunc(t)))))}tinv(e,t){return this.runFunction(e.args,t,this.metadata("T.INV"),((e,t)=>T$(e,Math.trunc(t))))}tinv2t(e,t){return this.runFunction(e.args,t,this.metadata("T.INV.2T"),((e,t)=>T$(1-e/2,Math.trunc(t))))}lognormdist(e,t){return this.runFunction(e.args,t,this.metadata("LOGNORM.DIST"),((e,t,r,n)=>n?b$(e,t,r):C$(e,t,r)))}lognorminv(e,t){return this.runFunction(e.args,t,this.metadata("LOGNORM.INV"),((e,t,r)=>N$(e,t,r)))}normdist(e,t){return this.runFunction(e.args,t,this.metadata("NORM.DIST"),((e,t,r,n)=>n?Kz(e,t,r):Xz(e,t,r)))}norminv(e,t){return this.runFunction(e.args,t,this.metadata("NORM.INV"),((e,t,r)=>qz(e,t,r)))}normsdist(e,t){return this.runFunction(e.args,t,this.metadata("NORM.S.DIST"),((e,t)=>t?Kz(e,0,1):Xz(e,0,1)))}normsinv(e,t){return this.runFunction(e.args,t,this.metadata("NORM.S.INV"),(e=>qz(e,0,1)))}phi(e,t){return this.runFunction(e.args,t,this.metadata("PHI"),(e=>Xz(e,0,1)))}negbinomdist(e,t){return this.runFunction(e.args,t,this.metadata("NEGBINOM.DIST"),((e,t,r,n)=>(e=Math.trunc(e),t=Math.trunc(t),n?A$.cdf(e,t,r):A$.pdf(e,t,r))))}confidencenorm(e,t){return this.runFunction(e.args,t,this.metadata("CONFIDENCE.NORM"),((e,t,r)=>function(){var e,t=[].slice.call(arguments),r=new Array(2);return e=4===t.length?Math.abs(qz(t[1]/2,0,1)*t[2]/Math.sqrt(t[3])):Math.abs(qz(t[1]/2,0,1)*x$(t[2])/Math.sqrt(t[2].length)),r[0]=t[0]-e,r[1]=t[0]+e,r}(1,e,t,Math.trunc(r))[1]-1))}confidencet(e,t){return this.runFunction(e.args,t,this.metadata("CONFIDENCE.T"),((e,t,r)=>1===(r=Math.trunc(r))?new pk(XU.DIV_BY_ZERO):function(){var e,t=[].slice.call(arguments),r=new Array(2);return e=4===t.length?Math.abs(T$(t[1]/2,t[3]-1)*t[2]/Math.sqrt(t[3])):Math.abs(T$(t[1]/2,t[2].length-1)*x$(t[2],!0)/Math.sqrt(t[2].length)),r[0]=t[0]-e,r[1]=t[0]+e,r}(1,e,t,r)[1]-1))}standardize(e,t){return this.runFunction(e.args,t,this.metadata("STANDARDIZE"),((e,t,r)=>(e-t)/r))}}P$.implementedFunctions={ERF:{method:"erf",parameters:[{argumentType:Qk.NUMBER},{argumentType:Qk.NUMBER,optionalArg:!0}]},ERFC:{method:"erfc",parameters:[{argumentType:Qk.NUMBER}]},"EXPON.DIST":{method:"expondist",parameters:[{argumentType:Qk.NUMBER,minValue:0},{argumentType:Qk.NUMBER,greaterThan:0},{argumentType:Qk.BOOLEAN}]},FISHER:{method:"fisher",parameters:[{argumentType:Qk.NUMBER,greaterThan:-1,lessThan:1}]},FISHERINV:{method:"fisherinv",parameters:[{argumentType:Qk.NUMBER}]},GAMMA:{method:"gamma",parameters:[{argumentType:Qk.NUMBER}]},"GAMMA.DIST":{method:"gammadist",parameters:[{argumentType:Qk.NUMBER,minValue:0},{argumentType:Qk.NUMBER,greaterThan:0},{argumentType:Qk.NUMBER,greaterThan:0},{argumentType:Qk.BOOLEAN}]},GAMMALN:{method:"gammaln",parameters:[{argumentType:Qk.NUMBER,greaterThan:0}]},"GAMMA.INV":{method:"gammainv",parameters:[{argumentType:Qk.NUMBER,minValue:0,lessThan:1},{argumentType:Qk.NUMBER,greaterThan:0},{argumentType:Qk.NUMBER,greaterThan:0}]},GAUSS:{method:"gauss",parameters:[{argumentType:Qk.NUMBER}]},"BETA.DIST":{method:"betadist",parameters:[{argumentType:Qk.NUMBER},{argumentType:Qk.NUMBER,greaterThan:0},{argumentType:Qk.NUMBER,greaterThan:0},{argumentType:Qk.BOOLEAN},{argumentType:Qk.NUMBER,defaultValue:0},{argumentType:Qk.NUMBER,defaultValue:1}]},"BETA.INV":{method:"betainv",parameters:[{argumentType:Qk.NUMBER,greaterThan:0,maxValue:1},{argumentType:Qk.NUMBER,greaterThan:0},{argumentType:Qk.NUMBER,greaterThan:0},{argumentType:Qk.NUMBER,defaultValue:0},{argumentType:Qk.NUMBER,defaultValue:1}]},"BINOM.DIST":{method:"binomialdist",parameters:[{argumentType:Qk.NUMBER,minValue:0},{argumentType:Qk.NUMBER,minValue:0},{argumentType:Qk.NUMBER,minValue:0,maxValue:1},{argumentType:Qk.BOOLEAN}]},"BINOM.INV":{method:"binomialinv",parameters:[{argumentType:Qk.NUMBER,minValue:0},{argumentType:Qk.NUMBER,minValue:0,maxValue:1},{argumentType:Qk.NUMBER,greaterThan:0,lessThan:1}]},BESSELI:{method:"besselifn",parameters:[{argumentType:Qk.NUMBER},{argumentType:Qk.NUMBER,minValue:0}]},BESSELJ:{method:"besseljfn",parameters:[{argumentType:Qk.NUMBER},{argumentType:Qk.NUMBER,minValue:0}]},BESSELK:{method:"besselkfn",parameters:[{argumentType:Qk.NUMBER},{argumentType:Qk.NUMBER,minValue:0}]},BESSELY:{method:"besselyfn",parameters:[{argumentType:Qk.NUMBER},{argumentType:Qk.NUMBER,minValue:0}]},"CHISQ.DIST":{method:"chisqdist",parameters:[{argumentType:Qk.NUMBER},{argumentType:Qk.NUMBER,minValue:1,maxValue:1e10},{argumentType:Qk.BOOLEAN}]},"CHISQ.DIST.RT":{method:"chisqdistrt",parameters:[{argumentType:Qk.NUMBER},{argumentType:Qk.NUMBER,minValue:1,maxValue:1e10}]},"CHISQ.INV":{method:"chisqinv",parameters:[{argumentType:Qk.NUMBER,minValue:0,maxValue:1},{argumentType:Qk.NUMBER,minValue:1,maxValue:1e10}]},"CHISQ.INV.RT":{method:"chisqinvrt",parameters:[{argumentType:Qk.NUMBER,minValue:0,maxValue:1},{argumentType:Qk.NUMBER,minValue:1}]},"F.DIST":{method:"fdist",parameters:[{argumentType:Qk.NUMBER,minValue:0},{argumentType:Qk.NUMBER,minValue:1},{argumentType:Qk.NUMBER,minValue:1},{argumentType:Qk.BOOLEAN}]},"F.DIST.RT":{method:"fdistrt",parameters:[{argumentType:Qk.NUMBER,minValue:0},{argumentType:Qk.NUMBER,minValue:1},{argumentType:Qk.NUMBER,minValue:1}]},"F.INV":{method:"finv",parameters:[{argumentType:Qk.NUMBER,minValue:0,maxValue:1},{argumentType:Qk.NUMBER,minValue:1},{argumentType:Qk.NUMBER,minValue:1}]},"F.INV.RT":{method:"finvrt",parameters:[{argumentType:Qk.NUMBER,minValue:0,maxValue:1},{argumentType:Qk.NUMBER,minValue:1},{argumentType:Qk.NUMBER,minValue:1}]},"WEIBULL.DIST":{method:"weibulldist",parameters:[{argumentType:Qk.NUMBER,minValue:0},{argumentType:Qk.NUMBER,greaterThan:0},{argumentType:Qk.NUMBER,greaterThan:0},{argumentType:Qk.BOOLEAN}]},"POISSON.DIST":{method:"poissondist",parameters:[{argumentType:Qk.NUMBER,minValue:0},{argumentType:Qk.NUMBER,minValue:0},{argumentType:Qk.BOOLEAN}]},"HYPGEOM.DIST":{method:"hypgeomdist",parameters:[{argumentType:Qk.NUMBER,minValue:0},{argumentType:Qk.NUMBER,greaterThan:0},{argumentType:Qk.NUMBER,greaterThan:0},{argumentType:Qk.NUMBER,greaterThan:0},{argumentType:Qk.BOOLEAN}]},"T.DIST":{method:"tdist",parameters:[{argumentType:Qk.NUMBER},{argumentType:Qk.NUMBER,minValue:1},{argumentType:Qk.BOOLEAN}]},"T.DIST.2T":{method:"tdist2t",parameters:[{argumentType:Qk.NUMBER,minValue:0},{argumentType:Qk.NUMBER,minValue:1}]},"T.DIST.RT":{method:"tdistrt",parameters:[{argumentType:Qk.NUMBER},{argumentType:Qk.NUMBER,minValue:1}]},TDIST:{method:"tdistold",parameters:[{argumentType:Qk.NUMBER,minValue:0},{argumentType:Qk.NUMBER,minValue:1},{argumentType:Qk.INTEGER,minValue:1,maxValue:2}]},"T.INV":{method:"tinv",parameters:[{argumentType:Qk.NUMBER,greaterThan:0,lessThan:1},{argumentType:Qk.NUMBER,minValue:1}]},"T.INV.2T":{method:"tinv2t",parameters:[{argumentType:Qk.NUMBER,greaterThan:0,maxValue:1},{argumentType:Qk.NUMBER,minValue:1}]},"LOGNORM.DIST":{method:"lognormdist",parameters:[{argumentType:Qk.NUMBER,greaterThan:0},{argumentType:Qk.NUMBER},{argumentType:Qk.NUMBER,greaterThan:0},{argumentType:Qk.BOOLEAN}]},"LOGNORM.INV":{method:"lognorminv",parameters:[{argumentType:Qk.NUMBER,greaterThan:0,lessThan:1},{argumentType:Qk.NUMBER},{argumentType:Qk.NUMBER,greaterThan:0}]},"NORM.DIST":{method:"normdist",parameters:[{argumentType:Qk.NUMBER},{argumentType:Qk.NUMBER},{argumentType:Qk.NUMBER,greaterThan:0},{argumentType:Qk.BOOLEAN}]},"NORM.INV":{method:"norminv",parameters:[{argumentType:Qk.NUMBER,greaterThan:0,lessThan:1},{argumentType:Qk.NUMBER},{argumentType:Qk.NUMBER,greaterThan:0}]},"NORM.S.DIST":{method:"normsdist",parameters:[{argumentType:Qk.NUMBER},{argumentType:Qk.BOOLEAN}]},"NORM.S.INV":{method:"normsinv",parameters:[{argumentType:Qk.NUMBER,greaterThan:0,lessThan:1}]},PHI:{method:"phi",parameters:[{argumentType:Qk.NUMBER}]},"NEGBINOM.DIST":{method:"negbinomdist",parameters:[{argumentType:Qk.NUMBER,minValue:0},{argumentType:Qk.NUMBER,minValue:1},{argumentType:Qk.NUMBER,minValue:0,maxValue:1},{argumentType:Qk.BOOLEAN}]},"CONFIDENCE.NORM":{method:"confidencenorm",parameters:[{argumentType:Qk.NUMBER,greaterThan:0,lessThan:1},{argumentType:Qk.NUMBER,greaterThan:0},{argumentType:Qk.NUMBER,minValue:1}]},"CONFIDENCE.T":{method:"confidencet",parameters:[{argumentType:Qk.NUMBER,greaterThan:0,lessThan:1},{argumentType:Qk.NUMBER,greaterThan:0},{argumentType:Qk.NUMBER,minValue:1}]},STANDARDIZE:{method:"standardize",parameters:[{argumentType:Qk.NUMBER},{argumentType:Qk.NUMBER},{argumentType:Qk.NUMBER,greaterThan:0}]}},P$.aliases={NEGBINOMDIST:"NEGBINOM.DIST",EXPONDIST:"EXPON.DIST",BETADIST:"BETA.DIST",NORMDIST:"NORM.DIST",NORMINV:"NORM.INV",NORMSDIST:"NORM.S.DIST",NORMSINV:"NORM.S.INV",LOGNORMDIST:"LOGNORM.DIST",LOGINV:"LOGNORM.INV",TINV:"T.INV.2T",HYPGEOMDIST:"HYPGEOM.DIST",POISSON:"POISSON.DIST",WEIBULL:"WEIBULL.DIST",FINV:"F.INV.RT",FDIST:"F.DIST.RT",CHIDIST:"CHISQ.DIST.RT",CHIINV:"CHISQ.INV.RT",GAMMADIST:"GAMMA.DIST","GAMMALN.PRECISE":"GAMMALN",GAMMAINV:"GAMMA.INV",BETAINV:"BETA.INV",BINOMDIST:"BINOM.DIST",CONFIDENCE:"CONFIDENCE.NORM",CRITBINOM:"BINOM.INV",WEIBULLDIST:"WEIBULL.DIST",TINV2T:"T.INV.2T",TDISTRT:"T.DIST.RT",TDIST2T:"T.DIST.2T",FINVRT:"F.INV.RT",FDISTRT:"F.DIST.RT",CHIDISTRT:"CHISQ.DIST.RT",CHIINVRT:"CHISQ.INV.RT",LOGNORMINV:"LOGNORM.INV",POISSONDIST:"POISSON.DIST"};
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
class V$ extends Zk{fact(e,t){return this.runFunction(e.args,t,this.metadata("FACT"),(e=>{e=Math.trunc(e);let t=1;for(let r=1;r<=e;r++)t*=r;return t}))}factdouble(e,t){return this.runFunction(e.args,t,this.metadata("FACTDOUBLE"),(e=>{let t=1;for(let r=e=Math.trunc(e);r>=1;r-=2)t*=r;return t}))}combin(e,t){return this.runFunction(e.args,t,this.metadata("COMBIN"),((e,t)=>t>e?new pk(XU.NUM,BH.WrongOrder):H$(e=Math.trunc(e),t=Math.trunc(t))))}combina(e,t){return this.runFunction(e.args,t,this.metadata("COMBINA"),((e,t)=>(e=Math.trunc(e))+(t=Math.trunc(t))-1>=1030?new pk(XU.NUM,BH.ValueLarge):0===e&&0===t?1:H$(e+t-1,t)))}gcd(e,t){return this.runFunction(e.args,t,this.metadata("GCD"),((...e)=>{const t=this.arithmeticHelper.coerceNumbersCoerceRangesDropNulls(e);if(t instanceof pk)return t;let r=0;for(const n of t){if(n<0)return new pk(XU.NUM,BH.ValueSmall);r=D$(r,Math.trunc(n))}return r>Number.MAX_SAFE_INTEGER?new pk(XU.NUM,BH.ValueLarge):r}))}lcm(e,t){return this.runFunction(e.args,t,this.metadata("LCM"),((...e)=>{const t=this.arithmeticHelper.coerceNumbersCoerceRangesDropNulls(e);if(t instanceof pk)return t;let r=1;for(const n of t){if(n<0)return new pk(XU.NUM,BH.ValueSmall);r=U$(r,Math.trunc(n))}return r>Number.MAX_SAFE_INTEGER?new pk(XU.NUM,BH.ValueLarge):r}))}mround(e,t){return this.runFunction(e.args,t,this.metadata("MROUND"),((e,t)=>0===t?0:e>0&&t<0||e<0&&t>0?new pk(XU.NUM,BH.DistinctSigns):Math.round(e/t)*t))}multinomial(e,t){return this.runFunction(e.args,t,this.metadata("MULTINOMIAL"),((...e)=>{let t=0,r=1;for(let n of e){if(n<0)return new pk(XU.NUM,BH.ValueSmall);n=Math.trunc(n);for(let e=1;e<=n;e++)r*=(t+e)/e;t+=n}return Math.round(r)}))}quotient(e,t){return this.runFunction(e.args,t,this.metadata("QUOTIENT"),((e,t)=>0===t?new pk(XU.DIV_BY_ZERO):Math.trunc(e/t)))}seriessum(e,t){return this.runFunction(e.args,t,this.metadata("SERIESSUM"),((e,t,r,n)=>{const o=this.arithmeticHelper.manyToOnlyNumbersDropNulls(n.valuesFromTopLeftCorner());if(o instanceof pk)return o;let i=0;o.reverse();for(const s of o)i*=Math.pow(e,r),i+=s;return i*Math.pow(e,t)}))}sign(e,t){return this.runFunction(e.args,t,this.metadata("SIGN"),(e=>e>0?1:e<0?-1:0))}sumx2my2(e,t){return this.runFunction(e.args,t,this.metadata("SUMX2MY2"),((e,t)=>{const r=e.valuesFromTopLeftCorner(),n=t.valuesFromTopLeftCorner();if(r.length!==n.length)return new pk(XU.NA,BH.EqualLength);const o=r.length;let i=0;for(let s=0;s<o;s++){const e=r[s],t=n[s];if(e instanceof pk)return e;if(t instanceof pk)return t;"number"==typeof e&&"number"==typeof t&&(i+=Math.pow(e,2)-Math.pow(t,2))}return i}))}sumx2py2(e,t){return this.runFunction(e.args,t,this.metadata("SUMX2PY2"),((e,t)=>{const r=e.valuesFromTopLeftCorner(),n=t.valuesFromTopLeftCorner();if(r.length!==n.length)return new pk(XU.NA,BH.EqualLength);const o=r.length;let i=0;for(let s=0;s<o;s++){const e=r[s],t=n[s];if(e instanceof pk)return e;if(t instanceof pk)return t;"number"==typeof e&&"number"==typeof t&&(i+=Math.pow(e,2)+Math.pow(t,2))}return i}))}sumxmy2(e,t){return this.runFunction(e.args,t,this.metadata("SUMXMY2"),((e,t)=>{const r=e.valuesFromTopLeftCorner(),n=t.valuesFromTopLeftCorner();if(r.length!==n.length)return new pk(XU.NA,BH.EqualLength);const o=r.length;let i=0;for(let s=0;s<o;s++){const e=r[s],t=n[s];if(e instanceof pk)return e;if(t instanceof pk)return t;"number"==typeof e&&"number"==typeof t&&(i+=Math.pow(e-t,2))}return i}))}}function H$(e,t){2*t>e&&(t=e-t);let r=1;for(let n=1;n<=t;n++)r*=(e-t+n)/n;return Math.round(r)}function D$(e,t){for(e<t&&([e,t]=[t,e]);t>0;)[e,t]=[t,e%t];return e}function U$(e,t){return 0===e||0===t?0:e*(t/D$(e,t))}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */V$.implementedFunctions={FACT:{method:"fact",parameters:[{argumentType:Qk.NUMBER,minValue:0,maxValue:170}]},FACTDOUBLE:{method:"factdouble",parameters:[{argumentType:Qk.NUMBER,minValue:0,maxValue:288}]},COMBIN:{method:"combin",parameters:[{argumentType:Qk.NUMBER,minValue:0,lessThan:1030},{argumentType:Qk.NUMBER,minValue:0}]},COMBINA:{method:"combina",parameters:[{argumentType:Qk.NUMBER,minValue:0},{argumentType:Qk.NUMBER,minValue:0}]},GCD:{method:"gcd",parameters:[{argumentType:Qk.ANY}],repeatLastArgs:1},LCM:{method:"lcm",parameters:[{argumentType:Qk.ANY}],repeatLastArgs:1},MROUND:{method:"mround",parameters:[{argumentType:Qk.NUMBER},{argumentType:Qk.NUMBER}]},MULTINOMIAL:{method:"multinomial",parameters:[{argumentType:Qk.NUMBER}],repeatLastArgs:1,expandRanges:!0},QUOTIENT:{method:"quotient",parameters:[{argumentType:Qk.NUMBER},{argumentType:Qk.NUMBER}]},SERIESSUM:{method:"seriessum",parameters:[{argumentType:Qk.NUMBER},{argumentType:Qk.NUMBER},{argumentType:Qk.NUMBER},{argumentType:Qk.RANGE}]},SIGN:{method:"sign",parameters:[{argumentType:Qk.NUMBER}]},SUMX2MY2:{method:"sumx2my2",parameters:[{argumentType:Qk.RANGE},{argumentType:Qk.RANGE}]},SUMX2PY2:{method:"sumx2py2",parameters:[{argumentType:Qk.RANGE},{argumentType:Qk.RANGE}]},SUMXMY2:{method:"sumxmy2",parameters:[{argumentType:Qk.RANGE},{argumentType:Qk.RANGE}]}};class k$ extends Zk{complex(e,t){return this.runFunction(e.args,t,this.metadata("COMPLEX"),((e,t,r)=>"i"!==r&&"j"!==r?new pk(XU.VALUE,BH.ShouldBeIorJ):Lk([e,t],r)))}imabs(e,t){return this.runFunction(e.args,t,this.metadata("IMABS"),K$)}imaginary(e,t){return this.runFunction(e.args,t,this.metadata("IMAGINARY"),(([e,t])=>t))}imreal(e,t){return this.runFunction(e.args,t,this.metadata("IMREAL"),(([e,t])=>e))}imargument(e,t){return this.runFunction(e.args,t,this.metadata("IMARGUMENT"),(([e,t])=>0===e&&0===t?new pk(XU.DIV_BY_ZERO):Math.atan2(t,e)))}imconjugate(e,t){return this.runFunction(e.args,t,this.metadata("IMCONJUGATE"),(([e,t])=>Lk([e,-t])))}imcos(e,t){return this.runFunction(e.args,t,this.metadata("IMCOS"),(e=>Lk(j$(e))))}imcosh(e,t){return this.runFunction(e.args,t,this.metadata("IMCOSH"),(e=>Lk(z$(e))))}imcot(e,t){return this.runFunction(e.args,t,this.metadata("IMCOT"),(e=>Lk(G$(j$(e),$$(e)))))}imcsc(e,t){return this.runFunction(e.args,t,this.metadata("IMCSC"),(e=>Lk(G$([1,0],$$(e)))))}imcsch(e,t){return this.runFunction(e.args,t,this.metadata("IMCSCH"),(e=>Lk(G$([1,0],Y$(e)))))}imsec(e,t){return this.runFunction(e.args,t,this.metadata("IMSEC"),(e=>Lk(G$([1,0],j$(e)))))}imsech(e,t){return this.runFunction(e.args,t,this.metadata("IMSECH"),(e=>Lk(G$([1,0],z$(e)))))}imsin(e,t){return this.runFunction(e.args,t,this.metadata("IMSIN"),(e=>Lk($$(e))))}imsinh(e,t){return this.runFunction(e.args,t,this.metadata("IMSINH"),(e=>Lk(Y$(e))))}imtan(e,t){return this.runFunction(e.args,t,this.metadata("IMTAN"),(e=>Lk(G$($$(e),j$(e)))))}imdiv(e,t){return this.runFunction(e.args,t,this.metadata("IMDIV"),((e,t)=>Lk(G$(e,t))))}improduct(e,t){return this.runFunction(e.args,t,this.metadata("IMPRODUCT"),((...e)=>{const t=this.arithmeticHelper.coerceComplexExactRanges(e);if(t instanceof pk)return t;let r=[1,0];for(const n of t)r=W$(r,n);return Lk(r)}))}imsum(e,t){return this.runFunction(e.args,t,this.metadata("IMSUM"),((...e)=>{const t=this.arithmeticHelper.coerceComplexExactRanges(e);if(t instanceof pk)return t;let r=[0,0];for(const n of t)r=B$(r,n);return Lk(r)}))}imsub(e,t){return this.runFunction(e.args,t,this.metadata("IMSUB"),((e,t)=>Lk(function([e,t],[r,n]){return[e-r,t-n]}(e,t))))}imexp(e,t){return this.runFunction(e.args,t,this.metadata("IMEXP"),(e=>Lk(X$(e))))}imln(e,t){return this.runFunction(e.args,t,this.metadata("IMLN"),(e=>Lk(q$(e))))}imlog10(e,t){return this.runFunction(e.args,t,this.metadata("IMLOG10"),(e=>{const[t,r]=q$(e),n=Math.log(10);return Lk([t/n,r/n])}))}imlog2(e,t){return this.runFunction(e.args,t,this.metadata("IMLOG2"),(e=>{const[t,r]=q$(e),n=Math.log(2);return Lk([t/n,r/n])}))}impower(e,t){return this.runFunction(e.args,t,this.metadata("IMPOWER"),((e,t)=>Lk(Q$(e,t))))}imsqrt(e,t){return this.runFunction(e.args,t,this.metadata("IMSQRT"),(e=>Lk(Q$(e,.5))))}}function B$([e,t],[r,n]){return[e+r,t+n]}function W$([e,t],[r,n]){return[e*r-t*n,e*n+r*t]}function G$([e,t],[r,n]){const o=Math.pow(r,2)+Math.pow(n,2),[i,s]=W$([e,t],[r,-n]);return[i/o,s/o]}function j$([e,t]){return[Math.cos(e)*Math.cosh(t),-Math.sin(e)*Math.sinh(t)]}function z$([e,t]){return[Math.cosh(e)*Math.cos(t),Math.sinh(e)*Math.sin(t)]}function $$([e,t]){return[Math.sin(e)*Math.cosh(t),Math.cos(e)*Math.sinh(t)]}function Y$([e,t]){return[Math.sinh(e)*Math.cos(t),Math.cosh(e)*Math.sin(t)]}function X$([e,t]){return[Math.exp(e)*Math.cos(t),Math.exp(e)*Math.sin(t)]}function K$([e,t]){return Math.sqrt(e*e+t*t)}function q$([e,t]){return[Math.log(K$([e,t])),Math.atan2(t,e)]}function Q$(e,t){const[r,n]=q$(e);return X$([t*r,t*n])}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */k$.implementedFunctions={COMPLEX:{method:"complex",parameters:[{argumentType:Qk.NUMBER},{argumentType:Qk.NUMBER},{argumentType:Qk.STRING,defaultValue:"i"}]},IMABS:{method:"imabs",parameters:[{argumentType:Qk.COMPLEX}]},IMAGINARY:{method:"imaginary",parameters:[{argumentType:Qk.COMPLEX}]},IMREAL:{method:"imreal",parameters:[{argumentType:Qk.COMPLEX}]},IMARGUMENT:{method:"imargument",parameters:[{argumentType:Qk.COMPLEX}]},IMCONJUGATE:{method:"imconjugate",parameters:[{argumentType:Qk.COMPLEX}]},IMCOS:{method:"imcos",parameters:[{argumentType:Qk.COMPLEX}]},IMCOSH:{method:"imcosh",parameters:[{argumentType:Qk.COMPLEX}]},IMCOT:{method:"imcot",parameters:[{argumentType:Qk.COMPLEX}]},IMCSC:{method:"imcsc",parameters:[{argumentType:Qk.COMPLEX}]},IMCSCH:{method:"imcsch",parameters:[{argumentType:Qk.COMPLEX}]},IMSEC:{method:"imsec",parameters:[{argumentType:Qk.COMPLEX}]},IMSECH:{method:"imsech",parameters:[{argumentType:Qk.COMPLEX}]},IMSIN:{method:"imsin",parameters:[{argumentType:Qk.COMPLEX}]},IMSINH:{method:"imsinh",parameters:[{argumentType:Qk.COMPLEX}]},IMTAN:{method:"imtan",parameters:[{argumentType:Qk.COMPLEX}]},IMDIV:{method:"imdiv",parameters:[{argumentType:Qk.COMPLEX},{argumentType:Qk.COMPLEX}]},IMPRODUCT:{method:"improduct",parameters:[{argumentType:Qk.ANY}],repeatLastArgs:1},IMSUM:{method:"imsum",parameters:[{argumentType:Qk.ANY}],repeatLastArgs:1},IMSUB:{method:"imsub",parameters:[{argumentType:Qk.COMPLEX},{argumentType:Qk.COMPLEX}]},IMEXP:{method:"imexp",parameters:[{argumentType:Qk.COMPLEX}]},IMLN:{method:"imln",parameters:[{argumentType:Qk.COMPLEX}]},IMLOG10:{method:"imlog10",parameters:[{argumentType:Qk.COMPLEX}]},IMLOG2:{method:"imlog2",parameters:[{argumentType:Qk.COMPLEX}]},IMPOWER:{method:"impower",parameters:[{argumentType:Qk.COMPLEX},{argumentType:Qk.NUMBER}]},IMSQRT:{method:"imsqrt",parameters:[{argumentType:Qk.COMPLEX}]}};class Z$ extends Zk{avedev(e,t){return this.runFunction(e.args,t,this.metadata("AVEDEV"),((...e)=>{const t=this.arithmeticHelper.coerceNumbersExactRanges(e);if(t instanceof pk)return t;if(0===t.length)return new pk(XU.DIV_BY_ZERO);const r=O$(t);return t.reduce(((e,t)=>e+Math.abs(t-r)),0)/t.length}))}devsq(e,t){return this.runFunction(e.args,t,this.metadata("DEVSQ"),((...e)=>{const t=this.arithmeticHelper.coerceNumbersExactRanges(e);return t instanceof pk?t:0===t.length?0:M$(t)}))}geomean(e,t){return this.runFunction(e.args,t,this.metadata("GEOMEAN"),((...e)=>{const t=this.arithmeticHelper.coerceNumbersExactRanges(e);if(t instanceof pk)return t;if(0===t.length)return new pk(XU.NUM,BH.OneValue);for(const n of t)if(n<=0)return new pk(XU.NUM,BH.ValueSmall);return r=t,Math.pow(function(e){for(var t=1,r=e.length;--r>=0;)t*=e[r];return t}(r),1/r.length);var r}))}harmean(e,t){return this.runFunction(e.args,t,this.metadata("HARMEAN"),((...e)=>{const t=this.arithmeticHelper.coerceNumbersExactRanges(e);if(t instanceof pk)return t;if(0===t.length)return new pk(XU.NUM,BH.OneValue);for(const r of t)if(r<=0)return new pk(XU.NUM,BH.ValueSmall);return t.length/t.reduce(((e,t)=>e+1/t),0)}))}correl(e,t){return this.runFunction(e.args,t,this.metadata("CORREL"),((e,t)=>{if(e.numberOfElements()!==t.numberOfElements())return new pk(XU.NA,BH.EqualLength);const r=J$(e,t);if(r instanceof pk)return r;return r[0].length<=1?new pk(XU.DIV_BY_ZERO,BH.TwoValues):F$(r[0],r[1])}))}rsq(e,t){return this.runFunction(e.args,t,this.metadata("RSQ"),((e,t)=>{if(e.numberOfElements()!==t.numberOfElements())return new pk(XU.NA,BH.EqualLength);const r=J$(e,t);if(r instanceof pk)return r;return r[0].length<=1?new pk(XU.DIV_BY_ZERO,BH.TwoValues):Math.pow(F$(r[0],r[1]),2)}))}covariancep(e,t){return this.runFunction(e.args,t,this.metadata("COVARIANCE.P"),((e,t)=>{if(e.numberOfElements()!==t.numberOfElements())return new pk(XU.NA,BH.EqualLength);const r=J$(e,t);if(r instanceof pk)return r;const n=r[0].length;return n<1?new pk(XU.DIV_BY_ZERO,BH.OneValue):1===n?0:L$(r[0],r[1])*(n-1)/n}))}covariances(e,t){return this.runFunction(e.args,t,this.metadata("COVARIANCE.S"),((e,t)=>{if(e.numberOfElements()!==t.numberOfElements())return new pk(XU.NA,BH.EqualLength);const r=J$(e,t);if(r instanceof pk)return r;return r[0].length<=1?new pk(XU.DIV_BY_ZERO,BH.TwoValues):L$(r[0],r[1])}))}ztest(e,t){return this.runFunction(e.args,t,this.metadata("Z.TEST"),((e,t,r)=>{const n=this.arithmeticHelper.manyToExactNumbers(e.valuesFromTopLeftCorner());if(n instanceof pk)return n;const o=n.length;if(void 0===r){if(o<2)return new pk(XU.DIV_BY_ZERO,BH.TwoValues);r=x$(n,!0)}return o<1?new pk(XU.NA,BH.OneValue):0===r?new pk(XU.DIV_BY_ZERO):1-Kz((O$(n)-t)/(r/Math.sqrt(o)),0,1)}))}ftest(e,t){return this.runFunction(e.args,t,this.metadata("F.TEST"),((e,t)=>{const r=this.arithmeticHelper.manyToExactNumbers(e.valuesFromTopLeftCorner()),n=this.arithmeticHelper.manyToExactNumbers(t.valuesFromTopLeftCorner());if(r instanceof pk)return r;if(n instanceof pk)return n;if(r.length<=1||n.length<=1)return new pk(XU.DIV_BY_ZERO);const o=_$(r,!0),i=_$(n,!0);if(0===o||0===i)return new pk(XU.DIV_BY_ZERO);const s=g$(o/i,r.length-1,n.length-1);return 2*Math.min(s,1-s)}))}steyx(e,t){return this.runFunction(e.args,t,this.metadata("STEYX"),((e,t)=>{if(e.numberOfElements()!==t.numberOfElements())return new pk(XU.NA,BH.EqualLength);const r=J$(e,t);if(r instanceof pk)return r;const n=r[0].length;return n<=2?new pk(XU.DIV_BY_ZERO,BH.ThreeValues):Math.sqrt((M$(r[0])-Math.pow(L$(r[0],r[1])*(n-1),2)/M$(r[1]))/(n-2))}))}slope(e,t){return this.runFunction(e.args,t,this.metadata("SLOPE"),((e,t)=>{if(e.numberOfElements()!==t.numberOfElements())return new pk(XU.NA,BH.EqualLength);const r=J$(e,t);if(r instanceof pk)return r;const n=r[0].length;return n<=1?new pk(XU.DIV_BY_ZERO,BH.TwoValues):L$(r[0],r[1])*(n-1)/M$(r[1])}))}chisqtest(e,t){return this.runFunction(e.args,t,this.metadata("CHISQ.TEST"),((e,t)=>{const r=e.height(),n=e.width();if(t.height()!==r||t.width()!==n)return new pk(XU.NA,BH.EqualLength);const o=J$(e,t);if(o instanceof pk)return o;if(o[0].length<=1)return new pk(XU.DIV_BY_ZERO,BH.TwoValues);let i=0;for(let s=0;s<o[0].length;s++){if(0===o[1][s])return new pk(XU.DIV_BY_ZERO);i+=Math.pow(o[0][s]-o[1][s],2)/o[1][s]}return i<0?new pk(XU.NUM,BH.NaN):1-d$(i,r>1&&n>1?(r-1)*(n-1):r*n-1)}))}ttest(e,t){return this.runFunction(e.args,t,this.metadata("T.TEST"),((e,t,r,n)=>{const o=this.arithmeticHelper.manyToExactNumbers(e.valuesFromTopLeftCorner()),i=this.arithmeticHelper.manyToExactNumbers(t.valuesFromTopLeftCorner());if(o instanceof pk)return o;if(i instanceof pk)return i;const s=o.length,a=i.length;if(1===n){if(a!==s)return new pk(XU.NA,BH.EqualLength);if(s<=1)return new pk(XU.DIV_BY_ZERO,BH.TwoValues);const e=Array(s);for(let r=0;r<s;r++)e[r]=o[r]-i[r];const t=x$(e,!0);if(0===t)return new pk(XU.DIV_BY_ZERO);const n=Math.abs(Math.sqrt(s)*O$(e)/t);return r*(1-S$(n,s-1))}if(2===n){if(s<=1||a<=1)return new pk(XU.DIV_BY_ZERO,BH.TwoValues);const e=(M$(o)+M$(i))/(s+a-2);if(0===e)return new pk(XU.DIV_BY_ZERO);const t=Math.abs((O$(o)-O$(i))/Math.sqrt(e*(1/s+1/a)));return r*(1-S$(t,s+a-2))}{if(s<=1||a<=1)return new pk(XU.DIV_BY_ZERO,BH.TwoValues);const e=_$(o,!0),t=_$(i,!0);if(0===e&&0===t)return new pk(XU.DIV_BY_ZERO);const n=Math.abs((O$(o)-O$(i))/Math.sqrt(e/s+t/a)),l=Math.pow(e/s+t/a,2)/(Math.pow(e/s,2)/(s-1)+Math.pow(t/a,2)/(a-1));return r*(1-S$(n,l))}}))}skew(e,t){return this.runFunction(e.args,t,this.metadata("SKEW"),((...e)=>{const t=this.arithmeticHelper.coerceNumbersExactRanges(e);if(t instanceof pk)return t;const r=t.length;if(r<3)return new pk(XU.DIV_BY_ZERO,BH.ThreeValues);const n=O$(t),o=x$(t,!0);return 0===o?new pk(XU.DIV_BY_ZERO):t.reduce(((e,t)=>e+Math.pow((t-n)/o,3)),0)*r/(r-1)/(r-2)}))}skewp(e,t){return this.runFunction(e.args,t,this.metadata("SKEW.P"),((...e)=>{const t=this.arithmeticHelper.coerceNumbersExactRanges(e);if(t instanceof pk)return t;const r=t.length;if(r<3)return new pk(XU.DIV_BY_ZERO,BH.ThreeValues);const n=O$(t),o=x$(t,!1);return 0===o?new pk(XU.DIV_BY_ZERO):t.reduce(((e,t)=>e+Math.pow((t-n)/o,3)),0)/r}))}}function J$(e,t){const r=e.iterateValuesFromTopLeftCorner(),n=t.iterateValuesFromTopLeftCorner();let o,i;const s=[],a=[];for(;o=r.next(),i=n.next(),!o.done&&!i.done;){const e=o.value,t=i.value;if(e instanceof pk)return e;if(t instanceof pk)return t;BD(e)&&BD(t)&&(s.push(LD(e)),a.push(LD(t)))}return[s,a]}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */Z$.implementedFunctions={AVEDEV:{method:"avedev",parameters:[{argumentType:Qk.ANY}],repeatLastArgs:1},DEVSQ:{method:"devsq",parameters:[{argumentType:Qk.ANY}],repeatLastArgs:1},GEOMEAN:{method:"geomean",parameters:[{argumentType:Qk.ANY}],repeatLastArgs:1},HARMEAN:{method:"harmean",parameters:[{argumentType:Qk.ANY}],repeatLastArgs:1},CORREL:{method:"correl",parameters:[{argumentType:Qk.RANGE},{argumentType:Qk.RANGE}]},RSQ:{method:"rsq",parameters:[{argumentType:Qk.RANGE},{argumentType:Qk.RANGE}]},"COVARIANCE.P":{method:"covariancep",parameters:[{argumentType:Qk.RANGE},{argumentType:Qk.RANGE}]},"COVARIANCE.S":{method:"covariances",parameters:[{argumentType:Qk.RANGE},{argumentType:Qk.RANGE}]},"Z.TEST":{method:"ztest",parameters:[{argumentType:Qk.RANGE},{argumentType:Qk.NUMBER},{argumentType:Qk.NUMBER,optionalArg:!0}]},"F.TEST":{method:"ftest",parameters:[{argumentType:Qk.RANGE},{argumentType:Qk.RANGE}]},STEYX:{method:"steyx",parameters:[{argumentType:Qk.RANGE},{argumentType:Qk.RANGE}]},SLOPE:{method:"slope",parameters:[{argumentType:Qk.RANGE},{argumentType:Qk.RANGE}]},"CHISQ.TEST":{method:"chisqtest",parameters:[{argumentType:Qk.RANGE},{argumentType:Qk.RANGE}]},"T.TEST":{method:"ttest",parameters:[{argumentType:Qk.RANGE},{argumentType:Qk.RANGE},{argumentType:Qk.INTEGER,minValue:1,maxValue:2},{argumentType:Qk.INTEGER,minValue:1,maxValue:3}]},SKEW:{method:"skew",parameters:[{argumentType:Qk.ANY}],repeatLastArgs:1},"SKEW.P":{method:"skewp",parameters:[{argumentType:Qk.ANY}],repeatLastArgs:1}},Z$.aliases={COVAR:"COVARIANCE.P",FTEST:"F.TEST",PEARSON:"CORREL",ZTEST:"Z.TEST",CHITEST:"CHISQ.TEST",TTEST:"T.TEST",COVARIANCEP:"COVARIANCE.P",COVARIANCES:"COVARIANCE.S",SKEWP:"SKEW.P"};const eY=Object.freeze(Object.defineProperty({__proto__:null,AbsPlugin:jG,AddressPlugin:WG,ArrayPlugin:GG,BitShiftPlugin:$G,BitwiseLogicOperationsPlugin:qG,BooleanPlugin:QG,CharPlugin:ZG,CodePlugin:JG,ComplexPlugin:k$,ConditionalAggregationPlugin:iz,CountBlankPlugin:ej,CountUniquePlugin:tj,DateTimePlugin:rj,DegreesPlugin:aj,DeltaPlugin:lj,ExpPlugin:uj,FinancialPlugin:hj,FormulaTextPlugin:fj,HyperlinkPlugin:yj,InformationPlugin:wj,IsEvenPlugin:Ej,IsOddPlugin:vj,LogarithmPlugin:Rj,LookupPlugin:hz,MathConstantsPlugin:Tj,MathPlugin:V$,MatrixPlugin:Nj,MedianPlugin:Aj,ModuloPlugin:Ij,NumericAggregationPlugin:_j,PowerPlugin:Fj,RadiansPlugin:Pj,RadixConversionPlugin:Hj,RandomPlugin:jj,RomanPlugin:cz,RoundingPlugin:Yj,SimpleArithmerticPlugin:mz,SqrtPlugin:Xj,StatisticalAggregationPlugin:Z$,StatisticalPlugin:P$,SumprodPlugin:sz,TextPlugin:az,TrigonometryPlugin:lz},Symbol.toStringTag,{value:"Module"}));
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class tY extends VG{}tY.HyperFormula=VG,tY.ErrorType=XU,tY.CellError=pk,tY.CellType=KU,tY.CellValueType=ak,tY.CellValueDetailedType=lk,tY.DetailedCellError=tB,tY.ExportedCellChange=tG,tY.ExportedNamedExpressionChange=rG,tY.ConfigValueTooBigError=fU,tY.ConfigValueTooSmallError=gU,tY.EvaluationSuspendedError=wU,tY.ExpectedOneOfValuesError=yU,tY.ExpectedValueOfTypeError=pU,tY.ArraySize=Jk,tY.SimpleRangeValue=zD,tY.EmptyValue=xD,tY.FunctionPlugin=Zk,tY.FunctionArgumentType=Qk,tY.FunctionPluginValidationError=TU,tY.InvalidAddressError=rU,tY.InvalidArgumentsError=nU,tY.LanguageNotRegisteredError=RU,tY.LanguageAlreadyRegisteredError=SU,tY.MissingTranslationError=EU,tY.NamedExpressionDoesNotExistError=aU,tY.NamedExpressionNameIsAlreadyTakenError=iU,tY.NamedExpressionNameIsInvalidError=sU,tY.NoOperationToRedoError=uU,tY.NoOperationToUndoError=lU,tY.NoRelativeAddressesAllowedError=AU,tY.NoSheetWithIdError=QD,tY.NoSheetWithNameError=ZD,tY.NotAFormulaError=tU,tY.NothingToPasteError=hU,tY.ProtectedFunctionTranslationError=vU,tY.SheetNameAlreadyTakenError=JD,tY.SheetSizeLimitExceededError=eU,tY.SourceLocationHasArrayError=bU,tY.TargetLocationHasArrayError=NU,tY.UnableToParseError=dU;const rY=DG.defaultConfig.language;VG.registerLanguage(rY,kG),VG.languages[kG.langCode]=kG;for(const L of Object.getOwnPropertyNames(eY))L.startsWith("_")||VG.registerFunctionPlugin(eY[L]);const nY={class:"modal-form full-screen columns is-multiline"},oY={class:"column is-9"},iY={class:"column is-3 is-flex space-between"},sY={class:"column is-12"},aY=h({__name:"ExcelFileEditor",props:{excelFileModal:{type:Boolean},fileId:{},objectId:{},getLeadsList:{type:Boolean}},emits:["update:modalHandler","update:OnSuccess"],setup(e,{emit:t}){const r=e,n=VG.buildEmpty();c();const o=J(),i=Z(),s=d(!1);d(!1),d(""),d([]);const h=d(null);d(!1);const p=d([[""]]),m=d({title:"Enter Title",data:Array.from({length:80},(()=>Array(50).fill("")))}),f=d({colHeaders:!0,rowHeaders:!0,width:"100%",height:800,minRows:50,minCols:50,rowHeights:30,colWidths:120,stretchH:"all",manualColumnResize:!0,manualRowResize:!0,columnSorting:!0,filters:!0,dropdownMenu:!0,contextMenu:!0,formulas:{engine:n},licenseKey:"non-commercial-and-evaluation"});d([]);const T=async()=>{try{r.fileId?(await i.patch(`/api/excel-files/${r.fileId}/`,{title:m.value.title,sheet_data:JSON.stringify(p.value)}),o.success("Sheet updated successfully!")):(await i.post("/api/excel-files/",{title:m.value.title,sheet_data:JSON.stringify(p.value)}),o.success("Sheet created successfully!")),t("update:OnSuccess",null),o.success("Sheet saved successfully!")}catch(e){console.error(e),o.error("Failed to save sheet.")}};return g((async()=>{r.fileId&&await(async()=>{try{const e=await i.get(`/api/excel-files/${r.fileId}/`);let t=e.data.sheet_data,n="string"==typeof t?JSON.parse(t):t;console.log("Parsed Data:",n),Array.isArray(n)||(console.error("Invalid data format: Expected an array"),n=[]),n=n.map((e=>Array.isArray(e)?e.map((e=>null===e?"":e)):"object"==typeof e&&null!==e?Object.values(e).map((e=>null===e?"":e)):[e])),console.log("Fixed Data:",n),p.value=n,m.value.title=e.data.title,await X(),h.value?.hotInstance&&(h.value.hotInstance.loadData(p.value),h.value.hotInstance.render())}catch(e){console.log("Error fetching sheet:",e)}})(),await X(),h.value?.hotInstance&&p.value.length>0&&(h.value.hotInstance.loadData(p.value),h.value.hotInstance.render())})),(e,n)=>{const c=l,d=u,g=a,C=x;return y(),w("div",nY,[E("div",oY,[v(g,null,{default:R((()=>[v(d,null,{default:R((()=>[v(c,{modelValue:m.value.title,"onUpdate:modelValue":n[0]||(n[0]=e=>m.value.title=e),type:"text",placeholder:"title"},null,8,["modelValue"])])),_:1})])),_:1})]),E("div",iY,[v(C,{loading:s.value,onClick:T,color:"primary",raised:"",outlined:"",class:"mr-2",light:""},{default:R((()=>[S("Save")])),_:1},8,["loading"]),v(C,{loading:s.value,onClick:n[1]||(n[1]=e=>(async()=>{try{const e=await i.post(`/api/excel-files/${r.fileId}/download/`,{},{responseType:"blob"}),t=new Blob([e.data],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),n=window.URL.createObjectURL(t),s=document.createElement("a");s.href=n,s.download=`${m.value.title}.xlsx`,document.body.appendChild(s),s.click(),document.body.removeChild(s),window.URL.revokeObjectURL(n),o.success("File downloaded successfully!")}catch(e){console.error("Download Error:",e),o.error("Failed to download the sheet.")}})()),color:"info",raised:"",outlined:"",style:{width:"160px"},light:""},{default:R((()=>[S("Download")])),_:1},8,["loading"]),v(C,{loading:s.value,color:"danger",outlined:"",style:{width:"160px"},light:"",class:"ml-2",raised:""},{default:R((()=>[S("Delete")])),_:1},8,["loading"]),v(C,{loading:s.value,onClick:n[2]||(n[2]=e=>{t("update:modalHandler",!1)}),color:"warning",raised:"",class:"ml-2",outlined:"",light:""},{default:R((()=>[S("Close")])),_:1},8,["loading"])]),E("div",sY,[v(I(Ox),{ref_key:"hotTable",ref:h,settings:f.value,data:p.value},null,8,["settings","data"])])])}}}),lY=H(aY,[["__scopeId","data-v-a59c9b2e"]]),uY={class:"column is-12"},hY={class:"list-flex-toolbar is-reversed"},cY={class:"columns is-multiline"},dY={class:"card p-4 curved is-flex space-between"},pY={class:"subtitle is-5 m-0"},mY={class:"content"},gY={class:"is-flex"},fY={class:"modal-form columns is-multiline"},yY={class:"file has-name"},wY={class:"file-label"},EY=(e=>(P("data-v-b0da7289"),e=e(),V(),e))((()=>E("span",{class:"file-cta"},[E("span",{class:"file-icon"},[E("i",{class:"fas fa-cloud-upload-alt"})]),E("span",{class:"file-label"}," Choose a file… ")],-1))),vY={class:"file-name light-text"},RY=h({__name:"ExcelSheetComponent",props:{fetchAll:{},userId:{},objectId:{}},setup(e){const t=e,r=c();d(null);const o=Z(),i=J(),s=d(!1);d([[""]]);const h=d([]),p=d(""),f=async()=>{try{const e=await o.get("/api/excel-files/");h.value=e.data}catch(e){console.error(e)}finally{s.value=!1}},A=d(!1),L=d(0),P=(e="")=>{L.value=e,A.value=!0},V=m((()=>{if(p.value){const e=new RegExp(p.value,"i");return h.value.filter((t=>t.title?.match(e)))}return h.value})),H=d(!1);d("");const D=d("");d("");const U=d({file:"",title:"",user_id:r.user.id,object_id:t.objectId}),k=e=>{let t=e.target.files[0];U.value.file=t,D.value=t.name,U.value.title=t.name},W=async()=>{try{const e=te(U.value,[""]);await o.post("/api/excel-files/upload-excel/",e);f(),i.success("Sheet uploaded successfully")}catch(e){console.error(e)}finally{s.value=!1,H.value=!1}};return g((async()=>{t.fetchAll&&await f(),t.userId&&(async()=>{try{const e=await o.get(`/api/excel-files/by-user/${t.userId}/`);h.value=e.data}catch(e){console.error(e)}finally{s.value=!1}})(),await f()})),(e,t)=>{const r=x,s=F,h=u,c=n,d=lY,m=Ie,g=l,G=a,j=Ae;return y(),w("div",uY,[E("div",hY,[v(s,null,{default:R((()=>[v(r,{icon:"fas fa-plus",color:"info",outlined:"",light:"",class:"ml-2",raised:"",onClick:t[0]||(t[0]=e=>P())},{default:R((()=>[S("New Sheet")])),_:1}),v(r,{icon:"fas fa-upload",raised:"",light:"",onClick:t[1]||(t[1]=e=>H.value=!H.value),outlined:"",color:"primary"},{default:R((()=>[S(" File ")])),_:1})])),_:1}),E("div",null,[v(h,{class:"mr-2 h-hidden-mobile",icon:"feather:search"},{default:R((()=>[C(E("input",{"onUpdate:modelValue":t[2]||(t[2]=e=>p.value=e),class:"input custom-text-filter",placeholder:"Search..."},null,512),[[b,p.value]])])),_:1})])]),E("div",cY,[(y(!0),w(M,null,_(I(V),((e,t)=>(y(),w("div",{class:"column is-6",key:e.id},[E("div",dY,[E("div",null,[E("h4",pY,T(e.title),1),E("div",mY,[E("p",null,T(I(ee)(e.created_at)),1)])]),E("div",gY,[v(c,{icon:"lucide:pen",color:"info",class:"cu-pointer",onClick:t=>P(e.id),"has-background":""},null,8,["onClick"]),v(c,{onClick:t=>(async e=>{try{await o.delete(`/api/excel-files/${e}/`),i.success("Sheet deleted successfully!"),f()}catch(t){console.error(t),i.error("Failed to delete sheet.")}})(e.id),icon:"lucide:trash",color:"danger","has-background":"",class:"cu-pointer ml-1"},null,8,["onClick"])])])])))),128))]),A.value?(y(),O(d,{key:0,class:"fullscreen","excel-file-modal":A.value,fileId:L.value,"onUpdate:modalHandler":t[3]||(t[3]=e=>A.value=!1),"onUpdate:onSuccess":f},null,8,["excel-file-modal","fileId"])):N("",!0),v(j,{is:"form",open:H.value,title:"Upload Task File",size:"medium",actions:"right",onClose:t[6]||(t[6]=e=>H.value=!1),onSubmit:B(W,["prevent"])},{content:R((()=>[E("div",fY,[v(G,{class:"column is-12"},{default:R((()=>[v(m,null,{default:R((()=>[S("File Title")])),_:1}),v(h,null,{default:R((()=>[v(g,{modelValue:U.value.title,"onUpdate:modelValue":t[4]||(t[4]=e=>U.value.title=e),type:"text"},null,8,["modelValue"])])),_:1})])),_:1}),v(G,{class:"column is-12",grouped:""},{default:R((()=>[v(h,null,{default:R((()=>[E("div",yY,[E("label",wY,[E("input",{onChange:k,class:"file-input",type:"file",name:"file",required:""},null,32),EY,E("span",vY,T(D.value?D.value:"Upload any file"),1)])])])),_:1})])),_:1})])])),cancel:R((()=>[v(r,{onClick:t[5]||(t[5]=e=>H.value=!1),raised:""},{default:R((()=>[S("Close")])),_:1})])),action:R((()=>[v(r,{type:"submit",color:"primary",raised:""},{default:R((()=>[S("Upload")])),_:1})])),_:1},8,["open","onSubmit"])])}}}),SY=H(RY,[["__scopeId","data-v-b0da7289"]]),TY={key:0,class:"modal-form"},CY=["src"],bY=["src"],NY=["src"],AY=["src"],IY={key:1,class:"modal-form"},OY=[E("h1",{class:"title is-5"},"No media file attached",-1)],MY=h({__name:"DocumentViewer",props:{openDocViewModal:{type:Boolean},document:{},title:{}},emits:["update:closeModalHandler","update:OnSuccess"],setup(e,{emit:t}){const r=e,n=()=>{t("update:closeModalHandler",!1)},o=e=>`https://docs.google.com/viewer?url=${encodeURIComponent(e)}&embedded=true`;return g((async()=>{console.log("picture",r.document)})),(e,t)=>{const i=x,s=Ae;return y(),O(s,{is:"form",open:r.openDocViewModal,title:r.title?r.title:"Attached Document",size:"xl",actions:"right",onClose:n},{content:R((()=>[r.document?(y(),w("div",TY,[r.document?.includes(".pdf")?(y(),w("iframe",{key:0,src:`${r.document}#toolbar=0&view=FitH`,style:{width:"100%",height:"800px",border:"none"}},"\n          Oops! an error has occurred.\n        ",8,CY)):r.document?.toLowerCase().includes(".doc")||r.document?.toLowerCase().includes(".docx")?(y(),w("iframe",{key:1,src:o(r.document),style:{width:"100%",height:"800px",border:"none"}},"\n          Oops! an error has occurred.\n        ",8,bY)):r.document?.toLowerCase().includes(".xls")||r.document?.toLowerCase().includes(".xlsx")?(y(),w("iframe",{key:2,src:o(r.document),style:{width:"100%",height:"800px",border:"none"}},"\n          Oops! an error has occurred.\n        ",8,NY)):(y(),w("img",{key:3,src:r.document,alt:""},null,8,AY))])):(y(),w("div",IY,OY))])),cancel:R((()=>[v(i,{type:"submit",style:{display:"none"},color:"primary",raised:""},{default:R((()=>[S("Close")])),_:1})])),_:1},8,["open","title"])}}}),_Y={class:"tile-grid-item"},xY={class:"tile-grid-item-inner"},LY=["src"],FY={class:"meta"},PY={class:"dark-inverted"},VY=E("i",{"aria-hidden":"true",class:"fas fa-circle icon-separator"},null,-1),HY=[E("div",{class:"icon"},[E("i",{"aria-hidden":"true",class:"lnil lnil-cloud-download"})],-1),E("div",{class:"meta"},[E("span",null,"Download"),E("span",null,"Download this file")],-1)],DY=E("hr",{class:"dropdown-divider"},null,-1),UY=[E("div",{class:"icon"},[E("i",{"aria-hidden":"true",class:"lnil lnil-trash-can-alt"})],-1),E("div",{class:"meta"},[E("span",null,"Delete"),E("span",null,"Delete this file")],-1)],kY=h({__name:"DocumentTile",props:{document:{}},emits:["deleteSelectedFile"],setup(e,{emit:t}){const r=e,n=d(""),o=d(!1),i=d(""),s={pdf:"/images/icons/files/pdf.svg",xls:"/images/icons/files/sheet.svg",doc:"/images/icons/files/doc-2.svg",ppt:"/images/icons/files/ppt.svg",ai:"/images/icons/files/ai.svg",docx:"/images/icons/files/doc-2.svg",docs:"/images/icons/files/doc-2.svg",xlsx:"/images/icons/files/sheet.svg",ai2:"/images/icons/files/ai.svg",xlx:"/images/icons/files/sheet.svg",ods:"/images/icons/files/sheet.svg",png:"/icons/png-icon.png",jpg:"/icons/jpg-50.png",jpeg:"/icons/jpg-50.png"};return(e,a)=>{const l=Oe;return y(),w("div",null,[E("div",_Y,[E("div",xY,[E("img",{onClick:a[0]||(a[0]=e=>{return t=r.document?.file,n.value=t,i.value=t.title,void(o.value=!o.value);var t}),src:s[r.document?.file_info?.type]},null,8,LY),E("div",FY,[E("span",PY,T(r.document.title??"N/A"),1),E("span",null,[E("span",null,T(r.document?.file_info?.size??0)+" MB",1),VY,E("span",null,"At:"+T(I(ne)(r.document.created_at)),1)])]),v(l,{icon:"feather:more-vertical",spaced:"",right:""},{content:R((()=>[E("a",{role:"menuitem",onClick:a[1]||(a[1]=e=>(async(e,t)=>{try{const r=await fetch(e);if(!r.ok)throw new Error("Network response was not ok");const n=await r.blob(),o=window.URL.createObjectURL(n),i=document.createElement("a");i.href=o,i.download=t,document.body.appendChild(i),i.click(),document.body.removeChild(i),window.URL.revokeObjectURL(o)}catch(r){console.error("Download failed:",r)}})(r.document.file,r.document.title)),class:"dropdown-item is-media"},HY),DY,E("a",{role:"menuitem",onClick:a[2]||(a[2]=e=>(e=>{t("deleteSelectedFile",e)})(r.document.id)),class:"dropdown-item is-media"},UY)])),_:1})])]),I(o)?(y(),O(MY,{key:0,openDocViewModal:I(o),document:I(n),title:I(i),"onUpdate:closeModalHandler":a[3]||(a[3]=e=>o.value=!1)},null,8,["openDocViewModal","document","title"])):N("",!0)])}}}),BY={key:1},WY={class:"tile-grid-toolbar"},GY={class:"buttons"},jY=E("span",{class:"icon"},[E("i",{"aria-hidden":"true",class:"fas fa-plus"})],-1),zY=E("span",null,"Add File",-1),$Y={class:"tile-grid tile-grid-v2"},YY=E("img",{class:"light-image",src:q,alt:""},null,-1),XY=E("img",{class:"dark-image",src:Q,alt:""},null,-1),KY=h({__name:"ObjectDocumentsTiles",props:{objectId:{},docType:{}},setup(e){const t=e,r=J(),n=Z(),i=d(""),s=d(0),l=d(""),h=d(!1),c=d(!1),p=d([{id:"27223081-e97a-4420-91f2-6a08da82d846",uploaded_by_info:{id:"709ef38f-b1e3-48f2-8cd9-5a8e3e0c9a1b",username:"APIs",last_name:"Dev",email:"api@dev.com",role:"admin",avatar:null},file_info:{url:"https://ibex-documents.s3.us-east-2.amazonaws.com/public/attachments/combined_proposal_95Ac2Fu.pdf",name:"combined_proposal_95Ac2Fu.pdf",type:"pdf",size:.14},file:"https://ibex-documents.s3.us-east-2.amazonaws.com/public/attachments/combined_proposal_95Ac2Fu.pdf",type:"proposal_formats",object:"751b95b2-9961-45a0-948c-96f85cea6a52",created_at:"2025-02-14T19:42:31.991589Z",title:"proposal",uploaded_by:"709ef38f-b1e3-48f2-8cd9-5a8e3e0c9a1b"}]),f=["All Files","Recently Updated","My Files","Team Files","Deprecated"],S=async(e="proposal_formats")=>{try{h.value=!0;const e=await n.get(`/api/attachment/by-object/${t.objectId}/?type=${t.docType}`);p.value=e.data}catch(r){console.log(r)}finally{h.value=!1}},T=async e=>{try{const o=await n.delete(`/api/attachment/${e}/`);re({object_type:"files",object_id:t.objectId,action:"DELETE",message:`Deleted a file named <b>${o.data.title}</b>.`,performedOnName:"job"}),r.purple("File Deleted Successfully"),S()}catch(o){console.log(o)}},L=m((()=>i.value?p.value.filter((e=>e.title.match(new RegExp(i.value,"i"))||e.file_info?.name?.match(new RegExp(i.value,"i"))||e.created_at.match(new RegExp(i.value,"i")))):p.value));return g((()=>{S()})),(e,r)=>{const n=Me,d=u,p=W("Multiselect"),m=a,g=x,F=o,P=kY,V=ho;return y(),w("div",null,[I(h)?(y(),O(n,{key:0,rows:4})):(y(),w("div",BY,[E("div",WY,[v(d,{icon:"feather:search"},{default:R((()=>[C(E("input",{"onUpdate:modelValue":r[0]||(r[0]=e=>G(i)?i.value=e:null),class:"input custom-text-filter",placeholder:"Search..."},null,512),[[b,I(i)]])])),_:1}),E("div",GY,[v(m,{class:"h-hidden-mobile"},{default:R((()=>[v(d,null,{default:R((()=>[v(p,{modelValue:I(s),"onUpdate:modelValue":r[1]||(r[1]=e=>G(s)?s.value=e:null),options:f,"max-height":145,placeholder:"Select an option"},null,8,["modelValue"])])),_:1})])),_:1}),v(g,{onClick:r[2]||(r[2]=e=>(l.value=t.docType,void(c.value=!c.value))),color:"primary",raised:""},{default:R((()=>[jY,zY])),_:1})])]),E("div",$Y,[0!=I(L).length||I(h)?N("",!0):(y(),O(F,{key:0,title:"We couldn't find any matching file of this directory.",subtitle:"Too bad. Looks like we couldn't find any matching results for the\n          search terms you've entered. Please try different search terms or\n          criteria.",larger:""},{image:R((()=>[YY,XY])),_:1})),E("div",null,[v(A,{name:"list",tag:"div",class:"columns is-multiline"},{default:R((()=>[(y(!0),w(M,null,_(I(L),(e=>(y(),w("div",{key:e.id,class:"column is-4"},[v(P,{document:e,onDeleteSelectedFile:T},null,8,["document"])])))),128))])),_:1})])]),I(c)?(y(),O(V,{key:0,openFileModal:I(c),object:t.objectId,type:I(l),"onClose:ModalHandler":r[3]||(r[3]=e=>c.value=!1),"onUpdate:OnSuccess":S},null,8,["openFileModal","object","type"])):N("",!0)]))])}}}),qY={class:"tabs-inner"},QY={class:"tabs"},ZY=[E("span",null,"Grouped Proposals",-1)],JY=[E("span",null,"Contracts",-1)],eX=[E("span",null,"Customer Estimates",-1)],tX=[E("span",null,"Job Scope",-1)],rX=[E("span",null,"Asbestos & Lead Report",-1)],nX=[E("span",null,"Permits",-1)],oX=[E("span",null,"Bids & Material",-1)],iX=[E("span",null,"Miscellaneous",-1)],sX=[E("span",null,"Uploaded Files",-1)],aX=[E("span",null,"Calculations",-1)],lX=E("li",{class:"tab-naver"},null,-1),uX={class:"tile-grid tile-grid-v2"},hX=E("img",{class:"light-image",src:q,alt:""},null,-1),cX=E("img",{class:"dark-image",src:Q,alt:""},null,-1),dX={key:0},pX={key:1},mX={key:2},gX={key:3},fX={key:4},yX={key:5},wX={key:6},EX={key:7},vX={key:8},RX={key:9},SX=h({__name:"JobDocuments",props:{leadId:{},uploaded_files:{}},emits:["getProjectInfo"],setup(e,{emit:t}){const r=e;J();const n=Z(),i=d("");d(0);const s=d(""),a=d("proposal_formats"),l=d(!1),u=d([]),h=m((()=>i.value?_e.filter((e=>e.name.match(new RegExp(i.value,"i"))||e.size.match(new RegExp(i.value,"i")))):_e)),c=()=>{t("getProjectInfo",null)},p=async(e="proposal_formats")=>{try{a.value=e;const t=await n.get(`/api/attachment/by-object/${r.leadId}/?type=${e}`);u.value=t.data}catch(t){console.log(t)}};return g((()=>{p()})),(e,t)=>{const n=o,i=KY,u=oe,d=SY,m=ho;return y(),w("div",null,[E("div",qY,[E("div",QY,[E("ul",null,[E("li",{class:D(["proposal_formats"===I(a)&&"is-active"])},[E("a",{tabindex:"0",role:"button",onKeydown:t[0]||(t[0]=k(B((e=>p("proposal_formats")),["prevent"]),["space"])),onClick:t[1]||(t[1]=e=>p("proposal_formats"))},ZY,32)],2),E("li",{class:D(["contracts"===I(a)&&"is-active"])},[E("a",{tabindex:"0",role:"button",onKeydown:t[2]||(t[2]=k(B((e=>p("contracts")),["prevent"]),["space"])),onClick:t[3]||(t[3]=e=>p("contracts"))},JY,32)],2),E("li",{class:D(["estimates"===I(a)&&"is-active"])},[E("a",{tabindex:"0",role:"button",onKeydown:t[4]||(t[4]=k(B((e=>p("estimates")),["prevent"]),["space"])),onClick:t[5]||(t[5]=e=>p("estimates"))},eX,32)],2),E("li",{class:D(["job_scope"===I(a)&&"is-active"])},[E("a",{tabindex:"0",role:"button",onKeydown:t[6]||(t[6]=k(B((e=>a.value="job_scope"),["prevent"]),["space"])),onClick:t[7]||(t[7]=e=>a.value="job_scope")},tX,32)],2),E("li",{class:D(["asbestos"===I(a)&&"is-active"])},[E("a",{tabindex:"0",role:"button",onKeydown:t[8]||(t[8]=k(B((e=>a.value="asbestos"),["prevent"]),["space"])),onClick:t[9]||(t[9]=e=>a.value="asbestos")},rX,32)],2),E("li",{class:D(["permits"===I(a)&&"is-active"])},[E("a",{tabindex:"0",role:"button",onKeydown:t[10]||(t[10]=k(B((e=>a.value="permits"),["prevent"]),["space"])),onClick:t[11]||(t[11]=e=>a.value="permits")},nX,32)],2),E("li",{class:D(["material"===I(a)&&"is-active"])},[E("a",{tabindex:"0",role:"button",onKeydown:t[12]||(t[12]=k(B((e=>a.value="material"),["prevent"]),["space"])),onClick:t[13]||(t[13]=e=>a.value="material")},oX,32)],2),E("li",{class:D(["miscellaneous"===I(a)&&"is-active"])},[E("a",{tabindex:"0",role:"button",onKeydown:t[14]||(t[14]=k(B((e=>a.value="miscellaneous"),["prevent"]),["space"])),onClick:t[15]||(t[15]=e=>a.value="miscellaneous")},iX,32)],2),E("li",{class:D(["files"===I(a)&&"is-active"])},[E("a",{tabindex:"0",role:"button",onKeydown:t[16]||(t[16]=k(B((e=>p("files")),["prevent"]),["space"])),onClick:t[17]||(t[17]=e=>p("files"))},sX,32)],2),E("li",{class:D(["calculations"===I(a)&&"is-active"])},[E("a",{tabindex:"0",role:"button",onKeydown:t[18]||(t[18]=k(B((e=>p("calculations")),["prevent"]),["space"])),onClick:t[19]||(t[19]=e=>p("calculations"))},aX,32)],2),lX])])]),E("div",uX,[v(n,{class:D([0!==I(h).length&&"is-hidden"]),title:"We couldn't find any matching results.",subtitle:"Too bad. Looks like we couldn't find any matching results for the\n          search terms you've entered. Please try different search terms or\n          criteria.",larger:""},{image:R((()=>[hX,cX])),_:1},8,["class"]),"contracts"==I(a)?(y(),w("div",dX,[v(i,{"doc-type":"contracts","object-id":r.leadId},null,8,["object-id"])])):N("",!0),"estimates"==I(a)?(y(),w("div",pX,[v(i,{"doc-type":"estimates","object-id":r.leadId},null,8,["object-id"])])):N("",!0),"proposal_formats"==I(a)?(y(),w("div",mX,[v(i,{"doc-type":"proposal_formats","object-id":r.leadId},null,8,["object-id"])])):N("",!0),"job_scope"==I(a)?(y(),w("div",gX,[v(i,{"doc-type":"job_scope","object-id":r.leadId},null,8,["object-id"])])):N("",!0),"asbestos"==I(a)?(y(),w("div",fX,[v(i,{"doc-type":"asbestos","object-id":r.leadId},null,8,["object-id"])])):N("",!0),"permits"==I(a)?(y(),w("div",yX,[v(i,{"doc-type":"permits","object-id":r.leadId},null,8,["object-id"])])):N("",!0),"material"==I(a)?(y(),w("div",wX,[v(i,{"doc-type":"material","object-id":r.leadId},null,8,["object-id"])])):N("",!0),"miscellaneous"==I(a)?(y(),w("div",EX,[v(i,{"doc-type":"miscellaneous","object-id":r.leadId},null,8,["object-id"])])):N("",!0),"files"==I(a)?(y(),w("div",vX,[v(u,{projectId:r.leadId,files:r.uploaded_files,"onUpdate:onUploadFile":c},null,8,["projectId","files"])])):N("",!0),"calculations"==I(a)?(y(),w("div",RX,[v(d)])):N("",!0)]),I(l)?(y(),O(m,{key:0,openFileModal:I(l),object:r.leadId,type:I(s),"onClose:ModalHandler":t[20]||(t[20]=e=>l.value=!1),"onUpdate:OnSuccess":p},null,8,["openFileModal","object","type"])):N("",!0)])}}}),TX={class:"business-dashboard hr-dashboard"},CX={class:"columns is-multiline"},bX={class:"column is-12"},NX={class:"columns is-multiline"},AX={class:"column is-12"},IX={class:"block-header"},OX={class:"left"},MX={class:"current-user"},_X={class:"center"},xX=E("h4",{class:"block-heading"},"Address",-1),LX={class:"block-text"},FX=E("br",null,null,-1),PX=E("br",null,null,-1),VX={class:"right"},HX=E("h4",{class:"block-heading"},"Managers",-1),DX={class:"candidates"},UX=E("button",null,[E("i",{"aria-hidden":"true",class:"iconify","data-icon":"feather:plus"})],-1),kX={class:"column is-12"},BX={class:"toolbar"},WX={class:"tabs-inner"},GX={class:"tabs is-boxed"},jX=[E("span",null,"Job Management",-1)],zX=[E("span",null,"Documents/Files",-1)],$X=[E("span",null,"Proposals",-1)],YX=[E("span",null,"Tasks",-1)],XX=[E("span",null,"Activities",-1)],KX=[E("span",null,"Job progress",-1)],qX=[E("span",null,"Calculations",-1)],QX=[E("span",null,"Finance",-1)],ZX=[E("span",null,"Report",-1)],JX=E("li",{class:"tab-naver"},null,-1),eK={key:0,class:"column is-12"},tK={class:"columns is-multiline"},rK={class:"column is-8"},nK={class:"columns is-multiline"},oK={class:"column is-12"},iK={class:"feed-settings"},sK=E("h3",{class:"dark-inverted"},"Job feeds",-1),aK={class:"buttons"},lK={class:"column is-4"},uK={class:"side-text"},hK=E("h3",{class:"dark-inverted"},"Job Description",-1),cK=["innerHTML"],dK=E("a",{class:"action-link",tabindex:"0"},"Read More",-1),pK={class:"column is-7 is-offset-1"},mK={class:"incoming"},gK=E("i",{"aria-hidden":"true",class:"lnil lnil-envelope-alt"},null,-1),fK=E("div",null,[E("span",{class:"item-name dark-inverted"},"Messages"),E("span",{class:"item-meta"},[E("span",null,"Inbox messages")])],-1),yK=E("i",{"aria-hidden":"true",class:"lnil lnil-checkmark-circle"},null,-1),wK=E("div",null,[E("span",{class:"item-name dark-inverted"},"Tasks"),E("span",{class:"item-meta"},[E("span",null,"Pending tasks")])],-1),EK={key:3,tabindex:"0",class:"action-link is-pushed-mobile"},vK={key:4,class:"light-text"},RK={class:"column is-12"},SK={class:"recent-rookies"},TK=E("div",{class:"recent-rookies-header"},[E("h3",{class:"dark-inverted"},"Internal Users"),E("a",{class:"action-link",tabindex:"0"},"View All")],-1),CK={class:"columns is-multiline user-grid user-grid-v4"},bK={class:"column is-4"},NK={class:"grid-item"},AK={class:"dark-inverted"},IK={class:"capitalized"},OK={class:"button-wrap has-text-centered"},MK={class:"column is-4"},_K={key:0,class:"card mb-4",id:"workerProfileMap",style:{height:"300px",width:"100%","border-radius":"10px","z-index":"9"}},xK=E("div",{class:"widget-toolbar"},[E("div",{class:"left"},[E("a",{class:"action-icon"},[E("i",{"aria-hidden":"true",class:"iconify ltr-hidden","data-icon":"feather:chevron-right"}),E("i",{"aria-hidden":"true",class:"iconify rtl-hidden","data-icon":"feather:chevron-left"})])]),E("div",{class:"center"},[E("h3",null,"October 2020")]),E("div",{class:"right"},[E("a",{class:"action-icon"},[E("i",{"aria-hidden":"true",class:"iconify rtl-hidden","data-icon":"feather:chevron-right"}),E("i",{"aria-hidden":"true",class:"iconify ltr-hidden","data-icon":"feather:chevron-left"})])])],-1),LK=E("table",{class:"calendar"},[E("thead",null,[E("tr",null,[E("th",{scope:"col"},"Mon"),E("th",{scope:"col"},"Tue"),E("th",{scope:"col"},"Wed"),E("th",{scope:"col"},"Thu"),E("th",{scope:"col"},"Fri"),E("th",{scope:"col"},"Sat"),E("th",{scope:"col"},"Sun")])]),E("tbody",null,[E("tr",null,[E("td",{class:"prev-month"},"29"),E("td",{class:"prev-month"},"30"),E("td",{class:"prev-month"},"31"),E("td",null,"1"),E("td",null,"2"),E("td",null,"3"),E("td",null,"4")]),E("tr",null,[E("td",null,"5"),E("td",null,"6"),E("td",null,"7"),E("td",null,"8"),E("td",null,"9"),E("td",null,"10"),E("td",null,"11")]),E("tr",null,[E("td",null,"12"),E("td",null,"13"),E("td",null,"14"),E("td",null,"15"),E("td",null,"16"),E("td",null,"17"),E("td",{class:"current-day"},"18")]),E("tr",null,[E("td",null,"19"),E("td",null,"20"),E("td",null,"21"),E("td",null,"22"),E("td",null,"23"),E("td",null,"24"),E("td",null,"25")]),E("tr",null,[E("td",null,"26"),E("td",null,"27"),E("td",null,"28"),E("td",null,"29"),E("td",null,"30"),E("td",null,"31"),E("td",{class:"next-month"},"1")])])],-1),FK={key:1,class:"column is-12"},PK={key:2,class:"column is-12"},VK={key:3,class:"column is-12"},HK={key:4,class:"column is-12"},DK={key:5,class:"column is-12"},UK={key:6,class:"column is-12"},kK={key:7,class:"column is-12"},BK={key:8,class:"column is-12"},WK={key:9,class:"column is-12"},GK=h({__name:"JobDetails",setup(t){const n=K();U();const o=Z();J();const i=d(!1),s=d(""),a=d(!1);d(null),d("Untitled"),d({data:Array.from({length:80},(()=>Array(50).fill(""))),rowHeaders:!0,colHeaders:!0,contextMenu:!0,width:"100%",height:"500px"});const l=d({id:"",sales_people_info:[{id:"",username:"",last_name:null,email:"",role:"",avatar:null},{id:"",username:"",last_name:null,email:"",role:"",avatar:""},{id:"",username:"",last_name:"",email:"",role:"",avatar:""}],clientInfo:{id:"",username:"",last_name:null,email:"",role:"",avatar:null},created_by_info:{id:"",username:"",last_name:null,email:"",role:"",avatar:""},managers_list:[{id:"",username:"",last_name:null,email:"",role:"",avatar:null},{id:"",username:"",last_name:"",email:"",role:"",avatar:""}],uploaded_files:[],title:"",address:"",current_state:"",city:"",state:"",status:"",zip_code:"",confidence:"",sale_date:"",tags:[],estimated_from:"",estimated_to:"",sources:"",project_type:"",notes:"",attach_mail:"",latitude:null,longitude:null,created_at:"",updated_at:"",created_by:"",client:"",contractor:null,sales_people:[],managers:[]}),u=d("management"),h=[{type:"messages",count:5,status:"new"},{type:"tasks",count:3,status:"pending"}],c={type:{label:"Type",grow:"lg",media:!0},count:{label:"Count",align:"center"},status:"Status",actions:{label:"Actions",align:"end"}};let p;const m=async()=>{try{i.value=!0;const e=await o.get(`/api/project/${n.params.id}/detail/`);l.value=e.data,e.data.latitude&&((e,t)=>{if(p&&p.remove(),p=L.map("workerProfileMap").setView([51.4497984,-.3464489],24),L.tileLayer("https://tile.openstreetmap.org/{z}/{x}/{y}.png",{maxZoom:17,attribution:'&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'}).addTo(p),e&&t){const r=[e,t];L.marker(r).addTo(p),p.setView(r,34)}else console.log("Invalid latitude or longitude for supplier")})(e.data.latitude??39.63,e.data.longitude??-105.3199999)}catch(e){console.error(e)}finally{i.value=!1}};return g((()=>{m()})),(t,o)=>{const i=we,d=x,p=Ve,g=Pe,b=r,A=Fe,L=Le,F=xe,P=SX,V=Ne,H=Zn,U=Nn,W=Ht,G=Tt,j=ie,z=ct,$=e,Y=f("tooltip");return y(),w("div",TX,[E("div",CX,[E("div",bX,[E("div",NX,[E("div",AX,[E("div",IX,[E("div",OX,[E("div",MX,[v(i,{size:"large",picture:"lead"==I(l).current_state?"/icons/lead-shield-96.png":"/icons/job-sheild.png",squared:""},null,8,["picture"]),E("h3",null,T(I(l).title?I(l).title:"No Title"),1)])]),E("div",_X,[xX,E("p",LX,[S(T(I(l).address?I(l).address:"No Address Added")+" ",1),FX,S(" "+T(I(l).city?I(l).city:"No City Added")+", "+T(I(l).state?I(l).state:"No State Added")+" ",1),PX,S(" "+T(I(l).zip_code?I(l).zip_code:"No Zip Code Added"),1)])]),E("div",VX,[HX,E("div",DX,[(y(!0),w(M,null,_(I(l).managers_list,(e=>C((y(),O(i,{picture:e.avatar,initials:e.username.slice(0,2),squared:"",color:"warning"},null,8,["picture","initials"])),[[Y,`${e.username??"N/A"} ${e.last_name??""}`,void 0,{info:!0,rounded:!0}]]))),256)),UX]),v(d,{class:"mt-1",onClick:o[0]||(o[0]=e=>(e=>{s.value=e,a.value=!0})(I(n).params.id)),bold:"",fullwidth:"","dark-outlined":""},{default:R((()=>[S(" Update "+T("lead"==I(l).current_state?"lead":"job"),1)])),_:1})])])]),E("div",kX,[E("div",BX,[E("div",WX,[E("div",GX,[E("ul",null,[E("li",{class:D(["management"===I(u)&&"is-active"])},[E("a",{tabindex:"0",role:"button",onKeydown:o[1]||(o[1]=k(B((e=>u.value="management"),["prevent"]),["space"])),onClick:o[2]||(o[2]=e=>u.value="management")},jX,32)],2),E("li",{class:D(["documents"===I(u)&&"is-active"])},[E("a",{tabindex:"0",role:"button",onKeydown:o[3]||(o[3]=k(B((e=>u.value="documents"),["prevent"]),["space"])),onClick:o[4]||(o[4]=e=>u.value="documents")},zX,32)],2),E("li",{class:D(["proposals"===I(u)&&"is-active"])},[E("a",{tabindex:"0",role:"button",onKeydown:o[5]||(o[5]=k(B((e=>u.value="proposals"),["prevent"]),["space"])),onClick:o[6]||(o[6]=e=>u.value="proposals")},$X,32)],2),E("li",{class:D(["tasks"===I(u)&&"is-active"])},[E("a",{tabindex:"0",role:"button",onKeydown:o[7]||(o[7]=k(B((e=>u.value="tasks"),["prevent"]),["space"])),onClick:o[8]||(o[8]=e=>u.value="tasks")},YX,32)],2),E("li",{class:D(["activities"===I(u)&&"is-active"])},[E("a",{tabindex:"0",role:"button",onKeydown:o[9]||(o[9]=k(B((e=>u.value="activities"),["prevent"]),["space"])),onClick:o[10]||(o[10]=e=>u.value="activities")},XX,32)],2),E("li",{class:D(["progress"===I(u)&&"is-active"])},[E("a",{tabindex:"0",role:"button",onKeydown:o[11]||(o[11]=k(B((e=>u.value="progress"),["prevent"]),["space"])),onClick:o[12]||(o[12]=e=>u.value="progress")},KX,32)],2),E("li",{class:D(["calculations"===I(u)&&"is-active"])},[E("a",{tabindex:"0",role:"button",onKeydown:o[13]||(o[13]=k(B((e=>u.value="calculations"),["prevent"]),["space"])),onClick:o[14]||(o[14]=e=>u.value="calculations")},qX,32)],2),E("li",{class:D(["finance"===I(u)&&"is-active"])},[E("a",{tabindex:"0",role:"button",onKeydown:o[15]||(o[15]=k(B((e=>u.value="finance"),["prevent"]),["space"])),onClick:o[16]||(o[16]=e=>u.value="finance")},QX,32)],2),E("li",{class:D(["report"===I(u)&&"is-active"])},[E("a",{tabindex:"0",role:"button",onKeydown:o[17]||(o[17]=k(B((e=>u.value="report"),["prevent"]),["space"])),onClick:o[18]||(o[18]=e=>u.value="report")},ZX,32)],2),JX])])])])]),"management"===I(u)?(y(),w("div",eK,[E("div",tK,[E("div",rK,[E("div",nK,[E("div",oK,[E("div",iK,[sK,E("div",aK,[(y(!0),w(M,null,_(I(l).tags,((e,t)=>(y(),w("button",{key:t,class:"button is-selected is-light is-dark-outlined"},T(e),1)))),128))])])]),E("div",lK,[E("div",uK,[hK,E("div",{innerHTML:I(l).notes},null,8,cK),dK])]),E("div",pK,[E("div",mK,[v(b,{rounded:"",data:h,columns:c},{"body-cell":R((({row:e,column:t,value:r})=>["type"===t.key&&"messages"===e.type?(y(),w(M,{key:0},[v(p,{color:"green"},{default:R((()=>[gK])),_:1}),fK],64)):"type"===t.key&&"tasks"===e.type?(y(),w(M,{key:1},[v(p,{color:"orange"},{default:R((()=>[yK])),_:1}),wK],64)):"status"===t.key?(y(),w(M,{key:2},["new"===e.status?(y(),O(g,{key:0,rounded:"",color:"success",label:"New"})):(y(),O(g,{key:1,rounded:"",label:"Pending"}))],64)):"actions"===t.key?(y(),w("a",EK,"Open")):(y(),w("span",vK,T(r),1))])),_:1})])]),E("div",RK,[E("div",SK,[TK,E("div",CK,[(y(!0),w(M,null,_(I(l).sales_people_info,(e=>(y(),w("div",bK,[E("div",NK,[v(A),v(i,{picture:e.avatar,initials:e.username.slice(0,2),size:"large"},null,8,["picture","initials"]),E("h3",AK,T(e.username??"N/A")+" "+T(e.last_name??""),1),E("p",IK,T(e.role),1),E("div",OK,[v(d,{color:"primary",raised:""},{default:R((()=>[S(" View Profile ")])),_:1})])])])))),256))])])])])]),E("div",MK,["management"===I(u)?(y(),w("div",_K)):N("",!0),v(L,{project:I(n).params.id},null,8,["project"]),v(F,{class:"picker-widget"},{header:R((()=>[xK])),body:R((()=>[LK])),_:1})])])])):N("",!0),"documents"===I(u)?(y(),w("div",FK,[v(P,{leadId:I(n).params.id,uploaded_files:I(l).uploaded_files,getProjectInfo:m},null,8,["leadId","uploaded_files"])])):N("",!0),"proposals"===I(u)?(y(),w("div",PK,[v(He,{"lead-id":I(n).params.id,onUpdateCompany:m},null,8,["lead-id"])])):N("",!0),"activities"===I(u)?(y(),w("div",VK,[v(V,{jobId:I(n).params.id},null,8,["jobId"])])):N("",!0),"progress"===I(u)?(y(),w("div",HK,[v(H,{object:I(n).params.id,type:"job"},null,8,["object"])])):N("",!0),"finance"===I(u)?(y(),w("div",DK,[v(U)])):N("",!0),"activityLogs"===I(u)?(y(),w("div",UK,[v(W,{object_id:I(n).params.id||I(l).id,object_type:"lead"},null,8,["object_id"])])):N("",!0),"report"===I(u)?(y(),w("div",kK,[v(G)])):N("",!0),"tasks"===I(u)?(y(),w("div",BK,[v(j,{projectID:I(n).params.id},null,8,["projectID"])])):N("",!0),"calculations"===I(u)?(y(),w("div",WK,[v(z,{objectId:I(n).params.id},null,8,["objectId"])])):N("",!0)])])]),I(a)?(y(),O($,{key:0,addUpdateLeadModal:I(a),leadId:I(s),"onUpdate:modalHandler":o[19]||(o[19]=e=>a.value=!1),"onUpdate:OnSuccess":m},null,8,["addUpdateLeadModal","leadId"])):N("",!0)])}}});export{GK as _};
