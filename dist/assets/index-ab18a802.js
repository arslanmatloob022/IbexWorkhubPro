import{_ as e}from"./VAvatar.vue_vue_type_style_index_0_lang-e1a11d50.js";import{F as s}from"./FullCalendar-c2d16204.js";import{i as t}from"./index-f52ed8ce.js";import{i as a}from"./index-75e08f06.js";import{u as o}from"./userSession-20c1d8da.js";import{u as r}from"./useNotyf-003e5f34.js";import{u as l}from"./useAPI-1bd54dce.js";import{e as i,r as n,o as c,M as d,y as u,z as p,l as v,H as m,B as h,C as g,J as _,Q as y,R as f,A as b,P as j,L as x,s as w,N as k,D as S,E as C,G as P,v as T}from"./index-bc6f32ee.js";import{u as D}from"./useThemeColors-5e9548e9.js";import{A}from"./vue3-apexcharts.common-502f7e75.js";import{_ as I}from"./VIcon.vue_vue_type_script_setup_true_lang-dfdbce32.js";import{_ as B}from"./VBlock.vue_vue_type_style_index_0_lang-82922d60.js";import{_ as L}from"./VIconBox.vue_vue_type_style_index_0_lang-14ed1f2d.js";import{u as $,a as z}from"./progressChart-229646e1.js";import{f as F}from"./useSupportElement-d8eecd8c.js";import{u as M}from"./viewWrapper-38f53a5f.js";import"./notyf-9c6ddeb2.js";import"./vue.runtime.esm-bundler-0d0f9512.js";import"./billboard-5857d5e1.js";const E={style:{display:"flex","border-radius":"6px","flex-wrap":"wrap","align-items":"center","justify-content":"space-between"}},O={onClick:()=>{},style:{"font-weight":"500","margin-bottom":"0px","padding-left":"10px"}},V={class:"avatars"},W=["src"],H={key:1,style:{width:"100%",height:"100%","background-color":"#292f3c",display:"flex","align-items":"center","justify-content":"center"}},N={class:"mb-0",style:{color:"white"}},Y={class:"v-popover-content is-text"},Q={class:"popover-head"},R={class:"dark-inverted"},G={class:"popover-body"},J=x(i({__name:"ProjectsDashboardCalendar",setup(i){const x=l(),w=o(),k=r(),S=n(!1),C=n(!1),P=n("");n(!1);const T=n([]),D=n({pending:"#8392ab",active:"#fbcf33",completed:"#82d616",canceled:"#344767"}),A=n({plugins:[t,a],schedulerLicenseKey:"0965592368-fcs-1694657447",initialView:"resourceTimelineMonth",height:"auto",resourceAreaWidth:"20%",selectable:!0,headerToolbar:{left:"today prev,next",center:"title",right:"resourceTimelineWeek,resourceTimelineMonth,resourceTimelineYear"},editable:!0,views:{resourceTimelineWeek:{slotDuration:{days:1,hours:1},slotLabelFormat:{weekday:"short",month:"numeric",day:"numeric",year:"numeric"}}},resourceAreaHeaderContent:"Projects",resources:[],eventClick:e=>{"manager"!==w.user.role||e.event.extendedProps.managers.some((e=>e.id===w.user.id))?(C.value=!0,P.value=e.event.id):k.success("You are not allowed to perform this action.")},eventDrop:e=>{let s=e.event.startStr,t=e.event.end.toISOString().substring(0,10);console.log("resource ids",e.event._def.resourceIds[0]),console.log(e.event.extendedProps.project),e.event.extendedProps.project===e.event._def.resourceIds[0]&&confirm(`Are you sure you want to update the project ${e.event.title} date from ${s} to ${t}?`)?B(e.event.id,s,t):e.revert()},eventResize:e=>{let s=e.event.startStr,t=e.event.end.toISOString().substring(0,10);console.log(e.event),confirm(`Are you sure you want to update the project ${e.event.title} date from ${s} to ${t}?`)?B(e.event.id,s,t):e.revert()}}),I=e=>{let s=new Date(e);return s.setDate(s.getDate()+1),s.toISOString().slice(0,10)},B=async(e,s,t)=>{try{let a=await x.patch(`/api/project/${e}/`,{startDate:s,endDate:t});console.log(a),k.success("Project updated successfully")}catch(a){k.error("Something went wrong"),console.log(a)}};return c((async()=>{await(async()=>{try{S.value=!0,console.log("inside all projects func");const e=await x.get("/api/project/",{});T.value=e.data,console.log("scratch projects",T.value),S.value=!1}catch(e){console.error(e),T.value=[],S.value=!1}})(),(()=>{console.log(T.value);const e=T.value.map((e=>({id:e.id,resourceId:e.id,project:e.id,start:e.startDate,end:I(e.endDate),title:e.title,description:e.description,total_tasks:e.total_tasks,managers:e.managers,borderColor:D[e.status]})));A.value.resources=T.value,A.value.events=e})(),console.log("projects",A.value)})),(t,a)=>{const o=e,r=d("Tippy");return u(),p("div",null,[v(S)?j("",!0):(u(),m(v(s),{key:0,options:v(A)},{eventContent:h((e=>[g("div",E,[g("div",null,[g("span",O,_(e.event.title),1),g("span",null," -- tasks ("+_(e.event.extendedProps.total_tasks)+")",1)]),g("div",V,[(u(!0),p(y,null,f(e.event.extendedProps.managers,(s=>(u(),p("div",{class:"avatars__item",key:s.id},[b(r,null,{content:h((()=>[g("div",Y,[g("div",Q,[b(o,{picture:s.avatar,size:"small"},null,8,["picture"]),g("h4",R,_(s.username?s.username:""),1)]),g("div",G,[g("p",null,_(e.event?.title),1)])])])),default:h((()=>[s.avatar?(u(),p("img",{key:0,src:s.avatar,alt:""},null,8,W)):(u(),p("div",H,[g("h6",N,_(s.username?s.username.slice(0,2):"AA"),1)]))])),_:2},1024)])))),128))])])])),_:1},8,["options"]))])}}}),[["__scopeId","data-v-eb14f759"]]),K={class:"dashboard-card"},U=g("div",{class:"card-head"},[g("h3",{class:"dark-inverted"},"Task Completion")],-1),q=i({__name:"DashbaordTasksChart",setup(e){const s=l(),t=n(!1),a=D(),o=w({series:[],chart:{height:295,type:"area",toolbar:{show:!0}},colors:[a.accent,a.info,a.primary],legend:{position:"top"},dataLabels:{enabled:!1},stroke:{width:[2,3,5],curve:"smooth"},xaxis:{type:"date",categories:[]},tooltip:{x:{format:"dd/MM/yy HH:mm"}}});return c((()=>{(async()=>{try{t.value=!0;const e=(await s.get("/api/task/dashboard-analaytics/")).data;o.value.series=e.series,o.value.xaxis.categories=e.dates}catch(e){console.error(e)}finally{t.value=!1}})()})),(e,s)=>(u(),p("div",K,[U,v(t)?j("",!0):(u(),m(v(A),{key:0,id:"completion-chart",height:v(o).chart.height,type:v(o).chart.type,series:v(o).series,options:v(o)},null,8,["height","type","series","options"]))]))}}),X={class:"dashboard-card"},Z=g("div",{class:"card-head"},[g("h3",{class:"dark-inverted"},"Task Completion")],-1),ee=i({__name:"DashBoardTasksPie",setup(e){const s=l(),t=n(!1),a=D(),o=w({height:695,type:"pie",series:[],colors:[a.accent,a.info,a.primary,a.purple,a.orange],labels:[],responsive:[{breakpoint:480,options:{chart:{width:315,toolbar:{show:!0}},legend:{position:"top"}}}],legend:{position:"right",horizontalAlign:"center"}});return c((()=>{(async()=>{try{t.value=!0;const e=(await s.get("/api/task/dashboard-analaytics/")).data.series;o.value.labels=e.map((e=>e.name)),console.log("chart",o.value.labels),o.value.series=e.map((e=>e.data.reduce(((e,s)=>e+s),0)))}catch(e){console.error(e)}finally{t.value=!1}})()})),(e,s)=>(u(),p("div",X,[Z,v(t)?j("",!0):(u(),m(v(A),{key:0,id:"completion-chart",height:v(o).height,type:v(o).type,series:v(o).series,options:v(o)},null,8,["height","type","series","options"]))]))}}),se={class:"dashboard-card"},te=g("div",{class:"card-head"},[g("h3",{class:"dark-inverted"},"Projects Stats")],-1),ae=i({__name:"ProjectsStatsChart",setup(e){const s=l(),t=n(!1),a=D(),o=n({series:[{name:"Projects",data:[]}],height:280,type:"bar",options:{chart:{toolbar:{show:!0}},plotOptions:{bar:{dataLabels:{position:"top"}}},dataLabels:{enabled:!0,offsetY:-20,style:{fontSize:"12px",colors:["#304758"]}},xaxis:{categories:[],position:"bottom",axisBorder:{show:!1},axisTicks:{show:!1},crosshairs:{fill:{type:"gradient",gradient:{colorFrom:"#D8E3F0",colorTo:"#BED1E6",stops:[0,100],opacityFrom:.4,opacityTo:.5}}},tooltip:{enabled:!0}},yaxis:{axisBorder:{show:!1},axisTicks:{show:!1},labels:{show:!1}},colors:[a.primary,a.secondary,a.orange],title:{text:"",align:"left"}}});return c((()=>{(async()=>{try{t.value=!0;const e=(await s.get("/api/project/project-analaytics/")).data;o.value.series[0].data=e.count,o.value.options.xaxis.categories=e.months}catch(e){console.error(e)}finally{t.value=!1}})()})),(e,s)=>(u(),p("div",se,[te,v(t)?j("",!0):(u(),m(v(A),{key:0,height:v(o).height,type:v(o).type,series:v(o).series,options:v(o).options},null,8,["height","type","series","options"]))]))}}),oe={class:"personal-dashboard personal-dashboard-v3"},re={class:"columns is-multiline"},le={class:"column is-12"},ie={class:"columns is-multiline is-flex-tablet-p"},ne={class:"column is-12"},ce={class:"stats-wrapper"},de={class:"columns is-multiline is-flex-tablet-p"},ue={class:"column is-3"},pe={class:"dashboard-card"},ve=g("i",{class:"fas fa-cubes","aria-hidden":"true"},null,-1),me={class:"column is-3"},he={class:"dashboard-card"},ge=g("i",{class:"fas fa-boxes","aria-hidden":"true"},null,-1),_e={class:"column is-3"},ye={class:"dashboard-card"},fe=g("i",{class:"fas fa-border-style","aria-hidden":"true"},null,-1),be={class:"column is-3"},je={class:"dashboard-card"},xe=g("i",{class:"fas fa-dice-d6","aria-hidden":"true"},null,-1),we={class:"column is-3"},ke={class:"dashboard-card"},Se=g("i",{class:"fas fa-hospital-user","aria-hidden":"true"},null,-1),Ce={class:"column is-3"},Pe={class:"dashboard-card"},Te=g("i",{class:"fas fa-users","aria-hidden":"true"},null,-1),De={class:"column is-3"},Ae={class:"dashboard-card"},Ie=g("i",{class:"fas fa-user-tag","aria-hidden":"true"},null,-1),Be={class:"column is-3"},Le={class:"dashboard-card"},$e=g("i",{class:"fas fa-user-tie","aria-hidden":"true"},null,-1),ze={class:"columns is-multiline"},Fe={class:"column is-8"},Me={class:"column is-4"},Ee={class:"column is-12"},Oe={class:"column is-12"},Ve=i({__name:"IbexDashboard",setup(e){$(),z();const s=l();k();const t=n(!1),a=n({all_project:0,active_projects:0,pending_projects:0,completed_projects:0,workers:0,managers:0,last_mail_sent:"",clients:0,contractors:0}),o=async()=>{try{t.value=!0;const e=await s.get("/api/project/dashboard/",{});a.value=e.data,t.value=!1}catch(e){console.log(e)}finally{t.value=!1}},r=()=>{try{t.value=!0;const e=s.post("/api/task/worker-mail/",{worker:"all"});console.log(e),o(),t.value=!1}catch(e){console.log(e)}};return c((()=>{o()})),(e,s)=>{const o=L,l=B,i=I,n=C,c=ae,d=ee,m=q,_=J;return u(),p("div",oe,[g("div",re,[g("div",le,[g("div",ie,[g("div",ne,[g("div",ce,[g("div",de,[g("div",ue,[g("div",pe,[b(l,{title:a.value?.all_project?a.value.all_project:"0",subtitle:"All Projects",center:""},{icon:h((()=>[b(o,{color:"info",rounded:""},{default:h((()=>[ve])),_:1})])),_:1},8,["title"])])]),g("div",me,[g("div",he,[b(l,{title:a.value?.active_projects?a.value?.active_projects:"0",subtitle:"Active Projects",center:""},{icon:h((()=>[b(o,{color:"blue",rounded:""},{default:h((()=>[ge])),_:1})])),_:1},8,["title"])])]),g("div",_e,[g("div",ye,[b(l,{title:a.value?.pending_projects?a.value?.pending_projects:"0",subtitle:"Pre Construction",center:""},{icon:h((()=>[b(o,{color:"pink",rounded:""},{default:h((()=>[fe])),_:1})])),_:1},8,["title"])])]),g("div",be,[g("div",je,[b(l,{title:a.value?.completed_projects?a.value?.completed_projects:"0",subtitle:"Completed",center:""},{icon:h((()=>[b(o,{color:"green",rounded:""},{default:h((()=>[xe])),_:1})])),_:1},8,["title"])])]),g("div",we,[g("div",ke,[b(l,{title:a.value?.managers?a.value?.managers:"0",subtitle:"Managers",center:""},{icon:h((()=>[b(o,{color:"yellow",rounded:""},{default:h((()=>[Se])),_:1})])),_:1},8,["title"])])]),g("div",Ce,[g("div",Pe,[b(l,{title:a.value?.workers?a.value?.workers:"0",subtitle:"Workers",center:""},{icon:h((()=>[b(o,{color:"lime",rounded:""},{default:h((()=>[Te])),_:1})])),_:1},8,["title"])])]),g("div",De,[g("div",Ae,[b(l,{title:a.value?.contractors?a.value?.contractors:"0",subtitle:"Contractors",center:""},{icon:h((()=>[b(o,{color:"orange",rounded:""},{default:h((()=>[Ie])),_:1})])),_:1},8,["title"])])]),g("div",Be,[g("div",Le,[b(l,{title:a.value?.clients?a.value?.clients:"0",subtitle:"Clients",center:""},{icon:h((()=>[b(o,{color:"blue",rounded:""},{default:h((()=>[$e])),_:1})])),_:1},8,["title"])])])]),b(l,{title:"Last Schedule Sent",subtitle:a.value.last_mail_sent?v(F)(a.value.last_mail_sent):"N/A"},{icon:h((()=>[b(o,{color:"success",rounded:""},{default:h((()=>[b(i,{icon:"lucide:clock"})])),_:1})])),action:h((()=>[b(n,{onClick:r,color:"warning",rounded:"",loading:t.value,elevated:""},{default:h((()=>[S(" Send Schedule ")])),_:1},8,["loading"])])),_:1},8,["subtitle"])])])])])]),g("div",ze,[g("div",Fe,[b(c)]),g("div",Me,[b(d,{style:{height:"360px"}})]),g("div",Ee,[b(m)]),g("div",Oe,[b(_)])])])}}}),We={class:"page-content-inner"},He=i({__name:"index",setup(e){P();return M().setPageTitle("Ibex Builders Studios"),T((()=>({title:"Ibex Builders Studios"}))),(e,s)=>{const t=Ve;return u(),p("div",We,[b(t)])}}});export{He as default};
