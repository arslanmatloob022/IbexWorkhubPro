import{_ as e}from"./VModal.vue_vue_type_style_index_0_lang-8219c908.js";import{_ as l}from"./LeadProposalsList.vue_vue_type_style_index_0_lang-2377d321.js";import{e as a,s,r as t,o as i,B as o,N as n,F as d,D as c,E as u,K as r,l as m,W as p,J as v,I as f,a4 as b,O as y,b as _,_ as g,A as h,C as V,ab as C,aE as S,M as x,a0 as U,aF as j,w as k,H as w,G as I,U as N,V as A,T as E,j as M}from"./index-29281dbb.js";import{_ as P}from"./VControl-ee52cd5b.js";import{_ as L}from"./VSwitchBlock.vue_vue_type_style_index_0_lang-e79b97e5.js";import{u as D,a as H}from"./useAPI-dc6e43aa.js";import{u as O}from"./useNotyf-10ab29f3.js";import{a as T,C as R}from"./useSupportElement-aeaa4876.js";import{u as F}from"./userSession-d868ea25.js";import{_ as z}from"./VField.vue_vue_type_script_setup_true_lang-6940a4a4.js";import{_ as $,a as G}from"./VOption.vue_vue_type_style_index_0_lang-4650ae15.js";import{C as q}from"./ckeditor-abc035b9.js";import{C as W}from"./ckeditor-9e23ed86.js";const B={class:"modal-form columns is-multiline"},K={class:"column is-12 m-0"},Z=c("div",{class:"column is-12"},[c("h3",{class:"title is-6 mb-2"},"Contact Information")],-1),J={class:"field column is-6 mb-0"},X=c("label",null,"First Name *",-1),Y={class:"control"},Q={class:"field column is-6 mb-0"},ee=c("label",null,"Last Name ",-1),le={class:"control"},ae={class:"field column is-6 mb-0"},se=c("label",null,"Display Name * ",-1),te={class:"control"},ie={class:"field column is-6 mb-0"},oe=c("label",null,"Primary Email ",-1),ne={class:"control"},de={class:"field column is-12 mb-0"},ce=c("label",null,"Street Address ",-1),ue={class:"control"},re={class:"field column is-6 mb-0"},me=c("label",null,"City: ",-1),pe={class:"control"},ve={class:"field column is-3 mb-0"},fe=c("label",null,"State: ",-1),be={class:"control"},ye={class:"field column is-3 mb-0"},_e=c("label",null,"Zip Code: ",-1),ge={class:"control"},he={class:"field column is-6 mb-0"},Ve=c("label",null,"Phone ",-1),Ce={class:"control"},Se={class:"field column is-6 mb-0"},xe=c("label",null,"Cell Phone ",-1),Ue={class:"control"},je=c("div",{class:"column is-12"},[c("h3",{class:"title is-6 mb-2"},"Security & Login")],-1),ke={class:"field column is-3 mb-0"},we={class:"field column is-3 mb-0"},Ie=a({__name:"AddUpdateContactModal",props:{addUpdateContactModal:{type:Boolean},userId:{}},emits:["update:modalHandler","update:OnSuccess"],setup(l,{emit:a}){const _=l;s(),F();const g=O(),h=D(),V=t(!1),C=t({}),S=t({firstName:"",lastName:"",displayName:"",address:"",city:"",state:"",zipCode:"",phone:"",cellPhone:"",email:"",latitude:"",longitude:"",loginAllowed:!1,inviteLogin:!1}),x=async()=>{try{V.value=!0;const e=T(C.value,["profileImageURL"]);await h.post("/v3/api/worker/",e);U(),g.dismissAll(),g.success("New worker added, New Worker")}catch(e){g.error(` ${e}, New Worker`)}finally{V.value=!1}},U=()=>{a("update:modalHandler",!1)},j=async()=>{try{const e=await H.get(`https://maps.googleapis.com/maps/api/geocode/json?address=${C.value.postCode}&key=AIzaSyDWHedwkLGGa4_3XgPqYxIzMkFpOdKJRik`);"OK"===e.data.status?(S.value.address=e.data.results[0].formatted_address,S.value.latitude=e.data.results[0].geometry.location.lat,S.value.longitude=e.data.results[0].geometry.location.lng,g.success("Address Added")):"ZERO_RESULTS"===e.data.status&&g.error("Invalid Post-Code")}catch(e){g.error("Invalid Post-Code"),console.error(e)}};return i((()=>{})),(l,a)=>{const s=b,t=L,i=P,g=y,h=e;return o(),n(h,{is:"form",open:_.addUpdateContactModal,title:"Contact Person",size:"big",actions:"right",onSubmit:f(x,["prevent"]),onClose:U},{content:d((()=>[c("div",B,[c("div",K,[u(s,{class:"columns is-multiline"},{default:d((()=>[Z,c("div",J,[X,c("div",Y,[r(c("input",{type:"text",name:"firstName","onUpdate:modelValue":a[0]||(a[0]=e=>m(S).firstName=e),required:"",class:"input is-primary-focus is-primary-focus",placeholder:"First Name"},null,512),[[p,m(S).firstName]])])]),c("div",Q,[ee,c("div",le,[r(c("input",{type:"text",name:"lastName","onUpdate:modelValue":a[1]||(a[1]=e=>m(S).lastName=e),class:"input is-primary-focus is-primary-focus",placeholder:"Last Name"},null,512),[[p,m(S).lastName]])])]),c("div",ae,[se,c("div",te,[r(c("input",{required:"",type:"text",name:"disName","onUpdate:modelValue":a[2]||(a[2]=e=>m(S).lastName=e),class:"input is-primary-focus is-primary-focus",placeholder:"Display Name"},null,512),[[p,m(S).lastName]])])]),c("div",ie,[oe,c("div",ne,[r(c("input",{type:"email",name:"email","onUpdate:modelValue":a[3]||(a[3]=e=>m(S).email=e),class:"input is-primary-focus is-primary-focus",placeholder:"Contact email"},null,512),[[p,m(S).email]])])]),c("div",de,[ce,c("div",ue,[r(c("input",{required:"",type:"text",name:"address","onUpdate:modelValue":a[4]||(a[4]=e=>m(S).lastName=e),class:"input is-primary-focus is-primary-focus",placeholder:"Street Address"},null,512),[[p,m(S).lastName]])])]),c("div",re,[me,c("div",pe,[r(c("input",{type:"text",name:"city","onUpdate:modelValue":a[5]||(a[5]=e=>m(S).city=e),class:"input is-primary-focus is-primary-focus",placeholder:"City"},null,512),[[p,m(S).city]])])]),c("div",ve,[fe,c("div",be,[r(c("input",{type:"text",name:"state","onUpdate:modelValue":a[6]||(a[6]=e=>m(S).state=e),class:"input is-primary-focus is-primary-focus",placeholder:"State"},null,512),[[p,m(S).state]])])]),c("div",ye,[_e,c("div",ge,[r(c("input",{type:"tel",name:"zipCode",onBlur:j,"onUpdate:modelValue":a[7]||(a[7]=e=>m(S).zipCode=e),class:"input is-primary-focus is-primary-focus",placeholder:"Zip code"},null,544),[[p,m(S).zipCode]])])]),c("div",he,[Ve,c("div",Ce,[r(c("input",{type:"tel",name:"phone","onUpdate:modelValue":a[8]||(a[8]=e=>m(S).phone=e),class:"input is-primary-focus is-primary-focus",placeholder:"Phone Number"},null,512),[[p,m(S).phone]])])]),c("div",Se,[xe,c("div",Ue,[r(c("input",{type:"tel",name:"phone","onUpdate:modelValue":a[9]||(a[9]=e=>m(S).cellPhone=e),class:"input is-primary-focus is-primary-focus",placeholder:"Cell Phone"},null,512),[[p,m(S).cellPhone]])])])])),_:1}),u(s,{class:"columns is-multiline mt-3"},{default:d((()=>[je,c("div",ke,[u(i,{subcontrol:""},{default:d((()=>[u(t,{thin:"",color:"primary",modelValue:m(S).loginAllowed,"onUpdate:modelValue":a[10]||(a[10]=e=>m(S).loginAllowed=e),label:"Allow login"},null,8,["modelValue"])])),_:1})]),c("div",we,[u(i,{subcontrol:""},{default:d((()=>[u(t,{thin:"",color:"primary",modelValue:m(S).inviteLogin,"onUpdate:modelValue":a[11]||(a[11]=e=>m(S).inviteLogin=e),label:"Send invite"},null,8,["modelValue"])])),_:1})])])),_:1})])])])),action:d((()=>[u(g,{loading:m(V),type:"submit",color:"primary",icon:"fas fa-plus",raised:""},{default:d((()=>[v("Add Contact")])),_:1},8,["loading"])])),_:1},8,["open","onSubmit"])}}}),Ne={class:"modal-form columns is-multiline"},Ae={class:"field column is-full"},Ee=c("label",{class:"label"},"Schedule Mail ",-1),Me=["value"],Pe={class:"column is-full"},Le={class:"field"},De=c("label",{class:"label"},"To ",-1),He={class:"control"},Oe={class:"column is-full"},Te={class:"field"},Re=c("label",{class:"label"},"Subject ",-1),Fe={class:"control"},ze={class:"field column is-full mt-5"},$e=c("label",{class:"label"},null,-1),Ge=c("i",{class:"feather:mail"},null,-1),qe=a({__name:"GenericEmailSender",props:{mailSenderModal:{type:Boolean},subject:{}},emits:["update:modalHandler","update:OnSuccess"],setup(l,{emit:a}){const b=l,k=D(),w=t(!1),I=O(),N=t(!1),A=t(""),E=s(),M=()=>{a("update:modalHandler",!1)};A.value="<b> Hi  <br />\nIbex Management <br />\n</b>";const L=t({scheduled_at:"",mailGroup:[],mail:"",subject:"",message:""}),H=async()=>{try{N.value=!0;await k.post("",{mail:L.value.mail,subject:L.value.subject,message:L.value.message,scheduled_at:L.value.scheduled_at});I.success("Email sent to worker successfully"),M()}catch(e){console.log(e)}finally{N.value=!1}},T=_((()=>g((()=>import("./ckeditor-abc035b9.js").then((e=>e.c))),["assets/ckeditor-abc035b9.js","assets/index-29281dbb.js","assets/index-a879fc9d.css","assets/vue.runtime.esm-bundler-1ff5ddd1.js"]).then((e=>e.default.component)))),R={fontFamily:{options:['"Montserrat", sans-serif','"Roboto", sans-serif']},height:"400px",minHeight:"400px",maxHeight:"600px"};return i((async()=>{E.value=await g((()=>import("./ckeditor-9e23ed86.js").then((e=>e.c))),["assets/ckeditor-9e23ed86.js","assets/index-29281dbb.js","assets/index-a879fc9d.css"]).then((e=>e.default))})),(l,a)=>{const s=P,t=z,i=h("VDatePicker"),_=j,g=y,k=e;return o(),V("div",null,[u(U,{name:"fade-slow"},{default:d((()=>[u(k,{is:"form",open:b.mailSenderModal,title:"Send Email",size:"large",actions:"right",onSubmit:f(H,["prevent"]),onClose:M},{content:d((()=>[c("div",Ne,[c("div",Ae,[Ee,u(_,null,{default:d((()=>[u(i,{modelValue:m(L).scheduled_at,"onUpdate:modelValue":a[0]||(a[0]=e=>m(L).scheduled_at=e),mode:"dateTime"},{default:d((({inputValue:e,inputEvents:l})=>[u(t,null,{default:d((()=>[u(s,{icon:"lucide:calendar"},{default:d((()=>[c("input",C({class:"input v-input",type:"text",value:e},S(l,!0)),null,16,Me)])),_:2},1024)])),_:2},1024)])),_:1},8,["modelValue"])])),_:1})]),c("div",Pe,[c("div",Le,[De,c("div",He,[r(c("input",{type:"email",required:"",class:"input",placeholder:"Enter Mail","onUpdate:modelValue":a[1]||(a[1]=e=>m(L).mail=e)},null,512),[[p,m(L).mail]])])])]),c("div",Oe,[c("div",Te,[Re,c("div",Fe,[r(c("input",{type:"text",required:"",class:"input",placeholder:"Enter mail subject","onUpdate:modelValue":a[2]||(a[2]=e=>m(L).subject=e)},null,512),[[p,m(L).subject]])])])]),c("div",ze,[$e,m(E)?(o(),n(m(T),{key:0,modelValue:m(L).message,"onUpdate:modelValue":a[3]||(a[3]=e=>m(L).message=e),editor:m(E),config:R},null,8,["modelValue","editor"])):x("",!0)])])])),action:d((()=>[u(g,{onClick:H,color:"primary",loading:m(w),raised:""},{default:d((()=>[Ge,v(" Schedule Mail")])),_:1},8,["loading"])])),cancel:d((()=>[u(g,{color:"light",onClick:M,raised:""},{default:d((()=>[v("Close ")])),_:1})])),_:1},8,["open","onSubmit"])])),_:1})])}}}),We={class:"modal-form columns is-multiline"},Be={class:"column is-full"},Ke={class:"field"},Ze=c("label",{class:"label"},"To ",-1),Je={class:"control"},Xe={class:"column is-full"},Ye={class:"field"},Qe=c("label",{class:"label"},"Subject ",-1),el={class:"control"},ll={class:"field column is-half"},al=c("label",{class:"label"},"Schedule Mail ",-1),sl=["value"],tl={class:"field column is-half"},il=c("div",{class:"file"},[c("label",{class:"file-label"},[c("input",{class:"file-input",type:"file",name:"resume"}),c("span",{class:"file-cta"},[c("span",{class:"file-icon"},[c("i",{class:"fas fa-cloud-upload-alt"})]),c("span",{class:"file-label"}," Choose a file… ")])])],-1),ol={class:"field column is-full mt-5"},nl=c("label",{class:"label"},null,-1),dl=c("i",{class:"feather:mail"},null,-1),cl=a({__name:"ScheduleEmailModal",props:{mailSchedulerModal:{type:Boolean},subject:{}},emits:["update:modalHandler","update:OnSuccess"],setup(l,{emit:a}){const b=l,k=D(),w=t(!1),I=O(),N=t(!1),A=t(""),E=s(),M=()=>{a("update:modalHandler",!1)};A.value="<b> Hi  <br />\nIbex Management <br />\n</b>";const L=t({objectId:"",subject:"",content:"",mail:"",scheduled_at:"",sent_at:"",status:"",mailGroup:[]}),H=async()=>{try{N.value=!0;await k.post("",{mail:L.value.mail,subject:L.value.subject,content:L.value.content,scheduled_at:L.value.scheduled_at});I.success("Email sent to worker successfully"),M()}catch(e){console.log(e)}finally{N.value=!1}},T=_((()=>g((()=>import("./ckeditor-abc035b9.js").then((e=>e.c))),["assets/ckeditor-abc035b9.js","assets/index-29281dbb.js","assets/index-a879fc9d.css","assets/vue.runtime.esm-bundler-1ff5ddd1.js"]).then((e=>e.default.component)))),R={fontFamily:{options:['"Montserrat", sans-serif','"Roboto", sans-serif']},height:"400px",minHeight:"400px",maxHeight:"600px"};return i((async()=>{E.value=await g((()=>import("./ckeditor-9e23ed86.js").then((e=>e.c))),["assets/ckeditor-9e23ed86.js","assets/index-29281dbb.js","assets/index-a879fc9d.css"]).then((e=>e.default))})),(l,a)=>{const s=P,t=z,i=h("VDatePicker"),_=j,g=y,k=e;return o(),V("div",null,[u(U,{name:"fade-slow"},{default:d((()=>[u(k,{is:"form",open:b.mailSchedulerModal,title:"Schedule Email",size:"large",actions:"right",onSubmit:f(H,["prevent"]),onClose:M},{content:d((()=>[c("div",We,[c("div",Be,[c("div",Ke,[Ze,c("div",Je,[r(c("input",{type:"email",required:"",class:"input",placeholder:"Enter Mail","onUpdate:modelValue":a[0]||(a[0]=e=>m(L).mail=e)},null,512),[[p,m(L).mail]])])])]),c("div",Xe,[c("div",Ye,[Qe,c("div",el,[r(c("input",{type:"text",required:"",class:"input",placeholder:"Enter mail subject","onUpdate:modelValue":a[1]||(a[1]=e=>m(L).subject=e)},null,512),[[p,m(L).subject]])])])]),c("div",ll,[al,u(_,null,{default:d((()=>[u(i,{modelValue:m(L).scheduled_at,"onUpdate:modelValue":a[2]||(a[2]=e=>m(L).scheduled_at=e),mode:"dateTime"},{default:d((({inputValue:e,inputEvents:l})=>[u(t,null,{default:d((()=>[u(s,{icon:"lucide:calendar"},{default:d((()=>[c("input",C({class:"input v-input",type:"text",value:e},S(l,!0)),null,16,sl)])),_:2},1024)])),_:2},1024)])),_:1},8,["modelValue"])])),_:1})]),c("div",tl,[u(t,{grouped:""},{default:d((()=>[u(s,null,{default:d((()=>[il])),_:1})])),_:1})]),c("div",ol,[nl,m(E)?(o(),n(m(T),{key:0,modelValue:m(L).content,"onUpdate:modelValue":a[3]||(a[3]=e=>m(L).content=e),editor:m(E),config:R},null,8,["modelValue","editor"])):x("",!0)])])])),action:d((()=>[u(g,{onClick:H,color:"primary",loading:m(w),raised:""},{default:d((()=>[dl,v(" Schedule Mail")])),_:1},8,["loading"])])),cancel:d((()=>[u(g,{color:"light",onClick:M,raised:""},{default:d((()=>[v("Close ")])),_:1})])),_:1},8,["open","onSubmit"])])),_:1})])}}}),ul={class:"modal-form columns is-multiline",style:{height:"80dvh"}},rl={class:"tabs-wrapper column is-12 m-0"},ml={class:"tabs-inner"},pl={class:"tabs is-boxed"},vl=[c("span",null,"General",-1)],fl=[c("span",null,"Activities",-1)],bl=[c("span",null,"Proposals",-1)],yl={key:0,class:"column is-12"},_l=c("h3",{class:"title is-6 mb-2"},"General Information",-1),gl={class:"columns is-multiline"},hl={class:"field column is-12 mb-0"},Vl=c("label",null,"Opportunity Title: *",-1),Cl={class:"control"},Sl={class:"field column is-3 mb-0"},xl=c("label",null,"Zip Code: without slash ",-1),Ul={class:"control"},jl={class:"field column is-3 mb-0"},kl=c("label",null,"City: ",-1),wl={class:"control"},Il={class:"field column is-6 mb-0"},Nl=c("label",null,"State: ",-1),Al={class:"control"},El={class:"field column is-6 mb-0"},Ml=c("label",null,"Address: ",-1),Pl={class:"control"},Ll={class:"field column is-6 mb-0"},Dl=c("label",null,"Confidence ",-1),Hl={class:"control"},Ol={class:"field column is-6 mb-0"},Tl=c("label",null,"Projected Sale Date: ",-1),Rl={class:"control"},Fl={class:"field column is-6 mb-0"},zl=c("label",null,"Project Type ",-1),$l={class:"field column is-6 mb-0"},Gl=c("label",null,"Start Date: ",-1),ql={class:"control"},Wl={class:"field column is-6 mb-0"},Bl=c("label",null,"End Date: ",-1),Kl={class:"control"},Zl={class:"field column is-12 mb-0"},Jl={class:"multiselect-single-label"},Xl=["src"],Yl={class:"select-label-text"},Ql=["src"],ea={class:"select-label-text"},la={class:"field column is-3 mb-0"},aa={class:"multiselect-single-label"},sa=["src"],ta={class:"select-label-text"},ia=["src"],oa={class:"select-label-text"},na={class:"field column is-3 mb-0"},da={class:"multiselect-single-label"},ca=["src"],ua={class:"select-label-text"},ra=["src"],ma={class:"select-label-text"},pa={class:"field column is-6 mb-0"},va={class:"multiselect-single-label"},fa=["src"],ba={class:"select-label-text"},ya=["src"],_a={class:"select-label-text"},ga={class:"field column is-3 mb-0"},ha=c("label",null,"Estimated Revenue: ",-1),Va={class:"control"},Ca={class:"field column is-3 mb-0"},Sa=c("label",null,"To",-1),xa={class:"control"},Ua={class:"field column is-6 mb-0"},ja=c("label",null,"Tags ",-1),ka={class:"field column is-6 mb-0"},wa=c("label",null,"Sources ",-1),Ia={class:"field column is-6 mb-0"},Na=c("label",null,"Status ",-1),Aa=c("h3",{class:"title is-6 mb-2"},"Notes",-1),Ea={class:"field column is-12 mb-0"},Ma=c("h3",{class:"title is-6 mb-2"},"Attach Documents",-1),Pa={class:"field column is-12 mb-0"},La=c("label",null,"Attachments ",-1),Da=c("div",{class:"file"},[c("label",{class:"file-label"},[c("input",{class:"file-input",type:"file",name:"resume"}),c("span",{class:"file-cta"},[c("span",{class:"file-icon"},[c("i",{class:"fas fa-cloud-upload-alt"})]),c("span",{class:"file-label"}," Choose a file… ")])])],-1),Ha={key:1,class:"column is-12"},Oa=c("div",{class:"column is-12",style:{"text-align":"center"}},[c("h1",{class:"title is-4"},"Connect your clients to their projects"),c("h1",{class:"title is-5"}," Create a client contact and assign them to jobs and lead opportunities effortlessly. ")],-1),Ta={class:"column is-6"},Ra={class:"column is-6"},Fa=c("div",{class:"column is-3"},null,-1),za=c("div",{class:"column is-6 text-align-center"},[c("i",{class:"fas fa-phone-alt fa-5x primary-text text-primary mb-3","aria-hidden":"true"}),c("h1",{class:"title is-4"},"Engage your leads with activities"),c("h1",{class:"title is-6"}," Track calls, emails, and meeting notes for leads in one place. ")],-1),$a=c("div",{class:"column is-3"},null,-1),Ga=c("div",{class:"column is-3"},null,-1),qa={class:"column is-6 text-align-center"},Wa=c("div",{class:"column is-3"},null,-1),Ba={key:2,class:"column is-12"},Ka={class:"column is-12"},Za=a({__name:"LeadAddUpdateModal",props:{addUpdateLeadModal:{type:Boolean},leadId:{}},emits:["update:modalHandler","update:OnSuccess"],setup(a,{emit:s}){const _=a,g=F(),C=O(),S=D(),U=t(0),j=t(!1),L=t(!1),B=t(!1),K=t([]),Z=t([]),J=()=>{s("update:modalHandler",!1)},X=t(""),Y=t("general"),Q=t([]),ee=[{id:1,value:"Lead",label:"Lead"},{id:2,value:"Home",label:"Home"},{id:3,value:"Floor Work",label:"Floor Work"},{id:4,value:"Tile Work",label:"Tile Work"},{id:5,value:"Carpenter",label:"Carpenter"},{id:6,value:"Complete Renovation",label:"Complete Renovation"},{id:7,value:"Painting",label:"Painting"},{id:8,value:"Plumbing",label:"Plumbing"},{id:9,value:"New Construction",label:"New Construction"},{id:10,value:"Carpenter",label:"Carpenter"},{id:11,value:"Carpenter",label:"Carpenter"},{id:12,value:"Carpenter",label:"Carpenter"}],le=[{value:"all",label:"All"},{value:"Contact Form",label:"Contact Form"},{value:"Social Media",label:"Social Media"},{value:"Referral",label:"Referral"},{value:"Company Website",label:"Company Website"}],ae=t([{value:"",name:"",icon:""}]),se=t([{value:"",name:"",icon:""}]),te=t([{value:"",name:"",icon:""}]),ie=q.component,oe={fontFamily:{options:['"Montserrat Variable", sans-serif','"Roboto Flex Variable", sans-serif']}},ne=t({id:"",title:"",address:"",leadStatus:"open",current_state:"",city:"",state:"",status:"",zip_code:"",contractor:"",confidence:0,sale_date:"",sales_people:[],tags:[],estimated_from:"",estimated_to:"",sources:"",project_type:"",notes:"",attachments:[],attach_mail:"",created_by:g.user.id,managers:[],client:"",latitude:0,longitude:0,startDate:"",endDate:"",description:"",image:"",color:"",is_active:!0,wifiAvaliabe:!1,parkingAvaliable:!1,property_features:!1}),de=t([{value:"open",label:"Open"},{value:"onHold",label:"On Hold"},{value:"lost",label:"Lost"},{value:"sold",label:"Sold"}]),ce=t([{value:"Residential",label:"Residential"},{value:"Commercial",label:"Commercial"},{value:"Government",label:"Government"},{value:"Business Site",label:"Business Site"},{value:"Company/Factories",label:"Company/Factories"}]),ue=async(e=0)=>{try{U.value=e,ne.value.tags=JSON.stringify(Q.value);const l=T(ne.value,["image"]);if(ne.value.client||l.append("client",""),ne.value.contractor||l.append("contractor",""),_.leadId||ne.value.id){const e=await S.patch(`/api/project/${_.leadId?_.leadId:ne.value.id}/`,l);ne.value=e.data,R({object_type:"lead",action:"UPDATE",performedOnName:"lead",object_id:_.leadId||ne.value.id,message:`updated <a>${ne.value.title}</a> ${ne.value.state} information.`})}else{const e=await S.post("/api/project/",l);ne.value=e.data,R({object_type:"lead",action:"CREATE",performedOnName:"lead",object_id:_.leadId||ne.value.id,message:`created new <a>${ne.value.title}</a> ${ne.value.state} information.`})}C.success(`Lead ${_.leadId||ne.value.id?"updated":"created"} successfully`),s("update:OnSuccess",null),3==e&&J()}catch(l){C.error(`${l}, Lead`)}finally{U.value=0}},re=async()=>{try{const e=await H.get(`https://maps.googleapis.com/maps/api/geocode/json?address=${ne.value.zip_code}&key=AIzaSyDWHedwkLGGa4_3XgPqYxIzMkFpOdKJRik`);"OK"===e.data.status?(ne.value.address=e.data.results[0].formatted_address,ne.value.latitude=e.data.results[0].geometry.location.lat,ne.value.longitude=e.data.results[0].geometry.location.lng,ne.value.city=e.data.results[0].address_components[1].long_name,ne.value.state=e.data.results[0].address_components[3].long_name,C.success("Address Added")):"ZERO_RESULTS"===e.data.status&&C.error("Invalid Post-Code")}catch(e){C.error("Invalid Post-Code"),console.error(e)}};return k((()=>ne.value.leadStatus),(()=>{"sold"==ne.value.leadStatus&&(ne.value.current_state="job")})),i((async()=>{_.leadId&&(async()=>{try{U.value=1;const e=await S.get(`/api/project/${_.leadId}/single-project/`);ne.value=e.data,Q.value=e.data.tags}catch(e){C.error(` ${e}, Lead`)}finally{U.value=0}})(),(async()=>{try{U.value=1;const e=await S.get("/api/users/by-role/manager/",{});te.value=e.data.map((e=>({value:e.id,name:`${e.username?e.username:""+e.lastName?e.lastName:""}`,icon:e.avatar}))),X.value=ne.value.manager}catch(e){console.log(e)}finally{U.value=0}})(),(async()=>{try{U.value=1;const e=await S.get("/api/users/by-role/admin/");e&&e.data?(Z.value=e.data.map((e=>({value:e.id,name:`${e.username||""} ${e.lastName||""}`.trim(),icon:e.avatar||""}))),ne.value?.sales_people?.length&&(K.value=ne.value?.sales_people)):C.error("Failed to fetch admin data.")}catch(e){console.error("Error fetching admin data:",e),C.error("An error occurred while fetching admins.")}finally{U.value=0}})(),(async()=>{try{U.value=1;const e=await S.get("/api/users/by-role/contractor/",{});ae.value=e.data.map((e=>({value:e.id,name:`${e.username?e.username:""+e.lastName?e.lastName:""}`,icon:e.avatar})))}catch(e){console.log(e)}finally{U.value=0}})(),(async()=>{try{U.value=1;const e=await S.get("/api/users/by-role/client/",{});se.value=e.data.map((e=>({value:e.id,name:`${e.username?e.username:""+e.lastName?e.lastName:""}`,icon:e.avatar})))}catch(e){console.log(e)}finally{U.value=0}})()})),(a,s)=>{const t=h("Slider"),i=P,g=z,C=$,S=G,k=h("Multiselect"),D=b,H=y,O=cl,T=qe,R=Ie,F=l,q=e;return o(),n(q,{is:"form",open:_.addUpdateLeadModal,title:"Lead Information",size:"xl",actions:"right",onSubmit:s[33]||(s[33]=f((e=>ue(1)),["prevent"])),onClose:J},{content:d((()=>[c("div",ul,[c("div",rl,[c("div",ml,[c("div",pl,[c("ul",null,[c("li",{class:w(["general"===m(Y)?"is-active":"not-active"])},[c("a",{tabindex:"0",role:"button",onKeydown:s[0]||(s[0]=I(f((e=>Y.value="general"),["prevent"]),["space"])),onClick:s[1]||(s[1]=e=>Y.value="general")},vl,32)],2),c("li",{class:w(["activities"===m(Y)?"is-active":"not-active"])},[c("a",{tabindex:"0",role:"button",onKeydown:s[2]||(s[2]=I(f((e=>Y.value="activities"),["prevent"]),["space"])),onClick:s[3]||(s[3]=e=>Y.value="activities")},fl,32)],2),c("li",{class:w(["proposals"===m(Y)?"is-active":"not-active"])},[c("a",{tabindex:"0",role:"button",onKeydown:s[4]||(s[4]=I(f((e=>Y.value="proposals"),["prevent"]),["space"])),onClick:s[5]||(s[5]=e=>Y.value="proposals")},bl,32)],2)])])])]),"general"===m(Y)?(o(),V("div",yl,[u(D,{class:"columns is-multiline"},{default:d((()=>[_l,c("div",gl,[c("div",hl,[Vl,c("div",Cl,[r(c("input",{type:"text",name:"title","onUpdate:modelValue":s[6]||(s[6]=e=>m(ne).title=e),required:"",class:"input is-primary-focus is-primary-focus",placeholder:"Opportunity Title"},null,512),[[p,m(ne).title]])])]),c("div",Sl,[xl,c("div",Ul,[r(c("input",{onBlur:re,type:"text",name:"zipCode","onUpdate:modelValue":s[7]||(s[7]=e=>m(ne).zip_code=e),class:"input is-primary-focus is-primary-focus",placeholder:"Zip code"},null,544),[[p,m(ne).zip_code]])])]),c("div",jl,[kl,c("div",wl,[r(c("input",{type:"text",name:"city","onUpdate:modelValue":s[8]||(s[8]=e=>m(ne).city=e),class:"input is-primary-focus is-primary-focus",placeholder:"City"},null,512),[[p,m(ne).city]])])]),c("div",Il,[Nl,c("div",Al,[r(c("input",{type:"text",name:"state","onUpdate:modelValue":s[9]||(s[9]=e=>m(ne).state=e),class:"input is-primary-focus is-primary-focus",placeholder:"State"},null,512),[[p,m(ne).state]])])]),c("div",El,[Ml,c("div",Pl,[r(c("input",{type:"text",name:"address","onUpdate:modelValue":s[10]||(s[10]=e=>m(ne).address=e),class:"input is-primary-focus is-primary-focus",placeholder:"Street Address"},null,512),[[p,m(ne).address]])])]),c("div",Ll,[Dl,c("div",Hl,[u(g,{class:"has-rounded-tooltip is-slider-info"},{default:d((({id:e})=>[u(i,null,{default:d((()=>[u(t,{id:e,modelValue:m(ne).confidence,"onUpdate:modelValue":s[11]||(s[11]=e=>m(ne).confidence=e)},null,8,["id","modelValue"])])),_:2},1024)])),_:1})])]),c("div",Ol,[Tl,c("div",Rl,[r(c("input",{type:"date",name:"saleDate","onUpdate:modelValue":s[12]||(s[12]=e=>m(ne).sale_date=e),class:"input is-primary-focus is-primary-focus",placeholder:"Post code"},null,512),[[p,m(ne).sale_date]])])]),c("div",Fl,[zl,u(g,null,{default:d((()=>[u(i,null,{default:d((()=>[u(S,{modelValue:m(ne).project_type,"onUpdate:modelValue":s[13]||(s[13]=e=>m(ne).project_type=e)},{default:d((()=>[(o(!0),V(N,null,A(m(ce),((e,l)=>(o(),n(C,{key:l,value:e.value},{default:d((()=>[v(E(e.label),1)])),_:2},1032,["value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1})]),c("div",$l,[Gl,c("div",ql,[r(c("input",{type:"date",name:"saleDate","onUpdate:modelValue":s[14]||(s[14]=e=>m(ne).startDate=e),class:"input is-primary-focus is-primary-focus",placeholder:"Post code"},null,512),[[p,m(ne).startDate]])])]),c("div",Wl,[Bl,c("div",Kl,[r(c("input",{type:"date",name:"saleDate","onUpdate:modelValue":s[15]||(s[15]=e=>m(ne).endDate=e),class:"input is-primary-focus is-primary-focus",placeholder:"Post code"},null,512),[[p,m(ne).endDate]])])])]),c("div",Zl,[u(g,{class:"is-image-select",label:"Sales people"},{default:d((({id:e})=>[u(i,null,{default:d((()=>[u(k,{modelValue:m(ne).sales_people,"onUpdate:modelValue":s[16]||(s[16]=e=>m(ne).sales_people=e),attrs:{id:e},placeholder:"Sales people",label:"name",track:"value",mode:"tags",options:m(Z)},{singlelabel:d((({value:e})=>[c("div",Jl,[c("img",{class:"select-label-icon",src:e.icon,alt:""},null,8,Xl),c("span",Yl,E(e.name),1)])])),option:d((({option:e})=>[c("img",{class:"select-option-icon",src:e.icon,alt:""},null,8,Ql),c("span",ea,E(e.name),1)])),_:2},1032,["modelValue","attrs","options"])])),_:2},1024)])),_:1})]),c("div",la,[u(g,{class:"is-image-select",label:"Contractors"},{default:d((({id:e})=>[u(i,null,{default:d((()=>[u(k,{modelValue:m(ne).contractor,"onUpdate:modelValue":s[17]||(s[17]=e=>m(ne).contractor=e),attrs:{id:e},placeholder:"Select a contractor",label:"name",options:m(ae)},{singlelabel:d((({value:e})=>[c("div",aa,[c("img",{class:"select-label-icon",src:e.icon,alt:""},null,8,sa),c("span",ta,E(e.name),1)])])),option:d((({option:e})=>[c("img",{class:"select-option-icon",src:e.icon,alt:""},null,8,ia),c("span",oa,E(e.name),1)])),_:2},1032,["modelValue","attrs","options"])])),_:2},1024)])),_:1})]),c("div",na,[u(g,{class:"is-image-select",label:"Client"},{default:d((({id:e})=>[u(i,null,{default:d((()=>[u(k,{modelValue:m(ne).client,"onUpdate:modelValue":s[18]||(s[18]=e=>m(ne).client=e),attrs:{id:e},placeholder:"Select a client",label:"name",options:m(se)},{singlelabel:d((({value:e})=>[c("div",da,[c("img",{class:"select-label-icon",src:e.icon},null,8,ca),c("span",ua,E(e.name),1)])])),option:d((({option:e})=>[c("img",{class:"select-option-icon",src:e.icon},null,8,ra),c("span",ma,E(e.name),1)])),_:2},1032,["modelValue","attrs","options"])])),_:2},1024)])),_:1})]),c("div",pa,[u(g,{class:"is-image-select",label:"Manager"},{default:d((({id:e})=>[u(i,null,{default:d((()=>[u(k,{modelValue:m(ne).managers,"onUpdate:modelValue":s[19]||(s[19]=e=>m(ne).managers=e),attrs:{id:e},placeholder:"Select managers",label:"name",track:"value",mode:"tags",options:m(te)},{singlelabel:d((({value:e})=>[c("div",va,[c("img",{class:"select-label-icon",src:e.icon,alt:""},null,8,fa),c("span",ba,E(e.name),1)])])),option:d((({option:e})=>[c("img",{class:"select-option-icon",src:e.icon,alt:""},null,8,ya),c("span",_a,E(e.name),1)])),_:2},1032,["modelValue","attrs","options"])])),_:2},1024)])),_:1})]),c("div",ga,[ha,c("div",Va,[r(c("input",{type:"text",name:"externalID","onUpdate:modelValue":s[20]||(s[20]=e=>m(ne).estimated_from=e),class:"input is-primary-focus is-primary-focus",placeholder:"From"},null,512),[[p,m(ne).estimated_from]])])]),c("div",Ca,[Sa,c("div",xa,[r(c("input",{type:"text",name:"externalID","onUpdate:modelValue":s[21]||(s[21]=e=>m(ne).estimated_to=e),class:"input is-primary-focus is-primary-focus",placeholder:"To"},null,512),[[p,m(ne).estimated_to]])])]),c("div",Ua,[ja,u(g,null,{default:d((({id:e})=>[u(i,null,{default:d((()=>[u(k,{modelValue:m(Q),"onUpdate:modelValue":s[22]||(s[22]=e=>M(Q)?Q.value=e:null),attrs:{id:e},mode:"tags",searchable:!0,"create-tag":!0,options:ee,placeholder:"Add tags"},null,8,["modelValue","attrs"])])),_:2},1024)])),_:1})]),c("div",ka,[wa,u(g,null,{default:d((({id:e})=>[u(i,null,{default:d((()=>[u(k,{modelValue:m(ne).sources,"onUpdate:modelValue":s[23]||(s[23]=e=>m(ne).sources=e),attrs:{id:e},"create-tag":!0,options:le,placeholder:"Sources"},null,8,["modelValue","attrs"])])),_:2},1024)])),_:1})]),c("div",Ia,[Na,u(g,null,{default:d((()=>[u(i,null,{default:d((()=>[u(S,{modelValue:m(ne).leadStatus,"onUpdate:modelValue":s[24]||(s[24]=e=>m(ne).leadStatus=e)},{default:d((()=>[(o(!0),V(N,null,A(m(de),((e,l)=>(o(),n(C,{key:l,value:e.value},{default:d((()=>[v(E(e.label),1)])),_:2},1032,["value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1})])])),_:1}),u(D,{class:"columns is-multiline mt-3"},{default:d((()=>[Aa,c("div",Ea,[u(m(ie),{modelValue:m(ne).notes,"onUpdate:modelValue":s[25]||(s[25]=e=>m(ne).notes=e),editor:m(W),config:oe},null,8,["modelValue","editor"])])])),_:1}),u(D,{class:"columns is-multiline mt-3"},{default:d((()=>[Ma,c("div",Pa,[La,u(g,{grouped:""},{default:d((()=>[u(i,null,{default:d((()=>[Da])),_:1})])),_:1})])])),_:1})])):x("",!0),"activities"===m(Y)?(o(),V("div",Ha,[u(D,{class:"columns is-multiline"},{default:d((()=>[Oa,c("div",Ta,[u(H,{onClick:s[26]||(s[26]=e=>j.value=!m(j)),color:"info",class:"p-5",icon:"fas fa-plus",fullwidth:"",bold:""},{default:d((()=>[v(" Add New ")])),_:1})]),c("div",Ra,[u(H,{class:"p-5",color:"primary",icon:"fas fa-sign-in-alt",fullwidth:"",bold:""},{default:d((()=>[v(" Import existing one ")])),_:1})])])),_:1}),u(D,{class:"columns is-multiline mt-1"},{default:d((()=>[Fa,za,$a,Ga,c("div",qa,[u(H,{onClick:s[27]||(s[27]=e=>L.value=!m(L)),color:"warning",icon:"lnir lnir-alarm"},{default:d((()=>[v(" Create Activity ")])),_:1}),u(H,{onClick:s[28]||(s[28]=e=>B.value=!m(B)),color:"success",class:"ml-2",icon:"fas fa-envelope"},{default:d((()=>[v(" Schedule Email ")])),_:1})]),Wa])),_:1}),m(L)?(o(),n(O,{key:0,mailSchedulerModal:m(L),"onUpdate:modalHandler":s[29]||(s[29]=e=>L.value=!1)},null,8,["mailSchedulerModal"])):x("",!0),m(B)?(o(),n(T,{key:1,mailSenderModal:m(B),"onUpdate:modalHandler":s[30]||(s[30]=e=>B.value=!1)},null,8,["mailSenderModal"])):x("",!0),m(j)?(o(),n(R,{key:2,"add-update-contact-modal":m(j),"onUpdate:modalHandler":s[31]||(s[31]=e=>j.value=!1)},null,8,["add-update-contact-modal"])):x("",!0)])):x("",!0),"proposals"===m(Y)?(o(),V("div",Ba,[u(D,{class:"columns is-multiline"},{default:d((()=>[c("div",Ka,[u(F,{leadId:m(ne).id?m(ne).id:_.leadId},null,8,["leadId"])])])),_:1})])):x("",!0)])])),action:d((()=>[u(H,{loading:1==m(U),type:"submit",color:_.leadId?"info":"primary",raised:""},{default:d((()=>[v(E(_.leadId?"Update":"Create")+" Lead",1)])),_:1},8,["loading","color"]),u(H,{loading:3==m(U),onClick:s[32]||(s[32]=e=>ue(3)),color:"warning",raised:""},{default:d((()=>[v(E(_.leadId?"Update & Close":"Create & Close"),1)])),_:1},8,["loading"])])),_:1},8,["open"])}}});export{Za as _,cl as a};
