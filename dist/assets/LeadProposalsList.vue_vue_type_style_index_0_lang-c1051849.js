import{_ as e}from"./VModal.vue_vue_type_style_index_0_lang-c16bfccb.js";import{_ as l}from"./VFlexPagination.vue_vue_type_script_setup_true_lang-f24fafff.js";import{_ as a,c as t}from"./VFlexTable.vue_vue_type_style_index_0_lang-589285fb.js";import{_ as s}from"./VCheckbox.vue_vue_type_style_index_0_lang-aa677c7f.js";import{_ as o}from"./VTag.vue_vue_type_style_index_0_lang-0cf27db1.js";import{_ as n}from"./VPlaceholderPage.vue_vue_type_style_index_0_lang-0ba04464.js";import{e as i,s as r,r as d,b as u,_ as p,o as c,i as m,B as v,N as _,F as f,D as y,H as g,l as b,G as h,C as w,K as k,W as x,E as I,M as P,J as V,T as C,I as T,O as j,Z as S,A,j as U,U as q,V as D,aR as O,P as M,Q as $,R as L,v as H,x as E}from"./index-eed4595b.js";import{_ as R}from"./VField.vue_vue_type_script_setup_true_lang-6adaf0c2.js";import{_ as F}from"./VControl-92022093.js";import{_ as W}from"./VRadio.vue_vue_type_style_index_0_lang-424b3e91.js";import{_ as B,a as N}from"./search-4-dark-2b5b440c.js";import{_ as z,a as J}from"./projects-dark-4a371d8a.js";import{u as Z}from"./useAPI-4e95edd2.js";import{a as G,e as K,g as Q}from"./useSupportElement-9655898e.js";import{_ as Y}from"./SweetAlert.vue_vue_type_style_index_0_lang-c7f19dfa.js";import{u as X,s as ee,_ as le,a as ae}from"./WorksheetItems.vue_vue_type_script_setup_true_lang-0d78536e.js";import{_ as te}from"./VAvatar.vue_vue_type_style_index_0_lang-e9e29320.js";import{c as se}from"./proposalItems-39315392.js";import{_ as oe}from"./VTextarea.vue_vue_type_script_setup_true_lang-e4b9add2.js";import{u as ne}from"./useNotyf-7f8800ec.js";import{u as ie}from"./userSession-4917c7c6.js";import{_ as re}from"./VDropdown.vue_vue_type_style_index_0_lang-a1a23466.js";import{_ as de}from"./PlaceloadV1.vue_vue_type_style_index_0_lang-2c2762a9.js";const ue={class:"modal-form columns is-multiline"},pe={class:"tabs-wrapper column is-12 m-0"},ce={class:"tabs-inner"},me={class:"tabs is-boxed"},ve=[y("span",null,"Proposal",-1)],_e=["disabled"],fe=[y("span",null,"Worksheet",-1)],ye={key:0,class:"column is-12"},ge={class:"columns is-multiline"},be={class:"field column is-6 mb-0"},he=y("label",null,"Title: *",-1),we={class:"control"},ke={class:"column is-6"},xe={class:"field column is-6"},Ie=y("label",null,"Approval Deadline *",-1),Pe={class:"control"},Ve={class:"field column is-6"},Ce=y("label",null,"Attachments",-1),Te=y("div",{class:"file"},[y("label",{class:"file-label"},[y("input",{class:"file-input",type:"file",name:"resume"}),y("span",{class:"file-cta"},[y("span",{class:"file-icon"},[y("i",{class:"fas fa-cloud-upload-alt"})]),y("span",{class:"file-label"}," Choose a fileâ€¦ ")])])],-1),je={class:"column is-12"},Se={class:"body-inner-content columns is-multiline"},Ae={class:"field column is-12"},Ue=y("label",{for:"",class:"label"},"Internal Notes",-1),qe={class:"field column is-12 mb-0"},De=y("label",{for:"",class:"label"},"Introductory Text",-1),Oe={class:"field column is-12 mb-0"},Me=y("label",{for:"",class:"label"},"Closing Text",-1),$e={class:"column is-12"},Le={key:0,class:"columns is-multiline"},He=i({__name:"LeadProposalModal",props:{leadProposalModal:{type:Boolean},proposalId:{},leadId:{}},emits:["update:modalHandler","update:OnSuccess","clearProposalId"],setup(l,{emit:a}){const t=l;X();const s=r();ie();const o=ne(),n=Z(),i=d(!1);d({}),d("");const S=d("general"),A=d({id:"",title:"",approval_deadline:"",internal_notes:"",introductory_text:null,closing_text:null,payment_status:"",worksheetItems:[],type:"proposal",job:"",attachments:[],columns_to_show:[],status:"",created_at:"",updated_at:""}),U=async(e=!0)=>{try{if(i.value=!0,!A.value.title&&!e)return;t.leadId&&(A.value.job=t.leadId),A.value.columns_to_show=JSON.stringify(ee.value);const l=G(A.value,[]);if(t.proposalId||A.value.id){const e=await n.patch(`/api/lead-proposal/${t.proposalId?t.proposalId:A.value.id}/`,l);A.value=e.data}else{const e=await n.post("/api/lead-proposal/",l);A.value=e.data}D(),e&&o.success(`Proposal ${t.proposalId||A.value.id?"updated":"created"} successfully`)}catch(l){o.error("Something went wrong, try again")}finally{i.value=!1}},q=()=>{a("update:modalHandler",!1)},D=()=>{a("update:OnSuccess",null)},O=u((()=>p((()=>import("./ckeditor-44eee7d7.js").then((e=>e.c))),["assets/ckeditor-44eee7d7.js","assets/index-eed4595b.js","assets/index-ce8747cd.css","assets/vue.runtime.esm-bundler-1b38661a.js"]).then((e=>e.default.component)))),M={fontFamily:{options:['"Montserrat", sans-serif','"Roboto", sans-serif']},height:"400px",minHeight:"400px"};return c((async()=>{s.value=await p((()=>import("./ckeditor-ac11e158.js").then((e=>e.c))),["assets/ckeditor-ac11e158.js","assets/index-eed4595b.js","assets/index-ce8747cd.css"]).then((e=>e.default)),t.proposalId&&(async()=>{try{const e=await n.get(`/api/lead-proposal/${t.proposalId}/`);A.value=e.data,ee.value=e.data.columns_to_show}catch(e){console.log(e)}})()})),m((()=>{a("clearProposalId",null),A.value={}})),(l,a)=>{const o=W,n=F,r=R,d=oe,u=le,p=j,c=e;return v(),_(c,{is:"form",open:t.leadProposalModal,title:"Lead Proposal",size:"xl",actions:"right",onSubmit:T(U,["prevent"]),onClose:q},{content:f((()=>[y("div",ue,[y("div",pe,[y("div",ce,[y("div",me,[y("ul",null,[y("li",{class:g(["general"===b(S)?"is-active":"not-active"])},[y("a",{tabindex:"0",role:"button",onKeydown:a[0]||(a[0]=h(T((e=>S.value="general"),["prevent"]),["space"])),onClick:a[1]||(a[1]=e=>S.value="general")},ve,32)],2),y("li",{class:g(["CostWorksheet"===b(S)?"is-active":"not-active"])},[y("a",{tabindex:"0",role:"button",disabled:!!b(A).title,onKeydown:a[2]||(a[2]=h(T((e=>S.value="CostWorksheet"),["prevent"]),["space"])),onClick:a[3]||(a[3]=()=>{S.value="CostWorksheet",U(!1)})},fe,40,_e)],2)])])])]),"general"==b(S)?(v(),w("div",ye,[y("div",ge,[y("div",be,[he,y("div",we,[k(y("input",{type:"text",name:"title","onUpdate:modelValue":a[4]||(a[4]=e=>b(A).title=e),required:"",class:"input is-primary-focus is-primary-focus",placeholder:"Proposal Title"},null,512),[[x,b(A).title]])])]),y("div",ke,[I(r,{class:"m-0 p-0",label:"Type"},{default:f((()=>[I(n,null,{default:f((()=>[I(o,{modelValue:b(A).type,"onUpdate:modelValue":a[5]||(a[5]=e=>b(A).type=e),value:"proposal",label:"Proposal",name:"solid_squared_radio",color:"primary",square:"",solid:""},null,8,["modelValue"]),I(o,{modelValue:b(A).type,"onUpdate:modelValue":a[6]||(a[6]=e=>b(A).type=e),value:"change_order",label:"Change Order",name:"solid_squared_radio",color:"info",square:"",solid:""},null,8,["modelValue"]),I(o,{modelValue:b(A).type,"onUpdate:modelValue":a[7]||(a[7]=e=>b(A).type=e),value:"draft",label:"Draft",name:"solid_squared_radio",color:"warning",square:"",solid:""},null,8,["modelValue"])])),_:1})])),_:1})]),y("div",xe,[Ie,y("div",Pe,[k(y("input",{type:"date",name:"firstName","onUpdate:modelValue":a[8]||(a[8]=e=>b(A).approval_deadline=e),required:"",class:"input is-primary-focus is-primary-focus",placeholder:"Proposal Approval deadline"},null,512),[[x,b(A).approval_deadline]])])]),y("div",Ve,[Ce,I(r,{grouped:""},{default:f((()=>[I(n,null,{default:f((()=>[Te])),_:1})])),_:1})]),y("div",je,[y("div",Se,[y("div",Ae,[Ue,I(r,null,{default:f((()=>[I(n,null,{default:f((()=>[I(d,{modelValue:b(A).internal_notes,"onUpdate:modelValue":a[9]||(a[9]=e=>b(A).internal_notes=e),rows:"4",placeholder:"Internal notes..."},null,8,["modelValue"])])),_:1})])),_:1})]),y("div",qe,[De,b(s)?(v(),_(b(O),{key:0,modelValue:b(A).introductory_text,"onUpdate:modelValue":a[10]||(a[10]=e=>b(A).introductory_text=e),editor:b(s),config:M},null,8,["modelValue","editor"])):P("",!0)]),y("div",Oe,[Me,b(s)?(v(),_(b(O),{key:0,modelValue:b(A).closing_text,"onUpdate:modelValue":a[11]||(a[11]=e=>b(A).closing_text=e),editor:b(s),config:M},null,8,["modelValue","editor"])):P("",!0)])])])])])):P("",!0),y("div",$e,["CostWorksheet"==b(S)?(v(),w("div",Le,[I(u,{proposalId:b(A).id?b(A).id:t.proposalId,proposalData:b(A)},null,8,["proposalId","proposalData"])])):P("",!0)])])])),action:f((()=>[I(p,{loading:b(i),type:"submit",color:"primary",raised:""},{default:f((()=>[V(C(t.proposalId?"Update Proposal":"Create Proposal"),1)])),_:1},8,["loading"])])),cancel:f((()=>[I(p,{onClick:a[12]||(a[12]=e=>q()),raised:""},{default:f((()=>[V("Close")])),_:1})])),_:1},8,["open","onSubmit"])}}}),Ee=e=>(M("data-v-f8144e70"),e=e(),$(),e),Re={class:"columns is-multiline"},Fe={class:"column is-12 is-flex space-between"},We={class:"is-flex"},Be={class:"column is-12"},Ne={class:"flex-list-wrapper flex-list-v2"},ze=Ee((()=>y("img",{class:"light-image",src:B,alt:""},null,-1))),Je=Ee((()=>y("img",{class:"dark-image",src:N,alt:""},null,-1))),Ze={key:1,class:"tab-content is-active"},Ge={class:"item-name dark-inverted"},Ke={class:"item-meta"},Qe={class:"light-text"},Ye={key:2,class:"tab-content is-active"},Xe=Ee((()=>y("img",{class:"light-image is-larger",src:z,alt:""},null,-1))),el=Ee((()=>y("img",{class:"dark-image is-larger",src:J,alt:""},null,-1))),ll=L(i({__name:"ProposalGroupModal",props:{groupProposalModal:{type:Boolean},leadID:{default:""}},emits:["update:modalHandler","update:OnSuccess"],setup(i,{emit:r}){const u=i,p=d([{id:"",proposalAmount:0,title:"",approval_deadline:"",internal_notes:"",introductory_text:"",closing_text:"",payment_status:"",type:"",status:"",created_at:"",updated_at:"",job:""}]),m=d("combine"),g=d(!1),h=d("active"),k=Z(),x=[],T=[{value:"title",label:"Tile"},{value:"carpentry",label:"Carpentry"},{value:"floor",label:"Flooring"}],M=d(""),$={picture:{label:"Proposal",grow:!0,media:!0},customer:"Type",industry:"Amount",status:"Status",team:{label:"Payment"},actions:{label:"Select",align:"end"}},L=S((()=>{if(M.value){const e=new RegExp(M.value,"i");return p.value.filter((l=>l.title.match(e)||l.description.match(e)))}return p.value})),H=()=>{r("update:modalHandler",!1)};return c((()=>{(async()=>{try{g.value=!0;const e=await k.get(`/api/lead-proposal/by-job/${u.leadID}/`);p.value=e.data}catch(e){console.log(e)}finally{g.value=!1}})()})),(i,r)=>{const d=W,p=F,c=R,k=A("Multiselect"),S=j,M=n,E=t,B=o,N=s,z=a,J=l,Z=e;return v(),_(Z,{is:"form",open:u.groupProposalModal,title:"Group Proposal",size:"xl",actions:"right",onClose:H},{content:f((()=>[y("div",Re,[y("div",Fe,[I(c,null,{default:f((()=>[I(p,null,{default:f((()=>[I(d,{modelValue:b(m),"onUpdate:modelValue":r[0]||(r[0]=e=>U(m)?m.value=e:null),value:"combine",label:"Combine Proposals",name:"outlined_squared_radio",color:"warning",square:""},null,8,["modelValue"]),I(d,{modelValue:b(m),"onUpdate:modelValue":r[1]||(r[1]=e=>U(m)?m.value=e:null),value:"trade",label:"Trade Proposal",name:"outlined_squared_radio",color:"primary",square:""},null,8,["modelValue"]),I(d,{modelValue:b(m),"onUpdate:modelValue":r[2]||(r[2]=e=>U(m)?m.value=e:null),value:"summary",label:"Summary Proposal",name:"outlined_squared_radio",color:"info",square:""},null,8,["modelValue"]),I(d,{modelValue:b(m),"onUpdate:modelValue":r[3]||(r[3]=e=>U(m)?m.value=e:null),value:"report",label:"Report",name:"outlined_squared_radio",color:"success",square:""},null,8,["modelValue"])])),_:1})])),_:1}),y("div",We,["trade"==b(m)?(v(),_(c,{key:0,style:{width:"340px"}},{default:f((({id:e})=>[I(p,null,{default:f((()=>[I(k,{modelValue:x,"onUpdate:modelValue":r[4]||(r[4]=e=>x=e),attrs:{id:e},mode:"tags",searchable:!0,"create-tag":!0,options:T,placeholder:"Select Trades"},null,8,["attrs"])])),_:2},1024)])),_:1})):P("",!0),I(S,{class:"ml-2",raised:"",color:"warning",light:"",outlined:""},{default:f((()=>[V(" Merge ")])),_:1}),I(S,{class:"ml-2",raised:"",icon:"fas fa-envelope",color:"info",light:"",outlined:""},{default:f((()=>[V(" Send ")])),_:1})])]),y("div",Be,[y("div",Ne,["active"===b(h)&&0===b(L).length?(v(),_(M,{key:0,title:"We couldn't find any matching results.",subtitle:"Too bad. Looks like we couldn't find any matching results for the\n          search terms you've entered. Please try different search terms or\n          criteria.",larger:""},{image:f((()=>[ze,Je])),_:1})):P("",!0),"active"===b(h)?(v(),w("div",Ze,[b(L).length?(v(),_(z,{key:0,data:b(L),columns:$,rounded:""},{body:f((()=>[I(O,{name:"list",tag:"div",class:"flex-list-inner"},{default:f((()=>[(v(!0),w(q,null,D(b(L),(e=>(v(),w("div",{key:e.id,class:"flex-table-item"},[I(E,{column:{media:!0,grow:!0}},{default:f((()=>[y("div",null,[y("span",Ge,C(e.title??"N/A"),1),y("span",Ke,[y("span",null,C(b(K)(e.created_at)),1)])])])),_:2},1024),I(E,null,{default:f((()=>[I(B,null,{default:f((()=>[V(C(e.type),1)])),_:2},1024)])),_:2},1024),I(E,null,{default:f((()=>[y("span",Qe,"$"+C(e.proposalAmount),1)])),_:2},1024),I(E,null,{default:f((()=>[I(B,{rounded:""},{default:f((()=>[V(C(e.status),1)])),_:2},1024)])),_:2},1024),I(E,null,{default:f((()=>[I(B,{rounded:""},{default:f((()=>[V(C(e.status),1)])),_:2},1024)])),_:2},1024),I(E,{column:{align:"end"}},{default:f((()=>[I(p,{raw:"",subcontrol:""},{default:f((()=>[I(N,{modelValue:e.payment_status,"onUpdate:modelValue":l=>e.payment_status=l,label:"",color:"primary"},null,8,["modelValue","onUpdate:modelValue"])])),_:2},1024)])),_:2},1024)])))),128))])),_:1})])),_:1},8,["data"])):P("",!0),b(L).length>5?(v(),_(J,{key:1,"item-per-page":10,"total-items":873,"current-page":42,"max-links-displayed":7})):P("",!0)])):"closed"===b(h)?(v(),w("div",Ye,[I(M,{title:"No closed projects.",subtitle:"Looks like you don't have any closed project yet. When you'll\n              start closing off projects, they will be showing up in here."},{image:f((()=>[Xe,el])),_:1})])):P("",!0)])])])])),action:f((()=>[I(S,{loading:b(g),type:"submit",color:"warning",raised:"",onClick:H},{default:f((()=>[V("Close")])),_:1},8,["loading"])])),_:1},8,["open"])}}}),[["__scopeId","data-v-f8144e70"]]),al={class:"columns is-multiline"},tl={class:"column is-12"},sl={class:"invoice-wrapper"},ol=y("div",{class:"invoice-header"},[y("div",{class:"left"},[y("h3",null,"Proposal-ID PD-456-14")]),y("div",{class:"right"},[y("div",{class:"controls"},[y("a",{class:"action"},[y("i",{"aria-hidden":"true",class:"iconify","data-icon":"feather:printer"})]),y("a",{class:"action"},[y("i",{"aria-hidden":"true",class:"iconify","data-icon":"feather:download-cloud"})]),y("a",{class:"action"},[y("i",{"aria-hidden":"true",class:"iconify","data-icon":"feather:mail"})])])])],-1),nl={class:"invoice-body"},il={class:"invoice-card"},rl={class:"invoice-section is-flex is-bordered"},dl=y("div",{class:"meta"},null,-1),ul=y("div",{class:"end"},[y("span",null,"PO Box 242"),y("span",null,"Evergreen, CO 80437-0242"),y("span",null,"Phone: 720 272-9061"),y("span",null,"Premium Trades for Premier Builders")],-1),pl=y("div",{class:"invoice-section is-flex is-bordered"},[y("div",{class:"meta"},[y("h3",null,"Client Name"),y("span",null,"Client Phone"),y("span",null,"25724 Independence Trail Evergreen, CO 80439")]),y("div",{class:"end is-left"},[y("h3",null,"Friday Jan 17, 2025"),y("p",null," Lorem ipsum dolor sit amet, consectetur adipiscing elit. Quod equidem non reprehendo. ")])],-1),cl={key:0,class:"invoice-section"},ml={class:"responsive-table"},vl=y("br",null,null,-1),_l=["innerHTML"],fl={class:"invoice-section is-flex mt-0 pt-0"},yl={class:"end is-left"},gl={class:"text-right"},bl=y("p",null,"Mentioned price are final",-1),hl=i({__name:"ProposalViewModal",props:{previewModal:{type:Boolean},columnsToShow:{default:!1},proposalId:{default:""}},emits:["update:modalHandler","update:OnSuccess"],setup(l,{emit:a}){const t=l,s=Z();X();const o=d([{name:"Website Redesign",unit:"hrs",quantity:54,rate:24},{name:"Logo Design",unit:"hrs",quantity:12,rate:24},{name:"Custom Illustrations",unit:"hrs",quantity:7,rate:32}]);S((()=>{const e=o.value.reduce(((e,l)=>e+l.quantity*l.rate),0),l=.1*e;return[{label:"Subtotal",value:e},{label:"Taxes",value:l},{label:"Total",value:e+l}]}));const n=["Item","Description","Unit Cost","Qty","Unit","Builder Cost","Markup","Total Price"];d(""),d(!0),d(!0),d(!0),d(!0);const i=S((()=>se.value.reduce(((e,l)=>e+l.price*l.quantity),0))),r=d(!1);d({id:"c897de41-609f-4a20-8d79-0537b6a873d6",title:"Test Lead's Proposal",approval_deadline:"2025-01-30",internal_notes:null,introductory_text:null,closing_text:null,payment_status:"Pending",type:"proposal",status:"pending",created_at:"2025-01-21T19:08:06.509861Z",updated_at:"2025-01-21T19:08:06.509875Z",job:"da0aa7c1-3744-4856-a637-e5a821f5ec7e"});const u=d([{id:"5e7d026a-b392-47e9-9d24-58fbc1de12c5",index:1,title:"Test Lead Proposal Item",description:"<p>Description</p>",type:"",quantity:100,unit:"Sq ft",unit_cost:"10.00",markup:"150.00",total_price:"1150.00",cost_code:"11012",cost_type:"material",builder_cost:"1000.00",margin:"1.00",profit:"0.00",internal_notes:"Internal notes",mark_as:"bid",state:"active",group_amount:"0.00",status:null,created_at:"2025-01-23T18:25:46.392750Z",proposal:"c897de41-609f-4a20-8d79-0537b6a873d6"}]),p=()=>{a("update:modalHandler",!1)},m=async()=>{try{const e=await s.get(`api/cost/by-proposal/${t.proposalId}/`);u.value=e.data}catch(e){console.log(e)}};return c((()=>{(async()=>{try{r.value=!0,await s.get(`/api/lead-proposal/${t.proposalId}/`),m()}catch(e){console.log(e)}finally{r.value=!1}})()})),(l,a)=>{const s=te,o=j,d=e;return v(),_(d,{is:"form",open:t.previewModal,title:"Cost Item ",size:"xl",actions:"right",onClose:p},{content:f((()=>[y("div",al,[y("div",tl,[y("div",sl,[ol,y("div",nl,[y("div",il,[y("div",rl,[I(s,{size:"xl",picture:"/logos/IbexFavicon.png"}),dl,ul]),pl,b(u).length?(v(),w("div",cl,[y("table",ml,[y("thead",null,[(v(),w(q,null,D(n,((e,l)=>y("th",{key:l},C(e),1))),64))]),y("tbody",null,[(v(!0),w(q,null,D(b(u),((e,l)=>(v(),w("tr",{key:e.id},[y("td",null,[y("span",null,C(e.title),1),vl,y("span",null,C(e.cost_code),1)]),y("td",null,[y("span",{innerHTML:e.description},null,8,_l)]),y("td",null,[y("span",null," $"+C(e.unit_cost),1)]),y("td",null,[y("span",null,C(e.quantity),1)]),y("td",null,[y("span",null,C(e.unit),1)]),y("td",null,[y("span",null," $"+C(e.builder_cost),1)]),y("td",null,[y("span",null," $"+C(e.markup),1)]),y("td",null,[y("span",null," $"+C(e.total_price),1)])])))),128))])])])):P("",!0),y("div",fl,[y("div",yl,[y("h3",gl,"Total Price: $"+C(b(i)),1),bl])])])])])])])])),action:f((()=>[I(o,{loading:b(r),type:"submit",color:"warning",raised:"",onClick:p},{default:f((()=>[V("Close")])),_:1},8,["loading"])])),_:1},8,["open"])}}}),wl={onHold:"warning",open:"info",sold:"success",lost:"danger"},kl={pending:"info",approve:"success",review:"warning",disapprove:"danger"},xl={pending:"Pending",approve:"Approved",review:"Require Review",disapprove:"Disapproved"},Il={proposal:"primary",change_order:"warning",draft:"light"},Pl={proposal:"Proposal",change_order:"Change Order",draft:"Draft"},Vl=[{value:"call",label:"Phone Call"},{value:"email",label:"Email"},{value:"followup",label:"Follow Up"},{value:"visit",label:"Site Visit"},{value:"form",label:"Website Form"}],Cl={class:"flex-toolbar is-reversed is-flex space-between my-4"},Tl={key:0},jl={key:1,class:"flex-list-wrapper flex-list-v2"},Sl={class:"item-name dark-inverted"},Al={class:"item-name dark-inverted"},Ul={class:"light-text"},ql={class:"light-text"},Dl={class:"item-name dark-inverted"},Ol={class:"light-text"},Ml=["onClick"],$l=[y("div",{class:"icon"},[y("i",{"aria-hidden":"true",class:"lnil lnil-pencil"})],-1),y("div",{class:"meta"},[y("span",null,"Edit"),y("span",null,"Edit Proposal Details")],-1)],Ll=["onClick"],Hl=[y("div",{class:"icon"},[y("i",{"aria-hidden":"true",class:"lnil lnil-briefcase"})],-1),y("div",{class:"meta"},[y("span",null,"View Detail"),y("span",null,"View detail in page")],-1)],El=["onClick"],Rl=[y("div",{class:"icon"},[y("i",{"aria-hidden":"true",class:"lnil lnil-eye"})],-1),y("div",{class:"meta"},[y("span",null,"Preview"),y("span",null,"Preview proposal detail")],-1)],Fl=["onClick"],Wl=[y("div",{class:"icon"},[y("i",{"aria-hidden":"true",class:"lnil lnil-add-files"})],-1),y("div",{class:"meta"},[y("span",null,"Add Cost Item"),y("span",null,"Add a new cost item")],-1)],Bl=y("hr",{class:"dropdown-divider"},null,-1),Nl=["onClick"],zl=[y("div",{class:"icon"},[y("i",{"aria-hidden":"true",class:"lnil lnil-trash-can-alt"})],-1),y("div",{class:"meta"},[y("span",null,"Delete"),y("span",null,"Delete from list")],-1)],Jl=y("img",{class:"light-image",src:B,alt:""},null,-1),Zl=y("img",{class:"dark-image",src:N,alt:""},null,-1),Gl=i({__name:"LeadProposalsList",props:{activeTab:{default:"active"},leadId:{default:""},allProposal:{type:Boolean,default:!1}},setup(e){const s=e,i=H();E();const r=Z(),u=ne(),p=d(!1),m=d([]),g=d(!1),h=d(""),T=d(!1),A=d(""),M=d("");d(s.activeTab);const $=d({title:"",subtitle:"test",isSweetAlertOpen:!1,btntext:"text"}),L=async()=>{try{p.value=!0;const e=await r.delete(`/api/lead-proposal/${M.value}/`);m.value=e.data,u.success("Proposal delete successfully"),G()}catch(e){u.error(` ${e}, Proposal`),u.error("Something went wrong please try later")}finally{p.value=!1,$.value.isSweetAlertOpen=!1}},R={picture:{label:"Proposal",grow:!0,media:!0},customer:"Created At",industry:"Type",deadline:"Deadline",status:"Status",amount:{label:"Total Amount",media:!0},actions:{label:"Actions",align:"end"}},W=S((()=>{if(A.value){const e=new RegExp(A.value,"i");return m.value.filter((l=>l.title.match(e)||l.approval_deadline.match(e)))}return m.value})),B=d(!1),N=d(!1),z=d(!1),J=d(""),G=()=>{1==s.allProposal?(async()=>{try{p.value=!0;const e=await r.get("/api/lead-proposal/");m.value=e.data}catch(e){u.error(` ${e}, Lead`)}finally{p.value=!1}})():s.leadId&&(async()=>{try{p.value=!0;const e=await r.get(`/api/lead-proposal/by-job/${s.leadId}/`);m.value=e.data}catch(e){u.error(` ${e}, Lead`)}finally{p.value=!1}})()};return c((()=>{G()})),(e,r)=>{const d=F,u=j,c=de,S=t,H=o,E=re,Z=a,X=n,ee=l,le=He,te=hl,se=ae,oe=Y,ne=ll;return v(),w("div",null,[y("div",Cl,[I(d,{icon:"feather:search"},{default:f((()=>[k(y("input",{"onUpdate:modelValue":r[0]||(r[0]=e=>U(A)?A.value=e:null),class:"input custom-text-filter",placeholder:"Search..."},null,512),[[x,b(A)]])])),_:1}),y("div",null,[I(u,{color:"primary",onClick:r[1]||(r[1]=e=>g.value=!b(g)),icon:"fas fa-plus"},{default:f((()=>[V("Lead Proposal")])),_:1}),s.leadId?(v(),_(u,{key:0,color:"warning",class:"ml-2",onClick:r[2]||(r[2]=e=>{T.value=!0}),icon:"fas fa-cogs"},{default:f((()=>[V("Proposals")])),_:1})):P("",!0)])]),b(p)?(v(),w("div",Tl,[I(c)])):(v(),w("div",jl,[b(W).length>0&&b(m).length>0?(v(),_(Z,{key:0,data:b(W),columns:R,rounded:""},{body:f((()=>[I(O,{name:"list",tag:"div",class:"flex-list-inner"},{default:f((()=>[(v(!0),w(q,null,D(b(W),(e=>(v(),w("div",{key:e.id,class:"flex-table-item"},[I(S,{column:{media:!0,grow:!0}},{default:f((()=>[y("div",null,[y("span",Sl,C(e.title),1)])])),_:2},1024),I(S,{column:{media:!0}},{default:f((()=>[y("div",null,[y("span",Al,C(b(K)(e.created_at)),1),y("span",Ul,C(b(Q)(e.created_at)),1)])])),_:2},1024),I(S,null,{default:f((()=>[I(H,{rounded:"",color:b(Il)[e.type]},{default:f((()=>[V(C(b(Pl)[e.type]),1)])),_:2},1032,["color"])])),_:2},1024),I(S,null,{default:f((()=>[y("span",ql,C(e.approval_deadline),1)])),_:2},1024),I(S,null,{default:f((()=>[I(H,{class:"capitalized",rounded:"",color:b(kl)[e.status]},{default:f((()=>[V(C(b(xl)[e.status]),1)])),_:2},1032,["color"])])),_:2},1024),I(S,{column:{media:!0}},{default:f((()=>[y("div",null,[y("span",Dl,"$"+C(e.proposalAmount),1),y("span",Ol,C(e.payment_status),1)])])),_:2},1024),I(S,{column:{align:"end"}},{default:f((()=>[I(E,{class:"is-pushed-mobile",icon:"feather:more-vertical",spaced:"",right:""},{content:f((()=>[y("a",{role:"menuitem",onClick:l=>{return a=e.id,h.value=a,void(g.value=!0);var a},class:"dropdown-item is-media"},$l,8,Ml),y("a",{role:"menuitem",onClick:l=>b(i).push(`/sidebar/dashboard/proposals/${e.id}`),class:"dropdown-item is-media"},Hl,8,Ll),y("a",{disabled:"",role:"menuitem",onClick:l=>{return a=e.id,N.value=a,void(B.value=!B.value);var a},class:"dropdown-item is-media"},Rl,8,El),y("a",{role:"menuitem",onClick:l=>{return a=e.id,J.value=a,void(z.value=!z.value);var a},class:"dropdown-item is-media"},Wl,8,Fl),Bl,y("a",{role:"menuitem",onClick:l=>{return a=e.id,M.value=a,void($.value={title:"Delete Proposal?",subtitle:"Are you sure to delete this proposal? After delete you will not be able to recover it again.",btntext:"Yes delete",isSweetAlertOpen:!0});var a},class:"dropdown-item is-media"},zl,8,Nl)])),_:2},1024)])),_:2},1024)])))),128))])),_:1})])),_:1},8,["data"])):P("",!0),b(m).length<1&&0==b(W).length?(v(),_(X,{key:1,title:"There is no proposal created on this lead!",subtitle:"Too bad. Looks like we couldn't created any proposal on this Lead, please create proposal and release to the client",larger:""},{image:f((()=>[Jl,Zl])),_:1})):P("",!0),b(W).length>5?(v(),_(ee,{key:2,"item-per-page":10,"total-items":873,"current-page":42,"max-links-displayed":7})):P("",!0)])),b(g)?(v(),_(le,{key:2,leadId:s.leadId,proposalId:b(h),leadProposalModal:b(g),"onUpdate:modalHandler":r[3]||(r[3]=e=>g.value=!1),"onUpdate:OnSuccess":G,onClearProposalId:r[4]||(r[4]=e=>h.value="")},null,8,["leadId","proposalId","leadProposalModal"])):P("",!0),b(B)?(v(),_(te,{key:3,"preview-modal":b(B),proposalId:b(N),"onUpdate:modalHandler":r[5]||(r[5]=e=>B.value=!1)},null,8,["preview-modal","proposalId"])):P("",!0),b(z)?(v(),_(se,{key:4,costItemModal:b(z),proposalId:b(J),"onUpdate:modalHandler":r[6]||(r[6]=e=>z.value=!1),"onUpdate:OnSuccess":G},null,8,["costItemModal","proposalId"])):P("",!0),b($).isSweetAlertOpen?(v(),_(oe,{key:5,isSweetAlertOpen:b($).isSweetAlertOpen,title:b($).title,subtitle:b($).subtitle,btntext:b($).btntext,onConfirm:L,onCancel:()=>b($).isSweetAlertOpen=!1},null,8,["isSweetAlertOpen","title","subtitle","btntext","onCancel"])):P("",!0),b(T)?(v(),_(ne,{key:6,leadID:s.leadId,"group-proposal-modal":b(T),"onUpdate:modalHandler":r[7]||(r[7]=e=>T.value=!1)},null,8,["leadID","group-proposal-modal"])):P("",!0)])}}});export{He as _,Gl as a,Vl as b,wl as g};
