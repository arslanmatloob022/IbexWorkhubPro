import{_ as e}from"./UpdateTask.vue_vue_type_script_setup_true_lang-eba748b2.js";import{_ as a}from"./SweetAlert.vue_vue_type_style_index_0_lang-4e34ac38.js";import{_ as l}from"./VPlaceholderPage.vue_vue_type_style_index_0_lang-a98a6142.js";import{_ as t}from"./VAvatar.vue_vue_type_style_index_0_lang-f86e362a.js";import{_ as s}from"./VDropdown.vue_vue_type_style_index_0_lang-126b1443.js";import{e as i,r as n,Z as o,o as r,av as c,y as d,z as u,l as p,H as v,C as m,A as h,B as f,S as k,T as g,j as y,D as _,O as b,I as w,J as j,Q as C,R as x,P as A,E as D,ad as T,K as S,W as I,X as P,L as V,N as O,t as U,aR as E,s as N,M as $}from"./index-b750ebd3.js";import{_ as F}from"./VControl-48792b30.js";import{_ as M}from"./PlaceloadV3.vue_vue_type_style_index_0_lang-4bc1d7c9.js";import{_ as W,a as z}from"./projects-dark-4a371d8a.js";import{a as R}from"./useSupportElement-c5cb7903.js";import{u as B}from"./useNotyf-fd6acdce.js";import{u as L}from"./useAPI-d7cc4ad4.js";import{_ as H}from"./VBlock.vue_vue_type_style_index_0_lang-c86fdacf.js";import{_ as K}from"./VAvatarStack.vue_vue_type_script_setup_true_lang-67421880.js";import{_ as Q}from"./VAnimatedCheckbox.vue_vue_type_style_index_0_lang-349a373f.js";import{_ as q}from"./VField.vue_vue_type_script_setup_true_lang-25e58195.js";import{_ as Y,a as J}from"./VOption.vue_vue_type_style_index_0_lang-7f33ebe8.js";import{_ as X}from"./VLabel.vue_vue_type_script_setup_true_lang-30ee3a3d.js";import{_ as Z}from"./UserPopoverContent.vue_vue_type_script_setup_true_lang-fcfdb0e3.js";import{_ as G,a as ee}from"./search-4-dark-2b5b440c.js";import{_ as ae}from"./sheet-50221dfe.js";import{o as le}from"./via-placeholder-24645670.js";import{A as te}from"./vue3-apexcharts.common-5fb06877.js";import{p as se}from"./userPopovers-2b960611.js";import{u as ie}from"./useThemeColors-6c14c032.js";const ne=e=>(I("data-v-00cffb1a"),e=e(),P(),e),oe={key:1},re={class:"list-flex-toolbar is-reversed"},ce={class:"tabs-inner"},de={class:"tabs"},ue=ne((()=>m("span",null,"All",-1))),pe=[ue],ve=ne((()=>m("span",null,"Completed",-1))),me=[ve],he=ne((()=>m("li",{class:"tab-naver"},null,-1))),fe={class:"flex-list-wrapper flex-list-v2"},ke={key:0,class:"tab-content is-active"},ge={class:"all-projects"},ye={class:"all-projects-header"},_e={class:"header-item"},be={class:"item-inner"},we=ne((()=>m("i",{"aria-hidden":"true",class:"lnil lnil-analytics-alt-1"},null,-1))),je=ne((()=>m("p",null,"Total Tasks",-1))),Ce={class:"header-item"},xe={class:"item-inner"},Ae=ne((()=>m("i",{"aria-hidden":"true",class:"lnil lnil-target-alt-1"},null,-1))),De=ne((()=>m("p",null,"Completed Tasks",-1))),Te={class:"header-item"},Se={class:"item-inner"},Ie=ne((()=>m("i",{"aria-hidden":"true",class:"lnil lnil-pie-chart-alt"},null,-1))),Pe=ne((()=>m("p",null,"Pending Tasks",-1))),Ve={class:"header-item"},Oe={class:"item-inner"},Ue=ne((()=>m("i",{"aria-hidden":"true",class:"lnil lnil-leaf"},null,-1))),Ee=ne((()=>m("p",null,"Active Tasks",-1))),Ne={key:0,class:"columns is-multiline projects-card-grid"},$e={class:"column is-6"},Fe={class:"grid-item"},Me={class:"top-section"},We={class:"head"},ze=["onClick"],Re=[ne((()=>m("div",{class:"icon"},[m("i",{"aria-hidden":"true",class:"lnil lnil-eye"})],-1))),ne((()=>m("div",{class:"meta"},[m("span",null,"Active"),m("span",null,"Start work on this task")],-1)))],Be=["onClick"],Le=[ne((()=>m("div",{class:"icon"},[m("i",{"aria-hidden":"true",class:"lnil lnil-pencil"})],-1))),ne((()=>m("div",{class:"meta"},[m("span",null,"Pending"),m("span",null,"Waiting to work on")],-1)))],He=["onClick"],Ke=[ne((()=>m("div",{class:"icon"},[m("i",{"aria-hidden":"true",class:"lnil lnil-pencil"})],-1))),ne((()=>m("div",{class:"meta"},[m("span",null,"Completed"),m("span",null,"Mark task as completed")],-1)))],Qe=ne((()=>m("hr",{class:"dropdown-divider"},null,-1))),qe=["onClick"],Ye=[ne((()=>m("div",{class:"icon"},[m("i",{"aria-hidden":"true",class:"lnil lnil-pencil"})],-1))),ne((()=>m("div",{class:"meta"},[m("span",null,"Edit"),m("span",null,"Edit Task detail")],-1)))],Je=["onClick"],Xe=[ne((()=>m("div",{class:"icon"},[m("i",{"aria-hidden":"true",class:"lnil lnil-archive"})],-1))),ne((()=>m("div",{class:"meta"},[m("span",null,"Delete "),m("span",null,"Delete this task")],-1)))],Ze={class:"body"},Ge={class:"bottom-section"},ea={class:"foot-block"},aa=ne((()=>m("h4",{class:"heading"},"Worker(s)",-1))),la={class:"developers"},ta={class:"foot-block"},sa=ne((()=>m("h4",{class:"heading"},"Start date",-1))),ia={class:"foot-block"},na=ne((()=>m("h4",{class:"heading"},"End date",-1))),oa={class:"foot-block"},ra=ne((()=>m("h4",{class:"heading"},"Status",-1))),ca=ne((()=>m("img",{class:"light-image is-larger",src:W,alt:""},null,-1))),da=ne((()=>m("img",{class:"dark-image is-larger",src:z,alt:""},null,-1))),ua={key:1,class:"tab-content is-active"},pa={class:"all-projects"},va={key:0,class:"columns is-multiline projects-card-grid"},ma={class:"column is-6"},ha={class:"grid-item"},fa={class:"top-section"},ka={class:"head"},ga=["onClick"],ya=[ne((()=>m("div",{class:"icon"},[m("i",{"aria-hidden":"true",class:"lnil lnil-eye"})],-1))),ne((()=>m("div",{class:"meta"},[m("span",null,"Active"),m("span",null,"Start work on this task")],-1)))],_a=["onClick"],ba=[ne((()=>m("div",{class:"icon"},[m("i",{"aria-hidden":"true",class:"lnil lnil-pencil"})],-1))),ne((()=>m("div",{class:"meta"},[m("span",null,"Pending"),m("span",null,"Waiting to work on")],-1)))],wa=["onClick"],ja=[ne((()=>m("div",{class:"icon"},[m("i",{"aria-hidden":"true",class:"lnil lnil-pencil"})],-1))),ne((()=>m("div",{class:"meta"},[m("span",null,"Completed"),m("span",null,"Mark task as completed")],-1)))],Ca=ne((()=>m("hr",{class:"dropdown-divider"},null,-1))),xa=["onClick"],Aa=[ne((()=>m("div",{class:"icon"},[m("i",{"aria-hidden":"true",class:"lnil lnil-pencil"})],-1))),ne((()=>m("div",{class:"meta"},[m("span",null,"Edit"),m("span",null,"Edit Task detail")],-1)))],Da=["onClick"],Ta=[ne((()=>m("div",{class:"icon"},[m("i",{"aria-hidden":"true",class:"lnil lnil-archive"})],-1))),ne((()=>m("div",{class:"meta"},[m("span",null,"Delete "),m("span",null,"Delete this task")],-1)))],Sa={class:"body"},Ia={class:"bottom-section"},Pa={class:"foot-block"},Va=ne((()=>m("h4",{class:"heading"},"Worker(s)",-1))),Oa={class:"developers"},Ua={class:"foot-block"},Ea=ne((()=>m("h4",{class:"heading"},"Start date",-1))),Na={class:"foot-block"},$a=ne((()=>m("h4",{class:"heading"},"End date",-1))),Fa={class:"foot-block"},Ma=ne((()=>m("h4",{class:"heading"},"Status",-1))),Wa=ne((()=>m("img",{class:"light-image is-larger",src:W,alt:""},null,-1))),za=ne((()=>m("img",{class:"dark-image is-larger",src:z,alt:""},null,-1))),Ra=V(i({__name:"ProjectsTasks",props:{projectID:{default:""}},emits:["update:getAllTasks","update:completedTasks","update:activeTasks"],setup(i,{emit:I}){const P=i,V=L(),O=B();n(1);const U=n("");n("Edit Project"),n("Add Task");const E=n(""),N=n("active");n(!1);const $=n(0);n(!1),n(!1);const W=n(!1);n(!1);const z=n(!1),R=n(0);n(0),n(0),n({}),n([]),n(""),n("");const H=n("");n(""),n([{value:"active",name:"Active"},{value:"pending",name:"Pre Construction"},{value:"completed",name:"Completed"},{value:"cancelled",name:"cancelled"}]),n({icon:"fa fa-bell",alertTitle:"Delete Task ?",alertDescription:"After deleting this task you will not be able to recover it"}),n({icon:"fa fa-warning",alertTitle:"Delete Project Permanently?",alertDescription:"After deleting this Project you will not be able to recover it"}),n([{id:0,username:"",email:"",phoneNumber:""}]);const K=n([{id:0,title:"",description:"",startDate:"",endDate:"",project:0,status:"",worker:[{id:0,username:"",email:"",role:"",avatar:""}],quantity:"",unit:"",costCode:""}]),Q=n({title:"",subtitle:"test",isSweetAlertOpen:!1,btntext:"text"}),q=e=>{R.value=e,Q.value={title:"Delete Task?",subtitle:"Do you really want to delete this task permanently?",btntext:"Yes, Delete",isSweetAlertOpen:!0}},Y=async()=>{try{W.value=!0;const e=await V.get(`api/task/${P.projectID}/project/`);K.value=e.data,console.log(e.data)}catch(e){console.log(e)}finally{W.value=!1}},J=o((()=>{let e=K.value.filter((e=>"active"==e.status));return I("update:completedTasks",e.length),e.length})),X=o((()=>{let e=K.value.filter((e=>"pending"==e.status));return I("update:activeTasks",e.length),e.length})),Z=o((()=>K.value.filter((e=>"completed"==e.status)).length)),G=e=>{H.value=e,z.value=!0},ee=()=>{Y(),z.value=!1,H.value=""},ae=async(e,a)=>{try{W.value=!0;await V.patch(`/api/task/${e}/`,{status:a,schedule_mode:localStorage.getItem("isScheduleMode")});Y(),O.success(`Task set to ${a} successfully`),$.value=0,W.value=!1}catch(l){console.log(l)}},le=async()=>{try{W.value=!0;const e=await V.delete(`/api/task/${R.value}/`);console.log(e),O.success("Task deleted successfully"),Y(),Q.value.isSweetAlertOpen=!1,$.value=0}catch(e){console.log(e)}finally{W.value=!1}},te=o((()=>{if(E.value){const e=new RegExp(E.value,"i");return K.value.filter((a=>"completed"!=a.status&&(a.title.match(e)||a.description.match(e)||a.status.match(e))))}return K.value.filter((e=>"completed"!=e.status))})),se=o((()=>{if(E.value){const e=new RegExp(E.value,"i");return K.value.filter((a=>"completed"==a.status&&(a.title.match(e)||a.description.match(e)||a.status.match(e))))}return K.value.filter((e=>"completed"==e.status))}));return r((()=>{Y()})),(i,n)=>{const o=M,r=F,I=D,V=T,O=s,$=t,R=l,B=a,L=e,ie=c("tooltip");return d(),u(C,null,[p(W)?(d(),v(o,{key:0})):(d(),u("div",oe,[m("div",re,[h(V,null,{default:f((()=>[h(r,{class:"mr-2 h-hidden-mobile",icon:"feather:search"},{default:f((()=>[k(m("input",{"onUpdate:modelValue":n[0]||(n[0]=e=>y(E)?E.value=e:null),class:"input custom-text-filter",placeholder:"Search..."},null,512),[[g,p(E)]])])),_:1}),h(I,{onClick:n[1]||(n[1]=e=>G()),color:"primary",icon:"fas fa-plus",elevated:"",raised:""},{default:f((()=>[_("Task")])),_:1})])),_:1}),m("div",ce,[m("div",de,[m("ul",null,[m("li",{class:b(["active"===p(N)&&"is-active"])},[m("a",{tabindex:"0",role:"button",onKeydown:n[2]||(n[2]=w(S((e=>N.value="active"),["prevent"]),["space"])),onClick:n[3]||(n[3]=e=>N.value="active")},pe,32)],2),m("li",{class:b(["closed"===p(N)&&"is-active"])},[m("a",{tabindex:"0",role:"button",onKeydown:n[4]||(n[4]=w(S((e=>N.value="closed"),["prevent"]),["space"])),onClick:n[5]||(n[5]=e=>N.value="closed")},me,32)],2),he])])])]),m("div",fe,["active"===p(N)?(d(),u("div",ke,[m("div",ge,[m("div",ye,[m("div",_e,[m("div",be,[we,m("span",null,j(p(K).length),1),je])]),m("div",Ce,[m("div",xe,[Ae,m("span",null,j(p(Z)),1),De])]),m("div",Te,[m("div",Se,[Ie,m("span",null,j(p(X)),1),Pe])]),m("div",Ve,[m("div",Oe,[Ue,m("span",null,j(p(J)),1),Ee])])]),p(te).length?(d(),u("div",Ne,[(d(!0),u(C,null,x(p(te),(e=>(d(),u("div",$e,[m("div",Fe,[m("div",Me,[m("div",We,[m("h3",null,j(e.title),1),h(O,{icon:"feather:more-vertical",spaced:"",right:""},{content:f((()=>[m("a",{onClick:a=>ae(e.id,"active"),role:"menuitem",class:"dropdown-item is-media"},Re,8,ze),m("a",{onClick:a=>ae(e.id,"pending"),role:"menuitem",class:"dropdown-item is-media"},Le,8,Be),m("a",{onClick:a=>ae(e.id,"completed"),role:"menuitem",class:"dropdown-item is-media"},Ke,8,He),Qe,m("a",{onClick:a=>G(e.id),role:"menuitem",class:"dropdown-item is-media"},Ye,8,qe),m("a",{onClick:a=>q(e.id),role:"menuitem",class:"dropdown-item is-media"},Xe,8,Je)])),_:2},1024)]),m("div",Ze,[m("p",null,j(e.description),1)])]),m("div",Ge,[m("div",ea,[aa,m("div",la,[(d(!0),u(C,null,x(e.workers,(e=>k((d(),v($,{picture:e.avatar,size:"small",color:"primary",initials:e.avatar?"":e.username.slice(0,2)},null,8,["picture","initials"])),[[ie,`${e.username}`,void 0,{rounded:!0,info:!0}]]))),256))])]),m("div",ta,[sa,m("p",null,j(e.startDate),1)]),m("div",ia,[na,m("p",null,j(e.endDate),1)]),m("div",oa,[ra,m("p",null,j(e.status),1)])])])])))),256))])):(d(),v(R,{key:1,title:"There is no task added on this projects.",subtitle:"Looks like you don't have any task on this project yet. When you'll\n                start creating tasks of this project, they will be showing up in here."},{image:f((()=>[ca,da])),_:1}))])])):"closed"===p(N)?(d(),u("div",ua,[m("div",pa,[p(se).length?(d(),u("div",va,[(d(!0),u(C,null,x(p(se),(e=>(d(),u("div",ma,[m("div",ha,[m("div",fa,[m("div",ka,[m("h3",null,j(e.title),1),h(O,{icon:"feather:more-vertical",spaced:"",right:""},{content:f((()=>[m("a",{onClick:a=>ae(e.id,"active"),role:"menuitem",class:"dropdown-item is-media"},ya,8,ga),m("a",{onClick:a=>ae(e.id,"pending"),role:"menuitem",class:"dropdown-item is-media"},ba,8,_a),m("a",{onClick:a=>ae(e.id,"completed"),role:"menuitem",class:"dropdown-item is-media"},ja,8,wa),Ca,m("a",{onClick:a=>G(e.id),role:"menuitem",class:"dropdown-item is-media"},Aa,8,xa),m("a",{onClick:a=>q(e.id),role:"menuitem",class:"dropdown-item is-media"},Ta,8,Da)])),_:2},1024)]),m("div",Sa,[m("p",null,j(e.description),1)])]),m("div",Ia,[m("div",Pa,[Va,m("div",Oa,[(d(!0),u(C,null,x(e.workers,(e=>k((d(),v($,{picture:e.avatar,size:"small",color:"primary",initials:e.avatar?"":e.username.slice(0,2)},null,8,["picture","initials"])),[[ie,`${e.username}`,void 0,{rounded:!0,info:!0}]]))),256))])]),m("div",Ua,[Ea,m("p",null,j(e.startDate),1)]),m("div",Na,[$a,m("p",null,j(e.endDate),1)]),m("div",Fa,[Ma,m("p",null,j(e.status),1)])])])])))),256))])):(d(),v(R,{key:1,title:"No closed projects.",subtitle:"Looks like you don't have any closed project yet. When you'll\n                start closing off projects, they will be showing up in here."},{image:f((()=>[Wa,za])),_:1}))])])):A("",!0)])])),p(Q).isSweetAlertOpen?(d(),v(B,{key:2,isSweetAlertOpen:p(Q).isSweetAlertOpen,title:p(Q).title,subtitle:p(Q).subtitle,btntext:p(Q).btntext,onConfirm:le,loading:p(W),onCancel:()=>p(Q).isSweetAlertOpen=!1},null,8,["isSweetAlertOpen","title","subtitle","btntext","loading","onCancel"])):A("",!0),p(z)?(d(),v(L,{key:3,projectID:P.projectID,isOpen:p(z),taskIdSelected:p(H),startDate:p(U),"onUpdate:modalHandler":ee,"onUpdate:OnSuccess":Y},null,8,["projectID","isOpen","taskIdSelected","startDate"])):A("",!0)],64)}}}),[["__scopeId","data-v-00cffb1a"]]),Ba={class:"list-widget is-straight"},La={class:"widget-head"},Ha=m("h3",{class:"dark-inverted"},"Tasks of Today",-1),Ka={class:"inner-list"},Qa={href:"#"},qa=i({__name:"ProjectTodayTasks",props:{projectId:{default:""},straight:{type:Boolean}},setup(e){const a=L(),l=B(),t=O();U();const s=n([]),i=async e=>{try{const i=await a.get(`/api/task/today-tasks/?project=${t.params.id}`);s.value=i.data.map((e=>({...e,workers:e.workers.map((e=>({...e,picture:e?.avatar,initials:e?.username?.slice(0,2).toUpperCase()})))}))),e&&l.green("Tasks list Refreshed"),console.log("data",s.value)}catch(i){console.log(i)}};return r((()=>{i(!1)})),(e,a)=>{const l=Q,t=K,n=H;return d(),u("div",Ba,[m("div",La,[Ha,m("i",{onClick:a[0]||(a[0]=e=>i(!0)),style:{color:"var(--primary)"},class:"fas fa-redo cu-pointer","aria-hidden":"true"})]),m("div",Ka,[m("div",null,[(d(!0),u(C,null,x(p(s),(e=>(d(),v(n,{key:e.id,center:"",lighter:"",class:"inner-list-item"},{icon:f((()=>[h(l,{modelValue:e.is_active,"onUpdate:modelValue":a=>e.is_active=a,value:e.is_active,color:"info"},null,8,["modelValue","onUpdate:modelValue","value"])])),action:f((()=>[e.workers.length?(d(),v(t,{key:0,avatars:e.workers,size:"small",limit:3},null,8,["avatars"])):A("",!0)])),default:f((()=>[m("a",Qa,j(e.title),1),m("span",null,j(e.status),1)])),_:2},1024)))),128))])])])}}}),Ya=e=>(I("data-v-3d857eb3"),e=e(),P(),e),Ja={class:"tile-grid-toolbar"},Xa={class:"buttons"},Za={class:"file"},Ga={class:"file-label"},el=Ya((()=>m("span",{style:{"background-color":"var(--primary)",color:"#fff"},class:"file-cta"},[m("span",{class:"file-icon"},[m("i",{class:"fas fa-plus"})]),m("span",{class:"file-label"}," File ")],-1))),al={class:"tile-grid tile-grid-v2"},ll=Ya((()=>m("img",{class:"light-image",src:G,alt:""},null,-1))),tl=Ya((()=>m("img",{class:"dark-image",src:ee,alt:""},null,-1))),sl={class:"tile-grid-item"},il={class:"tile-grid-item-inner"},nl={class:"meta"},ol={class:"dark-inverted"},rl=["onClick"],cl=[Ya((()=>m("div",{class:"icon"},[m("i",{"aria-hidden":"true",class:"lnil lnil-trash-can-alt"})],-1))),Ya((()=>m("div",{class:"meta"},[m("span",null,"Delete"),m("span",null,"Delete this file")],-1)))],dl=V(i({__name:"ProjectFiles",props:{projectId:{},files:{}},emits:["update:onUploadFile"],setup(e,{emit:t}){const i=e,r=L(),c=B(),_=n(!1),w=n(""),D=o((()=>w.value?i.files.filter((e=>e.match(new RegExp(w.value,"i")))):i.files)),T=n(""),S=n(""),I=e=>{const a=e.match(/\d{4}-\d{2}-\d{2}/);if(a){return a[0]}return"N/A"},P=e=>{let a=e.target.files[0];(async e=>{try{_.value=!0;const a=await r.post(`/api/task/bulk-upload/${i.projectId}/`,{file:e});c.green("Tasks Will be generated automatically"),console.log(a),t("update:onUploadFile",null),_.value=!1}catch(a){console.log(a)}})(a),S.value=a.name},V=n({title:"",subtitle:"test",isSweetAlertOpen:!1,btntext:"text"}),O=async()=>{try{_.value=!0;await r.patch(`/api/project/${i.projectId}/delete-doc-tasks/`,{document_name:T.value});t("update:onUploadFile",null),c.success("Sheet deleted successfully!"),V.value.isSweetAlertOpen=!1}catch(e){console.log(e)}finally{_.value=!1}};return n(0),(e,t)=>{const i=F,n=q,o=l,r=s,c=a;return d(),u(C,null,[m("div",null,[m("div",Ja,[h(i,{icon:"feather:search"},{default:f((()=>[k(m("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>y(w)?w.value=e:null),class:"input custom-text-filter",placeholder:"Search..."},null,512),[[g,p(w)]])])),_:1}),m("div",Xa,[h(n,{grouped:""},{default:f((()=>[h(i,null,{default:f((()=>[m("div",Za,[m("label",Ga,[m("input",{onChange:P,class:"file-input",type:"file",name:"file",style:{"background-color":"var(--primary)",color:"#fff"}},null,32),el])])])),_:1})])),_:1})])]),m("div",al,[h(o,{class:b([0!==p(D).length&&"is-hidden"]),title:"There is not file uploaded",subtitle:"There is no file uploaded on this project to create the tasks. As you will upload the file and that will appear here on the spot",larger:""},{image:f((()=>[ll,tl])),_:1},8,["class"]),h(E,{name:"list",tag:"div",class:"columns is-multiline"},{default:f((()=>[(d(!0),u(C,null,x(p(D),(e=>(d(),u("div",{key:e.id,class:"column is-6"},[m("div",sl,[m("div",il,[m("img",{src:ae,alt:"",onErrorOnce:t[1]||(t[1]=e=>p(le)(150))},null,32),m("div",nl,[m("span",ol,j(e.length>20?e.slice(0,24):e),1),m("span",null,[m("span",null,"Updated: "+j(I(e)),1)])]),h(r,{icon:"feather:more-vertical",spaced:"",right:""},{content:f((()=>[m("a",{onClick:a=>{return l=e,T.value=l,void(V.value={title:"Are you sure?",subtitle:"This file and all task generated from this file will be deleted permanently!",btntext:"Yes, Delete it",isSweetAlertOpen:!0});var l},role:"menuitem",class:"dropdown-item is-media"},cl,8,rl)])),_:2},1024)])])])))),128))])),_:1})])]),p(V).isSweetAlertOpen?(d(),v(c,{key:0,isSweetAlertOpen:p(V).isSweetAlertOpen,title:p(V).title,subtitle:p(V).subtitle,btntext:p(V).btntext,onConfirm:O,onCancel:()=>p(V).isSweetAlertOpen=!1},null,8,["isSweetAlertOpen","title","subtitle","btntext","onCancel"])):A("",!0)],64)}}}),[["__scopeId","data-v-3d857eb3"]]),ul=e=>(I("data-v-0684e5b0"),e=e(),P(),e),pl={class:"personal-dashboard personal-dashboard-v2"},vl={class:"columns is-multiline"},ml={class:"column is-12"},hl={class:"dashboard-header"},fl={class:"user-meta is-dark-bordered-12"},kl={class:"title is-4 is-narrow is-bold"},gl={class:"light-text"},yl={class:"info-text is-bold"},_l=ul((()=>m("i",{class:"fas fa-home"},null,-1))),bl={class:"user-action"},wl=ul((()=>m("h3",{class:"title is-5 is-narrow"},"Information",-1))),jl={class:"light-text"},Cl={class:"light-text"},xl={class:"light-text"},Al={class:"h-hidden-tablet-p"},Dl={class:"media-flex inverted-text"},Tl=ul((()=>m("a",{class:"link inverted-text"},"Change status",-1))),Sl={class:"tabs-inner"},Il={class:"tabs is-boxed",slider:""},Pl=[ul((()=>m("span",null,"Project info",-1)))],Vl=[ul((()=>m("span",null,"Tasks",-1)))],Ol=ul((()=>m("li",{class:"tab-naver"},null,-1))),Ul={key:0,class:"columns is-multiline"},El={class:"column is-8"},Nl={class:"dashboard-card has-margin-bottom"},$l={class:"dashboard-card"},Fl=ul((()=>m("div",{class:"card-head"},[m("h3",{class:"dark-inverted"},"Task Completion"),m("a",{class:"action-link",tabindex:"0"},"Reports")],-1))),Ml={class:"column is-4"},Wl={class:"dashboard-card"},zl=ul((()=>m("div",{class:"card-head"},[m("h3",{class:"dark-inverted"},"Assigned Manager"),m("a",{class:"action-link",tabindex:"0"})],-1))),Rl={class:"active-team"},Bl={key:0,class:"user-list"},Ll={class:"user-list-info"},Hl={class:"name dark-inverted"},Kl={class:"position"},Ql=ul((()=>m("div",{class:"user-list-icons"},[m("a",null,[m("i",{"aria-hidden":"true",class:"fas fa-phone"})]),m("a",null,[m("i",{"aria-hidden":"true",class:"fas fa-video"})])],-1))),ql={key:1,class:"user-list"},Yl=[ul((()=>m("div",{class:"user-list-info"},[m("div",{class:"name dark-inverted"},"No Manager assigned yet")],-1)))],Jl={class:"dashboard-card"},Xl={class:"card-head"},Zl=ul((()=>m("h3",{class:"dark-inverted"},"Client Information",-1))),Gl={class:"active-team"},et={key:0,class:"user-list"},at={class:"user-list-info"},lt={class:"name dark-inverted"},tt={class:"position"},st=ul((()=>m("div",{class:"user-list-icons"},[m("a",null,[m("i",{"aria-hidden":"true",class:"fas fa-phone"})]),m("a",null,[m("i",{"aria-hidden":"true",class:"fas fa-video"})])],-1))),it={key:1,class:"user-list"},nt=[ul((()=>m("div",{class:"user-list-info"},[m("div",{class:"name dark-inverted"},"No Client Info Added yet")],-1)))],ot={key:2},rt={class:"dashboard-card"},ct={class:"card-head"},dt=ul((()=>m("h3",{class:"dark-inverted"},"Contractor Information",-1))),ut={class:"active-team"},pt={key:0,class:"user-list"},vt={class:"user-list-info"},mt={class:"name dark-inverted"},ht={class:"position"},ft=ul((()=>m("div",{class:"user-list-icons"},[m("a",null,[m("i",{"aria-hidden":"true",class:"fas fa-phone"})]),m("a",null,[m("i",{"aria-hidden":"true",class:"fas fa-video"})])],-1))),kt={key:1,class:"user-list"},gt=[ul((()=>m("div",{class:"user-list-info"},[m("div",{class:"name dark-inverted"}," No contractor Info Added yet ")],-1)))],yt={key:2},_t={class:"dashboard-card"},bt={key:1,class:"columns is-multiline"},wt={class:"column is-12"},jt=V(i({__name:"ProjectDetail",setup(e){const a=ie(),l=L(),s=B(),i=O();U();const o=n("detail"),c=n(!1),k=n(!1);n(!1);const g=n(!1);n(!1);const y=n(!1),D=n([]),T=n([]),I=n([]);n(0);const P=n(0),V=n(0);n(""),n(""),n("");const E=n("");n("");const M=n("");n("");const W=n([{id:0,username:"",email:"",phoneNumber:""}]);n([{value:"active",name:"Active"},{value:"pending",name:"Pre Construction"},{value:"completed",name:"Completed"},{value:"cancelled",name:"cancelled"}]);const z=n([]),H=n({id:0,title:"",created:"",startDate:"",color:"",endDate:"",description:"",image:"",is_active:null,status:"",address:"",total_tasks:0,client:0,contractor:0,clientInfo:{id:0,username:"",email:"",password:"",avatar:null},uploaded_files:[],contractorInfo:{id:0,username:"",email:"",password:"",avatar:null},managers:[{id:0,username:"",avatar:null,email:"",role:""}]});n({title:"",description:"",startDate:"",endDate:"",status:"",project:i.params.id,workers:[]});const K=n([{id:0,title:"",description:"",startDate:"",endDate:"",project:0,status:"",worker:[{id:0,username:"",email:"",role:"",avatar:""}]}]);n({icon:"fa fa-warning",alertTitle:"Delete Project Permanently?",alertDescription:"After deleting this Project you will not be able to recover it"});const Q=N({height:180,type:"radialBar",series:[],title:{text:""},chart:{toolbar:{show:!1}},colors:[a.primary,a.purple,a.orange],plotOptions:{radialBar:{hollow:{size:"55%"}}},labels:["Completion"]}),G=N({series:[{name:"Pending",data:[31,40,28,51,42,109,100]},{name:"Completed",data:[11,32,45,32,34,52,41]},{name:"Blocked",data:[78,53,36,10,14,5,2]}],chart:{height:295,type:"area",toolbar:{show:!1}},colors:[a.accent,a.info,a.primary],legend:{position:"top"},dataLabels:{enabled:!1},stroke:{width:[2,3,5],curve:"smooth"},xaxis:{type:"date",categories:["2020-09-19","2020-09-20","2020-09-21","2020-09-22","2020-09-23","2020-09-24","2020-09-25"]},tooltip:{x:{format:"dd/MM/yy HH:mm"}}}),ee=()=>{g.value=!g.value},ae=()=>{k.value=!k.value},le=n(0),ne=async()=>{try{c.value=!0;const e=await l.get(`/api/project/${M.value}/`);H.value=e.data;let a=e.data.percentage.toFixed(2);Q.value.series.push(a),E.value=e.data.image,oe()}catch(e){console.log(e)}finally{c.value=!1}},oe=async()=>{try{c.value=!0;const e=await l.get(`api/task/${i.params.id}/project/`);K.value=e.data,console.log(e.data),(()=>{let e=K.value.filter((e=>"active"==e.status));le.value=e.length})(),c.value=!1}catch(e){console.log(e)}},re=async()=>{try{H.value.managers=I;let e=R(H.value,["image"]);e.delete("clientInfo"),e.delete("contractorInfo"),"object"==typeof H.value.client&&e.delete("client"),"object"==typeof H.value.contractor&&e.delete("contractor");const a=await l.patch(`/api/project/${i.params.id}/`,e);k.value=!1,g.value=!1,s.green("Project updated successfully"),ne(a.data.id)}catch(e){console.log(e)}};n("");const ce=e=>{P.value=e},de=e=>{V.value=e};return r((()=>{M.value=i.params.id,ne(),(async()=>{try{y.value=!0;const e=await l.get("/api/users/",{});W.value=e.data.filter((e=>"worker"==e.role)),D.value=e.data.filter((e=>"client"==e.role)),T.value=e.data.filter((e=>"contractor"==e.role)),console.log("data",W.value)}catch(e){console.log(e)}finally{y.value=!1}})(),oe(),(async()=>{try{const e=await l.get(`/api/task/today-tasks/?project=${i.params.id}`);z.value=e.data}catch(e){console.log(e)}})()})),(e,a)=>{const l=t,s=$("Address"),n=dl,r=Z,y=$("Tippy"),I=X,P=Y,V=J,O=F,U=q,E=qa,N=Ra;return d(),u("div",pl,[m("div",vl,[m("div",ml,[m("div",hl,[h(l,{picture:p(H).image,squared:"",color:"primary",badge:"/images/icons/flags/united-states-of-america.svg",size:"xxl"},null,8,["picture"]),m("div",fl,[m("h3",kl,j(p(H).title?p(H).title:"N/A"),1),m("p",gl,[_(" Current status: "),m("span",yl,j("pending"===p(H).status?"Pre Construction":p(H).status.charAt(0).toUpperCase()+p(H).status.slice(1)),1)]),h(s,null,{default:f((()=>[_l,_(" "+j(p(H).address),1)])),_:1})]),m("div",bl,[wl,m("p",jl," Started at: "+j(p(H)?.startDate?p(H)?.startDate:"N/A"),1),m("p",Cl," Expected end: "+j(p(H)?.endDate?p(H)?.endDate:"N/A"),1),m("p",xl," Total jobs: "+j(p(H).total_tasks?p(H).total_tasks:"N/A")+" Tasks ",1)]),m("div",Al,[m("div",Dl,[p(c)?A("",!0):(d(),v(p(te),{key:0,id:"completion-chart",height:p(Q).height,type:p(Q).type,series:p(Q).series,label:"Completion",options:p(Q)},null,8,["height","type","series","options"]))]),Tl])])])]),m("div",Sl,[m("div",Il,[m("ul",null,[m("li",{class:b(["detail"===p(o)&&"is-active"])},[m("a",{tabindex:"0",role:"button",onKeydown:a[0]||(a[0]=w(S((e=>o.value="detail"),["prevent"]),["space"])),onClick:a[1]||(a[1]=e=>o.value="detail")},Pl,32)],2),m("li",{class:b(["tasks"===p(o)&&"is-active"])},[m("a",{tabindex:"0",role:"button",onKeydown:a[2]||(a[2]=w(S((e=>o.value="tasks"),["prevent"]),["space"])),onClick:a[3]||(a[3]=e=>o.value="tasks")},Vl,32)],2),Ol])])]),"detail"===p(o)?(d(),u("div",Ul,[m("div",El,[m("div",Nl,[h(n,{projectId:p(i).params.id,files:p(H).uploaded_files,"onUpdate:onUploadFile":ne},null,8,["projectId","files"])]),m("div",$l,[Fl,h(p(te),{id:"completion-chart",height:p(G).chart.height,type:p(G).chart.type,series:p(G).series,options:p(G)},null,8,["height","type","series","options"])])]),m("div",Ml,[m("div",Wl,[zl,m("div",Rl,[p(H).managers.length>0?(d(),u("ul",Bl,[(d(!0),u(C,null,x(p(H).managers,(e=>(d(),u("li",{key:e.id},[m("div",null,[h(y,{class:"has-help-cursor",interactive:"",offset:[0,10]},{content:f((()=>[h(r,{user:p(se).user18},null,8,["user"])])),default:f((()=>[h(l,{picture:e.avatar},null,8,["picture"])])),_:2},1024)]),m("div",Ll,[m("div",Hl,j(e.username),1),m("div",Kl,j(e.email),1)]),Ql])))),128))])):(d(),u("ul",ql,Yl))])]),m("div",Jl,[m("div",Xl,[Zl,m("a",{onClick:ae,class:"action-link",tabindex:"0"},j(p(k)?"Close":"Edit"),1)]),m("div",Gl,[p(H).client?(d(),u("ul",et,[m("li",null,[m("div",null,[h(y,{class:"has-help-cursor",interactive:"",offset:[0,10]},{content:f((()=>[h(r,{user:p(se).user18},null,8,["user"])])),default:f((()=>[h(l,{picture:p(H).client.avatar},null,8,["picture"])])),_:1})]),m("div",at,[m("div",lt,j(p(H).client.username),1),m("div",tt,j(p(H).client.email),1)]),st])])):(d(),u("ul",it,nt)),p(k)?(d(),u("div",ot,[h(U,null,{default:f((()=>[h(I,null,{default:f((()=>[_("Select client")])),_:1}),h(O,null,{default:f((()=>[h(V,{modelValue:p(H).client,"onUpdate:modelValue":a[4]||(a[4]=e=>p(H).client=e),onChange:re},{default:f((()=>[h(P,{value:""},{default:f((()=>[_(" Clients ")])),_:1}),(d(!0),u(C,null,x(p(D),(e=>(d(),v(P,{key:e.id,value:e.id},{default:f((()=>[_(j(e.username),1)])),_:2},1032,["value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1})])):A("",!0)])]),m("div",rt,[m("div",ct,[dt,m("a",{onClick:ee,class:"action-link",tabindex:"0"},j(p(g)?"Close":"Edit"),1)]),m("div",ut,[p(H).contractor?(d(),u("ul",pt,[m("li",null,[m("div",null,[h(y,{class:"has-help-cursor",interactive:"",offset:[0,10]},{content:f((()=>[h(r,{user:p(se).user18},null,8,["user"])])),default:f((()=>[h(l,{picture:p(H).contractor.avatar},null,8,["picture"])])),_:1})]),m("div",vt,[m("div",mt,j(p(H).contractor.username),1),m("div",ht,j(p(H).contractor.email),1)]),ft])])):(d(),u("ul",kt,gt)),p(g)?(d(),u("div",yt,[h(U,null,{default:f((()=>[h(I,null,{default:f((()=>[_("Select contractor")])),_:1}),h(O,null,{default:f((()=>[h(V,{modelValue:p(H).contractor,"onUpdate:modelValue":a[5]||(a[5]=e=>p(H).contractor=e),onChange:re},{default:f((()=>[(d(!0),u(C,null,x(p(T),(e=>(d(),v(P,{key:e.id,value:e.id},{default:f((()=>[_(j(e.username),1)])),_:2},1032,["value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1})])):A("",!0)])]),m("div",_t,[h(E,{projectId:p(i).params.id},null,8,["projectId"])])])])):A("",!0),"tasks"===p(o)?(d(),u("div",bt,[m("div",wt,[h(N,{"onUpdate:completedTasks":ce,"onUpdate:activeTasks":de,projectID:p(i).params.id},null,8,["projectID"])])])):A("",!0)])}}}),[["__scopeId","data-v-0684e5b0"]]);export{jt as P};
