import{_ as e}from"./VModal.vue_vue_type_style_index_0_lang-2bee2677.js";import{u as a,_ as l,a as t,b as o,c as s}from"./CreateProposalTasksModal-7ead2602.js";import{e as i,s as n,r,b as d,_ as u,o as p,i as c,B as m,N as _,F as v,D as f,K as g,W as y,l as b,E as h,M as k,C as w,J as C,T as P,I as x,O as I,av as V,Z as T,Y as S,A,U as M,V as U,R as j,j as O,aR as q,P as D,Q as H,v as E,x as L}from"./index-70af507c.js";import{_ as $}from"./VTextarea.vue_vue_type_script_setup_true_lang-e812f757.js";import{_ as R}from"./VInput.vue_vue_type_script_setup_true_lang-8c98f35b.js";import{_ as G}from"./VField.vue_vue_type_script_setup_true_lang-f9f54325.js";import{_ as Z}from"./VControl-a243656f.js";import{_ as B}from"./VRadio.vue_vue_type_style_index_0_lang-ca7f2326.js";import{_ as F}from"./V-Snack.vue_vue_type_style_index_0_lang-3c561e91.js";import{_ as N}from"./VIcon.vue_vue_type_script_setup_true_lang-730ef7fb.js";import{u as z}from"./useAPI-7526ffb5.js";import{s as Q,c as W}from"./costItems-db4736e1.js";import{u as J}from"./useNotyf-98b938b1.js";import{a as Y,e as K,g as X}from"./useSupportElement-6fb37513.js";import{_ as ee}from"./VFlexPagination.vue_vue_type_script_setup_true_lang-857f5d87.js";import{_ as ae,c as le}from"./VFlexTable.vue_vue_type_style_index_0_lang-1f2eda23.js";import{_ as te}from"./VCheckbox.vue_vue_type_style_index_0_lang-bd11b3e3.js";import{_ as oe}from"./VTag.vue_vue_type_style_index_0_lang-caab6404.js";import{_ as se}from"./VPlaceholderPage.vue_vue_type_style_index_0_lang-a62d7c3e.js";import{_ as ie,a as ne}from"./search-4-dark-2b5b440c.js";import{_ as re}from"./SweetAlert.vue_vue_type_style_index_0_lang-d291204b.js";import{_ as de}from"./VAvatar.vue_vue_type_style_index_0_lang-f1d074f0.js";import{u as ue}from"./userSession-2550218b.js";import{_ as pe}from"./VDropdown.vue_vue_type_style_index_0_lang-1d6d26a5.js";import{_ as ce}from"./PlaceloadV1.vue_vue_type_style_index_0_lang-929ef51a.js";const me={class:"modal-form columns is-multiline"},_e={class:"column is-12"},ve={class:"columns is-multiline"},fe={class:"field column is-6 mb-0"},ge=f("label",null,"Title: *",-1),ye={class:"control"},be={class:"column is-6"},he={class:"field column is-6"},ke=f("label",null,"Approval Deadline *",-1),we={class:"control"},Ce={class:"field column is-6"},Pe=f("label",null,"Attachments",-1),xe=f("div",{class:"file"},[f("label",{class:"file-label"},[f("input",{class:"file-input",type:"file",name:"resume"}),f("span",{class:"file-cta"},[f("span",{class:"file-icon"},[f("i",{class:"fas fa-cloud-upload-alt"})]),f("span",{class:"file-label"}," Choose a fileâ€¦ ")])])],-1),Ie={class:"column is-12"},Ve={class:"body-inner-content columns is-multiline"},Te={class:"field column is-12"},Se=f("label",{for:"",class:"label"},"Internal Notes",-1),Ae={class:"field column is-12 mb-0"},Me=f("label",{for:"",class:"label"},"Introductory Text",-1),Ue={class:"field column is-12 mb-0"},je=f("label",{for:"",class:"label"},"Closing Text",-1),Oe={class:"column is-12",id:"items-div"},qe={key:0},De=i({__name:"LeadProposalModal",props:{leadProposalModal:{type:Boolean},proposalId:{},leadId:{}},emits:["update:modalHandler","update:OnSuccess","clearProposalId"],setup(t,{emit:o}){const s=t;a();const i=n();ue();const V=J(),T=z(),S=r(!1),A=r(!1),M=r({id:"",title:"",approval_deadline:"",internal_notes:"",introductory_text:null,closing_text:null,payment_status:"",worksheetItems:[],type:"proposal",project:"",attachments:[],columns_to_show:[],status:"",created_at:"",updated_at:""}),U=async(e=!1)=>{try{S.value=!0,s.leadId&&(M.value.project=s.leadId),M.value.columns_to_show=JSON.stringify(Q.value);const a=Y(M.value,[]);if(s.proposalId||M.value.id){const e=await T.patch(`/api/lead-proposal/${s.proposalId?s.proposalId:M.value.id}/`,a);M.value=e.data}else{const e=await T.post("/api/lead-proposal/",a);M.value=e.data,j(100)}q(),e&&O(),V.success(`Proposal ${s.proposalId||M.value.id?"updated":"created"} successfully`)}catch(a){V.error("Something went wrong, try again")}finally{S.value=!1}},j=(e=0)=>{const a=document.getElementById("items-div");if(a){const l=a.offsetTop-e;window.scrollTo({top:l,behavior:"smooth"})}},O=()=>{o("update:modalHandler",!1)},q=()=>{o("update:OnSuccess",null)},D=d((()=>u((()=>import("./ckeditor-dbf08bf4.js").then((e=>e.c))),["assets/ckeditor-dbf08bf4.js","assets/index-70af507c.js","assets/index-ce8747cd.css","assets/vue.runtime.esm-bundler-c9a83e39.js"]).then((e=>e.default.component)))),H={fontFamily:{options:['"Montserrat", sans-serif','"Roboto", sans-serif']},height:"400px",minHeight:"400px"};return p((async()=>{i.value=await u((()=>import("./ckeditor-2554a6f6.js").then((e=>e.c))),["assets/ckeditor-2554a6f6.js","assets/index-70af507c.js","assets/index-ce8747cd.css"]).then((e=>e.default)),s.proposalId&&(async()=>{try{const e=await T.get(`/api/lead-proposal/${s.proposalId}/`);M.value=e.data,Q.value=e.data.columns_to_show}catch(e){console.log(e)}})()})),c((()=>{o("clearProposalId",null),M.value={}})),(a,t)=>{const o=B,n=Z,r=G,d=$,u=l,p=I,c=e;return m(),_(c,{is:"form",open:s.leadProposalModal,title:"Lead Proposal",size:"xl",actions:"right",onSubmit:t[10]||(t[10]=x((e=>U(!1)),["prevent"])),onClose:O},{content:v((()=>[f("div",me,[f("div",_e,[f("div",ve,[f("div",fe,[ge,f("div",ye,[g(f("input",{type:"text",name:"title","onUpdate:modelValue":t[0]||(t[0]=e=>b(M).title=e),required:"",class:"input is-primary-focus is-primary-focus",placeholder:"Proposal Title"},null,512),[[y,b(M).title]])])]),f("div",be,[h(r,{class:"m-0 p-0",label:"Type"},{default:v((()=>[h(n,null,{default:v((()=>[h(o,{modelValue:b(M).type,"onUpdate:modelValue":t[1]||(t[1]=e=>b(M).type=e),value:"proposal",label:"Proposal",name:"solid_squared_radio",color:"primary",square:"",solid:""},null,8,["modelValue"]),h(o,{modelValue:b(M).type,"onUpdate:modelValue":t[2]||(t[2]=e=>b(M).type=e),value:"change_order",label:"Change Order",name:"solid_squared_radio",color:"info",square:"",solid:""},null,8,["modelValue"]),h(o,{modelValue:b(M).type,"onUpdate:modelValue":t[3]||(t[3]=e=>b(M).type=e),value:"draft",label:"Draft",name:"solid_squared_radio",color:"warning",square:"",solid:""},null,8,["modelValue"])])),_:1})])),_:1})]),f("div",he,[ke,f("div",we,[g(f("input",{type:"date",name:"firstName","onUpdate:modelValue":t[4]||(t[4]=e=>b(M).approval_deadline=e),required:"",class:"input is-primary-focus is-primary-focus",placeholder:"Proposal Approval deadline"},null,512),[[y,b(M).approval_deadline]])])]),f("div",Ce,[Pe,h(r,{grouped:""},{default:v((()=>[h(n,null,{default:v((()=>[xe])),_:1})])),_:1})]),f("div",Ie,[f("div",Ve,[f("div",Te,[Se,h(r,null,{default:v((()=>[h(n,null,{default:v((()=>[h(d,{modelValue:b(M).internal_notes,"onUpdate:modelValue":t[5]||(t[5]=e=>b(M).internal_notes=e),rows:"4",placeholder:"Internal notes..."},null,8,["modelValue"])])),_:1})])),_:1})]),f("div",Ae,[Me,b(i)?(m(),_(b(D),{key:0,modelValue:b(M).introductory_text,"onUpdate:modelValue":t[6]||(t[6]=e=>b(M).introductory_text=e),editor:b(i),config:H},null,8,["modelValue","editor"])):k("",!0)]),f("div",Ue,[je,b(i)?(m(),_(b(D),{key:0,modelValue:b(M).closing_text,"onUpdate:modelValue":t[7]||(t[7]=e=>b(M).closing_text=e),editor:b(i),config:H},null,8,["modelValue","editor"])):k("",!0)])])])])]),f("div",Oe,[b(M).id||s.proposalId?(m(),w("div",qe,[h(u,{proposalId:b(M).id?b(M).id:s.proposalId,proposalData:b(M)},null,8,["proposalId","proposalData"])])):k("",!0)])])])),action:v((()=>[h(p,{loading:b(S),type:"submit",color:"primary",raised:""},{default:v((()=>[C(P(s.proposalId?"Update Proposal":"Create Proposal"),1)])),_:1},8,["loading"]),h(p,{loading:b(A),onClick:t[8]||(t[8]=e=>U(!0)),color:"info",raised:""},{default:v((()=>[C(P(s.proposalId?"Update & Close":"Create & Close"),1)])),_:1},8,["loading"])])),cancel:v((()=>[h(p,{onClick:t[9]||(t[9]=e=>O()),raised:""},{default:v((()=>[C("Close")])),_:1})])),_:1},8,["open"])}}}),He={class:"v-grid"},Ee=i({__name:"VGrid",props:{inline:{type:Boolean},gridTemplateColumns:{default:"none"},gridTemplateRows:{default:"none"},gridTemplateAreas:{default:"none"},columnGap:{default:"normal"},rowGap:{default:"normal"},justifyItems:{default:"initial"},alignItems:{default:"initial"},justifyContent:{default:"initial"},alignContent:{default:"initial"},placeContent:{default:"normal"},gridAutoColumns:{default:"auto"},gridAutoRows:{default:"auto"},gridAutoFlow:{default:"row"}},setup(e){const a=e;V((e=>({"36a9ff9c":b(l),"644edfcf":a.gridTemplateColumns,"13ee8f27":a.gridTemplateRows,"68f4ddf8":a.gridTemplateAreas,"3f6d0412":a.columnGap,"9b29192c":a.rowGap,"6ce21d44":a.justifyItems,"274efcee":a.alignItems,"5c2c4e97":a.justifyContent,"1a5afffc":a.alignContent,68195080:a.placeContent,d4bc820c:a.gridAutoColumns,"07161048":a.gridAutoRows,"0721119e":a.gridAutoFlow})));const l=T((()=>a.inline?"inline-grid":"grid"));return(e,a)=>(m(),w("div",He,[S(e.$slots,"default")]))}}),Le={class:"v-grid-item"},$e=i({__name:"VGridItem",props:{gridColumnStart:{default:"auto"},gridColumnEnd:{default:"auto"},gridRowStart:{default:"auto"},gridRowEnd:{default:"auto"},justifySelf:{default:"auto"},alignSelf:{default:"auto"},placeSelf:{default:"auto"}},setup(e){const a=e;return V((e=>({"639fd2f2":a.gridColumnStart,"0928fb6b":a.gridColumnEnd,"58f2dc22":a.gridRowStart,"690c909b":a.gridRowEnd,"4e453368":a.justifySelf,"3160ef46":a.alignSelf,"2e640d42":a.placeSelf}))),(e,a)=>(m(),w("div",Le,[S(e.$slots,"default")]))}}),Re={class:"columns is-multiline"},Ge={class:"column is-12"},Ze={class:"column is-12"},Be={class:"column is-12"},Fe={class:"column is-12"},Ne={class:"column is-12"},ze={class:"column is-12"},Qe=j(i({__name:"MergeProposalModal",props:{groupProposalModal:{type:Boolean,default:!1},leadID:{default:""},selectedProposals:{default:[]}},emits:["update:modalHandler","update:OnSuccess","removeProposal"],setup(a,{emit:l}){const t=a,o=r(!1),s=z(),i=J(),n=r(""),d=r([{value:"",label:""}]);r([{id:"",proposalAmount:0,title:"",approval_deadline:"",internal_notes:"",introductory_text:"",closing_text:"",payment_status:"",type:"",status:"",created_at:"",updated_at:"",job:""}]);const u=t.selectedProposals.map((e=>e.id)),c=r({title:"",type:"combined",description:"",proposals:u,trades:[],columns_to_show:[]}),g=async()=>{try{o.value=!0;const e=Y(c.value,[]),a=await s.post("/api/lead-proposal/merge-proposals/",e);n.value=a.data,i.success("Proposal grouped successfully")}catch(e){console.log(e)}finally{o.value=!1}};return p((()=>{(async()=>{try{const e=await s.get("/api/cost-trade/");d.value=e.data.map((e=>({value:e.id,label:e.name})))}catch(e){console.log(e)}})()})),(a,s)=>{const i=N,n=F,r=$e,u=Ee,p=B,y=Z,P=G,V=R,T=A("Multiselect"),S=$,j=I,O=e;return m(),_(O,{is:"form",open:t.groupProposalModal,title:"Group Proposal",size:"large",actions:"right",onSubmit:x(g,["prevent"]),onClose:s[8]||(s[8]=e=>{l("update:modalHandler",!1)})},{content:v((()=>[f("div",Re,[f("div",Ge,[h(u,null,{default:v((()=>[h(r,null,{default:v((()=>[(m(!0),w(M,null,U(t.selectedProposals,(e=>(m(),_(n,{title:e.title,white:"",class:"m-1",icon:"lnir lnir-envelope"},{default:v((()=>[h(i,{onClick:a=>(e=>{l("removeProposal",e)})(e),icon:"lucide:x"},null,8,["onClick"])])),_:2},1032,["title"])))),256))])),_:1})])),_:1})]),f("div",Ze,[h(P,{label:"Select Group Type"},{default:v((()=>[h(y,null,{default:v((()=>[h(p,{modelValue:b(c).type,"onUpdate:modelValue":s[0]||(s[0]=e=>b(c).type=e),value:"combined",label:"Combine Proposals",name:"outlined_squared_radio",color:"warning",square:""},null,8,["modelValue"]),h(p,{modelValue:b(c).type,"onUpdate:modelValue":s[1]||(s[1]=e=>b(c).type=e),value:"trade",label:"Trade Proposal",name:"outlined_squared_radio",color:"primary",square:""},null,8,["modelValue"]),h(p,{modelValue:b(c).type,"onUpdate:modelValue":s[2]||(s[2]=e=>b(c).type=e),value:"summary",label:"Summary Proposal",name:"outlined_squared_radio",color:"info",square:""},null,8,["modelValue"]),h(p,{modelValue:b(c).type,"onUpdate:modelValue":s[3]||(s[3]=e=>b(c).type=e),value:"report",label:"Report",name:"outlined_squared_radio",color:"success",square:""},null,8,["modelValue"])])),_:1})])),_:1})]),f("div",Be,[h(P,{label:"Proposal Title *"},{default:v((()=>[h(y,null,{default:v((()=>[h(V,{modelValue:b(c).title,"onUpdate:modelValue":s[4]||(s[4]=e=>b(c).title=e),placeholder:"Enter Group Proposal Title",type:"text",name:"title",required:""},null,8,["modelValue"])])),_:1})])),_:1})]),f("div",Fe,[h(P,{label:"Choose what to merge in show in group proposal"},{default:v((({id:e})=>[h(y,null,{default:v((()=>[h(T,{modelValue:b(c).columns_to_show,"onUpdate:modelValue":s[5]||(s[5]=e=>b(c).columns_to_show=e),attrs:{id:e},mode:"tags",searchable:!0,"create-tag":!0,options:b(W),placeholder:"Add columns"},null,8,["modelValue","attrs","options"])])),_:2},1024)])),_:1})]),f("div",Ne,["trade"==b(c).type?(m(),_(P,{key:0,label:"Select the trades to merge"},{default:v((({id:e})=>[h(y,null,{default:v((()=>[h(T,{modelValue:b(c).trades,"onUpdate:modelValue":s[6]||(s[6]=e=>b(c).trades=e),attrs:{id:e},mode:"tags",searchable:!0,"create-tag":!0,options:b(d),placeholder:"Select Trade"},null,8,["modelValue","attrs","options"])])),_:2},1024)])),_:1})):k("",!0)]),f("div",ze,[h(P,{label:"Proposal Title"},{default:v((()=>[h(y,null,{default:v((()=>[h(S,{modelValue:b(c).description,"onUpdate:modelValue":s[7]||(s[7]=e=>b(c).description=e),placeholder:"Enter Group Proposal Title",rows:"3",type:"text"},null,8,["modelValue"])])),_:1})])),_:1})])])])),action:v((()=>[h(j,{loading:b(o),type:"submit",color:"warning",raised:""},{default:v((()=>[C("Group Proposals")])),_:1},8,["loading"])])),_:1},8,["open","onSubmit"])}}}),[["__scopeId","data-v-1c8ac713"]]),We=e=>(D("data-v-43f758ca"),e=e(),H(),e),Je={class:"columns is-multiline"},Ye={class:"column is-12 is-flex space-between"},Ke=We((()=>f("div",null,null,-1))),Xe={class:"is-flex"},ea={class:"column is-12"},aa={class:"flex-list-wrapper flex-list-v2"},la=We((()=>f("img",{class:"light-image",src:ie,alt:""},null,-1))),ta=We((()=>f("img",{class:"dark-image",src:ne,alt:""},null,-1))),oa={class:"tab-content is-active"},sa={class:"item-name dark-inverted"},ia={class:"item-meta"},na={class:"light-text"},ra=j(i({__name:"ProposalGroupModal",props:{leadProposalListModal:{type:Boolean},leadID:{default:""}},emits:["update:modalHandler","update:OnSuccess"],setup(a,{emit:l}){const o=a,s=r([{id:"",proposalAmount:0,title:"",approval_deadline:"",internal_notes:"",introductory_text:"",closing_text:"",payment_status:"",type:"",status:"",created_at:"",updated_at:"",job:""}]),i=r("combine"),n=r(!1),d=r("active"),u=z(),c=r([]),g=r([{value:"",label:""}]),y=r(!1),x=r([]);x.value.map((e=>e.id));const V=r(""),S={picture:{label:"Proposal",grow:!0,media:!0},customer:"Type",industry:"Amount",status:"Status",team:{label:"Payment"},actions:{label:"Select",align:"end"}},j=r(!1),D=e=>{const a=x.value.findIndex((a=>a.id===e.id));-1!==a?x.value.splice(a,1):x.value.push(e)},H=T((()=>{if(V.value){const e=new RegExp(V.value,"i");return s.value.filter((a=>a.title.match(e)||a.description.match(e)))}return s.value})),E=()=>{l("update:modalHandler",!1)};return p((()=>{(async()=>{try{n.value=!0;const e=await u.get(`/api/lead-proposal/by-project/${o.leadID}/`);s.value=e.data}catch(e){console.log(e)}finally{n.value=!1}})(),(async()=>{try{const e=await u.get("/api/cost-trade/");g.value=e.data.map((e=>({value:e.id,label:e.name})))}catch(e){console.log(e)}})()})),(a,l)=>{const s=A("Multiselect"),r=Z,u=G,p=I,V=se,T=le,L=oe,$=te,R=ae,B=ee,F=Qe,N=t,z=e;return m(),_(z,{is:"form",open:o.leadProposalListModal,title:"Proposal List",size:"xl",actions:"right",onClose:E},{content:v((()=>[f("div",Je,[f("div",Ye,[Ke,f("div",Xe,["trade"==b(i)?(m(),_(u,{key:0,style:{width:"340px"}},{default:v((({id:e})=>[h(r,null,{default:v((()=>[h(s,{modelValue:b(c),"onUpdate:modelValue":l[0]||(l[0]=e=>O(c)?c.value=e:null),attrs:{id:e},mode:"tags",searchable:!0,"create-tag":!0,options:b(g),placeholder:"Select Trades"},null,8,["modelValue","attrs","options"])])),_:2},1024)])),_:1})):k("",!0),h(p,{class:"ml-2",onClick:l[1]||(l[1]=e=>y.value=!b(y)),raised:"",color:"warning",light:"",outlined:"",icon:"lnil lnil-files-alt",disabled:!b(x).length},{default:v((()=>[C(" Group Proposal ")])),_:1},8,["disabled"]),h(p,{class:"ml-2",raised:"",icon:"fas fa-envelope",color:"info",light:"",disabled:!b(x).length,outlined:"",onClick:l[2]||(l[2]=e=>{j.value=!j.value})},{default:v((()=>[C(" Send ")])),_:1},8,["disabled"])])]),f("div",ea,[f("div",aa,["active"===b(d)&&0===b(H).length?(m(),_(V,{key:0,title:"We couldn't find any matching results.",subtitle:"Too bad. Looks like we couldn't find any matching results for the\n          search terms you've entered. Please try different search terms or\n          criteria.",larger:""},{image:v((()=>[la,ta])),_:1})):k("",!0),f("div",oa,[b(H).length?(m(),_(R,{key:0,data:b(H),columns:S,rounded:""},{body:v((()=>[h(q,{name:"list",tag:"div",class:"flex-list-inner"},{default:v((()=>[(m(!0),w(M,null,U(b(H),(e=>(m(),w("div",{key:e.id,class:"flex-table-item"},[h(T,{column:{media:!0,grow:!0}},{default:v((()=>[f("div",null,[f("span",sa,P(e.title??"N/A"),1),f("span",ia,[f("span",null,P(b(K)(e.created_at)),1)])])])),_:2},1024),h(T,null,{default:v((()=>[h(L,null,{default:v((()=>[C(P(e.type),1)])),_:2},1024)])),_:2},1024),h(T,null,{default:v((()=>[f("span",na,"$"+P(e.proposalAmount),1)])),_:2},1024),h(T,null,{default:v((()=>[h(L,{rounded:""},{default:v((()=>[C(P(e.status),1)])),_:2},1024)])),_:2},1024),h(T,null,{default:v((()=>[h(L,{rounded:""},{default:v((()=>[C(P(e.status),1)])),_:2},1024)])),_:2},1024),h(T,{column:{align:"end"}},{default:v((()=>[h(r,{raw:"",subcontrol:""},{default:v((()=>[h($,{onClick:()=>{D(e)},modelValue:e.payment_status,"onUpdate:modelValue":a=>e.payment_status=a,label:"",color:"primary"},null,8,["onClick","modelValue","onUpdate:modelValue"])])),_:2},1024)])),_:2},1024)])))),128))])),_:1})])),_:1},8,["data"])):k("",!0),b(H).length>5?(m(),_(B,{key:1,"item-per-page":10,"total-items":873,"current-page":42,"max-links-displayed":7})):k("",!0)])])]),b(y)?(m(),_(F,{key:0,"group-proposal-modal":b(y),selectedProposals:b(x),onRemoveProposal:D,"onUpdate:modalHandler":l[3]||(l[3]=e=>y.value=!1)},null,8,["group-proposal-modal","selectedProposals"])):k("",!0),b(j)?(m(),_(N,{key:1,proposalSenderModal:b(j),selectedProposalsIds:b(x),"onUpdate:modalHandler":l[4]||(l[4]=e=>j.value=!1)},null,8,["proposalSenderModal","selectedProposalsIds"])):k("",!0)])])),action:v((()=>[h(p,{loading:b(n),type:"submit",color:"warning",raised:"",onClick:E},{default:v((()=>[C("Close")])),_:1},8,["loading"])])),_:1},8,["open"])}}}),[["__scopeId","data-v-43f758ca"]]),da=r([{id:"12347",title:"Electrical Wiring",cost_code:"040100",cost_type:"Material",unit_cost:20,quantity:500,unit:"meters",total_cost:1e4,price:750,markup:15,markup_type:"percentage",markup_value:1500,markup_amount:3e3,unit_price:50,tax_rate:7.5,client_price:12000.9,total_price:9e3,builder_cost:825,group_price:78987,grand_total:12325,total_markup:9874567,mark_as:"catalogue_item",description:"Electrical wiring and related materials.",internal_notes:"Include wiring for backup generator.",created_by:"user125",created_date:"2024-12-22T12:00:00Z",updated_by:"user125",updated_date:"2024-12-22T13:00:00Z",approved_by:"manager458",approval_date:"2024-12-22T18:00:00Z",status:"pending",category:"Electrical",tags:["wiring","electrical","materials"],attachments:[],visibility:{admin:!0,internal_only:!1,shared_with_client:!1},front_end_elements:{highlighted:!1,background_color:"#f0f0f0",font_color:"#000000",display_order:3,editable:!0}},{id:"56789",title:"Plumbing Fixtures",cost_code:"050200",cost_type:"Labor",unit_cost:45,quantity:200,unit:"hours",total_cost:9e3,price:1500,markup:20,markup_type:"percentage",markup_value:1800,markup_amount:3600,unit_price:75,tax_rate:8,client_price:12000.9,total_price:10800,builder_cost:950,group_price:67890,grand_total:13200,total_markup:1234567,mark_as:"custom_item",description:"Installation of plumbing fixtures.",internal_notes:"Check water pressure before installation.",created_by:"user456",created_date:"2024-11-30T09:00:00Z",updated_by:"user456",updated_date:"2024-12-01T10:00:00Z",approved_by:"manager123",approval_date:"2024-12-01T15:00:00Z",status:"approved",category:"Plumbing",tags:["plumbing","fixtures","labor"],attachments:[],visibility:{admin:!0,internal_only:!0,shared_with_client:!1},front_end_elements:{highlighted:!0,background_color:"#ffffff",font_color:"#333333",display_order:1,editable:!1}},{id:"90123",title:"HVAC Installation",cost_code:"070300",cost_type:"Service",unit_cost:75,quantity:50,unit:"units",total_cost:3750,client_price:12000.9,price:850,markup:10,markup_type:"fixed",markup_value:850,markup_amount:1700,unit_price:95,tax_rate:6.5,total_price:4200,builder_cost:1025,group_price:56789,grand_total:15500,total_markup:654321,mark_as:"service_item",description:"HVAC system installation and setup.",internal_notes:"Ensure proper duct sealing.",created_by:"user789",created_date:"2024-12-10T14:00:00Z",updated_by:"user789",updated_date:"2024-12-15T11:30:00Z",approved_by:"manager567",approval_date:"2024-12-16T09:00:00Z",status:"completed",category:"HVAC",tags:["HVAC","installation","service"],attachments:[],visibility:{admin:!0,internal_only:!1,shared_with_client:!0},front_end_elements:{highlighted:!0,background_color:"#e6e6e6",font_color:"#111111",display_order:2,editable:!0}},{id:"34567",title:"Roofing Materials",cost_code:"080500",cost_type:"Material",unit_cost:30,quantity:1e3,unit:"sheets",total_cost:3e4,client_price:12000.9,price:1200,markup:25,markup_type:"percentage",markup_value:3e3,markup_amount:7500,unit_price:90,tax_rate:9,total_price:32700,builder_cost:1125,group_price:43210,grand_total:37500,total_markup:98765,mark_as:"material_item",description:"High-quality roofing materials.",internal_notes:"Ensure weather-resistant properties.",created_by:"user321",created_date:"2024-12-05T08:00:00Z",updated_by:"user321",updated_date:"2024-12-06T12:00:00Z",approved_by:"manager789",approval_date:"2024-12-07T14:00:00Z",status:"pending",category:"Roofing",tags:["roofing","materials","construction"],attachments:[],visibility:{admin:!1,internal_only:!0,shared_with_client:!0},front_end_elements:{highlighted:!1,background_color:"#dddddd",font_color:"#444444",display_order:4,editable:!1}}]);r({CostCode:"Cost Code",Title:"Title",Unit:"Unit",Description:"Description",CostType:"Cost Type",MarkAs:"Mark As",Quantity:"Quantity",UnitCost:"Unit Cost",BuilderCost:"Builder Cost",Markup:"Markup",MarkupAmount:"Markup Amount",Status:"Status",ClientPrice:"Client Price",GroupPrice:"Group Price",TotalCost:"Total Cost",TotalMarkup:"Total Markup",Profit:"Profit",Notes:"Internal Notes",State:"State"}),r({CostCode:"cost_code",Title:"title",Unit:"unit",Description:"description",CostType:"cost_type",MarkAs:"mark_as",Quantity:"quantity",UnitCost:"unit_cost",ClientPrice:"total_price",BuilderCost:"builder_cost",Markup:"markup",Status:"status",GroupPrice:"group_amount",TotalMarkup:"total_markup",Profit:"profit",Notes:"internal_notes",MarkupAmount:"markup_amount"});const ua={class:"columns is-multiline"},pa={class:"column is-12"},ca={class:"invoice-wrapper"},ma=f("div",{class:"invoice-header"},[f("div",{class:"left"},[f("h3",null,"Proposal-ID PD-456-14")]),f("div",{class:"right"},[f("div",{class:"controls"},[f("a",{class:"action"},[f("i",{"aria-hidden":"true",class:"iconify","data-icon":"feather:printer"})]),f("a",{class:"action"},[f("i",{"aria-hidden":"true",class:"iconify","data-icon":"feather:download-cloud"})]),f("a",{class:"action"},[f("i",{"aria-hidden":"true",class:"iconify","data-icon":"feather:mail"})])])])],-1),_a={class:"invoice-body"},va={class:"invoice-card"},fa={class:"invoice-section is-flex is-bordered"},ga=f("div",{class:"meta"},null,-1),ya=f("div",{class:"end"},[f("span",null,"PO Box 242"),f("span",null,"Evergreen, CO 80437-0242"),f("span",null,"Phone: 720 272-9061"),f("span",null,"Premium Trades for Premier Builders")],-1),ba=f("div",{class:"invoice-section is-flex is-bordered"},[f("div",{class:"meta"},[f("h3",null,"Client Name"),f("span",null,"Client Phone"),f("span",null,"25724 Independence Trail Evergreen, CO 80439")]),f("div",{class:"end is-left"},[f("h3",null,"Friday Jan 17, 2025"),f("p",null," Lorem ipsum dolor sit amet, consectetur adipiscing elit. Quod equidem non reprehendo. ")])],-1),ha={key:0,class:"invoice-section"},ka={class:"responsive-table"},wa=f("br",null,null,-1),Ca=["innerHTML"],Pa={class:"invoice-section is-flex mt-0 pt-0"},xa={class:"end is-left"},Ia={class:"text-right"},Va=f("p",null,"Mentioned price are final",-1),Ta=i({__name:"ProposalViewModal",props:{previewModal:{type:Boolean},columnsToShow:{default:!1},proposalId:{default:""}},emits:["update:modalHandler","update:OnSuccess"],setup(l,{emit:t}){const o=l,s=z();a();const i=r([{name:"Website Redesign",unit:"hrs",quantity:54,rate:24},{name:"Logo Design",unit:"hrs",quantity:12,rate:24},{name:"Custom Illustrations",unit:"hrs",quantity:7,rate:32}]);T((()=>{const e=i.value.reduce(((e,a)=>e+a.quantity*a.rate),0),a=.1*e;return[{label:"Subtotal",value:e},{label:"Taxes",value:a},{label:"Total",value:e+a}]}));const n=["Item","Description","Unit Cost","Qty","Unit","Builder Cost","Markup","Total Price"];r(""),r(!0),r(!0),r(!0),r(!0);const d=T((()=>da.value.reduce(((e,a)=>e+a.price*a.quantity),0))),u=r(!1);r({id:"c897de41-609f-4a20-8d79-0537b6a873d6",title:"Test Lead's Proposal",approval_deadline:"2025-01-30",internal_notes:null,introductory_text:null,closing_text:null,payment_status:"Pending",type:"proposal",status:"pending",created_at:"2025-01-21T19:08:06.509861Z",updated_at:"2025-01-21T19:08:06.509875Z",job:"da0aa7c1-3744-4856-a637-e5a821f5ec7e"});const c=r([{id:"5e7d026a-b392-47e9-9d24-58fbc1de12c5",index:1,title:"Test Lead Proposal Item",description:"<p>Description</p>",type:"",quantity:100,unit:"Sq ft",unit_cost:"10.00",markup:"150.00",total_price:"1150.00",cost_code:"11012",cost_type:"material",builder_cost:"1000.00",margin:"1.00",profit:"0.00",internal_notes:"Internal notes",mark_as:"bid",state:"active",group_amount:"0.00",status:null,created_at:"2025-01-23T18:25:46.392750Z",proposal:"c897de41-609f-4a20-8d79-0537b6a873d6"}]),g=()=>{t("update:modalHandler",!1)},y=async()=>{try{const e=await s.get(`api/cost/by-proposal/${o.proposalId}/`);c.value=e.data}catch(e){console.log(e)}};return p((()=>{(async()=>{try{u.value=!0,await s.get(`/api/lead-proposal/${o.proposalId}/`),y()}catch(e){console.log(e)}finally{u.value=!1}})()})),(a,l)=>{const t=de,s=I,i=e;return m(),_(i,{is:"form",open:o.previewModal,title:"Cost Item ",size:"xl",actions:"right",onClose:g},{content:v((()=>[f("div",ua,[f("div",pa,[f("div",ca,[ma,f("div",_a,[f("div",va,[f("div",fa,[h(t,{size:"xl",picture:"/logos/IbexFavicon.png"}),ga,ya]),ba,b(c).length?(m(),w("div",ha,[f("table",ka,[f("thead",null,[(m(),w(M,null,U(n,((e,a)=>f("th",{key:a},P(e),1))),64))]),f("tbody",null,[(m(!0),w(M,null,U(b(c),((e,a)=>(m(),w("tr",{key:e.id},[f("td",null,[f("span",null,P(e.title),1),wa,f("span",null,P(e.cost_code),1)]),f("td",null,[f("span",{innerHTML:e.description},null,8,Ca)]),f("td",null,[f("span",null," $"+P(e.unit_cost),1)]),f("td",null,[f("span",null,P(e.quantity),1)]),f("td",null,[f("span",null,P(e.unit),1)]),f("td",null,[f("span",null," $"+P(e.builder_cost),1)]),f("td",null,[f("span",null," $"+P(e.markup),1)]),f("td",null,[f("span",null," $"+P(e.total_price),1)])])))),128))])])])):k("",!0),f("div",Pa,[f("div",xa,[f("h3",Ia,"Total Price: $"+P(b(d)),1),Va])])])])])])])])),action:v((()=>[h(s,{loading:b(u),type:"submit",color:"warning",raised:"",onClick:g},{default:v((()=>[C("Close")])),_:1},8,["loading"])])),_:1},8,["open"])}}}),Sa={onHold:"warning",open:"info",sold:"success",lost:"danger"},Aa={onHold:"On Hold",open:"Open",sold:"Sold",lost:"Lost"},Ma={pending:"info",approve:"success",review:"warning",disapprove:"danger"},Ua={pending:"Pending",approve:"Approved",review:"Require Review",disapprove:"Disapproved"},ja={proposal:"primary",change_order:"warning",draft:"light"},Oa={proposal:"Proposal",change_order:"Change Order",draft:"Draft"},qa=[{value:"call",label:"Phone Call"},{value:"email",label:"Email"},{value:"followup",label:"Follow Up"},{value:"visit",label:"Site Visit"},{value:"form",label:"Website Form"}],Da={class:"flex-toolbar is-reversed is-flex space-between my-4"},Ha={key:0},Ea={key:1,class:"flex-list-wrapper flex-list-v2"},La={class:"item-name dark-inverted"},$a={class:"item-name dark-inverted"},Ra={class:"light-text"},Ga={class:"light-text"},Za={class:"item-name dark-inverted"},Ba={class:"light-text"},Fa=["onClick"],Na=[f("div",{class:"icon"},[f("i",{"aria-hidden":"true",class:"lnil lnil-pencil"})],-1),f("div",{class:"meta"},[f("span",null,"Edit"),f("span",null,"Edit Proposal Details")],-1)],za=["onClick"],Qa=[f("div",{class:"icon"},[f("i",{"aria-hidden":"true",class:"lnil lnil-eye"})],-1),f("div",{class:"meta"},[f("span",null,"Preview"),f("span",null,"Preview proposal detail")],-1)],Wa=["onClick"],Ja=[f("div",{class:"icon"},[f("i",{class:"lnil lnil-calender-alt-1","aria-hidden":"true"})],-1),f("div",{class:"meta"},[f("span",null,"Create Tasks"),f("span",null,"Create tasks in chart ")],-1)],Ya=["onClick"],Ka=[f("div",{class:"icon"},[f("i",{"aria-hidden":"true",class:"lnil lnil-add-files"})],-1),f("div",{class:"meta"},[f("span",null,"Add Cost Item"),f("span",null,"Add a new cost item")],-1)],Xa=f("hr",{class:"dropdown-divider"},null,-1),el=["onClick"],al=[f("div",{class:"icon"},[f("i",{class:"lnir lnir-round-box-check","aria-hidden":"true"})],-1),f("div",{class:"meta"},[f("span",null,"Mark Approved"),f("span",null,"Mark Proposal As Approved")],-1)],ll=["onClick"],tl=[f("div",{class:"icon"},[f("i",{"aria-hidden":"true",class:"lnil lnil-trash-can-alt"})],-1),f("div",{class:"meta"},[f("span",null,"Delete"),f("span",null,"Delete from list")],-1)],ol=f("img",{class:"light-image",src:ie,alt:""},null,-1),sl=f("img",{class:"dark-image",src:ne,alt:""},null,-1),il=i({__name:"LeadProposalsList",props:{activeTab:{default:"active"},leadId:{default:""},allProposal:{type:Boolean,default:!1}},setup(e){const a=e,l=E();L();const t=z(),i=J(),n=r(!1),d=r([]),u=r(!1),c=r(""),x=r(!1),V=r(!1),S=r(""),A=r("");r(a.activeTab);const j=r({title:"",subtitle:"test",isSweetAlertOpen:!1,btntext:"text"}),D=r({title:"",subtitle:"",isSweetAlertOpen:!1,btntext:""}),H=async()=>{try{n.value=!0;await t.delete(`/api/lead-proposal/${A.value}/`);i.success("Proposal delete successfully"),W()}catch(e){i.error(` ${e}, Proposal`),i.error("Something went wrong please try later")}finally{n.value=!1,j.value.isSweetAlertOpen=!1}},$={picture:{label:"Proposal",grow:!0,media:!0},customer:"Created At",industry:"Type",deadline:"Deadline",status:"Status",amount:{label:"Total Amount",media:!0},actions:{label:"Actions",align:"end"}},R=T((()=>{if(S.value){const e=new RegExp(S.value,"i");return d.value.filter((a=>a.title.match(e)||a.approval_deadline.match(e)))}return d.value})),G=r(!1),B=r(!1),F=r(!1),N=r(""),Q=e=>{l.push(`/sidebar/dashboard/proposals/${e}`)},W=()=>{1==a.allProposal?(async()=>{try{n.value=!0;const e=await t.get("/api/lead-proposal/");d.value=e.data}catch(e){i.error(` ${e}, Lead`)}finally{n.value=!1}})():a.leadId&&(async()=>{try{n.value=!0;const e=await t.get(`/api/lead-proposal/by-project/${a.leadId}/`);d.value=e.data}catch(e){i.error(` ${e}, Lead`)}finally{n.value=!1}})()};return p((()=>{W()})),(e,l)=>{const r=Z,p=I,T=ce,E=le,L=oe,z=pe,J=ae,Y=se,te=ee,ie=o,ne=De,de=Ta,ue=s,me=re,_e=ra;return m(),w("div",null,[f("div",Da,[h(r,{icon:"feather:search"},{default:v((()=>[g(f("input",{"onUpdate:modelValue":l[0]||(l[0]=e=>O(S)?S.value=e:null),class:"input custom-text-filter",placeholder:"Search..."},null,512),[[y,b(S)]])])),_:1}),f("div",null,[h(p,{color:"primary",onClick:l[1]||(l[1]=e=>u.value=!b(u)),icon:"fas fa-plus"},{default:v((()=>[C("Lead Proposal ")])),_:1}),a.leadId?(m(),_(p,{key:0,color:"warning",class:"ml-2",onClick:l[2]||(l[2]=e=>{V.value=!0}),icon:"fas fa-cogs"},{default:v((()=>[C("Proposals")])),_:1})):k("",!0)])]),b(n)?(m(),w("div",Ha,[h(T)])):(m(),w("div",Ea,[b(R).length>0&&b(d).length>0?(m(),_(J,{key:0,data:b(R),columns:$,rounded:""},{body:v((()=>[h(q,{name:"list",tag:"div",class:"flex-list-inner"},{default:v((()=>[(m(!0),w(M,null,U(b(R),(e=>(m(),w("div",{key:e.id,class:"flex-table-item"},[h(E,{column:{media:!0,grow:!0},class:"cu-pointer",onClick:a=>Q(e.id)},{default:v((()=>[f("div",null,[f("span",La,P(e.title),1)])])),_:2},1032,["onClick"]),h(E,{column:{media:!0},class:"cu-pointer",onClick:a=>Q(e.id)},{default:v((()=>[f("div",null,[f("span",$a,P(b(K)(e.created_at)),1),f("span",Ra,P(b(X)(e.created_at)),1)])])),_:2},1032,["onClick"]),h(E,{class:"cu-pointer",onClick:a=>Q(e.id)},{default:v((()=>[h(L,{rounded:"",color:b(ja)[e.type]},{default:v((()=>[C(P(b(Oa)[e.type]),1)])),_:2},1032,["color"])])),_:2},1032,["onClick"]),h(E,{class:"cu-pointer",onClick:a=>Q(e.id)},{default:v((()=>[f("span",Ga,P(e.approval_deadline),1)])),_:2},1032,["onClick"]),h(E,{class:"cu-pointer",onClick:a=>Q(e.id)},{default:v((()=>[h(L,{class:"capitalized",rounded:"",color:b(Ma)[e.status]},{default:v((()=>[C(P(b(Ua)[e.status]),1)])),_:2},1032,["color"])])),_:2},1032,["onClick"]),h(E,{class:"cu-pointer",onClick:a=>Q(e.id),column:{media:!0}},{default:v((()=>[f("div",null,[f("span",Za,"$"+P(e.proposalAmount),1),f("span",Ba,P(e.payment_status),1)])])),_:2},1032,["onClick"]),h(E,{column:{align:"end"}},{default:v((()=>[h(z,{class:"is-pushed-mobile",icon:"feather:more-vertical",spaced:"",right:""},{content:v((()=>[f("a",{role:"menuitem",onClick:a=>{return l=e.id,c.value=l,void(u.value=!0);var l},class:"dropdown-item is-media"},Na,8,Fa),f("a",{disabled:"",role:"menuitem",onClick:a=>{return l=e.id,B.value=l,void(G.value=!G.value);var l},class:"dropdown-item is-media"},Qa,8,za),"approve"==e.status?(m(),w("a",{key:0,role:"menuitem",onClick:a=>{return l=e.id,c.value=l,void(x.value=!0);var l},class:"dropdown-item is-media"},Ja,8,Wa)):k("",!0),f("a",{role:"menuitem",onClick:a=>{return l=e.id,N.value=l,void(F.value=!F.value);var l},class:"dropdown-item is-media"},Ka,8,Ya),Xa,f("a",{role:"menuitem",onClick:a=>(async(e,a)=>{try{await t.patch(`/api/lead-proposal/${a}/`,{status:e}),i.success(`You have ${e} this proposal.`),W()}catch(l){console.log(l)}})("approve",e.id),class:"dropdown-item is-media"},al,8,el),f("a",{role:"menuitem",onClick:a=>{return l=e.id,A.value=l,void(j.value={title:"Delete Proposal?",subtitle:"Are you sure to delete this proposal? After delete you will not be able to recover it again.",btntext:"Yes delete",isSweetAlertOpen:!0});var l},class:"dropdown-item is-media"},tl,8,ll)])),_:2},1024)])),_:2},1024)])))),128))])),_:1})])),_:1},8,["data"])):k("",!0),b(d).length<1&&0==b(R).length?(m(),_(Y,{key:1,title:"There is no proposal created on this lead!",subtitle:"Too bad. Looks like we couldn't created any proposal on this Lead, please create proposal and release to the client",larger:""},{image:v((()=>[ol,sl])),_:1})):k("",!0),b(R).length>5?(m(),_(te,{key:2,"item-per-page":10,"total-items":873,"current-page":42,"max-links-displayed":7})):k("",!0)])),b(x)?(m(),_(ie,{key:2,createProposalTasksModal:b(x),proposalId:b(c),onCloseModalHandler:l[3]||(l[3]=e=>x.value=!1),"onUpdate:OnSuccess":W},null,8,["createProposalTasksModal","proposalId"])):k("",!0),b(u)?(m(),_(ne,{key:3,leadId:a.leadId,proposalId:b(c),leadProposalModal:b(u),"onUpdate:modalHandler":l[4]||(l[4]=e=>u.value=!1),"onUpdate:OnSuccess":W,onClearProposalId:l[5]||(l[5]=e=>c.value="")},null,8,["leadId","proposalId","leadProposalModal"])):k("",!0),b(G)?(m(),_(de,{key:4,"preview-modal":b(G),proposalId:b(B),"onUpdate:modalHandler":l[6]||(l[6]=e=>G.value=!1)},null,8,["preview-modal","proposalId"])):k("",!0),b(F)?(m(),_(ue,{key:5,costItemModal:b(F),proposalId:b(N),"onUpdate:modalHandler":l[7]||(l[7]=e=>F.value=!1),"onUpdate:OnSuccess":W},null,8,["costItemModal","proposalId"])):k("",!0),b(j).isSweetAlertOpen?(m(),_(me,{key:6,isSweetAlertOpen:b(j).isSweetAlertOpen,title:b(j).title,subtitle:b(j).subtitle,btntext:b(j).btntext,onConfirm:H,onCancel:()=>b(j).isSweetAlertOpen=!1},null,8,["isSweetAlertOpen","title","subtitle","btntext","onCancel"])):k("",!0),b(D).isSweetAlertOpen?(m(),_(me,{key:7,isSweetAlertOpen:b(D).isSweetAlertOpen,title:b(D).title,subtitle:b(D).subtitle,btntext:b(D).btntext,onConfirm:H,onCancel:()=>b(D).isSweetAlertOpen=!1},null,8,["isSweetAlertOpen","title","subtitle","btntext","onCancel"])):k("",!0),b(V)?(m(),_(_e,{key:8,leadProposalListModal:b(V),leadID:a.leadId,"group-proposal-modal":b(V),"onUpdate:modalHandler":l[8]||(l[8]=e=>V.value=!1)},null,8,["leadProposalListModal","leadID","group-proposal-modal"])):k("",!0)])}}});export{De as _,il as a,qa as b,Aa as c,Sa as g};
