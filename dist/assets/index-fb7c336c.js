import{i as e,F as s}from"./index-430b4a93.js";import{i as t}from"./index-54003611.js";import{u as a}from"./userSession-58a3ddc7.js";import{u as o}from"./useNotyf-18e668a8.js";import{u as r}from"./useAPI-f85d8e56.js";import{e as l,r as i,o as n,y as c,z as d,l as u,H as p,B as v,C as m,J as h,Q as g,R as y,P as _,L as f,s as b,A as j,D as x,E as k,G as w,v as S}from"./index-54a9a01d.js";import{u as C}from"./useThemeColors-fc123429.js";import{A as P}from"./vue3-apexcharts.common-430c5f4c.js";import{_ as D}from"./VIcon.vue_vue_type_script_setup_true_lang-49b93554.js";import{_ as T}from"./VBlock.vue_vue_type_style_index_0_lang-8508a058.js";import{_ as A}from"./VIconBox.vue_vue_type_style_index_0_lang-de4f6469.js";import{u as I,a as B}from"./progressChart-4e987439.js";import{b as L}from"./useSupportElement-d4e5428a.js";import{u as $}from"./viewWrapper-b565bc40.js";import"./notyf-85dfaa3b.js";import"./vue.runtime.esm-bundler-6cbae649.js";import"./billboard-5857d5e1.js";const V={style:{display:"flex","border-radius":"6px","flex-wrap":"wrap","align-items":"center","justify-content":"space-between"}},W={onClick:()=>{},style:{"font-weight":"500","margin-bottom":"0px","padding-left":"10px"}},E={class:"avatars"},F=["src"],M={key:1,style:{width:"100%",height:"100%","background-color":"#292f3c",display:"flex","align-items":"center","justify-content":"center"}},z={class:"mb-0",style:{color:"white"}},H=f(l({__name:"ProjectsDashboardCalendar",setup(l){const f=r(),b=a(),j=o(),x=i(!1),k=i(!1),w=i("");i(!1),i("all"),i(""),i([]),i([]);const S=i([]),C=i({pending:"#8392ab",active:"#fbcf33",completed:"#82d616",canceled:"#344767"}),P=i({plugins:[e,t],schedulerLicenseKey:"0965592368-fcs-1694657447",initialView:"resourceTimelineMonth",height:"auto",resourceAreaWidth:"20%",selectable:!0,headerToolbar:{left:"today prev,next",center:"title",right:"resourceTimelineWeek,resourceTimelineMonth,resourceTimelineYear"},editable:!0,views:{resourceTimelineWeek:{slotDuration:{days:1,hours:1},slotLabelFormat:{weekday:"short",month:"numeric",day:"numeric",year:"numeric"}}},resourceAreaHeaderContent:"Projects",resources:[],eventClick:e=>{"manager"!==b.user.role||e.event.extendedProps.managers.some((e=>e.id===b.user.id))?(k.value=!0,w.value=e.event.id):j.success("You are not allowed to perform this action.")},eventDrop:e=>{let s=e.event.startStr,t=e.event.end.toISOString().substring(0,10);console.log("resource ids",e.event._def.resourceIds[0]),console.log(e.event.extendedProps.project),e.event.extendedProps.project===e.event._def.resourceIds[0]&&confirm(`Are you sure you want to update the project ${e.event.title} date from ${s} to ${t}?`)?T(e.event.id,s,t):e.revert()},eventResize:e=>{let s=e.event.startStr,t=e.event.end.toISOString().substring(0,10);console.log(e.event),confirm(`Are you sure you want to update the project ${e.event.title} date from ${s} to ${t}?`)?T(e.event.id,s,t):e.revert()}}),D=e=>{let s=new Date(e);return s.setDate(s.getDate()+1),s.toISOString().slice(0,10)},T=async(e,s,t)=>{try{let a=await f.patch(`/api/project/${e}/`,{startDate:s,endDate:t});console.log(a),j.success("Project updated successfully")}catch(a){j.error("Something went wrong"),console.log(a)}};return n((async()=>{await(async()=>{try{x.value=!0,console.log("inside all projects func");const e=await f.get("/api/project/",{});S.value=e.data,console.log("scratch projects",S.value),x.value=!1}catch(e){console.error(e),S.value=[],x.value=!1}})(),(()=>{console.log(S.value);const e=S.value.map((e=>({id:e.id,resourceId:e.id,project:e.id,start:e.startDate,end:D(e.endDate),title:e.title,description:e.description,total_tasks:e.total_tasks,managers:e.managers,borderColor:C[e.status]})));P.value.resources=S.value,P.value.events=e})(),console.log("projects",P.value)})),(e,t)=>(c(),d("div",null,[u(x)?_("",!0):(c(),p(u(s),{key:0,options:u(P)},{eventContent:v((e=>[m("div",V,[m("div",null,[m("span",W,h(e.event.title),1),m("span",null," -- tasks ("+h(e.event.extendedProps.total_tasks)+")",1)]),m("div",E,[(c(!0),d(g,null,y(e.event.extendedProps.managers,(e=>(c(),d("div",{class:"avatars__item",key:e.id},[e.avatar?(c(),d("img",{key:0,src:e.avatar,alt:""},null,8,F)):(c(),d("div",M,[m("h6",z,h(e.username?e.username.slice(0,2):"AA"),1)]))])))),128))])])])),_:1},8,["options"]))]))}}),[["__scopeId","data-v-c895d0c3"]]),O={class:"dashboard-card"},R=m("div",{class:"card-head"},[m("h3",{class:"dark-inverted"},"Task Completion"),m("a",{class:"action-link",tabindex:"0"},"Reports")],-1),Y=l({__name:"DashbaordTasksChart",setup(e){const s=r(),t=i(!1),a=C(),o=b({series:[],chart:{height:295,type:"area",toolbar:{show:!1}},colors:[a.accent,a.info,a.primary],legend:{position:"top"},dataLabels:{enabled:!1},stroke:{width:[2,3,5],curve:"smooth"},xaxis:{type:"date",categories:[]},tooltip:{x:{format:"dd/MM/yy HH:mm"}}});return n((()=>{(async()=>{try{t.value=!0;const e=(await s.get("/api/task/dashboard-analaytics/")).data;o.value.series=e.series,o.value.xaxis.categories=e.dates}catch(e){console.error(e)}finally{t.value=!1}})()})),(e,s)=>(c(),d("div",O,[R,u(t)?_("",!0):(c(),p(u(P),{key:0,id:"completion-chart",height:u(o).chart.height,type:u(o).chart.type,series:u(o).series,options:u(o)},null,8,["height","type","series","options"]))]))}}),J={class:"dashboard-card"},N=m("div",{class:"card-head"},[m("h3",{class:"dark-inverted"},"Task Completion"),m("a",{class:"action-link",tabindex:"0"},"Reports")],-1),G=l({__name:"DashBoardTasksPie",setup(e){const s=r(),t=i(!1),a=C(),o=b({height:295,type:"pie",series:[],colors:[a.accent,a.info,a.primary,a.purple,a.orange],labels:[],responsive:[{breakpoint:480,options:{chart:{width:315,toolbar:{show:!1}},legend:{position:"top"}}}],legend:{position:"right",horizontalAlign:"center"}});return n((()=>{(async()=>{try{t.value=!0;const e=(await s.get("/api/task/dashboard-analaytics/")).data.series;o.value.labels=e.map((e=>e.name)),console.log("chart",o.value.labels),o.value.series=e.map((e=>e.data.reduce(((e,s)=>e+s),0)))}catch(e){console.error(e)}finally{t.value=!1}})()})),(e,s)=>(c(),d("div",J,[N,u(t)?_("",!0):(c(),p(u(P),{key:0,id:"completion-chart",height:u(o).height,type:u(o).type,series:u(o).series,options:u(o)},null,8,["height","type","series","options"]))]))}}),K={class:"dashboard-card"},Q=m("div",{class:"card-head"},[m("h3",{class:"dark-inverted"},"Projects Stats")],-1),U=l({__name:"ProjectsStatsChart",setup(e){const s=r(),t=i(!1),a=C(),o=i({series:[{name:"Projects",data:[]}],height:280,type:"bar",options:{chart:{toolbar:{show:!0}},plotOptions:{bar:{dataLabels:{position:"top"}}},dataLabels:{enabled:!0,offsetY:-20,style:{fontSize:"12px",colors:["#304758"]}},xaxis:{categories:[],position:"bottom",axisBorder:{show:!1},axisTicks:{show:!1},crosshairs:{fill:{type:"gradient",gradient:{colorFrom:"#D8E3F0",colorTo:"#BED1E6",stops:[0,100],opacityFrom:.4,opacityTo:.5}}},tooltip:{enabled:!0}},yaxis:{axisBorder:{show:!1},axisTicks:{show:!1},labels:{show:!1}},colors:[a.primary,a.secondary,a.orange],title:{text:"",align:"left"}}});return n((()=>{(async()=>{try{t.value=!0;const e=(await s.get("/api/project/project-analaytics/")).data;o.value.series[0].data=e.count,o.value.options.xaxis.categories=e.months}catch(e){console.error(e)}finally{t.value=!1}})()})),(e,s)=>(c(),d("div",K,[Q,u(t)?_("",!0):(c(),p(u(P),{key:0,height:u(o).height,type:u(o).type,series:u(o).series,options:u(o).options},null,8,["height","type","series","options"]))]))}}),q={class:"personal-dashboard personal-dashboard-v3"},X={class:"columns is-multiline"},Z={class:"column is-12"},ee={class:"columns is-multiline is-flex-tablet-p"},se={class:"column is-12"},te={class:"stats-wrapper"},ae={class:"columns is-multiline is-flex-tablet-p"},oe={class:"column is-3"},re={class:"dashboard-card"},le=m("i",{class:"fas fa-cubes","aria-hidden":"true"},null,-1),ie={class:"column is-3"},ne={class:"dashboard-card"},ce=m("i",{class:"fas fa-boxes","aria-hidden":"true"},null,-1),de={class:"column is-3"},ue={class:"dashboard-card"},pe=m("i",{class:"fas fa-border-style","aria-hidden":"true"},null,-1),ve={class:"column is-3"},me={class:"dashboard-card"},he=m("i",{class:"fas fa-dice-d6","aria-hidden":"true"},null,-1),ge={class:"column is-3"},ye={class:"dashboard-card"},_e=m("i",{class:"fas fa-hospital-user","aria-hidden":"true"},null,-1),fe={class:"column is-3"},be={class:"dashboard-card"},je=m("i",{class:"fas fa-users","aria-hidden":"true"},null,-1),xe={class:"column is-3"},ke={class:"dashboard-card"},we=m("i",{class:"fas fa-user-tag","aria-hidden":"true"},null,-1),Se={class:"column is-3"},Ce={class:"dashboard-card"},Pe=m("i",{class:"fas fa-user-tie","aria-hidden":"true"},null,-1),De={class:"columns is-multiline"},Te={class:"column is-8"},Ae={class:"column is-4"},Ie={class:"column is-12"},Be={class:"column is-12"},Le=l({__name:"IbexDashboard",setup(e){I(),B();const s=r();C();const t=i(!1),a=i({all_project:0,active_projects:0,pending_projects:0,completed_projects:0,workers:0,managers:0,last_mail_sent:"",clients:0,contractors:0}),o=async()=>{try{t.value=!0;const e=await s.get("/api/project/dashboard/",{});a.value=e.data,t.value=!1}catch(e){console.log(e)}finally{t.value=!1}},l=()=>{try{t.value=!0;const e=s.post("/api/task/worker-mail/",{worker:"all"});console.log(e),o(),t.value=!1}catch(e){console.log(e)}};return n((()=>{o()})),(e,s)=>{const o=A,r=T,i=D,n=k,p=U,h=G,g=Y,y=H;return c(),d("div",q,[m("div",X,[m("div",Z,[m("div",ee,[m("div",se,[m("div",te,[m("div",ae,[m("div",oe,[m("div",re,[j(r,{title:a.value?.all_project?a.value.all_project:"0",subtitle:"All Projects",center:""},{icon:v((()=>[j(o,{color:"info",rounded:""},{default:v((()=>[le])),_:1})])),_:1},8,["title"])])]),m("div",ie,[m("div",ne,[j(r,{title:a.value?.active_projects?a.value?.active_projects:"0",subtitle:"Active Projects",center:""},{icon:v((()=>[j(o,{color:"blue",rounded:""},{default:v((()=>[ce])),_:1})])),_:1},8,["title"])])]),m("div",de,[m("div",ue,[j(r,{title:a.value?.pending_projects?a.value?.pending_projects:"0",subtitle:"Pre Construction",center:""},{icon:v((()=>[j(o,{color:"pink",rounded:""},{default:v((()=>[pe])),_:1})])),_:1},8,["title"])])]),m("div",ve,[m("div",me,[j(r,{title:a.value?.completed_projects?a.value?.completed_projects:"0",subtitle:"Completed",center:""},{icon:v((()=>[j(o,{color:"green",rounded:""},{default:v((()=>[he])),_:1})])),_:1},8,["title"])])]),m("div",ge,[m("div",ye,[j(r,{title:a.value?.managers?a.value?.managers:"0",subtitle:"Managers",center:""},{icon:v((()=>[j(o,{color:"yellow",rounded:""},{default:v((()=>[_e])),_:1})])),_:1},8,["title"])])]),m("div",fe,[m("div",be,[j(r,{title:a.value?.workers?a.value?.workers:"0",subtitle:"Workers",center:""},{icon:v((()=>[j(o,{color:"lime",rounded:""},{default:v((()=>[je])),_:1})])),_:1},8,["title"])])]),m("div",xe,[m("div",ke,[j(r,{title:a.value?.contractors?a.value?.contractors:"0",subtitle:"Contractors",center:""},{icon:v((()=>[j(o,{color:"orange",rounded:""},{default:v((()=>[we])),_:1})])),_:1},8,["title"])])]),m("div",Se,[m("div",Ce,[j(r,{title:a.value?.clients?a.value?.clients:"0",subtitle:"Clients",center:""},{icon:v((()=>[j(o,{color:"blue",rounded:""},{default:v((()=>[Pe])),_:1})])),_:1},8,["title"])])])]),j(r,{title:"Last Schedule Sent",subtitle:a.value.last_mail_sent?u(L)(a.value.last_mail_sent):"N/A"},{icon:v((()=>[j(o,{color:"success",rounded:""},{default:v((()=>[j(i,{icon:"lucide:clock"})])),_:1})])),action:v((()=>[j(n,{onClick:l,color:"warning",rounded:"",loading:t.value,elevated:""},{default:v((()=>[x(" Send Schedule ")])),_:1},8,["loading"])])),_:1},8,["subtitle"])])])])])]),m("div",De,[m("div",Te,[j(p)]),m("div",Ae,[j(h)]),m("div",Ie,[j(g)]),m("div",Be,[j(y)])])])}}}),$e={class:"page-content-inner"},Ve=l({__name:"index",setup(e){w();return $().setPageTitle("Ibex Builders Studios"),S((()=>({title:"Ibex Builders Studios"}))),(e,s)=>{const t=Le;return c(),d("div",$e,[j(t)])}}});export{Ve as default};
