import{_ as e}from"./VModal.vue_vue_type_style_index_0_lang-7c403184.js";import{e as t,x as s,r as a,o as r,B as o,C as n,D as l,E as i,F as u,T as c,l as d,N as p,J as v,U as m,V as y,M as f,O as g,z as k}from"./index-fd0ff1bc.js";import{F as w}from"./FullCalendar-4d608af6.js";import{i as h}from"./index-f52ed8ce.js";import{u as j}from"./useAPI-4bb46aa3.js";import{u as _}from"./useNotyf-70dc65ec.js";import{u as x}from"./userSession-71b1c148.js";import{u as C}from"./viewWrapper-7df9e515.js";import"./notyf-14362462.js";import"./useThemeColors-129035d3.js";const b={class:"lifestyle-dashboard lifestyle-dashboard-v3"},T={class:"columns is-multiline"},D={class:"column is-12"},A={style:{display:"flex","flex-wrap":"wrap","align-items":"center","justify-content":"space-between"}},N=["onClick"],W={style:{"margin-top":"8px","padding-right":"10px"}},M=t({__name:"WorkerCalendar",setup(t){const k=x(),C=_(),M=j();s();const S=a(!1);a({});const F=a([]),I=a({id:"",password:"",last_login:null,date_joined:"",email:"",role:"",avatar:"",is_active:!0,phoneNumber:"",username:"",is_sentMail:!1});a(!1),a("all"),a("");const P=a(!1),V=a([]),$=a([]),B=a([]),L=a([]),R=a({pending:"#fbcf33",active:"#82d616",completed:"#cb0c9f",canceled:"#344767"}),U=a({plugins:[h],schedulerLicenseKey:"0965592368-fcs-1694657447",initialView:"resourceTimelineMonth",height:"auto",resourceAreaWidth:"20%",selectable:!0,events:[],headerToolbar:{left:"today prev,next",center:"title",right:"resourceTimelineWeek,resourceTimelineMonth,resourceTimelineYear"},editable:!0,views:{resourceTimelineWeek:{slotDuration:{days:1,hours:1},slotLabelFormat:{weekday:"short",month:"numeric",day:"numeric",year:"numeric"}}},resourceAreaHeaderContent:"Projects",resources:[]}),Y=a({}),q=a({});return r((async()=>{await(async()=>{try{P.value=!0;const e=await M.get(`/api/users/${k.user.id}`);I.value=e.data,P.value=!1}catch(e){console.log(e)}})(),await(async()=>{try{const e=await M.get(`/api/task/${k.user.id}/worker-tasks/`);V.value=e.data,console.log("worker tasks",V.value)}catch(e){V.value=[]}})(),(async(e=!1)=>{try{const t=await M.get(`/api/task/worker-today/${k.user.id}/`);q.value=t.data,e&&C.green("Tasks list Refreshed")}catch(t){console.log(t)}})(),F.value=V.value.map((e=>({id:e.id,resourceId:e.project.id,start:e.startDate,end:e.endDate,title:e.title,color:e.color,description:e.description,workers:e.workers,borderColor:R[e.status],status:e.status,unit:e.unit,note:e.note}))),L.value=V.value.map((e=>({id:e.project.id,start:e.project.startDate,end:e.project.endDate,title:e.project.title,address:e.project.address,status:e.project.status,color:R[e.project.status]}))),$.value=L.value,B.value=F.value,U.value={...U.value,resources:$.value,events:B.value},console.log("tasks",U.value.events,"resources",U.value.resources)})),(t,s)=>{const a=g,r=e;return o(),n(m,null,[l("div",b,[l("div",T,[l("div",D,[i(d(w),{options:d(U)},{eventContent:u((e=>[l("div",A,[l("p",{onClick:t=>{return s=e.event.extendedProps,console.log("detail",s),Y.value=s,void(S.value=!0);var s},style:{"font-weight":"600","margin-bottom":"0px","padding-left":"10px"}},c(e.event.title),9,N),l("div",null,[l("p",W,c(new Date(e.event.start).toDateString())+" to "+c(new Date(e.event.end).toDateString()),1)])])])),_:1},8,["options"])])])]),d(S)?(o(),p(r,{key:0,open:d(S),title:"Task Info",actions:"center",onClose:s[1]||(s[1]=e=>S.value=!1)},{content:u((()=>[l("p",null,[v(" Workers:"),d(Y).workers.length?(o(!0),n(m,{key:0},y(d(Y).workers,(e=>(o(),n("span",null,c(e.username),1)))),256)):f("",!0)]),l("p",null," Description :"+c(d(Y).description?d(Y).description:"N/A"),1),l("p",null,"Unit :"+c(d(Y).unit?d(Y).unit:"N/A"),1),l("p",null,"Status :"+c(d(Y).status?d(Y).status:"N/A"),1),l("p",null,"Note :"+c(d(Y).note?d(Y).note:"N/A"),1)])),action:u((()=>[i(a,{style:{display:"none"},color:"primary",raised:""},{default:u((()=>[v(" Confirm ")])),_:1})])),cancel:u((()=>[i(a,{onClick:s[0]||(s[0]=e=>S.value=!1),raised:""},{default:u((()=>[v(" Close ")])),_:1})])),_:1},8,["open"])):f("",!0)],64)}}}),S={class:""},F=t({__name:"calendar",setup:e=>(C().setPageTitle("Calendar View"),k({title:"Tasks Calendar- Ibex"}),(e,t)=>{const s=M;return o(),n("div",S,[i(s)])})});export{F as default};
