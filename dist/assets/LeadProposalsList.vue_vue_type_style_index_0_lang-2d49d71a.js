import{_ as e,b as a,c as l,e as t,f as s,g as o,a as i}from"./estimatesScripts-d8f66174.js";import{_ as r}from"./SweetAlert.vue_vue_type_style_index_0_lang-77a5b8b5.js";import{_ as n,a as d}from"./CreateProposalTasksModal-d6f84737.js";import{_ as p}from"./VFlexPagination.vue_vue_type_script_setup_true_lang-af0d8306.js";import{_ as u}from"./VPlaceholderPage.vue_vue_type_style_index_0_lang-cff9fb0c.js";import{_ as c,c as m}from"./VFlexTable.vue_vue_type_style_index_0_lang-1dd22f7e.js";import{_ as v}from"./VDropdown.vue_vue_type_style_index_0_lang-0868859d.js";import{_}from"./VTag.vue_vue_type_style_index_0_lang-49128f21.js";import{_ as f}from"./PlaceloadV1.vue_vue_type_style_index_0_lang-5edd70d0.js";import{e as y,v as k,x as g,r as h,Z as b,o as w,B as C,C as x,D as P,E as A,F as S,K as I,W as O,l as j,j as M,J as T,N as U,M as $,U as L,V,aR as D,O as E,T as H}from"./index-797f323c.js";import{_ as F}from"./VControl-bbf92ffd.js";import{_ as N,a as z}from"./search-4-dark-2b5b440c.js";import{u as B}from"./useAPI-b2b28f22.js";import{u as J}from"./useNotyf-b138f887.js";import{f as R}from"./useSupportElement-012e6b86.js";const Y={class:"flex-toolbar is-reversed is-flex space-between my-4"},K={key:0},W={key:1,class:"flex-list-wrapper flex-list-v2"},Z={class:"item-name dark-inverted"},q={class:"item-meta"},G=P("i",{"aria-hidden":"true",class:"iconify","data-icon":"feather:clock"},null,-1),Q={class:"item-name dark-inverted"},X={class:"light-text"},ee=["onClick"],ae=[P("div",{class:"icon"},[P("i",{"aria-hidden":"true",class:"lnil lnil-pencil"})],-1),P("div",{class:"meta"},[P("span",null,"Edit"),P("span",null,"Edit Proposal Details")],-1)],le=["onClick"],te=[P("div",{class:"icon"},[P("i",{"aria-hidden":"true",class:"lnil lnil-eye"})],-1),P("div",{class:"meta"},[P("span",null,"Preview"),P("span",null,"Preview proposal detail")],-1)],se=P("hr",{class:"dropdown-divider"},null,-1),oe=["onClick"],ie=[P("div",{class:"icon"},[P("i",{class:"lnir lnir-round-box-check","aria-hidden":"true"})],-1),P("div",{class:"meta"},[P("span",null,"Mark Approved"),P("span",null,"Mark Proposal As Approved")],-1)],re=["onClick"],ne=[P("div",{class:"icon"},[P("i",{"aria-hidden":"true",class:"lnil lnil-trash-can-alt"})],-1),P("div",{class:"meta"},[P("span",null,"Delete"),P("span",null,"Delete from list")],-1)],de=P("img",{class:"light-image",src:N,alt:""},null,-1),pe=P("img",{class:"dark-image",src:z,alt:""},null,-1),ue=y({__name:"LeadProposalsList",props:{activeTab:{default:"active"},leadId:{default:""},allProposal:{type:Boolean,default:!1}},setup(y){const N=y,z=k();g();const ue=B(),ce=J(),me=h(!1),ve=h([]),_e=h(!1),fe=h(""),ye=h(!1),ke=h(!1),ge=h(""),he=h("");h(N.activeTab);const be=h({title:"",subtitle:"test",isSweetAlertOpen:!1,btntext:"text"}),we=h({title:"",subtitle:"",isSweetAlertOpen:!1,btntext:""}),Ce=async()=>{try{me.value=!0;await ue.delete(`/api/lead-proposal/${he.value}/`);ce.success("Proposal delete successfully"),Me()}catch(e){ce.error(` ${e}, Proposal`),ce.error("Something went wrong please try later")}finally{me.value=!1,be.value.isSweetAlertOpen=!1}},xe={picture:{label:"Proposal",grow:!0,media:!0},industry:"Type",status:"Status",amount:{label:"Total Amount",media:!0},customer:"Calendar Tasks ",actions:{label:"Actions",align:"end"}},Pe=b((()=>{if(ge.value){const e=new RegExp(ge.value,"i");return ve.value.filter((a=>a.title.match(e)||a.approval_deadline.match(e)))}return ve.value})),Ae=h(!1),Se=h(!1),Ie=h(!1),Oe=h(""),je=e=>{z.push(`/sidebar/dashboard/proposals/${e}`)},Me=()=>{1==N.allProposal?(async()=>{try{me.value=!0;const e=await ue.get("/api/lead-proposal/");ve.value=e.data}catch(e){ce.error(` ${e}, Lead`)}finally{me.value=!1}})():N.leadId&&(async()=>{try{me.value=!0;const e=await ue.get(`/api/lead-proposal/by-project/${N.leadId}/`);ve.value=e.data}catch(e){ce.error(` ${e}, Lead`)}finally{me.value=!1}})()};return w((()=>{Me()})),(y,k)=>{const g=F,h=E,b=f,w=m,z=_,B=v,J=c,Te=u,Ue=p,$e=n,Le=e,Ve=a,De=d,Ee=r,He=l;return C(),x("div",null,[P("div",Y,[A(g,{icon:"feather:search"},{default:S((()=>[I(P("input",{"onUpdate:modelValue":k[0]||(k[0]=e=>M(ge)?ge.value=e:null),class:"input custom-text-filter",placeholder:"Search..."},null,512),[[O,j(ge)]])])),_:1}),P("div",null,[A(h,{color:"primary",onClick:k[1]||(k[1]=e=>_e.value=!j(_e)),icon:"fas fa-plus"},{default:S((()=>[T("Lead Proposal ")])),_:1}),N.leadId?(C(),U(h,{key:0,color:"warning",class:"ml-2",onClick:k[2]||(k[2]=e=>{ke.value=!0}),icon:"fas fa-cogs"},{default:S((()=>[T("Proposals")])),_:1})):$("",!0)])]),j(me)?(C(),x("div",K,[A(b)])):(C(),x("div",W,[j(Pe).length>0&&j(ve).length>0?(C(),U(J,{key:0,data:j(Pe),columns:xe,rounded:""},{body:S((()=>[A(D,{name:"list",tag:"div",class:"flex-list-inner"},{default:S((()=>[(C(!0),x(L,null,V(j(Pe),(e=>(C(),x("div",{key:e.id,class:"flex-table-item"},[A(w,{column:{media:!0,grow:!0},class:"cu-pointer",onClick:a=>je(e.id)},{default:S((()=>[P("div",null,[P("span",Z,H(e.title),1),P("span",q,[P("span",null,[G,T(H(j(R)(e.created_at)),1)])])])])),_:2},1032,["onClick"]),A(w,{class:"cu-pointer",onClick:a=>je(e.id)},{default:S((()=>[A(z,{rounded:"",color:j(t)[e.type]},{default:S((()=>[T(H(j(s)[e.type]),1)])),_:2},1032,["color"])])),_:2},1032,["onClick"]),A(w,{class:"cu-pointer",onClick:a=>je(e.id)},{default:S((()=>[A(z,{class:"capitalized",rounded:"",color:j(o)[e.status]},{default:S((()=>[T(H(j(i)[e.status]),1)])),_:2},1032,["color"])])),_:2},1032,["onClick"]),A(w,{class:"cu-pointer",onClick:a=>je(e.id),column:{media:!0}},{default:S((()=>[P("div",null,[P("span",Q,"$"+H(e.proposalAmount),1),P("span",X,H(e.payment_status),1)])])),_:2},1032,["onClick"]),A(w,{class:"cu-pointer",onClick:a=>je(e.id)},{default:S((()=>[A(z,{color:"purple",outlined:""},{default:S((()=>[T(H(e.is_task_created?"Created":"Not Created"),1)])),_:2},1024)])),_:2},1032,["onClick"]),A(w,{column:{align:"end"}},{default:S((()=>[A(B,{class:"is-pushed-mobile",icon:"feather:more-vertical",spaced:"",right:""},{content:S((()=>[P("a",{role:"menuitem",onClick:a=>{return l=e.id,fe.value=l,void(_e.value=!0);var l},class:"dropdown-item is-media"},ae,8,ee),P("a",{disabled:"",role:"menuitem",onClick:a=>{return l=e.id,Se.value=l,void(Ae.value=!Ae.value);var l},class:"dropdown-item is-media"},te,8,le),se,P("a",{role:"menuitem",onClick:a=>(async(e,a)=>{try{await ue.patch(`/api/lead-proposal/${a}/`,{status:e}),ce.success(`You have ${e} this proposal.`),Me()}catch(l){console.log(l)}})("approved",e.id),class:"dropdown-item is-media"},ie,8,oe),P("a",{role:"menuitem",onClick:a=>{return l=e.id,he.value=l,void(be.value={title:"Delete Proposal?",subtitle:"Are you sure to delete this proposal? After delete you will not be able to recover it again.",btntext:"Yes delete",isSweetAlertOpen:!0});var l},class:"dropdown-item is-media"},ne,8,re)])),_:2},1024)])),_:2},1024)])))),128))])),_:1})])),_:1},8,["data"])):$("",!0),j(ve).length<1&&0==j(Pe).length?(C(),U(Te,{key:1,title:"There is no proposal created on this lead!",subtitle:"Too bad. Looks like we couldn't created any proposal on this Lead, please create proposal and release to the client",larger:""},{image:S((()=>[de,pe])),_:1})):$("",!0),j(Pe).length>5?(C(),U(Ue,{key:2,"item-per-page":10,"total-items":873,"current-page":42,"max-links-displayed":7})):$("",!0)])),j(ye)?(C(),U($e,{key:2,createProposalTasksModal:j(ye),proposalId:j(fe),onCloseModalHandler:k[3]||(k[3]=e=>ye.value=!1),"onUpdate:OnSuccess":Me},null,8,["createProposalTasksModal","proposalId"])):$("",!0),j(_e)?(C(),U(Le,{key:3,leadId:N.leadId,proposalId:j(fe),leadProposalModal:j(_e),"onUpdate:modalHandler":k[4]||(k[4]=e=>_e.value=!1),"onUpdate:OnSuccess":Me,onClearProposalId:k[5]||(k[5]=e=>fe.value="")},null,8,["leadId","proposalId","leadProposalModal"])):$("",!0),j(Ae)?(C(),U(Ve,{key:4,"preview-modal":j(Ae),proposalId:j(Se),"onUpdate:modalHandler":k[6]||(k[6]=e=>Ae.value=!1)},null,8,["preview-modal","proposalId"])):$("",!0),j(Ie)?(C(),U(De,{key:5,costItemModal:j(Ie),proposalId:j(Oe),"onUpdate:modalHandler":k[7]||(k[7]=e=>Ie.value=!1),"onUpdate:OnSuccess":Me},null,8,["costItemModal","proposalId"])):$("",!0),j(be).isSweetAlertOpen?(C(),U(Ee,{key:6,isSweetAlertOpen:j(be).isSweetAlertOpen,title:j(be).title,subtitle:j(be).subtitle,btntext:j(be).btntext,onConfirm:Ce,onCancel:()=>j(be).isSweetAlertOpen=!1},null,8,["isSweetAlertOpen","title","subtitle","btntext","onCancel"])):$("",!0),j(we).isSweetAlertOpen?(C(),U(Ee,{key:7,isSweetAlertOpen:j(we).isSweetAlertOpen,title:j(we).title,subtitle:j(we).subtitle,btntext:j(we).btntext,onConfirm:Ce,onCancel:()=>j(we).isSweetAlertOpen=!1},null,8,["isSweetAlertOpen","title","subtitle","btntext","onCancel"])):$("",!0),j(ke)?(C(),U(He,{key:8,leadProposalListModal:j(ke),leadID:N.leadId,"group-proposal-modal":j(ke),"onUpdate:modalHandler":k[8]||(k[8]=e=>ke.value=!1)},null,8,["leadProposalListModal","leadID","group-proposal-modal"])):$("",!0)])}}});export{ue as _};
