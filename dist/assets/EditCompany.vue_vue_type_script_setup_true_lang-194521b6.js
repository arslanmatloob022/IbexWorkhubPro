import{_ as e}from"./VModal.vue_vue_type_style_index_0_lang-411fffd3.js";import{f as a,r as l,o as s,C as n,O as o,G as t,E as i,L as u,m as r,X as d,F as m,D as p,N as c,H as y,J as g,k as v,K as f,P as b}from"./index-e4314370.js";import{_ as C}from"./V-Snack.vue_vue_type_style_index_0_lang-ba83c709.js";import{_ as h}from"./VField.vue_vue_type_script_setup_true_lang-72b4d114.js";import{_}from"./VAvatar.vue_vue_type_style_index_0_lang-0dd8a172.js";import{_ as N}from"./VIconButton-a5460ff7.js";import{u as A}from"./useAPI-1e83a242.js";import{u as R}from"./useNotyf-efc5ad4e.js";import{m as U}from"./upload-3-b9fba75d.js";import{u as S}from"./company-290258e1.js";const V={class:"modal-form columns cu-all-input cus-scrollbary is-multiline"},L={class:"field column is-6 mb-0"},x=i("label",null,"Company Name: *",-1),E={class:"control"},j={class:"field column is-6 mb-0"},B=i("label",null,"Site URL: ",-1),P={class:"control"},w={class:"field column is-6 mb-0"},k=i("label",null,"Business Address: ",-1),O={class:"control"},I={class:"field column is-6 mb-0"},M=i("label",null,"Post Code: ",-1),F={class:"control"},K={class:"field column is-6 mb-0"},q=i("label",null,"Country: ",-1),z={class:"control"},D={class:"field column is-6 mb-0"},H=i("label",null,"State: ",-1),J={class:"control"},T={class:"field column is-6 mb-0"},Y=i("label",null,"Year Business Started: ",-1),$={class:"control"},G={class:"field column is-6 mb-0"},W=i("label",null,"Company Phone Number: ",-1),X={class:"control"},Q={class:"field column is-6 mb-0"},Z=i("label",null,"Company Email Address: ",-1),ee={class:"control"},ae={class:"field column is-6 mb-0"},le=i("label",null,"Company Registration Number: ",-1),se={class:"control"},ne={class:"field column is-6 mb-0"},oe=i("label",null,"Company Registered Name: ",-1),te={class:"control"},ie={class:"column is-12"},ue={class:"columns mb-0"},re=i("label",null,"Company Logo:",-1),de={class:"control"},me=["src"],pe={key:1},ce=i("i",{class:"iconify","data-icon":"feather:plus"},null,-1),ye=["src"],ge=a({__name:"EditCompany",props:{EditCompanyModalOpen:{type:Boolean,default:!1},id:{type:Number,default:0}},emits:["update:handleUpdateEditCompanyModalOpen","update:getAllCompanies"],setup(a,{emit:ge}){const ve=a,fe=S(),be=l(!1),Ce=l(!1),he=l(""),_e=R(),Ne=A(),Ae=l([]),Re=l(!1),Ue=l(!1),Se=l("update"),Ve=l([]),Le=l({companyName:"",industry:"",siteURL:"",businessAddress:"",postCode:"",country:"",state:"",yearBusinessStarted:"",companyPhoneNumber:"",billingAddress:"",companyEmailAddress:"",companyRegistrationNumber:"",companyRegisteredName:"",billingPhoneNumber:"",BillingEmailAddress:"",dailyEmailLimit:0,dailySMSLimit:0,noOfLicence:0,noOfWorkers:0,favIcon:"",compnayLogo:null}),xe=l({}),Ee=async()=>{try{Re.value=!0;const e=new window.FormData;for(const a in xe.value)e.append(a,xe.value[a]);await Ne.patch(`/v3/api/company/${ve.id}/`,e);Be(),_e.dismissAll(),Re.value=!1,_e.success("Company updated, Company"),ge("update:getAllCompanies",null)}catch(e){let a=e.response.data??{};Object.values(a).forEach((e=>{e.forEach((e=>{console.log(e),_e.error(` ${e}, New Company`)}))}))}},je=e=>{if("industry"==e)return console.log("insustry tpe",Le.value.industry.id),void(xe.value={...xe.value,industry:Le.value.industry.id});xe.value={...xe.value,[e.target.name]:e.target.value}},Be=()=>{ge("update:handleUpdateEditCompanyModalOpen",!1),Le.value={companyName:"",industry:"",siteURL:"",businessAddress:"",postCode:"",country:"",state:"",yearBusinessStarted:"",companyPhoneNumber:"",billingAddress:"",companyEmailAddress:"",companyRegistrationNumber:"",companyRegisteredName:"",billingPhoneNumber:"",BillingEmailAddress:"",dailyEmailLimit:0,dailySMSLimit:0,noOfLicence:0,favIcon:"",compnayLogo:null}},Pe=()=>{be.value=!be.value},we=(e,a)=>{const l=Oe(e);xe.value.favIcon=l,he.value=e},ke=e=>{const a=Oe(e);xe.value.compnayLogo=a,Le.value.compnayLogo=e};function Oe(e){const a=e.split(","),l=a[0].indexOf("base64")>=0?atob(a[1]):decodeURI(a[1]),s=a[0].split(":")[1].split(";")[0],n=new Uint8Array(l.length);for(let o=0;o<l.length;o++)n[o]=l.charCodeAt(o);return new Blob([n],{type:s})}return s((()=>{(async()=>{try{const e=await Ne.get("/v3/api/industry/");Ae.value=e.data}catch(e){}})(),Ve.value=fe.loggedCompany.industry,Le.value=fe.loggedCompany})),(a,l)=>{const s=N,A=_,R=h,S=C,ge=b,_e=e;return n(),o(_e,{is:"form",open:ve.EditCompanyModalOpen,title:"Edit Company",size:"big",actions:"right",onSubmit:g(Ee,["prevent"]),onClose:Be,noclose:""},{content:t((()=>[i("div",V,[i("div",L,[x,i("div",E,[u(i("input",{type:"text",name:"companyName","onUpdate:modelValue":l[0]||(l[0]=e=>r(Le).companyName=e),onChange:l[1]||(l[1]=e=>je(e)),required:"",class:"input is-primary-focus is-primary-focus",placeholder:"Company Name"},null,544),[[d,r(Le).companyName]])])]),i("div",j,[B,i("div",P,[u(i("input",{type:"text",name:"siteURL","onUpdate:modelValue":l[2]||(l[2]=e=>r(Le).siteURL=e),onChange:l[3]||(l[3]=e=>je(e)),class:"input is-primary-focus",placeholder:"Site URL"},null,544),[[d,r(Le).siteURL]])])]),i("div",w,[k,i("div",O,[u(i("input",{name:"businessAddress","onUpdate:modelValue":l[4]||(l[4]=e=>r(Le).businessAddress=e),onChange:l[5]||(l[5]=e=>je(e)),class:"input is-primary-focus",placeholder:"Business Address"},null,544),[[d,r(Le).businessAddress]])])]),i("div",I,[M,i("div",F,[u(i("input",{type:"text",name:"postCode","onUpdate:modelValue":l[6]||(l[6]=e=>r(Le).postCode=e),onChange:l[7]||(l[7]=e=>je(e)),class:"input is-primary-focus",placeholder:"Post Code"},null,544),[[d,r(Le).postCode]])])]),i("div",K,[q,i("div",z,[u(i("input",{type:"text",name:"country","onUpdate:modelValue":l[8]||(l[8]=e=>r(Le).country=e),onChange:l[9]||(l[9]=e=>je(e)),class:"input is-primary-focus",placeholder:"Country"},null,544),[[d,r(Le).country]])])]),i("div",D,[H,i("div",J,[u(i("input",{type:"text",name:"state","onUpdate:modelValue":l[10]||(l[10]=e=>r(Le).state=e),onChange:l[11]||(l[11]=e=>je(e)),class:"input is-primary-focus",placeholder:"State"},null,544),[[d,r(Le).state]])])]),i("div",T,[Y,i("div",$,[u(i("input",{type:"text",name:"yearBusinessStarted","onUpdate:modelValue":l[12]||(l[12]=e=>r(Le).yearBusinessStarted=e),onChange:l[13]||(l[13]=e=>je(e)),class:"input is-primary-focus",placeholder:"Year Business Started"},null,544),[[d,r(Le).yearBusinessStarted]])])]),i("div",G,[W,i("div",X,[u(i("input",{type:"tel",name:"companyPhoneNumber","onUpdate:modelValue":l[14]||(l[14]=e=>r(Le).companyPhoneNumber=e),onChange:l[15]||(l[15]=e=>je(e)),class:"input is-primary-focus",placeholder:"Company Phone Number"},null,544),[[d,r(Le).companyPhoneNumber]])])]),i("div",Q,[Z,i("div",ee,[u(i("input",{type:"email",name:"companyEmailAddress","onUpdate:modelValue":l[16]||(l[16]=e=>r(Le).companyEmailAddress=e),onChange:l[17]||(l[17]=e=>je(e)),class:"input is-primary-focus",placeholder:"Company Email Address"},null,544),[[d,r(Le).companyEmailAddress]])])]),i("div",ae,[le,i("div",se,[u(i("input",{type:"text",name:"companyRegistrationNumber","onUpdate:modelValue":l[18]||(l[18]=e=>r(Le).companyRegistrationNumber=e),onChange:l[19]||(l[19]=e=>je(e)),class:"input is-primary-focus",placeholder:"Company Registration Number"},null,544),[[d,r(Le).companyRegistrationNumber]])])]),i("div",ne,[oe,i("div",te,[u(i("input",{type:"text",name:"companyRegisteredName","onUpdate:modelValue":l[20]||(l[20]=e=>r(Le).companyRegisteredName=e),onChange:l[21]||(l[21]=e=>je(e)),class:"input is-primary-focus",placeholder:"Company Registered Name"},null,544),[[d,r(Le).companyRegisteredName]])])]),i("div",ie,[i("div",ue,[m(R,{class:"column is-3"},{default:t((()=>[re,i("div",de,[m(A,{size:"xl",class:"profile-v-avatar mt-4"},{avatar:t((()=>[r(Ue)?c("",!0):(n(),p("img",{key:0,class:"avatar",src:null==r(Le).compnayLogo?"/images/avatars/placeholder.jpg":r(Le).compnayLogo,alt:""},null,8,me)),"update"==r(Se)?(n(),p("span",pe,[r(Ue)?(n(),o(s,{key:1,style:{position:"absolute",top:"60%",right:"-3%"},icon:"feather:arrow-left",class:"edit-button is-back",circle:"",tabindex:"0",onKeydown:l[24]||(l[24]=y(g((e=>Ue.value=!1),["prevent"]),["space"])),onClick:l[25]||(l[25]=e=>Ue.value=!1)})):(n(),o(s,{key:0,style:{position:"absolute",top:"60%",right:"-3%"},icon:"feather:edit-2",class:"edit-button is-edit",circle:"",tabindex:"0",onKeydown:l[22]||(l[22]=y(g((e=>Ue.value=!0),["prevent"]),["space"])),onClick:l[23]||(l[23]=()=>{Ce.value=!r(Ce)})}))])):c("",!0)])),_:1})])])),_:1}),m(r(U),{field:"img",onCropSuccess:ke,modelValue:r(Ce),"onUpdate:modelValue":l[26]||(l[26]=e=>v(Ce)?Ce.value=e:null),noRotate:!1,noSquare:!1,langType:"en","img-format":"png/jpg"},null,8,["modelValue"]),m(R,{class:"column is-3"},{default:t((()=>[m(S,{onClick:Pe,color:"primary",title:"Favicon",primary:"",icon:"fas fa-cloud-upload-alt"},{default:t((()=>[ce])),_:1}),m(r(U),{field:"img",onCropSuccess:we,modelValue:r(be),"onUpdate:modelValue":l[27]||(l[27]=e=>v(be)?be.value=e:null),noRotate:!1,noSquare:!1,langType:"en","img-format":"png/jpg"},null,8,["modelValue"]),i("img",{src:r(he)?r(he):r(fe).loggedCompany.favIcon,style:{width:"100px",height:"100px","border-radius":"50%",margin:"10px"}},null,8,ye)])),_:1})])])])])),action:t((()=>[m(ge,{type:"submit",loading:r(Re),color:"primary",raised:""},{default:t((()=>[f("Update")])),_:1},8,["loading"])])),_:1},8,["open","onSubmit"])}}});export{ge as _};
