import{_ as e}from"./AddUpdateUser-2b65890d.js";import{_ as t}from"./SweetAlert.vue_vue_type_style_index_0_lang-a5d48e16.js";import{_ as s}from"./VProgress.vue_vue_type_style_index_0_lang-249189d1.js";import{_ as a}from"./VAvatar.vue_vue_type_style_index_0_lang-44706e4c.js";import{_ as l}from"./VPlaceholderPage.vue_vue_type_style_index_0_lang-063a697a.js";import{e as i,r,Z as n,o,l as u,B as c,N as d,C as _,D as p,E as v,F as m,K as g,X as y,j as f,H as k,V as b,W as h,aR as w,M as x,P as j,U as A,J as C,x as S,z as V}from"./index-6822cb6c.js";import{_ as O}from"./VControl-82cc88a1.js";import{_ as P}from"./PlaceloadV3.vue_vue_type_style_index_0_lang-4fa7583a.js";import{_ as W,a as U}from"./search-4-dark-2b5b440c.js";import{u as I}from"./useAPI-8ffd32d3.js";import{u as F}from"./useNotyf-58075e13.js";import{u as M}from"./viewWrapper-1be7af83.js";import"./VModal.vue_vue_type_style_index_0_lang-5f85507f.js";import"./VRadio.vue_vue_type_style_index_0_lang-ce6a14d3.js";import"./VLabel.vue_vue_type_script_setup_true_lang-c267a264.js";import"./useVFieldContext-8c3287cc.js";import"./VSwitchBlock.vue_vue_type_style_index_0_lang-072f5ed6.js";import"./VIcon.vue_vue_type_script_setup_true_lang-60b95533.js";import"./VFilePond.vue_vue_type_script_lang-8e5d5aa1.js";import"./VField.vue_vue_type_script_setup_true_lang-631d5387.js";import"./VInput.vue_vue_type_script_setup_true_lang-81ee3232.js";import"./useSupportElement-04dac3f0.js";import"./userSession-04f4c15c.js";import"./VPlaceloadText.vue_vue_type_style_index_0_lang-190bea09.js";import"./VPlaceloadAvatar.vue_vue_type_style_index_0_lang-680f6262.js";import"./notyf-5c084f1f.js";import"./useThemeColors-9a3bb308.js";const T={key:1},D={class:"card-grid-toolbar"},E={class:"buttons"},z=p("span",{class:"icon"},[p("i",{"aria-hidden":"true",class:"fas fa-plus"})],-1),H=p("span",null," Worker",-1),L={class:"card-grid card-grid-v1"},R=p("img",{class:"light-image",src:W,alt:""},null,-1),$=p("img",{class:"dark-image",src:U,alt:""},null,-1),B={class:"card-grid-item"},N={class:"card-grid-item-body"},J={class:"left"},K={class:"meta"},Z={class:"dark-inverted"},q={class:"right"},X={class:"social-links"},Y=["onClick"],G=[p("i",{class:"success-text fas fa-check-circle","aria-hidden":"true"},null,-1)],Q=["onClick"],ee=[p("i",{class:"fas fa-ban warning-text","aria-hidden":"true"},null,-1)],te={key:2,channel:"Twitter",class:"social-link"},se=[p("i",{class:"fas fa-envelope warning-text","aria-hidden":"true"},null,-1)],ae=["onClick"],le=[p("i",{"aria-hidden":"true",class:"fas fa-edit info-text"},null,-1)],ie=["onClick"],re=[p("i",{"aria-hidden":"true",class:"fas fa-trash danger-text"},null,-1)],ne={class:"card-grid-item-footer"},oe={class:"left"},ue={class:"progress-stats"},ce=p("span",{class:"dark-inverted"},"Progress",-1),de={class:"progress-bar"},_e={class:"right"},pe={class:"buttons"},ve=i({__name:"IbexWorkers",setup(i){const S=I(),V=F(),W=r(""),U=r("");r(0);const M=r(""),ve=r(!1),me=r(!1),ge=r(null),ye=r(null),fe=r({title:"",subtitle:"test",isSweetAlertOpen:!1,btntext:"text"}),ke=r({title:"",subtitle:"test",isSweetAlertOpen:!1,btntext:"text"}),be=r([{id:"",active_tasks:0,completed_tasks:2,cancelled_tasks:0,pending_tasks:13,password:"",last_login:null,date_joined:"",email:"",role:"",is_active:!0,phoneNumber:"",username:"",is_sentMail:!1,avatar:null}]),he=(e="")=>{M.value=e,ve.value=!ve.value},we=n((()=>W.value?be.value.filter((e=>e.username.match(new RegExp(W.value,"i"))||e.email.match(new RegExp(W.value,"i")))):be.value)),xe=e=>{ge.value=e.id,ye.value=e.is_active,fe.value.title="Change Status",fe.value.btntext=""+(e.is_active?"In-Activate":"Activate"),fe.value.subtitle=ye.value?"After this User will not be able to login into the system":"From now this user will be able to login and perform all activities",fe.value.isSweetAlertOpen=!0},je=async()=>{try{me.value=!0,await S.delete(`/api/users/${U.value}/`,{}),await Ae(),V.green("Worker deleted successfully")}catch(e){console.log(e),V.error("Error while deleting")}finally{me.value=!1}},Ae=async()=>{try{me.value=!0;const e=await S.get("/api/users/workers/",{});be.value=e.data.map((e=>({...e,progress:e.active_tasks+e.pending_tasks+e.cancelled_tasks/e.completed_tasks}))),console.log("data",be.value)}catch(e){console.log(e)}finally{me.value=!1}},Ce=async()=>{try{me.value=!0;const e=await S.patch(`/api/users/${ge.value}/`,{is_active:!ye.value});await Ae(),V.success(ye.value?"Worker set inactive successfully":"Worker set active successfully"),fe.value.isSweetAlertOpen=!1,console.log(e)}catch(e){console.log(e)}finally{me.value=!1}};return o((()=>{Ae()})),(i,r)=>{const n=P,o=O,S=j,V=l,I=a,F=s,ge=t,ye=e;return u(me)?(c(),d(n,{key:0})):(c(),_("div",T,[p("div",D,[v(o,{icon:"feather:search"},{default:m((()=>[g(p("input",{"onUpdate:modelValue":r[0]||(r[0]=e=>f(W)?W.value=e:null),class:"input custom-text-filter",placeholder:"Search..."},null,512),[[y,u(W)]])])),_:1}),p("div",E,[v(S,{onClick:r[1]||(r[1]=e=>he()),color:"primary",raised:""},{default:m((()=>[z,H])),_:1})])]),p("div",L,[v(V,{class:k([0!==u(we).length&&"is-hidden"]),title:"We couldn't find any matching results.",subtitle:"Too bad. Looks like we couldn't find any matching results for the\n          search terms you've entered. Please try different search terms or\n          criteria.",larger:""},{image:m((()=>[R,$])),_:1},8,["class"]),v(w,{name:"list",tag:"div",class:"columns is-multiline"},{default:m((()=>[(c(!0),_(b,null,h(u(we),((e,t)=>(c(),_("div",{key:t,class:"column is-6"},[p("div",B,[p("div",N,[p("div",J,[v(I,{size:"big",picture:e?.avatar},null,8,["picture"]),p("div",K,[p("span",Z,A(e.username),1),p("span",null,A(e.role),1)])]),p("div",q,[p("div",X,[e.is_active?(c(),_("a",{key:0,onClick:t=>xe(e),channel:"Linkedin",class:"social-link"},G,8,Y)):(c(),_("a",{key:1,onClick:t=>xe(e),channel:"Linkedin",class:"social-link"},ee,8,Q)),e.is_sentMail?(c(),_("a",te,se)):x("",!0),p("a",{channel:"Dribbble",onClick:t=>he(e.id),class:"social-link"},le,8,ae),p("a",{channel:"Dribbble",onClick:t=>{return s=e,U.value=s.id,void(ke.value={title:`Delete ${s.username}?`,subtitle:"After deleting this worker you won't be able to recover it again.",btntext:"Delete it",isSweetAlertOpen:!0});var s},class:"social-link"},re,8,ie)])])]),p("div",ne,[p("div",oe,[p("div",ue,[ce,p("span",null,A(e.progress?e.progress:"0")+"%",1)]),p("div",de,[v(F,{size:"tiny",value:e.progress?e.progress:0},null,8,["value"])])]),p("div",_e,[p("div",pe,[v(S,{to:`/sidebar/dashboard/workers/${e.id}`,"dark-outlined":"",rounded:""},{default:m((()=>[C(" View Profile ")])),_:2},1032,["to"])])])])])])))),128))])),_:1})]),u(fe).isSweetAlertOpen?(c(),d(ge,{key:0,loading:u(me),isSweetAlertOpen:u(fe).isSweetAlertOpen,title:u(fe).title,subtitle:u(fe).subtitle,btntext:u(fe).btntext,onConfirm:Ce,onCancel:()=>u(fe).isSweetAlertOpen=!1},null,8,["loading","isSweetAlertOpen","title","subtitle","btntext","onCancel"])):x("",!0),u(ke).isSweetAlertOpen?(c(),d(ge,{key:1,loading:u(me),isSweetAlertOpen:u(ke).isSweetAlertOpen,title:u(ke).title,subtitle:u(ke).subtitle,btntext:u(ke).btntext,onConfirm:je,onCancel:()=>u(ke).isSweetAlertOpen=!1},null,8,["loading","isSweetAlertOpen","title","subtitle","btntext","onCancel"])):x("",!0),u(ve)?(c(),d(ye,{key:2,"is-modal-open":u(ve),"user-role":"worker","user-id":u(M),"onUpdate:closeModalHandler":r[2]||(r[2]=e=>ve.value=!1),"onUpdate:actionUpdateHandler":Ae},null,8,["is-modal-open","user-id"])):x("",!0)]))}}}),me={class:"page-content-inner"},ge=i({__name:"index",setup(e){S();return M().setPageTitle("Workers"),V({title:"Workers - Ibex"}),(e,t)=>{const s=ve;return c(),_("div",me,[v(s)])}}});export{ge as default};
