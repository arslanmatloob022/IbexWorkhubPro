import{c as e,b as l}from"./CreateProposalTasksModal-7c741cb9.js";import{_ as a,c as t}from"./VFlexTable.vue_vue_type_style_index_0_lang-d0c31d48.js";import{f as s,x as o,y as i,r as n,$ as r,o as p,C as d,D as u,E as c,F as m,G as _,L as v,X as y,m as g,k as f,O as k,V as b,W as x,aS as h,N as w,U as j,K as C,P as I,A as P,I as A,H as T,J as V}from"./index-a3400f1b.js";import{_ as S}from"./VControl-6dda33a1.js";import{u as M}from"./useAPI-2fd27276.js";import{u as O}from"./useNotyf-993498c3.js";import{_ as L,a as U,b as D}from"./ProposalViewModal.vue_vue_type_style_index_0_lang-5ed3e559.js";import{_ as $}from"./SweetAlert.vue_vue_type_style_index_0_lang-3a2b5313.js";import{_ as E}from"./VFlexPagination.vue_vue_type_script_setup_true_lang-399d4382.js";import{_ as H}from"./VPlaceholderPage.vue_vue_type_style_index_0_lang-ba646937.js";import{_ as F}from"./VDropdown.vue_vue_type_style_index_0_lang-9add1bf7.js";import{_ as K}from"./VTag.vue_vue_type_style_index_0_lang-eba8d43c.js";import{_ as B}from"./PlaceloadV1.vue_vue_type_style_index_0_lang-c49a999a.js";import{_ as N,a as R}from"./search-4-dark-2b5b440c.js";import{f as W,g as z}from"./useSupportElement-20f9399a.js";import{u as J}from"./viewWrapper-9b92c4df.js";import"./VModal.vue_vue_type_style_index_0_lang-6c5a892c.js";import"./VField.vue_vue_type_script_setup_true_lang-0356b305.js";import"./VLabel.vue_vue_type_script_setup_true_lang-9144ad72.js";import"./useVFieldContext-3f7d52ed.js";import"./VTextarea.vue_vue_type_script_setup_true_lang-7dc3b3e7.js";import"./VInput.vue_vue_type_script_setup_true_lang-63635957.js";import"./VCheckbox.vue_vue_type_style_index_0_lang-1494aa9f.js";import"./VOption.vue_vue_type_style_index_0_lang-353ad205.js";import"./estimatesScripts-8769a598.js";import"./costItems-0ad28236.js";import"./VIconButton-bbd92dbe.js";import"./company-bc5c4421.js";import"./notyf-38e0defd.js";import"./useThemeColors-24c6c000.js";import"./VRadio.vue_vue_type_style_index_0_lang-1109e882.js";import"./ckeditor-e918e369.js";import"./vue.runtime.esm-bundler-48e56762.js";import"./ckeditor-d2acaee6.js";import"./V-Snack.vue_vue_type_style_index_0_lang-6851950c.js";import"./VIcon.vue_vue_type_script_setup_true_lang-05602d75.js";import"./VAvatar.vue_vue_type_style_index_0_lang-84a613e6.js";import"./VFlex.vue_vue_type_style_index_0_lang-4bfe8b13.js";import"./useDropdown-612f30b5.js";import"./VPlaceloadWrap-dbe17c95.js";import"./VPlaceloadText.vue_vue_type_style_index_0_lang-8ca13ae6.js";import"./VPlaceloadAvatar.vue_vue_type_style_index_0_lang-1f3e4cf4.js";const Q={class:"is-flex",style:{"justify-content":"end"}},X={class:"item-name dark-inverted"},Y={class:"light-text"},q={class:"light-text"},G={class:"light-text"},Z=s({__name:"CataLogList",setup(l){o(),i();const s=M();O();const P=n(""),A=n([]);n([]);const T=n(!1),V=n(""),L=n(0),U=n(""),D=n("catalog"),$=[{label:"Title",key:"title"},{label:"Unit",key:"unit"},{label:"Total Price",key:"total_price"},{label:"Cost Type",key:"cost_type"},{label:"Actions",key:"actions"}],E=async()=>{try{const e=await s.get("/api/cost/catalogs/");A.value=e.data}catch(e){console.error("Error fetching catalogs:",e)}},H=r((()=>A.value.filter((e=>e.title.toLowerCase().includes(P.value.toLowerCase())))));return p(E),(l,o)=>{const i=S,n=t,r=I,p=a,M=e;return d(),u(b,null,[c("div",Q,[m(i,{icon:"feather:search"},{default:_((()=>[v(c("input",{"onUpdate:modelValue":o[0]||(o[0]=e=>f(P)?P.value=e:null),class:"input custom-text-filter",placeholder:"Search..."},null,512),[[y,g(P)]])])),_:1})]),g(H).length>0?(d(),k(p,{key:0,class:"mt-5",data:g(H),columns:$,rounded:""},{body:_((()=>[m(h,{name:"list",tag:"div",class:"flex-list-inner"},{default:_((()=>[(d(!0),u(b,null,x(g(H),(e=>(d(),u("div",{key:e.id,class:"flex-table-item"},[m(n,{column:{media:!0,grow:!1},class:"cu-pointer"},{default:_((()=>[c("div",null,[c("span",X,j(e.title),1)])])),_:2},1024),m(n,null,{default:_((()=>[c("span",Y,j(e.unit),1)])),_:2},1024),m(n,null,{default:_((()=>[c("span",q,j(e.total_price),1)])),_:2},1024),m(n,null,{default:_((()=>[c("span",G,j(e.cost_type),1)])),_:2},1024),m(n,null,{default:_((()=>[m(r,{color:"primary",size:"medium",light:"",onClick:l=>{return a=e,U.value=a.id,V.value=a.proposal,void(T.value=!T.value);var a},icon:"fas fa-pen"},{default:_((()=>[C("Edit")])),_:2},1032,["onClick"]),m(r,{class:"ml-2",color:"danger",size:"medium",light:"",onClick:l=>(async e=>{try{await s.delete(`/api/cost/${e}/`),A.value=A.value.filter((l=>l.id!==e))}catch(l){console.error("Error deleting catalog:",l)}})(e.id),icon:"fas fa-trash-alt"},{default:_((()=>[C("Delete")])),_:2},1032,["onClick"])])),_:2},1024)])))),128))])),_:1})])),_:1},8,["data"])):w("",!0),g(T)?(d(),k(M,{key:1,costItemModal:g(T),proposalId:g(V),costItemId:g(U),previousItemIndex:g(L),costMode:g(D),"onUpdate:modalHandler":o[1]||(o[1]=e=>{T.value=!1,U.value=""}),"onUpdate:OnSuccess":E},null,8,["costItemModal","proposalId","costItemId","previousItemIndex","costMode"])):w("",!0)],64)}}}),ee={class:"flex-toolbar is-reversed is-flex space-between my-4"},le=c("div",null,null,-1),ae={key:0},te={key:1,class:"flex-list-wrapper flex-list-v2"},se={class:"item-name dark-inverted"},oe={class:"item-meta"},ie=["innerHTML"],ne={class:"light-text"},re={class:"item-name dark-inverted"},pe={class:"light-text"},de={class:"item-name dark-inverted"},ue={class:"light-text"},ce=["onClick"],me=[c("div",{class:"icon"},[c("i",{"aria-hidden":"true",class:"lnil lnil-pencil"})],-1),c("div",{class:"meta"},[c("span",null,"Edit"),c("span",null,"Edit Proposal Details")],-1)],_e=["onClick"],ve=[c("div",{class:"icon"},[c("i",{"aria-hidden":"true",class:"lnil lnil-eye"})],-1),c("div",{class:"meta"},[c("span",null,"Preview"),c("span",null,"Preview proposal detail")],-1)],ye=c("hr",{class:"dropdown-divider"},null,-1),ge=["onClick"],fe=[c("div",{class:"icon"},[c("i",{class:"lnir lnir-round-box-check","aria-hidden":"true"})],-1),c("div",{class:"meta"},[c("span",null,"Mark Approved"),c("span",null,"Mark Proposal As Approved")],-1)],ke=["onClick"],be=[c("div",{class:"icon"},[c("i",{"aria-hidden":"true",class:"lnil lnil-trash-can-alt"})],-1),c("div",{class:"meta"},[c("span",null,"Delete"),c("span",null,"Delete from list")],-1)],xe=c("img",{class:"light-image",src:N,alt:""},null,-1),he=c("img",{class:"dark-image",src:R,alt:""},null,-1),we=s({__name:"TemplatePropsalsList",props:{activeTab:{default:"active"},leadId:{default:""},allProposal:{type:Boolean,default:!1}},setup(s){const C=s,I=o();i();const P=M(),A=O(),T=n(!1),V=n([]),N=n(!1),R=n(""),J=n(!1),Q=n(!1),X=n(""),Y=n("");n(C.activeTab);const q=n({title:"",subtitle:"test",isSweetAlertOpen:!1,btntext:"text"}),G=n({title:"",subtitle:"",isSweetAlertOpen:!1,btntext:""}),Z=async()=>{try{T.value=!0;await P.delete(`/api/lead-proposal/${Y.value}/`);A.success("Proposal delete successfully"),Ve()}catch(e){A.error(` ${e}, Proposal`),A.error("Something went wrong please try later")}finally{T.value=!1,q.value.isSweetAlertOpen=!1}},we={picture:{label:"Proposal",grow:!0,media:!0},deadline:"Cost Items",amount:{label:"Total Amount",media:!0},customer:"Created At",actions:{label:"Actions",align:"end"}},je=r((()=>{if(X.value){const e=new RegExp(X.value,"i");return V.value.filter((l=>l.title.match(e)||l.approval_deadline.match(e)))}return V.value})),Ce=n(!1),Ie=n(!1),Pe=n(!1),Ae=n(""),Te=e=>{I.push(`/sidebar/dashboard/proposals/${e}`)},Ve=()=>{(async()=>{try{T.value=!0;const e=await P.get("/api/lead-proposal/templates/");V.value=e.data}catch(e){A.error(` ${e}, Lead`)}finally{T.value=!1}})()};return p((()=>{Ve()})),(s,o)=>{const i=S,n=B,r=t,p=K,I=F,M=a,O=H,Se=E,Me=l,Oe=L,Le=U,Ue=e,De=$,$e=D;return d(),u("div",null,[c("div",ee,[m(i,{icon:"feather:search"},{default:_((()=>[v(c("input",{"onUpdate:modelValue":o[0]||(o[0]=e=>f(X)?X.value=e:null),class:"input custom-text-filter",placeholder:"Search..."},null,512),[[y,g(X)]])])),_:1}),le]),g(T)?(d(),u("div",ae,[m(n)])):(d(),u("div",te,[g(je).length>0&&g(V).length>0?(d(),k(M,{key:0,data:g(je),columns:we,rounded:""},{body:_((()=>[m(h,{name:"list",tag:"div",class:"flex-list-inner"},{default:_((()=>[(d(!0),u(b,null,x(g(je),(e=>(d(),u("div",{key:e.id,class:"flex-table-item"},[m(r,{column:{media:!0,grow:!0},class:"cu-pointer",onClick:l=>Te(e.id)},{default:_((()=>[c("div",null,[c("span",se,j(e.title),1),c("span",oe,[c("span",{innerHTML:e.introductory_text},null,8,ie)])])])),_:2},1032,["onClick"]),m(r,{class:"cu-pointer",onClick:l=>Te(e.id)},{default:_((()=>[c("span",ne,j(),1),m(p,{rounded:"",color:"primary",label:e.cost_items},null,8,["label"])])),_:2},1032,["onClick"]),m(r,{class:"cu-pointer",onClick:l=>Te(e.id),column:{media:!0}},{default:_((()=>[c("div",null,[c("span",re,"$"+j(e.proposalAmount),1),c("span",pe,j(e.payment_status),1)])])),_:2},1032,["onClick"]),m(r,{column:{media:!0},class:"cu-pointer",onClick:l=>Te(e.id)},{default:_((()=>[c("div",null,[c("span",de,j(g(W)(e.created_at)),1),c("span",ue,j(g(z)(e.created_at)),1)])])),_:2},1032,["onClick"]),m(r,{column:{align:"end"}},{default:_((()=>[m(I,{class:"is-pushed-mobile",icon:"feather:more-vertical",spaced:"",right:""},{content:_((()=>[c("a",{role:"menuitem",onClick:l=>{return a=e.id,R.value=a,void(N.value=!0);var a},class:"dropdown-item is-media"},me,8,ce),c("a",{disabled:"",role:"menuitem",onClick:l=>{return a=e.id,Ie.value=a,void(Ce.value=!Ce.value);var a},class:"dropdown-item is-media"},ve,8,_e),ye,c("a",{role:"menuitem",onClick:l=>(async(e,l)=>{try{await P.patch(`/api/lead-proposal/${l}/`,{status:e}),A.success(`You have ${e} this proposal.`),Ve()}catch(a){console.log(a)}})("approved",e.id),class:"dropdown-item is-media"},fe,8,ge),c("a",{role:"menuitem",onClick:l=>{return a=e.id,Y.value=a,void(q.value={title:"Delete Proposal?",subtitle:"Are you sure to delete this proposal? After delete you will not be able to recover it again.",btntext:"Yes delete",isSweetAlertOpen:!0});var a},class:"dropdown-item is-media"},be,8,ke)])),_:2},1024)])),_:2},1024)])))),128))])),_:1})])),_:1},8,["data"])):w("",!0),g(V).length<1&&0==g(je).length?(d(),k(O,{key:1,title:"There is no proposal created on this lead!",subtitle:"Too bad. Looks like we couldn't created any proposal on this Lead, please create proposal and release to the client",larger:""},{image:_((()=>[xe,he])),_:1})):w("",!0),g(je).length>5?(d(),k(Se,{key:2,"item-per-page":10,"total-items":873,"current-page":42,"max-links-displayed":7})):w("",!0)])),g(J)?(d(),k(Me,{key:2,createProposalTasksModal:g(J),proposalId:g(R),onCloseModalHandler:o[1]||(o[1]=e=>J.value=!1),"onUpdate:OnSuccess":Ve},null,8,["createProposalTasksModal","proposalId"])):w("",!0),g(N)?(d(),k(Oe,{key:3,leadId:C.leadId,proposalId:g(R),leadProposalModal:g(N),"onUpdate:modalHandler":o[2]||(o[2]=e=>N.value=!1),"onUpdate:OnSuccess":Ve,onClearProposalId:o[3]||(o[3]=e=>R.value="")},null,8,["leadId","proposalId","leadProposalModal"])):w("",!0),g(Ce)?(d(),k(Le,{key:4,"preview-modal":g(Ce),proposalId:g(Ie),"onUpdate:modalHandler":o[4]||(o[4]=e=>Ce.value=!1)},null,8,["preview-modal","proposalId"])):w("",!0),g(Pe)?(d(),k(Ue,{key:5,costItemModal:g(Pe),proposalId:g(Ae),"onUpdate:modalHandler":o[5]||(o[5]=e=>Pe.value=!1),"onUpdate:OnSuccess":Ve},null,8,["costItemModal","proposalId"])):w("",!0),g(q).isSweetAlertOpen?(d(),k(De,{key:6,isSweetAlertOpen:g(q).isSweetAlertOpen,title:g(q).title,subtitle:g(q).subtitle,btntext:g(q).btntext,onConfirm:Z,onCancel:()=>g(q).isSweetAlertOpen=!1},null,8,["isSweetAlertOpen","title","subtitle","btntext","onCancel"])):w("",!0),g(G).isSweetAlertOpen?(d(),k(De,{key:7,isSweetAlertOpen:g(G).isSweetAlertOpen,title:g(G).title,subtitle:g(G).subtitle,btntext:g(G).btntext,onConfirm:Z,onCancel:()=>g(G).isSweetAlertOpen=!1},null,8,["isSweetAlertOpen","title","subtitle","btntext","onCancel"])):w("",!0),g(Q)?(d(),k($e,{key:8,leadProposalListModal:g(Q),leadID:C.leadId,"group-proposal-modal":g(Q),"onUpdate:modalHandler":o[6]||(o[6]=e=>Q.value=!1)},null,8,["leadProposalListModal","leadID","group-proposal-modal"])):w("",!0)])}}}),je={class:"tabs-wrapper"},Ce={class:"tabs-inner"},Ie={class:"tabs"},Pe=[c("span",null,"Templates",-1)],Ae=[c("span",null,"Catalog",-1)],Te={key:0,class:""},Ve={key:1,class:""},Se=s({__name:"index",setup(e){const l=J(),a=n("proposalsTemplates");return l.setPageTitle("Proposals Templates"),P({title:"Proposals Templates - Ibex"}),(e,l)=>{const t=we,s=Z;return d(),u("div",null,[c("div",je,[c("div",Ce,[c("div",Ie,[c("ul",null,[c("li",{class:A(["proposalsTemplates"===g(a)?"is-active":"not-active"])},[c("a",{tabindex:"0",role:"button",onKeydown:l[0]||(l[0]=T(V((e=>a.value="proposalsTemplates"),["prevent"]),["space"])),onClick:l[1]||(l[1]=e=>a.value="proposalsTemplates")},Pe,32)],2),c("li",{class:A(["catalog"===g(a)?"is-active":"not-active"])},[c("a",{tabindex:"0",role:"button",onKeydown:l[2]||(l[2]=T(V((e=>a.value="catalog"),["prevent"]),["space"])),onClick:l[3]||(l[3]=e=>a.value="catalog")},Ae,32)],2)])])])]),"proposalsTemplates"===g(a)?(d(),u("div",Te,[m(t)])):w("",!0),"catalog"===g(a)?(d(),u("div",Ve,[m(s)])):w("",!0)])}}});export{Se as default};
