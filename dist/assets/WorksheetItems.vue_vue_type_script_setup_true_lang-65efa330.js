import{e,s as l,r as a,Z as t,b as o,_ as s,o as n,B as i,N as u,F as r,D as d,E as c,K as p,l as m,W as v,C as b,U as f,V as _,J as h,T as y,M as C,j as w,I as g,O as I,a4 as k,a0 as V,P as T,Q as x,R as S,i as P,A as M,aR as D,H as U,G as A}from"./index-b2cddf6b.js";import{_ as O}from"./VModal.vue_vue_type_style_index_0_lang-c64f2af6.js";import{_ as j}from"./VInput.vue_vue_type_script_setup_true_lang-50eb6df5.js";import{_ as E}from"./VTextarea.vue_vue_type_script_setup_true_lang-99f9cb04.js";import{_ as N}from"./VField.vue_vue_type_script_setup_true_lang-56a507fe.js";import{_ as H}from"./VControl-ad68365b.js";import{_ as L,a as q}from"./VOption.vue_vue_type_style_index_0_lang-6243a584.js";import{u as B}from"./useAPI-f754fb36.js";import{u as R}from"./useNotyf-80ed00ef.js";import{a as Q}from"./useSupportElement-bcd3e66c.js";import{u as z}from"./userSession-3c9c0bc9.js";import{_ as W}from"./VAvatar.vue_vue_type_style_index_0_lang-a2584e4d.js";import{_ as $}from"./VCheckbox.vue_vue_type_style_index_0_lang-101c1005.js";import{_ as F}from"./VRadio.vue_vue_type_style_index_0_lang-06ae29cf.js";import{u as G,c as K,g as J,a as Y}from"./proposalItems-c33c945d.js";import{_ as Z}from"./SweetAlert.vue_vue_type_style_index_0_lang-f3d061b8.js";import{_ as X}from"./VDropdown.vue_vue_type_style_index_0_lang-84ec431f.js";const ee={class:"modal-form columns is-multiline"},le={class:"columns is-multiline"},ae={class:"field column is-12 mb-0"},te=d("label",null,"Title: ",-1),oe={class:"control"},se=["disabled"],ne={class:"field column is-6"},ie=d("label",{for:""},"Cost Type",-1),ue={class:"field column is-6"},re=d("label",{for:""},"Catalog",-1),de={class:"field column is-6"},ce=d("label",{for:""},"Mark As",-1),pe={class:"field column is-6"},me=d("label",{for:""},"Cost Code *",-1),ve={class:"field column is-6"},be=d("label",{for:""},"Group Cost",-1),fe={class:"field column is-12 mb-0"},_e=d("label",{for:"",class:"label"},"Description",-1),he={class:"field column is-12 mb-0"},ye=d("label",{for:"",class:"label"},"Internal Notes",-1),Ce={class:"columns is-multiline"},we={class:"field column is-6"},ge=d("label",null,"Unit Cost",-1),Ie={class:"field column is-6"},ke=d("label",null,"Quantity",-1),Ve={class:"field column is-6"},Te=d("label",null,"Unit",-1),xe={class:"field column is-6"},Se=d("label",null,"Builder Cost",-1),Pe={class:"field column is-6"},Me=d("label",null,"Markup (%)",-1),De={class:"field column is-6"},Ue=d("label",null,"Client Price",-1),Ae={class:"field column is-6"},Oe=d("label",null,"Margin (%)",-1),je=e({__name:"EstimateCostItemModal",props:{costItemModal:{type:Boolean},proposalId:{},previousItemIndex:{},costItemId:{},previewCostItems:{type:Boolean}},emits:["update:modalHandler","update:OnSuccess"],setup(e,{emit:V}){const T=e,x=l();z();const S=R(),P=B(),M=a(!1);a([]),a([]);const D=a({previousItemIndex:0,index:0,id:"",type:"",total_price:0,cost_code:"",cost_type:"",builder_cost:0,internal_notes:"",mark_as:"",state:"",title:"",description:"",quantity:0,unit:"",unit_cost:0,markup:0,margin:0,profit:0,group:"",proposal:T.proposalId}),U=a([{value:"labour",label:"Labour"},{value:"material",label:"Material"},{value:"equipment",label:"Equipment"},{value:"subcontractor",label:"Subcontractor"},{value:"other",label:"Others"}]),A=a([{value:"11011",label:"Labour"},{value:"11012",label:"Material"},{value:"11013",label:"Equipment"},{value:"11014",label:"Subcontractor"},{value:"11015",label:"Others"}]),W=a([{value:"Tiling",label:"Tiling"},{value:"Material",label:"Material"},{value:"Paint",label:"Paint"},{value:"Carpenter",label:"Carpenter"}]),$=a([{value:"bid",label:"Bid"},{value:"allowance",label:"Allowance"}]);a([{value:"open",label:"Open"},{value:"inProgress",label:"In Progress"},{value:"onHold",label:"On Hold"},{value:"pending",label:"Pending"},{value:"lost",label:"Lost"},{value:"sold",label:"sold"},{value:"noOpportunity",label:"No Opportunity"}]);const F=async()=>{try{M.value=!0;const e=Q(D.value,[]);if(T.costItemId){await P.patch(`/api/cost/${T.costItemId}/`,e)}else{await P.post("/api/cost/",e)}G(),K(),S.success("Item added successfully.")}catch(e){S.error(` ${e}, New Worker`)}finally{M.value=!1}},G=()=>{V("update:modalHandler",!1)},K=()=>{V("update:OnSuccess",null)};a(0),a(0);const J=t((()=>D.value.unit_cost*D.value.quantity));a(0),a(0);const Y=t((()=>D.value.markup>0?J.value+J.value*D.value.markup/100:D.value.margin>0?J.value/(1-D.value.margin/100):J.value));t((()=>(Y.value-J.value)/J.value*100)),t((()=>(Y.value-J.value)/Y.value*100));const Z=o((()=>s((()=>import("./ckeditor-e79d34da.js").then((e=>e.c))),["assets/ckeditor-e79d34da.js","assets/index-b2cddf6b.js","assets/index-ce8747cd.css","assets/vue.runtime.esm-bundler-47467d80.js"]).then((e=>e.default.component)))),X={fontFamily:{options:['"Montserrat", sans-serif','"Roboto", sans-serif']},height:"400px",minHeight:"400px"},je=a(!1);return n((async()=>{x.value=await s((()=>import("./ckeditor-5aa2d5df.js").then((e=>e.c))),["assets/ckeditor-5aa2d5df.js","assets/index-b2cddf6b.js","assets/index-ce8747cd.css"]).then((e=>e.default)),T.previousItemIndex&&(D.value.previousItemIndex=T.previousItemIndex),T.costItemId&&(async()=>{try{je.value=!0;const e=await P.get(`/api/cost/${T.costItemId}/`);D.value=e.data}catch(e){console.log(e)}finally{je.value=!1}})()})),(e,l)=>{const a=L,t=q,o=H,s=N,n=I,V=E,S=k,P=j,B=O;return i(),u(B,{is:"form",open:T.costItemModal,title:"Cost Item ",size:"xl",actions:"right",onSubmit:g(F,["prevent"]),onClose:G},{content:r((()=>[d("div",ee,[c(S,{class:"column is-12"},{default:r((()=>[d("div",le,[d("div",ae,[te,d("div",oe,[p(d("input",{type:"text",name:"firstName","onUpdate:modelValue":l[0]||(l[0]=e=>m(D).title=e),required:"",disabled:T.previewCostItems,class:"input is-primary-focus is-primary-focus",placeholder:"Proposal Title"},null,8,se),[[v,m(D).title]])])]),d("div",ne,[ie,c(s,null,{default:r((()=>[c(o,null,{default:r((()=>[c(t,{modelValue:m(D).cost_type,"onUpdate:modelValue":l[1]||(l[1]=e=>m(D).cost_type=e),disabled:T.previewCostItems},{default:r((()=>[(i(!0),b(f,null,_(m(U),((e,l)=>(i(),u(a,{value:e.value},{default:r((()=>[h(y(e.label),1)])),_:2},1032,["value"])))),256))])),_:1},8,["modelValue","disabled"])])),_:1})])),_:1})]),d("div",ue,[re,d("div",null,[c(n,{size:"small"},{default:r((()=>[h("Add in Catalog")])),_:1})])]),d("div",de,[ce,c(s,null,{default:r((()=>[c(o,null,{default:r((()=>[c(t,{modelValue:m(D).mark_as,"onUpdate:modelValue":l[2]||(l[2]=e=>m(D).mark_as=e),disabled:T.previewCostItems},{default:r((()=>[(i(!0),b(f,null,_(m($),((e,l)=>(i(),u(a,{value:e.value},{default:r((()=>[h(y(e.label),1)])),_:2},1032,["value"])))),256))])),_:1},8,["modelValue","disabled"])])),_:1})])),_:1})]),d("div",pe,[me,c(s,null,{default:r((()=>[c(o,null,{default:r((()=>[c(t,{modelValue:m(D).cost_code,"onUpdate:modelValue":l[3]||(l[3]=e=>m(D).cost_code=e),disabled:T.previewCostItems},{default:r((()=>[(i(!0),b(f,null,_(m(A),((e,l)=>(i(),u(a,{value:e.value},{default:r((()=>[h(y(e.label),1)])),_:2},1032,["value"])))),256))])),_:1},8,["modelValue","disabled"])])),_:1})])),_:1})]),d("div",ve,[be,c(s,null,{default:r((()=>[c(o,null,{default:r((()=>[c(t,{modelValue:m(D).group,"onUpdate:modelValue":l[4]||(l[4]=e=>m(D).group=e),disabled:T.previewCostItems},{default:r((()=>[(i(!0),b(f,null,_(m(W),((e,l)=>(i(),u(a,{value:e.value},{default:r((()=>[h(y(e.label),1)])),_:2},1032,["value"])))),256))])),_:1},8,["modelValue","disabled"])])),_:1})])),_:1})]),d("div",fe,[_e,m(x)?(i(),u(m(Z),{key:0,disabled:T.previewCostItems,modelValue:m(D).description,"onUpdate:modelValue":l[5]||(l[5]=e=>m(D).description=e),editor:m(x),config:X},null,8,["disabled","modelValue","editor"])):C("",!0)]),d("div",he,[ye,c(s,null,{default:r((()=>[c(o,null,{default:r((()=>[c(V,{modelValue:m(D).internal_notes,"onUpdate:modelValue":l[6]||(l[6]=e=>m(D).internal_notes=e),disabled:T.previewCostItems,rows:"4",placeholder:"Internal notes..."},null,8,["modelValue","disabled"])])),_:1})])),_:1})])])])),_:1}),c(S,{class:"column is-12 mt-3"},{default:r((()=>[d("div",Ce,[d("div",we,[ge,c(s,null,{default:r((()=>[c(o,null,{default:r((()=>[c(P,{modelValue:m(D).unit_cost,"onUpdate:modelValue":l[7]||(l[7]=e=>m(D).unit_cost=e),disabled:T.previewCostItems,type:"number",name:"unitCost",placeholder:"Unit cost"},null,8,["modelValue","disabled"])])),_:1})])),_:1})]),d("div",Ie,[ke,c(s,null,{default:r((()=>[c(o,null,{default:r((()=>[c(P,{modelValue:m(D).quantity,"onUpdate:modelValue":l[8]||(l[8]=e=>m(D).quantity=e),disabled:T.previewCostItems,type:"number",name:"quantity",placeholder:"Quantity"},null,8,["modelValue","disabled"])])),_:1})])),_:1})]),d("div",Ve,[Te,c(s,null,{default:r((()=>[c(o,null,{default:r((()=>[c(P,{modelValue:m(D).unit,"onUpdate:modelValue":l[9]||(l[9]=e=>m(D).unit=e),disabled:T.previewCostItems,type:"text",name:"unit",placeholder:"Unit"},null,8,["modelValue","disabled"])])),_:1})])),_:1})]),d("div",xe,[Se,c(s,null,{default:r((()=>[c(o,null,{default:r((()=>[c(P,{modelValue:m(J),"onUpdate:modelValue":l[10]||(l[10]=e=>w(J)?J.value=e:null),disabled:T.previewCostItems,type:"number",name:"builderCost",placeholder:"Builder cost"},null,8,["modelValue","disabled"])])),_:1})])),_:1})]),d("div",Pe,[Me,c(s,null,{default:r((()=>[c(o,null,{default:r((()=>[c(P,{modelValue:m(D).markup,"onUpdate:modelValue":l[11]||(l[11]=e=>m(D).markup=e),disabled:T.previewCostItems,type:"number",name:"markup",placeholder:"Markup"},null,8,["modelValue","disabled"])])),_:1})])),_:1})]),d("div",De,[Ue,c(s,null,{default:r((()=>[c(o,null,{default:r((()=>[c(P,{modelValue:m(Y),"onUpdate:modelValue":l[12]||(l[12]=e=>w(Y)?Y.value=e:null),disabled:T.previewCostItems,type:"number",name:"markup",placeholder:"Total Price"},null,8,["modelValue","disabled"])])),_:1})])),_:1})]),d("div",Ae,[Oe,c(s,null,{default:r((()=>[c(o,null,{default:r((()=>[c(P,{modelValue:m(D).margin,"onUpdate:modelValue":l[13]||(l[13]=e=>m(D).margin=e),disabled:T.previewCostItems,type:"number",name:"markup",placeholder:"Margin"},null,8,["modelValue","disabled"])])),_:1})])),_:1})])])])),_:1})])])),action:r((()=>[T.previewCostItems?(i(),u(n,{key:0,loading:m(M),type:"submit",color:"primary",icon:T.costItemId?"":"fas fa-plus",raised:""},{default:r((()=>[h(y(T.costItemId?"Update":"Add"),1)])),_:1},8,["loading","icon"])):C("",!0)])),_:1},8,["open","onSubmit"])}}}),Ee={class:"modal-form columns is-multiline"},Ne={class:"column is-full"},He={class:"field"},Le=d("label",{class:"label"},"Send To ",-1),qe={class:"control"},Be={class:"column is-full"},Re={class:"field"},Qe=d("label",{class:"label"},"Subject ",-1),ze={class:"control"},We={class:"field column is-full mt-5"},$e=d("label",{class:"label"},"Message",-1),Fe=d("i",{class:"feather:mail"},null,-1),Ge=e({__name:"SendProposalEmailModal",props:{proposalSenderModal:{type:Boolean},proposalData:{},columnsToShow:{}},emits:["update:modalHandler","update:OnSuccess"],setup(e,{emit:t}){const f=e,_=B();a(!1);const y=R(),w=a(!1),k=a(""),T=l(),x=window.origin,S=a(`${x}/proposal-view/?proposal=${f.proposalData?.id}`),P=()=>{t("update:modalHandler",!1)};k.value="<b> Hi  <br />\nIbex Management <br />\n</b>";const M=a({scheduleAt:"",sendToGroup:[],link:"",sendTo:"",subject:"",message:`<p><b>Dear [Client's Name],</b></p>\n  \n  <p>We hope this message finds you well.</p>\n  \n  <p>\n    Please find attached a detailed proposal outlining the cost items associated with the services/products we will be providing. \n    We have carefully curated this proposal to ensure complete transparency and alignment with your expectations.\n  </p>\n  \n  <p>\n    You can review the full proposal, including the cost breakdown, by clicking the link below: <br />\n    <a href="${S.value}" style="color: #007bff; text-decoration: none; font-weight: bold;">View Proposal</a>\n  </p>\n\n  \n  <p><b>Summary of Charges:</b></p>\n  <ul>\n    <li><b>Total Items:</b> [Number of Items]</li>\n    <li><b>Total Amount:</b> [Total Cost]</li>\n  </ul>\n  \n  <p>\n    If you have any questions or require further clarification, feel free to reach out to us at your earliest convenience. \n    We are here to assist you.\n  </p>\n  \n  <p>Thank you for trusting <b>Ibex Team</b> with your project.</p>\n  \n  <p><b>Best Regards,</b><br />\n    Ibex Team\n  </p>`}),D=async()=>{try{w.value=!0;await _.post(`/api/lead-proposal/${f.proposalData?.id}/send-proposal-template/`,{email:M.value.sendTo,subject:M.value.subject,message:M.value.message,scheduleAt:M.value.scheduleAt,link:S.value,column:f.columnsToShow});y.success("Email sent to worker successfully"),P()}catch(e){console.log(e)}finally{w.value=!1}},U=o((()=>s((()=>import("./ckeditor-e79d34da.js").then((e=>e.c))),["assets/ckeditor-e79d34da.js","assets/index-b2cddf6b.js","assets/index-ce8747cd.css","assets/vue.runtime.esm-bundler-47467d80.js"]).then((e=>e.default.component)))),A={fontFamily:{options:['"Montserrat", sans-serif','"Roboto", sans-serif']},height:"400px",minHeight:"400px",maxHeight:"600px"};return n((async()=>{T.value=await s((()=>import("./ckeditor-5aa2d5df.js").then((e=>e.c))),["assets/ckeditor-5aa2d5df.js","assets/index-b2cddf6b.js","assets/index-ce8747cd.css"]).then((e=>e.default))})),(e,l)=>{const a=I,t=O;return i(),b("div",null,[c(V,{name:"fade-slow"},{default:r((()=>[c(t,{is:"form",open:f.proposalSenderModal,title:"Schedule Email",size:"large",actions:"right",onSubmit:g(D,["prevent"]),onClose:P},{content:r((()=>[d("div",Ee,[d("div",Ne,[d("div",He,[Le,d("div",qe,[p(d("input",{type:"email",required:"",class:"input",placeholder:"Enter Mail","onUpdate:modelValue":l[0]||(l[0]=e=>m(M).sendTo=e)},null,512),[[v,m(M).sendTo]])])])]),d("div",Be,[d("div",Re,[Qe,d("div",ze,[p(d("input",{type:"text",required:"",class:"input",placeholder:"Enter mail subject","onUpdate:modelValue":l[1]||(l[1]=e=>m(M).subject=e)},null,512),[[v,m(M).subject]])])])]),d("div",We,[$e,m(T)?(i(),u(m(U),{key:0,modelValue:m(M).message,"onUpdate:modelValue":l[2]||(l[2]=e=>m(M).message=e),editor:m(T),config:A},null,8,["modelValue","editor"])):C("",!0)])])])),action:r((()=>[c(a,{type:"submit",color:"primary",loading:m(w),raised:""},{default:r((()=>[Fe,h(" Send Proposal")])),_:1},8,["loading"])])),cancel:r((()=>[c(a,{color:"light",onClick:P,raised:""},{default:r((()=>[h("Close ")])),_:1})])),_:1},8,["open","onSubmit"])])),_:1})])}}}),Ke={class:"columns is-multiline"},Je=d("div",{class:"column is-9"},[d("h1",{class:"title is-5 m-1 p-0"},"Preview Lead Proposal"),d("p",{class:"m-1"}," Below is a preview of the proposal that will be sent as a link to the email addresses on this client contact. The proposal can be accessed through the link while it is Released. ")],-1),Ye={class:"column is-4"},Ze=d("h1",{class:"subtitle is-5 is-bold"},"Layout Options",-1),Xe=d("h1",{class:"subtitle is-6 mb-0"},"Header",-1),el=d("h1",{class:"subtitle is-6 mb-0"},"Body",-1),ll={class:"column is-4"},al=d("h1",{class:"subtitle is-5 is-bold"},"Customer Information",-1),tl={class:"column is-4"},ol=d("h1",{class:"subtitle is-5 is-bold"},"Company Information",-1),sl={class:"column is-12"},nl={class:"invoice-wrapper"},il=d("div",{class:"left"},[d("h3",null,"Proposal-ID PD-456-14")],-1),ul=d("a",{class:"action"},[d("i",{"aria-hidden":"true",class:"iconify","data-icon":"feather:printer"})],-1),rl=d("a",{class:"action"},[d("i",{"aria-hidden":"true",class:"iconify","data-icon":"feather:download-cloud"})],-1),dl=[d("i",{"aria-hidden":"true",class:"iconify","data-icon":"feather:mail"},null,-1)],cl={class:"invoice-body"},pl={class:"invoice-card"},ml={class:"invoice-section is-flex is-bordered"},vl=d("div",{class:"meta"},null,-1),bl=d("div",{class:"end"},[d("span",null,"PO Box 242"),d("span",null,"Evergreen, CO 80437-0242"),d("span",null,"Phone: 720 272-9061"),d("span",null,"Premium Trades for Premier Builders")],-1),fl=d("div",{class:"invoice-section is-flex is-bordered"},[d("div",{class:"meta"},[d("h3",null,"Client Name"),d("span",null,"Client Phone"),d("span",null,"25724 Independence Trail Evergreen, CO 80439")]),d("div",{class:"end is-left"},[d("h3",null,"Friday Jan 17, 2025"),d("p",null," Lorem ipsum dolor sit amet, consectetur adipiscing elit. Quod equidem non reprehendo. ")])],-1),_l={class:"invoice-section"},hl={class:"responsive-table"},yl=["innerHTML"],Cl={key:1},wl={class:"invoice-section is-flex mt-0 pt-0"},gl={class:"end is-left"},Il={class:"text-right"},kl=d("p",null,"Mentioned price are final",-1),Vl=e({__name:"ProposalPreview",props:{columnsToShow:{},proposalData:{}},setup(e){const l=e,o=G(),s=a(""),p=a(!0),v=a(!1),h=a(!0),g=a(!0),I=a(!0);t((()=>K.value.reduce(((e,l)=>e+l.price*l.quantity),0)));const k=a({}),V=()=>{k.value=l.proposalData,T.value=l.columnsToShow,v.value=!v.value},T=a([]);return n((()=>{})),(e,a)=>{const t=F,n=H,k=N,x=$,S=W,P=Ge;return i(),b("div",Ke,[Je,d("div",Ye,[Ze,Xe,c(k,null,{default:r((()=>[c(n,{class:"flex-columns"},{default:r((()=>[c(t,{modelValue:m(s),"onUpdate:modelValue":a[0]||(a[0]=e=>w(s)?s.value=e:null),value:"center",label:"Centralized",name:"outlined_radio",color:"info",class:"m-0 p-2"},null,8,["modelValue"]),c(t,{modelValue:m(s),"onUpdate:modelValue":a[1]||(a[1]=e=>w(s)?s.value=e:null),value:"split",label:"Space between",name:"outlined_radio",color:"info",class:"m-0 p-2"},null,8,["modelValue"])])),_:1})])),_:1}),el,c(k,null,{default:r((()=>[c(n,{class:"flex-columns"},{default:r((()=>[c(t,{modelValue:m(p),"onUpdate:modelValue":a[2]||(a[2]=e=>w(p)?p.value=e:null),value:"column",label:"Columns",name:"outlined_radio",color:"info",class:"m-0 p-2"},null,8,["modelValue"]),c(t,{modelValue:m(p),"onUpdate:modelValue":a[3]||(a[3]=e=>w(p)?p.value=e:null),value:"multiline",label:"Multiline",name:"outlined_radio",color:"info",class:"m-0 p-2"},null,8,["modelValue"]),c(t,{modelValue:m(p),"onUpdate:modelValue":a[4]||(a[4]=e=>w(p)?p.value=e:null),value:"none",label:"None",name:"outlined_radio",color:"info",class:"m-0 p-2"},null,8,["modelValue"])])),_:1})])),_:1})]),d("div",ll,[al,c(k,{class:"flex-columns"},{default:r((()=>[c(n,{raw:"",subcontrol:""},{default:r((()=>[c(x,{class:"mt-2 p-0",modelValue:m(h),"onUpdate:modelValue":a[5]||(a[5]=e=>w(h)?h.value=e:null),label:"Show Client Contact and Phone",color:"info"},null,8,["modelValue"])])),_:1}),c(n,{raw:"",subcontrol:""},{default:r((()=>[c(x,{class:"mt-4 p-0",modelValue:m(g),"onUpdate:modelValue":a[6]||(a[6]=e=>w(g)?g.value=e:null),label:"Show Address"},null,8,["modelValue"])])),_:1})])),_:1})]),d("div",tl,[ol,c(k,{class:"flex-columns"},{default:r((()=>[c(n,{raw:"",subcontrol:""},{default:r((()=>[c(x,{class:"mt-2 p-0",modelValue:m(I),"onUpdate:modelValue":a[7]||(a[7]=e=>w(I)?I.value=e:null),label:"Show Company One Liner"},null,8,["modelValue"])])),_:1})])),_:1})]),d("div",sl,[d("div",nl,[d("div",{class:"invoice-header"},[il,d("div",{class:"right"},[d("div",{class:"controls"},[ul,rl,d("a",{class:"action",onClick:V},dl)])])]),d("div",cl,[d("div",pl,[d("div",ml,[c(S,{size:"xl",picture:"/logos/IbexFavicon.png"}),vl,bl]),fl,d("div",_l,[d("table",hl,[d("thead",null,[(i(!0),b(f,null,_(l.columnsToShow,((e,l)=>(i(),b("th",{key:l},y(m(J)[e]),1)))),128))]),d("tbody",null,[(i(!0),b(f,null,_(m(o).proposalCostItems,((e,a)=>(i(),b("tr",{key:e.id},[(i(!0),b(f,null,_(l.columnsToShow,((l,a)=>(i(),b("td",{key:a},["Description"===l?(i(),b("div",{key:0,innerHTML:e[m(Y)[l]]},null,8,yl)):(i(),b("span",Cl,y(e[m(Y)[l]]),1))])))),128))])))),128))])])]),d("div",wl,[d("div",gl,[d("h3",Il," Total Price: $"+y(l.proposalData.proposalAmount),1),kl])])])])])]),m(v)?(i(),u(P,{key:0,proposalSenderModal:m(v),proposalData:l.proposalData,columnsToShow:m(T),"onUpdate:modalHandler":a[8]||(a[8]=e=>v.value=!1)},null,8,["proposalSenderModal","proposalData","columnsToShow"])):C("",!0)])}}}),Tl=e=>(T("data-v-2ecb0489"),e=e(),x(),e),xl={class:"datatable-wrapper mt-0"},Sl={class:"table-container"},Pl={class:"table datatable-table is-fullwidth",id:"external-events"},Ml=Tl((()=>d("th",null,"Item#",-1))),Dl=Tl((()=>d("th",null,"Actions",-1))),Ul=["data-event","onDragstart","onDrop"],Al={class:"is-relative"},Ol=["onClick"],jl=Tl((()=>d("i",{style:{cursor:"grab"},class:"lnir lnir-sort","aria-hidden":"true"},null,-1))),El=["innerHTML"],Nl={key:1},Hl=["onClick"],Ll=[Tl((()=>d("div",{class:"icon"},[d("i",{"aria-hidden":"true",class:"lnil lnil-eye"})],-1))),Tl((()=>d("div",{class:"meta"},[d("span",null,"View"),d("span",null,"View user details")],-1)))],ql=["onClick"],Bl=[Tl((()=>d("div",{class:"icon"},[d("i",{"aria-hidden":"true",class:"lnil lnil-briefcase"})],-1))),Tl((()=>d("div",{class:"meta"},[d("span",null,"Edit"),d("span",null,"Edit Cost Item")],-1)))],Rl=Tl((()=>d("hr",{class:"dropdown-divider"},null,-1))),Ql=["onClick"],zl=[Tl((()=>d("div",{class:"icon"},[d("i",{"aria-hidden":"true",class:"lnil lnil-trash-can-alt"})],-1))),Tl((()=>d("div",{class:"meta"},[d("span",null,"Remove"),d("span",null,"Remove from list")],-1)))],Wl=e({__name:"CostItemsTable",props:{columnsToShow:{},itemsList:{}},setup(e){const l=e,t=G(),o=R(),s=a({CostCode:"Cost Code",Title:"Title",Unit:"Unit",Description:"Description",CostType:"Cost Type",MarkAs:"Mark As",Quantity:"Quantity",UnitCost:"Unit Cost",BuilderCost:"Builder Cost",Markup:"Markup",MarkupAmount:"Markup Amount",Status:"Status",ClientPrice:"Client Price",GroupPrice:"Group Price",TotalCost:"Total Cost",TotalMarkup:"Total Markup",Profit:"Profit",Notes:"Internal Notes",State:"State"}),p=a({CostCode:"cost_code",Title:"title",Unit:"unit",Description:"description",CostType:"cost_type",MarkAs:"mark_as",Quantity:"quantity",UnitCost:"unit_cost",ClientPrice:"total_price",BuilderCost:"builder_cost",Markup:"markup",Status:"status",GroupPrice:"group_amount",TotalMarkup:"total_markup",Profit:"profit",Notes:"internal_notes",MarkupAmount:"markup_amount"}),v=a({title:"",subtitle:"test",isSweetAlertOpen:!1,btntext:"text"}),h=B(),w=a(""),I=a(!1);a([]);const k=e=>{e.preventDefault()},V=e=>{e.preventDefault(),e.currentTarget?.classList.add("drag-over")},T=e=>{e.preventDefault(),e.currentTarget?.classList.remove("drag-over")},x=a(""),S=a(0),P=a(""),M=a(!1),D=a(!1),U=async()=>{try{D.value=!0;await h.delete(`/api/cost/${P.value}/`);O(),v.value.isSweetAlertOpen=!1,o.success("Cost item deleted")}catch(e){console.log(e)}finally{D.value=!1}},A=(e,l=!1)=>{P.value=e.id,M.value=l,x.value=e.proposal,I.value=!I.value},O=()=>{t.getProposalCostItems(x.value)};return n((()=>{})),(e,a)=>{const o=X,n=Z,D=je;return i(),b("div",xl,[d("div",Sl,[d("table",Pl,[d("thead",null,[Ml,(i(!0),b(f,null,_(l.columnsToShow,((e,l)=>(i(),b("th",{key:l},y(m(s)[e]),1)))),128)),Dl]),d("tbody",null,[m(t).proposalCostItems.length>0?(i(!0),b(f,{key:0},_(m(t).proposalCostItems,((e,a)=>(i(),b("tr",{key:e.id,"data-event":JSON.stringify(e),draggable:"true",onDragstart:l=>{return a=e.id,w.value=a,void console.log("Drag started for ID:",a);var a},onDrop:l=>(e=>{console.log("Dropped on ID:",e);const l=t.proposalCostItems.find((e=>e.id===w.value)),a=t.proposalCostItems.find((l=>l.id===e));if(l&&a){h.post("/api/cost/drag-drop-items/",{dragged_item_id:l.id,dropped_item_id:a.id});const e=t.proposalCostItems.indexOf(l),o=t.proposalCostItems.indexOf(a);e>=0&&o>=0&&(t.proposalCostItems.splice(e,1),t.proposalCostItems.splice(o,0,l))}else console.error("Dragged or Dropped Item not found");w.value=null})(e.id),onDragover:k,onDragenter:V,onDragleave:T,class:"draggable-item events"},[d("td",Al,[d("i",{style:{position:"absolute",bottom:"-7px",left:"1px",cursor:"pointer","font-weight":"600"},onClick:l=>(e=>{x.value=e.proposal,S.value=e.index,I.value=!I.value})(e),class:"lnir lnir-circle-plus info-text","aria-hidden":"true"},null,8,Ol),jl]),(i(!0),b(f,null,_(l.columnsToShow,((l,a)=>(i(),b("td",{key:a},["Description"===l?(i(),b("div",{key:0,innerHTML:e[m(p)[l]]},null,8,El)):(i(),b("span",Nl,y(e[m(p)[l]]),1))])))),128)),d("td",null,[c(o,{icon:"feather:more-vertical",class:"is-pushed-mobile",spaced:"",right:""},{content:r((({close:l})=>[d("a",{role:"menuitem",href:"#",class:"dropdown-item is-media",onClick:g((()=>{A(e,!0),l()}),["prevent"])},Ll,8,Hl),d("a",{role:"menuitem",href:"#",class:"dropdown-item is-media",onClick:g((()=>{A(e,!1),l()}),["prevent"])},Bl,8,ql),Rl,d("a",{role:"menuitem",href:"#",class:"dropdown-item is-media",onClick:g((()=>{(e=>{P.value=e.id,x.value=e.proposal,v.value={title:"Are you sure?",subtitle:"You will not be able to recover this cost item!",btntext:"Delete",isSweetAlertOpen:!0}})(e),l()}),["prevent"])},zl,8,Ql)])),_:2},1024)])],40,Ul)))),128)):C("",!0)])])]),m(v).isSweetAlertOpen?(i(),u(n,{key:0,isSweetAlertOpen:m(v).isSweetAlertOpen,title:m(v).title,subtitle:m(v).subtitle,btntext:m(v).btntext,onConfirm:U,onCancel:()=>m(v).isSweetAlertOpen=!1},null,8,["isSweetAlertOpen","title","subtitle","btntext","onCancel"])):C("",!0),m(I)?(i(),u(D,{key:1,costItemModal:m(I),proposalId:m(x),costItemId:m(P),previousItemIndex:m(S),previewCostItems:m(M),"onUpdate:modalHandler":a[0]||(a[0]=e=>I.value=!1),"onUpdate:OnSuccess":O},null,8,["costItemModal","proposalId","costItemId","previousItemIndex","previewCostItems"])):C("",!0)])}}}),$l=S(Wl,[["__scopeId","data-v-2ecb0489"]]),Fl={class:"columns is-multiline"},Gl={class:"column is-12 is-flex space-between"},Kl=d("div",null,[d("h1",{class:"title is-4"},"Proposal Worksheet")],-1),Jl={key:0,class:"column is-12"},Yl={class:"tabs-wrapper column is-12 m-0"},Zl={class:"tabs-inner mt-4"},Xl={class:"tabs is-boxed"},ea=[d("span",null,"Worksheet",-1)],la=[d("span",null,"Format",-1)],aa=[d("span",null,"Preview",-1)],ta={key:0,class:"column is-12"},oa={key:0,class:"column is-12"},sa={class:"columns is-multiline"},na=d("div",{class:"column is-12",style:{"text-align":"center"}},[d("h1",{class:"title is-4"},"Connect your clients to their projects"),d("h1",{class:"title is-5"}," Create a client contact and assign them to jobs and lead opportunities effortlessly. ")],-1),ia={class:"column is-12"},ua={key:0,class:"column is-12"},ra=e({__name:"WorksheetItems",props:{leadProposalModal:{type:Boolean},proposalId:{},proposalData:{}},emits:["update:modalHandler","update:OnSuccess"],setup(e,{emit:t}){const p=e,v=l();z(),R(),B(),a(!1),a({});const f=G();a(!1);const _=a(["Title","CostCode","Description","Quantity","UnitCost","Unit","ClientPrice"]),y=[{value:"ItemNumber",label:"Item Number"},{value:"Title",label:"Title"},{value:"CostCode",label:"Cost Code"},{value:"Description",label:"Description"},{value:"Quantity",label:"Quantity"},{value:"UnitCost",label:"Unit Cost"},{value:"Unit",label:"Unit"},{value:"BuilderCost",label:"Builder Cost"},{value:"Markup",label:"Markup"},{value:"ClientPrice",label:"Client Price"},{value:"CostType",label:"Cost Type"},{value:"GroupPrice",label:"Group Price"},{value:"TotalMarkup",label:"Total Markup"},{value:"MarkupAmount",label:"Markup Amount"},{value:"Profit",label:"Profit"},{value:"Notes",label:"Notes"}];a({title:"",description:"",quantity:0,unit:0,unitCost:0,markup:0,clientPrice:0,costCode:"",costType:"",builderCost:"",margin:0,profit:0,internalNotes:""}),a({title:"",attachments:[],approvalDeadline:"",internalNotes:"",introductoryText:"",closingText:"",paymentStatus:"",worksheetItems:[]});const V=a("worksheet");o((()=>s((()=>import("./ckeditor-e79d34da.js").then((e=>e.c))),["assets/ckeditor-e79d34da.js","assets/index-b2cddf6b.js","assets/index-ce8747cd.css","assets/vue.runtime.esm-bundler-47467d80.js"]).then((e=>e.default.component))));const T=a(!1),x=a(!1);a({id:"",type:"",total_price:0,cost_code:"",cost_type:"",builder_cost:0,internal_notes:"",mark_as:"",state:"",title:"",costType:"",description:"",quantity:0,unit:0,unit_cost:0,markup:0,clientPrice:0,costCode:"",builderCost:"",margin:0,profit:0,internalNotes:"",includeInCatalog:!1,markAs:"",group:"",proposal:""});const S=async()=>{try{f.getProposalCostItems(p.proposalId)}catch(e){console.log(e)}};return n((async()=>{v.value=await s((()=>import("./ckeditor-5aa2d5df.js").then((e=>e.c))),["assets/ckeditor-5aa2d5df.js","assets/index-b2cddf6b.js","assets/index-ce8747cd.css"]).then((e=>e.default)),p.proposalId&&S()})),P((()=>{f.clearProposalId()})),(e,l)=>{const a=I,t=M("Multiselect"),o=H,s=N,n=$l,v=k,f=Vl,P=je;return i(),b("div",null,[d("div",Fl,[d("div",Gl,[Kl,d("div",null,[c(a,{size:"small",light:"",outlined:"",icon:"fas fa-cog",class:"mr-2",color:m(x)?"danger":"success",onClick:l[0]||(l[0]=e=>x.value=!m(x))},{default:r((()=>[h("Table")])),_:1},8,["color"]),c(a,{size:"small",light:"",outlined:"",class:"mr-2",color:"info",onClick:l[1]||(l[1]=e=>T.value=!m(T))},{default:r((()=>[h("Import")])),_:1}),c(a,{size:"small",light:"",outlined:"",class:"mr-2",color:"primary",onClick:l[2]||(l[2]=e=>T.value=!m(T))},{default:r((()=>[h("Add From")])),_:1}),c(a,{size:"small",light:"",outlined:"",color:"warning",onClick:l[3]||(l[3]=e=>T.value=!m(T))},{default:r((()=>[h("Add Item")])),_:1})])]),c(D,{class:"fade-slow",name:"fade-slow"},{default:r((()=>[m(x)?(i(),b("div",Jl,[c(s,{label:"Choose what to show to lead",class:"column is-12"},{default:r((({id:e})=>[c(o,null,{default:r((()=>[c(t,{modelValue:m(_),"onUpdate:modelValue":l[4]||(l[4]=e=>w(_)?_.value=e:null),attrs:{id:e},mode:"tags",searchable:!0,"create-tag":!0,options:y,placeholder:"Add columns"},null,8,["modelValue","attrs"])])),_:2},1024)])),_:1})])):C("",!0)])),_:1}),d("div",Yl,[d("div",Zl,[d("div",Xl,[d("ul",null,[d("li",{class:U(["worksheet"===m(V)?"is-active":"not-active"])},[d("a",{tabindex:"0",role:"button",onKeydown:l[5]||(l[5]=A(g((e=>V.value="worksheet"),["prevent"]),["space"])),onClick:l[6]||(l[6]=e=>V.value="worksheet")},ea,32)],2),d("li",{class:U(["format"===m(V)?"is-active":"not-active"])},[d("a",{tabindex:"0",role:"button",onKeydown:l[7]||(l[7]=A(g((e=>V.value="format"),["prevent"]),["space"])),onClick:l[8]||(l[8]=e=>V.value="format")},la,32)],2),d("li",{class:U(["preview"===m(V)?"is-active":"not-active"])},[d("a",{tabindex:"0",role:"button",onKeydown:l[9]||(l[9]=A(g((e=>V.value="preview"),["prevent"]),["space"])),onClick:l[10]||(l[10]=e=>V.value="preview")},aa,32)],2)])])])]),c(D,{class:"fade-slow",name:"slide-x"},{default:r((()=>["worksheet"===m(V)?(i(),b("div",ta,[c(n,{columnsToShow:m(_),proposalId:p.proposalId},null,8,["columnsToShow","proposalId"])])):C("",!0)])),_:1}),c(D,{class:"fade-slow",name:"slide-x"},{default:r((()=>["format"===m(V)?(i(),b("div",oa,[d("div",sa,[c(s,{label:"Choose what to show to lead",class:"column is-12"},{default:r((({id:e})=>[c(o,null,{default:r((()=>[c(t,{modelValue:m(_),"onUpdate:modelValue":l[11]||(l[11]=e=>w(_)?_.value=e:null),attrs:{id:e},mode:"tags",searchable:!0,"create-tag":!0,options:y,placeholder:"Add tags"},null,8,["modelValue","attrs"])])),_:2},1024)])),_:1})]),c(v,{class:"columns is-multiline m-0"},{default:r((()=>[na,d("div",ia,[c(n,{columnsToShow:m(_)},null,8,["columnsToShow"])])])),_:1})])):C("",!0)])),_:1}),c(D,{class:"fade-slow",name:"slide-x"},{default:r((()=>["preview"===m(V)?(i(),b("div",ua,[c(f,{proposalData:p.proposalData,columnsToShow:m(_)},null,8,["proposalData","columnsToShow"])])):C("",!0)])),_:1})]),m(T)?(i(),u(P,{key:0,costItemModal:m(T),proposalId:p.proposalId,"onUpdate:modalHandler":l[12]||(l[12]=e=>T.value=!1),"onUpdate:OnSuccess":S},null,8,["costItemModal","proposalId"])):C("",!0)])}}});export{ra as _};
