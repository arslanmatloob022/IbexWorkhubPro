import{_ as e}from"./VField.vue_vue_type_script_setup_true_lang-83f8a996.js";import{_ as t}from"./VControl-e560833d.js";import{_ as a}from"./VInput.vue_vue_type_script_setup_true_lang-aec5dd2e.js";import{f as s,b as o,r,o as l,C as n,D as i,E as u,F as c,G as p,m as d,k as m,J as v,U as f,S as _,A as h,O as y,am as b}from"./index-1e2858ba.js";import{F as g}from"./FullCalendar-5d7402ad.js";import{i as j}from"./index-55eb4335.js";import{i as w}from"./index-37e62c97.js";import{u as k}from"./useNotyf-80993c7d.js";import{u as x}from"./useAPI-1926e190.js";import{u as C}from"./viewWrapper-a3ea302f.js";import{b as I}from"./route-block-83d24a4e.js";import"./VLabel.vue_vue_type_script_setup_true_lang-40320205.js";import"./useVFieldContext-cce803fd.js";import"./notyf-05b8acf3.js";import"./useThemeColors-7ef384fe.js";const T=["onSubmit"],V={class:"datatable-toolbar"},S={style:{display:"flex","flex-wrap":"wrap","align-items":"center","justify-content":"space-between"}},W={style:{"font-weight":"500","margin-bottom":"0px","padding-left":"10px"}},D=_(s({__name:"ProjectWorkerCalendar",setup(s){const _=x();o(),k();const h=r(!1);r(!1),r(""),r(!1),r("all");const y=r(""),b=r([]);r([]);const C=r([]);r(0),r(""),r("");const I=r(0),D=r(!0);r(!1),r(0),r({all:"all",active:"active",pending:"pending",completed:"completed"});const F=r({pending:"#8392ab",active:"#fbcf33",completed:"#82d616",canceled:"#344767"}),L=r({plugins:[j,w],schedulerLicenseKey:"0965592368-fcs-1694657447",initialView:"resourceTimelineMonth",height:"auto",themeSystem:"cerulean",resourceAreaWidth:"20%",resourceGroupField:"title",resourcesInitiallyExpanded:!1,selectable:!0,headerToolbar:{left:"today prev,next",center:"title",right:"resourceTimelineWeek,resourceTimelineMonth,resourceTimelineYear"},editable:!0,views:{resourceTimelineWeek:{slotDuration:{days:1,hours:1},slotLabelFormat:{weekday:"short",month:"numeric",day:"numeric",year:"numeric"}}},resourceAreaHeaderContent:"Workers",resources:[],resourceId:I.value}),E=e=>{let t=new Date(e);return t.setDate(t.getDate()+1),t.toISOString().slice(0,10)},P=()=>{let e=[],t=[];t=y.value?A.value.filter((e=>e.username.toLowerCase().includes(y.value.toLowerCase()))):A.value,t.forEach((t=>{e.push({id:t.id,title:t.username})})),L.value.resources=e},A=r([]),M=async()=>{try{h.value=!0,console.log("inside all projects func");const e=await _.get("/api/users/by-role/worker/",{});A.value=e.data,h.value=!1}catch(e){console.error(e),A.value=[],h.value=!1}},U=async()=>{try{const e=await _.get("/api/task/all-tasks/",{});b.value=e.data}catch(e){b.value=[]}};return l((async()=>{await Promise.all([M(),U()]),(()=>{console.log(C.value);const e=[],t=[];A.value.forEach((a=>{b.value.forEach((t=>{t.workers.includes(a.id)&&e.push({id:t.id,resourceId:a.id,project:t.project,start:t.startDate,end:E(t.endDate),title:t.title,color:t.color,description:t.description,borderColor:F[t.status],projectInfo:t.projectInfo})})),t.push({id:a.id,title:a.username})})),L.value.resources=t,L.value.events=[...e]})(),console.log("projects",L.value),D.value=!0})),(s,o)=>{const r=a,l=t,_=e;return n(),i("div",null,[u("form",{onSubmit:v(P,["prevent"])},[u("div",V,[c(_,{elevated:""},{default:p((()=>[c(l,{icon:"fas fa-search"},{default:p((()=>[c(r,{type:"text",placeholder:"Search worker...",modelValue:d(y),"onUpdate:modelValue":o[0]||(o[0]=e=>m(y)?y.value=e:null),onInput:o[1]||(o[1]=e=>P()),class:""},null,8,["modelValue"])])),_:1})])),_:1})])],40,T),c(d(g),{options:d(L)},{eventContent:p((e=>[u("div",S,[u("p",W," ("+f(e.event.extendedProps.projectInfo.title)+") "+f(e.event.title),1)])])),_:1},8,["options"])])}}}),[["__scopeId","data-v-bb268ff5"]]),F={class:"page-content-inner"},L=u("div",{class:"lifestyle-dashboard-bg has-top-nav"},null,-1),E=s({__name:"index",setup:e=>(C().setPageTitle("Workers Tasks"),h({title:"Workers tasks"}),(e,t)=>{const a=D;return n(),i("div",F,[(n(),y(b,{to:"[data-teleport-bg]"},[L])),c(a)])})});"function"==typeof I&&I(E);export{E as default};
