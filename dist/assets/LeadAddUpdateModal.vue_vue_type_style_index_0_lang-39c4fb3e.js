import{_ as l}from"./VModal.vue_vue_type_style_index_0_lang-b7a7d01e.js";import{a as e}from"./LeadProposalsList.vue_vue_type_style_index_0_lang-9a3c899d.js";import{e as a,s,r as t,o as i,B as o,N as n,F as d,D as c,E as u,K as r,l as m,W as p,J as v,I as f,a4 as b,O as y,b as _,_ as g,A as h,C as V,ab as C,aE as S,M as x,a0 as U,aF as k,w as j,H as w,G as I,U as N,V as M,T as A,j as E}from"./index-3945af1d.js";import{_ as P}from"./VControl-35e5f906.js";import{_ as L}from"./VSwitchBlock.vue_vue_type_style_index_0_lang-03543521.js";import{u as H,a as D}from"./useAPI-9c0b6639.js";import{u as O}from"./useNotyf-98e8ba5f.js";import{a as R}from"./useSupportElement-f3d65a2b.js";import{u as T}from"./userSession-0cb55279.js";import{_ as F}from"./VField.vue_vue_type_script_setup_true_lang-ffcf89bd.js";import{_ as z,a as $}from"./VOption.vue_vue_type_style_index_0_lang-7999977c.js";import{C as G}from"./ckeditor-4752a33c.js";import{C as W}from"./ckeditor-fae0a979.js";const q={class:"modal-form columns is-multiline"},B={class:"column is-12 m-0"},K=c("div",{class:"column is-12"},[c("h3",{class:"title is-6 mb-2"},"Contact Information")],-1),Z={class:"field column is-6 mb-0"},J=c("label",null,"First Name *",-1),X={class:"control"},Y={class:"field column is-6 mb-0"},Q=c("label",null,"Last Name ",-1),ll={class:"control"},el={class:"field column is-6 mb-0"},al=c("label",null,"Display Name * ",-1),sl={class:"control"},tl={class:"field column is-6 mb-0"},il=c("label",null,"Primary Email ",-1),ol={class:"control"},nl={class:"field column is-12 mb-0"},dl=c("label",null,"Street Address ",-1),cl={class:"control"},ul={class:"field column is-6 mb-0"},rl=c("label",null,"City: ",-1),ml={class:"control"},pl={class:"field column is-3 mb-0"},vl=c("label",null,"State: ",-1),fl={class:"control"},bl={class:"field column is-3 mb-0"},yl=c("label",null,"Zip Code: ",-1),_l={class:"control"},gl={class:"field column is-6 mb-0"},hl=c("label",null,"Phone ",-1),Vl={class:"control"},Cl={class:"field column is-6 mb-0"},Sl=c("label",null,"Cell Phone ",-1),xl={class:"control"},Ul=c("div",{class:"column is-12"},[c("h3",{class:"title is-6 mb-2"},"Security & Login")],-1),kl={class:"field column is-3 mb-0"},jl={class:"field column is-3 mb-0"},wl=a({__name:"AddUpdateContactModal",props:{addUpdateContactModal:{type:Boolean},userId:{}},emits:["update:modalHandler","update:OnSuccess"],setup(e,{emit:a}){const _=e;s(),T();const g=O(),h=H(),V=t(!1),C=t({}),S=t({firstName:"",lastName:"",displayName:"",address:"",city:"",state:"",zipCode:"",phone:"",cellPhone:"",email:"",latitude:"",longitude:"",loginAllowed:!1,inviteLogin:!1}),x=async()=>{try{V.value=!0;const l=R(C.value,["profileImageURL"]);await h.post("/v3/api/worker/",l);U(),g.dismissAll(),g.success("New worker added, New Worker")}catch(l){g.error(` ${l}, New Worker`)}finally{V.value=!1}},U=()=>{a("update:modalHandler",!1)},k=async()=>{try{const l=await D.get(`https://maps.googleapis.com/maps/api/geocode/json?address=${C.value.postCode}&key=AIzaSyDWHedwkLGGa4_3XgPqYxIzMkFpOdKJRik`);"OK"===l.data.status?(S.value.address=l.data.results[0].formatted_address,S.value.latitude=l.data.results[0].geometry.location.lat,S.value.longitude=l.data.results[0].geometry.location.lng,g.success("Address Added")):"ZERO_RESULTS"===l.data.status&&g.error("Invalid Post-Code")}catch(l){g.error("Invalid Post-Code"),console.error(l)}};return i((()=>{})),(e,a)=>{const s=b,t=L,i=P,g=y,h=l;return o(),n(h,{is:"form",open:_.addUpdateContactModal,title:"Contact Person",size:"big",actions:"right",onSubmit:f(x,["prevent"]),onClose:U},{content:d((()=>[c("div",q,[c("div",B,[u(s,{class:"columns is-multiline"},{default:d((()=>[K,c("div",Z,[J,c("div",X,[r(c("input",{type:"text",name:"firstName","onUpdate:modelValue":a[0]||(a[0]=l=>m(S).firstName=l),required:"",class:"input is-primary-focus is-primary-focus",placeholder:"First Name"},null,512),[[p,m(S).firstName]])])]),c("div",Y,[Q,c("div",ll,[r(c("input",{type:"text",name:"lastName","onUpdate:modelValue":a[1]||(a[1]=l=>m(S).lastName=l),class:"input is-primary-focus is-primary-focus",placeholder:"Last Name"},null,512),[[p,m(S).lastName]])])]),c("div",el,[al,c("div",sl,[r(c("input",{required:"",type:"text",name:"disName","onUpdate:modelValue":a[2]||(a[2]=l=>m(S).lastName=l),class:"input is-primary-focus is-primary-focus",placeholder:"Display Name"},null,512),[[p,m(S).lastName]])])]),c("div",tl,[il,c("div",ol,[r(c("input",{type:"email",name:"email","onUpdate:modelValue":a[3]||(a[3]=l=>m(S).email=l),class:"input is-primary-focus is-primary-focus",placeholder:"Contact email"},null,512),[[p,m(S).email]])])]),c("div",nl,[dl,c("div",cl,[r(c("input",{required:"",type:"text",name:"address","onUpdate:modelValue":a[4]||(a[4]=l=>m(S).lastName=l),class:"input is-primary-focus is-primary-focus",placeholder:"Street Address"},null,512),[[p,m(S).lastName]])])]),c("div",ul,[rl,c("div",ml,[r(c("input",{type:"text",name:"city","onUpdate:modelValue":a[5]||(a[5]=l=>m(S).city=l),class:"input is-primary-focus is-primary-focus",placeholder:"City"},null,512),[[p,m(S).city]])])]),c("div",pl,[vl,c("div",fl,[r(c("input",{type:"text",name:"state","onUpdate:modelValue":a[6]||(a[6]=l=>m(S).state=l),class:"input is-primary-focus is-primary-focus",placeholder:"State"},null,512),[[p,m(S).state]])])]),c("div",bl,[yl,c("div",_l,[r(c("input",{type:"tel",name:"zipCode",onBlur:k,"onUpdate:modelValue":a[7]||(a[7]=l=>m(S).zipCode=l),class:"input is-primary-focus is-primary-focus",placeholder:"Zip code"},null,544),[[p,m(S).zipCode]])])]),c("div",gl,[hl,c("div",Vl,[r(c("input",{type:"tel",name:"phone","onUpdate:modelValue":a[8]||(a[8]=l=>m(S).phone=l),class:"input is-primary-focus is-primary-focus",placeholder:"Phone Number"},null,512),[[p,m(S).phone]])])]),c("div",Cl,[Sl,c("div",xl,[r(c("input",{type:"tel",name:"phone","onUpdate:modelValue":a[9]||(a[9]=l=>m(S).cellPhone=l),class:"input is-primary-focus is-primary-focus",placeholder:"Cell Phone"},null,512),[[p,m(S).cellPhone]])])])])),_:1}),u(s,{class:"columns is-multiline mt-3"},{default:d((()=>[Ul,c("div",kl,[u(i,{subcontrol:""},{default:d((()=>[u(t,{thin:"",color:"primary",modelValue:m(S).loginAllowed,"onUpdate:modelValue":a[10]||(a[10]=l=>m(S).loginAllowed=l),label:"Allow login"},null,8,["modelValue"])])),_:1})]),c("div",jl,[u(i,{subcontrol:""},{default:d((()=>[u(t,{thin:"",color:"primary",modelValue:m(S).inviteLogin,"onUpdate:modelValue":a[11]||(a[11]=l=>m(S).inviteLogin=l),label:"Send invite"},null,8,["modelValue"])])),_:1})])])),_:1})])])])),action:d((()=>[u(g,{loading:m(V),type:"submit",color:"primary",icon:"fas fa-plus",raised:""},{default:d((()=>[v("Add Contact")])),_:1},8,["loading"])])),_:1},8,["open","onSubmit"])}}}),Il={class:"modal-form columns is-multiline"},Nl={class:"field column is-full"},Ml=c("label",{class:"label"},"Schedule Mail ",-1),Al=["value"],El={class:"column is-full"},Pl={class:"field"},Ll=c("label",{class:"label"},"To ",-1),Hl={class:"control"},Dl={class:"column is-full"},Ol={class:"field"},Rl=c("label",{class:"label"},"Subject ",-1),Tl={class:"control"},Fl={class:"field column is-full mt-5"},zl=c("label",{class:"label"},null,-1),$l=c("i",{class:"feather:mail"},null,-1),Gl=a({__name:"GenericEmailSender",props:{mailSenderModal:{type:Boolean},subject:{}},emits:["update:modalHandler","update:OnSuccess"],setup(e,{emit:a}){const b=e,j=H(),w=t(!1),I=O(),N=t(!1),M=t(""),A=s(),E=()=>{a("update:modalHandler",!1)};M.value="<b> Hi  <br />\nIbex Management <br />\n</b>";const L=t({scheduled_at:"",mailGroup:[],mail:"",subject:"",message:""}),D=async()=>{try{N.value=!0;await j.post("",{mail:L.value.mail,subject:L.value.subject,message:L.value.message,scheduled_at:L.value.scheduled_at});I.success("Email sent to worker successfully"),E()}catch(l){console.log(l)}finally{N.value=!1}},R=_((()=>g((()=>import("./ckeditor-4752a33c.js").then((l=>l.c))),["assets/ckeditor-4752a33c.js","assets/index-3945af1d.js","assets/index-ce8747cd.css","assets/vue.runtime.esm-bundler-60de206f.js"]).then((l=>l.default.component)))),T={fontFamily:{options:['"Montserrat", sans-serif','"Roboto", sans-serif']},height:"400px",minHeight:"400px",maxHeight:"600px"};return i((async()=>{A.value=await g((()=>import("./ckeditor-fae0a979.js").then((l=>l.c))),["assets/ckeditor-fae0a979.js","assets/index-3945af1d.js","assets/index-ce8747cd.css"]).then((l=>l.default))})),(e,a)=>{const s=P,t=F,i=h("VDatePicker"),_=k,g=y,j=l;return o(),V("div",null,[u(U,{name:"fade-slow"},{default:d((()=>[u(j,{is:"form",open:b.mailSenderModal,title:"Send Email",size:"large",actions:"right",onSubmit:f(D,["prevent"]),onClose:E},{content:d((()=>[c("div",Il,[c("div",Nl,[Ml,u(_,null,{default:d((()=>[u(i,{modelValue:m(L).scheduled_at,"onUpdate:modelValue":a[0]||(a[0]=l=>m(L).scheduled_at=l),mode:"dateTime"},{default:d((({inputValue:l,inputEvents:e})=>[u(t,null,{default:d((()=>[u(s,{icon:"lucide:calendar"},{default:d((()=>[c("input",C({class:"input v-input",type:"text",value:l},S(e,!0)),null,16,Al)])),_:2},1024)])),_:2},1024)])),_:1},8,["modelValue"])])),_:1})]),c("div",El,[c("div",Pl,[Ll,c("div",Hl,[r(c("input",{type:"email",required:"",class:"input",placeholder:"Enter Mail","onUpdate:modelValue":a[1]||(a[1]=l=>m(L).mail=l)},null,512),[[p,m(L).mail]])])])]),c("div",Dl,[c("div",Ol,[Rl,c("div",Tl,[r(c("input",{type:"text",required:"",class:"input",placeholder:"Enter mail subject","onUpdate:modelValue":a[2]||(a[2]=l=>m(L).subject=l)},null,512),[[p,m(L).subject]])])])]),c("div",Fl,[zl,m(A)?(o(),n(m(R),{key:0,modelValue:m(L).message,"onUpdate:modelValue":a[3]||(a[3]=l=>m(L).message=l),editor:m(A),config:T},null,8,["modelValue","editor"])):x("",!0)])])])),action:d((()=>[u(g,{onClick:D,color:"primary",loading:m(w),raised:""},{default:d((()=>[$l,v(" Schedule Mail")])),_:1},8,["loading"])])),cancel:d((()=>[u(g,{color:"light",onClick:E,raised:""},{default:d((()=>[v("Close ")])),_:1})])),_:1},8,["open","onSubmit"])])),_:1})])}}}),Wl={class:"modal-form columns is-multiline"},ql={class:"column is-full"},Bl={class:"field"},Kl=c("label",{class:"label"},"To ",-1),Zl={class:"control"},Jl={class:"column is-full"},Xl={class:"field"},Yl=c("label",{class:"label"},"Subject ",-1),Ql={class:"control"},le={class:"field column is-half"},ee=c("label",{class:"label"},"Schedule Mail ",-1),ae=["value"],se={class:"field column is-half"},te=c("div",{class:"file"},[c("label",{class:"file-label"},[c("input",{class:"file-input",type:"file",name:"resume"}),c("span",{class:"file-cta"},[c("span",{class:"file-icon"},[c("i",{class:"fas fa-cloud-upload-alt"})]),c("span",{class:"file-label"}," Choose a file… ")])])],-1),ie={class:"field column is-full mt-5"},oe=c("label",{class:"label"},null,-1),ne=c("i",{class:"feather:mail"},null,-1),de=a({__name:"ScheduleEmailModal",props:{mailSchedulerModal:{type:Boolean},subject:{}},emits:["update:modalHandler","update:OnSuccess"],setup(e,{emit:a}){const b=e,j=H(),w=t(!1),I=O(),N=t(!1),M=t(""),A=s(),E=()=>{a("update:modalHandler",!1)};M.value="<b> Hi  <br />\nIbex Management <br />\n</b>";const L=t({objectId:"",subject:"",content:"",mail:"",scheduled_at:"",sent_at:"",status:"",mailGroup:[]}),D=async()=>{try{N.value=!0;await j.post("",{mail:L.value.mail,subject:L.value.subject,content:L.value.content,scheduled_at:L.value.scheduled_at});I.success("Email sent to worker successfully"),E()}catch(l){console.log(l)}finally{N.value=!1}},R=_((()=>g((()=>import("./ckeditor-4752a33c.js").then((l=>l.c))),["assets/ckeditor-4752a33c.js","assets/index-3945af1d.js","assets/index-ce8747cd.css","assets/vue.runtime.esm-bundler-60de206f.js"]).then((l=>l.default.component)))),T={fontFamily:{options:['"Montserrat", sans-serif','"Roboto", sans-serif']},height:"400px",minHeight:"400px",maxHeight:"600px"};return i((async()=>{A.value=await g((()=>import("./ckeditor-fae0a979.js").then((l=>l.c))),["assets/ckeditor-fae0a979.js","assets/index-3945af1d.js","assets/index-ce8747cd.css"]).then((l=>l.default))})),(e,a)=>{const s=P,t=F,i=h("VDatePicker"),_=k,g=y,j=l;return o(),V("div",null,[u(U,{name:"fade-slow"},{default:d((()=>[u(j,{is:"form",open:b.mailSchedulerModal,title:"Schedule Email",size:"large",actions:"right",onSubmit:f(D,["prevent"]),onClose:E},{content:d((()=>[c("div",Wl,[c("div",ql,[c("div",Bl,[Kl,c("div",Zl,[r(c("input",{type:"email",required:"",class:"input",placeholder:"Enter Mail","onUpdate:modelValue":a[0]||(a[0]=l=>m(L).mail=l)},null,512),[[p,m(L).mail]])])])]),c("div",Jl,[c("div",Xl,[Yl,c("div",Ql,[r(c("input",{type:"text",required:"",class:"input",placeholder:"Enter mail subject","onUpdate:modelValue":a[1]||(a[1]=l=>m(L).subject=l)},null,512),[[p,m(L).subject]])])])]),c("div",le,[ee,u(_,null,{default:d((()=>[u(i,{modelValue:m(L).scheduled_at,"onUpdate:modelValue":a[2]||(a[2]=l=>m(L).scheduled_at=l),mode:"dateTime"},{default:d((({inputValue:l,inputEvents:e})=>[u(t,null,{default:d((()=>[u(s,{icon:"lucide:calendar"},{default:d((()=>[c("input",C({class:"input v-input",type:"text",value:l},S(e,!0)),null,16,ae)])),_:2},1024)])),_:2},1024)])),_:1},8,["modelValue"])])),_:1})]),c("div",se,[u(t,{grouped:""},{default:d((()=>[u(s,null,{default:d((()=>[te])),_:1})])),_:1})]),c("div",ie,[oe,m(A)?(o(),n(m(R),{key:0,modelValue:m(L).content,"onUpdate:modelValue":a[3]||(a[3]=l=>m(L).content=l),editor:m(A),config:T},null,8,["modelValue","editor"])):x("",!0)])])])),action:d((()=>[u(g,{onClick:D,color:"primary",loading:m(w),raised:""},{default:d((()=>[ne,v(" Schedule Mail")])),_:1},8,["loading"])])),cancel:d((()=>[u(g,{color:"light",onClick:E,raised:""},{default:d((()=>[v("Close ")])),_:1})])),_:1},8,["open","onSubmit"])])),_:1})])}}}),ce={class:"modal-form columns is-multiline",style:{height:"80dvh"}},ue={class:"tabs-wrapper column is-12 m-0"},re={class:"tabs-inner"},me={class:"tabs is-boxed"},pe=[c("span",null,"General",-1)],ve=[c("span",null,"Activities",-1)],fe=[c("span",null,"Proposals",-1)],be={key:0,class:"column is-12"},ye=c("h3",{class:"title is-6 mb-2"},"General Information",-1),_e={class:"columns is-multiline"},ge={class:"field column is-12 mb-0"},he=c("label",null,"Opportunity Title: *",-1),Ve={class:"control"},Ce={class:"field column is-3 mb-0"},Se=c("label",null,"Zip Code: without slash ",-1),xe={class:"control"},Ue={class:"field column is-3 mb-0"},ke=c("label",null,"City: ",-1),je={class:"control"},we={class:"field column is-6 mb-0"},Ie=c("label",null,"State: ",-1),Ne={class:"control"},Me={class:"field column is-6 mb-0"},Ae=c("label",null,"Address: ",-1),Ee={class:"control"},Pe={class:"field column is-6 mb-0"},Le=c("label",null,"Confidence ",-1),He={class:"control"},De={class:"field column is-6 mb-0"},Oe=c("label",null,"Projected Sale Date: ",-1),Re={class:"control"},Te={class:"field column is-6 mb-0"},Fe=c("label",null,"Project Type ",-1),ze={class:"field column is-6 mb-0"},$e=c("label",null,"Start Date: ",-1),Ge={class:"control"},We={class:"field column is-6 mb-0"},qe=c("label",null,"End Date: ",-1),Be={class:"control"},Ke={class:"field column is-12 mb-0"},Ze={class:"multiselect-single-label"},Je=["src"],Xe={class:"select-label-text"},Ye=["src"],Qe={class:"select-label-text"},la={class:"field column is-3 mb-0"},ea={class:"multiselect-single-label"},aa=["src"],sa={class:"select-label-text"},ta=["src"],ia={class:"select-label-text"},oa={class:"field column is-3 mb-0"},na={class:"multiselect-single-label"},da=["src"],ca={class:"select-label-text"},ua=["src"],ra={class:"select-label-text"},ma={class:"field column is-6 mb-0"},pa={class:"multiselect-single-label"},va=["src"],fa={class:"select-label-text"},ba=["src"],ya={class:"select-label-text"},_a={class:"field column is-3 mb-0"},ga=c("label",null,"Estimated Revenue: ",-1),ha={class:"control"},Va={class:"field column is-3 mb-0"},Ca=c("label",null,"To",-1),Sa={class:"control"},xa={class:"field column is-6 mb-0"},Ua=c("label",null,"Tags ",-1),ka={class:"field column is-6 mb-0"},ja=c("label",null,"Sources ",-1),wa={class:"field column is-6 mb-0"},Ia=c("label",null,"Status ",-1),Na=c("h3",{class:"title is-6 mb-2"},"Notes",-1),Ma={class:"field column is-12 mb-0"},Aa=c("h3",{class:"title is-6 mb-2"},"Attach Documents",-1),Ea={class:"field column is-12 mb-0"},Pa=c("label",null,"Attachments ",-1),La=c("div",{class:"file"},[c("label",{class:"file-label"},[c("input",{class:"file-input",type:"file",name:"resume"}),c("span",{class:"file-cta"},[c("span",{class:"file-icon"},[c("i",{class:"fas fa-cloud-upload-alt"})]),c("span",{class:"file-label"}," Choose a file… ")])])],-1),Ha={key:1,class:"column is-12"},Da=c("div",{class:"column is-12",style:{"text-align":"center"}},[c("h1",{class:"title is-4"},"Connect your clients to their projects"),c("h1",{class:"title is-5"}," Create a client contact and assign them to jobs and lead opportunities effortlessly. ")],-1),Oa={class:"column is-6"},Ra={class:"column is-6"},Ta=c("div",{class:"column is-3"},null,-1),Fa=c("div",{class:"column is-6 text-align-center"},[c("i",{class:"fas fa-phone-alt fa-5x primary-text text-primary mb-3","aria-hidden":"true"}),c("h1",{class:"title is-4"},"Engage your leads with activities"),c("h1",{class:"title is-6"}," Track calls, emails, and meeting notes for leads in one place. ")],-1),za=c("div",{class:"column is-3"},null,-1),$a=c("div",{class:"column is-3"},null,-1),Ga={class:"column is-6 text-align-center"},Wa=c("div",{class:"column is-3"},null,-1),qa={key:2,class:"column is-12"},Ba={class:"column is-12"},Ka=a({__name:"LeadAddUpdateModal",props:{addUpdateLeadModal:{type:Boolean},leadId:{}},emits:["update:modalHandler","update:OnSuccess"],setup(a,{emit:s}){const _=a,g=T(),C=O(),S=H(),U=t(0),k=t(!1),L=t(!1),q=t(!1),B=t([]),K=t([]),Z=()=>{s("update:modalHandler",!1)},J=t(""),X=t("general"),Y=t([]),Q=[{id:1,value:"Lead",label:"Lead"},{id:2,value:"Home",label:"Home"},{id:3,value:"Floor Work",label:"Floor Work"},{id:4,value:"Tile Work",label:"Tile Work"},{id:5,value:"Carpenter",label:"Carpenter"},{id:6,value:"Complete Renovation",label:"Complete Renovation"},{id:7,value:"Painting",label:"Painting"},{id:8,value:"Plumbing",label:"Plumbing"},{id:9,value:"New Construction",label:"New Construction"},{id:10,value:"Carpenter",label:"Carpenter"},{id:11,value:"Carpenter",label:"Carpenter"},{id:12,value:"Carpenter",label:"Carpenter"}],ll=[{value:"all",label:"All"},{value:"Contact Form",label:"Contact Form"},{value:"Social Media",label:"Social Media"},{value:"Referral",label:"Referral"},{value:"Company Website",label:"Company Website"}],el=t([{value:"",name:"",icon:""}]),al=t([{value:"",name:"",icon:""}]),sl=t([{value:"",name:"",icon:""}]),tl=G.component,il={fontFamily:{options:['"Montserrat Variable", sans-serif','"Roboto Flex Variable", sans-serif']}},ol=t({id:"",title:"",address:"",leadStatus:"",current_state:"",city:"",state:"",status:"",zip_code:"",contractor:"",confidence:0,sale_date:"",sales_people:[],tags:[],estimated_from:"",estimated_to:"",sources:"",project_type:"",notes:"",attachments:[],attach_mail:"",created_by:g.user.id,managers:[],client:"",latitude:0,longitude:0,startDate:"",endDate:"",description:"",image:"",color:"",is_active:!0,wifiAvaliabe:!1,parkingAvaliable:!1,property_features:!1}),nl=t([{value:"open",label:"Open"},{value:"onHold",label:"On Hold"},{value:"lost",label:"Lost"},{value:"sold",label:"Sold"}]),dl=t([{value:"Residential",label:"Residential"},{value:"Commercial",label:"Commercial"},{value:"Government",label:"Government"},{value:"Business Site",label:"Business Site"},{value:"Company/Factories",label:"Company/Factories"}]),cl=async(l=0)=>{try{U.value=l,ol.value.tags=JSON.stringify(Y.value);const e=R(ol.value,["image"]);if(ol.value.client||e.append("client",""),ol.value.contractor||e.append("contractor",""),_.leadId||ol.value.id){const l=await S.patch(`/api/project/${_.leadId?_.leadId:ol.value.id}/`,e);ol.value=l.data}else{const l=await S.post("/api/project/",e);ol.value=l.data}C.success(`Lead ${_.leadId||ol.value.id?"updated":"created"} successfully`),s("update:OnSuccess",null),3==l&&Z()}catch(e){C.error(`${e}, Lead`)}finally{U.value=0}},ul=async()=>{try{const l=await D.get(`https://maps.googleapis.com/maps/api/geocode/json?address=${ol.value.zip_code}&key=AIzaSyDWHedwkLGGa4_3XgPqYxIzMkFpOdKJRik`);"OK"===l.data.status?(ol.value.address=l.data.results[0].formatted_address,ol.value.latitude=l.data.results[0].geometry.location.lat,ol.value.longitude=l.data.results[0].geometry.location.lng,ol.value.city=l.data.results[0].address_components[1].long_name,ol.value.state=l.data.results[0].address_components[3].long_name,C.success("Address Added")):"ZERO_RESULTS"===l.data.status&&C.error("Invalid Post-Code")}catch(l){C.error("Invalid Post-Code"),console.error(l)}};return j((()=>ol.value.leadStatus),(()=>{"sold"==ol.value.leadStatus&&(ol.value.current_state="job")})),i((async()=>{_.leadId&&(async()=>{try{U.value=1;const l=await S.get(`/api/project/${_.leadId}/single-project/`);ol.value=l.data,Y.value=l.data.tags}catch(l){C.error(` ${l}, Lead`)}finally{U.value=0}})(),(async()=>{try{U.value=1;const l=await S.get("/api/users/by-role/manager/",{});sl.value=l.data.map((l=>({value:l.id,name:`${l.username?l.username:""+l.lastName?l.lastName:""}`,icon:l.avatar}))),J.value=ol.value.manager}catch(l){console.log(l)}finally{U.value=0}})(),(async()=>{try{U.value=1;const l=await S.get("/api/users/by-role/admin/");l&&l.data?(K.value=l.data.map((l=>({value:l.id,name:`${l.username||""} ${l.lastName||""}`.trim(),icon:l.avatar||""}))),ol.value?.sales_people?.length&&(B.value=ol.value?.sales_people)):C.error("Failed to fetch admin data.")}catch(l){console.error("Error fetching admin data:",l),C.error("An error occurred while fetching admins.")}finally{U.value=0}})(),(async()=>{try{U.value=1;const l=await S.get("/api/users/by-role/contractor/",{});el.value=l.data.map((l=>({value:l.id,name:`${l.username?l.username:""+l.lastName?l.lastName:""}`,icon:l.avatar})))}catch(l){console.log(l)}finally{U.value=0}})(),(async()=>{try{U.value=1;const l=await S.get("/api/users/by-role/client/",{});al.value=l.data.map((l=>({value:l.id,name:`${l.username?l.username:""+l.lastName?l.lastName:""}`,icon:l.avatar})))}catch(l){console.log(l)}finally{U.value=0}})()})),(a,s)=>{const t=h("Slider"),i=P,g=F,C=z,S=$,j=h("Multiselect"),H=b,D=y,O=de,R=Gl,T=wl,G=e,B=l;return o(),n(B,{is:"form",open:_.addUpdateLeadModal,title:"Lead Information",size:"xl",actions:"right",onSubmit:s[33]||(s[33]=f((l=>cl(1)),["prevent"])),onClose:Z},{content:d((()=>[c("div",ce,[c("div",ue,[c("div",re,[c("div",me,[c("ul",null,[c("li",{class:w(["general"===m(X)?"is-active":"not-active"])},[c("a",{tabindex:"0",role:"button",onKeydown:s[0]||(s[0]=I(f((l=>X.value="general"),["prevent"]),["space"])),onClick:s[1]||(s[1]=l=>X.value="general")},pe,32)],2),c("li",{class:w(["activities"===m(X)?"is-active":"not-active"])},[c("a",{tabindex:"0",role:"button",onKeydown:s[2]||(s[2]=I(f((l=>X.value="activities"),["prevent"]),["space"])),onClick:s[3]||(s[3]=l=>X.value="activities")},ve,32)],2),c("li",{class:w(["proposals"===m(X)?"is-active":"not-active"])},[c("a",{tabindex:"0",role:"button",onKeydown:s[4]||(s[4]=I(f((l=>X.value="proposals"),["prevent"]),["space"])),onClick:s[5]||(s[5]=l=>X.value="proposals")},fe,32)],2)])])])]),"general"===m(X)?(o(),V("div",be,[u(H,{class:"columns is-multiline"},{default:d((()=>[ye,c("div",_e,[c("div",ge,[he,c("div",Ve,[r(c("input",{type:"text",name:"title","onUpdate:modelValue":s[6]||(s[6]=l=>m(ol).title=l),required:"",class:"input is-primary-focus is-primary-focus",placeholder:"Opportunity Title"},null,512),[[p,m(ol).title]])])]),c("div",Ce,[Se,c("div",xe,[r(c("input",{onBlur:ul,type:"text",name:"zipCode","onUpdate:modelValue":s[7]||(s[7]=l=>m(ol).zip_code=l),class:"input is-primary-focus is-primary-focus",placeholder:"Zip code"},null,544),[[p,m(ol).zip_code]])])]),c("div",Ue,[ke,c("div",je,[r(c("input",{type:"text",name:"city","onUpdate:modelValue":s[8]||(s[8]=l=>m(ol).city=l),class:"input is-primary-focus is-primary-focus",placeholder:"City"},null,512),[[p,m(ol).city]])])]),c("div",we,[Ie,c("div",Ne,[r(c("input",{type:"text",name:"state","onUpdate:modelValue":s[9]||(s[9]=l=>m(ol).state=l),class:"input is-primary-focus is-primary-focus",placeholder:"State"},null,512),[[p,m(ol).state]])])]),c("div",Me,[Ae,c("div",Ee,[r(c("input",{type:"text",name:"address","onUpdate:modelValue":s[10]||(s[10]=l=>m(ol).address=l),class:"input is-primary-focus is-primary-focus",placeholder:"Street Address"},null,512),[[p,m(ol).address]])])]),c("div",Pe,[Le,c("div",He,[u(g,{class:"has-rounded-tooltip is-slider-info"},{default:d((({id:l})=>[u(i,null,{default:d((()=>[u(t,{id:l,modelValue:m(ol).confidence,"onUpdate:modelValue":s[11]||(s[11]=l=>m(ol).confidence=l)},null,8,["id","modelValue"])])),_:2},1024)])),_:1})])]),c("div",De,[Oe,c("div",Re,[r(c("input",{type:"date",name:"saleDate","onUpdate:modelValue":s[12]||(s[12]=l=>m(ol).sale_date=l),class:"input is-primary-focus is-primary-focus",placeholder:"Post code"},null,512),[[p,m(ol).sale_date]])])]),c("div",Te,[Fe,u(g,null,{default:d((()=>[u(i,null,{default:d((()=>[u(S,{modelValue:m(ol).project_type,"onUpdate:modelValue":s[13]||(s[13]=l=>m(ol).project_type=l)},{default:d((()=>[(o(!0),V(N,null,M(m(dl),((l,e)=>(o(),n(C,{key:e,value:l.value},{default:d((()=>[v(A(l.label),1)])),_:2},1032,["value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1})]),c("div",ze,[$e,c("div",Ge,[r(c("input",{type:"date",name:"saleDate","onUpdate:modelValue":s[14]||(s[14]=l=>m(ol).startDate=l),class:"input is-primary-focus is-primary-focus",placeholder:"Post code"},null,512),[[p,m(ol).startDate]])])]),c("div",We,[qe,c("div",Be,[r(c("input",{type:"date",name:"saleDate","onUpdate:modelValue":s[15]||(s[15]=l=>m(ol).endDate=l),class:"input is-primary-focus is-primary-focus",placeholder:"Post code"},null,512),[[p,m(ol).endDate]])])])]),c("div",Ke,[u(g,{class:"is-image-select",label:"Sales people"},{default:d((({id:l})=>[u(i,null,{default:d((()=>[u(j,{modelValue:m(ol).sales_people,"onUpdate:modelValue":s[16]||(s[16]=l=>m(ol).sales_people=l),attrs:{id:l},placeholder:"Sales people",label:"name",track:"value",mode:"tags",options:m(K)},{singlelabel:d((({value:l})=>[c("div",Ze,[c("img",{class:"select-label-icon",src:l.icon,alt:""},null,8,Je),c("span",Xe,A(l.name),1)])])),option:d((({option:l})=>[c("img",{class:"select-option-icon",src:l.icon,alt:""},null,8,Ye),c("span",Qe,A(l.name),1)])),_:2},1032,["modelValue","attrs","options"])])),_:2},1024)])),_:1})]),c("div",la,[u(g,{class:"is-image-select",label:"Contractors"},{default:d((({id:l})=>[u(i,null,{default:d((()=>[u(j,{modelValue:m(ol).contractor,"onUpdate:modelValue":s[17]||(s[17]=l=>m(ol).contractor=l),attrs:{id:l},placeholder:"Select a contractor",label:"name",options:m(el)},{singlelabel:d((({value:l})=>[c("div",ea,[c("img",{class:"select-label-icon",src:l.icon,alt:""},null,8,aa),c("span",sa,A(l.name),1)])])),option:d((({option:l})=>[c("img",{class:"select-option-icon",src:l.icon,alt:""},null,8,ta),c("span",ia,A(l.name),1)])),_:2},1032,["modelValue","attrs","options"])])),_:2},1024)])),_:1})]),c("div",oa,[u(g,{class:"is-image-select",label:"Client"},{default:d((({id:l})=>[u(i,null,{default:d((()=>[u(j,{modelValue:m(ol).client,"onUpdate:modelValue":s[18]||(s[18]=l=>m(ol).client=l),attrs:{id:l},placeholder:"Select a client",label:"name",options:m(al)},{singlelabel:d((({value:l})=>[c("div",na,[c("img",{class:"select-label-icon",src:l.icon},null,8,da),c("span",ca,A(l.name),1)])])),option:d((({option:l})=>[c("img",{class:"select-option-icon",src:l.icon},null,8,ua),c("span",ra,A(l.name),1)])),_:2},1032,["modelValue","attrs","options"])])),_:2},1024)])),_:1})]),c("div",ma,[u(g,{class:"is-image-select",label:"Manager"},{default:d((({id:l})=>[u(i,null,{default:d((()=>[u(j,{modelValue:m(ol).managers,"onUpdate:modelValue":s[19]||(s[19]=l=>m(ol).managers=l),attrs:{id:l},placeholder:"Select managers",label:"name",track:"value",mode:"tags",options:m(sl)},{singlelabel:d((({value:l})=>[c("div",pa,[c("img",{class:"select-label-icon",src:l.icon,alt:""},null,8,va),c("span",fa,A(l.name),1)])])),option:d((({option:l})=>[c("img",{class:"select-option-icon",src:l.icon,alt:""},null,8,ba),c("span",ya,A(l.name),1)])),_:2},1032,["modelValue","attrs","options"])])),_:2},1024)])),_:1})]),c("div",_a,[ga,c("div",ha,[r(c("input",{type:"text",name:"externalID","onUpdate:modelValue":s[20]||(s[20]=l=>m(ol).estimated_from=l),class:"input is-primary-focus is-primary-focus",placeholder:"From"},null,512),[[p,m(ol).estimated_from]])])]),c("div",Va,[Ca,c("div",Sa,[r(c("input",{type:"text",name:"externalID","onUpdate:modelValue":s[21]||(s[21]=l=>m(ol).estimated_to=l),class:"input is-primary-focus is-primary-focus",placeholder:"To"},null,512),[[p,m(ol).estimated_to]])])]),c("div",xa,[Ua,u(g,null,{default:d((({id:l})=>[u(i,null,{default:d((()=>[u(j,{modelValue:m(Y),"onUpdate:modelValue":s[22]||(s[22]=l=>E(Y)?Y.value=l:null),attrs:{id:l},mode:"tags",searchable:!0,"create-tag":!0,options:Q,placeholder:"Add tags"},null,8,["modelValue","attrs"])])),_:2},1024)])),_:1})]),c("div",ka,[ja,u(g,null,{default:d((({id:l})=>[u(i,null,{default:d((()=>[u(j,{modelValue:m(ol).sources,"onUpdate:modelValue":s[23]||(s[23]=l=>m(ol).sources=l),attrs:{id:l},"create-tag":!0,options:ll,placeholder:"Sources"},null,8,["modelValue","attrs"])])),_:2},1024)])),_:1})]),c("div",wa,[Ia,u(g,null,{default:d((()=>[u(i,null,{default:d((()=>[u(S,{modelValue:m(ol).leadStatus,"onUpdate:modelValue":s[24]||(s[24]=l=>m(ol).leadStatus=l)},{default:d((()=>[(o(!0),V(N,null,M(m(nl),((l,e)=>(o(),n(C,{key:e,value:l.value},{default:d((()=>[v(A(l.label),1)])),_:2},1032,["value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1})])])),_:1}),u(H,{class:"columns is-multiline mt-3"},{default:d((()=>[Na,c("div",Ma,[u(m(tl),{modelValue:m(ol).notes,"onUpdate:modelValue":s[25]||(s[25]=l=>m(ol).notes=l),editor:m(W),config:il},null,8,["modelValue","editor"])])])),_:1}),u(H,{class:"columns is-multiline mt-3"},{default:d((()=>[Aa,c("div",Ea,[Pa,u(g,{grouped:""},{default:d((()=>[u(i,null,{default:d((()=>[La])),_:1})])),_:1})])])),_:1})])):x("",!0),"activities"===m(X)?(o(),V("div",Ha,[u(H,{class:"columns is-multiline"},{default:d((()=>[Da,c("div",Oa,[u(D,{onClick:s[26]||(s[26]=l=>k.value=!m(k)),color:"info",class:"p-5",icon:"fas fa-plus",fullwidth:"",bold:""},{default:d((()=>[v(" Add New ")])),_:1})]),c("div",Ra,[u(D,{class:"p-5",color:"primary",icon:"fas fa-sign-in-alt",fullwidth:"",bold:""},{default:d((()=>[v(" Import existing one ")])),_:1})])])),_:1}),u(H,{class:"columns is-multiline mt-1"},{default:d((()=>[Ta,Fa,za,$a,c("div",Ga,[u(D,{onClick:s[27]||(s[27]=l=>L.value=!m(L)),color:"warning",icon:"lnir lnir-alarm"},{default:d((()=>[v(" Create Activity ")])),_:1}),u(D,{onClick:s[28]||(s[28]=l=>q.value=!m(q)),color:"success",class:"ml-2",icon:"fas fa-envelope"},{default:d((()=>[v(" Schedule Email ")])),_:1})]),Wa])),_:1}),m(L)?(o(),n(O,{key:0,mailSchedulerModal:m(L),"onUpdate:modalHandler":s[29]||(s[29]=l=>L.value=!1)},null,8,["mailSchedulerModal"])):x("",!0),m(q)?(o(),n(R,{key:1,mailSenderModal:m(q),"onUpdate:modalHandler":s[30]||(s[30]=l=>q.value=!1)},null,8,["mailSenderModal"])):x("",!0),m(k)?(o(),n(T,{key:2,"add-update-contact-modal":m(k),"onUpdate:modalHandler":s[31]||(s[31]=l=>k.value=!1)},null,8,["add-update-contact-modal"])):x("",!0)])):x("",!0),"proposals"===m(X)?(o(),V("div",qa,[u(H,{class:"columns is-multiline"},{default:d((()=>[c("div",Ba,[u(G,{leadId:m(ol).id?m(ol).id:_.leadId},null,8,["leadId"])])])),_:1})])):x("",!0)])])),action:d((()=>[u(D,{loading:1==m(U),type:"submit",color:_.leadId?"info":"primary",raised:""},{default:d((()=>[v(A(_.leadId?"Update":"Create")+" Lead",1)])),_:1},8,["loading","color"]),u(D,{loading:3==m(U),onClick:s[32]||(s[32]=l=>cl(3)),color:"warning",raised:""},{default:d((()=>[v(A(_.leadId?"Update & Close":"Create & Close"),1)])),_:1},8,["loading"])])),_:1},8,["open"])}}});export{Ka as _,de as a};
