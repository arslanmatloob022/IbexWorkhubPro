import{_ as e}from"./VIconBox.vue_vue_type_style_index_0_lang-4d6c6cd7.js";import{a as t,f as n,bq as r,C as i,D as o,Z as s,r as a,b as l,o as h,n as u,E as c,F as d,G as p,O as g,K as m,U as f,N as w,m as y,P as v,Q as C,R as S,S as R}from"./index-c5e45f53.js";import{_ as E}from"./VField.vue_vue_type_script_setup_true_lang-82d05aad.js";import{_ as b}from"./VControl-4d3f173c.js";import{_ as T}from"./VInput.vue_vue_type_script_setup_true_lang-c7092a36.js";import{u as N}from"./useAPI-bef75d24.js";import{u as A}from"./useNotyf-25b7a264.js";import{h as M}from"./moment-bad41465.js";var I=function(e){return e&&e.Math===Math&&e},O=I("object"==typeof globalThis&&globalThis)||I("object"==typeof window&&window)||I("object"==typeof self&&self)||I("object"==typeof t&&t)||I("object"==typeof t&&t)||function(){return this}()||Function("return this")(),x={},P=function(e){try{return!!e()}catch(xm){return!0}},_=!P((function(){return 7!==Object.defineProperty({},1,{get:function(){return 7}})[1]})),L=!P((function(){var e=function(){}.bind();return"function"!=typeof e||e.hasOwnProperty("prototype")})),H=L,k=Function.prototype.call,F=H?k.bind(k):function(){return k.apply(k,arguments)},D={},V={}.propertyIsEnumerable,U=Object.getOwnPropertyDescriptor,B=U&&!V.call({1:2},1);D.f=B?function(e){var t=U(this,e);return!!t&&t.enumerable}:V;var W,j,G=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}},z=L,$=Function.prototype,Y=$.call,K=z&&$.bind.bind(Y,Y),X=z?K:function(e){return function(){return Y.apply(e,arguments)}},q=X,Q=q({}.toString),Z=q("".slice),J=function(e){return Z(Q(e),8,-1)},ee=P,te=J,ne=Object,re=X("".split),ie=ee((function(){return!ne("z").propertyIsEnumerable(0)}))?function(e){return"String"===te(e)?re(e,""):ne(e)}:ne,oe=function(e){return null==e},se=oe,ae=TypeError,le=function(e){if(se(e))throw new ae("Can't call method on "+e);return e},he=ie,ue=le,ce=function(e){return he(ue(e))},de="object"==typeof document&&document.all,pe=void 0===de&&void 0!==de?function(e){return"function"==typeof e||e===de}:function(e){return"function"==typeof e},ge=pe,me=function(e){return"object"==typeof e?null!==e:ge(e)},fe=O,we=pe,ye=function(e,t){return arguments.length<2?(n=fe[e],we(n)?n:void 0):fe[e]&&fe[e][t];var n},ve=X({}.isPrototypeOf),Ce=O.navigator,Se=Ce&&Ce.userAgent,Re=Se?String(Se):"",Ee=O,be=Re,Te=Ee.process,Ne=Ee.Deno,Ae=Te&&Te.versions||Ne&&Ne.version,Me=Ae&&Ae.v8;Me&&(j=(W=Me.split("."))[0]>0&&W[0]<4?1:+(W[0]+W[1])),!j&&be&&(!(W=be.match(/Edge\/(\d+)/))||W[1]>=74)&&(W=be.match(/Chrome\/(\d+)/))&&(j=+W[1]);var Ie=j,Oe=P,xe=O.String,Pe=!!Object.getOwnPropertySymbols&&!Oe((function(){var e=Symbol("symbol detection");return!xe(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&Ie&&Ie<41})),_e=Pe&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,Le=ye,He=pe,ke=ve,Fe=Object,De=_e?function(e){return"symbol"==typeof e}:function(e){var t=Le("Symbol");return He(t)&&ke(t.prototype,Fe(e))},Ve=String,Ue=function(e){try{return Ve(e)}catch(xm){return"Object"}},Be=pe,We=Ue,je=TypeError,Ge=function(e){if(Be(e))return e;throw new je(We(e)+" is not a function")},ze=Ge,$e=oe,Ye=function(e,t){var n=e[t];return $e(n)?void 0:ze(n)},Ke=F,Xe=pe,qe=me,Qe=TypeError,Ze={exports:{}},Je=O,et=Object.defineProperty,tt=function(e,t){try{et(Je,e,{value:t,configurable:!0,writable:!0})}catch(xm){Je[e]=t}return t},nt=O,rt=tt,it="__core-js_shared__",ot=Ze.exports=nt[it]||rt(it,{});(ot.versions||(ot.versions=[])).push({version:"3.41.0",mode:"global",copyright:"Â© 2014-2025 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.41.0/LICENSE",source:"https://github.com/zloirock/core-js"});var st=Ze.exports,at=st,lt=function(e,t){return at[e]||(at[e]=t||{})},ht=le,ut=Object,ct=function(e){return ut(ht(e))},dt=ct,pt=X({}.hasOwnProperty),gt=Object.hasOwn||function(e,t){return pt(dt(e),t)},mt=X,ft=0,wt=Math.random(),yt=mt(1..toString),vt=function(e){return"Symbol("+(void 0===e?"":e)+")_"+yt(++ft+wt,36)},Ct=lt,St=gt,Rt=vt,Et=Pe,bt=_e,Tt=O.Symbol,Nt=Ct("wks"),At=bt?Tt.for||Tt:Tt&&Tt.withoutSetter||Rt,Mt=function(e){return St(Nt,e)||(Nt[e]=Et&&St(Tt,e)?Tt[e]:At("Symbol."+e)),Nt[e]},It=F,Ot=me,xt=De,Pt=Ye,_t=function(e,t){var n,r;if("string"===t&&Xe(n=e.toString)&&!qe(r=Ke(n,e)))return r;if(Xe(n=e.valueOf)&&!qe(r=Ke(n,e)))return r;if("string"!==t&&Xe(n=e.toString)&&!qe(r=Ke(n,e)))return r;throw new Qe("Can't convert object to primitive value")},Lt=TypeError,Ht=Mt("toPrimitive"),kt=function(e,t){if(!Ot(e)||xt(e))return e;var n,r=Pt(e,Ht);if(r){if(void 0===t&&(t="default"),n=It(r,e,t),!Ot(n)||xt(n))return n;throw new Lt("Can't convert object to primitive value")}return void 0===t&&(t="number"),_t(e,t)},Ft=De,Dt=function(e){var t=kt(e,"string");return Ft(t)?t:t+""},Vt=me,Ut=O.document,Bt=Vt(Ut)&&Vt(Ut.createElement),Wt=function(e){return Bt?Ut.createElement(e):{}},jt=Wt,Gt=!_&&!P((function(){return 7!==Object.defineProperty(jt("div"),"a",{get:function(){return 7}}).a})),zt=_,$t=F,Yt=D,Kt=G,Xt=ce,qt=Dt,Qt=gt,Zt=Gt,Jt=Object.getOwnPropertyDescriptor;x.f=zt?Jt:function(e,t){if(e=Xt(e),t=qt(t),Zt)try{return Jt(e,t)}catch(xm){}if(Qt(e,t))return Kt(!$t(Yt.f,e,t),e[t])};var en={},tn=_&&P((function(){return 42!==Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype})),nn=me,rn=String,on=TypeError,sn=function(e){if(nn(e))return e;throw new on(rn(e)+" is not an object")},an=_,ln=Gt,hn=tn,un=sn,cn=Dt,dn=TypeError,pn=Object.defineProperty,gn=Object.getOwnPropertyDescriptor,mn="enumerable",fn="configurable",wn="writable";en.f=an?hn?function(e,t,n){if(un(e),t=cn(t),un(n),"function"==typeof e&&"prototype"===t&&"value"in n&&wn in n&&!n[wn]){var r=gn(e,t);r&&r[wn]&&(e[t]=n.value,n={configurable:fn in n?n[fn]:r[fn],enumerable:mn in n?n[mn]:r[mn],writable:!1})}return pn(e,t,n)}:pn:function(e,t,n){if(un(e),t=cn(t),un(n),ln)try{return pn(e,t,n)}catch(xm){}if("get"in n||"set"in n)throw new dn("Accessors not supported");return"value"in n&&(e[t]=n.value),e};var yn=en,vn=G,Cn=_?function(e,t,n){return yn.f(e,t,vn(1,n))}:function(e,t,n){return e[t]=n,e},Sn={exports:{}},Rn=_,En=gt,bn=Function.prototype,Tn=Rn&&Object.getOwnPropertyDescriptor,Nn=En(bn,"name"),An={EXISTS:Nn,PROPER:Nn&&"something"===function(){}.name,CONFIGURABLE:Nn&&(!Rn||Rn&&Tn(bn,"name").configurable)},Mn=pe,In=st,On=X(Function.toString);Mn(In.inspectSource)||(In.inspectSource=function(e){return On(e)});var xn,Pn,_n,Ln=In.inspectSource,Hn=pe,kn=O.WeakMap,Fn=Hn(kn)&&/native code/.test(String(kn)),Dn=vt,Vn=lt("keys"),Un=function(e){return Vn[e]||(Vn[e]=Dn(e))},Bn={},Wn=Fn,jn=O,Gn=me,zn=Cn,$n=gt,Yn=st,Kn=Un,Xn=Bn,qn="Object already initialized",Qn=jn.TypeError,Zn=jn.WeakMap;if(Wn||Yn.state){var Jn=Yn.state||(Yn.state=new Zn);Jn.get=Jn.get,Jn.has=Jn.has,Jn.set=Jn.set,xn=function(e,t){if(Jn.has(e))throw new Qn(qn);return t.facade=e,Jn.set(e,t),t},Pn=function(e){return Jn.get(e)||{}},_n=function(e){return Jn.has(e)}}else{var er=Kn("state");Xn[er]=!0,xn=function(e,t){if($n(e,er))throw new Qn(qn);return t.facade=e,zn(e,er,t),t},Pn=function(e){return $n(e,er)?e[er]:{}},_n=function(e){return $n(e,er)}}var tr={set:xn,get:Pn,has:_n,enforce:function(e){return _n(e)?Pn(e):xn(e,{})},getterFor:function(e){return function(t){var n;if(!Gn(t)||(n=Pn(t)).type!==e)throw new Qn("Incompatible receiver, "+e+" required");return n}}},nr=X,rr=P,ir=pe,or=gt,sr=_,ar=An.CONFIGURABLE,lr=Ln,hr=tr.enforce,ur=tr.get,cr=String,dr=Object.defineProperty,pr=nr("".slice),gr=nr("".replace),mr=nr([].join),fr=sr&&!rr((function(){return 8!==dr((function(){}),"length",{value:8}).length})),wr=String(String).split("String"),yr=Sn.exports=function(e,t,n){"Symbol("===pr(cr(t),0,7)&&(t="["+gr(cr(t),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),n&&n.getter&&(t="get "+t),n&&n.setter&&(t="set "+t),(!or(e,"name")||ar&&e.name!==t)&&(sr?dr(e,"name",{value:t,configurable:!0}):e.name=t),fr&&n&&or(n,"arity")&&e.length!==n.arity&&dr(e,"length",{value:n.arity});try{n&&or(n,"constructor")&&n.constructor?sr&&dr(e,"prototype",{writable:!1}):e.prototype&&(e.prototype=void 0)}catch(xm){}var r=hr(e);return or(r,"source")||(r.source=mr(wr,"string"==typeof t?t:"")),e};Function.prototype.toString=yr((function(){return ir(this)&&ur(this).source||lr(this)}),"toString");var vr=Sn.exports,Cr=pe,Sr=en,Rr=vr,Er=tt,br=function(e,t,n,r){r||(r={});var i=r.enumerable,o=void 0!==r.name?r.name:t;if(Cr(n)&&Rr(n,o,r),r.global)i?e[t]=n:Er(t,n);else{try{r.unsafe?e[t]&&(i=!0):delete e[t]}catch(xm){}i?e[t]=n:Sr.f(e,t,{value:n,enumerable:!1,configurable:!r.nonConfigurable,writable:!r.nonWritable})}return e},Tr={},Nr=Math.ceil,Ar=Math.floor,Mr=Math.trunc||function(e){var t=+e;return(t>0?Ar:Nr)(t)},Ir=function(e){var t=+e;return t!=t||0===t?0:Mr(t)},Or=Ir,xr=Math.max,Pr=Math.min,_r=Ir,Lr=Math.min,Hr=function(e){var t=_r(e);return t>0?Lr(t,9007199254740991):0},kr=function(e){return Hr(e.length)},Fr=ce,Dr=function(e,t){var n=Or(e);return n<0?xr(n+t,0):Pr(n,t)},Vr=kr,Ur=function(e){return function(t,n,r){var i=Fr(t),o=Vr(i);if(0===o)return!e&&-1;var s,a=Dr(r,o);if(e&&n!=n){for(;o>a;)if((s=i[a++])!=s)return!0}else for(;o>a;a++)if((e||a in i)&&i[a]===n)return e||a||0;return!e&&-1}},Br={includes:Ur(!0),indexOf:Ur(!1)},Wr=gt,jr=ce,Gr=Br.indexOf,zr=Bn,$r=X([].push),Yr=function(e,t){var n,r=jr(e),i=0,o=[];for(n in r)!Wr(zr,n)&&Wr(r,n)&&$r(o,n);for(;t.length>i;)Wr(r,n=t[i++])&&(~Gr(o,n)||$r(o,n));return o},Kr=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],Xr=Yr,qr=Kr.concat("length","prototype");Tr.f=Object.getOwnPropertyNames||function(e){return Xr(e,qr)};var Qr={};Qr.f=Object.getOwnPropertySymbols;var Zr=ye,Jr=Tr,ei=Qr,ti=sn,ni=X([].concat),ri=Zr("Reflect","ownKeys")||function(e){var t=Jr.f(ti(e)),n=ei.f;return n?ni(t,n(e)):t},ii=gt,oi=ri,si=x,ai=en,li=function(e,t,n){for(var r=oi(t),i=ai.f,o=si.f,s=0;s<r.length;s++){var a=r[s];ii(e,a)||n&&ii(n,a)||i(e,a,o(t,a))}},hi=P,ui=pe,ci=/#|\.prototype\./,di=function(e,t){var n=gi[pi(e)];return n===fi||n!==mi&&(ui(t)?hi(t):!!t)},pi=di.normalize=function(e){return String(e).replace(ci,".").toLowerCase()},gi=di.data={},mi=di.NATIVE="N",fi=di.POLYFILL="P",wi=di,yi=O,vi=x.f,Ci=Cn,Si=br,Ri=tt,Ei=li,bi=wi,Ti=function(e,t){var n,r,i,o,s,a=e.target,l=e.global,h=e.stat;if(n=l?yi:h?yi[a]||Ri(a,{}):yi[a]&&yi[a].prototype)for(r in t){if(o=t[r],i=e.dontCallGetSet?(s=vi(n,r))&&s.value:n[r],!bi(l?r:a+(h?".":"#")+r,e.forced)&&void 0!==i){if(typeof o==typeof i)continue;Ei(o,i)}(e.sham||i&&i.sham)&&Ci(o,"sham",!0),Si(n,r,o,e)}},Ni=L,Ai=Function.prototype,Mi=Ai.apply,Ii=Ai.call,Oi="object"==typeof Reflect&&Reflect.apply||(Ni?Ii.bind(Mi):function(){return Ii.apply(Mi,arguments)}),xi=X,Pi=Ge,_i=function(e,t,n){try{return xi(Pi(Object.getOwnPropertyDescriptor(e,t)[n]))}catch(xm){}},Li=me,Hi=function(e){return Li(e)||null===e},ki=String,Fi=TypeError,Di=_i,Vi=me,Ui=le,Bi=function(e){if(Hi(e))return e;throw new Fi("Can't set "+ki(e)+" as a prototype")},Wi=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,n={};try{(e=Di(Object.prototype,"__proto__","set"))(n,[]),t=n instanceof Array}catch(xm){}return function(n,r){return Ui(n),Bi(r),Vi(n)?(t?e(n,r):n.__proto__=r,n):n}}():void 0),ji=en.f,Gi=pe,zi=me,$i=Wi,Yi={};Yi[Mt("toStringTag")]="z";var Ki="[object z]"===String(Yi),Xi=pe,qi=J,Qi=Mt("toStringTag"),Zi=Object,Ji="Arguments"===qi(function(){return arguments}()),eo=Ki?qi:function(e){var t,n,r;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=function(e,t){try{return e[t]}catch(xm){}}(t=Zi(e),Qi))?n:Ji?qi(t):"Object"===(r=qi(t))&&Xi(t.callee)?"Arguments":r},to=eo,no=String,ro=function(e){if("Symbol"===to(e))throw new TypeError("Cannot convert a Symbol value to a string");return no(e)},io=ro,oo=me,so=Cn,ao=Error,lo=X("".replace),ho=String(new ao("zxcasd").stack),uo=/\n\s*at [^:]*:[^\n]*/,co=uo.test(ho),po=G,go=!P((function(){var e=new Error("a");return!("stack"in e)||(Object.defineProperty(e,"stack",po(1,7)),7!==e.stack)})),mo=Cn,fo=function(e,t){if(co&&"string"==typeof e&&!ao.prepareStackTrace)for(;t--;)e=lo(e,uo,"");return e},wo=go,yo=Error.captureStackTrace,vo=ye,Co=gt,So=Cn,Ro=ve,Eo=Wi,bo=li,To=function(e,t,n){n in e||ji(e,n,{configurable:!0,get:function(){return t[n]},set:function(e){t[n]=e}})},No=function(e,t,n){var r,i;return $i&&Gi(r=t.constructor)&&r!==n&&zi(i=r.prototype)&&i!==n.prototype&&$i(e,i),e},Ao=function(e,t){return void 0===e?arguments.length<2?"":t:io(e)},Mo=function(e,t){oo(t)&&"cause"in t&&so(e,"cause",t.cause)},Io=function(e,t,n,r){wo&&(yo?yo(e,t):mo(e,"stack",fo(n,r)))},Oo=_,xo=Ti,Po=Oi,_o=function(e,t,n,r){var i="stackTraceLimit",o=r?2:1,s=e.split("."),a=s[s.length-1],l=vo.apply(null,s);if(l){var h=l.prototype;if(Co(h,"cause")&&delete h.cause,!n)return l;var u=vo("Error"),c=t((function(e,t){var n=Ao(r?t:e,void 0),i=r?new l(e):new l;return void 0!==n&&So(i,"message",n),Io(i,c,i.stack,2),this&&Ro(h,this)&&No(i,this,c),arguments.length>o&&Mo(i,arguments[o]),i}));c.prototype=h,"Error"!==a?Eo?Eo(c,u):bo(c,u,{name:!0}):Oo&&i in l&&(To(c,l,i),To(c,l,"prepareStackTrace")),bo(c,l);try{h.name!==a&&So(h,"name",a),h.constructor=c}catch(xm){}return c}},Lo="WebAssembly",Ho=O[Lo],ko=7!==new Error("e",{cause:7}).cause,Fo=function(e,t){var n={};n[e]=_o(e,t,ko),xo({global:!0,constructor:!0,arity:1,forced:ko},n)},Do=function(e,t){if(Ho&&Ho[e]){var n={};n[e]=_o(Lo+"."+e,t,ko),xo({target:Lo,stat:!0,constructor:!0,arity:1,forced:ko},n)}};Fo("Error",(function(e){return function(t){return Po(e,this,arguments)}})),Fo("EvalError",(function(e){return function(t){return Po(e,this,arguments)}})),Fo("RangeError",(function(e){return function(t){return Po(e,this,arguments)}})),Fo("ReferenceError",(function(e){return function(t){return Po(e,this,arguments)}})),Fo("SyntaxError",(function(e){return function(t){return Po(e,this,arguments)}})),Fo("TypeError",(function(e){return function(t){return Po(e,this,arguments)}})),Fo("URIError",(function(e){return function(t){return Po(e,this,arguments)}})),Do("CompileError",(function(e){return function(t){return Po(e,this,arguments)}})),Do("LinkError",(function(e){return function(t){return Po(e,this,arguments)}})),Do("RuntimeError",(function(e){return function(t){return Po(e,this,arguments)}}));var Vo=J,Uo=Array.isArray||function(e){return"Array"===Vo(e)},Bo=_,Wo=Uo,jo=TypeError,Go=Object.getOwnPropertyDescriptor,zo=Bo&&!function(){if(void 0!==this)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(xm){return xm instanceof TypeError}}(),$o=zo?function(e,t){if(Wo(e)&&!Go(e,"length").writable)throw new jo("Cannot set read only .length");return e.length=t}:function(e,t){return e.length=t},Yo=TypeError,Ko=function(e){if(e>9007199254740991)throw Yo("Maximum allowed index exceeded");return e},Xo=Ti,qo=ct,Qo=kr,Zo=$o,Jo=Ko,es=P((function(){return 4294967297!==[].push.call({length:4294967296},1)}))||!function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(xm){return xm instanceof TypeError}}();Xo({target:"Array",proto:!0,arity:1,forced:es},{push:function(e){var t=qo(this),n=Qo(t),r=arguments.length;Jo(n+r);for(var i=0;i<r;i++)t[n]=arguments[i],n++;return Zo(t,n),n}});var ts=X,ns=Set.prototype,rs={Set:Set,add:ts(ns.add),has:ts(ns.has),remove:ts(ns.delete),proto:ns},is=rs.has,os=function(e){return is(e),e},ss=F,as=function(e,t,n){for(var r,i,o=n?e:e.iterator,s=e.next;!(r=ss(s,o)).done;)if(void 0!==(i=t(r.value)))return i},ls=X,hs=as,us=rs.Set,cs=rs.proto,ds=ls(cs.forEach),ps=ls(cs.keys),gs=ps(new us).next,ms=function(e,t,n){return n?hs({iterator:ps(e),next:gs},t):ds(e,t)},fs=ms,ws=rs.Set,ys=rs.add,vs=function(e){var t=new ws;return fs(e,(function(e){ys(t,e)})),t},Cs=_i(rs.proto,"size","get")||function(e){return e.size},Ss=function(e){return{iterator:e,next:e.next,done:!1}},Rs=Ge,Es=sn,bs=F,Ts=Ir,Ns=Ss,As="Invalid size",Ms=RangeError,Is=TypeError,Os=Math.max,xs=function(e,t){this.set=e,this.size=Os(t,0),this.has=Rs(e.has),this.keys=Rs(e.keys)};xs.prototype={getIterator:function(){return Ns(Es(bs(this.keys,this.set)))},includes:function(e){return bs(this.has,this.set,e)}};var Ps=function(e){Es(e);var t=+e.size;if(t!=t)throw new Is(As);var n=Ts(t);if(n<0)throw new Ms(As);return new xs(e,n)},_s=os,Ls=vs,Hs=Cs,ks=Ps,Fs=ms,Ds=as,Vs=rs.has,Us=rs.remove,Bs=ye,Ws=function(e){return{size:e,has:function(){return!1},keys:function(){return{next:function(){return{done:!0}}}}}},js=function(e){return{size:e,has:function(){return!0},keys:function(){throw new Error("e")}}},Gs=function(e,t){var n=Bs("Set");try{(new n)[e](Ws(0));try{return(new n)[e](Ws(-1)),!1}catch(i){if(!t)return!0;try{return(new n)[e](js(-1/0)),!1}catch(xm){var r=new n;return r.add(1),r.add(2),t(r[e](js(1/0)))}}}catch(xm){return!1}},zs=function(e){var t=_s(this),n=ks(e),r=Ls(t);return Hs(t)<=n.size?Fs(t,(function(e){n.includes(e)&&Us(r,e)})):Ds(n.getIterator(),(function(e){Vs(t,e)&&Us(r,e)})),r};Ti({target:"Set",proto:!0,real:!0,forced:!Gs("difference",(function(e){return 0===e.size}))},{difference:zs});var $s=os,Ys=Cs,Ks=Ps,Xs=ms,qs=as,Qs=rs.Set,Zs=rs.add,Js=rs.has,ea=P,ta=function(e){var t=$s(this),n=Ks(e),r=new Qs;return Ys(t)>n.size?qs(n.getIterator(),(function(e){Js(t,e)&&Zs(r,e)})):Xs(t,(function(e){n.includes(e)&&Zs(r,e)})),r};Ti({target:"Set",proto:!0,real:!0,forced:!Gs("intersection",(function(e){return 2===e.size&&e.has(1)&&e.has(2)}))||ea((function(){return"3,2"!==String(Array.from(new Set([1,2,3]).intersection(new Set([3,2]))))}))},{intersection:ta});var na=F,ra=sn,ia=Ye,oa=function(e,t,n){var r,i;ra(e);try{if(!(r=ia(e,"return"))){if("throw"===t)throw n;return n}r=na(r,e)}catch(xm){i=!0,r=xm}if("throw"===t)throw n;if(i)throw r;return ra(r),n},sa=os,aa=rs.has,la=Cs,ha=Ps,ua=ms,ca=as,da=oa,pa=function(e){var t=sa(this),n=ha(e);if(la(t)<=n.size)return!1!==ua(t,(function(e){if(n.includes(e))return!1}),!0);var r=n.getIterator();return!1!==ca(r,(function(e){if(aa(t,e))return da(r,"normal",!1)}))};Ti({target:"Set",proto:!0,real:!0,forced:!Gs("isDisjointFrom",(function(e){return!e}))},{isDisjointFrom:pa});var ga=os,ma=Cs,fa=ms,wa=Ps,ya=function(e){var t=ga(this),n=wa(e);return!(ma(t)>n.size)&&!1!==fa(t,(function(e){if(!n.includes(e))return!1}),!0)};Ti({target:"Set",proto:!0,real:!0,forced:!Gs("isSubsetOf",(function(e){return e}))},{isSubsetOf:ya});var va=os,Ca=rs.has,Sa=Cs,Ra=Ps,Ea=as,ba=oa,Ta=function(e){var t=va(this),n=Ra(e);if(Sa(t)<n.size)return!1;var r=n.getIterator();return!1!==Ea(r,(function(e){if(!Ca(t,e))return ba(r,"normal",!1)}))};Ti({target:"Set",proto:!0,real:!0,forced:!Gs("isSupersetOf",(function(e){return!e}))},{isSupersetOf:Ta});var Na=os,Aa=vs,Ma=Ps,Ia=as,Oa=rs.add,xa=rs.has,Pa=rs.remove,_a=function(e){var t=Na(this),n=Ma(e).getIterator(),r=Aa(t);return Ia(n,(function(e){xa(t,e)?Pa(r,e):Oa(r,e)})),r};Ti({target:"Set",proto:!0,real:!0,forced:!Gs("symmetricDifference")},{symmetricDifference:_a});var La=os,Ha=rs.add,ka=vs,Fa=Ps,Da=as,Va=function(e){var t=La(this),n=Fa(e).getIterator(),r=ka(t);return Da(n,(function(e){Ha(r,e)})),r};Ti({target:"Set",proto:!0,real:!0,forced:!Gs("union")},{union:Va});var Ua=ve,Ba=TypeError,Wa=!P((function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype})),ja=gt,Ga=pe,za=ct,$a=Wa,Ya=Un("IE_PROTO"),Ka=Object,Xa=Ka.prototype,qa=$a?Ka.getPrototypeOf:function(e){var t=za(e);if(ja(t,Ya))return t[Ya];var n=t.constructor;return Ga(n)&&t instanceof n?n.prototype:t instanceof Ka?Xa:null},Qa=vr,Za=en,Ja=_,el=en,tl=G,nl=function(e,t,n){Ja?el.f(e,t,tl(0,n)):e[t]=n},rl={},il=Yr,ol=Kr,sl=Object.keys||function(e){return il(e,ol)},al=_,ll=tn,hl=en,ul=sn,cl=ce,dl=sl;rl.f=al&&!ll?Object.defineProperties:function(e,t){ul(e);for(var n,r=cl(t),i=dl(t),o=i.length,s=0;o>s;)hl.f(e,n=i[s++],r[n]);return e};var pl,gl=ye("document","documentElement"),ml=sn,fl=rl,wl=Kr,yl=Bn,vl=gl,Cl=Wt,Sl="prototype",Rl="script",El=Un("IE_PROTO"),bl=function(){},Tl=function(e){return"<"+Rl+">"+e+"</"+Rl+">"},Nl=function(e){e.write(Tl("")),e.close();var t=e.parentWindow.Object;return e=null,t},Al=function(){try{pl=new ActiveXObject("htmlfile")}catch(xm){}var e,t,n;Al="undefined"!=typeof document?document.domain&&pl?Nl(pl):(t=Cl("iframe"),n="java"+Rl+":",t.style.display="none",vl.appendChild(t),t.src=String(n),(e=t.contentWindow.document).open(),e.write(Tl("document.F=Object")),e.close(),e.F):Nl(pl);for(var r=wl.length;r--;)delete Al[Sl][wl[r]];return Al()};yl[El]=!0;var Ml,Il,Ol,xl=Object.create||function(e,t){var n;return null!==e?(bl[Sl]=ml(e),n=new bl,bl[Sl]=null,n[El]=e):n=Al(),void 0===t?n:fl.f(n,t)},Pl=P,_l=pe,Ll=me,Hl=qa,kl=br,Fl=Mt("iterator"),Dl=!1;[].keys&&("next"in(Ol=[].keys())?(Il=Hl(Hl(Ol)))!==Object.prototype&&(Ml=Il):Dl=!0);var Vl=!Ll(Ml)||Pl((function(){var e={};return Ml[Fl].call(e)!==e}));Vl&&(Ml={}),_l(Ml[Fl])||kl(Ml,Fl,(function(){return this}));var Ul={IteratorPrototype:Ml,BUGGY_SAFARI_ITERATORS:Dl},Bl=Ti,Wl=O,jl=function(e,t){if(Ua(t,e))return e;throw new Ba("Incorrect invocation")},Gl=sn,zl=pe,$l=qa,Yl=function(e,t,n){return n.get&&Qa(n.get,t,{getter:!0}),n.set&&Qa(n.set,t,{setter:!0}),Za.f(e,t,n)},Kl=nl,Xl=P,ql=gt,Ql=Ul.IteratorPrototype,Zl=_,Jl="constructor",eh="Iterator",th=Mt("toStringTag"),nh=TypeError,rh=Wl[eh],ih=!zl(rh)||rh.prototype!==Ql||!Xl((function(){rh({})})),oh=function(){if(jl(this,Ql),$l(this)===Ql)throw new nh("Abstract class Iterator not directly constructable")},sh=function(e,t){Zl?Yl(Ql,e,{configurable:!0,get:function(){return t},set:function(t){if(Gl(this),this===Ql)throw new nh("You can't redefine this property");ql(this,e)?this[e]=t:Kl(this,e,t)}}):Ql[e]=t};ql(Ql,th)||sh(th,eh),!ih&&ql(Ql,Jl)&&Ql[Jl]!==Object||sh(Jl,oh),oh.prototype=Ql,Bl({global:!0,constructor:!0,forced:ih},{Iterator:oh});var ah=br,lh=F,hh=xl,uh=Cn,ch=function(e,t,n){for(var r in t)ah(e,r,t[r],n);return e},dh=tr,ph=Ye,gh=Ul.IteratorPrototype,mh=function(e,t){return{value:e,done:t}},fh=oa,wh=Mt("toStringTag"),yh="IteratorHelper",vh="WrapForValidIterator",Ch=dh.set,Sh=function(e){var t=dh.getterFor(e?vh:yh);return ch(hh(gh),{next:function(){var n=t(this);if(e)return n.nextHandler();if(n.done)return mh(void 0,!0);try{var r=n.nextHandler();return n.returnHandlerResult?r:mh(r,n.done)}catch(xm){throw n.done=!0,xm}},return:function(){var n=t(this),r=n.iterator;if(n.done=!0,e){var i=ph(r,"return");return i?lh(i,r):mh(void 0,!0)}if(n.inner)try{fh(n.inner.iterator,"normal")}catch(xm){return fh(r,"throw",xm)}return r&&fh(r,"normal"),mh(void 0,!0)}})},Rh=Sh(!0),Eh=Sh(!1);uh(Eh,wh,"Iterator Helper");var bh=function(e,t,n){var r=function(r,i){i?(i.iterator=r.iterator,i.next=r.next):i=r,i.type=t?vh:yh,i.returnHandlerResult=!!n,i.nextHandler=e,i.counter=0,i.done=!1,Ch(this,i)};return r.prototype=t?Rh:Eh,r},Th=sn,Nh=oa,Ah=function(e,t,n,r){try{return r?t(Th(n)[0],n[1]):t(n)}catch(xm){Nh(e,"throw",xm)}},Mh=Ti,Ih=F,Oh=Ge,xh=sn,Ph=Ss,_h=Ah,Lh=bh((function(){for(var e,t,n=this.iterator,r=this.predicate,i=this.next;;){if(e=xh(Ih(i,n)),this.done=!!e.done)return;if(t=e.value,_h(n,r,[t,this.counter++],!0))return t}}));Mh({target:"Iterator",proto:!0,real:!0,forced:false},{filter:function(e){return xh(this),Oh(e),new Lh(Ph(this),{predicate:e})}});var Hh=J,kh=X,Fh=function(e){if("Function"===Hh(e))return kh(e)},Dh=Ge,Vh=L,Uh=Fh(Fh.bind),Bh=function(e,t){return Dh(e),void 0===t?e:Vh?Uh(e,t):function(){return e.apply(t,arguments)}},Wh={},jh=Wh,Gh=Mt("iterator"),zh=Array.prototype,$h=eo,Yh=Ye,Kh=oe,Xh=Wh,qh=Mt("iterator"),Qh=function(e){if(!Kh(e))return Yh(e,qh)||Yh(e,"@@iterator")||Xh[$h(e)]},Zh=F,Jh=Ge,eu=sn,tu=Ue,nu=Qh,ru=TypeError,iu=Bh,ou=F,su=sn,au=Ue,lu=function(e){return void 0!==e&&(jh.Array===e||zh[Gh]===e)},hu=kr,uu=ve,cu=function(e,t){var n=arguments.length<2?nu(e):t;if(Jh(n))return eu(Zh(n,e));throw new ru(tu(e)+" is not iterable")},du=Qh,pu=oa,gu=TypeError,mu=function(e,t){this.stopped=e,this.result=t},fu=mu.prototype,wu=function(e,t,n){var r,i,o,s,a,l,h,u=n&&n.that,c=!(!n||!n.AS_ENTRIES),d=!(!n||!n.IS_RECORD),p=!(!n||!n.IS_ITERATOR),g=!(!n||!n.INTERRUPTED),m=iu(t,u),f=function(e){return r&&pu(r,"normal",e),new mu(!0,e)},w=function(e){return c?(su(e),g?m(e[0],e[1],f):m(e[0],e[1])):g?m(e,f):m(e)};if(d)r=e.iterator;else if(p)r=e;else{if(!(i=du(e)))throw new gu(au(e)+" is not iterable");if(lu(i)){for(o=0,s=hu(e);s>o;o++)if((a=w(e[o]))&&uu(fu,a))return a;return new mu(!1)}r=cu(e,i)}for(l=d?e.next:r.next;!(h=ou(l,r)).done;){try{a=w(h.value)}catch(xm){pu(r,"throw",xm)}if("object"==typeof a&&a&&uu(fu,a))return a}return new mu(!1)},yu=wu,vu=Ge,Cu=sn,Su=Ss;Ti({target:"Iterator",proto:!0,real:!0},{forEach:function(e){Cu(this),vu(e);var t=Su(this),n=0;yu(t,(function(t){e(t,n++)}),{IS_RECORD:!0})}});var Ru=F,Eu=Ge,bu=sn,Tu=Ss,Nu=Ah,Au=bh((function(){var e=this.iterator,t=bu(Ru(this.next,e));if(!(this.done=!!t.done))return Nu(e,this.mapper,[t.value,this.counter++],!0)}));Ti({target:"Iterator",proto:!0,real:!0,forced:false},{map:function(e){return bu(this),Eu(e),new Au(Tu(this),{mapper:e})}});var Mu,Iu,Ou,xu,Pu=X([].slice),_u=TypeError,Lu=function(e,t){if(e<t)throw new _u("Not enough arguments");return e},Hu=/(?:ipad|iphone|ipod).*applewebkit/i.test(Re),ku=O,Fu=Re,Du=J,Vu=function(e){return Fu.slice(0,e.length)===e},Uu=Vu("Bun/")?"BUN":Vu("Cloudflare-Workers")?"CLOUDFLARE":Vu("Deno/")?"DENO":Vu("Node.js/")?"NODE":ku.Bun&&"string"==typeof Bun.version?"BUN":ku.Deno&&"object"==typeof Deno.version?"DENO":"process"===Du(ku.process)?"NODE":ku.window&&ku.document?"BROWSER":"REST",Bu=O,Wu=Oi,ju=Bh,Gu=pe,zu=gt,$u=P,Yu=gl,Ku=Pu,Xu=Wt,qu=Lu,Qu=Hu,Zu="NODE"===Uu,Ju=Bu.setImmediate,ec=Bu.clearImmediate,tc=Bu.process,nc=Bu.Dispatch,rc=Bu.Function,ic=Bu.MessageChannel,oc=Bu.String,sc=0,ac={},lc="onreadystatechange";$u((function(){Mu=Bu.location}));var hc=function(e){if(zu(ac,e)){var t=ac[e];delete ac[e],t()}},uc=function(e){return function(){hc(e)}},cc=function(e){hc(e.data)},dc=function(e){Bu.postMessage(oc(e),Mu.protocol+"//"+Mu.host)};Ju&&ec||(Ju=function(e){qu(arguments.length,1);var t=Gu(e)?e:rc(e),n=Ku(arguments,1);return ac[++sc]=function(){Wu(t,void 0,n)},Iu(sc),sc},ec=function(e){delete ac[e]},Zu?Iu=function(e){tc.nextTick(uc(e))}:nc&&nc.now?Iu=function(e){nc.now(uc(e))}:ic&&!Qu?(xu=(Ou=new ic).port2,Ou.port1.onmessage=cc,Iu=ju(xu.postMessage,xu)):Bu.addEventListener&&Gu(Bu.postMessage)&&!Bu.importScripts&&Mu&&"file:"!==Mu.protocol&&!$u(dc)?(Iu=dc,Bu.addEventListener("message",cc,!1)):Iu=lc in Xu("script")?function(e){Yu.appendChild(Xu("script"))[lc]=function(){Yu.removeChild(this),hc(e)}}:function(e){setTimeout(uc(e),0)});var pc={set:Ju,clear:ec},gc=pc.clear;Ti({global:!0,bind:!0,enumerable:!0,forced:O.clearImmediate!==gc},{clearImmediate:gc});var mc=O,fc=Oi,wc=pe,yc=Uu,vc=Re,Cc=Pu,Sc=Lu,Rc=mc.Function,Ec=/MSIE .\./.test(vc)||"BUN"===yc&&function(){var e=mc.Bun.version.split(".");return e.length<3||"0"===e[0]&&(e[1]<3||"3"===e[1]&&"0"===e[2])}(),bc=Ti,Tc=O,Nc=pc.set,Ac=function(e,t){var n=t?2:1;return Ec?function(r,i){var o=Sc(arguments.length,1)>n,s=wc(r)?r:Rc(r),a=o?Cc(arguments,n):[],l=o?function(){fc(s,this,a)}:s;return t?e(l,i):e(l)}:e},Mc=Tc.setImmediate?Ac(Nc,!1):Nc;bc({global:!0,bind:!0,enumerable:!0,forced:Tc.setImmediate!==Mc},{setImmediate:Mc});
/*! @license DOMPurify 3.2.4 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.2.4/LICENSE */
const{entries:Ic,setPrototypeOf:Oc,isFrozen:xc,getPrototypeOf:Pc,getOwnPropertyDescriptor:_c}=Object;let{freeze:Lc,seal:Hc,create:kc}=Object,{apply:Fc,construct:Dc}="undefined"!=typeof Reflect&&Reflect;Lc||(Lc=function(e){return e}),Hc||(Hc=function(e){return e}),Fc||(Fc=function(e,t,n){return e.apply(t,n)}),Dc||(Dc=function(e,t){return new e(...t)});const Vc=ed(Array.prototype.forEach),Uc=ed(Array.prototype.lastIndexOf),Bc=ed(Array.prototype.pop),Wc=ed(Array.prototype.push),jc=ed(Array.prototype.splice),Gc=ed(String.prototype.toLowerCase),zc=ed(String.prototype.toString),$c=ed(String.prototype.match),Yc=ed(String.prototype.replace),Kc=ed(String.prototype.indexOf),Xc=ed(String.prototype.trim),qc=ed(Object.prototype.hasOwnProperty),Qc=ed(RegExp.prototype.test),Zc=(Jc=TypeError,function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Dc(Jc,t)});var Jc;function ed(e){return function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return Fc(e,t,r)}}function td(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Gc;Oc&&Oc(e,null);let r=t.length;for(;r--;){let i=t[r];if("string"==typeof i){const e=n(i);e!==i&&(xc(t)||(t[r]=e),i=e)}e[i]=!0}return e}function nd(e){for(let t=0;t<e.length;t++){qc(e,t)||(e[t]=null)}return e}function rd(e){const t=kc(null);for(const[n,r]of Ic(e)){qc(e,n)&&(Array.isArray(r)?t[n]=nd(r):r&&"object"==typeof r&&r.constructor===Object?t[n]=rd(r):t[n]=r)}return t}function id(e,t){for(;null!==e;){const n=_c(e,t);if(n){if(n.get)return ed(n.get);if("function"==typeof n.value)return ed(n.value)}e=Pc(e)}return function(){return null}}const od=Lc(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),sd=Lc(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),ad=Lc(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),ld=Lc(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),hd=Lc(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),ud=Lc(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),cd=Lc(["#text"]),dd=Lc(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),pd=Lc(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),gd=Lc(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),md=Lc(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),fd=Hc(/\{\{[\w\W]*|[\w\W]*\}\}/gm),wd=Hc(/<%[\w\W]*|[\w\W]*%>/gm),yd=Hc(/\$\{[\w\W]*/gm),vd=Hc(/^data-[\-\w.\u00B7-\uFFFF]+$/),Cd=Hc(/^aria-[\-\w]+$/),Sd=Hc(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),Rd=Hc(/^(?:\w+script|data):/i),Ed=Hc(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),bd=Hc(/^html$/i),Td=Hc(/^[a-z][.\w]*(-[.\w]+)+$/i);var Nd=Object.freeze({__proto__:null,ARIA_ATTR:Cd,ATTR_WHITESPACE:Ed,CUSTOM_ELEMENT:Td,DATA_ATTR:vd,DOCTYPE_NAME:bd,ERB_EXPR:wd,IS_ALLOWED_URI:Sd,IS_SCRIPT_OR_DATA:Rd,MUSTACHE_EXPR:fd,TMPLIT_EXPR:yd});const Ad=1,Md=3,Id=7,Od=8,xd=9,Pd=function(){return"undefined"==typeof window?null:window};var _d=function e(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Pd();const n=t=>e(t);if(n.version="3.2.4",n.removed=[],!t||!t.document||t.document.nodeType!==xd||!t.Element)return n.isSupported=!1,n;let{document:r}=t;const i=r,o=i.currentScript,{DocumentFragment:s,HTMLTemplateElement:a,Node:l,Element:h,NodeFilter:u,NamedNodeMap:c=t.NamedNodeMap||t.MozNamedAttrMap,HTMLFormElement:d,DOMParser:p,trustedTypes:g}=t,m=h.prototype,f=id(m,"cloneNode"),w=id(m,"remove"),y=id(m,"nextSibling"),v=id(m,"childNodes"),C=id(m,"parentNode");if("function"==typeof a){const e=r.createElement("template");e.content&&e.content.ownerDocument&&(r=e.content.ownerDocument)}let S,R="";const{implementation:E,createNodeIterator:b,createDocumentFragment:T,getElementsByTagName:N}=r,{importNode:A}=i;let M={afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]};n.isSupported="function"==typeof Ic&&"function"==typeof C&&E&&void 0!==E.createHTMLDocument;const{MUSTACHE_EXPR:I,ERB_EXPR:O,TMPLIT_EXPR:x,DATA_ATTR:P,ARIA_ATTR:_,IS_SCRIPT_OR_DATA:L,ATTR_WHITESPACE:H,CUSTOM_ELEMENT:k}=Nd;let{IS_ALLOWED_URI:F}=Nd,D=null;const V=td({},[...od,...sd,...ad,...hd,...cd]);let U=null;const B=td({},[...dd,...pd,...gd,...md]);let W=Object.seal(kc(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),j=null,G=null,z=!0,$=!0,Y=!1,K=!0,X=!1,q=!0,Q=!1,Z=!1,J=!1,ee=!1,te=!1,ne=!1,re=!0,ie=!1,oe=!0,se=!1,ae={},le=null;const he=td({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let ue=null;const ce=td({},["audio","video","img","source","image","track"]);let de=null;const pe=td({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),ge="http://www.w3.org/1998/Math/MathML",me="http://www.w3.org/2000/svg",fe="http://www.w3.org/1999/xhtml";let we=fe,ye=!1,ve=null;const Ce=td({},[ge,me,fe],zc);let Se=td({},["mi","mo","mn","ms","mtext"]),Re=td({},["annotation-xml"]);const Ee=td({},["title","style","font","a","script"]);let be=null;const Te=["application/xhtml+xml","text/html"];let Ne=null,Ae=null;const Me=r.createElement("form"),Ie=function(e){return e instanceof RegExp||e instanceof Function},Oe=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!Ae||Ae!==e){if(e&&"object"==typeof e||(e={}),e=rd(e),be=-1===Te.indexOf(e.PARSER_MEDIA_TYPE)?"text/html":e.PARSER_MEDIA_TYPE,Ne="application/xhtml+xml"===be?zc:Gc,D=qc(e,"ALLOWED_TAGS")?td({},e.ALLOWED_TAGS,Ne):V,U=qc(e,"ALLOWED_ATTR")?td({},e.ALLOWED_ATTR,Ne):B,ve=qc(e,"ALLOWED_NAMESPACES")?td({},e.ALLOWED_NAMESPACES,zc):Ce,de=qc(e,"ADD_URI_SAFE_ATTR")?td(rd(pe),e.ADD_URI_SAFE_ATTR,Ne):pe,ue=qc(e,"ADD_DATA_URI_TAGS")?td(rd(ce),e.ADD_DATA_URI_TAGS,Ne):ce,le=qc(e,"FORBID_CONTENTS")?td({},e.FORBID_CONTENTS,Ne):he,j=qc(e,"FORBID_TAGS")?td({},e.FORBID_TAGS,Ne):{},G=qc(e,"FORBID_ATTR")?td({},e.FORBID_ATTR,Ne):{},ae=!!qc(e,"USE_PROFILES")&&e.USE_PROFILES,z=!1!==e.ALLOW_ARIA_ATTR,$=!1!==e.ALLOW_DATA_ATTR,Y=e.ALLOW_UNKNOWN_PROTOCOLS||!1,K=!1!==e.ALLOW_SELF_CLOSE_IN_ATTR,X=e.SAFE_FOR_TEMPLATES||!1,q=!1!==e.SAFE_FOR_XML,Q=e.WHOLE_DOCUMENT||!1,ee=e.RETURN_DOM||!1,te=e.RETURN_DOM_FRAGMENT||!1,ne=e.RETURN_TRUSTED_TYPE||!1,J=e.FORCE_BODY||!1,re=!1!==e.SANITIZE_DOM,ie=e.SANITIZE_NAMED_PROPS||!1,oe=!1!==e.KEEP_CONTENT,se=e.IN_PLACE||!1,F=e.ALLOWED_URI_REGEXP||Sd,we=e.NAMESPACE||fe,Se=e.MATHML_TEXT_INTEGRATION_POINTS||Se,Re=e.HTML_INTEGRATION_POINTS||Re,W=e.CUSTOM_ELEMENT_HANDLING||{},e.CUSTOM_ELEMENT_HANDLING&&Ie(e.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(W.tagNameCheck=e.CUSTOM_ELEMENT_HANDLING.tagNameCheck),e.CUSTOM_ELEMENT_HANDLING&&Ie(e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(W.attributeNameCheck=e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),e.CUSTOM_ELEMENT_HANDLING&&"boolean"==typeof e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements&&(W.allowCustomizedBuiltInElements=e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),X&&($=!1),te&&(ee=!0),ae&&(D=td({},cd),U=[],!0===ae.html&&(td(D,od),td(U,dd)),!0===ae.svg&&(td(D,sd),td(U,pd),td(U,md)),!0===ae.svgFilters&&(td(D,ad),td(U,pd),td(U,md)),!0===ae.mathMl&&(td(D,hd),td(U,gd),td(U,md))),e.ADD_TAGS&&(D===V&&(D=rd(D)),td(D,e.ADD_TAGS,Ne)),e.ADD_ATTR&&(U===B&&(U=rd(U)),td(U,e.ADD_ATTR,Ne)),e.ADD_URI_SAFE_ATTR&&td(de,e.ADD_URI_SAFE_ATTR,Ne),e.FORBID_CONTENTS&&(le===he&&(le=rd(le)),td(le,e.FORBID_CONTENTS,Ne)),oe&&(D["#text"]=!0),Q&&td(D,["html","head","body"]),D.table&&(td(D,["tbody"]),delete j.tbody),e.TRUSTED_TYPES_POLICY){if("function"!=typeof e.TRUSTED_TYPES_POLICY.createHTML)throw Zc('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if("function"!=typeof e.TRUSTED_TYPES_POLICY.createScriptURL)throw Zc('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');S=e.TRUSTED_TYPES_POLICY,R=S.createHTML("")}else void 0===S&&(S=function(e,t){if("object"!=typeof e||"function"!=typeof e.createPolicy)return null;let n=null;const r="data-tt-policy-suffix";t&&t.hasAttribute(r)&&(n=t.getAttribute(r));const i="dompurify"+(n?"#"+n:"");try{return e.createPolicy(i,{createHTML:e=>e,createScriptURL:e=>e})}catch(o){return console.warn("TrustedTypes policy "+i+" could not be created."),null}}(g,o)),null!==S&&"string"==typeof R&&(R=S.createHTML(""));Lc&&Lc(e),Ae=e}},xe=td({},[...sd,...ad,...ld]),Pe=td({},[...hd,...ud]),_e=function(e){Wc(n.removed,{element:e});try{C(e).removeChild(e)}catch(t){w(e)}},Le=function(e,t){try{Wc(n.removed,{attribute:t.getAttributeNode(e),from:t})}catch(r){Wc(n.removed,{attribute:null,from:t})}if(t.removeAttribute(e),"is"===e)if(ee||te)try{_e(t)}catch(r){}else try{t.setAttribute(e,"")}catch(r){}},He=function(e){let t=null,n=null;if(J)e="<remove></remove>"+e;else{const t=$c(e,/^[\r\n\t ]+/);n=t&&t[0]}"application/xhtml+xml"===be&&we===fe&&(e='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+e+"</body></html>");const i=S?S.createHTML(e):e;if(we===fe)try{t=(new p).parseFromString(i,be)}catch(s){}if(!t||!t.documentElement){t=E.createDocument(we,"template",null);try{t.documentElement.innerHTML=ye?R:i}catch(s){}}const o=t.body||t.documentElement;return e&&n&&o.insertBefore(r.createTextNode(n),o.childNodes[0]||null),we===fe?N.call(t,Q?"html":"body")[0]:Q?t.documentElement:o},ke=function(e){return b.call(e.ownerDocument||e,e,u.SHOW_ELEMENT|u.SHOW_COMMENT|u.SHOW_TEXT|u.SHOW_PROCESSING_INSTRUCTION|u.SHOW_CDATA_SECTION,null)},Fe=function(e){return e instanceof d&&("string"!=typeof e.nodeName||"string"!=typeof e.textContent||"function"!=typeof e.removeChild||!(e.attributes instanceof c)||"function"!=typeof e.removeAttribute||"function"!=typeof e.setAttribute||"string"!=typeof e.namespaceURI||"function"!=typeof e.insertBefore||"function"!=typeof e.hasChildNodes)},De=function(e){return"function"==typeof l&&e instanceof l};function Ve(e,t,r){Vc(e,(e=>{e.call(n,t,r,Ae)}))}const Ue=function(e){let t=null;if(Ve(M.beforeSanitizeElements,e,null),Fe(e))return _e(e),!0;const r=Ne(e.nodeName);if(Ve(M.uponSanitizeElement,e,{tagName:r,allowedTags:D}),e.hasChildNodes()&&!De(e.firstElementChild)&&Qc(/<[/\w]/g,e.innerHTML)&&Qc(/<[/\w]/g,e.textContent))return _e(e),!0;if(e.nodeType===Id)return _e(e),!0;if(q&&e.nodeType===Od&&Qc(/<[/\w]/g,e.data))return _e(e),!0;if(!D[r]||j[r]){if(!j[r]&&We(r)){if(W.tagNameCheck instanceof RegExp&&Qc(W.tagNameCheck,r))return!1;if(W.tagNameCheck instanceof Function&&W.tagNameCheck(r))return!1}if(oe&&!le[r]){const t=C(e)||e.parentNode,n=v(e)||e.childNodes;if(n&&t){for(let r=n.length-1;r>=0;--r){const i=f(n[r],!0);i.__removalCount=(e.__removalCount||0)+1,t.insertBefore(i,y(e))}}}return _e(e),!0}return e instanceof h&&!function(e){let t=C(e);t&&t.tagName||(t={namespaceURI:we,tagName:"template"});const n=Gc(e.tagName),r=Gc(t.tagName);return!!ve[e.namespaceURI]&&(e.namespaceURI===me?t.namespaceURI===fe?"svg"===n:t.namespaceURI===ge?"svg"===n&&("annotation-xml"===r||Se[r]):Boolean(xe[n]):e.namespaceURI===ge?t.namespaceURI===fe?"math"===n:t.namespaceURI===me?"math"===n&&Re[r]:Boolean(Pe[n]):e.namespaceURI===fe?!(t.namespaceURI===me&&!Re[r])&&!(t.namespaceURI===ge&&!Se[r])&&!Pe[n]&&(Ee[n]||!xe[n]):!("application/xhtml+xml"!==be||!ve[e.namespaceURI]))}(e)?(_e(e),!0):"noscript"!==r&&"noembed"!==r&&"noframes"!==r||!Qc(/<\/no(script|embed|frames)/i,e.innerHTML)?(X&&e.nodeType===Md&&(t=e.textContent,Vc([I,O,x],(e=>{t=Yc(t,e," ")})),e.textContent!==t&&(Wc(n.removed,{element:e.cloneNode()}),e.textContent=t)),Ve(M.afterSanitizeElements,e,null),!1):(_e(e),!0)},Be=function(e,t,n){if(re&&("id"===t||"name"===t)&&(n in r||n in Me))return!1;if($&&!G[t]&&Qc(P,t));else if(z&&Qc(_,t));else if(!U[t]||G[t]){if(!(We(e)&&(W.tagNameCheck instanceof RegExp&&Qc(W.tagNameCheck,e)||W.tagNameCheck instanceof Function&&W.tagNameCheck(e))&&(W.attributeNameCheck instanceof RegExp&&Qc(W.attributeNameCheck,t)||W.attributeNameCheck instanceof Function&&W.attributeNameCheck(t))||"is"===t&&W.allowCustomizedBuiltInElements&&(W.tagNameCheck instanceof RegExp&&Qc(W.tagNameCheck,n)||W.tagNameCheck instanceof Function&&W.tagNameCheck(n))))return!1}else if(de[t]);else if(Qc(F,Yc(n,H,"")));else if("src"!==t&&"xlink:href"!==t&&"href"!==t||"script"===e||0!==Kc(n,"data:")||!ue[e]){if(Y&&!Qc(L,Yc(n,H,"")));else if(n)return!1}else;return!0},We=function(e){return"annotation-xml"!==e&&$c(e,k)},je=function(e){Ve(M.beforeSanitizeAttributes,e,null);const{attributes:t}=e;if(!t||Fe(e))return;const r={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:U,forceKeepAttr:void 0};let i=t.length;for(;i--;){const s=t[i],{name:a,namespaceURI:l,value:h}=s,u=Ne(a);let c="value"===a?h:Xc(h);if(r.attrName=u,r.attrValue=c,r.keepAttr=!0,r.forceKeepAttr=void 0,Ve(M.uponSanitizeAttribute,e,r),c=r.attrValue,!ie||"id"!==u&&"name"!==u||(Le(a,e),c="user-content-"+c),q&&Qc(/((--!?|])>)|<\/(style|title)/i,c)){Le(a,e);continue}if(r.forceKeepAttr)continue;if(Le(a,e),!r.keepAttr)continue;if(!K&&Qc(/\/>/i,c)){Le(a,e);continue}X&&Vc([I,O,x],(e=>{c=Yc(c,e," ")}));const d=Ne(e.nodeName);if(Be(d,u,c)){if(S&&"object"==typeof g&&"function"==typeof g.getAttributeType)if(l);else switch(g.getAttributeType(d,u)){case"TrustedHTML":c=S.createHTML(c);break;case"TrustedScriptURL":c=S.createScriptURL(c)}try{l?e.setAttributeNS(l,a,c):e.setAttribute(a,c),Fe(e)?_e(e):Bc(n.removed)}catch(o){}}}Ve(M.afterSanitizeAttributes,e,null)},Ge=function e(t){let n=null;const r=ke(t);for(Ve(M.beforeSanitizeShadowDOM,t,null);n=r.nextNode();)Ve(M.uponSanitizeShadowNode,n,null),Ue(n),je(n),n.content instanceof s&&e(n.content);Ve(M.afterSanitizeShadowDOM,t,null)};return n.sanitize=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=null,o=null,a=null,h=null;if(ye=!e,ye&&(e="\x3c!--\x3e"),"string"!=typeof e&&!De(e)){if("function"!=typeof e.toString)throw Zc("toString is not a function");if("string"!=typeof(e=e.toString()))throw Zc("dirty is not a string, aborting")}if(!n.isSupported)return e;if(Z||Oe(t),n.removed=[],"string"==typeof e&&(se=!1),se){if(e.nodeName){const t=Ne(e.nodeName);if(!D[t]||j[t])throw Zc("root node is forbidden and cannot be sanitized in-place")}}else if(e instanceof l)r=He("\x3c!----\x3e"),o=r.ownerDocument.importNode(e,!0),o.nodeType===Ad&&"BODY"===o.nodeName||"HTML"===o.nodeName?r=o:r.appendChild(o);else{if(!ee&&!X&&!Q&&-1===e.indexOf("<"))return S&&ne?S.createHTML(e):e;if(r=He(e),!r)return ee?null:ne?R:""}r&&J&&_e(r.firstChild);const u=ke(se?e:r);for(;a=u.nextNode();)Ue(a),je(a),a.content instanceof s&&Ge(a.content);if(se)return e;if(ee){if(te)for(h=T.call(r.ownerDocument);r.firstChild;)h.appendChild(r.firstChild);else h=r;return(U.shadowroot||U.shadowrootmode)&&(h=A.call(i,h,!0)),h}let c=Q?r.outerHTML:r.innerHTML;return Q&&D["!doctype"]&&r.ownerDocument&&r.ownerDocument.doctype&&r.ownerDocument.doctype.name&&Qc(bd,r.ownerDocument.doctype.name)&&(c="<!DOCTYPE "+r.ownerDocument.doctype.name+">\n"+c),X&&Vc([I,O,x],(e=>{c=Yc(c,e," ")})),S&&ne?S.createHTML(c):c},n.setConfig=function(){Oe(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),Z=!0},n.clearConfig=function(){Ae=null,Z=!1},n.isValidAttribute=function(e,t,n){Ae||Oe({});const r=Ne(e),i=Ne(t);return Be(r,i,n)},n.addHook=function(e,t){"function"==typeof t&&Wc(M[e],t)},n.removeHook=function(e,t){if(void 0!==t){const n=Uc(M[e],t);return-1===n?void 0:jc(M[e],n,1)[0]}return Bc(M[e])},n.removeHooks=function(e){M[e]=[]},n.removeAllHooks=function(){M={afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}},n}();function Ld(e,t){const n=t.length;let r=0;for(;r<n;)e.push(t[r]),r+=1}function Hd(e){const t=[];if(!e||0===e.length||!e[0]||0===e[0].length)return t;const n=e.length,r=e[0].length;for(let i=0;i<n;i++)for(let n=0;n<r;n++)t[n]||(t[n]=[]),t[n][i]=e[i][n];return t}function kd(e,t,n,r){let i=-1,o=e,s=n;Array.isArray(e)||(o=Array.from(e));const a=o.length;for(r&&a&&(i+=1,s=o[i]),i+=1;i<a;)s=t(s,o[i],i,o),i+=1;return s}function Fd(e,t){let n=0,r=e;Array.isArray(e)||(r=Array.from(e));const i=r.length,o=[];let s=-1;for(;n<i;){const e=r[n];t(e,n,r)&&(s+=1,o[s]=e),n+=1}return o}function Dd(e,t){let n=0,r=e;Array.isArray(e)||(r=Array.from(e));const i=r.length,o=[];let s=-1;for(;n<i;){const e=r[n];s+=1,o[s]=t(e,n,r),n+=1}return o}function Vd(e,t){let n=0,r=e;Array.isArray(e)||(r=Array.from(e));const i=r.length;for(;n<i&&!1!==t(r[n],n,r);)n+=1;return e}function Ud(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const[r,...i]=[...t];let o=r;return Vd(i,(e=>{o=o.filter((t=>!e.includes(t)))})),o}function Bd(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:" ";return e.split(t)}function Wd(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const i=kd(e,((e,t,r)=>e+t.replace(/\r?\n\s*/g,"")+(n[r]?n[r]:"")),"");return i.trim()}function jd(e){let t;switch(typeof e){case"string":case"number":t=`${e}`;break;case"object":t=null===e?"":e.toString();break;case"undefined":t="";break;default:t=e.toString()}return t}function Gd(e){return void 0!==e}function zd(e){return void 0===e}function $d(e){return null===e||""===e||zd(e)}const Yd="length",Kd=e=>parseInt(e,16),Xd=e=>parseInt(e,10),qd=(e,t,n)=>e.substr(t,n),Qd=e=>e.codePointAt(0)-65,Zd=e=>`${e}`.replace(/\-/g,"");let Jd=!1;const ep={invalid:()=>Wd`
    The license key for Handsontable is invalid.\x20
    If you need any help, contact us at support@handsontable.com.`,expired:e=>{let{keyValidityDate:t,hotVersion:n}=e;return Wd`
    The license key for Handsontable expired on ${t}, and is not valid for the installed\x20
    version ${n}. Renew your license key at handsontable.com or downgrade to a version released prior\x20
    to ${t}. If you need any help, contact us at sales@handsontable.com.`},missing:()=>Wd`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\x20
    us at support@handsontable.com.`,non_commercial:()=>""},tp={invalid:()=>Wd`
    The license key for Handsontable is invalid.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,expired:e=>{let{keyValidityDate:t,hotVersion:n}=e;return Wd`
    The license key for Handsontable expired on ${t}, and is not valid for the installed\x20
    version ${n}. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\x20
    license key or downgrade to a version released prior to ${t}. If you need any\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`},missing:()=>Wd`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,non_commercial:()=>""};function np(e,t){const n=!$d(e),r="string"==typeof e&&"non-commercial-and-evaluation"===e.toLowerCase(),i="15.2.0";let o,s="invalid",a="invalid";const l=function(e){let t=[][Yd],n=t;if(e[Yd]!==Qd("Z"))return!1;for(let r="",i="B<H4P+".split(""),o=Qd(i.shift());o;o=Qd(i.shift()||"A"))--o<""[Yd]?n|=(Xd(`${Xd(Kd(r)+(Kd(qd(e,Math.abs(o),2))+[]).padStart(2,"0"))}`)%97||2)>>1:r=qd(e,o,o?1===i[Yd]?9:8:6);return n===t}(e=Zd(e||""));if(n||r||l)if(l){const t=M("19/03/2025","DD/MM/YYYY"),n=Math.floor(t.toDate().getTime()/864e5),r=Kd(qd(Zd(h=e),Kd("12"),Qd("F")))/(Kd(qd(Zd(h),Qd("B"),~~![][Yd]))||9);o=M(864e5*(r+1),"x").format("MMMM DD, YYYY"),n>r?(s="expired",a="expired"):(s="valid",a="valid")}else r?(s="non_commercial",a="valid"):(s="invalid",a="invalid");else s="missing",a="missing";var h;if("undefined"!=typeof location&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host)&&(s="valid",a="valid"),!Jd&&"valid"!==s){ep[s]({keyValidityDate:o,hotVersion:i})&&console["non_commercial"===s?"info":"warn"](ep[s]({keyValidityDate:o,hotVersion:i})),Jd=!0}if("valid"!==a&&t.parentNode){if(tp[a]({keyValidityDate:o,hotVersion:i})){const e=document.createElement("div");e.className="handsontable hot-display-license-info",e.innerHTML=tp[a]({keyValidityDate:o,hotVersion:i}),t.parentNode.insertBefore(e,t.nextSibling)}}}function rp(e){return e[0].toUpperCase()+e.substr(1)}function ip(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+e()+e()}function op(e){return/^([0-9][0-9]?%$)|(^100%$)/.test(e)}function sp(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return`${e}`.replace(/(?:\\)?\[([^[\]]+)]/g,((e,n)=>"\\"===e.charAt(0)?e.substr(1,e.length-1):void 0===t[n]?"":t[n]))}function ap(e){return lp(`${e}`,{ALLOWED_TAGS:[]})}function lp(e,t){return _d.sanitize(e,t)}const hp=e=>["tabindex",e],up=e=>["aria-label",e],cp=e=>["aria-haspopup",e],dp=e=>["aria-rowcount",e],pp=e=>["aria-colcount",e],gp=e=>["aria-rowindex",e],mp=e=>["aria-colindex",e],fp=e=>["aria-expanded",e],wp=e=>["aria-checked",e],yp=e=>["aria-relevant",e],vp=e=>["aria-posinset",e];function Cp(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=-1,r=null,i=e;for(;null!==i;){if(n===t){r=i;break}i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:(n+=1,i=i.parentNode)}return r}function Sp(e,t){const n=e.closest(".handsontable");return!!n&&(n.parentNode===t||n===t)}function Rp(e){return function(e){return Object.getPrototypeOf(e.parent)&&e.frameElement}(e)&&e.parent}function Ep(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;const{ELEMENT_NODE:r,DOCUMENT_FRAGMENT_NODE:i}=Node;let o=e;for(;null!=o&&o!==n;){const{nodeType:e,nodeName:n}=o;if(e===r&&(t.includes(n)||t.includes(o)))return o;const{host:s}=o;o=s&&e===i?s:o.parentNode}return null}function bp(e,t,n){const r=[];let i=e;for(;i&&(i=Ep(i,t,n),i&&(!n||n.contains(i)));)r.push(i),i=i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i.host:i.parentNode;const o=r.length;return o?r[o-1]:null}function Tp(e,t){let n=e.parentNode,r=[];for("string"==typeof t?r=e.defaultView?Array.prototype.slice.call(e.querySelectorAll(t),0):Array.prototype.slice.call(e.ownerDocument.querySelectorAll(t),0):r.push(t);null!==n;){if(r.indexOf(n)>-1)return!0;n=n.parentNode}return!1}function Np(e,t,n){const r=n.parentElement.querySelector(`.ht_clone_${e}`);return r?r.contains(t):null}function Ap(e){return e&&e.length?e.filter((e=>!!e)):[]}function Mp(e,t){if(!e||!e.length)return t?{regexFree:[],regexes:[]}:[];const n=[],r=[];return r.push(...e.filter((e=>{const r=e instanceof RegExp;return r&&t&&n.push(e),!r}))),t?{regexFree:r,regexes:n}:r}function Ip(e,t){return void 0!==e.classList&&"string"==typeof t&&""!==t&&e.classList.contains(t)}function Op(e,t){"string"==typeof t&&(t=t.split(" ")),(t=Ap(t)).length>0&&e.classList.add(...t)}function xp(e,t){"string"==typeof t?t=t.split(" "):t instanceof RegExp&&(t=[t]);let{regexFree:n,regexes:r}=Mp(t,!0);n=Ap(n),n.length>0&&e.classList.remove(...n),r.forEach((t=>{e.classList.forEach((n=>{t.test(n)&&e.classList.remove(n)}))}))}function Pp(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;Array.isArray(t)||(t=[[t,n]]),t.forEach((t=>{Array.isArray(t)&&""!==t[0]&&e.setAttribute(...t)}))}function _p(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];"string"==typeof t?t=t.split(" "):t instanceof RegExp&&(t=[t]);const{regexFree:n,regexes:r}=Mp(t,!0);n.forEach((t=>{""!==t&&e.removeAttribute(t)})),r.forEach((t=>{e.getAttributeNames().forEach((n=>{t.test(n)&&e.removeAttribute(n)}))}))}function Lp(e){if(3===e.nodeType)e.parentNode.removeChild(e);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(e.nodeName)>-1){const t=e.childNodes;for(let e=t.length-1;e>=0;e--)Lp(t[e])}}function Hp(e){let t;for(;t=e.lastChild;)e.removeChild(t)}const kp=/(<(.*)>|&(.*);)/;function Fp(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];kp.test(t)?e.innerHTML=n?lp(t):t:Dp(e,t)}function Dp(e,t){const n=e.firstChild;n&&3===n.nodeType&&null===n.nextSibling?n.textContent=t:(Hp(e),e.appendChild(e.ownerDocument.createTextNode(t)))}function Vp(e){const t=e.ownerDocument.documentElement,n=e.ownerDocument.defaultView;let r=e;for(;r!==t;){if(null===r)return!1;if(r.nodeType===Node.DOCUMENT_FRAGMENT_NODE){if(r.host){if(r.host.impl)return Vp(r.host.impl);if(r.host)return Vp(r.host);throw new Error("Lost in Web Components world")}return!1}if("none"===n.getComputedStyle(r).display)return!1;r=r.parentNode}return!0}function Up(e){const t=e.ownerDocument,n=t.defaultView,r=t.documentElement;let i,o,s,a=e;for(i=a.offsetLeft,o=a.offsetTop,s=a;(a=a.offsetParent)&&a!==t.body&&"offsetLeft"in a;)i+=a.offsetLeft,o+=a.offsetTop,s=a;return s&&"fixed"===s.style.position&&(i+=n.pageXOffset||r.scrollLeft,o+=n.pageYOffset||r.scrollTop),{left:i,top:o}}function Bp(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:window).scrollY}function Wp(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:window).scrollX}function jp(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;return e===t?Bp(t):e.scrollTop}function Gp(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;return e===t?Wp(t):e.scrollLeft}function zp(e){let t=e.ownerDocument,n=t?t.defaultView:void 0;t||(t=e.document?e.document:e,n=t.defaultView);const r=["auto","scroll"];let i=e.parentNode;for(;i&&i.style&&t.body!==i;){let{overflow:e,overflowX:t,overflowY:o}=i.style;if([e,t,o].includes("scroll"))return i;if(({overflow:e,overflowX:t,overflowY:o}=n.getComputedStyle(i)),r.includes(e)||r.includes(t)||r.includes(o))return i;if(i.clientHeight<=i.scrollHeight+1&&(r.includes(o)||r.includes(e)))return i;if(i.clientWidth<=i.scrollWidth+1&&(r.includes(t)||r.includes(e)))return i;i=i.parentNode}return n}function $p(e){const t=e.ownerDocument,n=t.defaultView;let r=e.parentNode;for(;r&&r.style&&t.body!==r;){if("visible"!==r.style.overflow&&""!==r.style.overflow)return r;const e=n.getComputedStyle(r),t=["scroll","hidden","auto"],i=e.getPropertyValue("overflow"),o=e.getPropertyValue("overflow-y"),s=e.getPropertyValue("overflow-x");if(t.includes(i)||t.includes(o)||t.includes(s))return r;r=r.parentNode}return n}function Yp(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:window;if(!e)return;if(e===n)return"width"===t?`${n.innerWidth}px`:"height"===t?`${n.innerHeight}px`:void 0;const r=e.style[t];if(""!==r&&void 0!==r)return r;const i=n.getComputedStyle(e);return""!==i[t]&&void 0!==i[t]?i[t]:void 0}function Kp(e){return e.offsetWidth}function Xp(e){return e.offsetHeight}function qp(e){return e.clientHeight||e.innerHeight}function Qp(e){return e.clientWidth||e.innerWidth}function Zp(e){return e.selectionStart?e.selectionStart:0}function Jp(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window;e.getSelection&&(e.getSelection().empty?e.getSelection().empty():e.getSelection().removeAllRanges&&e.getSelection().removeAllRanges())}function eg(e,t,n){if(void 0===n&&(n=t),e.setSelectionRange){e.focus();try{e.setSelectionRange(t,n)}catch(r){const i=e.parentNode,o=i.style.display;i.style.display="block",e.setSelectionRange(t,n),i.style.display=o}}}let tg;function ng(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document;return void 0===tg&&(tg=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document;const t=e.createElement("div");t.style.height="200px",t.style.width="100%";const n=e.createElement("div");n.style.boxSizing="content-box",n.style.height="150px",n.style.left="0px",n.style.overflow="hidden",n.style.position="absolute",n.style.top="0px",n.style.width="200px",n.style.visibility="hidden",n.appendChild(t),(e.body||e.documentElement).appendChild(n);const r=t.offsetWidth;n.style.overflow="scroll";let i=t.offsetWidth;return r===i&&(i=n.clientWidth),(e.body||e.documentElement).removeChild(n),r-i}(e)),tg}function rg(e){return e instanceof Window?e.document.body.scrollHeight>e.innerHeight:e.offsetWidth!==e.clientWidth}function ig(e){return e instanceof Window?e.document.body.scrollWidth>e.innerWidth:e.offsetHeight!==e.clientHeight}function og(e,t,n){e.style.transform=`translate3d(${t},${n},0)`}function sg(e){e.style.transform&&""!==e.style.transform&&(e.style.transform="")}function ag(e){return e&&(["INPUT","SELECT","TEXTAREA"].indexOf(e.nodeName)>-1||"true"===e.contentEditable)}function lg(e){return ag(e)&&!1===e.hasAttribute("data-hot-input")}function hg(e){return!e.parentNode}function ug(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const r=e.ownerDocument,i=r.createRange(),o=r.defaultView.getSelection();Pp(e,"contenteditable",!0),n&&Pp(e,"aria-hidden","true"),t&&Op(e,"invisibleSelection"),i.selectNodeContents(e),o.removeAllRanges(),o.addRange(i)}function cg(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const n=e.ownerDocument.defaultView.getSelection();e.hasAttribute("aria-hidden")&&e.removeAttribute("aria-hidden"),n.removeAllRanges(),t&&xp(e,"invisibleSelection"),e.removeAttribute("contenteditable")}function dg(e){var t;const n=null==e||null===(t=e.ownerDocument)||void 0===t?void 0:t.defaultView.Element;return!!(n&&null!==n&&e instanceof n)}function pg(e){return"function"==typeof e}function gg(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,r=null;return function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r&&clearTimeout(r),r=setTimeout((()=>{t=e.apply(this,o)}),n),t}}function mg(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return e.apply(this,n.concat(r))}}function fg(e,t,n,r,i,o,s,a){return Gd(a)?e.call(t,n,r,i,o,s,a):Gd(s)?e.call(t,n,r,i,o,s):Gd(o)?e.call(t,n,r,i,o):Gd(i)?e.call(t,n,r,i):Gd(r)?e.call(t,n,r):Gd(n)?e.call(t,n):e.call(t)}var wg=Uo,yg=pe,vg=J,Cg=ro,Sg=X([].push),Rg=Ti,Eg=ye,bg=Oi,Tg=F,Ng=X,Ag=P,Mg=pe,Ig=De,Og=Pu,xg=function(e){if(yg(e))return e;if(wg(e)){for(var t=e.length,n=[],r=0;r<t;r++){var i=e[r];"string"==typeof i?Sg(n,i):"number"!=typeof i&&"Number"!==vg(i)&&"String"!==vg(i)||Sg(n,Cg(i))}var o=n.length,s=!0;return function(e,t){if(s)return s=!1,t;if(wg(this))return t;for(var r=0;r<o;r++)if(n[r]===e)return t}}},Pg=Pe,_g=String,Lg=Eg("JSON","stringify"),Hg=Ng(/./.exec),kg=Ng("".charAt),Fg=Ng("".charCodeAt),Dg=Ng("".replace),Vg=Ng(1..toString),Ug=/[\uD800-\uDFFF]/g,Bg=/^[\uD800-\uDBFF]$/,Wg=/^[\uDC00-\uDFFF]$/,jg=!Pg||Ag((function(){var e=Eg("Symbol")("stringify detection");return"[null]"!==Lg([e])||"{}"!==Lg({a:e})||"{}"!==Lg(Object(e))})),Gg=Ag((function(){return'"\\udf06\\ud834"'!==Lg("\udf06\ud834")||'"\\udead"'!==Lg("\udead")})),zg=function(e,t){var n=Og(arguments),r=xg(t);if(Mg(r)||void 0!==e&&!Ig(e))return n[1]=function(e,t){if(Mg(r)&&(t=Tg(r,this,_g(e),t)),!Ig(t))return t},bg(Lg,null,n)},$g=function(e,t,n){var r=kg(n,t-1),i=kg(n,t+1);return Hg(Bg,e)&&!Hg(Wg,i)||Hg(Wg,e)&&!Hg(Bg,r)?"\\u"+Vg(Fg(e,0),16):e};function Yg(e){let t;return Array.isArray(e)?t=e.length?new Array(e.length).fill(null):[]:(t={},nm(e,((e,n)=>{"__children"!==n&&(e&&"object"==typeof e&&!Array.isArray(e)?t[n]=Yg(e):Array.isArray(e)?e.length&&"object"==typeof e[0]&&!Array.isArray(e[0])?t[n]=[Yg(e[0])]:t[n]=[]:t[n]=null)}))),t}function Kg(e,t,n){const r=Array.isArray(n);return nm(t,((t,i)=>{(!1===r||n.includes(i))&&(e[i]=t)})),e}function Xg(e,t){nm(t,((n,r)=>{t[r]&&"object"==typeof t[r]?(e[r]||(Array.isArray(t[r])?e[r]=[]:"[object Date]"===Object.prototype.toString.call(t[r])?e[r]=t[r]:e[r]={}),Xg(e[r],t[r])):e[r]=t[r]}))}function qg(e){return"object"==typeof e?JSON.parse(JSON.stringify(e)):e}function Qg(e){const t={};return nm(e,((e,n)=>{t[n]=e})),t}function Zg(e){e.MIXINS||(e.MIXINS=[]);for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return Vd(n,(t=>{e.MIXINS.push(t.MIXIN_NAME),nm(t,((t,n)=>{if(void 0!==e.prototype[n])throw new Error(`Mixin conflict. Property '${n}' already exist and cannot be overwritten.`);if("function"==typeof t)e.prototype[n]=t;else{const r=function(e,t){const n=`_${e}`;return function(){return void 0===this[n]&&(this[n]=(e=>{let t=e;return(Array.isArray(t)||em(t))&&(t=qg(t)),t})(t)),this[n]}},i=function(e){const t=`_${e}`;return function(e){this[t]=e}};Object.defineProperty(e.prototype,n,{get:r(n,t),set:i(n),configurable:!0})}}))})),e}function Jg(e,t){return JSON.stringify(e)===JSON.stringify(t)}function em(e){return"[object Object]"===Object.prototype.toString.call(e)}function tm(e,t,n,r){r.value=n,r.writable=!1!==r.writable,r.enumerable=!1!==r.enumerable,r.configurable=!1!==r.configurable,Object.defineProperty(e,t,r)}function nm(e,t){for(const n in e)if((!e.hasOwnProperty||e.hasOwnProperty&&Object.prototype.hasOwnProperty.call(e,n))&&!1===t(e[n],n,e))break;return e}function rm(e,t,n){const r=t.split(".");let i=e;r.forEach(((e,t)=>{"__proto__"!==e&&"constructor"!==e&&"prototype"!==e&&(t!==r.length-1?(sm(i,e)||(i[e]={}),i=i[e]):i[e]=n)}))}function im(e){if(!em(e))return 0;const t=function(e){let n=0;return em(e)?nm(e,((e,r)=>{"__children"!==r&&(n+=t(e))})):n+=1,n};return t(e)}function om(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"value";const n=`_${t}`,r={_touched:!1,[n]:e,isTouched(){return this._touched}};return Object.defineProperty(r,t,{get(){return this[n]},set(e){this._touched=!0,this[n]=e},enumerable:!0,configurable:!0}),r}function sm(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function am(e){return window.requestAnimationFrame(e)}function lm(e){window.cancelAnimationFrame(e)}function hm(){return"ontouchstart"in window}let um;Lg&&Rg({target:"JSON",stat:!0,arity:3,forced:jg||Gg},{stringify:function(e,t,n){var r=Og(arguments),i=bg(jg?zg:Lg,null,r);return Gg&&"string"==typeof i?Dg(i,Ug,$g):i}});const cm=e=>{const t={value:!1,test:(n,r)=>{t.value=e(n,r)}};return t},dm={chrome:cm(((e,t)=>/Chrome/.test(e)&&/Google/.test(t))),chromeWebKit:cm((e=>/CriOS/.test(e))),edge:cm((e=>/Edge/.test(e))),edgeWebKit:cm((e=>/EdgiOS/.test(e))),firefox:cm((e=>/Firefox/.test(e))),firefoxWebKit:cm((e=>/FxiOS/.test(e))),mobile:cm((e=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(e))),safari:cm(((e,t)=>/Safari/.test(e)&&/Apple Computer/.test(t)))},pm={mac:cm((e=>/^Mac/.test(e))),win:cm((e=>/^Win/.test(e))),linux:cm((e=>/^Linux/.test(e))),ios:cm((e=>/iPhone|iPad|iPod/i.test(e)))};function gm(){return dm.chrome.value}function mm(){return dm.firefox.value}function fm(){return dm.safari.value}function wm(){return dm.mobile.value}function ym(){return pm.ios.value}function vm(){let{maxTouchPoints:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:navigator;return e>2&&pm.mac.value}function Cm(){return pm.win.value}function Sm(){return pm.mac.value}"undefined"!=typeof window&&(function(){let{userAgent:e=navigator.userAgent,vendor:t=navigator.vendor}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};nm(dm,(n=>{let{test:r}=n;r(e,t)}))}(),function(){let{platform:e=navigator.platform}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};nm(pm,(t=>{let{test:n}=t;n(e)}))}());const Rm={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:mm()?182:174,AUDIO_MUTE:mm()?181:173,AUDIO_UP:mm()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},Em=[Rm.ALT,Rm.ARROW_DOWN,Rm.ARROW_LEFT,Rm.ARROW_RIGHT,Rm.ARROW_UP,Rm.AUDIO_DOWN,Rm.AUDIO_MUTE,Rm.AUDIO_UP,Rm.BACKSPACE,Rm.CAPS_LOCK,Rm.DELETE,Rm.END,Rm.ENTER,Rm.ESCAPE,Rm.F1,Rm.F2,Rm.F3,Rm.F4,Rm.F5,Rm.F6,Rm.F7,Rm.F8,Rm.F9,Rm.F10,Rm.F11,Rm.F12,Rm.F13,Rm.F14,Rm.F15,Rm.F16,Rm.F17,Rm.F18,Rm.F19,Rm.HOME,Rm.INSERT,Rm.MEDIA_NEXT,Rm.MEDIA_PLAY_PAUSE,Rm.MEDIA_PREV,Rm.MEDIA_STOP,Rm.NULL,Rm.NUM_LOCK,Rm.PAGE_DOWN,Rm.PAGE_UP,Rm.PAUSE,Rm.SCROLL_LOCK,Rm.SHIFT,Rm.TAB];function bm(e){return Em.includes(e)}function Tm(e,t){const n=t.split("|");let r=!1;return Vd(n,(t=>{if(e===Rm[t])return r=!0,!1})),r}function Nm(e){e.isImmediatePropagationEnabled=!1,e.cancelBubble=!0}function Am(e){return!1===e.isImmediatePropagationEnabled}function Mm(e){return 2===e.button}function Im(e){return 0===e.button}function Om(){Gd(console)&&console.warn(...arguments)}function xm(){Gd(console)&&console.error(...arguments)}const Pm=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","beforeViewportScrollVertically","beforeViewportScrollHorizontally","beforeViewportScroll","afterScrollHorizontally","afterScrollVertically","afterScroll","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSelectionFocusSet","beforeSelectColumns","afterSelectColumns","beforeSelectRows","afterSelectRows","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterSetTheme","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeRowWrap","beforeColumnWrap","beforeSetCellMeta","beforeSelectionFocusSet","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeSelectionHighlightSet","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyFiltersMultiSelectValue","modifyFocusedElement","modifyRowHeader","modifyRowHeight","modifyRowHeightByOverlayName","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","modifyGetCoordsElement","modifyFocusOnTabNavigation","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformFocus","modifyTransformStart","modifyTransformEnd","afterModifyTransformFocus","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","beforeBeginEditing","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],_m=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),Lm=new Map([[]]);var Hm=kr,km=O,Fm=Mt,Dm=xl,Vm=en.f,Um=Fm("unscopables"),Bm=Array.prototype;void 0===Bm[Um]&&Vm(Bm,Um,{configurable:!0,value:Dm(null)});var Wm=function(e){Bm[Um][e]=!0},jm=Ti,Gm=Ge,zm=ce,$m=function(e,t,n){for(var r=0,i=arguments.length>2?n:Hm(t),o=new e(i);i>r;)o[r]=t[r++];return o},Ym=function(e,t){var n=km[e],r=n&&n.prototype;return r&&r[t]},Km=Wm,Xm=Array,qm=X(Ym("Array","sort"));jm({target:"Array",proto:!0},{toSorted:function(e){void 0!==e&&Gm(e);var t=zm(this),n=$m(Xm,t);return qm(n,e)}}),Km("toSorted");var Qm=wu,Zm=Ge,Jm=sn,ef=Ss;function tf(e,t,n){nf(e,t),t.set(e,n)}function nf(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function rf(e,t,n){return e.set(sf(e,t),n),n}function of(e,t){return e.get(sf(e,t))}function sf(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}Ti({target:"Iterator",proto:!0,real:!0},{find:function(e){Jm(this),Zm(e);var t=ef(this),n=0;return Qm(t,(function(t,r){if(e(t,n++))return r(t)}),{IS_RECORD:!0,INTERRUPTED:!0}).result}});var af=new WeakMap,lf=new WeakMap,hf=new WeakMap,uf=new WeakSet;class cf{constructor(){var e,t;nf(e=this,t=uf),t.add(e),tf(this,af,new Map),tf(this,lf,new Map),tf(this,hf,new Set),Pm.forEach((e=>sf(uf,this,df).call(this,e)))}getHooks(e){var t;return null!==(t=of(af,this).get(e))&&void 0!==t?t:[]}add(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};of(af,this).has(e)||(sf(uf,this,df).call(this,e),Pm.push(e));const r=of(af,this).get(e);if(r.find((e=>e.callback===t)))return;const i=Number.isInteger(n.orderIndex)?n.orderIndex:0,o=!!n.runOnce,s=!!n.initialHook;let a=!1;if(s){const e=r.find((e=>e.initialHook));e&&(e.callback=t,a=!0)}if(!a){r.push({callback:t,orderIndex:i,runOnce:o,initialHook:s,skip:!1});let n=of(hf,this).has(e);n||0===i||(n=!0,of(hf,this).add(e)),n&&r.length>1&&of(af,this).set(e,r.toSorted(((e,t)=>e.orderIndex-t.orderIndex)))}}has(e){return of(af,this).has(e)&&of(af,this).get(e).length>0}remove(e,t){if(!of(af,this).has(e))return!1;const n=of(af,this).get(e),r=n.find((e=>e.callback===t));if(r){let t=of(lf,this).get(e);return r.skip=!0,t+=1,t>100&&(of(af,this).set(e,n.filter((e=>!e.skip))),t=0),of(lf,this).set(e,t),!0}return!1}destroy(){of(af,this).clear(),of(lf,this).clear(),rf(af,this,null),rf(lf,this,null)}}function df(e){of(af,this).set(e,[]),of(lf,this).set(e,0)}function pf(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const gf=Wd`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\x20
  learn about the migration path.`;class mf{constructor(){pf(this,"globalBucket",new cf)}static getSingleton(){return ff}getBucket(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return e?(e.pluginHookBucket||(e.pluginHookBucket=new cf),e.pluginHookBucket):this.globalBucket}add(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3?arguments[3]:void 0;return Array.isArray(t)?Vd(t,(t=>this.add(e,t,n))):(_m.has(e)&&Om(sp(gf,{hookName:e,removedInVersion:_m.get(e)})),Lm.has(e)&&Om(Lm.get(e)),this.getBucket(n).add(e,t,{orderIndex:r,runOnce:!1})),this}once(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3?arguments[3]:void 0;return Array.isArray(t)?Vd(t,(t=>this.once(e,t,n))):this.getBucket(n).add(e,t,{orderIndex:r,runOnce:!0}),this}addAsFixed(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return Array.isArray(t)?Vd(t,(t=>this.addAsFixed(e,t,n))):this.getBucket(n).add(e,t,{initialHook:!0}),this}remove(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return this.getBucket(n).remove(e,t)}has(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this.getBucket(t).has(e)}run(e,t,n,r,i,o,s,a){{const l=this.getBucket().getHooks(t),h=l?l.length:0;let u=0;if(h)for(;u<h;){if(!l[u]||l[u].skip){u+=1;continue}const h=fg(l[u].callback,e,n,r,i,o,s,a);void 0!==h&&(n=h),l[u]&&l[u].runOnce&&this.remove(t,l[u].callback),u+=1}}{const l=this.getBucket(e).getHooks(t),h=l?l.length:0;let u=0;if(h)for(;u<h;){if(!l[u]||l[u].skip){u+=1;continue}const h=fg(l[u].callback,e,n,r,i,o,s,a);void 0!==h&&(n=h),l[u]&&l[u].runOnce&&this.remove(t,l[u].callback,e),u+=1}}return n}destroy(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.getBucket(e).destroy()}register(e){this.isRegistered(e)||Pm.push(e)}deregister(e){this.isRegistered(e)&&Pm.splice(Pm.indexOf(e),1)}isDeprecated(e){return Lm.has(e)||_m.has(e)}isRegistered(e){return Pm.indexOf(e)>=0}getRegistered(){return Pm}}const ff=new mf;const wf=new Map;function yf(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"common";wf.has(e)||wf.set(e,new Map);const t=wf.get(e);return{register:function(e,n){t.set(e,n)},getItem:function(e){return t.get(e)},hasItem:function(e){return t.has(e)},getNames:function(){return[...t.keys()]},getValues:function(){return[...t.values()]}}}const vf=new WeakMap,{register:Cf,getItem:Sf,hasItem:Rf,getNames:Ef,getValues:bf}=yf("editors");function Tf(e){const t={},n=e;this.getConstructor=function(){return e},this.getInstance=function(e){return e.guid in t||(t[e.guid]=new n(e)),t[e.guid]},mf.getSingleton().add("afterDestroy",(function(){t[this.guid]=null}))}function Nf(e,t){let n;if("function"==typeof e)vf.get(e)||Mf(null,e),n=vf.get(e);else{if("string"!=typeof e)throw Error('Only strings and functions can be passed as "editor" parameter');n=Sf(e)}if(!n)throw Error(`No editor registered under name "${e}"`);return n.getInstance(t)}function Af(e){if("function"==typeof e)return e;if(!Rf(e))throw Error(`No registered editor found under "${e}" name`);return Sf(e).getConstructor()}function Mf(e,t){e&&"string"!=typeof e&&(e=(t=e).EDITOR_TYPE);const n=new Tf(t);"string"==typeof e&&Cf(e,n),vf.set(t,n)}function If(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const Of=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;If(this,"context",void 0),this.context=e||this,this.context.eventListeners||(this.context.eventListeners=[])}addEventListener(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];function i(e){n.call(this,function(e){const t=e.stopImmediatePropagation;return e.stopImmediatePropagation=function(){t.apply(this),Nm(this)},e}(e))}return this.context.eventListeners.push({element:e,event:t,callback:n,callbackProxy:i,options:r,eventManager:this}),e.addEventListener(t,i,r),()=>{this.removeEventListener(e,t,n)}}removeEventListener(e,t,n){let r,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=this.context.eventListeners.length;for(;o;)if(o-=1,r=this.context.eventListeners[o],r.event===t&&r.element===e){if(n&&n!==r.callback)continue;if(i&&r.eventManager!==this)continue;this.context.eventListeners.splice(o,1),r.element.removeEventListener(r.event,r.callbackProxy,r.options)}}clearEvents(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.context)return;let t=this.context.eventListeners.length;for(;t;){t-=1;const n=this.context.eventListeners[t];e&&n.eventManager!==this||(this.context.eventListeners.splice(t,1),n.element.removeEventListener(n.event,n.callbackProxy,n.options))}}clear(){this.clearEvents()}destroy(){this.clearEvents(),this.context=null}destroyWithOwnEventsOnly(){this.clearEvents(!0),this.context=null}fireEvent(e,t){let n=e.document,r=e;n||(n=e.ownerDocument?e.ownerDocument:e,r=n.defaultView);const i={bubbles:!0,cancelable:"mousemove"!==t,view:r,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0};let o;n.createEvent?(o=n.createEvent("MouseEvents"),o.initMouseEvent(t,i.bubbles,i.cancelable,i.view,i.detail,i.screenX,i.screenY,i.clientX,i.clientY,i.ctrlKey,i.altKey,i.shiftKey,i.metaKey,i.button,n.body.parentNode)):o=n.createEventObject(),e.dispatchEvent?e.dispatchEvent(o):e.fireEvent(`on${t}`,o)}};function xf(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function Pf(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _f(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var Lf=new WeakSet;class Hf{constructor(e,t,n){xf(this,Lf),Pf(this,"hot",void 0),Pf(this,"tableMeta",void 0),Pf(this,"selection",void 0),Pf(this,"eventManager",void 0),Pf(this,"destroyed",!1),Pf(this,"activeEditor",void 0),Pf(this,"cellProperties",void 0),this.hot=e,this.tableMeta=t,this.selection=n,this.eventManager=new Of(e),this.hot.addHook("afterDocumentKeyDown",(e=>_f(Lf,this,kf).call(this,e))),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"compositionstart",(e=>{!this.destroyed&&this.hot.isListening()&&this.openEditor("",e)})),this.hot.view._wt.update("onCellDblClick",((e,t,n)=>_f(Lf,this,Ff).call(this,e,t,n)))}getActiveEditor(){return this.activeEditor}prepareEditor(){var e;if(this.activeEditor&&this.activeEditor.isWaiting())return void this.closeEditor(!1,!1,(e=>{e&&this.prepareEditor()}));const t=null===(e=this.hot.getSelectedRangeLast())||void 0===e?void 0:e.highlight;if(!t||t.isHeader())return;const{row:n,col:r}=t,i=this.hot.runHooks("modifyGetCellCoords",n,r,!1,"meta");let o=n,s=r;if(Array.isArray(i)&&([o,s]=i),this.cellProperties=this.hot.getCellMeta(o,s),!this.isCellEditable())return void this.clearActiveEditor();const a=this.hot.getCell(n,r,!0);if(a){const e=this.hot.getCellEditor(this.cellProperties),t=this.hot.colToProp(s),i=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(o),s);this.activeEditor=Nf(e,this.hot),this.activeEditor.prepare(n,r,t,a,i,this.cellProperties)}}isEditorOpened(){return this.activeEditor&&this.activeEditor.isOpened()}openEditor(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!this.isCellEditable())return void this.clearActiveEditor();const r=this.hot.getSelectedRangeLast();let i=this.hot.runHooks("beforeBeginEditing",r.highlight.row,r.highlight.col,e,t,n);t instanceof MouseEvent&&"boolean"!=typeof i&&(i=0===this.hot.selection.getLayerLevel()&&r.isSingle()),!1!==i?(this.activeEditor||(this.hot.scrollToFocusedCell(),this.prepareEditor()),this.activeEditor&&(n&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(e,t))):this.clearActiveEditor()}closeEditor(e,t,n){this.activeEditor?this.activeEditor.finishEditing(e,t,n):n&&n(!1)}closeEditorAndSaveChanges(e){this.closeEditor(!1,e)}closeEditorAndRestoreOriginalValue(e){this.closeEditor(!0,e)}clearActiveEditor(){this.activeEditor=void 0}isCellEditable(){const e=this.hot.getSelectedRangeLast();if(!e)return!1;const t=this.hot.getCellEditor(this.cellProperties),{row:n,col:r}=e.highlight,{rowIndexMapper:i,columnIndexMapper:o}=this.hot,s=i.isHidden(this.hot.toPhysicalRow(n))||o.isHidden(this.hot.toPhysicalColumn(r));return!(this.cellProperties.readOnly||!t||s)}moveSelectionAfterEnter(e){const t={..."function"==typeof this.tableMeta.enterMoves?this.tableMeta.enterMoves(e):this.tableMeta.enterMoves};e.shiftKey&&(t.row=-t.row,t.col=-t.col),this.hot.selection.isMultiple()?this.selection.transformFocus(t.row,t.col):this.selection.transformStart(t.row,t.col,!0)}destroy(){this.destroyed=!0,this.eventManager.destroy()}}function kf(e){const t=this.hot.getSelectedRangeLast();if(!this.hot.isListening()||!t||t.highlight.isHeader()||Am(e))return;const{keyCode:n}=e,r=(e.ctrlKey||e.metaKey)&&!e.altKey;(!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&(bm(n)||function(e){return[Rm.CONTROL,Rm.COMMAND_LEFT,Rm.COMMAND_RIGHT,Rm.COMMAND_FIREFOX].includes(e)}(n)||r||this.isEditorOpened()||this.openEditor("",e))}function Ff(e,t){t.isCell()&&this.openEditor(null,e,!0)}const Df=new WeakMap;Hf.getInstance=function(e,t,n){let r=Df.get(e);return r||(r=new Hf(e,t,n),Df.set(e,r)),r};const Vf=Hf;function Uf(e,t,n){Bf(e,t),t.set(e,n)}function Bf(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Wf(e,t){return e.get(Gf(e,t))}function jf(e,t,n){return e.set(Gf(e,t),n),n}function Gf(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}const zf=Object.freeze({CELL:"cell",MIXED:"mixed"});var $f=new WeakMap,Yf=new WeakMap,Kf=new WeakMap,Xf=new WeakMap,qf=new WeakMap,Qf=new WeakSet;class Zf{constructor(e){var t,n,r=this;Bf(t=this,n=Qf),n.add(t),Uf(this,$f,void 0),Uf(this,Yf,void 0),Uf(this,Kf,1),Uf(this,Xf,null),Uf(this,qf,new Map);const i=e.getSettings();jf($f,this,e),jf(Yf,this,i.imeFastEdit?zf.MIXED:zf.CELL),Wf($f,this).addHook("afterUpdateSettings",(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Gf(Qf,r,nw).call(r,...t)})),Wf($f,this).addHook("afterSelection",(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Gf(Qf,r,ew).call(r,...t)})),Wf($f,this).addHook("afterSelectionFocusSet",(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Gf(Qf,r,ew).call(r,...t)})),Wf($f,this).addHook("afterSelectionEnd",(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Gf(Qf,r,tw).call(r,...t)}))}getFocusMode(){return Wf(Yf,this)}setFocusMode(e){Object.values(zf).includes(e)?jf(Yf,this,e):Om(`"${e}" is not a valid focus mode.`)}getRefocusDelay(){return Wf(Kf,this)}setRefocusDelay(e){jf(Kf,this,e)}setRefocusElementGetter(e){jf(Xf,this,e)}getRefocusElement(){var e;return"function"==typeof Wf(Xf,this)?Wf(Xf,this).call(this):null===(e=Wf($f,this).getActiveEditor())||void 0===e?void 0:e.TEXTAREA}focusOnHighlightedCell(e){const t=e=>{var t,n;const r=null===(t=Wf($f,this).getSelectedRangeLast())||void 0===t?void 0:t.highlight;if(!r)return;let i=Wf($f,this).runHooks("modifyFocusedElement",r.row,r.col,e);dg(i)||(i=e),!i||null!==(n=Wf($f,this).getActiveEditor())&&void 0!==n&&n.isOpened()||i.focus({preventScroll:!0})};e?t(e):Gf(Qf,this,Jf).call(this,(e=>t(e)))}refocusToEditorTextarea(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Wf(Kf,this);var n,r;!Wf($f,this).getSettings().imeFastEdit||null!==(e=Wf($f,this).getActiveEditor())&&void 0!==e&&e.isOpened()||(null===(n=Wf($f,this).getActiveEditor())||void 0===n||null===(r=n.refreshValue)||void 0===r||r.call(n),Wf(qf,this).has(t)||Wf(qf,this).set(t,gg((()=>{var e;null===(e=this.getRefocusElement())||void 0===e||e.select()}),t)),Wf(qf,this).get(t)())}}function Jf(e){var t;const n=null===(t=Wf($f,this).getSelectedRangeLast())||void 0===t?void 0:t.highlight;if(!n||!Wf($f,this).selection.isCellVisible(n))return void e(null);const r=Wf($f,this).getCell(n.row,n.col,!0);null===r?Wf($f,this).addHookOnce("afterScroll",(()=>{e(Wf($f,this).getCell(n.row,n.col,!0))})):e(r)}function ew(){Gf(Qf,this,Jf).call(this,(e=>{const{activeElement:t}=Wf($f,this).rootDocument;t&&lg(t)&&t.blur(),this.focusOnHighlightedCell(e)}))}function tw(){Gf(Qf,this,Jf).call(this,(e=>{this.getFocusMode()===zf.MIXED&&"TD"===(null==e?void 0:e.nodeName)&&this.refocusToEditorTextarea()}))}function nw(e){"boolean"==typeof e.imeFastEdit&&this.setFocusMode(e.imeFastEdit?zf.MIXED:zf.CELL)}var rw=me,iw=J,ow=Mt("match"),sw=sn,aw=F,lw=gt,hw=ve,uw=function(){var e=sw(this),t="";return e.hasIndices&&(t+="d"),e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.unicodeSets&&(t+="v"),e.sticky&&(t+="y"),t},cw=RegExp.prototype,dw=X,pw=ct,gw=Math.floor,mw=dw("".charAt),fw=dw("".replace),ww=dw("".slice),yw=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,vw=/\$([$&'`]|\d{1,2})/g,Cw=Ti,Sw=F,Rw=X,Ew=le,bw=pe,Tw=oe,Nw=function(e){var t;return rw(e)&&(void 0!==(t=e[ow])?!!t:"RegExp"===iw(e))},Aw=ro,Mw=Ye,Iw=function(e){var t=e.flags;return void 0!==t||"flags"in cw||lw(e,"flags")||!hw(cw,e)?t:aw(uw,e)},Ow=function(e,t,n,r,i,o){var s=n+e.length,a=r.length,l=vw;return void 0!==i&&(i=pw(i),l=yw),fw(o,l,(function(o,l){var h;switch(mw(l,0)){case"$":return"$";case"&":return e;case"`":return ww(t,0,n);case"'":return ww(t,s);case"<":h=i[ww(l,1,-1)];break;default:var u=+l;if(0===u)return o;if(u>a){var c=gw(u/10);return 0===c?o:c<=a?void 0===r[c-1]?mw(l,1):r[c-1]+mw(l,1):o}h=r[u-1]}return void 0===h?"":h}))},xw=Mt("replace"),Pw=TypeError,_w=Rw("".indexOf);Rw("".replace);var Lw=Rw("".slice),Hw=Math.max;Cw({target:"String",proto:!0},{replaceAll:function(e,t){var n,r,i,o,s,a,l,h,u,c=Ew(this),d=0,p="";if(!Tw(e)){if(Nw(e)&&(n=Aw(Ew(Iw(e))),!~_w(n,"g")))throw new Pw("`.replaceAll` does not allow non-global regexes");if(r=Mw(e,xw))return Sw(r,e,c,t)}for(i=Aw(c),o=Aw(e),(s=bw(t))||(t=Aw(t)),a=o.length,l=Hw(1,a),h=_w(i,o);-1!==h;)u=s?Aw(t(o,h,i)):Ow(o,i,h,[],void 0,t),p+=Lw(i,d,h)+u,d=h+a,h=h+l>i.length?-1:_w(i,o,h+l);return d<i.length&&(p+=Lw(i,d)),p}});var kw=wu,Fw=Ge,Dw=sn,Vw=Ss,Uw=TypeError;Ti({target:"Iterator",proto:!0,real:!0},{reduce:function(e){Dw(this),Fw(e);var t=Vw(this),n=arguments.length<2,r=n?void 0:arguments[1],i=0;if(kw(t,(function(t){n?(n=!1,r=t):r=e(r,t,i),i++}),{IS_RECORD:!0}),n)throw new Uw("Reduce of empty iterator with no initial value");return r}});const Bw={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},Ww=new RegExp(Object.keys(Bw).map((e=>`(${e})`)).join("|"),"gi");function jw(e){const t=e.hasColHeaders(),n=e.hasRowHeaders(),r=[t?-1:0,n?-1:0,e.countRows()-1,e.countCols()-1],i=e.getData(...r),o=i.length,s=o>0?i[0].length:0,a=["<table>","</table>"],l=t?["<thead>","</thead>"]:[],h=["<tbody>","</tbody>"],u=n?1:0,c=t?1:0;for(let d=0;d<o;d+=1){const r=t&&0===d,o=[];for(let t=0;t<s;t+=1){const s=!r&&n&&0===t;let a="";if(r)a=`<th>${e.getColHeader(t-u)}</th>`;else if(s)a=`<th>${e.getRowHeader(d-c)}</th>`;else{const n=i[d][t],{hidden:r,rowspan:o,colspan:s}=e.getCellMeta(d-c,t-u);if(!r){const e=[];if(o&&e.push(`rowspan="${o}"`),s&&e.push(`colspan="${s}"`),$d(n))a=`<td ${e.join(" ")}></td>`;else{const t=n.toString().replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,"<br>\r\n").replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");a=`<td ${e.join(" ")}>${t}</td>`}}}o.push(a)}const a=["<tr>",...o,"</tr>"].join("");r?l.splice(1,0,a):h.splice(-1,0,a)}return a.splice(1,0,l.join(""),h.join("")),a.join("")}function Gw(e){const t=e.length,n=["<table>"];for(let r=0;r<t;r+=1){const i=e[r],o=i.length,s=[];0===r&&n.push("<tbody>");for(let e=0;e<o;e+=1){const t=i[e],n=$d(t)?"":t.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,"<br>\r\n").replace(/\x20{2,}/gi,(e=>`<span style="mso-spacerun: yes">${"&nbsp;".repeat(e.length-1)} </span>`)).replace(/\t/gi,"&#9;");s.push(`<td>${n}</td>`)}n.push("<tr>",...s,"</tr>"),r+1===t&&n.push("</tbody>")}return n.push("</table>"),n.join("")}function zw(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];const n=typeof e;if("number"===n)return!isNaN(e)&&isFinite(e);if("string"===n){if(0===e.length)return!1;if(1===e.length)return/\d/.test(e);const n=Array.from(new Set([".",...t])).map((e=>`\\${e}`)).join("|");return new RegExp(`^[+-]?(((${n})?\\d+((${n})\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$`,"i").test(e.trim())}return"object"===n&&!(!e||"number"!=typeof e.valueOf()||e instanceof Date)}function $w(e,t,n){let r=-1;for("function"==typeof t?(n=t,t=e):r=e-1;++r<=t&&!1!==n(r););}function Yw(e,t,n){let r=e+1;for("function"==typeof t&&(n=t,t=0);--r>=t&&!1!==n(r););}function Kw(e,t){return t=parseInt(t.toString().replace("%",""),10),t=isNaN(t)?0:t,parseInt(e*t/100,10)}function Xw(e,t,n){return Math.min(e,t)===e?t:Math.max(e,n)===e?n:e}const qw="asc",Qw=new Map([[qw,[-1,1]],["desc",[1,-1]]]),Zw=e=>`The priority '${e}' is already declared in a map.`,Jw=e=>`The priority '${e}' is not a number.`;const ey=e=>`The id '${e}' is already declared in a map.`;function ty(){let{errorIdExists:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=new Map;function n(){return[...t]}function r(e){return t.has(e)}return e=pg(e)?e:ey,{addItem:function(n,i){if(r(n))throw new Error(e(n));t.set(n,i)},clear:function(){t.clear()},getId:function(e){const[t]=n().find((t=>{let[n,r]=t;return e===r&&n}))||[null];return t},getItem:function(e){return t.get(e)},getItems:n,hasItem:r,removeItem:function(e){return t.delete(e)}}}const ny=e=>`'${e}' value is already declared in a unique set.`;const ry=e=>`There is already registered "${e}" plugin.`,iy=function(){let{errorPriorityExists:e,errorPriorityNaN:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const n=new Map;return e=pg(e)?e:Zw,t=pg(t)?t:Jw,{addItem:function(r,i){if(!zw(r))throw new Error(t(r));if(n.has(r))throw new Error(e(r));n.set(r,i)},getItems:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:qw;const[t,r]=Qw.get(e)||Qw.get(qw);return[...n].sort(((e,n)=>e[0]<n[0]?t:r)).map((e=>e[1]))}}}({errorPriorityExists:e=>`There is already registered plugin on priority "${e}".`,errorPriorityNaN:e=>`The priority "${e}" is not a number.`}),oy=function(){let{errorItemExists:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=new Set;return e=pg(e)?e:ny,{addItem:function(n){if(t.has(n))throw new Error(e(n));t.add(n)},clear:function(){t.clear()},getItems:function(){return[...t]}}}({errorItemExists:ry}),sy=ty({errorIdExists:ry});function ay(){return[...iy.getItems(),...oy.getItems()]}function ly(e){const t=rp(e);return sy.getItem(t)}function hy(e,t,n){[e,t,n]=function(e,t,n){"function"==typeof e&&(e=(t=e).PLUGIN_KEY,n=t.PLUGIN_PRIORITY);return[e,t,n]}(e,t,n),void 0===ly(e)&&function(e,t,n){const r=rp(e);if(sy.hasItem(r))throw new Error(ry(r));void 0===n?oy.addItem(r):iy.addItem(n,r);sy.addItem(r,t)}(e,t,n)}const{register:uy,getItem:cy,hasItem:dy,getNames:py,getValues:gy}=yf("renderers");function my(e){if("function"==typeof e)return e;if(!dy(e))throw Error(`No registered renderer found under "${e}" name`);return cy(e)}function fy(e,t){"string"!=typeof e&&(e=(t=e).RENDERER_TYPE),uy(e,t)}const{register:wy,getItem:yy,hasItem:vy,getNames:Cy,getValues:Sy}=yf("validators");function Ry(e,t){"string"!=typeof e&&(e=(t=e).VALIDATOR_TYPE),wy(e,t)}var Ey=ct,by=kr,Ty=Ir,Ny=Wm;Ti({target:"Array",proto:!0},{at:function(e){var t=Ey(this),n=by(t),r=Ty(e),i=r>=0?r:n+r;return i<0||i>=n?void 0:t[i]}}),Ny("at");var Ay=Ti,My=le,Iy=Ir,Oy=ro,xy=P,Py=X("".charAt);function _y(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Ay({target:"String",proto:!0,forced:xy((function(){return"\ud842"!=="ð ®·".at(-2)}))},{at:function(e){var t=Oy(My(this)),n=t.length,r=Iy(e),i=r>=0?r:n+r;return i<0||i>=n?void 0:Py(t,i)}});class Ly{constructor(){_y(this,"count",0),_y(this,"startColumn",null),_y(this,"endColumn",null),_y(this,"startPosition",null),_y(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,t){const{totalCalculatedWidth:n,zeroBasedScrollOffset:r,viewportWidth:i,columnWidth:o}=t;n>=r&&n+o<=r+(r>0?i+1:i)&&(null!==this.startColumn&&void 0!==this.startColumn||(this.startColumn=e),this.endColumn=e)}finalize(e){var t;const{scrollOffset:n,viewportWidth:r,inlineStartOffset:i,zeroBasedScrollOffset:o,totalColumns:s,needReverse:a,startPositions:l,columnWidth:h}=e;if(this.endColumn===s-1&&a)for(this.startColumn=this.endColumn;this.startColumn>0;){const e=l[this.endColumn]+h-l[this.startColumn-1];if(e<=r&&(this.startColumn-=1),e>=r)break}this.startPosition=null!==(t=l[this.startColumn])&&void 0!==t?t:null;const u=n+r-(o>0?r+1:r),c=null===this.startColumn?0:e.getColumnWidth(this.startColumn);u<-1*i||n>l.at(-1)||-1*n-r>-1*c?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,s<this.endColumn&&(this.endColumn=s-1),null!==this.startColumn&&(this.count=this.endColumn-this.startColumn+1)}}function Hy(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class ky{constructor(){Hy(this,"count",0),Hy(this,"startRow",null),Hy(this,"endRow",null),Hy(this,"startPosition",null),Hy(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,t){const{totalCalculatedHeight:n,zeroBasedScrollOffset:r,innerViewportHeight:i,rowHeight:o}=t;n>=r&&n+o<=i&&(null===this.startRow&&(this.startRow=e),this.endRow=e)}finalize(e){var t;const{scrollOffset:n,viewportHeight:r,horizontalScrollbarHeight:i,totalRows:o,needReverse:s,startPositions:a,rowHeight:l}=e;if(this.endRow===o-1&&s)for(this.startRow=this.endRow;this.startRow>0;){const e=a[this.endRow]+l-a[this.startRow-1];if(e<=r-i&&(this.startRow-=1),e>=r-i)break}this.startPosition=null!==(t=a[this.startRow])&&void 0!==t?t:null;n+r-i<(null===this.startRow?0:e.getRowHeight(this.startRow))||n>a.at(-1)?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,o<this.endRow&&(this.endRow=o-1),null!==this.startRow&&(this.count=this.endRow-this.startRow+1)}}function Fy(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Dy{constructor(){Fy(this,"count",0),Fy(this,"startColumn",null),Fy(this,"endColumn",null),Fy(this,"startPosition",null),Fy(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,t){const{totalCalculatedWidth:n,zeroBasedScrollOffset:r,viewportWidth:i}=t;n<=r&&(this.startColumn=e);n>=r&&n<=r+(r>0?i+1:i)&&(null!==this.startColumn&&void 0!==this.startColumn||(this.startColumn=e)),this.endColumn=e}finalize(e){var t;const{scrollOffset:n,viewportWidth:r,inlineStartOffset:i,zeroBasedScrollOffset:o,totalColumns:s,needReverse:a,startPositions:l,columnWidth:h}=e;if(this.endColumn===s-1&&a)for(this.startColumn=this.endColumn;this.startColumn>0;){const e=l[this.endColumn]+h-l[this.startColumn-1];if(this.startColumn-=1,e>r)break}this.startPosition=null!==(t=l[this.startColumn])&&void 0!==t?t:null;n+r-(o>0?r+1:r)<-1*i||n>l.at(-1)+h||-1*n-r>0?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,s<this.endColumn&&(this.endColumn=s-1),null!==this.startColumn&&(this.count=this.endColumn-this.startColumn+1)}}function Vy(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Uy{constructor(){Vy(this,"count",0),Vy(this,"startRow",null),Vy(this,"endRow",null),Vy(this,"startPosition",null),Vy(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,t){const{totalCalculatedHeight:n,zeroBasedScrollOffset:r,innerViewportHeight:i}=t;n<=r&&(this.startRow=e),n>=r&&n<=i&&null===this.startRow&&(this.startRow=e),this.endRow=e}finalize(e){var t;const{scrollOffset:n,viewportHeight:r,horizontalScrollbarHeight:i,totalRows:o,needReverse:s,startPositions:a,rowHeight:l}=e;if(this.endRow===o-1&&s)for(this.startRow=this.endRow;this.startRow>0;){const e=a[this.endRow]+l-a[this.startRow-1];if(this.startRow-=1,e>=r-i)break}this.startPosition=null!==(t=a[this.startRow])&&void 0!==t?t:null;n+r-i<0||n>a.at(-1)+l?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,o<this.endRow&&(this.endRow=o-1),null!==this.startRow&&(this.count=this.endRow-this.startRow+1)}}function By(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Wy{constructor(){By(this,"count",0),By(this,"startColumn",0),By(this,"endColumn",0),By(this,"startPosition",0),By(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalColumns:t}=e;this.count=t,this.endColumn=this.count-1}process(){}finalize(){}}function jy(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Gy{constructor(){jy(this,"count",0),jy(this,"startRow",0),jy(this,"endRow",0),jy(this,"startPosition",0),jy(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalRows:t}=e;this.count=t,this.endRow=this.count-1}process(){}finalize(){}}function zy(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class $y extends Dy{constructor(){super(...arguments),zy(this,"columnStartOffset",0),zy(this,"columnEndOffset",0)}finalize(e){var t;super.finalize(e);const{overrideFn:n,totalColumns:r,startPositions:i}=e;if(null!==this.startColumn&&"function"==typeof n){const e=this.startColumn,t=this.endColumn;n(this),this.columnStartOffset=e-this.startColumn,this.columnEndOffset=this.endColumn-t}this.startColumn<0&&(this.startColumn=0),this.startPosition=null!==(t=i[this.startColumn])&&void 0!==t?t:null,r<this.endColumn&&(this.endColumn=r-1),null!==this.startColumn&&(this.count=this.endColumn-this.startColumn+1)}}function Yy(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Ky extends Uy{constructor(){super(...arguments),Yy(this,"rowStartOffset",0),Yy(this,"rowEndOffset",0)}finalize(e){var t;super.finalize(e);const{overrideFn:n,totalRows:r,startPositions:i}=e;if(null!==this.startRow&&"function"==typeof n){const e=this.startRow,t=this.endRow;n(this),this.rowStartOffset=e-this.startRow,this.rowEndOffset=this.endRow-t}this.startRow<0&&(this.startRow=0),this.startPosition=null!==(t=i[this.startRow])&&void 0!==t?t:null,r<this.endRow&&(this.endRow=r-1),null!==this.startRow&&(this.count=this.endRow-this.startRow+1)}}function Xy(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class qy{constructor(e){Xy(this,"calculationTypes",[]),Xy(this,"calculationResults",new Map),this.calculationTypes=e}_initialize(e){this.calculationTypes.forEach((t=>{let[n,r]=t;this.calculationResults.set(n,r),r.initialize(e)}))}_process(e,t){this.calculationTypes.forEach((n=>{let[,r]=n;return r.process(e,t)}))}_finalize(e){this.calculationTypes.forEach((t=>{let[,n]=t;return n.finalize(e)}))}getResultsFor(e){return this.calculationResults.get(e)}}function Qy(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const Zy=50;class Jy extends qy{constructor(e){let{calculationTypes:t,viewportWidth:n,scrollOffset:r,totalColumns:i,columnWidthFn:o,overrideFn:s,inlineStartOffset:a}=e;super(t),Qy(this,"viewportWidth",0),Qy(this,"scrollOffset",0),Qy(this,"zeroBasedScrollOffset",0),Qy(this,"totalColumns",0),Qy(this,"columnWidthFn",null),Qy(this,"columnWidth",0),Qy(this,"overrideFn",null),Qy(this,"inlineStartOffset",0),Qy(this,"totalCalculatedWidth",0),Qy(this,"startPositions",[]),Qy(this,"needReverse",!0),this.viewportWidth=n,this.scrollOffset=r,this.zeroBasedScrollOffset=Math.max(r,0),this.totalColumns=i,this.columnWidthFn=o,this.overrideFn=s,this.inlineStartOffset=a,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalColumns;e++)if(this.columnWidth=this.getColumnWidth(e),this._process(e,this),this.startPositions.push(this.totalCalculatedWidth),this.totalCalculatedWidth+=this.columnWidth,this.totalCalculatedWidth>=this.zeroBasedScrollOffset+this.viewportWidth){this.needReverse=!1;break}this._finalize(this)}getColumnWidth(e){const t=this.columnWidthFn(e);return isNaN(t)?Zy:t}}function ev(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class tv extends qy{constructor(e){let{calculationTypes:t,viewportHeight:n,scrollOffset:r,totalRows:i,defaultRowHeight:o,rowHeightFn:s,overrideFn:a,horizontalScrollbarHeight:l}=e;super(t),ev(this,"viewportHeight",0),ev(this,"scrollOffset",0),ev(this,"zeroBasedScrollOffset",0),ev(this,"totalRows",0),ev(this,"rowHeightFn",null),ev(this,"rowHeight",0),ev(this,"overrideFn",null),ev(this,"horizontalScrollbarHeight",0),ev(this,"innerViewportHeight",0),ev(this,"totalCalculatedHeight",0),ev(this,"startPositions",[]),ev(this,"needReverse",!0),this.defaultHeight=o,this.viewportHeight=n,this.scrollOffset=r,this.zeroBasedScrollOffset=Math.max(r,0),this.totalRows=i,this.rowHeightFn=s,this.overrideFn=a,this.horizontalScrollbarHeight=null!=l?l:0,this.innerViewportHeight=this.zeroBasedScrollOffset+this.viewportHeight-this.horizontalScrollbarHeight,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalRows;e++)if(this.rowHeight=this.getRowHeight(e),this._process(e,this),this.startPositions.push(this.totalCalculatedHeight),this.totalCalculatedHeight+=this.rowHeight,this.totalCalculatedHeight>=this.innerViewportHeight){this.needReverse=!1;break}this._finalize(this)}getRowHeight(e){const t=this.rowHeightFn(e);return isNaN(t)?this.defaultHeight:t}}function nv(e,t,n){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,n)}function rv(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function iv(e,t){return e.get(sv(e,t))}function ov(e,t,n){return e.set(sv(e,t),n),n}function sv(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var av=new WeakMap;class lv{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];rv(this,"row",null),rv(this,"col",null),nv(this,av,!1),ov(av,this,n),void 0!==e&&void 0!==t&&(this.row=e,this.col=t)}isValid(e){const{countRows:t,countCols:n,countRowHeaders:r,countColHeaders:i}={countRows:0,countCols:0,countRowHeaders:0,countColHeaders:0,...e};return!(!Number.isInteger(this.row)||!Number.isInteger(this.col))&&(!(this.row<-i||this.col<-r)&&!(this.row>=t||this.col>=n))}isEqual(e){return e===this||this.row===e.row&&this.col===e.col}isHeader(){return!this.isCell()}isCell(){return this.row>=0&&this.col>=0}isRtl(){return iv(av,this)}isSouthEastOf(e){return this.row>=e.row&&(iv(av,this)?this.col<=e.col:this.col>=e.col)}isNorthWestOf(e){return this.row<=e.row&&(iv(av,this)?this.col>=e.col:this.col<=e.col)}isSouthWestOf(e){return this.row>=e.row&&(iv(av,this)?this.col>=e.col:this.col<=e.col)}isNorthEastOf(e){return this.row<=e.row&&(iv(av,this)?this.col<=e.col:this.col>=e.col)}normalize(){return this.row=null===this.row?this.row:Math.max(this.row,0),this.col=null===this.col?this.col:Math.max(this.col,0),this}assign(e){return Number.isInteger(null==e?void 0:e.row)&&(this.row=e.row),Number.isInteger(null==e?void 0:e.col)&&(this.col=e.col),e instanceof lv&&ov(av,this,e.isRtl()),this}clone(){return new lv(this.row,this.col,iv(av,this))}toObject(){return{row:this.row,col:this.col}}}const hv=lv;function uv(e,t,n){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,n)}function cv(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function dv(e,t){return e.get(pv(e,t))}function pv(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var gv=new WeakMap;class mv{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];var i,o,s;cv(this,"highlight",null),cv(this,"from",null),cv(this,"to",null),uv(this,gv,!1),this.highlight=e.clone(),this.from=t.clone(),this.to=n.clone(),o=this,s=r,(i=gv).set(pv(i,o),s)}setHighlight(e){return this.highlight=e.clone(),this}setFrom(e){return this.from=e.clone(),this}setTo(e){return this.to=e.clone(),this}isValid(e){return this.from.isValid(e)&&this.to.isValid(e)}isSingle(){return this.isSingleCell()||this.isSingleHeader()}isSingleCell(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}isSingleHeader(){return(this.from.row<0||this.from.col<0)&&this.from.row===this.to.row&&this.from.col===this.to.col}isHeader(){return!(!this.from.isHeader()||!this.to.isHeader())||(this.from.col<0&&this.to.col<0||this.from.row<0&&this.to.row<0)}containsHeaders(){return this.from.isHeader()||this.to.isHeader()}getOuterHeight(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}getOuterWidth(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}getHeight(){if(this.from.row<0&&this.to.row<0)return 0;const e=Math.max(this.from.row,0),t=Math.max(this.to.row,0);return Math.max(e,t)-Math.min(e,t)+1}getWidth(){if(this.from.col<0&&this.to.col<0)return 0;const e=Math.max(this.from.col,0),t=Math.max(this.to.col,0);return Math.max(e,t)-Math.min(e,t)+1}getCellsCount(){return this.getWidth()*this.getHeight()}includes(e){const{row:t,col:n}=e,r=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner();return r.row<=t&&i.row>=t&&r.col<=n&&i.col>=n}includesRange(e){return this.includes(e.getOuterTopStartCorner())&&this.includes(e.getOuterBottomEndCorner())}isEqual(e){return Math.min(this.from.row,this.to.row)===Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(e.from.col,e.to.col)}overlaps(e){return e.isSouthEastOf(this.getOuterTopLeftCorner())&&e.isNorthWestOf(this.getOuterBottomRightCorner())}isSouthEastOf(e){return this.getOuterTopLeftCorner().isSouthEastOf(e)||this.getOuterBottomRightCorner().isSouthEastOf(e)}isNorthWestOf(e){return this.getOuterTopLeftCorner().isNorthWestOf(e)||this.getOuterBottomRightCorner().isNorthWestOf(e)}isOverlappingHorizontally(e){return this.getOuterTopEndCorner().col>=e.getOuterTopStartCorner().col&&this.getOuterTopEndCorner().col<=e.getOuterTopEndCorner().col||this.getOuterTopStartCorner().col<=e.getOuterTopEndCorner().col&&this.getOuterTopStartCorner().col>=e.getOuterTopStartCorner().col}isOverlappingVertically(e){return this.getOuterBottomStartCorner().row>=e.getOuterTopRightCorner().row&&this.getOuterBottomStartCorner().row<=e.getOuterBottomStartCorner().row||this.getOuterTopEndCorner().row<=e.getOuterBottomStartCorner().row&&this.getOuterTopEndCorner().row>=e.getOuterTopRightCorner().row}expand(e){const t=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner();return(e.row<t.row||e.col<t.col||e.row>n.row||e.col>n.col)&&(this.from=this._createCellCoords(Math.min(t.row,e.row),Math.min(t.col,e.col)),this.to=this._createCellCoords(Math.max(n.row,e.row),Math.max(n.col,e.col)),!0)}expandByRange(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.includesRange(e)||!this.overlaps(e))return!1;const n=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner(),i=this.getDirection(),o=e.getOuterTopStartCorner(),s=e.getOuterBottomEndCorner(),a=Math.min(n.row,o.row),l=Math.min(n.col,o.col),h=Math.max(r.row,s.row),u=Math.max(r.col,s.col),c=this._createCellCoords(a,l),d=this._createCellCoords(h,u);return this.from=c,this.to=d,this.setDirection(i),t&&(this.highlight.row===this.getOuterBottomRightCorner().row&&"N-S"===this.getVerticalDirection()&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&"W-E"===this.getHorizontalDirection()&&this.flipDirectionHorizontally()),!0}getDirection(){return this.from.isNorthWestOf(this.to)?"NW-SE":this.from.isNorthEastOf(this.to)?"NE-SW":this.from.isSouthEastOf(this.to)?"SE-NW":this.from.isSouthWestOf(this.to)?"SW-NE":void 0}setDirection(e){switch(e){case"NW-SE":[this.from,this.to]=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];break;case"NE-SW":[this.from,this.to]=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];break;case"SE-NW":[this.from,this.to]=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];break;case"SW-NE":[this.from,this.to]=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()]}}getVerticalDirection(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}getHorizontalDirection(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}flipDirectionVertically(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE")}}flipDirectionHorizontally(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW")}}getTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getTopLeftCorner(){return dv(gv,this)?this.getTopEndCorner():this.getTopStartCorner()}getBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getBottomRightCorner(){return dv(gv,this)?this.getBottomStartCorner():this.getBottomEndCorner()}getTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getTopRightCorner(){return dv(gv,this)?this.getTopStartCorner():this.getTopEndCorner()}getBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getBottomLeftCorner(){return dv(gv,this)?this.getBottomEndCorner():this.getBottomStartCorner()}getOuterTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterTopLeftCorner(){return dv(gv,this)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}getOuterBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterBottomRightCorner(){return dv(gv,this)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}getOuterTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterTopRightCorner(){return dv(gv,this)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}getOuterBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterBottomLeftCorner(){return dv(gv,this)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}isCorner(e){return e.isEqual(this.getOuterTopLeftCorner())||e.isEqual(this.getOuterTopRightCorner())||e.isEqual(this.getOuterBottomLeftCorner())||e.isEqual(this.getOuterBottomRightCorner())}getOppositeCorner(e){return e instanceof hv&&(e.isEqual(this.getOuterBottomEndCorner())?this.getOuterTopStartCorner():e.isEqual(this.getOuterTopStartCorner())?this.getOuterBottomEndCorner():e.isEqual(this.getOuterTopEndCorner())?this.getOuterBottomStartCorner():e.isEqual(this.getOuterBottomStartCorner())?this.getOuterTopEndCorner():void 0)}getBordersSharedWith(e){if(!this.includesRange(e))return[];const t=Math.min(this.from.row,this.to.row),n=Math.max(this.from.row,this.to.row),r=Math.min(this.from.col,this.to.col),i=Math.max(this.from.col,this.to.col),o=Math.min(e.from.row,e.to.row),s=Math.max(e.from.row,e.to.row),a=Math.min(e.from.col,e.to.col),l=Math.max(e.from.col,e.to.col),h=[];return t===o&&h.push("top"),i===l&&h.push(dv(gv,this)?"left":"right"),n===s&&h.push("bottom"),r===a&&h.push(dv(gv,this)?"right":"left"),h}getInner(){const e=this.getOuterTopStartCorner(),t=this.getOuterBottomEndCorner(),n=[];for(let r=e.row;r<=t.row;r++)for(let i=e.col;i<=t.col;i++)this.from.row===r&&this.from.col===i||this.to.row===r&&this.to.col===i||n.push(this._createCellCoords(r,i));return n}getAll(){const e=this.getOuterTopStartCorner(),t=this.getOuterBottomEndCorner(),n=[];for(let r=e.row;r<=t.row;r++)for(let i=e.col;i<=t.col;i++)e.row===r&&e.col===i?n.push(e):t.row===r&&t.col===i?n.push(t):n.push(this._createCellCoords(r,i));return n}forAll(e){const t=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner();for(let r=t.row;r<=n.row;r++)for(let i=t.col;i<=n.col;i++){if(!1===e(r,i))return}}clone(){return new mv(this.highlight,this.from,this.to,dv(gv,this))}toObject(){return{from:this.from.toObject(),to:this.to.toObject()}}_createCellCoords(e,t){return new hv(e,t,dv(gv,this))}}const fv=mv;function wv(e,t,n){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,n)}function yv(e,t){return e.get(Cv(e,t))}function vv(e,t,n){return e.set(Cv(e,t),n),n}function Cv(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var Sv=new WeakMap,Rv=new WeakMap,Ev=new WeakMap,bv=new WeakMap,Tv=new WeakMap,Nv=new WeakMap,Av=new WeakMap,Mv=new WeakMap,Iv=new WeakMap,Ov=new WeakMap;const xv=class{constructor(e,t,n,r,i,o){let s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;wv(this,Sv,void 0),wv(this,Rv,void 0),wv(this,Ev,void 0),wv(this,bv,void 0),wv(this,Tv,void 0),wv(this,Nv,void 0),wv(this,Av,void 0),wv(this,Mv,void 0),wv(this,Iv,[null,null]),wv(this,Ov,[null,null]),vv(Sv,this,n),vv(Rv,this,t),vv(Ev,this,i),vv(bv,this,o),vv(Tv,this,s),vv(Nv,this,r),vv(Av,this,e),this.registerEvents()}registerEvents(){yv(Nv,this).addEventListener(yv(Ev,this).holder,"contextmenu",(e=>this.onContextMenu(e))),yv(Nv,this).addEventListener(yv(Ev,this).TABLE,"mouseover",(e=>this.onMouseOver(e))),yv(Nv,this).addEventListener(yv(Ev,this).TABLE,"mouseout",(e=>this.onMouseOut(e)));const e=()=>{yv(Nv,this).addEventListener(yv(Ev,this).holder,"touchstart",(e=>this.onTouchStart(e))),yv(Nv,this).addEventListener(yv(Ev,this).holder,"touchend",(e=>this.onTouchEnd(e))),this.momentumScrolling||(this.momentumScrolling={}),yv(Nv,this).addEventListener(yv(Ev,this).holder,"scroll",(()=>{clearTimeout(this.momentumScrolling._timeout),this.momentumScrolling.ongoing||yv(Sv,this).getSetting("onBeforeTouchScroll"),this.momentumScrolling.ongoing=!0,this.momentumScrolling._timeout=setTimeout((()=>{this.touchApplied||(this.momentumScrolling.ongoing=!1,yv(Sv,this).getSetting("onAfterMomentumScroll"))}),200)}))},t=()=>{yv(Nv,this).addEventListener(yv(Ev,this).holder,"mouseup",(e=>this.onMouseUp(e))),yv(Nv,this).addEventListener(yv(Ev,this).holder,"mousedown",(e=>this.onMouseDown(e)))};wm()?e():(hm()&&e(),t())}selectedCellWasTouched(e){const t=this.parentCell(e).coords;if(yv(Mv,this)&&t){const[e,n]=[t.row,yv(Mv,this).from.row],[r,i]=[t.col,yv(Mv,this).from.col];return e===n&&r===i}return!1}parentCell(e){const t={},n=bp(e,["TD","TH"],yv(Ev,this).TABLE);return n?(t.coords=yv(Ev,this).getCoords(n),t.TD=n):Ip(e,"wtBorder")&&Ip(e,"current")?(t.coords=yv(bv,this).getFocusSelection().cellRange.highlight,t.TD=yv(Ev,this).getCell(t.coords)):Ip(e,"wtBorder")&&Ip(e,"area")&&yv(bv,this).getAreaSelection().cellRange&&(t.coords=yv(bv,this).getAreaSelection().cellRange.to,t.TD=yv(Ev,this).getCell(t.coords)),t}onMouseDown(e){const t=yv(Rv,this).rootDocument.activeElement,n=mg(Cp,e.target),r=e.target;if(!["TD","TH"].includes(t.nodeName)&&(r===t||n(0)===t||n(1)===t))return;const i=this.parentCell(r);Ip(r,"corner")?yv(Sv,this).getSetting("onCellCornerMouseDown",e,r):i.TD&&yv(Sv,this).has("onCellMouseDown")&&this.callListener("onCellMouseDown",e,i.coords,i.TD),(0===e.button||this.touchApplied)&&i.TD&&(yv(Ov,this)[0]=i.TD,clearTimeout(yv(Iv,this)[0]),yv(Iv,this)[0]=setTimeout((()=>{yv(Ov,this)[0]=null}),1e3))}onContextMenu(e){if(yv(Sv,this).has("onCellContextMenu")){const t=this.parentCell(e.target);t.TD&&this.callListener("onCellContextMenu",e,t.coords,t.TD)}}onMouseOver(e){if(!yv(Sv,this).has("onCellMouseOver"))return;const t=yv(Ev,this).TABLE,n=bp(e.target,["TD","TH"],t),r=yv(Tv,this)||this;n&&n!==r.lastMouseOver&&Tp(n,t)&&(r.lastMouseOver=n,this.callListener("onCellMouseOver",e,yv(Ev,this).getCoords(n),n))}onMouseOut(e){if(!yv(Sv,this).has("onCellMouseOut"))return;const t=yv(Ev,this).TABLE,n=bp(e.target,["TD","TH"],t),r=bp(e.relatedTarget,["TD","TH"],t),i=yv(Tv,this)||this;n&&n!==r&&Tp(n,t)&&(this.callListener("onCellMouseOut",e,yv(Ev,this).getCoords(n),n),null===r&&(i.lastMouseOver=null))}onMouseUp(e){const t=this.parentCell(e.target);t.TD&&yv(Sv,this).has("onCellMouseUp")&&this.callListener("onCellMouseUp",e,t.coords,t.TD),(0===e.button||this.touchApplied)&&(t.TD===yv(Ov,this)[0]&&t.TD===yv(Ov,this)[1]?(Ip(e.target,"corner")?this.callListener("onCellCornerDblClick",e,t.coords,t.TD):this.callListener("onCellDblClick",e,t.coords,t.TD),yv(Ov,this)[0]=null,yv(Ov,this)[1]=null):t.TD===yv(Ov,this)[0]&&(yv(Ov,this)[1]=t.TD,clearTimeout(yv(Iv,this)[1]),yv(Iv,this)[1]=setTimeout((()=>{yv(Ov,this)[1]=null}),500)))}onTouchStart(e){vv(Mv,this,yv(bv,this).getFocusSelection().cellRange),this.touchApplied=!0,this.onMouseDown(e)}onTouchEnd(e){var t;const n=e.target,r=null===(t=this.parentCell(n))||void 0===t?void 0:t.coords,i=Gd(r)&&r.row>=0&&r.col>=0;if(e.cancelable&&i&&yv(Sv,this).getSetting("isDataViewInstance")){const t=["A","BUTTON","INPUT"];ym()&&(dm.chromeWebKit.value||dm.firefoxWebKit.value)&&this.selectedCellWasTouched(n)&&!t.includes(n.tagName)?e.preventDefault():this.selectedCellWasTouched(n)||e.preventDefault()}this.onMouseUp(e),this.touchApplied=!1}callListener(e,t,n,r){const i=yv(Sv,this).getSettingPure(e);i&&i(t,n,r,yv(Av,this).call(this))}destroy(){clearTimeout(yv(Iv,this)[0]),clearTimeout(yv(Iv,this)[1]),yv(Nv,this).destroy()}};function Pv(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const _v=class{constructor(e,t,n){Pv(this,"offset",void 0),Pv(this,"total",void 0),Pv(this,"countTH",void 0),this.offset=e,this.total=t,this.countTH=n}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleRowHeadedColumnToSourceColumn(e){return this.renderedToSource(this.offsettedTH(e))}sourceColumnToVisibleRowHeadedColumn(e){return this.unOffsettedTH(this.sourceToRendered(e))}};function Lv(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const Hv=class{constructor(e,t,n){Lv(this,"offset",void 0),Lv(this,"total",void 0),Lv(this,"countTH",void 0),this.offset=e,this.total=t,this.countTH=n}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleColHeadedRowToSourceRow(e){return this.renderedToSource(this.offsettedTH(e))}sourceRowToVisibleColHeadedRow(e){return this.unOffsettedTH(this.sourceToRendered(e))}};function kv(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Fv{constructor(){kv(this,"currentSize",0),kv(this,"nextSize",0),kv(this,"currentOffset",0),kv(this,"nextOffset",0)}setSize(e){this.currentSize=this.nextSize,this.nextSize=e}setOffset(e){this.currentOffset=this.nextOffset,this.nextOffset=e}}function Dv(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Vv{constructor(){Dv(this,"size",new Fv),Dv(this,"workingSpace",0),Dv(this,"sharedSize",null)}setSize(e){this.size.setSize(e)}setOffset(e){this.size.setOffset(e)}getViewSize(){return this.size}isShared(){return null!==this.sharedSize}isPlaceOn(e){return this.workingSpace===e}append(e){this.workingSpace=1,e.workingSpace=2,this.sharedSize=e.getViewSize()}prepend(e){this.workingSpace=2,e.workingSpace=1,this.sharedSize=e.getViewSize()}}var Uv=Ue,Bv=TypeError,Wv=Ti,jv=ct,Gv=kr,zv=$o,$v=function(e,t){if(!delete e[t])throw new Bv("Cannot delete property "+Uv(t)+" of "+Uv(e))},Yv=Ko,Kv=1!==[].unshift(0)||!function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(xm){return xm instanceof TypeError}}();function Xv(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Wv({target:"Array",proto:!0,arity:1,forced:Kv},{unshift:function(e){var t=jv(this),n=Gv(t),r=arguments.length;if(r){Yv(n+r);for(var i=n;i--;){var o=i+r;i in t?t[o]=t[i]:$v(t,o)}for(var s=0;s<r;s++)t[s]=arguments[s]}return zv(t,n+r)}});class qv{constructor(e,t){Xv(this,"order",[]),this.order=[...Array(t).keys()].map((t=>e+t))}get length(){return this.order.length}has(e){return this.order.indexOf(e)>-1}get(e){return e<this.order.length?this.order[e]:-1}remove(e){this.order.splice(this.order.indexOf(e),1)}prepend(e){return this.order.unshift(e),this.order.pop()}}function Qv(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Zv{constructor(e){Qv(this,"sizeSet",void 0),this.sizeSet=e}diff(){const{sizeSet:e}=this,{currentSize:t,nextSize:n}=e.getViewSize();let r=Math.max(n,t);if(0===r)return[];const{currentOffset:i,nextOffset:o}=e.getViewSize(),s=new qv(i,t),a=new qv(o,n),l=[];for(let h=0;h<r;h++){const t=s.get(h),i=a.get(h);if(-1===i)l.push(["remove",t]);else if(-1===t)!e.isShared()||e.isShared()&&e.isPlaceOn(2)?l.push(["append",i]):l.push(["prepend",i]);else if(i>t)s.has(i)&&(s.remove(i),n<=s.length&&(r-=1)),l.push(["replace",i,t]);else if(i<t){const e=s.prepend(i);l.push(["insert_before",i,t,e])}else l.push(["none",i])}return l}}function Jv(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class eC{constructor(e,t){Jv(this,"rootNode",void 0),Jv(this,"nodesPool",void 0),Jv(this,"sizeSet",new Vv),Jv(this,"collectedNodes",[]),Jv(this,"viewDiffer",new Zv(this.sizeSet)),Jv(this,"leads",[]),this.rootNode=e,this.nodesPool=t}setSize(e){return this.sizeSet.setSize(e),this}setOffset(e){return this.sizeSet.setOffset(e),this}isSharedViewSet(){return this.sizeSet.isShared()}getNode(e){return e<this.collectedNodes.length?this.collectedNodes[e]:null}getCurrentNode(){const e=this.collectedNodes.length;return e>0?this.collectedNodes[e-1]:null}applyCommand(e){const{rootNode:t}=this,[n,r,i,o]=e,s=this.nodesPool(r);switch(this.collectedNodes.push(s),n){case"prepend":t.insertBefore(s,t.firstChild);break;case"append":t.appendChild(s);break;case"insert_before":t.insertBefore(s,this.nodesPool(i)),t.removeChild(this.nodesPool(o));break;case"replace":t.replaceChild(s,this.nodesPool(i));break;case"remove":t.removeChild(s)}}start(){this.collectedNodes.length=0,this.leads=this.viewDiffer.diff()}render(){this.leads.length>0&&this.applyCommand(this.leads.shift())}end(){for(;this.leads.length>0;)this.applyCommand(this.leads.shift())}}class tC extends eC{prependView(e){return this.sizeSet.prepend(e.sizeSet),e.sizeSet.append(this.sizeSet),this}appendView(e){return this.sizeSet.append(e.sizeSet),e.sizeSet.prepend(this.sizeSet),this}}function nC(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class rC{constructor(e){nC(this,"nodeType",void 0),nC(this,"pool",new Map),this.nodeType=e.toUpperCase()}setRootDocument(e){this.rootDocument=e}obtain(e,t){const n="number"==typeof t?`${e}x${t}`:e.toString();if(this.pool.has(n))return this.pool.get(n);const r=this.rootDocument.createElement(this.nodeType);return this.pool.set(n,r),r}}function iC(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class oC{constructor(e,t){iC(this,"nodesPool",null),iC(this,"nodeType",void 0),iC(this,"rootNode",void 0),iC(this,"table",null),iC(this,"renderedNodes",0),this.nodesPool="string"==typeof e?new rC(e):null,this.nodeType=e,this.rootNode=t}setTable(e){this.nodesPool&&this.nodesPool.setRootDocument(e.rootDocument),this.table=e}adjust(){}render(){}}function sC(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class aC extends oC{constructor(){super("TH"),sC(this,"orderViews",new WeakMap),sC(this,"sourceRowIndex",0)}obtainOrderView(e){let t;return this.orderViews.has(e)?t=this.orderViews.get(e):(t=new tC(e,(e=>this.nodesPool.obtain(this.sourceRowIndex,e))),this.orderViews.set(e,t)),t}render(){const{rowsToRender:e,rowHeaderFunctions:t,rowHeadersCount:n,rows:r,cells:i}=this.table;for(let o=0;o<e;o++){const e=this.table.renderedRowToSource(o),s=r.getRenderedNode(o);this.sourceRowIndex=e;const a=this.obtainOrderView(s),l=i.obtainOrderView(s);a.appendView(l).setSize(n).setOffset(0).start();for(let r=0;r<n;r++){a.render();const n=a.getCurrentNode();n.className="",n.removeAttribute("style"),_p(n,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&Pp(n,[["role","rowheader"],["scope","row"],mp(r+1),hp(-1)]),t[r](e,n,r)}a.end()}}}class lC extends oC{constructor(e){super(null,e)}adjust(){const{columnHeadersCount:e,rowHeadersCount:t}=this.table;let n=this.rootNode.firstChild;if(e){const{columnsToRender:r}=this.table,i=r+t;for(let t=0,s=e;t<s;t++){for(n=this.rootNode.childNodes[t],n||(n=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(n)),this.renderedNodes=n.childNodes.length;this.renderedNodes<i;)n.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>i;)n.removeChild(n.lastChild),this.renderedNodes-=1}const o=this.rootNode.childNodes.length;if(o>e)for(let t=e;t<o;t++)this.rootNode.removeChild(this.rootNode.lastChild)}else n&&Hp(n)}render(){const{columnHeadersCount:e}=this.table;this.table.isAriaEnabled()&&Pp(this.rootNode,[["role","rowgroup"]]);for(let t=0;t<e;t+=1){const{columnHeaderFunctions:e,columnsToRender:n,rowHeadersCount:r}=this.table,i=this.rootNode.childNodes[t];this.table.isAriaEnabled()&&Pp(i,[["role","row"],gp(t+1)]);for(let o=-1*r;o<n;o+=1){const n=this.table.renderedColumnToSource(o),s=i.childNodes[o+r];s.className="",s.removeAttribute("style"),_p(s,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&Pp(s,[mp(o+1+this.table.rowHeadersCount),hp(-1),["role","columnheader"],...o>=0?[["scope","col"]]:[["role","row"]]]),e[t](n,s,t)}}}}let hC=!1;class uC extends oC{constructor(e){super(null,e)}adjust(){const{columnsToRender:e,rowHeadersCount:t}=this.table,n=e+t;for(;this.renderedNodes<n;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>n;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}render(){this.adjust();const{columnsToRender:e,rowHeadersCount:t}=this.table;!hC&&e>1e3&&(hC=!0,Om(Wd`Performance tip: Handsontable rendered more than 1000 visible columns.\x20
        Consider limiting the number of rendered columns by specifying the table width and/or\x20
        turning off the "renderAllColumns" option.`));for(let r=0;r<t;r++){const e=this.table.renderedColumnToSource(r),t=this.table.columnUtils.getHeaderWidth(e);this.rootNode.childNodes[r].style.width=`${t}px`}for(let r=0;r<e;r++){const e=this.table.renderedColumnToSource(r),n=this.table.columnUtils.getWidth(e);this.rootNode.childNodes[r+t].style.width=`${n}px`}const n=this.rootNode.firstChild;n&&Op(n,"rowHeader")}}function cC(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const dC="ht__row_even",pC="ht__row_odd";let gC=!1;class mC extends oC{constructor(e){super("TR",e),cC(this,"orderView",void 0),this.orderView=new eC(e,(e=>this.nodesPool.obtain(e)))}getRenderedNode(e){return this.orderView.getNode(e)}hasStaleContent(e){return this.orderView.hasStaleContent(e)}render(){const{rowsToRender:e}=this.table;!gC&&e>1e3&&(gC=!0,Om(Wd`Performance tip: Handsontable rendered more than 1000 visible rows.\x20
        Consider limiting the number of rendered rows by specifying the table height and/or\x20
        turning off the "renderAllRows" option.`)),this.table.isAriaEnabled()&&Pp(this.rootNode,[["role","rowgroup"]]),this.orderView.setSize(e).setOffset(this.table.renderedRowToSource(0)).start();for(let r=0;r<e;r++){this.orderView.render();const e=this.orderView.getCurrentNode(),i=this.table.renderedRowToSource(r);var t,n;if(this.table.isAriaEnabled())Pp(e,[["role","row"],gp(i+(null!==(t=null===(n=this.table.rowUtils)||void 0===n||null===(n=n.dataAccessObject)||void 0===n?void 0:n.columnHeaders.length)&&void 0!==t?t:0)+1)]);(i+1)%2==0?Ip(e,dC)||(xp(e,pC),Op(e,dC)):Ip(e,pC)||(xp(e,dC),Op(e,pC))}this.orderView.end()}}function fC(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class wC extends oC{constructor(){super("TD"),fC(this,"orderViews",new WeakMap),fC(this,"sourceRowIndex",0)}obtainOrderView(e){let t;return this.orderViews.has(e)?t=this.orderViews.get(e):(t=new tC(e,(e=>this.nodesPool.obtain(this.sourceRowIndex,e)),this.nodeType),this.orderViews.set(e,t)),t}render(){const{rowsToRender:e,columnsToRender:t,rows:n,rowHeaders:r}=this.table;for(let s=0;s<e;s++){const e=this.table.renderedRowToSource(s),a=n.getRenderedNode(s);this.sourceRowIndex=e;const l=this.obtainOrderView(a),h=r.obtainOrderView(a);l.prependView(h).setSize(t).setOffset(0).start();for(let n=0;n<t;n++){l.render();const t=this.table.renderedColumnToSource(n),r=l.getCurrentNode();var i,o;if(Ip(r,"hide")||(r.className=""),r.removeAttribute("style"),r.removeAttribute("dir"),_p(r,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.cellRenderer(e,t,r),this.table.isAriaEnabled())Pp(r,[...r.hasAttribute("role")?[]:[["role","gridcell"]],hp(-1),mp(t+(null!==(i=null===(o=this.table.rowUtils)||void 0===o||null===(o=o.dataAccessObject)||void 0===o?void 0:o.rowHeaders.length)&&void 0!==i?i:0)+1)])}l.end()}}}function yC(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class vC{constructor(e){let{cellRenderer:t,stylesHandler:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};yC(this,"rootNode",void 0),yC(this,"rootDocument",void 0),yC(this,"rowHeaders",null),yC(this,"columnHeaders",null),yC(this,"colGroup",null),yC(this,"rows",null),yC(this,"cells",null),yC(this,"rowFilter",null),yC(this,"columnFilter",null),yC(this,"rowUtils",null),yC(this,"columnUtils",null),yC(this,"rowsToRender",0),yC(this,"columnsToRender",0),yC(this,"rowHeaderFunctions",[]),yC(this,"rowHeadersCount",0),yC(this,"columnHeaderFunctions",[]),yC(this,"columnHeadersCount",0),yC(this,"cellRenderer",void 0),yC(this,"activeOverlayName",void 0),yC(this,"stylesHandler",void 0),this.rootNode=e,this.rootDocument=this.rootNode.ownerDocument,this.cellRenderer=t,this.stylesHandler=n}setActiveOverlayName(e){this.activeOverlayName=e}setAxisUtils(e,t){this.rowUtils=e,this.columnUtils=t}setViewportSize(e,t){this.rowsToRender=e,this.columnsToRender=t}setFilters(e,t){this.rowFilter=e,this.columnFilter=t}setHeaderContentRenderers(e,t){this.rowHeaderFunctions=e,this.rowHeadersCount=e.length,this.columnHeaderFunctions=t,this.columnHeadersCount=t.length}setRenderers(){let{rowHeaders:e,columnHeaders:t,colGroup:n,rows:r,cells:i}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.setTable(this),t.setTable(this),n.setTable(this),r.setTable(this),i.setTable(this),this.rowHeaders=e,this.columnHeaders=t,this.colGroup=n,this.rows=r,this.cells=i}renderedRowToSource(e){return this.rowFilter.renderedToSource(e)}renderedColumnToSource(e){return this.columnFilter.renderedToSource(e)}isAriaEnabled(){return this.rowUtils.wtSettings.getSetting("ariaTags")}render(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();const{rowsToRender:e,rows:t}=this;for(let n=0;n<e;n++){const e=t.getRenderedNode(n),r=this.rowUtils;if(e.firstChild){const t=this.renderedRowToSource(n),i=r.getHeightByOverlayName(t,this.activeOverlayName),o=this.stylesHandler.areCellsBorderBox()?0:1;e.firstChild.style.height=i?i-o+"px":""}}}}class CC{constructor(){let{TABLE:e,THEAD:t,COLGROUP:n,TBODY:r,rowUtils:i,columnUtils:o,cellRenderer:s,stylesHandler:a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.renderer=new vC(e,{cellRenderer:s,stylesHandler:a}),this.renderer.setRenderers({rowHeaders:new aC,columnHeaders:new lC(t),colGroup:new uC(n),rows:new mC(r),cells:new wC}),this.renderer.setAxisUtils(i,o)}setActiveOverlayName(e){return this.renderer.setActiveOverlayName(e),this}setFilters(e,t){return this.renderer.setFilters(e,t),this}setViewportSize(e,t){return this.renderer.setViewportSize(e,t),this}setHeaderContentRenderers(e,t){return this.renderer.setHeaderContentRenderers(e,t),this}adjust(){this.renderer.adjust()}render(){this.renderer.render()}}function SC(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class RC{constructor(e,t){SC(this,"dataAccessObject",void 0),SC(this,"wtSettings",void 0),SC(this,"headerWidths",new Map),this.dataAccessObject=e,this.wtSettings=t}getWidth(e){return this.wtSettings.getSetting("columnWidth",e)||this.wtSettings.getSetting("defaultColumnWidth")}getHeaderHeight(e){let t=this.dataAccessObject.stylesHandler.getDefaultRowHeight();const n=this.dataAccessObject.wtViewport.oversizedColumnHeaders[e];return void 0!==n&&(t=t?Math.max(t,n):n),t}getHeaderWidth(e){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(e))}calculateWidths(){const{wtSettings:e}=this;let t=e.getSetting("rowHeaderWidth");if(t=e.getSetting("onModifyRowHeaderWidth",t),null!=t){const n=e.getSetting("rowHeaders").length,r=e.getSetting("defaultColumnWidth");for(let e=0;e<n;e++){let n=Array.isArray(t)?t[e]:t;n=null==n?r:n,this.headerWidths.set(e,n)}}}}function EC(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class bC{constructor(e,t){EC(this,"dataAccessObject",void 0),EC(this,"wtSettings",void 0),this.dataAccessObject=e,this.wtSettings=t}getHeight(e){let t=this.wtSettings.getSetting("rowHeight",e);const n=this.dataAccessObject.wtViewport.oversizedRows[e];return void 0!==n&&(t=void 0===t?n:Math.max(t,n)),t}getHeightByOverlayName(e,t){let n=this.wtSettings.getSetting("rowHeightByOverlayName",e,t);const r=this.dataAccessObject.wtViewport.oversizedRows[e];return void 0!==r&&(n=void 0===n?r:Math.max(n,r)),n}}function TC(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const NC=class{constructor(e,t,n,r,i){TC(this,"wtSettings",null),TC(this,"domBindings",void 0),TC(this,"TBODY",null),TC(this,"THEAD",null),TC(this,"COLGROUP",null),TC(this,"hasTableHeight",!0),TC(this,"hasTableWidth",!0),TC(this,"isTableVisible",!1),TC(this,"tableOffset",0),TC(this,"holderOffset",0),this.domBindings=n,this.isMaster="master"===i,this.name=i,this.dataAccessObject=e,this.facadeGetter=t,this.wtSettings=r,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=n.rootTable,Lp(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;const o=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",(()=>this._modifyRowHeaderWidth(o))),this.rowUtils=new bC(this.dataAccessObject,this.wtSettings),this.columnUtils=new RC(this.dataAccessObject,this.wtSettings),this.tableRenderer=new CC({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer"),stylesHandler:this.dataAccessObject.stylesHandler})}is(e){return this.name===e}fixTableDomTree(){const e=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=e.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=e.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=e.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}createSpreader(e){const t=e.parentNode;let n;return t&&t.nodeType===Node.ELEMENT_NODE&&Ip(t,"wtHolder")||(n=this.domBindings.rootDocument.createElement("div"),n.className="wtSpreader",t&&t.insertBefore(n,e),n.appendChild(e)),n.style.position="relative",this.wtSettings.getSetting("ariaTags")&&Pp(n,[["role","presentation"]]),n}createHider(e){const t=e.parentNode;let n;return t&&t.nodeType===Node.ELEMENT_NODE&&Ip(t,"wtHolder")||(n=this.domBindings.rootDocument.createElement("div"),n.className="wtHider",t&&t.insertBefore(n,e),n.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&Pp(n,[["role","presentation"]]),n}createHolder(e){const t=e.parentNode;let n;return t&&t.nodeType===Node.ELEMENT_NODE&&Ip(t,"wtHolder")||(n=this.domBindings.rootDocument.createElement("div"),n.style.position="relative",n.className="wtHolder",Pp(n,[hp(-1)]),t&&t.insertBefore(n,e),this.isMaster&&(n.parentNode.className+="ht_master handsontable",n.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr"),this.wtSettings.getSetting("ariaTags")&&Pp(n.parentNode,[["role","presentation"]])),n.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&Pp(n,[["role","presentation"]]),n}draw(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const{wtSettings:t}=this,{wtOverlays:n,wtViewport:r}=this.dataAccessObject,i=t.getSetting("totalRows"),o=t.getSetting("totalColumns"),s=t.getSetting("rowHeaders"),a=s.length,l=t.getSetting("columnHeaders"),h=l.length;let u=e;if(this.isMaster&&(n.beforeDraw(),this.holderOffset=Up(this.holder),u=r.createCalculators(u),a&&!t.getSetting("fixedColumnsStart"))){const e=n.inlineStartOverlay.getScrollPosition(),t=this.correctHeaderWidth;this.correctHeaderWidth=0!==e,t!==this.correctHeaderWidth&&(u=!1)}if(u)this.isMaster&&n.refresh(!0);else{this.isMaster?this.tableOffset=Up(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;const e=i>0?this.getFirstRenderedRow():0,t=o>0?this.getFirstRenderedColumn():0;this.rowFilter=new Hv(e,i,h),this.columnFilter=new _v(t,o,a);let u=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();const e={};this.wtSettings.getSetting("beforeDraw",!0,e),u=!0!==e.skipRender}u&&(this.tableRenderer.setHeaderContentRenderers(s,l),(this.is(LC)||this.is(FC))&&this.tableRenderer.setHeaderContentRenderers(s,[]),this.resetOversizedRows(),this.tableRenderer.setActiveOverlayName(this.name).setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render(),this.isMaster&&this.markOversizedColumnHeaders(),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(LC))&&this.markOversizedRows(),this.isMaster?(this.wtSettings.getSetting("externalRowCalculator")||r.createVisibleCalculators(),n.refresh(!1),n.applyToDOM(),this.wtSettings.getSetting("onDraw",!0)):this.is(LC)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize())}let c=!1;return this.isMaster&&(c=n.topOverlay.resetFixedPosition(),n.bottomOverlay.clone&&(c=n.bottomOverlay.resetFixedPosition()||c),c=n.inlineStartOverlay.resetFixedPosition()||c,n.topInlineStartCornerOverlay&&n.topInlineStartCornerOverlay.resetFixedPosition(),n.bottomInlineStartCornerOverlay&&n.bottomInlineStartCornerOverlay.clone&&n.bottomInlineStartCornerOverlay.resetFixedPosition()),c?(n.refreshAll(),n.adjustElementsSize()):this.dataAccessObject.selectionManager.setActiveOverlay(this.facadeGetter()).render(u),this.isMaster&&n.afterDraw(),this.dataAccessObject.drawn=!0,this}markIfOversizedColumnHeader(e){const t=this.columnFilter.renderedToSource(e);let n=this.wtSettings.getSetting("columnHeaders").length;const r=this.dataAccessObject.stylesHandler.getDefaultRowHeight();let i,o,s;const a=this.wtSettings.getSetting("columnHeaderHeight")||[];for(;n;)n-=1,i=this.getColumnHeaderHeight(n),o=this.getColumnHeader(t,n),o&&(s=qp(o),(!i&&r<s||i<s)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=s),Array.isArray(a)?null!==a[n]&&void 0!==a[n]&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=a[n]):isNaN(a)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=a),this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]<(a[n]||a)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=a[n]||a))}adjustColumnHeaderHeights(){const{wtSettings:e}=this,t=this.THEAD.childNodes,n=this.dataAccessObject.wtViewport.oversizedColumnHeaders;for(let r=0,i=e.getSetting("columnHeaders").length;r<i;r++)if(n[r]){if(!t[r]||0===t[r].childNodes.length)return;t[r].childNodes[0].style.height=`${n[r]}px`}}resetOversizedRows(){const{wtSettings:e}=this,{wtViewport:t}=this.dataAccessObject;if((this.isMaster||this.is(LC))&&!e.getSetting("externalRowCalculator")){const e=this.getRenderedRowsCount();for(let n=0;n<e;n++){const e=this.rowFilter.renderedToSource(n);t.oversizedRows&&t.oversizedRows[e]&&(t.oversizedRows[e]=void 0)}}}getCell(e){let t=e.row,n=e.col;const r=this.wtSettings.getSetting("onModifyGetCellCoords",t,n,!this.isMaster,"render");if(r&&Array.isArray(r)&&([t,n]=r),this.isRowBeforeRenderedRows(t))return-1;if(this.isRowAfterRenderedRows(t))return-2;if(this.isColumnBeforeRenderedColumns(n))return-3;if(this.isColumnAfterRenderedColumns(n))return-4;const i=this.getRow(t);if(!i&&t>=0)throw new Error("TR was expected to be rendered but is not");const o=i.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(n)];if(!o&&n>=0)throw new Error("TD or TH was expected to be rendered but is not");return o}getRow(e){let t=null,n=null;var r,i;e<0?(t=null===(r=this.rowFilter)||void 0===r?void 0:r.sourceRowToVisibleColHeadedRow(e),n=this.THEAD):(t=null===(i=this.rowFilter)||void 0===i?void 0:i.sourceToRendered(e),n=this.TBODY);return void 0!==t&&void 0!==n&&(!(n.childNodes.length<t+1)&&n.childNodes[t])}getColumnHeader(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=this.THEAD.childNodes[t];return null==n?void 0:n.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]}getColumnHeaders(e){const t=[],n=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e);return this.THEAD.childNodes.forEach((e=>{const r=e.childNodes[n];r&&t.push(r)})),t}getRowHeader(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(t>=this.wtSettings.getSetting("rowHeaders").length)return;const n=this.rowFilter.sourceToRendered(e),r=n<0?this.rowFilter.sourceRowToVisibleColHeadedRow(e):n,i=(n<0?this.THEAD:this.TBODY).childNodes[r];return null==i?void 0:i.childNodes[t]}getRowHeaders(e){const t=[],n=this.wtSettings.getSetting("rowHeaders").length;for(let r=0;r<n;r++){const n=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)],i=null==n?void 0:n.childNodes[r];i&&t.push(i)}return t}getCoords(e){let t=e;if("TD"!==t.nodeName&&"TH"!==t.nodeName&&(t=Ep(t,["TD","TH"])),null===t)return null;const n=t.parentNode,r=n.parentNode;let i=function(e){let t=0,n=e;if(n.previousSibling)for(;n=n.previousSibling;)t+=1;return t}(n),o=t.cellIndex;if(Np(kC,t,this.wtRootElement)||Np(_C,t,this.wtRootElement))"THEAD"===r.nodeName&&(i-=r.childNodes.length);else if(Np(FC,t,this.wtRootElement)||Np(LC,t,this.wtRootElement)){i=this.wtSettings.getSetting("totalRows")-r.childNodes.length+i}else r===this.THEAD?i=this.rowFilter.visibleColHeadedRowToSourceRow(i):this.rowFilter&&(i=this.rowFilter.renderedToSource(i));Np(kC,t,this.wtRootElement)||Np(HC,t,this.wtRootElement)||Np(FC,t,this.wtRootElement)?o=this.columnFilter.offsettedTH(o):this.columnFilter&&(o=this.columnFilter.visibleRowHeadedColumnToSourceColumn(o));const s=this.wtSettings.getSetting("onModifyGetCoordsElement",i,o);return s&&Array.isArray(s)&&([i,o]=s),this.wot.createCellCoords(i,o)}markOversizedRows(){if(this.wtSettings.getSetting("externalRowCalculator"))return;let e=this.TBODY.childNodes.length;const t=e*this.dataAccessObject.stylesHandler.getDefaultRowHeight(),n=qp(this.TBODY)-1,r=this.wot.stylesHandler.areCellsBorderBox(),i=r?Xp:qp,o=r?0:1,s=r?1:0;let a,l,h,u,c;if(t!==n||this.wtSettings.getSetting("fixedRowsBottom"))for(;e;){e-=1,h=this.rowFilter.renderedToSource(e),a=this.getRowHeight(h),u=this.getTrForRow(h),c=u.querySelector("th");const t=0===h?s:0;l=c?i(c):i(u)-o,(!a&&this.dataAccessObject.stylesHandler.getDefaultRowHeight()<l-t||a<l)&&(r||(l+=1),this.dataAccessObject.wtViewport.oversizedRows[h]=l)}}getTrForRow(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]}isColumnHeaderRendered(e){if(e>=0)return!1;const t=this.wtSettings.getSetting("rowHeaders").length;return Math.abs(e)<=t}isRowHeaderRendered(e){if(e>=0)return!1;const t=this.wtSettings.getSetting("columnHeaders").length;return Math.abs(e)<=t}isRowBeforeRenderedRows(e){const t=this.getFirstRenderedRow();return e<0&&t<=0?!this.isRowHeaderRendered(e):e<t}isRowAfterRenderedRows(e){return e>this.getLastRenderedRow()}isColumnBeforeRenderedColumns(e){const t=this.getFirstRenderedColumn();return e<0&&t<=0?!this.isColumnHeaderRendered(e):e<t}isColumnAfterRenderedColumns(e){return this.columnFilter&&e>this.getLastRenderedColumn()}isColumnAfterViewport(e){return this.columnFilter&&e>this.getLastVisibleColumn()}isRowAfterViewport(e){return this.rowFilter&&e>this.getLastVisibleRow()}isColumnBeforeViewport(e){return this.columnFilter&&this.columnFilter.sourceToRendered(e)<0&&e>=0}isLastRowFullyVisible(){return this.getLastVisibleRow()===this.getLastRenderedRow()}isLastColumnFullyVisible(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}allRowsInViewport(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}allColumnsInViewport(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}getRowHeight(e){return this.rowUtils.getHeight(e)}getColumnHeaderHeight(e){return this.columnUtils.getHeaderHeight(e)}getColumnWidth(e){return this.columnUtils.getWidth(e)}hasDefinedSize(){return this.hasTableHeight&&this.hasTableWidth}getWidth(){return Kp(this.TABLE)}getHeight(){return Xp(this.TABLE)}getTotalWidth(){const e=Kp(this.hider);return 0!==e?e:this.getWidth()}getTotalHeight(){const e=Xp(this.hider);return 0!==e?e:this.getHeight()}isVisible(){return Vp(this.TABLE)}_modifyRowHeaderWidth(e){let t=pg(e)?e():null;return Array.isArray(t)?(t=[...t],t[t.length-1]=this._correctRowHeaderWidth(t[t.length-1])):t=this._correctRowHeaderWidth(t),t}_correctRowHeaderWidth(e){let t=e;return"number"!=typeof e&&(t=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(t+=1),t}},AC={getFirstRenderedRow(){const e=this.wtSettings.getSetting("totalRows"),t=this.wtSettings.getSetting("fixedRowsBottom"),n=e-t;return 0===e||0===t?-1:n<0?0:n},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){const e=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsBottom"),e)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount:()=>0};tm(AC,"MIXIN_NAME","stickyRowsBottom",{writable:!1,enumerable:!1});const MC=AC,IC={getFirstRenderedColumn(){return 0===this.wtSettings.getSetting("totalColumns")?-1:0},getFirstVisibleColumn(){return this.getFirstRenderedColumn()},getFirstPartiallyVisibleColumn(){return this.getFirstRenderedColumn()},getLastRenderedColumn(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn(){return this.getLastRenderedColumn()},getLastPartiallyVisibleColumn(){return this.getLastRenderedColumn()},getRenderedColumnsCount(){const e=this.wtSettings.getSetting("totalColumns");return Math.min(this.wtSettings.getSetting("fixedColumnsStart"),e)},getVisibleColumnsCount(){return this.getRenderedColumnsCount()},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};tm(IC,"MIXIN_NAME","stickyColumnsStart",{writable:!1,enumerable:!1});const OC=IC;class xC extends NC{constructor(e,t,n,r){super(e,t,n,r,FC)}}Zg(xC,MC),Zg(xC,OC);const PC=xC,_C="top",LC="bottom",HC="inline_start",kC="top_inline_start_corner",FC="bottom_inline_start_corner",DC=[_C,LC,HC,kC,FC],VC=new Map([[_C,`ht_clone_${_C}`],[LC,`ht_clone_${LC}`],[HC,`ht_clone_${HC} ht_clone_left`],[kC,`ht_clone_${kC} ht_clone_top_left_corner`],[FC,`ht_clone_${FC} ht_clone_bottom_left_corner`]]);function UC(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function BC(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function WC(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var jC=new WeakSet;function GC(e){const{wtSettings:t,inlineStartOverlay:n,wtTable:r,wtViewport:i,totalColumns:o,rootWindow:s}=this.dataAccessObject;if(n.mainTableScrollableElement===s){let a=null;if(t.getSetting("rtlMode")){const e=r.TABLE.getBoundingClientRect(),t=this.dataAccessObject.rootWindow.document.documentElement.offsetWidth;a=Math.abs(e.right-t)}else{a=Up(r.wtRootElement).left}const l=Math.abs(Gp(s,s));if(a>l){const t=Qp(s);let r=i.getRowHeaderWidth();for(let i=1;i<=o;i++)if(r+=n.sumCellSizes(i-1,i),a+r-l>=t){e=i-2;break}}}return e}function zC(e){const{topOverlay:t,wtTable:n,wtViewport:r,totalRows:i,rootWindow:o}=this.dataAccessObject;if(t.mainTableScrollableElement===o){const s=Up(n.wtRootElement),a=jp(o,o);if(s.top>a){const n=qp(o);let l=r.getColumnHeaderHeight();for(let r=1;r<=i;r++)if(l+=t.sumCellSizes(r-1,r),s.top+l-a>=n){e=r-2;break}}}return e}const $C=class{constructor(e){UC(this,jC),BC(this,"dataAccessObject",void 0),this.dataAccessObject=e}scrollViewport(e,t,n){if(e.col<0||e.row<0)return!1;const r=this.scrollViewportHorizontally(e.col,t),i=this.scrollViewportVertically(e.row,n);return r||i}scrollViewportHorizontally(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"auto";const{drawn:n,totalColumns:r}=this.dataAccessObject;if(!n)return!1;const i=om(t);if(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollHorizontally",e,i),!Number.isInteger(e)||e<0||e>r)return!1;t=i.value;const{fixedColumnsStart:o,inlineStartOverlay:s}=this.dataAccessObject,a="auto"===t;if(a&&e<o)return!1;const l=this.getFirstVisibleColumn(),h=this.getLastVisibleColumn();let u=!1;return(a&&(e<l||e>h)||!a)&&(u=s.scrollTo(e,a?e>=this.getLastPartiallyVisibleColumn():"end"===t)),u}scrollViewportVertically(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"auto";const{drawn:n,totalRows:r}=this.dataAccessObject;if(!n)return!1;const i=om(t);if(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollVertically",e,i),!Number.isInteger(e)||e<0||e>r)return!1;t=i.value;const{fixedRowsBottom:o,fixedRowsTop:s,topOverlay:a}=this.dataAccessObject,l="auto"===t;if(l&&(e<s||e>r-o-1))return!1;const h=this.getFirstVisibleRow(),u=this.getLastVisibleRow();let c=!1;return(l&&(e<h||e>u)||!l)&&(c=a.scrollTo(e,l?e>=this.getLastPartiallyVisibleRow():"bottom"===t)),c}getFirstVisibleRow(){return this.dataAccessObject.wtTable.getFirstVisibleRow()}getLastVisibleRow(){return WC(jC,this,zC).call(this,this.dataAccessObject.wtTable.getLastVisibleRow())}getFirstPartiallyVisibleRow(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleRow()}getLastPartiallyVisibleRow(){return WC(jC,this,zC).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleRow())}getFirstVisibleColumn(){return this.dataAccessObject.wtTable.getFirstVisibleColumn()}getLastVisibleColumn(){return WC(jC,this,GC).call(this,this.dataAccessObject.wtTable.getLastVisibleColumn())}getFirstPartiallyVisibleColumn(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleColumn()}getLastPartiallyVisibleColumn(){return WC(jC,this,GC).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleColumn())}};function YC(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class KC{get eventManager(){return new Of(this)}constructor(e,t){YC(this,"wtTable",void 0),YC(this,"wtScroll",void 0),YC(this,"wtViewport",void 0),YC(this,"wtOverlays",void 0),YC(this,"selectionManager",void 0),YC(this,"wtEvent",void 0),YC(this,"guid",`wt_${ip()}`),YC(this,"drawInterrupted",!1),YC(this,"drawn",!1),YC(this,"activeOverlayName","master"),YC(this,"domBindings",void 0),YC(this,"wtSettings",void 0),this.domBindings={rootTable:e,rootDocument:e.ownerDocument,rootWindow:e.ownerDocument.defaultView},this.wtSettings=t,this.wtScroll=new $C(this.createScrollDao())}findOriginalHeaders(){const e=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(let t=0,n=this.wtTable.THEAD.childNodes[0].childNodes.length;t<n;t++)e.push(this.wtTable.THEAD.childNodes[0].childNodes[t].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(t,n){Dp(n,e[t])}])}}createCellCoords(e,t){return new hv(e,t,this.wtSettings.getSetting("rtlMode"))}createCellRange(e,t,n){return new fv(e,t,n,this.wtSettings.getSetting("rtlMode"))}draw(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.drawInterrupted=!1,this.wtTable.isVisible()?this.wtTable.draw(e):this.drawInterrupted=!0,this}getCell(e){if(!(arguments.length>1&&void 0!==arguments[1]&&arguments[1]))return this.wtTable.getCell(e);const t=this.wtSettings.getSetting("totalRows"),n=this.wtSettings.getSetting("fixedRowsTop"),r=this.wtSettings.getSetting("fixedRowsBottom"),i=this.wtSettings.getSetting("fixedColumnsStart");if(e.row<n&&e.col<i)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(e);if(e.row<n)return this.wtOverlays.topOverlay.clone.wtTable.getCell(e);if(e.col<i&&e.row>=t-r){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(e)}else{if(e.col<i)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(e);if(e.row<t&&e.row>=t-r&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(e)}return this.wtTable.getCell(e)}scrollViewport(e,t,n){return this.wtScroll.scrollViewport(e,t,n)}scrollViewportHorizontally(e,t){return this.wtScroll.scrollViewportHorizontally(e,t)}scrollViewportVertically(e,t){return this.wtScroll.scrollViewportVertically(e,t)}getViewport(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}destroy(){this.wtOverlays.destroy(),this.wtEvent.destroy()}createScrollDao(){const e=this;return{get drawn(){return e.drawn},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get wtTable(){return e.wtTable},get wtViewport(){return e.wtViewport},get wtSettings(){return e.wtSettings},get rootWindow(){return e.domBindings.rootWindow},get totalRows(){return e.wtSettings.getSetting("totalRows")},get totalColumns(){return e.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return e.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return e.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return e.wtSettings.getSetting("fixedColumnsStart")}}}getTableDao(){const e=this;return{get wot(){return e},get parentTableOffset(){return e.cloneSource.wtTable.tableOffset},get cloneSource(){return e.cloneSource},get workspaceWidth(){return e.wtViewport.getWorkspaceWidth()},get wtViewport(){return e.wtViewport},get wtOverlays(){return e.wtOverlays},get selectionManager(){return e.selectionManager},get stylesHandler(){return e.stylesHandler},get drawn(){return e.drawn},set drawn(t){e.drawn=t},get wtTable(){return e.wtTable},get startColumnRendered(){return e.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return e.wtViewport.columnsVisibleCalculator.startColumn},get startColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.startColumn},get endColumnRendered(){return e.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return e.wtViewport.columnsVisibleCalculator.endColumn},get endColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.endColumn},get countColumnsRendered(){return e.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return e.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return e.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return e.wtViewport.rowsVisibleCalculator.startRow},get startRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.startRow},get endRowRendered(){return e.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return e.wtViewport.rowsVisibleCalculator.endRow},get endRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.endRow},get countRowsRendered(){return e.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return e.wtViewport.rowsVisibleCalculator.count},get columnHeaders(){return e.wtSettings.getSetting("columnHeaders")},get rowHeaders(){return e.wtSettings.getSetting("rowHeaders")}}}}function XC(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class qC extends KC{constructor(e,t,n){super(e,t),XC(this,"cloneSource",void 0),XC(this,"cloneOverlay",void 0);const r=this.wtSettings.getSetting("facade",this);this.cloneSource=n.source,this.cloneOverlay=n.overlay,this.stylesHandler=n.stylesHandler,this.wtTable=this.cloneOverlay.createTable(this.getTableDao(),r,this.domBindings,this.wtSettings),this.wtViewport=n.viewport,this.selectionManager=n.selectionManager,this.wtEvent=new xv(r,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager,n.event),this.findOriginalHeaders()}}function QC(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class ZC{constructor(e,t,n,r,i){QC(this,"wtSettings",null),tm(this,"wot",e,{writable:!1}),this.domBindings=i,this.facadeGetter=t,this.wtSettings=r;const{TABLE:o,hider:s,spreader:a,holder:l,wtRootElement:h}=this.wot.wtTable;this.instance=this.wot,this.type=n,this.mainTableScrollableElement=null,this.TABLE=o,this.hider=s,this.spreader=a,this.holder=l,this.wtRootElement=h,this.trimmingContainer=$p(this.hider.parentNode.parentNode),this.needFullRender=this.shouldBeRendered(),this.clone=this.makeClone()}hasRenderingStateChanged(){return this.needFullRender!==this.shouldBeRendered()}updateStateOfRendering(e){"before"===e&&this.shouldBeRendered()?this.needFullRender=!0:"after"!==e||this.shouldBeRendered()||(this.needFullRender=!1)}shouldBeRendered(){return!0}updateTrimmingContainer(){this.trimmingContainer=$p(this.hider.parentNode.parentNode)}updateMainScrollableElement(){const{wtTable:e}=this.wot,{rootWindow:t}=this.domBindings;"hidden"===t.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=zp(e.TABLE)}getRelativeCellPosition(e,t,n){if(!1===this.clone.wtTable.holder.contains(e))return void Om(`The provided element is not a child of the ${this.type} overlay`);const r=this.mainTableScrollableElement===this.domBindings.rootWindow,i=n<this.wtSettings.getSetting("fixedColumnsStart"),o=t<this.wtSettings.getSetting("fixedRowsTop"),s=t>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),a=this.clone.wtTable.spreader,l={start:this.getRelativeStartPosition(a),top:a.offsetTop},h={start:this.getRelativeStartPosition(e),top:e.offsetTop};let u=null;return u=r?this.getRelativeCellPositionWithinWindow(o,i,h,l):this.getRelativeCellPositionWithinHolder(o,s,i,h,l),u}getRelativeStartPosition(e){return this.isRtl()?e.offsetParent.offsetWidth-e.offsetLeft-e.offsetWidth:e.offsetLeft}getRelativeCellPositionWithinWindow(e,t,n,r){const i=this.wot.wtTable.wtRootElement.getBoundingClientRect();let o=0,s=0;if(t){let e=i.left;this.isRtl()&&(e=this.domBindings.rootWindow.innerWidth-(i.left+i.width+ng())),o=e<=0?-1*e:0}else o=r.start;if(e){s=this.clone.wtTable.TABLE.getBoundingClientRect().top-i.top}else s=r.top;return{start:n.start+o,top:n.top+s}}getRelativeCellPositionWithinHolder(e,t,n,r,i){const o=this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),s=this.wot.wtOverlays.topOverlay.getScrollPosition();let a=0,l=0;if(n||(a=o-i.start),t){const e=this.wot.wtTable.wtRootElement.getBoundingClientRect();l=-1*this.clone.wtTable.TABLE.getBoundingClientRect().top+e.top}else e||(l=s-i.top);return{start:r.start-a,top:r.top-l}}makeClone(){if(-1===DC.indexOf(this.type))throw new Error(`Clone type "${this.type}" is not supported.`);const{wtTable:e,wtSettings:t}=this.wot,{rootDocument:n,rootWindow:r}=this.domBindings,i=n.createElement("div"),o=n.createElement("table"),s=e.wtRootElement.parentNode;i.className=`${VC.get(this.type)} handsontable`,i.setAttribute("dir",this.isRtl()?"rtl":"ltr"),i.style.position="absolute",i.style.top=0,i.style.overflow="visible",this.isRtl()?i.style.right=0:i.style.left=0,t.getSetting("ariaTags")&&Pp(i,[["role","presentation"]]),o.className=e.TABLE.className;e.TABLE.getAttribute("role")&&o.setAttribute("role",e.TABLE.getAttribute("role")),i.appendChild(o),s.appendChild(i);const a=this.wtSettings.getSetting("preventOverflow");return!0===a||"horizontal"===a&&this.type===_C||"vertical"===a&&this.type===HC?this.mainTableScrollableElement=r:"hidden"===r.getComputedStyle(s).getPropertyValue("overflow")?this.mainTableScrollableElement=e.holder:this.mainTableScrollableElement=zp(e.TABLE),new qC(o,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selectionManager:this.wot.selectionManager,stylesHandler:this.wot.stylesHandler})}refresh(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.needFullRender){const t=this.clone.cloneSource;t.activeOverlayName=this.clone.wtTable.name,this.clone.draw(e),t.activeOverlayName="master"}}reset(){const e=this.clone.wtTable.holder,t=this.clone.wtTable.hider;[e.style,t.style,e.parentNode.style].forEach((e=>{e.width="",e.height=""}))}isRtl(){return this.wtSettings.getSetting("rtlMode")}destroy(){this.clone.eventManager.destroy()}}class JC extends ZC{constructor(e,t,n,r,i,o){super(e,t,FC,n,r),this.bottomOverlay=i,this.inlineStartOverlay=o}createTable(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new PC(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wot:e}=this;if(this.updateTrimmingContainer(),!e.wtTable.holder.parentNode)return!1;const t=this.clone.wtTable.holder.parentNode;if(t.style.top="",this.trimmingContainer===this.domBindings.rootWindow){const e=this.inlineStartOverlay.getOverlayOffset(),n=this.bottomOverlay.getOverlayOffset();t.style[this.isRtl()?"right":"left"]=`${e}px`,t.style.bottom=`${n}px`}else sg(t),this.repositionOverlay();let n=Xp(this.clone.wtTable.TABLE);const r=Kp(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(n=0),t.style.height=`${n}px`,t.style.width=`${r}px`,!1}repositionOverlay(){const{wtTable:e,wtViewport:t}=this.wot,{rootDocument:n}=this.domBindings,r=this.clone.wtTable.holder.parentNode;let i=0;t.hasVerticalScroll()||(i+=t.getWorkspaceHeight()-e.getTotalHeight()),t.hasVerticalScroll()&&t.hasHorizontalScroll()&&(i+=ng(n)),r.style.bottom=`${i}px`}}const eS={getFirstRenderedColumn(){const e=this.dataAccessObject.startColumnRendered;return null===e?-1:e},getFirstVisibleColumn(){const e=this.dataAccessObject.startColumnVisible;return null===e?-1:e},getFirstPartiallyVisibleColumn(){const e=this.dataAccessObject.startColumnPartiallyVisible;return null===e?-1:e},getLastRenderedColumn(){const e=this.dataAccessObject.endColumnRendered;return null===e?-1:e},getLastVisibleColumn(){const e=this.dataAccessObject.endColumnVisible;return null===e?-1:e},getLastPartiallyVisibleColumn(){const e=this.dataAccessObject.endColumnPartiallyVisible;return null===e?-1:e},getRenderedColumnsCount(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount(){return this.dataAccessObject.countColumnsVisible},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};tm(eS,"MIXIN_NAME","calculatedColumns",{writable:!1,enumerable:!1});const tS=eS;class nS extends NC{constructor(e,t,n,r){super(e,t,n,r,LC)}}Zg(nS,MC),Zg(nS,tS);const rS=nS;function iS(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class oS extends ZC{constructor(e,t,n,r){super(e,t,LC,n,r),iS(this,"cachedFixedRowsBottom",-1),this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom")}createTable(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new rS(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const{rootWindow:e}=this.domBindings,t=this.clone.wtTable.holder.parentNode;t.style.top="";let n=0;const r=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer!==e||r&&"vertical"===r?(n=this.getScrollPosition(),this.repositionOverlay()):(n=this.getOverlayOffset(),t.style.bottom=`${n}px`);const i=this.adjustHeaderBordersPosition(n);return this.adjustElementsSize(),i}repositionOverlay(){const{wtTable:e,wtViewport:t}=this.wot,{rootDocument:n}=this.domBindings,r=this.clone.wtTable.holder.parentNode;let i=0;t.hasVerticalScroll()||(i+=t.getWorkspaceHeight()-e.getTotalHeight()),t.hasVerticalScroll()&&t.hasHorizontalScroll()&&(i+=ng(n)),r.style.bottom=`${i}px`}setScrollPosition(e){const{rootWindow:t}=this.domBindings;let n=!1;return this.mainTableScrollableElement===t?(t.scrollTo(Wp(t),e),n=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,n=!0),n}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,t){const{wtTable:n,stylesHandler:r}=this.wot,i=r.getDefaultRowHeight();let o=e,s=0;for(;o<t;){const e=n.getRowHeight(o);s+=void 0===e?i:e,o+=1}return s}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:t}=this.wot,{rootDocument:n,rootWindow:r}=this.domBindings,i=this.clone.wtTable.holder.parentNode.style,o=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==r||"horizontal"===o){let r=t.getWorkspaceWidth();t.hasVerticalScroll()&&(r-=ng(n)),r=Math.min(r,e.wtRootElement.scrollWidth),i.width=`${r}px`}else i.width="";this.clone.wtTable.holder.style.width=i.width;let s=Xp(this.clone.wtTable.TABLE);e.hasDefinedSize()||(s=0),i.height=`${s}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=e.parentNode.style.height}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if("number"==typeof this.wot.wtViewport.rowsRenderCalculator.startPosition)this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else{if(0!==e)throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.top="0"}this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:t}=this.clone.wtTable;"number"==typeof this.wot.wtViewport.columnsRenderCalculator.startPosition?t.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:t.style[e]=""}scrollTo(e,t){let n=this.getTableParentOffset();const r=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let i=0;t&&r.offsetHeight!==r.clientHeight&&(i=ng(this.domBindings.rootDocument)),t?(n+=this.sumCellSizes(0,e+1),n-=this.wot.wtViewport.getViewportHeight(),n+=1):n+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),e),n+=i,this.setScrollPosition(n)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return jp(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,t=this.wtSettings.getSetting("preventOverflow");let n=0;if(this.trimmingContainer===e&&(!t||"vertical"!==t)){const e=this.wot.wtTable.getTotalHeight(),t=e-this.clone.wtTable.getTotalHeight(),r=this.domBindings.rootDocument.documentElement.clientHeight;n=Math.max(this.getTableParentOffset()-this.getScrollPosition()-r+e,0),n>t&&(n=0)}return n}adjustHeaderBordersPosition(e){const t=this.wtSettings.getSetting("fixedRowsBottom"),n=this.cachedFixedRowsBottom!==t,r=this.wtSettings.getSetting("columnHeaders");let i=!1;if((n||0===t)&&r.length>0){const t=this.wot.wtTable.holder.parentNode,n=Ip(t,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),e||0===this.wtSettings.getSetting("totalRows")?(Op(t,"innerBorderBottom"),i=!n):(xp(t,"innerBorderBottom"),i=n)}return i}}const sS={getFirstRenderedRow(){const e=this.dataAccessObject.startRowRendered;return null===e?-1:e},getFirstVisibleRow(){const e=this.dataAccessObject.startRowVisible;return null===e?-1:e},getFirstPartiallyVisibleRow(){const e=this.dataAccessObject.startRowPartiallyVisible;return null===e?-1:e},getLastRenderedRow(){const e=this.dataAccessObject.endRowRendered;return null===e?-1:e},getLastVisibleRow(){const e=this.dataAccessObject.endRowVisible;return null===e?-1:e},getLastPartiallyVisibleRow(){const e=this.dataAccessObject.endRowPartiallyVisible;return null===e?-1:e},getRenderedRowsCount(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount(){return this.dataAccessObject.countRowsVisible},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};tm(sS,"MIXIN_NAME","calculatedRows",{writable:!1,enumerable:!1});const aS=sS;class lS extends NC{constructor(e,t,n,r){super(e,t,n,r,HC)}}Zg(lS,aS),Zg(lS,OC);const hS=lS,uS={_localHooks:Object.create(null),addLocalHook(e,t){return this._localHooks[e]||(this._localHooks[e]=[]),this._localHooks[e].push(t),this},runLocalHooks(e,t,n,r,i,o,s){if(this._localHooks[e]){const a=this._localHooks[e].length;for(let l=0;l<a;l++)fg(this._localHooks[e][l],this,t,n,r,i,o,s)}},clearLocalHooks(){return this._localHooks={},this}};tm(uS,"MIXIN_NAME","localHooks",{writable:!1,enumerable:!1});const cS=uS;let dS=class{constructor(e,t){this.settings=e,this.cellRange=t||null}isEmpty(){return null===this.cellRange}add(e){return this.isEmpty()?this.cellRange=this.settings.createCellRange(e):this.cellRange.expand(e),this}replace(e,t){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=t,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=t,!0}return!1}clear(){return this.cellRange=null,this}getCorners(){const e=this.cellRange.getOuterTopStartCorner(),t=this.cellRange.getOuterBottomEndCorner();return[e.row,e.col,t.row,t.col]}destroy(){this.runLocalHooks("destroy")}};Zg(dS,cS);const pS=dS,gS="active-header",mS="header",fS="area",wS="focus",yS=e=>{const t=e.stylesHandler;if(t.isClassicTheme())return Object.freeze({width:6,height:6,borderWidth:1,borderStyle:"solid",borderColor:"#FFF"});const n=t.getCSSVariableValue("cell-autofill-size"),r=t.getCSSVariableValue("cell-autofill-border-width"),i=t.getCSSVariableValue("cell-autofill-border-color");return Object.freeze({width:n,height:n,borderWidth:r,borderStyle:"solid",borderColor:i})};function vS(e,t,n){CS(e,t),t.set(e,n)}function CS(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function SS(e,t){return e.get(ES(e,t))}function RS(e,t,n){return e.set(ES(e,t),n),n}function ES(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}Wm("flat");var bS=new WeakMap,TS=new WeakMap,NS=new WeakSet;class AS{constructor(){var e,t;CS(e=this,t=NS),t.add(e),vS(this,bS,void 0),vS(this,TS,void 0)}setActiveOverlay(e){return RS(TS,this,e),this}setActiveSelection(e){return RS(bS,this,e),this}scan(){const e=SS(bS,this).settings.selectionType,t=new Set;return"active-header"===e?(this.scanColumnsInHeadersRange((e=>t.add(e))),this.scanRowsInHeadersRange((e=>t.add(e)))):"area"===e?this.scanCellsRange((e=>t.add(e))):"focus"===e?(this.scanColumnsInHeadersRange((e=>t.add(e))),this.scanRowsInHeadersRange((e=>t.add(e))),this.scanCellsRange((e=>t.add(e)))):"fill"===e?this.scanCellsRange((e=>t.add(e))):"header"===e?(this.scanColumnsInHeadersRange((e=>t.add(e))),this.scanRowsInHeadersRange((e=>t.add(e)))):"row"===e?(this.scanRowsInHeadersRange((e=>t.add(e))),this.scanRowsInCellsRange((e=>t.add(e)))):"column"===e&&(this.scanColumnsInHeadersRange((e=>t.add(e))),this.scanColumnsInCellsRange((e=>t.add(e)))),t}scanColumnsInHeadersRange(e){const[t,n,r,i]=SS(bS,this).getCorners(),{wtTable:o}=SS(TS,this),s=o.getRenderedColumnsCount(),a=o.getColumnHeadersCount();let l=0;for(let h=-o.getRowHeadersCount();h<s;h++){const s=o.columnFilter.renderedToSource(h);if(!(s<n||s>i)){for(let h=-a;h<0;h++){if(h<t||h>r)continue;const u=h+a;let c=o.getColumnHeader(s,u);const d=SS(TS,this).getSetting("onBeforeHighlightingColumnHeader",s,u,{selectionType:SS(bS,this).settings.selectionType,columnCursor:l,selectionWidth:i-n+1});null!==d&&(d!==s&&(c=o.getColumnHeader(d,u)),e(c))}l+=1}}}scanRowsInHeadersRange(e){const[t,n,r,i]=SS(bS,this).getCorners(),{wtTable:o}=SS(TS,this),s=o.getRenderedRowsCount(),a=o.getRowHeadersCount();let l=0;for(let h=-o.getColumnHeadersCount();h<s;h++){const s=o.rowFilter.renderedToSource(h);if(!(s<t||s>r)){for(let h=-a;h<0;h++){if(h<n||h>i)continue;const u=h+a;let c=o.getRowHeader(s,u);const d=SS(TS,this).getSetting("onBeforeHighlightingRowHeader",s,u,{selectionType:SS(bS,this).settings.selectionType,rowCursor:l,selectionHeight:r-t+1});null!==d&&(d!==s&&(c=o.getRowHeader(d,u)),e(c))}l+=1}}}scanCellsRange(e){const{wtTable:t}=SS(TS,this);ES(NS,this,MS).call(this,((n,r)=>{const i=t.getCell(SS(TS,this).createCellCoords(n,r)),o=SS(TS,this).getSetting("onAfterDrawSelection",n,r,SS(bS,this).settings.layerLevel);"string"==typeof o&&Op(i,o),e(i)}))}scanRowsInCellsRange(e){const[t,,n]=SS(bS,this).getCorners(),{wtTable:r}=SS(TS,this);ES(NS,this,IS).call(this,((i,o)=>{if(i>=t&&i<=n){const t=r.getCell(SS(TS,this).createCellCoords(i,o));e(t)}}))}scanColumnsInCellsRange(e){const[,t,,n]=SS(bS,this).getCorners(),{wtTable:r}=SS(TS,this);ES(NS,this,IS).call(this,((i,o)=>{if(o>=t&&o<=n){const t=r.getCell(SS(TS,this).createCellCoords(i,o));e(t)}}))}}function MS(e){let[t,n,r,i]=SS(bS,this).getCorners();if(t<0&&r<0||n<0&&i<0)return;const{wtTable:o}=SS(TS,this),s=t!==r||n!==i;if(n=Math.max(n,0),i=Math.max(i,0),t=Math.max(t,0),r=Math.max(r,0),s){if(n=Math.max(n,o.getFirstRenderedColumn()),i=Math.min(i,o.getLastRenderedColumn()),t=Math.max(t,o.getFirstRenderedRow()),r=Math.min(r,o.getLastRenderedRow()),i<n||r<t)return}else{if(!dg(o.getCell(SS(TS,this).createCellCoords(t,n))))return}for(let a=t;a<=r;a+=1)for(let t=n;t<=i;t+=1)e(a,t)}function IS(e){const{wtTable:t}=SS(TS,this),n=t.getRenderedRowsCount(),r=t.getRenderedColumnsCount();for(let i=0;i<n;i+=1){const n=t.rowFilter.renderedToSource(i);for(let i=0;i<r;i+=1)e(n,t.columnFilter.renderedToSource(i))}}const OS=class{constructor(e,t){t&&(this.eventManager=e.eventManager,this.instance=e,this.wot=e,this.settings=t,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle=yS(this.instance),this.cornerCenterPointOffset=-Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(t),this.registerListeners())}registerListeners(){const e=this.wot.rootDocument.body;this.eventManager.addEventListener(e,"mousedown",(()=>this.onMouseDown())),this.eventManager.addEventListener(e,"mouseup",(()=>this.onMouseUp()));for(let t=0,n=this.main.childNodes.length;t<n;t++){const e=this.main.childNodes[t];this.eventManager.addEventListener(e,"mouseenter",(e=>this.onMouseEnter(e,this.main.childNodes[t])))}}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onMouseEnter(e,t){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;e.preventDefault(),Nm(e);const n=this,r=this.wot.rootDocument.body,i=t.getBoundingClientRect();t.style.display="none",this.eventManager.addEventListener(r,"mousemove",(function e(o){var s;((s=o).clientY<Math.floor(i.top)||s.clientY>Math.ceil(i.top+i.height)||s.clientX<Math.floor(i.left)||s.clientX>Math.ceil(i.left+i.width))&&(n.eventManager.removeEventListener(r,"mousemove",e),t.style.display="block")}))}createBorders(e){const{rootDocument:t}=this.wot;this.main=t.createElement("div");const n=["top","start","bottom","end","corner"];let r=this.main.style;r.position="absolute",r.top=0,r.left=0;for(let s=0;s<5;s++){const i=n[s],o=t.createElement("div");o.className=`wtBorder ${this.settings.className||""}`,this.settings[i]&&this.settings[i].hide&&(o.className+=" hidden"),r=o.style,r.backgroundColor=this.settings[i]&&this.settings[i].color?this.settings[i].color:e.border.color,r.height=this.settings[i]&&this.settings[i].width?`${this.settings[i].width}px`:`${e.border.width}px`,r.width=this.settings[i]&&this.settings[i].width?`${this.settings[i].width}px`:`${e.border.width}px`,this.main.appendChild(o)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=`${this.cornerDefaultStyle.width}px`,this.cornerStyle.height=`${this.cornerDefaultStyle.height}px`,this.cornerStyle.border=[`${this.cornerDefaultStyle.borderWidth}px`,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),wm()&&this.instance.getSetting("isDataViewInstance")&&this.createMultipleSelectorHandles(),this.disappear();const{wtTable:i}=this.wot;let o=i.bordersHolder;o||(o=t.createElement("div"),o.className="htBorders",i.bordersHolder=o,i.spreader.appendChild(o)),o.appendChild(this.main)}createMultipleSelectorHandles(){const{rootDocument:e,stylesHandler:t}=this.wot,n=t.getCSSVariableValue("cell-mobile-handle-size"),r=t.getCSSVariableValue("cell-mobile-handle-border-radius"),i=t.getCSSVariableValue("cell-mobile-handle-background-color"),o=t.getCSSVariableValue("cell-mobile-handle-border-width"),s=t.getCSSVariableValue("cell-mobile-handle-border-color");this.selectionHandles={top:e.createElement("DIV"),topHitArea:e.createElement("DIV"),bottom:e.createElement("DIV"),bottomHitArea:e.createElement("DIV")};this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};nm({position:"absolute",height:"40px",width:"40px","border-radius":`${parseInt(40/1.5,10)}px`},((e,t)=>{this.selectionHandles.styles.bottomHitArea[t]=e,this.selectionHandles.styles.topHitArea[t]=e}));nm(t.isClassicTheme()?{position:"absolute",height:"10px",width:"10px","border-radius":`${parseInt(10/1.5,10)}px`,background:"#F5F5FF",border:"1px solid #4285c8"}:{position:"absolute",height:`${n}px`,width:`${n}px`,"border-radius":`${r}px`,background:`${i}`,border:`${o}px solid ${s}`},((e,t)=>{this.selectionHandles.styles.bottom[t]=e,this.selectionHandles.styles.top[t]=e})),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}isPartRange(e,t){const n=this.wot.selectionManager.getAreaSelection();return!(!n.cellRange||e===n.cellRange.to.row&&t===n.cellRange.to.col)}updateMultipleSelectionHandlesPosition(e,t,n,r,i,o){const s=this.wot.wtSettings.getSetting("rtlMode")?"right":"left",{top:a,topHitArea:l,bottom:h,bottomHitArea:u}=this.selectionHandles.styles,c=parseInt(a.borderWidth,10),d=parseInt(a.width,10),p=parseInt(l.width,10),g=this.wot.wtTable.getWidth(),m=this.wot.wtTable.getHeight();a.top=`${parseInt(n-d-1,10)}px`,a[s]=`${parseInt(r-d-1,10)}px`,l.top=`${parseInt(n-p/4*3,10)}px`,l[s]=`${parseInt(r-p/4*3,10)}px`;const f=Math.min(parseInt(r+i,10),g-d-2*c),w=Math.min(parseInt(r+i-p/4,10),g-p-2*c);h[s]=`${f}px`,u[s]=`${w}px`;const y=Math.min(parseInt(n+o,10),m-d-2*c),v=Math.min(parseInt(n+o-p/4,10),m-p-2*c);h.top=`${y}px`,u.top=`${v}px`,this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(a.display="block",l.display="block",this.isPartRange(e,t)?(h.display="none",u.display="none"):(h.display="block",u.display="block")):(a.display="none",h.display="none",l.display="none",u.display="none"),e===this.wot.wtSettings.getSetting("fixedRowsTop")||t===this.wot.wtSettings.getSetting("fixedColumnsStart")?(a.zIndex="9999",l.zIndex="9999"):(a.zIndex="",l.zIndex="")}appear(e){if(this.disabled)return;let[t,n,r,i]=e;if(t<0&&r<0||n<0&&i<0)return void this.disappear();const{wtTable:o,rootDocument:s,rootWindow:a}=this.wot,l=t!==r||n!==i,h=o.getFirstRenderedRow(),u=o.getLastRenderedRow(),c=o.getFirstRenderedColumn(),d=o.getLastRenderedColumn();let p;if(l){if(n=Math.max(n,c),i=Math.min(i,d),t=Math.max(t,h),r=Math.min(r,u),i<n||r<t)return void this.disappear();p=o.getCell(this.wot.createCellCoords(t,n))}else if(p=o.getCell(this.wot.createCellCoords(t,n)),!dg(p))return void this.disappear();const g=l?o.getCell(this.wot.createCellCoords(r,i)):p,m=Up(p),f=l?Up(g):m,w=Up(o.TABLE),y=m.top,v=m.left,C=this.wot.wtSettings.getSetting("rtlMode");let S=0,R=0;if(C){const e=Kp(o.TABLE),t=Kp(p),n=a.innerWidth-w.left-e;R=v+t-f.left,S=a.innerWidth-v-t-n-1}else R=f.left+Kp(g)-v,S=v-w.left-1;if(this.isEntireColumnSelected(t,r)){const e=t,r=this.getDimensionsFromHeader("columns",n,i,e,w);let o=null;r&&([o,S,R]=r),o&&(p=o)}let E=y-w.top-1,b=f.top+Xp(g)-y;if(this.isEntireRowSelected(n,i)){const e=n,i=this.getDimensionsFromHeader("rows",t,r,e,w);let o=null;i&&([o,E,b]=i),o&&(p=o)}const T=a.getComputedStyle(p);parseInt(T.borderTopWidth,10)>0&&(E+=1,b=b>0?b-1:0),parseInt(T[C?"borderRightWidth":"borderLeftWidth"],10)>0&&(S+=1,R=R>0?R-1:0);const N=C?"right":"left";this.topStyle.top=`${E}px`,this.topStyle[N]=`${S}px`,this.topStyle.width=`${R}px`,this.topStyle.display="block",this.startStyle.top=`${E}px`,this.startStyle[N]=`${S}px`,this.startStyle.height=`${b}px`,this.startStyle.display="block";const A=Math.floor(this.settings.border.width/2);this.bottomStyle.top=E+b-A+"px",this.bottomStyle[N]=`${S}px`,this.bottomStyle.width=`${R}px`,this.bottomStyle.display="block",this.endStyle.top=`${E}px`,this.endStyle[N]=S+R-A+"px",this.endStyle.height=`${b+1}px`,this.endStyle.display="block";let M=this.settings.border.cornerVisible;M="function"==typeof M?M(this.settings.layerLevel):M;const I=this.wot.getSetting("onModifyGetCellCoords",r,i,!1,"render");let[O,x]=[r,i];if(I&&Array.isArray(I)&&([,,O,x]=I),wm()||!M||this.isPartRange(O,x))this.cornerStyle.display="none";else{this.cornerStyle.top=E+b+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth+"px",this.cornerStyle[N]=S+R+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth+"px",this.cornerStyle.borderRightWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderLeftWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderBottomWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";let e=$p(o.TABLE);const t=e===a;t&&(e=s.documentElement);const n=parseInt(this.cornerDefaultStyle.borderWidth,10)-1,l=Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),h=Math.ceil(parseInt(this.cornerDefaultStyle.height,10)/2);if(i===this.wot.getSetting("totalColumns")-1){const r=t?g.getBoundingClientRect().left:g.offsetLeft;let i=!1,o=0;C?(o=r-parseInt(this.cornerDefaultStyle.width,10)/2,i=o<0):(o=r+Kp(g)+parseInt(this.cornerDefaultStyle.width,10)/2,i=o>=Qp(e)),i&&(this.cornerStyle[N]=`${Math.floor(S+R+this.cornerCenterPointOffset-l-n)}px`,this.cornerStyle[C?"borderLeftWidth":"borderRightWidth"]=0)}if(r===this.wot.getSetting("totalRows")-1){const r=(t?g.getBoundingClientRect().top:g.offsetTop)+Xp(g)+parseInt(this.cornerDefaultStyle.height,10)/2>=qp(e),i=this.wot.stylesHandler.isClassicTheme();if(r){const e=Math.floor(E+b+this.cornerCenterPointOffset-h-n);i?(this.cornerStyle.top=`${e}px`,this.cornerStyle.borderBottomWidth=0):this.cornerStyle.top=e-1+"px"}}this.cornerStyle.display="block"}wm()&&this.instance.getSetting("isDataViewInstance")&&this.updateMultipleSelectionHandlesPosition(r,i,E,S,R,b)}isEntireColumnSelected(e,t){return e===this.wot.wtTable.getFirstRenderedRow()&&t===this.wot.wtTable.getLastRenderedRow()}isEntireRowSelected(e,t){return e===this.wot.wtTable.getFirstRenderedColumn()&&t===this.wot.wtTable.getLastRenderedColumn()}getDimensionsFromHeader(e,t,n,r,i){const{wtTable:o}=this.wot,s=o.wtRootElement.parentNode;let a=null,l=null,h=null,u=null,c=null,d=null,p=null,g=null;switch(e){case"rows":a=function(){return o.getRowHeader(...arguments)},l=function(){return Xp(...arguments)},h="ht__selection--rows",d="top";break;case"columns":a=function(){return o.getColumnHeader(...arguments)},l=function(){return Kp(...arguments)},h="ht__selection--columns",d="left"}if(s.classList.contains(h)){const e=this.wot.getSetting("columnHeaders").length;if(p=a(t,e-r),g=a(n,e-r),!p||!g)return!1;const o=Up(p),s=Up(g);return p&&g&&(u=o[d]-i[d]-1,c=s[d]+l(g)-o[d]),[p,u,c]}return!1}changeBorderStyle(e,t){const n=this[e].style,r=t[e];!r||r.hide?Op(this[e],"hidden"):(Ip(this[e],"hidden")&&xp(this[e],"hidden"),n.backgroundColor=r.color,"top"!==e&&"bottom"!==e||(n.height=`${r.width}px`),"start"!==e&&"end"!==e||(n.width=`${r.width}px`))}changeBorderToDefaultStyle(e){const t=1,n="#000",r=this[e].style;r.backgroundColor=n,r.width=`${t}px`,r.height=`${t}px`}toggleHiddenClass(e,t){this.changeBorderToDefaultStyle(e),t?Op(this[e],"hidden"):xp(this[e],"hidden")}disappear(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",wm()&&this.instance.getSetting("isDataViewInstance")&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}destroy(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}};function xS(e,t,n){PS(e,t),t.set(e,n)}function PS(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _S(e,t){return e.get(HS(e,t))}function LS(e,t,n){return e.set(HS(e,t),n),n}function HS(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var kS=new WeakMap,FS=new WeakMap,DS=new WeakMap,VS=new WeakMap,US=new WeakMap,BS=new WeakMap,WS=new WeakSet;class jS{constructor(e){var t,n;PS(t=this,n=WS),n.add(t),xS(this,kS,void 0),xS(this,FS,void 0),xS(this,DS,new AS),xS(this,VS,new WeakMap),xS(this,US,new WeakSet),xS(this,BS,new Map),LS(FS,this,e)}setActiveOverlay(e){return LS(kS,this,e),_S(DS,this).setActiveOverlay(_S(kS,this)),_S(VS,this).has(_S(kS,this))||_S(VS,this).set(_S(kS,this),new Set),this}getFocusSelection(){return null!==_S(FS,this)?_S(FS,this).getFocus():null}getAreaSelection(){return null!==_S(FS,this)?_S(FS,this).createLayeredArea():null}getBorderInstance(e){if(!e.settings.border)return null;if(_S(BS,this).has(e)){const t=_S(BS,this).get(e);if(t.has(_S(kS,this)))return t.get(_S(kS,this));const n=new OS(_S(kS,this),e.settings);return t.set(_S(kS,this),n),n}const t=new OS(_S(kS,this),e.settings);return _S(BS,this).set(e,new Map([[_S(kS,this),t]])),t}getBorderInstances(e){var t,n;return Array.from(null!==(t=null===(n=_S(BS,this).get(e))||void 0===n?void 0:n.values())&&void 0!==t?t:[])}destroyBorders(e){_S(BS,this).get(e).forEach((e=>e.destroy())),_S(BS,this).delete(e)}render(e){if(null===_S(FS,this))return;e&&HS(WS,this,GS).call(this);const t=Array.from(_S(FS,this)),n=new Map,r=new Map;for(let i=0;i<t.length;i++){const e=t[i],{className:o,headerAttributes:s,createLayers:a,selectionType:l}=e.settings;_S(US,this).has(e)||(_S(US,this).add(e),e.addLocalHook("destroy",(()=>this.destroyBorders(e))));const h=this.getBorderInstance(e);if(e.isEmpty()){null==h||h.disappear();continue}if(o){_S(DS,this).setActiveSelection(e).scan().forEach((e=>{if(n.has(e)){const t=n.get(e);t.has(o)&&!0===a?t.set(o,t.get(o)+1):t.set(o,1)}else n.set(e,new Map([[o,1]]));s&&(r.has(e)||r.set(e,[]),"TH"===e.nodeName&&r.get(e).push(...s))}))}const u=e.getCorners();_S(kS,this).getSetting("onBeforeDrawBorders",u,l),null==h||h.appear(u)}n.forEach(((e,t)=>{var n;const r=Array.from(e).map((e=>{let[t,n]=e;return 1===n?t:[t,...Array.from({length:n-1},((e,n)=>`${t}-${n+1}`))]})).flat();r.forEach((e=>_S(VS,this).get(_S(kS,this)).add(e))),Op(t,r),"TD"===t.nodeName&&Array.isArray(null===(n=_S(FS,this).options)||void 0===n?void 0:n.cellAttributes)&&Pp(t,_S(FS,this).options.cellAttributes)})),Array.from(r.keys()).forEach((e=>{Pp(e,[...r.get(e)])}))}}function GS(){const e=_S(VS,this).get(_S(kS,this)),t=_S(kS,this).wtSettings.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(t))for(let n=0;n<t.length;n++)e.add(t[n]);e.forEach((e=>{var t,n;const r=_S(kS,this).wtTable.TABLE.querySelectorAll(`.${e}`);let i=[];Array.isArray(null===(t=_S(FS,this).options)||void 0===t?void 0:t.cellAttributes)&&(i=_S(FS,this).options.cellAttributes.map((e=>e[0]))),Array.isArray(null===(n=_S(FS,this).options)||void 0===n?void 0:n.headerAttributes)&&(i=[...i,..._S(FS,this).options.headerAttributes.map((e=>e[0]))]);for(let o=0,s=r.length;o<s;o++)xp(r[o],e),_p(r[o],i)})),e.clear()}class zS extends ZC{constructor(e,t,n,r){super(e,t,HC,n,r)}createTable(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new hS(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wtTable:e}=this.wot;if(!this.needFullRender||!this.shouldBeRendered()||!e.holder.parentNode)return!1;const{rootWindow:t}=this.domBindings,n=this.clone.wtTable.holder.parentNode,r=this.wtSettings.getSetting("preventOverflow");let i=0;this.trimmingContainer!==t||r&&"horizontal"===r?(i=this.getScrollPosition(),sg(n)):(i=this.getOverlayOffset()*(this.isRtl()?-1:1),og(n,`${i}px`,"0px"));const o=this.adjustHeaderBordersPosition(i);return this.adjustElementsSize(),o}setScrollPosition(e){const{rootWindow:t}=this.domBindings;let n=!1;return this.isRtl()&&(e=-e),this.mainTableScrollableElement===t&&t.scrollX!==e?(t.scrollTo(e,Bp(t)),n=!0):this.mainTableScrollableElement.scrollLeft!==e&&(this.mainTableScrollableElement.scrollLeft=e,n=!0),n}onScroll(){this.wtSettings.getSetting("onScrollVertically")}sumCellSizes(e,t){const n=this.wtSettings.getSetting("defaultColumnWidth");let r=e,i=0;for(;r<t;)i+=this.wot.wtTable.getColumnWidth(r)||n,r+=1;return i}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:t}=this.wot,{rootDocument:n,rootWindow:r}=this.domBindings,i=this.clone.wtTable.holder.parentNode.style,o=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==r||"vertical"===o){let r=t.getWorkspaceHeight();t.hasHorizontalScroll()&&(r-=ng(n)),r=Math.min(r,e.wtRootElement.scrollHeight),i.height=`${r}px`}else i.height="";this.clone.wtTable.holder.style.height=i.height;const s=Kp(this.clone.wtTable.TABLE);i.width=`${s}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,t=yS(this.wot),n=this.wot.selectionManager.getFocusSelection()?parseInt(t.width,10)/2:0;this.clone.wtTable.hider.style.height=this.hider.style.height,e.style.height=e.parentNode.style.height,e.style.width=`${parseInt(e.parentNode.style.width,10)+n}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalColumns"),t=this.isRtl()?"right":"left";if("number"==typeof this.wot.wtViewport.columnsRenderCalculator.startPosition)this.spreader.style[t]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`;else{if(0!==e)throw new Error("Incorrect value of the columnsRenderCalculator");this.spreader.style[t]="0"}this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){"number"==typeof this.wot.wtViewport.rowsRenderCalculator.startPosition?this.clone.wtTable.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`:this.clone.wtTable.spreader.style.top=""}scrollTo(e,t){const{wtSettings:n}=this,r=n.getSetting("rowHeaders"),i=n.getSetting("fixedColumnsStart"),o=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,s=0===i&&r.length>0&&!Ip(o.parentNode,"innerBorderInlineStart")?1:0;let a=this.getTableParentOffset(),l=0;if(t){this.wot.wtTable.getColumnWidth(e)>this.wot.wtViewport.getViewportWidth()&&(t=!1)}var h;return t&&o.offsetWidth!==o.clientWidth&&(l=ng(this.domBindings.rootDocument)),t?(a+=this.sumCellSizes(0,e+1),a-=this.wot.wtViewport.getViewportWidth(),a+=s):a+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),e),a+=l,(h=this.mainTableScrollableElement).scrollWidth-h.clientWidth==a-s&&s>0&&this.wot.wtOverlays.expandHiderHorizontallyBy(s),this.setScrollPosition(a)}getTableParentOffset(){let e=0;return this.wtSettings.getSetting("preventOverflow")||this.trimmingContainer!==this.domBindings.rootWindow||(e=this.wot.wtTable.holderOffset.left),e}getScrollPosition(){return Math.abs(Gp(this.mainTableScrollableElement,this.domBindings.rootWindow))}getOverlayOffset(){const{rootWindow:e}=this.domBindings,t=this.wtSettings.getSetting("preventOverflow");let n=0;if(this.trimmingContainer===e&&(!t||"horizontal"!==t)){n=this.isRtl()?Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);n>this.wot.wtTable.getTotalWidth()-this.clone.wtTable.getTotalWidth()&&(n=0)}return n}adjustHeaderBordersPosition(e){const{wtSettings:t}=this,n=this.wot.wtTable.holder.parentNode,r=t.getSetting("rowHeaders"),i=t.getSetting("fixedColumnsStart"),o=t.getSetting("totalRows"),s="vertical"===t.getSetting("preventOverflow");o?xp(n,"emptyRows"):Op(n,"emptyRows");let a=!1;if(!s)if(i&&!r.length)Op(n,"innerBorderLeft innerBorderInlineStart");else if(!i&&r.length){const t=Ip(n,"innerBorderInlineStart");e?(Op(n,"innerBorderLeft innerBorderInlineStart"),a=!t):(xp(n,"innerBorderLeft innerBorderInlineStart"),a=t)}return a}}const $S={getFirstRenderedRow(){return 0===this.wtSettings.getSetting("totalRows")?-1:0},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){const e=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsTop"),e)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};tm($S,"MIXIN_NAME","stickyRowsTop",{writable:!1,enumerable:!1});const YS=$S;class KS extends NC{constructor(e,t,n,r){super(e,t,n,r,kC)}}Zg(KS,YS),Zg(KS,OC);const XS=KS;function qS(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class QS extends ZC{constructor(e,t,n,r,i,o){super(e,t,kC,n,r),qS(this,"topOverlay",void 0),qS(this,"inlineStartOverlay",void 0),this.topOverlay=i,this.inlineStartOverlay=o}createTable(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new XS(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){og(e,`${this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1)}px`,`${this.topOverlay.getOverlayOffset()}px`)}else sg(e);let t=Xp(this.clone.wtTable.TABLE);const n=Kp(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(t=0),e.style.height=`${t}px`,e.style.width=`${n}px`,!1}}class ZS extends NC{constructor(e,t,n,r){super(e,t,n,r,_C)}}Zg(ZS,YS),Zg(ZS,tS);const JS=ZS;function eR(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class tR extends ZC{constructor(e,t,n,r){super(e,t,_C,n,r),eR(this,"cachedFixedRowsTop",-1),this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop")}createTable(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new JS(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode,{rootWindow:t}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let r=0,i=!1;if(this.trimmingContainer!==t||n&&"vertical"===n)r=this.getScrollPosition(),sg(e);else{const{wtTable:t}=this.wot,n=t.hider.getBoundingClientRect();i=Math.ceil(n.bottom)===e.offsetHeight,r=this.getOverlayOffset(),og(e,"0px",`${r}px`)}const o=this.adjustHeaderBordersPosition(r,i);return this.adjustElementsSize(),o}setScrollPosition(e){const t=this.domBindings.rootWindow;let n=!1;return this.mainTableScrollableElement===t&&t.scrollY!==e?(t.scrollTo(Wp(t),e),n=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,n=!0),n}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,t){const n=this.wot.stylesHandler.getDefaultRowHeight();let r=e,i=0;for(;r<t;){const e=this.wot.wtTable.getRowHeight(r);i+=void 0===e?n:e,r+=1}return i}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:t}=this.wot,{rootDocument:n,rootWindow:r}=this.domBindings,i=this.clone.wtTable.holder.parentNode.style,o=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==r||"horizontal"===o){let r=t.getWorkspaceWidth();t.hasVerticalScroll()&&(r-=ng(n)),r=Math.min(r,e.wtRootElement.scrollWidth),i.width=`${r}px`}else i.width="";this.clone.wtTable.holder.style.width=i.width;let s=Xp(this.clone.wtTable.TABLE);e.hasDefinedSize()||(s=0),i.height=`${s}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,t=yS(this.wot),n=this.wot.selectionManager.getFocusSelection()?parseInt(t.height,10)/2:0;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=`${parseInt(e.parentNode.style.height,10)+n}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if("number"==typeof this.wot.wtViewport.rowsRenderCalculator.startPosition)this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else{if(0!==e)throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.top="0"}this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:t}=this.clone.wtTable;"number"==typeof this.wot.wtViewport.columnsRenderCalculator.startPosition?t.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:t.style[e]=""}scrollTo(e,t){const{wot:n,wtSettings:r}=this,i=(n.cloneSource?n.cloneSource:n).wtTable.holder,o=r.getSetting("columnHeaders"),s=0===r.getSetting("fixedRowsTop")&&o.length>0&&!Ip(i.parentNode,"innerBorderTop")?1:0;let a=this.getTableParentOffset(),l=0;if(t){this.wot.wtTable.getRowHeight(e)>this.wot.wtViewport.getViewportHeight()&&(t=!1)}if(t&&i.offsetHeight!==i.clientHeight&&(l=ng(this.domBindings.rootDocument)),t){const t=r.getSetting("fixedRowsBottom"),i=r.getSetting("totalRows");a+=this.sumCellSizes(0,e+1),a-=n.wtViewport.getViewportHeight()-this.sumCellSizes(i-t,i),a+=1,a+=s}else a+=this.sumCellSizes(r.getSetting("fixedRowsTop"),e);var h;return a+=l,(h=this.mainTableScrollableElement).scrollHeight-h.clientHeight==a-s&&s>0&&this.wot.wtOverlays.expandHiderVerticallyBy(s),this.setScrollPosition(a)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return jp(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,t=this.wtSettings.getSetting("preventOverflow");let n=0;if(this.trimmingContainer===e&&(!t||"vertical"!==t)){const e=this.wot.wtTable.getTotalHeight()-this.clone.wtTable.getTotalHeight();n=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),n>e&&(n=0)}return n}adjustHeaderBordersPosition(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const{wtSettings:n}=this,r=this.wot.wtTable.holder.parentNode,i=n.getSetting("totalColumns"),o="horizontal"===n.getSetting("preventOverflow");i?xp(r,"emptyColumns"):Op(r,"emptyColumns");let s=!1;if(!t&&!o){const t=n.getSetting("fixedRowsTop"),i=this.cachedFixedRowsTop!==t,o=n.getSetting("columnHeaders");if((i||0===t)&&o.length>0){const t=Ip(r,"innerBorderTop");this.cachedFixedRowsTop=n.getSetting("fixedRowsTop"),e||0===n.getSetting("totalRows")?(Op(r,"innerBorderTop"),s=!t):(xp(r,"innerBorderTop"),s=t)}}return s}}function nR(e,t,n){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,n)}function rR(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function iR(e,t,n){return e.set(sR(e,t),n),n}function oR(e,t){return e.get(sR(e,t))}function sR(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var aR=new WeakMap,lR=new WeakMap,hR=new WeakMap,uR=new WeakMap;const cR=class{constructor(e,t,n,r,i,o){rR(this,"wot",null),nR(this,aR,[]),rR(this,"topOverlay",null),rR(this,"bottomOverlay",null),rR(this,"inlineStartOverlay",null),rR(this,"topInlineStartCornerOverlay",null),rR(this,"bottomInlineStartCornerOverlay",null),rR(this,"browserLineHeight",void 0),rR(this,"wtSettings",null),nR(this,lR,!1),nR(this,hR,0),nR(this,uR,null),rR(this,"resizeObserver",new ResizeObserver((e=>{am((()=>{Array.isArray(e)&&e.length&&(iR(hR,this,oR(hR,this)+1),100===oR(hR,this)&&(Om("The ResizeObserver callback was fired too many times in direct succession.\nThis may be due to an infinite loop caused by setting a dynamic height/width (for example, with the `dvh` units) to a Handsontable container's parent. \nThe observer will be disconnected."),this.resizeObserver.disconnect()),null!==oR(uR,this)&&clearTimeout(oR(uR,this)),iR(uR,this,setTimeout((()=>{iR(hR,this,0)}),100)),this.wtSettings.getSetting("onContainerElementResize"))}))}))),this.wot=e,this.wtSettings=r,this.domBindings=n,this.facadeGetter=t,this.wtTable=o;const{rootDocument:s,rootWindow:a}=this.domBindings;this.instance=this.wot,this.eventManager=i,this.scrollbarSize=ng(s);const l="hidden"===a.getComputedStyle(o.wtRootElement.parentNode).getPropertyValue("overflow");this.scrollableElement=l?o.holder:zp(o.TABLE),this.initOverlays(),this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=a.scrollX,this.lastScrollY=a.scrollY}getOverlays(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t=[...oR(aR,this)];return e&&t.push(this.wtTable),t}initBrowserLineHeight(){const{rootWindow:e,rootDocument:t}=this.domBindings,n=e.getComputedStyle(t.body),r=parseInt(n.lineHeight,10),i=1.2*parseInt(n.fontSize,10);this.browserLineHeight=r||i}initOverlays(){const e=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=new tR(...e),this.bottomOverlay=new oS(...e),this.inlineStartOverlay=new zS(...e),this.topInlineStartCornerOverlay=new QS(...e,this.topOverlay,this.inlineStartOverlay),this.bottomInlineStartCornerOverlay=new JC(...e,this.bottomOverlay,this.inlineStartOverlay),iR(aR,this,[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay])}beforeDraw(){iR(lR,this,oR(aR,this).reduce(((e,t)=>t.hasRenderingStateChanged()||e),!1)),oR(aR,this).forEach((e=>e.updateStateOfRendering("before")))}afterDraw(){this.syncScrollWithMaster(),oR(aR,this).forEach((e=>{const t=e.hasRenderingStateChanged();e.updateStateOfRendering("after"),t&&!e.needFullRender&&e.reset()}))}refreshAll(){this.wot.drawn&&(this.wtTable.holder.parentNode?(this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1):this.destroy())}registerListeners(){const{rootDocument:e,rootWindow:t}=this.domBindings,{mainTableScrollableElement:n}=this.topOverlay,{mainTableScrollableElement:r}=this.inlineStartOverlay;this.eventManager.addEventListener(e.documentElement,"keydown",(e=>this.onKeyDown(e))),this.eventManager.addEventListener(e.documentElement,"keyup",(()=>this.onKeyUp())),this.eventManager.addEventListener(e,"visibilitychange",(()=>this.onKeyUp())),this.eventManager.addEventListener(n,"scroll",(e=>this.onTableScroll(e)),{passive:!0}),n!==r&&this.eventManager.addEventListener(r,"scroll",(e=>this.onTableScroll(e)),{passive:!0});const i=t.devicePixelRatio&&t.devicePixelRatio>1,o=this.scrollableElement===t,s=this.wtSettings.getSetting("preventWheel"),a={passive:o};(s||i||!gm())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",(e=>this.onCloneWheel(e,s)),a);let l;[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay].forEach((e=>{this.eventManager.addEventListener(e.clone.wtTable.holder,"wheel",(e=>this.onCloneWheel(e,s)),a)})),this.eventManager.addEventListener(t,"resize",(()=>{am((()=>{clearTimeout(l),this.wtSettings.getSetting("onWindowResize"),l=setTimeout((()=>{iR(hR,this,0)}),200)}))})),o||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}onTableScroll(e){const t=this.domBindings.rootWindow,n=this.inlineStartOverlay.mainTableScrollableElement,r=this.topOverlay.mainTableScrollableElement,i=e.target;this.keyPressed&&(r!==t&&i!==t&&!e.target.contains(r)||n!==t&&i!==t&&!e.target.contains(n))||this.syncScrollPositions(e)}onCloneWheel(e,t){const{rootWindow:n}=this.domBindings,r=this.inlineStartOverlay.mainTableScrollableElement,i=this.topOverlay.mainTableScrollableElement,o=e.target,s=i!==n&&o!==n&&!o.contains(i),a=r!==n&&o!==n&&!o.contains(r);if(this.keyPressed&&(s||a)||this.scrollableElement===n)return;const l=this.translateMouseWheelToScroll(e);(t||this.scrollableElement!==n&&l)&&e.preventDefault()}onKeyDown(e){this.keyPressed=Tm(e.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}onKeyUp(){this.keyPressed=!1}translateMouseWheelToScroll(e){let t=isNaN(e.deltaY)?-1*e.wheelDeltaY:e.deltaY,n=isNaN(e.deltaX)?-1*e.wheelDeltaX:e.deltaX;1===e.deltaMode&&(n+=n*this.browserLineHeight,t+=t*this.browserLineHeight);const r=this.scrollVertically(t),i=this.scrollHorizontally(n);return r||i}scrollVertically(e){const t=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=e,t!==this.scrollableElement.scrollTop}scrollHorizontally(e){const t=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=e,t!==this.scrollableElement.scrollLeft}syncScrollPositions(){if(this.destroyed)return;const{rootWindow:e}=this.domBindings,t=this.topOverlay.clone.wtTable.holder,n=this.inlineStartOverlay.clone.wtTable.holder,[r,i]=[this.scrollableElement.scrollLeft,this.scrollableElement.scrollTop];if(this.horizontalScrolling=t.scrollLeft!==r||this.lastScrollX!==e.scrollX,this.verticalScrolling=n.scrollTop!==i||this.lastScrollY!==e.scrollY,this.lastScrollX=e.scrollX,this.lastScrollY=e.scrollY,this.horizontalScrolling){t.scrollLeft=r;const e=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;e&&(e.scrollLeft=r)}this.verticalScrolling&&(n.scrollTop=i),this.refreshAll()}syncScrollWithMaster(){if(!oR(lR,this))return;const e=this.topOverlay.mainTableScrollableElement,{scrollLeft:t,scrollTop:n}=e;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=t),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=t),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=n),iR(lR,this,!1)}updateMainScrollableElements(){this.eventManager.clearEvents(!0),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();const{wtTable:e}=this,{rootWindow:t}=this.domBindings;"hidden"===t.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")?this.scrollableElement=e.holder:this.scrollableElement=zp(e.TABLE),this.registerListeners()}destroy(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}refresh(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.updateLastSpreaderSize()&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(e),this.inlineStartOverlay.refresh(e),this.topOverlay.refresh(e),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(e),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(e)}updateLastSpreaderSize(){const e=this.wtTable.spreader,t=e.clientWidth,n=e.clientHeight,r=t!==this.spreaderLastSize.width||n!==this.spreaderLastSize.height;return r&&(this.spreaderLastSize.width=t,this.spreaderLastSize.height=n),r}adjustElementsSize(){const{wtViewport:e}=this.wot,{wtTable:t}=this,{rootWindow:n}=this.domBindings,r=this.scrollableElement===n,i=this.wtSettings.getSetting("totalColumns"),o=this.wtSettings.getSetting("totalRows"),s=e.getRowHeaderWidth(),a=e.getColumnHeaderHeight()+this.topOverlay.sumCellSizes(0,o)+1,l=s+this.inlineStartOverlay.sumCellSizes(0,i),h=t.hider.style,u=(()=>!r&&this.scrollableElement.scrollTop>Math.max(0,a-t.holder.clientHeight))()?1:0,c=(()=>!r&&this.scrollableElement.scrollLeft>Math.max(0,l-t.holder.clientWidth))()?1:0;h.width=`${l+c}px`,h.height=`${a+u}px`,this.topOverlay.adjustElementsSize(),this.inlineStartOverlay.adjustElementsSize(),this.bottomOverlay.adjustElementsSize()}expandHiderVerticallyBy(e){const{wtTable:t}=this;t.hider.style.height=`${parseInt(t.hider.style.height,10)+e}px`}expandHiderHorizontallyBy(e){const{wtTable:t}=this;t.hider.style.width=`${parseInt(t.hider.style.width,10)+e}px`}applyToDOM(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}getParentOverlay(e){if(!e)return null;const t=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];let n=null;return Vd(t,(t=>{t&&t.clone&&t.clone.wtTable.TABLE.contains(e)&&(n=t.clone)})),n}syncOverlayTableClassNames(){const e=this.wtTable.TABLE;Vd([this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay],(t=>{t&&(t.clone.wtTable.TABLE.className=e.className)}))}};function dR(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class pR{constructor(e){dR(this,"settings",{}),dR(this,"defaults",Object.freeze(this.getDefaults())),nm(this.defaults,((t,n)=>{if(void 0!==e[n])this.settings[n]=e[n];else{if(void 0===t)throw new Error(`A required setting "${n}" was not provided`);this.settings[n]=t}}))}getDefaults(){return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,currentRowClassName:null,currentColumnClassName:null,preventOverflow:()=>!1,preventWheel:!1,data:void 0,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:()=>this.getSetting("fixedColumnsStart")>0||this.getSetting("rowHeaders").length>0,shouldRenderTopOverlay:()=>this.getSetting("fixedRowsTop")>0||this.getSetting("columnHeaders").length>0,shouldRenderBottomOverlay:()=>this.getSetting("fixedRowsBottom")>0,minSpareRows:0,rowHeaders:()=>[],columnHeaders:()=>[],totalRows:void 0,totalColumns:void 0,cellRenderer:(e,t,n)=>{const r=this.getSetting("data",e,t);Dp(n,null==r?"":r)},columnWidth(){},rowHeight(){},rowHeightByOverlayName(){},defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,viewportRowRenderingThreshold:null,viewportColumnRenderingThreshold:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onBeforeViewportScrollHorizontally:e=>e,onBeforeViewportScrollVertically:e=>e,onScrollHorizontally:null,onScrollVertically:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onModifyGetCoordsElement:null,onModifyGetCoords:null,onBeforeHighlightingRowHeader:e=>e,onBeforeHighlightingColumnHeader:e=>e,onWindowResize:null,onContainerElementResize:null,renderAllColumns:!1,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1,ariaTags:!0}}update(e,t){return void 0===t?nm(e,((e,t)=>{this.settings[t]=e})):this.settings[e]=t,this}getSetting(e,t,n,r,i){return"function"==typeof this.settings[e]?this.settings[e](t,n,r,i):void 0!==t&&Array.isArray(this.settings[e])?this.settings[e][t]:this.settings[e]}getSettingPure(e){return this.settings[e]}has(e){return!!this.settings[e]}}class gR extends NC{constructor(e,t,n,r){super(e,t,n,r,"master")}alignOverlaysWithTrimmingContainer(){const e=$p(this.wtRootElement),{rootWindow:t}=this.domBindings;if(e===t){this.wtSettings.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible")}else{const n=e.parentElement,r=Yp(e,"height",t),i=Yp(e,"overflow",t),o=this.holder.style,{scrollWidth:s,scrollHeight:a}=e;let l=e.offsetWidth,h=e.offsetHeight;if(n&&["auto","hidden","scroll"].includes(i)){const r=e.cloneNode(!1);r.style.overflow="auto",r.style.position="absolute",e.nextElementSibling?n.insertBefore(r,e.nextElementSibling):n.appendChild(r);const i=parseInt(t.getComputedStyle(r).height,10);n.removeChild(r),0===i&&(h=0)}h=Math.min(h,a),o.height="auto"===r?"auto":`${h}px`,l=Math.min(l,s),o.width=`${l}px`,o.overflow="",this.hasTableHeight="auto"===o.height||h>0,this.hasTableWidth=l>0}this.isTableVisible=Vp(this.TABLE)}markOversizedColumnHeaders(){const{wtSettings:e}=this,{wtViewport:t}=this.dataAccessObject,n="master",r=e.getSetting("columnHeaders").length;if(r&&!t.hasOversizedColumnHeadersMarked[n]){const i=e.getSetting("rowHeaders").length,o=this.getRenderedColumnsCount();for(let e=0;e<r;e++)for(let t=-1*i;t<o;t++)this.markIfOversizedColumnHeader(t);t.hasOversizedColumnHeadersMarked[n]=!0}}}Zg(gR,aS),Zg(gR,tS);const mR=gR;const fR=class{constructor(e,t,n,r,i){this.dataAccessObject=e,this.wot=e.wot,this.instance=this.wot,this.domBindings=t,this.wtSettings=n,this.wtTable=i,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.rowsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllRows")?new Gy:new Ky],["fullyVisible",()=>new ky],["partiallyVisible",()=>new Uy]]),this.columnsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllColumns")?new Wy:new $y],["fullyVisible",()=>new Ly],["partiallyVisible",()=>new Dy]]),this.eventManager=r,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",(()=>{this.clientHeight=this.getWorkspaceHeight()}))}getWorkspaceHeight(){const e=this.domBindings.rootDocument,t=this.dataAccessObject.topOverlayTrimmingContainer;let n=0;if(t===this.domBindings.rootWindow)n=e.documentElement.clientHeight;else{n=Xp(t)>0&&t.clientHeight>0?t.clientHeight:1/0}return n}getViewportHeight(){let e=this.getWorkspaceHeight();if(e===1/0)return e;const t=this.getColumnHeaderHeight();return t>0&&(e-=t),e}getWorkspaceWidth(){const{rootDocument:e,rootWindow:t}=this.domBindings,n=this.dataAccessObject.inlineStartOverlayTrimmingContainer;let r;if(n===t){const t=this.wtSettings.getSetting("totalColumns");r=this.wtTable.holder.offsetWidth,this.getRowHeaderWidth()+this.sumColumnWidths(0,t)>r&&(r=e.documentElement.clientWidth)}else r=n.clientWidth;return r}getViewportWidth(){const e=this.getWorkspaceWidth();if(e===1/0)return e;const t=this.getRowHeaderWidth();return t>0?e-t:e}hasVerticalScroll(){if(this.isVerticallyScrollableByWindow()){const e=this.domBindings.rootDocument.documentElement;return e.scrollHeight>e.clientHeight}const{holder:e,hider:t}=this.wtTable,n=e.clientHeight,r=t.offsetHeight;return n<r||r>this.getWorkspaceHeight()}hasHorizontalScroll(){if(this.isVerticallyScrollableByWindow()){const e=this.domBindings.rootDocument.documentElement;return e.scrollWidth>e.clientWidth}const{holder:e,hider:t}=this.wtTable,n=e.clientWidth,r=t.offsetWidth;return n<r||r>this.getWorkspaceWidth()}isVerticallyScrollableByWindow(){return this.dataAccessObject.topOverlayTrimmingContainer===this.domBindings.rootWindow}isHorizontallyScrollableByWindow(){return this.dataAccessObject.inlineStartOverlayTrimmingContainer===this.domBindings.rootWindow}sumColumnWidths(e,t){let n=0,r=e;for(;r<t;)n+=this.wtTable.getColumnWidth(r),r+=1;return n}getWorkspaceOffset(){return Up(this.wtTable.holder)}getColumnHeaderHeight(){return this.wtSettings.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=Xp(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}getRowHeaderWidth(){const e=this.wtSettings.getSetting("rowHeaderWidth"),t=this.wtSettings.getSetting("rowHeaders");if(e){this.rowHeaderWidth=0;for(let n=0,r=t.length;n<r;n++)this.rowHeaderWidth+=e[n]||e}if(isNaN(this.rowHeaderWidth))if(t.length){let e=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(let n=0,r=t.length;n<r;n++)e?(this.rowHeaderWidth+=Kp(e),e=e.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}createRowsCalculator(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:t,wtTable:n}=this;let r,i,o=this.getViewportHeight();this.rowHeaderWidth=NaN;let s=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset;const a=t.getSetting("fixedRowsTop"),l=t.getSetting("fixedRowsBottom"),h=t.getSetting("totalRows");return a&&s>=0&&(i=this.dataAccessObject.topOverlay.sumCellSizes(0,a),s+=i,o-=i),l&&this.dataAccessObject.bottomOverlay.clone&&(i=this.dataAccessObject.bottomOverlay.sumCellSizes(h-l,h),o-=i),r=n.holder.clientHeight===n.holder.offsetHeight?0:ng(this.domBindings.rootDocument),new tv({calculationTypes:e.map((e=>[e,this.rowsCalculatorTypes.get(e)()])),viewportHeight:o,scrollOffset:s,totalRows:t.getSetting("totalRows"),defaultRowHeight:this.instance.stylesHandler.getDefaultRowHeight(),rowHeightFn:e=>n.getRowHeight(e),overrideFn:t.getSettingPure("viewportRowCalculatorOverride"),horizontalScrollbarHeight:r})}createColumnsCalculator(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:t,wtTable:n}=this;let r=this.getViewportWidth(),i=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;const o=t.getSetting("fixedColumnsStart");if(o&&i>=0){const e=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,o);i+=e,r-=e}return n.holder.clientWidth!==n.holder.offsetWidth&&(r-=ng(this.domBindings.rootDocument)),new Jy({calculationTypes:e.map((e=>[e,this.columnsCalculatorTypes.get(e)()])),viewportWidth:r,scrollOffset:i,totalColumns:t.getSetting("totalColumns"),columnWidthFn:e=>n.getColumnWidth(e),overrideFn:t.getSettingPure("viewportColumnCalculatorOverride"),inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}createCalculators(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const{wtSettings:t}=this,n=this.createRowsCalculator(),r=this.createColumnsCalculator();if(e&&!t.getSetting("renderAllRows")){const t=n.getResultsFor("fullyVisible");e=this.areAllProposedVisibleRowsAlreadyRendered(t)}if(e&&!t.getSetting("renderAllColumns")){const t=r.getResultsFor("fullyVisible");e=this.areAllProposedVisibleColumnsAlreadyRendered(t)}return e||(this.rowsRenderCalculator=n.getResultsFor("rendered"),this.columnsRenderCalculator=r.getResultsFor("rendered")),this.rowsVisibleCalculator=n.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=r.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=n.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=r.getResultsFor("partiallyVisible"),e}createVisibleCalculators(){const e=this.createRowsCalculator(["fullyVisible","partiallyVisible"]),t=this.createColumnsCalculator(["fullyVisible","partiallyVisible"]);this.rowsVisibleCalculator=e.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=t.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=e.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=t.getResultsFor("partiallyVisible")}areAllProposedVisibleRowsAlreadyRendered(e){if(!this.rowsVisibleCalculator)return!1;let{startRow:t,endRow:n}=e;if(null===t&&null===n){if(!e.isVisibleInTrimmingContainer)return!0;t=this.rowsPartiallyVisibleCalculator.startRow,n=this.rowsPartiallyVisibleCalculator.endRow}const{startRow:r,endRow:i,rowStartOffset:o,rowEndOffset:s}=this.rowsRenderCalculator,a=this.wtSettings.getSetting("totalRows")-1,l=this.wtSettings.getSetting("viewportRowRenderingThreshold");return Number.isInteger(l)&&l>0?(t=Math.max(0,t-Math.min(o,l)),n=Math.min(a,n+Math.min(s,l))):"auto"===l&&(t=Math.max(0,t-Math.ceil(o/2)),n=Math.min(a,n+Math.ceil(s/2))),!(t<r||t===r&&t>0)&&!(n>i||n===i&&n<a)}areAllProposedVisibleColumnsAlreadyRendered(e){if(!this.columnsVisibleCalculator)return!1;let{startColumn:t,endColumn:n}=e;if(null===t&&null===n){if(!e.isVisibleInTrimmingContainer)return!0;t=this.columnsPartiallyVisibleCalculator.startColumn,n=this.columnsPartiallyVisibleCalculator.endColumn}const{startColumn:r,endColumn:i,columnStartOffset:o,columnEndOffset:s}=this.columnsRenderCalculator,a=this.wtSettings.getSetting("totalColumns")-1,l=this.wtSettings.getSetting("viewportColumnRenderingThreshold");return Number.isInteger(l)&&l>0?(t=Math.max(0,t-Math.min(o,l)),n=Math.min(a,n+Math.min(s,l))):"auto"===l&&(t=Math.max(0,t-Math.ceil(o/2)),n=Math.min(a,n+Math.ceil(s/2))),!(t<r||t===r&&t>0)&&!(n>i||n===i&&n<a)}resetHasOversizedColumnHeadersMarked(){nm(this.hasOversizedColumnHeadersMarked,((e,t,n)=>{n[t]=void 0}))}};function wR(e,t,n){yR(e,t),t.set(e,n)}function yR(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function vR(e,t){return e.get(SR(e,t))}function CR(e,t,n){return e.set(SR(e,t),n),n}function SR(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var RR=new WeakMap,ER=new WeakMap,bR=new WeakMap,TR=new WeakMap,NR=new WeakMap,AR=new WeakMap,MR=new WeakMap,IR=new WeakSet;class OR{constructor(e){var t,n;yR(t=this,n=IR),n.add(t),wR(this,RR,void 0),wR(this,ER,void 0),wR(this,bR,void 0),wR(this,TR,void 0),wR(this,NR,!0),wR(this,AR,{}),wR(this,MR,{}),CR(ER,this,e.rootTable.parentElement.parentElement),CR(TR,this,e.rootDocument)}isClassicTheme(){return vR(NR,this)}getCSSVariableValue(e){var t;if(vR(NR,this))return null;if(vR(AR,this)[`--ht-${e}`])return vR(AR,this)[`--ht-${e}`];const n=null!==(t=SR(IR,this,HR).call(this,`--ht-${e}`))&&void 0!==t?t:SR(IR,this,kR).call(this,`--ht-${e}`);return null!==n?(vR(AR,this)[`--ht-${e}`]=n,n):void 0}getStyleForTD(e){var t;return null===(t=vR(MR,this))||void 0===t?void 0:t.td[e]}getDefaultRowHeight(){if(vR(NR,this))return 23;const e=SR(IR,this,xR).call(this);return!e&&Ip(vR(ER,this),"ht-wrapper")?(Om(`The "${vR(RR,this)}" theme is enabled, but its stylesheets are missing or not imported correctly. Import the correct CSS files in order to use that theme.`),CR(NR,this,!0),this.useTheme(),23):e}areCellsBorderBox(){return"border-box"===this.getStyleForTD("box-sizing")}useTheme(e){if(!e)return SR(IR,this,_R).call(this),CR(NR,this,!0),void CR(RR,this,e||void 0);e&&e!==vR(RR,this)&&(vR(RR,this)&&SR(IR,this,FR).call(this),CR(RR,this,e),CR(NR,this,!1),SR(IR,this,PR).call(this),SR(IR,this,_R).call(this))}getThemeName(){return vR(RR,this)}removeClassNames(){Ip(vR(ER,this),vR(RR,this))&&xp(vR(ER,this),vR(RR,this))}}function xR(){const e=this.getCSSVariableValue("line-height"),t=this.getCSSVariableValue("cell-vertical-padding"),n=Math.ceil(parseFloat(this.getStyleForTD("border-bottom-width")));return null===e||null===t||isNaN(n)?null:e+2*t+n}function PR(){xp(vR(ER,this),/ht-theme-.*/g),Op(vR(ER,this),vR(RR,this))}function _R(){this.isClassicTheme()||CR(bR,this,getComputedStyle(vR(ER,this)));const e=SR(IR,this,LR).call(this,["box-sizing","border-bottom-width"]);vR(MR,this).td={...vR(MR,this).td,"box-sizing":e["box-sizing"],"border-bottom-width":e["border-bottom-width"]}}function LR(e){const t=vR(TR,this),n=vR(ER,this),r=t.createElement("table"),i=t.createElement("tbody"),o=t.createElement("tr"),s=t.createElement("tr"),a=t.createElement("td");s.appendChild(a),i.appendChild(o),i.appendChild(s),r.appendChild(i),n.appendChild(r);const l=getComputedStyle(a),h={};return e.forEach((e=>{h[e]=l.getPropertyValue(e)})),n.removeChild(r),h}function HR(e){const t=Math.ceil(parseFloat(SR(IR,this,kR).call(this,e)));return Number.isNaN(t)?null:t}function kR(e){const t=vR(bR,this).getPropertyValue(e);return""===t?null:t}function FR(){CR(MR,this,{}),CR(AR,this,{}),CR(NR,this,!0)}class DR extends KC{constructor(e,t){super(e,new pR(t)),this.stylesHandler=new OR(this.domBindings);const n=this.wtSettings.getSetting("facade",this);this.wtTable=new mR(this.getTableDao(),n,this.domBindings,this.wtSettings),this.wtViewport=new fR(this.getViewportDao(),this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.selectionManager=new jS(this.wtSettings.getSetting("selections")),this.wtEvent=new xv(n,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager),this.wtOverlays=new cR(this,n,this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.exportSettingsAsClassNames(),this.findOriginalHeaders()}exportSettingsAsClassNames(){const e=[],t=[];nm({rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},((n,r)=>{this.wtSettings.getSetting(r).length&&t.push(n),e.push(n)})),xp(this.wtTable.wtRootElement.parentNode,e),Op(this.wtTable.wtRootElement.parentNode,t)}getOverlayByName(e){var t;if(!DC.includes(e))return null;const n=e.replace(/_([a-z])/g,(e=>e[1].toUpperCase()));return null!==(t=this.wtOverlays[`${n}Overlay`])&&void 0!==t?t:null}getViewportDao(){const e=this;return{get wot(){return e},get topOverlayTrimmingContainer(){return e.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return e.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return e.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return e.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return e.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return e.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get bottomOverlay(){return e.wtOverlays.bottomOverlay}}}}class VR{constructor(e){e instanceof KC?this._wot=e:this._initFromSettings(e)}_initFromSettings(e){e.facade=e=>{const t=new VR(e);return()=>t},this._wot=new DR(e.table,e)}get guid(){return this._wot.guid}get rootDocument(){return this._wot.domBindings.rootDocument}get rootWindow(){return this._wot.domBindings.rootWindow}get wtSettings(){return this._wot.wtSettings}get cloneSource(){return this._wot.cloneSource}get cloneOverlay(){return this._wot.cloneOverlay}get selectionManager(){return this._wot.selectionManager}get wtViewport(){return this._wot.wtViewport}get wtOverlays(){return this._wot.wtOverlays}get wtTable(){return this._wot.wtTable}get wtEvent(){return this._wot.wtEvent}get wtScroll(){return this._wot.wtScroll}get drawn(){return this._wot.drawn}set drawn(e){this._wot.drawn=e}get activeOverlayName(){return this._wot.activeOverlayName}get drawInterrupted(){return this._wot.drawInterrupted}set drawInterrupted(e){this._wot.drawInterrupted=e}get lastMouseOver(){return this._wot.lastMouseOver}set lastMouseOver(e){this._wot.lastMouseOver=e}get momentumScrolling(){return this._wot.momentumScrolling}set momentumScrolling(e){this._wot.momentumScrolling=e}get touchApplied(){return this._wot.touchApplied}set touchApplied(e){this._wot.touchApplied=e}get domBindings(){return this._wot.domBindings}get eventListeners(){return this._wot.eventListeners}set eventListeners(e){this._wot.eventListeners=e}get eventManager(){return this._wot.eventManager}get stylesHandler(){return this._wot.stylesHandler}createCellCoords(e,t){return this._wot.createCellCoords(e,t)}createCellRange(e,t,n){return this._wot.createCellRange(e,t,n)}draw(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this._wot.draw(e),this}getCell(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this._wot.getCell(e,t)}scrollViewport(e,t,n){return this._wot.scrollViewport(e,t,n)}scrollViewportHorizontally(e,t){return this._wot.scrollViewportHorizontally(e,t)}scrollViewportVertically(e,t){return this._wot.scrollViewportVertically(e,t)}getViewport(){return this._wot.getViewport()}getOverlayName(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}getOverlayByName(e){return this._wot.getOverlayByName(e)}exportSettingsAsClassNames(){return this._wot.exportSettingsAsClassNames()}update(e,t){return this._wot.wtSettings.update(e,t),this}getSetting(e,t,n,r,i){return this._wot.wtSettings.getSetting(e,t,n,r,i)}hasSetting(e){return this._wot.wtSettings.hasSetting(e)}destroy(){this._wot.destroy()}}function UR(e){let{isShiftKey:t,isLeftClick:n,isRightClick:r,coords:i,selection:o,controller:s,cellCoordsFactory:a}=e;const l=o.isSelected()?o.getSelectedRange().current():null,h=o.isSelectedByCorner(),u=o.isSelectedByRowHeader();if(o.markSource("mouse"),t&&l)i.row>=0&&i.col>=0&&!s.cell?o.setRangeEnd(i):(h||u)&&i.row>=0&&i.col>=0&&!s.cell?o.setRangeEnd(a(i.row,i.col)):h&&i.row<0&&!s.column?o.setRangeEnd(a(l.to.row,i.col)):u&&i.col<0&&!s.row?o.setRangeEnd(a(i.row,l.to.col)):(!h&&!u&&i.col<0||h&&i.col<0)&&!s.row?o.selectRows(Math.max(l.from.row,0),i.row,i.col):(!h&&!u&&i.row<0||u&&i.row<0)&&!s.column&&o.selectColumns(Math.max(l.from.col,0),i.col,i.row);else{const e=!o.inInSelection(i),t=n||r&&e;i.row<0&&i.col>=0&&!s.column?t&&o.selectColumns(i.col,i.col,i.row):i.col<0&&i.row>=0&&!s.row?t&&o.selectRows(i.row,i.row,i.col):i.col>=0&&i.row>=0&&!s.cell?t&&o.setRangeStart(i):i.col<0&&i.row<0&&o.selectAll(!0,!0,{disableHeadersHighlight:!0,focusPosition:{row:0,col:0}})}o.markEndSource()}const BR=new Map([["mousedown",UR],["mouseover",function(e){let{isLeftClick:t,coords:n,selection:r,controller:i,cellCoordsFactory:o}=e;if(!t)return;const s=r.isSelectedByRowHeader(),a=r.isSelectedByColumnHeader(),l=r.tableProps.countCols(),h=r.tableProps.countRows();r.markSource("mouse"),a&&!i.column?r.setRangeEnd(o(h-1,n.col)):s&&!i.row?r.setRangeEnd(o(n.row,l-1)):i.cell||r.setRangeEnd(n),r.markEndSource()}],["touchstart",UR]]);function WR(e,t){let{coords:n,selection:r,controller:i,cellCoordsFactory:o}=t;BR.get(e.type)({coords:n,selection:r,controller:i,cellCoordsFactory:o,isShiftKey:e.shiftKey,isLeftClick:Im(e)||"touchstart"===e.type,isRightClick:Mm(e)})}const jR=new WeakMap,GR=Symbol("rootInstance");function zR(e){return e===GR}function $R(e){return jR.has(e)}function YR(e,t,n){KR(e,t),t.set(e,n)}function KR(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function XR(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function qR(e,t){return e.get(ZR(e,t))}function QR(e,t,n){return e.set(ZR(e,t),n),n}function ZR(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var JR=new WeakMap,eE=new WeakMap,tE=new WeakMap,nE=new WeakMap,rE=new WeakMap,iE=new WeakMap,oE=new WeakMap,sE=new WeakMap,aE=new WeakSet;function lE(){return parseInt(this.hot.rootElement.getAttribute(pp()[0]),10)}function hE(e){const t=ZR(aE,this,lE).call(this)+e;Pp(this.hot.rootElement,...pp(t))}function uE(){const e=this.hot.rootElement;this.hasVerticalScroll()?Op(e,"htHasScrollY"):xp(e,"htHasScrollY"),this.hasHorizontalScroll()?Op(e,"htHasScrollX"):xp(e,"htHasScrollX")}const cE=class{constructor(e){var t,n;KR(t=this,n=aE),n.add(t),XR(this,"hot",void 0),XR(this,"eventManager",void 0),XR(this,"settings",void 0),XR(this,"THEAD",void 0),XR(this,"TBODY",void 0),XR(this,"_wt",void 0),XR(this,"activeWt",void 0),YR(this,JR,0),YR(this,eE,0),XR(this,"postponedAdjustElementsSize",!1),YR(this,tE,!1),YR(this,nE,void 0),YR(this,rE,void 0),YR(this,iE,0),YR(this,oE,0),YR(this,sE,null),this.hot=e,this.eventManager=new Of(this.hot),this.settings=this.hot.getSettings(),this.createElements(),this.registerEvents(),this.initializeWalkontable()}render(){this.hot.isRenderSuspended()||(this.hot.runHooks("beforeRender",this.hot.forceFullRender),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize()),this._wt.draw(!this.hot.forceFullRender),ZR(aE,this,uE).call(this),this.hot.runHooks("afterRender",this.hot.forceFullRender),this.hot.forceFullRender=!1,this.hot.renderCall=!1)}adjustElementsSize(){this.hot.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize()}getCellAtCoords(e,t){const n=this._wt.getCell(e,t);return n<0?null:n}scrollViewport(e,t,n){return this._wt.scrollViewport(e,t,n)}scrollViewportHorizontally(e,t){return this._wt.scrollViewportHorizontally(e,t)}scrollViewportVertically(e,t){return this._wt.scrollViewportVertically(e,t)}createElements(){const{rootElement:e,rootDocument:t}=this.hot,n=e.getAttribute("style");n&&e.setAttribute("data-originalstyle",n),Op(e,"handsontable"),QR(rE,this,t.createElement("TABLE")),Op(qR(rE,this),"htCore"),this.hot.getSettings().tableClassName&&Op(qR(rE,this),this.hot.getSettings().tableClassName),this.settings.ariaTags&&(Pp(qR(rE,this),[["role","presentation"]]),Pp(e,[["role","treegrid"],dp(-1),pp(this.hot.countCols()),["aria-multiselectable","true"]])),this.THEAD=t.createElement("THEAD"),qR(rE,this).appendChild(this.THEAD),this.TBODY=t.createElement("TBODY"),qR(rE,this).appendChild(this.TBODY),this.hot.table=qR(rE,this),this.hot.container.insertBefore(qR(rE,this),this.hot.container.firstChild)}registerEvents(){const{rootElement:e,rootDocument:t,selection:n,rootWindow:r}=this.hot,i=t.documentElement;this.eventManager.addEventListener(e,"mousedown",(e=>{QR(tE,this,!0),this.isTextSelectionAllowed(e.target)||(Jp(r),e.preventDefault(),r.focus())})),this.eventManager.addEventListener(e,"mouseup",(()=>{QR(tE,this,!1)})),this.eventManager.addEventListener(e,"mousemove",(e=>{qR(tE,this)&&!this.isTextSelectionAllowed(e.target)&&(this.settings.fragmentSelection&&Jp(r),e.preventDefault())})),this.eventManager.addEventListener(i,"keyup",(e=>{n.isInProgress()&&!e.shiftKey&&n.finish()})),this.eventManager.addEventListener(i,"mouseup",(r=>{n.isInProgress()&&Im(r)&&n.finish(),QR(nE,this,!1);const i=lg(t.activeElement);ag(t.activeElement)&&!i||!i&&(n.isSelected()||n.isSelectedByAnyHeader()||e.contains(r.target)||Mm(r))||this.hot.unlisten()})),this.eventManager.addEventListener(i,"contextmenu",(e=>{n.isInProgress()&&Mm(e)&&(n.finish(),QR(nE,this,!1))})),this.eventManager.addEventListener(i,"touchend",(()=>{n.isInProgress()&&n.finish(),QR(nE,this,!1)})),this.eventManager.addEventListener(i,"mousedown",(n=>{const r=n.target,o=n.x||n.clientX,s=n.y||n.clientY;let a=n.target;if(qR(nE,this)||!e||!this.hot.view)return;const{holder:l}=this._wt.wtTable;if(a===l){const e=ng(t);if(t.elementFromPoint(o+e,s)!==l||t.elementFromPoint(o,s+e)!==l)return}else for(;a!==i;){if(null===a){if(n.isTargetWebComponent)break;return}if(a===e)return;a=a.parentNode}("function"==typeof this.settings.outsideClickDeselects?this.settings.outsideClickDeselects(r):this.settings.outsideClickDeselects)?this.hot.deselectCell():this.hot.destroyEditor(!1,!1)}));let o=Rp(r);for(;null!==o;)this.eventManager.addEventListener(o.document.documentElement,"click",(()=>{this.hot.unlisten()})),o=Rp(o);this.eventManager.addEventListener(qR(rE,this),"selectstart",(e=>{this.settings.fragmentSelection||ag(e.target)||e.preventDefault()}))}translateFromRenderableToVisualCoords(e){let{row:t,col:n}=e;return this.hot._createCellCoords(...this.translateFromRenderableToVisualIndex(t,n))}translateFromRenderableToVisualIndex(e,t){let n=e>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(e):e,r=t>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(t):t;return null===n&&(n=e),null===r&&(r=t),[n,r]}countRenderableIndexes(e,t){const n=Math.min(e.getNotTrimmedIndexesLength(),t),r=e.getNearestNotHiddenIndex(n-1,-1);return null===r?0:e.getRenderableFromVisualIndex(r)+1}countRenderableColumns(){return this.countRenderableIndexes(this.hot.columnIndexMapper,this.settings.maxCols)}countRenderableRows(){return this.countRenderableIndexes(this.hot.rowIndexMapper,this.settings.maxRows)}countNotHiddenRowIndexes(e,t){return this.countNotHiddenIndexes(e,t,this.hot.rowIndexMapper,this.countRenderableRows())}countNotHiddenColumnIndexes(e,t){return this.countNotHiddenIndexes(e,t,this.hot.columnIndexMapper,this.countRenderableColumns())}countNotHiddenIndexes(e,t,n,r){if(isNaN(e)||e<0)return 0;const i=n.getNearestNotHiddenIndex(e,t),o=n.getRenderableFromVisualIndex(i);if(!Number.isInteger(o))return 0;let s=0;return t<0?s=o+1:t>0&&(s=r-o),s}countNotHiddenFixedColumnsStart(){const e=this.hot.countCols(),t=Math.min(parseInt(this.settings.fixedColumnsStart,10),e)-1;return this.countNotHiddenColumnIndexes(t,-1)}countNotHiddenFixedRowsTop(){const e=this.hot.countRows(),t=Math.min(parseInt(this.settings.fixedRowsTop,10),e)-1;return this.countNotHiddenRowIndexes(t,-1)}countNotHiddenFixedRowsBottom(){const e=this.hot.countRows(),t=Math.max(e-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(t,1)}countRenderableColumnsInRange(e,t){let n=0;for(let r=e;r<=t;r++)null!==this.hot.columnIndexMapper.getRenderableFromVisualIndex(r)&&(n+=1);return n}countRenderableRowsInRange(e,t){let n=0;for(let r=e;r<=t;r++)null!==this.hot.rowIndexMapper.getRenderableFromVisualIndex(r)&&(n+=1);return n}getStylesHandler(){return this._wt.stylesHandler}getDefaultRowHeight(){return this._wt.stylesHandler.getDefaultRowHeight()}addClassNameToLicenseElement(e){var t;const n=null===(t=this.hot.rootElement.parentNode)||void 0===t?void 0:t.querySelector(".hot-display-license-info");n&&Op(n,e)}removeClassNameFromLicenseElement(e){var t;const n=null===(t=this.hot.rootElement.parentNode)||void 0===t?void 0:t.querySelector(".hot-display-license-info");n&&xp(n,e)}isMainTableNotFullyCoveredByOverlays(){const e=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),t=this.countNotHiddenFixedColumnsStart();return this.hot.countRenderedRows()>e&&this.hot.countRenderedCols()>t}initializeWalkontable(){const e={ariaTags:this.settings.ariaTags,rtlMode:this.hot.isRtl(),externalRowCalculator:this.hot.getPlugin("autoRowSize")&&this.hot.getPlugin("autoRowSize").isEnabled(),table:qR(rE,this),isDataViewInstance:()=>$R(this.hot),preventOverflow:()=>this.settings.preventOverflow,preventWheel:()=>this.settings.preventWheel,viewportColumnRenderingThreshold:()=>this.settings.viewportColumnRenderingThreshold,viewportRowRenderingThreshold:()=>this.settings.viewportRowRenderingThreshold,data:(e,t)=>this.hot.getDataAtCell(...this.translateFromRenderableToVisualIndex(e,t)),totalRows:()=>this.countRenderableRows(),totalColumns:()=>this.countRenderableColumns(),fixedColumnsStart:()=>this.countNotHiddenFixedColumnsStart(),fixedRowsTop:()=>this.countNotHiddenFixedRowsTop(),fixedRowsBottom:()=>this.countNotHiddenFixedRowsBottom(),shouldRenderInlineStartOverlay:()=>this.settings.fixedColumnsStart>0||e.rowHeaders().length>0,shouldRenderTopOverlay:()=>this.settings.fixedRowsTop>0||e.columnHeaders().length>0,shouldRenderBottomOverlay:()=>this.settings.fixedRowsBottom>0,minSpareRows:()=>this.settings.minSpareRows,renderAllRows:this.settings.renderAllRows,renderAllColumns:this.settings.renderAllColumns,rowHeaders:()=>{const e=[];return this.hot.hasRowHeaders()&&e.push(((e,t)=>{const n=e>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(e):e;this.appendRowHeader(n,t)})),this.hot.runHooks("afterGetRowHeaderRenderers",e),QR(eE,this,e.length),this.hot.getSettings().ariaTags&&ZR(aE,this,lE).call(this)===this.hot.countCols()&&ZR(aE,this,hE).call(this,qR(eE,this)),e},columnHeaders:()=>{const e=[];return this.hot.hasColHeaders()&&e.push(((e,t)=>{const n=e>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(e):e;this.appendColHeader(n,t)})),this.hot.runHooks("afterGetColumnHeaderRenderers",e),QR(JR,this,e.length),e},columnWidth:e=>{const t=this.hot.columnIndexMapper.getVisualFromRenderableIndex(e);return this.hot.getColWidth(null===t?e:t)},rowHeight:e=>{const t=this.hot.rowIndexMapper.getVisualFromRenderableIndex(e);return this.hot.getRowHeight(null===t?e:t)},rowHeightByOverlayName:(e,t)=>{const n=this.hot.rowIndexMapper.getVisualFromRenderableIndex(e),r=null===n?e:n;return this.hot.runHooks("modifyRowHeightByOverlayName",this.hot.getRowHeight(r),r,t)},cellRenderer:(e,t,n)=>{const[r,i]=this.translateFromRenderableToVisualIndex(e,t),o=this.hot.runHooks("modifyGetCellCoords",r,i,!1,"meta");let s=r,a=i;Array.isArray(o)&&([s,a]=o);const l=this.hot.getCellMeta(s,a),h=this.hot.colToProp(a);let u=this.hot.getDataAtRowProp(s,h);this.hot.hasHook("beforeValueRender")&&(u=this.hot.runHooks("beforeValueRender",u,l)),this.hot.runHooks("beforeRenderer",n,r,i,h,u,l),this.hot.getCellRenderer(l)(this.hot,n,r,i,h,u,l),this.hot.runHooks("afterRenderer",n,r,i,h,u,l)},selections:this.hot.selection.highlight,hideBorderOnMouseDownOver:()=>this.settings.fragmentSelection,onWindowResize:()=>{this.hot&&!this.hot.isDestroyed&&this.hot.refreshDimensions()},onContainerElementResize:()=>{this.hot&&!this.hot.isDestroyed&&Vp(this.hot.rootElement)&&this.hot.refreshDimensions()},onCellMouseDown:(e,t,n,r)=>{const i=this.translateFromRenderableToVisualCoords(t),o={row:!1,column:!1,cell:!1};this.hot.listen(),this.activeWt=r,QR(nE,this,!0),QR(sE,this,{x:e.clientX,y:e.clientY}),this.hot.runHooks("beforeOnCellMouseDown",e,i,n,o),Am(e)||(WR(e,{coords:i,selection:this.hot.selection,controller:o,cellCoordsFactory:(e,t)=>this.hot._createCellCoords(e,t)}),this.hot.runHooks("afterOnCellMouseDown",e,i,n),this.activeWt=this._wt)},onCellContextMenu:(e,t,n,r)=>{const i=this.translateFromRenderableToVisualCoords(t);this.activeWt=r,QR(nE,this,!1),this.hot.selection.isInProgress()&&this.hot.selection.finish(),this.hot.runHooks("beforeOnCellContextMenu",e,i,n),Am(e)||(this.hot.runHooks("afterOnCellContextMenu",e,i,n),this.activeWt=this._wt)},onCellMouseOut:(e,t,n,r)=>{const i=this.translateFromRenderableToVisualCoords(t);this.activeWt=r,this.hot.runHooks("beforeOnCellMouseOut",e,i,n),Am(e)||(this.hot.runHooks("afterOnCellMouseOut",e,i,n),this.activeWt=this._wt)},onCellMouseOver:(e,t,n,r)=>{const i=this.translateFromRenderableToVisualCoords(t),o={row:!1,column:!1,cell:!1};this.activeWt=r,this.hot.runHooks("beforeOnCellMouseOver",e,i,n,o),Am(e)||(!qR(nE,this)||qR(sE,this)&&qR(sE,this).x===e.clientX&&qR(sE,this).y===e.clientY||WR(e,{coords:i,selection:this.hot.selection,controller:o,cellCoordsFactory:(e,t)=>this.hot._createCellCoords(e,t)}),this.hot.runHooks("afterOnCellMouseOver",e,i,n),this.activeWt=this._wt,QR(sE,this,null))},onCellMouseUp:(e,t,n,r)=>{const i=this.translateFromRenderableToVisualCoords(t);this.activeWt=r,this.hot.runHooks("beforeOnCellMouseUp",e,i,n),Am(e)||this.hot.isDestroyed||(this.hot.runHooks("afterOnCellMouseUp",e,i,n),this.activeWt=this._wt)},onCellCornerMouseDown:e=>{e.preventDefault(),this.hot.runHooks("afterOnCellCornerMouseDown",e)},onCellCornerDblClick:e=>{e.preventDefault(),this.hot.runHooks("afterOnCellCornerDblClick",e)},beforeDraw:(e,t)=>this.beforeRender(e,t),onDraw:e=>this.afterRender(e),onBeforeViewportScrollVertically:(e,t)=>{const n=this.hot.rowIndexMapper,r=e<0;let i=e;return r||(i=n.getVisualFromRenderableIndex(e),null!==i)?(i=this.hot.runHooks("beforeViewportScrollVertically",i,t),this.hot.runHooks("beforeViewportScroll"),r?i:n.getRenderableFromVisualIndex(i)):e},onBeforeViewportScrollHorizontally:(e,t)=>{const n=this.hot.columnIndexMapper,r=e<0;let i=e;return r||(i=n.getVisualFromRenderableIndex(e),null!==i)?(i=this.hot.runHooks("beforeViewportScrollHorizontally",i,t),this.hot.runHooks("beforeViewportScroll"),r?i:n.getRenderableFromVisualIndex(i)):e},onScrollVertically:()=>{this.hot.runHooks("afterScrollVertically"),this.hot.runHooks("afterScroll")},onScrollHorizontally:()=>{this.hot.runHooks("afterScrollHorizontally"),this.hot.runHooks("afterScroll")},onBeforeRemoveCellClassNames:()=>this.hot.runHooks("beforeRemoveCellClassNames"),onBeforeHighlightingRowHeader:(e,t,n)=>{const r=this.hot.rowIndexMapper,i=e<0;let o=e;i||(o=r.getVisualFromRenderableIndex(e));const s=this.hot.runHooks("beforeHighlightingRowHeader",o,t,n);return i?s:r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(s,1))},onBeforeHighlightingColumnHeader:(e,t,n)=>{const r=this.hot.columnIndexMapper,i=e<0;let o=e;i||(o=r.getVisualFromRenderableIndex(e));const s=this.hot.runHooks("beforeHighlightingColumnHeader",o,t,n);return i?s:r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(s,1))},onAfterDrawSelection:(e,t,n)=>{let r;const[i,o]=this.translateFromRenderableToVisualIndex(e,t),s=this.hot.selection.getSelectedRange();if(s.size()>0){const e=s.peekByIndex(null!=n?n:0);r=[e.from.row,e.from.col,e.to.row,e.to.col]}return this.hot.runHooks("afterDrawSelection",i,o,r,n)},onBeforeDrawBorders:(e,t)=>{const[n,r,i,o]=e,s=[this.hot.rowIndexMapper.getVisualFromRenderableIndex(n),this.hot.columnIndexMapper.getVisualFromRenderableIndex(r),this.hot.rowIndexMapper.getVisualFromRenderableIndex(i),this.hot.columnIndexMapper.getVisualFromRenderableIndex(o)];return this.hot.runHooks("beforeDrawBorders",s,t)},onBeforeTouchScroll:()=>this.hot.runHooks("beforeTouchScroll"),onAfterMomentumScroll:()=>this.hot.runHooks("afterMomentumScroll"),onModifyRowHeaderWidth:e=>this.hot.runHooks("modifyRowHeaderWidth",e),onModifyGetCellCoords:(e,t,n,r)=>{const i=this.hot.rowIndexMapper,o=this.hot.columnIndexMapper,s=t>=0?o.getVisualFromRenderableIndex(t):t,a=e>=0?i.getVisualFromRenderableIndex(e):e,l=this.hot.runHooks("modifyGetCellCoords",a,s,n,r);if(Array.isArray(l)){const[e,t,n,r]=l;return[e>=0?i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(e,1)):e,t>=0?o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(t,1)):t,n>=0?i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(n,-1)):n,r>=0?o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(r,-1)):r]}},onModifyGetCoordsElement:(e,t)=>{const n=this.hot.rowIndexMapper,r=this.hot.columnIndexMapper,i=t>=0?r.getVisualFromRenderableIndex(t):t,o=e>=0?n.getVisualFromRenderableIndex(e):e,s=this.hot.runHooks("modifyGetCoordsElement",o,i);if(Array.isArray(s)){const[e,t]=s;return[e>=0?n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(e,1)):e,t>=0?r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(t,1)):t]}},viewportRowCalculatorOverride:e=>{let t=this.settings.viewportRowRenderingOffset;if("auto"===t&&this.settings.fixedRowsTop&&(t=10),t>0||"auto"===t){const n=this.countRenderableRows(),r=e.startRow,i=e.endRow;if("number"==typeof t)e.startRow=Math.max(r-t,0),e.endRow=Math.min(i+t,n-1);else if("auto"===t){const t=Math.max(1,Math.ceil(i/n*12));e.startRow=Math.max(r-t,0),e.endRow=Math.min(i+t,n-1)}}this.hot.runHooks("afterViewportRowCalculatorOverride",e)},viewportColumnCalculatorOverride:e=>{let t=this.settings.viewportColumnRenderingOffset;if("auto"===t&&this.settings.fixedColumnsStart&&(t=10),t>0||"auto"===t){const n=this.countRenderableColumns(),r=e.startColumn,i=e.endColumn;if("number"==typeof t&&(e.startColumn=Math.max(r-t,0),e.endColumn=Math.min(i+t,n-1)),"auto"===t){const t=Math.max(1,Math.ceil(i/n*6));e.startColumn=Math.max(r-t,0),e.endColumn=Math.min(i+t,n-1)}}this.hot.runHooks("afterViewportColumnCalculatorOverride",e)},rowHeaderWidth:()=>this.settings.rowHeaderWidth,columnHeaderHeight:()=>{const e=this.hot.runHooks("modifyColumnHeaderHeight");return this.settings.columnHeaderHeight||e}};this.hot.runHooks("beforeInitWalkontable",e),this._wt=new VR(e),this.activeWt=this._wt;const t=this._wt.wtTable.spreader,{width:n,height:r}=this.hot.rootElement.getBoundingClientRect();this.setLastSize(n,r),this.eventManager.addEventListener(t,"mousedown",(e=>{e.target===t&&3===e.which&&e.stopPropagation()})),this.eventManager.addEventListener(t,"contextmenu",(e=>{e.target===t&&3===e.which&&e.stopPropagation()})),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"click",(()=>{this.settings.observeDOMVisibility&&this._wt.drawInterrupted&&(this.hot.forceFullRender=!0,this.render())}))}isTextSelectionAllowed(e){if(ag(e))return!0;const t=Tp(e,this._wt.wtTable.spreader);return!(!0!==this.settings.fragmentSelection||!t)||(!("cell"!==this.settings.fragmentSelection||!this.isSelectedOnlyCell()||!t)||!(this.settings.fragmentSelection||!this.isCellEdited()||!this.isSelectedOnlyCell()))}isMouseDown(){return qR(nE,this)}isSelectedOnlyCell(){var e,t;return null!==(e=null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.isSingleCell())&&void 0!==e&&e}isCellEdited(){const e=this.hot.getActiveEditor();return e&&e.isOpened()}beforeRender(e,t){e&&this.hot.runHooks("beforeViewRender",this.hot.forceFullRender,t)}afterRender(e){e&&this.hot.runHooks("afterViewRender",this.hot.forceFullRender)}appendRowHeader(e,t){if(t.firstChild){const n=t.firstChild;if(!Ip(n,"relative"))return Hp(t),void this.appendRowHeader(e,t);this.updateCellHeader(n.querySelector(".rowHeader"),e,this.hot.getRowHeader)}else{const{rootDocument:n,getRowHeader:r}=this.hot,i=n.createElement("div"),o=n.createElement("span");i.className="relative",o.className="rowHeader",this.updateCellHeader(o,e,r),i.appendChild(o),t.appendChild(i)}this.hot.runHooks("afterGetRowHeader",e,t)}appendColHeader(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.hot.getColHeader,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;const i=()=>{const t=e>=0?this.hot.getColumnMeta(e).headerClassName:null;return t?t.split(" "):[]};if(t.firstChild){const o=t.firstChild;Ip(o,"relative")?(this.updateCellHeader(o.querySelector(".colHeader"),e,n,r),o.className="",Op(o,["relative",...i()])):(Hp(t),this.appendColHeader(e,t,n,r))}else{const{rootDocument:o}=this.hot,s=o.createElement("div"),a=o.createElement("span"),l=i();s.classList.add("relative",...l),a.className="colHeader",this.settings.ariaTags&&(Pp(s,"role","presentation"),Pp(a,"role","presentation")),this.updateCellHeader(a,e,n,r),s.appendChild(a),t.appendChild(s)}this.hot.runHooks("afterGetColHeader",e,t,r)}updateCellHeader(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=t;const o=this._wt.wtOverlays.getParentOverlay(e)||this._wt;e.parentNode&&(Ip(e,"colHeader")?i=o.wtTable.columnFilter.sourceToRendered(t):Ip(e,"rowHeader")&&(i=o.wtTable.rowFilter.sourceToRendered(t))),i>-1?Fp(e,n(t,r)):(Dp(e,String.fromCharCode(160)),Op(e,"cornerHeader"))}maximumVisibleElementWidth(e){const t=this._wt.wtViewport.getWorkspaceWidth()-e;return t>0?t:0}maximumVisibleElementHeight(e){const t=this._wt.wtViewport.getWorkspaceHeight()-e;return t>0?t:0}setLastSize(e,t){QR(iE,this,e),QR(oE,this,t)}getLastSize(){return{width:qR(iE,this),height:qR(oE,this)}}getFirstRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;const e=this.hot.rowIndexMapper,t=e.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedRow());return e.getNearestNotHiddenIndex(null!=t?t:0,1)}getLastRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;const e=this.hot.rowIndexMapper,t=e.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedRow());return e.getNearestNotHiddenIndex(null!=t?t:this.hot.countRows()-1,-1)}getFirstRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;const e=this.hot.columnIndexMapper,t=e.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedColumn());return e.getNearestNotHiddenIndex(null!=t?t:0,1)}getLastRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;const e=this.hot.columnIndexMapper,t=e.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedColumn());return e.getNearestNotHiddenIndex(null!=t?t:this.hot.countCols()-1,-1)}getFirstFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleRow())}getLastFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleRow())}getFirstFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleColumn())}getLastFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleColumn())}getFirstPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleRow())}getLastPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleRow())}getFirstPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleColumn())}getLastPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleColumn())}getColumnHeadersCount(){return qR(JR,this)}getRowHeadersCount(){return qR(eE,this)}getViewportWidth(){return this._wt.wtViewport.getViewportWidth()}getWorkspaceWidth(){return this._wt.wtViewport.getWorkspaceWidth()}getViewportHeight(){return this._wt.wtViewport.getViewportHeight()}getWorkspaceHeight(){return this._wt.wtViewport.getWorkspaceHeight()}getElementOverlayName(e){var t;return(null!==(t=this._wt.wtOverlays.getParentOverlay(e))&&void 0!==t?t:this._wt).wtTable.name}getOverlayByName(e){return this._wt.getOverlayByName(e)}getActiveOverlayName(){return this._wt.activeOverlayName}isVisible(){return this._wt.wtTable.isVisible()}hasVerticalScroll(){return this._wt.wtViewport.hasVerticalScroll()}hasHorizontalScroll(){return this._wt.wtViewport.hasHorizontalScroll()}getTableWidth(){return this._wt.wtTable.getWidth()}getTableHeight(){return this._wt.wtTable.getHeight()}getTableOffset(){return this._wt.wtViewport.getWorkspaceOffset()}getRowHeaderWidth(){return this._wt.wtViewport.getRowHeaderWidth()}getColumnHeaderHeight(){return this._wt.wtViewport.getColumnHeaderHeight()}isVerticallyScrollableByWindow(){return this._wt.wtViewport.isVerticallyScrollableByWindow()}isHorizontallyScrollableByWindow(){return this._wt.wtViewport.isHorizontallyScrollableByWindow()}destroy(){this._wt.destroy(),this.eventManager.destroy()}};var dE=wu,pE=Ge,gE=sn,mE=Ss;Ti({target:"Iterator",proto:!0,real:!0},{every:function(e){gE(this),pE(e);var t=mE(this),n=0;return!dE(t,(function(t,r){if(!e(t,n++))return r()}),{IS_RECORD:!0,INTERRUPTED:!0}).stopped}});function fE(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=e;const r=[];return Array.isArray(e)&&Array.isArray(e[0])||(n=[e]),n.forEach(((e,n)=>{Array.isArray(e)?e.forEach(((e,i)=>{r.push([n+t,i,e])})):Object.keys(e).forEach((i=>{r.push([n+t,i,e[i]])}))})),r}function wE(e){let t=0;return Array.isArray(e)&&(e[0]&&Array.isArray(e[0])?t=e[0].length:e[0]&&em(e[0])&&(t=im(e[0]))),t}function yE(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const vE=class{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];yE(this,"hot",void 0),yE(this,"data",void 0),yE(this,"dataType","array"),yE(this,"colToProp",(()=>{})),yE(this,"propToCol",(()=>{})),this.hot=e,this.data=t}modifyRowData(e){let t;return this.hot.hasHook("modifyRowData")&&(t=this.hot.runHooks("modifyRowData",e)),void 0===t||Number.isInteger(t)?this.data[e]:t}getData(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.data&&0!==this.data.length?this.getByRange(null,null,e):this.data}setData(e){this.data=e}getAtColumn(e){const t=[];return Vd(this.data,((n,r)=>{const i=this.getAtCell(r,e);t.push(i)})),t}getAtRow(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const i=void 0===t&&void 0===n,{dataDotNotation:o}=this.hot.getSettings();let s=null,a=null;if(s=this.modifyRowData(e),Array.isArray(s))a=[],i?s.forEach(((t,n)=>{a[n]=this.getAtPhysicalCell(e,n,s)})):$w(t,n,(n=>{a[n-t]=this.getAtPhysicalCell(e,n,s)}));else if(em(s)||pg(s))if(a=r?[]:{},!i||r){const i=0,l=this.countFirstRowKeys()-1;$w(i,l,(h=>{const u=this.colToProp(h);if(h>=(t||i)&&h<=(n||l)&&!Number.isInteger(u)){const t=this.getAtPhysicalCell(e,u,s);r?a.push(t):o?rm(a,u,t):a[u]=t}}))}else nm(s,((t,n)=>{const r=this.getAtPhysicalCell(e,n,s);o?rm(a,n,r):a[n]=r}));return a}setAtCell(e,t,n){if(!(e>=this.countRows()||t>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){const r=om(n);this.hot.runHooks("modifySourceData",e,t,r,"set"),r.isTouched()&&(n=r.value)}["__proto__","constructor","prototype"].includes(e)||(Number.isInteger(t)?this.data[e][t]=n:rm(this.data[e],t,n))}}getAtPhysicalCell(e,t,n){let r=null;if(n)if("string"==typeof t){const{dataDotNotation:e}=this.hot.getSettings();r=e?function(e,t){const n=t.split(".");let r=e;return nm(n,(e=>{if(r=r[e],void 0===r)return r=void 0,!1})),r}(n,t):n[t]}else r="function"==typeof t?t(n):n[t];if(this.hot.hasHook("modifySourceData")){const n=om(r);this.hot.runHooks("modifySourceData",e,t,n,"get"),n.isTouched()&&(r=n.value)}return r}getAtCell(e,t){const n=this.modifyRowData(e);return this.getAtPhysicalCell(e,this.colToProp(t),n)}getByRange(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=!1,i=null,o=null,s=null,a=null;null===e||null===t?(r=!0,i=0,s=this.countRows()-1):(i=Math.min(e.row,t.row),o=Math.min(e.col,t.col),s=Math.max(e.row,t.row),a=Math.max(e.col,t.col));const l=[];return $w(i,s,(e=>{l.push(r?this.getAtRow(e,void 0,void 0,n):this.getAtRow(e,o,a,n))})),l}countRows(){if(this.hot.hasHook("modifySourceLength")){const e=this.hot.runHooks("modifySourceLength");if(Number.isInteger(e))return e}return this.data.length}countFirstRowKeys(){return wE(this.data)}destroy(){this.data=null,this.hot=null}};var CE=wu,SE=Ge,RE=sn,EE=Ss;function bE(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Ti({target:"Iterator",proto:!0,real:!0},{some:function(e){RE(this),SE(e);var t=EE(this),n=0;return CE(t,(function(t,r){if(e(t,n++))return r()}),{IS_RECORD:!0,INTERRUPTED:!0}).stopped}});class TE{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;bE(this,"indexedValues",[]),bE(this,"initValueOrFn",void 0),this.initValueOrFn=e}getValues(){return this.indexedValues}getValueAtIndex(e){const t=this.indexedValues;if(e<t.length)return t[e]}setValues(e){this.indexedValues=e.slice(),this.runLocalHooks("change")}setValueAtIndex(e,t){return e<this.indexedValues.length&&(this.indexedValues[e]=t,this.runLocalHooks("change"),!0)}clear(){this.setDefaultValues()}getLength(){return this.getValues().length}setDefaultValues(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,pg(this.initValueOrFn)?$w(e-1,(e=>this.indexedValues.push(this.initValueOrFn(e)))):$w(e-1,(()=>this.indexedValues.push(this.initValueOrFn))),this.runLocalHooks("change")}init(e){return this.setDefaultValues(e),this.runLocalHooks("init"),this}insert(){this.runLocalHooks("change")}remove(){this.runLocalHooks("change")}destroy(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}function NE(e,t,n,r){const i=n.length?n[0]:void 0;return[...e.slice(0,i),...n.map(((e,t)=>pg(r)?r(e,t):r)),...void 0===i?[]:e.slice(i)]}function AE(e,t){return Fd(e,((e,n)=>!1===t.includes(n)))}Zg(TE,cS);class ME extends TE{insert(e,t){this.indexedValues=NE(this.indexedValues,0,t,this.initValueOrFn),super.insert(e,t)}remove(e){this.indexedValues=AE(this.indexedValues,e),super.remove(e)}}class IE extends ME{constructor(){super(arguments.length>0&&void 0!==arguments[0]&&arguments[0])}getHiddenIndexes(){return kd(this.getValues(),((e,t,n)=>(t&&e.push(n),e)),[])}}function OE(e,t,n){return[...e.slice(0,t),...n,...e.slice(t)]}function xE(e,t){return Fd(e,(e=>!1===t.includes(e)))}function PE(e,t){return Dd(e,(e=>e-t.filter((t=>t<e)).length))}function _E(e,t){const n=t[0],r=t.length;return Dd(e,(e=>e>=n?e+r:e))}function LE(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class HE extends TE{constructor(){super(...arguments),LE(this,"orderOfIndexes",[])}getValues(){return this.orderOfIndexes.map((e=>this.indexedValues[e]))}setValues(e){this.orderOfIndexes=[...Array(e.length).keys()],super.setValues(e)}setValueAtIndex(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.orderOfIndexes.length;return e<this.indexedValues.length&&(this.indexedValues[e]=t,!1===this.orderOfIndexes.includes(e)&&this.orderOfIndexes.splice(n,0,e),this.runLocalHooks("change"),!0)}clearValue(e){this.orderOfIndexes=xE(this.orderOfIndexes,[e]),pg(this.initValueOrFn)?super.setValueAtIndex(e,this.initValueOrFn(e)):super.setValueAtIndex(e,this.initValueOrFn)}getLength(){return this.orderOfIndexes.length}setDefaultValues(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,super.setDefaultValues(e)}insert(e,t){this.indexedValues=NE(this.indexedValues,0,t,this.initValueOrFn),this.orderOfIndexes=_E(this.orderOfIndexes,t),super.insert(e,t)}remove(e){this.indexedValues=AE(this.indexedValues,e),this.orderOfIndexes=xE(this.orderOfIndexes,e),this.orderOfIndexes=PE(this.orderOfIndexes,e),super.remove(e)}getEntries(){return this.orderOfIndexes.map((e=>[e,this.getValueAtIndex(e)]))}}class kE extends ME{constructor(){super(arguments.length>0&&void 0!==arguments[0]&&arguments[0])}getTrimmedIndexes(){return kd(this.getValues(),((e,t,n)=>(t&&e.push(n),e)),[])}}const FE=new Map([["indexesSequence",{getListWithInsertedItems:OE,getListWithRemovedItems:xE}],["physicallyIndexed",{getListWithInsertedItems:NE,getListWithRemovedItems:AE}]]),DE=e=>{if(!1===FE.has(e))throw new Error(`Alter strategy with ID '${e}' does not exist.`);return FE.get(e)};class VE extends TE{constructor(){super((e=>e))}insert(e,t){const n=_E(this.indexedValues,t);this.indexedValues=OE(n,e,t),super.insert(e,t)}remove(e){const t=xE(this.indexedValues,e);this.indexedValues=PE(t,e),super.remove(e)}}const UE=new Map([["hiding",IE],["index",TE],["linkedPhysicalIndexToValue",HE],["physicalIndexToValue",ME],["trimming",kE]]);function BE(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class WE{constructor(){BE(this,"collection",new Map)}register(e,t){!1===this.collection.has(e)&&(this.collection.set(e,t),t.addLocalHook("change",(()=>this.runLocalHooks("change",t))))}unregister(e){const t=this.collection.get(e);Gd(t)&&(t.destroy(),this.collection.delete(e),this.runLocalHooks("change",t))}unregisterAll(){this.collection.forEach(((e,t)=>this.unregister(t))),this.collection.clear()}get(e){return zd(e)?Array.from(this.collection.values()):this.collection.get(e)}getLength(){return this.collection.size}removeFromEvery(e){this.collection.forEach((t=>{t.remove(e)}))}insertToEvery(e,t){this.collection.forEach((n=>{n.insert(e,t)}))}initEvery(e){this.collection.forEach((t=>{t.init(e)}))}}function jE(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Zg(WE,cS);class GE extends WE{constructor(e,t){super(),jE(this,"mergedValuesCache",[]),jE(this,"aggregationFunction",void 0),jE(this,"fallbackValue",void 0),this.aggregationFunction=e,this.fallbackValue=t}getMergedValues(){if(!0===(!(arguments.length>0&&void 0!==arguments[0])||arguments[0]))return this.mergedValuesCache;if(0===this.getLength())return[];const e=Dd(this.get(),(e=>e.getValues())),t=[],n=Gd(e[0])&&e[0].length||0;for(let r=0;r<n;r+=1){const n=[];for(let t=0;t<this.getLength();t+=1)n.push(e[t][r]);t.push(n)}return Dd(t,this.aggregationFunction)}getMergedValueAtIndex(e,t){const n=this.getMergedValues(t)[e];return Gd(n)?n:this.fallbackValue}updateCache(){this.mergedValuesCache=this.getMergedValues(!1)}}function zE(e,t,n){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,n)}function $E(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var YE=new WeakMap;class KE{constructor(){zE(this,YE,[])}subscribe(e){var t,n;return this.addLocalHook("change",e),this._write((n=this,(t=YE).get($E(t,n)))),this}unsubscribe(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}_write(e){return e.length>0&&this.runLocalHooks("change",e),this}_writeInitialChanges(e){var t,n,r;n=this,r=e,(t=YE).set($E(t,n),r)}}function XE(e,t){const n=[];let r=0,i=0;for(;r<e.length&&i<t.length;r++,i++)e[r]!==t[i]&&n.push({op:"replace",index:i,oldValue:e[r],newValue:t[i]});for(;r<t.length;r++)n.push({op:"insert",index:r,oldValue:void 0,newValue:t[r]});for(;i<e.length;i++)n.push({op:"remove",index:i,oldValue:e[i],newValue:void 0});return n}function qE(e,t,n){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,n)}function QE(e,t){return e.get(JE(e,t))}function ZE(e,t,n){return e.set(JE(e,t),n),n}function JE(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}Zg(KE,cS);var eb=new WeakMap,tb=new WeakMap,nb=new WeakMap,rb=new WeakMap,ib=new WeakMap;class ob{constructor(){let{initialIndexValue:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};qE(this,eb,new Set),qE(this,tb,[]),qE(this,nb,[]),qE(this,rb,!1),qE(this,ib,!1),ZE(ib,this,null!=e&&e)}createObserver(){const e=new KE;return QE(eb,this).add(e),e.addLocalHook("unsubscribe",(()=>{QE(eb,this).delete(e)})),e._writeInitialChanges(XE(QE(tb,this),QE(nb,this))),e}emit(e){let t=QE(nb,this);QE(rb,this)&&QE(tb,this).length===e.length||(0===e.length?e=new Array(t.length).fill(QE(ib,this)):ZE(tb,this,new Array(e.length).fill(QE(ib,this))),QE(rb,this)||(ZE(rb,this,!0),t=QE(tb,this)));const n=XE(t,e);QE(eb,this).forEach((e=>e._write(n))),ZE(nb,this,e)}}function sb(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class ab{constructor(){sb(this,"indexesSequence",new VE),sb(this,"trimmingMapsCollection",new GE((e=>e.some((e=>!0===e))),!1)),sb(this,"hidingMapsCollection",new GE((e=>e.some((e=>!0===e))),!1)),sb(this,"variousMapsCollection",new WE),sb(this,"hidingChangesObservable",new ob({initialIndexValue:!1})),sb(this,"notTrimmedIndexesCache",[]),sb(this,"notHiddenIndexesCache",[]),sb(this,"isBatched",!1),sb(this,"indexesSequenceChanged",!1),sb(this,"indexesChangeSource",void 0),sb(this,"trimmedIndexesChanged",!1),sb(this,"hiddenIndexesChanged",!1),sb(this,"renderablePhysicalIndexesCache",[]),sb(this,"fromPhysicalToVisualIndexesCache",new Map),sb(this,"fromVisualToRenderableIndexesCache",new Map),this.indexesSequence.addLocalHook("change",(()=>{this.indexesSequenceChanged=!0,this.updateCache(),this.runLocalHooks("indexesSequenceChange",this.indexesChangeSource),this.runLocalHooks("change",this.indexesSequence,null)})),this.trimmingMapsCollection.addLocalHook("change",(e=>{this.trimmedIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.trimmingMapsCollection)})),this.hidingMapsCollection.addLocalHook("change",(e=>{this.hiddenIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.hidingMapsCollection)})),this.variousMapsCollection.addLocalHook("change",(e=>{this.runLocalHooks("change",e,this.variousMapsCollection)}))}suspendOperations(){this.isBatched=!0}resumeOperations(){this.isBatched=!1,this.updateCache()}createChangesObserver(e){if("hiding"!==e)throw new Error(`Unsupported index map type "${e}".`);return this.hidingChangesObservable.createObserver()}createAndRegisterIndexMap(e,t,n){return this.registerMap(e,function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!UE.has(e))throw new Error(`The provided map type ("${e}") does not exist.`);return new(UE.get(e))(t)}(t,n))}registerMap(e,t){if(this.trimmingMapsCollection.get(e)||this.hidingMapsCollection.get(e)||this.variousMapsCollection.get(e))throw Error(`Map with name "${e}" has been already registered.`);t instanceof kE?this.trimmingMapsCollection.register(e,t):t instanceof IE?this.hidingMapsCollection.register(e,t):this.variousMapsCollection.register(e,t);const n=this.getNumberOfIndexes();return n>0&&t.init(n),t}unregisterMap(e){this.trimmingMapsCollection.unregister(e),this.hidingMapsCollection.unregister(e),this.variousMapsCollection.unregister(e)}unregisterAll(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}getPhysicalFromVisualIndex(e){const t=this.notTrimmedIndexesCache[e];return Gd(t)?t:null}getPhysicalFromRenderableIndex(e){const t=this.renderablePhysicalIndexesCache[e];return Gd(t)?t:null}getVisualFromPhysicalIndex(e){const t=this.fromPhysicalToVisualIndexesCache.get(e);return Gd(t)?t:null}getVisualFromRenderableIndex(e){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(e))}getRenderableFromVisualIndex(e){const t=this.fromVisualToRenderableIndexesCache.get(e);return Gd(t)?t:null}getNearestNotHiddenIndex(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(null===this.getPhysicalFromVisualIndex(e))return null;if(this.fromVisualToRenderableIndexesCache.has(e))return e;const r=Array.from(this.fromVisualToRenderableIndexesCache.keys());let i=-1;return i=t>0?r.findIndex((t=>t>e)):r.reverse().findIndex((t=>t<e)),-1===i?n?this.getNearestNotHiddenIndex(e,-t,!1):null:r[i]}initToLength(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=[...new Array(e).keys()],this.notHiddenIndexesCache=[...new Array(e).keys()],this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(e),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(e),this.variousMapsCollection.initEvery(e),this.resumeOperations(),this.runLocalHooks("init")}fitToLength(e){const t=this.getNumberOfIndexes();if(e<t){const t=[...Array(this.getNumberOfIndexes()-e).keys()].map((t=>t+e));this.removeIndexes(t)}else this.insertIndexes(t,e-t)}getIndexesSequence(){return this.indexesSequence.getValues()}setIndexesSequence(e){void 0===this.indexesChangeSource&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(e),"update"===this.indexesChangeSource&&(this.indexesChangeSource=void 0)}getNotTrimmedIndexes(){if(!0===(!(arguments.length>0&&void 0!==arguments[0])||arguments[0]))return this.notTrimmedIndexesCache;return this.getIndexesSequence().filter((e=>!1===this.isTrimmed(e)))}getNotTrimmedIndexesLength(){return this.getNotTrimmedIndexes().length}getNotHiddenIndexes(){if(!0===(!(arguments.length>0&&void 0!==arguments[0])||arguments[0]))return this.notHiddenIndexesCache;return this.getIndexesSequence().filter((e=>!1===this.isHidden(e)))}getNotHiddenIndexesLength(){return this.getNotHiddenIndexes().length}getRenderableIndexes(){if(!0===(!(arguments.length>0&&void 0!==arguments[0])||arguments[0]))return this.renderablePhysicalIndexesCache;return this.getNotTrimmedIndexes().filter((e=>!1===this.isHidden(e)))}getRenderableIndexesLength(){return this.getRenderableIndexes().length}getNumberOfIndexes(){return this.getIndexesSequence().length}moveIndexes(e,t){"number"==typeof e&&(e=[e]);const n=Dd(e,(e=>this.getPhysicalFromVisualIndex(e))),r=this.getNotTrimmedIndexesLength(),i=e.length,o=xE(this.getIndexesSequence(),n),s=o.filter((e=>!1===this.isTrimmed(e)));let a=o.indexOf(s[s.length-1])+1;if(t+i<r){const e=s[t];a=o.indexOf(e)}this.indexesChangeSource="move",this.setIndexesSequence(OE(o,a,n)),this.indexesChangeSource=void 0}isTrimmed(e){return this.trimmingMapsCollection.getMergedValueAtIndex(e)}isHidden(e){return this.hidingMapsCollection.getMergedValueAtIndex(e)}insertIndexes(e,t){const n=this.getNotTrimmedIndexes()[e],r=Gd(n)?n:this.getNumberOfIndexes(),i=this.getIndexesSequence().includes(n)?this.getIndexesSequence().indexOf(n):this.getNumberOfIndexes(),o=Dd(new Array(t).fill(r),((e,t)=>e+t));this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(i,o),this.indexesChangeSource=void 0,this.trimmingMapsCollection.insertToEvery(i,o),this.hidingMapsCollection.insertToEvery(i,o),this.variousMapsCollection.insertToEvery(i,o),this.resumeOperations()}removeIndexes(e){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(e),this.hidingMapsCollection.removeFromEvery(e),this.variousMapsCollection.removeFromEvery(e),this.resumeOperations()}updateCache(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(!0===e||!1===this.isBatched&&!0===t)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}cacheFromPhysicalToVisualIndexes(){const e=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(let t=0;t<e;t+=1){const e=this.getPhysicalFromVisualIndex(t);this.fromPhysicalToVisualIndexesCache.set(e,t)}}cacheFromVisualToRenderableIndexes(){const e=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(let t=0;t<e;t+=1){const e=this.getPhysicalFromRenderableIndex(t),n=this.getVisualFromPhysicalIndex(e);this.fromVisualToRenderableIndexesCache.set(n,t)}}}function lb(e){const t=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(e);return t?`${t[1].toLowerCase()}-${t[2].toUpperCase()}`:e}function hb(e){Gd(e)&&xm(Wd`Language with code "${e}" was not found. You should register particular language\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`)}Zg(ab,cS);const{register:ub,getValues:cb}=yf("phraseFormatters");ub("pluralize",(function(e,t){return Array.isArray(e)&&Number.isInteger(t)?e[t]:e}));const db="ContextMenu:items",pb=`${db}.noItems`,gb=`${db}.insertRowAbove`,mb=`${db}.insertRowBelow`,fb=`${db}.insertColumnOnTheLeft`,wb=`${db}.insertColumnOnTheRight`,yb=`${db}.removeRow`,vb=`${db}.removeColumn`,Cb=`${db}.undo`,Sb=`${db}.redo`,Rb=`${db}.readOnly`,Eb=`${db}.clearColumn`,bb=`${db}.copy`,Tb=`${db}.copyWithHeaders`,Nb=`${db}.copyWithGroupHeaders`,Ab=`${db}.copyHeadersOnly`,Mb=`${db}.cut`,Ib=`${db}.freezeColumn`,Ob=`${db}.unfreezeColumn`,xb=`${db}.mergeCells`,Pb=`${db}.unmergeCells`,_b=`${db}.addComment`,Lb=`${db}.editComment`,Hb=`${db}.removeComment`,kb=`${db}.readOnlyComment`,Fb=`${db}.align`,Db=`${db}.align.left`,Vb=`${db}.align.center`,Ub=`${db}.align.right`,Bb=`${db}.align.justify`,Wb=`${db}.align.top`,jb=`${db}.align.middle`,Gb=`${db}.align.bottom`,zb=`${db}.borders`,$b=`${db}.borders.top`,Yb=`${db}.borders.right`,Kb=`${db}.borders.bottom`,Xb=`${db}.borders.left`,qb=`${db}.borders.remove`,Qb=`${db}.nestedHeaders.insertChildRow`,Zb=`${db}.nestedHeaders.detachFromParent`,Jb=`${db}.hideColumn`,eT=`${db}.showColumn`,tT=`${db}.hideRow`,nT=`${db}.showRow`,rT="Filters:",iT=`${rT}conditions`,oT=`${iT}.none`,sT=`${iT}.isEmpty`,aT=`${iT}.isNotEmpty`,lT=`${iT}.isEqualTo`,hT=`${iT}.isNotEqualTo`,uT=`${iT}.beginsWith`,cT=`${iT}.endsWith`,dT=`${iT}.contains`,pT=`${iT}.doesNotContain`,gT=`${iT}.byValue`,mT=`${iT}.greaterThan`,fT=`${iT}.greaterThanOrEqualTo`,wT=`${iT}.lessThan`,yT=`${iT}.lessThanOrEqualTo`,vT=`${iT}.isBetween`,CT=`${iT}.isNotBetween`,ST=`${iT}.after`,RT=`${iT}.before`,ET=`${iT}.today`,bT=`${iT}.tomorrow`,TT=`${iT}.yesterday`,NT=`${rT}labels.filterByCondition`,AT=`${rT}labels.filterByValue`,MT=`${rT}labels.conjunction`,IT=`${rT}labels.disjunction`,OT=`${rT}values.blankCells`,xT=`${rT}buttons.selectAll`,PT=`${rT}buttons.clear`,_T=`${rT}buttons.ok`,LT=`${rT}buttons.cancel`,HT=`${rT}buttons.placeholder.search`,kT=`${rT}buttons.placeholder.value`,FT=`${rT}buttons.placeholder.secondValue`,DT="CheckboxRenderer:",VT=`${DT}checked`,UT=`${DT}unchecked`,BT=Object.freeze(Object.defineProperty({__proto__:null,CHECKBOX_CHECKED:VT,CHECKBOX_RENDERER_NAMESPACE:DT,CHECKBOX_UNCHECKED:UT,CONTEXTMENU_ITEMS_ADD_COMMENT:_b,CONTEXTMENU_ITEMS_ALIGNMENT:Fb,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:Gb,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:Vb,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:Bb,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:Db,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:jb,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:Ub,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:Wb,CONTEXTMENU_ITEMS_BORDERS:zb,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:Kb,CONTEXTMENU_ITEMS_BORDERS_LEFT:Xb,CONTEXTMENU_ITEMS_BORDERS_RIGHT:Yb,CONTEXTMENU_ITEMS_BORDERS_TOP:$b,CONTEXTMENU_ITEMS_CLEAR_COLUMN:Eb,CONTEXTMENU_ITEMS_COPY:bb,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:Ab,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:Nb,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:Tb,CONTEXTMENU_ITEMS_CUT:Mb,CONTEXTMENU_ITEMS_EDIT_COMMENT:Lb,CONTEXTMENU_ITEMS_FREEZE_COLUMN:Ib,CONTEXTMENU_ITEMS_HIDE_COLUMN:Jb,CONTEXTMENU_ITEMS_HIDE_ROW:tT,CONTEXTMENU_ITEMS_INSERT_LEFT:fb,CONTEXTMENU_ITEMS_INSERT_RIGHT:wb,CONTEXTMENU_ITEMS_MERGE_CELLS:xb,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:Zb,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:Qb,CONTEXTMENU_ITEMS_NO_ITEMS:pb,CONTEXTMENU_ITEMS_READ_ONLY:Rb,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:kb,CONTEXTMENU_ITEMS_REDO:Sb,CONTEXTMENU_ITEMS_REMOVE_BORDERS:qb,CONTEXTMENU_ITEMS_REMOVE_COLUMN:vb,CONTEXTMENU_ITEMS_REMOVE_COMMENT:Hb,CONTEXTMENU_ITEMS_REMOVE_ROW:yb,CONTEXTMENU_ITEMS_ROW_ABOVE:gb,CONTEXTMENU_ITEMS_ROW_BELOW:mb,CONTEXTMENU_ITEMS_SHOW_COLUMN:eT,CONTEXTMENU_ITEMS_SHOW_ROW:nT,CONTEXTMENU_ITEMS_UNDO:Cb,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:Ob,CONTEXTMENU_ITEMS_UNMERGE_CELLS:Pb,CONTEXT_MENU_ITEMS_NAMESPACE:db,FILTERS_BUTTONS_CANCEL:LT,FILTERS_BUTTONS_CLEAR:PT,FILTERS_BUTTONS_OK:_T,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:HT,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:FT,FILTERS_BUTTONS_PLACEHOLDER_VALUE:kT,FILTERS_BUTTONS_SELECT_ALL:xT,FILTERS_CONDITIONS_AFTER:ST,FILTERS_CONDITIONS_BEFORE:RT,FILTERS_CONDITIONS_BEGINS_WITH:uT,FILTERS_CONDITIONS_BETWEEN:vT,FILTERS_CONDITIONS_BY_VALUE:gT,FILTERS_CONDITIONS_CONTAINS:dT,FILTERS_CONDITIONS_EMPTY:sT,FILTERS_CONDITIONS_ENDS_WITH:cT,FILTERS_CONDITIONS_EQUAL:lT,FILTERS_CONDITIONS_GREATER_THAN:mT,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:fT,FILTERS_CONDITIONS_LESS_THAN:wT,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:yT,FILTERS_CONDITIONS_NAMESPACE:iT,FILTERS_CONDITIONS_NONE:oT,FILTERS_CONDITIONS_NOT_BETWEEN:CT,FILTERS_CONDITIONS_NOT_CONTAIN:pT,FILTERS_CONDITIONS_NOT_EMPTY:aT,FILTERS_CONDITIONS_NOT_EQUAL:hT,FILTERS_CONDITIONS_TODAY:ET,FILTERS_CONDITIONS_TOMORROW:bT,FILTERS_CONDITIONS_YESTERDAY:TT,FILTERS_DIVS_FILTER_BY_CONDITION:NT,FILTERS_DIVS_FILTER_BY_VALUE:AT,FILTERS_LABELS_CONJUNCTION:MT,FILTERS_LABELS_DISJUNCTION:IT,FILTERS_NAMESPACE:rT,FILTERS_VALUES_BLANK_CELLS:OT},Symbol.toStringTag,{value:"Module"})),WT={languageCode:"en-US",[pb]:"No available options",[gb]:"Insert row above",[mb]:"Insert row below",[fb]:"Insert column left",[wb]:"Insert column right",[yb]:["Remove row","Remove rows"],[vb]:["Remove column","Remove columns"],[Cb]:"Undo",[Sb]:"Redo",[Rb]:"Read only",[Eb]:"Clear column",[Fb]:"Alignment",[Db]:"Left",[Vb]:"Center",[Ub]:"Right",[Bb]:"Justify",[Wb]:"Top",[jb]:"Middle",[Gb]:"Bottom",[Ib]:"Freeze column",[Ob]:"Unfreeze column",[zb]:"Borders",[$b]:"Top",[Yb]:"Right",[Kb]:"Bottom",[Xb]:"Left",[qb]:"Remove border(s)",[_b]:"Add comment",[Lb]:"Edit comment",[Hb]:"Delete comment",[kb]:"Read-only comment",[xb]:"Merge cells",[Pb]:"Unmerge cells",[bb]:"Copy",[Tb]:["Copy with header","Copy with headers"],[Nb]:["Copy with group header","Copy with group headers"],[Ab]:["Copy header only","Copy headers only"],[Mb]:"Cut",[Qb]:"Insert child row",[Zb]:"Detach from parent",[Jb]:["Hide column","Hide columns"],[eT]:["Show column","Show columns"],[tT]:["Hide row","Hide rows"],[nT]:["Show row","Show rows"],[oT]:"None",[sT]:"Is empty",[aT]:"Is not empty",[lT]:"Is equal to",[hT]:"Is not equal to",[uT]:"Begins with",[cT]:"Ends with",[dT]:"Contains",[pT]:"Does not contain",[mT]:"Greater than",[fT]:"Greater than or equal to",[wT]:"Less than",[yT]:"Less than or equal to",[vT]:"Is between",[CT]:"Is not between",[ST]:"After",[RT]:"Before",[ET]:"Today",[bT]:"Tomorrow",[TT]:"Yesterday",[OT]:"Blank cells",[NT]:"Filter by condition",[AT]:"Filter by value",[MT]:"And",[IT]:"Or",[xT]:"Select all",[PT]:"Clear",[_T]:"OK",[LT]:"Cancel",[HT]:"Search",[kT]:"Value",[FT]:"Second value",[VT]:"Checked",[UT]:"Unchecked"},jT=BT,GT=WT.languageCode,{register:zT,getItem:$T,hasItem:YT,getValues:KT}=yf("languagesDictionaries");function XT(e,t){let n=e,r=t;return em(e)&&(r=e,n=r.languageCode),function(e,t){e!==GT&&(n=t,nm($T(GT),((e,t)=>{zd(n[t])&&(n[t]=e)})));var n}(n,r),zT(n,qg(r)),qg(r)}function qT(e){return QT(e)?qg($T(e)):null}function QT(e){return YT(e)}function ZT(e,t,n){const r=qT(e);if(null===r)return null;const i=r[t];if(zd(i))return null;const o=function(e,t){let n=e;return Vd(function(){return cb()}(),(r=>{n=r(e,t)})),n}(i,n);return Array.isArray(o)?o[0]:o}function JT(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}XT(WT);const eN=class extends pS{constructor(e,t){super(e,null),JT(this,"visualCellRange",null),this.visualCellRange=t||null,this.commit()}add(e){return null===this.visualCellRange?this.visualCellRange=this.settings.createCellRange(e):this.visualCellRange.expand(e),this}clear(){return this.visualCellRange=null,super.clear()}trimToVisibleCellsRangeOnly(e){let{from:t,to:n}=e,r=this.getNearestNotHiddenCoords(t,1),i=this.getNearestNotHiddenCoords(n,-1);return null===r||null===i?null:((r.row>i.row||r.col>i.col)&&(r=t,i=n),this.settings.createCellRange(r,r,i))}getNearestNotHiddenCoords(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t;const r=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper,e.row,t);if(null===r)return null;const i=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper,e.col,n);return null===i?null:this.settings.createCellCoords(r,i)}getNearestNotHiddenIndex(e,t,n){return t<0?t:e.getNearestNotHiddenIndex(t,n)}commit(){if(null===this.visualCellRange)return this;const e=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return this.cellRange=null===e?null:this.createRenderableCellRange(e.from,e.to),this}syncWith(e){const t=e.from.clone().normalize(),n="N-S"===e.getVerticalDirection()?1:-1,r="W-E"===e.getHorizontalDirection()?1:-1,i=this.settings.visualToRenderableCoords(this.visualCellRange.highlight);let o=null;if(null!==i&&null!==i.col&&null!==i.row||(o=this.getNearestNotHiddenCoords(t,n,r)),null!==o&&e.overlaps(o)){const t=e.highlight.clone();if(t.row>=0&&(t.row=o.row),t.col>=0&&(t.col=o.col),null===this.cellRange){const e=this.settings.visualToRenderableCoords(t);this.cellRange=this.settings.createCellRange(e)}e.setHighlight(t)}return"focus"===this.settings.selectionType&&null!==i&&null===o&&e.setHighlight(this.visualCellRange.highlight),this}getCorners(){const{from:e,to:t}=this.cellRange;return[Math.min(e.row,t.row),Math.min(e.col,t.col),Math.max(e.row,t.row),Math.max(e.col,t.col)]}getVisualCorners(){const e=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),t=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[e.row,e.col,t.row,t.col]}createRenderableCellRange(e,t){const n=this.settings.visualToRenderableCoords(e),r=this.settings.visualToRenderableCoords(t);return null===n.row||null===n.col||null===r.row||null===r.col?null:this.settings.createCellRange(n,n,r)}};function tN(e){let{activeHeaderClassName:t,...n}=e;return new eN({className:t,...n,selectionType:gS})}function nN(e){let{areaCornerVisible:t,...n}=e;return new eN({className:"area",createLayers:!0,border:{width:1,color:"#4b89ff",cornerVisible:t},...n,selectionType:fS})}function rN(e){let{...t}=e;return new eN({className:"highlight",...t,selectionType:fS})}function iN(e){let{columnClassName:t,...n}=e;return new eN({className:t,...n,selectionType:"column"})}function oN(e){let{headerClassName:t,...n}=e;return new eN({className:t,...n,selectionType:mS})}function sN(e){let{rowClassName:t,...n}=e;return new eN({className:t,...n,selectionType:"row"})}function aN(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function lN(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function hN(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var uN=new WeakSet;class cN{constructor(e){aN(this,uN),lN(this,"options",void 0),lN(this,"layerLevel",0),lN(this,"focus",void 0),lN(this,"fill",void 0),lN(this,"layeredAreas",new Map),lN(this,"areas",new Map),lN(this,"rowHeaders",new Map),lN(this,"columnHeaders",new Map),lN(this,"activeRowHeaders",new Map),lN(this,"activeColumnHeaders",new Map),lN(this,"activeCornerHeaders",new Map),lN(this,"rowHighlights",new Map),lN(this,"columnHighlights",new Map),lN(this,"customSelections",[]),this.options=e,this.focus=function(e){let{cellCornerVisible:t,...n}=e;return new eN({className:"current",headerAttributes:[["aria-selected","true"]],border:{width:2,color:"#4b89ff",cornerVisible:t},...n,selectionType:wS})}(e),this.fill=function(e){let{...t}=e;return new eN({className:"fill",border:{width:1,color:"#ff0000"},...t,selectionType:"fill"})}(e)}isEnabledFor(e,t){let n=e;e===wS&&(n="current");let r=this.options.disabledCellSelection(t.row,t.col);return"string"==typeof r&&(r=[r]),!1===r||Array.isArray(r)&&!r.includes(n)}useLayerLevel(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.layerLevel=e,this}getFocus(){return this.focus}getFill(){return this.fill}createLayeredArea(){return hN(uN,this,dN).call(this,this.layeredAreas,nN)}getLayeredAreas(){return[...this.layeredAreas.values()]}createArea(){return hN(uN,this,dN).call(this,this.areas,rN)}getAreas(){return[...this.areas.values()]}createRowHeader(){return hN(uN,this,dN).call(this,this.rowHeaders,oN)}getRowHeaders(){return[...this.rowHeaders.values()]}createColumnHeader(){return hN(uN,this,dN).call(this,this.columnHeaders,oN)}getColumnHeaders(){return[...this.columnHeaders.values()]}createActiveRowHeader(){return hN(uN,this,dN).call(this,this.activeRowHeaders,tN)}getActiveRowHeaders(){return[...this.activeRowHeaders.values()]}createActiveColumnHeader(){return hN(uN,this,dN).call(this,this.activeColumnHeaders,tN)}getActiveColumnHeaders(){return[...this.activeColumnHeaders.values()]}createActiveCornerHeader(){return hN(uN,this,dN).call(this,this.activeCornerHeaders,tN)}getActiveCornerHeaders(){return[...this.activeCornerHeaders.values()]}createRowHighlight(){return hN(uN,this,dN).call(this,this.rowHighlights,sN)}getRowHighlights(){return[...this.rowHighlights.values()]}createColumnHighlight(){return hN(uN,this,dN).call(this,this.columnHighlights,iN)}getColumnHighlights(){return[...this.columnHighlights.values()]}getCustomSelections(){return[...this.customSelections.values()]}addCustomSelection(e){this.customSelections.push(function(e){let{border:t,visualCellRange:n,...r}=e;return new eN({...t,...r,selectionType:"custom-selection"},n)}({...this.options,...e}))}clear(){this.focus.clear(),this.fill.clear(),Vd(this.areas.values(),(e=>{e.clear()})),Vd(this.layeredAreas.values(),(e=>{e.clear()})),Vd(this.rowHeaders.values(),(e=>{e.clear()})),Vd(this.columnHeaders.values(),(e=>{e.clear()})),Vd(this.activeRowHeaders.values(),(e=>{e.clear()})),Vd(this.activeColumnHeaders.values(),(e=>{e.clear()})),Vd(this.activeCornerHeaders.values(),(e=>{e.clear()})),Vd(this.rowHighlights.values(),(e=>{e.clear()})),Vd(this.columnHighlights.values(),(e=>{e.clear()}))}[Symbol.iterator](){return[this.focus,this.fill,...this.areas.values(),...this.layeredAreas.values(),...this.rowHeaders.values(),...this.columnHeaders.values(),...this.activeRowHeaders.values(),...this.activeColumnHeaders.values(),...this.activeCornerHeaders.values(),...this.rowHighlights.values(),...this.columnHighlights.values(),...this.customSelections][Symbol.iterator]()}}function dN(e,t){const n=this.layerLevel;if(e.has(n))return e.get(n);const r=t({layerLevel:n,...this.options});return e.set(n,r),r}const pN=cN;function gN(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class mN{constructor(e){gN(this,"ranges",[]),gN(this,"createCellRange",void 0),this.createCellRange=e}isEmpty(){return 0===this.size()}set(e){return this.clear(),this.ranges.push(this.createCellRange(e)),this}add(e){return this.ranges.push(this.createCellRange(e)),this}pop(){return this.ranges.pop(),this}current(){return this.peekByIndex(this.size()-1)}previous(){return this.peekByIndex(this.size()-2)}includes(e){return this.ranges.some((t=>t.includes(e)))}clear(){return this.ranges.length=0,this}size(){return this.ranges.length}peekByIndex(){let e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return t>=0&&t<this.size()&&(e=this.ranges[t]),e}[Symbol.iterator](){return this.ranges[Symbol.iterator]()}}const fN=mN;function wN(e,t,n){yN(e,t),t.set(e,n)}function yN(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function vN(e,t){return e.get(SN(e,t))}function CN(e,t,n){return e.set(SN(e,t),n),n}function SN(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var RN=new WeakMap,EN=new WeakMap,bN=new WeakMap,TN=new WeakSet;class NN{constructor(e,t){var n,r;yN(n=this,r=TN),r.add(n),wN(this,RN,void 0),wN(this,EN,void 0),wN(this,bN,{x:0,y:0}),CN(RN,this,e),CN(EN,this,t)}transformStart(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=vN(EN,this).createCellCoords(e,t);let i=vN(RN,this).current().highlight;const o=vN(EN,this).visualToRenderableCoords(i);let s=0,a=0;if(this.runLocalHooks("beforeTransformStart",r),null!==o.row&&null!==o.col){const{width:e,height:t}=SN(TN,this,MN).call(this),{row:o,col:l}=SN(TN,this,xN).call(this,i),h=vN(EN,this).fixedRowsBottom(),u=vN(EN,this).minSpareRows(),c=vN(EN,this).minSpareCols(),d=vN(EN,this).autoWrapRow(),p=vN(EN,this).autoWrapCol(),g=vN(EN,this).createCellCoords(o+r.row,l+r.col);if(g.row>=t){const r=om(n&&u>0&&0===h),i=g.col+1,o=vN(EN,this).createCellCoords(g.row-t,i>=e?i-e:i);this.runLocalHooks("beforeColumnWrap",r,SN(TN,this,PN).call(this,o),i>=e),r.value?this.runLocalHooks("insertRowRequire",vN(EN,this).countRenderableRows()):p&&g.assign(o)}else if(g.row<0){const n=om(p),r=g.col-1,i=vN(EN,this).createCellCoords(t+g.row,r<0?e+r:r);this.runLocalHooks("beforeColumnWrap",n,SN(TN,this,PN).call(this,i),r<0),p&&g.assign(i)}if(g.col>=e){const r=om(n&&c>0),i=g.row+1,o=vN(EN,this).createCellCoords(i>=t?i-t:i,g.col-e);this.runLocalHooks("beforeRowWrap",r,SN(TN,this,PN).call(this,o),i>=t),r.value?this.runLocalHooks("insertColRequire",vN(EN,this).countRenderableColumns()):d&&g.assign(o)}else if(g.col<0){const n=om(d),r=g.row-1,i=vN(EN,this).createCellCoords(r<0?t+r:r,e+g.col);this.runLocalHooks("beforeRowWrap",n,SN(TN,this,PN).call(this,i),r<0),d&&g.assign(i)}const{rowDir:m,colDir:f}=SN(TN,this,AN).call(this,g);s=m,a=f,i=SN(TN,this,PN).call(this,g)}return this.runLocalHooks("afterTransformStart",i,s,a),i}transformEnd(e,t){const n=vN(EN,this).createCellCoords(e,t),r=vN(RN,this).current(),i=vN(EN,this).visualToRenderableCoords(r.highlight),o=SN(TN,this,IN).call(this,r.to.row,r.from.row),s=SN(TN,this,ON).call(this,r.to.col,r.from.col),a=r.to.clone();let l=0,h=0;if(this.runLocalHooks("beforeTransformEnd",n),null!==i.row&&null!==i.col&&null!==o&&null!==s){const{row:e,col:t}=SN(TN,this,xN).call(this,r.highlight),i=vN(EN,this).createCellCoords(o+n.row,s+n.col),u=r.getTopStartCorner(),c=r.getTopEndCorner(),d=r.getBottomEndCorner();if(n.col<0&&s>=t&&i.col<t){const e=i.col-t;i.col=SN(TN,this,ON).call(this,u.col,c.col)+e}else if(n.col>0&&s<=t&&i.col>t){const e=SN(TN,this,ON).call(this,c.col,u.col),t=Math.max(i.col-e,1);i.col=e+t}if(n.row<0&&o>=e&&i.row<e){const t=i.row-e;i.row=SN(TN,this,IN).call(this,u.row,d.row)+t}else if(n.row>0&&o<=e&&i.row>e){const e=SN(TN,this,IN).call(this,d.row,u.row),t=Math.max(i.row-e,1);i.row=e+t}const{rowDir:p,colDir:g}=SN(TN,this,AN).call(this,i);l=p,h=g;const m=SN(TN,this,PN).call(this,i);0===n.row&&0!==n.col?a.col=m.col:0!==n.row&&0===n.col?a.row=m.row:(a.row=m.row,a.col=m.col)}return this.runLocalHooks("afterTransformEnd",a,l,h),a}setOffsetSize(e){let{x:t,y:n}=e;CN(bN,this,{x:t,y:n})}resetOffsetSize(){CN(bN,this,{x:0,y:0})}}function AN(e){const{width:t,height:n}=SN(TN,this,MN).call(this);let r=0,i=0;return e.row<0?(r=-1,e.row=0):e.row>0&&e.row>=n&&(r=1,e.row=n-1),e.col<0?(i=-1,e.col=0):e.col>0&&e.col>=t&&(i=1,e.col=t-1),{rowDir:r,colDir:i}}function MN(){return{width:vN(bN,this).x+vN(EN,this).countRenderableColumns(),height:vN(bN,this).y+vN(EN,this).countRenderableRows()}}function IN(e,t){const n=vN(EN,this).findFirstNonHiddenRenderableRow(e,t);return null===n?null:vN(bN,this).y+n}function ON(e,t){const n=vN(EN,this).findFirstNonHiddenRenderableColumn(e,t);return null===n?null:vN(bN,this).x+n}function xN(e){const{row:t,col:n}=vN(EN,this).visualToRenderableCoords(e);if(null===t||null===n)throw new Error("Renderable coords are not visible.");return vN(EN,this).createCellCoords(vN(bN,this).y+t,vN(bN,this).x+n)}function PN(e){const t=e.clone();return t.col=e.col-vN(bN,this).x,t.row=e.row-vN(bN,this).y,vN(EN,this).renderableToVisualCoords(t)}Zg(NN,cS);const _N=NN,LN=[3,2],HN=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],kN=Symbol("root"),FN=Symbol("child");function DN(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:kN;if(t!==kN&&t!==FN)throw new Error("The second argument is used internally only and cannot be overwritten.");const n=Array.isArray(e),r=t===kN;let i=0;if(n){const t=e[0];if(0===e.length)i=1;else if(r&&t instanceof fv)i=3;else if(r&&Array.isArray(t))i=DN(t,FN);else if(e.length>=2&&e.length<=4){const t=!e.some(((e,t)=>!HN[t].includes(typeof e)));t&&(i=2)}}return i}function VN(e){let{createCellCoords:t,createCellRange:n,keepDirection:r=!1,propToCol:i}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!LN.includes(e))throw new Error("Unsupported selection ranges schema type was provided.");return function(o){const s=3===e;let a=s?o.from.row:o[0],l=s?o.from.col:o[1],h=s?o.to.row:o[2],u=s?o.to.col:o[3];if("function"==typeof i&&("string"==typeof l&&(l=i(l)),"string"==typeof u&&(u=i(u))),zd(h)&&(h=a),zd(u)&&(u=l),!r){const e=a,t=l,n=h,r=u;a=Math.min(e,n),l=Math.min(t,r),h=Math.max(e,n),u=Math.max(t,r)}const c=t(a,l),d=t(h,u);return n(c,c,d)}}function UN(e,t,n){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,n)}function BN(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function WN(e,t){return e.get(GN(e,t))}function jN(e,t,n){return e.set(GN(e,t),n),n}function GN(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var zN=new WeakMap,$N=new WeakMap,YN=new WeakMap,KN=new WeakMap,XN=new WeakMap,qN=new WeakMap;class QN{constructor(e,t){var n=this;BN(this,"settings",void 0),BN(this,"tableProps",void 0),BN(this,"inProgress",!1),BN(this,"selectedRange",new fN(((e,t,n)=>this.tableProps.createCellRange(e,t,n)))),BN(this,"highlight",void 0),UN(this,zN,void 0),UN(this,$N,void 0),BN(this,"selectedByRowHeader",new Set),BN(this,"selectedByColumnHeader",new Set),UN(this,YN,!1),UN(this,KN,!1),UN(this,XN,"unknown"),UN(this,qN,-1),this.settings=e,this.tableProps=t,this.highlight=new pN({headerClassName:e.currentHeaderClassName,activeHeaderClassName:e.activeHeaderClassName,rowClassName:e.currentRowClassName,columnClassName:e.currentColClassName,cellAttributes:[["aria-selected","true"]],rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,disabledCellSelection:(e,t)=>this.tableProps.isDisabledCellSelection(e,t),cellCornerVisible:function(){return n.isCellCornerVisible(...arguments)},areaCornerVisible:function(){return n.isAreaCornerVisible(...arguments)},visualToRenderableCoords:e=>this.tableProps.visualToRenderableCoords(e),renderableToVisualCoords:e=>this.tableProps.renderableToVisualCoords(e),createCellCoords:(e,t)=>this.tableProps.createCellCoords(e,t),createCellRange:(e,t,n)=>this.tableProps.createCellRange(e,t,n)}),jN(zN,this,new _N(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>this.tableProps.countRenderableRows(),countRenderableColumns:()=>this.tableProps.countRenderableColumns(),visualToRenderableCoords:e=>this.tableProps.visualToRenderableCoords(e),renderableToVisualCoords:e=>this.tableProps.renderableToVisualCoords(e),findFirstNonHiddenRenderableRow:function(){return n.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return n.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(e,t)=>this.tableProps.createCellCoords(e,t),fixedRowsBottom:()=>e.fixedRowsBottom,minSpareRows:()=>e.minSpareRows,minSpareCols:()=>e.minSpareCols,autoWrapRow:()=>e.autoWrapRow,autoWrapCol:()=>e.autoWrapCol})),jN($N,this,new _N(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>{const e=this.selectedRange.current();return this.tableProps.countRenderableRowsInRange(0,e.getOuterBottomEndCorner().row)},countRenderableColumns:()=>{const e=this.selectedRange.current();return this.tableProps.countRenderableColumnsInRange(0,e.getOuterBottomEndCorner().col)},visualToRenderableCoords:e=>this.tableProps.visualToRenderableCoords(e),renderableToVisualCoords:e=>this.tableProps.renderableToVisualCoords(e),findFirstNonHiddenRenderableRow:function(){return n.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return n.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(e,t)=>this.tableProps.createCellCoords(e,t),fixedRowsBottom:()=>0,minSpareRows:()=>0,minSpareCols:()=>0,autoWrapRow:()=>!0,autoWrapCol:()=>!0})),WN(zN,this).addLocalHook("beforeTransformStart",(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.runLocalHooks("beforeModifyTransformStart",...t)})),WN(zN,this).addLocalHook("afterTransformStart",(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.runLocalHooks("afterModifyTransformStart",...t)})),WN(zN,this).addLocalHook("beforeTransformEnd",(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.runLocalHooks("beforeModifyTransformEnd",...t)})),WN(zN,this).addLocalHook("afterTransformEnd",(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.runLocalHooks("afterModifyTransformEnd",...t)})),WN(zN,this).addLocalHook("insertRowRequire",(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.runLocalHooks("insertRowRequire",...t)})),WN(zN,this).addLocalHook("insertColRequire",(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.runLocalHooks("insertColRequire",...t)})),WN(zN,this).addLocalHook("beforeRowWrap",(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.runLocalHooks("beforeRowWrap",...t)})),WN(zN,this).addLocalHook("beforeColumnWrap",(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.runLocalHooks("beforeColumnWrap",...t)})),WN($N,this).addLocalHook("beforeTransformStart",(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.runLocalHooks("beforeModifyTransformFocus",...t)})),WN($N,this).addLocalHook("afterTransformStart",(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.runLocalHooks("afterModifyTransformFocus",...t)}))}getSelectedRange(){return this.selectedRange}markSource(e){jN(XN,this,e)}markEndSource(){jN(XN,this,"unknown")}getSelectionSource(){return WN(XN,this)}setExpectedLayers(e){jN(qN,this,e)}begin(){this.inProgress=!0}finish(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1,jN(qN,this,-1)}isInProgress(){return this.inProgress}setRangeStart(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e;const i="multiple"===this.settings.selectionMode,o=zd(t)?this.tableProps.getShortcutManager().isCtrlPressed():t,s=e.clone();jN(YN,this,!1),this.runLocalHooks("beforeSetRangeStart"+(n?"Only":""),s),(!i||i&&!o&&zd(t))&&this.selectedRange.clear(),this.selectedRange.add(s).current().setHighlight(r.clone()),0===this.getLayerLevel()&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),n||this.setRangeEnd(e)}setRangeStartOnly(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e;this.setRangeStart(e,t,!0,n)}setRangeEnd(e){if(this.selectedRange.isEmpty())return;const t=e.clone(),n=this.tableProps.countRows(),r=this.tableProps.countCols(),i=this.selectedRange.current().clone().setTo(e).isSingleHeader();if((n>0||r>0)&&(0===n&&t.col<0&&!i||0===r&&t.row<0&&!i))return;this.runLocalHooks("beforeSetRangeEnd",t),this.begin();const o=this.selectedRange.current();if(this.settings.navigableHeaders||o.highlight.normalize(),"single"===this.settings.selectionMode)o.setFrom(o.highlight),o.setTo(o.highlight);else{const e=o.getHorizontalDirection(),n=o.getVerticalDirection(),r=this.isMultiple();o.setTo(t),r&&(e!==o.getHorizontalDirection()||1===o.getWidth()&&!o.includes(o.highlight))&&o.from.assign({col:o.highlight.col}),r&&(n!==o.getVerticalDirection()||1===o.getHeight()&&!o.includes(o.highlight))&&o.from.assign({row:o.highlight.row})}n>0&&r>0&&(!this.settings.navigableHeaders||this.settings.navigableHeaders&&!o.isSingleHeader())&&o.to.normalize(),this.runLocalHooks("beforeHighlightSet"),this.setRangeFocus(this.selectedRange.current().highlight),this.applyAndCommit();const s=-1===WN(qN,this)||this.selectedRange.size()===WN(qN,this);this.runLocalHooks("afterSetRangeEnd",e,s)}applyAndCommit(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.selectedRange.current(),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.getLayerLevel();const n=this.tableProps.countRows(),r=this.tableProps.countCols();t<this.highlight.layerLevel&&(Vd(this.highlight.getAreas(),(e=>{e.clear()})),Vd(this.highlight.getLayeredAreas(),(e=>{e.clear()})),Vd(this.highlight.getRowHeaders(),(e=>{e.clear()})),Vd(this.highlight.getColumnHeaders(),(e=>{e.clear()})),Vd(this.highlight.getActiveRowHeaders(),(e=>{e.clear()})),Vd(this.highlight.getActiveColumnHeaders(),(e=>{e.clear()})),Vd(this.highlight.getActiveCornerHeaders(),(e=>{e.clear()})),Vd(this.highlight.getRowHighlights(),(e=>{e.clear()})),Vd(this.highlight.getColumnHighlights(),(e=>{e.clear()}))),this.highlight.useLayerLevel(t);const i=this.highlight.createArea(),o=this.highlight.createLayeredArea(),s=this.highlight.createRowHeader(),a=this.highlight.createColumnHeader(),l=this.highlight.createActiveRowHeader(),h=this.highlight.createActiveColumnHeader(),u=this.highlight.createActiveCornerHeader(),c=this.highlight.createRowHighlight(),d=this.highlight.createColumnHighlight();if(i.clear(),o.clear(),s.clear(),a.clear(),l.clear(),h.clear(),u.clear(),c.clear(),d.clear(),this.highlight.isEnabledFor(fS,e.highlight)&&(this.isMultiple()||t>=1)&&(i.add(e.from).add(e.to).commit(),o.add(e.from).add(e.to).commit(),1===t)){const e=this.selectedRange.previous();this.highlight.useLayerLevel(t-1),this.highlight.createArea().add(e.from).commit().syncWith(e),this.highlight.createLayeredArea().add(e.from).commit().syncWith(e),this.highlight.useLayerLevel(t)}if(this.highlight.isEnabledFor(mS,e.highlight)){if(!e.isSingleHeader()){const t=this.tableProps.createCellCoords(Math.max(e.from.row,0),-1),n=this.tableProps.createCellCoords(e.to.row,-1),r=this.tableProps.createCellCoords(-1,Math.max(e.from.col,0)),i=this.tableProps.createCellCoords(-1,e.to.col);"single"===this.settings.selectionMode?(s.add(t).commit(),a.add(r).commit(),c.add(t).commit(),d.add(r).commit()):(s.add(t).add(n).commit(),a.add(r).add(i).commit(),c.add(t).add(n).commit(),d.add(r).add(i).commit())}const t=!WN(KN,this)&&this.isEntireRowSelected()&&(r>0&&r===e.getWidth()||0===r&&this.isSelectedByRowHeader()),i=!WN(KN,this)&&this.isEntireColumnSelected()&&(n>0&&n===e.getHeight()||0===n&&this.isSelectedByColumnHeader());t&&l.add(this.tableProps.createCellCoords(Math.max(e.from.row,0),Math.min(-this.tableProps.countRowHeaders(),-1))).add(this.tableProps.createCellCoords(Math.max(e.to.row,0),-1)).commit(),i&&h.add(this.tableProps.createCellCoords(Math.min(-this.tableProps.countColHeaders(),-1),Math.max(e.from.col,0))).add(this.tableProps.createCellCoords(-1,Math.max(e.to.col,0))).commit(),t&&i&&u.add(this.tableProps.createCellCoords(-this.tableProps.countColHeaders(),-this.tableProps.countRowHeaders())).add(this.tableProps.createCellCoords(-1,-1)).commit()}}setRangeFocus(e){if(this.selectedRange.isEmpty())return;const t=this.selectedRange.current();this.inProgress||this.runLocalHooks("beforeSetFocus",e);const n=this.highlight.getFocus();n.clear(),t.setHighlight(e),this.inProgress||this.runLocalHooks("beforeHighlightSet"),this.highlight.isEnabledFor(wS,t.highlight)&&n.add(t.highlight).commit().syncWith(t),this.inProgress||(jN(YN,this,!0),this.runLocalHooks("afterSetFocus",t.highlight))}transformStart(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.settings.navigableHeaders?WN(zN,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):WN(zN,this).resetOffsetSize(),this.setRangeStart(WN(zN,this).transformStart(e,t,n))}transformEnd(e,t){this.settings.navigableHeaders?WN(zN,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):WN(zN,this).resetOffsetSize(),this.setRangeEnd(WN(zN,this).transformEnd(e,t))}transformFocus(e,t){const n=this.selectedRange.current(),{row:r,col:i}=n.getOuterTopStartCorner(),o=this.tableProps.countRenderableColumnsInRange(0,i-1),s=this.tableProps.countRenderableRowsInRange(0,r-1);n.highlight.isHeader()?WN($N,this).setOffsetSize({x:i<0?Math.abs(i):-o,y:r<0?Math.abs(r):-s}):WN($N,this).setOffsetSize({x:i<0?0:-o,y:r<0?0:-s});const a=WN($N,this).transformStart(e,t);this.setRangeFocus(a.normalize())}shiftRows(e,t){if(!this.isSelected())return;const n=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByColumnHeader()||n.getOuterTopStartCorner().row>=e){const{from:r,to:i,highlight:o}=n,s=this.tableProps.countRows(),a=this.isSelectedByRowHeader(),l=this.isSelectedByColumnHeader(),h=l?-1:0,u=l?0:t;this.getSelectedRange().pop();const c=this.tableProps.createCellCoords(Xw(r.row+u,h,s-1),r.col),d=this.tableProps.createCellCoords(Xw(i.row+t,h,s-1),i.col);this.markSource("shift"),o.row>=e?this.setRangeStartOnly(c,!0,this.tableProps.createCellCoords(Xw(o.row+t,0,s-1),o.col)):this.setRangeStartOnly(c,!0),a&&this.selectedByRowHeader.add(this.getLayerLevel()),l&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(d),this.markEndSource()}}shiftColumns(e,t){if(!this.isSelected())return;const n=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByRowHeader()||n.getOuterTopStartCorner().col>=e){const{from:r,to:i,highlight:o}=n,s=this.tableProps.countCols(),a=this.isSelectedByRowHeader(),l=this.isSelectedByColumnHeader(),h=a?-1:0,u=a?0:t;this.getSelectedRange().pop();const c=this.tableProps.createCellCoords(r.row,Xw(r.col+u,h,s-1)),d=this.tableProps.createCellCoords(i.row,Xw(i.col+t,h,s-1));this.markSource("shift"),o.col>=e?this.setRangeStartOnly(c,!0,this.tableProps.createCellCoords(o.row,Xw(o.col+t,0,s-1))):this.setRangeStartOnly(c,!0),a&&this.selectedByRowHeader.add(this.getLayerLevel()),l&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(d),this.markEndSource()}}getLayerLevel(){return this.selectedRange.size()-1}isSelected(){return!this.selectedRange.isEmpty()}isMultiple(){if(!this.isSelected())return!1;const e=om(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",e),e.value}isFocusSelectionChanged(){return this.isSelected()&&WN(YN,this)}isSelectedByRowHeader(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(e)&&(-1===e?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(e))}isEntireRowSelected(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();const t=e=>{const{col:t}=e.getOuterTopStartCorner(),n=this.tableProps.countRowHeaders(),r=this.tableProps.countCols();return(n>0&&t<0||0===n)&&e.getWidth()===r};if(-1===e)return Array.from(this.selectedRange).some((e=>t(e)));const n=this.selectedRange.peekByIndex(e);return!!n&&t(n)}isSelectedByColumnHeader(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&(-1===e?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(e))}isEntireColumnSelected(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();const t=e=>{const{row:t}=e.getOuterTopStartCorner(),n=this.tableProps.countColHeaders(),r=this.tableProps.countRows();return(n>0&&t<0||0===n)&&e.getHeight()===r};if(-1===e)return Array.from(this.selectedRange).some((e=>t(e)));const n=this.selectedRange.peekByIndex(e);return!!n&&t(n)}isSelectedByAnyHeader(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}isSelectedByCorner(){return this.selectedByColumnHeader.has(this.getLayerLevel())&&this.selectedByRowHeader.has(this.getLayerLevel())}inInSelection(e){return this.selectedRange.includes(e)}isCellCornerVisible(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}isCellVisible(e){const t=this.tableProps.visualToRenderableCoords(e);return null!==t.row&&null!==t.col}isAreaCornerVisible(e){return(!Number.isInteger(e)||e===this.getLayerLevel())&&(this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple())}clear(){this.selectedRange.clear(),this.highlight.clear()}deselect(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}selectAll(){var e;let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{focusPosition:!1,disableHeadersHighlight:!1};const i=this.tableProps.countRows(),o=this.tableProps.countCols(),s=this.tableProps.countRowHeaders(),a=this.tableProps.countColHeaders(),l=n?-a:0,h=t?-s:0;if(0===l&&0===h&&(0===i||0===o))return;let u=null===(e=this.getSelectedRange().current())||void 0===e?void 0:e.highlight;const{focusPosition:c,disableHeadersHighlight:d}=r;jN(KN,this,d),c&&Number.isInteger(null==c?void 0:c.row)&&Number.isInteger(null==c?void 0:c.col)&&(u=this.tableProps.createCellCoords(Xw(c.row,l,i-1),Xw(c.col,h,o-1)));const p=this.tableProps.createCellCoords(l,h),g=this.tableProps.createCellCoords(i-1,o-1);this.clear(),this.setRangeStartOnly(p,void 0,u),h<0&&this.selectedByRowHeader.add(this.getLayerLevel()),l<0&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(g),this.finish(),jN(KN,this,!1)}selectCells(e){var t=this;const n=DN(e);if(1===n)return!1;if(0===n)throw new Error(Wd`Unsupported format of the selection ranges was passed. To select cells pass\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`);const r=VN(n,{createCellCoords:function(){return t.tableProps.createCellCoords(...arguments)},createCellRange:function(){return t.tableProps.createCellRange(...arguments)},propToCol:e=>this.tableProps.propToCol(e),keepDirection:!0}),i=this.settings.navigableHeaders,o={countRows:this.tableProps.countRows(),countCols:this.tableProps.countCols(),countRowHeaders:i?this.tableProps.countRowHeaders():0,countColHeaders:i?this.tableProps.countColHeaders():0},s=!e.some((e=>{const t=r(e),n=t.isValid(o);return!(n&&!t.containsHeaders()||n&&t.containsHeaders()&&t.isSingleHeader())}));return s&&(this.clear(),this.setExpectedLayers(e.length),Vd(e,(e=>{const{from:t,to:n}=r(e);this.setRangeStartOnly(t.clone(),!1),this.setRangeEnd(n.clone())})),this.finish()),s}selectColumns(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const r="string"==typeof e?this.tableProps.propToCol(e):e,i="string"==typeof t?this.tableProps.propToCol(t):t,o=this.tableProps.countRows(),s=this.tableProps.countCols(),a=this.tableProps.countColHeaders(),l=0===a?0:-a,h=this.tableProps.createCellCoords(l,r),u=this.tableProps.createCellCoords(o-1,i),c=this.tableProps.createCellRange(h,h,u).isValid({countRows:o,countCols:s,countRowHeaders:0,countColHeaders:a});if(c){let e=0,t=0;Number.isInteger(null==n?void 0:n.row)&&Number.isInteger(null==n?void 0:n.col)?(e=Xw(n.row,l,o-1),t=Xw(n.col,Math.min(r,i),Math.max(r,i))):(e=Xw(n,l,o-1),t=r);const s=this.tableProps.createCellCoords(e,t),h=0===a?0:Xw(s.row,l,-1),u=o-1,c=this.tableProps.createCellCoords(h,r),d=this.tableProps.createCellCoords(u,i);this.runLocalHooks("beforeSelectColumns",c,d,s),c.row=h,d.row=u,this.setRangeStartOnly(c,void 0,s),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(d),this.runLocalHooks("afterSelectColumns",c,d,s),this.finish()}return c}selectRows(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const r=this.tableProps.countRows(),i=this.tableProps.countCols(),o=this.tableProps.countRowHeaders(),s=0===o?0:-o,a=this.tableProps.createCellCoords(e,s),l=this.tableProps.createCellCoords(t,i-1),h=this.tableProps.createCellRange(a,a,l).isValid({countRows:r,countCols:i,countRowHeaders:o,countColHeaders:0});if(h){let r=0,a=0;Number.isInteger(null==n?void 0:n.row)&&Number.isInteger(null==n?void 0:n.col)?(r=Xw(n.row,Math.min(e,t),Math.max(e,t)),a=Xw(n.col,s,i-1)):(r=e,a=Xw(n,s,i-1));const l=this.tableProps.createCellCoords(r,a),h=0===o?0:Xw(l.col,s,-1),u=i-1,c=this.tableProps.createCellCoords(e,h),d=this.tableProps.createCellCoords(t,u);this.runLocalHooks("beforeSelectRows",c,d,l),c.col=h,d.col=u,this.setRangeStartOnly(c,void 0,l),this.selectedByRowHeader.add(this.getLayerLevel()),this.setRangeEnd(d),this.runLocalHooks("afterSelectRows",c,d,l),this.finish()}return h}refresh(){if(!this.isSelected())return;const e=this.tableProps.countRows(),t=this.tableProps.countCols();if(0===e||0===t)return void this.deselect();const n=this.selectedRange.peekByIndex(this.selectedRange.size()-1),{from:r,to:i,highlight:o}=n;this.clear(),o.assign({row:Xw(o.row,-1/0,e-1),col:Xw(o.col,-1/0,t-1)}),r.assign({row:Xw(r.row,-1/0,e-1),col:Xw(r.col,-1/0,t-1)}),i.assign({row:Xw(i.row,0,e-1),col:Xw(i.col,0,t-1)}),this.selectedRange.ranges.push(n),this.highlight.getFocus().add(o).commit().syncWith(n),this.applyAndCommit(n)}commit(){if(this.highlight.getCustomSelections().forEach((e=>{e.commit()})),!this.isSelected())return;const e=this.getLayerLevel(),t=this.selectedRange.current();this.highlight.isEnabledFor(wS,t.highlight)&&this.highlight.getFocus().commit().syncWith(t);for(let n=0;n<this.selectedRange.size();n+=1){this.highlight.useLayerLevel(n);const e=this.highlight.createArea(),t=this.highlight.createLayeredArea(),r=this.highlight.createRowHeader(),i=this.highlight.createColumnHeader(),o=this.highlight.createActiveRowHeader(),s=this.highlight.createActiveColumnHeader(),a=this.highlight.createActiveCornerHeader(),l=this.highlight.createRowHighlight(),h=this.highlight.createColumnHighlight();e.commit(),t.commit(),r.commit(),i.commit(),o.commit(),s.commit(),a.commit(),l.commit(),h.commit()}this.highlight.useLayerLevel(e)}}Zg(QN,cS);const ZN=QN,JN=/^(\r\n|\n\r|\r|\n)/,eA=/^[^\t\r\n]+/,tA=/^\t/;function nA(e){let t,n,r,i,o,s="";for(t=0,n=e.length;t<n;t+=1){for(i=e[t].length,r=0;r<i;r+=1)r>0&&(s+="\t"),o=e[t][r],"string"==typeof o?o.indexOf("\n")>-1?s+=`"${o.replace(/"/g,'""')}"`:s+=o:s+=null==o?"":o;t!==n-1&&(s+="\n")}return s}function rA(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class iA{static get DESTINATION_RENDERER(){return 1}static get DESTINATION_CLIPBOARD_GENERATOR(){return 2}constructor(e,t,n){rA(this,"hot",void 0),rA(this,"metaManager",void 0),rA(this,"tableMeta",void 0),rA(this,"dataSource",void 0),rA(this,"duckSchema",void 0),rA(this,"colToPropCache",void 0),rA(this,"propToColCache",void 0),this.hot=e,this.metaManager=n,this.tableMeta=n.getTableMeta(),this.dataSource=t,this.refreshDuckSchema(),this.createMap()}createMap(){const e=this.getSchema();if(void 0===e)throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");const t=this.tableMeta.columns;let n;if(this.colToPropCache=[],this.propToColCache=new Map,t){let r=0,i=0,o=!1;if("function"==typeof t){const t=im(e);r=t>0?t:this.countFirstRowKeys(),o=!0}else{const e=this.tableMeta.maxCols;r=Math.min(e,t.length)}for(n=0;n<r;n++){const e=o?t(n):t[n];if(em(e)){if(void 0!==e.data){const t=o?i:n;this.colToPropCache[t]=e.data,this.propToColCache.set(e.data,t)}i+=1}}}else this.recursiveDuckColumns(e)}countFirstRowKeys(){return wE(this.dataSource)}recursiveDuckColumns(e,t,n){let r,i=t,o=n;return void 0===i&&(i=0,o=""),"object"!=typeof e||Array.isArray(e)||nm(e,((e,t)=>{null===e?(r=o+t,this.colToPropCache.push(r),this.propToColCache.set(r,i),i+=1):i=this.recursiveDuckColumns(e,i,`${t}.`)})),i}colToProp(e){if(!1===Number.isInteger(e))return e;const t=this.hot.toPhysicalColumn(e);return null===t?e:this.colToPropCache&&Gd(this.colToPropCache[t])?this.colToPropCache[t]:t}propToCol(e){const t=this.propToColCache.get(e);if(Gd(t))return this.hot.toVisualColumn(t);const n=this.hot.toVisualColumn(e);return null===n?e:n}getSchema(){const e=this.tableMeta.dataSchema;return e?"function"==typeof e?e():e:this.duckSchema}createDuckSchema(){return this.dataSource&&this.dataSource[0]?Yg(this.dataSource[0]):{}}refreshDuckSchema(){this.duckSchema=this.createDuckSchema()}createRow(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,{source:n,mode:r="above"}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i=this.hot.countSourceRows();let o=i,s=0,a=e;("number"!=typeof a||a>=i)&&(a=i),a<this.hot.countRows()&&(o=this.hot.toPhysicalRow(a));if(!1===this.hot.runHooks("beforeCreateRow",a,t,n)||null===o)return{delta:0};const l=this.tableMeta.maxRows,h=this.getSchema().length,u=[];for(;s<t&&i+s<l;){let e=null;"array"===this.hot.dataType?this.tableMeta.dataSchema?e=qg(this.getSchema()):(e=[],$w(h-1,(()=>e.push(null)))):"function"===this.hot.dataType?e=this.tableMeta.dataSchema(a+s):(e={},Xg(e,this.getSchema())),u.push(e),s+=1}this.hot.rowIndexMapper.insertIndexes(a,s),"below"===r&&(o=Math.min(o+1,i)),this.spliceData(o,0,u);const c=this.hot.toVisualRow(o);return this.hot.countSourceRows()===u.length&&this.hot.columnIndexMapper.initToLength(this.hot.getInitialColumnCount()),s>0&&(null==e?this.metaManager.createRow(null,s):"auto"!==n&&this.metaManager.createRow(o,t)),this.hot.runHooks("afterCreateRow",c,s,n),this.hot.forceFullRender=!0,{delta:s,startPhysicalIndex:o}}createCol(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,{source:n,mode:r="start"}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!this.hot.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");const i=this.dataSource,o=this.tableMeta.maxCols,s=this.hot.countSourceCols();let a=e;("number"!=typeof a||a>=s)&&(a=s);if(!1===this.hot.runHooks("beforeCreateCol",a,t,n))return{delta:0};let l=s;a<this.hot.countCols()&&(l=this.hot.toPhysicalColumn(a));const h=this.hot.countSourceRows();let u=this.hot.countCols(),c=0,d=l;"end"===r&&(d=Math.min(d+1,s));const p=d;for(;c<t&&u<o;){if("number"!=typeof a||a>=u)if(h>0)for(let e=0;e<h;e+=1)void 0===i[e]&&(i[e]=[]),i[e].push(null);else i.push([null]);else for(let e=0;e<h;e++)i[e].splice(d,0,null);c+=1,d+=1,u+=1}this.hot.columnIndexMapper.insertIndexes(a,c),c>0&&(null==e?this.metaManager.createColumn(null,c):"auto"!==n&&this.metaManager.createColumn(p,t));const g=this.hot.toVisualColumn(p);return this.hot.runHooks("afterCreateCol",g,c,n),this.hot.forceFullRender=!0,this.refreshDuckSchema(),{delta:c,startPhysicalIndex:p}}removeRow(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0,r=Number.isInteger(e)?e:-t;const i=this.visualRowsToPhysical(r,t),o=this.hot.countSourceRows();r=(o+r)%o;if(!1===this.hot.runHooks("beforeRemoveRow",r,i.length,i,n))return!1;const s=i.length;if(this.filterData(r,s,i),r<this.hot.countRows()){this.hot.rowIndexMapper.removeIndexes(i);const e=Gd(this.tableMeta.columns)||Gd(this.tableMeta.dataSchema)||this.tableMeta.colHeaders;0!==this.hot.rowIndexMapper.getNotTrimmedIndexesLength()||e||this.hot.columnIndexMapper.setIndexesSequence([])}return i.slice(0).sort(((e,t)=>t-e)).forEach((e=>{this.metaManager.removeRow(e,1)})),this.hot.runHooks("afterRemoveRow",r,s,i,n),this.hot.forceFullRender=!0,!0}removeCol(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0;if("object"===this.hot.dataType||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");let r="number"!=typeof e?-t:e;r=(this.hot.countCols()+r)%this.hot.countCols();const i=this.visualColumnsToPhysical(r,t),o=i.slice(0).sort(((e,t)=>t-e));if(!1===this.hot.runHooks("beforeRemoveCol",r,t,i,n))return!1;let s=!0;const a=o.length,l=this.dataSource;for(let h=0;h<a;h++)s&&i[0]!==i[h]-h&&(s=!1);if(s)for(let h=0,u=this.hot.countSourceRows();h<u;h++)l[h].splice(i[0],t),0===h&&this.metaManager.removeColumn(i[0],t);else for(let h=0,u=this.hot.countSourceRows();h<u;h++)for(let e=0;e<a;e++)l[h].splice(o[e],1),0===h&&this.metaManager.removeColumn(o[e],1);return r<this.hot.countCols()&&(this.hot.columnIndexMapper.removeIndexes(i),this.tableMeta.rowHeaders||0!==this.hot.columnIndexMapper.getNotTrimmedIndexesLength()||this.hot.rowIndexMapper.setIndexesSequence([])),this.hot.runHooks("afterRemoveCol",r,t,i,n),this.hot.forceFullRender=!0,this.refreshDuckSchema(),!0}spliceCol(e,t,n){const r=this.hot.getDataAtCol(e),i=r.slice(t,t+n),o=r.slice(t+n);for(var s=arguments.length,a=new Array(s>3?s-3:0),l=3;l<s;l++)a[l-3]=arguments[l];Ld(a,o);let h=0;for(;h<n;)a.push(null),h+=1;return function(e){const t=e.length;let n=0;for(;n<t;)e[n]=[e[n]],n+=1}(a),this.hot.populateFromArray(t,e,a,null,null,"spliceCol"),i}spliceRow(e,t,n){const r=this.hot.getSourceDataAtRow(e),i=r.slice(t,t+n),o=r.slice(t+n);for(var s=arguments.length,a=new Array(s>3?s-3:0),l=3;l<s;l++)a[l-3]=arguments[l];Ld(a,o);let h=0;for(;h<n;)a.push(null),h+=1;return this.hot.populateFromArray(e,t,[a],null,null,"spliceRow"),i}spliceData(e,t,n){if(!1!==this.hot.runHooks("beforeDataSplice",e,t,n)){const t=[...this.dataSource.slice(0,e),...n,...this.dataSource.slice(e)];this.dataSource.length=0,t.forEach((e=>this.dataSource.push(e)))}}filterData(e,t,n){let r=this.hot.runHooks("filterData",e,t,n);!1===Array.isArray(r)&&(r=this.dataSource.filter(((e,t)=>-1===n.indexOf(t)))),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,r)}get(e,t){const n=this.hot.toPhysicalRow(e);let r=this.dataSource[n];const i=this.hot.runHooks("modifyRowData",n);r=isNaN(i)?i:r;const{dataDotNotation:o}=this.hot.getSettings();let s=null;if(r&&r.hasOwnProperty&&sm(r,t))s=r[t];else if(o&&"string"==typeof t&&t.indexOf(".")>-1){let e=r;if(!e)return null;const n=t.split(".");for(let t=0,r=n.length;t<r;t++)if(e=e[n[t]],void 0===e)return null;s=e}else"function"==typeof t&&(s=t(this.dataSource.slice(n,n+1)[0]));if(this.hot.hasHook("modifyData")){const e=om(s);this.hot.runHooks("modifyData",n,this.propToCol(t),e,"get"),e.isTouched()&&(s=e.value)}return s}getCopyable(e,t){return this.hot.getCellMeta(e,this.propToCol(t)).copyable?this.get(e,t):""}set(e,t,n){const r=this.hot.toPhysicalRow(e);let i=n,o=this.dataSource[r];const s=this.hot.runHooks("modifyRowData",r);if(o=isNaN(s)?s:o,this.hot.hasHook("modifyData")){const e=om(i);this.hot.runHooks("modifyData",r,this.propToCol(t),e,"set"),e.isTouched()&&(i=e.value)}const{dataDotNotation:a}=this.hot.getSettings();if(o&&o.hasOwnProperty&&sm(o,t))o[t]=i;else if(a&&"string"==typeof t&&t.indexOf(".")>-1){let e,n=o,r=0;const s=t.split(".");for(r=0,e=s.length-1;r<e;r++){if("__proto__"===s[r]||"constructor"===s[r]||"prototype"===s[r])return;void 0===n[s[r]]&&(n[s[r]]={}),n=n[s[r]]}n[s[r]]=i}else if("function"==typeof t)t(this.dataSource.slice(r,r+1)[0],i);else{if("__proto__"===t||"constructor"===t||"prototype"===t)return;o[t]=i}}visualRowsToPhysical(e,t){const n=this.hot.countSourceRows(),r=[];let i,o=(n+e)%n,s=t;for(;o<n&&s;)i=this.hot.toPhysicalRow(o),r.push(i),s-=1,o+=1;return r}visualColumnsToPhysical(e,t){const n=this.hot.countCols(),r=[];let i=(n+e)%n,o=t;for(;i<n&&o;){const e=this.hot.toPhysicalColumn(i);r.push(e),o-=1,i+=1}return r}clear(){for(let e=0;e<this.hot.countSourceRows();e++)for(let t=0;t<this.hot.countCols();t++)this.set(e,this.colToProp(t),"")}getLength(){const e=this.tableMeta.maxRows;let t;t=e<0||0===e?0:e||1/0;const n=this.hot.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(n,t)}getAll(){const e={row:0,col:0},t={row:Math.max(this.hot.countRows()-1,0),col:Math.max(this.hot.countCols()-1,0)};return e.row-t.row!=0||this.hot.countSourceRows()?this.getRange(e,t,iA.DESTINATION_RENDERER):[]}countCachedColumns(){return this.colToPropCache.length}getRange(e,t,n){const r=[];let i,o,s;const a=this.tableMeta.maxRows,l=this.tableMeta.maxCols;if(0===a||0===l)return[];const h=n===iA.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,u=Math.min(Math.max(a-1,0),Math.max(e.row,t.row)),c=Math.min(Math.max(l-1,0),Math.max(e.col,t.col));for(i=Math.min(e.row,t.row);i<=u;i++){s=[];const n=i>=0?this.hot.toPhysicalRow(i):i;for(o=Math.min(e.col,t.col);o<=c&&null!==n;o++)s.push(h.call(this,i,this.colToProp(o)));null!==n&&r.push(s)}return r}getText(e,t){return nA(this.getRange(e,t,iA.DESTINATION_RENDERER))}getCopyableText(e,t){return nA(this.getRange(e,t,iA.DESTINATION_CLIPBOARD_GENERATOR))}destroy(){this.hot=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}const oA=iA,{register:sA,getItem:aA,hasItem:lA,getNames:hA,getValues:uA}=yf("cellTypes");function cA(e,t){"string"!=typeof e&&(e=(t=e).CELL_TYPE);const{editor:n,renderer:r,validator:i}=t;n&&Mf(e,n),r&&fy(e,r),i&&Ry(e,i),sA(e,t)}function dA(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e;const r="string"==typeof t.type?function(e){if(!lA(e))throw Error(`You declared cell type "${e}" as a string that is not mapped to a known object.\n                 Cell type must be an object or a string mapped to an object registered by\n                 "Handsontable.cellTypes.registerCellType" method`);return aA(e)}(t.type):t.type;if(e._automaticallyAssignedMetaProps&&nm(t,((t,n)=>{e._automaticallyAssignedMetaProps.delete(n)})),!em(r))return;n!==e||e._automaticallyAssignedMetaProps||(e._automaticallyAssignedMetaProps=new Set);const i={};nm(r,((t,r)=>{var o;(function(e,t){var n;return"CELL_TYPE"!==e&&((null===(n=t._automaticallyAssignedMetaProps)||void 0===n?void 0:n.has(e))||!sm(t,e))})(r,n)&&(i[r]=t,null===(o=e._automaticallyAssignedMetaProps)||void 0===o||o.add(r))})),Kg(e,i)}function pA(e){return Number.isInteger(e)&&e>=0}function gA(e,t){if(!e())throw new Error(`Assertion failed: ${t}`)}function mA(e){return null==e}const fA=()=>({_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,ariaTags:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataDotNotation:!0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",timeFormat:"h:mm:ss a",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,headerClassName:void 0,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",imeFastEdit:!1,isEmptyCol(e){let t,n,r;for(t=0,n=this.countRows();t<n;t++)if(r=this.getDataAtCell(t,e),!1===$d(r))return!1;return!0},isEmptyRow(e){let t,n,r,i;for(t=0,n=this.countCols();t<n;t++)if(r=this.getDataAtCell(e,t),!1===$d(r))return"object"==typeof r&&(i=this.getCellMeta(e,t),Jg(this.getSchema()[i.prop],r));return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,navigableHeaders:!1,tabNavigation:!0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:!1,renderAllColumns:!1,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,themeName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:!0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",viewportColumnRenderingThreshold:0,viewportRowRenderingThreshold:0,visibleRows:10,width:void 0,wordWrap:!0});function wA(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class yA{constructor(e){wA(this,"metaCtor",class{}),wA(this,"meta",void 0),this.meta=this.metaCtor.prototype,Kg(this.meta,fA()),this.meta.instance=e}getMetaConstructor(){return this.metaCtor}getMeta(){return this.meta}updateMeta(e){var t;Kg(this.meta,e),dA(this.meta,{...e,type:null!==(t=e.type)&&void 0!==t?t:this.meta.type},e)}}function vA(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class CA{constructor(e){vA(this,"meta",void 0);const t=e.getMetaConstructor();this.meta=new t}getMeta(){return this.meta}updateMeta(e){Kg(this.meta,e),dA(this.meta,e,e)}}function SA(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class RA{constructor(e){SA(this,"valueFactory",void 0),SA(this,"data",[]),SA(this,"index",[]),SA(this,"holes",new Set),this.valueFactory=e}obtain(e){gA((()=>pA(e)),"Expecting an unsigned number.");const t=this._getStorageIndexByKey(e);let n;if(t>=0)n=this.data[t],void 0===n&&(n=this.valueFactory(e),this.data[t]=n);else if(n=this.valueFactory(e),this.holes.size>0){const t=this.holes.values().next().value;this.holes.delete(t),this.data[t]=n,this.index[e]=t}else this.data.push(n),this.index[e]=this.data.length-1;return n}insert(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;gA((()=>pA(e)||mA(e)),"Expecting an unsigned number or null/undefined argument.");const n=[],r=this.data.length;for(let o=0;o<t;o++)n.push(r+o),this.data.push(void 0);const i=mA(e)?this.index.length:e;this.index=[...this.index.slice(0,i),...n,...this.index.slice(i)]}remove(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;gA((()=>pA(e)||mA(e)),"Expecting an unsigned number or null/undefined argument.");const n=this.index.splice(mA(e)?this.index.length-t:e,t);for(let r=0;r<n.length;r++){const e=n[r];"number"==typeof e&&this.holes.add(e)}}size(){return this.data.length-this.holes.size}values(){return this.data.filter(((e,t)=>void 0!==e&&!this.holes.has(t)))[Symbol.iterator]()}entries(){const e=[];for(let n=0;n<this.data.length;n++){const t=this._getKeyByStorageIndex(n);-1!==t&&void 0!==this.data[n]&&e.push([t,this.data[n]])}let t=0;return{next:()=>{if(t<e.length){const n=e[t];return t+=1,{value:n,done:!1}}return{done:!0}}}}clear(){this.data=[],this.index=[],this.holes.clear()}_getStorageIndexByKey(e){return this.index.length>e?this.index[e]:-1}_getKeyByStorageIndex(e){return this.index.indexOf(e)}[Symbol.iterator](){return this.entries()}}function EA(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const bA=["data","width"];class TA{constructor(e){EA(this,"globalMeta",void 0),EA(this,"metas",new RA((()=>this._createMeta()))),this.globalMeta=e,this.metas=new RA((()=>this._createMeta()))}updateMeta(e,t){const n=this.getMeta(e);Kg(n,t),dA(n,t)}createColumn(e,t){this.metas.insert(e,t)}removeColumn(e,t){this.metas.remove(e,t)}getMeta(e){return this.metas.obtain(e)}getMetaConstructor(e){return this.metas.obtain(e).constructor}clearCache(){this.metas.clear()}_createMeta(){return function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];function n(){}var r,i;r=n,(i=e).prototype.constructor=i,r.prototype=new i,r.prototype.constructor=r;for(let o=0;o<t.length;o++)n.prototype[t[o]]=void 0;return n}(this.globalMeta.getMetaConstructor(),bA).prototype}}function NA(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class AA{constructor(e){NA(this,"columnMeta",void 0),NA(this,"metas",new RA((()=>this._createRow()))),this.columnMeta=e}updateMeta(e,t,n){const r=this.getMeta(e,t);Kg(r,n),dA(r,n)}createRow(e,t){this.metas.insert(e,t)}createColumn(e,t){for(let n=0;n<this.metas.size();n++)this.metas.obtain(n).insert(e,t)}removeRow(e,t){this.metas.remove(e,t)}removeColumn(e,t){for(let n=0;n<this.metas.size();n++)this.metas.obtain(n).remove(e,t)}getMeta(e,t,n){const r=this.metas.obtain(e).obtain(t);return void 0===n?r:r[n]}setMeta(e,t,n,r){var i;const o=this.metas.obtain(e).obtain(t);null===(i=o._automaticallyAssignedMetaProps)||void 0===i||i.delete(n),o[n]=r}removeMeta(e,t,n){delete this.metas.obtain(e).obtain(t)[n]}getMetas(){const e=[],t=Array.from(this.metas.values());for(let n=0;n<t.length;n++)Gd(t[n])&&e.push(...t[n].values());return e}getMetasAtRow(e){gA((()=>pA(e)),"Expecting an unsigned number.");const t=new Map(this.metas);return t.has(e)?Array.from(t.get(e).values()):[]}clearCache(){this.metas.clear()}_createRow(){return new RA((e=>this._createMeta(e)))}_createMeta(e){return new(this.columnMeta.getMetaConstructor(e))}}class MA{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];this.hot=e,this.globalMeta=new yA(e),this.tableMeta=new CA(this.globalMeta),this.columnMeta=new TA(this.globalMeta),this.cellMeta=new AA(this.columnMeta),n.forEach((e=>new e(this))),this.globalMeta.updateMeta(t)}getGlobalMeta(){return this.globalMeta.getMeta()}updateGlobalMeta(e){this.globalMeta.updateMeta(e)}getTableMeta(){return this.tableMeta.getMeta()}updateTableMeta(e){this.tableMeta.updateMeta(e)}getColumnMeta(e){return this.columnMeta.getMeta(e)}updateColumnMeta(e,t){this.columnMeta.updateMeta(e,t)}getCellMeta(e,t,n){let{visualRow:r,visualColumn:i}=n;const o=this.cellMeta.getMeta(e,t);return o.visualRow=r,o.visualCol=i,o.row=e,o.col=t,this.runLocalHooks("afterGetCellMeta",o),o}getCellMetaKeyValue(e,t,n){if("string"!=typeof n)throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(e,t,n)}setCellMeta(e,t,n,r){this.cellMeta.setMeta(e,t,n,r)}updateCellMeta(e,t,n){this.cellMeta.updateMeta(e,t,n)}removeCellMeta(e,t,n){this.cellMeta.removeMeta(e,t,n)}getCellsMeta(){return this.cellMeta.getMetas()}getCellsMetaAtRow(e){return this.cellMeta.getMetasAtRow(e)}createRow(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.createRow(e,t)}removeRow(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.removeRow(e,t)}createColumn(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.createColumn(e,t),this.columnMeta.createColumn(e,t)}removeColumn(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.removeColumn(e,t),this.columnMeta.removeColumn(e,t)}clearCellsCache(){this.cellMeta.clearCache()}clearCache(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}function IA(e,t,n,r){const{hotInstance:i,dataMap:o,dataSource:s,internalSource:a,source:l,metaManager:h,firstRun:u}=r,c=rp(a),d=i.getSettings();Array.isArray(d.dataSchema)?i.dataType="array":pg(d.dataSchema)?i.dataType="function":i.dataType="object",o&&o.destroy(),e=i.runHooks(`before${c}`,e,u,l);const p=new oA(i,e,h);if(t(p),"object"==typeof e&&null!==e)e.push&&e.splice||(e=[e]);else{if(null!==e)throw new Error(`${a} only accepts array of objects or array of arrays (${typeof e} given)`);{const t=p.getSchema();let n;e=[];let r=0,o=0;for(r=0,o=d.startRows;r<o;r++)if("object"!==i.dataType&&"function"!==i.dataType||!d.dataSchema)if("array"===i.dataType)n=qg(t[0]),e.push(n);else{n=[];for(let e=0,t=d.startCols;e<t;e++)n.push(null);e.push(n)}else n=qg(t),e.push(n)}}Array.isArray(e[0])&&(i.dataType="array"),d.data=e,p.dataSource=e,s.data=e,s.dataType=i.dataType,s.colToProp=p.colToProp.bind(p),s.propToCol=p.propToCol.bind(p),s.countCachedColumns=p.countCachedColumns.bind(p),n(p),i.runHooks(`after${c}`,e,u,l),u||(i.runHooks("afterChange",null,a),i.render()),i.getSettings().ariaTags&&Pp(i.rootElement,[dp(-1),pp(i.countCols()+(i.view?i.countRowHeaders():0))])}function OA(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Zg(MA,cS);class xA{constructor(e){OA(this,"metaManager",void 0),OA(this,"metaSyncMemo",new Map),this.metaManager=e,e.addLocalHook("afterGetCellMeta",(e=>this.extendCellMeta(e))),mf.getSingleton().add("beforeRender",(e=>{e&&this.metaSyncMemo.clear()}),this.metaManager.hot)}extendCellMeta(e){var t;const{row:n,col:r}=e;if(null!==(t=this.metaSyncMemo.get(n))&&void 0!==t&&t.has(r))return;const{visualRow:i,visualCol:o}=e,s=this.metaManager.hot,a=s.colToProp(o);e.prop=a,s.runHooks("beforeGetCellMeta",i,o,e);const l=sm(e,"type")?e.type:null;let h=pg(e.cells)?e.cells(n,r,a):null;var u;l&&(h?h.type=null!==(u=h.type)&&void 0!==u?u:l:h={type:l});h&&this.metaManager.updateCellMeta(n,r,h),s.runHooks("afterGetCellMeta",i,o,e),this.metaSyncMemo.has(n)||this.metaSyncMemo.set(n,new Set),this.metaSyncMemo.get(n).add(r)}}function PA(e,t,n){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,n)}function _A(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function LA(e,t){return e.get(function(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}(e,t))}var HA=new WeakMap;class kA{constructor(e){_A(this,"metaManager",void 0),_A(this,"usageTracker",new Set),_A(this,"propDescriptors",new Map([["ariaTags",{initOnly:!0}],["fixedColumnsLeft",{target:"fixedColumnsStart",onChange(e){if(this.metaManager.hot.isRtl()&&"fixedColumnsLeft"===e)throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{initOnly:!0}],["renderAllColumns",{initOnly:!0}],["renderAllRows",{initOnly:!0}]])),PA(this,HA,((e,t,n)=>{if(!n)throw new Error(`The \`${e}\` option can not be updated after the Handsontable is initialized.`)})),this.metaManager=e,this.extendMetaProps()}extendMetaProps(){this.propDescriptors.forEach(((e,t)=>{const{initOnly:n,target:r,onChange:i}=e,o="string"==typeof r,s=o?r:t,a=`_${s}`;this.metaManager.globalMeta.meta[a]=this.metaManager.globalMeta.meta[s],i?(this.installPropWatcher(t,a,i),o&&this.installPropWatcher(r,a,i)):n&&(this.installPropWatcher(t,a,LA(HA,this)),this.metaManager.globalMeta.meta._initOnlySettings||(this.metaManager.globalMeta.meta._initOnlySettings=[]),this.metaManager.globalMeta.meta._initOnlySettings.push(t))}))}installPropWatcher(e,t,n){const r=this;Object.defineProperty(this.metaManager.globalMeta.meta,e,{get(){return this[t]},set(i){const o=!r.usageTracker.has(e);r.usageTracker.add(e),n.call(r,e,i,o),this[t]=i},enumerable:!0,configurable:!0})}}const FA="gridDefault",DA="editorManager.handlingEditor",VA={name:"editorCloseAndSave",callback(e){e._getEditorManager().closeEditorAndSaveChanges()}},UA={_hooksStorage:Object.create(null),addHook(e,t){return this._hooksStorage[e]||(this._hooksStorage[e]=[]),this.hot.addHook(e,t),this._hooksStorage[e].push(t),this},removeHooksByKey(e){Vd(this._hooksStorage[e]||[],(t=>{this.hot.removeHook(e,t)}))},clearHooks(){nm(this._hooksStorage,((e,t)=>this.removeHooksByKey(t))),this._hooksStorage={}}};tm(UA,"MIXIN_NAME","hooksRefRegisterer",{writable:!1,enumerable:!1});const BA=UA;function WA(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const jA=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"});class GA{static get EDITOR_TYPE(){return"base"}constructor(e){WA(this,"hot",void 0),WA(this,"state",jA.VIRGIN),WA(this,"_opened",!1),WA(this,"_fullEditMode",!1),WA(this,"_closeCallback",null),WA(this,"TD",null),WA(this,"row",null),WA(this,"col",null),WA(this,"prop",null),WA(this,"originalValue",null),WA(this,"cellProperties",null),this.hot=e,this.init()}_fireCallbacks(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)}init(){}getValue(){throw Error("Editor getValue() method unimplemented")}setValue(){throw Error("Editor setValue() method unimplemented")}open(){throw Error("Editor open() method unimplemented")}close(){throw Error("Editor close() method unimplemented")}prepare(e,t,n,r,i,o){this.TD=r,this.row=e,this.col=t,this.prop=n,this.originalValue=i,this.cellProperties=o,this.state=this.isOpened()?this.state:jA.VIRGIN}extend(){return class extends this.constructor{}}saveValue(e,t){let n,r,i,o;if(t){const e=this.hot.getSelectedLast();n=Math.max(Math.min(e[0],e[2]),0),r=Math.max(Math.min(e[1],e[3]),0),i=Math.max(e[0],e[2]),o=Math.max(e[1],e[3])}else[n,r,i,o]=[this.row,this.col,null,null];const s=this.hot.runHooks("modifyGetCellCoords",n,r,!1,"meta");Array.isArray(s)&&([n,r]=s),this.hot.populateFromArray(n,r,e,i,o,"edit")}beginEditing(e,t){if(this.state!==jA.VIRGIN)return;const n=this.hot,r=n.rowIndexMapper.getRenderableFromVisualIndex(this.row),i=n.columnIndexMapper.getRenderableFromVisualIndex(this.col),o=()=>{if(this.state=jA.EDITING,this.isInFullEditMode()){const t="string"==typeof e?e:jd(this.originalValue);this.setValue(t)}this.open(t),this._opened=!0,this.focus(),n.view.render(),n.runHooks("afterBeginEditing",this.row,this.col)};this.hot.addHookOnce("afterScroll",o);n.view.scrollViewport(n._createCellCoords(r,i))||(this.hot.removeHook("afterScroll",o),o())}finishEditing(e,t,n){let r;if(n){const e=this._closeCallback;this._closeCallback=t=>{e&&e(t),n(t),this.hot.view.render()}}if(!this.isWaiting())if(this.state!==jA.VIRGIN){if(this.state===jA.EDITING){if(e)return this.cancelChanges(),void this.hot.view.render();const n=this.getValue();r=this.cellProperties.trimWhitespace?[["string"==typeof n?String.prototype.trim.call(n||""):n]]:[[n]],this.state=jA.WAITING,this.saveValue(r,t),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",(e=>{this.state=jA.FINISHED,this.discardEditor(e)})):(this.state=jA.FINISHED,this.discardEditor(!0))}}else this.hot._registerTimeout((()=>{this._fireCallbacks(!0)}))}cancelChanges(){this.state=jA.FINISHED,this.discardEditor()}discardEditor(e){if(this.state===jA.FINISHED)if(!1===e&&!0!==this.cellProperties.allowInvalid)this.hot.selectCell(this.row,this.col),this.focus(),this.state=jA.EDITING,this._fireCallbacks(!1);else{this.close(),this._opened=!1,this._fullEditMode=!1,this.state=jA.VIRGIN,this._fireCallbacks(!0);this.hot.getShortcutManager().setActiveContextName("grid")}}enableFullEditMode(){this._fullEditMode=!0}isInFullEditMode(){return this._fullEditMode}isOpened(){return this._opened}isWaiting(){return this.state===jA.WAITING}getEditedCellRect(){var e;const t=this.getEditedCell();if(!t)return;const{wtOverlays:n,wtViewport:r}=this.hot.view._wt,i=this.hot.rootWindow,o=Up(t),s=Kp(t),a=Up(this.hot.rootElement),l=Kp(this.hot.rootElement),h=n.topOverlay.holder,u=n.inlineStartOverlay.holder,c=h!==i?h.scrollTop:0,d=u!==i?u.scrollLeft:0,p=i.innerWidth-a.left-l,{wtTable:g}=null!==(e=n.getParentOverlay(t))&&void 0!==e?e:this.hot.view._wt,m=g.name,f=["master","inline_start"].includes(m)?c:0,w=["master","top","bottom"].includes(m)?d:0,y=o.top===a.top?0:1;let v=o.top-a.top-y-f,C=0;C=this.hot.isRtl()?i.innerWidth-o.left-s-p-1+w:o.left-a.left-1-w,["top","top_inline_start_corner"].includes(m)&&(v+=n.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(m)&&(C+=Math.abs(n.inlineStartOverlay.getOverlayOffset()));const S=this.hot.hasColHeaders(),R=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),E=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),b=this.hot.rowIndexMapper.getRenderableIndexesLength()-this.hot.view._wt.getSetting("fixedRowsBottom");(S&&R<=0||R===b)&&(v+=1),E<=0&&(C+=1);const T=r.rowsRenderCalculator.startPosition,N=r.columnsRenderCalculator.startPosition,A=Math.abs(n.inlineStartOverlay.getScrollPosition()),M=n.topOverlay.getScrollPosition(),I=ng(this.hot.rootDocument);let O=t.offsetTop;if(["inline_start","master"].includes(m)&&(O+=T-M),["bottom","bottom_inline_start_corner"].includes(m)){const{wtViewport:e,wtTable:t}=n.bottomOverlay.clone;O+=e.getWorkspaceHeight()-t.getHeight()-I}let x=t.offsetLeft;this.hot.isRtl()?(x=x>=0?g.getWidth()-t.offsetLeft:Math.abs(x),x+=N-A-s):["top","master","bottom"].includes(m)&&(x+=N-A);const P=i.getComputedStyle(this.TD),_=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",L=parseInt(P[_],10)>0?0:1,H=parseInt(P.borderTopWidth,10)>0?0:1,k=Kp(t)+L,F=Xp(t)+H,D=rg(h)?I:0,V=ig(u)?I:0,U=this.hot.view.maximumVisibleElementWidth(x)-D+L;return{top:v,start:C,height:F,maxHeight:Math.max(this.hot.view.maximumVisibleElementHeight(O)-V+H,this.hot.view.getDefaultRowHeight()),width:k,maxWidth:U}}getEditedCellsLayerClass(){switch(this.checkEditorSection()){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}getEditedCell(){return this.hot.getCell(this.row,this.col,!0)}checkEditorSection(){const e=this.hot.countRows();let t="";return this.row<this.hot.getSettings().fixedRowsTop?t=this.col<this.hot.getSettings().fixedColumnsStart?"top-inline-start-corner":"top":this.hot.getSettings().fixedRowsBottom&&this.row>=e-this.hot.getSettings().fixedRowsBottom?t=this.col<this.hot.getSettings().fixedColumnsStart?"bottom-inline-start-corner":"bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(t="inline-start"),t}}Zg(GA,BA);const zA={name:"editorCloseAndSaveByArrowKeys",callback(e,t,n){const r=e._getEditorManager(),i=r.getActiveEditor();i.isInFullEditMode()&&i.state===jA.EDITING||(r.closeEditorAndSaveChanges(),e.getSelected()&&(n.includes("arrowdown")?e.selection.transformStart(1,0):n.includes("arrowup")?e.selection.transformStart(-1,0):n.includes("arrowleft")?e.selection.transformStart(0,-1*e.getDirectionFactor()):n.includes("arrowright")&&e.selection.transformStart(0,e.getDirectionFactor())),t.preventDefault())}},$A={name:"editorCloseAndSaveByEnter",callback(e,t){const n=e._getEditorManager();n.closeEditorAndSaveChanges(t.ctrlKey||t.metaKey),n.moveSelectionAfterEnter(t)}},YA={name:"editorCloseWithoutSaving",callback(e){const t=e._getEditorManager();t.closeEditorAndRestoreOriginalValue(e.getShortcutManager().isCtrlPressed()),t.activeEditor.focus()}},KA={name:"editorFastOpen",callback(e,t){const{highlight:n}=e.getSelectedRangeLast();n.isHeader()||e._getEditorManager().openEditor(null,t,!0)}},XA={name:"editorOpen",callback(e,t,n){const r=e._getEditorManager(),i=e.getSelectedRangeLast(),{highlight:o}=i;if(e.selection.isMultiple()&&!i.isHeader()&&e.countRenderedCols()>0&&e.countRenderedRows()>0){const r=e.getSettings(),i="function"==typeof r.enterMoves?r.enterMoves(t):r.enterMoves;n.includes("shift")?e.selection.transformFocus(-i.row,-i.col):e.selection.transformFocus(i.row,i.col)}else o.isHeader()||(e.getSettings().enterBeginsEditing?r.cellProperties.readOnly?r.moveSelectionAfterEnter(t):r.openEditor(null,t,!0):r.moveSelectionAfterEnter(t),Nm(t))}};const qA=[VA,zA,$A,YA,KA,XA,{name:"extendCellsSelectionDown",callback(e){const{highlight:t}=e.getSelectedRangeLast();e.selection.isSelectedByColumnHeader()||e.selection.isSelectedByCorner()||!(t.isCell()||t.isHeader()&&e.selection.isSelectedByRowHeader())||e.selection.transformEnd(1,0)}},{name:"extendCellsSelectionDownByViewportHeight",callback(e){const{to:t}=e.getSelectedRangeLast(),n=Math.min(t.row+e.countVisibleRows(),e.countRows()-1),r=e.rowIndexMapper.getNearestNotHiddenIndex(n,-1);if(null!==r){const n=e._createCellCoords(r,t.col),i=t.row-e.getFirstFullyVisibleRow(),o=Math.min(n.row-i,e.countRows()-1);e.selection.setRangeEnd(n),e.scrollViewportTo({row:o,verticalSnap:"top",horizontalSnap:"start"})}}},{name:"extendCellsSelectionLeft",callback(e){const{highlight:t}=e.getSelectedRangeLast();e.selection.isSelectedByRowHeader()||e.selection.isSelectedByCorner()||!(t.isCell()||t.isHeader()&&e.selection.isSelectedByColumnHeader())||e.selection.transformEnd(0,-1*e.getDirectionFactor())}},{name:"extendCellsSelectionRight",callback(e){const{highlight:t}=e.getSelectedRangeLast();e.selection.isSelectedByRowHeader()||e.selection.isSelectedByCorner()||!(t.isCell()||t.isHeader()&&e.selection.isSelectedByColumnHeader())||e.selection.transformEnd(0,e.getDirectionFactor())}},{name:"extendCellsSelectionToColumns",callback(e){const{highlight:t,from:n,to:r}=e.getSelectedRangeLast();e.selection.isSelectedByRowHeader()?e.selection.selectAll(!0,!0):e.selectColumns(n.col,r.col,t)}},{name:"extendCellsSelectionToMostBottom",callback(e){const{selection:t,rowIndexMapper:n}=e,{highlight:r,from:i,to:o}=e.getSelectedRangeLast(),s=r.isHeader()&&e.selection.isSelectedByRowHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(e.countRows()-1,-1),l=i.clone();l.row=r.row,t.setRangeStart(l,void 0,!1,r.clone()),s&&t.selectedByRowHeader.add(t.getLayerLevel()),t.setRangeEnd(e._createCellCoords(a,o.col))}}},{name:"extendCellsSelectionToMostInlineEnd",callback(e){const{selection:t,columnIndexMapper:n}=e,{highlight:r,from:i,to:o}=e.getSelectedRangeLast();if(!e.selection.isSelectedByRowHeader()&&!e.selection.isSelectedByCorner()&&r.isCell()){const s=n.getNearestNotHiddenIndex(e.countCols()-1,-1),a=i.clone();a.col=r.col,t.setRangeStart(a,void 0,!1,r.clone()),t.setRangeEnd(e._createCellCoords(o.row,s))}}},{name:"extendCellsSelectionToMostInlineStart",callback(e){const{selection:t,columnIndexMapper:n}=e,{highlight:r,from:i,to:o}=e.getSelectedRangeLast();if(!e.selection.isSelectedByRowHeader()&&!e.selection.isSelectedByCorner()&&r.isCell()){const s=parseInt(e.getSettings().fixedColumnsStart,10),a=n.getNearestNotHiddenIndex(s,1),l=i.clone();l.col=r.col,t.setRangeStart(l,void 0,!1,r.clone()),t.setRangeEnd(e._createCellCoords(o.row,a))}}},{name:"extendCellsSelectionToMostLeft",callback(e){const{selection:t,columnIndexMapper:n}=e,{highlight:r,from:i,to:o}=e.getSelectedRangeLast(),s=r.isHeader()&&e.selection.isSelectedByColumnHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(...e.isRtl()?[e.countCols()-1,-1]:[0,1]),l=i.clone();l.col=r.col,t.setRangeStart(l,void 0,!1,r.clone()),s&&t.selectedByColumnHeader.add(t.getLayerLevel()),t.setRangeEnd(e._createCellCoords(o.row,a))}}},{name:"extendCellsSelectionToMostRight",callback(e){const{selection:t,columnIndexMapper:n}=e,{highlight:r,from:i,to:o}=e.getSelectedRangeLast(),s=r.isHeader()&&e.selection.isSelectedByColumnHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(...e.isRtl()?[0,1]:[e.countCols()-1,-1]),l=i.clone();l.col=r.col,t.setRangeStart(l,void 0,!1,r.clone()),s&&t.selectedByColumnHeader.add(t.getLayerLevel()),t.setRangeEnd(e._createCellCoords(o.row,a))}}},{name:"extendCellsSelectionToMostTop",callback(e){const{selection:t,rowIndexMapper:n}=e,{highlight:r,from:i,to:o}=e.getSelectedRangeLast(),s=r.isHeader()&&e.selection.isSelectedByRowHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(0,1),l=i.clone();l.row=r.row,t.setRangeStart(l,void 0,!1,r.clone()),s&&t.selectedByRowHeader.add(t.getLayerLevel()),t.setRangeEnd(e._createCellCoords(a,o.col))}}},{name:"extendCellsSelectionToRows",callback(e){const{highlight:t,from:n,to:r}=e.getSelectedRangeLast();e.selection.isSelectedByColumnHeader()?e.selection.selectAll(!0,!0):e.selectRows(n.row,r.row,t)}},{name:"extendCellsSelectionUp",callback(e){const{highlight:t}=e.getSelectedRangeLast();e.selection.isSelectedByColumnHeader()||e.selection.isSelectedByCorner()||!(t.isCell()||t.isHeader()&&e.selection.isSelectedByRowHeader())||e.selection.transformEnd(-1,0)}},{name:"extendCellsSelectionUpByViewportHeight",callback(e){const{to:t}=e.getSelectedRangeLast(),n=Math.max(t.row-e.countVisibleRows(),0),r=e.rowIndexMapper.getNearestNotHiddenIndex(n,1);if(null!==r){const n=e._createCellCoords(r,t.col),i=t.row-e.getFirstFullyVisibleRow(),o=Math.max(n.row-i,0);e.selection.setRangeEnd(n),e.scrollViewportTo({row:o,verticalSnap:"top",horizontalSnap:"start"})}}},{name:"moveCellSelectionDown",callback(e){let{selection:t}=e;t.transformStart(1,0)}},{name:"moveCellSelectionDownByViewportHeight",callback(e){const{navigableHeaders:t}=e.getSettings(),n=t?e.countColHeaders():0,{row:r}=e.getSelectedRangeLast().highlight;let i=e.countVisibleRows()+n;i=0===i?1:i,r===e.countRows()-1?i=1:r+i>e.countRows()&&(i=e.countRows()-r-1),e.selection.transformStart(i,0),e.getSelectedRangeLast().highlight.row<0&&e.scrollViewportTo({row:0})}},{name:"moveCellSelectionInlineEnd",callback(e,t){const n=e.getSettings(),r=e.getSelectedRangeLast(),i="function"==typeof n.tabMoves?n.tabMoves(t):n.tabMoves;e.selection.isMultiple()&&!r.isHeader()&&e.countRenderedCols()>0&&e.countRenderedRows()>0?e.selection.transformFocus(-i.row,-i.col):e.selection.transformStart(-i.row,-i.col)}},{name:"moveCellSelectionInlineStart",callback(e,t){const n=e.getSettings(),r=e.getSelectedRangeLast(),i="function"==typeof n.tabMoves?n.tabMoves(t):n.tabMoves;e.selection.isMultiple()&&!r.isHeader()&&e.countRenderedCols()>0&&e.countRenderedRows()>0?e.selection.transformFocus(i.row,i.col):e.selection.transformStart(i.row,i.col)}},{name:"moveCellSelectionLeft",callback(e){e.selection.transformStart(0,-1*e.getDirectionFactor())}},{name:"moveCellSelectionRight",callback(e){e.selection.transformStart(0,e.getDirectionFactor())}},{name:"moveCellSelectionToMostBottom",callback(e){const{col:t}=e.getSelectedRangeLast().highlight;let n=e.rowIndexMapper.getNearestNotHiddenIndex(e.countRows()-1,-1);null===n&&(n=-1),e.selection.setRangeStart(e._createCellCoords(n,t))}},{name:"moveCellSelectionToMostBottomInlineEnd",callback(e){const{selection:t,rowIndexMapper:n,columnIndexMapper:r}=e,i=parseInt(e.getSettings().fixedRowsBottom,10),o=n.getNearestNotHiddenIndex(e.countRows()-i-1,-1),s=r.getNearestNotHiddenIndex(e.countCols()-1,-1);t.setRangeStart(e._createCellCoords(o,s))}},{name:"moveCellSelectionToMostInlineEnd",callback(e){const{selection:t,columnIndexMapper:n}=e;t.setRangeStart(e._createCellCoords(e.getSelectedRangeLast().highlight.row,n.getNearestNotHiddenIndex(e.countCols()-1,-1)))}},{name:"moveCellSelectionToMostInlineStart",callback(e){const{selection:t,columnIndexMapper:n}=e,r=parseInt(e.getSettings().fixedColumnsStart,10),i=e.getSelectedRangeLast().highlight.row,o=n.getNearestNotHiddenIndex(r,1);t.setRangeStart(e._createCellCoords(i,o))}},{name:"moveCellSelectionToMostLeft",callback(e){const{selection:t,columnIndexMapper:n}=e,r=e.getSelectedRangeLast().highlight.row;let i=n.getNearestNotHiddenIndex(...e.isRtl()?[e.countCols()-1,-1]:[0,1]);null===i&&(i=e.isRtl()?-1:-e.countRowHeaders()),t.setRangeStart(e._createCellCoords(r,i))}},{name:"moveCellSelectionToMostRight",callback(e){const{selection:t,columnIndexMapper:n}=e,{row:r}=e.getSelectedRangeLast().highlight;let i=n.getNearestNotHiddenIndex(...e.isRtl()?[0,1]:[e.countCols()-1,-1]);null===i&&(i=e.isRtl()?-e.countRowHeaders():-1),t.setRangeStart(e._createCellCoords(r,i))}},{name:"moveCellSelectionToMostTop",callback(e){const{col:t}=e.getSelectedRangeLast().highlight;let n=e.rowIndexMapper.getNearestNotHiddenIndex(0,1);null===n&&(n=-e.countColHeaders()),e.selection.setRangeStart(e._createCellCoords(n,t))}},{name:"moveCellSelectionToMostTopInlineStart",callback(e){const{selection:t,rowIndexMapper:n,columnIndexMapper:r}=e,i=parseInt(e.getSettings().fixedRowsTop,10),o=parseInt(e.getSettings().fixedColumnsStart,10),s=n.getNearestNotHiddenIndex(i,1),a=r.getNearestNotHiddenIndex(o,1);t.setRangeStart(e._createCellCoords(s,a))}},{name:"moveCellSelectionUp",callback(e){let{selection:t}=e;t.transformStart(-1,0)}},{name:"moveCellSelectionUpByViewportHight",callback(e){const{navigableHeaders:t}=e.getSettings(),n=t?e.countColHeaders():0,{row:r}=e.getSelectedRangeLast().highlight;let i=e.countVisibleRows()+n;i=0===i?-1:-i,r===-n?i=-1:r+i<n&&(i=-(r+n)),e.selection.transformStart(i,0),e.getSelectedRangeLast().highlight.row<0&&e.scrollViewportTo({row:0})}},{name:"emptySelectedCells",callback(e){e.emptySelectedCells(),e._getEditorManager().prepareEditor()}},{name:"scrollToFocusedCell",callback(e){const{highlight:t}=e.getSelectedRangeLast(),n=e.getFirstFullyVisibleRow()-1,r=e.getFirstFullyVisibleColumn()-1,i=e.getLastFullyVisibleRow()+1,o=e.getLastFullyVisibleColumn()+1,s=e._createCellCoords(n,r),a=e._createCellCoords(i,o);if(!e._createCellRange(s,s,a).includes(t)&&(t.row>=0||t.col>=0)){const n={};if(t.col>=0){const r=Math.floor(e.countVisibleCols()/2);n.col=Math.max(t.col-r,0)}if(t.row>=0){const r=Math.floor(e.countVisibleRows()/2);n.row=Math.max(t.row-r,0)}e.scrollViewportTo({...n,verticalSnap:"top",horizontalSnap:"start"})}}},{name:"selectAllCells",callback(e){e.selection.selectAll(!0,!0,{disableHeadersHighlight:!0})}},{name:"selectAllCellsAndHeaders",callback(e){e.selection.selectAll(!0,!0,{disableHeadersHighlight:!1})}},{name:"populateSelectedCellsData",callback(e){const t=e.getSelectedRange(),{row:n,col:r}=t[t.length-1].highlight.normalize(),i=e.getDataAtCell(n,r),o=new Map;for(let s=0;s<t.length;s++)t[s].forAll(((t,s)=>{if(t>=0&&s>=0&&(t!==n||s!==r)){const{readOnly:n}=e.getCellMeta(t,s);n||o.set(`${t}x${s}`,[t,s,i])}}));e.setDataAtCell(Array.from(o.values()))}}];function QA(e){const t={};return qA.forEach((n=>{let{name:r,callback:i}=n;t[r]=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return i(e,...n)}})),t}function ZA(e){const t=e.getShortcutManager().addContext("editor"),n=QA(e),r={group:DA};t.addShortcuts([{keys:[["Enter"],["Enter","Shift"]],callback:(e,t)=>n.editorCloseAndSaveByEnter(e,t)},{keys:[["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],captureCtrl:!0,callback:(e,t)=>n.editorCloseAndSaveByEnter(e,t)},{keys:[["Tab"],["Tab","Shift"],["PageDown"],["PageUp"]],forwardToContext:e.getShortcutManager().getContext("grid"),callback:(e,t)=>n.editorCloseAndSave(e,t)},{keys:[["ArrowDown"],["ArrowUp"],["ArrowLeft"],["ArrowRight"]],preventDefault:!1,callback:(e,t)=>n.editorCloseAndSaveByArrowKeys(e,t)},{keys:[["Escape"],["Escape","Control/Meta"]],callback:()=>n.editorCloseWithoutSaving()}],r)}function JA(e){const t=e.getShortcutManager().addContext("grid"),n=QA(e),r={runOnlyIf:()=>{const{navigableHeaders:t}=e.getSettings();return Gd(e.getSelected())&&(t||!t&&e.countRenderedRows()>0&&e.countRenderedCols()>0)},group:FA};t.addShortcuts([{keys:[["F2"]],callback:e=>n.editorFastOpen(e)},{keys:[["Enter"],["Enter","Shift"]],callback:(e,t)=>n.editorOpen(e,t)},{keys:[["Backspace"],["Delete"]],callback:()=>n.emptySelectedCells()}],{group:DA,runOnlyIf:()=>Gd(e.getSelected())}),t.addShortcuts([{keys:[["Control/Meta","A"]],callback:()=>n.selectAllCells(),runOnlyIf:()=>{var t;return!(null!==(t=e.getSelectedRangeLast())&&void 0!==t&&t.highlight.isHeader())}},{keys:[["Control/Meta","A"]],callback:()=>{},runOnlyIf:()=>{var t;return null===(t=e.getSelectedRangeLast())||void 0===t?void 0:t.highlight.isHeader()},preventDefault:!0},{keys:[["Control/Meta","Shift","Space"]],callback:()=>n.selectAllCellsAndHeaders()},{keys:[["Control/Meta","Enter"]],callback:()=>n.populateSelectedCellsData(),runOnlyIf:()=>{var t,n;return!(null!==(t=e.getSelectedRangeLast())&&void 0!==t&&t.highlight.isHeader())&&(null===(n=e.getSelectedRangeLast())||void 0===n?void 0:n.getCellsCount())>1}},{keys:[["Control","Space"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToColumns()},{keys:[["Shift","Space"]],stopPropagation:!0,callback:()=>n.extendCellsSelectionToRows()},{keys:[["ArrowUp"]],callback:()=>n.moveCellSelectionUp()},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostTop()},{keys:[["ArrowUp","Shift"]],callback:()=>n.extendCellsSelectionUp()},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostTop(),runOnlyIf:()=>!(e.selection.isSelectedByCorner()||e.selection.isSelectedByColumnHeader())},{keys:[["ArrowDown"]],callback:()=>n.moveCellSelectionDown()},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostBottom()},{keys:[["ArrowDown","Shift"]],callback:()=>n.extendCellsSelectionDown()},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostBottom(),runOnlyIf:()=>!(e.selection.isSelectedByCorner()||e.selection.isSelectedByColumnHeader())},{keys:[["ArrowLeft"]],callback:()=>n.moveCellSelectionLeft()},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostLeft()},{keys:[["ArrowLeft","Shift"]],callback:()=>n.extendCellsSelectionLeft()},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostLeft(),runOnlyIf:()=>!(e.selection.isSelectedByCorner()||e.selection.isSelectedByRowHeader())},{keys:[["ArrowRight"]],callback:()=>n.moveCellSelectionRight()},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostRight()},{keys:[["ArrowRight","Shift"]],callback:()=>n.extendCellsSelectionRight()},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostRight(),runOnlyIf:()=>!(e.selection.isSelectedByCorner()||e.selection.isSelectedByRowHeader())},{keys:[["Home"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostInlineStart(),runOnlyIf:()=>e.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["Home","Shift"]],callback:()=>n.extendCellsSelectionToMostInlineStart()},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostTopInlineStart(),runOnlyIf:()=>e.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostInlineEnd(),runOnlyIf:()=>e.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End","Shift"]],callback:()=>n.extendCellsSelectionToMostInlineEnd()},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostBottomInlineEnd(),runOnlyIf:()=>e.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["PageUp"]],callback:()=>n.moveCellSelectionUpByViewportHight()},{keys:[["PageUp","Shift"]],callback:()=>n.extendCellsSelectionUpByViewportHeight()},{keys:[["PageDown"]],callback:()=>n.moveCellSelectionDownByViewportHeight()},{keys:[["PageDown","Shift"]],callback:()=>n.extendCellsSelectionDownByViewportHeight()},{keys:[["Tab"]],preventDefault:!1,callback:e=>n.moveCellSelectionInlineStart(e)},{keys:[["Shift","Tab"]],preventDefault:!1,callback:e=>n.moveCellSelectionInlineEnd(e)},{keys:[["Control/Meta","Backspace"]],callback:()=>n.scrollToFocusedCell()}],r)}function eM(e){const t=e.rootDocument.createElement("input");return t.type="text",t.name="__htFocusCatcher",t.classList.add("htFocusCatcher"),e.getSettings().ariaTags&&Pp(t,[["role","presentation"],["aria-hidden","true"]]),t}function tM(e){const t=function(e){return t=>{if(!t)return null;const n=nM(e),r=rM(e);return t.col<n.col&&(t.col=n.col),t.col>r.col&&(t.col=r.col),t.row<n.row&&(t.row=n.row),t.row>r.row&&(t.row=r.row),t}}(e);let n;const{activate:r,deactivate:i}=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=e.rootElement,r=eM(e),i=eM(e);return r.addEventListener("focus",(()=>null==t?void 0:t.onFocusFromTop())),i.addEventListener("focus",(()=>null==t?void 0:t.onFocusFromBottom())),n.firstChild.before(r),n.lastChild.after(i),{activate(){e._registerTimeout((()=>{r.tabIndex=0,i.tabIndex=0}),10)},deactivate(){e._registerTimeout((()=>{r.tabIndex=-1,i.tabIndex=-1}),10)}}}(e,{onFocusFromTop(){var r;const i=null!==(r=t(n))&&void 0!==r?r:nM(e);i&&(e.runHooks("modifyFocusOnTabNavigation","from_above",i),e.selectCell(i.row,i.col)),e.listen()},onFocusFromBottom(){var r;const i=null!==(r=t(n))&&void 0!==r?r:rM(e);i&&(e.runHooks("modifyFocusOnTabNavigation","from_below",i),e.selectCell(i.row,i.col)),e.listen()}}),o={wrapped:!1,flipped:!1};let s=!0,a=!1,l=!1;e.addHook("afterListen",(()=>i())),e.addHook("afterUnlisten",(()=>r())),e.addHook("afterSelection",((t,r,i,h,u)=>{var c;(a&&(o.wrapped&&o.flipped||l)&&(l=!1,u.value=!0),s)&&(n=null===(c=e.getSelectedRangeLast())||void 0===c?void 0:c.highlight)})),e.addHook("beforeRowWrap",((e,t,n)=>{o.wrapped=!0,o.flipped=n}));const h={keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:FA,group:"focusCatcher"};e.getShortcutManager().getContext("grid").addShortcuts([{...h,callback:()=>{const{tabNavigation:t}=e.getSettings();a=!0,e.getSelectedRangeLast()&&!t&&(s=!1),t||(l=!0)},position:"before"},{...h,callback:t=>{const{tabNavigation:r,autoWrapRow:i}=e.getSettings();if(a=!1,s=!0,!r||!e.selection.isSelected()||i&&o.wrapped&&o.flipped||!i&&o.wrapped)return i&&o.wrapped&&o.flipped&&(n=t.shiftKey?nM(e):rM(e)),o.wrapped=!1,o.flipped=!1,e.deselectCell(),e.unlisten(),!1;t.preventDefault()},position:"after"}])}function nM(e){const{rowIndexMapper:t,columnIndexMapper:n}=e,{navigableHeaders:r}=e.getSettings();let i=r&&e.countColHeaders()>0?-e.countColHeaders():0,o=r&&e.countRowHeaders()>0?-e.countRowHeaders():0;return 0===i&&(i=t.getVisualFromRenderableIndex(i)),0===o&&(o=n.getVisualFromRenderableIndex(o)),null===i||null===o?null:e._createCellCoords(i,o)}function rM(e){var t,n;const{rowIndexMapper:r,columnIndexMapper:i}=e,{navigableHeaders:o}=e.getSettings();let s=r.getRenderableIndexesLength()-1,a=i.getRenderableIndexesLength()-1;if(s<0){if(!o||0===e.countColHeaders())return null;s=-1}if(a<0){if(!o||0===e.countColHeaders())return null;a=-1}return e._createCellCoords(null!==(t=r.getVisualFromRenderableIndex(s))&&void 0!==t?t:s,null!==(n=i.getVisualFromRenderableIndex(a))&&void 0!==n?n:a)}const iM=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),oM=e=>e.map((e=>{const t=e.toLowerCase();return iM.has(t)?iM.get(t):t})).sort().join("+"),sM=new Map([[96,"numpad0"],[97,"numpad1"],[98,"numpad2"],[99,"numpad3"],[100,"numpad4"],[101,"numpad5"],[102,"numpad6"],[103,"numpad7"],[104,"numpad8"],[105,"numpad9"],[106,"multiply"],[107,"add"],[108,"decimal"],[109,"subtract"],[110,"decimal"],[111,"divide"],[112,"f1"],[113,"f2"],[114,"f3"],[115,"f4"],[116,"f5"],[117,"f6"],[118,"f7"],[119,"f8"],[120,"f9"],[121,"f10"],[122,"f11"],[123,"f12"],[186,"semicolon"],[187,"equal"],[188,"comma"],[189,"minus"],[190,"period"],[191,"slash"],[192,"backquote"],[219,"bracketleft"],[220,"backslash"],[221,"bracketright"],[222,"quote"]]),aM=e=>{let{which:t,key:n}=e;if(sM.has(t))return sM.get(t);const r=String.fromCharCode(t).toLowerCase();return/^[a-z0-9]$/.test(r)?r:n.toLowerCase()},lM=Symbol("shortcut-context");function hM(e){return em(e)&&e.__kindOf===lM}const uM=["meta","alt","shift","control"],cM=function(){const e=new Set;return{press(t){e.add(t)},release(t){e.delete(t)},releaseAll(){e.clear()},isPressed:t=>e.has(t)}}(),dM=[];let pM=0;const gM=e=>{let{ownerWindow:t,handleEvent:n,beforeKeyDown:r,afterKeyDown:i}=e;const o=ty({errorIdExists:e=>`The "${e}" context name is already registered.`});let s="grid";const a=()=>s,l=e=>o.getItem(e);let h=!1;const u=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:a();const r=hM(n)?n:l(n);let i=!1;if(!r.hasShortcut(t))return i;const o=r.getShortcuts(t);for(let s=0;s<o.length;s++){const{callback:n,runOnlyIf:r,preventDefault:a,stopPropagation:l,captureCtrl:c,forwardToContext:d}=o[s];if(!0===r(e)){if(h=c,i=!1===n(e,t),h=!1,a&&e.preventDefault(),l&&(Nm(e),e.stopPropagation()),i)break;d&&u(e,t,d)}}return i},c=function(e,t,n,r,i){const o=e=>uM.includes(e),s=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=[];return e.altKey&&n.push("alt"),t&&(e.ctrlKey||e.metaKey)?n.push("control/meta"):(e.ctrlKey&&n.push("control"),e.metaKey&&n.push("meta")),e.shiftKey&&n.push("shift"),n},a=e=>{if(!1===t(e))return;if(!1===n(e)||229===e.keyCode||"string"!=typeof e.key||Am(e))return;const a=aM(e);let l=[];o(a)||(l=s(e));const h=[a].concat(l);!i(e,h)&&(Sm()&&l.includes("meta")||!Sm()&&l.includes("control"))&&i(e,[a].concat(s(e,!0))),r(e)},l=e=>{if("string"==typeof e.key){const t=aM(e);o(t)&&cM.press(t)}},h=e=>{if("string"==typeof e.key){const t=aM(e);o(t)&&cM.release(t)}},u=()=>{cM.releaseAll()};return{mount:()=>{let t=e;for(pM+=1;t;)1===pM&&(t.document.documentElement.addEventListener("keydown",l),dM.push({event:"keydown",listener:l}),t.document.documentElement.addEventListener("keyup",h),dM.push({event:"keyup",listener:h})),t.document.documentElement.addEventListener("keydown",a),t.document.documentElement.addEventListener("blur",u),t=Rp(t)},unmount:()=>{let t=e;for(pM-=1;t;){if(0===pM){for(let e=0;e<dM.length;e++){const{event:n,listener:r}=dM[e];t.document.documentElement.removeEventListener(n,r)}dM.length=0}t.document.documentElement.removeEventListener("keydown",a),t.document.documentElement.removeEventListener("blur",u),t=Rp(t)}},isPressed:e=>cM.isPressed(e),releasePressedKeys:()=>cM.releaseAll()}}(t,n,r,i,u);return c.mount(),{addContext:e=>{const t=(e=>{const t=ty({errorIdExists:t=>`The "${t}" shortcut is already registered in the "${e}" context.`}),n=function(){let{keys:e,callback:n,group:r,runOnlyIf:i=()=>!0,captureCtrl:o=!1,preventDefault:s=!0,stopPropagation:a=!1,relativeToGroup:l,position:h,forwardToContext:u}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(zd(r))throw new Error("You need to define the shortcut's group.");if(!1===pg(n))throw new Error("The shortcut's callback needs to be a function.");if(!1===Array.isArray(e))throw new Error(Wd`Pass the shortcut\'s keys as an array of arrays,\x20
      using the KeyboardEvent.key properties:\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`);const c={callback:n,group:r,runOnlyIf:i,captureCtrl:o,preventDefault:s,stopPropagation:a};Gd(l)&&(c.relativeToGroup=l,c.position=h),hM(u)&&(c.forwardToContext=u),e.forEach((e=>{const n=oM(e);if(t.hasItem(n)){const e=t.getItem(n);let r=e.findIndex((e=>e.group===l));-1!==r?"before"===h?r-=1:r+=1:r=e.length,e.splice(r,0,c)}else t.addItem(n,[c])}))},r=e=>{const n=oM(e);t.removeItem(n)};return{__kindOf:lM,addShortcut:n,addShortcuts:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e.forEach((e=>{nm(t,((n,r)=>{!1===Object.prototype.hasOwnProperty.call(e,r)&&(e[r]=t[r])})),n(e)}))},getShortcuts:e=>{const n=oM(e),r=t.getItem(n);return Gd(r)?r.slice():[]},hasShortcut:e=>{const n=oM(e);return t.hasItem(n)},removeShortcutsByKeys:r,removeShortcutsByGroup:e=>{t.getItems().forEach((t=>{let[n,i]=t;const o=i.filter((t=>t.group!==e));0===o.length?r((e=>e.split("+"))(n)):(i.length=0,i.push(...o))}))}}})(e);return o.addItem(e,t),t},getActiveContextName:a,getContext:l,setActiveContextName:e=>{if(!o.hasItem(e))throw new Error(Wd`You've tried to activate the "${e}" shortcut context\x20
        that does not exist. Before activation, register the context using the "addContext" method.`);s=e},isCtrlPressed:()=>!h&&(c.isPressed("control")||c.isPressed("meta")),releasePressedKeys:()=>c.releasePressedKeys(),destroy:()=>c.unmount()}};function mM(e){const{classNames:t}=function(e,t){const n={element:void 0,classNames:[]};let r=e;for(;null!==r&&r!==e.ownerDocument.documentElement&&!n.element;){if("string"==typeof t&&r.classList.contains(t))n.element=r,n.classNames.push(t);else if(t instanceof RegExp){const e=Array.from(r.classList).filter((e=>t.test(e)));e.length&&(n.element=r,n.classNames.push(...e))}r=r.parentElement}return n}(e,/ht-theme-[a-zA-Z0-9_-]+/);return t.pop()}let fM=null;const wM=new Map;function yM(e,t){var n,r=this;let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=this;const s=new Of(o);let a,l,h,u,c,d,p=!0;var g;zR(i)&&(g=this,jR.set(g,!0)),this.rootElement=e,this.rootDocument=e.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;const m=null!==(n=null==t?void 0:t.layoutDirection)&&void 0!==n?n:"inherit",f=["rtl","ltr"].includes(m)?m:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",f),this.isRtl=function(){return"rtl"===f},this.isLtr=function(){return!o.isRtl()},this.getDirectionFactor=function(){return o.isLtr()?1:-1},t.language=function(e){let t=lb(e);return QT(t)||(t=GT,hb(e)),t}(t.language);const w=new MA(o,t,[xA,kA]),y=w.getTableMeta(),v=w.getGlobalMeta(),C=ty();this.container=this.rootDocument.createElement("div"),this.renderCall=!1,e.insertBefore(this.container,e.firstChild),$R(this)&&(np(t.licenseKey,e),Op(e,"ht-wrapper")),this.guid=`ht_${ip()}`,wM.set(this.guid,this),this.columnIndexMapper=new ab,this.rowIndexMapper=new ab,this.columnIndexMapper.addLocalHook("indexesSequenceChange",(e=>{o.runHooks("afterColumnSequenceChange",e)})),this.rowIndexMapper.addLocalHook("indexesSequenceChange",(e=>{o.runHooks("afterRowSequenceChange",e)})),l=new vE(o),this.rootElement.id&&"ht_"!==this.rootElement.id.substring(0,3)||(this.rootElement.id=this.guid);let S=new ZN(y,{rowIndexMapper:o.rowIndexMapper,columnIndexMapper:o.columnIndexMapper,countCols:()=>o.countCols(),countRows:()=>o.countRows(),propToCol:e=>a.propToCol(e),isEditorOpened:()=>!!o.getActiveEditor()&&o.getActiveEditor().isOpened(),countRenderableColumns:()=>this.view.countRenderableColumns(),countRenderableRows:()=>this.view.countRenderableRows(),countRowHeaders:()=>this.countRowHeaders(),countColHeaders:()=>this.countColHeaders(),countRenderableRowsInRange:function(){return r.view.countRenderableRowsInRange(...arguments)},countRenderableColumnsInRange:function(){return r.view.countRenderableColumnsInRange(...arguments)},getShortcutManager:()=>o.getShortcutManager(),createCellCoords:(e,t)=>o._createCellCoords(e,t),createCellRange:(e,t,n)=>o._createCellRange(e,t,n),visualToRenderableCoords:e=>{const{row:t,col:n}=e;return o._createCellCoords(t>=0?o.rowIndexMapper.getRenderableFromVisualIndex(t):t,n>=0?o.columnIndexMapper.getRenderableFromVisualIndex(n):n)},renderableToVisualCoords:e=>{const{row:t,col:n}=e;return o._createCellCoords(t>=0?o.rowIndexMapper.getVisualFromRenderableIndex(t):t,n>=0?o.columnIndexMapper.getVisualFromRenderableIndex(n):n)},findFirstNonHiddenRenderableRow:(e,t)=>{const n=t>e?1:-1,r=Math.min(e,t),i=Math.max(e,t),s=o.rowIndexMapper.getNearestNotHiddenIndex(e,n);return null===s||1===n&&s>i||-1===n&&s<r?null:s>=0?o.rowIndexMapper.getRenderableFromVisualIndex(s):s},findFirstNonHiddenRenderableColumn:(e,t)=>{const n=t>e?1:-1,r=Math.min(e,t),i=Math.max(e,t),s=o.columnIndexMapper.getNearestNotHiddenIndex(e,n);return null===s||1===n&&s>i||-1===n&&s<r?null:s>=0?o.columnIndexMapper.getRenderableFromVisualIndex(s):s},isDisabledCellSelection:(e,t)=>e<0||t<0?o.getSettings().disableVisualSelection:o.getCellMeta(e,t).disableVisualSelection});this.selection=S;const R=e=>{let{hiddenIndexesChanged:t}=e;t&&this.selection.commit()};function E(e){const t=lb(e);QT(t)?(o.runHooks("beforeLanguageChange",t),v.language=t,o.runHooks("afterLanguageChange",t)):hb(e)}function b(e,t){const n="className"===e?o.rootElement:o.table;if(p)Op(n,t);else{let r=[],i=[];v[e]&&(r=Array.isArray(v[e])?v[e]:Bd(v[e])),t&&(i=Array.isArray(t)?t:Bd(t));const o=Ud(r,i),s=Ud(i,r);o.length&&xp(n,o),s.length&&Op(n,s)}v[e]=t}function T(){let e=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue(){this.validatorsInQueue+=1,e=!1},removeValidatorFormQueue(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty(){},checkIfQueueIsEmpty(){0===this.validatorsInQueue&&!1===e&&(e=!0,this.onQueueEmpty(this.valid))}}}function N(e){const t=e.replace(",",".");return!1===isNaN(parseFloat(t))?parseFloat(t):e}function A(e,t,n){if(!e.length)return void n();const r=o.getActiveEditor(),i=new T;let s=!0;i.onQueueEmpty=()=>{r&&s&&r.cancelChanges(),n()};for(let l=e.length-1;l>=0;l--){const[n,r]=e[l],h=a.propToCol(r);let u;u=Number.isInteger(h)?o.getCellMeta(n,h):{...Object.getPrototypeOf(y),...y},o.getCellValidator(u)&&(i.addValidatorToQueue(),o.validateCell(e[l][3],u,function(t,n){return function(r){if("boolean"!=typeof r)throw new Error("Validation error: result is not boolean");!1===r&&!1===n.allowInvalid&&(s=!1,e.splice(t,1),n.valid=!0),i.removeValidatorFormQueue()}}(l,u),t))}i.checkIfQueueIsEmpty()}function M(e,t){for(let r=e.length-1;r>=0;r--){let t=!1;if(null!==e[r]){if(null!==e[r][2]&&void 0!==e[r][2]||null!==e[r][3]&&void 0!==e[r][3]){if(y.allowInsertRow)for(;e[r][0]>o.countRows()-1;){const{delta:e}=a.createRow(void 0,void 0,{source:"auto"});if(0===e){t=!0;break}}if("array"===o.dataType&&(!y.columns||0===y.columns.length)&&y.allowInsertColumn)for(;a.propToCol(e[r][1])>o.countCols()-1;){const{delta:e}=a.createCol(void 0,void 0,{source:"auto"});if(0===e){t=!0;break}}t||a.set(e[r][0],e[r][1],e[r][3])}}else e.splice(r,1)}const n=e.length>0;if(o.forceFullRender=!0,n){h.adjustRowsAndCols(),o.runHooks("beforeChangeRender",e,t),u.closeEditor(),o.view.render(),u.prepareEditor(),o.view.adjustElementsSize(),o.runHooks("afterChange",e,t||"edit");const n=o.getActiveEditor();n&&Gd(n.refreshValue)&&n.refreshValue()}else o.view.render()}function I(e,t,n){return Array.isArray(e)?e:[[e,t,n]]}function O(e,t){const n=o.runHooks("beforeChange",e,t||"edit"),r=e.filter((e=>null!==e));var i;if(!1===n||0===r.length)return null===(i=o.getActiveEditor())||void 0===i||i.cancelChanges(),[];for(let s=r.length-1;s>=0;s--){const[e,t,,n]=r[s],i=a.propToCol(t);let l;l=Number.isInteger(i)?o.getCellMeta(e,i):{...Object.getPrototypeOf(y),...y},"numeric"===l.type&&"string"==typeof n&&zw(n,[","])&&(r[s][3]=N(n))}return r}this.columnIndexMapper.addLocalHook("cacheUpdated",R),this.rowIndexMapper.addLocalHook("cacheUpdated",R),this.selection.addLocalHook("afterSetRangeEnd",((e,t)=>{const n=om(!1),r=this.selection.getSelectedRange(),{from:i,to:s}=r.current(),a=r.size()-1;this.runHooks("afterSelection",i.row,i.col,s.row,s.col,n,a),this.runHooks("afterSelectionByProp",i.row,o.colToProp(i.col),s.row,o.colToProp(s.col),n,a),t&&(!n.isTouched()||n.isTouched()&&!n.value)&&d.scrollTo(e);const l=S.isSelectedByRowHeader(),h=S.isSelectedByColumnHeader();l&&h?Op(this.rootElement,["ht__selection--rows","ht__selection--columns"]):l?(xp(this.rootElement,"ht__selection--columns"),Op(this.rootElement,"ht__selection--rows")):h?(xp(this.rootElement,"ht__selection--rows"),Op(this.rootElement,"ht__selection--columns")):xp(this.rootElement,["ht__selection--rows","ht__selection--columns"]),"shift"!==S.getSelectionSource()&&u.closeEditor(null),o.view.render(),u.prepareEditor()})),this.selection.addLocalHook("beforeSetFocus",(e=>{this.runHooks("beforeSelectionFocusSet",e.row,e.col)})),this.selection.addLocalHook("afterSetFocus",(e=>{const t=om(!1);this.runHooks("afterSelectionFocusSet",e.row,e.col,t),(!t.isTouched()||t.isTouched()&&!t.value)&&d.scrollTo(e),u.closeEditor(),o.view.render(),u.prepareEditor()})),this.selection.addLocalHook("afterSelectionFinished",(e=>{const t=e.length-1,{from:n,to:r}=e[t];this.runHooks("afterSelectionEnd",n.row,n.col,r.row,r.col,t),this.runHooks("afterSelectionEndByProp",n.row,o.colToProp(n.col),r.row,o.colToProp(r.col),t)})),this.selection.addLocalHook("afterIsMultipleSelection",(e=>{const t=this.runHooks("afterIsMultipleSelection",e.value);e.value&&(e.value=t)})),this.selection.addLocalHook("afterDeselect",(()=>{u.closeEditor(),o.view.render(),xp(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this.runHooks("afterDeselect")})),this.selection.addLocalHook("beforeHighlightSet",(()=>this.runHooks("beforeSelectionHighlightSet"))).addLocalHook("beforeSetRangeStart",(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.runHooks("beforeSetRangeStart",...t)})).addLocalHook("beforeSetRangeStartOnly",(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.runHooks("beforeSetRangeStartOnly",...t)})).addLocalHook("beforeSetRangeEnd",(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.runHooks("beforeSetRangeEnd",...t)})).addLocalHook("beforeSelectColumns",(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.runHooks("beforeSelectColumns",...t)})).addLocalHook("afterSelectColumns",(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.runHooks("afterSelectColumns",...t)})).addLocalHook("beforeSelectRows",(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.runHooks("beforeSelectRows",...t)})).addLocalHook("afterSelectRows",(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.runHooks("afterSelectRows",...t)})).addLocalHook("beforeModifyTransformStart",(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.runHooks("modifyTransformStart",...t)})).addLocalHook("afterModifyTransformStart",(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.runHooks("afterModifyTransformStart",...t)})).addLocalHook("beforeModifyTransformFocus",(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.runHooks("modifyTransformFocus",...t)})).addLocalHook("afterModifyTransformFocus",(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.runHooks("afterModifyTransformFocus",...t)})).addLocalHook("beforeModifyTransformEnd",(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.runHooks("modifyTransformEnd",...t)})).addLocalHook("afterModifyTransformEnd",(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.runHooks("afterModifyTransformEnd",...t)})).addLocalHook("beforeRowWrap",(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.runHooks("beforeRowWrap",...t)})).addLocalHook("beforeColumnWrap",(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.runHooks("beforeColumnWrap",...t)})).addLocalHook("insertRowRequire",(e=>this.alter("insert_row_above",e,1,"auto"))).addLocalHook("insertColRequire",(e=>this.alter("insert_col_start",e,1,"auto"))),h={alter(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0;const s=e=>{if(0===e.length)return[];const t=[...e];t.sort(((e,t)=>{let[n]=e,[r]=t;return n===r?0:n>r?1:-1}));return kd(t,((e,t)=>{let[n,r]=t;const i=e[e.length-1],[o,s]=i,a=o+s;if(n<=a){const e=Math.max(r-(a-n),0);i[1]+=e}else e.push([n,r]);return e}),[t[0]])};switch(e){case"insert_row_below":case"insert_row_above":const i=o.countSourceRows();if(y.maxRows===i)return;const l="insert_row_below"===e?"below":"above";t=null!=t?t:"below"===l?i:0;const{delta:h,startPhysicalIndex:c}=a.createRow(t,n,{source:r,mode:l});S.shiftRows(o.toVisualRow(c),h);break;case"insert_col_start":case"insert_col_end":const d="insert_col_end"===e?"end":"start";t=null!=t?t:"end"===d?o.countSourceCols():0;const{delta:p,startPhysicalIndex:g}=a.createCol(t,n,{source:r,mode:d});if(p){if(Array.isArray(y.colHeaders)){const e=[o.toVisualColumn(g),0];e.length+=p,Array.prototype.splice.apply(y.colHeaders,e)}S.shiftColumns(o.toVisualColumn(g),p)}break;case"remove_row":const m=e=>{let t=0;Vd(e,(e=>{let[n,i]=e;const s=$d(n)?o.countRows()-1:Math.max(n-t,0);Number.isInteger(n)&&(n=Math.max(n-t,0));if(!a.removeRow(n,i,r))return;if(S.isSelected()){const{row:e}=o.getSelectedRangeLast().highlight;e>=n&&e<=n+i-1&&u.closeEditor(!0)}const l=o.countRows();0===l?S.deselect():"ContextMenu.removeRow"===r?S.refresh():S.shiftRows(n,-i);const h=y.fixedRowsTop;h>=s+1&&(y.fixedRowsTop-=Math.min(i,h-s));const c=y.fixedRowsBottom;c&&s>=l-c&&(y.fixedRowsBottom-=Math.min(i,c)),t+=i}))};Array.isArray(t)?m(s(t)):m([[t,n]]);break;case"remove_col":const f=e=>{let t=0;Vd(e,(e=>{let[n,i]=e;const s=$d(n)?o.countCols()-1:Math.max(n-t,0);let l=o.toPhysicalColumn(s);Number.isInteger(n)&&(n=Math.max(n-t,0));if(!a.removeCol(n,i,r))return;if(S.isSelected()){const{col:e}=o.getSelectedRangeLast().highlight;e>=n&&e<=n+i-1&&u.closeEditor(!0)}0===o.countCols()?S.deselect():"ContextMenu.removeColumn"===r?S.refresh():S.shiftColumns(n,-i);const h=y.fixedColumnsStart;h>=s+1&&(y.fixedColumnsStart-=Math.min(i,h-s)),Array.isArray(y.colHeaders)&&(void 0===l&&(l=-1),y.colHeaders.splice(l,i)),t+=i}))};Array.isArray(t)?f(s(t)):f([[t,n]]);break;default:throw new Error(`There is no such action "${e}"`)}i||h.adjustRowsAndCols(),o.view.render(),o.view.adjustElementsSize()},adjustRowsAndCols(){const e=y.minRows,t=y.minSpareRows,n=y.minCols,r=y.minSpareCols;if(e){const t=o.countRows();t<e&&a.createRow(t,e-t,{source:"auto"})}if(t){const e=o.countEmptyRows(!0);if(e<t){const n=t-e,r=Math.min(n,y.maxRows-o.countSourceRows());a.createRow(o.countRows(),r,{source:"auto"})}}{let e;(n||r)&&(e=o.countEmptyCols(!0));let t=o.countCols();if(n&&!y.columns&&t<n){const r=n-t;e+=r,a.createCol(t,r,{source:"auto"})}if(r&&!y.columns&&"array"===o.dataType&&e<r){t=o.countCols();const n=r-e,i=Math.min(n,y.maxCols-t);a.createCol(t,i,{source:"auto"})}}},populateFromArray(e,t,n,r,i){let s,a,l,h;const u=[],c={},d=[],p=e.row,g=e.col;if(a=t.length,0===a)return!1;let m=0,f=0;switch(em(n)&&(m=n.col-g+1,f=n.row-p+1),i){case"shift_down":const i=Hd(t),w=i.length,v=Math.max(w,m),C=o.getData().slice(p),S=Hd(C).slice(g,g+v);for(l=0;l<v;l+=1)if(l<w){for(s=0,a=i[l].length;s<f-a;s+=1)i[l].push(i[l][s%a]);l<S.length?d.push(i[l].concat(S[l])):d.push(i[l].concat(new Array(C.length).fill(null)))}else d.push(i[l%w].concat(S[l]));o.populateFromArray(p,g,Hd(d));break;case"shift_right":const R=t.length,E=Math.max(R,f),b=o.getData().slice(p).map((e=>e.slice(g)));for(s=0;s<E;s+=1)if(s<R){for(l=0,h=t[s].length;l<m-h;l+=1)t[s].push(t[s][l%h]);if(s<b.length)for(let e=0;e<b[s].length;e+=1)t[s].push(b[s][e]);else t[s].push(...new Array(b[0].length).fill(null))}else t.push(t[s%a].slice(0,E).concat(b[s]));o.populateFromArray(p,g,t);break;default:c.row=e.row,c.col=e.col;let T,N=0,A=0,M=!0;const I=function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const r=t[e%t.length];return null!==n?r[n%r.length]:r},O=t.length,x=n?n.row-e.row+1:0;for(a=n?x:Math.max(O,x),s=0;s<a&&!(n&&c.row>n.row&&x>O||!y.allowInsertRow&&c.row>o.countRows()-1||c.row>=y.maxRows);s++){const t=s-N,i=I(t).length,d=n?n.col-e.col+1:0;if(h=n?d:Math.max(i,d),c.col=e.col,T=o.getCellMeta(c.row,c.col),"CopyPaste.paste"!==r&&"Autofill.fill"!==r||!T.skipRowOnPaste){for(A=0,l=0;l<h&&!(n&&c.col>n.col&&d>i||!y.allowInsertColumn&&c.col>o.countCols()-1||c.col>=y.maxCols);l++){if(T=o.getCellMeta(c.row,c.col),("CopyPaste.paste"===r||"Autofill.fill"===r)&&T.skipColumnOnPaste){A+=1,c.col+=1,h+=1;continue}if(T.readOnly&&"UndoRedo.undo"!==r){c.col+=1;continue}let e=I(t,l-A),n=o.getDataAtCell(c.row,c.col);if(null!==e&&"object"==typeof e)if(Array.isArray(e)&&null===n&&(n=[]),null===n||"object"!=typeof n)M=!1;else{const t=Yg(Array.isArray(n)?n:n[0]||n),r=Yg(Array.isArray(e)?e:e[0]||e);Jg(t,r)||Array.isArray(t)&&Array.isArray(r)?e=qg(e):M=!1}else null!==n&&"object"==typeof n&&(M=!1);M&&u.push([c.row,c.col,e]),M=!0,c.col+=1}c.row+=1}else N+=1,c.row+=1,a+=1}o.setDataAtCell(u,null,null,r||"populateFromArray")}}},this.init=function(){l.setData(y.data),o.runHooks("beforeInit"),(wm()||vm())&&Op(o.rootElement,"mobile"),this.updateSettings(y,!0),this.view=new cE(this);const e=y.themeName||mM(o.rootElement);o.useTheme(e),o.view.addClassNameToLicenseElement(o.getCurrentThemeName()),u=Vf.getInstance(o,y,S),d=function(e){const{selection:t}=e;let n=!1,r=!1;return{resume(){r=!1},suspend(){r=!0},skipNextScrollCycle(){n=!0},scrollTo(i){var o;if(n||r)return void(n=!1);let s;t.isFocusSelectionChanged()?s=function(e){return t=>{e.scrollViewportTo(t.toObject())}}(e):t.isSelectedByCorner()?s=()=>{}:t.isSelectedByRowHeader()?s=function(e){return t=>{let{row:n}=t;e.scrollViewportTo({row:n})}}(e):t.isSelectedByColumnHeader()?s=function(e){return t=>{let{col:n}=t;e.scrollViewportTo({col:n})}}(e):1===t.getSelectedRange().size()&&t.isMultiple()?s=function(e){return t=>{e.scrollViewportTo(t.toObject())}}(e):1!==t.getSelectedRange().size()||t.isMultiple()?t.getSelectedRange().size()>1&&(s=function(e){return t=>{e.scrollViewportTo(t.toObject())}}(e)):s=function(e){return t=>{const n=e.selection.getSelectionSource(),{row:r,col:i}=t;if(r<0&&i>=0)e.scrollViewportTo({col:i});else if(i<0&&r>=0)e.scrollViewportTo({row:r});else{if("mouse"===n&&(i===e.view.getLastPartiallyVisibleColumn()||r===e.view.getLastPartiallyVisibleRow()))return;e.scrollViewportTo({row:r,col:i})}}}(e),null===(o=s)||void 0===o||o(i)}}}(o),c=new Zf(o),$R(this)&&tM(o),o.runHooks("init"),this.forceFullRender=!0,this.view.render(),p&&null===o.rootElement.offsetParent&&function(e,t){const n=new IntersectionObserver(((n,r)=>{n.forEach((n=>{n.isIntersecting&&null!==e.offsetParent&&(t(),r.unobserve(e))}))}),{root:e.ownerDocument.body});n.observe(e)}(o.rootElement,(()=>{o.view._wt.wtOverlays.updateLastSpreaderSize(),o.render(),o.view.adjustElementsSize()})),"object"==typeof p&&(o.runHooks("afterChange",p[0],p[1]),p=!1),o.runHooks("afterInit")},this._createCellCoords=function(e,t){return o.view._wt.createCellCoords(e,t)},this._createCellRange=function(e,t,n){return o.view._wt.createCellRange(e,t,n)},this.validateCell=function(e,t,n,r){let i=o.getCellValidator(t);function s(e){if(!(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])||!0===t.hidden)return void n(e);const r=t.visualCol,i=t.visualRow,s=o.getCell(i,r,!0);if(s&&"TH"!==s.nodeName){const e=o.rowIndexMapper.getRenderableFromVisualIndex(i),t=o.columnIndexMapper.getRenderableFromVisualIndex(r);o.view._wt.getSetting("cellRenderer",e,t,s)}n(e)}var a,l;l=i,"[object RegExp]"===Object.prototype.toString.call(l)&&(a=i,i=function(e,t){t(a.test(e))}),pg(i)?(e=o.runHooks("beforeValidate",e,t.visualRow,t.prop,r),o._registerImmediate((()=>{i.call(t,e,(n=>{o&&(n=o.runHooks("afterValidate",n,e,t.visualRow,t.prop,r),t.valid=n,s(n),o.runHooks("postAfterValidate",n,e,t.visualRow,t.prop,r))}))}))):o._registerImmediate((()=>{t.valid=!0,s(t.valid,!1)}))},this.setDataAtCell=function(e,t,n,r){const i=I(e,t,n),s=[];let h,u,c,d=r;for(h=0,u=i.length;h<u;h++){if("object"!=typeof i[h])throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if("number"!=typeof i[h][1])throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");c=i[h][1]>=this.countCols()?i[h][1]:a.colToProp(i[h][1]),s.push([i[h][0],c,l.getAtCell(this.toPhysicalRow(i[h][0]),i[h][1]),i[h][2]])}d||"object"!=typeof e||(d=t);const p=O(s,d);o.runHooks("afterSetDataAtCell",p,d),A(p,d,(()=>{M(p,d)}))},this.setDataAtRowProp=function(e,t,n,r){const i=I(e,t,n),s=[];let a,h,u=r;for(a=0,h=i.length;a<h;a++)s.push([i[a][0],i[a][1],l.getAtCell(this.toPhysicalRow(i[a][0]),i[a][1]),i[a][2]]);u||"object"!=typeof e||(u=t);const c=O(s,r);o.runHooks("afterSetDataAtRowProp",c,u),A(c,u,(()=>{M(c,u)}))},this.listen=function(){o&&!o.isListening()&&(wM.forEach((e=>{o!==e&&e.unlisten()})),fM=o.guid,o.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(fM=null,o.runHooks("afterUnlisten"))},this.isListening=function(){return fM===o.guid},this.destroyEditor=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];u.closeEditor(e),o.view.render(),t&&S.isSelected()&&u.prepareEditor()},this.populateFromArray=function(e,t,n,r,i,s,a){if("object"!=typeof n||"object"!=typeof n[0])throw new Error("populateFromArray parameter `input` must be an array of arrays");const l="number"==typeof r?o._createCellCoords(r,i):null;return h.populateFromArray(o._createCellCoords(e,t),n,l,s,a)},this.spliceCol=function(e,t,n){for(var r=arguments.length,i=new Array(r>3?r-3:0),o=3;o<r;o++)i[o-3]=arguments[o];return a.spliceCol(e,t,n,...i)},this.spliceRow=function(e,t,n){for(var r=arguments.length,i=new Array(r>3?r-3:0),o=3;o<r;o++)i[o-3]=arguments[o];return a.spliceRow(e,t,n,...i)},this.getSelected=function(){if(S.isSelected())return Dd(S.getSelectedRange(),(e=>{let{from:t,to:n}=e;return[t.row,t.col,n.row,n.col]}))},this.getSelectedLast=function(){const e=this.getSelected();let t;return e&&e.length>0&&(t=e[e.length-1]),t},this.getSelectedRange=function(){if(S.isSelected())return Array.from(S.getSelectedRange())},this.getSelectedRangeLast=function(){const e=this.getSelectedRange();let t;return e&&e.length>0&&(t=e[e.length-1]),t},this.emptySelectedCells=function(e){if(!S.isSelected()||0===this.countRows()||0===this.countCols())return;const t=[];Vd(S.getSelectedRange(),(e=>{if(e.isSingleHeader())return;const n=e.getTopStartCorner(),r=e.getBottomEndCorner();$w(n.row,r.row,(e=>{$w(n.col,r.col,(n=>{this.getCellMeta(e,n).readOnly||t.push([e,n,null])}))}))})),t.length>0&&this.setDataAtCell(t,e)},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){const e=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(e,0),this.isRenderSuspended()||e!==this.renderSuspendedCounter||(this.renderCall?this.render():o.view.render())},this.render=function(){this.view&&(this.renderCall=!0,this.forceFullRender=!0,this.isRenderSuspended()||o.view.render())},this.batchRender=function(e){this.suspendRender();const t=e();return this.resumeRender(),t},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(t,0),(!this.isExecutionSuspended()&&t===this.executionSuspendedCounter||e)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.suspendExecution();const n=e();return this.resumeExecution(t),n},this.batch=function(e){this.suspendRender(),this.suspendExecution();const t=e();return this.resumeExecution(),this.resumeRender(),t},this.refreshDimensions=function(){if(!o.view)return;const e=o.view,{width:t,height:n}=e.getLastSize(),{width:r,height:i}=o.rootElement.getBoundingClientRect(),s=r!==t||i!==n;!1===o.runHooks("beforeRefreshDimensions",{width:t,height:n},{width:r,height:i},s)||((s||e._wt.wtOverlays.scrollableElement===o.rootWindow)&&(e.setLastSize(r,i),o.render(),e.adjustElementsSize()),o.runHooks("afterRefreshDimensions",{width:t,height:n},{width:r,height:i},s))},this.updateData=function(e,t){IA(e,(e=>{a=e}),(e=>{a=e,o.columnIndexMapper.fitToLength(this.getInitialColumnCount()),o.rowIndexMapper.fitToLength(this.countSourceRows()),h.adjustRowsAndCols(),S.refresh()}),{hotInstance:o,dataMap:a,dataSource:l,internalSource:"updateData",source:t,metaManager:w,firstRun:p})},this.loadData=function(e,t){IA(e,(e=>{a=e}),(()=>{w.clearCellsCache(),o.initIndexMappers(),h.adjustRowsAndCols(),S.refresh(),p&&(p=[null,"loadData"])}),{hotInstance:o,dataMap:a,dataSource:l,internalSource:"loadData",source:t,metaManager:w,firstRun:p})},this.getInitialColumnCount=function(){const e=y.columns;let t=0;if(Array.isArray(e))t=e.length;else if(pg(e))if("array"===o.dataType){const n=this.countSourceCols();for(let r=0;r<n;r+=1)e(r)&&(t+=1)}else"object"!==o.dataType&&"function"!==o.dataType||(t=a.colToPropCache.length);else if(Gd(y.dataSchema)){const e=a.getSchema();t=Array.isArray(e)?e.length:im(e)}else t=this.countSourceCols();return t},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(e,t,n,r){return zd(e)?a.getAll():a.getRange(o._createCellCoords(e,t),o._createCellCoords(n,r),a.DESTINATION_RENDERER)},this.getCopyableText=function(e,t,n,r){return a.getCopyableText(o._createCellCoords(e,t),o._createCellCoords(n,r))},this.getCopyableData=function(e,t){return a.getCopyable(e,a.colToProp(t))},this.getSchema=function(){return a.getSchema()},this.updateSettings=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=(p?o.loadData:o.updateData).bind(this);let r,i,s=!1;if(Gd(e.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(Gd(e.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(Gd(e.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');for(r in e)"data"===r||("language"===r?E(e.language):"className"===r?b("className",e.className):"tableClassName"===r&&o.table?(b("tableClassName",e.tableClassName),o.view._wt.wtOverlays.syncOverlayTableClassNames()):mf.getSingleton().isRegistered(r)||mf.getSingleton().isDeprecated(r)?pg(e[r])?mf.getSingleton().addAsFixed(r,e[r],o):Array.isArray(e[r])&&mf.getSingleton().add(r,e[r],o):!t&&sm(e,r)&&(v[r]=e[r]));void 0===e.data&&void 0===y.data?n(null,"updateSettings"):void 0!==e.data?n(e.data,"updateSettings"):void 0!==e.columns&&(a.createMap(),o.initIndexMappers());const l=o.countCols(),u=y.columns;if(u&&pg(u)&&(s=!0),void 0===e.cell&&void 0===e.cells&&void 0===e.columns||w.clearCache(),l>0)for(r=0,i=0;r<l;r++){if(u){const e=s?u(r):u[i];e&&w.updateColumnMeta(i,e)}i+=1}Gd(e.cell)&&nm(e.cell,(e=>{o.setCellMetaObject(e.row,e.col,e)})),o.runHooks("afterCellMetaReset");let c=o.rootElement.style.height;""!==c&&(c=parseInt(o.rootElement.style.height,10));let d=e.height;if(pg(d)&&(d=d()),t){o.rootElement.getAttribute("style")&&o.rootElement.setAttribute("data-initialstyle",o.rootElement.getAttribute("style"))}if(null===d){const e=o.rootElement.getAttribute("data-initialstyle");e&&(e.indexOf("height")>-1||e.indexOf("overflow")>-1)?o.rootElement.setAttribute("style",e):(o.rootElement.style.height="",o.rootElement.style.overflow="")}else void 0!==d&&(o.rootElement.style.height=isNaN(d)?`${d}`:`${d}px`,o.rootElement.style.overflow="hidden");if(void 0!==e.width){let t=e.width;pg(t)&&(t=t()),o.rootElement.style.width=isNaN(t)?`${t}`:`${t}px`}if(!t){if(o.view){o.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),o.view._wt.exportSettingsAsClassNames();const t=o.getCurrentThemeName(),n=sm(e,"themeName");t&&n&&t!==e.themeName&&(o.view.getStylesHandler().removeClassNames(),o.view.removeClassNameFromLicenseElement(t));const r=n&&e.themeName||mM(o.rootElement);o.useTheme(r),o.view.addClassNameToLicenseElement(o.getCurrentThemeName())}o.runHooks("afterUpdateSettings",e)}h.adjustRowsAndCols(),o.view&&!p&&(o.forceFullRender=!0,o.view.render(),o.view._wt.wtOverlays.adjustElementsSize()),t||!o.view||""!==c&&""!==d&&void 0!==d||c===d||o.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){const e=o.getSelectedLast();if(y.getValue){if(pg(y.getValue))return y.getValue.call(o);if(e)return o.getData()[e[0][0]][y.getValue]}else if(e)return o.getDataAtCell(e[0],e[1])},this.getSettings=function(){return y},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(e,t,n,r,i){h.alter(e,t,n,r,i)},this.getCell=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=t,i=e;if(t>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(t)))return null;r=this.columnIndexMapper.getRenderableFromVisualIndex(t)}if(e>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(e)))return null;i=this.rowIndexMapper.getRenderableFromVisualIndex(e)}return null===i||null===r||void 0===i||void 0===r?null:o.view.getCellAtCoords(o._createCellCoords(i,r),n)},this.getCoords=function(e){const t=this.view._wt.wtTable.getCoords(e);if(null===t)return null;const{row:n,col:r}=t;let i=n,s=r;return n>=0&&(i=this.rowIndexMapper.getVisualFromRenderableIndex(n)),r>=0&&(s=this.columnIndexMapper.getVisualFromRenderableIndex(r)),o._createCellCoords(i,s)},this.colToProp=function(e){return a.colToProp(e)},this.propToCol=function(e){return a.propToCol(e)},this.toVisualRow=e=>this.rowIndexMapper.getVisualFromPhysicalIndex(e),this.toVisualColumn=e=>this.columnIndexMapper.getVisualFromPhysicalIndex(e),this.toPhysicalRow=e=>this.rowIndexMapper.getPhysicalFromVisualIndex(e),this.toPhysicalColumn=e=>this.columnIndexMapper.getPhysicalFromVisualIndex(e),this.getDataAtCell=function(e,t){return a.get(e,a.colToProp(t))},this.getDataAtRowProp=function(e,t){return a.get(e,t)},this.getDataAtCol=function(e){const t=[],n=a.getRange(o._createCellCoords(0,e),o._createCellCoords(y.data.length-1,e),a.DESTINATION_RENDERER);for(let r=0;r<n.length;r+=1)for(let e=0;e<n[r].length;e+=1)t.push(n[r][e]);return t},this.getDataAtProp=function(e){const t=[],n=a.getRange(o._createCellCoords(0,a.propToCol(e)),o._createCellCoords(y.data.length-1,a.propToCol(e)),a.DESTINATION_RENDERER);for(let r=0;r<n.length;r+=1)for(let e=0;e<n[r].length;e+=1)t.push(n[r][e]);return t},this.getSourceData=function(e,t,n,r){let i;return i=void 0===e?l.getData():l.getByRange(o._createCellCoords(e,t),o._createCellCoords(n,r)),i},this.getSourceDataArray=function(e,t,n,r){let i;return i=void 0===e?l.getData(!0):l.getByRange(o._createCellCoords(e,t),o._createCellCoords(n,r),!0),i},this.getSourceDataAtCol=function(e){return l.getAtColumn(e)},this.setSourceDataAtCell=function(e,t,n,r){const i=I(e,t,n),s=this.hasHook("afterSetSourceDataAtCell"),a=[];s&&Vd(i,(e=>{let[t,n,r]=e;a.push([t,n,l.getAtCell(t,n),r])})),Vd(i,(e=>{let[t,n,r]=e;l.setAtCell(t,n,r)})),s&&this.runHooks("afterSetSourceDataAtCell",a,r),this.render();const h=o.getActiveEditor();h&&Gd(h.refreshValue)&&h.refreshValue()},this.getSourceDataAtRow=function(e){return l.getAtRow(e)},this.getSourceDataAtCell=function(e,t){return l.getAtCell(e,t)},this.getDataAtRow=function(e){return a.getRange(o._createCellCoords(e,0),o._createCellCoords(e,this.countCols()-1),a.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(e,t,n,r){const i=void 0===e?[0,0,this.countRows(),this.countCols()]:[e,t,n,r],[o,s]=i;let[,,a,l]=i,h=null,u=null;void 0===a&&(a=o),void 0===l&&(l=s);let c="mixed";return $w(Math.max(Math.min(o,a),0),Math.max(o,a),(e=>{let t=!0;return $w(Math.max(Math.min(s,l),0),Math.max(s,l),(n=>{const r=this.getCellMeta(e,n);return u=r.type,h?t=h===u:h=u,t})),c=t?u:"mixed",t})),c},this.removeCellMeta=function(e,t,n){const[r,i]=[this.toPhysicalRow(e),this.toPhysicalColumn(t)];let s=w.getCellMetaKeyValue(r,i,n);!1!==o.runHooks("beforeRemoveCellMeta",e,t,n,s)&&(w.removeCellMeta(r,i,n),o.runHooks("afterRemoveCellMeta",e,t,n,s)),s=null},this.spliceCellsMeta=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if(r.length>0&&!Array.isArray(r[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");t>0&&w.removeRow(this.toPhysicalRow(e),t),r.length>0&&Vd(r.reverse(),(t=>{w.createRow(this.toPhysicalRow(e)),Vd(t,((t,n)=>this.setCellMetaObject(e,n,t)))})),o.render()},this.setCellMetaObject=function(e,t,n){"object"==typeof n&&nm(n,((n,r)=>{this.setCellMeta(e,t,r,n)}))},this.setCellMeta=function(e,t,n,r){if(!1===o.runHooks("beforeSetCellMeta",e,t,n,r))return;let i=e,s=t;e<this.countRows()&&(i=this.toPhysicalRow(e)),t<this.countCols()&&(s=this.toPhysicalColumn(t)),w.setCellMeta(i,s,n,r),o.runHooks("afterSetCellMeta",e,t,n,r)},this.getCellsMeta=function(){return w.getCellsMeta()},this.getCellMeta=function(e,t){let n=this.toPhysicalRow(e),r=this.toPhysicalColumn(t);return null===n&&(n=e),null===r&&(r=t),w.getCellMeta(n,r,{visualRow:e,visualColumn:t})},this.getColumnMeta=function(e){return w.getColumnMeta(this.toPhysicalColumn(e))},this.getCellMetaAtRow=function(e){return w.getCellsMetaAtRow(e)},this.isColumnModificationAllowed=function(){return!("object"===o.dataType||y.columns)},this.getCellRenderer=function(e,t){const n="number"==typeof e?o.getCellMeta(e,t).renderer:e.renderer;return"string"==typeof n?my(n):zd(n)?my("text"):n},this.getCellEditor=function(e,t){const n="number"==typeof e?o.getCellMeta(e,t).editor:e.editor;return"string"==typeof n?Af(n):zd(n)?Af("text"):n},this.getCellValidator=function(e,t){const n="number"==typeof e?o.getCellMeta(e,t).validator:e.validator;return"string"==typeof n?function(e){if("function"==typeof e)return e;if(!vy(e))throw Error(`No registered validator found under "${e}" name`);return yy(e)}(n):n},this.validateCells=function(e){this._validateCells(e)},this.validateRows=function(e,t){if(!Array.isArray(e))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(t,e)},this.validateColumns=function(e,t){if(!Array.isArray(e))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(t,void 0,e)},this._validateCells=function(e,t,n){const r=new T;e&&(r.onQueueEmpty=e);let i=o.countRows()-1;for(;i>=0;){if(void 0!==t&&-1===t.indexOf(i)){i-=1;continue}let e=o.countCols()-1;for(;e>=0;)void 0===n||-1!==n.indexOf(e)?(r.addValidatorToQueue(),o.validateCell(o.getDataAtCell(i,e),o.getCellMeta(i,e),(e=>{if("boolean"!=typeof e)throw new Error("Validation error: result is not boolean");!1===e&&(r.valid=!1),r.removeValidatorFormQueue()}),"validateCells"),e-=1):e-=1;i-=1}r.checkIfQueueIsEmpty()},this.getRowHeader=function(e){let t=y.rowHeaders,n=e;return void 0!==n&&(n=o.runHooks("modifyRowHeader",n)),void 0===n?(t=[],$w(o.countRows()-1,(e=>{t.push(o.getRowHeader(e))}))):Array.isArray(t)&&void 0!==t[n]?t=t[n]:pg(t)?t=t(n):t&&"string"!=typeof t&&"number"!=typeof t&&(t=n+1),t},this.hasRowHeaders=function(){return!!y.rowHeaders},this.hasColHeaders=function(){if(void 0!==y.colHeaders&&null!==y.colHeaders)return!!y.colHeaders;for(let e=0,t=o.countCols();e<t;e++)if(o.getColHeader(e))return!0;return!1},this.getColHeader=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;const n=o.runHooks("modifyColHeader",e);if(void 0===n){const e=[],t=o.countCols();for(let n=0;n<t;n++)e.push(o.getColHeader(n));return e}let r=y.colHeaders;const i=o.toPhysicalColumn(n),s=function(e){const t=[],n=o.countCols();let r=0;for(;r<n;r++)pg(y.columns)&&y.columns(r)&&t.push(r);return t[e]}(i);return!1===y.colHeaders?r=null:y.columns&&pg(y.columns)&&y.columns(s)&&y.columns(s).title?r=y.columns(s).title:y.columns&&y.columns[i]&&y.columns[i].title?r=y.columns[i].title:Array.isArray(y.colHeaders)&&void 0!==y.colHeaders[i]?r=y.colHeaders[i]:pg(y.colHeaders)?r=y.colHeaders(i):y.colHeaders&&"string"!=typeof y.colHeaders&&"number"!=typeof y.colHeaders&&(r=function(e){let t,n=e+1,r="";for(;n>0;)t=(n-1)%26,r=String.fromCharCode(65+t)+r,n=parseInt((n-t)/26,10);return r}(n)),r=o.runHooks("modifyColumnHeaderValue",r,e,t),r},this._getColWidthFromSettings=function(e){let t;if(e>=0){t=o.getCellMeta(0,e).width}if(void 0!==t&&t!==y.width||(t=y.colWidths),null!=t){switch(typeof t){case"object":t=t[e];break;case"function":t=t(e)}"string"==typeof t&&(t=parseInt(t,10))}return t},this.getColWidth=function(e,t){let n=o._getColWidthFromSettings(e);return n=o.runHooks("modifyColWidth",n,e,t),void 0===n&&(n=Zy),n},this._getRowHeightFromSettings=function(e){const t=this.view.getDefaultRowHeight();let n=y.rowHeights;if(null!=n){switch(typeof n){case"object":n=n[e];break;case"function":n=n(e)}"string"==typeof n&&(n=parseInt(n,10))}return null!=n&&n<t?t:n},this.getRowHeight=function(e,t){let n=o._getRowHeightFromSettings(e);return n=o.runHooks("modifyRowHeight",n,e,t),n},this.countSourceRows=function(){return l.countRows()},this.countSourceCols=function(){return l.countFirstRowKeys()},this.countRows=function(){return a.getLength()},this.countCols=function(){const e=y.maxCols,t=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(e,t)},this.countRenderedRows=function(){return o.view._wt.drawn?o.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return o.view._wt.drawn?o.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return o.view._wt.drawn?o.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return o.view._wt.drawn?o.view._wt.wtTable.getVisibleColumnsCount():-1},this.countRowHeaders=function(){return this.view.getRowHeadersCount()},this.countColHeaders=function(){return this.view.getColumnHeadersCount()},this.countEmptyRows=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=0;return Yw(o.countRows()-1,(n=>{if(o.isEmptyRow(n))t+=1;else if(!0===e)return!1})),t},this.countEmptyCols=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=0;return Yw(o.countCols()-1,(n=>{if(o.isEmptyCol(n))t+=1;else if(!0===e)return!1})),t},this.isEmptyRow=function(e){return y.isEmptyRow.call(o,e)},this.isEmptyCol=function(e){return y.isEmptyCol.call(o,e)},this.selectCell=function(e,t,n,r){let i=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],o=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];return!zd(e)&&!zd(t)&&this.selectCells([[e,t,n,r]],i,o)},this.selectCells=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[[]],t=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];!1===(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&d.suspend();const n=S.selectCells(e);return n&&t&&o.listen(),d.resume(),n},this.selectColumns=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,n=arguments.length>2?arguments[2]:void 0;return S.selectColumns(e,t,n)},this.selectRows=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,n=arguments.length>2?arguments[2]:void 0;return S.selectRows(e,t,n)},this.deselectCell=function(){S.deselect()},this.selectAll=function(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,n=arguments.length>2?arguments[2]:void 0;d.skipNextScrollCycle(),S.selectAll(e,t,n)};const x=(e,t)=>e.getNearestNotHiddenIndex(t,1,!0);this.scrollViewportTo=function(e){var t;"number"==typeof e&&(e={row:arguments[0],col:arguments[1],verticalSnap:arguments[2]?"bottom":"top",horizontalSnap:arguments[3]?"end":"start",considerHiddenIndexes:null===(t=arguments[4])||void 0===t||t});const{row:n,col:r,considerHiddenIndexes:i}=null!=e?e:{};let s=n,a=r;if(void 0===i||i){const e=Number.isInteger(n)&&n>=0,t=Number.isInteger(r)&&r>=0,i=e?x(this.rowIndexMapper,n):void 0,l=t?x(this.columnIndexMapper,r):void 0;if(null===i||null===l)return!1;s=e?o.rowIndexMapper.getRenderableFromVisualIndex(i):n,a=t?o.columnIndexMapper.getRenderableFromVisualIndex(l):r}const l=Number.isInteger(s),h=Number.isInteger(a);return l&&s>=0&&h&&a>=0?o.view.scrollViewport(o._createCellCoords(s,a),e.horizontalSnap,e.verticalSnap):l&&s>=0&&(h&&a<0||!h)?o.view.scrollViewportVertically(s,e.verticalSnap):!!(h&&a>=0&&(l&&s<0||!l))&&o.view.scrollViewportHorizontally(a,e.horizontalSnap)},this.scrollToFocusedCell=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:()=>{};if(!this.selection.isSelected())return;this.addHookOnce("afterScroll",e);const{highlight:t}=this.getSelectedRangeLast();this.scrollViewportTo(t.toObject())?this.view.render():(this.removeHook("afterScroll",e),this._registerImmediate((()=>e())))},this.destroy=function(){if(o._clearTimeouts(),o._clearImmediates(),o.view&&o.view.destroy(),l&&l.destroy(),l=null,this.getShortcutManager().destroy(),w.clearCache(),wM.delete(this.guid),$R(o)){const e=this.rootDocument.querySelector(".hot-display-license-info");e&&e.parentNode.removeChild(e)}Hp(o.rootElement),s.destroy(),u&&u.destroy(),o.batchExecution((()=>{o.rowIndexMapper.unregisterAll(),o.columnIndexMapper.unregisterAll(),C.getItems().forEach((e=>{let[,t]=e;t.destroy()})),C.clear(),o.runHooks("afterDestroy")}),!0),mf.getSingleton().destroy(o),nm(o,((e,t,n)=>{var r;pg(e)?n[t]=(r=t,()=>{throw new Error(`The "${r}" method cannot be called because this Handsontable instance has been destroyed`)}):"guid"!==t&&(n[t]=null)})),o.isDestroyed=!0,a&&a.destroy(),a=null,h=null,S=null,u=null,o=null},this.getActiveEditor=function(){return u.getActiveEditor()},this.getFirstRenderedVisibleRow=function(){return o.view.getFirstRenderedVisibleRow()},this.getLastRenderedVisibleRow=function(){return o.view.getLastRenderedVisibleRow()},this.getFirstRenderedVisibleColumn=function(){return o.view.getFirstRenderedVisibleColumn()},this.getLastRenderedVisibleColumn=function(){return o.view.getLastRenderedVisibleColumn()},this.getFirstFullyVisibleRow=function(){return o.view.getFirstFullyVisibleRow()},this.getLastFullyVisibleRow=function(){return o.view.getLastFullyVisibleRow()},this.getFirstFullyVisibleColumn=function(){return o.view.getFirstFullyVisibleColumn()},this.getLastFullyVisibleColumn=function(){return o.view.getLastFullyVisibleColumn()},this.getFirstPartiallyVisibleRow=function(){return o.view.getFirstPartiallyVisibleRow()},this.getLastPartiallyVisibleRow=function(){return o.view.getLastPartiallyVisibleRow()},this.getFirstPartiallyVisibleColumn=function(){return o.view.getFirstPartiallyVisibleColumn()},this.getLastPartiallyVisibleColumn=function(){return o.view.getLastPartiallyVisibleColumn()},this.getPlugin=function(e){return C.getItem(rp(e))},this.getPluginName=function(e){return e===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:C.getId(e)},this.getInstance=function(){return o},this.addHook=function(e,t,n){mf.getSingleton().add(e,t,o,n)},this.hasHook=function(e){return mf.getSingleton().has(e,o)||mf.getSingleton().has(e)},this.addHookOnce=function(e,t,n){mf.getSingleton().once(e,t,o,n)},this.removeHook=function(e,t){mf.getSingleton().remove(e,t,o)},this.runHooks=function(e,t,n,r,i,s,a){return mf.getSingleton().run(o,e,t,n,r,i,s,a)},this.getTranslatedPhrase=function(e,t){return ZT(y.language,e,t)},this.toHTML=()=>jw(this),this.toTableElement=()=>{const e=this.rootDocument.createElement("div");return e.insertAdjacentHTML("afterbegin",jw(this)),e.firstElementChild},this.timeouts=[],this.useTheme=e=>{this.view.getStylesHandler().useTheme(e),this.runHooks("afterSetTheme",e,!!p)},this.getCurrentThemeName=()=>this.view.getStylesHandler().getThemeName(),this._registerTimeout=function(e){let t=e;"function"==typeof t&&(t=setTimeout(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0)),this.timeouts.push(t)},this._clearTimeouts=function(){Vd(this.timeouts,(e=>{clearTimeout(e)}))},this.immediates=[],this._registerImmediate=function(e){this.immediates.push(setImmediate(e))},this._clearImmediates=function(){Vd(this.immediates,(e=>{clearImmediate(e)}))},this._getEditorManager=function(){return u};const P=gM({handleEvent:()=>o.isListening(),beforeKeyDown:e=>this.runHooks("beforeKeyDown",e),afterKeyDown:e=>{this.isDestroyed||o.runHooks("afterDocumentKeyDown",e)},ownerWindow:this.rootWindow});var _;this.addHook("beforeOnCellMouseDown",(e=>{!1===e.ctrlKey&&!1===e.metaKey&&P.releasePressedKeys()})),this.getShortcutManager=function(){return P},this.getFocusManager=function(){return c},ay().forEach((e=>{const t=ly(e);C.addItem(e,new t(this))})),_=o,[JA,ZA].forEach((e=>e(_))),P.setActiveContextName("grid"),mf.getSingleton().run(o,"construct")}function vM(e,t,n){e.addEventListener(t,n,!1)}function CM(e,t,n){e.removeEventListener(t,n,!1)}function SM(e){return e.ownerDocument.defaultView.getComputedStyle(e)}function RM(e){const t={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300,textContent:e=>e.value,...arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}},n=e.body,r=e.createTextNode(""),i=e.createElement("span");let o;function s(){var e,s;r.textContent=t.textContent(o),i.style.position="absolute",i.style.fontSize=SM(o).fontSize,i.style.fontFamily=SM(o).fontFamily,i.style.whiteSpace="pre",n.appendChild(i);const a=parseInt((null===(e=SM(o))||void 0===e?void 0:e.paddingInlineStart)||0,10),l=parseInt((null===(s=SM(o))||void 0===s?void 0:s.paddingInlineEnd)||0,10),h=i.clientWidth+a+l+1;n.removeChild(i);const u=o.style;u.height=`${t.minHeight}px`,t.minWidth>h?u.width=`${t.minWidth}px`:h>t.maxWidth?u.width=`${t.maxWidth}px`:u.width=`${h}px`;const c=o.scrollHeight?o.scrollHeight-1:0;t.minHeight>c?u.height=`${t.minHeight}px`:t.maxHeight<c?(u.height=`${t.maxHeight}px`,u.overflowY="visible"):u.height=`${c}px`}function a(){e.defaultView.setTimeout(s,0)}return{init:function(e,n){let l=arguments.length>2&&void 0!==arguments[2]&&arguments[2];o=e,function(e){if(e&&e.minHeight)if("inherit"===e.minHeight)t.minHeight=o.clientHeight;else{const n=parseInt(e.minHeight,10);isNaN(n)||(t.minHeight=n)}if(e&&e.maxHeight)if("inherit"===e.maxHeight)t.maxHeight=o.clientHeight;else{const n=parseInt(e.maxHeight,10);isNaN(n)||(t.maxHeight=n)}if(e&&e.minWidth)if("inherit"===e.minWidth)t.minWidth=o.clientWidth;else{const n=parseInt(e.minWidth,10);isNaN(n)||(t.minWidth=n)}if(e&&e.maxWidth)if("inherit"===e.maxWidth)t.maxWidth=o.clientWidth;else{const n=parseInt(e.maxWidth,10);isNaN(n)||(t.maxWidth=n)}i.firstChild||(i.className="autoResize",i.style.display="inline-block",i.appendChild(r))}(n),"TEXTAREA"===o.nodeName&&(o.style.resize="none",o.style.height=`${t.minHeight}px`,o.style.minWidth=`${t.minWidth}px`,o.style.maxWidth=`${t.maxWidth}px`,o.style.overflowY="hidden"),l&&(vM(o,"input",s),vM(o,"keydown",a)),s()},resize:s,unObserve(){CM(o,"input",s),CM(o,"keydown",a)}}}function EM(e,t){const n=Zp(t),r=t.value.split("\n");let i=n,o=0;for(let s=0;s<r.length;s++){const t=r[s];0!==s&&(o+=r[s-1].length+1);const a=o+t.length;if("home"===e?i=o:"end"===e&&(i=a),n<=a)break}eg(t,i)}function bM(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const TM="ht_editor_hidden",NM="textEditor";class AM extends GA{static get EDITOR_TYPE(){return"text"}constructor(e){super(e),bM(this,"eventManager",new Of(this)),bM(this,"autoResize",RM(this.hot.rootDocument)),bM(this,"TEXTAREA",void 0),bM(this,"textareaStyle",void 0),bM(this,"TEXTAREA_PARENT",void 0),bM(this,"textareaParentStyle",void 0),bM(this,"layerClass",void 0),this.eventManager=new Of(this),this.createElements(),this.bindEvents(),this.hot.addHookOnce("afterDestroy",(()=>this.destroy()))}getValue(){return this.TEXTAREA.value}setValue(e){this.TEXTAREA.value=e}open(){this.refreshDimensions(),this.showEditableElement(),this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this.autoResize.unObserve(),Sp(this.hot.rootDocument.activeElement,this.hot.rootElement)&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts()}prepare(e,t,n,r,i,o){const s=this.state;if(super.prepare(e,t,n,r,i,o),!o.readOnly){this.refreshDimensions(!0);const{allowInvalid:e}=o;e&&!this.isOpened()&&(this.TEXTAREA.value=""),s===jA.FINISHED||this.isOpened()||this.hideEditableElement()}}beginEditing(e,t){this.state===jA.VIRGIN&&(this.TEXTAREA.value="",super.beginEditing(e,t))}focus(){this.TEXTAREA.select(),eg(this.TEXTAREA,this.TEXTAREA.value.length)}createElements(){const{rootDocument:e}=this.hot;this.TEXTAREA=e.createElement("TEXTAREA"),Pp(this.TEXTAREA,[["data-hot-input",""],hp(-1)]),Op(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=e.createElement("DIV"),Op(this.TEXTAREA_PARENT,"handsontableInputHolder"),Ip(this.TEXTAREA_PARENT,this.layerClass)&&xp(this.TEXTAREA_PARENT,this.layerClass),Op(this.TEXTAREA_PARENT,TM),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}hideEditableElement(){dm.edge.value&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",xp(this.TEXTAREA_PARENT,this.layerClass),Op(this.TEXTAREA_PARENT,TM)}showEditableElement(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="";const e=this.TEXTAREA_PARENT.childNodes;let t=!1;$w(e.length-1,(n=>{if(Ip(e[n],"handsontableEditor"))return t=!0,!1})),Ip(this.TEXTAREA_PARENT,TM)&&xp(this.TEXTAREA_PARENT,TM),t?(this.layerClass="ht_editor_visible",Op(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),Op(this.TEXTAREA_PARENT,this.layerClass))}refreshValue(){const e=this.hot.toPhysicalRow(this.row),t=this.hot.getSourceDataAtCell(e,this.col);this.originalValue=t,this.setValue(t),this.refreshDimensions()}refreshDimensions(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.state!==jA.EDITING&&!e)return;if(this.TD=this.getEditedCell(),!this.TD)return void(e||this.close());const{top:t,start:n,width:r,maxWidth:i,height:o,maxHeight:s}=this.getEditedCellRect();this.textareaParentStyle.top=`${t}px`,this.textareaParentStyle[this.hot.isRtl()?"right":"left"]=`${n}px`,this.showEditableElement();const a=this.hot.rootWindow.getComputedStyle(this.TD);this.TEXTAREA.style.fontSize=a.fontSize,this.TEXTAREA.style.fontFamily=a.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor,this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(r,i),minHeight:Math.min(o,s),maxWidth:i,maxHeight:s},!0)}bindEvents(){ym()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",(()=>this.finishEditing(!1))),this.addHook("afterScrollHorizontally",(()=>this.refreshDimensions())),this.addHook("afterScrollVertically",(()=>this.refreshDimensions())),this.addHook("afterColumnResize",(()=>{this.refreshDimensions(),this.state===jA.EDITING&&this.focus()})),this.addHook("afterRowResize",(()=>{this.refreshDimensions(),this.state===jA.EDITING&&this.focus()}))}allowKeyEventPropagation(){}destroy(){this.eventManager.destroy(),this.clearHooks()}registerShortcuts(){const e=this.hot.getShortcutManager().getContext("editor"),t={runOnlyIf:()=>Gd(this.hot.getSelected()),group:NM},n=()=>{this.hot.rootDocument.execCommand("insertText",!1,"\n")};e.addShortcuts([{keys:[["Control","Enter"]],callback:()=>(n(),!1),runOnlyIf:e=>!this.hot.selection.isMultiple()&&!e.altKey},{keys:[["Meta","Enter"]],callback:()=>(n(),!1),runOnlyIf:()=>!this.hot.selection.isMultiple()},{keys:[["Alt","Enter"]],callback:()=>(n(),!1)},{keys:[["Home"]],callback:(e,t)=>{let[n]=t;EM(n,this.TEXTAREA)}},{keys:[["End"]],callback:(e,t)=>{let[n]=t;EM(n,this.TEXTAREA)}}],t)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(NM)}}function MM(e,t,n,r,i,o,s){const a=s.ariaTags,l=[],h=[],u=[],c=[];s.className&&Op(t,s.className),s.readOnly?(l.push(s.readOnlyCellClassName),a&&c.push(["aria-readonly","true"])):a&&u.push("aria-readonly"),!1===s.valid&&s.invalidCellClassName?(l.push(s.invalidCellClassName),a&&c.push(["aria-invalid","true"])):(h.push(s.invalidCellClassName),a&&u.push("aria-invalid")),!1===s.wordWrap&&s.noWordWrapClassName&&l.push(s.noWordWrapClassName),!o&&s.placeholder&&l.push(s.placeholderCellClassName),xp(t,h),Op(t,l),_p(t,u),Pp(t,c)}MM.RENDERER_TYPE="base";function IM(e,t,n,r,i,o,s){MM.apply(this,[e,t,n,r,i,o,s]);let a=o;!a&&s.placeholder&&(a=s.placeholder),a=jd(a),s.trimWhitespace&&(a=a.trim()),Dp(t,a)}IM.RENDERER_TYPE="text";const OM={CELL_TYPE:"text",editor:AM,renderer:IM};function xM(e,t){const n=new yM(e,t||{},GR);return n.init(),n}function PM(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t);if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _M(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function LM(e){return LM="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},LM(e)}cA(OM),xM.editors={BaseEditor:GA},xM.Core=function(e){return new yM(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},GR)},xM.DefaultSettings=fA(),xM.hooks=mf.getSingleton(),xM.CellCoords=hv,xM.CellRange=fv,xM.packageName="handsontable",xM.buildDate="19/03/2025 09:41:52",xM.version="15.2.0",xM.languages={dictionaryKeys:jT,getLanguageDictionary:qT,getLanguagesDictionaries:function(){return KT()},registerLanguageDictionary:XT,getTranslatedPhrase:ZT};var HM=Symbol("unassigned");function kM(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function FM(e){var t=xM.hooks.getRegistered(),n={};for(var r in Object.assign(n,xM.DefaultSettings),n)n[r]={default:HM};for(var i=0;i<t.length;i++)n[t[i]]={default:HM};return n.settings={default:HM},"HotTable"===e&&(n.id={type:String,default:"hot-".concat(Math.random().toString(36).substring(5))}),n}function DM(e){var t={},n=e.settings;if(n!==HM)for(var r in n)kM(n,r)&&n[r]!==HM&&(t[r]=n[r]);for(var i in e)kM(e,i)&&"settings"!==i&&e[i]!==HM&&(t[i]=e[i]);return t}function VM(e,t){var n=DM(e),r=e.settings?e.settings:n,i=e.settings?n:null,o={};for(var s in r)!kM(r,s)||void 0===r[s]||t&&"data"!==s&&UM(t[s],r[s])||(o[s]=r[s]);for(var a in i)!kM(i,a)||"id"===a||"settings"===a||void 0===i[a]||t&&"data"!==a&&UM(t[a],i[a])||(o[a]=i[a]);return o}function UM(e,t){var n=function(e){var t,n=(t=new WeakSet,function(e,n){if("object"===LM(n)&&null!==n){if(t.has(n))return;t.add(n)}return n});return JSON.stringify(e,n)};return"function"==typeof e&&"function"==typeof t?e.toString()===t.toString():LM(e)===LM(t)&&n(e)===n(t)}var BM=n({name:"HotTable",props:FM("HotTable"),provide:function(){return{columnsCache:this.columnsCache}},watch:{$props:{handler:function(e){var t=VM(e,this.hotInstance?this.hotInstance.getSettings():void 0);this.hotInstance&&void 0!==t&&(t.data&&(this.hotInstance.isColumnModificationAllowed()||!this.hotInstance.isColumnModificationAllowed()&&this.hotInstance.countSourceCols()===this.miscCache.currentSourceColumns)&&(this.matchHotMappersSize(),delete t.data),Object.keys(t).length?this.hotInstance.updateSettings(t):this.hotInstance.render(),this.miscCache.currentSourceColumns=this.hotInstance.countSourceCols())},deep:!0,immediate:!0}},data:function(){return{__hotInstance:null,miscCache:{currentSourceColumns:null},columnSettings:null,columnsCache:new Map,get hotInstance(){return!this.__hotInstance||this.__hotInstance&&!this.__hotInstance.isDestroyed?this.__hotInstance:(console.warn("The Handsontable instance bound to this component was destroyed and cannot be used properly."),null)},set hotInstance(e){this.__hotInstance=e}}},methods:{hotInit:function(){var e=VM(this.$props);e.columns=this.columnSettings?this.columnSettings:e.columns,this.hotInstance=r(new xM.Core(this.$el,e)),this.hotInstance.init(),this.miscCache.currentSourceColumns=this.hotInstance.countSourceCols()},matchHotMappersSize:function(){var e=this;if(this.hotInstance){var t,n=this.hotInstance.getSourceData(),r=[],i=[],o=this.hotInstance.rowIndexMapper.getNumberOfIndexes(),s=this.hotInstance.isColumnModificationAllowed(),a=0;if(n&&n.length!==o&&n.length<o)for(var l=n.length;l<o;l++)r.push(l);if(s)if(a=this.hotInstance.columnIndexMapper.getNumberOfIndexes(),n&&n[0]&&(null===(t=n[0])||void 0===t?void 0:t.length)!==a&&n[0].length<a)for(var h=n[0].length;h<a;h++)i.push(h);this.hotInstance.batch((function(){r.length>0?e.hotInstance.rowIndexMapper.removeIndexes(r):e.hotInstance.rowIndexMapper.insertIndexes(o-1,n.length-o),s&&0!==n.length&&(i.length>0?e.hotInstance.columnIndexMapper.removeIndexes(i):e.hotInstance.columnIndexMapper.insertIndexes(a-1,n[0].length-a))}))}},getColumnSettings:function(){var e=Array.from(this.columnsCache.values());return e.length?e:void 0}},mounted:function(){this.columnSettings=this.getColumnSettings(),this.hotInit()},beforeUnmount:function(){this.hotInstance&&this.hotInstance.destroy()},version:"15.2.0"}),WM=["id"];BM.render=function(e,t,n,r,a,l){return i(),o("div",{id:e.id},[s(e.$slots,"default")],8,WM)},BM.__file="src/HotTable.vue",n({name:"HotColumn",props:FM("HotColumn"),inject:["columnsCache"],methods:{createColumnSettings:function(){var e=DM(this.$props),t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_M(Object(n),!0).forEach((function(t){PM(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_M(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e);e.renderer&&(t.renderer=e.renderer),e.editor&&(t.editor=e.editor),this.columnsCache.set(this,t)}},mounted:function(){this.createColumnSettings()},unmounted:function(){this.columnsCache.delete(this)},render:function(){return null}}).__file="src/HotColumn.vue";const jM="handsontableEditor";class GM extends AM{static get EDITOR_TYPE(){return"handsontable"}open(){super.open();const e=this.htContainer.style;this.htEditor&&(this.htEditor.destroy(),e.width="",e.height="",e.overflow=""),"none"===e.display&&(e.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),eg(this.TEXTAREA,0,this.TEXTAREA.value.length),this.htEditor.updateSettings({width:this.getWidth(),height:this.getHeight()}),this.refreshDimensions()}close(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),super.close()}prepare(e,t,n,r,i,o){super.prepare(e,t,n,r,i,o);const s=this,a={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,ariaTags:!1,themeName:this.hot.getCurrentThemeName(),afterOnCellMouseDown(e,t){const n=this.getSourceData(t.row,t.col);void 0!==n&&s.setValue(n),s.hot.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&Kg(a,o.handsontable),this.htOptions=a}beginEditing(e,t){const n=this.hot.getSettings().onBeginEditing;n&&!1===n()||super.beginEditing(e,t)}createElements(){super.createElements();const e=this.hot.rootDocument.createElement("DIV");e.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(e),this.htContainer=e,this.assignHooks()}finishEditing(e,t,n){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){const e=this.htEditor.getValue();void 0!==e&&this.setValue(e)}super.finishEditing(e,t,n)}getHeight(){return this.htEditor.view.getTableHeight()+1}getWidth(){return this.htEditor.view.getTableWidth()}assignHooks(){this.hot.addHook("afterDestroy",(()=>{var e;null===(e=this.htEditor)||void 0===e||e.destroy()})),this.hot.addHook("afterSetTheme",((e,t)=>{var n;t||(null===(n=this.htEditor)||void 0===n||n.useTheme(e))}))}registerShortcuts(){const e=this.hot.getShortcutManager().getContext("editor");super.registerShortcuts();const t={group:jM,relativeToGroup:DA,position:"before"},n=(e,t)=>{const n=this.htEditor;if(void 0!==e&&(e<0||n.flipped&&e>n.countRows()-1?n.deselectCell():n.selectCell(e,0),n.getData().length))return t.preventDefault(),Nm(t),this.hot.listen(),this.TEXTAREA.focus(),!1};e.addShortcuts([{keys:[["ArrowUp"]],callback:e=>{const t=this.htEditor;let r,i;return!t.getSelectedLast()&&t.flipped?r=t.countRows()-1:t.getSelectedLast()&&(t.flipped?(i=t.getSelectedLast()[0],r=Math.max(0,i-1)):(i=t.getSelectedLast()[0],r=i-1)),n(r,e)},preventDefault:!1},{keys:[["ArrowDown"]],callback:e=>{const t=this.htEditor;let r,i;if(t.getSelectedLast()||t.flipped){if(t.getSelectedLast())if(t.flipped)r=t.getSelectedLast()[0]+1;else if(!t.flipped){const e=t.countRows()-1;i=t.getSelectedLast()[0],r=Math.min(e,i+1)}}else r=0;return n(r,e)},preventDefault:!1}],t)}unregisterShortcuts(){super.unregisterShortcuts();this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(jM)}}function zM(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $M(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function YM(e,t){return e.get(KM(e,t))}function KM(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var XM=new WeakMap,qM=new WeakSet;class QM extends GM{constructor(){var e,t;super(...arguments),zM(e=this,t=qM),t.add(e),$M(this,"query",null),$M(this,"strippedChoices",[]),$M(this,"rawChoices",[]),function(e,t,n){zM(e,t),t.set(e,n)}(this,XM,this.hot.guid.slice(0,9)),$M(this,"sortByRelevance",(function(e,t,n){const r=[],i=[],o=e.length;let s,a,l,h,u=t.length;if(0===o){for(l=0;l<u;l++)i.push(l);return i}for(l=0;l<u;l++){if(a=ap(jd(t[l])),n)h=a.indexOf(e);else{const t=this.cellProperties.locale;h=a.toLocaleLowerCase(t).indexOf(e.toLocaleLowerCase(t))}-1!==h&&(s=a.length-h-o,r.push({baseIndex:l,index:h,charsLeft:s,value:a}))}for(r.sort(((e,t)=>{if(-1===t.index)return-1;if(-1===e.index)return 1;if(e.index<t.index)return-1;if(t.index<e.index)return 1;if(e.index===t.index){if(e.charsLeft<t.charsLeft)return-1;if(e.charsLeft>t.charsLeft)return 1}return 0})),l=0,u=r.length;l<u;l++)i.push(r[l].baseIndex);return i}))}static get EDITOR_TYPE(){return"autocomplete"}getValue(){const e=this.rawChoices.find((e=>this.stripValueIfNeeded(e)===this.TEXTAREA.value));return Gd(e)?e:this.TEXTAREA.value}createElements(){super.createElements(),Op(this.htContainer,"autocompleteEditor"),Op(this.htContainer,-1===this.hot.rootWindow.navigator.platform.indexOf("Mac")?"":"htMacScroll"),this.hot.getSettings().ariaTags&&Pp(this.TEXTAREA,[["type","text"],["role","combobox"],cp("listbox"),["aria-autocomplete","list"]])}prepare(e,t,n,r,i,o){var s;super.prepare(e,t,n,r,i,o),this.hot.getSettings().ariaTags&&Pp(this.TEXTAREA,[fp("false"),(s=`${YM(XM,this)}-listbox-${e}-${t}`,["aria-controls",s])])}open(){super.open();const e=void 0===this.cellProperties.trimDropdown||this.cellProperties.trimDropdown,t=this.hot.getSettings().ariaTags,n=Array.isArray(this.cellProperties.source)?this.cellProperties.source:null,r=null==n?void 0:n.length,{row:i,col:o}=this;var s;this.showEditableElement(),this.focus(),this.addHook("beforeKeyDown",(e=>this.onBeforeKeyDown(e))),this.htEditor.updateSettings({colWidths:e?[Kp(this.TEXTAREA)-2]:void 0,autoColumnSize:!0,autoRowSize:!0,renderer:(e,i,o,s,a,l,h)=>{IM(e,i,o,s,a,l,h);const{filteringCaseSensitive:u,allowHtml:c,locale:d}=this.cellProperties,p=this.query;let g,m,f=jd(l);var w;f&&!c&&(g=!0===u?f.indexOf(p):f.toLocaleLowerCase(d).indexOf(p.toLocaleLowerCase(d)),-1!==g&&(m=f.substr(g,p.length),f=f.replace(m,`<strong>${m}</strong>`))),t&&Pp(i,[["role","option"],...n?[(w=r,["aria-setsize",w])]:[],...n?[vp(n.indexOf(l)+1)]:[],["id",`${this.htEditor.rootElement.id}_${o}-${s}`]]),i.innerHTML=f},afterSelectionEnd:(e,n)=>{if(t){const t=this.htEditor.getCell(e,n,!0);Pp(t,[["aria-selected","true"]]),Pp(this.TEXTAREA,...(r=t.id,["aria-activedescendant",r]))}var r}}),t&&(Pp(this.htEditor.view._wt.wtOverlays.wtTable.TABLE,"role","presentation"),Pp(this.htEditor.rootElement,[["role","listbox"],(s="polite",["aria-live",s]),yp("text"),["id",`${YM(XM,this)}-listbox-${i}-${o}`]]),Pp(this.TEXTAREA,...fp("true"))),this.hot._registerTimeout((()=>{this.queryChoices(this.TEXTAREA.value)}))}close(){this.removeHooksByKey("beforeKeyDown"),super.close(),this.hot.getSettings().ariaTags&&Pp(this.TEXTAREA,[fp("false")])}discardEditor(e){super.discardEditor(e),this.hot.view.render()}queryChoices(e){const t=this.cellProperties.source;this.query=e,"function"==typeof t?t.call(this.cellProperties,e,(e=>{this.rawChoices=e,this.updateChoicesList(this.stripValuesIfNeeded(e))})):Array.isArray(t)?(this.rawChoices=t,this.updateChoicesList(this.stripValuesIfNeeded(t))):this.updateChoicesList([])}updateChoicesList(e){const t=Zp(this.TEXTAREA),n=(r=this.TEXTAREA).selectionEnd?r.selectionEnd:0;var r;const i=this.cellProperties.sortByRelevance,o=this.cellProperties.filter;let s=null,a=null,l=e;i&&(s=this.sortByRelevance(this.stripValueIfNeeded(this.getValue()),l,this.cellProperties.filteringCaseSensitive));const h=Array.isArray(s)?s.length:0;if(!1===o)a=h>0?s[0]:0;else{const e=[];for(let t=0,n=l.length;t<n&&!(i&&h<=t);t++)h?e.push(l[s[t]]):e.push(l[t]);a=0,l=e}this.strippedChoices=l,0===l.length?this.htEditor.rootElement.style.display="none":this.htEditor.rootElement.style.display="",this.htEditor.loadData(Hd([l])),l.length>0&&(this.updateDropdownDimensions(),this.flipDropdownIfNeeded(),!0===this.cellProperties.strict&&this.highlightBestMatchingChoice(a)),this.hot.listen(),eg(this.TEXTAREA,t,t===n?void 0:n)}flipDropdownIfNeeded(){const e=this.getEditedCellRect(),t=e.height;let n=e.top;if(this.hot.view.isVerticallyScrollableByWindow()){const e=this.hot.view.getTableOffset().top-this.hot.rootWindow.scrollY;n=Math.max(n+e,0)}const r=this.getHeight(),i=this.hot.view.getWorkspaceHeight()-n-t,o=r>i&&n>i+t;return o?this.flipDropdown(r):this.unflipDropdown(),this.limitDropdownIfNeeded(o?n:i,r),o}limitDropdownIfNeeded(e,t){if(t>e){let n=0,r=0,i=0,o=null;do{i=this.htEditor.getRowHeight(r)||this.htEditor.view.getDefaultRowHeight(),n+=i,r+=1}while(n<e);o=n-i,this.htEditor.flipped&&(this.htEditor.rootElement.style.top=parseInt(this.htEditor.rootElement.style.top,10)+t-o+"px"),this.setDropdownHeight(n-i)}}flipDropdown(e){const t=this.htEditor.rootElement.style;t.position="absolute",t.top=-e+"px",this.htEditor.flipped=!0}unflipDropdown(){const e=this.htEditor.rootElement.style;e.position="absolute",e.top="",this.htEditor.flipped=void 0}updateDropdownDimensions(){this.htEditor.updateSettings({width:this.getWidth(),height:this.getHeight()}),KM(qM,this,ZM).call(this),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}setDropdownHeight(e){this.htEditor.updateSettings({height:e}),KM(qM,this,ZM).call(this),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}highlightBestMatchingChoice(e){"number"==typeof e?this.htEditor.selectCell(e,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}getHeight(){const e=this.hot.rootWindow.getComputedStyle(this.htContainer.querySelector(".htCore")),t=parseInt(e.borderTopWidth,10)+parseInt(e.borderBottomWidth,10),n=Math.min(this.cellProperties.visibleRows,this.strippedChoices.length),r=Array.from({length:n},((e,t)=>t)).reduce(((e,t)=>e+this.htEditor.getRowHeight(t)),0);return r+t+1}getWidth(){const e=this.hot.rootWindow.getComputedStyle(this.htContainer.querySelector(".htCore")),t=parseInt(e.borderInlineStartWidth,10)+parseInt(e.borderInlineEndWidth,10);return this.htEditor.getColWidth(0)+t}stripValueIfNeeded(e){return this.stripValuesIfNeeded([e])[0]}stripValuesIfNeeded(e){const{allowHtml:t}=this.cellProperties,n=Dd(e,(e=>jd(e)));return Dd(n,(e=>t?e:ap(e)))}allowKeyEventPropagation(e){const t=this.htEditor.getSelectedRangeLast(),n=t?t.from.row:-1;let r=!1;return e===Rm.ARROW_DOWN&&n>0&&n<this.htEditor.countRows()-1&&(r=!0),e===Rm.ARROW_UP&&n>-1&&(r=!0),r}onBeforeKeyDown(e){if(32===(t=e.keyCode)||t>=48&&t<=57||t>=96&&t<=111||t>=186&&t<=192||t>=219&&t<=222||t>=226||t>=65&&t<=90||e.keyCode===Rm.BACKSPACE||e.keyCode===Rm.DELETE||e.keyCode===Rm.INSERT){let t=10;if(e.keyCode===Rm.C&&(e.ctrlKey||e.metaKey))return;this.isOpened()||(t+=10),this.htEditor&&this.hot._registerTimeout((()=>{this.queryChoices(this.TEXTAREA.value)}),t)}var t}}function ZM(){this.htEditor.view.hasVerticalScroll()&&this.htEditor.updateSettings({width:this.htEditor.getSettings().width+ng(this.hot.rootDocument)})}class JM extends GA{static get EDITOR_TYPE(){return"checkbox"}beginEditing(e,t){if(t&&"mouseup"===t.type&&"TD"===t.target.nodeName){const e=this.TD.querySelector('input[type="checkbox"]');Ip(e,"htBadValue")||e.click()}}finishEditing(){}init(){}open(){}close(){}getValue(){}setValue(){}focus(){}}
/*!
 * Pikaday
 *
 * Copyright Â© 2014 David Bushell | BSD & MIT license | https://github.com/Pikaday/Pikaday
 */const eI=()=>window,tI=()=>window.document,nI=(e,t)=>window.setTimeout(e,t),rI=function(e,t,n,r){e.addEventListener(t,n,!!r)},iI=function(e,t,n,r){e.removeEventListener(t,n,!!r)},oI=function(e,t){return-1!==(" "+e.className+" ").indexOf(" "+t+" ")},sI=function(e,t){oI(e,t)||(e.className=""===e.className?t:e.className+" "+t)},aI=function(e,t){var n;e.className=(n=(" "+e.className+" ").replace(" "+t+" "," ")).trim?n.trim():n.replace(/^\s+|\s+$/g,"")},lI=function(e){return/Array/.test(Object.prototype.toString.call(e))},hI=function(e){return/Date/.test(Object.prototype.toString.call(e))&&!isNaN(e.getTime())},uI=function(e){let t=e.getDay();return 0===t||6===t},cI=function(e){return e%4==0&&e%100!=0||e%400==0},dI=function(e,t){return[31,cI(e)?29:28,31,30,31,30,31,31,30,31,30,31][t]},pI=function(e){hI(e)&&e.setHours(0,0,0,0)},gI=function(e,t){return e.getTime()===t.getTime()},mI=function(e,t,n){let r,i;for(r in t)i=void 0!==e[r],i&&"object"==typeof t[r]&&null!==t[r]&&void 0===t[r].nodeName?hI(t[r])?n&&(e[r]=new Date(t[r].getTime())):lI(t[r])?n&&(e[r]=t[r].slice(0)):e[r]=mI({},t[r],n):!n&&i||(e[r]=t[r]);return e},fI=function(e,t,n){let r=tI().createEvent("HTMLEvents");r.initEvent(t,!0,!1),r=mI(r,n),e.dispatchEvent(r)},wI=function(e){return e.month<0&&(e.year-=Math.ceil(Math.abs(e.month)/12),e.month+=12),e.month>11&&(e.year+=Math.floor(Math.abs(e.month)/12),e.month-=12),e},yI={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,firstWeekOfYearMinDays:4,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},vI=function(e,t,n){for(t+=e.firstDay;t>=7;)t-=7;return n?e.i18n.weekdaysShort[t]:e.i18n.weekdays[t]},CI=function(e){let t=[],n="false";if(e.isEmpty){if(!e.showDaysInNextAndPreviousMonths)return'<td class="is-empty"></td>';t.push("is-outside-current-month"),e.enableSelectionDaysInNextAndPreviousMonths||t.push("is-selection-disabled")}return e.isDisabled&&t.push("is-disabled"),e.isToday&&t.push("is-today"),e.isSelected&&(t.push("is-selected"),n="true"),e.hasEvent&&t.push("has-event"),e.isInRange&&t.push("is-inrange"),e.isStartRange&&t.push("is-startrange"),e.isEndRange&&t.push("is-endrange"),'<td data-day="'+e.day+'" class="'+t.join(" ")+'" aria-selected="'+n+'"><button class="pika-button pika-day" type="button" data-pika-year="'+e.year+'" data-pika-month="'+e.month+'" data-pika-day="'+e.day+'">'+e.day+"</button></td>"},SI=function(e,t,n,r,i){let o=new Date(r,n,t),s=e.hasMoment?e.moment(o).isoWeek():function(e,t){e.setHours(0,0,0,0);let n=e.getDate(),r=e.getDay(),i=t,o=i-1,s=function(e){return(e+7-1)%7};e.setDate(n+o-s(r));let a=new Date(e.getFullYear(),0,i),l=(e.getTime()-a.getTime())/864e5;return 1+Math.round((l-o+s(a.getDay()))/7)}(o,i);return'<td class="pika-week">'+s+"</td>"},RI=function(e,t,n,r){return'<tr class="pika-row'+(n?" pick-whole-week":"")+(r?" is-selected":"")+'">'+(t?e.reverse():e).join("")+"</tr>"},EI=function(e,t,n,r,i,o){let s,a,l,h,u,c=e._o,d=n===c.minYear,p=n===c.maxYear,g='<div id="'+o+'" class="pika-title" role="heading" aria-live="polite">',m=!0,f=!0;for(l=[],s=0;s<12;s++)l.push('<option value="'+(n===i?s-t:12+s-t)+'"'+(s===r?' selected="selected"':"")+(d&&s<c.minMonth||p&&s>c.maxMonth?' disabled="disabled"':"")+">"+c.i18n.months[s]+"</option>");for(h='<div class="pika-label">'+c.i18n.months[r]+'<select class="pika-select pika-select-month" tabindex="-1">'+l.join("")+"</select></div>",lI(c.yearRange)?(s=c.yearRange[0],a=c.yearRange[1]+1):(s=n-c.yearRange,a=1+n+c.yearRange),l=[];s<a&&s<=c.maxYear;s++)s>=c.minYear&&l.push('<option value="'+s+'"'+(s===n?' selected="selected"':"")+">"+s+"</option>");return u='<div class="pika-label">'+n+c.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+l.join("")+"</select></div>",c.showMonthAfterYear?g+=u+h:g+=h+u,d&&(0===r||c.minMonth>=r)&&(m=!1),p&&(11===r||c.maxMonth<=r)&&(f=!1),0===t&&(g+='<button class="pika-prev'+(m?"":" is-disabled")+'" type="button">'+c.i18n.previousMonth+"</button>"),t===e._o.numberOfMonths-1&&(g+='<button class="pika-next'+(f?"":" is-disabled")+'" type="button">'+c.i18n.nextMonth+"</button>"),g+"</div>"},bI=function(e,t,n){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+n+'">'+function(e){let t,n=[];for(e.showWeekNumber&&n.push("<th></th>"),t=0;t<7;t++)n.push('<th scope="col"><abbr title="'+vI(e,t)+'">'+vI(e,t,!0)+"</abbr></th>");return"<thead><tr>"+(e.isRTL?n.reverse():n).join("")+"</tr></thead>"}(e)+("<tbody>"+t.join("")+"</tbody></table>")};function TI(e){let t=this,n=t.config(e);t._onMouseDown=function(e){if(!t._v)return;let r=(e=e||eI().event).target||e.srcElement;if(r)if(oI(r,"is-disabled")||(!oI(r,"pika-button")||oI(r,"is-empty")||oI(r.parentNode,"is-disabled")?oI(r,"pika-prev")?t.prevMonth():oI(r,"pika-next")&&t.nextMonth():(t.setDate(new Date(r.getAttribute("data-pika-year"),r.getAttribute("data-pika-month"),r.getAttribute("data-pika-day"))),n.bound&&nI((function(){t.hide(),n.blurFieldOnSelect&&n.field&&n.field.blur()}),100))),oI(r,"pika-select"))t._c=!0;else{if(!e.preventDefault)return e.returnValue=!1,!1;e.preventDefault()}},t._onChange=function(e){let n=(e=e||eI().event).target||e.srcElement;n&&(oI(n,"pika-select-month")?t.gotoMonth(n.value):oI(n,"pika-select-year")&&t.gotoYear(n.value))},t._onKeyChange=function(e){if(e=e||eI().event,t.isVisible())switch(e.keyCode){case 13:case 27:n.field&&n.field.blur();break;case 37:t.adjustDate("subtract",1);break;case 38:t.adjustDate("subtract",7);break;case 39:t.adjustDate("add",1);break;case 40:t.adjustDate("add",7);break;case 8:case 46:t.setDate(null)}},t._parseFieldValue=function(){if(n.parse)return n.parse(n.field.value,n.format);if(this.hasMoment){let e=this.moment(n.field.value,n.format,n.formatStrict);return e&&e.isValid()?e.toDate():null}return new Date(Date.parse(n.field.value))},t._onInputChange=function(e){let n;e.firedBy!==t&&(n=t._parseFieldValue(),hI(n)&&t.setDate(n),t._v||t.show())},t._onInputFocus=function(){t.show()},t._onInputClick=function(){t.show()},t._onInputBlur=function(){let e=tI().activeElement;do{if(oI(e,"pika-single"))return}while(e=e.parentNode);t._c||(t._b=nI((function(){t.hide()}),50)),t._c=!1},t._onClick=function(e){let r=(e=e||eI().event).target||e.srcElement,i=r;if(r){!hasEventListeners&&oI(r,"pika-select")&&(r.onchange||(r.setAttribute("onchange","return;"),rI(r,"change",t._onChange)));do{if(oI(i,"pika-single")||i===n.trigger)return}while(i=i.parentNode);t._v&&r!==n.trigger&&i!==n.trigger&&t.hide()}},t.el=tI().createElement("div"),t.el.className="pika-single"+(n.isRTL?" is-rtl":"")+(n.theme?" "+n.theme:""),rI(t.el,"mousedown",t._onMouseDown,!0),rI(t.el,"touchend",t._onMouseDown,!0),rI(t.el,"change",t._onChange),n.keyboardInput&&rI(tI(),"keydown",t._onKeyChange),n.field&&(n.container?n.container.appendChild(t.el):n.bound?tI().body.appendChild(t.el):n.field.parentNode.insertBefore(t.el,n.field.nextSibling),rI(n.field,"change",t._onInputChange),n.defaultDate||(n.defaultDate=t._parseFieldValue(),n.setDefaultDate=!0));let r=n.defaultDate;hI(r)?n.setDefaultDate?t.setDate(r,!0):t.gotoDate(r):t.gotoDate(new Date),n.bound?(this.hide(),t.el.className+=" is-bound",rI(n.trigger,"click",t._onInputClick),rI(n.trigger,"focus",t._onInputFocus),rI(n.trigger,"blur",t._onInputBlur)):this.show()}function NI(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function AI(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function MI(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}TI.prototype={config:function(e){this._o||(this._o=mI({},yI,!0));let t=mI(this._o,e,!0);t.isRTL=!!t.isRTL,t.field=t.field&&t.field.nodeName?t.field:null,t.theme="string"==typeof t.theme&&t.theme?t.theme:null,t.bound=!!(void 0!==t.bound?t.field&&t.bound:t.field),t.trigger=t.trigger&&t.trigger.nodeName?t.trigger:t.field,t.disableWeekends=!!t.disableWeekends,t.disableDayFn="function"==typeof t.disableDayFn?t.disableDayFn:null;let n=parseInt(t.numberOfMonths,10)||1;if(t.numberOfMonths=n>4?4:n,hI(t.minDate)||(t.minDate=!1),hI(t.maxDate)||(t.maxDate=!1),t.minDate&&t.maxDate&&t.maxDate<t.minDate&&(t.maxDate=t.minDate=!1),t.minDate&&this.setMinDate(t.minDate),t.maxDate&&this.setMaxDate(t.maxDate),lI(t.yearRange)){let e=(new Date).getFullYear()-10;t.yearRange[0]=parseInt(t.yearRange[0],10)||e,t.yearRange[1]=parseInt(t.yearRange[1],10)||e}else t.yearRange=Math.abs(parseInt(t.yearRange,10))||yI.yearRange,t.yearRange>100&&(t.yearRange=100);return t},toString:function(e){return e=e||this._o.format,hI(this._d)?this._o.toString?this._o.toString(this._d,e):this.hasMoment?this.moment(this._d).format(e):this._d.toDateString():""},getMoment:function(){return this.hasMoment?this.moment(this._d):null},setMoment:function(e,t){this.hasMoment&&this.moment.isMoment(e)&&this.setDate(e.toDate(),t)},useMoment:function(e){this.hasMoment=!0,this.moment=e},getDate:function(){return hI(this._d)?new Date(this._d.getTime()):null},setDate:function(e,t){if(!e)return this._d=null,this._o.field&&(this._o.field.value="",fI(this._o.field,"change",{firedBy:this})),this.draw();if("string"==typeof e&&(e=new Date(Date.parse(e))),!hI(e))return;let n=this._o.minDate,r=this._o.maxDate;hI(n)&&e<n?e=n:hI(r)&&e>r&&(e=r),this._d=new Date(e.getTime()),pI(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),fI(this._o.field,"change",{firedBy:this})),t||"function"!=typeof this._o.onSelect||this._o.onSelect.call(this,this.getDate())},clear:function(){this.setDate(null)},gotoDate:function(e){let t=!0;if(hI(e)){if(this.calendars){let n=new Date(this.calendars[0].year,this.calendars[0].month,1),r=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),i=e.getTime();r.setMonth(r.getMonth()+1),r.setDate(r.getDate()-1),t=i<n.getTime()||r.getTime()<i}t&&(this.calendars=[{month:e.getMonth(),year:e.getFullYear()}],"right"===this._o.mainCalendar&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(e,t){let n,r=this.getDate()||new Date,i=24*parseInt(t)*60*60*1e3;"add"===e?n=new Date(r.valueOf()+i):"subtract"===e&&(n=new Date(r.valueOf()-i)),this.setDate(n)},adjustCalendars:function(){this.calendars[0]=wI(this.calendars[0]);for(let e=1;e<this._o.numberOfMonths;e++)this.calendars[e]=wI({month:this.calendars[0].month+e,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(e){isNaN(e)||(this.calendars[0].month=parseInt(e,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(e){isNaN(e)||(this.calendars[0].year=parseInt(e,10),this.adjustCalendars())},setMinDate:function(e){e instanceof Date?(pI(e),this._o.minDate=e,this._o.minYear=e.getFullYear(),this._o.minMonth=e.getMonth()):(this._o.minDate=yI.minDate,this._o.minYear=yI.minYear,this._o.minMonth=yI.minMonth,this._o.startRange=yI.startRange),this.draw()},setMaxDate:function(e){e instanceof Date?(pI(e),this._o.maxDate=e,this._o.maxYear=e.getFullYear(),this._o.maxMonth=e.getMonth()):(this._o.maxDate=yI.maxDate,this._o.maxYear=yI.maxYear,this._o.maxMonth=yI.maxMonth,this._o.endRange=yI.endRange),this.draw()},setStartRange:function(e){this._o.startRange=e},setEndRange:function(e){this._o.endRange=e},draw:function(e){if(!this._v&&!e)return;let t,n=this._o,r=n.minYear,i=n.maxYear,o=n.minMonth,s=n.maxMonth,a="";this._y<=r&&(this._y=r,!isNaN(o)&&this._m<o&&(this._m=o)),this._y>=i&&(this._y=i,!isNaN(s)&&this._m>s&&(this._m=s));for(let l=0;l<n.numberOfMonths;l++)t="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),a+='<div class="pika-lendar">'+EI(this,l,this.calendars[l].year,this.calendars[l].month,this.calendars[0].year,t)+this.render(this.calendars[l].year,this.calendars[l].month,t)+"</div>";this.el.innerHTML=a,n.bound&&"hidden"!==n.field.type&&nI((function(){n.trigger.focus()}),1),"function"==typeof this._o.onDraw&&this._o.onDraw(this),n.bound&&n.field.setAttribute("aria-label",n.ariaLabel)},adjustPosition:function(){let e,t,n,r,i,o,s,a,l,h,u;this._o.container||(this.el.style.position="absolute",e=this._o.trigger,t=this.el.offsetWidth,n=this.el.offsetHeight,r=eI().innerWidth||tI().documentElement.clientWidth,i=eI().innerHeight||tI().documentElement.clientHeight,o=tI().body.scrollTop||tI().documentElement.scrollTop,h=!0,u=!0,l=e.getBoundingClientRect(),s=l.left+eI().pageXOffset,a=l.bottom+eI().pageYOffset,(this._o.reposition&&s+t>r||this._o.position.indexOf("right")>-1&&s-t+e.offsetWidth>0)&&(s=s-t+e.offsetWidth,h=!1),(this._o.reposition&&a+n>i+o||this._o.position.indexOf("top")>-1&&a-n-e.offsetHeight>0)&&(a=a-n-e.offsetHeight,u=!1),s<0&&(s=0),a<0&&(a=0),this.el.style.left=s+"px",this.el.style.top=a+"px",sI(this.el,h?"left-aligned":"right-aligned"),sI(this.el,u?"bottom-aligned":"top-aligned"),aI(this.el,h?"right-aligned":"left-aligned"),aI(this.el,u?"top-aligned":"bottom-aligned"))},render:function(e,t,n){let r=this._o,i=new Date,o=dI(e,t),s=new Date(e,t,1).getDay(),a=[],l=[];pI(i),r.firstDay>0&&(s-=r.firstDay,s<0&&(s+=7));let h=0===t?11:t-1,u=11===t?0:t+1,c=0===t?e-1:e,d=11===t?e+1:e,p=dI(c,h),g=o+s,m=g;for(;m>7;)m-=7;g+=7-m;let f=!1;for(let w=0,y=0;w<g;w++){let n=new Date(e,t,w-s+1),g=!!hI(this._d)&&gI(n,this._d),m=gI(n,i),v=-1!==r.events.indexOf(n.toDateString()),C=w<s||w>=o+s,S=w-s+1,R=t,E=e,b=r.startRange&&gI(r.startRange,n),T=r.endRange&&gI(r.endRange,n),N=r.startRange&&r.endRange&&r.startRange<n&&n<r.endRange;C&&(w<s?(S=p+S,R=h,E=c):(S-=o,R=u,E=d));let A={day:S,month:R,year:E,hasEvent:v,isSelected:g,isToday:m,isDisabled:r.minDate&&n<r.minDate||r.maxDate&&n>r.maxDate||r.disableWeekends&&uI(n)||r.disableDayFn&&r.disableDayFn(n),isEmpty:C,isStartRange:b,isEndRange:T,isInRange:N,showDaysInNextAndPreviousMonths:r.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:r.enableSelectionDaysInNextAndPreviousMonths};r.pickWholeWeek&&g&&(f=!0),l.push(CI(A)),7==++y&&(r.showWeekNumber&&l.unshift(SI(this,w-s,t,e,r.firstWeekOfYearMinDays)),a.push(RI(l,r.isRTL,r.pickWholeWeek,f)),l=[],y=0,f=!1)}return bI(r,a,n)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),aI(this.el,"is-hidden"),this._o.bound&&(rI(tI(),"click",this._onClick),this.adjustPosition()),"function"==typeof this._o.onOpen&&this._o.onOpen.call(this))},hide:function(){let e=this._v;!1!==e&&(this._o.bound&&iI(tI(),"click",this._onClick),this._o.container||(this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto"),sI(this.el,"is-hidden"),this._v=!1,void 0!==e&&"function"==typeof this._o.onClose&&this._o.onClose.call(this))},destroy:function(){let e=this._o;this.hide(),iI(this.el,"mousedown",this._onMouseDown,!0),iI(this.el,"touchend",this._onMouseDown,!0),iI(this.el,"change",this._onChange),e.keyboardInput&&iI(tI(),"keydown",this._onKeyChange),e.field&&(iI(e.field,"change",this._onInputChange),e.bound&&(iI(e.trigger,"click",this._onInputClick),iI(e.trigger,"focus",this._onInputFocus),iI(e.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}};const II="date",OI="dateEditor";var xI=new WeakSet;class PI extends AM{constructor(){super(...arguments),NI(this,xI),AI(this,"parentDestroyed",!1),AI(this,"$datePicker",null)}static get EDITOR_TYPE(){return II}init(){if("function"!=typeof M)throw new Error("You need to include moment.js to your project.");super.init(),this.hot.addHook("afterDestroy",(()=>{this.parentDestroyed=!0,this.destroyElements()})),this.hot.addHook("afterSetTheme",((e,t)=>{t||(xp(this.datePicker,/ht-theme-.*/g),Op(this.datePicker,e))}))}createElements(){super.createElements(),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),Op(this.datePicker,"htDatepickerHolder");const e=this.hot.getCurrentThemeName();xp(this.datePicker,/ht-theme-.*/g),Op(this.datePicker,e),this.hot.rootDocument.body.appendChild(this.datePicker),this.eventManager.addEventListener(this.datePicker,"mousedown",(e=>{Ip(e.target,"pika-day")&&this.hideDatepicker(),e.stopPropagation()}))}destroyElements(){const e=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),e&&e.removeChild(this.datePicker)}prepare(e,t,n,r,i,o){super.prepare(e,t,n,r,i,o)}open(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;const t=this.hot.getShortcutManager().getContext("editor");this.showDatepicker(e),super.open(),t.addShortcuts([{keys:[["ArrowLeft"]],callback:()=>{this.$datePicker.adjustDate("subtract",1)}},{keys:[["ArrowRight"]],callback:()=>{this.$datePicker.adjustDate("add",1)}},{keys:[["ArrowUp"]],callback:()=>{this.$datePicker.adjustDate("subtract",7)}},{keys:[["ArrowDown"]],callback:()=>{this.$datePicker.adjustDate("add",7)}}],{group:OI})}close(){var e;this._opened=!1,null!==(e=this.$datePicker)&&void 0!==e&&e.destroy&&this.$datePicker.destroy(),this.hot._registerTimeout((()=>{const e=this.hot._getEditorManager();e.closeEditor(),this.hot.view.render(),e.prepareEditor()}));this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(OI),super.close()}finishEditing(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];super.finishEditing(e,t)}showDatepicker(e){const t=MI(xI,this,_I).call(this),n=this.hot.view.isMouseDown(),r=!!e&&bm(e.keyCode);let i;this.datePicker.style.display="block",this.$datePicker=new TI(this.getDatePickerConfig()),"function"==typeof this.$datePicker.useMoment&&this.$datePicker.useMoment(M),this.$datePicker._onInputFocus=function(){},this.originalValue?(i=this.originalValue,M(i,t,!0).isValid()&&this.$datePicker.setMoment(M(i,t),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),r||n||this.setValue("")):this.cellProperties.defaultDate?(i=this.cellProperties.defaultDate,M(i,t,!0).isValid()&&this.$datePicker.setMoment(M(i,t),!0),r||n||this.setValue("")):this.$datePicker.gotoToday()}hideDatepicker(){this.datePickerStyle.display="none",this.$datePicker.hide()}getDatePickerConfig(){var e;const t=this.TEXTAREA,n={};this.cellProperties&&this.cellProperties.datePickerConfig&&Xg(n,this.cellProperties.datePickerConfig);const r=n.onSelect,i=n.onClose;return n.field=t,n.trigger=t,n.container=this.datePicker,n.bound=!1,n.keyboardInput=!1,n.format=null!==(e=n.format)&&void 0!==e?e:MI(xI,this,_I).call(this),n.reposition=n.reposition||!1,n.isRTL=!1,n.onSelect=e=>{let t=e;isNaN(t.getTime())||(t=M(t).format(MI(xI,this,_I).call(this))),this.setValue(t),r&&r(),wm()&&this.hideDatepicker()},n.onClose=()=>{this.parentDestroyed||this.finishEditing(!1),i&&i()},n}refreshDimensions(e){var t;if(super.refreshDimensions(e),this.state!==jA.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD)return void this.hideDatepicker();const{rowIndexMapper:n,columnIndexMapper:r}=this.hot,{wtOverlays:i}=this.hot.view._wt,{wtTable:o}=null!==(t=i.getParentOverlay(this.TD))&&void 0!==t?t:this.hot.view._wt,s=n.getVisualFromRenderableIndex(o.getFirstPartiallyVisibleRow()),a=n.getVisualFromRenderableIndex(o.getLastPartiallyVisibleRow()),l=r.getVisualFromRenderableIndex(o.getFirstPartiallyVisibleColumn()),h=r.getVisualFromRenderableIndex(o.getLastPartiallyVisibleColumn());if(this.row>=s&&this.row<=a&&this.col>=l&&this.col<=h){const e=this.TD.getBoundingClientRect();this.datePickerStyle.top=`${this.hot.rootWindow.pageYOffset+e.top+Xp(this.TD)}px`;let t=this.hot.rootWindow.pageXOffset;this.hot.isRtl()?t+=e.right-Kp(this.datePicker):t+=e.left,this.datePickerStyle.left=`${t}px`}else this.hideDatepicker()}}function _I(){var e;return null!==(e=this.cellProperties.dateFormat)&&void 0!==e?e:"DD/MM/YYYY"}class LI extends QM{static get EDITOR_TYPE(){return"dropdown"}prepare(e,t,n,r,i,o){o.filter=!1,o.strict=!0,super.prepare(e,t,n,r,i,o)}}class HI extends AM{static get EDITOR_TYPE(){return"numeric"}}function kI(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class FI extends AM{constructor(){super(...arguments),kI(this,"autoResize",RM(this.hot.rootDocument,{textContent:e=>"â¢".repeat(e.value.length)}))}static get EDITOR_TYPE(){return"password"}createElements(){super.createElements(),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,Hp(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}const DI="ht_editor_visible",VI="selectEditor";class UI extends GA{static get EDITOR_TYPE(){return"select"}init(){this.selectWrapper=this.hot.rootDocument.createElement("div"),this.select=this.hot.rootDocument.createElement("select"),this.select.setAttribute("data-hot-input","true"),this.selectWrapper.style.display="none";const e=this.hot.rootDocument.createElement("DIV"),t=this.hot.getSettings().ariaTags;e.className="htAutocompleteArrow",t&&e.setAttribute("aria-hidden","true"),e.appendChild(this.hot.rootDocument.createTextNode(String.fromCharCode(9660))),Op(this.selectWrapper,"htSelectEditor"),this.selectWrapper.appendChild(this.select),this.selectWrapper.insertBefore(e,this.selectWrapper.firstChild),this.hot.rootElement.appendChild(this.selectWrapper),this.registerHooks()}getValue(){return this.select.value}setValue(e){this.select.value=e}open(){this._opened=!0,this.refreshDimensions(),this.selectWrapper.style.display="";this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.selectWrapper.style.display="none",Ip(this.selectWrapper,DI)&&xp(this.selectWrapper,DI),this.unregisterShortcuts(),this.clearHooks()}focus(){this.select.focus()}registerHooks(){this.addHook("afterScrollHorizontally",(()=>this.refreshDimensions())),this.addHook("afterScrollVertically",(()=>this.refreshDimensions())),this.addHook("afterColumnResize",(()=>this.refreshDimensions())),this.addHook("afterRowResize",(()=>this.refreshDimensions()))}prepare(e,t,n,r,i,o){super.prepare(e,t,n,r,i,o);const s=this.cellProperties.selectOptions;let a;a="function"==typeof s?this.prepareOptions(s(this.row,this.col,this.prop)):this.prepareOptions(s),Hp(this.select),nm(a,((e,t)=>{const n=this.hot.rootDocument.createElement("OPTION");n.value=t,Fp(n,e),this.select.appendChild(n)}))}prepareOptions(e){let t={};if(Array.isArray(e))for(let n=0,r=e.length;n<r;n++)t[e[n]]=e[n];else"object"==typeof e&&(t=e);return t}refreshValue(){const e=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=e,this.setValue(e),this.refreshDimensions()}refreshDimensions(){if(this.state!==jA.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD)return void this.close();const{top:e,start:t,width:n,height:r}=this.getEditedCellRect(),i=this.selectWrapper.style;i.height=`${r}px`,i.width=`${n}px`,i.top=`${e}px`,i[this.hot.isRtl()?"right":"left"]=`${t}px`,i.margin="0px",Op(this.selectWrapper,DI)}registerShortcuts(){const e=this.hot.getShortcutManager().getContext("editor"),t={group:VI};this.isInFullEditMode()&&e.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{const e=this.select.selectedIndex-1;e>=0&&(this.select[e].selected=!0)}},{keys:[["ArrowDown"]],callback:()=>{const e=this.select.selectedIndex+1;e<=this.select.length-1&&(this.select[e].selected=!0)}}],t)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(VI)}}class BI extends AM{static get EDITOR_TYPE(){return"time"}prepare(e,t,n,r,i,o){super.prepare(e,t,n,r,i,o),this.TEXTAREA.dir="ltr"}}function WI(e,t,n,r,i,o,s){MM.apply(this,[e,t,n,r,i,o,s]),Fp(t,null==o?"":o,!1)}WI.RENDERER_TYPE="html";function jI(e,t,n,r,i,o,s){const{rootDocument:a}=e,l=s.allowHtml?WI:IM,h=a.createElement("DIV"),u=e.getSettings().ariaTags;if(h.className="htAutocompleteArrow",u&&h.setAttribute("aria-hidden","true"),h.appendChild(a.createTextNode(String.fromCharCode(9660))),l.apply(this,[e,t,n,r,i,o,s]),t.firstChild||t.appendChild(a.createTextNode(String.fromCharCode(160))),t.insertBefore(h,t.firstChild),Op(t,"htAutocomplete"),!e.acArrowListener){const i=new Of(e);e.acArrowListener=function(i){Ip(i.target,"htAutocompleteArrow")&&e.view._wt.getSetting("onCellDblClick",null,e._createCellCoords(n,r),t)},i.addEventListener(e.rootElement,"mousedown",e.acArrowListener),e.addHookOnce("afterDestroy",(()=>{i.destroy()}))}}jI.RENDERER_TYPE="autocomplete";function GI(e,t,n,r,i,o,s){jI.apply(this,[e,t,n,r,i,o,s])}GI.RENDERER_TYPE="dropdown";const zI=new WeakMap,$I=new WeakMap,YI="data-row",KI="data-col",XI="checkboxRenderer",qI="checkbox";function QI(e,t,n,r,i,o,s){const{rootDocument:a}=e,l=e.getSettings().ariaTags;MM.apply(this,[e,t,n,r,i,o,s]),function(e){let t=$I.get(e);if(!t){const{rootElement:n}=e;t=new Of(e),t.addEventListener(n,"click",(t=>function(e,t){const{target:n}=e;if(!ZI(n))return;if(!n.hasAttribute(YI)||!n.hasAttribute(KI))return;const r=parseInt(n.getAttribute(YI),10),i=parseInt(n.getAttribute(KI),10),o=t.getCellMeta(r,i);o.readOnly&&e.preventDefault()}(t,e))),t.addEventListener(n,"mouseup",(t=>function(e,t){const{target:n}=e;if(!ZI(n))return;if(!n.hasAttribute(YI)||!n.hasAttribute(KI))return;setTimeout(t.listen,10)}(t,e))),t.addEventListener(n,"change",(t=>function(e,t){const{target:n}=e;if(!ZI(n))return;if(!n.hasAttribute(YI)||!n.hasAttribute(KI))return;const r=parseInt(n.getAttribute(YI),10),i=parseInt(n.getAttribute(KI),10),o=t.getCellMeta(r,i);if(!o.readOnly){let n=null;n=e.target.checked?void 0===o.uncheckedTemplate||o.checkedTemplate:void 0!==o.uncheckedTemplate&&o.uncheckedTemplate,t.setDataAtCell(r,i,n)}}(t,e))),$I.set(e,t)}}(e);let h=function(e){const t=e.createElement("input");return t.className="htCheckboxRendererInput",t.type="checkbox",t.setAttribute("tabindex","-1"),t.cloneNode(!1)}(a);const u=s.label;let c=!1;if(void 0===s.checkedTemplate&&(s.checkedTemplate=!0),void 0===s.uncheckedTemplate&&(s.uncheckedTemplate=!1),Hp(t),o===s.checkedTemplate||jd(o).toLocaleLowerCase(s.locale)===jd(s.checkedTemplate).toLocaleLowerCase(s.locale)?h.checked=!0:o===s.uncheckedTemplate||jd(o).toLocaleLowerCase(s.locale)===jd(s.uncheckedTemplate).toLocaleLowerCase(s.locale)?h.checked=!1:$d(o)?Op(h,"noValue"):(h.style.display="none",Op(h,"htBadValue"),c=!0),Pp(h,[[YI,n],[KI,r]]),l&&Pp(h,[up(h.checked?e.getTranslatedPhrase(VT):e.getTranslatedPhrase(UT)),wp(h.checked),["role","checkbox"]]),!c&&u){let s="";if(u.value)s="function"==typeof u.value?u.value.call(this,n,r,i,o):u.value;else if(u.property){const t=e.getDataAtRowProp(n,u.property);s=null!==t?t:""}const l=function(e,t,n){const r=e.createElement("label");r.className="htCheckboxRendererLabel "+(n?"fullWidth":"");const i=e.createTextNode(t);if(n){const t=e.createElement("span");t.appendChild(i),r.appendChild(t)}else r.appendChild(i);return r.cloneNode(!0)}(a,s,!0!==u.separated);"before"===u.position?u.separated?(t.appendChild(l),t.appendChild(h)):(l.appendChild(h),h=l):u.position&&"after"!==u.position||(u.separated?(t.appendChild(h),t.appendChild(l)):(l.insertBefore(h,l.firstChild),h=l))}function d(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const n=e.getSelectedRange(),r=[],i=new Map;let o=[],s=0;if(n){for(let a=0;a<n.length;a++){const{row:l,col:h}=n[a].getTopStartCorner(),{row:u,col:c}=n[a].getBottomEndCorner();for(let n=l;n<=u;n+=1)for(let a=h;a<=c;a+=1){const l=e.getCellMeta(n,a);if(l.hidden)continue;const h={checkedTemplate:l.checkedTemplate,uncheckedTemplate:l.uncheckedTemplate};if("checkbox"!==l.type){!0!==t||l.readOnly||(i.has(r.length)?i.set(r.length,[...i.get(r.length),[n,a,null]]):i.set(r.length,[[n,a,null]]));continue}if(!0===l.readOnly)continue;void 0===l.checkedTemplate&&(l.checkedTemplate=!0),void 0===l.uncheckedTemplate&&(l.uncheckedTemplate=!1);const u=e.getDataAtCell(n,a);!1===t?[l.checkedTemplate,l.checkedTemplate.toString()].includes(u)?o.push([n,a,l.uncheckedTemplate,h]):[l.uncheckedTemplate,l.uncheckedTemplate.toString(),null,void 0].includes(u)&&o.push([n,a,l.checkedTemplate,h]):o.push([n,a,l.uncheckedTemplate,h]),s+=1}r.push(s),s=0}o=o.every((e=>{let[,,t]=e;return t===o[0][2]}))?o.map((e=>{let[t,n,r]=e;return[t,n,r]})):o.map((e=>{let[t,n,,r]=e;return[t,n,r.checkedTemplate]})),o.length>0&&r.forEach(((t,n)=>{let r=o.splice(0,t);i.size&&i.has(n)&&(r=[...r,...i.get(n)]),e.setDataAtCell(r)}))}}function p(){const t=e.getSelectedRange();if(t){for(let n=0;n<t.length;n++){const r=t[n].getTopStartCorner(),i=t[n].getBottomEndCorner();for(let t=r.row;t<=i.row;t++)for(let n=r.col;n<=i.col;n++){if(e.getCellMeta(t,n).readOnly)continue;const r=e.getCell(t,n);if(dg(r)){if(r.querySelectorAll("input[type=checkbox]").length>0)return!0}}}return!1}}(!u||u&&!u.separated)&&t.appendChild(h),c&&t.appendChild(a.createTextNode("#bad-value#")),zI.has(e)||(zI.set(e,!0),function(){const t=e.getShortcutManager().getContext("grid"),n={group:XI,relativeToGroup:DA,position:"before"};t.addShortcuts([{keys:[["space"]],callback:()=>(d(),!p()),runOnlyIf:()=>{var t;return null===(t=e.getSelectedRangeLast())||void 0===t?void 0:t.highlight.isCell()}},{keys:[["enter"]],callback:()=>(d(),!p()),runOnlyIf:()=>{const t=e.getSelectedRangeLast();return e.getSettings().enterBeginsEditing&&(null==t?void 0:t.highlight.isCell())&&!e.selection.isMultiple()}},{keys:[["delete"],["backspace"]],callback:()=>(d(!0),!p()),runOnlyIf:()=>{var t;return null===(t=e.getSelectedRangeLast())||void 0===t?void 0:t.highlight.isCell()}}],n)}())}function ZI(e){return"INPUT"===e.tagName&&"checkbox"===e.getAttribute("type")}mf.getSingleton().add("modifyAutoColumnSizeSeed",(function(e,t,n){const{label:r,type:i,row:o,column:s,prop:a}=t;if(i===qI){if(r){const{value:t,property:i}=r;let l=n;if(t)l="function"==typeof t?t(o,s,a,n):t;else if(i){const e=this.getDataAtRowProp(o,i);l=null!==e?e:n}e=l}return e}})),QI.RENDERER_TYPE=qI;function JI(e,t,n,r,i,o,s){jI.apply(this,[e,t,n,r,i,o,s])}JI.RENDERER_TYPE="handsontable";var eO,tO,nO,rO,iO,oO,sO="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function aO(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}
/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */function lO(){return tO?eO:(tO=1,eO={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(e){let t=e%10;return 1==~~(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th"},bytes:{binarySuffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],decimalSuffixes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"]},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0,spaceSeparatedCurrency:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}})}
/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */function hO(){if(rO)return nO;rO=1;const e=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function t(e){return e.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function n(r,i,o,s,a,l,h){if(!isNaN(+r))return+r;let u="",c=r.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(c!==r)return-1*n(c,i,o,s,a,l);for(let t=0;t<e.length;t++){let h=e[t];if(u=r.replace(RegExp(`([0-9 ])(${h.key})$`),"$1"),u!==r)return n(u,i,o,s,a,l)*h.factor}if(u=r.replace("%",""),u!==r)return n(u,i,o,s,a,l)/100;let d=parseFloat(r);if(isNaN(d))return;let p=s(d);if(p&&"."!==p&&(u=r.replace(new RegExp(`${t(p)}$`),""),u!==r))return n(u,i,o,s,a,l);let g={};Object.keys(l).forEach((e=>{g[l[e]]=e}));let m=Object.keys(g).sort().reverse(),f=m.length;for(let e=0;e<f;e++){let t=m[e],h=g[t];if(u=r.replace(t,""),u!==r){let e;switch(h){case"thousand":e=Math.pow(10,3);break;case"million":e=Math.pow(10,6);break;case"billion":e=Math.pow(10,9);break;case"trillion":e=Math.pow(10,12)}return n(u,i,o,s,a,l)*e}}}function r(e,r,i="",o,s,a,l){if(""===e)return;if(e===s)return 0;let h=function(e,n,r){let i=e.replace(r,"");return i=i.replace(new RegExp(`([0-9])${t(n.thousands)}([0-9])`,"g"),"$1$2"),i=i.replace(n.decimal,"."),i}(e,r,i);return n(h,r,i,o,s,a)}return nO={unformat:function(e,t){const n=gO();let i,o=n.currentDelimiters(),s=n.currentCurrency().symbol,a=n.currentOrdinal(),l=n.getZeroFormat(),h=n.currentAbbreviations();if("string"==typeof e)i=function(e,t){if(!e.indexOf(":")||":"===t.thousands)return!1;let n=e.split(":");if(3!==n.length)return!1;let r=+n[0],i=+n[1],o=+n[2];return!isNaN(r)&&!isNaN(i)&&!isNaN(o)}(e,o)?function(e){let t=e.split(":"),n=+t[0],r=+t[1];return+t[2]+60*r+3600*n}(e):r(e,o,s,a,l,h);else{if("number"!=typeof e)return;i=e}if(void 0!==i)return i}},nO}
/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */function uO(){if(oO)return iO;oO=1;let e=hO();const t=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,n={output:{type:"string",validValues:["currency","percent","byte","time","ordinal","number"]},base:{type:"string",validValues:["decimal","binary","general"],restriction:(e,t)=>"byte"===t.output,message:"`base` must be provided only when the output is `byte`",mandatory:e=>"byte"===e.output},characteristic:{type:"number",restriction:e=>e>=0,message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:["trillion","billion","million","thousand"]},average:"boolean",lowPrecision:{type:"boolean",restriction:(e,t)=>!0===t.average,message:"`lowPrecision` must be provided only when the option `average` is set"},currencyPosition:{type:"string",validValues:["prefix","infix","postfix"]},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:e=>e>=0,message:"value must be positive"},{restriction:(e,t)=>!t.exponential,message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:e=>e>=0,message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",roundingFunction:"function",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",spaceSeparatedCurrency:"boolean",spaceSeparatedAbbreviation:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:["sign","parenthesis"]},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:(e,t)=>"percent"===t.output,message:"`prefixSymbol` can be provided only when the output is `percent`"}},r={languageTag:{type:"string",mandatory:!0,restriction:e=>e.match(t),message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:{type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},spaceSeparated:"boolean",spaceSeparatedCurrency:"boolean",ordinal:{type:"function",mandatory:!0},bytes:{type:"object",children:{binarySuffixes:"object",decimalSuffixes:"object"}},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function i(t){return void 0!==e.unformat(t)}function o(e,t,r,i=!1){let s=Object.keys(e).map((i=>{if(!t[i])return console.error(`${r} Invalid key: ${i}`),!1;let s=e[i],a=t[i];if("string"==typeof a&&(a={type:a}),"format"===a.type){if(!o(s,n,`[Validate ${i}]`,!0))return!1}else if(typeof s!==a.type)return console.error(`${r} ${i} type mismatched: "${a.type}" expected, "${typeof s}" provided`),!1;if(a.restrictions&&a.restrictions.length){let t=a.restrictions.length;for(let n=0;n<t;n++){let{restriction:t,message:o}=a.restrictions[n];if(!t(s,e))return console.error(`${r} ${i} invalid value: ${o}`),!1}}if(a.restriction&&!a.restriction(s,e))return console.error(`${r} ${i} invalid value: ${a.message}`),!1;if(a.validValues&&-1===a.validValues.indexOf(s))return console.error(`${r} ${i} invalid value: must be among ${JSON.stringify(a.validValues)}, "${s}" provided`),!1;if(a.children){if(!o(s,a.children,`[Validate ${i}]`))return!1}return!0}));return i||s.push(...Object.keys(t).map((n=>{let i=t[n];if("string"==typeof i&&(i={type:i}),i.mandatory){let t=i.mandatory;if("function"==typeof t&&(t=t(e)),t&&void 0===e[n])return console.error(`${r} Missing mandatory key "${n}"`),!1}return!0}))),s.reduce(((e,t)=>e&&t),!0)}function s(e){return o(e,n,"[Validate format]")}return iO={validate:function(e,t){let n=i(e),r=s(t);return n&&r},validateFormat:s,validateInput:i,validateLanguage:function(e){return o(e,r,"[Validate language]")}},iO}
/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var cO,dO,pO={parseFormat:function(e,t={}){return"string"!=typeof e?e:(e=function(e,t){let n=e.match(/^{([^}]*)}/);return n?(t.prefix=n[1],e.slice(n[0].length)):e}(e,t),e=function(e,t){let n=e.match(/{([^}]*)}$/);return n?(t.postfix=n[1],e.slice(0,-n[0].length)):e}(e,t),function(e,t){if(-1===e.indexOf("$")){if(-1===e.indexOf("%"))return-1!==e.indexOf("bd")?(t.output="byte",void(t.base="general")):-1!==e.indexOf("b")?(t.output="byte",void(t.base="binary")):-1!==e.indexOf("d")?(t.output="byte",void(t.base="decimal")):void(-1===e.indexOf(":")?-1!==e.indexOf("o")&&(t.output="ordinal"):t.output="time");t.output="percent"}else t.output="currency"}(e,t),function(e,t){let n=e.match(/[1-9]+[0-9]*/);n&&(t.totalLength=+n[0])}(e,t),function(e,t){let n=e.split(".")[0].match(/0+/);n&&(t.characteristic=n[0].length)}(e,t),function(e,t){if(-1!==e.indexOf(".")){let n=e.split(".")[0];t.optionalCharacteristic=-1===n.indexOf("0")}}(e,t),function(e,t){-1!==e.indexOf("a")&&(t.average=!0)}(e,t),function(e,t){-1!==e.indexOf("K")?t.forceAverage="thousand":-1!==e.indexOf("M")?t.forceAverage="million":-1!==e.indexOf("B")?t.forceAverage="billion":-1!==e.indexOf("T")&&(t.forceAverage="trillion")}(e,t),function(e,t){let n=e.split(".")[1];if(n){let e=n.match(/0+/);e&&(t.mantissa=e[0].length)}}(e,t),function(e,t){e.match(/\[\.]/)?t.optionalMantissa=!0:e.match(/\./)&&(t.optionalMantissa=!1)}(e,t),function(e,t){const n=e.split(".")[1];n&&(t.trimMantissa=-1!==n.indexOf("["))}(e,t),function(e,t){-1!==e.indexOf(",")&&(t.thousandSeparated=!0)}(e,t),function(e,t){-1!==e.indexOf(" ")&&(t.spaceSeparated=!0,t.spaceSeparatedCurrency=!0,(t.average||t.forceAverage)&&(t.spaceSeparatedAbbreviation=!0))}(e,t),function(e,t){e.match(/^\+?\([^)]*\)$/)&&(t.negative="parenthesis"),e.match(/^\+?-/)&&(t.negative="sign")}(e,t),function(e,t){e.match(/^\+/)&&(t.forceSign=!0)}(e,t),t)}};
/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */function gO(){if(dO)return cO;dO=1;const e=lO(),t=uO(),n=pO;let r,i={},o={},s=null,a={};function l(e){r=e}function h(){return o[r]}return i.languages=()=>Object.assign({},o),i.currentLanguage=()=>r,i.currentBytes=()=>h().bytes||{},i.currentCurrency=()=>h().currency,i.currentAbbreviations=()=>h().abbreviations,i.currentDelimiters=()=>h().delimiters,i.currentOrdinal=()=>h().ordinal,i.currentDefaults=()=>Object.assign({},h().defaults,a),i.currentOrdinalDefaultFormat=()=>Object.assign({},i.currentDefaults(),h().ordinalFormat),i.currentByteDefaultFormat=()=>Object.assign({},i.currentDefaults(),h().byteFormat),i.currentPercentageDefaultFormat=()=>Object.assign({},i.currentDefaults(),h().percentageFormat),i.currentCurrencyDefaultFormat=()=>Object.assign({},i.currentDefaults(),h().currencyFormat),i.currentTimeDefaultFormat=()=>Object.assign({},i.currentDefaults(),h().timeFormat),i.setDefaults=e=>{e=n.parseFormat(e),t.validateFormat(e)&&(a=e)},i.getZeroFormat=()=>s,i.setZeroFormat=e=>s="string"==typeof e?e:null,i.hasZeroFormat=()=>null!==s,i.languageData=e=>{if(e){if(o[e])return o[e];throw new Error(`Unknown tag "${e}"`)}return h()},i.registerLanguage=(e,n=!1)=>{if(!t.validateLanguage(e))throw new Error("Invalid language data");o[e.languageTag]=e,n&&l(e.languageTag)},i.setLanguage=(t,n=e.languageTag)=>{if(!o[t]){let e=t.split("-")[0],r=Object.keys(o).find((t=>t.split("-")[0]===e));return o[r]?void l(r):void l(n)}l(t)},i.registerLanguage(e),r=e.languageTag,cO=i}
/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */
function mO(e,t){e.forEach((e=>{let n;try{n=function(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}(`../languages/${e}`)}catch(r){console.error(`Unable to load "${e}". No matching language file found.`)}n&&t.registerLanguage(n)}))}var fO,wO={exports:{}};fO=wO,function(e){var t,n=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,r=Math.ceil,i=Math.floor,o="[BigNumber Error] ",s=o+"Number primitive has more than 15 significant digits: ",a=1e14,l=14,h=9007199254740991,u=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],c=1e7,d=1e9;function p(e){var t=0|e;return e>0||e===t?t:t-1}function g(e){for(var t,n,r=1,i=e.length,o=e[0]+"";r<i;){for(t=e[r++]+"",n=l-t.length;n--;t="0"+t);o+=t}for(i=o.length;48===o.charCodeAt(--i););return o.slice(0,i+1||1)}function m(e,t){var n,r,i=e.c,o=t.c,s=e.s,a=t.s,l=e.e,h=t.e;if(!s||!a)return null;if(n=i&&!i[0],r=o&&!o[0],n||r)return n?r?0:-a:s;if(s!=a)return s;if(n=s<0,r=l==h,!i||!o)return r?0:!i^n?1:-1;if(!r)return l>h^n?1:-1;for(a=(l=i.length)<(h=o.length)?l:h,s=0;s<a;s++)if(i[s]!=o[s])return i[s]>o[s]^n?1:-1;return l==h?0:l>h^n?1:-1}function f(e,t,n,r){if(e<t||e>n||e!==i(e))throw Error(o+(r||"Argument")+("number"==typeof e?e<t||e>n?" out of range: ":" not an integer: ":" not a primitive number: ")+String(e))}function w(e){var t=e.c.length-1;return p(e.e/l)==t&&e.c[t]%2!=0}function y(e,t){return(e.length>1?e.charAt(0)+"."+e.slice(1):e)+(t<0?"e":"e+")+t}function v(e,t,n){var r,i;if(t<0){for(i=n+".";++t;i+=n);e=i+e}else if(++t>(r=e.length)){for(i=n,t-=r;--t;i+=n);e+=i}else t<r&&(e=e.slice(0,t)+"."+e.slice(t));return e}t=function e(t){var C,S,R,E,b,T,N,A,M,I,O=G.prototype={constructor:G,toString:null,valueOf:null},x=new G(1),P=20,_=4,L=-7,H=21,k=-1e7,F=1e7,D=!1,V=1,U=0,B={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"Â ",suffix:""},W="0123456789abcdefghijklmnopqrstuvwxyz",j=!0;function G(e,t){var r,o,a,u,c,d,p,g,m=this;if(!(m instanceof G))return new G(e,t);if(null==t){if(e&&!0===e._isBigNumber)return m.s=e.s,void(!e.c||e.e>F?m.c=m.e=null:e.e<k?m.c=[m.e=0]:(m.e=e.e,m.c=e.c.slice()));if((d="number"==typeof e)&&0*e==0){if(m.s=1/e<0?(e=-e,-1):1,e===~~e){for(u=0,c=e;c>=10;c/=10,u++);return void(u>F?m.c=m.e=null:(m.e=u,m.c=[e]))}g=String(e)}else{if(!n.test(g=String(e)))return R(m,g,d);m.s=45==g.charCodeAt(0)?(g=g.slice(1),-1):1}(u=g.indexOf("."))>-1&&(g=g.replace(".","")),(c=g.search(/e/i))>0?(u<0&&(u=c),u+=+g.slice(c+1),g=g.substring(0,c)):u<0&&(u=g.length)}else{if(f(t,2,W.length,"Base"),10==t&&j)return K(m=new G(e),P+m.e+1,_);if(g=String(e),d="number"==typeof e){if(0*e!=0)return R(m,g,d,t);if(m.s=1/e<0?(g=g.slice(1),-1):1,G.DEBUG&&g.replace(/^0\.0*|\./,"").length>15)throw Error(s+e)}else m.s=45===g.charCodeAt(0)?(g=g.slice(1),-1):1;for(r=W.slice(0,t),u=c=0,p=g.length;c<p;c++)if(r.indexOf(o=g.charAt(c))<0){if("."==o){if(c>u){u=p;continue}}else if(!a&&(g==g.toUpperCase()&&(g=g.toLowerCase())||g==g.toLowerCase()&&(g=g.toUpperCase()))){a=!0,c=-1,u=0;continue}return R(m,String(e),d,t)}d=!1,(u=(g=S(g,t,10,m.s)).indexOf("."))>-1?g=g.replace(".",""):u=g.length}for(c=0;48===g.charCodeAt(c);c++);for(p=g.length;48===g.charCodeAt(--p););if(g=g.slice(c,++p)){if(p-=c,d&&G.DEBUG&&p>15&&(e>h||e!==i(e)))throw Error(s+m.s*e);if((u=u-c-1)>F)m.c=m.e=null;else if(u<k)m.c=[m.e=0];else{if(m.e=u,m.c=[],c=(u+1)%l,u<0&&(c+=l),c<p){for(c&&m.c.push(+g.slice(0,c)),p-=l;c<p;)m.c.push(+g.slice(c,c+=l));c=l-(g=g.slice(c)).length}else c-=p;for(;c--;g+="0");m.c.push(+g)}}else m.c=[m.e=0]}function z(e,t,n,r){var i,o,s,a,l;if(null==n?n=_:f(n,0,8),!e.c)return e.toString();if(i=e.c[0],s=e.e,null==t)l=g(e.c),l=1==r||2==r&&(s<=L||s>=H)?y(l,s):v(l,s,"0");else if(o=(e=K(new G(e),t,n)).e,a=(l=g(e.c)).length,1==r||2==r&&(t<=o||o<=L)){for(;a<t;l+="0",a++);l=y(l,o)}else if(t-=s,l=v(l,o,"0"),o+1>a){if(--t>0)for(l+=".";t--;l+="0");}else if((t+=o-a)>0)for(o+1==a&&(l+=".");t--;l+="0");return e.s<0&&i?"-"+l:l}function $(e,t){for(var n,r,i=1,o=new G(e[0]);i<e.length;i++)(!(r=new G(e[i])).s||(n=m(o,r))===t||0===n&&o.s===t)&&(o=r);return o}function Y(e,t,n){for(var r=1,i=t.length;!t[--i];t.pop());for(i=t[0];i>=10;i/=10,r++);return(n=r+n*l-1)>F?e.c=e.e=null:n<k?e.c=[e.e=0]:(e.e=n,e.c=t),e}function K(e,t,n,o){var s,h,c,d,p,g,m,f=e.c,w=u;if(f){e:{for(s=1,d=f[0];d>=10;d/=10,s++);if((h=t-s)<0)h+=l,c=t,p=f[g=0],m=i(p/w[s-c-1]%10);else if((g=r((h+1)/l))>=f.length){if(!o)break e;for(;f.length<=g;f.push(0));p=m=0,s=1,c=(h%=l)-l+1}else{for(p=d=f[g],s=1;d>=10;d/=10,s++);m=(c=(h%=l)-l+s)<0?0:i(p/w[s-c-1]%10)}if(o=o||t<0||null!=f[g+1]||(c<0?p:p%w[s-c-1]),o=n<4?(m||o)&&(0==n||n==(e.s<0?3:2)):m>5||5==m&&(4==n||o||6==n&&(h>0?c>0?p/w[s-c]:0:f[g-1])%10&1||n==(e.s<0?8:7)),t<1||!f[0])return f.length=0,o?(t-=e.e+1,f[0]=w[(l-t%l)%l],e.e=-t||0):f[0]=e.e=0,e;if(0==h?(f.length=g,d=1,g--):(f.length=g+1,d=w[l-h],f[g]=c>0?i(p/w[s-c]%w[c])*d:0),o)for(;;){if(0==g){for(h=1,c=f[0];c>=10;c/=10,h++);for(c=f[0]+=d,d=1;c>=10;c/=10,d++);h!=d&&(e.e++,f[0]==a&&(f[0]=1));break}if(f[g]+=d,f[g]!=a)break;f[g--]=0,d=1}for(h=f.length;0===f[--h];f.pop());}e.e>F?e.c=e.e=null:e.e<k&&(e.c=[e.e=0])}return e}function X(e){var t,n=e.e;return null===n?e.toString():(t=g(e.c),t=n<=L||n>=H?y(t,n):v(t,n,"0"),e.s<0?"-"+t:t)}return G.clone=e,G.ROUND_UP=0,G.ROUND_DOWN=1,G.ROUND_CEIL=2,G.ROUND_FLOOR=3,G.ROUND_HALF_UP=4,G.ROUND_HALF_DOWN=5,G.ROUND_HALF_EVEN=6,G.ROUND_HALF_CEIL=7,G.ROUND_HALF_FLOOR=8,G.EUCLID=9,G.config=G.set=function(e){var t,n;if(null!=e){if("object"!=typeof e)throw Error(o+"Object expected: "+e);if(e.hasOwnProperty(t="DECIMAL_PLACES")&&(f(n=e[t],0,d,t),P=n),e.hasOwnProperty(t="ROUNDING_MODE")&&(f(n=e[t],0,8,t),_=n),e.hasOwnProperty(t="EXPONENTIAL_AT")&&((n=e[t])&&n.pop?(f(n[0],-d,0,t),f(n[1],0,d,t),L=n[0],H=n[1]):(f(n,-d,d,t),L=-(H=n<0?-n:n))),e.hasOwnProperty(t="RANGE"))if((n=e[t])&&n.pop)f(n[0],-d,-1,t),f(n[1],1,d,t),k=n[0],F=n[1];else{if(f(n,-d,d,t),!n)throw Error(o+t+" cannot be zero: "+n);k=-(F=n<0?-n:n)}if(e.hasOwnProperty(t="CRYPTO")){if((n=e[t])!==!!n)throw Error(o+t+" not true or false: "+n);if(n){if("undefined"==typeof crypto||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw D=!n,Error(o+"crypto unavailable");D=n}else D=n}if(e.hasOwnProperty(t="MODULO_MODE")&&(f(n=e[t],0,9,t),V=n),e.hasOwnProperty(t="POW_PRECISION")&&(f(n=e[t],0,d,t),U=n),e.hasOwnProperty(t="FORMAT")){if("object"!=typeof(n=e[t]))throw Error(o+t+" not an object: "+n);B=n}if(e.hasOwnProperty(t="ALPHABET")){if("string"!=typeof(n=e[t])||/^.?$|[+\-.\s]|(.).*\1/.test(n))throw Error(o+t+" invalid: "+n);j="0123456789"==n.slice(0,10),W=n}}return{DECIMAL_PLACES:P,ROUNDING_MODE:_,EXPONENTIAL_AT:[L,H],RANGE:[k,F],CRYPTO:D,MODULO_MODE:V,POW_PRECISION:U,FORMAT:B,ALPHABET:W}},G.isBigNumber=function(e){if(!e||!0!==e._isBigNumber)return!1;if(!G.DEBUG)return!0;var t,n,r=e.c,s=e.e,h=e.s;e:if("[object Array]"=={}.toString.call(r)){if((1===h||-1===h)&&s>=-d&&s<=d&&s===i(s)){if(0===r[0]){if(0===s&&1===r.length)return!0;break e}if((t=(s+1)%l)<1&&(t+=l),String(r[0]).length==t){for(t=0;t<r.length;t++)if((n=r[t])<0||n>=a||n!==i(n))break e;if(0!==n)return!0}}}else if(null===r&&null===s&&(null===h||1===h||-1===h))return!0;throw Error(o+"Invalid BigNumber: "+e)},G.maximum=G.max=function(){return $(arguments,-1)},G.minimum=G.min=function(){return $(arguments,1)},G.random=(E=9007199254740992,b=Math.random()*E&2097151?function(){return i(Math.random()*E)}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)},function(e){var t,n,s,a,h,c=0,p=[],g=new G(x);if(null==e?e=P:f(e,0,d),a=r(e/l),D)if(crypto.getRandomValues){for(t=crypto.getRandomValues(new Uint32Array(a*=2));c<a;)(h=131072*t[c]+(t[c+1]>>>11))>=9e15?(n=crypto.getRandomValues(new Uint32Array(2)),t[c]=n[0],t[c+1]=n[1]):(p.push(h%1e14),c+=2);c=a/2}else{if(!crypto.randomBytes)throw D=!1,Error(o+"crypto unavailable");for(t=crypto.randomBytes(a*=7);c<a;)(h=281474976710656*(31&t[c])+1099511627776*t[c+1]+4294967296*t[c+2]+16777216*t[c+3]+(t[c+4]<<16)+(t[c+5]<<8)+t[c+6])>=9e15?crypto.randomBytes(7).copy(t,c):(p.push(h%1e14),c+=7);c=a/7}if(!D)for(;c<a;)(h=b())<9e15&&(p[c++]=h%1e14);for(a=p[--c],e%=l,a&&e&&(h=u[l-e],p[c]=i(a/h)*h);0===p[c];p.pop(),c--);if(c<0)p=[s=0];else{for(s=-1;0===p[0];p.splice(0,1),s-=l);for(c=1,h=p[0];h>=10;h/=10,c++);c<l&&(s-=l-c)}return g.e=s,g.c=p,g}),G.sum=function(){for(var e=1,t=arguments,n=new G(t[0]);e<t.length;)n=n.plus(t[e++]);return n},S=function(){var e="0123456789";function t(e,t,n,r){for(var i,o,s=[0],a=0,l=e.length;a<l;){for(o=s.length;o--;s[o]*=t);for(s[0]+=r.indexOf(e.charAt(a++)),i=0;i<s.length;i++)s[i]>n-1&&(null==s[i+1]&&(s[i+1]=0),s[i+1]+=s[i]/n|0,s[i]%=n)}return s.reverse()}return function(n,r,i,o,s){var a,l,h,u,c,d,p,m,f=n.indexOf("."),w=P,y=_;for(f>=0&&(u=U,U=0,n=n.replace(".",""),d=(m=new G(r)).pow(n.length-f),U=u,m.c=t(v(g(d.c),d.e,"0"),10,i,e),m.e=m.c.length),h=u=(p=t(n,r,i,s?(a=W,e):(a=e,W))).length;0==p[--u];p.pop());if(!p[0])return a.charAt(0);if(f<0?--h:(d.c=p,d.e=h,d.s=o,p=(d=C(d,m,w,y,i)).c,c=d.r,h=d.e),f=p[l=h+w+1],u=i/2,c=c||l<0||null!=p[l+1],c=y<4?(null!=f||c)&&(0==y||y==(d.s<0?3:2)):f>u||f==u&&(4==y||c||6==y&&1&p[l-1]||y==(d.s<0?8:7)),l<1||!p[0])n=c?v(a.charAt(1),-w,a.charAt(0)):a.charAt(0);else{if(p.length=l,c)for(--i;++p[--l]>i;)p[l]=0,l||(++h,p=[1].concat(p));for(u=p.length;!p[--u];);for(f=0,n="";f<=u;n+=a.charAt(p[f++]));n=v(n,h,a.charAt(0))}return n}}(),C=function(){function e(e,t,n){var r,i,o,s,a=0,l=e.length,h=t%c,u=t/c|0;for(e=e.slice();l--;)a=((i=h*(o=e[l]%c)+(r=u*o+(s=e[l]/c|0)*h)%c*c+a)/n|0)+(r/c|0)+u*s,e[l]=i%n;return a&&(e=[a].concat(e)),e}function t(e,t,n,r){var i,o;if(n!=r)o=n>r?1:-1;else for(i=o=0;i<n;i++)if(e[i]!=t[i]){o=e[i]>t[i]?1:-1;break}return o}function n(e,t,n,r){for(var i=0;n--;)e[n]-=i,i=e[n]<t[n]?1:0,e[n]=i*r+e[n]-t[n];for(;!e[0]&&e.length>1;e.splice(0,1));}return function(r,o,s,h,u){var c,d,g,m,f,w,y,v,C,S,R,E,b,T,N,A,M,I=r.s==o.s?1:-1,O=r.c,x=o.c;if(!(O&&O[0]&&x&&x[0]))return new G(r.s&&o.s&&(O?!x||O[0]!=x[0]:x)?O&&0==O[0]||!x?0*I:I/0:NaN);for(C=(v=new G(I)).c=[],I=s+(d=r.e-o.e)+1,u||(u=a,d=p(r.e/l)-p(o.e/l),I=I/l|0),g=0;x[g]==(O[g]||0);g++);if(x[g]>(O[g]||0)&&d--,I<0)C.push(1),m=!0;else{for(T=O.length,A=x.length,g=0,I+=2,(f=i(u/(x[0]+1)))>1&&(x=e(x,f,u),O=e(O,f,u),A=x.length,T=O.length),b=A,R=(S=O.slice(0,A)).length;R<A;S[R++]=0);M=x.slice(),M=[0].concat(M),N=x[0],x[1]>=u/2&&N++;do{if(f=0,(c=t(x,S,A,R))<0){if(E=S[0],A!=R&&(E=E*u+(S[1]||0)),(f=i(E/N))>1)for(f>=u&&(f=u-1),y=(w=e(x,f,u)).length,R=S.length;1==t(w,S,y,R);)f--,n(w,A<y?M:x,y,u),y=w.length,c=1;else 0==f&&(c=f=1),y=(w=x.slice()).length;if(y<R&&(w=[0].concat(w)),n(S,w,R,u),R=S.length,-1==c)for(;t(x,S,A,R)<1;)f++,n(S,A<R?M:x,R,u),R=S.length}else 0===c&&(f++,S=[0]);C[g++]=f,S[0]?S[R++]=O[b]||0:(S=[O[b]],R=1)}while((b++<T||null!=S[0])&&I--);m=null!=S[0],C[0]||C.splice(0,1)}if(u==a){for(g=1,I=C[0];I>=10;I/=10,g++);K(v,s+(v.e=g+d*l-1)+1,h,m)}else v.e=d,v.r=+m;return v}}(),T=/^(-?)0([xbo])(?=\w[\w.]*$)/i,N=/^([^.]+)\.$/,A=/^\.([^.]+)$/,M=/^-?(Infinity|NaN)$/,I=/^\s*\+(?=[\w.])|^\s+|\s+$/g,R=function(e,t,n,r){var i,s=n?t:t.replace(I,"");if(M.test(s))e.s=isNaN(s)?null:s<0?-1:1;else{if(!n&&(s=s.replace(T,(function(e,t,n){return i="x"==(n=n.toLowerCase())?16:"b"==n?2:8,r&&r!=i?e:t})),r&&(i=r,s=s.replace(N,"$1").replace(A,"0.$1")),t!=s))return new G(s,i);if(G.DEBUG)throw Error(o+"Not a"+(r?" base "+r:"")+" number: "+t);e.s=null}e.c=e.e=null},O.absoluteValue=O.abs=function(){var e=new G(this);return e.s<0&&(e.s=1),e},O.comparedTo=function(e,t){return m(this,new G(e,t))},O.decimalPlaces=O.dp=function(e,t){var n,r,i,o=this;if(null!=e)return f(e,0,d),null==t?t=_:f(t,0,8),K(new G(o),e+o.e+1,t);if(!(n=o.c))return null;if(r=((i=n.length-1)-p(this.e/l))*l,i=n[i])for(;i%10==0;i/=10,r--);return r<0&&(r=0),r},O.dividedBy=O.div=function(e,t){return C(this,new G(e,t),P,_)},O.dividedToIntegerBy=O.idiv=function(e,t){return C(this,new G(e,t),0,1)},O.exponentiatedBy=O.pow=function(e,t){var n,s,a,h,u,c,d,p,g=this;if((e=new G(e)).c&&!e.isInteger())throw Error(o+"Exponent not an integer: "+X(e));if(null!=t&&(t=new G(t)),u=e.e>14,!g.c||!g.c[0]||1==g.c[0]&&!g.e&&1==g.c.length||!e.c||!e.c[0])return p=new G(Math.pow(+X(g),u?e.s*(2-w(e)):+X(e))),t?p.mod(t):p;if(c=e.s<0,t){if(t.c?!t.c[0]:!t.s)return new G(NaN);(s=!c&&g.isInteger()&&t.isInteger())&&(g=g.mod(t))}else{if(e.e>9&&(g.e>0||g.e<-1||(0==g.e?g.c[0]>1||u&&g.c[1]>=24e7:g.c[0]<8e13||u&&g.c[0]<=9999975e7)))return h=g.s<0&&w(e)?-0:0,g.e>-1&&(h=1/h),new G(c?1/h:h);U&&(h=r(U/l+2))}for(u?(n=new G(.5),c&&(e.s=1),d=w(e)):d=(a=Math.abs(+X(e)))%2,p=new G(x);;){if(d){if(!(p=p.times(g)).c)break;h?p.c.length>h&&(p.c.length=h):s&&(p=p.mod(t))}if(a){if(0===(a=i(a/2)))break;d=a%2}else if(K(e=e.times(n),e.e+1,1),e.e>14)d=w(e);else{if(0==(a=+X(e)))break;d=a%2}g=g.times(g),h?g.c&&g.c.length>h&&(g.c.length=h):s&&(g=g.mod(t))}return s?p:(c&&(p=x.div(p)),t?p.mod(t):h?K(p,U,_,void 0):p)},O.integerValue=function(e){var t=new G(this);return null==e?e=_:f(e,0,8),K(t,t.e+1,e)},O.isEqualTo=O.eq=function(e,t){return 0===m(this,new G(e,t))},O.isFinite=function(){return!!this.c},O.isGreaterThan=O.gt=function(e,t){return m(this,new G(e,t))>0},O.isGreaterThanOrEqualTo=O.gte=function(e,t){return 1===(t=m(this,new G(e,t)))||0===t},O.isInteger=function(){return!!this.c&&p(this.e/l)>this.c.length-2},O.isLessThan=O.lt=function(e,t){return m(this,new G(e,t))<0},O.isLessThanOrEqualTo=O.lte=function(e,t){return-1===(t=m(this,new G(e,t)))||0===t},O.isNaN=function(){return!this.s},O.isNegative=function(){return this.s<0},O.isPositive=function(){return this.s>0},O.isZero=function(){return!!this.c&&0==this.c[0]},O.minus=function(e,t){var n,r,i,o,s=this,h=s.s;if(t=(e=new G(e,t)).s,!h||!t)return new G(NaN);if(h!=t)return e.s=-t,s.plus(e);var u=s.e/l,c=e.e/l,d=s.c,g=e.c;if(!u||!c){if(!d||!g)return d?(e.s=-t,e):new G(g?s:NaN);if(!d[0]||!g[0])return g[0]?(e.s=-t,e):new G(d[0]?s:3==_?-0:0)}if(u=p(u),c=p(c),d=d.slice(),h=u-c){for((o=h<0)?(h=-h,i=d):(c=u,i=g),i.reverse(),t=h;t--;i.push(0));i.reverse()}else for(r=(o=(h=d.length)<(t=g.length))?h:t,h=t=0;t<r;t++)if(d[t]!=g[t]){o=d[t]<g[t];break}if(o&&(i=d,d=g,g=i,e.s=-e.s),(t=(r=g.length)-(n=d.length))>0)for(;t--;d[n++]=0);for(t=a-1;r>h;){if(d[--r]<g[r]){for(n=r;n&&!d[--n];d[n]=t);--d[n],d[r]+=a}d[r]-=g[r]}for(;0==d[0];d.splice(0,1),--c);return d[0]?Y(e,d,c):(e.s=3==_?-1:1,e.c=[e.e=0],e)},O.modulo=O.mod=function(e,t){var n,r,i=this;return e=new G(e,t),!i.c||!e.s||e.c&&!e.c[0]?new G(NaN):!e.c||i.c&&!i.c[0]?new G(i):(9==V?(r=e.s,e.s=1,n=C(i,e,0,3),e.s=r,n.s*=r):n=C(i,e,0,V),(e=i.minus(n.times(e))).c[0]||1!=V||(e.s=i.s),e)},O.multipliedBy=O.times=function(e,t){var n,r,i,o,s,h,u,d,g,m,f,w,y,v,C,S=this,R=S.c,E=(e=new G(e,t)).c;if(!(R&&E&&R[0]&&E[0]))return!S.s||!e.s||R&&!R[0]&&!E||E&&!E[0]&&!R?e.c=e.e=e.s=null:(e.s*=S.s,R&&E?(e.c=[0],e.e=0):e.c=e.e=null),e;for(r=p(S.e/l)+p(e.e/l),e.s*=S.s,(u=R.length)<(m=E.length)&&(y=R,R=E,E=y,i=u,u=m,m=i),i=u+m,y=[];i--;y.push(0));for(v=a,C=c,i=m;--i>=0;){for(n=0,f=E[i]%C,w=E[i]/C|0,o=i+(s=u);o>i;)n=((d=f*(d=R[--s]%C)+(h=w*d+(g=R[s]/C|0)*f)%C*C+y[o]+n)/v|0)+(h/C|0)+w*g,y[o--]=d%v;y[o]=n}return n?++r:y.splice(0,1),Y(e,y,r)},O.negated=function(){var e=new G(this);return e.s=-e.s||null,e},O.plus=function(e,t){var n,r=this,i=r.s;if(t=(e=new G(e,t)).s,!i||!t)return new G(NaN);if(i!=t)return e.s=-t,r.minus(e);var o=r.e/l,s=e.e/l,h=r.c,u=e.c;if(!o||!s){if(!h||!u)return new G(i/0);if(!h[0]||!u[0])return u[0]?e:new G(h[0]?r:0*i)}if(o=p(o),s=p(s),h=h.slice(),i=o-s){for(i>0?(s=o,n=u):(i=-i,n=h),n.reverse();i--;n.push(0));n.reverse()}for((i=h.length)-(t=u.length)<0&&(n=u,u=h,h=n,t=i),i=0;t;)i=(h[--t]=h[t]+u[t]+i)/a|0,h[t]=a===h[t]?0:h[t]%a;return i&&(h=[i].concat(h),++s),Y(e,h,s)},O.precision=O.sd=function(e,t){var n,r,i,o=this;if(null!=e&&e!==!!e)return f(e,1,d),null==t?t=_:f(t,0,8),K(new G(o),e,t);if(!(n=o.c))return null;if(r=(i=n.length-1)*l+1,i=n[i]){for(;i%10==0;i/=10,r--);for(i=n[0];i>=10;i/=10,r++);}return e&&o.e+1>r&&(r=o.e+1),r},O.shiftedBy=function(e){return f(e,-9007199254740991,h),this.times("1e"+e)},O.squareRoot=O.sqrt=function(){var e,t,n,r,i,o=this,s=o.c,a=o.s,l=o.e,h=P+4,u=new G("0.5");if(1!==a||!s||!s[0])return new G(!a||a<0&&(!s||s[0])?NaN:s?o:1/0);if(0==(a=Math.sqrt(+X(o)))||a==1/0?(((t=g(s)).length+l)%2==0&&(t+="0"),a=Math.sqrt(+t),l=p((l+1)/2)-(l<0||l%2),n=new G(t=a==1/0?"5e"+l:(t=a.toExponential()).slice(0,t.indexOf("e")+1)+l)):n=new G(a+""),n.c[0])for((a=(l=n.e)+h)<3&&(a=0);;)if(i=n,n=u.times(i.plus(C(o,i,h,1))),g(i.c).slice(0,a)===(t=g(n.c)).slice(0,a)){if(n.e<l&&--a,"9999"!=(t=t.slice(a-3,a+1))&&(r||"4999"!=t)){+t&&(+t.slice(1)||"5"!=t.charAt(0))||(K(n,n.e+P+2,1),e=!n.times(n).eq(o));break}if(!r&&(K(i,i.e+P+2,0),i.times(i).eq(o))){n=i;break}h+=4,a+=4,r=1}return K(n,n.e+P+1,_,e)},O.toExponential=function(e,t){return null!=e&&(f(e,0,d),e++),z(this,e,t,1)},O.toFixed=function(e,t){return null!=e&&(f(e,0,d),e=e+this.e+1),z(this,e,t)},O.toFormat=function(e,t,n){var r,i=this;if(null==n)null!=e&&t&&"object"==typeof t?(n=t,t=null):e&&"object"==typeof e?(n=e,e=t=null):n=B;else if("object"!=typeof n)throw Error(o+"Argument not an object: "+n);if(r=i.toFixed(e,t),i.c){var s,a=r.split("."),l=+n.groupSize,h=+n.secondaryGroupSize,u=n.groupSeparator||"",c=a[0],d=a[1],p=i.s<0,g=p?c.slice(1):c,m=g.length;if(h&&(s=l,l=h,h=s,m-=s),l>0&&m>0){for(s=m%l||l,c=g.substr(0,s);s<m;s+=l)c+=u+g.substr(s,l);h>0&&(c+=u+g.slice(s)),p&&(c="-"+c)}r=d?c+(n.decimalSeparator||"")+((h=+n.fractionGroupSize)?d.replace(new RegExp("\\d{"+h+"}\\B","g"),"$&"+(n.fractionGroupSeparator||"")):d):c}return(n.prefix||"")+r+(n.suffix||"")},O.toFraction=function(e){var t,n,r,i,s,a,h,c,d,p,m,f,w=this,y=w.c;if(null!=e&&(!(h=new G(e)).isInteger()&&(h.c||1!==h.s)||h.lt(x)))throw Error(o+"Argument "+(h.isInteger()?"out of range: ":"not an integer: ")+X(h));if(!y)return new G(w);for(t=new G(x),d=n=new G(x),r=c=new G(x),f=g(y),s=t.e=f.length-w.e-1,t.c[0]=u[(a=s%l)<0?l+a:a],e=!e||h.comparedTo(t)>0?s>0?t:d:h,a=F,F=1/0,h=new G(f),c.c[0]=0;p=C(h,t,0,1),1!=(i=n.plus(p.times(r))).comparedTo(e);)n=r,r=i,d=c.plus(p.times(i=d)),c=i,t=h.minus(p.times(i=t)),h=i;return i=C(e.minus(n),r,0,1),c=c.plus(i.times(d)),n=n.plus(i.times(r)),c.s=d.s=w.s,m=C(d,r,s*=2,_).minus(w).abs().comparedTo(C(c,n,s,_).minus(w).abs())<1?[d,r]:[c,n],F=a,m},O.toNumber=function(){return+X(this)},O.toPrecision=function(e,t){return null!=e&&f(e,1,d),z(this,e,t,2)},O.toString=function(e){var t,n=this,r=n.s,i=n.e;return null===i?r?(t="Infinity",r<0&&(t="-"+t)):t="NaN":(null==e?t=i<=L||i>=H?y(g(n.c),i):v(g(n.c),i,"0"):10===e&&j?t=v(g((n=K(new G(n),P+i+1,_)).c),n.e,"0"):(f(e,2,W.length,"Base"),t=S(v(g(n.c),i,"0"),10,e,r,!0)),r<0&&n.c[0]&&(t="-"+t)),t},O.valueOf=O.toJSON=function(){return X(this)},O._isBigNumber=!0,null!=t&&G.set(t),G}(),t.default=t.BigNumber=t,fO.exports?fO.exports=t:(e||(e="undefined"!=typeof self&&self?self:window),e.BigNumber=t)}(sO);var yO=wO.exports;
/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const vO=gO(),CO=uO(),SO=pO,RO=yO,EO={trillion:Math.pow(10,12),billion:Math.pow(10,9),million:Math.pow(10,6),thousand:Math.pow(10,3)},bO={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1,roundingFunction:Math.round,spaceSeparatedAbbreviation:!1},{binarySuffixes:TO,decimalSuffixes:NO}=vO.currentBytes(),AO={general:{scale:1024,suffixes:NO,marker:"bd"},binary:{scale:1024,suffixes:TO,marker:"b"},decimal:{scale:1e3,suffixes:NO,marker:"d"}};function MO(e,t={},n){if("string"==typeof t&&(t=SO.parseFormat(t)),!CO.validateFormat(t))return"ERROR: invalid format";let r=t.prefix||"",i=t.postfix||"",o=function(e,t,n){switch(t.output){case"currency":return function(e,t,n){const r=n.currentCurrency();let i,o=Object.assign({},t),s=Object.assign({},bO,o),a="",l=!!s.totalLength||!!s.forceAverage||s.average,h=o.currencyPosition||r.position,u=o.currencySymbol||r.symbol;const c=void 0!==s.spaceSeparatedCurrency?s.spaceSeparatedCurrency:s.spaceSeparated;void 0===o.lowPrecision&&(o.lowPrecision=!1);c&&(a=" ");"infix"===h&&(i=a+u+a);let d=PO({instance:e,providedFormat:o,state:n,decimalSeparator:i});"prefix"===h&&(d=e._value<0&&"sign"===s.negative?`-${a}${u}${d.slice(1)}`:e._value>0&&s.forceSign?`+${a}${u}${d.slice(1)}`:u+a+d);h&&"postfix"!==h||(a=!s.spaceSeparatedAbbreviation&&l?"":a,d=d+a+u);return d}(e,t=_O(t,vO.currentCurrencyDefaultFormat()),vO);case"percent":return function(e,t,n,r){let i=t.prefixSymbol,o=PO({instance:r(100*e._value),providedFormat:t,state:n}),s=Object.assign({},bO,t);if(i)return`%${s.spaceSeparated?" ":""}${o}`;return`${o}${s.spaceSeparated?" ":""}%`}(e,t=_O(t,vO.currentPercentageDefaultFormat()),vO,n);case"byte":return function(e,t,n,r){let i=t.base||"binary",o=Object.assign({},bO,t);const{binarySuffixes:s,decimalSuffixes:a}=n.currentBytes();let l={general:{scale:1024,suffixes:a||NO,marker:"bd"},binary:{scale:1024,suffixes:s||TO,marker:"b"},decimal:{scale:1e3,suffixes:a||NO,marker:"d"}}[i],{value:h,suffix:u}=IO(e._value,l.suffixes,l.scale),c=PO({instance:r(h),providedFormat:t,state:n,defaults:n.currentByteDefaultFormat()});return`${c}${o.spaceSeparated?" ":""}${u}`}(e,t=_O(t,vO.currentByteDefaultFormat()),vO,n);case"time":return t=_O(t,vO.currentTimeDefaultFormat()),function(e){let t=Math.floor(e._value/60/60),n=Math.floor((e._value-60*t*60)/60),r=Math.round(e._value-60*t*60-60*n);return`${t}:${n<10?"0":""}${n}:${r<10?"0":""}${r}`}(e);case"ordinal":return function(e,t,n){let r=n.currentOrdinal(),i=Object.assign({},bO,t),o=PO({instance:e,providedFormat:t,state:n}),s=r(e._value);return`${o}${i.spaceSeparated?" ":""}${s}`}(e,t=_O(t,vO.currentOrdinalDefaultFormat()),vO);default:return PO({instance:e,providedFormat:t,numbro:n})}}(e,t,n);return o=function(e,t){return t+e}(o,r),o=function(e,t){return e+t}(o,i),o}function IO(e,t,n){let r=t[0],i=Math.abs(e);if(i>=n){for(let o=1;o<t.length;++o){let s=Math.pow(n,o),a=Math.pow(n,o+1);if(i>=s&&i<a){r=t[o],e/=s;break}}r===t[0]&&(e/=Math.pow(n,t.length-1),r=t[t.length-1])}return{value:e,suffix:r}}function OO(e){let t="";for(let n=0;n<e;n++)t+="0";return t}function xO(e,t,n=Math.round){if(-1!==e.toString().indexOf("e"))return function(e,t){let n=e.toString(),[r,i]=n.split("e"),[o,s=""]=r.split(".");if(+i>0)n=o+s+OO(i-s.length);else{let e=".";e=+o<0?`-0${e}`:`0${e}`;let r=(OO(-i-1)+Math.abs(o)+s).substr(0,t);r.length<t&&(r+=OO(t-r.length)),n=e+r}return+i>0&&t>0&&(n+=`.${OO(t)}`),n}(e,t);return new RO(n(+`${e}e+${t}`)/Math.pow(10,t)).toFixed(t)}function PO({instance:e,providedFormat:t,state:n=vO,decimalSeparator:r,defaults:i=n.currentDefaults()}){let o=e._value;if(0===o&&n.hasZeroFormat())return n.getZeroFormat();if(!isFinite(o))return o.toString();let s=Object.assign({},bO,i,t),a=s.totalLength,l=a?0:s.characteristic,h=s.optionalCharacteristic,u=s.forceAverage,c=s.lowPrecision,d=!!a||!!u||s.average,p=a?-1:d&&void 0===t.mantissa?0:s.mantissa,g=!a&&(void 0===t.optionalMantissa?-1===p:s.optionalMantissa),m=s.trimMantissa,f=s.thousandSeparated,w=s.spaceSeparated,y=s.negative,v=s.forceSign,C=s.exponential,S=s.roundingFunction,R="";if(d){let e=function({value:e,forceAverage:t,lowPrecision:n=!0,abbreviations:r,spaceSeparated:i=!1,totalLength:o=0,roundingFunction:s=Math.round}){let a="",l=Math.abs(e),h=-1;if(t&&r[t]&&EO[t]?(a=r[t],e/=EO[t]):l>=EO.trillion||n&&1===s(l/EO.trillion)?(a=r.trillion,e/=EO.trillion):l<EO.trillion&&l>=EO.billion||n&&1===s(l/EO.billion)?(a=r.billion,e/=EO.billion):l<EO.billion&&l>=EO.million||n&&1===s(l/EO.million)?(a=r.million,e/=EO.million):(l<EO.million&&l>=EO.thousand||n&&1===s(l/EO.thousand))&&(a=r.thousand,e/=EO.thousand),a&&(a=(i?" ":"")+a),o){let t=e<0,n=e.toString().split(".")[0],r=t?n.length-1:n.length;h=Math.max(o-r,0)}return{value:e,abbreviation:a,mantissaPrecision:h}}({value:o,forceAverage:u,lowPrecision:c,abbreviations:n.currentAbbreviations(),spaceSeparated:w,roundingFunction:S,totalLength:a});o=e.value,R+=e.abbreviation,a&&(p=e.mantissaPrecision)}if(C){let e=function({value:e,characteristicPrecision:t}){let[n,r]=e.toExponential().split("e"),i=+n;return t?(1<t&&(i*=Math.pow(10,t-1),r=+r-(t-1),r=r>=0?`+${r}`:r),{value:i,abbreviation:`e${r}`}):{value:i,abbreviation:`e${r}`}}({value:o,characteristicPrecision:l});o=e.value,R=e.abbreviation+R}let E=function(e,t,n,r,i,o){if(-1===r)return e;let s=xO(t,r,o),[a,l=""]=s.toString().split(".");if(l.match(/^0+$/)&&(n||i))return a;let h=l.match(/0+$/);return i&&h?`${a}.${l.toString().slice(0,h.index)}`:s.toString()}(o.toString(),o,g,p,m,S);return E=function(e,t,n,r){let i=e,[o,s]=i.toString().split(".");if(o.match(/^-?0$/)&&n)return s?`${o.replace("0","")}.${s}`:o.replace("0","");const a=t<0&&0===o.indexOf("-");if(a&&(o=o.slice(1),i=i.slice(1)),o.length<r){let e=r-o.length;for(let t=0;t<e;t++)i=`0${i}`}return a&&(i=`-${i}`),i.toString()}(E,o,h,l),E=function(e,t,n,r,i){let o=r.currentDelimiters(),s=o.thousands;i=i||o.decimal;let a=o.thousandsSize||3,l=e.toString(),h=l.split(".")[0],u=l.split(".")[1];const c=t<0&&0===h.indexOf("-");if(n){c&&(h=h.slice(1));let e=function(e,t){let n=[],r=0;for(let i=e;i>0;i--)r===t&&(n.unshift(i),r=0),r++;return n}(h.length,a);e.forEach(((e,t)=>{h=h.slice(0,e+t)+s+h.slice(e+t)})),c&&(h=`-${h}`)}return l=u?h+i+u:h,l}(E,o,f,n,r),(d||C)&&(E=function(e,t){return e+t}(E,R)),(v||o<0)&&(E=function(e,t,n){return 0===t?e:0==+e?e.replace("-",""):t>0?`+${e}`:"sign"===n?e:`(${e.replace("-","")})`}(E,o,y)),E}function _O(e,t){if(!e)return t;let n=Object.keys(e);return 1===n.length&&"output"===n[0]?t:e}
/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */
const LO=yO;function HO(e,t,n){let r=new LO(e._value),i=t;return n.isNumbro(t)&&(i=t._value),i=new LO(i),e._value=r.minus(i).toNumber(),e}
/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */
const kO=gO(),FO=uO(),DO=(e=>({loadLanguagesInNode:t=>mO(t,e)}))(zO),VO=hO();let UO=(e=>({format:(...t)=>MO(...t,e),getByteUnit:(...t)=>function(e){let t=AO.general;return IO(e._value,t.suffixes,t.scale).suffix}(...t,e),getBinaryByteUnit:(...t)=>function(e){let t=AO.binary;return IO(e._value,t.suffixes,t.scale).suffix}(...t,e),getDecimalByteUnit:(...t)=>function(e){let t=AO.decimal;return IO(e._value,t.suffixes,t.scale).suffix}(...t,e),formatOrDefault:_O}))(zO),BO=(e=>({add:(t,n)=>function(e,t,n){let r=new LO(e._value),i=t;return n.isNumbro(t)&&(i=t._value),i=new LO(i),e._value=r.plus(i).toNumber(),e}(t,n,e),subtract:(t,n)=>HO(t,n,e),multiply:(t,n)=>function(e,t,n){let r=new LO(e._value),i=t;return n.isNumbro(t)&&(i=t._value),i=new LO(i),e._value=r.times(i).toNumber(),e}(t,n,e),divide:(t,n)=>function(e,t,n){let r=new LO(e._value),i=t;return n.isNumbro(t)&&(i=t._value),i=new LO(i),e._value=r.dividedBy(i).toNumber(),e}(t,n,e),set:(t,n)=>function(e,t,n){let r=t;return n.isNumbro(t)&&(r=t._value),e._value=r,e}(t,n,e),difference:(t,n)=>function(e,t,n){let r=n(e._value);return HO(r,t,n),Math.abs(r._value)}(t,n,e),BigNumber:LO}))(zO);const WO=pO;class jO{constructor(e){this._value=e}clone(){return zO(this._value)}format(e={}){return UO.format(this,e)}formatCurrency(e){return"string"==typeof e&&(e=WO.parseFormat(e)),(e=UO.formatOrDefault(e,kO.currentCurrencyDefaultFormat())).output="currency",UO.format(this,e)}formatTime(e={}){return e.output="time",UO.format(this,e)}binaryByteUnits(){return UO.getBinaryByteUnit(this)}decimalByteUnits(){return UO.getDecimalByteUnit(this)}byteUnits(){return UO.getByteUnit(this)}difference(e){return BO.difference(this,e)}add(e){return BO.add(this,e)}subtract(e){return BO.subtract(this,e)}multiply(e){return BO.multiply(this,e)}divide(e){return BO.divide(this,e)}set(e){return BO.set(this,GO(e))}value(){return this._value}valueOf(){return this._value}}function GO(e){let t=e;return zO.isNumbro(e)?t=e._value:"string"==typeof e?t=zO.unformat(e):isNaN(e)&&(t=NaN),t}function zO(e){return new jO(GO(e))}zO.version="2.5.0",zO.isNumbro=function(e){return e instanceof jO},zO.language=kO.currentLanguage,zO.registerLanguage=kO.registerLanguage,zO.setLanguage=kO.setLanguage,zO.languages=kO.languages,zO.languageData=kO.languageData,zO.zeroFormat=kO.setZeroFormat,zO.defaultFormat=kO.currentDefaults,zO.setDefaults=kO.setDefaults,zO.defaultCurrencyFormat=kO.currentCurrencyDefaultFormat,zO.validate=FO.validate,zO.loadLanguagesInNode=DO.loadLanguagesInNode,zO.unformat=VO.unformat,zO.BigNumber=BO.BigNumber;var $O=aO(zO);function YO(e,t){if(zw(e)){const n=t.numericFormat,r=n&&n.culture||"-",i=n&&n.pattern;if(void 0!==r&&!$O.languages()[r]){const e=r.replace("-",""),t=$O.allLanguages?$O.allLanguages[r]:$O[e];t&&$O.registerLanguage(t)}$O.setLanguage(r),e=$O(e).format(i||"0")}return e}function KO(e,t,n,r,i,o,s){let a=o;if(zw(a)){let e=[];if(Array.isArray(s.className))e=s.className;else{var l;const t=null!==(l=s.className)&&void 0!==l?l:"";t.length&&(e=t.split(" "))}a=YO(a,s),e.indexOf("htLeft")<0&&e.indexOf("htCenter")<0&&e.indexOf("htRight")<0&&e.indexOf("htJustify")<0&&e.push("htRight"),e.indexOf("htNumeric")<0&&e.push("htNumeric"),s.className=e.join(" "),t.dir="ltr"}IM(e,t,n,r,i,a,s)}KO.RENDERER_TYPE="numeric";function XO(e,t,n,r,i,o,s){IM.apply(this,[e,t,n,r,i,o,s]);const a=s.hashLength||t.innerHTML.length,l=s.hashSymbol||"*";let h="";$w(a-1,(()=>{h+=l})),Fp(t,h)}XO.RENDERER_TYPE="password";function qO(e,t,n,r,i,o,s){IM.apply(this,[e,t,n,r,i,o,s])}qO.RENDERER_TYPE="select";function QO(e,t,n,r,i,o,s){IM.apply(this,[e,t,n,r,i,o,s]),t.dir="ltr"}QO.RENDERER_TYPE="time";function ZO(e,t){let n=e;null==n&&(n=""),this.allowEmpty&&""===n?t(!0):this.strict&&this.source?"function"==typeof this.source?this.source(n,JO(n,t)):JO(n,t)(this.source):t(!0)}function JO(e,t){const n=e;return function(e){let r=!1;for(let t=0,i=e.length;t<i;t++)if(n===e[t]){r=!0;break}t(r)}}ZO.VALIDATOR_TYPE="autocomplete";function ex(e,t){const n=Nf(II,this.instance);let r=e,i=!0;null==r&&(r="");let o=M(r,this.dateFormat||n.defaultDateFormat,!0).isValid(),s=M(new Date(r)).isValid()||o;if(this.allowEmpty&&""===r&&(s=!0,o=!0),s||(i=!1),!s&&o&&(i=!0),s&&!o)if(!0===this.correctFormat){const e=function(e,t){const n=M(function(e){const t=new Date(e);return isNaN(new Date(`${e}T00:00`).getDate())?t:new Date(t.getTime()+6e4*t.getTimezoneOffset())}(e)),r=M(e,t),i=e.search(/[A-Za-z]/g)>-1;let o;o=n.isValid()&&n.format("x")===r.format("x")||!r.isValid()||i?n:r;return o.format(t)}(r,this.dateFormat);this.instance.setDataAtCell(this.visualRow,this.visualCol,e,"dateValidator"),i=!0}else i=!1;t(i)}ex.VALIDATOR_TYPE="date";function tx(e,t){ZO.apply(this,[e,t])}tx.VALIDATOR_TYPE="dropdown";function nx(e,t){let n=e;null==n&&(n=""),this.allowEmpty&&""===n?t(!0):t(""!==n&&zw(e))}nx.VALIDATOR_TYPE="numeric";const rx=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"];function ix(e,t){const n=this.timeFormat||"h:mm:ss a";let r=!0,i=e;null===i&&(i=""),i=/^\d{3,}$/.test(i)?parseInt(i,10):i;const o=/^\d{1,2}$/.test(i);o&&(i+=":00");const s=M(i,rx,!0).isValid()?M(i):M(i,n);let a=s.isValid(),l=M(i,n,!0).isValid()&&!o;if(this.allowEmpty&&""===i&&(a=!0,l=!0),a||(r=!1),!a&&l&&(r=!0),a&&!l)if(!0===this.correctFormat){const e=s.format(n);this.instance.setDataAtCell(this.visualRow,this.visualCol,e,"timeValidator"),r=!0}else r=!1;t(r)}ix.VALIDATOR_TYPE="time";const ox={CELL_TYPE:"autocomplete",editor:QM,renderer:jI,validator:ZO},sx={CELL_TYPE:"checkbox",editor:JM,renderer:QI};function ax(e,t,n,r,i,o,s){jI.apply(this,[e,t,n,r,i,o,s])}ax.RENDERER_TYPE="date";const lx={CELL_TYPE:"date",editor:PI,renderer:ax,validator:ex},hx={CELL_TYPE:"dropdown",editor:LI,renderer:GI,validator:tx,filter:!1,strict:!0},ux={CELL_TYPE:"handsontable",editor:GM,renderer:JI},cx={CELL_TYPE:"numeric",editor:HI,renderer:KO,validator:nx,dataType:"number"},dx={CELL_TYPE:"password",editor:FI,renderer:XO,copyable:!1},px={CELL_TYPE:"select",editor:UI,renderer:qO},gx={CELL_TYPE:"time",editor:BI,renderer:QO,validator:ix};function mx(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function fx(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function wx(e,t){return e.get(yx(e,t))}function yx(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}const vx=new Map([["plugin",function(e){return!!ly(e)}],["cell-type",lA],["editor",Rf],["renderer",dy],["validator",vy]]),Cx=Symbol("mainSetting"),Sx=[];let Rx=null;var Ex=new WeakMap,bx=new WeakSet;class Tx{static get PLUGIN_KEY(){return"base"}static get SETTING_KEYS(){return[this.PLUGIN_KEY]}static get DEFAULT_SETTINGS(){return{}}constructor(e){var t,n;mx(t=this,n=bx),n.add(t),fx(this,"eventManager",new Of(this)),fx(this,"pluginName",null),fx(this,"pluginsInitializedCallbacks",[]),fx(this,"isPluginsReady",!1),fx(this,"enabled",!1),fx(this,"initialized",!1),function(e,t,n){mx(e,t),t.set(e,n)}(this,Ex,{}),tm(this,"hot",e,{writable:!1}),Rx=null,this.hot.addHook("afterPluginsInitialized",(()=>this.onAfterPluginsInitialized())),this.hot.addHook("afterUpdateSettings",(e=>this.onUpdateSettings(e))),this.hot.addHook("beforeInit",(()=>this.init()))}init(){this.pluginName=this.hot.getPluginName(this);const e=this.constructor.PLUGIN_DEPS,t=Array.isArray(e)?e:[];if(t.length>0){const e=[];if(t.forEach((t=>{const[n,r]=t.split(":");if(!vx.has(n))throw new Error(`Unknown plugin dependency type "${n}" was found.`);vx.get(n)(r)||e.push(` - ${r} (${n})`)})),e.length>0){const t=[`The ${this.pluginName} plugin requires the following modules:\n`,`${e.join("\n")}\n`].join("");Sx.push(t)}}Rx||(Rx=ay()),Rx.indexOf(this.pluginName)>=0&&Rx.splice(Rx.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",(()=>{this.isEnabled&&this.isEnabled()&&this.enablePlugin()}));if(0===Rx.length){if(Sx.length>0){const e=[`${Sx.join("\n")}\n`,"You have to import and register them manually."].join("");throw Sx.length=0,new Error(e)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}enablePlugin(){this.enabled=!0}disablePlugin(){var e;null===(e=this.eventManager)||void 0===e||e.clear(),this.clearHooks(),this.enabled=!1}getSetting(e){const t=this.hot.getSettings()[this.constructor.PLUGIN_KEY];if(void 0===e)return t;const n=this.constructor.DEFAULT_SETTINGS;var r,i;return(Array.isArray(t)||em(t))&&n[Cx]===e?Array.isArray(t)?t:null!==(r=t[e])&&void 0!==r?r:n[e]:em(t)&&null!==(i=t[e])&&void 0!==i?i:n[e]}addHook(e,t,n){wx(Ex,this)[e]=wx(Ex,this)[e]||[];const r=wx(Ex,this)[e];this.hot.addHook(e,t,n),r.push(t),wx(Ex,this)[e]=r}removeHooks(e){Vd(wx(Ex,this)[e]||[],(t=>{this.hot.removeHook(e,t)}))}clearHooks(){const e=wx(Ex,this);nm(e,((e,t)=>this.removeHooks(t))),e.length=0}callOnPluginsReady(e){this.isPluginsReady?e():this.pluginsInitializedCallbacks.push(e)}onAfterPluginsInitialized(){Vd(this.pluginsInitializedCallbacks,(e=>e())),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}onUpdateSettings(e){const t=yx(bx,this,Nx).call(this,e);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&t&&this.updatePlugin(e))}updatePlugin(){}destroy(){var e;null===(e=this.eventManager)||void 0===e||e.destroy(),this.clearHooks(),nm(this,((e,t)=>{"hot"!==t&&(this[t]=null)})),delete this.t,delete this.hot}}function Nx(e){if(!e)return!1;const t=this.constructor.SETTING_KEYS;if("boolean"==typeof t)return t;for(let n=0;n<t.length;n++)if(void 0!==e[t[n]])return!0;return!1}function Ax(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const Mx=class{constructor(e){Ax(this,"hot",null),Ax(this,"container",null),Ax(this,"injected",!1),Ax(this,"rows",[]),Ax(this,"columns",[]),Ax(this,"samples",null),Ax(this,"settings",{useHeaders:!0}),this.hot=e}addRow(e,t){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));const n={row:e};this.rows.push(n),this.samples=t,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol(e)),this.table.tr.appendChild(this.createRow(e)),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}addColumnHeadersRow(e){const t=this.hot.getColHeader(0);if(null!=t){const t={row:-1};this.rows.push(t),this.container=this.createContainer(this.hot.rootElement.className),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),t.table=this.table.table}}addColumn(e,t){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));const n={col:e};this.columns.push(n),this.samples=t,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&null!==this.hot.getColHeader(e)&&this.hot.view.appendColHeader(e,this.table.th,void 0,-1),this.table.tBody.appendChild(this.createCol(e)),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}getHeights(e){this.injected||this.injectTable(),Vd(this.rows,(t=>{const{height:n}=t.table.getBoundingClientRect();e(t.row,Math.ceil(n))}))}getWidths(e){this.injected||this.injectTable(),Vd(this.columns,(t=>{const{width:n}=t.table.getBoundingClientRect();e(t.col,Math.ceil(n))}))}setSettings(e){this.settings=e}setSetting(e,t){this.settings||(this.settings={}),this.settings[e]=t}getSettings(){return this.settings}getSetting(e){return this.settings?this.settings[e]:null}createColGroupsCol(e){const t=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&t.appendChild(this.createColElement(-1,-1)),this.samples.forEach((n=>{Vd(n.strings,(n=>{t.appendChild(this.createColElement(n.col,e))}))})),t}createRow(e){const{rootDocument:t}=this.hot,n=t.createDocumentFragment(),r=t.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(e,r),n.appendChild(r)),this.samples.forEach((r=>{Vd(r.strings,(r=>{const i=r.col,o=this.hot.getCellMeta(e,i),s=this.hot.getCellRenderer(o),a=t.createElement("td");a.setAttribute("ghost-table",1),s(this.hot,a,e,i,this.hot.colToProp(i),r.value,o),n.appendChild(a)}))})),n}appendColumnHeadersRow(){const{rootDocument:e}=this.hot,t=e.createDocumentFragment(),n=[];if(this.hot.hasRowHeaders()){const r=e.createElement("th");n.push([-1,r]),t.appendChild(r)}this.samples.forEach((r=>{Vd(r.strings,(r=>{const i=r.col,o=e.createElement("th");n.push([i,o]),t.appendChild(o)}))})),this.table.tHead.appendChild(t),Vd(n,(e=>{const[t,n]=e;this.hot.view.appendColHeader(t,n)}))}createCol(e){const{rootDocument:t}=this.hot,n=t.createDocumentFragment();return this.samples.forEach((r=>{Vd(r.strings,(r=>{const i=r.row,o=this.hot.getCellMeta(i,e),s=this.hot.getCellRenderer(o),a=t.createElement("td"),l=t.createElement("tr");a.setAttribute("ghost-table",1),s(this.hot,a,i,e,this.hot.colToProp(e),r.value,o),l.appendChild(a),n.appendChild(l)}))})),n}clean(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}injectTable(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.injected||((e||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}removeTable(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}createColElement(e,t){const n=this.hot.rootDocument.createElement("col");let r=0;t>=0&&e>=0&&(r=this.hot.getCellMeta(t,e).colspan);let i=this.hot.getColWidth(e);if(r>1)for(let o=e+1;o<e+r;o++)i+=this.hot.getColWidth(o);return n.style.width=`${i}px`,n}createTable(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";const{rootDocument:t}=this.hot,n=t.createDocumentFragment(),r=t.createElement("table"),i=t.createElement("thead"),o=t.createElement("tbody"),s=t.createElement("colgroup"),a=t.createElement("tr"),l=t.createElement("th");return this.isVertical()&&r.appendChild(s),this.isHorizontal()&&(a.appendChild(l),i.appendChild(a),r.style.tableLayout="auto",r.style.width="auto"),r.appendChild(i),this.isVertical()&&o.appendChild(a),r.appendChild(o),Op(r,e),n.appendChild(r),{fragment:n,table:r,tHead:i,tBody:o,colGroup:s,tr:a,th:l}}createContainer(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";const{rootDocument:t}=this.hot,n=t.createDocumentFragment(),r=t.createElement("div");return Op(r,`htGhostTable htAutoSize ${e.trim()}`),n.appendChild(r),{fragment:n,container:r}}isVertical(){return!(!this.rows.length||this.columns.length)}isHorizontal(){return!(!this.columns.length||this.rows.length)}};function Ix(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Ox{static get SAMPLE_COUNT(){return 3}constructor(e){Ix(this,"samples",null),Ix(this,"dataFactory",null),Ix(this,"customSampleCount",null),Ix(this,"allowDuplicates",!1),this.dataFactory=e}getSampleCount(){return this.customSampleCount?this.customSampleCount:Ox.SAMPLE_COUNT}setSampleCount(e){this.customSampleCount=e}setAllowDuplicates(e){this.allowDuplicates=e}generateRowSamples(e,t){return this.generateSamples("row",t,e)}generateColumnSamples(e,t){return this.generateSamples("col",t,e)}generateSamples(e,t,n){const r=new Map,{from:i,to:o}="number"==typeof n?{from:n,to:n}:n;return $w(i,o,(n=>{const i=this.generateSample(e,t,n);r.set(n,i)})),r}generateSample(e,t,n){if("row"!==e&&"col"!==e)throw new Error("Unsupported sample type");const r=new Map,i="row"===e?"col":"row",o=[];return $w(t.from,t.to,(t=>{const s="row"===e?this.dataFactory(n,t):this.dataFactory(t,n);if(!1===s)return;const{value:a,bundleSeed:l}=s,h="string"==typeof l&&l.length>0;let u;u=h?l:em(a)?`${Object.keys(a).length}`:Array.isArray(a)?`${a.length}`:`${jd(a).length}`,r.has(u)||r.set(u,{needed:this.getSampleCount(),strings:[]});const c=r.get(u);if(c.needed){(!(o.indexOf(a)>-1)||this.allowDuplicates||h)&&(c.strings.push({value:a,[i]:t}),o.push(a),c.needed-=1)}})),r}}const xx=Ox;function Px(e,t,n){_x(e,t),t.set(e,n)}function _x(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Lx(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Hx(e,t){return e.get(Fx(e,t))}function kx(e,t,n){return e.set(Fx(e,t),n),n}function Fx(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}mf.getSingleton().register("modifyAutoColumnSizeSeed");const Dx="autoColumnSize";var Vx=new WeakMap,Ux=new WeakMap,Bx=new WeakSet;class Wx extends Tx{static get PLUGIN_KEY(){return Dx}static get PLUGIN_PRIORITY(){return 10}static get SETTING_KEYS(){return!0}static get DEFAULT_SETTINGS(){return{useHeaders:!0,samplingRatio:null,allowSampleDuplicates:!1}}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 50}constructor(e){var t,n;super(e),_x(t=this,n=Bx),n.add(t),Lx(this,"ghostTable",new Mx(this.hot)),Lx(this,"samplesGenerator",new xx(((e,t)=>{const n=this.hot.toPhysicalRow(e),r=this.hot.toPhysicalColumn(t);if(this.hot.rowIndexMapper.isHidden(n)||this.hot.columnIndexMapper.isHidden(r))return!1;const i=this.hot.getCellMeta(e,t);let o="";i.spanned||(o=this.hot.getDataAtCell(e,t));let s="";return this.hot.hasHook("modifyAutoColumnSizeSeed")&&(s=this.hot.runHooks("modifyAutoColumnSizeSeed",s,i,o)),{value:o,bundleSeed:s}}))),Lx(this,"inProgress",!1),Lx(this,"measuredColumns",0),Lx(this,"columnWidthsMap",new ME),Px(this,Vx,[]),Px(this,Ux,[]),this.hot.columnIndexMapper.registerMap("autoColumnSize",this.columnWidthsMap),this.addHook("beforeColumnResize",((e,t,n)=>Fx(Bx,this,Yx).call(this,e,t,n)))}isEnabled(){return!1!==this.hot.getSettings()[Dx]&&!this.hot.getSettings().colWidths}enablePlugin(){var e=this;if(this.enabled)return;this.ghostTable.setSetting("useHeaders",this.getSetting("useHeaders")),this.samplesGenerator.setAllowDuplicates(this.getSetting("allowSampleDuplicates"));const t=this.getSetting("samplingRatio");t&&!isNaN(t)&&this.samplesGenerator.setSampleCount(parseInt(t,10)),this.addHook("afterLoadData",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return Fx(Bx,e,zx).call(e,...n)})),this.addHook("beforeChangeRender",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return Fx(Bx,e,$x).call(e,...n)})),this.addHook("afterFormulasValuesUpdate",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return Fx(Bx,e,Xx).call(e,...n)})),this.addHook("beforeRender",(()=>Fx(Bx,this,Gx).call(this))),this.addHook("modifyColWidth",((e,t)=>this.getColumnWidth(t,e))),this.addHook("init",(()=>Fx(Bx,this,Kx).call(this))),super.enablePlugin()}updatePlugin(){kx(Ux,this,this.findColumnsWhereHeaderWasChanged()),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.addHook("beforeColumnResize",((e,t,n)=>Fx(Bx,this,Yx).call(this,e,t,n)))}calculateVisibleColumnsWidth(){if(!this.hot.countRows())return;const e=this.getFirstVisibleColumn(),t=this.getLastVisibleColumn();if(-1===e||-1===t)return;const n=this.hot.renderCall;this.calculateColumnsWidth({from:e,to:t},void 0,n)}calculateColumnsWidth(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countCols()-1},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{from:0,to:this.hot.countRows()-1},n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r="number"==typeof e?{from:e,to:e}:e,i="number"==typeof t?{from:t,to:t}:t;$w(r.from,r.to,(e=>{let t=this.hot.toPhysicalColumn(e);if(null===t&&(t=e),n||null===this.columnWidthsMap.getValueAtIndex(t)&&!this.hot._getColWidthFromSettings(t)){this.samplesGenerator.generateColumnSamples(e,i).forEach(((e,t)=>this.ghostTable.addColumn(t,e)))}})),this.ghostTable.columns.length&&(this.hot.batchExecution((()=>{this.ghostTable.getWidths(((e,t)=>{const n=this.hot.toPhysicalColumn(e);this.columnWidthsMap.setValueAtIndex(n,t)}))}),!0),this.measuredColumns=r.to+1,this.ghostTable.clean())}calculateAllColumnsWidth(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countRows()-1},t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=0;const r=this.hot.countCols()-1;let i=null;this.inProgress=!0;const o=()=>{if(!this.hot)return lm(i),void(this.inProgress=!1);this.calculateColumnsWidth({from:n,to:Math.min(n+Wx.CALCULATION_STEP,r)},e,t),n=n+Wx.CALCULATION_STEP+1,n<r?i=am(o):(lm(i),this.inProgress=!1,this.hot.view.adjustElementsSize())},s=this.getSyncCalculationLimit();s>=0&&(this.calculateColumnsWidth({from:0,to:s},e,t),n=s+1),n<r?o():this.inProgress=!1}recalculateAllColumnsWidth(){this.hot.view.isVisible()&&this.calculateAllColumnsWidth({from:0,to:this.hot.countRows()-1},!0)}getSyncCalculationLimit(){const e=this.hot.getSettings()[Dx];let t=Wx.SYNC_CALCULATION_LIMIT;const n=this.hot.countCols()-1;return em(e)&&(t=e.syncLimit,op(t)?t=Kw(n,t):t>>=0),Math.min(t,n)}getColumnWidth(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=t;return void 0===r&&(r=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e)),n&&"number"==typeof r&&(r=Math.max(r,Zy))),r}getFirstVisibleColumn(){var e;return null!==(e=this.hot.getFirstRenderedVisibleColumn())&&void 0!==e?e:-1}getLastVisibleColumn(){var e;return null!==(e=this.hot.getLastRenderedVisibleColumn())&&void 0!==e?e:-1}findColumnsWhereHeaderWasChanged(){return this.hot.getColHeader().reduce(((e,t,n)=>{const r=Hx(Vx,this).length;return(r-1<n||Hx(Vx,this)[n]!==t)&&e.push(this.hot.toVisualColumn(n)),r-1<n?Hx(Vx,this).push(t):Hx(Vx,this)[n]=t,e}),[])}clearCache(e){Array.isArray(e)?this.hot.batchExecution((()=>{e.forEach((e=>{this.columnWidthsMap.setValueAtIndex(e,null)}))}),!0):this.columnWidthsMap.clear()}isNeedRecalculate(){return!!this.columnWidthsMap.getValues().slice(0,this.measuredColumns).filter((e=>null===e)).length}destroy(){this.ghostTable.clean(),super.destroy()}}function jx(e){const t={from:0,to:this.hot.countRows()-1};e.forEach((e=>{const n=this.hot.toPhysicalColumn(e);if(null!==n&&!this.hot._getColWidthFromSettings(n)){this.samplesGenerator.generateColumnSamples(e,t).forEach(((e,t)=>this.ghostTable.addColumn(t,e)))}})),this.ghostTable.columns.length&&(this.hot.batchExecution((()=>{this.ghostTable.getWidths(((e,t)=>{const n=this.hot.toPhysicalColumn(e);this.columnWidthsMap.setValueAtIndex(n,t)}))}),!0),this.ghostTable.clean())}function Gx(){this.calculateVisibleColumnsWidth(),this.inProgress||(Fx(Bx,this,jx).call(this,Hx(Ux,this)),kx(Ux,this,[]))}function zx(e,t){t||this.recalculateAllColumnsWidth()}function $x(e){const t=e.reduce(((e,t)=>{let[,n]=t;const r=this.hot.propToCol(n);return Number.isInteger(r)&&-1===e.indexOf(r)&&e.push(r),e}),[]);Hx(Ux,this).push(...t)}function Yx(e,t,n){let r=e;return n&&(this.calculateColumnsWidth(t,void 0,!0),r=this.getColumnWidth(t,void 0,!1)),r}function Kx(){kx(Vx,this,this.hot.getColHeader()),this.recalculateAllColumnsWidth()}function Xx(e){const t=e.reduce(((e,t)=>{var n;const r=null===(n=t.address)||void 0===n?void 0:n.col;if(Number.isInteger(r)){const t=this.hot.toVisualColumn(r);-1===e.indexOf(t)&&e.push(t)}return e}),[]);Hx(Ux,this).push(...t)}const qx={horizontal:"horizontal",vertical:"vertical"};function Qx(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function Zx(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Jx(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}mf.getSingleton().register("modifyAutofillRange"),mf.getSingleton().register("beforeAutofill"),mf.getSingleton().register("afterAutofill");const eP="autofill",tP=["fillHandle"];var nP=new WeakSet;class rP extends Tx{constructor(){super(...arguments),Qx(this,nP),Zx(this,"addingStarted",!1),Zx(this,"mouseDownOnCellCorner",!1),Zx(this,"mouseDragOutside",!1),Zx(this,"handleDraggedCells",0),Zx(this,"directions",[]),Zx(this,"autoInsertRow",!1)}static get PLUGIN_KEY(){return eP}static get PLUGIN_PRIORITY(){return 20}static get SETTING_KEYS(){return[eP,...tP]}isEnabled(){return this.hot.getSettings().fillHandle}enablePlugin(){this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",(e=>Jx(nP,this,oP).call(this,e))),this.addHook("afterOnCellCornerDblClick",(e=>Jx(nP,this,iP).call(this,e))),this.addHook("beforeOnCellMouseOver",((e,t)=>Jx(nP,this,sP).call(this,t))),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.clearMappedSettings(),super.disablePlugin()}getSelectionData(){const e=this.hot.getSelectedRangeLast(),{row:t,col:n}=e.getTopStartCorner(),{row:r,col:i}=e.getBottomEndCorner(),o=this.hot.runHooks("modifyCopyableRange",[{startRow:t,startCol:n,endRow:r,endCol:i}]),s=[],a=[],l=[];return Vd(o,(e=>{for(let t=e.startRow;t<=e.endRow;t+=1)-1===s.indexOf(t)&&s.push(t);for(let t=e.startCol;t<=e.endCol;t+=1)-1===a.indexOf(t)&&a.push(t)})),Vd(s,(e=>{const t=[];Vd(a,(n=>{t.push(this.hot.getCopyableData(e,n))})),l.push(t)})),l}fillIn(){if(this.hot.selection.highlight.getFill().isEmpty())return!1;const[e,t,n,r]=this.hot.selection.highlight.getFill().getVisualCorners(),i=this.hot.getSelectedRangeLast(),o=i.getTopStartCorner(),s=i.getBottomEndCorner();this.resetSelectionOfDraggedArea();const a=[o.row,o.col,s.row,s.col],l=this.hot.runHooks("modifyAutofillRange",[Math.min(o.row,e),Math.min(o.col,t),Math.max(s.row,n),Math.max(s.col,r)],a),{directionOfDrag:h,startOfDragCoords:u,endOfDragCoords:c}=function(e,t,n){let r,i,o;return t[0]===e[0]&&t[1]<e[1]?(o="left",r=n(t[0],t[1]),i=n(t[2],e[1]-1)):t[2]===e[2]&&t[0]===e[0]&&t[3]>e[3]?(o="right",r=n(t[0],e[3]+1),i=n(t[2],t[3])):t[0]<e[0]&&t[1]===e[1]?(o="up",r=n(t[0],t[1]),i=n(e[0]-1,t[3])):t[2]>e[2]&&t[1]===e[1]&&(o="down",r=n(e[2]+1,t[1]),i=n(t[2],t[3])),r&&r.normalize(),i&&i.normalize(),{directionOfDrag:o,startOfDragCoords:r,endOfDragCoords:i}}(a,l,((e,t)=>this.hot._createCellCoords(e,t)));if(u&&u.row>-1&&u.col>-1){const e=this.getSelectionData(),t=i.clone(),n=this.hot._createCellRange(u,u,c),r=this.hot.runHooks("beforeAutofill",e,t,n,h);if(!1===r)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;let o=r;const s=r;if(["up","left"].indexOf(h)>-1&&(1!==s.length||0!==s[0].length))if(o=[],"up"===h){const e=c.row-u.row+1,t=e%s.length;for(let n=0;n<e;n++)o.push(s[(n+(s.length-t))%s.length])}else{const e=c.col-u.col+1,t=e%s[0].length;for(let n=0;n<s.length;n++){o.push([]);for(let r=0;r<e;r++)o[n].push(s[n][(r+(s[n].length-t))%s[n].length])}}this.hot.populateFromArray(u.row,u.col,o,c.row,c.col,`${this.pluginName}.fill`,null),this.setSelection(l),this.hot.runHooks("afterAutofill",o,t,n,h),this.hot.render()}else this.hot.view.render();return!0}reduceSelectionAreaIfNeeded(e){return e.row<0&&(e.row=0),e.col<0&&(e.col=0),e}getCoordsOfDragAndDropBorders(e){const t=this.hot.getSelectedRangeLast(),n=t.getBottomEndCorner();let r=e;if(this.directions.includes(qx.vertical)&&this.directions.includes(qx.horizontal)){const i=t.getTopStartCorner();(n.col<=e.col||i.col>=e.col)&&(r=this.hot._createCellCoords(n.row,e.col)),(n.row<e.row||i.row>e.row)&&(r=this.hot._createCellCoords(e.row,n.col))}else if(this.directions.includes(qx.vertical))r=this.hot._createCellCoords(e.row,n.col);else{if(!this.directions.includes(qx.horizontal))return;r=this.hot._createCellCoords(n.row,e.col)}return this.reduceSelectionAreaIfNeeded(r)}showBorder(e){const t=this.getCoordsOfDragAndDropBorders(e);t&&this.redrawBorders(t)}addRow(){this.hot._registerTimeout((()=>{this.hot.alter("insert_row_below",void 0,1,`${this.pluginName}.fill`),this.addingStarted=!1}),200)}addNewRowIfNeeded(){if(!this.hot.selection.highlight.getFill().isEmpty()&&!1===this.addingStarted&&this.autoInsertRow){const e=this.hot.getSelectedLast(),t=this.hot.selection.highlight.getFill().getVisualCorners(),n=this.hot.countRows();e[2]<n-1&&t[2]===n-1&&(this.addingStarted=!0,this.addRow())}}getIndexOfLastAdjacentFilledInRow(e){const t=this.hot.getData(),n=this.hot.countRows();let r;for(let i=e[2]+1;i<n;i++){for(let r=e[1];r<=e[3];r++){if(!$d(t[i][r]))return-1}const n=t[i][e[1]-1],o=t[i][e[3]+1];$d(n)&&$d(o)||(r=i)}return r}addSelectionFromStartAreaToSpecificRowIndex(e,t){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(e[0],e[1])).add(this.hot._createCellCoords(t,e[3])).commit()}setSelection(e){this.hot.selectCell(...Dd(e,(e=>Math.max(e,0))),!1,!1)}selectAdjacent(){const e=this.hot.getSelectedLast(),t=this.getIndexOfLastAdjacentFilledInRow(e);return-1!==t&&void 0!==t&&(this.addSelectionFromStartAreaToSpecificRowIndex(e,t),!0)}resetSelectionOfDraggedArea(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}redrawBorders(e){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(e).commit(),this.hot.view.render()}getIfMouseWasDraggedOutside(e){const{documentElement:t}=this.hot.rootDocument,n=Up(this.hot.table).top-(this.hot.rootWindow.pageYOffset||t.scrollTop)+Xp(this.hot.table),r=Up(this.hot.table).left-(this.hot.rootWindow.pageXOffset||t.scrollLeft)+Kp(this.hot.table);return e.clientY>n&&e.clientX<=r}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mouseup",(()=>Jx(nP,this,aP).call(this))),this.eventManager.addEventListener(e,"mousemove",(e=>Jx(nP,this,lP).call(this,e)))}clearMappedSettings(){this.directions.length=0,this.autoInsertRow=!1}mapSettings(){const e=function(e){const t={};return!0===e?(t.directions=Object.keys(qx),t.autoInsertRow=!0):em(e)?(Gd(e.autoInsertRow)?e.direction===qx.horizontal?t.autoInsertRow=!1:t.autoInsertRow=e.autoInsertRow:t.autoInsertRow=!1,Gd(e.direction)?t.directions=[e.direction]:t.directions=Object.keys(qx)):"string"==typeof e?(t.directions=[e],t.autoInsertRow=!0):(t.directions=[],t.autoInsertRow=!1),t}(this.hot.getSettings().fillHandle);this.directions=e.directions,this.autoInsertRow=e.autoInsertRow}destroy(){super.destroy()}}function iP(){this.selectAdjacent()&&this.fillIn()}function oP(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}function sP(e){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(e),this.addNewRowIfNeeded())}function aP(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}function lP(e){const t=this.getIfMouseWasDraggedOutside(e);!1===this.addingStarted&&this.handleDraggedCells>0&&t?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}function hP(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function uP(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function cP(e,t){return e.get(dP(e,t))}function dP(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}const pP="autoRowSize";var gP=new WeakMap,mP=new WeakSet;class fP extends Tx{static get PLUGIN_KEY(){return pP}static get PLUGIN_PRIORITY(){return 40}static get SETTING_KEYS(){return!0}static get DEFAULT_SETTINGS(){return{useHeaders:!0,samplingRatio:null,allowSampleDuplicates:!1}}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 500}constructor(e){var t,n;super(e),hP(t=this,n=mP),n.add(t),uP(this,"headerHeight",null),uP(this,"ghostTable",new Mx(this.hot)),uP(this,"samplesGenerator",new xx(((e,t)=>{const n=this.hot.toPhysicalRow(e),r=this.hot.toPhysicalColumn(t);if(this.hot.rowIndexMapper.isHidden(n)||this.hot.columnIndexMapper.isHidden(r))return!1;if(e>=0&&t>=0){if(this.hot.getCellMeta(e,t).hidden)return!1}let i;return e>=0?i=this.hot.getDataAtCell(e,t):-1===e&&(i=this.hot.getColHeader(t)),{value:i}}))),uP(this,"inProgress",!1),uP(this,"measuredRows",0),uP(this,"rowHeightsMap",new ME),function(e,t,n){hP(e,t),t.set(e,n)}(this,gP,[]),this.hot.rowIndexMapper.registerMap("autoRowSize",this.rowHeightsMap),this.addHook("beforeRowResize",((e,t,n)=>dP(mP,this,vP).call(this,e,t,n)))}isEnabled(){const e=this.hot.getSettings()[pP];return!0===e||em(e)}enablePlugin(){var e=this;if(this.enabled)return;this.samplesGenerator.setAllowDuplicates(this.getSetting("allowSampleDuplicates"));const t=this.getSetting("samplingRatio");t&&!isNaN(t)&&this.samplesGenerator.setSampleCount(parseInt(t,10)),this.addHook("afterLoadData",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return dP(mP,e,CP).call(e,...n)})),this.addHook("beforeChangeRender",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return dP(mP,e,SP).call(e,...n)})),this.addHook("beforeColumnResize",(()=>this.recalculateAllRowsHeight())),this.addHook("afterFormulasValuesUpdate",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return dP(mP,e,EP).call(e,...n)})),this.addHook("beforeRender",(()=>dP(mP,this,yP).call(this))),this.addHook("modifyRowHeight",((e,t)=>this.getRowHeight(t,e))),this.addHook("init",(()=>dP(mP,this,RP).call(this))),this.addHook("modifyColumnHeaderHeight",(()=>this.getColumnHeaderHeight())),super.enablePlugin()}disablePlugin(){this.headerHeight=null,super.disablePlugin(),this.addHook("beforeRowResize",((e,t,n)=>dP(mP,this,vP).call(this,e,t,n)))}calculateVisibleRowsHeight(){if(!this.hot.countCols())return;const e=this.getFirstVisibleRow(),t=this.getLastVisibleRow();if(-1===e||-1===t)return;const n=this.hot.renderCall;this.calculateRowsHeight({from:e,to:t},void 0,n)}calculateRowsHeight(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countRows()-1},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{from:0,to:this.hot.countCols()-1},n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r="number"==typeof e?{from:e,to:e}:e,i="number"==typeof t?{from:t,to:t}:t;if(null!==this.hot.getColHeader(0)){const e=this.samplesGenerator.generateRowSamples(-1,i);this.ghostTable.addColumnHeadersRow(e.get(-1))}$w(r.from,r.to,(e=>{let t=this.hot.toPhysicalRow(e);if(null===t&&(t=e),n||null===this.rowHeightsMap.getValueAtIndex(t)){this.samplesGenerator.generateRowSamples(e,i).forEach(((e,t)=>this.ghostTable.addRow(t,e)))}})),this.ghostTable.rows.length&&(this.hot.batchExecution((()=>{this.ghostTable.getHeights(((e,t)=>{e<0?this.headerHeight=t:this.rowHeightsMap.setValueAtIndex(this.hot.toPhysicalRow(e),t)}))}),!0),this.measuredRows=r.to+1,this.ghostTable.clean())}calculateAllRowsHeight(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countCols()-1},t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=0;const r=this.hot.countRows()-1;let i=null;this.inProgress=!0;const o=()=>{if(!this.hot)return lm(i),void(this.inProgress=!1);this.calculateRowsHeight({from:n,to:Math.min(n+fP.CALCULATION_STEP,r)},e,t),n=n+fP.CALCULATION_STEP+1,n<r?i=am(o):(lm(i),this.inProgress=!1,this.hot.view.adjustElementsSize(),this.hot.view._wt.wtOverlays.inlineStartOverlay.needFullRender&&this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.draw())},s=this.getSyncCalculationLimit();s>=0&&(this.calculateRowsHeight({from:0,to:s},e,t),n=s+1),n<r?o():(this.inProgress=!1,this.hot.view.adjustElementsSize())}recalculateAllRowsHeight(){this.hot.view.isVisible()&&this.calculateAllRowsHeight({from:0,to:this.hot.countCols()-1},!0)}getSyncCalculationLimit(){const e=this.hot.getSettings()[pP];let t=fP.SYNC_CALCULATION_LIMIT;const n=this.hot.countRows()-1;return em(e)&&(t=e.syncLimit,op(t)?t=Kw(n,t):t>>=0),Math.min(t,n)}getRowHeight(e,t){const n=e<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(e));let r=t;return null!==n&&n>(t||0)&&(r=n),r}getColumnHeaderHeight(){return this.headerHeight}getFirstVisibleRow(){var e;return null!==(e=this.hot.getFirstRenderedVisibleRow())&&void 0!==e?e:-1}getLastVisibleRow(){var e;return null!==(e=this.hot.getLastRenderedVisibleRow())&&void 0!==e?e:-1}clearCache(e){this.headerHeight=null,Array.isArray(e)?this.hot.batchExecution((()=>{e.forEach((e=>{this.rowHeightsMap.setValueAtIndex(e,null)}))}),!0):this.rowHeightsMap.clear()}clearCacheByRange(e){const{from:t,to:n}="number"==typeof e?{from:e,to:e}:e;this.hot.batchExecution((()=>{$w(Math.min(t,n),Math.max(t,n),(e=>{this.rowHeightsMap.setValueAtIndex(e,null)}))}),!0)}isNeedRecalculate(){return!!this.rowHeightsMap.getValues().slice(0,this.measuredRows).filter((e=>null===e)).length}destroy(){this.ghostTable.clean(),super.destroy()}}function wP(e){const t={from:0,to:this.hot.countCols()-1};e.forEach((e=>{this.samplesGenerator.generateRowSamples(e,t).forEach(((e,t)=>this.ghostTable.addRow(t,e)))})),this.ghostTable.rows.length&&(this.hot.batchExecution((()=>{this.ghostTable.getHeights(((e,t)=>{const n=this.hot.toPhysicalRow(e);this.rowHeightsMap.setValueAtIndex(n,t)}))}),!0),this.ghostTable.clean())}function yP(){var e,t,n;this.calculateVisibleRowsHeight(),this.inProgress||(dP(mP,this,wP).call(this,cP(gP,this)),t=this,n=[],(e=gP).set(dP(e,t),n))}function vP(e,t,n){let r=e;return n&&(this.calculateRowsHeight(t,void 0,!0),r=this.getRowHeight(t)),r}function CP(e,t){t||this.recalculateAllRowsHeight()}function SP(e){const t=e.reduce(((e,t)=>{let[n]=t;return-1===e.indexOf(n)&&e.push(n),e}),[]);cP(gP,this).push(...t)}function RP(){this.recalculateAllRowsHeight()}function EP(e){const t=e.reduce(((e,t)=>{var n;const r=null===(n=t.address)||void 0===n?void 0:n.row;if(Number.isInteger(r)){const t=this.hot.toVisualRow(r);-1===e.indexOf(t)&&e.push(t)}return e}),[]);cP(gP,this).push(...t)}const{getListWithInsertedItems:bP,getListWithRemovedItems:TP}=DE("physicallyIndexed");const NP=class extends TE{constructor(){super((e=>e))}insert(e,t){const n=_E(this.indexedValues,t);this.indexedValues=bP(n,e,t,this.initValueOrFn),super.insert(e,t)}remove(e){const t=TP(this.indexedValues,e);this.indexedValues=PE(t,e),super.remove(e)}},{getListWithInsertedItems:AP,getListWithRemovedItems:MP}=DE("physicallyIndexed");const IP=class extends TE{constructor(){super((e=>e))}insert(e,t){this.indexedValues=AP(this.indexedValues,e,t,((e,t)=>this.getNextValue(t))),super.insert(e,t)}remove(e){this.indexedValues=MP(this.indexedValues,e),super.remove(e)}getNextValue(e){return Math.max(...this.getValues())+1+e}};function OP(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function xP(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const PP="bindRowsWithHeaders",_P=new Map([["loose",NP],["strict",IP]]);var LP=new WeakSet;class HP extends Tx{constructor(){super(...arguments),OP(this,LP),xP(this,"headerIndexes",null)}static get PLUGIN_KEY(){return PP}static get PLUGIN_PRIORITY(){return 210}isEnabled(){return!!this.hot.getSettings()[PP]}enablePlugin(){var e;if(this.enabled)return;const t=null!==(e=_P.get(this.getSetting()))&&void 0!==e?e:_P.get("loose");this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new t),this.addHook("modifyRowHeader",(e=>function(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}(LP,this,kP).call(this,e))),super.enablePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),super.disablePlugin()}destroy(){super.destroy()}}function kP(e){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(e))}function FP(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function DP(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function VP(e,t){return e.get(BP(e,t))}function UP(e,t,n){return e.set(BP(e,t),n),n}function BP(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}const WP="collapsibleColumns",jP=["nestedHeaders"],GP="collapsibleIndicator",zP=WP,$P=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]);var YP=new WeakMap,KP=new WeakSet;class XP extends Tx{constructor(){var e,t;super(...arguments),FP(e=this,t=KP),t.add(e),DP(this,"nestedHeadersPlugin",null),DP(this,"headerStateManager",null),function(e,t,n){FP(e,t),t.set(e,n)}(this,YP,null)}static get PLUGIN_KEY(){return WP}static get PLUGIN_PRIORITY(){return 290}static get PLUGIN_DEPS(){return["plugin:NestedHeaders"]}static get SETTING_KEYS(){return[WP,...jP]}isEnabled(){return!!this.hot.getSettings()[WP]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:t}=this.hot.getSettings();t||Om("You need to configure the Nested Headers plugin in order to use collapsible headers."),UP(YP,this,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",(()=>BP(KP,this,ZP).call(this))),this.addHook("afterLoadData",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return BP(KP,e,JP).call(e,...n)})),this.addHook("afterGetColHeader",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return BP(KP,e,qP).call(e,...n)})),this.addHook("beforeOnCellMouseDown",((e,t,n)=>BP(KP,this,QP).call(this,e,t,n))),this.registerShortcuts(),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){const{collapsibleColumns:e}=this.hot.getSettings();"boolean"==typeof e?this.headerStateManager.mapState((e=>({collapsible:e.origColspan>1}))):Array.isArray(e)&&(this.headerStateManager.mapState((()=>({collapsible:!1}))),this.headerStateManager.mergeStateWith(e))}super.updatePlugin()}}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),UP(YP,this,null),this.nestedHeadersPlugin=null,this.unregisterShortcuts(),this.clearButtons(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{var e;const{row:t,col:n}=this.hot.getSelectedRangeLast().highlight,{collapsible:r,isCollapsed:i,columnIndex:o}=null!==(e=this.headerStateManager.getHeaderTreeNodeData(t,n))&&void 0!==e?e:{};if(r)return i?this.expandSection({row:t,col:o}):this.collapseSection({row:t,col:o}),!1},runOnlyIf:()=>{var e,t;return(null===(e=this.hot.getSelectedRangeLast())||void 0===e?void 0:e.isSingle())&&(null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight.isHeader())},group:zP,relativeToGroup:DA,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(zP)}clearButtons(){if(!this.hot.view)return;const e=this.hot.view._wt.getSetting("columnHeaders").length,t=this.hot.view._wt.wtTable.THEAD,n=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,r=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,i=function(e){e&&e.parentNode.removeChild(e)};$w(0,e-1,(e=>{const o=t.childNodes[e],s=n.childNodes[e],a=r?r.childNodes[e]:null;$w(0,o.childNodes.length-1,(e=>{let t=o.childNodes[e].querySelector(`.${GP}`);i(t),s&&s.childNodes[e]&&(t=s.childNodes[e].querySelector(`.${GP}`),i(t)),r&&a&&a.childNodes[e]&&(t=a.childNodes[e].querySelector(`.${GP}`),i(t))}))}))}expandSection(e){this.toggleCollapsibleSection([e],"expand")}collapseSection(e){this.toggleCollapsibleSection([e],"collapse")}toggleAllCollapsibleSections(e){const t=this.headerStateManager.mapNodes((t=>{const{collapsible:n,origColspan:r,headerLevel:i,columnIndex:o,isCollapsed:s}=t;if(!0===n&&r>1&&(s&&"expand"===e||!s&&"collapse"===e))return{row:this.headerStateManager.levelToRowCoords(i),col:o}}));this.toggleCollapsibleSection(t,e)}collapseAll(){this.toggleAllCollapsibleSections("collapse")}expandAll(){this.toggleAllCollapsibleSections("expand")}toggleCollapsibleSection(e,t){if(!$P.has(t))throw new Error(`Unsupported action is passed (${t}).`);if(!Array.isArray(e))return;const n=Fd(e,(e=>{let{row:t}=e;return t<0}));let r=n.length>0;Vd(n,(e=>{var n;let{row:i,col:o}=e;const{collapsible:s,isCollapsed:a}=null!==(n=this.headerStateManager.getHeaderSettings(i,o))&&void 0!==n?n:{};if(!s||a&&"collapse"===t||!a&&"expand"===t)return r=!1,!1}));const i=[],o=[];r&&Vd(n,(e=>{let{row:n,col:r}=e;const{colspanCompensation:s,affectedColumns:a,rollbackModification:l}=this.headerStateManager.triggerNodeModification(t,n,r);s>0&&(o.push(...a),i.push(l))}));const s=this.getCollapsedColumns();let a=[];"collapse"===t?a=function(e){const t=[];return Vd(e,(e=>{-1===t.indexOf(e)&&t.push(e)})),t}([...s,...o]):"expand"===t&&(a=Fd(s,(e=>!o.includes(e))));const l=$P.get(t);if(!1===this.hot.runHooks(l.beforeHook,s,a,r))return void Vd(i,(e=>{e()}));this.hot.batchExecution((()=>{Vd(o,(e=>{VP(YP,this).setValueAtIndex(this.hot.toPhysicalColumn(e),l.hideColumn)}))}),!0);const h=this.getCollapsedColumns().length!==s.length,u=this.hot.getSelectedRangeLast();if("collapse"===t&&h&&u){const{row:e,col:t}=u.highlight;if((this.hot.rowIndexMapper.isHidden(e)||this.hot.columnIndexMapper.isHidden(t))&&o.includes(t)){const n=e>=0?this.hot.rowIndexMapper.getNearestNotHiddenIndex(e,1,!0):e,r=t>=0?this.hot.columnIndexMapper.getNearestNotHiddenIndex(t,1,!0):t;null!==n&&null!==r&&this.hot.selectCell(n,r)}}this.hot.runHooks(l.afterHook,s,a,r,h),this.hot.render(),this.hot.view.adjustElementsSize()}getCollapsedColumns(){return VP(YP,this).getHiddenIndexes()}destroy(){UP(YP,this,null),super.destroy()}}function qP(e,t,n){var r;const{collapsible:i,origColspan:o,isCollapsed:s}=null!==(r=this.headerStateManager.getHeaderSettings(n,e))&&void 0!==r?r:{},a=i&&o>1&&e>=this.hot.getSettings().fixedColumnsStart,l=this.hot.getSettings().ariaTags;let h=t.querySelector(`.${GP}`);var u;(_p(t,[fp("")[0]]),a)?(h||(h=this.hot.rootDocument.createElement("div"),Op(h,GP),t.querySelector("div:first-child").appendChild(h)),xp(h,["collapsed","expanded"]),s?(Op(h,"collapsed"),Dp(h,"+"),l&&Pp(t,...fp(!1))):(Op(h,"expanded"),Dp(h,"-"),l&&Pp(t,...fp(!0))),l&&Pp(h,"aria-hidden","true")):null===(u=h)||void 0===u||u.remove()}function QP(e,t){Ip(e.target,GP)&&(Ip(e.target,"expanded")?(this.eventManager.fireEvent(e.target,"mouseup"),this.toggleCollapsibleSection([t],"collapse")):Ip(e.target,"collapsed")&&(this.eventManager.fireEvent(e.target,"mouseup"),this.toggleCollapsibleSection([t],"expand")),Nm(e))}function ZP(){this.updatePlugin()}function JP(e,t){t||this.updatePlugin()}function e_(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const t_=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"];class n_{constructor(e,t){e_(this,"hot",void 0),e_(this,"sortingStates",new HE),e_(this,"sortEmptyCells",false),e_(this,"indicator",true),e_(this,"headerAction",true),e_(this,"compareFunctionFactory",void 0),e_(this,"mapName",void 0),this.hot=e,this.mapName=t,this.hot.columnIndexMapper.registerMap(t,this.sortingStates)}updateAllColumnsProperties(e){em(e)&&nm(e,((e,t)=>{t_.includes(t)&&(this[t]=e)}))}getAllColumnsProperties(){const e={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return"function"==typeof this.compareFunctionFactory&&(e.compareFunctionFactory=this.compareFunctionFactory),e}getSortOrderOfColumn(e){var t;return null===(t=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))||void 0===t?void 0:t.sortOrder}getIndexOfColumnInSortQueue(e){return e=this.hot.toPhysicalColumn(e),this.sortingStates.getEntries().findIndex((t=>{let[n]=t;return n===e}))}getNumberOfSortedColumns(){return this.sortingStates.getLength()}isListOfSortedColumnsEmpty(){return 0===this.getNumberOfSortedColumns()}isColumnSorted(e){return em(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))}getSortStates(){if(null===this.sortingStates)return[];return this.sortingStates.getEntries().map((e=>{let[t,n]=e;return{column:this.hot.toVisualColumn(t),...n}}))}getColumnSortState(e){const t=this.getSortOrderOfColumn(e);if(Gd(t))return{column:e,sortOrder:t}}setSortStates(e){this.sortingStates.clear();for(let t=0;t<e.length;t+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(e[t].column),{sortOrder:e[t].sortOrder})}destroy(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}function r_(e,t,n){const r=t.locale;return function(t,i){const{sortEmptyCells:o}=n;return"string"==typeof t&&(t=t.toLocaleLowerCase(r)),"string"==typeof i&&(i=i.toLocaleLowerCase(r)),t===i?c_:$d(t)?$d(i)?c_:o&&"asc"===e?d_:p_:$d(i)?o&&"asc"===e?p_:d_:isNaN(t)&&!isNaN(i)?"asc"===e?p_:d_:!isNaN(t)&&isNaN(i)?"asc"===e?d_:p_:(isNaN(t)||isNaN(i)||(t=parseFloat(t),i=parseFloat(i)),t<i?"asc"===e?d_:p_:t>i?"asc"===e?p_:d_:c_)}}const i_="default";const{register:o_,getItem:s_,hasItem:a_}=yf("sorting.compareFunctionFactory"),{register:l_,getItem:h_}=yf("sorting.mainSortComparator");function u_(e){return a_(e)?s_(e):s_(i_)}o_("checkbox",(function(e,t,n){const r=t.checkedTemplate,i=t.uncheckedTemplate,{sortEmptyCells:o}=n;return function(s,a){const l=$d(s),h=$d(a),u=l?i:s,c=h?i:a,d=u===i||u===r,p=c===i||c===r;if(!1===o){if(l&&!1===h)return p_;if(!1===l&&h)return d_}return!1===d&&p?"asc"===e?d_:p_:d&&!1===p?"asc"===e?p_:d_:!1===d&&!1===p?r_(e,t,n)(s,a):u===i&&c===r?"asc"===e?d_:p_:u===r&&c===i?"asc"===e?p_:d_:c_}})),o_("date",(function(e,t,n){return R_(e,t.dateFormat,n)})),o_(i_,r_),o_("numeric",(function(e,t,n){return function(t,r){const i=parseFloat(t),o=parseFloat(r),{sortEmptyCells:s}=n;if(i===o||isNaN(i)&&isNaN(o))return c_;if(s){if($d(t))return"asc"===e?d_:p_;if($d(r))return"asc"===e?p_:d_}return isNaN(i)?p_:isNaN(o)?d_:i<o?"asc"===e?d_:p_:i>o?"asc"===e?p_:d_:c_}})),o_("time",(function(e,t,n){return R_(e,t.timeFormat,n)}));const c_=0,d_=-1,p_=1;const g_="asc",m_="desc",f_="colHeader";function w_(e){if(e.some((e=>!1===function(e){if(!1===em(e))return!1;const{column:t,sortOrder:n}=e;return Number.isInteger(t)&&[g_,m_].includes(n)}(e))))return!1;const t=e.map((e=>{let{column:t}=e;return t}));return new Set(t).size===t.length}function y_(e){if(e!==m_)return e===g_?m_:g_}function v_(e){return e.querySelector(`.${f_}`)}function C_(e,t){if(e<0||!t.parentNode)return!1;const n=t.parentNode.parentNode.childNodes;return-1===Array.from(n).indexOf(t.parentNode)-n.length}function S_(e,t,n){return-1===e&&t>=0&&!1===Mm(n)}function R_(e,t,n){return function(r,i){const{sortEmptyCells:o}=n;if(r===i)return c_;if($d(r))return $d(i)?c_:o&&"asc"===e?d_:p_;if($d(i))return o&&"asc"===e?p_:d_;const s=M(r,t),a=M(i,t);return s.isValid()?a.isValid()?a.isAfter(s)?"asc"===e?d_:p_:a.isBefore(s)?"asc"===e?p_:d_:c_:d_:p_}}const E_="indicatorDisabled",b_="columnSorting",T_="sortAction",N_=new Map([[g_,"ascending"],[m_,"descending"]]);function A_(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function M_(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function I_(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}const O_="columnSorting",x_="append",P_=O_;l_(O_,(function(e,t){return function(n,r){const[,...i]=n,[,...o]=r;return function(n){const r=e[n],s=t[n],a=i[n],l=o[n],h=s.columnSorting;return(h.compareFunctionFactory?h.compareFunctionFactory:u_(s.type))(r,s,h)(a,l)}(0)}})),mf.getSingleton().register("beforeColumnSort"),mf.getSingleton().register("afterColumnSort");const __=new WeakMap;var L_=new WeakSet;class H_ extends Tx{constructor(){super(...arguments),A_(this,L_),M_(this,"columnStatesManager",null),M_(this,"columnMetaCache",null),M_(this,"pluginKey",O_),M_(this,"indexesSequenceCache",null)}static get PLUGIN_KEY(){return O_}static get PLUGIN_PRIORITY(){return 50}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){var e,t,n=this;if(__.has(this.hot)&&__.get(this.hot)!==this.pluginKey)return this.hot.updateSettings({[this.pluginKey]:!1}),e=__.get(this.hot),t=this.pluginKey,void Om(Wd`Plugins \`columnSorting\` and \`multiColumnSorting\` should not be enabled simultaneously.\x20
    Only \`${e}\` will work. The \`${t}\` plugin will remain disabled.`);this.enabled||(__.set(this.hot,this.pluginKey),this.columnStatesManager=new n_(this.hot,`${this.pluginKey}.sortingStates`),this.columnMetaCache=new ME((e=>{let t=this.hot.toVisualColumn(e);return null===t&&(t=e),this.getMergedPluginSettings(t)})),this.hot.columnIndexMapper.registerMap(`${this.pluginKey}.columnMeta`,this.columnMetaCache),this.addHook("afterGetColHeader",((e,t)=>I_(L_,this,F_).call(this,e,t))),this.addHook("beforeOnCellMouseDown",(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return I_(L_,n,V_).call(n,...t)})),this.addHook("afterOnCellMouseDown",((e,t)=>this.onAfterOnCellMouseDown(e,t))),this.addHook("afterInit",(()=>I_(L_,this,k_).call(this))),this.addHook("afterLoadData",(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return I_(L_,n,D_).call(n,...t)})),this.hot.view&&I_(L_,this,k_).call(this),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){const e=(e,t)=>{const n=v_(t);!1!==C_(e,t)&&null!==n&&this.updateHeaderClasses(n)};__.delete(this.hot),this.hot.addHook("afterGetColHeader",e),this.hot.addHookOnce("afterViewRender",(()=>{this.hot.removeHook("afterGetColHeader",e)})),this.hot.batchExecution((()=>{null!==this.indexesSequenceCache&&(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginKey),this.indexesSequenceCache=null)}),!0),this.hot.columnIndexMapper.unregisterMap(`${this.pluginKey}.columnMeta`),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();return this.sort(this.getColumnNextConfig(e.col)),!1},runOnlyIf:()=>{var e,t;const n=null===(e=this.hot.getSelectedRangeLast())||void 0===e?void 0:e.highlight;return n&&(null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.isSingle())&&this.hot.selection.isCellVisible(n)&&-1===n.row&&n.col>=0},relativeToGroup:DA,position:"before",group:P_})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(P_)}sort(e){const t=this.getSortConfig(),n=this.getNormalizedSortConfigs(e),r=this.areValidSortConfigs(n);!1!==this.hot.runHooks("beforeColumnSort",t,n,r)&&(0===t.length&&null===this.indexesSequenceCache&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new VE),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),r&&(this.columnStatesManager.setSortStates(n),this.sortByPresetSortStates(n),this.saveAllSortSettings(n)),this.hot.runHooks("afterColumnSort",t,r?n:t,r),r&&(this.hot.render(),this.hot.forceFullRender=!1,this.hot.view.render()))}clearSort(){this.sort([])}isSorted(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}getSortConfig(e){return Gd(e)?this.columnStatesManager.getColumnSortState(e):this.columnStatesManager.getSortStates()}setSortConfig(e){const t=this.getNormalizedSortConfigs(e);this.areValidSortConfigs(t)&&this.columnStatesManager.setSortStates(t)}getNormalizedSortConfigs(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Array.isArray(e)?e.slice(0,1):[e]}areValidSortConfigs(e){const t=this.hot.countCols();return w_(e)&&e.every((e=>{let{column:n}=e;return n<=t&&n>=0}))}saveAllSortSettings(e){const t=this.columnStatesManager.getAllColumnsProperties();t.initialConfig=Dd(e,(e=>{let{column:t,...n}=e;return{column:this.hot.toPhysicalColumn(t),...n}})),this.hot.runHooks("persistentStateSave","columnSorting",t)}getAllSavedSortSettings(){const e={};this.hot.runHooks("persistentStateLoad","columnSorting",e);const t=e.value,n=e=>{let{column:t,...n}=e;return{column:this.hot.toVisualColumn(t),...n}};return Gd(t)&&Array.isArray(t.initialConfig)&&(t.initialConfig=Dd(t.initialConfig,n)),t}getColumnNextConfig(e){const t=this.columnStatesManager.getSortOrderOfColumn(e);if(Gd(t)){const n=y_(t);return Gd(n)?{column:e,sortOrder:n}:void 0}const n=this.hot.countCols();if(Number.isInteger(e)&&e>=0&&e<n)return{column:e,sortOrder:y_()}}getNextSortConfig(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:x_;const n=this.columnStatesManager.getIndexOfColumnInSortQueue(e),r=-1!==n,i=this.getSortConfig(),o=this.getColumnNextConfig(e);if(r){if(zd(o))return[...i.slice(0,n),...i.slice(n+1)];if(t===x_)return[...i.slice(0,n),...i.slice(n+1),o];if("replace"===t)return[...i.slice(0,n),o,...i.slice(n+1)]}return Gd(o)?i.concat(o):i}getPluginColumnConfig(e){if(em(e)){const t=e[this.pluginKey];if(em(t))return t}return{}}getMergedPluginSettings(e){const t=this.hot.getSettings()[this.pluginKey],n=this.columnStatesManager.getAllColumnsProperties(),r=this.hot.getCellMeta(0,e),i=Object.getPrototypeOf(r);return Array.isArray(i.columns)?Object.assign(n,t,this.getPluginColumnConfig(i.columns[e])):pg(i.columns)?Object.assign(n,t,this.getPluginColumnConfig(i.columns(e))):Object.assign(n,t)}getFirstCellSettings(e){const t=this.hot.getCellMeta(0,e),n=Object.create(t);return n[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(e)),n}getNumberOfRowsToSort(e){const t=this.hot.getSettings();return t.maxRows<=e?t.maxRows:e-t.minSpareRows}sortByPresetSortStates(e){if(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),0===e.length)return;const t=[],n=this.hot.countRows(),r=t=>Dd(e,(e=>this.hot.getDataAtCell(t,e.column)));for(let l=0;l<this.getNumberOfRowsToSort(n);l+=1)t.push([this.hot.toPhysicalRow(l)].concat(r(l)));const i=Dd(t,(e=>e[0]));!function(e,t){const n=h_(t);for(var r=arguments.length,i=new Array(r>2?r-2:0),o=2;o<r;o++)i[o-2]=arguments[o];e.sort(n(...i))}(t,this.pluginKey,Dd(e,(e=>e.sortOrder)),Dd(e,(e=>this.getFirstCellSettings(e.column))));for(let l=t.length;l<n;l+=1)t.push([l].concat(r(l)));const o=Dd(t,(e=>e[0])),s=new Map(Dd(i,((e,t)=>[e,o[t]]))),a=Dd(this.hot.rowIndexMapper.getIndexesSequence(),(e=>s.has(e)?s.get(e):e));this.hot.rowIndexMapper.setIndexesSequence(a)}sortBySettings(e){if(em(e)){this.columnStatesManager.updateAllColumnsProperties(e);const t=e.initialConfig;(Array.isArray(t)||em(t))&&this.sort(t)}else this.hot.render()}updateHeaderClasses(e){if(xp(e,Array.from(N_.values()).concat(T_,E_,b_)),!1!==this.enabled){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];Op(e,function(e,t,n,r){const i=[b_];if(r&&i.push(T_),!1===n)return i.push(E_),i;const o=e.getSortOrderOfColumn(t);return Gd(o)&&i.push(N_.get(o)),i}(...n))}}onUpdateSettings(e){super.onUpdateSettings(e),null!==this.columnMetaCache&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),Gd(e[this.pluginKey])&&this.sortBySettings(e[this.pluginKey])}wasClickableHeaderClicked(e,t){return this.getFirstCellSettings(t)[this.pluginKey].headerAction&&Ip(e.target,f_)}onAfterOnCellMouseDown(e,t){if(!1!==S_(t.row,t.col,e)&&this.wasClickableHeaderClicked(e,t.col)){this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(t.col));const e=this.hot.getActiveEditor(),n=this.getColumnNextConfig(t.col);null!=e&&e.isOpened()&&this.hot.getCellValidator(e.row,e.col)?this.hot.addHookOnce("postAfterValidate",(()=>{this.sort(n)})):this.sort(n)}}destroy(){var e;null===(e=this.columnStatesManager)||void 0===e||e.destroy(),super.destroy()}}function k_(){const e=this.getAllSavedSortSettings();if(em(e))this.sortBySettings(e);else{const e=this.hot.getSettings()[this.pluginKey];this.sortBySettings(e)}}function F_(e,t){const n=v_(t);if(!1===C_(e,t)||null===n)return;const r=this.getFirstCellSettings(e)[this.pluginKey],i=r.indicator,o=r.headerAction;if(this.updateHeaderClasses(n,this.columnStatesManager,e,i,o),this.hot.getSettings().ariaTags){const n=this.columnStatesManager.getSortOrderOfColumn(e);Pp(t,...(s=n?`${n}ending`:"none",["aria-sort",s]))}var s}function D_(e){!0===e&&this.hot.view&&I_(L_,this,k_).call(this)}function V_(e,t,n,r){!1!==S_(t.row,t.col,e)&&this.wasClickableHeaderClicked(e,t.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(r.column=!0)}function U_(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const B_=class{constructor(e,t){U_(this,"plugin",void 0),U_(this,"hot",void 0),U_(this,"endpoints",[]),U_(this,"settings",void 0),U_(this,"settingsType","array"),U_(this,"currentEndpoint",null),U_(this,"cellsToSetCache",[]),this.plugin=e,this.hot=this.plugin.hot,this.settings=t}initEndpoints(){this.endpoints=this.parseSettings(),this.refreshAllEndpoints()}getEndpoint(e){return"function"===this.settingsType?this.fillMissingEndpointData(this.settings)[e]:this.endpoints[e]}getAllEndpoints(){return"function"===this.settingsType?this.fillMissingEndpointData(this.settings):this.endpoints}fillMissingEndpointData(e){return this.parseSettings(e.call(this))}parseSettings(e){const t=[];let n=e;if(n||"function"!=typeof this.settings)return n||(n=this.settings),Vd(n,(e=>{const n={};this.assignSetting(e,n,"ranges",[[0,this.hot.countRows()-1]]),this.assignSetting(e,n,"reversedRowCoords",!1),this.assignSetting(e,n,"destinationRow",new Error("\n        You must provide a destination row for the Column Summary plugin in order to work properly!\n      ")),this.assignSetting(e,n,"destinationColumn",new Error("\n        You must provide a destination column for the Column Summary plugin in order to work properly!\n      ")),this.assignSetting(e,n,"sourceColumn",e.destinationColumn),this.assignSetting(e,n,"type","sum"),this.assignSetting(e,n,"forceNumeric",!1),this.assignSetting(e,n,"suppressDataTypeErrors",!0),this.assignSetting(e,n,"customFunction",null),this.assignSetting(e,n,"readOnly",!0),this.assignSetting(e,n,"roundFloat",!1),t.push(n)})),t;this.settingsType="function"}assignSetting(e,t,n,r){if("ranges"!==n||void 0!==e[n]){if("ranges"!==n||0!==e[n].length)if(void 0===e[n]){if(r instanceof Error)throw r;t[n]=r}else"destinationRow"===n&&t.reversedRowCoords?t[n]=this.hot.countRows()-e[n]-1:t[n]=e[n]}else t[n]=r}resetSetupBeforeStructureAlteration(e,t,n){if("function"!==this.settingsType)return;const r=e.indexOf("row")>-1?"row":"col",i=this.getAllEndpoints();Vd(i,(i=>{"row"===r&&i.destinationRow>=t&&("insert_row"===e?i.alterRowOffset=n:"remove_row"===e&&(i.alterRowOffset=-1*n)),"col"===r&&i.destinationColumn>=t&&("insert_col"===e?i.alterColumnOffset=n:"remove_col"===e&&(i.alterColumnOffset=-1*n))})),this.resetAllEndpoints(i,!1)}resetSetupAfterStructureAlteration(e,t,n,r,i){let o=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];if("function"===this.settingsType){const e=()=>(this.hot.removeHook("beforeViewRender",e),this.refreshAllEndpoints());return void this.hot.addHookOnce("beforeViewRender",e)}const s=e.indexOf("row")>-1?"row":"col",a=e.indexOf("remove")>-1?-1:1,l=this.getAllEndpoints(),h=0===e.indexOf("move_row"),u=t;Vd(l,(e=>{"row"===s&&e.destinationRow>=u&&(e.alterRowOffset=a*n),"col"===s&&e.destinationColumn>=u&&(e.alterColumnOffset=a*n)})),this.resetAllEndpoints(l,!h),Vd(l,h?e=>{this.extendEndpointRanges(e,u,r[0],r.length),this.recreatePhysicalRanges(e),this.clearOffsetInformation(e)}:e=>{this.shiftEndpointCoordinates(e,u)}),o&&this.refreshAllEndpoints()}clearOffsetInformation(e){e.alterRowOffset=void 0,e.alterColumnOffset=void 0}extendEndpointRanges(e,t,n,r){Vd(e.ranges,(e=>{e[1]&&(t>=e[0]&&t<=e[1]?n>e[1]?e[1]+=r:n<e[0]&&(e[0]-=r):n>=e[0]&&n<=e[1]&&(e[1]-=r,t<=e[0]&&(e[0]+=1,e[1]+=1)))}))}recreatePhysicalRanges(e){const t=e.ranges,n=[],r=[];Vd(t,(e=>{const t=[];if(e[1])for(let n=e[0];n<=e[1];n++)t.push(this.hot.toPhysicalRow(n));else t.push(this.hot.toPhysicalRow(e[0]));r.push(t)})),Vd(r,(e=>{let t=[];Vd(e,((r,i)=>{0===i?t.push(r):e[i]!==e[i-1]+1&&(t.push(e[i-1]),n.push(t),t=[],t.push(r)),i===e.length-1&&(t.push(r),n.push(t))}))})),e.ranges=n}shiftEndpointCoordinates(e,t){e.alterRowOffset&&0!==e.alterRowOffset?(e.destinationRow+=e.alterRowOffset||0,Vd(e.ranges,(n=>{Vd(n,((r,i)=>{r>=t&&(n[i]+=e.alterRowOffset||0)}))}))):e.alterColumnOffset&&0!==e.alterColumnOffset&&(e.destinationColumn+=e.alterColumnOffset||0,e.sourceColumn+=e.alterColumnOffset||0)}resetAllEndpoints(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getAllEndpoints(),t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];e.some((e=>{const t=e.alterRowOffset||0,n=e.alterColumnOffset||0;return e.destinationRow+t>=this.hot.countRows()||e.destinationColumn+n>=this.hot.countCols()}))||(this.cellsToSetCache=[],Vd(e,(e=>{this.resetEndpointValue(e,t)})),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}refreshAllEndpoints(){this.cellsToSetCache=[],Vd(this.getAllEndpoints(),(e=>{this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e,"init")})),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshChangedEndpoints(e){const t=[];this.cellsToSetCache=[],Vd(e,((e,n,r)=>{`${e[2]||""}`!=`${e[3]}`&&Vd(this.getAllEndpoints(),((e,i)=>{this.hot.propToCol(r[n][1])===e.sourceColumn&&-1===t.indexOf(i)&&t.push(i)}))})),Vd(t,(e=>{this.refreshEndpoint(this.getEndpoint(e))})),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshCellMetas(){this.endpoints.forEach((e=>{const t=this.hot.toVisualRow(e.destinationRow);if(null!==t){const n=this.hot.getCellMeta(t,e.destinationColumn);n.readOnly=e.readOnly,n.className="columnSummaryResult"}}))}refreshEndpoint(e){this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e),this.currentEndpoint=null}resetEndpointValue(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const n=e.alterRowOffset||0,r=e.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(e.destinationRow+(t?n:0)),this.hot.toVisualColumn(e.destinationColumn+(t?r:0)),""])}setEndpointValue(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=this.hot.toVisualRow(e.destinationRow);if(e.destinationRow>=this.hot.countRows()||e.destinationColumn>=this.hot.countCols())return void this.throwOutOfBoundsWarning();const i=this.hot.toVisualRow(e.destinationRow);if(null!==i){const n=this.hot.getCellMeta(i,e.destinationColumn);"init"!==t&&n.readOnly===e.readOnly||(n.readOnly=e.readOnly,n.className="columnSummaryResult")}if((!0===e.roundFloat||Number.isInteger(e.roundFloat))&&!isNaN(e.result)){const t=e.roundFloat;let n=0;Number.isInteger(t)&&(n=Math.min(Math.max(0,t),100)),e.result=e.result.toFixed(n)}n?this.hot.setDataAtCell(r,e.destinationColumn,e.result,"ColumnSummary.set"):this.cellsToSetCache.push([r,e.destinationColumn,e.result]),e.alterRowOffset=void 0,e.alterColumnOffset=void 0}throwOutOfBoundsWarning(){Om("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}};function W_(e){return null==e||isNaN(e)}function j_(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function G_(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function z_(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}const $_="columnSummary";var Y_=new WeakSet;class K_ extends Tx{constructor(){super(...arguments),j_(this,Y_),G_(this,"endpoints",null)}static get PLUGIN_KEY(){return $_}static get PLUGIN_PRIORITY(){return 220}isEnabled(){return!!this.hot.getSettings()[$_]}enablePlugin(){var e=this;this.enabled||(this.settings=this.hot.getSettings()[$_],this.endpoints=new B_(this,this.settings),this.addHook("afterInit",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return z_(Y_,e,X_).call(e,...n)})),this.addHook("afterChange",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return z_(Y_,e,Q_).call(e,...n)})),this.addHook("afterUpdateSettings",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return z_(Y_,e,q_).call(e,...n)})),this.addHook("beforeCreateRow",((e,t,n)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_row",e,t,null,n))),this.addHook("beforeCreateCol",((e,t,n)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_col",e,t,null,n))),this.addHook("beforeRemoveRow",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.endpoints.resetSetupBeforeStructureAlteration("remove_row",...n)})),this.addHook("beforeRemoveCol",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.endpoints.resetSetupBeforeStructureAlteration("remove_col",...n)})),this.addHook("afterCreateRow",((e,t,n)=>this.endpoints.resetSetupAfterStructureAlteration("insert_row",e,t,null,n))),this.addHook("afterCreateCol",((e,t,n)=>this.endpoints.resetSetupAfterStructureAlteration("insert_col",e,t,null,n))),this.addHook("afterRemoveRow",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.endpoints.resetSetupAfterStructureAlteration("remove_row",...n)})),this.addHook("afterRemoveCol",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.endpoints.resetSetupAfterStructureAlteration("remove_col",...n)})),this.addHook("afterRowMove",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return z_(Y_,e,Z_).call(e,...n)})),super.enablePlugin())}disablePlugin(){this.endpoints=null,this.settings=null,this.currentEndpoint=null,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.endpoints.initEndpoints(),super.updatePlugin()}calculate(e){switch(e.type.toLowerCase()){case"sum":e.result=this.calculateSum(e);break;case"min":case"max":e.result=this.calculateMinMax(e,e.type);break;case"count":e.result=this.countEntries(e);break;case"average":e.result=this.calculateAverage(e);break;case"custom":e.result=e.customFunction.call(this,e)}}calculateSum(e){let t=0;return nm(e.ranges,(n=>{t+=this.getPartialSum(n,e.sourceColumn)})),t}getPartialSum(e,t){let n=0,r=e[1]||e[0],i=null,o=0;do{if(i=this.getCellValue(r,t),i=W_(i)?null:i,null!==i){const e=(`${i}`.split(".")[1]||[]).length||1;e>o&&(o=e)}n+=i||0,r-=1}while(r>=e[0]);return Math.round(n*10**o)/10**o}calculateMinMax(e,t){let n=null;return nm(e.ranges,(r=>{const i=this.getPartialMinMax(r,e.sourceColumn,t);if(null===n&&null!==i&&(n=i),null!==i)switch(t){case"min":n=Math.min(n,i);break;case"max":n=Math.max(n,i)}})),null===n?"Not enough data":n}getPartialMinMax(e,t,n){let r,i=null,o=e[1]||e[0];do{if(r=this.getCellValue(o,t),r=W_(r)?null:r,null===i)i=r;else if(null!==r)switch(n){case"min":i=Math.min(i,r);break;case"max":i=Math.max(i,r)}o-=1}while(o>=e[0]);return i}countEmpty(e,t){let n,r=0,i=e[1]||e[0];do{n=this.getCellValue(i,t),n=W_(n)?null:n,null===n&&(r+=1),i-=1}while(i>=e[0]);return r}countEntries(e){let t=0;return nm(e.ranges,(n=>{const r=void 0===n[1]?1:n[1]-n[0]+1,i=this.countEmpty(n,e.sourceColumn);t+=r,t-=i})),t}calculateAverage(e){return this.calculateSum(e)/this.countEntries(e)}getCellValue(e,t){const n=this.hot.toVisualRow(e),r=this.hot.toVisualColumn(t);let i=this.hot.getSourceDataAtCell(e,t),o="";if(null!==n&&null!==r&&(o=this.hot.getCellMeta(n,r).className||""),o.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&("string"==typeof i&&(i=i.replace(/,/,".")),i=parseFloat(i)),isNaN(i)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error(Wd`ColumnSummary plugin: cell at (${e}, ${t}) is not in a\x20
          numeric format. Cannot do the calculation.`);return i}}function X_(){this.endpoints.initEndpoints()}function q_(e){void 0!==e.columns&&this.endpoints.refreshCellMetas()}function Q_(e,t){e&&"ColumnSummary.reset"!==t&&"ColumnSummary.set"!==t&&"loadData"!==t&&this.endpoints.refreshChangedEndpoints(e)}function Z_(e,t){this.endpoints.resetSetupBeforeStructureAlteration("move_row",e[0],e.length,e,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",t,e.length,e,this.pluginName)}function J_(e,t,n){eL(e,t),t.set(e,n)}function eL(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function tL(e,t){return e.get(rL(e,t))}function nL(e,t,n){return e.set(rL(e,t),n),n}function rL(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var iL=new WeakMap,oL=new WeakMap,sL=new WeakMap,aL=new WeakSet;class lL{constructor(){var e,t;eL(e=this,t=aL),t.add(e),J_(this,iL,!0),J_(this,oL,null),J_(this,sL,new ResizeObserver((e=>rL(aL,this,hL).call(this,e))))}setObservedElement(e){nL(oL,this,e)}unobserve(){tL(sL,this).unobserve(tL(oL,this))}observe(){nL(iL,this,!0),tL(sL,this).observe(tL(oL,this))}destroy(){tL(sL,this).disconnect()}}function hL(e){!tL(iL,this)&&Array.isArray(e)&&e.length?e.forEach((e=>{let{borderBoxSize:t}=e;const{inlineSize:n,blockSize:r}=t[0];this.runLocalHooks("resize",n,r)})):nL(iL,this,!1)}function uL(e,t,n){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,n)}function cL(e,t){return e.get(pL(e,t))}function dL(e,t,n){return e.set(pL(e,t),n),n}function pL(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}Zg(lL,cS);var gL=new WeakMap,mL=new WeakMap,fL=new WeakMap,wL=new WeakMap,yL=new WeakMap,vL=new WeakMap,CL=new WeakMap;class SL{static get CLASS_EDITOR_CONTAINER(){return"htCommentsContainer"}static get CLASS_EDITOR(){return"htComments"}static get CLASS_INPUT(){return"htCommentTextArea"}static get CLASS_CELL(){return"htCommentCell"}constructor(e,t){var n=this;uL(this,gL,void 0),uL(this,mL,!1),uL(this,fL,null),uL(this,wL,void 0),uL(this,yL,void 0),uL(this,vL,!0),uL(this,CL,new lL),dL(gL,this,e),dL(mL,this,t),dL(wL,this,this.createEditor()),dL(yL,this,cL(wL,this).style),cL(CL,this).setObservedElement(this.getInputElement()),cL(CL,this).addLocalHook("resize",(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.runLocalHooks("resize",...t)})),this.hide()}setPosition(e,t){cL(yL,this).left=`${e}px`,cL(yL,this).top=`${t}px`}setSize(e,t){if(e&&t){const n=this.getInputElement();n.style.width=`${e}px`,n.style.height=`${t}px`}}getSize(){return{width:Kp(this.getInputElement()),height:Xp(this.getInputElement())}}observeSize(){cL(CL,this).observe()}resetSize(){const e=this.getInputElement();e.style.width="",e.style.height=""}setReadOnlyState(e){this.getInputElement().readOnly=e}show(){cL(yL,this).display="block",dL(vL,this,!1)}hide(){cL(CL,this).unobserve(),cL(vL,this)||(cL(yL,this).display="none"),dL(vL,this,!0)}isVisible(){return"block"===cL(yL,this).display}setValue(){const e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"")||"";this.getInputElement().value=e}getValue(){return this.getInputElement().value}isFocused(){return cL(gL,this).activeElement===this.getInputElement()}focus(){this.getInputElement().focus()}createEditor(){const e=cL(gL,this).createElement("div"),t=cL(gL,this).createElement("textarea");return e.style.display="none",dL(fL,this,cL(gL,this).createElement("div")),cL(fL,this).setAttribute("dir",cL(mL,this)?"rtl":"ltr"),Op(cL(fL,this),SL.CLASS_EDITOR_CONTAINER),cL(gL,this).body.appendChild(cL(fL,this)),Op(e,SL.CLASS_EDITOR),Op(t,SL.CLASS_INPUT),t.setAttribute("data-hot-input",!0),e.appendChild(t),cL(fL,this).appendChild(e),e}getInputElement(){return cL(wL,this).querySelector(`.${SL.CLASS_INPUT}`)}getEditorElement(){return cL(wL,this)}destroy(){const e=cL(fL,this)?cL(fL,this).parentNode:null;cL(wL,this).parentNode.removeChild(cL(wL,this)),dL(wL,this,null),dL(yL,this,null),cL(CL,this).destroy(),e&&e.removeChild(cL(fL,this))}}Zg(SL,cS);const RL=SL;function EL(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class bL{constructor(e){EL(this,"wasLastActionShow",!0),EL(this,"showDebounced",null),EL(this,"hidingTimer",null),this.updateDelay(e)}hide(){this.wasLastActionShow=!1,this.hidingTimer=setTimeout((()=>{!1===this.wasLastActionShow&&this.runLocalHooks("hide")}),250)}show(e){this.wasLastActionShow=!0,this.showDebounced(e)}cancelHiding(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}updateDelay(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:250;this.showDebounced=gg((e=>{this.wasLastActionShow&&this.runLocalHooks("show",e.from.row,e.from.col)}),e)}destroy(){this.clearLocalHooks()}}Zg(bL,cS);const TL=bL;function NL(e,t){const n={};return Vd(e,(e=>{e.forAll(((e,r)=>{e>=0&&r>=0&&(n[e]||(n[e]=[]),n[e][r]=t(e,r))}))})),n}function AL(e,t,n,r,i){Vd(e,(e=>{e.forAll(((e,o)=>{e>=0&&o>=0&&function(e,t,n,r,i,o){const s=i(e,t);let a=r;s.className&&(a="vertical"===n?function(e,t){return-1!==e.indexOf(t)?e:`${e.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","")} ${t}`}(s.className,r):function(e,t){return-1!==e.indexOf(t)?e:`${e.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","")} ${t}`}(s.className,r));o(e,t,"className",a)}(e,o,t,n,r,i)}))}))}function ML(e){return`<span class="selected">${String.fromCharCode(10003)}</span>${e}`}function IL(e,t){let n=!1;return Array.isArray(e)&&Vd(e,(e=>(e.forAll(((e,r)=>{if(e>=0&&r>=0&&t(e,r))return n=!0,!1})),n))),n}function OL(e,t){const n={top:0,left:0};if(t!==e.ownerDocument){const{frameElement:e}=t.defaultView,{top:r,left:i}=e.getBoundingClientRect();n.top=r,n.left=i}return n}const xL="---------";const PL="alignment";const _L="clear_column";const LL="col_left";const HL="col_right";const kL="make_read_only";const FL="redo";const DL="remove_col";const VL="remove_row";const UL="row_above";const BL="row_below";const WL="no_items";const jL="undo";const GL=[UL,BL,LL,HL,_L,VL,DL,jL,FL,kL,PL,xL,WL],zL={[xL]:function(){return{name:xL}},[WL]:function(){return{key:WL,name(){return this.getTranslatedPhrase(pb)},disabled:!0,isCommand:!1}},[UL]:function(){return{key:UL,name(){return this.getTranslatedPhrase(gb)},callback(){const e=this.getSelectedRangeLast().getTopLeftCorner();this.alter("insert_row_above",e.row,1,"ContextMenu.rowAbove")},disabled(){const e=this.getSelectedRangeLast();return!!(!e||this.selection.isSelectedByColumnHeader()||e.isSingleHeader()&&e.highlight.row<0||this.countSourceRows()>=this.getSettings().maxRows)||!!this.selection.isSelectedByCorner()&&0===this.countRows()},hidden(){return!this.getSettings().allowInsertRow}}},[BL]:function(){return{key:BL,name(){return this.getTranslatedPhrase(mb)},callback(){const e=this.getSelectedRangeLast().getBottomRightCorner();this.alter("insert_row_below",e.row,1,"ContextMenu.rowBelow")},disabled(){const e=this.getSelectedRangeLast();return!!(!e||this.selection.isSelectedByColumnHeader()||e.isSingleHeader()&&e.highlight.row<0||this.countSourceRows()>=this.getSettings().maxRows)},hidden(){return!this.getSettings().allowInsertRow}}},[LL]:function(){return{key:LL,name(){return this.getTranslatedPhrase(fb)},callback(){const e=this.getSelectedRangeLast().getTopLeftCorner(),t=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(t,e.col,1,"ContextMenu.columnLeft")},disabled(){if(!this.isColumnModificationAllowed())return!0;const e=this.getSelectedRangeLast();return!!(!e||this.selection.isSelectedByRowHeader()||e.isSingleHeader()&&e.highlight.col<0||this.countSourceCols()>=this.getSettings().maxCols)||!!this.selection.isSelectedByCorner()&&0===this.countCols()},hidden(){return!this.getSettings().allowInsertColumn}}},[HL]:function(){return{key:HL,name(){return this.getTranslatedPhrase(wb)},callback(){const e=this.getSelectedRangeLast().getTopRightCorner(),t=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(t,e.col,1,"ContextMenu.columnRight")},disabled(){if(!this.isColumnModificationAllowed())return!0;const e=this.getSelectedRangeLast();return!!(!e||this.selection.isSelectedByRowHeader()||e.isSingleHeader()&&e.highlight.col<0||this.countSourceCols()>=this.getSettings().maxCols)},hidden(){return!this.getSettings().allowInsertColumn}}},[_L]:function(){return{key:_L,name(){return this.getTranslatedPhrase(Eb)},callback(e,t){const n=t[0].start.col,r=t[0].end.col;this.countRows()&&this.populateFromArray(0,n,[[null]],Math.max(t[0].start.row,t[0].end.row),r,"ContextMenu.clearColumn")},disabled(){const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader()&&e.highlight.col<0||!this.selection.isSelectedByColumnHeader())return!0;let t=!1;return e.forAll(((e,n)=>{if(e<0||n<0)return!0;const{readOnly:r}=this.getCellMeta(e,n);return!!r||(t=!0,!1)})),!t}}},[VL]:function(){return{key:VL,name(){const e=this.getSelected();let t=0;if(e)if(e.length>1)t=1;else{const[n,,r]=e[0];n-r!=0&&(t=1)}return this.getTranslatedPhrase(yb,t)},callback(){this.alter("remove_row",function(e){const t=DN(e.getSelected());if(0===t||1===t)return[];const n=VN(t,{createCellCoords:e._createCellCoords.bind(e),createCellRange:e._createCellRange.bind(e)}),r=new Set;Vd(e.getSelected(),(e=>{const{from:t,to:i}=n(e),o=Math.max(t.row,0),s=i.row-o+1;Vd(Array.from(new Array(s),((e,t)=>o+t)),(e=>{r.has(e)||r.add(e)}))}));const i=kd(Array.from(r).sort(((e,t)=>e-t)),((e,t,n,r)=>(0!==n&&t===r[n-1]+1?e[e.length-1][1]+=1:e.push([t,1]),e)),[]);return i}(this),1,"ContextMenu.removeRow")},disabled(){const e=this.getSelectedRangeLast();if(!e)return!0;if(e.isSingleHeader()&&e.highlight.row<0)return!0;const t=this.countRows();return this.selection.isSelectedByCorner()?0===t:this.selection.isSelectedByColumnHeader()||0===t},hidden(){return!this.getSettings().allowRemoveRow}}},[DL]:function(){return{key:DL,name(){const e=this.getSelected();let t=0;if(e)if(e.length>1)t=1;else{const[,n,,r]=e[0];n-r!=0&&(t=1)}return this.getTranslatedPhrase(vb,t)},callback(){this.alter("remove_col",function(e){const t=DN(e.getSelected());if(0===t||1===t)return[];const n=VN(t,{createCellCoords:e._createCellCoords.bind(e),createCellRange:e._createCellRange.bind(e)}),r=new Set;Vd(e.getSelected(),(e=>{const{from:t,to:i}=n(e),o=Math.max(t.col,0),s=i.col-o+1;Vd(Array.from(new Array(s),((e,t)=>o+t)),(e=>{r.has(e)||r.add(e)}))}));const i=kd(Array.from(r).sort(((e,t)=>e-t)),((e,t,n,r)=>(0!==n&&t===r[n-1]+1?e[e.length-1][1]+=1:e.push([t,1]),e)),[]);return i}(this),null,"ContextMenu.removeColumn")},disabled(){if(!this.isColumnModificationAllowed())return!0;const e=this.getSelectedRangeLast();if(!e)return!0;if(e.isSingleHeader()&&e.highlight.col<0)return!0;const t=this.countCols();return this.selection.isSelectedByCorner()?0===t:this.selection.isSelectedByRowHeader()||0===t},hidden(){return!this.getSettings().allowRemoveColumn}}},[jL]:function(){return{key:jL,name(){return this.getTranslatedPhrase(Cb)},callback(){this.undo()},hidden(){const e=this.getPlugin("undoRedo");return!e||!e.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isUndoAvailable()}}},[FL]:function(){return{key:FL,name(){return this.getTranslatedPhrase(Sb)},callback(){this.redo()},hidden(){const e=this.getPlugin("undoRedo");return!e||!e.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isRedoAvailable()}}},[kL]:function(){return{key:kL,checkable:!0,ariaChecked(){return IL(this.getSelectedRange(),((e,t)=>this.getCellMeta(e,t).readOnly))},ariaLabel(){return this.getTranslatedPhrase(Rb)},name(){let e=this.getTranslatedPhrase(Rb);return IL(this.getSelectedRange(),((e,t)=>this.getCellMeta(e,t).readOnly))&&(e=ML(e)),e},callback(){const e=this.getSelectedRange(),t=IL(e,((e,t)=>this.getCellMeta(e,t).readOnly));Vd(e,(e=>{e.forAll(((e,n)=>{e>=0&&n>=0&&this.setCellMeta(e,n,"readOnly",!t)}))})),this.render()},disabled(){const e=this.getSelectedRangeLast();return!e||(!!e.isSingleHeader()||(!!this.selection.isSelectedByCorner()||(0===this.countRows()||0===this.countCols()||(!this.getSelectedRange()||0===this.getSelectedRange().length))))}}},[PL]:function(){return{key:PL,name(){return this.getTranslatedPhrase(Fb)},disabled(){if(0===this.countRows()||0===this.countCols())return!0;const e=this.getSelectedRangeLast();return!e||(!!e.isSingleHeader()||!(this.getSelectedRange()&&!this.selection.isSelectedByCorner()))},submenu:{items:[{key:`${PL}:left`,name(){return this.getTranslatedPhrase(Db)},callback(){const e=this.getSelectedRange(),t=NL(e,((e,t)=>this.getCellMeta(e,t).className)),n="horizontal",r="htLeft";this.runHooks("beforeCellAlignment",t,e,n,r),AL(e,n,r,((e,t)=>this.getCellMeta(e,t)),((e,t,n,r)=>this.setCellMeta(e,t,n,r))),this.render()},disabled:!1},{key:`${PL}:center`,name(){return this.getTranslatedPhrase(Vb)},callback(){const e=this.getSelectedRange(),t=NL(e,((e,t)=>this.getCellMeta(e,t).className)),n="horizontal",r="htCenter";this.runHooks("beforeCellAlignment",t,e,n,r),AL(e,n,r,((e,t)=>this.getCellMeta(e,t)),((e,t,n,r)=>this.setCellMeta(e,t,n,r))),this.render()},disabled:!1},{key:`${PL}:right`,name(){return this.getTranslatedPhrase(Ub)},callback(){const e=this.getSelectedRange(),t=NL(e,((e,t)=>this.getCellMeta(e,t).className)),n="horizontal",r="htRight";this.runHooks("beforeCellAlignment",t,e,n,r),AL(e,n,r,((e,t)=>this.getCellMeta(e,t)),((e,t,n,r)=>this.setCellMeta(e,t,n,r))),this.render()},disabled:!1},{key:`${PL}:justify`,name(){return this.getTranslatedPhrase(Bb)},callback(){const e=this.getSelectedRange(),t=NL(e,((e,t)=>this.getCellMeta(e,t).className)),n="horizontal",r="htJustify";this.runHooks("beforeCellAlignment",t,e,n,r),AL(e,n,r,((e,t)=>this.getCellMeta(e,t)),((e,t,n,r)=>this.setCellMeta(e,t,n,r))),this.render()},disabled:!1},{name:xL},{key:`${PL}:top`,name(){return this.getTranslatedPhrase(Wb)},callback(){const e=this.getSelectedRange(),t=NL(e,((e,t)=>this.getCellMeta(e,t).className)),n="vertical",r="htTop";this.runHooks("beforeCellAlignment",t,e,n,r),AL(e,n,r,((e,t)=>this.getCellMeta(e,t)),((e,t,n,r)=>this.setCellMeta(e,t,n,r))),this.render()},disabled:!1},{key:`${PL}:middle`,name(){return this.getTranslatedPhrase(jb)},callback(){const e=this.getSelectedRange(),t=NL(e,((e,t)=>this.getCellMeta(e,t).className)),n="vertical",r="htMiddle";this.runHooks("beforeCellAlignment",t,e,n,r),AL(e,n,r,((e,t)=>this.getCellMeta(e,t)),((e,t,n,r)=>this.setCellMeta(e,t,n,r))),this.render()},disabled:!1},{key:`${PL}:bottom`,name(){return this.getTranslatedPhrase(Gb)},callback(){const e=this.getSelectedRange(),t=NL(e,((e,t)=>this.getCellMeta(e,t).className)),n="vertical",r="htBottom";this.runHooks("beforeCellAlignment",t,e,n,r),AL(e,n,r,((e,t)=>this.getCellMeta(e,t)),((e,t,n,r)=>this.setCellMeta(e,t,n,r))),this.render()},disabled:!1}]}}}};function $L(){const e={};return nm(zL,((t,n)=>{e[n]=t()})),e}function YL(e,t,n){KL(e,t),t.set(e,n)}function KL(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function XL(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function qL(e,t,n){return e.set(ZL(e,t),n),n}function QL(e,t){return e.get(ZL(e,t))}function ZL(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}const JL="comments",eH="comment",tH="value",nH="style",rH="readOnly",iH=JL,oH=`plugin:${JL}`;var sH=new WeakMap,aH=new WeakMap,lH=new WeakMap,hH=new WeakMap,uH=new WeakMap,cH=new WeakMap,dH=new WeakSet;class pH extends Tx{constructor(){var e,t;super(...arguments),KL(e=this,t=dH),t.add(e),XL(this,"range",{}),YL(this,sH,null),YL(this,aH,null),YL(this,lH,!1),YL(this,hH,!1),YL(this,uH,null),YL(this,cH,"")}static get PLUGIN_KEY(){return JL}static get PLUGIN_PRIORITY(){return 60}static get DEFAULT_SETTINGS(){return{displayDelay:250}}isEnabled(){return!!this.hot.getSettings()[JL]}enablePlugin(){var e=this;this.enabled||(QL(sH,this)||(qL(sH,this,new RL(this.hot.rootDocument,this.hot.isRtl())),QL(sH,this).addLocalHook("resize",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return ZL(dH,e,SH).call(e,...n)}))),QL(aH,this)||qL(aH,this,new TL(this.getSetting("displayDelay"))),this.addHook("afterContextMenuDefaultOptions",(e=>this.addToContextMenu(e))),this.addHook("afterRenderer",((e,t,n,r,i,o)=>ZL(dH,this,yH).call(this,e,o))),this.addHook("afterScroll",(()=>ZL(dH,this,EH).call(this))),this.addHook("afterBeginEditing",(()=>this.hide())),this.addHook("afterDocumentKeyDown",(e=>ZL(dH,this,RH).call(this,e))),this.addHook("afterSetTheme",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return ZL(dH,e,bH).call(e,...n)})),QL(aH,this).addLocalHook("hide",(()=>this.hide())),QL(aH,this).addLocalHook("show",((e,t)=>this.showAtCell(e,t))),this.registerShortcuts(),this.registerListeners(),super.enablePlugin())}updatePlugin(){QL(aH,this).updateDelay(this.getSetting("displayDelay")),super.updatePlugin()}disablePlugin(){this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager(),t=e.getContext("grid"),n=e.addContext(oH);t.addShortcut({keys:[["Control","Alt","M"]],callback:()=>{const t=this.hot.getSelectedRangeLast();qL(hH,this,!0),this.hot.scrollToFocusedCell((()=>{this.setRange(t),this.show(),this.focusEditor(),e.setActiveContextName(oH),this.hot._registerTimeout((()=>{qL(hH,this,!1)}))}))},stopPropagation:!0,runOnlyIf:()=>{var e;return null===(e=this.hot.getSelectedRangeLast())||void 0===e?void 0:e.highlight.isCell()},group:iH}),n.addShortcut({keys:[["Escape"]],callback:()=>{QL(sH,this).setValue(QL(cH,this)),this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>QL(sH,this).isVisible()&&QL(sH,this).isFocused(),group:iH}),n.addShortcut({keys:[["Control/Meta","Enter"]],callback:()=>{this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>QL(sH,this).isVisible()&&QL(sH,this).isFocused(),group:iH}),n.addShortcut({keys:[["Shift","Tab"],["Tab"]],forwardToContext:e.getContext("grid"),callback:()=>{QL(sH,this).setValue(QL(sH,this).getValue()),this.hide(),e.setActiveContextName("grid")},group:iH})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(iH)}registerListeners(){const{rootDocument:e}=this.hot,t=this.getEditorInputElement();this.eventManager.addEventListener(e,"mouseover",(e=>ZL(dH,this,fH).call(this,e))),this.eventManager.addEventListener(e,"mousedown",(e=>ZL(dH,this,gH).call(this,e))),this.eventManager.addEventListener(e,"mouseup",(()=>ZL(dH,this,wH).call(this))),this.eventManager.addEventListener(t,"focus",(()=>ZL(dH,this,CH).call(this))),this.eventManager.addEventListener(t,"blur",(()=>ZL(dH,this,vH).call(this))),this.eventManager.addEventListener(this.getEditorInputElement(),"mousedown",(e=>ZL(dH,this,mH).call(this,e)))}setRange(e){this.range=e}clearRange(){this.range={}}targetIsCellWithComment(e){const t=Ep(e.target,"TD","TBODY");return!!(t&&Ip(t,"htCommentCell")&&Ep(t,[this.hot.rootElement]))}targetIsCommentTextArea(e){return this.getEditorInputElement()===e.target}setComment(e){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const t=QL(sH,this).getValue();let n="";null!=e?n=e:null!=t&&(n=t);const r=this.range.from.row,i=this.range.from.col;this.updateCommentMeta(r,i,{[tH]:n}),this.hot.render()}setCommentAtCell(e,t,n){this.setRange({from:this.hot._createCellCoords(e,t)}),this.setComment(n)}removeComment(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,eH),e&&this.hot.render(),this.hide()}removeCommentAtCell(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.setRange({from:this.hot._createCellCoords(e,t)}),this.removeComment(n)}getComment(){const e=this.range.from.row,t=this.range.from.col;return this.getCommentMeta(e,t,tH)}getCommentAtCell(e,t){return this.getCommentMeta(e,t,tH)}show(){var e;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const{from:{row:t,col:n}}=this.range;if(t<0||t>this.hot.countSourceRows()-1||n<0||n>this.hot.countSourceCols()-1)return!1;const r=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return QL(aH,this).cancelHiding(),QL(sH,this).setValue(null!==(e=r[eH]?r[eH][tH]:null)&&void 0!==e?e:""),QL(sH,this).show(),this.refreshEditor(!0),!0}showAtCell(e,t){return this.setRange({from:this.hot._createCellCoords(e,t)}),this.show()}hide(){QL(sH,this).hide()}refreshEditor(){if(!(arguments.length>0&&void 0!==arguments[0]&&arguments[0]||this.range.from&&QL(sH,this).isVisible()))return;const{rowIndexMapper:e,columnIndexMapper:t}=this.hot,{row:n,col:r}=this.range.from;let i=e.getRenderableFromVisualIndex(n),o=t.getRenderableFromVisualIndex(r);const s=null===i;QL(sH,this).setPosition(0,0),null===i&&(i=e.getRenderableFromVisualIndex(e.getNearestNotHiddenIndex(n,-1))),null===o&&(o=t.getRenderableFromVisualIndex(t.getNearestNotHiddenIndex(r,-1)));const a=null===i,l=null===o;i=null!=i?i:0,o=null!=o?o:0;const{rootWindow:h,view:{_wt:u}}=this.hot,{wtTable:c}=u,d=u.getCell({row:i,col:o},!0),p=this.getCommentMeta(n,r,nH);p?QL(sH,this).setSize(p.width,p.height):QL(sH,this).resetSize();const g=l?0:c.getColumnWidth(o),m=s&&!a?Xp(d):0,{left:f,top:w,width:y,height:v}=d.getBoundingClientRect(),{width:C,height:S}=QL(sH,this).getSize(),{innerWidth:R,innerHeight:E}=this.hot.rootWindow,b=this.hot.rootDocument.documentElement,T=ng(this.hot.rootDocument),N=rg(this.hot.rootWindow)?T:0,A=ig(this.hot.rootWindow)?T:0;let M=f+h.scrollX+g,I=w+h.scrollY+m;this.hot.isRtl()&&(M-=C+g),this.hot.isLtr()&&f+y+C>R-N?M=f+h.scrollX-C-1:this.hot.isRtl()&&M<-(b.scrollWidth-b.clientWidth)&&(M=f+h.scrollX+g+1),w+S>E-A&&(I-=S-v+1),QL(sH,this).setPosition(M,I),QL(sH,this).setReadOnlyState(this.getCommentMeta(n,r,rH)),QL(sH,this).observeSize()}focusEditor(){QL(sH,this).focus()}updateCommentMeta(e,t,n){const r=this.hot.getCellMeta(e,t)[eH];let i;r?(i=qg(r),Xg(i,n)):i=n,this.hot.setCellMeta(e,t,eH,i)}getCommentMeta(e,t,n){const r=this.hot.getCellMeta(e,t);if(r[eH])return r[eH][n]}addToContextMenu(e){var t;e.items.push({name:xL},(t=this,{key:"commentsAddEdit",name(){var e;const n=null===(e=this.getSelectedRangeLast())||void 0===e?void 0:e.highlight;return null!=n&&n.isCell()&&t.getCommentAtCell(n.row,n.col)?this.getTranslatedPhrase(Lb):this.getTranslatedPhrase(_b)},callback(){const e=this.getSelectedRangeLast();t.setRange(e),t.show(),t.focusEditor()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||0===this.countRenderedRows()||0===this.countRenderedCols())}}),function(e){return{key:"commentsRemove",name(){return this.getTranslatedPhrase(Hb)},callback(){this.getSelectedRangeLast().forAll(((t,n)=>{t>=0&&n>=0&&e.removeCommentAtCell(t,n,!1)})),this.render()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||0===this.countRenderedRows()||0===this.countRenderedCols())}}}(this),function(e){return{key:"commentsReadOnly",name(){const t=this.getTranslatedPhrase(kb);return IL(this.getSelectedRange(),((t,n)=>e.getCommentMeta(t,n,rH)))?ML(t):t},callback(){this.getSelectedRangeLast().forAll(((t,n)=>{if(t>=0&&n>=0){const r=!!e.getCommentMeta(t,n,rH);e.updateCommentMeta(t,n,{[rH]:!r})}}))},disabled(){const t=this.getSelectedRangeLast();return!!(!t||t.highlight.isHeader()||!e.getCommentAtCell(t.highlight.row,t.highlight.col)||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||0===this.countRenderedRows()||0===this.countRenderedCols())}}}(this))}getEditorInputElement(){return QL(sH,this).getInputElement()}destroy(){var e,t;null===(e=QL(sH,this))||void 0===e||e.destroy(),null===(t=QL(aH,this))||void 0===t||t.destroy(),super.destroy()}}function gH(e){if(this.hot.view&&this.hot.view._wt&&!QL(lH,this)&&!this.targetIsCommentTextArea(e)){const t=Ep(e.target,"TD","TBODY");let n=null;t&&(n=this.hot.getCoords(t)),(!t||this.range.from&&n&&(this.range.from.row!==n.row||this.range.from.col!==n.col))&&this.hide()}}function mH(e){e.stopPropagation()}function fH(e){const{rootDocument:t}=this.hot;if(!(QL(lH,this)||QL(sH,this).isFocused()||Ip(e.target,"wtBorder")||QL(uH,this)===e.target)&&QL(sH,this))if(qL(uH,this,t.elementFromPoint(e.clientX,e.clientY)),this.targetIsCellWithComment(e)){const t=this.hot._createCellRange(this.hot.getCoords(e.target));QL(aH,this).show(t)}else Tp(e.target,t)&&!this.targetIsCommentTextArea(e)&&QL(aH,this).hide()}function wH(){qL(lH,this,!1)}function yH(e,t){t[eH]&&t[eH][tH]&&Op(e,t.commentedCellClassName)}function vH(){qL(cH,this,""),this.hot.getShortcutManager().setActiveContextName("grid"),this.setComment()}function CH(){qL(cH,this,this.getComment()),this.hot.listen(),this.hot.getShortcutManager().setActiveContextName(oH)}function SH(e,t){this.updateCommentMeta(this.range.from.row,this.range.from.col,{[nH]:{width:e,height:t}})}function RH(e){QL(sH,this).isFocused()&&Nm(e)}function EH(){QL(hH,this)||this.hide()}function bH(){const e=QL(sH,this).getEditorElement();xp(e,/ht-theme-.*/g),Op(e,this.hot.getCurrentThemeName())}function TH(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class NH{constructor(e){TH(this,"hot",void 0),TH(this,"commands",{}),TH(this,"commonCallback",null),this.hot=e}registerCommand(e,t){this.commands[e]=t}setCommonCallback(e){this.commonCallback=e}execute(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const i=e.split(":"),o=i[0],s=2===i.length?i[1]:null;let a=this.commands[o];if(!a)throw new Error(`Menu command '${o}' not exists.`);if(s&&a.submenu&&(a=function(e,t){let n;return Vd(t,(t=>{const r=t.key?t.key.split(":"):null;if(Array.isArray(r)&&r[1]===e)return n=t,!1})),n}(s,a.submenu.items)),!0===a.disabled)return;if("function"==typeof a.disabled&&!0===a.disabled.call(this.hot))return;if(sm(a,"submenu"))return;const l=[];"function"==typeof a.callback&&l.push(a.callback),"function"==typeof this.commonCallback&&l.push(this.commonCallback),n.unshift(i.join(":")),Vd(l,(e=>e.apply(this.hot,n)))}}function AH(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class MH{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;AH(this,"hot",void 0),AH(this,"predefinedItems",$L()),AH(this,"defaultOrderPattern",void 0),this.hot=e,this.defaultOrderPattern=t}setPredefinedItems(e){const t={};this.defaultOrderPattern.length=0,nm(e,((e,n)=>{let r="";e.name===xL?(t[xL]=e,r=xL):isNaN(parseInt(n,10))?(e.key=void 0===e.key?n:e.key,t[n]=e,r=e.key):(t[e.key]=e,r=e.key),this.defaultOrderPattern.push(r)})),this.predefinedItems=t}getItems(){return function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=[];let i=e;i&&i.items?i=i.items:Array.isArray(i)||(i=t);em(i)?nm(i,((e,t)=>{let i=n["string"==typeof e?e:t];i||(i=e),em(e)?Kg(i,e):"string"==typeof i&&(i={name:i}),void 0===i.key&&(i.key=t),r.push(i)})):Vd(i,((e,t)=>{let i=n[e];!i&&GL.indexOf(e)>=0||(i||(i={name:e,key:`${t}`}),em(e)&&Kg(i,e),void 0===i.key&&(i.key=t),r.push(i))}));return r}(arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,this.defaultOrderPattern,this.predefinedItems)}}function IH(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class OH{constructor(e,t){IH(this,"top",void 0),IH(this,"topRelative",void 0),IH(this,"left",void 0),IH(this,"leftRelative",void 0),IH(this,"scrollTop",void 0),IH(this,"scrollLeft",void 0),IH(this,"cellHeight",void 0),IH(this,"cellWidth",void 0);const n=t.scrollY,r=t.scrollX;let i,o,s,a,l,h;this.rootWindow=t,this.type=this.getSourceType(e),"literal"===this.type?(i=parseInt(e.top,10),s=parseInt(e.left,10),l=e.height||0,h=e.width||0,o=i,a=s,i+=n,s+=r):"event"===this.type&&(i=parseInt(e.pageY,10),s=parseInt(e.pageX,10),l=e.target.clientHeight,h=e.target.clientWidth,o=i-n,a=s-r),this.top=i,this.topRelative=o,this.left=s,this.leftRelative=a,this.scrollTop=n,this.scrollLeft=r,this.cellHeight=l,this.cellWidth=h}getSourceType(e){let t="literal";return e instanceof Event&&(t="event"),t}fitsAbove(e){return this.topRelative>=e.offsetHeight}fitsBelow(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+e.offsetHeight<=t}fitsOnRight(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+e.offsetWidth<=t}fitsOnLeft(e){return this.leftRelative>=e.offsetWidth}}function xH(e,t,n){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,n)}function PH(e,t){return e.get(LH(e,t))}function _H(e,t,n){return e.set(LH(e,t),n),n}function LH(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var HH=new WeakMap,kH=new WeakMap,FH=new WeakMap,DH=new WeakMap,VH=new WeakMap;class UH{constructor(e){xH(this,HH,void 0),xH(this,kH,void 0),xH(this,FH,void 0),xH(this,DH,!1),xH(this,VH,{above:0,below:0,left:0,right:0}),_H(DH,this,e)}setOffset(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return PH(VH,this)[e]=t,this}setElement(e){return _H(HH,this,e),this}setParentElement(e){return _H(kH,this,e),this}updatePosition(e){_H(FH,this,new OH(e,PH(HH,this).ownerDocument.defaultView)),PH(DH,this)?(PH(FH,this).fitsBelow(PH(HH,this))?this.setPositionBelowCursor():PH(FH,this).fitsAbove(PH(HH,this))?this.setPositionAboveCursor():this.setPositionBelowCursor(),this.updateHorizontalPosition()):(this.setPositionBelowCursor(),this.setPositionOnRightOfCursor())}updateHorizontalPosition(){"rtl"===PH(HH,this).dir?PH(FH,this).fitsOnLeft(PH(HH,this))?this.setPositionOnLeftOfCursor():this.setPositionOnRightOfCursor():PH(FH,this).fitsOnRight(PH(HH,this))?this.setPositionOnRightOfCursor():this.setPositionOnLeftOfCursor()}setPositionAboveCursor(){let e=PH(VH,this).above+PH(FH,this).top-PH(HH,this).offsetHeight;PH(kH,this)&&(e=PH(FH,this).top+PH(FH,this).cellHeight-PH(HH,this).offsetHeight+3),PH(HH,this).style.top=`${e}px`}setPositionBelowCursor(){let e=PH(VH,this).below+PH(FH,this).top+1;PH(kH,this)&&(e=PH(FH,this).top-1),PH(HH,this).style.top=`${e}px`}setPositionOnRightOfCursor(){let e=PH(FH,this).left;if(PH(kH,this)){const t=PH(kH,this).ownerDocument.defaultView,n=Number.parseInt(t.getComputedStyle(PH(kH,this).querySelector(".htCore")).borderRightWidth,10);e+=PH(FH,this).cellWidth+n}else e+=PH(VH,this).right;PH(HH,this).style.left=`${e}px`}setPositionOnLeftOfCursor(){let e=PH(VH,this).left+PH(FH,this).left-PH(HH,this).offsetWidth;if(PH(kH,this)){const t=PH(kH,this).ownerDocument.defaultView;e-=Number.parseInt(t.getComputedStyle(PH(kH,this).querySelector(".htCore")).borderLeftWidth,10)}PH(HH,this).style.left=`${e}px`}}function BH(e){let{initialPage:t=-1,size:n=()=>0,onItemSelect:r=()=>{},onClear:i=()=>{}}=e;const o=new Set;let s=Xw(t,-1,l()-1);function a(e,t){const n=l()-1;if(e<0&&(e=n),e>n&&(e=0),o.has(e))return-1;o.add(e);return!1===r(e,!1)&&(e=a(1===t?++e:--e,t)),e}function l(){return Math.max(n(),0)}return{setCurrentPage:function(e){e>-1&&e<l()&&!1!==r(e,!0)&&(s=e)},getCurrentPage:function(){return s},toFirstItem:function(){l()>0&&(o.clear(),s=a(0,1))},toLastItem:function(){l()>0&&(o.clear(),s=a(l()-1,-1))},toNextItem:function(){l()>0&&(o.clear(),s=a(++s,1))},toPreviousItem:function(){l()>0&&(o.clear(),s=a(--s,-1))},getSize:l,clear:function(){o.clear(),s=t,i()}}}function WH(e){return sm(e,"submenu")}function jH(e){return new RegExp(xL,"i").test(e.name)}function GH(e,t){return!0===e.disabled||"function"==typeof e.disabled&&!0===e.disabled.call(t)}function zH(e){return sm(e,"disableSelection")}function $H(e,t){const n=e.slice(0);for(let r=0;r<n.length&&n[r].name===t;)n.shift();return n}function YH(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:xL,n=e.slice(0);return n=$H(n,t),n=function(e,t){let n=e.slice(0);return n.reverse(),n=$H(n,t),n.reverse(),n}(n,t),n=function(e){const t=[];return Vd(e,((e,n)=>{n>0?t[t.length-1].name!==e.name&&t.push(e):t.push(e)})),t}(n),n}function KH(e){return BH({size:()=>e.countRows(),onItemSelect(t,n){const r=e.getCell(t,0);if(!r||function(e){return Ip(e,"htSeparator")}(r)||function(e){return Ip(e,"htDisabled")}(r)||function(e){return Ip(e,"htSelectionDisabled")}(r))return!1;e.selectCell(t,0,...n?[t,0,!1,!1]:[])},onClear(){e.deselectCell()}})}const XH="menu",qH=XH;function QH(e,t,n){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,n)}function ZH(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function JH(e,t,n){return e.set(tk(e,t),n),n}function ek(e,t){return e.get(tk(e,t))}function tk(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var nk=new WeakMap,rk=new WeakMap,ik=new WeakMap;class ok{get tableBorderWidth(){return void 0===ek(ik,this)&&this.hotMenu&&JH(ik,this,parseInt(this.hotMenu.rootWindow.getComputedStyle(this.hotMenu.view._wt.wtTable.TABLE).borderWidth,10)),ek(ik,this)}constructor(e,t){var n=this;ZH(this,"hot",void 0),ZH(this,"options",void 0),ZH(this,"eventManager",new Of(this)),ZH(this,"container",void 0),ZH(this,"positioner",void 0),ZH(this,"hotMenu",null),ZH(this,"hotSubMenus",{}),ZH(this,"parentMenu",void 0),ZH(this,"menuItems",null),ZH(this,"origOutsideClickDeselects",null),QH(this,nk,void 0),QH(this,rk,void 0),QH(this,ik,void 0),this.hot=e,this.options=t||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:215,container:this.hot.rootDocument.documentElement},this.container=this.createContainer(this.options.name),this.positioner=new UH(this.options.keepInViewport),this.parentMenu=this.options.parent||null,this.registerEvents(),this.isSubMenu()&&this.addLocalHook("afterSelectionChange",(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.parentMenu.runLocalHooks("afterSelectionChange",...t)})),this.hot.addHook("afterSetTheme",((e,t)=>{var n;t||(null===(n=this.hotMenu)||void 0===n||n.useTheme(e))}))}registerEvents(){let e=this.hot.rootWindow;for(;e;)this.eventManager.addEventListener(e.document,"mousedown",(e=>this.onDocumentMouseDown(e))),this.eventManager.addEventListener(e.document,"touchstart",(e=>this.onDocumentMouseDown(e))),this.eventManager.addEventListener(e.document,"contextmenu",(e=>this.onDocumentContextMenu(e))),e=Rp(e)}setMenuItems(e){this.menuItems=e}getNavigator(){return ek(nk,this)}getKeyboardShortcutsCtrl(){return ek(rk,this)}getSelectedItem(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}hasSelectedItem(){return Array.isArray(this.hotMenu.getSelectedLast())}isSubMenu(){return null!==this.parentMenu}open(){this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";const e=gg((e=>this.openSubMenu(e)),300),t=this.options.minWidth||215;let n=!1,r=Fd(this.menuItems,(e=>(e.key===WL&&(n=!0),function(e,t){return!e.hidden||!("function"==typeof e.hidden&&e.hidden.call(t))}(e,this.hot))));if(r.length<1&&!n)r.push($L()[WL]);else if(0===r.length)return;r=YH(r,xL);let i=!1;const o={data:r,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth:e=>Gd(e)&&e<t?t:e,autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,hiddenRows:!0,maxCols:1,columns:[{data:"name",renderer:(s=this.hot,(e,t,n,r,i,o)=>{const a=e.getSourceDataAtRow(n),l=s.rootDocument.createElement("div"),h="function"==typeof o?o.call(s):o,u="function"==typeof a.ariaLabel?a.ariaLabel.call(s):a.ariaLabel,c="function"==typeof a.ariaChecked?a.ariaChecked.call(s):a.ariaChecked;if(Hp(t),Op(l,"htItemWrapper"),s.getSettings().ariaTags){const e=!GH(a,s)&&!zH(a)&&!jH(a);Pp(t,[...(d=a,!0===d.checkable?[["role","menuitemcheckbox"],up(u),wp(c)]:[["role","menuitem"],up(h)]),...e?[hp(-1)]:[],...GH(a,s)?[["aria-disabled","true"]]:[],...WH(a)?[fp(!1)]:[]])}var d;t.className="",t.appendChild(l),jH(a)?Op(t,"htSeparator"):"function"==typeof a.renderer?(Op(t,"htCustomMenuRenderer"),t.appendChild(a.renderer(e,l,n,r,i,h))):Fp(l,h),GH(a,s)?Op(t,"htDisabled"):zH(a)?Op(t,"htSelectionDisabled"):WH(a)&&Op(t,"htSubmenu")})}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",ariaTags:!1,themeName:this.hot.getCurrentThemeName(),beforeOnCellMouseOver:(e,t)=>{ek(nk,this).setCurrentPage(t.row)},afterOnCellMouseOver:(t,n)=>{this.isAllSubMenusClosed()?e(n.row):this.openSubMenu(n.row)},afterOnCellContextMenu:e=>{e.preventDefault(),Cm()&&i&&this.hasSelectedItem()&&this.close(!0)},afterSelection:(e,t,n,r,i)=>{this.hotMenu.view.isMouseDown()&&(i.value=!0),this.runLocalHooks("afterSelectionChange",this.getSelectedItem())},beforeOnCellMouseUp:e=>{this.hasSelectedItem()&&(i=!this.isCommandPassive(this.getSelectedItem()),this.executeCommand(e))},afterOnCellMouseUp:e=>{Cm()&&Mm(e)||!i||!this.hasSelectedItem()||(wm()||vm()?this.hot._registerTimeout((()=>this.close(!0)),325):this.close(!0))},afterUnlisten:()=>{!this.hasSelectedItem()&&this.isOpened()&&this.hotMenu.listen()}};var s;this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new this.hot.constructor(this.container,o),this.hotMenu.addHook("afterInit",(()=>this.onAfterInit())),this.hotMenu.init(),JH(nk,this,KH(this.hotMenu)),JH(rk,this,function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];const n=[];function r(e,t){s(t).addShortcuts(e,{group:XH})}function i(e,t){const i=s(t);e.forEach((e=>{let{keys:t}=e;t.forEach((e=>i.removeShortcutsByKeys(e)))})),n.push({shortcuts:e,contextName:t}),r(e,t)}function o(e){return e?`${qH}:${e}`:qH}function s(t){var n;const r=e.hotMenu.getShortcutManager(),i=o(t);return null!==(n=r.getContext(i))&&void 0!==n?n:r.addContext(i)}return r(function(e){const{hot:t,hotMenu:n}=e;return[{keys:[["Control/Meta","A"]],forwardToContext:t.getShortcutManager().getContext("grid"),callback:()=>e.close(!0)},{keys:[["Tab"],["Shift","Tab"]],callback:(n,r)=>{const i=t.getSettings(),o="function"==typeof i.tabMoves?i.tabMoves(n):i.tabMoves;r.includes("shift")?t.selection.transformStart(-o.row,-o.col):t.selection.transformStart(o.row,o.col),e.close(!0)}},{keys:[["Escape"]],callback:()=>e.close()},{keys:[["ArrowDown"]],callback:()=>e.getNavigator().toNextItem()},{keys:[["ArrowUp"]],callback:()=>e.getNavigator().toPreviousItem()},{keys:[["ArrowRight"]],callback:()=>{const t=n.getSelectedLast();if(t){const n=e.openSubMenu(t[0]);n&&n.getNavigator().toFirstItem()}}},{keys:[["ArrowLeft"]],callback:()=>{n.getSelectedLast()&&e.isSubMenu()&&(e.close(),e.isSubMenu()&&e.parentMenu.hotMenu.listen())}},{keys:[["Control/Meta","ArrowUp"],["Home"]],callback:()=>e.getNavigator().toFirstItem()},{keys:[["Control/Meta","ArrowDown"],["End"]],callback:()=>e.getNavigator().toLastItem()},{keys:[["Enter"],["Space"]],callback:t=>{const r=n.getSelectedLast();r&&(n.getSourceDataAtRow(r[0]).submenu?e.openSubMenu(r[0]).getNavigator().toFirstItem():(e.executeCommand(t),e.close(!0)))}},{keys:[["PageUp"]],callback:()=>{n.getSelectedLast()?n.selection.transformStart(-n.countVisibleRows(),0):e.getNavigator().toFirstItem()}},{keys:[["PageDown"]],callback:()=>{n.getSelectedLast()?n.selection.transformStart(n.countVisibleRows(),0):e.getNavigator().toLastItem()}}]}(e)),t.forEach((e=>{let{shortcuts:t,contextName:n}=e;i(t,n)})),{addCustomShortcuts:i,getCustomShortcuts:function(){return[...n]},getContext:s,listen:function(t){e.hotMenu.getShortcutManager().setActiveContextName(o(t))}}}(this)),ek(rk,this).listen(),this.focus(),this.isSubMenu()&&this.addLocalHook("afterOpen",(()=>this.parentMenu.runLocalHooks("afterSubmenuOpen",this))),this.runLocalHooks("afterOpen",this)}close(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.isOpened())if(e&&this.isSubMenu())this.parentMenu.close();else if(ek(nk,this).clear(),this.closeAllSubMenus(),this.container.style.display="none",this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.isSubMenu()){if(this.hot.getSettings().ariaTags){const e=this.parentMenu.hotMenu.getSelectedLast();if(e){Pp(this.parentMenu.hotMenu.getCell(e[0],0),[fp(!1)])}}this.parentMenu.hotMenu.listen()}}openSubMenu(e){if(!this.hotMenu)return!1;const t=this.hotMenu.getCell(e,0);if(this.closeAllSubMenus(),!t||!function(e){return Ip(e,"htSubmenu")}(t))return!1;const n=this.hotMenu.getSourceDataAtRow(e),r=new ok(this.hot,{parent:this,name:n.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return r.setMenuItems(n.submenu.items),r.open(),r.setPosition(t.getBoundingClientRect()),this.hotSubMenus[n.key]=r,this.hot.getSettings().ariaTags&&Pp(t,[fp(!0)]),r}closeSubMenu(e){const t=this.hotMenu.getSourceDataAtRow(e),n=this.hotSubMenus[t.key];if(n){n.destroy(),delete this.hotSubMenus[t.key];const r=this.hotMenu.getCell(e,0);this.hot.getSettings().ariaTags&&Pp(r,[fp(!1)])}}closeAllSubMenus(){Vd(this.hotMenu.getData(),((e,t)=>this.closeSubMenu(t)))}isAllSubMenusClosed(){return 0===Object.keys(this.hotSubMenus).length}focus(){this.isOpened()&&(this.hotMenu.rootElement.focus({preventScroll:!0}),this.getKeyboardShortcutsCtrl().listen(),this.hotMenu.listen())}destroy(){const e=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),e&&e.removeChild(this.container)}isOpened(){return null!==this.hotMenu}executeCommand(e){if(!this.isOpened()||!this.hasSelectedItem())return;const t=this.getSelectedItem();if(this.runLocalHooks("select",t,e),this.isCommandPassive(t))return;const n=this.hot.getSelectedRange(),r=n?function(e){return Dd(e,(e=>({start:e.getTopStartCorner(),end:e.getBottomEndCorner()})))}(n):[];this.runLocalHooks("executeCommand",t.key,r,e),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",t.key,r,e)}isCommandPassive(e){return!1===e.isCommand||jH(e)||GH(e,this.hot)||WH(e)}setOffset(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.positioner.setOffset(e,t)}setPosition(e){this.isSubMenu()&&this.positioner.setParentElement(this.parentMenu.container),this.positioner.setElement(this.container).updatePosition(e)}updateMenuDimensions(){const e=this.hotMenu.view.getStylesHandler(),{wtTable:t}=this.hotMenu.view._wt,n=this.hotMenu.getSettings().data,r=t.hider.style,i=t.holder.style,o=parseInt(r.width,10),s=kd(n,((e,t,n)=>{const r=this.hotMenu.getCell(n,0)?Xp(this.hotMenu.getCell(n,0)):0;return e+(t.name===xL?1:r)}),0);e.isClassicTheme()?(i.width=`${o+3}px`,i.height=`${s+3}px`):(i.width=`${o}px`,i.height=`${s}px`),r.height=i.height}createContainer(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;const t=this.options.container.ownerDocument;let n,r=e;return r&&(pg(r)&&(r=r.call(this.hot),r=null===r||zd(r)?"":r.toString()),r=r.replace(/[^A-Za-z0-9]/g,"_"),r=`${this.options.className}Sub_${r}`,n=t.querySelector(`.${this.options.className}.${r}`)),n||(n=t.createElement("div"),Op(n,`htMenu handsontable ${this.options.className}`),r&&Op(n,r),this.options.container.appendChild(n)),n}onAfterInit(){this.updateMenuDimensions(),this.hot.getSettings().ariaTags&&Pp(this.hotMenu.rootElement,[["role","menu"],hp(-1)])}onDocumentMouseDown(e){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!Tp(e.target,this.hotMenu.rootElement)?this.close(!0):!this.isAllSubMenusClosed()&&!this.isSubMenu()||Tp(e.target,".htMenu")||this.close(!0))}onDocumentContextMenu(e){this.isOpened()&&Ip(e.target,"htCore")&&Tp(e.target,this.hotMenu.rootElement)&&e.preventDefault()}}function sk(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function ak(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function lk(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}Zg(ok,cS);const hk="contextMenu",uk=hk;mf.getSingleton().register("afterContextMenuDefaultOptions"),mf.getSingleton().register("beforeContextMenuShow"),mf.getSingleton().register("afterContextMenuShow"),mf.getSingleton().register("afterContextMenuHide"),mf.getSingleton().register("afterContextMenuExecute");var ck=new WeakSet;class dk extends Tx{constructor(){super(...arguments),sk(this,ck),ak(this,"commandExecutor",new NH(this.hot)),ak(this,"itemsFactory",null),ak(this,"menu",null)}static get PLUGIN_KEY(){return hk}static get PLUGIN_PRIORITY(){return 70}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[UL,BL,xL,LL,HL,xL,VL,DL,xL,jL,FL,xL,kL,xL,PL]}isEnabled(){return!!this.hot.getSettings()[hk]}enablePlugin(){var e=this;if(this.enabled)return;const t=this.hot.getSettings()[hk];"function"==typeof t.callback&&this.commandExecutor.setCommonCallback(t.callback),this.menu=new ok(this.hot,{className:"htContextMenu",keepInViewport:!0,container:t.uiContainer||this.hot.rootDocument.body}),this.menu.addLocalHook("beforeOpen",(()=>lk(ck,this,gk).call(this))),this.menu.addLocalHook("afterOpen",(()=>lk(ck,this,mk).call(this))),this.menu.addLocalHook("afterClose",(()=>lk(ck,this,fk).call(this))),this.menu.addLocalHook("executeCommand",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.executeCommand.call(e,...n)})),this.addHook("afterOnCellContextMenu",(e=>lk(ck,this,pk).call(this,e))),this.registerShortcuts(),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control/Meta","Shift","Backslash"],["Shift","F10"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();this.hot.scrollToFocusedCell();const t=this.hot.getCell(e.row,e.col,!0).getBoundingClientRect(),n=OL(this.menu.container,this.hot.rootDocument);this.open({left:t.left+n.left,top:t.top+n.top-1+t.height},{left:t.width,above:-t.height}),this.menu.getNavigator().toFirstItem()},runOnlyIf:()=>{var e;const t=null===(e=this.hot.getSelectedRangeLast())||void 0===e?void 0:e.highlight;return t&&this.hot.selection.isCellVisible(t)&&!this.menu.isOpened()},group:uk})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(uk)}open(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{above:0,below:0,left:0,right:0};if(null!==(t=this.menu)&&void 0!==t&&t.isOpened())return;this.prepareMenuItems(),this.menu.open();const r=this.menu.tableBorderWidth>0;nm(n,((e,t)=>{const n=["below","right"].includes(t)?e+1:e-1;this.menu.setOffset(t,r?e:n)})),this.menu.setPosition(e)}close(){var e;null===(e=this.menu)||void 0===e||e.close(),this.itemsFactory=null}executeCommand(e){null===this.itemsFactory&&this.prepareMenuItems();for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];this.commandExecutor.execute(e,...n)}prepareMenuItems(){this.itemsFactory=new MH(this.hot,dk.DEFAULT_ITEMS);const e=this.hot.getSettings()[hk],t={items:this.itemsFactory.getItems(e)};this.hot.runHooks("afterContextMenuDefaultOptions",t),this.itemsFactory.setPredefinedItems(t.items);const n=this.itemsFactory.getItems(e);this.hot.runHooks("beforeContextMenuSetItems",n),this.menu.setMenuItems(n),Vd(n,(e=>this.commandExecutor.registerCommand(e.key,e)))}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function pk(e){const t=this.hot.getSettings(),n=t.rowHeaders,r=t.colHeaders;const i=e.target;if(this.close(),Ip(i,"handsontableInput"))return;if(e.preventDefault(),e.stopPropagation(),!n&&!r&&!(function(e){return"TD"===e.nodeName||"TD"===e.parentNode.nodeName}(i)||Ip(i,"current")&&Ip(i,"wtBorder")))return;const o=OL(this.menu.container,this.hot.rootDocument);this.open({top:e.clientY+o.top,left:e.clientX+o.left})}function gk(){this.hot.runHooks("beforeContextMenuShow",this)}function mk(){this.hot.runHooks("afterContextMenuShow",this)}function fk(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}dk.SEPARATOR={name:xL};class wk{constructor(){this.data={}}setData(e,t){this.data[e]=t}getData(e){return this.data[e]||void 0}}class yk{constructor(){this.clipboardData=new wk}preventDefault(){}}function vk(e,t,n){Ck(e,t),t.set(e,n)}function Ck(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Sk(e,t){return e.get(Ek(e,t))}function Rk(e,t,n){return e.set(Ek(e,t),n),n}function Ek(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var bk=new WeakMap,Tk=new WeakMap,Nk=new WeakMap,Ak=new WeakMap,Mk=new WeakMap,Ik=new WeakMap,Ok=new WeakSet;class xk{constructor(e){let{countRows:t,countColumns:n,rowsLimit:r,columnsLimit:i,countColumnHeaders:o}=e;var s,a;Ck(s=this,a=Ok),a.add(s),vk(this,bk,void 0),vk(this,Tk,void 0),vk(this,Nk,void 0),vk(this,Ak,void 0),vk(this,Mk,void 0),vk(this,Ik,void 0),Rk(Tk,this,t),Rk(Nk,this,n),Rk(Ak,this,r),Rk(Mk,this,i),Rk(Ik,this,o)}setSelectedRange(e){Rk(bk,this,e)}getCellsRange(){if(0===Sk(Tk,this).call(this)||0===Sk(Nk,this).call(this))return null;const{row:e,col:t}=Sk(bk,this).getTopStartCorner(),{row:n,col:r}=Sk(bk,this).getBottomEndCorner(),i=Ek(Ok,this,_k).call(this,e,n),o=Ek(Ok,this,Pk).call(this,t,r);return{isRangeTrimmed:n!==i||r!==o,startRow:e,startCol:t,endRow:i,endCol:o}}getMostBottomColumnHeadersRange(){if(0===Sk(Nk,this).call(this)||0===Sk(Ik,this).call(this))return null;const{col:e}=Sk(bk,this).getTopStartCorner(),{col:t}=Sk(bk,this).getBottomEndCorner(),n=Ek(Ok,this,Pk).call(this,e,t);return{isRangeTrimmed:t!==n,startRow:-1,startCol:e,endRow:-1,endCol:n}}getAllColumnHeadersRange(){if(0===Sk(Nk,this).call(this)||0===Sk(Ik,this).call(this))return null;const{col:e}=Sk(bk,this).getTopStartCorner(),{col:t}=Sk(bk,this).getBottomEndCorner(),n=Ek(Ok,this,Pk).call(this,e,t);return{isRangeTrimmed:t!==n,startRow:-Sk(Ik,this).call(this),startCol:e,endRow:-1,endCol:n}}}function Pk(e,t){return Math.min(t,Math.max(e+Sk(Mk,this).call(this)-1,e))}function _k(e,t){return Math.min(t,Math.max(e+Sk(Ak,this).call(this)-1,e))}function Lk(e){const t=[],n=[];return Vd(e,(e=>{$w(Math.min(e.startRow,e.endRow),Math.max(e.startRow,e.endRow),(e=>{-1===t.indexOf(e)&&t.push(e)}));$w(Math.min(e.startCol,e.endCol),Math.max(e.startCol,e.endCol),(e=>{-1===n.indexOf(e)&&n.push(e)}))})),{rows:t,columns:n}}function Hk(e,t,n){kk(e,t),t.set(e,n)}function kk(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Fk(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Dk(e,t){return e.get(Uk(e,t))}function Vk(e,t,n){return e.set(Uk(e,t),n),n}function Uk(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}mf.getSingleton().register("afterCopyLimit"),mf.getSingleton().register("modifyCopyableRange"),mf.getSingleton().register("beforeCut"),mf.getSingleton().register("afterCut"),mf.getSingleton().register("beforePaste"),mf.getSingleton().register("afterPaste"),mf.getSingleton().register("beforeCopy"),mf.getSingleton().register("afterCopy");const Bk="copyPaste",Wk=["fragmentSelection"],jk=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join("");var Gk=new WeakMap,zk=new WeakMap,$k=new WeakMap,Yk=new WeakMap,Kk=new WeakMap,Xk=new WeakMap,qk=new WeakMap,Qk=new WeakMap,Zk=new WeakSet;class Jk extends Tx{constructor(){var e,t;super(...arguments),kk(e=this,t=Zk),t.add(e),Fk(this,"columnsLimit",1/0),Fk(this,"rowsLimit",1/0),Fk(this,"pasteMode","overwrite"),Fk(this,"uiContainer",this.hot.rootDocument.body),Hk(this,Gk,!1),Hk(this,zk,!1),Hk(this,$k,!1),Hk(this,Yk,"cells-only"),Hk(this,Kk,!1),Hk(this,Xk,!1),Hk(this,qk,new xk({countRows:()=>this.hot.countRows(),countColumns:()=>this.hot.countCols(),rowsLimit:()=>this.rowsLimit,columnsLimit:()=>this.columnsLimit,countColumnHeaders:()=>this.hot.view.getColumnHeadersCount()})),Hk(this,Qk,!1),Fk(this,"copyableRanges",[])}static get PLUGIN_KEY(){return Bk}static get SETTING_KEYS(){return[Bk,...Wk]}static get PLUGIN_PRIORITY(){return 80}static get DEFAULT_SETTINGS(){return{pasteMode:"overwrite",rowsLimit:1/0,columnsLimit:1/0,copyColumnHeaders:!1,copyColumnGroupHeaders:!1,copyColumnHeadersOnly:!1}}isEnabled(){return!!this.hot.getSettings()[Bk]}enablePlugin(){var e,t,n=this;this.enabled||(this.pasteMode=null!==(e=this.getSetting("pasteMode"))&&void 0!==e?e:this.pasteMode,this.rowsLimit=isNaN(this.getSetting("rowsLimit"))?this.rowsLimit:this.getSetting("rowsLimit"),this.columnsLimit=isNaN(this.getSetting("columnsLimit"))?this.columnsLimit:this.getSetting("columnsLimit"),Vk(Gk,this,this.getSetting("copyColumnHeaders")),Vk(zk,this,this.getSetting("copyColumnGroupHeaders")),Vk($k,this,this.getSetting("copyColumnHeadersOnly")),this.uiContainer=null!==(t=this.getSetting("uiContainer"))&&void 0!==t?t:this.uiContainer,this.addHook("afterContextMenuDefaultOptions",(e=>Uk(Zk,this,iF).call(this,e))),this.addHook("afterSelection",(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return Uk(Zk,n,oF).call(n,...t)})),this.addHook("afterSelectionEnd",(()=>Uk(Zk,this,sF).call(this))),this.eventManager.addEventListener(this.hot.rootDocument,"copy",(function(){return n.onCopy(...arguments)})),this.eventManager.addEventListener(this.hot.rootDocument,"cut",(function(){return n.onCut(...arguments)})),this.eventManager.addEventListener(this.hot.rootDocument,"paste",(function(){return n.onPaste(...arguments)})),fm()&&(this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseenter",(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return Uk(Zk,n,aF).call(n,...t)})),this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseleave",(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return Uk(Zk,n,lF).call(n,...t)})),this.addHook("afterSelection",(()=>Uk(Zk,this,hF).call(this)))),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin()}copy(){Vk(Yk,this,arguments.length>0&&void 0!==arguments[0]?arguments[0]:"cells-only"),Vk(Kk,this,!0),Uk(Zk,this,eF).call(this,"copy")}copyCellsOnly(){this.copy("cells-only")}copyColumnHeadersOnly(){this.copy("column-headers-only")}copyWithAllColumnHeaders(){this.copy("with-column-group-headers")}copyWithColumnHeaders(){this.copy("with-column-headers")}cut(){Vk(Xk,this,!0),Uk(Zk,this,eF).call(this,"cut")}getRangedCopyableData(e){return nA(this.getRangedData(e))}getRangedData(e){const t=[],{rows:n,columns:r}=Lk(e);return Vd(n,(e=>{const n=[];Vd(r,(t=>{e<0?n.push(this.hot.getColHeader(t,e)):n.push(this.hot.getCopyableData(e,t))})),t.push(n)})),t}paste(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;if(!e&&!t)return;const n=new yk;e&&n.clipboardData.setData("text/plain",e),t&&n.clipboardData.setData("text/html",t),this.onPaste(n)}setCopyableText(){const e=this.hot.getSelectedRangeLast();if(!e)return;if(e.isSingleHeader())return void(this.copyableRanges=[]);Dk(qk,this).setSelectedRange(e);const t=new Map([["headers",null],["cells",null]]);"column-headers-only"===Dk(Yk,this)?t.set("headers",Dk(qk,this).getMostBottomColumnHeadersRange()):("with-column-headers"===Dk(Yk,this)?t.set("headers",Dk(qk,this).getMostBottomColumnHeadersRange()):"with-column-group-headers"===Dk(Yk,this)&&t.set("headers",Dk(qk,this).getAllColumnHeadersRange()),t.set("cells",Dk(qk,this).getCellsRange())),this.copyableRanges=Array.from(t.values()).filter((e=>null!==e)).map((e=>{let{startRow:t,startCol:n,endRow:r,endCol:i}=e;return{startRow:t,startCol:n,endRow:r,endCol:i}})),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);const n=t.get("cells");if(null!==n&&n.isRangeTrimmed){const{startRow:e,startCol:t,endRow:r,endCol:i}=n;this.hot.runHooks("afterCopyLimit",r-e+1,i-t+1,this.rowsLimit,this.columnsLimit)}}isEditorOpened(){var e;return null===(e=this.hot.getActiveEditor())||void 0===e?void 0:e.isOpened()}populateValues(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.hot.getSelectedRangeLast();if(!e.length)return;const n=e.length,r=e[0].length,i=[],{row:o,col:s}=t.getTopStartCorner(),{row:a,col:l}=t.getBottomEndCorner();let h=o,u=s,c=o,d=s;for(;i.length<n||h<=a;){const{skipRowOnPaste:t,visualRow:a}=this.hot.getCellMeta(h,s);if(h=a+1,!0===t)continue;c=a,u=s;const p=[],g=i.length%n;for(;p.length<r||u<=l;){const{skipColumnOnPaste:t,visualCol:n}=this.hot.getCellMeta(o,u);if(u=n+1,!0===t)continue;d=n;const i=p.length%r;p.push(e[g][i])}i.push(p)}return Vk(Qk,this,!0),this.hot.populateFromArray(o,s,i,void 0,void 0,"CopyPaste.paste",this.pasteMode),[o,s,c,d]}onCopy(e){var t;const n=this.hot.getFocusManager().getRefocusElement(),r=null===(t=e.target)||void 0===t?void 0:t.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!Dk(Kk,this)||this.isEditorOpened()||dg(e.target)&&(r&&e.target!==n||!r&&e.target!==this.hot.rootDocument.body&&!Sp(e.target,this.hot.rootElement)))return;e.preventDefault(),this.setCopyableText(),Vk(Kk,this,!1);const i=this.getRangedData(this.copyableRanges),o=Uk(Zk,this,tF).call(this,this.copyableRanges);if(!!this.hot.runHooks("beforeCopy",i,this.copyableRanges,o)){const t=nA(i);if(e&&e.clipboardData){const n=Gw(i,this.hot.rootDocument);e.clipboardData.setData("text/plain",t),e.clipboardData.setData("text/html",[jk,n].join(""))}else"undefined"==typeof ClipboardEvent&&this.hot.rootWindow.clipboardData.setData("Text",t);this.hot.runHooks("afterCopy",i,this.copyableRanges,o)}Vk(Yk,this,"cells-only")}onCut(e){var t;const n=this.hot.getFocusManager().getRefocusElement(),r=null===(t=e.target)||void 0===t?void 0:t.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!Dk(Xk,this)||this.isEditorOpened()||dg(e.target)&&(r&&e.target!==n||!r&&e.target!==this.hot.rootDocument.body&&!Sp(e.target,this.hot.rootElement)))return;e.preventDefault(),this.setCopyableText(),Vk(Xk,this,!1);const i=this.getRangedData(this.copyableRanges);if(!!this.hot.runHooks("beforeCut",i,this.copyableRanges)){const t=nA(i);if(e&&e.clipboardData){const n=Gw(i,this.hot.rootDocument);e.clipboardData.setData("text/plain",t),e.clipboardData.setData("text/html",[jk,n].join(""))}else"undefined"==typeof ClipboardEvent&&this.hot.rootWindow.clipboardData.setData("Text",t);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",i,this.copyableRanges)}}onPaste(e){var t;const n=this.hot.getFocusManager().getRefocusElement(),r=null===(t=e.target)||void 0===t?void 0:t.hasAttribute("data-hot-input");if(!this.hot.isListening()||this.isEditorOpened()||!this.hot.getSelected()||dg(e.target)&&(r&&e.target!==n||!r&&e.target!==this.hot.rootDocument.body&&!Sp(e.target,this.hot.rootElement)))return;let i;if(e.preventDefault(),e&&void 0!==e.clipboardData){const t=lp(e.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});if(t&&/(<table)|(<TABLE)/g.test(t)){const e=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document;const n={},r=t.createDocumentFragment(),i=t.createElement("div");r.appendChild(i);let o=e;if("string"==typeof o){const e=o.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,(e=>{const t=e.match(/<td\b[^>]*?>/g)[0];return`${t}${e.substring(t.length,e.lastIndexOf("<")).trim().replaceAll(/\n\s+/g," ").replaceAll(/<p.*?>/g,"\n").replace("\n","").replaceAll(/<\/(.*)>\s+$/gm,"</$1>").replace(/(<(?!br)([^>]+)>)/gi,"").replaceAll(/^&nbsp;$/gm,"")}</td>`}));i.insertAdjacentHTML("afterbegin",`${e}`),o=i.querySelector("table")}if(!o||!function(e){return"TABLE"===(e&&e.nodeName||"")}(o))return;const s=i.querySelector('meta[name$="enerator"]'),a=null!==o.querySelector("tbody th"),l=o.querySelector("tr"),h=l?Array.from(l.cells).reduce(((e,t)=>e+t.colSpan),0)-(a?1:0):0,u=o.tFoot&&Array.from(o.tFoot.rows)||[],c=[];let d=!1,p=0,g=0;if(o.tHead){const e=Array.from(o.tHead.rows).filter((e=>{const t=null!==e.querySelector("td");return t&&c.push(e),!t}));p=e.length,d=p>0,p>1?n.nestedHeaders=Array.from(e).reduce(((e,t)=>{const n=Array.from(t.cells).reduce(((e,t,n)=>{if(a&&0===n)return e;const{colSpan:r,innerHTML:i}=t,o=r>1?{label:i,colspan:r}:i;return e.push(o),e}),[]);return e.push(n),e}),[]):d&&(n.colHeaders=Array.from(e[0].children).reduce(((e,t,n)=>(a&&0===n||e.push(t.innerHTML),e)),[]))}c.length&&(n.fixedRowsTop=c.length),u.length&&(n.fixedRowsBottom=u.length);const m=[...c,...Array.from(o.tBodies).reduce(((e,t)=>(e.push(...Array.from(t.rows)),e)),[]),...u];g=m.length;const f=new Array(g);for(let v=0;v<g;v++)f[v]=new Array(h);const w=[],y=[];for(let v=0;v<g;v++){const e=m[v],t=Array.from(e.cells),n=t.length;for(let r=0;r<n;r++){const e=t[r],{nodeName:n,innerHTML:i,rowSpan:o,colSpan:a}=e,l=f[v].findIndex((e=>void 0===e));if("TD"===n){if(o>1||a>1){for(let e=v;e<v+o;e++)if(e<g)for(let t=l;t<l+a;t++)f[e][t]=null;const t=e.getAttribute("style");t&&t.includes("mso-ignore:colspan")||w.push({col:l,row:v,rowspan:o,colspan:a})}let t="";t=s&&/excel/gi.test(s.content)?i.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,"\r\n"):i.replace(/<br(\s*|\/)>[\r\n]?/gim,"\r\n"),f[v][l]=t.replace(Ww,(e=>Bw[e]))}else y.push(i)}}return w.length&&(n.mergeCells=w),y.length&&(n.rowHeaders=y),f.length&&(n.data=f),n}(t,this.hot.rootDocument);i=e.data}else i=e.clipboardData.getData("text/plain")}else"undefined"==typeof ClipboardEvent&&void 0!==this.hot.rootWindow.clipboardData&&(i=this.hot.rootWindow.clipboardData.getData("Text"));if("string"==typeof i&&(i=function(e){const t=[[""]];if(0===e.length)return t;let n,r=0,i=0;for(;e.length>0&&n!==e.length;)if(n=e.length,e.match(tA))e=e.replace(tA,""),r+=1,t[i][r]="";else if(e.match(JN))e=e.replace(JN,""),r=0,i+=1,t[i]=[""];else{let n="";if(e.startsWith('"')){let t=0,r=!0;for(;r;){const i=e.slice(0,1);'"'===i&&(t+=1),n+=i,(0===(e=e.slice(1)).length||e.match(/^[\t\r\n]/)&&t%2==0)&&(r=!1)}n=n.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,(e=>new Array(Math.floor(e.length/2)).fill('"').join("")))}else{const t=e.match(eA);n=t?t[0]:"",e=e.slice(n.length)}t[i][r]=n}return t}(i)),void 0===i||i&&0===i.length)return;if(!1===this.hot.runHooks("beforePaste",i,this.copyableRanges))return;const[o,s,a,l]=this.populateValues(i);this.hot.selectCell(o,s,Math.min(this.hot.countRows()-1,a),Math.min(this.hot.countCols()-1,l)),this.hot.runHooks("afterPaste",i,this.copyableRanges)}destroy(){super.destroy()}}function eF(e){if(fm()){const t=this.hot.getSelectedRangeLast();if(t){const{row:n,col:r}=t.highlight,i=this.hot.getCell(n,r,!0);i&&function(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];ug(e,n),t(),cg(e,n)}(i,(()=>{this.hot.rootDocument.execCommand(e)}))}}else this.hot.rootDocument.execCommand(e)}function tF(e){const{rows:t}=Lk(e);let n=0;for(let r=0;r<t.length&&!(t[r]>=0);r++)n+=1;return{columnHeadersCount:n}}function nF(){if(this.hot.isListening()){const e=this.hot.getSelectedRangeLast();if(e){const{row:t,col:n}=e.highlight,r=this.hot.getCell(t,n,!0);r&&ug(r)}}}function rF(){if(this.hot.isListening()){const e=this.hot.getSelectedRangeLast();if(e){const{row:t,col:n}=e.highlight,r=this.hot.getCell(t,n,!0);null!=r&&r.hasAttribute("contenteditable")&&cg(r)}}}function iF(e){var t;e.items.push({name:"---------"},(t=this,{key:"copy",name(){return this.getTranslatedPhrase(bb)},callback(){t.copyCellsOnly()},disabled(){if(0===this.countRows()||0===this.countCols())return!0;const e=this.getSelectedRangeLast();if(!e)return!0;if(e.isSingleHeader())return!0;const t=this.getSelected();return!t||t.length>1},hidden:!1})),Dk(Gk,this)&&e.items.push(function(e){return{key:"copy_with_column_headers",name(){const e=this.getSelectedRangeLast(),t=e?Xw(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(Tb,t)},callback(){e.copyWithColumnHeaders()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e)return!0;if(e.isSingleHeader())return!0;const t=this.getSelected();return!t||t.length>1},hidden:!1}}(this)),Dk(zk,this)&&e.items.push(function(e){return{key:"copy_with_column_group_headers",name(){const e=this.getSelectedRangeLast(),t=e?Xw(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(Nb,t)},callback(){e.copyWithAllColumnHeaders()},disabled(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;const e=this.getSelectedRangeLast();if(!e)return!0;if(e.isSingleHeader())return!0;const t=this.getSelected();return!t||t.length>1},hidden:!1}}(this)),Dk($k,this)&&e.items.push(function(e){return{key:"copy_column_headers_only",name(){const e=this.getSelectedRangeLast(),t=e?Xw(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(Ab,t)},callback(){e.copyColumnHeadersOnly()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e)return!0;if(e.isSingleHeader())return!0;const t=this.getSelected();return!t||t.length>1},hidden:!1}}(this)),e.items.push(function(e){return{key:"cut",name(){return this.getTranslatedPhrase(Mb)},callback(){e.cut()},disabled(){if(0===this.countRows()||0===this.countCols())return!0;const e=this.getSelectedRangeLast();if(!e)return!0;if(e.isSingleHeader())return!0;const t=this.getSelected();return!t||t.length>1},hidden:!1}}(this))}function oF(e,t,n,r,i){Dk(Qk,this)&&(i.value=!0),Vk(Qk,this,!1)}function sF(){this.isEditorOpened()||this.hot.getSettings().fragmentSelection||this.setCopyableText()}function aF(){Uk(Zk,this,rF).call(this)}function lF(){Uk(Zk,this,nF).call(this)}function hF(){Uk(Zk,this,rF).call(this)}function uF(e,t){return`border_row${e}col${t}`}function cF(e){var t,n;(Gd(e.start)||Gd(e.left))&&(e.start=null!==(t=e.start)&&void 0!==t?t:e.left);(Gd(e.end)||Gd(e.right))&&(e.end=null!==(n=e.end)&&void 0!==n?n:e.right);return delete e.left,delete e.right,e}function dF(e){return Gd(e.start)&&(e.left=e.start),Gd(e.end)&&(e.right=e.end),e}function pF(e,t){return{id:uF(e,t),border:{width:1,color:"#000",cornerVisible:!1},row:e,col:t,top:{hide:!0},bottom:{hide:!0},start:{hide:!0},end:{hide:!0}}}function gF(e,t){let n=!1;return Vd(e.getSelectedRange(),(r=>{r.forAll(((r,i)=>{if(r<0||i<0)return;const o=e.getCellMeta(r,i).borders;if(o){if(!t)return n=!0,!1;if(!sm(o[t],"hide")||!1===o[t].hide)return n=!0,!1}}))})),n}function mF(e){return`<span class="selected">${String.fromCharCode(10003)}</span>${e}`}const fF=new Map([["left","start"],["right","end"]]);function wF(e){return{key:"borders:bottom",name(){let e=this.getTranslatedPhrase(Kb);return gF(this,"bottom")&&(e=mF(e)),e},callback(t,n){const r=gF(this,"bottom");e.prepareBorder(n,"bottom",r)}}}function yF(e){const t=e.hot.isRtl()?"end":"start";return{key:"borders:left",name(){let e=this.getTranslatedPhrase(Xb);return gF(this,t)&&(e=mF(e)),e},callback(n,r){const i=gF(this,t);e.prepareBorder(r,t,i)}}}function vF(e){return{key:"borders:no_borders",name(){return this.getTranslatedPhrase(qb)},callback(t,n){e.prepareBorder(n,"noBorders")},disabled(){return!gF(this)}}}function CF(e){const t=e.hot.isRtl()?"start":"end";return{key:"borders:right",name(){let e=this.getTranslatedPhrase(Yb);return gF(this,t)&&(e=mF(e)),e},callback(n,r){const i=gF(this,t);e.prepareBorder(r,t,i)}}}function SF(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function RF(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function EF(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}const bF="customBorders";var TF=new WeakSet;class NF extends Tx{constructor(){super(...arguments),SF(this,TF),RF(this,"savedBorders",[])}static get PLUGIN_KEY(){return bF}static get PLUGIN_PRIORITY(){return 90}isEnabled(){return!!this.hot.getSettings()[bF]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",(e=>EF(TF,this,AF).call(this,e))),this.addHook("init",(()=>EF(TF,this,MF).call(this))),super.enablePlugin())}disablePlugin(){this.hideBorders(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),super.updatePlugin()}setBorders(e,t){let n=["top","bottom","start","end"],r=null;t&&(this.checkSettingsCohesion([t]),n=Object.keys(t),r=cF(t));const i=VN(DN(e),{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)});Vd(e,(e=>{i(e).forAll(((e,t)=>{Vd(n,(n=>{var i,o;this.prepareBorderFromCustomAdded(e,t,r,(i=n,null!==(o=fF.get(i))&&void 0!==o?o:i))}))}))})),this.hot.view.render()}getBorders(e){if(!Array.isArray(e))return this.savedBorders;const t=VN(DN(e),{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)}),n=[];return Vd(e,(e=>{t(e).forAll(((e,t)=>{Vd(this.savedBorders,(r=>{r.row===e&&r.col===t&&n.push(dF(r))}))}))})),n}clearBorders(e){e?this.setBorders(e):(Vd(this.savedBorders,(e=>{this.clearBordersFromSelectionSettings(e.id),this.clearNullCellRange(),this.hot.removeCellMeta(e.row,e.col,"borders")})),this.savedBorders.length=0)}insertBorderIntoSettings(e,t){this.checkSavedBorders(e)||this.savedBorders.push(e);const n=this.hot._createCellRange(this.hot._createCellCoords(e.row,e.col));this.checkCustomSelections(e,n,t)||this.hot.selection.highlight.addCustomSelection({border:e,visualCellRange:n})}prepareBorderFromCustomAdded(e,t,n,r){const i=this.hot.countRows(),o=this.hot.countCols();if(e>=i||t>=o)return;let s=pF(e,t);var a,l;n&&(a=s,sm(l=n,"border")&&l.border&&(a.border=l.border),sm(l,"top")&&Gd(l.top)&&(l.top?(em(l.top)||(l.top={width:1,color:"#000"}),a.top=l.top):(l.top={hide:!0},a.top=l.top)),sm(l,"bottom")&&Gd(l.bottom)&&(l.bottom?(em(l.bottom)||(l.bottom={width:1,color:"#000"}),a.bottom=l.bottom):(l.bottom={hide:!0},a.bottom=l.bottom)),sm(l,"start")&&Gd(l.start)&&(l.start?(em(l.start)||(l.start={width:1,color:"#000"}),a.start=l.start):(l.start={hide:!0},a.start=l.start)),sm(l,"end")&&Gd(l.end)&&(l.end?(em(l.end)||(l.end={width:1,color:"#000"}),a.end=l.end):(l.end={hide:!0},a.end=l.end)),s=a,Vd(this.hot.selection.highlight.customSelections,(e=>{if(s.id===e.settings.id)return Object.assign(e.settings,n),s.id=e.settings.id,s.top=e.settings.top,s.bottom=e.settings.bottom,s.start=e.settings.start,s.end=e.settings.end,!1}))),this.hot.setCellMeta(e,t,"borders",dF(s)),this.insertBorderIntoSettings(s,r)}prepareBorderFromCustomAddedRange(e,t){const n=Math.min(e.to.row,this.hot.countRows()-1),r=Math.min(e.to.col,this.hot.countCols()-1);$w(e.from.row,n,(n=>{$w(e.from.col,r,(r=>{const i=pF(n,r);let o=0;n===e.from.row&&sm(t,"top")&&(o+=1,i.top=t.top),n===e.to.row&&sm(t,"bottom")&&(o+=1,i.bottom=t.bottom),r===e.from.col&&sm(t,"start")&&(o+=1,i.start=t.start),r===e.to.col&&sm(t,"end")&&(o+=1,i.end=t.end),o>0&&(this.hot.setCellMeta(n,r,"borders",dF(i)),this.insertBorderIntoSettings(i))}))}))}removeAllBorders(e,t){const n=uF(e,t);this.spliceBorder(n),this.clearBordersFromSelectionSettings(n),this.clearNullCellRange(),this.hot.removeCellMeta(e,t,"borders")}setBorder(e,t,n,r){let i=this.hot.getCellMeta(e,t).borders;if(i=i&&void 0!==i.border?cF(i):pF(e,t),r){i[n]={hide:!0};if(4===this.countHide(i))this.removeAllBorders(e,t);else{this.checkCustomSelectionsFromContextMenu(i,n,r)||this.insertBorderIntoSettings(i),this.hot.setCellMeta(e,t,"borders",dF(i))}}else{i[n]={width:1,color:"#000"};this.checkCustomSelectionsFromContextMenu(i,n,r)||this.insertBorderIntoSettings(i),this.hot.setCellMeta(e,t,"borders",dF(i))}}prepareBorder(e,t,n){Vd(e,(e=>{let{start:r,end:i}=e;if(r.row===i.row&&r.col===i.col)"noBorders"===t?this.removeAllBorders(r.row,r.col):this.setBorder(r.row,r.col,t,n);else switch(t){case"noBorders":$w(r.col,i.col,(e=>{$w(r.row,i.row,(t=>{this.removeAllBorders(t,e)}))}));break;case"top":$w(r.col,i.col,(e=>{this.setBorder(r.row,e,t,n)}));break;case"bottom":$w(r.col,i.col,(e=>{this.setBorder(i.row,e,t,n)}));break;case"start":$w(r.row,i.row,(e=>{this.setBorder(e,r.col,t,n)}));break;case"end":$w(r.row,i.row,(e=>{this.setBorder(e,i.col,t,n)}))}}))}createCustomBorders(e){Vd(e,(e=>{const t=cF(e);e.range?this.prepareBorderFromCustomAddedRange(e.range,t):this.prepareBorderFromCustomAdded(e.row,e.col,t)}))}countHide(e){const{top:t,bottom:n,start:r,end:i}=e;return kd([t,n,r,i],((e,t)=>{let n=e;return t&&t.hide&&(n+=1),n}),0)}clearBordersFromSelectionSettings(e){const t=Dd(this.hot.selection.highlight.customSelections,(e=>e.settings.id)).indexOf(e);t>-1&&this.hot.selection.highlight.customSelections[t].clear()}clearNullCellRange(){Vd(this.hot.selection.highlight.customSelections,((e,t)=>{if(null===e.cellRange)return this.hot.selection.highlight.customSelections[t].destroy(),this.hot.selection.highlight.customSelections.splice(t,1),!1}))}hideBorders(){Vd(this.savedBorders,(e=>{this.clearBordersFromSelectionSettings(e.id),this.clearNullCellRange()}))}spliceBorder(e){const t=Dd(this.savedBorders,(e=>e.id)).indexOf(e);t>-1&&this.savedBorders.splice(t,1)}checkSavedBorders(e){let t=!1;return 4===this.countHide(e)?(this.spliceBorder(e.id),t=!0):Vd(this.savedBorders,((n,r)=>{if(e.id===n.id)return this.savedBorders[r]=e,t=!0,!1})),t}checkCustomSelectionsFromContextMenu(e,t,n){let r=!1;return Vd(this.hot.selection.highlight.customSelections,(i=>{if(e.id===i.settings.id){return Vd(this.hot.view._wt.selectionManager.getBorderInstances(i),(e=>{e.toggleHiddenClass(t,n)})),r=!0,!1}})),r}checkCustomSelections(e,t,n){const r=this.countHide(e);let i=!1;return 4===r?(this.removeAllBorders(e.row,e.col),i=!0):Vd(this.hot.selection.highlight.customSelections,(r=>{if(e.id===r.settings.id){if(r.visualCellRange=t,r.commit(),n){Vd(this.hot.view._wt.selectionManager.getBorderInstances(r),(t=>{t.changeBorderStyle(n,e)}))}return i=!0,!1}})),i}changeBorderSettings(){const e=this.hot.getSettings()[bF];if(Array.isArray(e)){const t=qg(e);this.checkSettingsCohesion(t),t.length||(this.savedBorders=t),this.createCustomBorders(t)}else void 0!==e&&this.createCustomBorders(this.savedBorders)}checkSettingsCohesion(e){const t=e.some((e=>Gd(e.left)||Gd(e.right)));const n=function(e){return e.some((e=>Gd(e.start)||Gd(e.end)))}(e);if(t&&n)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&t)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".')}destroy(){super.destroy()}}function AF(e){var t;this.hot.getSettings()[bF]&&e.items.push({name:"---------"},{key:"borders",name(){return this.getTranslatedPhrase(zb)},disabled(){const e=this.getSelectedRangeLast();return!e||(!!e.isSingleHeader()||this.selection.isSelectedByCorner())},submenu:{items:[(t=this,{key:"borders:top",name(){let e=this.getTranslatedPhrase($b);return gF(this,"top")&&(e=mF(e)),e},callback(e,n){const r=gF(this,"top");t.prepareBorder(n,"top",r)}}),CF(this),wF(this),yF(this),vF(this)]}})}function MF(){this.changeBorderSettings()}function IF(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function OF(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function xF(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}const PF="dragToScroll";var _F=new WeakSet;class LF extends Tx{constructor(){super(...arguments),IF(this,_F),OF(this,"boundaries",null),OF(this,"callback",null),OF(this,"listening",!1)}static get PLUGIN_KEY(){return PF}static get PLUGIN_PRIORITY(){return 100}isEnabled(){return!!this.hot.getSettings()[PF]}enablePlugin(){this.enabled||(this.addHook("afterOnCellMouseDown",(e=>xF(_F,this,HF).call(this,e))),this.addHook("afterOnCellCornerMouseDown",(e=>xF(_F,this,HF).call(this,e))),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.unregisterEvents(),super.disablePlugin()}setBoundaries(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{left:0,right:this.hot.rootWindow.innerWidth,top:0,bottom:this.hot.rootWindow.innerHeight};this.boundaries=e}setCallback(e){this.callback=e}check(e,t){let n=0,r=0;t<this.boundaries.top?r=t-this.boundaries.top:t>this.boundaries.bottom&&(r=t-this.boundaries.bottom),e<this.boundaries.left?n=e-this.boundaries.left:e>this.boundaries.right&&(n=e-this.boundaries.right),this.callback(n,r)}listen(){this.listening=!0}unlisten(){this.listening=!1}isListening(){return this.listening}registerEvents(){const{rootWindow:e}=this.hot;let t=e;for(;t;)this.eventManager.addEventListener(t.document,"contextmenu",(()=>this.unlisten())),this.eventManager.addEventListener(t.document,"mouseup",(()=>this.unlisten())),this.eventManager.addEventListener(t.document,"mousemove",(e=>this.onMouseMove(e))),t=Rp(t)}unregisterEvents(){this.eventManager.clear()}onMouseMove(e){this.isListening()&&this.check(e.clientX,e.clientY)}destroy(){super.destroy()}}function HF(e){if(Mm(e))return;const t=this.hot.view._wt.wtOverlays.topOverlay.mainTableScrollableElement;this.setBoundaries(t!==this.hot.rootWindow?t.getBoundingClientRect():void 0),this.setCallback(((e,n)=>{var r,i;const o=null!==(r=t.scrollLeft)&&void 0!==r?r:t.scrollX,s=null!==(i=t.scrollTop)&&void 0!==i?i:t.scrollY;t.scroll(o+50*Math.sign(e),s+20*Math.sign(n))})),this.listen()}function kF(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function FF(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function DF(e,t,n){return e.set(VF(e,t),n),n}function VF(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}mf.getSingleton().register("afterDropdownMenuDefaultOptions"),mf.getSingleton().register("beforeDropdownMenuShow"),mf.getSingleton().register("afterDropdownMenuShow"),mf.getSingleton().register("afterDropdownMenuHide"),mf.getSingleton().register("afterDropdownMenuExecute");const UF="dropdownMenu",BF="changeType",WF=UF;var jF=new WeakMap,GF=new WeakSet;class zF extends Tx{static get PLUGIN_KEY(){return UF}static get PLUGIN_PRIORITY(){return 230}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[LL,HL,xL,DL,xL,_L,xL,kL,xL,PL]}constructor(e){var t,n;super(e),kF(t=this,n=GF),n.add(t),FF(this,"commandExecutor",new NH(this.hot)),FF(this,"itemsFactory",null),FF(this,"menu",null),function(e,t,n){kF(e,t),t.set(e,n)}(this,jF,!1),this.hot.addHook("afterGetColHeader",((e,t)=>VF(GF,this,KF).call(this,e,t)))}isEnabled(){return this.hot.getSettings()[UF]}enablePlugin(){var e=this;if(this.enabled)return;this.itemsFactory=new MH(this.hot,zF.DEFAULT_ITEMS),this.addHook("beforeOnCellMouseDown",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return VF(GF,e,eD).call(e,...n)})),this.addHook("beforeViewportScrollHorizontally",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return VF(GF,e,JF).call(e,...n)}));const t=this.hot.getSettings()[UF],n={items:this.itemsFactory.getItems(t)};this.registerEvents(),"function"==typeof t.callback&&this.commandExecutor.setCommonCallback(t.callback),this.registerShortcuts(),super.enablePlugin(),this.callOnPluginsReady((()=>{this.hot.runHooks("afterDropdownMenuDefaultOptions",n),this.itemsFactory.setPredefinedItems(n.items);const r=this.itemsFactory.getItems(t);this.menu&&this.menu.destroy(),this.menu=new ok(this.hot,{className:"htDropdownMenu",keepInViewport:!0,container:t.uiContainer||this.hot.rootDocument.body}),this.hot.runHooks("beforeDropdownMenuSetItems",r),this.menu.setMenuItems(r),this.menu.addLocalHook("beforeOpen",(()=>VF(GF,this,XF).call(this))),this.menu.addLocalHook("afterOpen",(()=>VF(GF,this,qF).call(this))),this.menu.addLocalHook("afterSubmenuOpen",(e=>VF(GF,this,QF).call(this,e))),this.menu.addLocalHook("afterClose",(()=>VF(GF,this,ZF).call(this))),this.menu.addLocalHook("executeCommand",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.executeCommand.call(e,...n)})),Vd(r,(e=>this.commandExecutor.registerCommand(e.key,e)))}))}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&this.menu.destroy(),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=()=>{const{highlight:e}=this.hot.getSelectedRangeLast();if((e.isHeader()&&-1===e.row||e.isCell())&&e.col>=0){this.hot.selectColumns(e.col,e.col,-1);const{from:t}=this.hot.getSelectedRangeLast(),n=OL(this.menu.container,this.hot.rootDocument),r=this.hot.getCell(-1,t.col,!0).querySelector(`.${BF}`),i=r.getBoundingClientRect();this.open({left:i.left+n.left,top:i.top+r.offsetHeight+n.top},{left:i.width,right:0,above:0,below:3}),this.menu.getNavigator().toFirstItem()}};this.hot.getShortcutManager().getContext("grid").addShortcuts([{keys:[["Shift","Alt","ArrowDown"],["Control/Meta","Enter"]],callback:e,runOnlyIf:()=>{var e;const t=null===(e=this.hot.getSelectedRangeLast())||void 0===e?void 0:e.highlight;return t&&this.hot.selection.isCellVisible(t)&&t.isHeader()&&!this.menu.isOpened()},captureCtrl:!0,group:WF},{keys:[["Shift","Alt","ArrowDown"]],callback:e,runOnlyIf:()=>{var e;const t=null===(e=this.hot.getSelectedRangeLast())||void 0===e?void 0:e.highlight;return t&&this.hot.selection.isCellVisible(t)&&t.isCell()&&!this.menu.isOpened()},group:WF}])}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(WF)}registerEvents(){this.eventManager.addEventListener(this.hot.rootElement,"click",(e=>VF(GF,this,YF).call(this,e)))}open(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{above:0,below:0,left:0,right:0};null!==(t=this.menu)&&void 0!==t&&t.isOpened()||(this.menu.open(),nm(n,((e,t)=>{this.menu.setOffset(t,e)})),this.menu.setPosition(e))}close(){var e;null===(e=this.menu)||void 0===e||e.close()}executeCommand(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];this.commandExecutor.execute(e,...n)}setListening(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.menu.isOpened()&&(e?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function $F(e){e.getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Control/Meta","A"]],callback:()=>!1}])}function YF(e){if(Ip(e.target,BF)){const t=OL(this.menu.container,this.hot.rootDocument),n=e.target.getBoundingClientRect();e.stopPropagation(),DF(jF,this,!1),this.open({left:n.left+t.left,top:n.top+e.target.offsetHeight+t.top},{left:n.width,right:0,above:0,below:3})}}function KF(e,t){const n=t.parentNode;if(!n)return;const r=n.parentNode.childNodes,i=Array.prototype.indexOf.call(r,n);if(e<0||i!==r.length-1)return;const o=t.querySelector(`.${BF}`);if(this.enabled&&o)return;if(!this.enabled)return void(o&&o.parentNode.removeChild(o));const s=this.hot.rootDocument.createElement("button");s.className=BF,s.type="button",s.tabIndex=-1,this.hot.getSettings().ariaTags&&(Pp(s,[["aria-hidden","true"],up(" ")]),Pp(t,[cp("menu")])),s.onclick=function(){return!1},t.firstChild.insertBefore(s,t.firstChild.firstChild)}function XF(){this.hot.runHooks("beforeDropdownMenuShow",this)}function qF(){this.hot.runHooks("afterDropdownMenuShow",this),VF(GF,this,$F).call(this,this.menu)}function QF(e){VF(GF,this,$F).call(this,e)}function ZF(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}function JF(e){return n=this,(t=jF).get(VF(t,n))?null:e;var t,n}function eD(e){Ip(e.target,BF)&&DF(jF,this,!0)}function tD(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}zF.SEPARATOR={name:xL};const nD=class{constructor(e){tD(this,"hot",void 0),tD(this,"options",{}),this.hot=e}setOptions(e){this.options=e}getData(){const{startRow:e,startCol:t,endRow:n,endCol:r}=this._getDataRange(),i=this.options,o=[];return $w(e,n,(e=>{const n=[];!i.exportHiddenRows&&this._isHiddenRow(e)||($w(t,r,(t=>{!i.exportHiddenColumns&&this._isHiddenColumn(t)||n.push(this.hot.getDataAtCell(e,t))})),o.push(n))})),o}getRowHeaders(){const e=[];if(this.options.rowHeaders){const{startRow:t,endRow:n}=this._getDataRange(),r=this.hot.getRowHeader();$w(t,n,(t=>{!this.options.exportHiddenRows&&this._isHiddenRow(t)||e.push(r[t])}))}return e}getColumnHeaders(){const e=[];if(this.options.columnHeaders){const{startCol:t,endCol:n}=this._getDataRange(),r=this.hot.getColHeader();$w(t,n,(t=>{!this.options.exportHiddenColumns&&this._isHiddenColumn(t)||e.push(r[t])}))}return e}_getDataRange(){const e=this.hot.countCols()-1,t=this.hot.countRows()-1;let[n=0,r=0,i=t,o=e]=this.options.range;return n=Math.max(n,0),r=Math.max(r,0),i=Math.min(i,t),o=Math.min(o,e),{startRow:n,startCol:r,endRow:i,endCol:o}}_isHiddenRow(e){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(e))}_isHiddenColumn(e){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(e))}};function rD(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class iD{static get DEFAULT_OPTIONS(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}constructor(e,t){rD(this,"dataProvider",void 0),rD(this,"options",void 0),this.dataProvider=e,this.options=this._mergeOptions(t),this.dataProvider.setOptions(this.options)}_mergeOptions(e){let t=Qg(this.constructor.DEFAULT_OPTIONS);const n=new Date;return t=Kg(Qg(iD.DEFAULT_OPTIONS),t),t=Kg(t,e),t.filename=sp(t.filename,{YYYY:n.getFullYear(),MM:`${n.getMonth()+1}`.padStart(2,"0"),DD:`${n.getDate()}`.padStart(2,"0")}),t}}const oD=iD,sD=String.fromCharCode(13),aD=String.fromCharCode(34),lD=String.fromCharCode(10);const hD=class extends oD{static get DEFAULT_OPTIONS(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:"\r\n"}}export(){const e=this.options,t=this.dataProvider.getData();let n=this.dataProvider.getColumnHeaders();const r=n.length>0,i=this.dataProvider.getRowHeaders(),o=i.length>0;let s=e.bom?String.fromCharCode(65279):"";return r&&(n=Dd(n,(e=>this._escapeCell(e,!0))),o&&(s+=e.columnDelimiter),s+=n.join(e.columnDelimiter),s+=e.rowDelimiter),Vd(t,((t,n)=>{n>0&&(s+=e.rowDelimiter),o&&(s+=this._escapeCell(i[n])+e.columnDelimiter),s+=t.map((e=>this._escapeCell(e))).join(e.columnDelimiter)})),s}_escapeCell(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=jd(e);return""!==n&&(t||n.indexOf(sD)>=0||n.indexOf(aD)>=0||n.indexOf(lD)>=0||n.indexOf(this.options.columnDelimiter)>=0)&&(n=n.replace(new RegExp('"',"g"),'""'),n=`"${n}"`),n}},uD="csv",cD={[uD]:hD};class dD extends Tx{static get PLUGIN_KEY(){return"exportFile"}static get PLUGIN_PRIORITY(){return 240}isEnabled(){return!0}exportAsString(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._createTypeFormatter(e,t).export()}exportAsBlob(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._createBlob(this._createTypeFormatter(e,t))}downloadFile(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{rootDocument:n,rootWindow:r}=this.hot,i=this._createTypeFormatter(e,t),o=this._createBlob(i),s=r.URL||r.webkitURL,a=n.createElement("a"),l=`${i.options.filename}.${i.options.fileExtension}`;if(void 0!==a.download){const e=s.createObjectURL(o);a.style.display="none",a.setAttribute("href",e),a.setAttribute("download",l),n.body.appendChild(a),a.dispatchEvent(new MouseEvent("click")),n.body.removeChild(a),setTimeout((()=>{s.revokeObjectURL(e)}),100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(o,l)}_createTypeFormatter(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!cD[e])throw new Error(`Export format type "${e}" is not supported.`);return function(e,t,n){return"function"==typeof cD[e]?new cD[e](t,n):null}(e,new nD(this.hot),t)}_createBlob(e){let t=null;return"undefined"!=typeof Blob&&(t=new Blob([e.export()],{type:`${e.options.mimeType};charset=${e.options.encoding}`})),t}}function pD(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class gD{constructor(e,t){let{id:n,stateless:r=!0}=t;pD(this,"hot",void 0),pD(this,"id",void 0),pD(this,"elements",[]),pD(this,"hidden",!1),pD(this,"stateId",""),pD(this,"state",void 0),this.hot=e,this.id=n,this.stateId=`Filters.component.${this.id}`,this.state=r?null:this.hot.columnIndexMapper.registerMap(this.stateId,new HE)}getElements(){return this.elements}reset(){Vd(this.elements,(e=>e.reset()))}hide(){this.hidden=!0}show(){this.hidden=!1}isHidden(){return null===this.hot||this.hidden}restoreState(e){this.state&&this.setState(this.state.getValueAtIndex(e))}setState(){throw new Error("The state setting logic is not implemented")}saveState(e){this.state&&this.state.setValueAtIndex(e,this.getState())}getState(){throw new Error("The state gathering logic is not implemented")}destroy(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),Vd(this.elements,(e=>e.destroy())),this.state=null,this.elements=null,this.hot=null}}Zg(gD,cS);const mD={};function fD(e,t){if(!mD[e])throw Error(`Filter condition "${e}" does not exist.`);const{condition:n,descriptor:r}=mD[e];let i=t;return r.inputValuesDecorator&&(i=r.inputValuesDecorator(i)),function(e){return n.apply(e.meta.instance,[].concat([e],[i]))}}function wD(e){if(!mD[e])throw Error(`Filter condition "${e}" does not exist.`);return mD[e].descriptor}function yD(e,t,n){n.key=e,mD[e]={condition:t,descriptor:n}}const vD="none";yD(vD,(function(){return!0}),{name:oT,inputsCount:0,showOperators:!1});const CD="empty";yD(CD,(function(e){return $d(e.value)}),{name:sT,inputsCount:0,showOperators:!0});const SD="not_empty";yD(SD,(function(e,t){return!fD(CD,t)(e)}),{name:aT,inputsCount:0,showOperators:!0});const RD="eq";yD(RD,(function(e,t){let[n]=t;return jd(e.value).toLocaleLowerCase(e.meta.locale)===jd(n)}),{name:lT,inputsCount:1,showOperators:!0});const ED="neq";yD(ED,(function(e,t){return!fD(RD,t)(e)}),{name:hT,inputsCount:1,showOperators:!0});yD("gt",(function(e,t){let[n]=t,r=n;return"numeric"===e.meta.type&&(r=parseFloat(r,10)),e.value>r}),{name:mT,inputsCount:1,showOperators:!0});yD("gte",(function(e,t){let[n]=t,r=n;return"numeric"===e.meta.type&&(r=parseFloat(r,10)),e.value>=r}),{name:fT,inputsCount:1,showOperators:!0});yD("lt",(function(e,t){let[n]=t,r=n;return"numeric"===e.meta.type&&(r=parseFloat(r,10)),e.value<r}),{name:wT,inputsCount:1,showOperators:!0});yD("lte",(function(e,t){let[n]=t,r=n;return"numeric"===e.meta.type&&(r=parseFloat(r,10)),e.value<=r}),{name:yT,inputsCount:1,showOperators:!0});const bD="date_after";yD(bD,(function(e,t){let[n]=t;const r=M(e.value,e.meta.dateFormat),i=M(n,e.meta.dateFormat);return!(!r.isValid()||!i.isValid())&&r.diff(i)>=0}),{name:ST,inputsCount:1,showOperators:!0});const TD="date_before";yD(TD,(function(e,t){let[n]=t;const r=M(e.value,e.meta.dateFormat),i=M(n,e.meta.dateFormat);return!(!r.isValid()||!i.isValid())&&r.diff(i)<=0}),{name:RT,inputsCount:1,showOperators:!0});const ND="between";yD(ND,(function(e,t){let[n,r]=t,i=n,o=r;if("numeric"===e.meta.type){const e=parseFloat(i,10),t=parseFloat(o,10);i=Math.min(e,t),o=Math.max(e,t)}else if("date"===e.meta.type){const t=fD(TD,[o]),n=fD(bD,[i]);return t(e)&&n(e)}return e.value>=i&&e.value<=o}),{name:vT,inputsCount:2,showOperators:!0});const AD="not_between";yD(AD,(function(e,t){return!fD(ND,t)(e)}),{name:CT,inputsCount:2,showOperators:!0});const MD="begins_with";yD(MD,(function(e,t){let[n]=t;return jd(e.value).toLocaleLowerCase(e.meta.locale).startsWith(jd(n))}),{name:uT,inputsCount:1,showOperators:!0});const ID="ends_with";yD(ID,(function(e,t){let[n]=t;return jd(e.value).toLocaleLowerCase(e.meta.locale).endsWith(jd(n))}),{name:cT,inputsCount:1,showOperators:!0});const OD="contains";yD(OD,(function(e,t){let[n]=t;return jd(e.value).toLocaleLowerCase(e.meta.locale).indexOf(jd(n))>=0}),{name:dT,inputsCount:1,showOperators:!0});const xD="not_contains";yD(xD,(function(e,t){return!fD(OD,t)(e)}),{name:pT,inputsCount:1,showOperators:!0});const PD="date_tomorrow";yD(PD,(function(e){const t=M(e.value,e.meta.dateFormat);return!!t.isValid()&&t.isSame(M().subtract(-1,"days").startOf("day"),"d")}),{name:bT,inputsCount:0});const _D="date_today";yD(_D,(function(e){const t=M(e.value,e.meta.dateFormat);return!!t.isValid()&&t.isSame(M().startOf("day"),"d")}),{name:ET,inputsCount:0});const LD="date_yesterday";function HD(e,t){let n=e;return""===n&&(n=`(${t})`),n}function kD(e){const t=new Set(e);return function(e){return t.has(e)}}function FD(e){return null==e?"":e}function DD(e){return Array.from(new Set(e)).map((e=>FD(e))).sort(((e,t)=>"number"==typeof e&&"number"==typeof t?e-t:e===t?0:e>t?1:-1))}function VD(e,t,n,r){const i=[],o=e===t;let s;return o||(s=kD(t)),e.forEach((e=>{let t=!1;(o||s(e))&&(t=!0);const a={checked:t,value:e,visualValue:HD(e,n)};r&&r(a),i.push(a)})),i}yD(LD,(function(e){const t=M(e.value,e.meta.dateFormat);return!!t.isValid()&&t.isSame(M().subtract(1,"days").startOf("day"),"d")}),{name:TT,inputsCount:0}),function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};um||(um="object"==typeof Intl?new Intl.Collator(e,t).compare:"function"==typeof String.prototype.localeCompare?(e,t)=>`${e}`.localeCompare(t):(e,t)=>e===t?0:e>t?-1:1)}();const UD="by_value";yD(UD,(function(e,t){let[n]=t;return n(e.value)}),{name:"By value",inputsCount:0,inputValuesDecorator(e){let[t]=e;return[kD(t)]},showOperators:!1});const BD={};function WD(e){return BD[e].name}function jD(e,t,n){BD[e]={name:t,func:n}}const GD="conjunction";jD(GD,MT,(function(e,t){return e.every((e=>e.func(t)))}));const zD="disjunction";jD(zD,IT,(function(e,t){return e.some((e=>e.func(t)))}));const $D="disjunctionWithExtraCondition";jD($D,IT,(function(e,t){if(e.length<3)throw Error("Operation doesn't work on less then three conditions.");return e.slice(0,e.length-1).some((e=>e.func(t)))&&e[e.length-1].func(t)}));const YD="numeric",KD="text",XD="date",qD={[YD]:[vD,xL,CD,SD,xL,RD,ED,xL,"gt","gte","lt","lte",ND,AD],[KD]:[vD,xL,CD,SD,xL,RD,ED,xL,MD,ID,xL,OD,xD],[XD]:[vD,xL,CD,SD,xL,RD,ED,xL,TD,bD,ND,xL,PD,_D,LD]};function QD(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const ZD="built",JD="building",eV=["click","input","keydown","keypress","keyup","focus","blur","change"];let tV=class e{static get DEFAULTS(){return Qg({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}constructor(t,n){QD(this,"hot",void 0),QD(this,"eventManager",new Of(this)),QD(this,"options",void 0),QD(this,"_element",void 0),QD(this,"buildState",void 0),this.hot=t,this.options=Kg(e.DEFAULTS,n),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName)}setValue(e){this.options.value=e,this.update()}getValue(){return this.options.value}get element(){return this.buildState===JD?this._element:this.buildState===ZD?(this.update(),this._element):(this.buildState=JD,this.build(),this.buildState=ZD,this._element)}isBuilt(){return this.buildState===ZD}translateIfPossible(e){return"string"==typeof e&&e.startsWith(rT)?this.hot.getTranslatedPhrase(e):e}build(){const e=(e,t)=>{this.eventManager.addEventListener(e,t,(e=>this.runLocalHooks(t,e,this)))};if(this.buildState||(this.buildState=JD),this._element.setAttribute("data-hot-input",!0),void 0!==this.options.tabIndex&&this._element.setAttribute("tabindex",this.options.tabIndex),void 0!==this.options.role&&this._element.setAttribute("role",this.options.role),this.options.className&&Op(this._element,this.options.className),this.options.children.length)Vd(this.options.children,(e=>this._element.appendChild(e.element)));else if(this.options.wrapIt){const t=this.hot.rootDocument.createElement(this.options.tagName);t.setAttribute("data-hot-input",!0),nm(this.options,((e,n)=>{void 0!==t[n]&&"className"!==n&&"tagName"!==n&&"children"!==n&&(t[n]=this.translateIfPossible(e))})),this._element.appendChild(t),Vd(eV,(n=>e(t,n)))}else Vd(eV,(t=>e(this._element,t)))}update(){}reset(){this.options.value="",this.update()}show(){this.element.style.display=""}hide(){this.element.style.display="none"}focus(){}destroy(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}};function nV(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function rV(e,t){return e.get(iV(e,t))}function iV(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}Zg(tV,cS);var oV=new WeakMap,sV=new WeakSet;class aV extends tV{static get DEFAULTS(){return Qg({placeholder:"",type:"text",tagName:"input",tabIndex:-1})}constructor(e,t){var n,r;super(e,Kg(aV.DEFAULTS,t)),nV(n=this,r=sV),r.add(n),function(e,t,n){nV(e,t),t.set(e,n)}(this,oV,void 0),this.registerHooks()}registerHooks(){this.addLocalHook("keyup",(e=>iV(sV,this,lV).call(this,e)))}build(){super.build();const e=this.hot.rootDocument.createElement("div");var t,n,r;t=oV,n=this,r=this._element.firstChild,t.set(iV(t,n),r),Op(this._element,"htUIInput"),Op(e,"htUIInputIcon"),this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(rV(oV,this).type=this.options.type,rV(oV,this).placeholder=this.translateIfPossible(this.options.placeholder),rV(oV,this).value=this.translateIfPossible(this.options.value))}focus(){this.isBuilt()&&rV(oV,this).focus()}}function lV(e){this.options.value=e.target.value}function hV(e,t,n){uV(e,t),t.set(e,n)}function uV(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function cV(e,t,n){return e.set(pV(e,t),n),n}function dV(e,t){return e.get(pV(e,t))}function pV(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var gV=new WeakMap,mV=new WeakMap,fV=new WeakMap,wV=new WeakMap,yV=new WeakMap,vV=new WeakSet;class CV extends tV{static get DEFAULTS(){return Qg({className:"htUISelect",wrapIt:!1,tabIndex:-1})}constructor(e,t){var n,r;super(e,Kg(CV.DEFAULTS,t)),uV(n=this,r=vV),r.add(n),hV(this,gV,null),hV(this,mV,[]),hV(this,fV,void 0),hV(this,wV,void 0),hV(this,yV,void 0),this.registerHooks()}getMenu(){return dV(gV,this)}registerHooks(){this.addLocalHook("click",(()=>pV(vV,this,EV).call(this)))}setItems(e){cV(mV,this,this.translateNames(e)),dV(gV,this)&&dV(gV,this).setMenuItems(dV(mV,this))}translateNames(e){return Vd(e,(e=>{e.name=this.translateIfPossible(e.name)})),e}build(){super.build(),cV(gV,this,new ok(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer})),dV(gV,this).setMenuItems(dV(mV,this));const e=new tV(this.hot,{className:"htUISelectCaption"}),t=new tV(this.hot,{className:"htUISelectDropdown"});cV(fV,this,e),cV(wV,this,e.element),cV(yV,this,t),this.hot.getSettings().ariaTags&&(Pp(t.element,[["aria-hidden","true"]]),Pp(this._element,[["role","listbox"]])),Vd([e,t],(e=>this._element.appendChild(e.element))),dV(gV,this).addLocalHook("select",(e=>pV(vV,this,SV).call(this,e))),dV(gV,this).addLocalHook("afterClose",(()=>pV(vV,this,RV).call(this))),this.update()}update(){if(!this.isBuilt())return;let e;e=this.options.value?this.options.value.name:dV(gV,this).hot.getTranslatedPhrase(oT),dV(wV,this).textContent=e,super.update()}openOptions(){const e=this.element.getBoundingClientRect();dV(gV,this)&&(dV(gV,this).open(),dV(gV,this).setPosition({left:this.hot.isLtr()?e.left-5:e.left-31,top:e.top-1,width:e.width,height:e.height}),dV(gV,this).getNavigator().toFirstItem(),dV(gV,this).getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:e=>{this.closeOptions(),this.runLocalHooks("tabKeydown",e)}},{keys:[["Control/Meta","A"]],callback:()=>!1}]))}closeOptions(){dV(gV,this)&&dV(gV,this).close()}focus(){this.isBuilt()&&this.element.focus()}destroy(){dV(gV,this)&&(dV(gV,this).destroy(),cV(gV,this,null)),dV(fV,this)&&dV(fV,this).destroy(),dV(yV,this)&&dV(yV,this).destroy(),super.destroy()}}function SV(e){e.name!==xL&&(this.options.value=e,this.update(),this.runLocalHooks("select",this.options.value))}function RV(){this.runLocalHooks("afterClose")}function EV(){this.openOptions()}function bV(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function TV(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function NV(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var AV=new WeakSet;class MV extends gD{constructor(e,t){super(e,{id:t.id,stateless:!1}),bV(this,AV),TV(this,"name",""),TV(this,"addSeparator",!1),this.name=t.name,this.addSeparator=t.addSeparator,this.elements.push(new CV(this.hot,{menuContainer:t.menuContainer})),this.elements.push(new aV(this.hot,{placeholder:kT})),this.elements.push(new aV(this.hot,{placeholder:FT})),this.registerHooks()}registerHooks(){this.getSelectElement().addLocalHook("select",(e=>NV(AV,this,IV).call(this,e))).addLocalHook("afterClose",(()=>this.runLocalHooks("afterClose"))).addLocalHook("tabKeydown",(e=>this.runLocalHooks("selectTabKeydown",e))),Vd(this.getInputElements(),(e=>{e.addLocalHook("keydown",(e=>NV(AV,this,OV).call(this,e)))}))}setState(e){if(this.reset(),!e)return;const t=Qg(e.command);t.name.startsWith(iT)&&(t.name=this.hot.getTranslatedPhrase(t.name)),this.getSelectElement().setValue(t),Vd(e.args,((e,n)=>{if(n>t.inputsCount-1)return!1;const r=this.getInputElement(n);r.setValue(e),r[t.inputsCount>n?"show":"hide"](),n||this.hot._registerTimeout((()=>r.focus()),10)}))}getState(){const e=this.getSelectElement().getValue()||wD(vD),t=[];return Vd(this.getInputElements(),((n,r)=>{e.inputsCount>r&&t.push(n.getValue())})),{command:e,args:t}}updateState(e,t){const n=wD(e?e.name:vD);this.state.setValueAtIndex(t,{command:n,args:e?e.args:[]}),e||Vd(this.getInputElements(),(e=>e.setValue(null)))}getSelectElement(){return this.elements.filter((e=>e instanceof CV))[0]}getInputElement(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.getInputElements()[e]}getInputElements(){return this.elements.filter((e=>e instanceof aV))}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,t,n,r,i,o)=>{Op(t.parentNode,"htFiltersMenuCondition"),this.addSeparator&&Op(t.parentNode,"border");const s=this.hot.rootDocument.createElement("div");return Op(s,"htFiltersMenuLabel"),s.textContent=o,t.appendChild(s),t.parentElement.hasAttribute("ghost-table")||Vd(this.elements,(e=>t.appendChild(e.element))),t}}}reset(){const e=this.hot.getPlugin("filters").getSelectedColumn();let t=[wD(vD)];if(null!==e){const{visualIndex:n}=e;t=function(e){const t=[];let n=e;return qD[n]||(n=KD),Vd(qD[n],(e=>{let n;n=e===xL?{name:xL}:Qg(wD(e)),t.push(n)})),t}(this.hot.getDataType(0,n,this.hot.countRows(),n))}Vd(this.getInputElements(),(e=>e.hide())),this.getSelectElement().setItems(t),super.reset(),this.getSelectElement().setValue(t[0])}}function IV(e){Vd(this.getInputElements(),((t,n)=>{t[e.inputsCount>n?"show":"hide"](),0===n&&this.hot._registerTimeout((()=>t.focus()),10)})),this.runLocalHooks("change",e)}function OV(e){Tm(e.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),Nm(e))}function xV(e,t,n){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,n)}function PV(e,t){return e.get(LV(e,t))}function _V(e,t,n){return e.set(LV(e,t),n),n}function LV(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var HV=new WeakMap,kV=new WeakMap;class FV extends tV{static get DEFAULTS(){return Qg({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}constructor(e,t){super(e,Kg(FV.DEFAULTS,t)),xV(this,HV,void 0),xV(this,kV,void 0)}build(){super.build();const e=this.hot.rootDocument.createElement("label");e.textContent=this.translateIfPossible(this.options.label.textContent),e.htmlFor=this.translateIfPossible(this.options.label.htmlFor),_V(kV,this,e),_V(HV,this,this._element.firstChild),PV(HV,this).checked=this.options.checked,this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(PV(kV,this).textContent=this.translateIfPossible(this.options.label.textContent))}isChecked(){return!!this.isBuilt()&&PV(HV,this).checked}setChecked(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.isBuilt()&&(PV(HV,this).checked=e)}focus(){this.isBuilt()&&PV(HV,this).focus()}}function DV(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function VV(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var UV=new WeakSet;class BV extends gD{constructor(e,t){super(e,{id:t.id,stateless:!1}),DV(this,UV),VV(this,"name",""),this.name=t.name,this.buildOperatorsElement()}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,t)=>(Op(t.parentNode,"htFiltersMenuOperators"),Vd(this.elements,(e=>t.appendChild(e.element))),t)}}buildOperatorsElement(){const e=[GD,zD];Vd(e,(t=>{const n=new FV(this.hot,{name:"operator",label:{htmlFor:t,textContent:WD(t)},value:t,checked:t===e[0],id:t});n.addLocalHook("change",(e=>function(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}(UV,this,WV).call(this,e))),this.elements.push(n)}))}setChecked(e){if(this.elements.length<e)throw Error(Wd`Radio button with index ${e} doesn't exist.`);Vd(this.elements,((t,n)=>{t.setChecked(n===e)}))}getActiveOperationId(){const e=this.elements.find((e=>e instanceof FV&&e.isChecked()));return e?e.getValue():GD}getState(){return this.getActiveOperationId()}setState(e){this.reset(),e&&this.getActiveOperationId()!==e&&Vd(this.elements,(t=>{t.setChecked(t.getValue()===e)}))}updateState(){let e=arguments.length>1?arguments[1]:void 0,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:GD;t===$D&&(t=zD),this.state.setValueAtIndex(e,t)}reset(){this.setChecked(0)}}function WV(e){this.setState(e.target.value)}function jV(e,t,n){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,n)}function GV(e,t){return e.get(zV(e,t))}function zV(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var $V=new WeakMap;class YV extends tV{static get DEFAULTS(){return Qg({href:"#",tagName:"a",tabIndex:-1,role:"button"})}constructor(e,t){super(e,Kg(YV.DEFAULTS,t)),jV(this,$V,void 0)}build(){var e,t,n;super.build(),e=$V,t=this,n=this._element.firstChild,e.set(zV(e,t),n)}update(){this.isBuilt()&&(GV($V,this).textContent=this.translateIfPossible(this.options.textContent))}focus(){this.isBuilt()&&GV($V,this).focus()}activate(){GV($V,this).click()}}function KV(e,t,n){XV(e,t),t.set(e,n)}function XV(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function qV(e,t){return e.get(ZV(e,t))}function QV(e,t,n){return e.set(ZV(e,t),n),n}function ZV(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}const JV="multipleSelect.itemBox";var eU=new WeakMap,tU=new WeakMap,nU=new WeakMap,rU=new WeakMap,iU=new WeakMap,oU=new WeakMap,sU=new WeakSet;class aU extends tV{static get DEFAULTS(){return Qg({className:"htUIMultipleSelect",value:[]})}constructor(e,t){var n,r;super(e,Kg(aU.DEFAULTS,t)),XV(n=this,r=sU),r.add(n),KV(this,eU,[]),KV(this,tU,void 0),KV(this,nU,void 0),KV(this,rU,void 0),KV(this,iU,void 0),KV(this,oU,void 0),QV(rU,this,new aV(this.hot,{placeholder:HT,className:"htUIMultipleSelectSearch"})),QV(iU,this,new YV(this.hot,{textContent:xT,className:"htUISelectAll"})),QV(oU,this,new YV(this.hot,{textContent:PT,className:"htUIClearAll"})),this.registerHooks()}getItemsBox(){return qV(tU,this)}registerHooks(){qV(rU,this).addLocalHook("keydown",(e=>ZV(sU,this,hU).call(this,e))),qV(rU,this).addLocalHook("input",(e=>ZV(sU,this,lU).call(this,e))),qV(iU,this).addLocalHook("click",(e=>ZV(sU,this,uU).call(this,e))),qV(oU,this).addLocalHook("click",(e=>ZV(sU,this,cU).call(this,e)))}setItems(e){var t;QV(eU,this,e),null===(t=qV(tU,this))||void 0===t||t.loadData(qV(eU,this))}setLocale(e){QV(nU,this,e)}getLocale(){return qV(nU,this)}getItems(){return[...qV(eU,this)]}getValue(){return function(e){const t=[];return e.forEach((e=>{e.checked&&t.push(e.value)})),t}(qV(eU,this))}getSearchInputElement(){return qV(rU,this)}getSelectAllElement(){return qV(iU,this)}getClearAllElement(){return qV(oU,this)}isSelectedAllValues(){return qV(eU,this).length===this.getValue().length}build(){super.build();const{rootDocument:e}=this.hot,t=e.createElement("div"),n=new tV(this.hot,{className:"htUISelectionControls",children:[qV(iU,this),qV(oU,this)]});this._element.appendChild(qV(rU,this).element),this._element.appendChild(n.element),this._element.appendChild(t);const r=t=>{var n;if(!this._element)return;null===(n=qV(tU,this))||void 0===n||n.destroy(),Op(t,"htUIMultipleSelectHot"),QV(tU,this,new this.hot.constructor(t,{data:qV(eU,this),columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:(e,t,n,r,i,o)=>{e.title=o.instance.getDataAtRowProp(t,o.label.property)},afterListen:()=>{this.runLocalHooks("focus",this)},beforeOnCellMouseUp:()=>{qV(tU,this).listen()},colWidths:()=>qV(tU,this).container.scrollWidth-ng(e),maxCols:1,autoWrapCol:!0,height:110,copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},themeName:this.hot.getCurrentThemeName(),layoutDirection:this.hot.isRtl()?"rtl":"ltr"})),qV(tU,this).init(),this.hot.addHook("afterSetTheme",((e,t)=>{t||qV(tU,this).useTheme(e)}));const r=qV(tU,this).getShortcutManager().getContext("grid");r.removeShortcutsByKeys(["Tab"]),r.removeShortcutsByKeys(["Shift","Tab"]),r.addShortcut({keys:[["Escape"]],callback:e=>{this.runLocalHooks("keydown",e,this)},group:JV}),r.addShortcut({keys:[["Tab"],["Shift","Tab"]],callback:e=>{qV(tU,this).deselectCell(),this.runLocalHooks("keydown",e,this),this.runLocalHooks("listTabKeydown",e,this)},group:JV})};r(t),this.hot._registerTimeout((()=>r(t)),100)}focus(){this.isBuilt()&&qV(tU,this).listen()}reset(){qV(rU,this).reset(),qV(iU,this).reset(),qV(oU,this).reset()}update(){this.isBuilt()&&(qV(tU,this).loadData(function(e,t){const n=kD(t);return e.map((e=>(e.checked=n(e.value),e)))}(qV(eU,this),this.options.value)),super.update())}destroy(){var e;null===(e=qV(tU,this))||void 0===e||e.destroy(),qV(rU,this).destroy(),qV(oU,this).destroy(),qV(iU,this).destroy(),QV(rU,this,null),QV(oU,this,null),QV(iU,this,null),QV(tU,this,null),QV(eU,this,null),super.destroy()}}function lU(e){const t=e.target.value.toLocaleLowerCase(this.getLocale());let n;n=""===t?[...qV(eU,this)]:qV(eU,this).filter((e=>`${e.value}`.toLocaleLowerCase(this.getLocale()).indexOf(t)>=0)),qV(tU,this).loadData(n)}function hU(e){this.runLocalHooks("keydown",e,this);mg(Tm,e.keyCode)("ARROW_DOWN")&&(e.preventDefault(),Nm(e),qV(tU,this).listen(),qV(tU,this).selectCell(0,0))}function uU(e){const t=[];e.preventDefault(),qV(tU,this).getSourceData().forEach(((e,n)=>{e.checked=!0,t.push(fE(e,n)[0])})),qV(tU,this).setSourceDataAtCell(t)}function cU(e){const t=[];e.preventDefault(),qV(tU,this).getSourceData().forEach(((e,n)=>{e.checked=!1,t.push(fE(e,n)[0])})),qV(tU,this).setSourceDataAtCell(t)}function dU(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function pU(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function gU(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var mU,fU=new WeakSet;class wU extends gD{constructor(e,t){super(e,{id:t.id,stateless:!1}),dU(this,fU),pU(this,"name",""),this.name=t.name,this.elements.push(new aU(this.hot)),this.registerHooks()}registerHooks(){this.getMultipleSelectElement().addLocalHook("keydown",(e=>gU(fU,this,yU).call(this,e))).addLocalHook("listTabKeydown",(e=>this.runLocalHooks("listTabKeydown",e))),this.hot.addHook("modifyFiltersMultiSelectValue",((e,t)=>gU(fU,this,CU).call(this,e,t)))}getElements(){const e=this.getMultipleSelectElement();return[e.getSearchInputElement(),e.getSelectAllElement(),e.getClearAllElement(),this.getMultipleSelectElement()]}setState(e){if(this.reset(),e&&e.command.key===UD){const t=this.getMultipleSelectElement();t.setItems(e.itemsSnapshot),t.setValue(e.args[0]),t.setLocale(e.locale)}}getState(){const e=this.getMultipleSelectElement(),t=e.getItems();return{command:{key:e.isSelectedAllValues()||!t.length?vD:UD},args:[e.getValue()],itemsSnapshot:t}}updateState(e){const t=(t,n,r,i,o)=>{const[s]=Fd(n,(e=>e.name===UD)),a={},l=this.hot.getTranslatedPhrase(OT);if(s){const n=i(t,o),h=Dd(n,(e=>e.value)),u=new Map(n.map((e=>[e.value,this.hot.getCellMeta(e.meta.visualRow,e.meta.visualCol)]))),c=DD(h);r&&(s.args[0]=r);const d=[],p=VD(c,s.args[0],l,(e=>{e.checked&&d.push(e.value),gU(fU,this,vU).call(this,e,u)})),g=e.editedConditionStack.column;a.locale=this.hot.getCellMeta(0,g).locale,a.args=[d],a.command=wD(UD),a.itemsSnapshot=p}else a.args=[],a.command=wD(vD);this.state.setValueAtIndex(t,a)};t(e.editedConditionStack.column,e.editedConditionStack.conditions,e.conditionArgsChange,e.filteredRowsFactory),e.dependentConditionStacks.length&&t(e.dependentConditionStacks[0].column,e.dependentConditionStacks[0].conditions,e.conditionArgsChange,e.filteredRowsFactory,e.editedConditionStack)}getMultipleSelectElement(){return this.elements.filter((e=>e instanceof aU))[0]}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,t,n,r,i,o)=>{Op(t.parentNode,"htFiltersMenuValue");const s=this.hot.rootDocument.createElement("div");return Op(s,"htFiltersMenuLabel"),s.textContent=o,t.appendChild(s),t.parentElement.hasAttribute("ghost-table")||Vd(this.elements,(e=>t.appendChild(e.element))),t}}}reset(){const e=this.hot.getTranslatedPhrase(OT),t=this._getColumnVisibleValues(),n=t.map((e=>e.value)),r=new Map(t.map((e=>[e.value,e.meta]))),i=DD(n),o=VD(i,i,e,(e=>{gU(fU,this,vU).call(this,e,r)}));this.getMultipleSelectElement().setItems(o),super.reset(),this.getMultipleSelectElement().setValue(i);const s=this.hot.getPlugin("filters").getSelectedColumn();null!==s&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,s.visualIndex).locale)}_getColumnVisibleValues(){const e=this.hot.getPlugin("filters").getSelectedColumn();return null===e?[]:Dd(this.hot.getDataAtCol(e.visualIndex),((t,n)=>({value:FD(t),meta:this.hot.getCellMeta(n,e.visualIndex)})))}}function yU(e){Tm(e.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),Nm(e))}function vU(e,t){this.hot.hasHook("modifyFiltersMultiSelectValue")&&(e.visualValue=this.hot.runHooks("modifyFiltersMultiSelectValue",e.visualValue,t.get(e.value)))}function CU(e,t){return"numeric"===t.type?YO(e,t):e}function SU(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function RU(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var EU=new WeakSet;class bU extends gD{static get BUTTON_OK(){return"ok"}static get BUTTON_CANCEL(){return"cancel"}constructor(e,t){super(e,{id:t.id,stateless:!0}),SU(this,EU),RU(this,"name",""),this.name=t.name,this.elements.push(new aV(this.hot,{type:"button",value:_T,className:"htUIButton htUIButtonOK",identifier:bU.BUTTON_OK})),this.elements.push(new aV(this.hot,{type:"button",value:LT,className:"htUIButton htUIButtonCancel",identifier:bU.BUTTON_CANCEL})),this.registerHooks()}registerHooks(){Vd(this.elements,(e=>{e.addLocalHook("click",((e,t)=>function(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}(EU,this,TU).call(this,e,t)))}))}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,t)=>(Op(t.parentNode,"htFiltersMenuActionBar"),Vd(this.elements,(e=>t.appendChild(e.element))),t)}}accept(){this.runLocalHooks("accept")}cancel(){this.runLocalHooks("cancel")}}function TU(e,t){t.options.identifier===mU.BUTTON_OK?this.accept():this.cancel()}function NU(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}mU=bU;const AU="ConditionCollection.filteringStates";class MU{constructor(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];NU(this,"hot",void 0),NU(this,"isMapRegistrable",void 0),NU(this,"filteringStates",new HE),this.hot=e,this.isMapRegistrable=t,!0===this.isMapRegistrable?this.hot.columnIndexMapper.registerMap(AU,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}isEmpty(){return 0===this.getFilteredColumns().length}isMatch(e,t){var n;const r=this.filteringStates.getValueAtIndex(t),i=null!==(n=null==r?void 0:r.conditions)&&void 0!==n?n:[],o=null==r?void 0:r.operation;return this.isMatchInConditions(i,e,o)}isMatchInConditions(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:GD;return!e.length||function(e){if(!BD[e])throw Error(`Operation with id "${e}" does not exist.`);const t=BD[e].func;return function(e,n){return t(e,n)}}(n)(e,t)}addCondition(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:GD,r=arguments.length>3?arguments[3]:void 0;const i=this.hot.getCellMeta(0,e).locale,o=t.args.map((e=>"string"==typeof e?e.toLocaleLowerCase(i):e)),s=t.name||t.command.key;this.runLocalHooks("beforeAdd",e);const a=this.getOperation(e);if(a){if(a!==n)throw Error(Wd`The column of index ${e} has been already applied with a \`${a}\`\x20
        filter operation. Use \`removeConditions\` to clear the current conditions and then add new ones.\x20
        Mind that you cannot mix different types of operations (for instance, if you use \`conjunction\`,\x20
        use it consequently for a particular column).`)}else if(zd(BD[n]))throw new Error(Wd`Unexpected operation named \`${n}\`. Possible ones are\x20
        \`disjunction\` and \`conjunction\`.`);const l=this.getConditions(e);0===l.length?this.filteringStates.setValueAtIndex(e,{operation:n,conditions:[{name:s,args:o,func:fD(s,o)}]},r):l.push({name:s,args:o,func:fD(s,o)}),this.runLocalHooks("afterAdd",e)}getConditions(e){var t,n;return null!==(t=null===(n=this.filteringStates.getValueAtIndex(e))||void 0===n?void 0:n.conditions)&&void 0!==t?t:[]}getOperation(e){var t;return null===(t=this.filteringStates.getValueAtIndex(e))||void 0===t?void 0:t.operation}getFilteredColumns(){return this.filteringStates.getEntries().map((e=>{let[t]=e;return t}))}getColumnStackPosition(e){return this.getFilteredColumns().indexOf(e)}exportAllConditions(){return this.filteringStates.getEntries().reduce(((e,t)=>{let[n,{operation:r,conditions:i}]=t;return e.push({column:n,operation:r,conditions:i.map((e=>{let{name:t,args:n}=e;return{name:t,args:[...n]}}))}),e}),[])}importAllConditions(e){this.clean(),e.forEach((e=>{e.conditions.forEach((t=>this.addCondition(e.column,t)))}))}removeConditions(e){this.runLocalHooks("beforeRemove",e),this.filteringStates.clearValue(e),this.runLocalHooks("afterRemove",e)}clean(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}hasConditions(e,t){const n=this.getConditions(e);return t?n.some((e=>e.name===t)):n.length>0}destroy(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(AU),this.filteringStates=null,this.clearLocalHooks()}}Zg(MU,cS);const IU=MU;function OU(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const xU=class{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:()=>[];OU(this,"conditionCollection",void 0),OU(this,"columnDataFactory",void 0),this.conditionCollection=e,this.columnDataFactory=t}filter(){let e=[];return Vd(this.conditionCollection.getFilteredColumns(),((t,n)=>{let r=this.columnDataFactory(t);n&&(r=this._getIntersectData(r,e)),e=this.filterByColumn(t,r)})),e}filterByColumn(e){const t=[];return Vd(arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],(n=>{void 0!==n&&this.conditionCollection.isMatch(n,e)&&t.push(n)})),t}_getIntersectData(e,t){const n=[];return Vd(t,(t=>{const r=t.meta.visualRow;void 0!==e[r]&&(n[r]=e[r])})),n}};function PU(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function _U(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function LU(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var HU=new WeakSet;class kU{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>[];PU(this,HU),_U(this,"hot",void 0),_U(this,"conditionCollection",void 0),_U(this,"columnDataFactory",void 0),_U(this,"changes",[]),_U(this,"grouping",!1),_U(this,"latestEditedColumnPosition",-1),_U(this,"latestOrderStack",[]),this.hot=e,this.conditionCollection=t,this.columnDataFactory=n,this.conditionCollection.addLocalHook("beforeRemove",(e=>LU(HU,this,FU).call(this,e))),this.conditionCollection.addLocalHook("afterRemove",(e=>this.updateStatesAtColumn(e))),this.conditionCollection.addLocalHook("afterAdd",(e=>this.updateStatesAtColumn(e))),this.conditionCollection.addLocalHook("beforeClean",(()=>LU(HU,this,DU).call(this))),this.conditionCollection.addLocalHook("afterClean",(()=>LU(HU,this,VU).call(this)))}groupChanges(){this.grouping=!0}flush(){this.grouping=!1,Vd(this.changes,(e=>{this.updateStatesAtColumn(e)})),this.changes.length=0}updateStatesAtColumn(e,t){var n=this;if(this.grouping)return void(-1===this.changes.indexOf(e)&&this.changes.push(e));const r=this.conditionCollection.exportAllConditions();let i=this.conditionCollection.getColumnStackPosition(e);-1===i&&(i=this.latestEditedColumnPosition);const o=r.slice(0,i),s=r.slice(i);s.length&&s[0].column===e&&s.shift();const a=function(e){const t=e.length;return function n(r){return function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];const a=r.concat(o);let l;return l=a.length>=t?e.apply(this,a):n(a),l}}([])}((function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];const i=new IU(n.hot,!1),o=[].concat(e,r);i.importAllConditions(o);const s=n.columnDataFactory(t);let a;a=i.isEmpty()?s:new xU(i,(e=>n.columnDataFactory(e))).filter(),a=Dd(a,(e=>e.meta.visualRow));const l=kD(a);return i.destroy(),Fd(s,(e=>l(e.meta.visualRow)))}))(o),l=[].concat(this.conditionCollection.getConditions(e));this.runLocalHooks("update",{editedConditionStack:{column:e,conditions:l},dependentConditionStacks:s,filteredRowsFactory:a,conditionArgsChange:t})}destroy(){this.clearLocalHooks(),nm(this,((e,t)=>{this[t]=null}))}}function FU(e){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(e)}function DU(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}function VU(){Vd(this.latestOrderStack,(e=>{this.updateStatesAtColumn(e)}))}Zg(kU,cS);const UU=kU;const BU="filters";function WU(e,t){let n,r=-1;const i=(o=t,BH({initialPage:0,size:()=>o.length,onItemSelect:(e,t)=>{const n=o[e];return n instanceof aU?t:!(n.element&&!Vp(n.element))&&void n.focus()}}));var o;const s=e=>()=>{n.isOpened()&&n.getKeyboardShortcutsCtrl().listen(BU),i.setCurrentPage(t.indexOf(e))};function a(e){const o=n.getKeyboardShortcutsCtrl(),s=e.getKeyboardShortcutsCtrl();i.clear(),s.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],forwardToContext:o.getContext(BU),callback:()=>{e.isSubMenu()&&e.close(),o.listen(BU)}}]),e.isSubMenu()||o.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:e=>{const t=n.getNavigator();t.getCurrentPage()>-1&&(r=t.getCurrentPage()),t.clear(),e.shiftKey?i.toPreviousItem():i.toNextItem()}},{keys:[["Escape"]],callback:()=>{n.close()}},{keys:[["Enter"],["Space"]],preventDefault:!1,callback:e=>{const n=t[i.getCurrentPage()];n instanceof CV&&(n.openOptions(),e.preventDefault()),n instanceof YV&&(n.activate(),e.preventDefault()),n instanceof tV||e.preventDefault()}}],BU)}function l(e){e.addLocalHook("afterSelectionChange",(e=>{e.key.startsWith("filter_")||i.clear()})),e.addLocalHook("afterSubmenuOpen",a),e.addLocalHook("afterOpen",a),n=e}return t.forEach((e=>{e instanceof tV&&(e.addLocalHook("click",s(e)),e.addLocalHook("focus",s(e)),e.addLocalHook("afterClose",s(e)))})),l(e),{...i,listen:function(){n.focus(),n.getKeyboardShortcutsCtrl().listen(BU)},setMenu:l,getMenu:function(){return n},getLastMenuPage:function(){return r}}}function jU(e,t,n){GU(e,t),t.set(e,n)}function GU(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function zU(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function $U(e,t,n){return e.set(KU(e,t),n),n}function YU(e,t){return e.get(KU(e,t))}function KU(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}const XU="filters",qU=XU;var QU=new WeakMap,ZU=new WeakMap,JU=new WeakMap,eB=new WeakSet;class tB extends Tx{static get PLUGIN_KEY(){return XU}static get PLUGIN_PRIORITY(){return 250}static get PLUGIN_DEPS(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}constructor(e){var t,n,r;super(e),t=this,GU(n=this,r=eB),r.add(n),zU(this,"dropdownMenuPlugin",null),zU(this,"conditionCollection",null),zU(this,"conditionUpdateObserver",null),zU(this,"components",new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]])),zU(this,"filtersRowsMap",null),jU(this,QU,void 0),jU(this,ZU,new WeakSet),jU(this,JU,[]),this.hot.addHook("afterGetColHeader",(function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return KU(eB,t,uB).call(t,...n)}))}isEnabled(){return!!this.hot.getSettings()[XU]}enablePlugin(){var e=this;if(this.enabled)return;this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new kE),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");const t=this.hot.getSettings().dropdownMenu,n=t&&t.uiContainer||this.hot.rootDocument.body,r=e=>(e.addLocalHook("accept",(()=>KU(eB,this,aB).call(this,"accept"))),e.addLocalHook("cancel",(()=>KU(eB,this,aB).call(this,"cancel"))),e.addLocalHook("change",(t=>KU(eB,this,lB).call(this,e,t))),e),i=()=>`${this.hot.getTranslatedPhrase(NT)}:`,o=()=>`${this.hot.getTranslatedPhrase(AT)}:`;if(!this.components.get("filter_by_condition")){const e=new MV(this.hot,{id:"filter_by_condition",name:i,addSeparator:!1,menuContainer:n});e.addLocalHook("afterClose",(()=>KU(eB,this,hB).call(this))),this.components.set("filter_by_condition",r(e))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new BV(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){const e=new MV(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:n});e.addLocalHook("afterClose",(()=>KU(eB,this,hB).call(this))),this.components.set("filter_by_condition2",r(e))}if(this.components.get("filter_by_value")||this.components.set("filter_by_value",r(new wU(this.hot,{id:"filter_by_value",name:o}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",r(new bU(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new IU(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new UU(this.hot,this.conditionCollection,(e=>this.getDataMapAtColumn(e))),this.conditionUpdateObserver.addLocalHook("update",(e=>KU(eB,this,cB).call(this,e)))),this.components.forEach((e=>e.show())),this.addHook("afterDropdownMenuDefaultOptions",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return KU(eB,e,sB).call(e,...n)})),this.addHook("beforeDropdownMenuShow",(()=>KU(eB,this,oB).call(this))),this.addHook("afterDropdownMenuShow",(()=>KU(eB,this,rB).call(this))),this.addHook("afterDropdownMenuHide",(()=>KU(eB,this,iB).call(this))),this.addHook("afterChange",(e=>KU(eB,this,nB).call(this,e))),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),!YU(QU,this)&&this.dropdownMenuPlugin.enabled){const e=[{focus:()=>{const e=YU(QU,this).getMenu(),t=e.getNavigator(),n=YU(QU,this).getLastMenuPage();e.focus(),n>0?t.setCurrentPage(n):t.toFirstItem()}},...Array.from(this.components).map((e=>{let[,t]=e;return t.getElements()})).flat()];$U(QU,this,WU(this.dropdownMenuPlugin.menu,e));const t=e=>{YU(QU,this).listen(),e.preventDefault(),Tm(e.keyCode,"TAB")&&(e.shiftKey?YU(QU,this).toPreviousItem():YU(QU,this).toNextItem())};this.components.get("filter_by_value").addLocalHook("listTabKeydown",t),this.components.get("filter_by_condition").addLocalHook("selectTabKeydown",t)}this.registerShortcuts(),super.enablePlugin()}disablePlugin(){var e;this.enabled&&(null!==(e=this.dropdownMenuPlugin)&&void 0!==e&&e.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach(((e,t)=>{e.destroy(),this.components.set(t,null)})),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName));this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Alt","A"]],stopPropagation:!0,callback:()=>{const e=this.hot.getSelected();this.clearConditions(),this.filter(),e&&this.hot.selectCells(e)},group:qU})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(qU)}addCondition(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:GD;const i=this.hot.toPhysicalColumn(e);this.conditionCollection.addCondition(i,{command:{key:t},args:n},r)}removeConditions(e){const t=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(t)}clearConditions(e){if(void 0===e)this.conditionCollection.clean();else{const t=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(t)}}importConditions(e){this.conditionCollection.importAllConditions(e)}exportConditions(){return this.conditionCollection.exportAllConditions()}filter(){const{navigableHeaders:e}=this.hot.getSettings(),t=this._createDataFilter(),n=!this.conditionCollection.isEmpty();let r=[];const i=this.exportConditions();if(!1!==this.hot.runHooks("beforeFilter",i,YU(JU,this))){if(n){const n=[];this.hot.batchExecution((()=>{this.filtersRowsMap.clear(),r=Dd(t.filter(),(e=>e.meta.visualRow));const e=kD(r);$w(this.hot.countSourceRows()-1,(t=>{e(t)||n.push(t)})),Vd(n,(e=>{this.filtersRowsMap.setValueAtIndex(e,!0)}))}),!0),e||r.length||this.hot.deselectCell()}else this.filtersRowsMap.clear();$U(JU,this,this.exportConditions()),this.hot.runHooks("afterFilter",i),this.hot.view.adjustElementsSize(),this.hot.render()}else this.importConditions(YU(JU,this));this.hot.selection.isSelected()&&this.hot.selectCell(e?-1:0,this.hot.getSelectedRangeLast().highlight.col)}getSelectedColumn(){var e;const t=null===(e=this.hot.getSelectedRangeLast())||void 0===e?void 0:e.highlight;return t?{visualIndex:t.col,physicalIndex:this.hot.toPhysicalColumn(t.col)}:null}getDataMapAtColumn(e){const t=this.hot.toVisualColumn(e),n=[];return Vd(this.hot.getSourceDataAtCol(t),((e,r)=>{var i;const{row:o,col:s,visualCol:a,visualRow:l,type:h,instance:u,dateFormat:c,locale:d}=this.hot.getCellMeta(r,t),p=null!==(i=this.hot.getDataAtCell(this.hot.toVisualRow(r),t))&&void 0!==i?i:e;n.push({meta:{row:o,col:s,visualCol:a,visualRow:l,type:h,instance:u,dateFormat:c,locale:d},value:FD(p)})})),n}updateValueComponentCondition(e){const t=DD(this.hot.getDataAtCol(e));this.conditionUpdateObserver.updateStatesAtColumn(e,t)}restoreComponents(e){var t;const n=null===(t=this.getSelectedColumn())||void 0===t?void 0:t.physicalIndex;e.forEach((e=>{e.isHidden()||e.restoreState(n)})),this.updateDependentComponentsVisibility()}getOperationBasedOnArguments(e,t,n,r){let i=e;return i===zD&&t.command.key!==vD&&n.command.key!==vD&&r.command.key!==vD?i=$D:r.command.key!==vD&&(t.command.key!==vD&&n.command.key!==vD||(i=GD)),i}setListeningDropdownMenu(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}updateDependentComponentsVisibility(){const e=this.components.get("filter_by_condition"),{command:t}=e.getState(),n=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];t.showOperators?this.showComponents(...n):this.hideComponents(...n)}_createDataFilter(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.conditionCollection;return new xU(e,(e=>this.getDataMapAtColumn(e)))}getIndexesOfComponents(){const e=[];if(!this.dropdownMenuPlugin)return e;const t=this.dropdownMenuPlugin.menu;for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Vd(r,(n=>{Vd(t.menuItems,((t,r)=>{t.key===n.getMenuItemDescriptor().key&&e.push(r)}))})),e}changeComponentsVisibility(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!this.dropdownMenuPlugin)return;const t=this.dropdownMenuPlugin.menu.hotMenu,n=t.getPlugin("hiddenRows");for(var r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];const s=this.getIndexesOfComponents(...i);e?n.showRows(s):n.hideRows(s),t.render()}hideComponents(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.changeComponentsVisibility(!1,...t)}showComponents(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.changeComponentsVisibility(!0,...t)}destroy(){this.enabled&&(this.components.forEach(((e,t)=>{null!==e&&(e.destroy(),this.components.set(t,null))})),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),super.destroy()}}function nB(e){e&&Vd(e,(e=>{const[,t]=e,n=this.hot.propToCol(t);this.conditionCollection.hasConditions(n)&&this.updateValueComponentCondition(n)}))}function rB(){const e=this.dropdownMenuPlugin.menu;this.restoreComponents(Array.from(this.components.values())),e.updateMenuDimensions()}function iB(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}function oB(){const e=this.dropdownMenuPlugin.menu;YU(ZU,this).has(e)||YU(QU,this).setMenu(e),YU(ZU,this).add(e)}function sB(e){e.items.push({name:xL}),this.components.forEach((t=>{e.items.push(t.getMenuItemDescriptor())}))}function aB(e){var t;if("accept"===e){const e=this.getSelectedColumn();var n;if(null===e)return void(null===(n=this.dropdownMenuPlugin)||void 0===n||n.close());const{physicalIndex:t}=e,r=this.components.get("filter_by_condition").getState(),i=this.components.get("filter_by_condition2").getState(),o=this.components.get("filter_by_value").getState(),s=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),r,i,o);this.conditionUpdateObserver.groupChanges();let a=this.conditionCollection.getColumnStackPosition(t);-1===a&&(a=void 0),this.conditionCollection.removeConditions(t),r.command.key!==vD&&(this.conditionCollection.addCondition(t,r,s,a),i.command.key!==vD&&this.conditionCollection.addCondition(t,i,s,a)),o.command.key!==vD&&this.conditionCollection.addCondition(t,o,s,a),this.conditionUpdateObserver.flush(),this.components.forEach((e=>e.saveState(t))),this.filter()}null===(t=this.dropdownMenuPlugin)||void 0===t||t.close()}function lB(e,t){const n=this.dropdownMenuPlugin.menu;this.updateDependentComponentsVisibility(),e.constructor!==MV||t.inputsCount||this.setListeningDropdownMenu(),n.updateMenuDimensions()}function hB(){this.setListeningDropdownMenu()}function uB(e,t,n){const r=this.hot.toPhysicalColumn(e);this.enabled&&this.conditionCollection.hasConditions(r)&&n===this.hot.view.getColumnHeadersCount()-1?Op(t,"htFiltersActive"):xp(t,"htFiltersActive")}function cB(e){var t;if(null===(t=this.dropdownMenuPlugin)||void 0===t||!t.enabled)return;const{editedConditionStack:{conditions:n,column:r},conditionArgsChange:i}=e;Array.isArray(i)&&$U(JU,this,YU(JU,this).map((e=>(e.column===r&&n.length>0&&e.conditions.forEach((e=>{"by_value"===e.name&&(e.args=[[...i]])})),e))));const o=n.filter((e=>e.name===UD)),s=n.filter((e=>e.name!==UD));if(o.length>=2||s.length>=3)Om(Wd`The filter conditions have been applied properly, but couldnât be displayed visually.\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\x20
        For more details see the documentation.`);else{const t=this.conditionCollection.getOperation(r);this.components.get("filter_by_condition").updateState(s[0],r),this.components.get("filter_by_condition2").updateState(s[1],r),this.components.get("filter_operators").updateState(t,r),this.components.get("filter_by_value").updateState(e)}}const dB="internal-use-in-handsontable",pB={licenseKey:dB,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!1,nullDate:{year:1899,month:12,day:30},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function gB(e){var t;return{maxColumns:e.maxColumns,maxRows:e.maxRows,language:null===(t=e[iW])||void 0===t||null===(t=t.language)||void 0===t?void 0:t.langCode}}function mB(e){return Object.keys(e).reduce(((t,n)=>("hyperformula"!==n&&(t[n]=e[n]),t)),{})}function fB(){const e="engine_relationship",t=yf(iW);return t.hasItem(e)||t.register(e,new Map),t.getItem(e)}function wB(){const e="shared_engine_usage",t=yf(iW);return t.hasItem(e)||t.register(e,new Map),t.getItem(e)}function yB(e){const t=e.getSettings(),n=t[iW],r=null==n?void 0:n.engine;if(!0===n)return null;if(zd(r))return null;var i;if("function"==typeof r.hyperformula||"function"==typeof r)return function(e,t,n){const r=t[iW],i=function(e){var t;const n=e[iW],r=mB(null!=n&&null!==(t=n.engine)&&void 0!==t&&t.hyperformula?n.engine:{}),i=gB(e);return{...pB,...r,...i}}(t),o=fB(),s=wB();(function(e,t){t&&t.forEach((t=>{const{name:n,plugin:r,translations:i}=t;try{e.registerFunction(n,r,i)}catch(o){Om(o.message)}}))})(e,r.functions),function(e,t){if(t){const{langCode:r}=t;try{e.registerLanguage(r,t)}catch(n){Om(n.message)}}}(e,r.language);const a=e.buildEmpty(i);return o.set(a,[n]),s.set(a,[n.guid]),function(e,t){t&&(e.suspendEvaluation(),t.forEach((t=>{const{name:n,expression:r,scope:i,options:o}=t;try{e.addNamedExpression(n,r,i,o)}catch(s){Om(s.message)}})),e.resumeEvaluation())}(a,r.namedExpressions),a.on("sheetAdded",(()=>{a.rebuildAndRecalculate()})),a.on("sheetRemoved",(()=>{a.rebuildAndRecalculate()})),a}(null!==(i=r.hyperformula)&&void 0!==i?i:r,t,e);if("object"==typeof r&&zd(r.hyperformula)){const t=fB(),n=wB().get(r);return t.has(r)||t.set(r,[]),t.get(r).push(e),n&&n.push(e.guid),r.getConfig().licenseKey||r.updateConfig({licenseKey:dB}),r.getConfig().leapYear1900===pB.leapYear1900&&!1!==Jg(r.getConfig().nullDate,pB.nullDate)||Om(Wd`If you use HyperFormula with Handsontable, keep the default \`leapYear1900\` and \`nullDate\` 
      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates.`),r}return null}function vB(e){var t;const n=fB(),r=0===n.size?[]:Array.from(null!==(t=n.get(e))&&void 0!==t?t:[]);return new Map(r.map((e=>[e.getPlugin("formulas").sheetId,e])))}function CB(e,t){if(e){const n=fB(),r=n.get(e),i=wB(),o=i.get(e);r&&r.includes(t)&&(r.splice(r.indexOf(t),1),0===r.length&&n.delete(e)),o&&o.includes(t.guid)&&(o.splice(o.indexOf(t.guid),1),0===o.length&&(i.delete(e),e.destroy()))}}const SB="DD/MM/YYYY";function RB(e){return"string"==typeof e&&"'"===e.charAt(0)&&"="===e.charAt(1)}function EB(e,t){return"string"==typeof e&&"date"===t}function bB(e,t){return M(e,t,!0).isValid()}function TB(e,t){return M(e,t,!0).format(SB)}function NB(e,t){const n=new Date(Date.UTC(0,0,e+-1));return M(n).format(t)}function AB(e,t,n){const r=function(e,t){const n=[];return e.forEach((e=>{const r={from:e,to:t};n.forEach((e=>{const t=e.from>e.to,n=e.to<=r.from;e.from>r.from&&n&&t&&(r.from+=1)})),r.from>=t&&(t+=1),n.push(r)})),n}(e,function(e,t,n){const r=Array.from(Array(n).keys()).filter((t=>!1===e.includes(t)));var i;return 0===t?null!==(i=r[t])&&void 0!==i?i:0:r[t-1]+1}(e,t,n));return function(e){return e.forEach(((t,n)=>{e.slice(n+1).forEach((e=>{const n=e.from<e.to;e.from>t.from&&n&&(e.from-=1)}))})),e}(r)}function MB(e,t,n){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,n)}function IB(e,t){return e.get(xB(e,t))}function OB(e,t,n){return e.set(xB(e,t),n),n}function xB(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var PB=new WeakMap,_B=new WeakMap,LB=new WeakMap,HB=new WeakMap,kB=new WeakMap,FB=new WeakMap,DB=new WeakMap;const VB=class{constructor(e,t,n){MB(this,PB,void 0),MB(this,_B,void 0),MB(this,LB,void 0),MB(this,HB,[]),MB(this,kB,[]),MB(this,FB,void 0),MB(this,DB,[]),OB(PB,this,e),OB(_B,this,t),OB(LB,this,n)}setRemovedHfIndexes(e){return OB(DB,this,e.map((e=>{const t=IB(_B,this).getVisualFromPhysicalIndex(e);return this.getHfIndexFromVisualIndex(t)}))),IB(DB,this)}getRemovedHfIndexes(){return IB(DB,this)}getHfIndexFromVisualIndex(e){const t=IB(_B,this).getIndexesSequence(),n=IB(_B,this).getNotTrimmedIndexes();return t.indexOf(n[e])}syncMoves(e){const t=`move${rp(IB(PB,this))}s`;IB(LB,this).getEngine().batch((()=>{e.forEach((e=>{const n=e.from!==e.to,r=e.from+1!==e.to;n&&r&&IB(LB,this).getEngine()[t](IB(LB,this).getSheetId(),e.from,1,e.to)}))}))}storeMovesInformation(e,t,n){!1!==n&&(OB(kB,this,e.map((e=>this.getHfIndexFromVisualIndex(e)))),OB(FB,this,this.getHfIndexFromVisualIndex(t)))}calculateAndSyncMoves(e,t){if(IB(LB,this).isPerformingUndoRedo())return;if(!1===e||!1===t)return;const n=AB(IB(kB,this),IB(FB,this),IB(_B,this).getNumberOfIndexes());null===IB(LB,this).getSheetId()?IB(LB,this).getPostponeAction((()=>this.syncMoves(n))):this.syncMoves(n)}getIndexesChangeSyncMethod(){const e=`set${rp(IB(PB,this))}Order`;return t=>{if(IB(LB,this).isPerformingUndoRedo())return;const n=IB(_B,this).getIndexesSequence();if("update"===t&&n.length>0){const t=IB(HB,this).map((e=>n.indexOf(e))),r=IB(LB,this).getEngine().getSheetDimensions(IB(LB,this).getSheetId());let i;i="row"===IB(PB,this)?r.height:r.width;for(let e=t.length;e<i;e+=1)t.push(e);IB(LB,this).getEngine()[e](IB(LB,this).getSheetId(),t)}OB(HB,this,n)}}init(){OB(HB,this,IB(_B,this).getIndexesSequence())}};function UB(e,t,n){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,n)}function BB(e,t){return e.get(jB(e,t))}function WB(e,t,n){return e.set(jB(e,t),n),n}function jB(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var GB=new WeakMap,zB=new WeakMap,$B=new WeakMap,YB=new WeakMap,KB=new WeakMap,XB=new WeakMap,qB=new WeakMap;const QB=class{constructor(e,t,n){UB(this,GB,void 0),UB(this,zB,void 0),UB(this,$B,void 0),UB(this,YB,!1),UB(this,KB,!1),UB(this,XB,null),UB(this,qB,null),WB(GB,this,new VB("row",e,this)),WB(zB,this,new VB("column",t,this)),WB($B,this,n)}getForAxis(e){return BB("row"===e?GB:zB,this)}setPerformUndo(e){WB(YB,this,e)}setPerformRedo(e){WB(KB,this,e)}isPerformingUndoRedo(){return BB(YB,this)||BB(KB,this)}getSheetId(){return BB(qB,this)}getEngine(){return BB(XB,this)}getPostponeAction(){return BB($B,this)}setupSyncEndpoint(e,t){WB(XB,this,e),WB(qB,this,t),BB(GB,this).init(),BB(zB,this).init()}};function ZB(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function JB(e,t,n){eW(e,t),t.set(e,n)}function eW(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function tW(e,t,n){return e.set(rW(e,t),n),n}function nW(e,t){return e.get(rW(e,t))}function rW(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}const iW="formulas",oW=["maxRows","maxColumns","language"];mf.getSingleton().register("afterNamedExpressionAdded"),mf.getSingleton().register("afterNamedExpressionRemoved"),mf.getSingleton().register("afterSheetAdded"),mf.getSingleton().register("afterSheetRemoved"),mf.getSingleton().register("afterSheetRenamed"),mf.getSingleton().register("afterFormulasValuesUpdate");const sW=e=>"UndoRedo.undo"===e||"UndoRedo.redo"===e||"auto"===e;var aW=new WeakMap,lW=new WeakMap,hW=new WeakMap,uW=new WeakSet;class cW extends Tx{constructor(){var e,t,n;super(...arguments),e=this,eW(t=this,n=uW),n.add(t),JB(this,aW,!1),JB(this,lW,!1),JB(this,hW,[["valuesUpdated",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return rW(uW,e,OW).call(e,...n)}],["namedExpressionAdded",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return rW(uW,e,xW).call(e,...n)}],["namedExpressionRemoved",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return rW(uW,e,PW).call(e,...n)}],["sheetAdded",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return rW(uW,e,_W).call(e,...n)}],["sheetRenamed",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return rW(uW,e,LW).call(e,...n)}],["sheetRemoved",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return rW(uW,e,HW).call(e,...n)}]]),ZB(this,"staticRegister",yf("formulas")),ZB(this,"engine",null),ZB(this,"sheetName",null),ZB(this,"indexSyncer",null),ZB(this,"rowAxisSyncer",null),ZB(this,"columnAxisSyncer",null)}static get PLUGIN_KEY(){return iW}static get PLUGIN_PRIORITY(){return 260}static get SETTING_KEYS(){return[iW,...oW]}get sheetId(){return null===this.sheetName?null:this.engine.getSheetId(this.sheetName)}isEnabled(){return!!this.hot.getSettings()[iW]}enablePlugin(){var e,t=this;if(!this.enabled)if(this.engine=null!==(e=yB(this.hot))&&void 0!==e?e:this.engine,this.engine){if(null!==this.sheetName&&!this.engine.doesSheetExist(this.sheetName)){const e=this.addSheet(this.sheetName,this.hot.getSourceDataArray());!1!==e&&(this.sheetName=e)}this.addHook("beforeLoadData",(function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return rW(uW,t,gW).call(t,...n)})),this.addHook("afterLoadData",(function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return rW(uW,t,fW).call(t,...n)})),this.addHook("beforeUpdateData",(function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return rW(uW,t,gW).call(t,...n)})),this.addHook("afterUpdateData",(function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return rW(uW,t,fW).call(t,...n)})),this.addHook("modifyData",(function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return rW(uW,t,wW).call(t,...n)})),this.addHook("modifySourceData",(function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return rW(uW,t,yW).call(t,...n)})),this.addHook("beforeValidate",(function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return rW(uW,t,dW).call(t,...n)})),this.addHook("afterSetSourceDataAtCell",(function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return rW(uW,t,CW).call(t,...n)})),this.addHook("afterSetDataAtCell",(function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return rW(uW,t,vW).call(t,...n)})),this.addHook("afterSetDataAtRowProp",(function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return rW(uW,t,vW).call(t,...n)})),this.addHook("beforeCreateRow",(function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return rW(uW,t,SW).call(t,...n)})),this.addHook("beforeCreateCol",(function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return rW(uW,t,RW).call(t,...n)})),this.addHook("afterCreateRow",(function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return rW(uW,t,TW).call(t,...n)})),this.addHook("afterCreateCol",(function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return rW(uW,t,NW).call(t,...n)})),this.addHook("beforeRemoveRow",(function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return rW(uW,t,EW).call(t,...n)})),this.addHook("beforeRemoveCol",(function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return rW(uW,t,bW).call(t,...n)})),this.addHook("afterRemoveRow",(function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return rW(uW,t,AW).call(t,...n)})),this.addHook("afterRemoveCol",(function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return rW(uW,t,MW).call(t,...n)})),this.indexSyncer=new QB(this.hot.rowIndexMapper,this.hot.columnIndexMapper,(e=>{this.hot.addHookOnce("init",(()=>{e()}))})),this.rowAxisSyncer=this.indexSyncer.getForAxis("row"),this.columnAxisSyncer=this.indexSyncer.getForAxis("column"),this.hot.addHook("afterRowSequenceChange",this.rowAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("afterColumnSequenceChange",this.columnAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("beforeRowMove",((e,t,n,r)=>{this.rowAxisSyncer.storeMovesInformation(e,t,r)})),this.hot.addHook("beforeColumnMove",((e,t,n,r)=>{this.columnAxisSyncer.storeMovesInformation(e,t,r)})),this.hot.addHook("afterRowMove",((e,t,n,r,i)=>{this.rowAxisSyncer.calculateAndSyncMoves(r,i)})),this.hot.addHook("afterColumnMove",((e,t,n,r,i)=>{this.columnAxisSyncer.calculateAndSyncMoves(r,i)})),this.hot.addHook("beforeColumnFreeze",((e,t)=>{this.columnAxisSyncer.storeMovesInformation([e],this.hot.getSettings().fixedColumnsStart,t)})),this.hot.addHook("afterColumnFreeze",((e,t)=>{this.columnAxisSyncer.calculateAndSyncMoves(t,t)})),this.hot.addHook("beforeColumnUnfreeze",((e,t)=>{this.columnAxisSyncer.storeMovesInformation([e],this.hot.getSettings().fixedColumnsStart-1,t)})),this.hot.addHook("afterColumnUnfreeze",((e,t)=>{this.columnAxisSyncer.calculateAndSyncMoves(t,t)})),this.addHook("afterCellMetaReset",(function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return rW(uW,t,mW).call(t,...n)})),this.addHook("beforeUndo",(()=>{this.indexSyncer.setPerformUndo(!0),this.engine.undo()})),this.addHook("beforeRedo",(()=>{this.indexSyncer.setPerformRedo(!0),this.engine.redo()})),this.addHook("afterUndo",(()=>{this.indexSyncer.setPerformUndo(!1)})),this.addHook("afterUndo",(()=>{this.indexSyncer.setPerformRedo(!1)})),this.addHook("afterDetachChild",(function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return rW(uW,t,IW).call(t,...n)})),this.addHook("beforeAutofill",(function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return rW(uW,t,pW).call(t,...n)})),nW(hW,this).forEach((e=>{let[t,n]=e;return this.engine.on(t,n)})),super.enablePlugin()}else Om("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.")}disablePlugin(){nW(hW,this).forEach((e=>{let[t,n]=e;return this.engine.off(t,n)})),CB(this.engine,this.hot),this.engine=null,super.disablePlugin()}updatePlugin(e){const t=function(e){var t;const n=e[iW];return{...mB(null!=n&&null!==(t=n.engine)&&void 0!==t&&t.hyperformula?n.engine:{}),...gB(e)}}(this.hot.getSettings());(function(e,t){return Object.keys(t).some((n=>void 0!==t[n]&&t[n]!==e[n]))})(this.engine.getConfig(),t)&&this.engine.updateConfig(t);const n=this.hot.getSettings()[iW];if(Gd(n)&&Gd(n.sheetName)&&n.sheetName!==this.sheetName&&this.switchSheet(n.sheetName),!e.data&&null===this.sheetName){const e=this.hot.getSettings()[iW].sheetName;e&&this.engine.doesSheetExist(e)?this.switchSheet(this.sheetName):this.sheetName=this.addSheet(null!=e?e:void 0,this.hot.getSourceDataArray())}super.updatePlugin(e)}destroy(){nW(hW,this).forEach((e=>{var t;let[n,r]=e;return null===(t=this.engine)||void 0===t?void 0:t.off(n,r)})),tW(hW,this,null),CB(this.engine,this.hot),this.engine=null,super.destroy()}addSheet(e,t){if(Gd(t)&&!function(e){return!!(Array.isArray(e)&&e.length&&e.every((e=>Array.isArray(e))))}(t))return Om("The provided data should be an array of arrays."),!1;if(null!=e&&this.engine.doesSheetExist(e))return Om("Sheet with the provided name already exists."),!1;try{const n=this.engine.addSheet(null!=e?e:void 0);return t&&this.engine.setSheetContent(this.engine.getSheetId(n),t),n}catch(n){return Om(n.message),!1}}switchSheet(e){if(!this.engine.doesSheetExist(e))return void xm(`The sheet named \`${e}\` does not exist, switch aborted.`);this.sheetName=e;const t=this.engine.getSheetSerialized(this.sheetId);t.length>0&&this.hot.loadData(t,`${rp(iW)}.switchSheet`)}getCellType(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.sheetId;const r=this.hot.toPhysicalRow(e),i=this.hot.toPhysicalColumn(t);return null!==r&&null!==i?this.engine.getCellType({sheet:n,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(t)}):"EMPTY"}isFormulaCellType(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.sheetId;return this.engine.doesCellHaveFormula({sheet:n,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(t)})}renderDependentSheets(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=new Set;e.forEach((e=>{var t;const r=null==e||null===(t=e.address)||void 0===t?void 0:t.sheet;void 0!==r&&(n.has(r)||n.add(r))})),vB(this.engine).forEach(((e,r)=>{var i;(t||r!==this.sheetId)&&n.has(r)&&(e.render(),null===(i=e.view)||void 0===i||i.adjustElementsSize())}))}validateDependentCells(e){const t=e=>{var t;const{row:n,col:r,sheet:i}=null!==(t=null==e?void 0:e.address)&&void 0!==t?t:{};return Gd(i)?`${i}:${n}x${r}`:""},n=new Set((arguments.length>1&&void 0!==arguments[1]?arguments[1]:[]).map((e=>t(e))));e.forEach((e=>{var r,i;const{row:o,col:s}=null!==(r=e.address)&&void 0!==r?r:{};if(!1===Gd(o)||!1===Gd(s)||o>=this.hot.countRows()||s>=this.hot.countCols())return;const a=null==e||null===(i=e.address)||void 0===i?void 0:i.sheet,l=t(e);if(void 0!==a&&!n.has(l)){const e=vB(this.engine).get(a);if(!e)return;e.validateCell(e.getDataAtCell(o,s),e.getCellMeta(o,s),(()=>{}))}}))}syncChangeWithEngine(e,t,n){const r={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(t),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(r))return void Om(`Not possible to set cell data at ${JSON.stringify(r)}`);const i=this.hot.getCellMeta(e,t);var o;return EB(n,i.type)&&(bB(n,i.dateFormat)?n=TB(n,i.dateFormat):!1===("string"==typeof(o=n)&&o.startsWith("="))&&(n=`'${n}`)),this.engine.setCellContents(r,n)}}function dW(e,t,n){const r=this.hot.propToCol(n);if(this.isFormulaCellType(t,r)){const e={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(t),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(r),sheet:this.sheetId},n=this.hot.getCellMeta(t,r);let i=this.engine.getCellValue(e);return"date"===n.type&&zw(i)&&(i=NB(i,n.dateFormat)),"object"==typeof i&&null!==i?i.value:i}return e}function pW(e,t,n){const{row:r,col:i}=t.getTopStartCorner(),{row:o,col:s}=t.getBottomEndCorner(),{row:a,col:l}=n.getTopStartCorner(),{row:h,col:u}=n.getBottomEndCorner(),c={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(r),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(s),sheet:this.sheetId}},d={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(a),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(h),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(u),sheet:this.sheetId}};if(!1===this.engine.isItPossibleToSetCellContents(d))return!1;const p=this.engine.getFillRangeData(c,d),{row:g,col:m}=c.start,{row:f,col:w}=c.end,y=f-g+1,v=w-m+1;for(let R=0;R<p.length;R+=1)for(let e=0;e<p[R].length;e+=1){const t=p[R][e],n=g+R%y,r=m+e%v,i=this.hot.getCellMeta(n,r);EB(t,i.type)&&(t.startsWith("'")?p[R][e]=t.slice(1):!1===this.isFormulaCellType(n,r,this.sheetId)&&(p[R][e]=(C=t,S=i.dateFormat,M(C,SB,!0).format(S))))}var C,S;return p}function gW(e,t){(arguments.length>2&&void 0!==arguments[2]?arguments[2]:"").includes(rp(iW))||tW(lW,this,zd(this.hot.getSettings().data))}function mW(){const e=this.hot.getSourceDataArray();let t=!1;e.forEach(((n,r)=>{n.forEach(((n,i)=>{const o=this.hot.getCellMeta(r,i),s=o.dateFormat;EB(n,o.type)&&(t=!0,bB(n,s)?e[r][i]=TB(n,s):!1===this.isFormulaCellType(r,i)&&(e[r][i]=`'${n}`))}))})),!0===t&&(tW(aW,this,!0),this.engine.setSheetContent(this.sheetId,e),tW(aW,this,!1))}function fW(e,t){var n,r;if(!(arguments.length>2&&void 0!==arguments[2]?arguments[2]:"").includes(rp(iW)))if(this.sheetName=(n=this.engine,!zd(r=this.hot.getSettings()[iW].sheetName)&&n.doesSheetExist(r)||(r=n.addSheet(r)),r),nW(lW,this))this.switchSheet(this.sheetName);else{const e=this.hot.getSourceDataArray();if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,e)){tW(aW,this,!0);const t=this.engine.setSheetContent(this.sheetId,e);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(t),tW(aW,this,!1)}}}function wW(e,t,n,r){if("get"!==r||nW(aW,this)||null===this.sheetName||!this.engine.doesSheetExist(this.sheetName))return;const i=this.hot.toVisualRow(e);if(null===i||null===t)return;if(!this.isFormulaCellType(i,t)){if("ARRAY"!==this.getCellType(i,t))return void(RB(n.value)&&(n.value=RB(o=n.value)?o.substr(1):o))}var o;const s={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(t),sheet:this.sheetId};let a=this.engine.getCellValue(s),l=this.hot.getCellsMeta().find((e=>e.visualRow===i&&e.visualCol===t));void 0===l&&(l={}),"date"===l.type&&zw(a)&&(a=NB(a,l.dateFormat));const h="object"==typeof a&&null!==a?a.value:a;n.value=h}function yW(e,t,n,r){if("get"!==r||nW(aW,this)||null===this.sheetName||!this.engine.doesSheetExist(this.sheetName))return;const i=this.hot.toVisualRow(e),o=this.hot.propToCol(t);if(null===i||null===o)return;if(!this.isFormulaCellType(i,o)){if("ARRAY"!==this.getCellType(i,o))return}const s=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(0===s.width&&0===s.height)return;const a={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(o),sheet:this.sheetId};n.value=this.engine.getCellSerialized(a)}function vW(e,t){if(sW(t))return;const n=[],r=[],i=this.engine.batch((()=>{e.forEach((e=>{let[t,i,,o]=e;const s=this.hot.propToCol(i),a=this.hot.toPhysicalRow(t),l=this.hot.toPhysicalColumn(s),h={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(t),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(s),sheet:this.sheetId};null!==a&&null!==l?this.syncChangeWithEngine(t,s,o):n.push([t,s,o]),r.push({address:h})}))}));n.length&&this.hot.addHookOnce("afterChange",(()=>{const e=this.engine.batch((()=>{n.forEach((e=>{let[t,n,r]=e;this.syncChangeWithEngine(t,n,r)}))}));this.renderDependentSheets(e,!0)})),this.renderDependentSheets(i),this.validateDependentCells(i,r)}function CW(e,t){if(sW(t))return;const n=[],r=[];e.forEach((e=>{let[t,i,,o]=e;const s=this.hot.propToCol(i);if(!zw(s))return;const a={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(t),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(s),sheet:this.sheetId};this.engine.isItPossibleToSetCellContents(a)?(r.push({address:a}),n.push(...this.engine.setCellContents(a,o))):Om(`Not possible to set source cell data at ${JSON.stringify(a)}`)})),this.renderDependentSheets(n),this.validateDependentCells(n,r)}function SW(e,t){let n=this.rowAxisSyncer.getHfIndexFromVisualIndex(e);if(e>=this.hot.countRows()&&(n=e),null===this.sheetId||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[n,t]))return!1}function RW(e,t){let n=this.columnAxisSyncer.getHfIndexFromVisualIndex(e);if(e>=this.hot.countCols()&&(n=e),null===this.sheetId||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[n,t]))return!1}function EW(e,t,n){return!1!==this.rowAxisSyncer.setRemovedHfIndexes(n).every((e=>this.engine.isItPossibleToRemoveRows(this.sheetId,[e,1])))&&void 0}function bW(e,t,n){return!1!==this.columnAxisSyncer.setRemovedHfIndexes(n).every((e=>this.engine.isItPossibleToRemoveColumns(this.sheetId,[e,1])))&&void 0}function TW(e,t,n){if(sW(n))return;const r=this.engine.addRows(this.sheetId,[this.rowAxisSyncer.getHfIndexFromVisualIndex(e),t]);this.renderDependentSheets(r)}function NW(e,t,n){if(sW(n))return;const r=this.engine.addColumns(this.sheetId,[this.columnAxisSyncer.getHfIndexFromVisualIndex(e),t]);this.renderDependentSheets(r)}function AW(e,t,n,r){if(sW(r))return;const i=this.rowAxisSyncer.getRemovedHfIndexes().sort(((e,t)=>t-e)),o=this.engine.batch((()=>{i.forEach((e=>{this.engine.removeRows(this.sheetId,[e,1])}))}));this.renderDependentSheets(o)}function MW(e,t,n,r){if(sW(r))return;const i=this.columnAxisSyncer.getRemovedHfIndexes().sort(((e,t)=>t-e)),o=this.engine.batch((()=>{i.forEach((e=>{this.engine.removeColumns(this.sheetId,[e,1])}))}));this.renderDependentSheets(o)}function IW(e,t,n){var r;tW(aW,this,!0);const i=this.hot.getSourceDataArray(n,0,n+((null===(r=t.__children)||void 0===r?void 0:r.length)||0),this.hot.countSourceCols());tW(aW,this,!1),i.forEach(((e,t)=>{e.forEach(((e,r)=>{this.engine.setCellContents({col:r,row:n+t,sheet:this.sheetId},[[e]])}))}))}function OW(e){this.hot.runHooks("afterFormulasValuesUpdate",e)}function xW(e,t){this.hot.runHooks("afterNamedExpressionAdded",e,t)}function PW(e,t){this.hot.runHooks("afterNamedExpressionRemoved",e,t)}function _W(e){this.hot.runHooks("afterSheetAdded",e)}function LW(e,t){this.sheetName=t,this.hot.runHooks("afterSheetRenamed",e,t)}function HW(e,t){this.hot.runHooks("afterSheetRemoved",e,t)}function kW(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function FW(e,t){return e.get(VW(e,t))}function DW(e,t,n){return e.set(VW(e,t),n),n}function VW(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}mf.getSingleton().register("beforeHideColumns"),mf.getSingleton().register("afterHideColumns"),mf.getSingleton().register("beforeUnhideColumns"),mf.getSingleton().register("afterUnhideColumns");const UW="hiddenColumns";var BW=new WeakMap,WW=new WeakSet;class jW extends Tx{constructor(){var e,t;super(...arguments),kW(e=this,t=WW),t.add(e),function(e,t,n){kW(e,t),t.set(e,n)}(this,BW,null)}static get PLUGIN_KEY(){return UW}static get PLUGIN_PRIORITY(){return 310}static get DEFAULT_SETTINGS(){return{copyPasteEnabled:!0,indicators:!1,columns:[]}}isEnabled(){return!!this.hot.getSettings()[UW]}enablePlugin(){var e=this;this.enabled||(DW(BW,this,new IE),FW(BW,this).addLocalHook("init",(()=>VW(WW,this,XW).call(this))),this.hot.columnIndexMapper.registerMap(this.pluginName,FW(BW,this)),this.addHook("afterContextMenuDefaultOptions",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return VW(WW,e,KW).call(e,...n)})),this.addHook("afterGetCellMeta",((e,t,n)=>VW(WW,this,zW).call(this,e,t,n))),this.addHook("modifyColWidth",((e,t)=>VW(WW,this,GW).call(this,e,t)),2),this.addHook("afterGetColHeader",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return VW(WW,e,YW).call(e,...n)})),this.addHook("modifyCopyableRange",(e=>VW(WW,this,$W).call(this,e))),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),super.disablePlugin(),this.resetCellsMeta()}showColumns(e){const t=this.getHiddenColumns(),n=this.isValidConfig(e);let r=t;const i=FW(BW,this).getValues().slice(),o=e.length>0;if(n&&o){Vd(e.map((e=>this.hot.toPhysicalColumn(e))),(e=>{i[e]=!1})),r=kd(i,((e,t,n)=>(t&&e.push(this.hot.toVisualColumn(n)),e)),[])}!1!==this.hot.runHooks("beforeUnhideColumns",t,r,n&&o)&&(n&&o&&FW(BW,this).setValues(i),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",t,r,n&&o,n&&r.length<t.length))}showColumn(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.showColumns(t)}hideColumns(e){const t=this.getHiddenColumns(),n=this.isValidConfig(e);let r=t;n&&(r=Array.from(new Set(t.concat(e))));!1!==this.hot.runHooks("beforeHideColumns",t,r,n)&&(n&&this.hot.batchExecution((()=>{Vd(e,(e=>{FW(BW,this).setValueAtIndex(this.hot.toPhysicalColumn(e),!0)}))}),!0),this.hot.runHooks("afterHideColumns",t,r,n,n&&r.length>t.length))}hideColumn(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.hideColumns(t)}getHiddenColumns(){return Dd(FW(BW,this).getHiddenIndexes(),(e=>this.hot.toVisualColumn(e)))}isHidden(e){return FW(BW,this).getValueAtIndex(this.hot.toPhysicalColumn(e))||!1}isValidConfig(e){const t=this.hot.countCols();return!!(Array.isArray(e)&&e.length>0)&&e.every((e=>Number.isInteger(e)&&e>=0&&e<t))}resetCellsMeta(){Vd(this.hot.getCellsMeta(),(e=>{e.skipColumnOnPaste=!1}))}destroy(){DW(BW,this,null),super.destroy()}}function GW(e,t){return this.isHidden(t)?0:this.getSetting("indicators")&&(this.isHidden(t+1)||this.isHidden(t-1))&&"number"==typeof e&&this.hot.hasColHeaders()?e+15:void 0}function zW(e,t,n){if(!1===this.getSetting("copyPasteEnabled")&&this.isHidden(t)&&(n.skipColumnOnPaste=!0),this.isHidden(t-1))n.className=n.className||"",-1===n.className.indexOf("afterHiddenColumn")&&(n.className+=" afterHiddenColumn");else if(n.className){const e=n.className.split(" ");if(e.length>0){const t=e.indexOf("afterHiddenColumn");t>-1&&e.splice(t,1),n.className=e.join(" ")}}}function $W(e){if(this.getSetting("copyPasteEnabled"))return e;const t=[],n=(e,n,r,i)=>{t.push({startRow:e,endRow:n,startCol:r,endCol:i})};return Vd(e,(e=>{let t=!0,r=0;$w(e.startCol,e.endCol,(i=>{this.isHidden(i)?(t||n(e.startRow,e.endRow,r,i-1),t=!0):(t&&(r=i),i===e.endCol&&n(e.startRow,e.endRow,r,i),t=!1)}))})),t}function YW(e,t){if(!this.getSetting("indicators")||e<0)return;const n=[];e>=1&&this.isHidden(e-1)&&n.push("afterHiddenColumn"),e<this.hot.countCols()-1&&this.isHidden(e+1)&&n.push("beforeHiddenColumn"),Op(t,n)}function KW(e){var t;e.items.push({name:xL},(t=this,{key:"hidden_columns_hide",name(){const e=this.getSelectedLast();let t=0;if(Array.isArray(e)){const[,n,,r]=e;n-r!=0&&(t=1)}return this.getTranslatedPhrase(Jb,t)},callback(){const{from:e,to:n}=this.getSelectedRangeLast(),r=Math.max(Math.min(e.col,n.col),0),i=Math.max(e.col,n.col),o=[];for(let t=r;t<=i;t+=1)o.push(t);t.hideColumns(o);const s=o[o.length-1],a=this.columnIndexMapper.getNearestNotHiddenIndex(s,1,!0);Number.isInteger(a)&&a>=0?this.selectColumns(a):this.deselectCell(),this.render(),this.view.adjustElementsSize()},disabled:!1,hidden(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}),function(e){const t=[];return{key:"hidden_columns_show",name(){const e=t.length>1?1:0;return this.getTranslatedPhrase(eT,e)},callback(){var n,r;if(0===t.length)return;let i=t[0],o=t[t.length-1];i=null!==(n=this.columnIndexMapper.getNearestNotHiddenIndex(i-1,-1))&&void 0!==n?n:0,o=null!==(r=this.columnIndexMapper.getNearestNotHiddenIndex(o+1,1))&&void 0!==r?r:this.countCols()-1,e.showColumns(t),this.render(),this.view.adjustElementsSize(),o-i+1===this.countCols()||this.selectColumns(i,o)},disabled:!1,hidden(){const n=Dd(e.getHiddenColumns(),(e=>this.toPhysicalColumn(e)));if(!this.selection.isSelectedByColumnHeader()&&!this.selection.isSelectedByCorner()||n.length<1)return!0;t.length=0;const r=this.getSelectedRangeLast(),i=r.getTopStartCorner().col,o=r.getBottomEndCorner().col,s=this.columnIndexMapper,a=s.getRenderableFromVisualIndex(i),l=s.getRenderableFromVisualIndex(o),h=s.getNotTrimmedIndexes(),u=[];if(i!==o){if(o-i+1>l-a+1){const e=h.slice(i,o+1);u.push(...e.filter((e=>n.includes(e))))}}else if(0===a&&a<i)u.push(...h.slice(0,i));else if(null===a)u.push(...h.slice(0,this.countCols()));else{const e=this.countCols()-1;l===s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(e,-1))&&e>o&&u.push(...h.slice(o+1))}return Vd(u,(e=>{t.push(this.toVisualColumn(e))})),0===t.length}}}(this))}function XW(){const e=this.getSetting("columns");Array.isArray(e)&&this.hideColumns(e)}function qW(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function QW(e,t){return e.get(JW(e,t))}function ZW(e,t,n){return e.set(JW(e,t),n),n}function JW(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}mf.getSingleton().register("beforeHideRows"),mf.getSingleton().register("afterHideRows"),mf.getSingleton().register("beforeUnhideRows"),mf.getSingleton().register("afterUnhideRows");const ej="hiddenRows";var tj=new WeakMap,nj=new WeakSet;class rj extends Tx{constructor(){var e,t;super(...arguments),qW(e=this,t=nj),t.add(e),function(e,t,n){qW(e,t),t.set(e,n)}(this,tj,null)}static get PLUGIN_KEY(){return ej}static get PLUGIN_PRIORITY(){return 320}static get DEFAULT_SETTINGS(){return{copyPasteEnabled:!0,indicators:!1,rows:[]}}isEnabled(){return!!this.hot.getSettings()[ej]}enablePlugin(){var e=this;this.enabled||(ZW(tj,this,new IE),QW(tj,this).addLocalHook("init",(()=>JW(nj,this,hj).call(this))),this.hot.rowIndexMapper.registerMap(this.pluginName,QW(tj,this)),this.addHook("afterContextMenuDefaultOptions",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return JW(nj,e,lj).call(e,...n)})),this.addHook("afterGetCellMeta",((e,t,n)=>JW(nj,this,oj).call(this,e,t,n))),this.addHook("modifyRowHeight",((e,t)=>JW(nj,this,ij).call(this,e,t))),this.addHook("afterGetRowHeader",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return JW(nj,e,aj).call(e,...n)})),this.addHook("modifyCopyableRange",(e=>JW(nj,this,sj).call(this,e))),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap(this.pluginName),super.disablePlugin(),this.resetCellsMeta()}showRows(e){const t=this.getHiddenRows(),n=this.isValidConfig(e);let r=t;const i=QW(tj,this).getValues().slice(),o=e.length>0;if(n&&o){Vd(e.map((e=>this.hot.toPhysicalRow(e))),(e=>{i[e]=!1})),r=kd(i,((e,t,n)=>(t&&e.push(this.hot.toVisualRow(n)),e)),[])}!1!==this.hot.runHooks("beforeUnhideRows",t,r,n&&o)&&(n&&o&&QW(tj,this).setValues(i),this.hot.runHooks("afterUnhideRows",t,r,n&&o,n&&r.length<t.length))}showRow(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.showRows(t)}hideRows(e){const t=this.getHiddenRows(),n=this.isValidConfig(e);let r=t;n&&(r=Array.from(new Set(t.concat(e))));!1!==this.hot.runHooks("beforeHideRows",t,r,n)&&(n&&this.hot.batchExecution((()=>{Vd(e,(e=>{QW(tj,this).setValueAtIndex(this.hot.toPhysicalRow(e),!0)}))}),!0),this.hot.runHooks("afterHideRows",t,r,n,n&&r.length>t.length))}hideRow(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.hideRows(t)}getHiddenRows(){return Dd(QW(tj,this).getHiddenIndexes(),(e=>this.hot.toVisualRow(e)))}isHidden(e){return QW(tj,this).getValueAtIndex(this.hot.toPhysicalRow(e))||!1}isValidConfig(e){const t=this.hot.countRows();return!!(Array.isArray(e)&&e.length>0)&&e.every((e=>Number.isInteger(e)&&e>=0&&e<t))}resetCellsMeta(){Vd(this.hot.getCellsMeta(),(e=>{e.skipRowOnPaste=!1}))}destroy(){ZW(tj,this,null),super.destroy()}}function ij(e,t){return this.isHidden(t)?0:e}function oj(e,t,n){if(!1===this.getSetting("copyPasteEnabled")&&this.isHidden(e)&&(n.skipRowOnPaste=!0),this.isHidden(e-1))n.className=n.className||"",-1===n.className.indexOf("afterHiddenRow")&&(n.className+=" afterHiddenRow");else if(n.className){const e=n.className.split(" ");if(e.length>0){const t=e.indexOf("afterHiddenRow");t>-1&&e.splice(t,1),n.className=e.join(" ")}}}function sj(e){if(this.getSetting("copyPasteEnabled"))return e;const t=[],n=(e,n,r,i)=>{t.push({startRow:e,endRow:n,startCol:r,endCol:i})};return Vd(e,(e=>{let t=!0,r=0;$w(e.startRow,e.endRow,(i=>{this.isHidden(i)?(t||n(r,i-1,e.startCol,e.endCol),t=!0):(t&&(r=i),i===e.endRow&&n(r,i,e.startCol,e.endCol),t=!1)}))})),t}function aj(e,t){if(!this.getSetting("indicators")||e<0)return;const n=[];e>=1&&this.isHidden(e-1)&&n.push("afterHiddenRow"),e<this.hot.countRows()-1&&this.isHidden(e+1)&&n.push("beforeHiddenRow"),Op(t,n)}function lj(e){var t;e.items.push({name:xL},(t=this,{key:"hidden_rows_hide",name(){const e=this.getSelectedLast();let t=0;if(Array.isArray(e)){const[n,,r]=e;n-r!=0&&(t=1)}return this.getTranslatedPhrase(tT,t)},callback(){const{from:e,to:n}=this.getSelectedRangeLast(),r=Math.max(Math.min(e.row,n.row),0),i=Math.max(e.row,n.row),o=[];for(let t=r;t<=i;t+=1)o.push(t);t.hideRows(o);const s=o[o.length-1],a=this.rowIndexMapper.getNearestNotHiddenIndex(s,1,!0);Number.isInteger(a)&&a>=0?this.selectRows(a):this.deselectCell(),this.render(),this.view.adjustElementsSize()},disabled:!1,hidden(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}),function(e){const t=[];return{key:"hidden_rows_show",name(){const e=t.length>1?1:0;return this.getTranslatedPhrase(nT,e)},callback(){var n,r;if(0===t.length)return;let i=t[0],o=t[t.length-1];i=null!==(n=this.rowIndexMapper.getNearestNotHiddenIndex(i-1,-1))&&void 0!==n?n:0,o=null!==(r=this.rowIndexMapper.getNearestNotHiddenIndex(o+1,1))&&void 0!==r?r:this.countRows()-1,e.showRows(t),this.render(),this.view.adjustElementsSize(),o-i+1===this.countRows()||this.selectRows(i,o)},disabled:!1,hidden(){const n=Dd(e.getHiddenRows(),(e=>this.toPhysicalRow(e)));if(!this.selection.isSelectedByRowHeader()&&!this.selection.isSelectedByCorner()||n.length<1)return!0;t.length=0;const r=this.getSelectedRangeLast(),i=r.getTopStartCorner().row,o=r.getBottomEndCorner().row,s=this.rowIndexMapper,a=s.getRenderableFromVisualIndex(i),l=s.getRenderableFromVisualIndex(o),h=s.getNotTrimmedIndexes(),u=[];if(i!==o){if(o-i+1>l-a+1){const e=h.slice(i,o+1);u.push(...e.filter((e=>n.includes(e))))}}else if(0===a&&a<i)u.push(...h.slice(0,i));else if(null===a)u.push(...h.slice(0,this.countRows()));else{const e=this.countRows()-1;l===s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(e,-1))&&e>o&&u.push(...h.slice(o+1))}return Vd(u,(e=>{t.push(this.toVisualRow(e))})),0===t.length}}}(this))}function hj(){const e=this.getSetting("rows");Array.isArray(e)&&this.hideRows(e)}function uj(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function cj(e,t){return e.get(pj(e,t))}function dj(e,t,n){return e.set(pj(e,t),n),n}function pj(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}mf.getSingleton().register("beforeColumnFreeze"),mf.getSingleton().register("afterColumnFreeze"),mf.getSingleton().register("beforeColumnUnfreeze"),mf.getSingleton().register("afterColumnUnfreeze");const gj="manualColumnFreeze";var mj=new WeakMap,fj=new WeakSet;class wj extends Tx{constructor(){var e,t;super(...arguments),uj(e=this,t=fj),t.add(e),function(e,t,n){uj(e,t),t.set(e,n)}(this,mj,!1)}static get PLUGIN_KEY(){return gj}static get PLUGIN_PRIORITY(){return 110}isEnabled(){return!!this.hot.getSettings()[gj]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",(e=>pj(fj,this,yj).call(this,e))),this.addHook("beforeColumnMove",((e,t)=>pj(fj,this,vj).call(this,e,t))),super.enablePlugin())}disablePlugin(){dj(mj,this,!1),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}freezeColumn(e){const t=this.hot.getSettings(),n=t.fixedColumnsStart<this.hot.countCols()&&e>t.fixedColumnsStart-1;cj(mj,this)||dj(mj,this,!0);!1!==this.hot.runHooks("beforeColumnFreeze",e,n)&&(n&&(this.hot.columnIndexMapper.moveIndexes(e,t.fixedColumnsStart),t._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",e,n))}unfreezeColumn(e){const t=this.hot.getSettings(),n=t.fixedColumnsStart>0&&e<=t.fixedColumnsStart-1;cj(mj,this)||dj(mj,this,!0);!1!==this.hot.runHooks("beforeColumnUnfreeze",e,n)&&(n&&(t._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(e,t.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",e,n))}}function yj(e){var t;e.items.push({name:"---------"},(t=this,{key:"freeze_column",name(){return this.getTranslatedPhrase(Ib)},callback(e,n){const[{start:{col:r}}]=n;t.freezeColumn(r),this.render(),this.view.adjustElementsSize()},hidden(){const e=this.getSelectedRange();let t=!1;return(void 0===e||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(t=!0),t}}),function(e){return{key:"unfreeze_column",name(){return this.getTranslatedPhrase(Ob)},callback(t,n){const[{start:{col:r}}]=n;e.unfreezeColumn(r),this.render(),this.view.adjustElementsSize()},hidden(){const e=this.getSelectedRange();let t=!1;return(void 0===e||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col>=this.getSettings().fixedColumnsStart)&&(t=!0),t}}}(this))}function vj(e,t){if(cj(mj,this)){const n=this.hot.getSettings().fixedColumnsStart;if(t<n)return!1;if(e.some((e=>e<n)))return!1}}function Cj(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const Sj="px";const Rj=class{constructor(e){Cj(this,"hot",void 0),Cj(this,"_element",null),Cj(this,"state",0),Cj(this,"inlineProperty",void 0),this.hot=e,this.inlineProperty=e.isRtl()?"right":"left"}appendTo(e){e.appendChild(this._element),this.state=2}build(){0===this.state&&(this._element=this.hot.rootDocument.createElement("div"),this.state=1)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=0}isAppended(){return 2===this.state}isBuilt(){return this.state>=1}setPosition(e,t){zw(e)&&(this._element.style.top=e+Sj),zw(t)&&(this._element.style[this.inlineProperty]=t+Sj)}getPosition(){const e=this._element.style;return{top:e.top?parseInt(e.top,10):0,start:e[this.inlineProperty]?parseInt(e[this.inlineProperty],10):0}}setSize(e,t){zw(e)&&(this._element.style.width=e+Sj),zw(t)&&(this._element.style.height=t+Sj)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,t){zw(e)&&(this._element.style.marginTop=e+Sj),zw(t)&&(this._element.style[`margin${rp(this.inlineProperty)}`]=t+Sj)}getOffset(){const e=this._element.style,t=`margin${rp(this.inlineProperty)}`;return{top:e.marginTop?parseInt(e.marginTop,10):0,start:e[t]?parseInt(e[t],10):0}}};const Ej=class extends Rj{build(){super.build(),Op(this._element,"ht__manualColumnMove--backlight")}};const bj=class extends Rj{build(){super.build(),Op(this._element,"ht__manualColumnMove--guideline")}};function Tj(e,t,n){Nj(e,t),t.set(e,n)}function Nj(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Aj(e,t,n){return e.set(Ij(e,t),n),n}function Mj(e,t){return e.get(Ij(e,t))}function Ij(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}mf.getSingleton().register("beforeColumnMove"),mf.getSingleton().register("afterColumnMove");const Oj="manualColumnMove",xj="ht__manualColumnMove",Pj="show-ui",_j="on-moving--columns",Lj="after-selection--columns";var Hj=new WeakMap,kj=new WeakMap,Fj=new WeakMap,Dj=new WeakMap,Vj=new WeakMap,Uj=new WeakMap,Bj=new WeakMap,Wj=new WeakMap,jj=new WeakMap,Gj=new WeakMap,zj=new WeakMap,$j=new WeakSet;class Yj extends Tx{constructor(){var e,t;super(...arguments),Nj(e=this,t=$j),t.add(e),Tj(this,Hj,new Ej(this.hot)),Tj(this,kj,new bj(this.hot)),Tj(this,Fj,[]),Tj(this,Dj,0),Tj(this,Vj,!1),Tj(this,Uj,{}),Tj(this,Bj,void 0),Tj(this,Wj,void 0),Tj(this,jj,void 0),Tj(this,Gj,void 0),Tj(this,zj,void 0)}static get PLUGIN_KEY(){return Oj}static get PLUGIN_PRIORITY(){return 120}isEnabled(){return!!this.hot.getSettings()[Oj]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return Ij($j,e,Kj).call(e,...n)})),this.addHook("beforeOnCellMouseOver",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return Ij($j,e,qj).call(e,...n)})),this.addHook("afterScrollVertically",(()=>Ij($j,this,Zj).call(this))),this.addHook("afterLoadData",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return Ij($j,e,Jj).call(e,...n)})),this.buildPluginUI(),this.registerEvents(),Op(this.hot.rootElement,xj),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){xp(this.hot.rootElement,xj),this.unregisterEvents(),Mj(Hj,this).destroy(),Mj(kj,this).destroy(),super.disablePlugin()}moveColumn(e,t){return this.moveColumns([e],t)}moveColumns(e,t){const n=Mj(Bj,this),r=this.isMovePossible(e,t),i=this.hot.runHooks("beforeColumnMove",e,t,n,r);if(Aj(Bj,this,void 0),!1===i)return;r&&this.hot.columnIndexMapper.moveIndexes(e,t);const o=r&&this.isColumnOrderChanged(e,t);return this.hot.runHooks("afterColumnMove",e,t,n,r,o),o}dragColumn(e,t){return this.dragColumns([e],t)}dragColumns(e,t){const n=this.countFinalIndex(e,t);return Aj(Bj,this,t),this.moveColumns(e,n)}isMovePossible(e,t){const n=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),r=e.length+t>n,i=t<0,o=e.some((e=>e<0)),s=e.some((e=>e>=n));return!(r||i||o||s)}isColumnOrderChanged(e,t){return e.some(((e,n)=>e-n!==t))}countFinalIndex(e,t){const n=kd(e,((e,n)=>(n<t&&(e+=1),e)),0);return t-n}getColumnsWidth(e,t){const n=this.hot.columnIndexMapper;let r=0;for(let i=e;i<=t;i+=1){const e=n.getRenderableFromVisualIndex(i);i<0?r+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:null!==e&&(r+=this.hot.view._wt.wtTable.getColumnWidth(e)||0)}return r}moveBySettingsOrLoad(){const e=this.hot.getSettings()[Oj];if(Array.isArray(e))this.moveColumns(e,0);else if(void 0!==e){const e=this.persistentStateLoad();e.length&&this.moveColumns(e,0)}}isFixedColumnsStart(e){return e<this.hot.getSettings().fixedColumnsStart}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",e),e.value?e.value:[]}prepareColumnsToMoving(e,t){const n=[];return $w(e,t,(e=>{n.push(e)})),n}refreshPositions(){const e=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(Mj(Wj,this))&&e>0&&this.hot.scrollViewportTo({col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(e-1,-1)});const t=this.hot.view._wt.wtTable,n=this.hot.view._wt.wtOverlays.scrollableElement,r="number"==typeof n.scrollX?n.scrollX:n.scrollLeft;let i=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,Mj(Wj,this)-1);const o=t.hider.offsetWidth,s=t.TBODY.offsetLeft,a=Mj(Hj,this).getOffset().start,l=Mj(Hj,this).getSize().width;let h=0,u=0;if(this.hot.isRtl()){const e=this.hot.rootWindow,t=Kp(this.hot.rootElement),i=e.innerWidth-Mj(jj,this)-t;u=e.innerWidth-Mj(Uj,this).eventPageX-i-(void 0===n.scrollX?r:0)}else u=Mj(Uj,this).eventPageX-(Mj(jj,this)-(void 0===n.scrollX?r:0));if(Mj(Gj,this)&&(h=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(Mj(Wj,this))&&(i+=r),i+=h,Mj(Wj,this)<0)Mj(zj,this)>0?Mj(Uj,this).col=0:Mj(Uj,this).col=e>0?e-1:e;else if(Mj(Uj,this).TD.offsetWidth/2+i<=u){const e=Mj(Wj,this)>=Mj(Dj,this)?Mj(Dj,this)-1:Mj(Wj,this);Mj(Uj,this).col=e+1,i+=Mj(Uj,this).TD.offsetWidth}else Mj(Uj,this).col=Mj(Wj,this);let c=u,d=i;u+l+a>=o?c=o-l-a:u+a<s+h&&(c=s+h+Math.abs(a)),i>=o-1?d=o-1:0===d?d=1:void 0!==n.scrollX&&Mj(Wj,this)<Mj(zj,this)&&(d-=Mj(jj,this)<=n.scrollX?Mj(jj,this):0),Mj(Hj,this).setPosition(null,c),Mj(kj,this).setPosition(null,d)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",(e=>Ij($j,this,Xj).call(this,e))),this.eventManager.addEventListener(e,"mouseup",(()=>Ij($j,this,Qj).call(this)))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){Mj(Hj,this).build(),Mj(kj,this).build()}destroy(){Mj(Hj,this).destroy(),Mj(kj,this).destroy(),super.destroy()}}function Kj(e,t,n,r){const i=this.hot.view._wt.wtTable,o=this.hot.selection.isSelectedByColumnHeader(),s=this.hot.getSelectedRangeLast(),a=Ip(e.target,"sortAction");if(!s||!o||Mj(Vj,this)||0!==e.button||a)return Aj(Vj,this,!1),Mj(Fj,this).length=0,void xp(this.hot.rootElement,[_j,Pj]);const l=Mj(kj,this).isBuilt()&&!Mj(kj,this).isAppended(),h=Mj(Hj,this).isBuilt()&&!Mj(Hj,this).isAppended();l&&h&&(Mj(kj,this).appendTo(i.hider),Mj(Hj,this).appendTo(i.hider));const{from:u,to:c}=s,d=Math.min(u.col,c.col),p=Math.max(u.col,c.col);if(t.row<0&&t.col>=d&&t.col<=p){r.column=!0,Aj(Vj,this,!0);const o=n.firstChild?function(e,t){const n={x:e.offsetX,y:e.offsetY};let r=e.target;if(!dg(t)||r!==t&&r.contains(t))return n;for(;r!==t;)n.x+=r.offsetLeft,n.y+=r.offsetTop,r=r.offsetParent;return n}(e,n.firstChild).x:e.offsetX;Mj(Uj,this).eventPageX=e.pageX,Aj(Wj,this,t.col),Mj(Uj,this).TD=n,Mj(Uj,this).col=t.col,Aj(Fj,this,this.prepareColumnsToMoving(d,p)),Aj(Gj,this,!!this.hot.getSettings().rowHeaders),Aj(Dj,this,this.hot.countCols()),Aj(zj,this,this.hot.getSettings().fixedColumnsStart),Aj(jj,this,Up(this.hot.rootElement).left);const s=Mj(Gj,this)?-1:0,a=i.holder.scrollTop+i.getColumnHeaderHeight(0)+1,l=t.col<Mj(zj,this),h=this.hot.view._wt.wtOverlays.inlineStartOverlay.getOverlayOffset(),u=Math.abs(o-(this.hot.isRtl()?n.offsetWidth:0)),c=this.getColumnsWidth(d,t.col-1)+u,g=this.getColumnsWidth(s,d-1)+(l?h:0)+c;Mj(Hj,this).setPosition(a,g),Mj(Hj,this).setSize(this.getColumnsWidth(d,p),i.hider.offsetHeight-a),Mj(Hj,this).setOffset(null,-c),Op(this.hot.rootElement,_j)}else xp(this.hot.rootElement,Lj),Aj(Vj,this,!1),Mj(Fj,this).length=0}function Xj(e){Mj(Vj,this)&&(Mj(Uj,this).eventPageX=e.pageX,this.refreshPositions())}function qj(e,t,n,r){this.hot.getSelectedRangeLast()&&Mj(Vj,this)&&(Mj(Fj,this).indexOf(t.col)>-1?xp(this.hot.rootElement,Pj):Op(this.hot.rootElement,Pj),r.row=!0,r.column=!0,r.cell=!0,Aj(Wj,this,t.col),Mj(Uj,this).TD=n)}function Qj(){const e=Mj(Uj,this).col,t=Mj(Fj,this).length;if(Aj(Wj,this,void 0),Aj(Vj,this,!1),xp(this.hot.rootElement,[_j,Pj,Lj]),this.hot.selection.isSelectedByColumnHeader()&&Op(this.hot.rootElement,Lj),t<1||void 0===e)return;const n=Mj(Fj,this)[0],r=this.hot.toPhysicalColumn(n),i=this.dragColumns(Mj(Fj,this),e);if(Mj(Fj,this).length=0,!0===i){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize();const e=this.hot.toVisualColumn(r),n=e+t-1;this.hot.selectColumns(e,n)}}function Zj(){const e=this.hot.view._wt.wtTable,t=e.getColumnHeaderHeight(0)+1+e.holder.scrollTop;Mj(Hj,this).setPosition(t),Mj(Hj,this).setSize(null,e.hider.offsetHeight-t)}function Jj(){this.moveBySettingsOrLoad()}function eG(e,t,n){tG(e,t),t.set(e,n)}function tG(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function nG(e,t,n){return e.set(iG(e,t),n),n}function rG(e,t){return e.get(iG(e,t))}function iG(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}const oG="manualColumnResize",sG="manualColumnWidths";var aG=new WeakMap,lG=new WeakMap,hG=new WeakMap,uG=new WeakMap,cG=new WeakMap,dG=new WeakMap,pG=new WeakMap,gG=new WeakMap,mG=new WeakMap,fG=new WeakMap,wG=new WeakMap,yG=new WeakMap,vG=new WeakMap,CG=new WeakMap,SG=new WeakMap,RG=new WeakMap,EG=new WeakSet;class bG extends Tx{static get PLUGIN_KEY(){return oG}static get PLUGIN_PRIORITY(){return 130}constructor(e){var t,n;super(e),tG(t=this,n=EG),n.add(t),eG(this,aG,null),eG(this,lG,null),eG(this,hG,[]),eG(this,uG,null),eG(this,cG,null),eG(this,dG,null),eG(this,pG,null),eG(this,gG,null),eG(this,mG,this.hot.rootDocument.createElement("DIV")),eG(this,fG,this.hot.rootDocument.createElement("DIV")),eG(this,wG,null),eG(this,yG,!1),eG(this,vG,0),eG(this,CG,null),eG(this,SG,void 0),eG(this,RG,void 0),Op(rG(mG,this),"manualColumnResizer"),Op(rG(fG,this),"manualColumnResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[oG]}enablePlugin(){var e=this;this.enabled||(nG(SG,this,new ME),rG(SG,this).addLocalHook("init",(()=>iG(EG,this,TG).call(this))),this.hot.columnIndexMapper.registerMap(this.pluginName,rG(SG,this)),this.addHook("modifyColWidth",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return iG(EG,e,xG).call(e,...n)}),1),this.addHook("beforeStretchingColumnWidth",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return iG(EG,e,PG).call(e,...n)}),1),this.addHook("beforeColumnResize",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return iG(EG,e,_G).call(e,...n)})),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){nG(RG,this,rG(SG,this).getValues()),this.hot.columnIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualColumnWidths(){this.hot.runHooks("persistentStateSave",sG,rG(SG,this).getValues())}loadManualColumnWidths(){const e={};return this.hot.runHooks("persistentStateLoad",sG,e),e.value}setManualSize(e,t){const n=Math.max(t,20),r=this.hot.toPhysicalColumn(e);return rG(SG,this).setValueAtIndex(r,n),n}clearManualSize(e){const t=this.hot.toPhysicalColumn(e);rG(SG,this).setValueAtIndex(t,null)}setupHandlePosition(e){if(!e.parentNode)return;nG(aG,this,e);const{_wt:t}=this.hot.view,n=t.wtTable.getCoords(rG(aG,this)),r=n.col;if(r<0)return;const i=Xp(rG(aG,this)),o=rG(aG,this).getBoundingClientRect();let s;r<t.getSetting("fixedColumnsStart")&&(s=t.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(rG(aG,this),n.row,n.col)),s||(s=t.wtOverlays.topOverlay.getRelativeCellPosition(rG(aG,this),n.row,n.col)),nG(lG,this,this.hot.columnIndexMapper.getVisualFromRenderableIndex(r)),nG(hG,this,[]);const a=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&a){Vd(this.hot.getSelectedRange(),(e=>{$w(e.getTopStartCorner().col,e.getBottomEndCorner().col,(e=>{rG(hG,this).includes(e)||rG(hG,this).push(e)}))}))}rG(hG,this).includes(rG(lG,this))||nG(hG,this,[rG(lG,this)]),nG(gG,this,s.start-6),nG(pG,this,parseInt(o.width,10)),rG(mG,this).style.top=`${s.top}px`,rG(mG,this).style[this.inlineDir]=`${rG(gG,this)+rG(pG,this)}px`,rG(mG,this).style.height=`${i}px`,this.hot.rootElement.appendChild(rG(mG,this))}refreshHandlePosition(){rG(mG,this).style[this.inlineDir]=`${rG(gG,this)+rG(uG,this)}px`}setupGuidePosition(){const e=parseInt(Xp(rG(mG,this)),10),t=parseInt(rG(mG,this).style.top,10)+e,n=parseInt(this.hot.view.maximumVisibleElementHeight(0),10);Op(rG(mG,this),"active"),Op(rG(fG,this),"active"),rG(fG,this).style.top=`${t}px`,this.refreshGuidePosition(),rG(fG,this).style.height=n-e+"px",this.hot.rootElement.appendChild(rG(fG,this))}refreshGuidePosition(){rG(fG,this).style[this.inlineDir]=rG(mG,this).style[this.inlineDir]}hideHandleAndGuide(){xp(rG(mG,this),"active"),xp(rG(fG,this),"active")}checkIfColumnHeader(e){const t=Ep(e,["THEAD"],this.hot.rootElement),{topOverlay:n,topInlineStartCornerOverlay:r}=this.hot.view._wt.wtOverlays;return[n.clone.wtTable.THEAD,r.clone.wtTable.THEAD].includes(t)}getClosestTHParent(e){return"TABLE"!==e.tagName?"TH"===e.tagName?e:this.getClosestTHParent(e.parentNode):null}afterMouseDownTimeout(){const e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize()},t=(t,n)=>{const r=this.hot.runHooks("beforeColumnResize",rG(cG,this),t,!0);void 0!==r&&nG(cG,this,r),this.setManualSize(t,rG(cG,this)),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",rG(cG,this),t,!0),n&&e()};if(rG(vG,this)>=2){rG(hG,this).length>1?(Vd(rG(hG,this),(e=>{t(e)})),e()):Vd(rG(hG,this),(e=>{t(e,!0)}))}nG(vG,this,0),nG(CG,this,null)}bindEvents(){const{rootWindow:e,rootElement:t}=this.hot;this.eventManager.addEventListener(t,"mouseover",(e=>iG(EG,this,NG).call(this,e))),this.eventManager.addEventListener(t,"mousedown",(e=>iG(EG,this,AG).call(this,e))),this.eventManager.addEventListener(e,"mousemove",(e=>iG(EG,this,MG).call(this,e))),this.eventManager.addEventListener(e,"mouseup",(()=>iG(EG,this,IG).call(this))),this.eventManager.addEventListener(rG(mG,this),"contextmenu",(()=>iG(EG,this,OG).call(this)))}destroy(){super.destroy()}}function TG(){const e=this.hot.getSettings()[oG],t=this.loadManualColumnWidths();void 0!==t?this.hot.batchExecution((()=>{t.forEach(((e,t)=>{rG(SG,this).setValueAtIndex(t,e)}))}),!0):Array.isArray(e)?(this.hot.batchExecution((()=>{e.forEach(((e,t)=>{rG(SG,this).setValueAtIndex(t,e)}))}),!0),nG(RG,this,e)):!0===e&&Array.isArray(rG(RG,this))&&this.hot.batchExecution((()=>{rG(RG,this).forEach(((e,t)=>{rG(SG,this).setValueAtIndex(t,e)}))}),!0)}function NG(e){if(!hg(e.target)&&!0!==rG(yG,this)&&this.checkIfColumnHeader(e.target)){const t=this.getClosestTHParent(e.target);if(!t)return;const n=t.getAttribute("colspan");!t||null!==n&&"1"!==n||rG(wG,this)||this.setupHandlePosition(t)}}function AG(e){e.target.parentNode===this.hot.rootElement&&Ip(e.target,"manualColumnResizer")&&(this.setupHandlePosition(rG(aG,this)),this.setupGuidePosition(),nG(wG,this,!0),null===rG(CG,this)&&(nG(CG,this,setTimeout((()=>this.afterMouseDownTimeout()),500)),this.hot._registerTimeout(rG(CG,this))),nG(vG,this,rG(vG,this)+1),this.startX=e.pageX,nG(cG,this,rG(pG,this)))}function MG(e){if(rG(wG,this)){const t=(e.pageX-this.startX)*this.hot.getDirectionFactor();nG(uG,this,rG(pG,this)+t),Vd(rG(hG,this),(e=>{nG(cG,this,this.setManualSize(e,rG(uG,this)))})),this.refreshHandlePosition(),this.refreshGuidePosition()}}function IG(){const e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize()},t=(t,n)=>{this.hot.runHooks("beforeColumnResize",rG(cG,this),t,!1),n&&e(),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",rG(cG,this),t,!1)};if(rG(wG,this)){if(this.hideHandleAndGuide(),nG(wG,this,!1),rG(cG,this)!==rG(pG,this)){rG(hG,this).length>1?(Vd(rG(hG,this),(e=>{t(e)})),e()):Vd(rG(hG,this),(e=>{t(e,!0)}))}this.setupHandlePosition(rG(aG,this))}}function OG(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(rG(mG,this)),this.hot.rootElement.removeChild(rG(fG,this)),nG(wG,this,!1),nG(yG,this,!0),this.hot._registerImmediate((()=>{nG(yG,this,!1)}))}function xG(e,t){let n=e;if(this.enabled){const e=this.hot.toPhysicalColumn(t),r=rG(SG,this).getValueAtIndex(e);this.hot.getSettings()[oG]&&r&&(n=r)}return n}function PG(e,t){const n=rG(SG,this).getValueAtIndex(this.hot.toPhysicalColumn(t));return"number"==typeof n?n:e}function _G(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}function LG(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const HG="px";const kG=class{constructor(e){LG(this,"hot",void 0),LG(this,"_element",null),LG(this,"state",0),this.hot=e}appendTo(e){e.appendChild(this._element),this.state=2}build(){0===this.state&&(this._element=this.hot.rootDocument.createElement("div"),this.state=1)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=0}isAppended(){return 2===this.state}isBuilt(){return this.state>=1}setPosition(e,t){void 0!==e&&(this._element.style.top=e+HG),void 0!==t&&(this._element.style.left=t+HG)}getPosition(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}setSize(e,t){e&&(this._element.style.width=e+HG),t&&(this._element.style.height=t+HG)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,t){e&&(this._element.style.marginTop=e+HG),t&&(this._element.style.marginLeft=t+HG)}getOffset(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}};const FG=class extends kG{build(){super.build(),Op(this._element,"ht__manualRowMove--backlight")}};const DG=class extends kG{build(){super.build(),Op(this._element,"ht__manualRowMove--guideline")}};function VG(e,t,n){UG(e,t),t.set(e,n)}function UG(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function BG(e,t,n){return e.set(jG(e,t),n),n}function WG(e,t){return e.get(jG(e,t))}function jG(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}mf.getSingleton().register("beforeRowMove"),mf.getSingleton().register("afterRowMove");const GG="manualRowMove",zG="ht__manualRowMove",$G="show-ui",YG="on-moving--rows",KG="after-selection--rows";var XG=new WeakMap,qG=new WeakMap,QG=new WeakMap,ZG=new WeakMap,JG=new WeakMap,ez=new WeakMap,tz=new WeakSet;class nz extends Tx{constructor(){var e,t;super(...arguments),UG(e=this,t=tz),t.add(e),VG(this,XG,new FG(this.hot)),VG(this,qG,new DG(this.hot)),VG(this,QG,[]),VG(this,ZG,void 0),VG(this,JG,{}),VG(this,ez,void 0)}static get PLUGIN_KEY(){return GG}static get PLUGIN_PRIORITY(){return 140}isEnabled(){return!!this.hot.getSettings()[GG]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return jG(tz,e,rz).call(e,...n)})),this.addHook("beforeOnCellMouseOver",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return jG(tz,e,oz).call(e,...n)})),this.addHook("afterScrollHorizontally",(()=>jG(tz,this,az).call(this))),this.addHook("afterLoadData",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return jG(tz,e,lz).call(e,...n)})),this.buildPluginUI(),this.registerEvents(),Op(this.hot.rootElement,zG),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){xp(this.hot.rootElement,zG),this.unregisterEvents(),WG(XG,this).destroy(),WG(qG,this).destroy(),super.disablePlugin()}moveRow(e,t){return this.moveRows([e],t)}moveRows(e,t){const n=WG(ez,this),r=this.isMovePossible(e,t),i=this.hot.runHooks("beforeRowMove",e,t,n,r);if(BG(ez,this,void 0),!1===i)return;r&&this.hot.rowIndexMapper.moveIndexes(e,t);const o=r&&this.isRowOrderChanged(e,t);return this.hot.runHooks("afterRowMove",e,t,n,r,o),o}dragRow(e,t){return this.dragRows([e],t)}dragRows(e,t){const n=this.countFinalIndex(e,t);return BG(ez,this,t),this.moveRows(e,n)}isMovePossible(e,t){const n=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),r=e.length+t>n,i=t<0,o=e.some((e=>e<0)),s=e.some((e=>e>=n));return!(r||i||o||s)}isRowOrderChanged(e,t){return e.some(((e,n)=>e-n!==t))}countFinalIndex(e,t){const n=kd(e,((e,n)=>(n<t&&(e+=1),e)),0);return t-n}getRowsHeight(e,t){const n=this.hot.rowIndexMapper;let r=0;for(let i=e;i<=t;i++){const e=n.getRenderableFromVisualIndex(i);null!==e&&(r+=this.hot.view._wt.wtTable.getRowHeight(e)||this.hot.view.getDefaultRowHeight())}return r}moveBySettingsOrLoad(){const e=this.hot.getSettings()[GG];if(Array.isArray(e))this.moveRows(e,0);else if(void 0!==e){const e=this.persistentStateLoad();e.length&&this.moveRows(e,0)}}isFixedRowTop(e){return e<this.hot.getSettings().fixedRowsTop}isFixedRowBottom(e){return e>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualRowMove",e),e.value?e.value:[]}prepareRowsToMoving(){const e=this.hot.getSelectedRangeLast(),t=[];if(!e)return t;const{from:n,to:r}=e;return $w(Math.min(n.row,r.row),Math.max(n.row,r.row),(e=>{t.push(e)})),t}refreshPositions(){const e=WG(JG,this).coords,t=this.hot.getFirstFullyVisibleRow(),n=this.hot.getLastFullyVisibleRow(),r=this.hot.countRows();this.isFixedRowTop(e.row)&&t>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(t-1,-1)),this.isFixedRowBottom(e.row)&&n<r&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(n+1,1),void 0,!0);const i=this.hot.view._wt.wtTable,o=WG(JG,this).TD,s=this.hot.rootElement,a=Up(s),l=$p(s),h=i.holder.scrollTop,u=this.hot.rootWindow!==l?l.scrollTop:0,c=a.top-u,d=WG(JG,this).eventPageY-c+h,p=i.hider.offsetHeight,g=i.TBODY.offsetTop,m=WG(XG,this).getOffset().top,f=WG(XG,this).getSize().height,w=o.offsetHeight/2,y=o.offsetHeight;let v=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,e.row-1);const C=d>=v+w;this.isFixedRowTop(e.row)&&(v+=this.hot.view._wt.wtOverlays.topOverlay.getOverlayOffset()),e.row<0?WG(JG,this).row=t>0?t-1:t:C?(WG(JG,this).row=e.row+1,v+=0===e.row?y-1:y):WG(JG,this).row=e.row;let S=d,R=v;d+f+m>=p?S=p-f-m:d+m<g&&(S=g+Math.abs(m)),v>=p-1&&(R=p-1),WG(XG,this).setPosition(S),WG(qG,this).setPosition(R)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",(e=>jG(tz,this,iz).call(this,e))),this.eventManager.addEventListener(e,"mouseup",(()=>jG(tz,this,sz).call(this)))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){WG(XG,this).build(),WG(qG,this).build()}destroy(){WG(XG,this).destroy(),WG(qG,this).destroy(),super.destroy()}}function rz(e,t,n,r){const{wtTable:i,wtViewport:o}=this.hot.view._wt,s=this.hot.selection.isSelectedByRowHeader(),a=this.hot.getSelectedRangeLast();if(!a||!s||WG(ZG,this)||0!==e.button)return BG(ZG,this,!1),WG(QG,this).length=0,void xp(this.hot.rootElement,[YG,$G]);const l=WG(qG,this).isBuilt()&&!WG(qG,this).isAppended(),h=WG(XG,this).isBuilt()&&!WG(XG,this).isAppended();l&&h&&(WG(qG,this).appendTo(i.hider),WG(XG,this).appendTo(i.hider));const{from:u,to:c}=a,d=Math.min(u.row,c.row),p=Math.max(u.row,c.row);if(t.col<0&&t.row>=d&&t.row<=p){r.row=!0,BG(ZG,this,!0),WG(JG,this).eventPageY=e.pageY,WG(JG,this).coords=t,WG(JG,this).TD=n,BG(QG,this,this.prepareRowsToMoving());const s=i.holder.scrollLeft+o.getRowHeaderWidth(),a=this.getRowsHeight(d,t.row-1)+(e.clientY-n.getBoundingClientRect().top);WG(XG,this).setPosition(null,s),WG(XG,this).setSize(i.hider.offsetWidth-s,this.getRowsHeight(d,p)),WG(XG,this).setOffset(-a,null),Op(this.hot.rootElement,YG),this.refreshPositions()}else xp(this.hot.rootElement,KG),BG(ZG,this,!1),WG(QG,this).length=0}function iz(e){WG(ZG,this)&&(WG(JG,this).eventPageY=e.pageY,this.refreshPositions())}function oz(e,t,n,r){this.hot.getSelectedRangeLast()&&WG(ZG,this)&&(WG(QG,this).indexOf(t.row)>-1?xp(this.hot.rootElement,$G):Op(this.hot.rootElement,$G),r.row=!0,r.column=!0,r.cell=!0,WG(JG,this).coords=t,WG(JG,this).TD=n)}function sz(){const e=WG(JG,this).row,t=WG(QG,this).length;if(BG(ZG,this,!1),xp(this.hot.rootElement,[YG,$G,KG]),this.hot.selection.isSelectedByRowHeader()&&Op(this.hot.rootElement,KG),t<1||void 0===e)return;const n=WG(QG,this)[0],r=this.hot.toPhysicalRow(n),i=this.dragRows(WG(QG,this),e);if(WG(QG,this).length=0,!0===i){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize();const e=this.hot.toVisualRow(r),n=e+t-1;this.hot.selectRows(e,n)}}function az(){const e=this.hot.view._wt.wtTable,t=this.hot.view._wt.wtViewport.getRowHeaderWidth()+e.holder.scrollLeft;WG(XG,this).setPosition(null,t),WG(XG,this).setSize(e.hider.offsetWidth-t)}function lz(){this.moveBySettingsOrLoad()}function hz(e,t,n){uz(e,t),t.set(e,n)}function uz(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function cz(e,t,n){return e.set(pz(e,t),n),n}function dz(e,t){return e.get(pz(e,t))}function pz(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}const gz="manualRowResize",mz="manualRowHeights";var fz=new WeakMap,wz=new WeakMap,yz=new WeakMap,vz=new WeakMap,Cz=new WeakMap,Sz=new WeakMap,Rz=new WeakMap,Ez=new WeakMap,bz=new WeakMap,Tz=new WeakMap,Nz=new WeakMap,Az=new WeakMap,Mz=new WeakMap,Iz=new WeakMap,Oz=new WeakMap,xz=new WeakMap,Pz=new WeakSet;class _z extends Tx{static get PLUGIN_KEY(){return gz}static get PLUGIN_PRIORITY(){return 30}constructor(e){var t,n;super(e),uz(t=this,n=Pz),n.add(t),hz(this,fz,null),hz(this,wz,null),hz(this,yz,[]),hz(this,vz,null),hz(this,Cz,null),hz(this,Sz,null),hz(this,Rz,null),hz(this,Ez,null),hz(this,bz,this.hot.rootDocument.createElement("DIV")),hz(this,Tz,this.hot.rootDocument.createElement("DIV")),hz(this,Nz,!1),hz(this,Az,!1),hz(this,Mz,0),hz(this,Iz,null),hz(this,Oz,void 0),hz(this,xz,void 0),Op(dz(bz,this),"manualRowResizer"),Op(dz(Tz,this),"manualRowResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[gz]}enablePlugin(){this.enabled||(cz(Oz,this,new ME),dz(Oz,this).addLocalHook("init",(()=>pz(Pz,this,Uz).call(this))),this.hot.rowIndexMapper.registerMap(this.pluginName,dz(Oz,this)),this.addHook("modifyRowHeight",((e,t)=>pz(Pz,this,Vz).call(this,e,t))),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){cz(xz,this,dz(Oz,this).getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualRowHeights(){this.hot.runHooks("persistentStateSave",mz,dz(Oz,this).getValues())}loadManualRowHeights(){const e={};return this.hot.runHooks("persistentStateLoad",mz,e),e.value}setManualSize(e,t){const n=this.hot.toPhysicalRow(e),r=Math.max(t,this.hot.view.getDefaultRowHeight());return dz(Oz,this).setValueAtIndex(n,r),r}getLastDesiredRowHeight(){return dz(vz,this)}setupHandlePosition(e){cz(fz,this,e);const{view:t}=this.hot,{_wt:n}=t,r=n.wtTable.getCoords(dz(fz,this)),i=r.row;if(i<0)return;const o=Kp(dz(fz,this)),s=dz(fz,this).getBoundingClientRect(),a=i<n.getSetting("fixedRowsTop"),l=i>=t.countNotHiddenRowIndexes(0,1)-n.getSetting("fixedRowsBottom");let h;a?h=n.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(dz(fz,this),r.row,r.col):l&&(h=n.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(dz(fz,this),r.row,r.col)),h||(h=n.wtOverlays.inlineStartOverlay.getRelativeCellPosition(dz(fz,this),r.row,r.col)),cz(wz,this,this.hot.rowIndexMapper.getVisualFromRenderableIndex(i)),cz(yz,this,[]);const u=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&u){Vd(this.hot.getSelectedRange(),(e=>{$w(e.getTopStartCorner().row,e.getBottomStartCorner().row,(e=>{dz(yz,this).includes(e)||dz(yz,this).push(e)}))}))}dz(yz,this).includes(dz(wz,this))||cz(yz,this,[dz(wz,this)]),cz(Ez,this,h.top-6),cz(Rz,this,parseInt(s.height,10)),dz(bz,this).style.top=`${dz(Ez,this)+dz(Rz,this)}px`,dz(bz,this).style[this.inlineDir]=`${h.start}px`,dz(bz,this).style.width=`${o}px`,this.hot.rootElement.appendChild(dz(bz,this))}refreshHandlePosition(){dz(bz,this).style.top=`${dz(Ez,this)+dz(vz,this)}px`}setupGuidePosition(){const e=parseInt(Kp(dz(bz,this)),10),t=parseInt(dz(bz,this).style[this.inlineDir],10)+e,n=parseInt(this.hot.view.maximumVisibleElementWidth(0),10);Op(dz(bz,this),"active"),Op(dz(Tz,this),"active"),dz(Tz,this).style.top=dz(bz,this).style.top,dz(Tz,this).style[this.inlineDir]=`${t}px`,dz(Tz,this).style.width=n-e+"px",this.hot.rootElement.appendChild(dz(Tz,this))}refreshGuidePosition(){dz(Tz,this).style.top=dz(bz,this).style.top}hideHandleAndGuide(){xp(dz(bz,this),"active"),xp(dz(Tz,this),"active")}checkIfRowHeader(e){const t=Ep(e,["TBODY"],this.hot.rootElement),{inlineStartOverlay:n,topInlineStartCornerOverlay:r,bottomInlineStartCornerOverlay:i}=this.hot.view._wt.wtOverlays;return[n.clone.wtTable.TBODY,r.clone.wtTable.TBODY,i.clone.wtTable.TBODY].includes(t)}getClosestTHParent(e){return"TABLE"!==e.tagName?"TH"===e.tagName?e:this.getClosestTHParent(e.parentNode):null}getActualRowHeight(e){const t=this.hot.view._wt.wtTable.getRowHeight(e);return void 0!==t&&dz(Cz,this)<t?t:dz(Cz,this)}afterMouseDownTimeout(){const e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize()},t=(t,n)=>{const r=this.hot.runHooks("beforeRowResize",this.getActualRowHeight(t),t,!0);void 0!==r&&cz(Cz,this,r),this.setManualSize(t,dz(Cz,this)),this.hot.runHooks("afterRowResize",this.getActualRowHeight(t),t,!0),n&&e()};if(dz(Mz,this)>=2){dz(yz,this).length>1?(Vd(dz(yz,this),(e=>{t(e)})),e()):Vd(dz(yz,this),(e=>{t(e,!0)}))}cz(Mz,this,0),cz(Iz,this,null)}bindEvents(){const{rootElement:e,rootWindow:t}=this.hot;this.eventManager.addEventListener(e,"mouseover",(e=>pz(Pz,this,Lz).call(this,e))),this.eventManager.addEventListener(e,"mousedown",(e=>pz(Pz,this,Hz).call(this,e))),this.eventManager.addEventListener(t,"mousemove",(e=>pz(Pz,this,kz).call(this,e))),this.eventManager.addEventListener(t,"mouseup",(()=>pz(Pz,this,Fz).call(this))),this.eventManager.addEventListener(dz(bz,this),"contextmenu",(()=>pz(Pz,this,Dz).call(this)))}destroy(){super.destroy()}}function Lz(e){if(!hg(e.target)&&!0!==dz(Az,this)&&this.checkIfRowHeader(e.target)){const t=this.getClosestTHParent(e.target);t&&(dz(Nz,this)||this.setupHandlePosition(t))}}function Hz(e){Ip(e.target,"manualRowResizer")&&(this.setupHandlePosition(dz(fz,this)),this.setupGuidePosition(),cz(Nz,this,!0),null===dz(Iz,this)&&(cz(Iz,this,setTimeout((()=>this.afterMouseDownTimeout()),500)),this.hot._registerTimeout(dz(Iz,this))),cz(Mz,this,dz(Mz,this)+1),cz(Sz,this,e.pageY),cz(Cz,this,dz(Rz,this)))}function kz(e){dz(Nz,this)&&(cz(vz,this,dz(Rz,this)+(e.pageY-dz(Sz,this))),Vd(dz(yz,this),(e=>{cz(Cz,this,this.setManualSize(e,dz(vz,this)))})),this.refreshHandlePosition(),this.refreshGuidePosition())}function Fz(){const e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize()},t=(t,n)=>{this.hot.runHooks("beforeRowResize",this.getActualRowHeight(t),t,!1),n&&e(),this.saveManualRowHeights(),this.hot.runHooks("afterRowResize",this.getActualRowHeight(t),t,!1)};if(dz(Nz,this)){if(this.hideHandleAndGuide(),cz(Nz,this,!1),dz(Cz,this)!==dz(Rz,this)){dz(yz,this).length>1?(Vd(dz(yz,this),(e=>{t(e)})),e()):Vd(dz(yz,this),(e=>{t(e,!0)}))}this.setupHandlePosition(dz(fz,this))}}function Dz(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(dz(bz,this)),this.hot.rootElement.removeChild(dz(Tz,this)),cz(Nz,this,!1),cz(Az,this,!0),this.hot._registerImmediate((()=>{cz(Az,this,!1)}))}function Vz(e,t){let n=e;if(this.enabled){const e=this.hot.toPhysicalRow(t),r=dz(Oz,this).getValueAtIndex(e);this.hot.getSettings()[gz]&&r&&(n=r)}return n}function Uz(){const e=this.hot.getSettings()[gz],t=this.loadManualRowHeights();this.hot.batchExecution((()=>{void 0!==t?t.forEach(((e,t)=>{dz(Oz,this).setValueAtIndex(t,e)})):Array.isArray(e)?(e.forEach(((e,t)=>{dz(Oz,this).setValueAtIndex(t,e)})),cz(xz,this,e)):!0===e&&Array.isArray(dz(xz,this))&&dz(xz,this).forEach(((e,t)=>{dz(Oz,this).setValueAtIndex(t,e)}))}),!0)}Wm("flatMap");var Bz=F,Wz=sn,jz=Ss,Gz=Qh,zz=Ti,$z=F,Yz=Ge,Kz=sn,Xz=Ss,qz=function(e,t){t&&"string"==typeof e||Wz(e);var n=Gz(e);return jz(Wz(void 0!==n?Bz(n,e):e))},Qz=oa,Zz=bh((function(){for(var e,t,n=this.iterator,r=this.mapper;;){if(t=this.inner)try{if(!(e=Kz($z(t.next,t.iterator))).done)return e.value;this.inner=null}catch(xm){Qz(n,"throw",xm)}if(e=Kz($z(this.next,n)),this.done=!!e.done)return;try{this.inner=qz(r(e.value,this.counter++),!1)}catch(xm){Qz(n,"throw",xm)}}}));function Jz(e,t,n){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,n)}function e$(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function t$(e,t){return e.get(r$(e,t))}function n$(e,t,n){return e.set(r$(e,t),n),n}function r$(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}zz({target:"Iterator",proto:!0,real:!0,forced:false},{flatMap:function(e){return Kz(this),Yz(e),new Zz(Xz(this),{mapper:e,inner:null})}});var i$=new WeakMap;const o$=class{constructor(e,t,n,r,i,o){e$(this,"row",void 0),e$(this,"col",void 0),e$(this,"rowspan",void 0),e$(this,"colspan",void 0),e$(this,"removed",!1),e$(this,"cellCoordsFactory",void 0),e$(this,"cellRangeFactory",void 0),Jz(this,i$,null),this.row=e,this.col=t,this.rowspan=n,this.colspan=r,this.cellCoordsFactory=i,this.cellRangeFactory=o}static NEGATIVE_VALUES_WARNING(e){let{row:t,col:n,rowspan:r,colspan:i}=e;return Wd`The merged cell declared with {row: ${t}, col: ${n},\x20
      rowspan: ${r}, colspan: ${i}} contains negative values, which is\x20
      not supported. It will not be added to the collection.`}static IS_OUT_OF_BOUNDS_WARNING(e){let{row:t,col:n}=e;return Wd`The merged cell declared at [${t}, ${n}] is positioned\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`}static IS_SINGLE_CELL(e){let{row:t,col:n}=e;return Wd`The merged cell declared at [${t}, ${n}] has both "rowspan"\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`}static ZERO_SPAN_WARNING(e){let{row:t,col:n}=e;return Wd`The merged cell declared at [${t}, ${n}] has "rowspan"\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`}static containsNegativeValues(e){let{row:t,col:n,rowspan:r,colspan:i}=e;return t<0||n<0||r<0||i<0}static isSingleCell(e){let{rowspan:t,colspan:n}=e;return 1===n&&1===t}static containsZeroSpan(e){let{rowspan:t,colspan:n}=e;return 0===n||0===t}static isOutOfBounds(e,t,n){return e.row<0||e.col<0||e.row>=t||e.row+e.rowspan-1>=t||e.col>=n||e.col+e.colspan-1>=n}normalize(e){const t=e.countRows(),n=e.countCols();this.row<0?this.row=0:this.row>t-1&&(this.row=t-1),this.col<0?this.col=0:this.col>n-1&&(this.col=n-1),this.row+this.rowspan>t-1&&(this.rowspan=t-this.row),this.col+this.colspan>n-1&&(this.colspan=n-this.col),n$(i$,this,null)}includes(e,t){return this.row<=e&&this.col<=t&&this.row+this.rowspan-1>=e&&this.col+this.colspan-1>=t}includesHorizontally(e){return this.col<=e&&this.col+this.colspan-1>=e}includesVertically(e){return this.row<=e&&this.row+this.rowspan-1>=e}shift(e,t){const n=e[0]||e[1],r=t+Math.abs(e[0]||e[1])-1,i=e[0]?"colspan":"rowspan",o=e[0]?"col":"row",s=Math.min(t,r),a=Math.max(t,r),l=this[o],h=this[o]+this[i]-1;if(l>=t&&(this[o]+=n),n>0)t<=h&&t>l&&(this[i]+=n);else if(n<0){if(s<=l&&a>=h)return this.removed=!0,n$(i$,this,null),!1;if(l>=s&&l<=a){const e=a-l+1,t=Math.abs(n)-e;this[o]-=t+n,this[i]-=e}else if(l<=s&&h>=a)this[i]+=n;else if(l<=s&&h>=s&&h<a){const e=h-s+1;this[i]-=e}}return n$(i$,this,null),!0}isFarther(e,t){return!e||("down"===t?e.row+e.rowspan-1<this.row+this.rowspan-1:"up"===t?e.row>this.row:"right"===t?e.col+e.colspan-1<this.col+this.colspan-1:"left"===t?e.col>this.col:null)}getLastRow(){return this.row+this.rowspan-1}getLastColumn(){return this.col+this.colspan-1}getRange(){return t$(i$,this)||n$(i$,this,this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))),t$(i$,this)}};function s$(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function a$(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l$(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var h$=new WeakSet;class u${constructor(e){s$(this,h$),a$(this,"plugin",void 0),a$(this,"mergedCells",[]),a$(this,"mergedCellsMatrix",new Map),a$(this,"hot",void 0),this.plugin=e,this.hot=e.hot}static IS_OVERLAPPING_WARNING(e){let{row:t,col:n}=e;return Wd`The merged cell declared at [${t}, ${n}], overlaps\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\x20
      fix your setup.`}get(e,t){var n;return!!this.mergedCellsMatrix.has(e)&&(null!==(n=this.mergedCellsMatrix.get(e).get(t))&&void 0!==n&&n)}getByRange(e){const{row:t,col:n}=e.getTopStartCorner(),{row:r,col:i}=e.getBottomEndCorner(),o=this.mergedCells.length;let s=!1;for(let a=0;a<o;a++){const e=this.mergedCells[a],{row:o,col:l,rowspan:h,colspan:u}=e;if(o>=t&&o+h-1<=r&&l>=n&&l+u-1<=i){s=e;break}}return s}filterOverlappingMergeCells(e){const t=new Set;this.mergedCells.forEach((e=>{const{row:n,col:r,colspan:i,rowspan:o}=e;for(let s=n;s<n+o;s++)for(let e=r;e<r+i;e++)t.add(`r${s},c${e}`)}));return e.filter((e=>{const{row:n,col:r,colspan:i,rowspan:o}=e,s=new Set;let a=!1;for(let l=n;l<n+o;l++){for(let n=r;n<r+i;n++){const r=`r${l},c${n}`;if(t.has(r)){Om(u$.IS_OVERLAPPING_WARNING(e)),a=!0;break}s.add(r)}if(a)break}return a||t.add(...s),!a}))}getWithinRange(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const{row:n,col:r}=e.getTopStartCorner(),{row:i,col:o}=e.getBottomEndCorner(),s=[];for(let a=n;a<=i;a++)for(let e=r;e<=o;e++){const n=this.get(a,e);n&&(t||!t&&n.row===a&&n.col===e)&&s.push(n)}return s}add(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=e.row,r=e.col,i=e.rowspan,o=e.colspan,s=new o$(n,r,i,o,this.hot._createCellCoords,this.hot._createCellRange),a=this.get(n,r),l=!t&&this.isOverlapping(s);return a||l?(l&&Om(u$.IS_OVERLAPPING_WARNING(s)),!1):(this.hot&&s.normalize(this.hot),this.mergedCells.push(s),l$(h$,this,d$).call(this,s),s)}remove(e,t){const n=this.get(e,t),r=n?this.mergedCells.indexOf(n):-1;return!(!n||-1===r)&&(this.mergedCells.splice(r,1),l$(h$,this,p$).call(this,n),n)}clear(){Vd(this.mergedCells,(e=>{let{row:t,col:n,rowspan:r,colspan:i}=e;$w(t,t+r,(e=>{$w(n,n+i,(t=>{const n=this.hot.getCell(e,t);n&&(n.removeAttribute("rowspan"),n.removeAttribute("colspan"),n.style.display="")}))}))})),this.mergedCells.length=0,this.mergedCellsMatrix=new Map}isOverlapping(e){const t=e.getRange();for(let n=0;n<this.mergedCells.length;n++){if(this.mergedCells[n].getRange().overlaps(t))return!0}return!1}isFirstRenderableMergedCell(e,t){const n=this.get(e,t);if(!n)return!1;const{row:r,col:i,rowspan:o,colspan:s}=n,a=this.hot.view.getActiveOverlayName(),l=["top","top_inline_start_corner"].includes(a)?0:this.hot.getFirstRenderedVisibleRow(),h=["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(a)?0:this.hot.getFirstRenderedVisibleColumn(),u=Xw(l,r,r+o-1),c=Xw(h,i,i+s-1);return this.hot.rowIndexMapper.getNearestNotHiddenIndex(u,1)===e&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(c,1)===t}getFirstRenderableCoords(e,t){const n=this.get(e,t);if(!n||this.isFirstRenderableMergedCell(e,t))return this.hot._createCellCoords(e,t);const r=this.hot.rowIndexMapper.getNearestNotHiddenIndex(n.row,1),i=this.hot.columnIndexMapper.getNearestNotHiddenIndex(n.col,1);return this.hot._createCellCoords(r,i)}getStartMostColumnIndex(e,t){const n=l$(h$,this,c$).call(this,e,"col",-1);let r=t;for(let i=0;i<n.length;i++)if(n[i]<=t){r=n[i];break}return r}getEndMostColumnIndex(e,t){const n=l$(h$,this,c$).call(this,e,"col",1);let r=t;for(let i=0;i<n.length;i++)if(n[i]>=t){r=n[i];break}return r}getTopMostRowIndex(e,t){const n=l$(h$,this,c$).call(this,e,"row",-1);let r=t;for(let i=0;i<n.length;i++)if(n[i]<=t){r=n[i];break}return r}getBottomMostRowIndex(e,t){const n=l$(h$,this,c$).call(this,e,"row",1);let r=t;for(let i=0;i<n.length;i++)if(n[i]>=t){r=n[i];break}return r}shiftCollections(e,t,n){const r=[0,0];switch(e){case"right":r[0]+=n;break;case"left":r[0]-=n;break;case"down":r[1]+=n;break;case"up":r[1]-=n}const i=[];this.mergedCells.forEach((e=>{e.shift(r,t),e.removed&&i.push(e)})),i.forEach((e=>{this.mergedCells.splice(this.mergedCells.indexOf(e),1)})),this.mergedCellsMatrix.clear(),this.mergedCells.forEach((e=>{l$(h$,this,d$).call(this,e)}))}}function c$(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;const r=new Map,i=1===n?e.getTopStartCorner():e.getBottomEndCorner(),o=1===n?e.getBottomEndCorner():e.getTopStartCorner();for(let s=i.row;1===n?s<=o.row:s>=o.row;s+=n)for(let e=i.col;1===n?e<=o.col:e>=o.col;e+=n){const i="row"===t?s:e,o=this.get(s,e);let a=i;o&&(a=1===n?o[t]+o[`${t}span`]-1:o[t]),r.has(i)||r.set(i,new Set),r.get(i).add(a)}return Array.from(new Set(Array.from(r.entries()).filter((e=>{let[,t]=e;return 1===t.size})).flatMap((e=>{let[,t]=e;return Array.from(t)}))))}function d$(e){for(let t=e.row;t<e.row+e.rowspan;t++)for(let n=e.col;n<e.col+e.colspan;n++)this.mergedCellsMatrix.has(t)||this.mergedCellsMatrix.set(t,new Map),this.mergedCellsMatrix.get(t).set(n,e)}function p$(e){for(let t=e.row;t<e.row+e.rowspan;t++)for(let n=e.col;n<e.col+e.colspan;n++)this.mergedCellsMatrix.get(t).delete(n)}const g$=u$;function m$(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const f$=class{constructor(e){m$(this,"plugin",void 0),m$(this,"mergedCellsCollection",void 0),m$(this,"currentFillData",null),this.plugin=e,this.mergedCellsCollection=this.plugin.mergedCellsCollection}getDirection(e,t){let n=null;return n=t[0]===e[0]&&t[1]===e[1]&&t[3]===e[3]?"down":t[2]===e[2]&&t[1]===e[1]&&t[3]===e[3]?"up":t[1]===e[1]&&t[2]===e[2]?"right":"left",n}snapDragArea(e,t,n,r){const i=t.slice(0),o=this.getAutofillSize(e,t,n),[s,a,l,h]=e,u=["up","down"].indexOf(n)>-1?l-s+1:h-a+1,c=o-Math.floor(o/u)*u,d=this.getFarthestCollection(e,t,n,r);if(d)if("down"===n){const e=d.row+d.rowspan-s-c;i[2]+e>=this.plugin.hot.countRows()?i[2]-=c:i[2]+=c?e:0}else if("right"===n){const e=d.col+d.colspan-a-c;i[3]+e>=this.plugin.hot.countCols()?i[3]-=c:i[3]+=c?e:0}else if("up"===n){const e=l-c-d.row+1;i[0]+e<0?i[0]+=c:i[0]-=c?e:0}else if("left"===n){const e=h-c-d.col+1;i[1]+e<0?i[1]+=c:i[1]-=c?e:0}return this.updateCurrentFillCache({baseArea:e,dragDirection:n,foundMergedCells:r,fillSize:o,dragArea:i,cycleLength:u}),i}updateCurrentFillCache(e){this.currentFillData||(this.currentFillData={}),Kg(this.currentFillData,e)}getAutofillSize(e,t,n){const[r,i,o,s]=e,[a,l,h,u]=t;switch(n){case"up":return r-a;case"down":return h-o;case"left":return i-l;case"right":return u-s;default:return null}}getDragArea(e,t,n){const[r,i,o,s]=e,[a,l,h,u]=t;switch(n){case"up":return[a,l,r-1,s];case"down":{const e=this.mergedCellsCollection.get(h,s);return[o+1,i,h+(e?e.rowspan-1:0),s]}case"left":return[a,l,o,i-1];case"right":{const e=this.mergedCellsCollection.get(h,s);return[r,s+(e?e.colspan-1:0),h,u]}default:return null}}getFarthestCollection(e,t,n,r){const[i,o,s,a]=e,l=["up","down"].indexOf(n)>-1,h=l?s:a,u=l?i:o,c=this.getAutofillSize(e,t,n),d=l?s-i+1:a-o+1,p=c-Math.floor(c/d)*d;let g=null,m=null,f=null;switch(n){case"up":g="includesVertically",f=h-p+1;break;case"left":g="includesHorizontally",f=h-p+1;break;case"down":g="includesVertically",f=u+p-1;break;case"right":g="includesHorizontally",f=u+p-1}return Vd(r,(e=>{e[g](f)&&e.isFarther(m,n)&&(m=e)})),m}recreateAfterDataPopulation(e){if(!this.currentFillData)return;const t=this.getRangeFromChanges(e),n=this.currentFillData.foundMergedCells,r=this.currentFillData.dragDirection,i=(e,n)=>{switch(r){case"up":return e.row-n>=t.from.row;case"down":return e.row+e.rowspan-1+n<=t.to.row;case"left":return e.col-n>=t.from.column;case"right":return e.col+e.colspan-1+n<=t.to.column;default:return null}};let o=0,s=null,a=1;do{for(let e=0;e<n.length;e+=1){if(s=n[e],o=a*this.currentFillData.cycleLength,i(s,o))switch(r){case"up":this.plugin.mergedCellsCollection.add({row:s.row-o,rowspan:s.rowspan,col:s.col,colspan:s.colspan},!0);break;case"down":this.plugin.mergedCellsCollection.add({row:s.row+o,rowspan:s.rowspan,col:s.col,colspan:s.colspan},!0);break;case"left":this.plugin.mergedCellsCollection.add({row:s.row,rowspan:s.rowspan,col:s.col-o,colspan:s.colspan},!0);break;case"right":this.plugin.mergedCellsCollection.add({row:s.row,rowspan:s.rowspan,col:s.col+o,colspan:s.colspan},!0)}e===n.length-1&&(a+=1)}}while(i(s,o));this.currentFillData=null,this.plugin.hot.render(),n.length>0&&this.plugin.ifChromeForceRepaint()}getRangeFromChanges(e){const t={min:null,max:null},n={min:null,max:null};return Vd(e,(e=>{const r=e[0],i=this.plugin.hot.propToCol(e[1]);(null===t.min||r<t.min)&&(t.min=r),(null===t.max||r>t.max)&&(t.max=r),(null===n.min||i<n.min)&&(n.min=i),(null===n.max||i>n.max)&&(n.max=i)})),{from:{row:t.min,column:n.min},to:{row:t.max,column:n.max}}}dragAreaOverlapsCollections(e,t,n){const r=this.getDragArea(e,t,n),[i,o,s,a]=r,l=this.plugin.hot._createCellCoords(i,o),h=this.plugin.hot._createCellCoords(s,a),u=this.plugin.hot._createCellRange(l,l,h);if(0===this.mergedCellsCollection.getWithinRange(u,!0).length)return!1;const c=this.mergedCellsCollection.getWithinRange(u,!1);return 0===c.length||("up"===n||"down"===n?!c.every((e=>{let{colspan:t}=e;return t===u.getWidth()})):!c.every((e=>{let{rowspan:t}=e;return t===u.getHeight()})))}};function w$(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const y$=class{constructor(e){w$(this,"plugin",void 0),w$(this,"hot",void 0),w$(this,"fullySelectedMergedCellClassName","fullySelectedMergedCell"),this.plugin=e,this.hot=e.hot}getSelectedMergedCellClassName(e,t,n,r){const i=Math.min(n[0],n[2]),o=Math.min(n[1],n[3]),s=Math.max(n[0],n[2]),a=Math.max(n[1],n[3]);if(void 0===r)return;if(!this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(e,t))return;const l=this.plugin.mergedCellsCollection.get(e,t);if(!l)return;const h=l.getLastRow(),u=l.getLastColumn();return i<=l.row&&o<=l.col&&s>=h&&a>=u?`${this.fullySelectedMergedCellClassName}-${r}`:this.isMergeCellFullySelected(l,this.plugin.hot.getSelectedRange())?`${this.fullySelectedMergedCellClassName}-multiple`:void 0}isMergeCellFullySelected(e,t){const n=[];if(!t||!e)return!1;for(let r=0;r<e.rowspan;r+=1)for(let t=0;t<e.colspan;t+=1)n.push(this.hot._createCellCoords(e.row+r,e.col+t));for(let r=0;r<n.length;r+=1){const e=[];for(let i=0;i<t.length;i+=1)e[i]=t[i].includes(n[r]);if(!e.includes(!0))return!1}return!0}getSelectedMergedCellClassNameToRemove(){const e=[];for(let t=0;t<=7;t+=1)e.push(`${this.fullySelectedMergedCellClassName}-${t}`);return e.push(`${this.fullySelectedMergedCellClassName}-multiple`),e}};function v$(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class C${constructor(e){v$(this,"data",void 0),v$(this,"next",null),v$(this,"prev",null),this.data=e}}const S$=class{constructor(){v$(this,"first",null),v$(this,"last",null)}push(e){const t=new C$(e);if(null===this.first)this.first=t,this.last=t;else{const e=this.last;this.last=t,t.prev=e,e.next=t}return t}unshift(e){const t=new C$(e);if(null===this.first)this.first=t,this.last=t;else{const e=this.first;this.first=t,t.next=e,e.prev=t}}inorder(e){let t=this.first;for(;t;){const n=e(t);if(t===this.last||!0===n)break;t=t.next}}remove(e){if(null===this.first)return!1;let t,n,r=this.first;for(;r;){if(r.data===e)return t=r.next,n=r.prev,t&&(t.prev=n),n&&(n.next=t),r===this.first&&(this.first=t),r===this.last&&(this.last=n),!0;r=r.next}return!1}hasCycle(){let e=this.first,t=this.first;for(;;){if(null===e)return!1;if(e=e.next,null===e)return!1;if(e=e.next,t=t.next,e===t)return!0}}pop(){if(null===this.last)return null;const e=this.last;return this.last=this.last.prev,e}shift(){if(null===this.first)return null;const e=this.first;return this.first=this.first.next,e}recursiveReverse(){if(!this.first)return;!function e(t,n){n&&(e(n,n.next),n.next=t)}(this.first,this.first.next),this.first.next=null;const e=this.first;this.first=this.last,this.last=e}reverse(){if(!this.first||!this.first.next)return;let e,t=this.first.next,n=this.first;for(;t;)e=t.next,t.next=n,n.prev=t,n=t,t=e;this.first.next=null,this.last.prev=null,e=this.first,this.first=n,this.last=e}};function R$(e,t,n){E$(e,t),t.set(e,n)}function E$(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function b$(e,t){return e.get(N$(e,t))}function T$(e,t,n){return e.set(N$(e,t),n),n}function N$(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var A$=new WeakMap,M$=new WeakMap,I$=new WeakMap,O$=new WeakMap,x$=new WeakMap,P$=new WeakMap,_$=new WeakMap,L$=new WeakSet;class H${constructor(e){let{mergedCellsGetter:t,rowIndexMapper:n,columnIndexMapper:r}=e;var i,o;E$(i=this,o=L$),o.add(i),R$(this,A$,new S$),R$(this,M$,new S$),R$(this,I$,null),R$(this,O$,null),R$(this,x$,null),R$(this,P$,null),R$(this,_$,null),T$(x$,this,t),T$(P$,this,n),T$(_$,this,r)}getCurrentVerticalNode(){return b$(O$,this).data}getFirstVerticalNode(){return b$(M$,this).first.data}getNextVerticalNode(){return b$(O$,this).next.data}getPrevVerticalNode(){return b$(O$,this).prev.data}getCurrentHorizontalNode(){return b$(I$,this).data}getFirstHorizontalNode(){return b$(A$,this).first.data}getNextHorizontalNode(){return b$(I$,this).next.data}getPrevHorizontalNode(){return b$(I$,this).prev.data}setPrevNodeAsActive(){T$(O$,this,b$(O$,this).prev),T$(I$,this,b$(I$,this).prev)}setNextNodeAsActive(){T$(O$,this,b$(O$,this).next),T$(I$,this,b$(I$,this).next)}buildFocusOrder(e){const t=e.getTopStartCorner(),n=e.getBottomEndCorner(),r=new WeakSet;T$(A$,this,new S$);for(let o=t.row;o<=n.row;o++)if(!b$(P$,this).isHidden(o))for(let i=t.col;i<=n.col;i++){if(b$(_$,this).isHidden(i))continue;const t=N$(L$,this,k$).call(this,e,b$(A$,this),r,o,i);t&&T$(I$,this,t)}b$(A$,this).first&&(b$(A$,this).first.prev=b$(A$,this).last,b$(A$,this).last.next=b$(A$,this).first);const i=new WeakSet;T$(M$,this,new S$);for(let o=t.col;o<=n.col;o++)if(!b$(_$,this).isHidden(o))for(let r=t.row;r<=n.row;r++){if(b$(P$,this).isHidden(r))continue;const t=N$(L$,this,k$).call(this,e,b$(M$,this),i,r,o);t&&T$(O$,this,t)}b$(M$,this).first&&(b$(M$,this).first.prev=b$(M$,this).last,b$(M$,this).last.next=b$(M$,this).first)}setActiveNode(e,t){return b$(A$,this).inorder((n=>{const{rowStart:r,rowEnd:i,colStart:o,colEnd:s}=n.data;if(e>=r&&e<=i&&t>=o&&t<=s)return T$(I$,this,n),!1})),b$(M$,this).inorder((n=>{const{rowStart:r,rowEnd:i,colStart:o,colEnd:s}=n.data;if(e>=r&&e<=i&&t>=o&&t<=s)return T$(O$,this,n),!1})),this}}function k$(e,t,n,r,i){const o=e.getTopStartCorner(),s=e.getBottomEndCorner(),a=e.highlight.clone().normalize(),l=b$(x$,this).call(this,r,i);if(l&&n.has(l))return null;const h={colStart:i,colEnd:i,rowStart:r,rowEnd:r};if(l){if(n.add(l),l.row<o.row||l.row+l.rowspan-1>s.row||l.col<o.col||l.col+l.colspan-1>s.col)return null;h.colStart=l.col,h.colEnd=l.col+l.colspan-1,h.rowStart=l.row,h.rowEnd=l.row+l.rowspan-1}const u=t.push(h);return r===a.row&&i===a.col||l&&a.row>=l.row&&a.row<=l.row+l.rowspan-1&&a.col>=l.col&&a.col<=l.col+l.colspan-1?u:null}function F$(e,t,n){D$(e,t),t.set(e,n)}function D$(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function V$(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function U$(e,t,n){return e.set(W$(e,t),n),n}function B$(e,t){return e.get(W$(e,t))}function W$(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}mf.getSingleton().register("beforeMergeCells"),mf.getSingleton().register("afterMergeCells"),mf.getSingleton().register("beforeUnmergeCells"),mf.getSingleton().register("afterUnmergeCells");const j$="mergeCells",G$=j$;var z$=new WeakMap,$$=new WeakMap,Y$=new WeakMap,K$=new WeakMap,X$=new WeakSet;class q$ extends Tx{constructor(){var e,t;super(...arguments),D$(e=this,t=X$),t.add(e),V$(this,"mergedCellsCollection",null),V$(this,"autofillCalculations",null),V$(this,"selectionCalculations",null),F$(this,z$,null),F$(this,$$,{row:0,col:0}),F$(this,Y$,new H$({mergedCellsGetter:(e,t)=>this.mergedCellsCollection.get(e,t),rowIndexMapper:this.hot.rowIndexMapper,columnIndexMapper:this.hot.columnIndexMapper})),F$(this,K$,function(e){const{hot:t}=e,{rowIndexMapper:n,columnIndexMapper:r}=t;return{before:function(){},after:function(i,o,s){const a=e.mergedCellsCollection.get(o,s);if(!em(a))return i.removeAttribute("rowspan"),i.removeAttribute("colspan"),void(i.style.display="");const{row:l,col:h,colspan:u,rowspan:c}=a,[d,p]=e.translateMergedCellToRenderable(l,c,h,u),g=e.getSetting("virtualized"),m=d-n.getRenderableFromVisualIndex(o)+1,f=p-r.getRenderableFromVisualIndex(s)+1;let w=n.getNearestNotHiddenIndex(l,1),y=r.getNearestNotHiddenIndex(h,1);if(g){const e=t.view.getActiveOverlayName();["top","top_inline_start_corner"].includes(e)||(w=Math.max(w,t.getFirstRenderedVisibleRow())),["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(e)||(y=Math.max(y,t.getFirstRenderedVisibleColumn()))}const v=Math.min(c,m),C=Math.min(u,f);w===o&&y===s?(i.setAttribute("rowspan",v),i.setAttribute("colspan",C)):(i.removeAttribute("rowspan"),i.removeAttribute("colspan"),i.style.display="none")}}}(this))}static get PLUGIN_KEY(){return j$}static get PLUGIN_PRIORITY(){return 150}static get DEFAULT_SETTINGS(){return{[Cx]:"cells",virtualized:!1,cells:[]}}isEnabled(){return!!this.hot.getSettings()[j$]}enablePlugin(){var e=this;this.enabled||(this.mergedCellsCollection=new g$(this),this.autofillCalculations=new f$(this),this.selectionCalculations=new y$(this),this.addHook("afterInit",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return W$(X$,e,Q$).call(e,...n)})),this.addHook("modifyTransformFocus",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return W$(X$,e,J$).call(e,...n)})),this.addHook("modifyTransformStart",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return W$(X$,e,eY).call(e,...n)})),this.addHook("modifyTransformEnd",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return W$(X$,e,tY).call(e,...n)})),this.addHook("beforeSelectionHighlightSet",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return W$(X$,e,nY).call(e,...n)})),this.addHook("beforeSetRangeStart",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return W$(X$,e,oY).call(e,...n)})),this.addHook("beforeSetRangeStartOnly",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return W$(X$,e,oY).call(e,...n)})),this.addHook("beforeSelectionFocusSet",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return W$(X$,e,sY).call(e,...n)})),this.addHook("afterSelectionFocusSet",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return W$(X$,e,aY).call(e,...n)})),this.addHook("afterSelectionEnd",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return W$(X$,e,lY).call(e,...n)})),this.addHook("modifyGetCellCoords",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return W$(X$,e,rY).call(e,...n)})),this.addHook("modifyGetCoordsElement",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return W$(X$,e,rY).call(e,...n)})),this.addHook("afterIsMultipleSelection",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return W$(X$,e,Z$).call(e,...n)})),this.addHook("afterRenderer",(function(){return B$(K$,e).after(...arguments)})),this.addHook("afterContextMenuDefaultOptions",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return W$(X$,e,iY).call(e,...n)})),this.addHook("afterGetCellMeta",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return W$(X$,e,hY).call(e,...n)})),this.addHook("afterViewportRowCalculatorOverride",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return W$(X$,e,uY).call(e,...n)})),this.addHook("afterViewportColumnCalculatorOverride",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return W$(X$,e,cY).call(e,...n)})),this.addHook("modifyAutofillRange",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return W$(X$,e,dY).call(e,...n)})),this.addHook("afterCreateCol",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return W$(X$,e,pY).call(e,...n)})),this.addHook("afterRemoveCol",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return W$(X$,e,gY).call(e,...n)})),this.addHook("afterCreateRow",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return W$(X$,e,mY).call(e,...n)})),this.addHook("afterRemoveRow",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return W$(X$,e,fY).call(e,...n)})),this.addHook("afterChange",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return W$(X$,e,wY).call(e,...n)})),this.addHook("beforeDrawBorders",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return W$(X$,e,yY).call(e,...n)})),this.addHook("afterDrawSelection",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return W$(X$,e,vY).call(e,...n)})),this.addHook("beforeRemoveCellClassNames",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return W$(X$,e,CY).call(e,...n)})),this.addHook("beforeBeginEditing",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return W$(X$,e,SY).call(e,...n)})),this.addHook("modifyRowHeightByOverlayName",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return W$(X$,e,RY).call(e,...n)})),this.addHook("beforeUndoStackChange",((e,t)=>{if("MergeCells"===t)return!1})),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(),super.updatePlugin()}ifChromeForceRepaint(){if(!gm())return;const e=[];let t=[];this.mergedCellsCollection.mergedCells.forEach((e=>{const{row:n,rowspan:r}=e;for(let i=n+1;i<n+r;i++)t.push(i)})),t=[...new Set(t)],t.forEach((t=>{const n=this.hot.rowIndexMapper.getRenderableFromVisualIndex(t);this.hot.view._wt.wtOverlays.getOverlays(!0).map((e=>"master"===(null==e?void 0:e.name)?e:e.clone.wtTable)).forEach((t=>{const r=t.getRow(n);r&&(r.style.background=Yp(r,"backgroundColor").replace(")",", 0.99)"),e.push(r))}))})),this.hot._registerTimeout((()=>{e.forEach((e=>{e.style.background=Yp(e,"backgroundColor").replace(", 0.99)",")")}))}),1)}validateSetting(e){return!!e&&(o$.containsNegativeValues(e)?(Om(o$.NEGATIVE_VALUES_WARNING(e)),!1):o$.isOutOfBounds(e,this.hot.countRows(),this.hot.countCols())?(Om(o$.IS_OUT_OF_BOUNDS_WARNING(e)),!1):o$.isSingleCell(e)?(Om(o$.IS_SINGLE_CELL(e)),!1):!o$.containsZeroSpan(e)||(Om(o$.ZERO_SPAN_WARNING(e)),!1))}generateFromSettings(){const e=this.getSetting("cells").filter((e=>this.validateSetting(e))),t=this.mergedCellsCollection.filterOverlappingMergeCells(e),n=[];t.forEach((e=>{const{row:t,col:r,rowspan:i,colspan:o}=e,s=this.hot._createCellCoords(t,r),a=this.hot._createCellCoords(t+i-1,r+o-1),l=this.hot._createCellRange(s,s,a);this.mergeRange(l,!0,!0);for(let h=t;h<t+i;h++)for(let e=r;e<r+o;e++)h===t&&e===r||n.push([h,e,null])})),0!==n.length&&this.hot.setDataAtCell(n,void 0,void 0,this.pluginName)}clearCollections(){this.mergedCellsCollection.clear()}canMergeRange(e){return!!(arguments.length>1&&void 0!==arguments[1]&&arguments[1])||this.validateSetting(e)}mergeSelection(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;e.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");const{from:t,to:n}=e;this.unmergeRange(e,!0),this.mergeRange(e),this.hot.selectCell(t.row,t.col,n.row,n.col,!1)}unmergeSelection(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;const{from:t,to:n}=e;this.unmergeRange(e,!0),this.hot.selectCell(t.row,t.col,n.row,n.col,!1)}mergeRange(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=e.getTopStartCorner(),i=e.getBottomEndCorner(),o={row:r.row,col:r.col,rowspan:i.row-r.row+1,colspan:i.col-r.col+1},s=[];let a=null;if(!this.canMergeRange(o,t))return!1;this.hot.runHooks("beforeMergeCells",e,t),$w(0,o.rowspan-1,(e=>{$w(0,o.colspan-1,(t=>{let n=null;s[e]||(s[e]=[]),0===e&&0===t?n=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(o.row),this.hot.toPhysicalColumn(o.col)):this.hot.setCellMeta(o.row+e,o.col+t,"hidden",!0),s[e][t]=n}))})),this.hot.setCellMeta(o.row,o.col,"spanned",!0);return!this.mergedCellsCollection.add(o,t)||(n?a=[o.row,o.col,s]:this.hot.populateFromArray(o.row,o.col,s,void 0,void 0,this.pluginName),t||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",e,o,t),a)}unmergeRange(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=this.mergedCellsCollection.getWithinRange(e);0!==n.length&&(this.hot.runHooks("beforeUnmergeCells",e,t),Vd(n,(e=>{this.mergedCellsCollection.remove(e.row,e.col),$w(0,e.rowspan-1,(t=>{$w(0,e.colspan-1,(n=>{this.hot.removeCellMeta(e.row+t,e.col+n,"hidden"),this.hot.removeCellMeta(e.row+t,e.col+n,"copyable")}))})),this.hot.removeCellMeta(e.row,e.col,"spanned")})),this.hot.runHooks("afterUnmergeCells",e,t),this.hot.render())}toggleMerge(e){const t=this.mergedCellsCollection.get(e.from.row,e.from.col);t.row===e.from.row&&t.col===e.from.col&&t.row+t.rowspan-1===e.to.row&&t.col+t.colspan-1===e.to.col?this.unmergeRange(e):this.mergeSelection(e)}merge(e,t,n,r){const i=this.hot._createCellCoords(e,t),o=this.hot._createCellCoords(n,r);this.mergeRange(this.hot._createCellRange(i,i,o))}unmerge(e,t,n,r){const i=this.hot._createCellCoords(e,t),o=this.hot._createCellCoords(n,r);this.unmergeRange(this.hot._createCellRange(i,i,o))}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control","m"]],callback:()=>{const e=this.hot.getSelectedRangeLast();e&&!e.isSingleHeader()&&(this.toggleMerge(e),this.hot.render())},runOnlyIf:e=>!e.altKey,group:G$})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(G$)}modifyViewportRowStart(e,t){const n=this.hot.rowIndexMapper,r=n.getVisualFromRenderableIndex(e.startRow);for(let i=0;i<t;i+=1){const o=this.mergedCellsCollection.get(r,i);if(em(o)){const r=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(o.row,1));if(r<e.startRow)return e.startRow=r,void this.modifyViewportRowStart(e,t)}}}modifyViewportRowEnd(e,t){const n=this.hot.rowIndexMapper,r=n.getVisualFromRenderableIndex(e.endRow);for(let i=0;i<t;i+=1){const o=this.mergedCellsCollection.get(r,i);if(em(o)){const r=o.row+o.rowspan-1,i=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(r,-1));if(i>e.endRow)return e.endRow=i,void this.modifyViewportRowEnd(e,t)}}}modifyViewportColumnStart(e,t){const n=this.hot.columnIndexMapper,r=n.getVisualFromRenderableIndex(e.startColumn);for(let i=0;i<t;i+=1){const o=this.mergedCellsCollection.get(i,r);if(em(o)){const r=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(o.col,1));if(r<e.startColumn)return e.startColumn=r,void this.modifyViewportColumnStart(e,t)}}}modifyViewportColumnEnd(e,t){const n=this.hot.columnIndexMapper,r=n.getVisualFromRenderableIndex(e.endColumn);for(let i=0;i<t;i+=1){const o=this.mergedCellsCollection.get(i,r);if(em(o)){const r=o.col+o.colspan-1,i=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(r,-1));if(i>e.endColumn)return e.endColumn=i,void this.modifyViewportColumnEnd(e,t)}}}translateMergedCellToRenderable(e,t,n,r){const{rowIndexMapper:i,columnIndexMapper:o}=this.hot;let s,a;s=0===t?i.getNearestNotHiddenIndex(e,1):i.getNearestNotHiddenIndex(e+t-1,-1),a=0===r?o.getNearestNotHiddenIndex(n,1):o.getNearestNotHiddenIndex(n+r-1,-1);return[e>=0?i.getRenderableFromVisualIndex(s):e,n>=0?o.getRenderableFromVisualIndex(a):n]}}function Q$(){this.generateFromSettings(),this.hot.render()}function Z$(e){if(e){const e=this.mergedCellsCollection.mergedCells,t=this.hot.getSelectedRangeLast(),n=t.getTopStartCorner(),r=t.getBottomEndCorner();for(let i=0;i<e.length;i+=1)if(n.row===e[i].row&&n.col===e[i].col&&r.row===e[i].row+e[i].rowspan-1&&r.col===e[i].col+e[i].colspan-1)return!1}return e}function J$(e){B$($$,this).row=e.row,B$($$,this).col=e.col}function eY(e){const t=this.hot.getSelectedRangeLast(),{highlight:n}=t,{columnIndexMapper:r,rowIndexMapper:i}=this.hot;B$(z$,this)&&(null!==i.getRenderableFromVisualIndex(B$(z$,this).row)&&(n.row=B$(z$,this).row),null!==r.getRenderableFromVisualIndex(B$(z$,this).col)&&(n.col=B$(z$,this).col),U$(z$,this,null));const o=this.mergedCellsCollection.get(n.row,n.col);if(!o)return;const s=o.col,a=o.col+o.colspan-1;if(e.col<0){const t=n.col>=s&&n.col<=a?s-1:a,i=r.getNearestNotHiddenIndex(t,-1);e.col=null===i?-this.hot.view.countRenderableColumnsInRange(0,n.col):-Math.max(this.hot.view.countRenderableColumnsInRange(i,n.col)-1,1)}else if(e.col>0){const t=n.col>=s&&n.col<=a?a+1:s,i=r.getNearestNotHiddenIndex(t,1);e.col=null===i?this.hot.view.countRenderableColumnsInRange(n.col,this.hot.countCols()):Math.max(this.hot.view.countRenderableColumnsInRange(n.col,i)-1,1)}const l=o.row,h=o.row+o.rowspan-1;if(e.row<0){const t=n.row>=l&&n.row<=h?l-1:h,r=i.getNearestNotHiddenIndex(t,-1);e.row=null===r?-this.hot.view.countRenderableRowsInRange(0,n.row):-Math.max(this.hot.view.countRenderableRowsInRange(r,n.row)-1,1)}else if(e.row>0){const t=n.row>=l&&n.row<=h?h+1:l,r=i.getNearestNotHiddenIndex(t,1);e.row=null===r?this.hot.view.countRenderableRowsInRange(n.row,this.hot.countRows()):Math.max(this.hot.view.countRenderableRowsInRange(n.row,r)-1,1)}}function tY(e){const t=this.hot.getSelectedRangeLast(),n=t.clone(),{to:r}=t,{columnIndexMapper:i,rowIndexMapper:o}=this.hot,s=(e,t)=>{n.expand(this.hot._createCellCoords(e,t));for(let r=0;r<this.mergedCellsCollection.mergedCells.length;r+=1)n.expandByRange(this.mergedCellsCollection.mergedCells[r].getRange())};if(e.col<0){let o=this.mergedCellsCollection.getStartMostColumnIndex(t,r.col)+e.col;s(r.row,o),"E-W"===t.getHorizontalDirection()&&"E-W"===n.getHorizontalDirection()&&(o=n.getTopStartCorner().col);const a=i.getNearestNotHiddenIndex(o,1);null!==a&&(e.col=-Math.max(this.hot.view.countRenderableColumnsInRange(a,r.col)-1,1))}else if(e.col>0){let o=this.mergedCellsCollection.getEndMostColumnIndex(t,r.col)+e.col;s(r.row,o),"W-E"===t.getHorizontalDirection()&&"W-E"===n.getHorizontalDirection()&&(o=n.getBottomEndCorner().col);const a=i.getNearestNotHiddenIndex(o,-1);null!==a&&(e.col=Math.max(this.hot.view.countRenderableColumnsInRange(r.col,a)-1,1))}if(e.row<0){let i=this.mergedCellsCollection.getTopMostRowIndex(t,r.row)+e.row;s(i,r.col),"S-N"===t.getVerticalDirection()&&"S-N"===n.getVerticalDirection()&&(i=n.getTopStartCorner().row);const a=o.getNearestNotHiddenIndex(i,1);null!==a&&(e.row=-Math.max(this.hot.view.countRenderableRowsInRange(a,r.row)-1,1))}else if(e.row>0){let i=this.mergedCellsCollection.getBottomMostRowIndex(t,r.row)+e.row;s(i,r.col),"N-S"===t.getVerticalDirection()&&"N-S"===n.getVerticalDirection()&&(i=n.getBottomStartCorner().row);const a=o.getNearestNotHiddenIndex(i,-1);null!==a&&(e.row=Math.max(this.hot.view.countRenderableRowsInRange(r.row,a)-1,1))}}function nY(){const e=this.hot.getSelectedRangeLast(),{highlight:t}=e;if(this.hot.selection.isSelectedByColumnHeader()||this.hot.selection.isSelectedByRowHeader())return void U$(z$,this,t.clone());for(let r=0;r<this.mergedCellsCollection.mergedCells.length;r+=1)e.expandByRange(this.mergedCellsCollection.mergedCells[r].getRange(),!1);for(let r=0;r<this.mergedCellsCollection.mergedCells.length;r+=1)e.expandByRange(this.mergedCellsCollection.mergedCells[r].getRange(),!1);const n=this.mergedCellsCollection.get(t.row,t.col);U$(z$,this,t.clone()),n&&t.assign(n)}function rY(e,t,n,r){if(e<0||t<0)return;const i=this.mergedCellsCollection.get(e,t);if(!i)return;const{row:o,col:s,colspan:a,rowspan:l}=i,h=o,u=s,c=o+l-1,d=s+a-1;if("render"===r&&this.getSetting("virtualized")){const e=this.hot.view.getActiveOverlayName(),t=["top","top_inline_start_corner"].includes(e)?0:this.hot.getFirstRenderedVisibleRow(),n=["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(e)?0:this.hot.getFirstRenderedVisibleColumn();return[Xw(t,h,c),Xw(n,u,d),Xw(this.hot.getLastRenderedVisibleRow(),h,c),Xw(this.hot.getLastRenderedVisibleColumn(),u,d)]}return[h,u,c,d]}function iY(e){var t;e.items.push({name:"---------"},(t=this,{key:"mergeCells",name(){const e=this.getSelectedLast();if(e){const n=t.mergedCellsCollection.get(e[0],e[1]);if(n.row===e[0]&&n.col===e[1]&&n.row+n.rowspan-1===e[2]&&n.col+n.colspan-1===e[3])return this.getTranslatedPhrase(Pb)}return this.getTranslatedPhrase(xb)},callback(){const e=this.getSelectedRangeLast();if(!e)return;e.setDirection(this.isRtl()?"NE-SW":"NW-SE");const{from:n,to:r}=e;t.toggleMerge(e),this.selectCell(n.row,n.col,r.row,r.col,!1)},disabled(){const e=this.getSelectedLast();return!e||o$.isSingleCell({row:e[0],col:e[1],rowspan:e[2]-e[0]+1,colspan:e[3]-e[1]+1})||this.selection.isSelectedByCorner()},hidden:!1}))}function oY(){U$(z$,this,null)}function sY(){if(B$(z$,this).isCell())return;const e=this.hot.getSelectedRangeLast(),t=e.getVerticalDirection(),n=e.getHorizontalDirection(),r=B$(z$,this).clone().normalize();B$(Y$,this).setActiveNode(r.row,r.col),B$($$,this).row>0||B$($$,this).col>0?B$(Y$,this).setPrevNodeAsActive():("E-W"===n&&B$($$,this).col<0||"S-N"===t&&B$($$,this).row<0)&&B$(Y$,this).setNextNodeAsActive()}function aY(e,t){const n=this.hot.getSelectedRangeLast(),{columnIndexMapper:r,rowIndexMapper:i}=this.hot;let o=null,s=null;if(B$($$,this).col<0){const{rowEnd:e,colEnd:t}=B$(Y$,this).getPrevHorizontalNode();s=r.getNearestNotHiddenIndex(t,-1),o=i.getNearestNotHiddenIndex(e,-1)}else if(B$($$,this).col>0){const{rowStart:e,colStart:t}=B$(Y$,this).getNextHorizontalNode();s=r.getNearestNotHiddenIndex(t,1),o=i.getNearestNotHiddenIndex(e,1)}else if(B$($$,this).row<0){const{rowEnd:e,colEnd:t}=B$(Y$,this).getPrevVerticalNode();s=r.getNearestNotHiddenIndex(t,-1),o=i.getNearestNotHiddenIndex(e,-1)}else if(B$($$,this).row>0){const{rowStart:e,colStart:t}=B$(Y$,this).getNextVerticalNode();s=r.getNearestNotHiddenIndex(t,1),o=i.getNearestNotHiddenIndex(e,1)}if(null!==o||null!==s){const r=this.hot._createCellCoords(o,s),i=this.mergedCellsCollection.get(r.row,r.col),a=this.hot.selection.highlight.getFocus();e=r.row,t=r.col,i?n.highlight.assign({row:this.hot.rowIndexMapper.getNearestNotHiddenIndex(i.row,1),col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(i.col,1)}):n.highlight.assign(r),a.clear(),a.add(r).commit()}B$(Y$,this).setActiveNode(e,t),U$($$,this,{row:0,col:0})}function lY(){this.hot.getSelectedRangeLast().isHeader()||B$(Y$,this).buildFocusOrder(this.hot.getSelectedRangeLast())}function hY(e,t,n){const r=this.mergedCellsCollection.get(e,t);r&&(r.row!==e||r.col!==t?n.copyable=!1:(n.rowspan=r.rowspan,n.colspan=r.colspan))}function uY(e){if(this.getSetting("virtualized"))return;const t=this.hot.countCols();this.modifyViewportRowStart(e,t),this.modifyViewportRowEnd(e,t)}function cY(e){if(this.getSetting("virtualized"))return;const t=this.hot.countRows();this.modifyViewportColumnStart(e,t),this.modifyViewportColumnEnd(e,t)}function dY(e,t){const n=this.autofillCalculations.getDirection(t,e);if(this.autofillCalculations.dragAreaOverlapsCollections(t,e,n))return t;const r=this.hot._createCellCoords(t[0],t[1]),i=this.hot._createCellCoords(t[2],t[3]),o=this.hot._createCellRange(r,r,i),s=this.mergedCellsCollection.getWithinRange(o);return 0===s.length?e:this.autofillCalculations.snapDragArea(t,e,n,s)}function pY(e,t){this.mergedCellsCollection.shiftCollections("right",e,t)}function gY(e,t){this.mergedCellsCollection.shiftCollections("left",e,t)}function mY(e,t,n){"auto"!==n&&this.mergedCellsCollection.shiftCollections("down",e,t)}function fY(e,t){this.mergedCellsCollection.shiftCollections("up",e,t)}function wY(e,t){"Autofill.fill"===t&&this.autofillCalculations.recreateAfterDataPopulation(e)}function yY(e,t){if(t&&"area"===t){const t=this.hot.getSelectedRangeLast();Vd(this.mergedCellsCollection.getWithinRange(t),(n=>{t.getBottomEndCorner().row===n.getLastRow()&&t.getBottomEndCorner().col===n.getLastColumn()&&(e[2]=n.row,e[3]=n.col)}))}}function vY(e,t,n,r){if(n)return this.selectionCalculations.getSelectedMergedCellClassName(e,t,n,r)}function CY(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}function SY(e,t,n,r){if(!(r instanceof MouseEvent))return;const i=this.hot.getSelectedRangeLast(),o=this.mergedCellsCollection.getByRange(i);if(!o)return;const s=this.hot._createCellCoords(o.row,o.col),a=this.hot._createCellCoords(o.row+o.rowspan-1,o.col+o.colspan-1);return 0===this.hot.selection.getLayerLevel()&&i.isEqual(this.hot._createCellRange(s,s,a))}function RY(e,t,n){if(this.hot.getSettings().rowHeaders||"bottom"===n||"bottom_inline_start_corner"===n)return e;let r,i;if("master"===n)r=this.hot.getFirstRenderedVisibleColumn(),i=this.hot.getLastRenderedVisibleColumn();else{const e=this.hot.view.getOverlayByName(n);r=this.hot.columnIndexMapper.getVisualFromRenderableIndex(e.clone.wtTable.getFirstRenderedColumn()),i=this.hot.columnIndexMapper.getVisualFromRenderableIndex(e.clone.wtTable.getLastRenderedColumn())}if(!this.mergedCellsCollection.get(t,r))return e;const o=this.hot._createCellCoords(t,r),s=this.hot._createCellCoords(t,i),a=this.hot._createCellRange(o,o,s),l=this.mergedCellsCollection.getWithinRange(a,!0),h=l.reduce(((e,t)=>{let{rowspan:n}=t;return Math.max(e,n)}),1);let u=0;return l.length>1&&l[0].rowspan<h&&(u=h-l[0].rowspan),l.forEach((r=>{let{rowspan:i}=r,o=0;o="top"===n||"top_inline_start_corner"===n?Math.min(h,this.hot.view.countNotHiddenFixedRowsTop()-t):i-u,e=Math.max(null!=e?e:0,W$(X$,this,EY).call(this,t,o))})),e}function EY(e,t){const{view:n,rowIndexMapper:r}=this.hot,i=n.getStylesHandler(),o=n.getDefaultRowHeight();let s=0;for(let l=e;l<e+t;l++){var a;if(!r.isHidden(l))s+=null!==(a=this.hot.getRowHeight(l))&&void 0!==a?a:o,0!==l||i.isClassicTheme()||(s+=1)}return s}const bY="sort";function TY(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const NY="multiColumnSorting",AY=NY;l_(NY,(function(e,t){return function(n,r){const[,...i]=n,[,...o]=r;return function n(r){const s=e[r],a=t[r],l=i[r],h=o[r],u=a.multiColumnSorting,c=(u.compareFunctionFactory?u.compareFunctionFactory:u_(a.type))(s,a,u)(l,h);if(c===c_){const e=r+1;if(void 0!==t[e])return n(e)}return c}(0)}}));class MY extends H_{constructor(){super(...arguments),TY(this,"pluginKey",NY)}static get PLUGIN_KEY(){return NY}static get PLUGIN_PRIORITY(){return 170}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){super.enablePlugin()}disablePlugin(){super.disablePlugin()}registerShortcuts(){super.registerShortcuts(),this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Shift","Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();return-1===e.row&&e.col>=0&&this.sort(this.getNextSortConfig(e.col,x_)),!1},runOnlyIf:()=>{var e,t;const n=null===(e=this.hot.getSelectedRangeLast())||void 0===e?void 0:e.highlight;return n&&(null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.isSingle())&&this.hot.selection.isCellVisible(n)&&n.isHeader()},relativeToGroup:DA,position:"before",group:AY})}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(AY)}sort(e){super.sort(e)}clearSort(){super.clearSort()}isSorted(){return super.isSorted()}getSortConfig(e){return super.getSortConfig(e)}setSortConfig(e){super.setSortConfig(e)}getNormalizedSortConfigs(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Array.isArray(e)?e:[e]}updateHeaderClasses(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];super.updateHeaderClasses(e,...n),xp(e,function(e){const t=e.className.split(" "),n=new RegExp(`^${bY}-[0-9]{1,2}$`);return t.filter((e=>n.test(e)))}(e)),!1!==this.enabled&&Op(e,function(e,t,n){const r=[];return!1===n||e.isColumnSorted(t)&&e.getNumberOfSortedColumns()>1&&r.push(`${bY}-${e.getIndexOfColumnInSortQueue(t)+1}`),r}(...n))}onAfterOnCellMouseDown(e,t){!1!==S_(t.row,t.col,e)&&this.wasClickableHeaderClicked(e,t.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(t.col),this.sort(this.getNextSortConfig(t.col,x_))):this.sort(this.getColumnNextConfig(t.col)))}}function IY(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class OY extends Tx{constructor(){super(...arguments),IY(this,"dragged",[]),IY(this,"lastSetCell",null)}static get PLUGIN_KEY(){return"multipleSelectionHandles"}static get PLUGIN_PRIORITY(){return 160}isEnabled(){return wm()}enablePlugin(){this.enabled||(this.registerListeners(),super.enablePlugin())}registerListeners(){const e=this,{rootElement:t}=this.hot;function n(t){if(1===e.dragged.length)return e.dragged.splice(0,e.dragged.length),!0;const n=e.dragged.indexOf(t);if(-1===n)return!1;0===n?e.dragged=e.dragged.slice(0,1):1===n&&(e.dragged=e.dragged.slice(-1))}this.eventManager.addEventListener(t,"touchstart",(t=>{let n;return Ip(t.target,"topSelectionHandle-HitArea")?(n=e.hot.getSelectedRangeLast(),e.dragged.push("top"),e.touchStartRange={width:n.getWidth(),height:n.getHeight(),direction:n.getDirection()},t.preventDefault(),!1):Ip(t.target,"bottomSelectionHandle-HitArea")?(n=e.hot.getSelectedRangeLast(),e.dragged.push("bottom"),e.touchStartRange={width:n.getWidth(),height:n.getHeight(),direction:n.getDirection()},t.preventDefault(),!1):void 0})),this.eventManager.addEventListener(t,"touchend",(t=>Ip(t.target,"topSelectionHandle-HitArea")?(n.call(e,"top"),e.touchStartRange=void 0,t.preventDefault(),!1):Ip(t.target,"bottomSelectionHandle-HitArea")?(n.call(e,"bottom"),e.touchStartRange=void 0,t.preventDefault(),!1):void 0)),this.eventManager.addEventListener(t,"touchmove",(t=>{const{rootDocument:n}=this.hot;let r,i,o,s,a,l;if(0===e.dragged.length)return;const h=n.elementFromPoint(t.touches[0].clientX,t.touches[0].clientY);h&&h!==e.lastSetCell&&("TD"!==h.nodeName&&"TH"!==h.nodeName||(r=e.hot.getCoords(h),-1===r.col&&(r.col=0),i=e.hot.getSelectedRangeLast(),o=i.getWidth(),s=i.getHeight(),a=i.getDirection(),1===o&&1===s&&e.hot.selection.setRangeEnd(r),l=e.getCurrentRangeCoords(i,r,e.touchStartRange.direction,a,e.dragged[0]),null!==l.start&&e.hot.selection.setRangeStart(l.start),e.hot.selection.setRangeEnd(l.end),e.lastSetCell=h),t.preventDefault())}))}getCurrentRangeCoords(e,t,n,r,i){const o=e.getTopStartCorner(),s=e.getBottomEndCorner(),a=e.getBottomStartCorner(),l=e.getTopEndCorner();let h={start:null,end:null};switch(n){case"NE-SW":switch(r){case"NE-SW":case"NW-SE":h="top"===i?{start:this.hot._createCellCoords(t.row,e.highlight.col),end:this.hot._createCellCoords(a.row,t.col)}:{start:this.hot._createCellCoords(e.highlight.row,t.col),end:this.hot._createCellCoords(t.row,o.col)};break;case"SE-NW":"bottom"===i&&(h={start:this.hot._createCellCoords(s.row,t.col),end:this.hot._createCellCoords(t.row,o.col)})}break;case"NW-SE":switch(r){case"NE-SW":"top"===i?h={start:t,end:a}:h.end=t;break;case"NW-SE":"top"===i?h={start:t,end:s}:h.end=t;break;case"SE-NW":"top"===i?h={start:t,end:o}:h.end=t;break;case"SW-NE":"top"===i?h={start:t,end:l}:h.end=t}break;case"SW-NE":switch(r){case"NW-SE":h="bottom"===i?{start:this.hot._createCellCoords(t.row,o.col),end:this.hot._createCellCoords(a.row,t.col)}:{start:this.hot._createCellCoords(o.row,t.col),end:this.hot._createCellCoords(t.row,s.col)};break;case"SW-NE":h="top"===i?{start:this.hot._createCellCoords(e.highlight.row,t.col),end:this.hot._createCellCoords(t.row,s.col)}:{start:this.hot._createCellCoords(t.row,o.col),end:this.hot._createCellCoords(o.row,t.col)};break;case"SE-NW":"bottom"===i?h={start:this.hot._createCellCoords(t.row,l.col),end:this.hot._createCellCoords(o.row,t.col)}:"top"===i&&(h={start:a,end:t})}break;case"SE-NW":switch(r){case"NW-SE":case"NE-SW":case"SW-NE":"top"===i&&(h.end=t);break;case"SE-NW":"top"===i?h.end=t:h={start:t,end:o}}}return h}isDragged(){return this.dragged.length>0}}function xY(){let{label:e="",colspan:t=1,origColspan:n=1,collapsible:r=!1,crossHiddenColumns:i=[],isCollapsed:o=!1,isHidden:s=!1,isRoot:a=!1,isPlaceholder:l=!1,headerClassNames:h=[]}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{label:e,colspan:t,origColspan:n,collapsible:r,isCollapsed:o,crossHiddenColumns:i,isHidden:s,isRoot:a,isPlaceholder:l,headerClassNames:h}}function PY(e,t,n){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,n)}function _Y(e,t){return e.get(HY(e,t))}function LY(e,t,n){return e.set(HY(e,t),n),n}function HY(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}const kY=["label","collapsible"];var FY=new WeakMap,DY=new WeakMap,VY=new WeakMap;class UY{constructor(){PY(this,FY,[]),PY(this,DY,0),PY(this,VY,1/0)}setColumnsLimit(e){LY(VY,this,e)}setData(){LY(FY,this,function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0;const n=[];if(0===t)return n;Vd(e,(e=>{const r=[];let i=0;n.push(r),Vd(e,(e=>{const n=xY();if(em(e)){const{label:t,colspan:r,headerClassName:i}=e;n.label=jd(t),"number"==typeof r&&r>1&&(n.colspan=r,n.origColspan=r),"string"==typeof i&&(n.headerClassNames=[...i.split(" ")])}else n.label=jd(e);i+=n.origColspan;let o=!1;if(i>=t&&(n.colspan=n.origColspan-(i-t),n.origColspan=n.colspan,o=!0),r.push(n),n.colspan>1)for(let t=0;t<n.colspan-1;t++)r.push({label:"",isPlaceholder:!0});return!o}))}));const r=Math.max(...Dd(n,(e=>e.length)));return Vd(n,(e=>{if(e.length<r){const t=Dd(new Array(r-e.length),(()=>xY()));e.splice(e.length,0,...t)}})),n}(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],_Y(VY,this))),LY(DY,this,_Y(FY,this).length)}getData(){return _Y(FY,this)}mergeWith(e){Vd(e,(e=>{let{row:t,col:n,...r}=e;const i=this.getHeaderSettings(t,n);null!==i&&Kg(i,r,kY)}))}map(e){Vd(_Y(FY,this),(t=>{Vd(t,(t=>{const n=e({...t});em(n)&&Kg(t,n,kY)}))}))}getHeaderSettings(e,t){var n;if(e>=_Y(DY,this)||e<0)return null;const r=_Y(FY,this)[e];return!1===Array.isArray(r)||t>=r.length?null:null!==(n=r[t])&&void 0!==n?n:null}getHeadersSettings(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;const r=[];if(e>=_Y(DY,this)||e<0)return r;const i=_Y(FY,this)[e];let o=0;for(let s=t;s<i.length;s++){const e=i[s];if(e.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(o+=e.colspan,r.push(e),e.colspan>1&&(s+=e.colspan-1),o===n)break;if(o>n)throw new Error("The last column settings cannot overlap the other header layers")}return r}getLayersCount(){return _Y(DY,this)}getColumnsCount(){return _Y(DY,this)>0?_Y(FY,this)[0].length:0}clear(){LY(FY,this,[]),LY(DY,this,0)}}function BY(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const WY="DF-pre-order";const jY=new Map([[WY,function e(t,n){let r=t.call(n,this);for(let i=0;i<this.childs.length;i++){if(!1===r)return!1;r=e.call(this.childs[i],t,n)}return r}],["DF-post-order",function e(t,n){for(let r=0;r<this.childs.length;r++){if(!1===e.call(this.childs[r],t,n))return!1}return t.call(n,this)}],["BF",function(e,t){const n=[this];!function r(){if(0===n.length)return;const i=n.shift();n.push(...i.childs),!1!==e.call(t,i)&&r()}()}]]);class GY{constructor(e){BY(this,"data",{}),BY(this,"parent",null),BY(this,"childs",[]),this.data=e}addChild(e){e.parent=this,this.childs.push(e)}cloneTree(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this;const t=new GY({...e.data});for(let n=0;n<e.childs.length;n++)t.addChild(this.cloneTree(e.childs[n]));return t}replaceTreeWith(e){this.data={...e.data},this.childs=[];for(let t=0;t<e.childs.length;t++)this.addChild(e.childs[t])}walkDown(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"BF";if(!jY.has(t))throw new Error(`Traversal strategy "${t}" does not exist`);jY.get(t).call(this,e,this)}walkUp(e){const t=this,n=r=>{!1!==e.call(t,r)&&null!==r.parent&&n(r.parent)};n(this)}}function zY(e,t,n){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,n)}function $Y(e,t){return e.get(YY(e,t))}function YY(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var KY=new WeakMap,XY=new WeakMap,qY=new WeakMap;class QY{constructor(e){var t,n,r;zY(this,KY,new Map),zY(this,XY,new Map),zY(this,qY,null),n=this,r=e,(t=qY).set(YY(t,n),r)}getRoots(){return Array.from($Y(KY,this).values())}getRootByColumn(e){let t;return $Y(XY,this).has(e)&&(t=$Y(KY,this).get($Y(XY,this).get(e))),t}getNode(e,t){const n=this.getRootByColumn(t);if(!n)return;const r=t-$Y(XY,this).get(t);let i,o=0;return n.walkDown((n=>{const{data:{origColspan:s,headerLevel:a}}=n;if(e===a){if(r>=o&&r<=o+s-1)return i=n,i.data.isRoot=t===i.data.columnIndex,!1;o+=s}})),i}rebuildTreeIndex(){let e=0;$Y(XY,this).clear(),Vd($Y(KY,this),(t=>{let[,{data:{colspan:n}}]=t;for(let r=e;r<e+n;r++)$Y(XY,this).set(r,e);e+=n}))}buildTree(){this.clear();const e=$Y(qY,this).getColumnsCount();let t=0;for(;t<e;){const e=$Y(qY,this).getHeaderSettings(0,t),n=new GY;$Y(KY,this).set(t,n),this.buildLeaves(n,t,0,e.origColspan),t+=e.origColspan}this.rebuildTreeIndex()}buildLeaves(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;const i=$Y(qY,this).getHeadersSettings(n,t,r);n+=1,Vd(i,(r=>{const i={...r,headerLevel:n-1,columnIndex:t};let o;1===n?(e.data=i,o=e):(o=new GY(i),e.addChild(o)),n<$Y(qY,this).getLayersCount()&&this.buildLeaves(o,t,n,r.origColspan),t+=r.origColspan}))}clear(){$Y(KY,this).clear(),$Y(XY,this).clear()}}function ZY(e,t){e.walkDown((e=>{let{data:n,childs:r}=e;if(!n.isHidden&&(t(n.columnIndex),0===r.length))for(let i=1;i<n.colspan;i++)t(n.columnIndex+i)}))}function JY(e,t){let{childs:n}=e;if(0!==n.length)return n[0].data[t]}function eK(e){return JY(e,"origColspan")===e.data.origColspan}function tK(e){const{data:t,childs:n}=e;if(!t.isCollapsed||t.isHidden||t.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(eK(e))return tK(n[0]);t.isCollapsed=!1;const r=n.slice(1),i=new Set;let o=0;if(r.length>0)Vd(r,(e=>{e.replaceTreeWith(e.data.clonedTree),e.data.clonedTree=null;const t=e.data;o+=t.colspan,ZY(e,(e=>{i.add(e)}))}));else{const{colspan:e,origColspan:n,columnIndex:r}=t;o=n-e;for(let t=1;t<n;t++)i.add(r+t)}return e.walkUp((e=>{const{data:t}=e;t.colspan+=o,t.colspan>=t.origColspan?(t.colspan=t.origColspan,t.isCollapsed=!1):eK(e)&&(t.isCollapsed=JY(e,"isCollapsed"))})),{rollbackModification:()=>nK(e),affectedColumns:Array.from(i),colspanCompensation:o}}function nK(e){var t;const{data:n,childs:r}=e;if(n.isCollapsed||n.isHidden||n.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(eK(e))return nK(r[0]);n.isCollapsed=!0;const i=r.slice(1),o=new Set;if(i.length>0)Vd(i,(e=>{ZY(e,(e=>{o.add(e)})),e.data.clonedTree=e.cloneTree(),e.walkDown((e=>{let{data:t}=e;t.isHidden=!0}))}));else{const{origColspan:e,columnIndex:t}=n;for(let n=1;n<e;n++){const e=t+n;o.add(e)}}const s=n.colspan-(null!==(t=JY(e,"colspan"))&&void 0!==t?t:1);return e.walkUp((e=>{const{data:t}=e;t.colspan-=s,t.colspan<=1?(t.colspan=1,t.isCollapsed=!0):eK(e)&&(t.isCollapsed=JY(e,"isCollapsed"))})),{rollbackModification:()=>tK(e),affectedColumns:Array.from(o),colspanCompensation:s}}const rK=new Map([["collapse",nK],["expand",tK],["hide-column",function(e,t){if(!Number.isInteger(t))throw new Error("The passed gridColumnIndex argument has invalid type.");if(e.childs.length>0)throw new Error(Wd`The passed node is not the last node on the tree. Only for\x20
the last node, the hide column modification can be applied.`);const{crossHiddenColumns:n}=e.data;if(n.includes(t))return;let r=!1;e.walkUp((e=>{const{data:{collapsible:t}}=e;if(t)return r=!0,!1})),r||e.walkUp((e=>{const{data:n}=e;n.crossHiddenColumns.push(t),n.colspan>1?n.colspan-=1:n.isHidden=!0}))}],["show-column",function(e,t){if(!Number.isInteger(t))throw new Error("The passed gridColumnIndex argument has invalid type.");if(e.childs.length>0)throw new Error(Wd`The passed node is not the last node on the tree. Only for\x20
the last node, the show column modification can be applied.`);const{crossHiddenColumns:n}=e.data;if(!n.includes(t))return;let r=!1;e.walkUp((e=>{const{data:{collapsible:t}}=e;if(t)return r=!0,!1})),r||e.walkUp((e=>{const{data:n}=e;n.crossHiddenColumns.splice(n.crossHiddenColumns.indexOf(t),1),!n.isHidden&&n.colspan<n.origColspan&&(n.colspan+=1),n.isHidden=!1}))}]]);function iK(e){const t=[];return Vd(e,(e=>{e.walkDown((e=>{const n=e.data,{origColspan:r,columnIndex:i,headerLevel:o,crossHiddenColumns:s}=n,a=function(e,t){let n;Array.isArray(e[t])?n=e[t]:(n=[],e[t]=n);return n}(t,o);let l=!1;for(let t=i;t<i+r;t++){if(s.includes(t)||l)a.push({label:"",isPlaceholder:!0});else{const e=oK(n);e.isRoot=!0,a.push(e),l=!0}}}))})),t}function oK(e){const{crossHiddenColumns:t,...n}=xY(e);return n}function sK(e,t,n){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,n)}function aK(e,t,n){return e.set(hK(e,t),n),n}function lK(e,t){return e.get(hK(e,t))}function hK(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var uK=new WeakMap,cK=new WeakMap,dK=new WeakMap;class pK{constructor(){sK(this,uK,new UY),sK(this,cK,new QY(lK(uK,this))),sK(this,dK,[[]])}setState(e){lK(uK,this).setData(e);let t=!1;try{lK(cK,this).buildTree()}catch(n){lK(cK,this).clear(),lK(uK,this).clear(),t=!0}return aK(dK,this,iK(lK(cK,this).getRoots())),t}setColumnsLimit(e){lK(uK,this).setColumnsLimit(e)}mergeStateWith(e){const t=Dd(e,(e=>{let{row:t,...n}=e;return{row:t<0?this.rowCoordsToLevel(t):t,...n}}));lK(uK,this).mergeWith(t),lK(cK,this).buildTree(),aK(dK,this,iK(lK(cK,this).getRoots()))}mapState(e){lK(uK,this).map(e),lK(cK,this).buildTree(),aK(dK,this,iK(lK(cK,this).getRoots()))}mapNodes(e){return kd(lK(cK,this).getRoots(),((t,n)=>(n.walkDown((n=>{const r=e(n.data);void 0!==r&&t.push(r)})),t)),[])}triggerNodeModification(e,t,n){t<0&&(t=this.rowCoordsToLevel(t));const r=lK(cK,this).getNode(t,n);let i;return r&&(i=function(e,t,n){if(!rK.has(e))throw new Error(`The node modifier action ("${e}") does not exist.`);return rK.get(e)(t,n)}(e,r,n),aK(dK,this,iK(lK(cK,this).getRoots()))),i}triggerColumnModification(e,t){return this.triggerNodeModification(e,-1,t)}rowCoordsToLevel(e){if(e>=0)return null;const t=e+Math.max(this.getLayersCount(),1);return t<0?null:t}levelToRowCoords(e){if(e<0)return null;const t=e-Math.max(this.getLayersCount(),1);return t>=0?null:t}getHeaderSettings(e,t){var n,r;return e<0&&(e=this.rowCoordsToLevel(e)),null===e||e>=this.getLayersCount()?null:null!==(n=null===(r=lK(dK,this)[e])||void 0===r?void 0:r[t])&&void 0!==n?n:null}getHeaderTreeNodeData(e,t){const n=this.getHeaderTreeNode(e,t);return n?{...n.data}:null}getHeaderTreeNode(e,t){if(e<0&&(e=this.rowCoordsToLevel(e)),null===e||e>=this.getLayersCount())return null;const n=lK(cK,this).getNode(e,t);return n||null}findTopMostEntireHeaderLevel(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;const n=t-e+1;let r=!1,i=null;for(let o=e;o<=t;o++){const s=lK(cK,this).getRootByColumn(o);if(!s)break;r=!0,s.walkDown((r=>{const{columnIndex:o,headerLevel:s,origColspan:a,isHidden:l}=r.data;l||a<=n&&o>=e&&o+a-1<=t&&(null===i||s<i)&&(i=s)}),WY)}return r&&null===i?-1:this.levelToRowCoords(null!=i?i:0)}findLeftMostColumnIndex(e,t){var n;const{isRoot:r}=null!==(n=this.getHeaderSettings(e,t))&&void 0!==n?n:{isRoot:!0};if(r)return t;let i=t-1;for(;i>=0;){var o;const{isRoot:t}=null!==(o=this.getHeaderSettings(e,i))&&void 0!==o?o:{isRoot:!0};if(t)break;i-=1}return i}findRightMostColumnIndex(e,t){var n;const{isRoot:r,origColspan:i}=null!==(n=this.getHeaderSettings(e,t))&&void 0!==n?n:{isRoot:!0,origColspan:1};if(r)return t+i-1;let o=t+1;for(;o<this.getColumnsCount();){var s;const{isRoot:t}=null!==(s=this.getHeaderSettings(e,o))&&void 0!==s?s:{isRoot:!0};if(t)break;o+=1}return o-1}getLayersCount(){return lK(uK,this).getLayersCount()}getColumnsCount(){return lK(uK,this).getColumnsCount()}clear(){aK(dK,this,[]),lK(uK,this).clear(),lK(cK,this).clear()}}function gK(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const mK=class{constructor(e,t){gK(this,"hot",void 0),gK(this,"nestedHeaderSettingsGetter",void 0),gK(this,"layersCount",0),gK(this,"container",void 0),gK(this,"widthsMap",void 0),this.hot=e,this.nestedHeaderSettingsGetter=t,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}setLayersCount(e){return this.layersCount=e,this}getWidth(e){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e))}buildWidthsMap(){const e=this.hot.getCurrentThemeName();this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),e&&this.container.classList.add(e),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);const t=this.container.querySelectorAll("tr:last-of-type th"),n=t.length;this.widthsMap.clear();for(let r=0;r<n;r++){const e=this.hot.columnIndexMapper.getVisualFromRenderableIndex(r),n=this.hot.toPhysicalColumn(e);this.widthsMap.setValueAtIndex(n,t[r].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}_buildGhostTable(e){const{rootDocument:t,columnIndexMapper:n}=this.hot,r=t.createDocumentFragment(),i=t.createElement("table"),o=!!this.hot.getSettings().dropdownMenu,s=n.getRenderableIndexesLength();for(let a=0;a<this.layersCount;a++){const e=t.createElement("tr");for(let r=0;r<s;r++){let i=n.getVisualFromRenderableIndex(r);null===i&&(i=r);const s=t.createElement("th"),l=this.nestedHeaderSettingsGetter(a,i);if(l&&(!l.isPlaceholder||l.isHidden)){let t=l.label;o&&(t+='<button class="changeType"></button>'),Fp(s,t),s.colSpan=l.colspan,e.appendChild(s)}}i.appendChild(e)}r.appendChild(i),e.appendChild(r)}clear(){this.widthsMap.clear(),this.container=null}};function fK(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function wK(e,t,n){yK(e,t),t.set(e,n)}function yK(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function vK(e,t,n){return e.set(SK(e,t),n),n}function CK(e,t){return e.get(SK(e,t))}function SK(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}const RK="nestedHeaders";var EK=new WeakMap,bK=new WeakMap,TK=new WeakMap,NK=new WeakMap,AK=new WeakMap,MK=new WeakSet;class IK extends Tx{constructor(){var e,t;super(...arguments),yK(e=this,t=MK),t.add(e),wK(this,EK,new pK),wK(this,bK,null),wK(this,TK,null),wK(this,NK,!1),wK(this,AK,null),fK(this,"ghostTable",new mK(this.hot,((e,t)=>this.getHeaderSettings(e,t)))),fK(this,"detectedOverlappedHeaders",!1)}static get PLUGIN_KEY(){return RK}static get PLUGIN_PRIORITY(){return 280}isEnabled(){return!!this.hot.getSettings()[RK]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:t}=this.hot.getSettings();Array.isArray(t)&&Array.isArray(t[0])||Om(Wd`Your Nested Headers plugin configuration is invalid. The settings has to be\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`),this.addHook("init",(()=>SK(MK,this,$K).call(this))),this.addHook("afterLoadData",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return SK(MK,e,YK).call(e,...n)})),this.addHook("beforeOnCellMouseDown",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return SK(MK,e,LK).call(e,...n)})),this.addHook("afterOnCellMouseDown",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return SK(MK,e,HK).call(e,...n)})),this.addHook("beforeOnCellMouseOver",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return SK(MK,e,kK).call(e,...n)})),this.addHook("beforeOnCellMouseUp",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return SK(MK,e,FK).call(e,...n)})),this.addHook("beforeSelectionHighlightSet",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return SK(MK,e,DK).call(e,...n)})),this.addHook("modifyTransformStart",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return SK(MK,e,VK).call(e,...n)})),this.addHook("afterSelection",(()=>SK(MK,this,OK).call(this))),this.addHook("afterSelectionFocusSet",(()=>SK(MK,this,OK).call(this))),this.addHook("beforeViewportScrollHorizontally",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return SK(MK,e,xK).call(e,...n)})),this.addHook("afterGetColumnHeaderRenderers",(e=>SK(MK,this,BK).call(this,e))),this.addHook("modifyColWidth",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return SK(MK,e,jK).call(e,...n)})),this.addHook("modifyColumnHeaderValue",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return SK(MK,e,GK).call(e,...n)})),this.addHook("beforeHighlightingColumnHeader",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return SK(MK,e,PK).call(e,...n)})),this.addHook("beforeCopy",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return SK(MK,e,_K).call(e,...n)})),this.addHook("beforeSelectColumns",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return SK(MK,e,UK).call(e,...n)})),this.addHook("afterViewportColumnCalculatorOverride",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return SK(MK,e,WK).call(e,...n)})),this.addHook("modifyFocusedElement",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return SK(MK,e,zK).call(e,...n)})),this.hot.columnIndexMapper.addLocalHook("cacheUpdated",(()=>SK(MK,this,OK).call(this))),this.hot.rowIndexMapper.addLocalHook("cacheUpdated",(()=>SK(MK,this,OK).call(this))),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(!this.hot.view)return;const{nestedHeaders:e}=this.hot.getSettings();CK(EK,this).setColumnsLimit(this.hot.countCols()),Array.isArray(e)&&(this.detectedOverlappedHeaders=CK(EK,this).setState(e)),this.detectedOverlappedHeaders&&Om(Wd`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\x20
                        is currently not supported.`),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach(((e,t)=>{const n=!0===e?"hide-column":"show-column";CK(EK,this).triggerColumnModification(n,t)})),!CK(bK,this)&&this.enabled&&vK(bK,this,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe((e=>{e.forEach((e=>{let{op:t,index:n,newValue:r}=e;if("replace"===t){const e=!0===r?"hide-column":"show-column";CK(EK,this).triggerColumnModification(e,n)}})),this.ghostTable.buildWidthsMap()}))),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),super.updatePlugin()}disablePlugin(){this.clearColspans(),CK(EK,this).clear(),CK(bK,this).unsubscribe(),vK(bK,this,null),this.ghostTable.clear(),super.disablePlugin()}getStateManager(){return CK(EK,this)}getLayersCount(){return CK(EK,this).getLayersCount()}getHeaderSettings(e,t){return CK(EK,this).getHeaderSettings(e,t)}clearColspans(){if(!this.hot.view)return;const{_wt:e}=this.hot.view,t=e.getSetting("columnHeaders").length,n=e.wtTable.THEAD,r=e.wtOverlays.topOverlay.clone.wtTable.THEAD,i=e.wtOverlays.topInlineStartCornerOverlay?e.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null;for(let o=0;o<t;o++){const e=n.childNodes[o];if(!e)break;const t=r.childNodes[o],s=i?i.childNodes[o]:null;for(let n=0,r=e.childNodes.length;n<r;n++)e.childNodes[n].removeAttribute("colspan"),xp(e.childNodes[n],"hiddenHeader"),t&&t.childNodes[n]&&(t.childNodes[n].removeAttribute("colspan"),xp(t.childNodes[n],"hiddenHeader")),i&&s&&s.childNodes[n]&&(s.childNodes[n].removeAttribute("colspan"),xp(s.childNodes[n],"hiddenHeader"))}}headerRendererFactory(e){var t=this;const n=this.hot.view._wt.getSetting("fixedColumnsStart");return(r,i)=>{var o;const{columnIndexMapper:s,view:a}=this.hot;let l=s.getVisualFromRenderableIndex(r);null===l&&(l=r),i.removeAttribute("colspan"),xp(i,"hiddenHeader"),xp(i,"hiddenHeaderText");const{colspan:h,isHidden:u,isPlaceholder:c,headerClassNames:d}=null!==(o=CK(EK,this).getHeaderSettings(e,l))&&void 0!==o?o:{label:""};if(c||u)Op(i,"hiddenHeader");else if(h>1){var p,g,m;const{wtOverlays:e}=a._wt,t=null===(p=e.topInlineStartCornerOverlay)||void 0===p?void 0:p.clone.wtTable.THEAD.contains(i),o=null===(g=e.inlineStartOverlay)||void 0===g?void 0:g.clone.wtTable.THEAD.contains(i);(null===(m=e.topOverlay)||void 0===m?void 0:m.clone.wtTable.THEAD.contains(i))&&l<n&&Op(i,"hiddenHeaderText");const s=t||o?Math.min(h,n-r):h;s>1&&i.setAttribute("colspan",s)}if(this.hot.view.appendColHeader(l,i,(function(){return t.getColumnHeaderValue(...arguments)}),e),!c&&!u){const e=i.querySelector("div.relative");e&&d&&d.length>0&&(xp(e,this.hot.getColumnMeta(l).headerClassName),Op(e,d))}}}getColumnHeaderValue(e,t){var n;const{isHidden:r,isPlaceholder:i}=null!==(n=CK(EK,this).getHeaderSettings(t,e))&&void 0!==n?n:{};return i||r?"":this.hot.getColHeader(e,t)}destroy(){vK(EK,this,null),null!==CK(bK,this)&&(CK(bK,this).unsubscribe(),vK(bK,this,null)),super.destroy()}_getHeaderTreeNodeDataByCoords(e){if(!(e.row>=0||e.col<0))return CK(EK,this).getHeaderTreeNodeData(e.row,e.col)}}function OK(){var e;const t=null===(e=this.hot)||void 0===e?void 0:e.getSelectedRangeLast();if(!t)return;const{highlight:n}=t;if(n.isHeader()&&n.col>=0){const e=CK(EK,this).findLeftMostColumnIndex(n.row,n.col),t=this.hot.selection.highlight.getFocus();t.visualCellRange.highlight.col=e,t.visualCellRange.from.col=e,t.visualCellRange.to.col=e,t.commit()}}function xK(e,t){var n;const r=this.hot.getSelectedRangeLast();if(!r)return e;const{highlight:i}=r,{navigableHeaders:o}=this.hot.getSettings(),s=this.hot.selection.isSelectedByColumnHeader(),a=o?i.row:null===(n=CK(AK,this))||void 0===n?void 0:n.row,l=s?e:i.col,h=a<0&&l>=0;if(vK(AK,this,null),!h)return e;const u=this.hot.getFirstFullyVisibleColumn(),c=this.hot.getLastFullyVisibleColumn(),d=c-u+1,p=CK(EK,this).findLeftMostColumnIndex(a,l),g=CK(EK,this).findRightMostColumnIndex(a,l),m=g-p+1;if(p<u&&g>c)return p;if(s){let e=null;return p>=u&&g>c?m>d?(t.value="start",e=p):(t.value="end",e=g):p<u&&g<=c&&(m>d?(t.value="end",e=g):(t.value="start",e=p)),e}return p<=u?p:g}function PK(e,t,n){const r=CK(EK,this).getHeaderTreeNodeData(t,e);if(!r)return e;const{columnCursor:i,selectionType:o,selectionWidth:s}=n,{isRoot:a,colspan:l}=CK(EK,this).getHeaderSettings(t,e);if(o===mS){if(!a)return r.columnIndex}else if(o===gS&&(l>s-i||!a))return null;return e}function _K(e,t,n){let{columnHeadersCount:r}=n;if(0!==r)for(let o=0;o<t.length;o++){const{startRow:n,startCol:r,endRow:s,endCol:a}=t[o],l=s-n+1;if(n>=0||1===r-a+1)break;for(let t=r;t<=a;t++)for(let o=n;o<=s;o++){var i;const n=l+o,s=t-r;if(0===s)continue;!1===(null===(i=CK(EK,this).getHeaderTreeNodeData(o,t))||void 0===i?void 0:i.isRoot)&&(e[n][s]="")}}}function LK(e,t,n,r){this._getHeaderTreeNodeDataByCoords(t)&&(r.column=!0)}function HK(e,t){const n=this._getHeaderTreeNodeDataByCoords(t);if(!n)return;vK(TK,this,t.clone()),vK(NK,this,!0);const{selection:r}=this.hot,i=r.isSelected()?r.getSelectedRange().current():null,o=[],{columnIndex:s,origColspan:a}=n,l=!r.inInSelection(t);e.shiftKey&&i?t.col<i.from.col?o.push(i.getTopEndCorner().col,s,t.row):t.col>i.from.col?o.push(i.getTopStartCorner().col,s+a-1,t.row):o.push(s,s+a-1,t.row):(Im(e)||Mm(e)&&l||function(e){return e instanceof TouchEvent}(e))&&o.push(s,s+a-1,t.row),r.selectColumns(...o)}function kK(e,t,n,r){if(!this.hot.view.isMouseDown()||r.column)return;const i=this._getHeaderTreeNodeDataByCoords(t);if(!i)return;const{columnIndex:o,origColspan:s}=i,a=this.hot.getSelectedRangeLast(),l=a.getTopStartCorner(),h=a.getBottomEndCorner(),{from:u}=a;r.column=!0,r.cell=!0;const c=[],d=Xw(t.row,-1/0,-1);t.col<u.col?c.push(h.col,o,d):t.col>u.col?c.push(l.col,o+s-1,d):c.push(o,o+s-1,d),this.hot.selection.selectColumns(...c)}function FK(){vK(NK,this,!1)}function DK(){const{navigableHeaders:e}=this.hot.getSettings();if(!this.hot.view.isMouseDown()||!CK(NK,this)||!e)return;const t=this.hot.getSelectedRangeLast(),n=t.getTopStartCorner().col,r=t.getBottomEndCorner().col,{columnIndex:i,origColspan:o}=CK(EK,this).getHeaderTreeNodeData(CK(TK,this).row,CK(TK,this).col);if(t.setHighlight(CK(TK,this)),o>t.getWidth()||i<n||i+o-1>r){const e=CK(EK,this).findTopMostEntireHeaderLevel(Xw(n,i,i+o-1),Xw(r,i,i+o-1));t.highlight.row=e,t.highlight.col=t.from.col}}function VK(e){const{highlight:t}=this.hot.getSelectedRangeLast(),n=this.hot._createCellCoords(t.row+e.row,t.col+e.col);if(!(n.isHeader()&&n.col>=0))return;const r=CK(EK,this).findLeftMostColumnIndex(n.row,n.col),i=CK(EK,this).findRightMostColumnIndex(n.row,n.col);if(e.col<0){const n=t.col>=r&&t.col<=i?r-1:i,o=this.hot.columnIndexMapper.getNearestNotHiddenIndex(n,-1);e.col=null===o?-this.hot.view.countRenderableColumnsInRange(0,t.col):-Math.max(this.hot.view.countRenderableColumnsInRange(o,t.col)-1,1)}else if(e.col>0){const n=t.col>=r&&t.col<=i?i+1:r,o=this.hot.columnIndexMapper.getNearestNotHiddenIndex(n,1);e.col=null===o?this.hot.view.countRenderableColumnsInRange(t.col,this.hot.countCols()):Math.max(this.hot.view.countRenderableColumnsInRange(t.col,o)-1,1)}}function UK(e,t,n){const r=e.row,i=this._getHeaderTreeNodeDataByCoords({row:r,col:e.col}),o=this._getHeaderTreeNodeDataByCoords({row:r,col:t.col});vK(AK,this,n.clone()),t.col<e.col?(i&&(e.col=i.columnIndex+i.origColspan-1),o&&(t.col=o.columnIndex)):t.col>=e.col&&(i&&(e.col=i.columnIndex),o&&(t.col=o.columnIndex+o.origColspan-1))}function BK(e){if(CK(EK,this).getLayersCount()>0){e.length=0;for(let t=0;t<CK(EK,this).getLayersCount();t++)e.push(this.headerRendererFactory(t))}}function WK(e){const t=CK(EK,this).getLayersCount();let n=e.startColumn,r=!!t;for(let i=0;i<t;i++){const t=CK(EK,this).findLeftMostColumnIndex(i,e.startColumn),o=this.hot.columnIndexMapper.getRenderableFromVisualIndex(t);if(t>=0&&(r=!1),zw(o)&&o<e.startColumn){n=o;break}}e.startColumn=r?CK(EK,this).getHeaderTreeNodeData(0,n).columnIndex:n}function jK(e,t){const n=this.ghostTable.getWidth(t);return e>n?e:n}function GK(e,t,n){var r;const{label:i}=null!==(r=CK(EK,this).getHeaderTreeNodeData(n,t))&&void 0!==r?r:{label:""};return i}function zK(e,t){if(e<0)return this.hot.getCell(e,CK(EK,this).findLeftMostColumnIndex(e,t),!0)}function $K(){this.updatePlugin()}function YK(e,t){t||this.updatePlugin()}function KK(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const XK=class{constructor(e,t){KK(this,"hot",void 0),KK(this,"data",null),KK(this,"plugin",void 0),KK(this,"parentReference",new WeakMap),KK(this,"cache",{levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}),this.hot=t,this.plugin=e}setData(e){this.data=e}getData(){return this.data}getRawSourceData(){let e=null;return this.plugin.disableCoreAPIModifiers(),e=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),e}updateWithData(e){this.setData(e),this.rewriteCache()}rewriteCache(){this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},$w(0,this.data.length-1,(e=>{this.cacheNode(this.data[e],0,null)}))}cacheNode(e,t,n){this.cache.levels[t]||(this.cache.levels[t]=[],this.cache.levelCount+=1),this.cache.levels[t].push(e),this.cache.rows.push(e),this.cache.nodeInfo.set(e,{parent:n,row:this.cache.rows.length-1,level:t}),this.hasChildren(e)&&Vd(e.__children,(n=>{this.cacheNode(n,t+1,e)}))}getDataObject(e){return null==e?null:this.cache.rows[e]}readTreeNodes(e,t,n,r){let i=!1,o=t;if(isNaN(o)&&o.end)return o;let s=e;return s||(s={__children:this.data},i=!0,o-=1),null!=n&&o===n?{result:s,end:!0}:null!=r&&s===r?{result:o,end:!0}:(o+=1,s.__children&&Vd(s.__children,(e=>{if(this.parentReference.set(e,i?null:s),o=this.readTreeNodes(e,o,n,r),isNaN(o)&&o.end)return!1})),o)}mockParent(){const e=this.mockNode();return e.__children=this.data,e}mockNode(){const e={};return nm(this.data[0],((t,n)=>{e[n]=null})),e}getRowIndex(e){return null==e?null:this.cache.nodeInfo.get(e).row}getRowIndexWithinParent(e){let t=null;t=isNaN(e)?e:this.getDataObject(e);const n=this.getRowParent(e);return null==n?this.data.indexOf(t):n.__children.indexOf(t)}countAllRows(){const e={__children:this.data};return this.countChildren(e)}countChildren(e){let t=0,n=e;return isNaN(n)||(n=this.getDataObject(n)),n&&n.__children?(Vd(n.__children,(e=>{t+=1,e.__children&&(t+=this.countChildren(e))})),t):0}getRowParent(e){let t;return t=isNaN(e)?e:this.getDataObject(e),this.getRowObjectParent(t)}getRowObjectParent(e){return e&&"object"==typeof e?this.cache.nodeInfo.get(e).parent:null}getRowLevel(e){let t=null;return t=isNaN(e)?e:this.getDataObject(e),t?this.getRowObjectLevel(t):null}getRowObjectLevel(e){return null==e?null:this.cache.nodeInfo.get(e).level}hasChildren(e){let t=e;return isNaN(t)||(t=this.getDataObject(t)),!(!t.__children||!t.__children.length)}isChild(e){return null!==this.getRowParent(e)}getChild(e,t){var n;return(null===(n=e.__children)||void 0===n?void 0:n[t])||null}isRowHighestLevel(e){return!this.isChild(e)}isParent(e){var t;let n=e;return isNaN(n)||(n=this.getDataObject(n)),n&&!!n.__children&&0!==(null===(t=n.__children)||void 0===t?void 0:t.length)}addChild(e,t){let n=t;this.hot.runHooks("beforeAddChild",e,n);let r=null;e&&(r=this.getRowIndex(e)),this.hot.runHooks("beforeCreateRow",r+this.countChildren(e)+1,1);let i=e;e||(i=this.mockParent()),i.__children||(i.__children=[]),n||(n=this.mockNode()),i.__children.push(n),this.rewriteCache();const o=this.getRowIndex(n);this.hot.rowIndexMapper.insertIndexes(o,1),this.hot.runHooks("afterCreateRow",o,1),this.hot.runHooks("afterAddChild",e,n)}addChildAtIndex(e,t,n){let r,i=n;if(i||(i=this.mockNode()),this.hot.runHooks("beforeAddChild",e,i,t),e){const n=this.getRowIndex(e)+t+1;this.hot.runHooks("beforeCreateRow",n,1),e.__children.splice(t,null,i),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(e),"__children",e.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(n,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",n,1),r=n}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",t,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),r=this.getRowIndex(this.data[t]);i=this.getDataObject(r),this.hot.runHooks("afterAddChild",e,i,t)}addSibling(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"below";const n=this.translateTrimmedRow(e),r=this.getRowParent(n),i=this.getRowIndexWithinParent(n);switch(t){case"below":this.addChildAtIndex(r,i+1,null);break;case"above":this.addChildAtIndex(r,i,null)}}detachFromParent(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=null;const r=[];Array.isArray(e)?($w(e[0],e[2],(e=>{const t=this.translateTrimmedRow(e);r.push(this.getDataObject(t))})),$w(0,r.length-2,(e=>{this.detachFromParent(r[e],!1)})),n=r[r.length-1]):n=e;const i=this.getRowIndex(n),o=this.countChildren(n),s=this.getRowIndexWithinParent(n),a=this.getRowParent(n),l=this.getRowParent(a),h=this.getRowIndex(l);let u=null;if(this.hot.runHooks("beforeDetachChild",a,n),null!=s){const e=Array.from(new Array(i+o+1).keys()).splice(-1*(o+1));if(this.hot.runHooks("beforeRemoveRow",i,o+1,e,this.plugin.pluginName),a.__children.splice(s,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",i,o+1,e,this.plugin.pluginName),l){u=h+this.countChildren(l);const e=this.getChild(l,this.countChildren(l)-1),t=this.getRowIndex(e);this.hot.runHooks("beforeCreateRow",t+1,o+1,this.plugin.pluginName),l.__children.push(n)}else u=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",u-2,o+1,this.plugin.pluginName),this.data.push(n)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",u-2,o+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",a,n,this.getRowIndex(n)),t&&this.hot.render()}filterData(e,t,n){const r=[];Vd(n,(e=>{r.push(this.getDataObject(e))})),Vd(r,(e=>{const t=this.getRowIndexWithinParent(e),n=this.getRowParent(e);null===n?this.data.splice(t,1):n.__children.splice(t,1)})),this.rewriteCache()}spliceData(e,t,n){const r=this.getDataObject(e-1);let i=null,o=e;r&&r.__children&&0===r.__children.length?(i=r,o=0):e<this.countAllRows()&&(i=this.getRowParent(e),o=this.getRowIndexWithinParent(e)),i?n?i.__children.splice(o,t,...n):i.__children.splice(o,t):n?this.data.splice(o,t,...n):this.data.splice(o,t),this.rewriteCache()}syncRowWithRawSource(e){let t=e,n=null;do{n=this.getRowParent(n),null!==n&&(t=n)}while(null!==n);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndex(t),"__children",t.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}moveRow(e,t,n,r){const i=t===this.hot.countRows(),o=this.getRowParent(e),s=this.getRowIndexWithinParent(e),a=o.__children.slice(s,s+1),l=e>t;let h=i?this.getRowParent(t-1):this.getRowParent(t);null==h&&(h=this.getRowParent(t-1)),null==h&&(h=this.getDataObject(t-1)),h?h.__children||(h.__children=[]):(h=this.getDataObject(t),h.__children=[]);const u=i||n||r?h.__children.length:this.getRowIndexWithinParent(t),c=o===h;h.__children.splice(u,0,a[0]),o.__children.splice(s+(l&&c?1:0),1),this.syncRowWithRawSource(o),c||this.syncRowWithRawSource(h)}translateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(e):e}untranslateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(e):e}};function qK(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const QK=class{constructor(e,t){qK(this,"hot",void 0),qK(this,"plugin",void 0),this.hot=t,this.plugin=e}};class ZK extends QK{static get CSS_CLASSES(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}constructor(e,t){super(e,t),this.dataManager=this.plugin.dataManager,this.collapsingUI=this.plugin.collapsingUI,this.rowHeaderWidthCache=null}appendLevelIndicators(e,t){const n=this.hot.toPhysicalRow(e),r=this.dataManager.getRowLevel(n),i=this.dataManager.getDataObject(n),o=t.getElementsByTagName("DIV")[0],s=o.querySelector("span.rowHeader"),a=o.querySelectorAll('[class^="ht_nesting"]'),l=this.hot.getSettings().ariaTags;if(Vd(a,(e=>{e&&o.removeChild(e)})),Op(t,ZK.CSS_CLASSES.indicatorContainer),r){const{rootDocument:e}=this.hot,t=s.cloneNode(!0);o.innerHTML="",$w(0,r-1,(()=>{const t=e.createElement("SPAN");Op(t,ZK.CSS_CLASSES.emptyIndicator),o.appendChild(t)})),o.appendChild(t)}if(this.dataManager.hasChildren(i)){const e=this.hot.rootDocument.createElement("DIV");l&&Pp(e,[["aria-hidden","true"]]),Op(t,ZK.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(n)?(Op(e,`${ZK.CSS_CLASSES.button} ${ZK.CSS_CLASSES.expandButton}`),l&&Pp(t,[fp(!1)])):(Op(e,`${ZK.CSS_CLASSES.button} ${ZK.CSS_CLASSES.collapseButton}`),l&&Pp(t,[fp(!0)])),o.appendChild(e)}}updateRowHeaderWidth(e){let t=e;t||(t=this.dataManager.cache.levelCount);const n=this.hot.view.getStylesHandler();let r=11;if(!n.isClassicTheme()){r=2*n.getCSSVariableValue("cell-horizontal-padding")}this.rowHeaderWidthCache=Math.max(50,r+10*t+25),this.hot.render()}}const JK=ZK;const eX=class extends QK{constructor(e,t){var n;super(e,t),n=this,this.dataManager=this.plugin.dataManager,this.collapsedRows=[],this.collapsedRowsStash={stash:function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];n.lastCollapsedRows=n.collapsedRows.slice(0),n.expandMultipleChildren(n.lastCollapsedRows,e)},shiftStash:function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;null==t&&(t=1/0),Vd(n.lastCollapsedRows,((i,o)=>{i>=e&&i<t&&(n.lastCollapsedRows[o]=i+r)}))},applyStash:function(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];n.collapseMultipleChildren(n.lastCollapsedRows,e),n.lastCollapsedRows=void 0},trimStash:(e,t)=>{$w(e,e+t-1,(e=>{const t=this.lastCollapsedRows.indexOf(e);t>-1&&this.lastCollapsedRows.splice(t,1)}))}}}collapseChildren(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const r=[];let i=null,o=null,s=null;return isNaN(e)?(i=e,o=this.dataManager.getRowIndex(i)):(i=this.dataManager.getDataObject(e),o=e),this.dataManager.hasChildren(i)&&Vd(i.__children,(e=>{r.push(this.dataManager.getRowIndex(e))})),s=this.collapseRows(r,!0,!1),n&&this.trimRows(s),t&&this.renderAndAdjust(),-1===this.collapsedRows.indexOf(o)&&this.collapsedRows.push(o),s}collapseMultipleChildren(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const r=[];Vd(e,(e=>{r.push(...this.collapseChildren(e,!1,!1))})),n&&this.trimRows(r),t&&this.renderAndAdjust()}collapseRow(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.collapseRows([e],t)}collapseRows(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=[];return Vd(e,(e=>{r.push(e),t&&this.collapseChildRows(e,r)})),n&&this.trimRows(r),r}collapseChildRows(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(this.dataManager.hasChildren(e)){Vd(this.dataManager.getDataObject(e).__children,(e=>{const n=this.dataManager.getRowIndex(e);t.push(n),this.collapseChildRows(n,t)}))}n&&this.trimRows(t)}expandRow(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.expandRows([e],t)}expandRows(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=[];return Vd(e,(e=>{r.push(e),t&&this.expandChildRows(e,r)})),n&&this.untrimRows(r),r}expandChildRows(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(this.dataManager.hasChildren(e)){Vd(this.dataManager.getDataObject(e).__children,(e=>{if(!this.isAnyParentCollapsed(e)){const n=this.dataManager.getRowIndex(e);t.push(n),this.expandChildRows(n,t)}}))}n&&this.untrimRows(t)}expandChildren(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const r=[];let i=null,o=null,s=null;return isNaN(e)?(i=e,o=this.dataManager.getRowIndex(e)):(i=this.dataManager.getDataObject(e),o=e),this.collapsedRows.splice(this.collapsedRows.indexOf(o),1),this.dataManager.hasChildren(i)&&Vd(i.__children,(e=>{const t=this.dataManager.getRowIndex(e);r.push(t)})),s=this.expandRows(r,!0,!1),n&&this.untrimRows(s),t&&this.renderAndAdjust(),s}expandMultipleChildren(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const r=[];Vd(e,(e=>{r.push(...this.expandChildren(e,!1,!1))})),n&&this.untrimRows(r),t&&this.renderAndAdjust()}collapseAll(){const e=this.dataManager.getData(),t=[];Vd(e,(e=>{this.dataManager.hasChildren(e)&&t.push(e)})),this.collapseMultipleChildren(t),this.renderAndAdjust()}expandAll(){const e=this.dataManager.getData(),t=[];Vd(e,(e=>{this.dataManager.hasChildren(e)&&t.push(e)})),this.expandMultipleChildren(t),this.renderAndAdjust()}trimRows(e){this.hot.batchExecution((()=>{Vd(e,(e=>{this.plugin.collapsedRowsMap.setValueAtIndex(e,!0)}))}),!0)}untrimRows(e){this.hot.batchExecution((()=>{Vd(e,(e=>{this.plugin.collapsedRowsMap.setValueAtIndex(e,!1)}))}),!0)}areChildrenCollapsed(e){let t=isNaN(e)?e:this.dataManager.getDataObject(e),n=!0;return null===t&&(t={__children:this.dataManager.data}),this.dataManager.hasChildren(t)&&Vd(t.__children,(e=>{const t=this.dataManager.getRowIndex(e);if(!this.plugin.collapsedRowsMap.getValueAtIndex(t))return n=!1,!1})),n}isAnyParentCollapsed(e){let t=e;for(;null!==t;){t=this.dataManager.getRowParent(t);const e=this.dataManager.getRowIndex(t);if(this.collapsedRows.indexOf(e)>-1)return!0}return!1}toggleState(e,t){if(t.col>=0)return;const n=this.translateTrimmedRow(t.row);Ip(e.target,JK.CSS_CLASSES.button)&&(this.areChildrenCollapsed(n)?this.expandChildren(n):this.collapseChildren(n),Nm(e))}translateTrimmedRow(e){return this.hot.toPhysicalRow(e)}untranslateTrimmedRow(e){return this.hot.toVisualRow(e)}renderAndAdjust(){this.hot.render(),this.hot.view.adjustElementsSize()}};function tX(e,t,n){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,n)}function nX(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function rX(e,t){return e.get(function(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}(e,t))}var iX=new WeakMap;const oX=class extends QK{constructor(){super(...arguments),nX(this,"dataManager",this.plugin.dataManager),tX(this,iX,{row_above:(e,t)=>{const n=t[t.length-1];this.dataManager.addSibling(n.start.row,"above")},row_below:(e,t)=>{const n=t[t.length-1];this.dataManager.addSibling(n.start.row,"below")}})}appendOptions(e){const t=[{key:"add_child",name(){return this.getTranslatedPhrase(Qb)},callback:()=>{const e=this.dataManager.translateTrimmedRow(this.hot.getSelectedLast()[0]),t=this.dataManager.getDataObject(e);this.dataManager.addChild(t)},disabled:()=>{const e=this.hot.getSelectedLast();return!e||e[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{key:"detach_from_parent",name(){return this.getTranslatedPhrase(Zb)},callback:()=>{this.dataManager.detachFromParent(this.hot.getSelectedLast())},disabled:()=>{const e=this.hot.getSelectedLast(),t=this.dataManager.translateTrimmedRow(e[0]);return!this.dataManager.getRowParent(t)||!e||e[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{name:"---------"}];return $w(0,e.items.length-1,(n=>{if(0===n)return Vd(t,((t,r)=>{e.items.splice(n+r,0,t)})),!1})),this.modifyRowInsertingOptions(e)}modifyRowInsertingOptions(e){return $w(0,e.items.length-1,(t=>{const n=rX(iX,this)[e.items[t].key];null!=n&&(e.items[t].callback=n)})),e}};function sX(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class aX{constructor(e){sX(this,"plugin",void 0),sX(this,"hot",void 0),sX(this,"dataManager",void 0),sX(this,"collapsingUI",void 0),this.plugin=e,this.hot=e.hot,this.dataManager=e.dataManager,this.collapsingUI=e.collapsingUI}onBeforeRowMove(e,t,n,r){if(this.displayAPICompatibilityWarning({rows:e,finalIndex:t,dropIndex:n,movePossible:r}))return!1;this.movedToCollapsed=!1;const i=n===this.hot.countRows(),o=i?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(n);let s=!0;const a=e.map((e=>{if(!s)return!1;const t=this.dataManager.translateTrimmedRow(e);return s=this.shouldAllowMoving(t,o),t})),l=-1===a.indexOf(o);if(!s||!l)return!1;const h=this.getBaseParent(a),u=this.getTargetParent(i,o),c=h===u;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(u),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(a,o,c),this.moveRows(a,o,u),this.dataManager.rewriteCache(),this.moveCellsMeta(a,o),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",e,t,n,r,r&&this.isRowOrderChanged(e,t)),this.hot.render(),this.selectCells(e,n),!1}displayAPICompatibilityWarning(e){const{rows:t,finalIndex:n,dropIndex:r,movePossible:i}=e;let o=!1;return zd(r)&&(Om(Wd`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`),this.hot.runHooks("afterRowMove",t,n,r,i,!1),o=!0),o}shouldAllowMoving(e,t){return!(this.dataManager.isParent(e)||this.dataManager.isRowHighestLevel(e)||e===t||0===t)}getBaseParent(e){return this.dataManager.getRowParent(e[0])}getTargetParent(e,t){let n=this.dataManager.getRowParent(e?t-1:t);return null==n&&(n=this.dataManager.getRowParent(t-1)),n}shiftCollapsibleParentsLocations(e,t,n){n||(Math.max(...e)<=t?this.collapsingUI.collapsedRowsStash.shiftStash(e[0],t,-1*e.length):this.collapsingUI.collapsedRowsStash.shiftStash(t,e[0],e.length))}moveRows(e,t,n){const r=t===this.dataManager.getRowIndex(n)+this.dataManager.countChildren(n)+1;this.hot.batchRender((()=>{e.forEach((e=>{this.dataManager.moveRow(e,t,this.movedToCollapsed,r)}))}))}moveCellsMeta(e,t){const n=[],r=Math.max(...e)<t;e.forEach((e=>{n.push(this.hot.getCellMetaAtRow(e))})),this.hot.spliceCellsMeta(e[0],e.length),this.hot.spliceCellsMeta(t-(r?n.length:0),0,...n)}selectCells(e,t){const n=e.length;let r=0,i=0;if(this.movedToCollapsed){let o=null;o=e[n-1]<t?this.dataManager.translateTrimmedRow(t-n):this.dataManager.translateTrimmedRow(t);const s=this.dataManager.getRowParent(null===o?this.hot.countSourceRows()-1:o-1),a=this.dataManager.getRowIndex(s);r=this.dataManager.untranslateTrimmedRow(a),i=r}else e[n-1]<t?(i=t-1,r=i-n+1):(r=t,i=r+n-1);this.hot.selectCells([[r,0,i,this.hot.countCols()-1]],!1)}isRowOrderChanged(e,t){return e.some(((e,n)=>e-n!==t))}}function lX(e,t,n){hX(e,t),t.set(e,n)}function hX(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function uX(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function cX(e,t){return e.get(pX(e,t))}function dX(e,t,n){return e.set(pX(e,t),n),n}function pX(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}const gX="nestedRows",mX=gX;var fX=new WeakMap,wX=new WeakMap,yX=new WeakSet;class vX extends Tx{constructor(){var e,t;super(...arguments),hX(e=this,t=yX),t.add(e),uX(this,"dataManager",null),uX(this,"headersUI",null),uX(this,"collapsedRowsMap",null),lX(this,fX,!1),lX(this,wX,!1)}static get PLUGIN_KEY(){return gX}static get PLUGIN_PRIORITY(){return 300}isEnabled(){return!!this.hot.getSettings()[gX]}enablePlugin(){var e=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new kE),this.dataManager=new XK(this,this.hot),this.collapsingUI=new eX(this,this.hot),this.headersUI=new JK(this,this.hot),this.contextMenuUI=new oX(this,this.hot),this.rowMoveController=new aX(this),this.addHook("afterInit",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return pX(yX,e,_X).call(e,...n)})),this.addHook("beforeViewRender",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return pX(yX,e,LX).call(e,...n)})),this.addHook("modifyRowData",(function(){return e.onModifyRowData(...arguments)})),this.addHook("modifySourceLength",(function(){return e.onModifySourceLength(...arguments)})),this.addHook("beforeDataSplice",(function(){return e.onBeforeDataSplice(...arguments)})),this.addHook("filterData",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return pX(yX,e,RX).call(e,...n)})),this.addHook("afterContextMenuDefaultOptions",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return pX(yX,e,EX).call(e,...n)})),this.addHook("afterGetRowHeader",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return pX(yX,e,bX).call(e,...n)})),this.addHook("beforeOnCellMouseDown",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return pX(yX,e,SX).call(e,...n)})),this.addHook("beforeRemoveRow",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return pX(yX,e,AX).call(e,...n)})),this.addHook("afterRemoveRow",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return pX(yX,e,NX).call(e,...n)})),this.addHook("beforeAddChild",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return pX(yX,e,MX).call(e,...n)})),this.addHook("afterAddChild",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return pX(yX,e,IX).call(e,...n)})),this.addHook("beforeDetachChild",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return pX(yX,e,OX).call(e,...n)})),this.addHook("afterDetachChild",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return pX(yX,e,xX).call(e,...n)})),this.addHook("modifyRowHeaderWidth",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return pX(yX,e,TX).call(e,...n)})),this.addHook("afterCreateRow",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return pX(yX,e,PX).call(e,...n)})),this.addHook("beforeRowMove",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return pX(yX,e,CX).call(e,...n)})),this.addHook("beforeLoadData",(e=>pX(yX,this,HX).call(this,e))),this.addHook("beforeUpdateData",(e=>pX(yX,this,HX).call(this,e))),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),this.unregisterShortcuts(),super.disablePlugin()}updatePlugin(){this.disablePlugin();const e=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(e),super.updatePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast(),t=this.collapsingUI.translateTrimmedRow(e.row);return this.collapsingUI.areChildrenCollapsed(t)?this.collapsingUI.expandChildren(t):this.collapsingUI.collapseChildren(t),!1},runOnlyIf:()=>{var e,t;const n=null===(e=this.hot.getSelectedRangeLast())||void 0===e?void 0:e.highlight;return n&&(null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.isSingle())&&this.hot.selection.isCellVisible(n)&&-1===n.col&&n.row>=0},group:mX,relativeToGroup:DA,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(mX)}disableCoreAPIModifiers(){dX(wX,this,!0)}enableCoreAPIModifiers(){dX(wX,this,!1)}onModifyRowData(e){if(!cX(wX,this))return this.dataManager.getDataObject(e)}onModifySourceLength(){if(!cX(wX,this))return this.dataManager.countAllRows()}onBeforeDataSplice(e,t,n){return!(!cX(wX,this)&&!this.dataManager.isRowHighestLevel(e))||(this.dataManager.spliceData(e,t,n),!1)}destroy(){super.destroy()}}function CX(e,t,n,r){return this.rowMoveController.onBeforeRowMove(e,t,n,r)}function SX(e,t,n){this.collapsingUI.toggleState(e,t,n)}function RX(e,t,n){return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(n[0],t),this.collapsingUI.collapsedRowsStash.shiftStash(n[0],null,-1*t),this.dataManager.filterData(e,t,n),dX(fX,this,!0),this.dataManager.getData().slice()}function EX(e){return this.contextMenuUI.appendOptions(e)}function bX(e,t){this.headersUI.appendLevelIndicators(e,t)}function TX(e){return Math.max(this.headersUI.rowHeaderWidthCache,e)}function NX(e,t,n,r){r!==this.pluginName&&this.hot._registerTimeout((()=>{dX(fX,this,!1),this.headersUI.updateRowHeaderWidth(),this.collapsingUI.collapsedRowsStash.applyStash()}))}function AX(e,t,n){const r=Array.from(n.reduce(((e,t)=>{if(this.dataManager.isParent(t)){const n=this.dataManager.getDataObject(t).__children;return e.add(t),Array.isArray(n)&&n.forEach((t=>e.add(this.dataManager.getRowIndex(t)))),e}return e.add(t)}),new Set));n.length=0,n.push(...r)}function MX(){this.collapsingUI.collapsedRowsStash.stash()}function IX(e,t){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(t)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function OX(){this.collapsingUI.collapsedRowsStash.stash()}function xX(e,t,n){this.collapsingUI.collapsedRowsStash.shiftStash(n,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function PX(){this.dataManager.rewriteCache()}function _X(){this.headersUI.updateRowHeaderWidth()}function LX(e,t){cX(fX,this)&&(t.skipRender=!0)}function HX(e){if(!function(e){return!!(Array.isArray(e)&&e.length&&e.every((e=>"object"==typeof e&&!Array.isArray(e)&&null!==e)))}(e))return xm("The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled."),this.hot.getSettings()[gX]=!1,void this.disablePlugin();this.dataManager.setData(e),this.dataManager.rewriteCache()}function kX(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const FX=class{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;kX(this,"rootWindow",void 0),kX(this,"prefix",void 0),kX(this,"savedKeys",[]),this.rootWindow=t,this.prefix=e,this.loadSavedKeys()}saveValue(e,t){this.rootWindow.localStorage.setItem(`${this.prefix}_${e}`,JSON.stringify(t)),-1===this.savedKeys.indexOf(e)&&(this.savedKeys.push(e),this.saveSavedKeys())}loadValue(e,t){const n=void 0===e?t:e,r=this.rootWindow.localStorage.getItem(`${this.prefix}_${n}`);return null===r?void 0:JSON.parse(r)}reset(e){this.rootWindow.localStorage.removeItem(`${this.prefix}_${e}`)}resetAll(){Vd(this.savedKeys,((e,t)=>{this.rootWindow.localStorage.removeItem(`${this.prefix}_${this.savedKeys[t]}`)})),this.clearSavedKeys()}loadSavedKeys(){const e=this.rootWindow.localStorage.getItem(`${this.prefix}__persistentStateKeys`),t="string"==typeof e?JSON.parse(e):void 0;this.savedKeys=t||[]}saveSavedKeys(){this.rootWindow.localStorage.setItem(`${this.prefix}__persistentStateKeys`,JSON.stringify(this.savedKeys))}clearSavedKeys(){this.savedKeys.length=0,this.saveSavedKeys()}};function DX(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}mf.getSingleton().register("persistentStateSave"),mf.getSingleton().register("persistentStateLoad"),mf.getSingleton().register("persistentStateReset");const VX="persistentState";class UX extends Tx{constructor(){super(...arguments),DX(this,"storage",void 0)}static get PLUGIN_KEY(){return VX}static get PLUGIN_PRIORITY(){return 0}isEnabled(){return!!this.hot.getSettings()[VX]}enablePlugin(){this.enabled||(this.storage||(this.storage=new FX(this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",((e,t)=>this.saveValue(e,t))),this.addHook("persistentStateLoad",((e,t)=>this.loadValue(e,t))),this.addHook("persistentStateReset",(()=>this.resetValue())),super.enablePlugin())}disablePlugin(){this.storage=void 0,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}loadValue(e,t){t.value=this.storage.loadValue(e)}saveValue(e,t){this.storage.saveValue(e,t)}resetValue(e){void 0===e?this.storage.resetAll():this.storage.reset(e)}destroy(){super.destroy()}}function BX(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function WX(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function jX(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}const GX="search",zX=function(e,t,n,r,i){e.getCellMeta(t,n).isSearchResult=i},$X=function(e,t,n){return!(zd(e)||null===e||!e.toLocaleLowerCase||0===e.length)&&(!zd(t)&&null!==t&&-1!==t.toString().toLocaleLowerCase(n.locale).indexOf(e.toLocaleLowerCase(n.locale)))};var YX=new WeakSet;class KX extends Tx{constructor(){super(...arguments),BX(this,YX),WX(this,"callback",zX),WX(this,"queryMethod",$X),WX(this,"searchResultClass","htSearchResult")}static get PLUGIN_KEY(){return GX}static get PLUGIN_PRIORITY(){return 190}isEnabled(){return this.hot.getSettings()[GX]}enablePlugin(){var e=this;if(this.enabled)return;const t=this.hot.getSettings()[GX];this.updatePluginSettings(t),this.addHook("beforeRenderer",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return jX(YX,e,XX).call(e,...n)})),super.enablePlugin()}disablePlugin(){var e=this;const t=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return jX(YX,e,XX).call(e,...n)};this.hot.addHook("beforeRenderer",t),this.hot.addHookOnce("afterViewRender",(()=>{this.hot.removeHook("beforeRenderer",t)})),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}query(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.getCallback(),n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.getQueryMethod();const r=this.hot.countRows(),i=this.hot.countCols(),o=[],s=this.hot;return $w(0,r-1,(r=>{$w(0,i-1,(i=>{const a=this.hot.getDataAtCell(r,i),l=this.hot.getCellMeta(r,i),h=l.search.callback||t,u=(l.search.queryMethod||n)(e,a,l);if(u){const e={row:r,col:i,data:a};o.push(e)}h&&h(s,r,i,a,u)}))})),o}getCallback(){return this.callback}setCallback(e){this.callback=e}getQueryMethod(){return this.queryMethod}setQueryMethod(e){this.queryMethod=e}getSearchResultClass(){return this.searchResultClass}setSearchResultClass(e){this.searchResultClass=e}updatePluginSettings(e){em(e)&&(e.searchResultClass&&this.setSearchResultClass(e.searchResultClass),e.queryMethod&&this.setQueryMethod(e.queryMethod),e.callback&&this.setCallback(e.callback))}destroy(){super.destroy()}}function XX(e,t,n,r,i,o){const s=o.className||[];let a=[];"string"==typeof s?a=s.split(" "):a.push(...s),this.isEnabled()&&o.isSearchResult?a.includes(this.searchResultClass)||a.push(`${this.searchResultClass}`):a.includes(this.searchResultClass)&&a.splice(a.indexOf(this.searchResultClass),1),o.className=a.join(" ")}function qX(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class QX{constructor(e){qX(this,"viewportWidth",void 0),qX(this,"overwriteColumnWidthFn",void 0),qX(this,"baseWidths",new Map),qX(this,"stretchedWidths",new Map),this.overwriteColumnWidthFn=e}prepare(e){let{viewportWidth:t}=e;this.viewportWidth=t,this.baseWidths.clear(),this.stretchedWidths.clear()}setColumnBaseWidth(e,t){this.baseWidths.set(e,t)}calculate(){}getWidths(){return Array.from(this.stretchedWidths)}}class ZX extends QX{calculate(){const e=Array.from(this.baseWidths).reduce(((e,t)=>{let[,n]=t;return e+n}),0);if(this.viewportWidth-e<0)return void this.stretchedWidths.clear();const t=this.viewportWidth/e,n=[],r=[];let i=this.viewportWidth,o=0;if(this.baseWidths.forEach(((e,s)=>{const a=Math.round(e*t),l=this.overwriteColumnWidthFn(a,s);a===l&&a>=Zy?(n.push([s,l]),o+=l):a!==l&&(n.push([s,l]),r.push(s),i-=l)})),i<=Zy)return void this.stretchedWidths.clear();const s=i/o;let a=-1,l=0;n.forEach(((e,t)=>{let[i,o]=e,h=o;r.includes(i)||(h=Math.round(o*s)),this.stretchedWidths.set(i,h),a=i,t<n.length-1&&(l+=h)})),this.stretchedWidths.size>1&&this.stretchedWidths.set(a,Math.round(this.viewportWidth-l))}}function JX(e,t,n){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,n)}function eq(e,t){return e.get(nq(e,t))}function tq(e,t,n){return e.set(nq(e,t),n),n}function nq(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var rq=new WeakMap,iq=new WeakMap;class oq extends QX{constructor(){super(...arguments),JX(this,rq,0),JX(this,iq,-1)}prepare(e){super.prepare(e),tq(rq,this,0),tq(iq,this,-1)}setColumnBaseWidth(e,t){super.setColumnBaseWidth(e,t),tq(iq,this,e),tq(rq,this,t)}calculate(){if(-1===eq(iq,this))return;const e=Array.from(this.baseWidths).reduce(((e,t)=>{let[,n]=t;return e+n}),0),t=Math.max(this.viewportWidth-e+eq(rq,this),0);this.stretchedWidths.set(eq(iq,this),t)}}function sq(e,t,n){aq(e,t),t.set(e,n)}function aq(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function lq(e,t){return e.get(uq(e,t))}function hq(e,t,n){return e.set(uq(e,t),n),n}function uq(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var cq=new WeakMap,dq=new WeakMap,pq=new WeakMap,gq=new WeakMap,mq=new WeakSet;class fq{constructor(e){var t,n;aq(t=this,n=mq),n.add(t),sq(this,cq,void 0),sq(this,dq,void 0),sq(this,pq,new Map([["all",new ZX(uq(mq,this,vq).bind(this))],["last",new oq(uq(mq,this,vq).bind(this))]])),sq(this,gq,"none"),hq(cq,this,e),hq(dq,this,lq(cq,this).columnIndexMapper.createAndRegisterIndexMap("stretchColumns","physicalIndexToValue"))}useStrategy(e){hq(gq,this,lq(pq,this).has(e)?e:"none")}refreshStretching(){"none"!==lq(gq,this)?lq(cq,this).batchExecution((()=>{lq(dq,this).clear();const e=lq(pq,this).get(lq(gq,this));let t=lq(cq,this).view.getViewportWidth();uq(mq,this,wq).call(this)&&(t-=ng(lq(cq,this).rootDocument)),e.prepare({viewportWidth:t});for(let n=0;n<lq(cq,this).countCols();n++)lq(cq,this).columnIndexMapper.isHidden(lq(cq,this).toPhysicalColumn(n))||e.setColumnBaseWidth(n,uq(mq,this,yq).call(this,n));e.calculate(),e.getWidths().forEach((e=>{let[t,n]=e;lq(dq,this).setValueAtIndex(lq(cq,this).toPhysicalColumn(t),n)}))}),!0):lq(dq,this).clear()}getStretchedWidth(e){return lq(dq,this).getValueAtIndex(lq(cq,this).toPhysicalColumn(e))}}function wq(){const{view:e}=lq(cq,this);if(e.isVerticallyScrollableByWindow())return!1;const t=e.getViewportHeight(),n=lq(cq,this).countRows(),r=e.getStylesHandler().getDefaultRowHeight();let i=0,o=!1;for(let a=0;a<n;a++){var s;if(i+=(null!==(s=lq(cq,this).getRowHeight(a))&&void 0!==s?s:r)+(0===a?1:0),i>t){o=!0;break}}return o}function yq(e){var t;return null!==(t=lq(cq,this).getColWidth(e,"StretchColumns"))&&void 0!==t?t:Zy}function vq(e,t){return lq(cq,this).runHooks("beforeStretchingColumnWidth",e,t)}function Cq(e,t,n){Sq(e,t),t.set(e,n)}function Sq(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Rq(e,t,n){return e.set(bq(e,t),n),n}function Eq(e,t){return e.get(bq(e,t))}function bq(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var Tq=new WeakMap,Nq=new WeakMap,Aq=new WeakMap,Mq=new WeakSet;class Iq extends Tx{constructor(){var e,t;super(...arguments),Sq(e=this,t=Mq),t.add(e),Cq(this,Tq,new fq(this.hot)),Cq(this,Nq,null),Cq(this,Aq,new ResizeObserver((e=>{requestAnimationFrame((()=>{var t;null!==(t=this.hot)&&void 0!==t&&t.view.isHorizontallyScrollableByWindow()&&e.forEach((e=>{let{contentRect:t}=e;null!==Eq(Nq,this)&&Eq(Nq,this)!==t.width&&(this.hot.refreshDimensions(),this.hot.view.adjustElementsSize()),Rq(Nq,this,t.width)}))}))})))}static get PLUGIN_KEY(){return"stretchColumns"}static get PLUGIN_PRIORITY(){return 155}static get SETTING_KEYS(){return!0}isEnabled(){return["all","last"].includes(this.hot.getSettings().stretchH)}enablePlugin(){var e=this;this.enabled||(Eq(Tq,this).useStrategy(this.hot.getSettings().stretchH),Eq(Aq,this).observe(this.hot.rootElement),this.addHook("beforeRender",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return bq(Mq,e,xq).call(e,...n)})),this.addHook("modifyColWidth",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return bq(Mq,e,Oq).call(e,...n)}),10),super.enablePlugin())}updatePlugin(){Eq(Tq,this).useStrategy(this.hot.getSettings().stretchH),super.updatePlugin()}disablePlugin(){super.disablePlugin(),Eq(Aq,this).unobserve(this.hot.rootElement)}getColumnWidth(e){return Eq(Tq,this).getStretchedWidth(e)}destroy(){Eq(Aq,this).disconnect(),Rq(Aq,this,null),Rq(Tq,this,null),super.destroy()}}function Oq(e,t,n){if(n===this.pluginName)return;const r=this.getColumnWidth(t);return"number"==typeof r?r:e}function xq(e){e&&Eq(Tq,this).refreshStretching()}function Pq(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function _q(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Lq(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var Hq=new WeakSet;class kq extends Tx{constructor(){super(...arguments),Pq(this,Hq),_q(this,"scrollbars",[]),_q(this,"clones",[]),_q(this,"lockedCollection",!1),_q(this,"freezeOverlays",!1)}static get PLUGIN_KEY(){return"touchScroll"}static get PLUGIN_PRIORITY(){return 200}static get SETTING_KEYS(){return!0}isEnabled(){return hm()}enablePlugin(){this.enabled||(this.addHook("afterViewRender",(()=>Lq(Hq,this,Fq).call(this))),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.lockedCollection=!1,super.updatePlugin()}disablePlugin(){super.disablePlugin()}registerEvents(){this.addHook("beforeTouchScroll",(()=>Lq(Hq,this,Dq).call(this))),this.addHook("afterMomentumScroll",(()=>Lq(Hq,this,Vq).call(this)))}}function Fq(){if(this.lockedCollection)return;const{topOverlay:e,bottomOverlay:t,inlineStartOverlay:n,topInlineStartCornerOverlay:r,bottomInlineStartCornerOverlay:i}=this.hot.view._wt.wtOverlays;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(e),t.clone&&this.scrollbars.push(t),this.scrollbars.push(n),r&&this.scrollbars.push(r),i&&i.clone&&this.scrollbars.push(i),this.clones=[],e.needFullRender&&this.clones.push(e.clone.wtTable.holder.parentNode),t.needFullRender&&this.clones.push(t.clone.wtTable.holder.parentNode),n.needFullRender&&this.clones.push(n.clone.wtTable.holder.parentNode),r&&this.clones.push(r.clone.wtTable.holder.parentNode),i&&i.clone&&this.clones.push(i.clone.wtTable.holder.parentNode)}function Dq(){this.freezeOverlays=!0,Vd(this.clones,(e=>{Op(e,"hide-tween")}))}function Vq(){this.freezeOverlays=!1,Vd(this.clones,(e=>{xp(e,"hide-tween"),Op(e,"show-tween")})),this.hot._registerTimeout((()=>{Vd(this.clones,(e=>{xp(e,"show-tween")}))}),400),Vd(this.scrollbars,(e=>{e.refresh(),e.resetFixedPosition()})),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}function Uq(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function Bq(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const Wq="trimRows";var jq=new WeakSet;class Gq extends Tx{constructor(){super(...arguments),Uq(this,jq),Bq(this,"trimmedRowsMap",null)}static get PLUGIN_KEY(){return Wq}static get PLUGIN_PRIORITY(){return 330}isEnabled(){return!!this.hot.getSettings()[Wq]}enablePlugin(){this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new kE),this.trimmedRowsMap.addLocalHook("init",(()=>function(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}(jq,this,zq).call(this))),super.enablePlugin())}updatePlugin(){const e=this.hot.getSettings()[Wq];Array.isArray(e)&&this.hot.batchExecution((()=>{this.trimmedRowsMap.clear(),Vd(e,(e=>{this.trimmedRowsMap.setValueAtIndex(e,!0)}))}),!0),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("trimRows"),super.disablePlugin()}getTrimmedRows(){return this.trimmedRowsMap.getTrimmedIndexes()}trimRows(e){const t=this.getTrimmedRows(),n=this.isValidConfig(e);let r=t;n&&(r=Array.from(new Set(t.concat(e))));!1!==this.hot.runHooks("beforeTrimRow",t,r,n)&&(n&&this.hot.batchExecution((()=>{Vd(e,(e=>{this.trimmedRowsMap.setValueAtIndex(e,!0)}))}),!0),this.hot.runHooks("afterTrimRow",t,r,n,n&&r.length>t.length))}trimRow(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.trimRows(t)}untrimRows(e){const t=this.getTrimmedRows(),n=this.isValidConfig(e);let r=t;const i=this.trimmedRowsMap.getValues().slice(),o=e.length>0;n&&o&&(Vd(e,(e=>{i[e]=!1})),r=kd(i,((e,t,n)=>(t&&e.push(n),e)),[]));!1!==this.hot.runHooks("beforeUntrimRow",t,r,n&&o)&&(n&&o&&this.trimmedRowsMap.setValues(i),this.hot.runHooks("afterUntrimRow",t,r,n&&o,n&&r.length<t.length))}untrimRow(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.untrimRows(t)}isTrimmed(e){return this.trimmedRowsMap.getValueAtIndex(e)||!1}untrimAll(){this.untrimRows(this.getTrimmedRows())}isValidConfig(e){const t=this.hot.countSourceRows();return e.every((e=>Number.isInteger(e)&&e>=0&&e<t))}destroy(){super.destroy()}}function zq(){const e=this.hot.getSettings()[Wq];Array.isArray(e)&&this.hot.batchExecution((()=>{Vd(e,(e=>{this.trimmedRowsMap.setValueAtIndex(e,!0)}))}),!0)}function $q(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Yq{constructor(e){$q(this,"actionType",""),this.actionType=e}undo(){throw new Error("Not implemented")}redo(){throw new Error("Not implemented")}}function Kq(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Xq extends Yq{constructor(e){let{stateBefore:t,range:n,type:r,alignment:i}=e;super("cell_alignment"),Kq(this,"stateBefore",void 0),Kq(this,"range",void 0),Kq(this,"type",void 0),Kq(this,"alignment",void 0),this.stateBefore=t,this.range=n,this.type=r,this.alignment=i}static startRegisteringEvents(e,t){e.addHook("beforeCellAlignment",((e,n,r,i)=>{t.done((()=>new Xq({stateBefore:e,range:n,type:r,alignment:i})))}))}undo(e,t){Vd(this.range,(t=>{t.forAll(((t,n)=>{t>=0&&n>=0&&e.setCellMeta(t,n,"className",this.stateBefore[t][n]||" htLeft")}))})),e.addHookOnce("afterViewRender",t),e.render()}redo(e,t){AL(this.range,this.type,this.alignment,((t,n)=>e.getCellMeta(t,n)),((t,n,r,i)=>e.setCellMeta(t,n,r,i))),e.addHookOnce("afterViewRender",t),e.render()}}function qq(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Qq extends Yq{constructor(e){let{columns:t,finalIndex:n}=e;super("col_move"),qq(this,"columns",void 0),qq(this,"finalColumnIndex",void 0),this.columns=t.slice(),this.finalColumnIndex=n}static startRegisteringEvents(e,t){e.addHook("beforeColumnMove",((e,n)=>{!1!==e&&t.done((()=>new Qq({columns:e,finalIndex:n})))}))}undo(e,t){const n=e.getPlugin("manualColumnMove");e.addHookOnce("afterViewRender",t);AB(this.columns,this.finalColumnIndex,e.columnIndexMapper.getNumberOfIndexes()).reverse().forEach((e=>{let{from:t,to:r}=e;t<r&&(r-=1),n.moveColumn(r,t)})),e.render(),e.deselectCell(),e.selectColumns(this.columns[0],this.columns[0]+this.columns.length-1)}redo(e,t){const n=e.getPlugin("manualColumnMove");e.addHookOnce("afterViewRender",t),n.moveColumns(this.columns.slice(),this.finalColumnIndex),e.render(),e.deselectCell(),e.selectColumns(this.finalColumnIndex,this.finalColumnIndex+this.columns.length-1)}}function Zq(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Jq extends Yq{constructor(e){let{currentSortState:t,newSortState:n}=e;super("col_sort"),Zq(this,"previousSortState",void 0),Zq(this,"nextSortState",void 0),this.previousSortState=t,this.nextSortState=n}static startRegisteringEvents(e,t){e.addHook("beforeColumnSort",((e,n,r)=>{r&&t.done((()=>new Jq({currentSortState:e,newSortState:n})))}))}undo(e,t){const n=e.getPlugin("columnSorting"),r=e.getPlugin("multiColumnSorting"),i=r.isEnabled()?r:n;this.previousSortState.length?i.sort(this.previousSortState):i.clearSort(),t()}redo(e,t){const n=e.getPlugin("columnSorting"),r=e.getPlugin("multiColumnSorting");(r.isEnabled()?r:n).sort(this.nextSortState),t()}}function eQ(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class tQ extends Yq{constructor(e){let{index:t,amount:n}=e;super("insert_col"),eQ(this,"index",void 0),eQ(this,"amount",void 0),this.index=t,this.amount=n}static startRegisteringEvents(e,t){e.addHook("afterCreateCol",((e,n,r)=>{t.done((()=>new tQ({index:e,amount:n})),r)}))}undo(e,t){e.addHookOnce("afterRemoveCol",t),e.alter("remove_col",this.index,this.amount,"UndoRedo.undo")}redo(e,t){e.addHookOnce("afterCreateCol",t),e.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")}}function nQ(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class rQ extends Yq{constructor(e){let{index:t,amount:n}=e;super("insert_row"),nQ(this,"index",void 0),nQ(this,"amount",void 0),this.index=t,this.amount=n}static startRegisteringEvents(e,t){e.addHook("afterCreateRow",((e,n,r)=>{t.done((()=>new rQ({index:e,amount:n})),r)}))}undo(e,t){const n=e.countRows(),r=e.getSettings().minSpareRows;this.index>=n&&this.index-r<n&&(this.index-=r),e.addHookOnce("afterRemoveRow",t),e.alter("remove_row",this.index,this.amount,"UndoRedo.undo")}redo(e,t){e.addHookOnce("afterCreateRow",t),e.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")}}function iQ(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class oQ extends Yq{constructor(e){let{changes:t,selected:n,countCols:r,countRows:i}=e;super("change"),iQ(this,"changes",void 0),iQ(this,"selected",void 0),iQ(this,"countCols",void 0),iQ(this,"countRows",void 0),this.changes=t,this.selected=n,this.countCols=r,this.countRows=i}static startRegisteringEvents(e,t){e.addHook("beforeChange",(function(n,r){const i=n&&n.length;if(!i)return;if(!n.find((e=>{const[,,t,n]=e;return t!==n})))return;t.done((()=>{const t=n.reduce(((e,t)=>(e.push([...t]),e)),[]);t.forEach((t=>{t[1]=e.propToCol(t[1])}));const r=i>1?this.getSelected():[[t[0][0],t[0][1]]];return new oQ({changes:t,selected:r,countCols:e.countCols(),countRows:e.countRows()})}),r)}))}undo(e,t){const n=qg(this.changes);for(let o=0,s=n.length;o<s;o++)n[o].splice(3,1);e.addHookOnce("afterChange",t),e.setDataAtCell(n,null,null,"UndoRedo.undo");const r=e.countRows()-this.countRows;r>0&&e.alter("remove_row",null,r,"UndoRedo.undo");const i=e.countCols()-this.countCols;i>0&&e.isColumnModificationAllowed()&&e.alter("remove_col",null,i,"UndoRedo.undo"),e.scrollToFocusedCell(),e.selectCells(this.selected,!1,!1)}redo(e,t){const n=qg(this.changes);for(let r=0,i=n.length;r<i;r++)n[r].splice(2,1);e.addHookOnce("afterChange",t),e.setDataAtCell(n,null,null,"UndoRedo.redo"),this.selected&&e.selectCells(this.selected,!1,!1)}}function sQ(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class aQ extends Yq{constructor(e){let{conditionsStack:t,previousConditionsStack:n}=e;super("filter"),sQ(this,"conditionsStack",void 0),sQ(this,"previousConditionsStack",void 0),this.conditionsStack=t,this.previousConditionsStack=n}static startRegisteringEvents(e,t){e.addHook("beforeFilter",((e,n)=>{t.done((()=>new aQ({conditionsStack:e,previousConditionsStack:n})))}))}undo(e,t){const n=e.getPlugin("filters");e.addHookOnce("afterViewRender",t),n.importConditions(this.previousConditionsStack),n.filter()}redo(e,t){const n=e.getPlugin("filters");e.addHookOnce("afterViewRender",t),n.importConditions(this.conditionsStack),n.filter()}}function lQ(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class hQ extends Yq{constructor(e){let{data:t,cellRange:n}=e;super("merge_cells"),lQ(this,"cellRange",void 0),this.cellRange=n,this.data=t}static startRegisteringEvents(e,t){e.addHook("beforeMergeCells",((n,r)=>{if(r)return;const i=n.getTopStartCorner(),o=n.getBottomEndCorner(),s=e.getData(i.row,i.col,o.row,o.col);t.done((()=>new hQ({data:s,cellRange:n})))}))}undo(e,t){const n=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",t),n.unmergeRange(this.cellRange,!0);const r=this.cellRange.getTopStartCorner();e.populateFromArray(r.row,r.col,this.data,void 0,void 0,"MergeCells")}redo(e,t){const n=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",t),n.mergeRange(this.cellRange)}}var uQ=wu,cQ=nl;function dQ(e,t,n,r,i){const o=["visualRow","visualCol","row","col","prop"],s=o.length,a=[];return $w(r,i,(r=>{$w(t,n,(t=>{const n=e.getCellMeta(t,r);if(Object.keys(n).length!==s){const e=Object.fromEntries(Object.entries(n).filter((e=>{let[t]=e;return!1===o.includes(t)})));a.push([n.visualRow,n.visualCol,e])}}))})),a}function pQ(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Ti({target:"Object",stat:!0},{fromEntries:function(e){var t={};return uQ(e,(function(e,n){cQ(t,e,n)}),{AS_ENTRIES:!0}),t}});class gQ extends Yq{constructor(e){let{index:t,indexes:n,data:r,amount:i,headers:o,columnPositions:s,rowPositions:a,fixedColumnsStart:l,removedCellMetas:h}=e;super("remove_col"),pQ(this,"index",void 0),pQ(this,"indexes",void 0),pQ(this,"data",void 0),pQ(this,"amount",void 0),pQ(this,"headers",void 0),pQ(this,"columnPositions",void 0),pQ(this,"rowPositions",void 0),pQ(this,"fixedColumnsStart",void 0),pQ(this,"removedCellMetas",void 0),this.index=t,this.indexes=n,this.data=r,this.amount=i,this.headers=o,this.columnPositions=s.slice(0),this.rowPositions=a.slice(0),this.fixedColumnsStart=l,this.removedCellMetas=h}static startRegisteringEvents(e,t){e.addHook("beforeRemoveCol",((n,r,i,o)=>{t.done((()=>{const t=e.getSourceDataArray(),i=(e.countCols()+n)%e.countCols(),o=i+r-1,s=[],a=[],l=[];$w(t.length-1,(n=>{const r=[],a=t[n];$w(i,o,(t=>{r.push(a[e.toPhysicalColumn(t)])})),s.push(r)})),$w(r-1,(t=>{l.push(e.toPhysicalColumn(i+t))})),Array.isArray(e.getSettings().colHeaders)&&$w(r-1,(t=>{a.push(e.getSettings().colHeaders[e.toPhysicalColumn(i+t)]||null)}));const h=e.columnIndexMapper.getIndexesSequence(),u=e.rowIndexMapper.getIndexesSequence();return new gQ({index:i,indexes:l,data:s,amount:r,headers:a,columnPositions:h,rowPositions:u,fixedColumnsStart:e.getSettings().fixedColumnsStart,removedCellMetas:dQ(e,0,e.countRows(),i,o)})}),o)}))}undo(e,t){e.getSettings().fixedColumnsStart=this.fixedColumnsStart;const n=this.indexes.slice(0).sort(),r=(e,t,r)=>r[this.indexes.indexOf(n[t])],i=this.data.length,o=[];for(let l=0;l<i;l++)o.push(Dd(this.data[l],r));const s=Dd(this.headers,r),a=[];e.alter("insert_col_start",this.indexes[0],this.indexes.length,"UndoRedo.undo"),Vd(e.getSourceDataArray(),((e,t)=>{Vd(n,((n,r)=>{e[n]=o[t][r],a.push([t,n,e[n]])}))})),e.setSourceDataAtCell(a,void 0,void 0,"UndoRedo.undo"),void 0!==this.headers&&Vd(s,((t,r)=>{e.getSettings().colHeaders[n[r]]=t})),this.removedCellMetas.forEach((t=>{let[n,r,i]=t;e.setCellMetaObject(n,r,i)})),e.batchExecution((()=>{e.rowIndexMapper.setIndexesSequence(this.rowPositions),e.columnIndexMapper.setIndexesSequence(this.columnPositions)}),!0),e.addHookOnce("afterViewRender",t),e.render()}redo(e,t){e.addHookOnce("afterRemoveCol",t),e.alter("remove_col",this.index,this.amount,"UndoRedo.redo")}}function mQ(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class fQ extends Yq{constructor(e){let{index:t,data:n,fixedRowsBottom:r,fixedRowsTop:i,rowIndexesSequence:o,removedCellMetas:s}=e;super("remove_row"),mQ(this,"index",void 0),mQ(this,"data",void 0),mQ(this,"fixedRowsBottom",void 0),mQ(this,"fixedRowsTop",void 0),mQ(this,"rowIndexesSequence",void 0),mQ(this,"removedCellMetas",void 0),this.index=t,this.data=n,this.fixedRowsBottom=r,this.fixedRowsTop=i,this.rowIndexesSequence=o,this.removedCellMetas=s}static startRegisteringEvents(e,t){e.addHook("beforeRemoveRow",((n,r,i,o)=>{t.done((()=>{const t=e.toPhysicalRow(n),i=t+r-1,o=qg(e.getSourceData(t,0,t+r-1,e.countSourceCols()-1));return new fQ({index:t,data:o,fixedRowsBottom:e.getSettings().fixedRowsBottom,fixedRowsTop:e.getSettings().fixedRowsTop,rowIndexesSequence:e.rowIndexMapper.getIndexesSequence(),removedCellMetas:dQ(e,t,i,0,e.countCols()-1)})}),o)}))}undo(e,t){const n=e.getSettings(),r=[];n.fixedRowsBottom=this.fixedRowsBottom,n.fixedRowsTop=this.fixedRowsTop,this.data.forEach(((e,t)=>{Object.keys(e).forEach((n=>{const i=parseInt(n,10);r.push([this.index+t,isNaN(i)?n:i,e[n]])}))})),e.alter("insert_row_above",this.index,this.data.length,"UndoRedo.undo"),this.removedCellMetas.forEach((t=>{let[n,r,i]=t;e.setCellMetaObject(n,r,i)})),e.addHookOnce("afterViewRender",t),e.setSourceDataAtCell(r,null,null,"UndoRedo.undo"),e.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence)}redo(e,t){e.addHookOnce("afterRemoveRow",t),e.alter("remove_row",this.index,this.data.length,"UndoRedo.redo")}}function wQ(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class yQ extends Yq{constructor(e){let{rows:t,finalIndex:n}=e;super("row_move"),wQ(this,"rows",void 0),wQ(this,"finalRowIndex",void 0),this.rows=t.slice(),this.finalRowIndex=n}static startRegisteringEvents(e,t){e.addHook("beforeRowMove",((e,n)=>{!1!==e&&t.done((()=>new yQ({rows:e,finalIndex:n})))}))}undo(e,t){const n=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",t);AB(this.rows,this.finalRowIndex,e.rowIndexMapper.getNumberOfIndexes()).reverse().forEach((e=>{let{from:t,to:r}=e;t<r&&(r-=1),n.moveRow(r,t)})),e.render(),e.deselectCell(),e.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)}redo(e,t){const n=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",t),n.moveRows(this.rows.slice(),this.finalRowIndex),e.render(),e.deselectCell(),e.selectRows(this.finalRowIndex,this.finalRowIndex+this.rows.length-1)}}function vQ(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class CQ extends Yq{constructor(e){let{cellRange:t}=e;super("unmerge_cells"),vQ(this,"cellRange",void 0),this.cellRange=t}static startRegisteringEvents(e,t){e.addHook("afterUnmergeCells",((e,n)=>{n||t.done((()=>new CQ({cellRange:e})))}))}undo(e,t){const n=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",t),n.mergeRange(this.cellRange,!0)}redo(e,t){const n=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",t),n.unmergeRange(this.cellRange,!0),e.render()}}function SQ(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function RQ(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function EQ(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}const bQ="undoRedo";mf.getSingleton().register("beforeUndo"),mf.getSingleton().register("afterUndo"),mf.getSingleton().register("beforeRedo"),mf.getSingleton().register("afterRedo");const TQ=new Set;var NQ=new WeakSet;let AQ=class extends Tx{static get PLUGIN_KEY(){return"undoRedo"}static get PLUGIN_PRIORITY(){return 1e3}static get SETTING_KEYS(){return!0}constructor(e){var t,n;super(e),SQ(this,NQ),RQ(this,"doneActions",[]),RQ(this,"undoneActions",[]),RQ(this,"ignoreNewActions",!1),t=e,n=this,[Xq,Qq,Jq,tQ,rQ,oQ,aQ,hQ,gQ,fQ,yQ,CQ].forEach((e=>e.startRegisteringEvents(t,n)))}isEnabled(){return!!this.hot.getSettings().undo}enablePlugin(){var e=this;this.enabled||(this.addHook("afterChange",(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return EQ(NQ,e,MQ).call(e,...n)})),this.registerShortcuts(),EQ(NQ,this,IQ).call(this),super.enablePlugin())}disablePlugin(){super.disablePlugin(),this.clear(),this.unregisterShortcuts(),EQ(NQ,this,OQ).call(this)}registerShortcuts(){const e=this.hot.getShortcutManager().getContext("grid"),t={runOnlyIf:e=>!e.altKey,group:bQ};e.addShortcuts([{keys:[["Control/Meta","z"]],callback:()=>{this.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:()=>{this.redo()}}],t)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(bQ)}done(e,t){if(this.ignoreNewActions)return;if("UndoRedo.undo"===t||"UndoRedo.redo"===t||"auto"===t)return;const n=this.doneActions.slice();if(!1===this.hot.runHooks("beforeUndoStackChange",n,t))return;const r=e(),i=this.undoneActions.slice();this.doneActions.push(r),this.hot.runHooks("afterUndoStackChange",n,this.doneActions.slice()),this.hot.runHooks("beforeRedoStackChange",i),this.undoneActions.length=0,this.hot.runHooks("afterRedoStackChange",i,this.undoneActions.slice())}undo(){if(!this.isUndoAvailable())return;const e=this.doneActions.slice();this.hot.runHooks("beforeUndoStackChange",e);const t=this.doneActions.pop();this.hot.runHooks("afterUndoStackChange",e,this.doneActions.slice());const n=qg(t);if(!1===this.hot.runHooks("beforeUndo",n))return;this.ignoreNewActions=!0;const r=this.undoneActions.slice();this.hot.runHooks("beforeRedoStackChange",r),t.undo(this.hot,(()=>{this.ignoreNewActions=!1,this.undoneActions.push(t)})),this.hot.runHooks("afterRedoStackChange",r,this.undoneActions.slice()),this.hot.runHooks("afterUndo",n)}redo(){if(!this.isRedoAvailable())return;const e=this.undoneActions.slice();this.hot.runHooks("beforeRedoStackChange",e);const t=this.undoneActions.pop();this.hot.runHooks("afterRedoStackChange",e,this.undoneActions.slice());const n=qg(t);if(!1===this.hot.runHooks("beforeRedo",n))return;this.ignoreNewActions=!0;const r=this.doneActions.slice();this.hot.runHooks("beforeUndoStackChange",r),t.redo(this.hot,(()=>{this.ignoreNewActions=!1,this.doneActions.push(t)})),this.hot.runHooks("afterUndoStackChange",r,this.doneActions.slice()),this.hot.runHooks("afterRedo",n)}isUndoAvailable(){return this.doneActions.length>0}isRedoAvailable(){return this.undoneActions.length>0}clear(){this.doneActions.length=0,this.undoneActions.length=0}destroy(){this.clear(),this.doneActions=null,this.undoneActions=null,super.destroy()}};function MQ(e,t){"loadData"===t&&this.clear()}function IQ(){const e=e=>{TQ.has(e)||(Om(Wd`The "${e}" method is deprecated and it will be removed\x20
          from the Core API in the future. Please use the method from the UndoRedo plugin\x20
          (e.g. \`hotInstance.getPlugin("undoRedo").${e}()\`).`),TQ.add(e))};this.hot.undo=()=>{e("undo"),this.undo()},this.hot.redo=()=>{e("redo"),this.redo()},this.hot.isUndoAvailable=()=>(e("isUndoAvailable"),this.isUndoAvailable()),this.hot.isRedoAvailable=()=>(e("isRedoAvailable"),this.isRedoAvailable()),this.hot.clearUndo=()=>{e("clear"),this.clear()},this.hot.undoRedo=this}function OQ(){delete this.hot.undo,delete this.hot.redo,delete this.hot.isUndoAvailable,delete this.hot.isRedoAvailable,delete this.hot.clearUndo,delete this.hot.undoRedo}function xQ(){Mf(GA),Mf(QM),Mf(JM),Mf(PI),Mf(LI),Mf(GM),Mf(HI),Mf(FI),Mf(UI),Mf(AM),Mf(BI),fy(jI),fy(MM),fy(QI),fy(GI),fy(JI),fy(WI),fy(KO),fy(XO),fy(qO),fy(IM),fy(QO),Ry(ZO),Ry(tx),Ry(ex),Ry(nx),Ry(ix),cA(ox),cA(sx),cA(lx),cA(hx),cA(ux),cA(cx),cA(dx),cA(px),cA(OM),cA(gx),hy(Wx),hy(rP),hy(fP),hy(HP),hy(XP),hy(H_),hy(K_),hy(pH),hy(dk),hy(Jk),hy(NF),hy(LF),hy(zF),hy(dD),hy(tB),hy(cW),hy(jW),hy(rj),hy(wj),hy(Yj),hy(bG),hy(nz),hy(_z),hy(q$),hy(MY),hy(OY),hy(IK),hy(vX),hy(UX),hy(KX),hy(Iq),hy(kq),hy(Gq),hy(AQ)}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */var PQ,_Q;!function(e){e.RELATIVE="RELATIVE",e.ABSOLUTE="ABSOLUTE"}(PQ||(PQ={}));class LQ{constructor(e,t,n){this.type=e,this.col=t,this.sheet=n}static absolute(e,t){return new LQ(PQ.ABSOLUTE,e,t)}static relative(e,t){return new LQ(PQ.RELATIVE,e,t)}static compareByAbsoluteAddress(e){return(t,n)=>t.toSimpleColumnAddress(e).col-n.toSimpleColumnAddress(e).col}isColumnAbsolute(){return this.type===PQ.ABSOLUTE}isColumnRelative(){return this.type===PQ.RELATIVE}isAbsolute(){return this.type===PQ.ABSOLUTE&&void 0!==this.sheet}moved(e,t,n){const r=void 0===this.sheet?void 0:e;return new LQ(this.type,this.col+t,r)}shiftedByColumns(e){return new LQ(this.type,this.col+e,this.sheet)}toSimpleColumnAddress(e){const t=b4(this,e);let n=this.col;return this.isColumnRelative()&&(n=e.col+this.col),w4(t,n)}shiftRelativeDimensions(e,t){const n=this.isColumnRelative()?this.col+e:this.col;return new LQ(this.type,n,this.sheet)}shiftAbsoluteDimensions(e,t){const n=this.isColumnAbsolute()?this.col+e:this.col;return new LQ(this.type,n,this.sheet)}withSheet(e){return new LQ(this.type,this.col,e)}isInvalid(e){return this.toSimpleColumnAddress(e).col<0}hash(e){const t=e&&void 0!==this.sheet?`#${this.sheet}`:"";switch(this.type){case PQ.RELATIVE:return`${t}#COLR${this.col}`;case PQ.ABSOLUTE:return`${t}#COLA${this.col}`}}unparse(e){const t=this.toSimpleColumnAddress(e);if(y4(t))return;const n=aZ(t.col);return`${this.type===PQ.ABSOLUTE?"$":""}${n}`}exceedsSheetSizeLimits(e){return this.col>=e}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class HQ{constructor(e,t,n){this.type=e,this.row=t,this.sheet=n}static absolute(e,t){return new HQ(PQ.ABSOLUTE,e,t)}static relative(e,t){return new HQ(PQ.RELATIVE,e,t)}static compareByAbsoluteAddress(e){return(t,n)=>t.toSimpleRowAddress(e).row-n.toSimpleRowAddress(e).row}isRowAbsolute(){return this.type===PQ.ABSOLUTE}isRowRelative(){return this.type===PQ.RELATIVE}isAbsolute(){return this.type===PQ.ABSOLUTE&&void 0!==this.sheet}moved(e,t,n){const r=void 0===this.sheet?void 0:e;return new HQ(this.type,this.row+n,r)}shiftedByRows(e){return new HQ(this.type,this.row+e,this.sheet)}toSimpleRowAddress(e){const t=b4(this,e);let n=this.row;return this.isRowRelative()&&(n=e.row+this.row),m4(t,n)}shiftRelativeDimensions(e,t){const n=this.isRowRelative()?this.row+t:this.row;return new HQ(this.type,n,this.sheet)}shiftAbsoluteDimensions(e,t){const n=this.isRowAbsolute()?this.row+t:this.row;return new HQ(this.type,n,this.sheet)}withSheet(e){return new HQ(this.type,this.row,e)}isInvalid(e){return this.toSimpleRowAddress(e).row<0}hash(e){const t=e&&void 0!==this.sheet?`#${this.sheet}`:"";switch(this.type){case PQ.RELATIVE:return`${t}#ROWR${this.row}`;case PQ.ABSOLUTE:return`${t}#ROWA${this.row}`}}unparse(e){const t=this.toSimpleRowAddress(e);if(f4(t))return;return`${this.type===PQ.ABSOLUTE?"$":""}${t.row+1}`}exceedsSheetSizeLimits(e){return this.row>=e}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */!function(e){e.CELL_REFERENCE_RELATIVE="CELL_REFERENCE",e.CELL_REFERENCE_ABSOLUTE="CELL_REFERENCE_ABSOLUTE",e.CELL_REFERENCE_ABSOLUTE_COL="CELL_REFERENCE_ABSOLUTE_COL",e.CELL_REFERENCE_ABSOLUTE_ROW="CELL_REFERENCE_ABSOLUTE_ROW"}(_Q||(_Q={}));class kQ{constructor(e,t,n,r){this.col=e,this.row=t,this.type=n,this.sheet=r}static fromColAndRow(e,t,n){return(e.isColumnAbsolute()&&t.isRowAbsolute()?kQ.absolute.bind(this):e.isColumnAbsolute()?kQ.absoluteCol.bind(this):t.isRowAbsolute()?kQ.absoluteRow.bind(this):kQ.relative.bind(this))(e.col,t.row,n)}static relative(e,t,n){return new kQ(e,t,_Q.CELL_REFERENCE_RELATIVE,n)}static absolute(e,t,n){return new kQ(e,t,_Q.CELL_REFERENCE_ABSOLUTE,n)}static absoluteCol(e,t,n){return new kQ(e,t,_Q.CELL_REFERENCE_ABSOLUTE_COL,n)}static absoluteRow(e,t,n){return new kQ(e,t,_Q.CELL_REFERENCE_ABSOLUTE_ROW,n)}toSimpleCellAddress(e){const t=b4(this,e);return this.type===_Q.CELL_REFERENCE_ABSOLUTE?v4(t,this.col,this.row):this.type===_Q.CELL_REFERENCE_ABSOLUTE_ROW?v4(t,e.col+this.col,this.row):this.type===_Q.CELL_REFERENCE_ABSOLUTE_COL?v4(t,this.col,e.row+this.row):v4(t,e.col+this.col,e.row+this.row)}toColumnAddress(){const e=this.isColumnRelative()?PQ.RELATIVE:PQ.ABSOLUTE;return new LQ(e,this.col,this.sheet)}toRowAddress(){const e=this.isRowRelative()?PQ.RELATIVE:PQ.ABSOLUTE;return new HQ(e,this.row,this.sheet)}toSimpleColumnAddress(e){const t=b4(this,e);let n=this.col;return this.isColumnRelative()&&(n+=e.col),w4(t,n)}toSimpleRowAddress(e){const t=b4(this,e);let n=this.row;return this.isRowRelative()&&(n+=e.row),m4(t,n)}isRowAbsolute(){return this.type===_Q.CELL_REFERENCE_ABSOLUTE||this.type===_Q.CELL_REFERENCE_ABSOLUTE_ROW}isColumnAbsolute(){return this.type===_Q.CELL_REFERENCE_ABSOLUTE||this.type===_Q.CELL_REFERENCE_ABSOLUTE_COL}isColumnRelative(){return this.type===_Q.CELL_REFERENCE_RELATIVE||this.type===_Q.CELL_REFERENCE_ABSOLUTE_ROW}isRowRelative(){return this.type===_Q.CELL_REFERENCE_RELATIVE||this.type===_Q.CELL_REFERENCE_ABSOLUTE_COL}isAbsolute(){return this.type===_Q.CELL_REFERENCE_ABSOLUTE&&void 0!==this.sheet}shiftedByRows(e){return new kQ(this.col,this.row+e,this.type,this.sheet)}shiftedByColumns(e){return new kQ(this.col+e,this.row,this.type,this.sheet)}moved(e,t,n){const r=void 0===this.sheet?void 0:e;return new kQ(this.col+t,this.row+n,this.type,r)}withSheet(e){return new kQ(this.col,this.row,this.type,e)}isInvalid(e){return C4(this.toSimpleCellAddress(e))}shiftRelativeDimensions(e,t){const n=this.isColumnAbsolute()?this.col:this.col+e,r=this.isRowAbsolute()?this.row:this.row+t;return new kQ(n,r,this.type,this.sheet)}shiftAbsoluteDimensions(e,t){const n=this.isColumnRelative()?this.col:this.col+e,r=this.isRowRelative()?this.row:this.row+t;return new kQ(n,r,this.type,this.sheet)}hash(e){const t=e&&void 0!==this.sheet?`#${this.sheet}`:"";switch(this.type){case _Q.CELL_REFERENCE_RELATIVE:return`${t}#${this.row}R${this.col}`;case _Q.CELL_REFERENCE_ABSOLUTE:return`${t}#${this.row}A${this.col}`;case _Q.CELL_REFERENCE_ABSOLUTE_COL:return`${t}#${this.row}AC${this.col}`;case _Q.CELL_REFERENCE_ABSOLUTE_ROW:return`${t}#${this.row}AR${this.col}`}}unparse(e){const t=this.toSimpleCellAddress(e);if(C4(t))return;const n=aZ(t.col),r=this.type===_Q.CELL_REFERENCE_ABSOLUTE||this.type===_Q.CELL_REFERENCE_ABSOLUTE_ROW?"$":"";return`${this.type===_Q.CELL_REFERENCE_ABSOLUTE||this.type===_Q.CELL_REFERENCE_ABSOLUTE_COL?"$":""}${n}${r}${t.row+1}`}exceedsSheetSizeLimits(e,t){return this.row>=t||this.col>=e}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */const FQ=":",DQ="$",VQ="A-Za-zÃ-Ê¯",UQ=`${VQ}0-9_.`,BQ=`[${VQ}0-9_]+`,WQ=`(${BQ}|'(((?!').|'')*)')!`,jQ=`(${WQ})?\\${DQ}?[A-Za-z]+\\${DQ}?[0-9]+`,GQ=`(${WQ})?\\${DQ}?[A-Za-z]+`,zQ=`(${WQ})?\\${DQ}?[0-9]+`,$Q="[rR][0-9]*[cC][0-9]*",YQ=`(${jQ})[^${UQ}]`,KQ=`[${VQ}_][${UQ}]*`,XQ=["0","1","2","3","4","5","6","7","8","9"],qQ=[...Array.from(Array(26)).map(((e,t)=>t+"A".charCodeAt(0))),...Array.from(Array(26)).map(((e,t)=>t+"a".charCodeAt(0))),...Array.from(Array(496)).map(((e,t)=>t+192))].map((e=>String.fromCharCode(e))),QQ=new RegExp(`^(${WQ})?(\\${DQ}?)([A-Za-z]+)(\\${DQ}?)([0-9]+)$`),ZQ=new RegExp(`^(${WQ})?(\\${DQ}?)([A-Za-z]+)$`),JQ=new RegExp(`^(${WQ})?(\\${DQ}?)([0-9]+)$`),eZ=new RegExp(`^${BQ}$`),tZ=(e,t,n)=>{const r=QQ.exec(t),i=sZ(r[6]);let o=hZ(r,e);if(void 0===o)return;null===o&&(o=void 0);const s=Number(r[8])-1;return r[5]===DQ&&r[7]===DQ?kQ.absolute(i,s,o):r[5]===DQ?kQ.absoluteCol(i,s-n.row,o):r[7]===DQ?kQ.absoluteRow(i-n.col,s,o):kQ.relative(i-n.col,s-n.row,o)},nZ=(e,t,n)=>{const r=ZQ.exec(t);let i=hZ(r,e);if(void 0===i)return;null===i&&(i=void 0);const o=sZ(r[6]);return r[5]===DQ?LQ.absolute(o,i):LQ.relative(o-n.col,i)},rZ=(e,t,n)=>{const r=JQ.exec(t);let i=hZ(r,e);if(void 0===i)return;null===i&&(i=void 0);const o=Number(r[6])-1;return r[5]===DQ?HQ.absolute(o,i):HQ.relative(o-n.row,i)},iZ=(e,t,n)=>{const r=QQ.exec(t);if(!r)return;const i=sZ(r[6]);let o=hZ(r,e);if(void 0===o)return;null===o&&(o=n);const s=Number(r[8])-1;return v4(o,i,s)},oZ=(e,t,n)=>{const r=aZ(t.col),i=lZ(t.sheet,e);if(void 0!==i)return n!==t.sheet?`${i}!${r}${t.row+1}`:`${r}${t.row+1}`};function sZ(e){return 1===e.length?e.toUpperCase().charCodeAt(0)-65:e.split("").reduce(((e,t)=>26*e+(t.toUpperCase().charCodeAt(0)-64)),0)-1}function aZ(e){let t="";for(;e>=0;)t=String.fromCharCode(e%26+97)+t,e=Math.floor(e/26)-1;return t.toUpperCase()}function lZ(e,t){let n=t(e);if(void 0!==n)return eZ.test(n)?n:(n=n.replace(/'/g,"''"),`'${n}'`)}function hZ(e,t){var n;let r=null!==(n=e[3])&&void 0!==n?n:e[2];return r?(r=r.replace(/''/g,"'"),t(r)):null}function uZ(e){return e&&0===e.length}function cZ(e){return null==e?[]:Object.keys(e)}function dZ(e){for(var t=[],n=Object.keys(e),r=0;r<n.length;r++)t.push(e[n[r]]);return t}function pZ(e,t){for(var n=[],r=0;r<e.length;r++)n.push(t.call(null,e[r],r));return n}function gZ(e){for(var t=[],n=0;n<e.length;n++){var r=e[n];Array.isArray(r)?t=t.concat(gZ(r)):t.push(r)}return t}function mZ(e){return uZ(e)?void 0:e[0]}function fZ(e){var t=e&&e.length;return t?e[t-1]:void 0}function wZ(e,t){if(Array.isArray(e))for(var n=0;n<e.length;n++)t.call(null,e[n],n);else{if(!kZ(e))throw Error("non exhaustive match");var r=cZ(e);for(n=0;n<r.length;n++){var i=r[n],o=e[i];t.call(null,o,i)}}}function yZ(e){return"string"==typeof e}function vZ(e){return void 0===e}function CZ(e){return e instanceof Function}function SZ(e,t){return void 0===t&&(t=1),e.slice(t,e.length)}function RZ(e,t){return void 0===t&&(t=1),e.slice(0,e.length-t)}function EZ(e,t){var n=[];if(Array.isArray(e))for(var r=0;r<e.length;r++){var i=e[r];t.call(null,i)&&n.push(i)}return n}function bZ(e,t){return EZ(e,(function(e){return!t(e)}))}function TZ(e,t){for(var n=Object.keys(e),r={},i=0;i<n.length;i++){var o=n[i],s=e[o];t(s)&&(r[o]=s)}return r}function NZ(e,t){return!!kZ(e)&&e.hasOwnProperty(t)}function AZ(e,t){return void 0!==OZ(e,(function(e){return e===t}))}function MZ(e){for(var t=[],n=0;n<e.length;n++)t.push(e[n]);return t}function IZ(e){var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}function OZ(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(t.call(null,r))return r}}function xZ(e,t,n){for(var r=Array.isArray(e),i=r?e:dZ(e),o=r?[]:cZ(e),s=n,a=0;a<i.length;a++)s=t.call(null,s,i[a],r?a:o[a]);return s}function PZ(e){return bZ(e,(function(e){return null==e}))}function _Z(e,t){void 0===t&&(t=function(e){return e});var n=[];return xZ(e,(function(e,r){var i=t(r);return AZ(n,i)?e:(n.push(i),e.concat(r))}),[])}function LZ(e){return Array.isArray(e)}function HZ(e){return e instanceof RegExp}function kZ(e){return e instanceof Object}function FZ(e,t){for(var n=0;n<e.length;n++)if(!t(e[n],n))return!1;return!0}function DZ(e,t){return bZ(e,(function(e){return AZ(t,e)}))}function VZ(e,t){for(var n=0;n<e.length;n++)if(t(e[n]))return!0;return!1}function UZ(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var r=0;r<t.length;r++)for(var i=t[r],o=cZ(i),s=0;s<o.length;s++){var a=o[s];e[a]=i[a]}return e}function BZ(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var r=0;r<t.length;r++){var i=t[r];if(!vZ(i))for(var o=cZ(i),s=0;s<o.length;s++){var a=o[s];NZ(e,a)||(e[a]=i[a])}}return e}function WZ(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return BZ.apply(null,[{}].concat(e))}function jZ(e,t){var n={};return wZ(e,(function(e){var r=t(e),i=n[r];i?i.push(e):n[r]=[e]})),n}function GZ(e,t){for(var n=IZ(e),r=cZ(t),i=0;i<r.length;i++){var o=r[i],s=t[o];n[o]=s}return n}function zZ(){}function $Z(e){return e}function YZ(e){console&&console.error&&console.error("Error: "+e)}function KZ(e){console&&console.warn&&console.warn("Warning: "+e)}function XZ(){return"function"==typeof Map}function qZ(e){function t(){}t.prototype=e;var n=new t;function r(){return typeof n.bar}return r(),r(),e}function QZ(e){return e[e.length-1]}function ZZ(e){var t=(new Date).getTime(),n=e();return{time:(new Date).getTime()-t,value:n}}var JZ={exports:{}};!function(e){var n,r;n="undefined"!=typeof self?self:t,r=function(){function e(){}e.prototype.saveState=function(){return{idx:this.idx,input:this.input,groupIdx:this.groupIdx}},e.prototype.restoreState=function(e){this.idx=e.idx,this.input=e.input,this.groupIdx=e.groupIdx},e.prototype.pattern=function(e){this.idx=0,this.input=e,this.groupIdx=0,this.consumeChar("/");var t=this.disjunction();this.consumeChar("/");for(var n={type:"Flags",global:!1,ignoreCase:!1,multiLine:!1,unicode:!1,sticky:!1};this.isRegExpFlag();)switch(this.popChar()){case"g":a(n,"global");break;case"i":a(n,"ignoreCase");break;case"m":a(n,"multiLine");break;case"u":a(n,"unicode");break;case"y":a(n,"sticky")}if(this.idx!==this.input.length)throw Error("Redundant input: "+this.input.substring(this.idx));return{type:"Pattern",flags:n,value:t}},e.prototype.disjunction=function(){var e=[];for(e.push(this.alternative());"|"===this.peekChar();)this.consumeChar("|"),e.push(this.alternative());return{type:"Disjunction",value:e}},e.prototype.alternative=function(){for(var e=[];this.isTerm();)e.push(this.term());return{type:"Alternative",value:e}},e.prototype.term=function(){return this.isAssertion()?this.assertion():this.atom()},e.prototype.assertion=function(){switch(this.popChar()){case"^":return{type:"StartAnchor"};case"$":return{type:"EndAnchor"};case"\\":switch(this.popChar()){case"b":return{type:"WordBoundary"};case"B":return{type:"NonWordBoundary"}}throw Error("Invalid Assertion Escape");case"(":var e;switch(this.consumeChar("?"),this.popChar()){case"=":e="Lookahead";break;case"!":e="NegativeLookahead"}l(e);var t=this.disjunction();return this.consumeChar(")"),{type:e,value:t}}!function(){throw Error("Internal Error - Should never get here!")}()},e.prototype.quantifier=function(e){var t;switch(this.popChar()){case"*":t={atLeast:0,atMost:1/0};break;case"+":t={atLeast:1,atMost:1/0};break;case"?":t={atLeast:0,atMost:1};break;case"{":var n=this.integerIncludingZero();switch(this.popChar()){case"}":t={atLeast:n,atMost:n};break;case",":t=this.isDigit()?{atLeast:n,atMost:this.integerIncludingZero()}:{atLeast:n,atMost:1/0},this.consumeChar("}")}if(!0===e&&void 0===t)return;l(t)}if(!0!==e||void 0!==t)return l(t),"?"===this.peekChar(0)?(this.consumeChar("?"),t.greedy=!1):t.greedy=!0,t.type="Quantifier",t},e.prototype.atom=function(){var e;switch(this.peekChar()){case".":e=this.dotAll();break;case"\\":e=this.atomEscape();break;case"[":e=this.characterClass();break;case"(":e=this.group()}return void 0===e&&this.isPatternCharacter()&&(e=this.patternCharacter()),l(e),this.isQuantifier()&&(e.quantifier=this.quantifier()),e},e.prototype.dotAll=function(){return this.consumeChar("."),{type:"Set",complement:!0,value:[o("\n"),o("\r"),o("\u2028"),o("\u2029")]}},e.prototype.atomEscape=function(){switch(this.consumeChar("\\"),this.peekChar()){case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":return this.decimalEscapeAtom();case"d":case"D":case"s":case"S":case"w":case"W":return this.characterClassEscape();case"f":case"n":case"r":case"t":case"v":return this.controlEscapeAtom();case"c":return this.controlLetterEscapeAtom();case"0":return this.nulCharacterAtom();case"x":return this.hexEscapeSequenceAtom();case"u":return this.regExpUnicodeEscapeSequenceAtom();default:return this.identityEscapeAtom()}},e.prototype.decimalEscapeAtom=function(){return{type:"GroupBackReference",value:this.positiveInteger()}},e.prototype.characterClassEscape=function(){var e,t=!1;switch(this.popChar()){case"d":e=h;break;case"D":e=h,t=!0;break;case"s":e=c;break;case"S":e=c,t=!0;break;case"w":e=u;break;case"W":e=u,t=!0}return l(e),{type:"Set",value:e,complement:t}},e.prototype.controlEscapeAtom=function(){var e;switch(this.popChar()){case"f":e=o("\f");break;case"n":e=o("\n");break;case"r":e=o("\r");break;case"t":e=o("\t");break;case"v":e=o("\v")}return l(e),{type:"Character",value:e}},e.prototype.controlLetterEscapeAtom=function(){this.consumeChar("c");var e=this.popChar();if(!1===/[a-zA-Z]/.test(e))throw Error("Invalid ");return{type:"Character",value:e.toUpperCase().charCodeAt(0)-64}},e.prototype.nulCharacterAtom=function(){return this.consumeChar("0"),{type:"Character",value:o("\0")}},e.prototype.hexEscapeSequenceAtom=function(){return this.consumeChar("x"),this.parseHexDigits(2)},e.prototype.regExpUnicodeEscapeSequenceAtom=function(){return this.consumeChar("u"),this.parseHexDigits(4)},e.prototype.identityEscapeAtom=function(){return{type:"Character",value:o(this.popChar())}},e.prototype.classPatternCharacterAtom=function(){switch(this.peekChar()){case"\n":case"\r":case"\u2028":case"\u2029":case"\\":case"]":throw Error("TBD");default:return{type:"Character",value:o(this.popChar())}}},e.prototype.characterClass=function(){var e=[],t=!1;for(this.consumeChar("["),"^"===this.peekChar(0)&&(this.consumeChar("^"),t=!0);this.isClassAtom();){var n=this.classAtom();if("Character"===n.type&&this.isRangeDash()){this.consumeChar("-");var r=this.classAtom();if("Character"===r.type){if(r.value<n.value)throw Error("Range out of order in character class");e.push({from:n.value,to:r.value})}else s(n.value,e),e.push(o("-")),s(r.value,e)}else s(n.value,e)}return this.consumeChar("]"),{type:"Set",complement:t,value:e}},e.prototype.classAtom=function(){switch(this.peekChar()){case"]":case"\n":case"\r":case"\u2028":case"\u2029":throw Error("TBD");case"\\":return this.classEscape();default:return this.classPatternCharacterAtom()}},e.prototype.classEscape=function(){switch(this.consumeChar("\\"),this.peekChar()){case"b":return this.consumeChar("b"),{type:"Character",value:o("\b")};case"d":case"D":case"s":case"S":case"w":case"W":return this.characterClassEscape();case"f":case"n":case"r":case"t":case"v":return this.controlEscapeAtom();case"c":return this.controlLetterEscapeAtom();case"0":return this.nulCharacterAtom();case"x":return this.hexEscapeSequenceAtom();case"u":return this.regExpUnicodeEscapeSequenceAtom();default:return this.identityEscapeAtom()}},e.prototype.group=function(){var e=!0;this.consumeChar("("),"?"===this.peekChar(0)?(this.consumeChar("?"),this.consumeChar(":"),e=!1):this.groupIdx++;var t=this.disjunction();this.consumeChar(")");var n={type:"Group",capturing:e,value:t};return e&&(n.idx=this.groupIdx),n},e.prototype.positiveInteger=function(){var e=this.popChar();if(!1===i.test(e))throw Error("Expecting a positive integer");for(;r.test(this.peekChar(0));)e+=this.popChar();return parseInt(e,10)},e.prototype.integerIncludingZero=function(){var e=this.popChar();if(!1===r.test(e))throw Error("Expecting an integer");for(;r.test(this.peekChar(0));)e+=this.popChar();return parseInt(e,10)},e.prototype.patternCharacter=function(){var e=this.popChar();switch(e){case"\n":case"\r":case"\u2028":case"\u2029":case"^":case"$":case"\\":case".":case"*":case"+":case"?":case"(":case")":case"[":case"|":throw Error("TBD");default:return{type:"Character",value:o(e)}}},e.prototype.isRegExpFlag=function(){switch(this.peekChar(0)){case"g":case"i":case"m":case"u":case"y":return!0;default:return!1}},e.prototype.isRangeDash=function(){return"-"===this.peekChar()&&this.isClassAtom(1)},e.prototype.isDigit=function(){return r.test(this.peekChar(0))},e.prototype.isClassAtom=function(e){switch(void 0===e&&(e=0),this.peekChar(e)){case"]":case"\n":case"\r":case"\u2028":case"\u2029":return!1;default:return!0}},e.prototype.isTerm=function(){return this.isAtom()||this.isAssertion()},e.prototype.isAtom=function(){if(this.isPatternCharacter())return!0;switch(this.peekChar(0)){case".":case"\\":case"[":case"(":return!0;default:return!1}},e.prototype.isAssertion=function(){switch(this.peekChar(0)){case"^":case"$":return!0;case"\\":switch(this.peekChar(1)){case"b":case"B":return!0;default:return!1}case"(":return"?"===this.peekChar(1)&&("="===this.peekChar(2)||"!"===this.peekChar(2));default:return!1}},e.prototype.isQuantifier=function(){var e=this.saveState();try{return void 0!==this.quantifier(!0)}catch(t){return!1}finally{this.restoreState(e)}},e.prototype.isPatternCharacter=function(){switch(this.peekChar()){case"^":case"$":case"\\":case".":case"*":case"+":case"?":case"(":case")":case"[":case"|":case"/":case"\n":case"\r":case"\u2028":case"\u2029":return!1;default:return!0}},e.prototype.parseHexDigits=function(e){for(var t="",r=0;r<e;r++){var i=this.popChar();if(!1===n.test(i))throw Error("Expecting a HexDecimal digits");t+=i}return{type:"Character",value:parseInt(t,16)}},e.prototype.peekChar=function(e){return void 0===e&&(e=0),this.input[this.idx+e]},e.prototype.popChar=function(){var e=this.peekChar(0);return this.consumeChar(),e},e.prototype.consumeChar=function(e){if(void 0!==e&&this.input[this.idx]!==e)throw Error("Expected: '"+e+"' but found: '"+this.input[this.idx]+"' at offset: "+this.idx);if(this.idx>=this.input.length)throw Error("Unexpected end of input");this.idx++};var t,n=/[0-9a-fA-F]/,r=/[0-9]/,i=/[1-9]/;function o(e){return e.charCodeAt(0)}function s(e,t){void 0!==e.length?e.forEach((function(e){t.push(e)})):t.push(e)}function a(e,t){if(!0===e[t])throw"duplicate flag "+t;e[t]=!0}function l(e){if(void 0===e)throw Error("Internal Error - Should never get here!")}var h=[];for(t=o("0");t<=o("9");t++)h.push(t);var u=[o("_")].concat(h);for(t=o("a");t<=o("z");t++)u.push(t);for(t=o("A");t<=o("Z");t++)u.push(t);var c=[o(" "),o("\f"),o("\n"),o("\r"),o("\t"),o("\v"),o("\t"),o("Â "),o("á"),o("â"),o("â"),o("â"),o("â"),o("â"),o("â"),o("â"),o("â"),o("â"),o("â"),o("â"),o("\u2028"),o("\u2029"),o("â¯"),o("â"),o("ã"),o("\ufeff")];function d(){}return d.prototype.visitChildren=function(e){for(var t in e){var n=e[t];e.hasOwnProperty(t)&&(void 0!==n.type?this.visit(n):Array.isArray(n)&&n.forEach((function(e){this.visit(e)}),this))}},d.prototype.visit=function(e){switch(e.type){case"Pattern":this.visitPattern(e);break;case"Flags":this.visitFlags(e);break;case"Disjunction":this.visitDisjunction(e);break;case"Alternative":this.visitAlternative(e);break;case"StartAnchor":this.visitStartAnchor(e);break;case"EndAnchor":this.visitEndAnchor(e);break;case"WordBoundary":this.visitWordBoundary(e);break;case"NonWordBoundary":this.visitNonWordBoundary(e);break;case"Lookahead":this.visitLookahead(e);break;case"NegativeLookahead":this.visitNegativeLookahead(e);break;case"Character":this.visitCharacter(e);break;case"Set":this.visitSet(e);break;case"Group":this.visitGroup(e);break;case"GroupBackReference":this.visitGroupBackReference(e);break;case"Quantifier":this.visitQuantifier(e)}this.visitChildren(e)},d.prototype.visitPattern=function(e){},d.prototype.visitFlags=function(e){},d.prototype.visitDisjunction=function(e){},d.prototype.visitAlternative=function(e){},d.prototype.visitStartAnchor=function(e){},d.prototype.visitEndAnchor=function(e){},d.prototype.visitWordBoundary=function(e){},d.prototype.visitNonWordBoundary=function(e){},d.prototype.visitLookahead=function(e){},d.prototype.visitNegativeLookahead=function(e){},d.prototype.visitCharacter=function(e){},d.prototype.visitSet=function(e){},d.prototype.visitGroup=function(e){},d.prototype.visitGroupBackReference=function(e){},d.prototype.visitQuantifier=function(e){},{RegExpParser:e,BaseRegExpVisitor:d,VERSION:"0.4.0"}},e.exports?e.exports=r():n.regexpToAst=r()}(JZ);var eJ=JZ.exports,tJ={},nJ=new eJ.RegExpParser;function rJ(e){var t=e.toString();if(tJ.hasOwnProperty(t))return tJ[t];var n=nJ.pattern(t);return tJ[t]=n,n}var iJ,oJ=(iJ=function(e,t){return iJ=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},iJ(e,t)},function(e,t){function n(){this.constructor=e}iJ(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),sJ="Complement Sets are not supported for first char optimization",aJ='Unable to use "first char" lexer optimizations:\n';function lJ(e,t){void 0===t&&(t=!1);try{var n=rJ(e);return hJ(n.value,{},n.flags.ignoreCase)}catch(i){if(i.message===sJ)t&&KZ(aJ+"\tUnable to optimize: < "+e.toString()+" >\n\tComplement Sets cannot be automatically optimized.\n\tThis will disable the lexer's first char optimizations.\n\tSee: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#COMPLEMENT for details.");else{var r="";t&&(r="\n\tThis will disable the lexer's first char optimizations.\n\tSee: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#REGEXP_PARSING for details."),YZ(aJ+"\n\tFailed parsing: < "+e.toString()+" >\n\tUsing the regexp-to-ast library version: "+eJ.VERSION+"\n\tPlease open an issue at: https://github.com/bd82/regexp-to-ast/issues"+r)}}return[]}function hJ(e,t,n){switch(e.type){case"Disjunction":for(var r=0;r<e.value.length;r++)hJ(e.value[r],t,n);break;case"Alternative":var i=e.value;for(r=0;r<i.length;r++){var o=i[r];switch(o.type){case"EndAnchor":case"GroupBackReference":case"Lookahead":case"NegativeLookahead":case"StartAnchor":case"WordBoundary":case"NonWordBoundary":continue}var s=o;switch(s.type){case"Character":uJ(s.value,t,n);break;case"Set":if(!0===s.complement)throw Error(sJ);wZ(s.value,(function(e){if("number"==typeof e)uJ(e,t,n);else{var r=e;if(!0===n)for(var i=r.from;i<=r.to;i++)uJ(i,t,n);else{for(i=r.from;i<=r.to&&i<_J;i++)uJ(i,t,n);if(r.to>=_J)for(var o=r.from>=_J?r.from:_J,s=r.to,a=LJ(o),l=LJ(s),h=a;h<=l;h++)t[h]=h}}}));break;case"Group":hJ(s.value,t,n);break;default:throw Error("Non Exhaustive Match")}var a=void 0!==s.quantifier&&0===s.quantifier.atLeast;if("Group"===s.type&&!1===dJ(s)||"Group"!==s.type&&!1===a)break}break;default:throw Error("non exhaustive match!")}return dZ(t)}function uJ(e,t,n){var r=LJ(e);t[r]=r,!0===n&&function(e,t){var n=String.fromCharCode(e),r=n.toUpperCase();if(r!==n){t[i=LJ(r.charCodeAt(0))]=i}else{var i,o=n.toLowerCase();if(o!==n)t[i=LJ(o.charCodeAt(0))]=i}}(e,t)}function cJ(e,t){return OZ(e.value,(function(e){if("number"==typeof e)return AZ(t,e);var n=e;return void 0!==OZ(t,(function(e){return n.from<=e&&e<=n.to}))}))}function dJ(e){return!(!e.quantifier||0!==e.quantifier.atLeast)||!!e.value&&(LZ(e.value)?FZ(e.value,dJ):dJ(e.value))}var pJ=function(e){function t(t){var n=e.call(this)||this;return n.targetCharCodes=t,n.found=!1,n}return oJ(t,e),t.prototype.visitChildren=function(t){if(!0!==this.found){switch(t.type){case"Lookahead":return void this.visitLookahead(t);case"NegativeLookahead":return void this.visitNegativeLookahead(t)}e.prototype.visitChildren.call(this,t)}},t.prototype.visitCharacter=function(e){AZ(this.targetCharCodes,e.value)&&(this.found=!0)},t.prototype.visitSet=function(e){e.complement?void 0===cJ(e,this.targetCharCodes)&&(this.found=!0):void 0!==cJ(e,this.targetCharCodes)&&(this.found=!0)},t}(eJ.BaseRegExpVisitor);function gJ(e,t){if(t instanceof RegExp){var n=rJ(t),r=new pJ(e);return r.visit(n),r.found}return void 0!==OZ(t,(function(t){return AZ(e,t.charCodeAt(0))}))}var mJ=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),fJ="PATTERN",wJ="defaultMode",yJ="modes",vJ="boolean"==typeof new RegExp("(?:)").sticky;function CJ(e,t){var n,r=(t=WZ(t,{useSticky:vJ,debug:!1,safeMode:!1,positionTracking:"full",lineTerminatorCharacters:["\r","\n"],tracer:function(e,t){return t()}})).tracer;r("initCharCodeToOptimizedIndexMap",(function(){!function(){if(uZ(HJ)){HJ=new Array(65536);for(var e=0;e<65536;e++)HJ[e]=e>255?255+~~(e/255):e}}()})),r("Reject Lexer.NA",(function(){n=bZ(e,(function(e){return e[fJ]===YJ.NA}))}));var i,o,s,a,l,h,u,c,d,p,g,m=!1;r("Transform Patterns",(function(){m=!1,i=pZ(n,(function(e){var n=e[fJ];if(HZ(n)){var r=n.source;return 1===r.length&&"^"!==r&&"$"!==r&&"."!==r?r:2!==r.length||"\\"!==r[0]||AZ(["d","D","s","S","t","r","n","t","0","c","b","B","f","v","w","W"],r[1])?t.useSticky?TJ(n):bJ(n):r[1]}if(CZ(n))return m=!0,{exec:n};if(NZ(n,"exec"))return m=!0,n;if("string"==typeof n){if(1===n.length)return n;var i=n.replace(/[\\^$.*+?()[\]{}|]/g,"\\$&"),o=new RegExp(i);return t.useSticky?TJ(o):bJ(o)}throw Error("non exhaustive match")}))})),r("misc mapping",(function(){o=pZ(n,(function(e){return e.tokenTypeIdx})),s=pZ(n,(function(e){var t=e.GROUP;if(t!==YJ.SKIPPED){if(yZ(t))return t;if(vZ(t))return!1;throw Error("non exhaustive match")}})),a=pZ(n,(function(e){var t=e.LONGER_ALT;if(t)return function(e,t){for(var n=0;n<e.length;n++)if(e[n]===t)return n;return-1}(n,t)})),l=pZ(n,(function(e){return e.PUSH_MODE})),h=pZ(n,(function(e){return NZ(e,"POP_MODE")}))})),r("Line Terminator Handling",(function(){var e=xJ(t.lineTerminatorCharacters);u=pZ(n,(function(e){return!1})),"onlyOffset"!==t.positionTracking&&(u=pZ(n,(function(t){return NZ(t,"LINE_BREAKS")?t.LINE_BREAKS:!1===OJ(t,e)?gJ(e,t.PATTERN):void 0})))})),r("Misc Mapping #2",(function(){c=pZ(n,AJ),d=pZ(i,MJ),p=xZ(n,(function(e,t){var n=t.GROUP;return yZ(n)&&n!==YJ.SKIPPED&&(e[n]=[]),e}),{}),g=pZ(i,(function(e,t){return{pattern:i[t],longerAlt:a[t],canLineTerminator:u[t],isCustom:c[t],short:d[t],group:s[t],push:l[t],pop:h[t],tokenTypeIdx:o[t],tokenType:n[t]}}))}));var f=!0,w=[];return t.safeMode||r("First Char Optimization",(function(){w=xZ(n,(function(e,n,r){if("string"==typeof n.PATTERN){var i=LJ(n.PATTERN.charCodeAt(0));PJ(e,i,g[r])}else if(LZ(n.START_CHARS_HINT)){var o;wZ(n.START_CHARS_HINT,(function(t){var n=LJ("string"==typeof t?t.charCodeAt(0):t);o!==n&&(o=n,PJ(e,n,g[r]))}))}else if(HZ(n.PATTERN))if(n.PATTERN.unicode)f=!1,t.ensureOptimizations&&YZ(aJ+"\tUnable to analyze < "+n.PATTERN.toString()+" > pattern.\n\tThe regexp unicode flag is not currently supported by the regexp-to-ast library.\n\tThis will disable the lexer's first char optimizations.\n\tFor details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#UNICODE_OPTIMIZE");else{var s=lJ(n.PATTERN,t.ensureOptimizations);uZ(s)&&(f=!1),wZ(s,(function(t){PJ(e,t,g[r])}))}else t.ensureOptimizations&&YZ(aJ+"\tTokenType: <"+n.name+"> is using a custom token pattern without providing <start_chars_hint> parameter.\n\tThis will disable the lexer's first char optimizations.\n\tFor details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#CUSTOM_OPTIMIZE"),f=!1;return e}),[])})),r("ArrayPacking",(function(){w=function(e){for(var t=[],n=0;n<e.length;n++){var r=e[n];t.push(void 0!==r?r:void 0)}return t}(w)})),{emptyGroups:p,patternIdxToConfig:g,charCodeToPatternIdxToConfig:w,hasCustom:m,canBeOptimized:f}}function SJ(e,t){var n=[],r=function(e){var t=EZ(e,(function(e){return!NZ(e,fJ)})),n=pZ(t,(function(e){return{message:"Token Type: ->"+e.name+"<- missing static 'PATTERN' property",type:zJ.MISSING_PATTERN,tokenTypes:[e]}})),r=DZ(e,t);return{errors:n,valid:r}}(e);n=n.concat(r.errors);var i=function(e){var t=EZ(e,(function(e){var t=e[fJ];return!(HZ(t)||CZ(t)||NZ(t,"exec")||yZ(t))})),n=pZ(t,(function(e){return{message:"Token Type: ->"+e.name+"<- static 'PATTERN' can only be a RegExp, a Function matching the {CustomPatternMatcherFunc} type or an Object matching the {ICustomPattern} interface.",type:zJ.INVALID_PATTERN,tokenTypes:[e]}})),r=DZ(e,t);return{errors:n,valid:r}}(r.valid),o=i.valid;return n=(n=n.concat(i.errors)).concat(function(e){var t=[],n=EZ(e,(function(e){return HZ(e[fJ])}));return t=t.concat(function(e){var t=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.found=!1,t}return mJ(t,e),t.prototype.visitEndAnchor=function(e){this.found=!0},t}(eJ.BaseRegExpVisitor),n=EZ(e,(function(e){var n=e[fJ];try{var r=rJ(n),i=new t;return i.visit(r),i.found}catch(o){return RJ.test(n.source)}})),r=pZ(n,(function(e){return{message:"Unexpected RegExp Anchor Error:\n\tToken Type: ->"+e.name+"<- static 'PATTERN' cannot contain end of input anchor '$'\n\tSee sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#ANCHORS\tfor details.",type:zJ.EOI_ANCHOR_FOUND,tokenTypes:[e]}}));return r}(n)),t=t.concat(function(e){var t=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.found=!1,t}return mJ(t,e),t.prototype.visitStartAnchor=function(e){this.found=!0},t}(eJ.BaseRegExpVisitor),n=EZ(e,(function(e){var n=e[fJ];try{var r=rJ(n),i=new t;return i.visit(r),i.found}catch(o){return EJ.test(n.source)}})),r=pZ(n,(function(e){return{message:"Unexpected RegExp Anchor Error:\n\tToken Type: ->"+e.name+"<- static 'PATTERN' cannot contain start of input anchor '^'\n\tSee https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#ANCHORS\tfor details.",type:zJ.SOI_ANCHOR_FOUND,tokenTypes:[e]}}));return r}(n)),t=t.concat(function(e){var t=EZ(e,(function(e){var t=e[fJ];return t instanceof RegExp&&(t.multiline||t.global)})),n=pZ(t,(function(e){return{message:"Token Type: ->"+e.name+"<- static 'PATTERN' may NOT contain global('g') or multiline('m')",type:zJ.UNSUPPORTED_FLAGS_FOUND,tokenTypes:[e]}}));return n}(n)),t=t.concat(function(e){var t=[],n=pZ(e,(function(n){return xZ(e,(function(e,r){return n.PATTERN.source!==r.PATTERN.source||AZ(t,r)||r.PATTERN===YJ.NA||(t.push(r),e.push(r)),e}),[])})),r=pZ(EZ(n=PZ(n),(function(e){return e.length>1})),(function(e){var t=pZ(e,(function(e){return e.name}));return{message:"The same RegExp pattern ->"+mZ(e).PATTERN+"<-has been used in all of the following Token Types: "+t.join(", ")+" <-",type:zJ.DUPLICATE_PATTERNS_FOUND,tokenTypes:e}}));return r}(n)),t=t.concat(function(e){var t=EZ(e,(function(e){return e[fJ].test("")})),n=pZ(t,(function(e){return{message:"Token Type: ->"+e.name+"<- static 'PATTERN' must not match an empty string",type:zJ.EMPTY_MATCH_PATTERN,tokenTypes:[e]}}));return n}(n)),t}(o)),n=n.concat(function(e){var t=EZ(e,(function(e){if(!NZ(e,"GROUP"))return!1;var t=e.GROUP;return t!==YJ.SKIPPED&&t!==YJ.NA&&!yZ(t)})),n=pZ(t,(function(e){return{message:"Token Type: ->"+e.name+"<- static 'GROUP' can only be Lexer.SKIPPED/Lexer.NA/A String",type:zJ.INVALID_GROUP_TYPE_FOUND,tokenTypes:[e]}}));return n}(o)),n=n.concat(function(e,t){var n=EZ(e,(function(e){return void 0!==e.PUSH_MODE&&!AZ(t,e.PUSH_MODE)})),r=pZ(n,(function(e){return{message:"Token Type: ->"+e.name+"<- static 'PUSH_MODE' value cannot refer to a Lexer Mode ->"+e.PUSH_MODE+"<-which does not exist",type:zJ.PUSH_MODE_DOES_NOT_EXIST,tokenTypes:[e]}}));return r}(o,t)),n=n.concat(function(e){var t=[],n=xZ(e,(function(e,t,n){var r,i=t.PATTERN;return i===YJ.NA||(yZ(i)?e.push({str:i,idx:n,tokenType:t}):HZ(i)&&(r=i,void 0===OZ([".","\\","[","]","|","^","$","(",")","?","*","+","{"],(function(e){return-1!==r.source.indexOf(e)})))&&e.push({str:i.source,idx:n,tokenType:t})),e}),[]);return wZ(e,(function(e,r){wZ(n,(function(n){var i=n.str,o=n.idx,s=n.tokenType;if(r<o&&function(e,t){if(HZ(t)){var n=t.exec(e);return null!==n&&0===n.index}if(CZ(t))return t(e,0,[],{});if(NZ(t,"exec"))return t.exec(e,0,[],{});if("string"==typeof t)return t===e;throw Error("non exhaustive match")}(i,e.PATTERN)){var a="Token: ->"+s.name+"<- can never be matched.\nBecause it appears AFTER the Token Type ->"+e.name+"<-in the lexer's definition.\nSee https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#UNREACHABLE";t.push({message:a,type:zJ.UNREACHABLE_PATTERN,tokenTypes:[e,s]})}}))})),t}(o)),n}var RJ=/[^\\][\$]/;var EJ=/[^\\[][\^]|^\^/;function bJ(e){var t=e.ignoreCase?"i":"";return new RegExp("^(?:"+e.source+")",t)}function TJ(e){var t=e.ignoreCase?"iy":"y";return new RegExp(""+e.source,t)}function NJ(e,t,n){var r=[],i=!1,o=bZ(PZ(gZ(function(e,t){for(var n=[],r=cZ(e),i=0;i<r.length;i++){var o=r[i];n.push(t.call(null,e[o],o))}return n}(e.modes,(function(e){return e})))),(function(e){return e[fJ]===YJ.NA})),s=xJ(n);return t&&wZ(o,(function(e){var t=OJ(e,s);if(!1!==t){var n=function(e,t){if(t.issue===zJ.IDENTIFY_TERMINATOR)return"Warning: unable to identify line terminator usage in pattern.\n\tThe problem is in the <"+e.name+"> Token Type\n\t Root cause: "+t.errMsg+".\n\tFor details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#IDENTIFY_TERMINATOR";if(t.issue===zJ.CUSTOM_LINE_BREAK)return"Warning: A Custom Token Pattern should specify the <line_breaks> option.\n\tThe problem is in the <"+e.name+"> Token Type\n\tFor details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#CUSTOM_LINE_BREAK";throw Error("non exhaustive match")}(e,t),o={message:n,type:t.issue,tokenType:e};r.push(o)}else NZ(e,"LINE_BREAKS")?!0===e.LINE_BREAKS&&(i=!0):gJ(s,e.PATTERN)&&(i=!0)})),t&&!i&&r.push({message:"Warning: No LINE_BREAKS Found.\n\tThis Lexer has been defined to track line and column information,\n\tBut none of the Token Types can be identified as matching a line terminator.\n\tSee https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#LINE_BREAKS \n\tfor details.",type:zJ.NO_LINE_BREAKS_FLAGS}),r}function AJ(e){var t=e.PATTERN;if(HZ(t))return!1;if(CZ(t))return!0;if(NZ(t,"exec"))return!0;if(yZ(t))return!1;throw Error("non exhaustive match")}function MJ(e){return!(!yZ(e)||1!==e.length)&&e.charCodeAt(0)}var IJ={test:function(e){for(var t=e.length,n=this.lastIndex;n<t;n++){var r=e.charCodeAt(n);if(10===r)return this.lastIndex=n+1,!0;if(13===r)return 10===e.charCodeAt(n+1)?this.lastIndex=n+2:this.lastIndex=n+1,!0}return!1},lastIndex:0};function OJ(e,t){if(NZ(e,"LINE_BREAKS"))return!1;if(HZ(e.PATTERN)){try{gJ(t,e.PATTERN)}catch(n){return{issue:zJ.IDENTIFY_TERMINATOR,errMsg:n.message}}return!1}if(yZ(e.PATTERN))return!1;if(AJ(e))return{issue:zJ.CUSTOM_LINE_BREAK};throw Error("non exhaustive match")}function xJ(e){return pZ(e,(function(e){return yZ(e)&&e.length>0?e.charCodeAt(0):e}))}function PJ(e,t,n){void 0===e[t]?e[t]=[n]:e[t].push(n)}var _J=256;function LJ(e){return e<_J?e:HJ[e]}var HJ=[];function kJ(e,t){var n=e.tokenTypeIdx;return n===t.tokenTypeIdx||!0===t.isParent&&!0===t.categoryMatchesMap[n]}function FJ(e,t){return e.tokenTypeIdx===t.tokenTypeIdx}var DJ=1,VJ={};function UJ(e){var t=function(e){var t=MZ(e),n=e,r=!0;for(;r;){var i=DZ(n=PZ(gZ(pZ(n,(function(e){return e.CATEGORIES})))),t);t=t.concat(i),uZ(i)?r=!1:n=i}return t}(e);!function(e){wZ(e,(function(e){WJ(e)||(VJ[DJ]=e,e.tokenTypeIdx=DJ++),jJ(e)&&!LZ(e.CATEGORIES)&&(e.CATEGORIES=[e.CATEGORIES]),jJ(e)||(e.CATEGORIES=[]),NZ(e,"categoryMatches")||(e.categoryMatches=[]),function(e){return NZ(e,"categoryMatchesMap")}(e)||(e.categoryMatchesMap={})}))}(t),function(e){wZ(e,(function(e){BJ([],e)}))}(t),function(e){wZ(e,(function(e){e.categoryMatches=[],wZ(e.categoryMatchesMap,(function(t,n){e.categoryMatches.push(VJ[n].tokenTypeIdx)}))}))}(t),wZ(t,(function(e){e.isParent=e.categoryMatches.length>0}))}function BJ(e,t){wZ(e,(function(e){t.categoryMatchesMap[e.tokenTypeIdx]=!0})),wZ(t.CATEGORIES,(function(n){var r=e.concat(t);AZ(r,n)||BJ(r,n)}))}function WJ(e){return NZ(e,"tokenTypeIdx")}function jJ(e){return NZ(e,"CATEGORIES")}function GJ(e){return NZ(e,"tokenTypeIdx")}var zJ;!function(e){e[e.MISSING_PATTERN=0]="MISSING_PATTERN",e[e.INVALID_PATTERN=1]="INVALID_PATTERN",e[e.EOI_ANCHOR_FOUND=2]="EOI_ANCHOR_FOUND",e[e.UNSUPPORTED_FLAGS_FOUND=3]="UNSUPPORTED_FLAGS_FOUND",e[e.DUPLICATE_PATTERNS_FOUND=4]="DUPLICATE_PATTERNS_FOUND",e[e.INVALID_GROUP_TYPE_FOUND=5]="INVALID_GROUP_TYPE_FOUND",e[e.PUSH_MODE_DOES_NOT_EXIST=6]="PUSH_MODE_DOES_NOT_EXIST",e[e.MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE=7]="MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE",e[e.MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY=8]="MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY",e[e.MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST=9]="MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST",e[e.LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED=10]="LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED",e[e.SOI_ANCHOR_FOUND=11]="SOI_ANCHOR_FOUND",e[e.EMPTY_MATCH_PATTERN=12]="EMPTY_MATCH_PATTERN",e[e.NO_LINE_BREAKS_FLAGS=13]="NO_LINE_BREAKS_FLAGS",e[e.UNREACHABLE_PATTERN=14]="UNREACHABLE_PATTERN",e[e.IDENTIFY_TERMINATOR=15]="IDENTIFY_TERMINATOR",e[e.CUSTOM_LINE_BREAK=16]="CUSTOM_LINE_BREAK"}(zJ||(zJ={}));var $J={deferDefinitionErrorsHandling:!1,positionTracking:"full",lineTerminatorsPattern:/\n|\r\n?/g,lineTerminatorCharacters:["\n","\r"],ensureOptimizations:!1,safeMode:!1,errorMessageProvider:{buildUnableToPopLexerModeMessage:function(e){return"Unable to pop Lexer Mode after encountering Token ->"+e.image+"<- The Mode Stack is empty"},buildUnexpectedCharactersMessage:function(e,t,n,r,i){return"unexpected character: ->"+e.charAt(t)+"<- at offset: "+t+", skipped "+n+" characters."}},traceInitPerf:!1,skipValidations:!1};Object.freeze($J);var YJ=function(){function e(e,t){var n=this;if(void 0===t&&(t=$J),this.lexerDefinition=e,this.lexerDefinitionErrors=[],this.lexerDefinitionWarning=[],this.patternIdxToConfig={},this.charCodeToPatternIdxToConfig={},this.modes=[],this.emptyGroups={},this.config=void 0,this.trackStartLines=!0,this.trackEndLines=!0,this.hasCustom=!1,this.canModeBeOptimized={},"boolean"==typeof t)throw Error("The second argument to the Lexer constructor is now an ILexerConfig Object.\na boolean 2nd argument is no longer supported");this.config=GZ($J,t);var r=this.config.traceInitPerf;!0===r?(this.traceInitMaxIdent=1/0,this.traceInitPerf=!0):"number"==typeof r&&(this.traceInitMaxIdent=r,this.traceInitPerf=!0),this.traceInitIndent=-1,this.TRACE_INIT("Lexer Constructor",(function(){var r,i=!0;n.TRACE_INIT("Lexer Config handling",(function(){if(n.config.lineTerminatorsPattern===$J.lineTerminatorsPattern)n.config.lineTerminatorsPattern=IJ;else if(n.config.lineTerminatorCharacters===$J.lineTerminatorCharacters)throw Error("Error: Missing <lineTerminatorCharacters> property on the Lexer config.\n\tFor details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#MISSING_LINE_TERM_CHARS");if(t.safeMode&&t.ensureOptimizations)throw Error('"safeMode" and "ensureOptimizations" flags are mutually exclusive.');n.trackStartLines=/full|onlyStart/i.test(n.config.positionTracking),n.trackEndLines=/full/i.test(n.config.positionTracking),LZ(e)?((r={modes:{}}).modes[wJ]=MZ(e),r[wJ]=wJ):(i=!1,r=IZ(e))})),!1===n.config.skipValidations&&(n.TRACE_INIT("performRuntimeChecks",(function(){n.lexerDefinitionErrors=n.lexerDefinitionErrors.concat(function(e){var t=[];return NZ(e,wJ)||t.push({message:"A MultiMode Lexer cannot be initialized without a <"+wJ+"> property in its definition\n",type:zJ.MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE}),NZ(e,yJ)||t.push({message:"A MultiMode Lexer cannot be initialized without a <modes> property in its definition\n",type:zJ.MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY}),NZ(e,yJ)&&NZ(e,wJ)&&!NZ(e.modes,e.defaultMode)&&t.push({message:"A MultiMode Lexer cannot be initialized with a "+wJ+": <"+e.defaultMode+">which does not exist\n",type:zJ.MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST}),NZ(e,yJ)&&wZ(e.modes,(function(e,n){wZ(e,(function(e,r){vZ(e)&&t.push({message:"A Lexer cannot be initialized using an undefined Token Type. Mode:<"+n+"> at index: <"+r+">\n",type:zJ.LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED})}))})),t}(r,n.trackStartLines,n.config.lineTerminatorCharacters))})),n.TRACE_INIT("performWarningRuntimeChecks",(function(){n.lexerDefinitionWarning=n.lexerDefinitionWarning.concat(NJ(r,n.trackStartLines,n.config.lineTerminatorCharacters))}))),r.modes=r.modes?r.modes:{},wZ(r.modes,(function(e,t){r.modes[t]=bZ(e,(function(e){return vZ(e)}))}));var o=cZ(r.modes);if(wZ(r.modes,(function(e,r){n.TRACE_INIT("Mode: <"+r+"> processing",(function(){var i;(n.modes.push(r),!1===n.config.skipValidations&&n.TRACE_INIT("validatePatterns",(function(){n.lexerDefinitionErrors=n.lexerDefinitionErrors.concat(SJ(e,o))})),uZ(n.lexerDefinitionErrors))&&(UJ(e),n.TRACE_INIT("analyzeTokenTypes",(function(){i=CJ(e,{lineTerminatorCharacters:n.config.lineTerminatorCharacters,positionTracking:t.positionTracking,ensureOptimizations:t.ensureOptimizations,safeMode:t.safeMode,tracer:n.TRACE_INIT.bind(n)})})),n.patternIdxToConfig[r]=i.patternIdxToConfig,n.charCodeToPatternIdxToConfig[r]=i.charCodeToPatternIdxToConfig,n.emptyGroups=GZ(n.emptyGroups,i.emptyGroups),n.hasCustom=i.hasCustom||n.hasCustom,n.canModeBeOptimized[r]=i.canBeOptimized)}))})),n.defaultMode=r.defaultMode,!uZ(n.lexerDefinitionErrors)&&!n.config.deferDefinitionErrorsHandling){var s=pZ(n.lexerDefinitionErrors,(function(e){return e.message})),a=s.join("-----------------------\n");throw new Error("Errors detected in definition of Lexer:\n"+a)}wZ(n.lexerDefinitionWarning,(function(e){KZ(e.message)})),n.TRACE_INIT("Choosing sub-methods implementations",(function(){if(vJ?(n.chopInput=$Z,n.match=n.matchWithTest):(n.updateLastIndex=zZ,n.match=n.matchWithExec),i&&(n.handleModes=zZ),!1===n.trackStartLines&&(n.computeNewColumn=$Z),!1===n.trackEndLines&&(n.updateTokenEndLineColumnLocation=zZ),/full/i.test(n.config.positionTracking))n.createTokenInstance=n.createFullToken;else if(/onlyStart/i.test(n.config.positionTracking))n.createTokenInstance=n.createStartOnlyToken;else{if(!/onlyOffset/i.test(n.config.positionTracking))throw Error('Invalid <positionTracking> config option: "'+n.config.positionTracking+'"');n.createTokenInstance=n.createOffsetOnlyToken}n.hasCustom?(n.addToken=n.addTokenUsingPush,n.handlePayload=n.handlePayloadWithCustom):(n.addToken=n.addTokenUsingMemberAccess,n.handlePayload=n.handlePayloadNoCustom)})),n.TRACE_INIT("Failed Optimization Warnings",(function(){var e=xZ(n.canModeBeOptimized,(function(e,t,n){return!1===t&&e.push(n),e}),[]);if(t.ensureOptimizations&&!uZ(e))throw Error("Lexer Modes: < "+e.join(", ")+' > cannot be optimized.\n\t Disable the "ensureOptimizations" lexer config flag to silently ignore this and run the lexer in an un-optimized mode.\n\t Or inspect the console log for details on how to resolve these issues.')})),n.TRACE_INIT("clearRegExpParserCache",(function(){tJ={}})),n.TRACE_INIT("toFastProperties",(function(){qZ(n)}))}))}return e.prototype.tokenize=function(e,t){if(void 0===t&&(t=this.defaultMode),!uZ(this.lexerDefinitionErrors)){var n=pZ(this.lexerDefinitionErrors,(function(e){return e.message})),r=n.join("-----------------------\n");throw new Error("Unable to Tokenize because Errors detected in definition of Lexer:\n"+r)}return this.tokenizeInternal(e,t)},e.prototype.tokenizeInternal=function(e,t){var n,r,i,o,s,a,l,h,u,c,d,p,g,m,f,w,y=this,v=e,C=v.length,S=0,R=0,E=this.hasCustom?0:Math.floor(e.length/10),b=new Array(E),T=[],N=this.trackStartLines?1:void 0,A=this.trackStartLines?1:void 0,M=(f=this.emptyGroups,w={},wZ(cZ(f),(function(e){if(!LZ(f[e]))throw Error("non exhaustive match");w[e]=[]})),w),I=this.trackStartLines,O=this.config.lineTerminatorsPattern,x=0,P=[],_=[],L=[],H=[];Object.freeze(H);var k=void 0;function F(){return P}function D(e){var t=LJ(e),n=_[t];return void 0===n?H:n}var V,U=function(e){if(1===L.length&&void 0===e.tokenType.PUSH_MODE){var t=y.config.errorMessageProvider.buildUnableToPopLexerModeMessage(e);T.push({offset:e.startOffset,line:void 0!==e.startLine?e.startLine:void 0,column:void 0!==e.startColumn?e.startColumn:void 0,length:e.image.length,message:t})}else{L.pop();var n=fZ(L);P=y.patternIdxToConfig[n],_=y.charCodeToPatternIdxToConfig[n],x=P.length;var r=y.canModeBeOptimized[n]&&!1===y.config.safeMode;k=_&&r?D:F}};function B(e){L.push(e),_=this.charCodeToPatternIdxToConfig[e],P=this.patternIdxToConfig[e],x=P.length,x=P.length;var t=this.canModeBeOptimized[e]&&!1===this.config.safeMode;k=_&&t?D:F}for(B.call(this,t);S<C;){s=null;var W=v.charCodeAt(S),j=k(W),G=j.length;for(n=0;n<G;n++){var z=(V=j[n]).pattern;if(a=null,!1!==(te=V.short)?W===te&&(s=z):!0===V.isCustom?null!==(m=z.exec(v,S,b,M))?(s=m[0],void 0!==m.payload&&(a=m.payload)):s=null:(this.updateLastIndex(z,S),s=this.match(z,e,S)),null!==s){if(void 0!==(o=V.longerAlt)){var $=P[o],Y=$.pattern;l=null,!0===$.isCustom?null!==(m=Y.exec(v,S,b,M))?(i=m[0],void 0!==m.payload&&(l=m.payload)):i=null:(this.updateLastIndex(Y,S),i=this.match(Y,e,S)),i&&i.length>s.length&&(s=i,a=l,V=$)}break}}if(null!==s){if(h=s.length,void 0!==(u=V.group)&&(c=V.tokenTypeIdx,d=this.createTokenInstance(s,S,c,V.tokenType,N,A,h),this.handlePayload(d,a),!1===u?R=this.addToken(b,R,d):M[u].push(d)),e=this.chopInput(e,h),S+=h,A=this.computeNewColumn(A,h),!0===I&&!0===V.canLineTerminator){var K=0,X=void 0,q=void 0;O.lastIndex=0;do{!0===(X=O.test(s))&&(q=O.lastIndex-1,K++)}while(!0===X);0!==K&&(N+=K,A=h-q,this.updateTokenEndLineColumnLocation(d,u,q,K,N,A,h))}this.handleModes(V,U,B,d)}else{for(var Q=S,Z=N,J=A,ee=!1;!ee&&S<C;)for(v.charCodeAt(S),e=this.chopInput(e,1),S++,r=0;r<x;r++){var te,ne=P[r];z=ne.pattern;if(!1!==(te=ne.short)?v.charCodeAt(S)===te&&(ee=!0):!0===ne.isCustom?ee=null!==z.exec(v,S,b,M):(this.updateLastIndex(z,S),ee=null!==z.exec(e)),!0===ee)break}p=S-Q,g=this.config.errorMessageProvider.buildUnexpectedCharactersMessage(v,Q,p,Z,J),T.push({offset:Q,line:Z,column:J,length:p,message:g})}}return this.hasCustom||(b.length=R),{tokens:b,groups:M,errors:T}},e.prototype.handleModes=function(e,t,n,r){if(!0===e.pop){var i=e.push;t(r),void 0!==i&&n.call(this,i)}else void 0!==e.push&&n.call(this,e.push)},e.prototype.chopInput=function(e,t){return e.substring(t)},e.prototype.updateLastIndex=function(e,t){e.lastIndex=t},e.prototype.updateTokenEndLineColumnLocation=function(e,t,n,r,i,o,s){var a,l;void 0!==t&&(l=(a=n===s-1)?-1:0,1===r&&!0===a||(e.endLine=i+l,e.endColumn=o-1-l))},e.prototype.computeNewColumn=function(e,t){return e+t},e.prototype.createTokenInstance=function(){return null},e.prototype.createOffsetOnlyToken=function(e,t,n,r){return{image:e,startOffset:t,tokenTypeIdx:n,tokenType:r}},e.prototype.createStartOnlyToken=function(e,t,n,r,i,o){return{image:e,startOffset:t,startLine:i,startColumn:o,tokenTypeIdx:n,tokenType:r}},e.prototype.createFullToken=function(e,t,n,r,i,o,s){return{image:e,startOffset:t,endOffset:t+s-1,startLine:i,endLine:i,startColumn:o,endColumn:o+s-1,tokenTypeIdx:n,tokenType:r}},e.prototype.addToken=function(e,t,n){return 666},e.prototype.addTokenUsingPush=function(e,t,n){return e.push(n),t},e.prototype.addTokenUsingMemberAccess=function(e,t,n){return e[t]=n,++t},e.prototype.handlePayload=function(e,t){},e.prototype.handlePayloadNoCustom=function(e,t){},e.prototype.handlePayloadWithCustom=function(e,t){null!==t&&(e.payload=t)},e.prototype.match=function(e,t,n){return null},e.prototype.matchWithTest=function(e,t,n){return!0===e.test(t)?t.substring(n,e.lastIndex):null},e.prototype.matchWithExec=function(e,t){var n=e.exec(t);return null!==n?n[0]:n},e.prototype.TRACE_INIT=function(e,t){if(!0===this.traceInitPerf){this.traceInitIndent++;var n=new Array(this.traceInitIndent+1).join("\t");this.traceInitIndent<this.traceInitMaxIdent&&console.log(n+"--\x3e <"+e+">");var r=ZZ(t),i=r.time,o=r.value,s=i>10?console.warn:console.log;return this.traceInitIndent<this.traceInitMaxIdent&&s(n+"<-- <"+e+"> time: "+i+"ms"),this.traceInitIndent--,o}return t()},e.SKIPPED="This marks a skipped Token pattern, this means each token identified by it willbe consumed and then thrown into oblivion, this can be used to for example to completely ignore whitespace.",e.NA=/NOT_APPLICABLE/,e}();function KJ(e){return XJ(e)?e.LABEL:e.name}function XJ(e){return yZ(e.LABEL)&&""!==e.LABEL}var qJ="parent",QJ="categories",ZJ="label",JJ="group",e0="push_mode",t0="pop_mode",n0="longer_alt",r0="line_breaks",i0="start_chars_hint";function o0(e){return function(e){var t=e.pattern,n={};n.name=e.name,vZ(t)||(n.PATTERN=t);if(NZ(e,qJ))throw"The parent property is no longer supported.\nSee: https://github.com/SAP/chevrotain/issues/564#issuecomment-349062346 for details.";NZ(e,QJ)&&(n.CATEGORIES=e[QJ]);UJ([n]),NZ(e,ZJ)&&(n.LABEL=e[ZJ]);NZ(e,JJ)&&(n.GROUP=e[JJ]);NZ(e,t0)&&(n.POP_MODE=e[t0]);NZ(e,e0)&&(n.PUSH_MODE=e[e0]);NZ(e,n0)&&(n.LONGER_ALT=e[n0]);NZ(e,r0)&&(n.LINE_BREAKS=e[r0]);NZ(e,i0)&&(n.START_CHARS_HINT=e[i0]);return n}(e)}var s0=o0({name:"EOF",pattern:YJ.NA});function a0(e,t,n,r,i,o,s,a){return{image:t,startOffset:n,endOffset:r,startLine:i,endLine:o,startColumn:s,endColumn:a,tokenTypeIdx:e.tokenTypeIdx,tokenType:e}}function l0(e,t){return kJ(e,t)}UJ([s0]);var h0=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),u0=function(){function e(e){this.definition=e}return e.prototype.accept=function(e){e.visit(this),wZ(this.definition,(function(t){t.accept(e)}))},e}(),c0=function(e){function t(t){var n=e.call(this,[])||this;return n.idx=1,UZ(n,TZ(t,(function(e){return void 0!==e}))),n}return h0(t,e),Object.defineProperty(t.prototype,"definition",{get:function(){return void 0!==this.referencedRule?this.referencedRule.definition:[]},set:function(e){},enumerable:!0,configurable:!0}),t.prototype.accept=function(e){e.visit(this)},t}(u0),d0=function(e){function t(t){var n=e.call(this,t.definition)||this;return n.orgText="",UZ(n,TZ(t,(function(e){return void 0!==e}))),n}return h0(t,e),t}(u0),p0=function(e){function t(t){var n=e.call(this,t.definition)||this;return n.ignoreAmbiguities=!1,UZ(n,TZ(t,(function(e){return void 0!==e}))),n}return h0(t,e),t}(u0),g0=function(e){function t(t){var n=e.call(this,t.definition)||this;return n.idx=1,UZ(n,TZ(t,(function(e){return void 0!==e}))),n}return h0(t,e),t}(u0),m0=function(e){function t(t){var n=e.call(this,t.definition)||this;return n.idx=1,UZ(n,TZ(t,(function(e){return void 0!==e}))),n}return h0(t,e),t}(u0),f0=function(e){function t(t){var n=e.call(this,t.definition)||this;return n.idx=1,UZ(n,TZ(t,(function(e){return void 0!==e}))),n}return h0(t,e),t}(u0),w0=function(e){function t(t){var n=e.call(this,t.definition)||this;return n.idx=1,UZ(n,TZ(t,(function(e){return void 0!==e}))),n}return h0(t,e),t}(u0),y0=function(e){function t(t){var n=e.call(this,t.definition)||this;return n.idx=1,UZ(n,TZ(t,(function(e){return void 0!==e}))),n}return h0(t,e),t}(u0),v0=function(e){function t(t){var n=e.call(this,t.definition)||this;return n.idx=1,n.ignoreAmbiguities=!1,n.hasPredicates=!1,UZ(n,TZ(t,(function(e){return void 0!==e}))),n}return h0(t,e),t}(u0),C0=function(){function e(e){this.idx=1,UZ(this,TZ(e,(function(e){return void 0!==e})))}return e.prototype.accept=function(e){e.visit(this)},e}();function S0(e){function t(e){return pZ(e,S0)}if(e instanceof c0)return{type:"NonTerminal",name:e.nonTerminalName,idx:e.idx};if(e instanceof p0)return{type:"Flat",definition:t(e.definition)};if(e instanceof g0)return{type:"Option",idx:e.idx,definition:t(e.definition)};if(e instanceof m0)return{type:"RepetitionMandatory",name:e.name,idx:e.idx,definition:t(e.definition)};if(e instanceof f0)return{type:"RepetitionMandatoryWithSeparator",name:e.name,idx:e.idx,separator:S0(new C0({terminalType:e.separator})),definition:t(e.definition)};if(e instanceof y0)return{type:"RepetitionWithSeparator",name:e.name,idx:e.idx,separator:S0(new C0({terminalType:e.separator})),definition:t(e.definition)};if(e instanceof w0)return{type:"Repetition",name:e.name,idx:e.idx,definition:t(e.definition)};if(e instanceof v0)return{type:"Alternation",name:e.name,idx:e.idx,definition:t(e.definition)};if(e instanceof C0){var n={type:"Terminal",name:e.terminalType.name,label:KJ(e.terminalType),idx:e.idx},r=e.terminalType.PATTERN;return e.terminalType.PATTERN&&(n.pattern=HZ(r)?r.source:r),n}if(e instanceof d0)return{type:"Rule",name:e.name,orgText:e.orgText,definition:t(e.definition)};throw Error("non exhaustive match")}var R0=function(){function e(){}return e.prototype.walk=function(e,t){var n=this;void 0===t&&(t=[]),wZ(e.definition,(function(r,i){var o=SZ(e.definition,i+1);if(r instanceof c0)n.walkProdRef(r,o,t);else if(r instanceof C0)n.walkTerminal(r,o,t);else if(r instanceof p0)n.walkFlat(r,o,t);else if(r instanceof g0)n.walkOption(r,o,t);else if(r instanceof m0)n.walkAtLeastOne(r,o,t);else if(r instanceof f0)n.walkAtLeastOneSep(r,o,t);else if(r instanceof y0)n.walkManySep(r,o,t);else if(r instanceof w0)n.walkMany(r,o,t);else{if(!(r instanceof v0))throw Error("non exhaustive match");n.walkOr(r,o,t)}}))},e.prototype.walkTerminal=function(e,t,n){},e.prototype.walkProdRef=function(e,t,n){},e.prototype.walkFlat=function(e,t,n){var r=t.concat(n);this.walk(e,r)},e.prototype.walkOption=function(e,t,n){var r=t.concat(n);this.walk(e,r)},e.prototype.walkAtLeastOne=function(e,t,n){var r=[new g0({definition:e.definition})].concat(t,n);this.walk(e,r)},e.prototype.walkAtLeastOneSep=function(e,t,n){var r=E0(e,t,n);this.walk(e,r)},e.prototype.walkMany=function(e,t,n){var r=[new g0({definition:e.definition})].concat(t,n);this.walk(e,r)},e.prototype.walkManySep=function(e,t,n){var r=E0(e,t,n);this.walk(e,r)},e.prototype.walkOr=function(e,t,n){var r=this,i=t.concat(n);wZ(e.definition,(function(e){var t=new p0({definition:[e]});r.walk(t,i)}))},e}();function E0(e,t,n){return[new g0({definition:[new C0({terminalType:e.separator})].concat(e.definition)})].concat(t,n)}var b0=function(){function e(){}return e.prototype.visit=function(e){var t=e;switch(t.constructor){case c0:return this.visitNonTerminal(t);case p0:return this.visitFlat(t);case g0:return this.visitOption(t);case m0:return this.visitRepetitionMandatory(t);case f0:return this.visitRepetitionMandatoryWithSeparator(t);case y0:return this.visitRepetitionWithSeparator(t);case w0:return this.visitRepetition(t);case v0:return this.visitAlternation(t);case C0:return this.visitTerminal(t);case d0:return this.visitRule(t);default:throw Error("non exhaustive match")}},e.prototype.visitNonTerminal=function(e){},e.prototype.visitFlat=function(e){},e.prototype.visitOption=function(e){},e.prototype.visitRepetition=function(e){},e.prototype.visitRepetitionMandatory=function(e){},e.prototype.visitRepetitionMandatoryWithSeparator=function(e){},e.prototype.visitRepetitionWithSeparator=function(e){},e.prototype.visitAlternation=function(e){},e.prototype.visitTerminal=function(e){},e.prototype.visitRule=function(e){},e}(),T0=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();function N0(e,t){return void 0===t&&(t=[]),!!(e instanceof g0||e instanceof w0||e instanceof y0)||(e instanceof v0?VZ(e.definition,(function(e){return N0(e,t)})):!(e instanceof c0&&AZ(t,e))&&(e instanceof u0&&(e instanceof c0&&t.push(e),FZ(e.definition,(function(e){return N0(e,t)})))))}function A0(e){if(e instanceof c0)return"SUBRULE";if(e instanceof g0)return"OPTION";if(e instanceof v0)return"OR";if(e instanceof m0)return"AT_LEAST_ONE";if(e instanceof f0)return"AT_LEAST_ONE_SEP";if(e instanceof y0)return"MANY_SEP";if(e instanceof w0)return"MANY";if(e instanceof C0)return"CONSUME";throw Error("non exhaustive match")}var M0=new(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.separator="-",t.dslMethods={option:[],alternation:[],repetition:[],repetitionWithSeparator:[],repetitionMandatory:[],repetitionMandatoryWithSeparator:[]},t}return T0(t,e),t.prototype.reset=function(){this.dslMethods={option:[],alternation:[],repetition:[],repetitionWithSeparator:[],repetitionMandatory:[],repetitionMandatoryWithSeparator:[]}},t.prototype.visitTerminal=function(e){var t=e.terminalType.name+this.separator+"Terminal";NZ(this.dslMethods,t)||(this.dslMethods[t]=[]),this.dslMethods[t].push(e)},t.prototype.visitNonTerminal=function(e){var t=e.nonTerminalName+this.separator+"Terminal";NZ(this.dslMethods,t)||(this.dslMethods[t]=[]),this.dslMethods[t].push(e)},t.prototype.visitOption=function(e){this.dslMethods.option.push(e)},t.prototype.visitRepetitionWithSeparator=function(e){this.dslMethods.repetitionWithSeparator.push(e)},t.prototype.visitRepetitionMandatory=function(e){this.dslMethods.repetitionMandatory.push(e)},t.prototype.visitRepetitionMandatoryWithSeparator=function(e){this.dslMethods.repetitionMandatoryWithSeparator.push(e)},t.prototype.visitRepetition=function(e){this.dslMethods.repetition.push(e)},t.prototype.visitAlternation=function(e){this.dslMethods.alternation.push(e)},t}(b0));function I0(e){if(e instanceof c0)return I0(e.referencedRule);if(e instanceof C0)return[e.terminalType];if(function(e){return e instanceof p0||e instanceof g0||e instanceof w0||e instanceof m0||e instanceof f0||e instanceof y0||e instanceof C0||e instanceof d0}(e))return function(e){var t,n=[],r=e.definition,i=0,o=r.length>i,s=!0;for(;o&&s;)s=N0(t=r[i]),n=n.concat(I0(t)),i+=1,o=r.length>i;return _Z(n)}(e);if(function(e){return e instanceof v0}(e))return function(e){var t=pZ(e.definition,(function(e){return I0(e)}));return _Z(gZ(t))}(e);throw Error("non exhaustive match")}var O0="_~IN~_",x0=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),P0=function(e){function t(t){var n=e.call(this)||this;return n.topProd=t,n.follows={},n}return x0(t,e),t.prototype.startWalking=function(){return this.walk(this.topProd),this.follows},t.prototype.walkTerminal=function(e,t,n){},t.prototype.walkProdRef=function(e,t,n){var r,i,o=(r=e.referencedRule,i=e.idx,r.name+i+O0+this.topProd.name),s=t.concat(n),a=I0(new p0({definition:s}));this.follows[o]=a},t}(R0);var _0=256,L0=512,H0=768,k0=1024,F0=1280,D0=1536;function V0(e,t,n){return n|t|e}function U0(e,t,n,r){var i=r+1<<24;return V0(e,t,n)|i}var B0=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();function W0(e,t){!0===isNaN(e.startOffset)?(e.startOffset=t.startOffset,e.endOffset=t.endOffset):e.endOffset<t.endOffset==!0&&(e.endOffset=t.endOffset)}function j0(e,t){!0===isNaN(e.startOffset)?(e.startOffset=t.startOffset,e.startColumn=t.startColumn,e.startLine=t.startLine,e.endOffset=t.endOffset,e.endColumn=t.endColumn,e.endLine=t.endLine):e.endOffset<t.endOffset==!0&&(e.endOffset=t.endOffset,e.endColumn=t.endColumn,e.endLine=t.endLine)}function G0(e,t,n){void 0===e.children[t]?e.children[t]=[n]:e.children[t].push(n)}var z0=function(e){function t(t){var n=e.call(this)||this;return n.result=[],n.ruleIdx=t,n}return B0(t,e),t.prototype.collectNamedDSLMethod=function(e,t,n){if(!vZ(e.name)){var r=void 0;if(e instanceof g0||e instanceof w0||e instanceof m0||e instanceof v0)r=new t({definition:e.definition,idx:e.idx});else{if(!(e instanceof f0||e instanceof y0))throw Error("non exhaustive match");r=new t({definition:e.definition,idx:e.idx,separator:e.separator})}var i=[r],o=V0(this.ruleIdx,n,e.idx);this.result.push({def:i,key:o,name:e.name,orgProd:e})}},t.prototype.visitOption=function(e){this.collectNamedDSLMethod(e,g0,L0)},t.prototype.visitRepetition=function(e){this.collectNamedDSLMethod(e,w0,H0)},t.prototype.visitRepetitionMandatory=function(e){this.collectNamedDSLMethod(e,m0,k0)},t.prototype.visitRepetitionMandatoryWithSeparator=function(e){this.collectNamedDSLMethod(e,f0,D0)},t.prototype.visitRepetitionWithSeparator=function(e){this.collectNamedDSLMethod(e,y0,F0)},t.prototype.visitAlternation=function(e){var t=this;this.collectNamedDSLMethod(e,v0,_0);var n=e.definition.length>1;wZ(e.definition,(function(r,i){if(!vZ(r.name)){var o=r.definition;o=n?[new g0({definition:r.definition})]:r.definition;var s=U0(t.ruleIdx,_0,e.idx,i);t.result.push({def:o,key:s,name:r.name,orgProd:r})}}))},t}(b0);var $0=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Y0=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.path=n,r.nextTerminalName="",r.nextTerminalOccurrence=0,r.nextTerminalName=r.path.lastTok.name,r.nextTerminalOccurrence=r.path.lastTokOccurrence,r}return $0(t,e),t.prototype.walkTerminal=function(e,t,n){if(this.isAtEndOfPath&&e.terminalType.name===this.nextTerminalName&&e.idx===this.nextTerminalOccurrence&&!this.found){var r=t.concat(n),i=new p0({definition:r});this.possibleTokTypes=I0(i),this.found=!0}},t}(function(e){function t(t,n){var r=e.call(this)||this;return r.topProd=t,r.path=n,r.possibleTokTypes=[],r.nextProductionName="",r.nextProductionOccurrence=0,r.found=!1,r.isAtEndOfPath=!1,r}return $0(t,e),t.prototype.startWalking=function(){if(this.found=!1,this.path.ruleStack[0]!==this.topProd.name)throw Error("The path does not start with the walker's top Rule!");return this.ruleStack=MZ(this.path.ruleStack).reverse(),this.occurrenceStack=MZ(this.path.occurrenceStack).reverse(),this.ruleStack.pop(),this.occurrenceStack.pop(),this.updateExpectedNext(),this.walk(this.topProd),this.possibleTokTypes},t.prototype.walk=function(t,n){void 0===n&&(n=[]),this.found||e.prototype.walk.call(this,t,n)},t.prototype.walkProdRef=function(e,t,n){if(e.referencedRule.name===this.nextProductionName&&e.idx===this.nextProductionOccurrence){var r=t.concat(n);this.updateExpectedNext(),this.walk(e.referencedRule,r)}},t.prototype.updateExpectedNext=function(){uZ(this.ruleStack)?(this.nextProductionName="",this.nextProductionOccurrence=0,this.isAtEndOfPath=!0):(this.nextProductionName=this.ruleStack.pop(),this.nextProductionOccurrence=this.occurrenceStack.pop())},t}(R0)),K0=function(e){function t(t,n){var r=e.call(this)||this;return r.topRule=t,r.occurrence=n,r.result={token:void 0,occurrence:void 0,isEndOfRule:void 0},r}return $0(t,e),t.prototype.startWalking=function(){return this.walk(this.topRule),this.result},t}(R0),X0=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return $0(t,e),t.prototype.walkMany=function(t,n,r){if(t.idx===this.occurrence){var i=mZ(n.concat(r));this.result.isEndOfRule=void 0===i,i instanceof C0&&(this.result.token=i.terminalType,this.result.occurrence=i.idx)}else e.prototype.walkMany.call(this,t,n,r)},t}(K0),q0=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return $0(t,e),t.prototype.walkManySep=function(t,n,r){if(t.idx===this.occurrence){var i=mZ(n.concat(r));this.result.isEndOfRule=void 0===i,i instanceof C0&&(this.result.token=i.terminalType,this.result.occurrence=i.idx)}else e.prototype.walkManySep.call(this,t,n,r)},t}(K0),Q0=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return $0(t,e),t.prototype.walkAtLeastOne=function(t,n,r){if(t.idx===this.occurrence){var i=mZ(n.concat(r));this.result.isEndOfRule=void 0===i,i instanceof C0&&(this.result.token=i.terminalType,this.result.occurrence=i.idx)}else e.prototype.walkAtLeastOne.call(this,t,n,r)},t}(K0),Z0=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return $0(t,e),t.prototype.walkAtLeastOneSep=function(t,n,r){if(t.idx===this.occurrence){var i=mZ(n.concat(r));this.result.isEndOfRule=void 0===i,i instanceof C0&&(this.result.token=i.terminalType,this.result.occurrence=i.idx)}else e.prototype.walkAtLeastOneSep.call(this,t,n,r)},t}(K0);function J0(e,t,n){void 0===n&&(n=[]),n=MZ(n);var r=[],i=0;function o(o){var s=J0(o.concat(SZ(e,i+1)),t,n);return r.concat(s)}for(;n.length<t&&i<e.length;){var s=e[i];if(s instanceof p0)return o(s.definition);if(s instanceof c0)return o(s.definition);if(s instanceof g0)r=o(s.definition);else{if(s instanceof m0)return o(a=s.definition.concat([new w0({definition:s.definition})]));if(s instanceof f0)return o(a=[new p0({definition:s.definition}),new w0({definition:[new C0({terminalType:s.separator})].concat(s.definition)})]);if(s instanceof y0){var a=s.definition.concat([new w0({definition:[new C0({terminalType:s.separator})].concat(s.definition)})]);r=o(a)}else if(s instanceof w0){a=s.definition.concat([new w0({definition:s.definition})]);r=o(a)}else{if(s instanceof v0)return wZ(s.definition,(function(e){r=o(e.definition)})),r;if(!(s instanceof C0))throw Error("non exhaustive match");n.push(s.terminalType)}}i++}return r.push({partialPath:n,suffixDef:SZ(e,i)}),r}function e1(e,t,n,r){var i="EXIT_NONE_TERMINAL",o=[i],s="EXIT_ALTERNATIVE",a=!1,l=t.length,h=l-r-1,u=[],c=[];for(c.push({idx:-1,def:e,ruleStack:[],occurrenceStack:[]});!uZ(c);){var d=c.pop();if(d!==s){var p=d.def,g=d.idx,m=d.ruleStack,f=d.occurrenceStack;if(!uZ(p)){var w=p[0];if(w===i){var y={idx:g,def:SZ(p),ruleStack:RZ(m),occurrenceStack:RZ(f)};c.push(y)}else if(w instanceof C0)if(g<l-1){var v=g+1;if(n(t[v],w.terminalType)){y={idx:v,def:SZ(p),ruleStack:m,occurrenceStack:f};c.push(y)}}else{if(g!==l-1)throw Error("non exhaustive match");u.push({nextTokenType:w.terminalType,nextTokenOccurrence:w.idx,ruleStack:m,occurrenceStack:f}),a=!0}else if(w instanceof c0){var C=MZ(m);C.push(w.nonTerminalName);var S=MZ(f);S.push(w.idx);y={idx:g,def:w.definition.concat(o,SZ(p)),ruleStack:C,occurrenceStack:S};c.push(y)}else if(w instanceof g0){var R={idx:g,def:SZ(p),ruleStack:m,occurrenceStack:f};c.push(R),c.push(s);var E={idx:g,def:w.definition.concat(SZ(p)),ruleStack:m,occurrenceStack:f};c.push(E)}else if(w instanceof m0){var b=new w0({definition:w.definition,idx:w.idx});y={idx:g,def:w.definition.concat([b],SZ(p)),ruleStack:m,occurrenceStack:f};c.push(y)}else if(w instanceof f0){var T=new C0({terminalType:w.separator});b=new w0({definition:[T].concat(w.definition),idx:w.idx}),y={idx:g,def:w.definition.concat([b],SZ(p)),ruleStack:m,occurrenceStack:f};c.push(y)}else if(w instanceof y0){R={idx:g,def:SZ(p),ruleStack:m,occurrenceStack:f};c.push(R),c.push(s);T=new C0({terminalType:w.separator});var N=new w0({definition:[T].concat(w.definition),idx:w.idx});E={idx:g,def:w.definition.concat([N],SZ(p)),ruleStack:m,occurrenceStack:f};c.push(E)}else if(w instanceof w0){R={idx:g,def:SZ(p),ruleStack:m,occurrenceStack:f};c.push(R),c.push(s);N=new w0({definition:w.definition,idx:w.idx}),E={idx:g,def:w.definition.concat([N],SZ(p)),ruleStack:m,occurrenceStack:f};c.push(E)}else if(w instanceof v0)for(var A=w.definition.length-1;A>=0;A--){var M={idx:g,def:w.definition[A].definition.concat(SZ(p)),ruleStack:m,occurrenceStack:f};c.push(M),c.push(s)}else if(w instanceof p0)c.push({idx:g,def:w.definition.concat(SZ(p)),ruleStack:m,occurrenceStack:f});else{if(!(w instanceof d0))throw Error("non exhaustive match");c.push(t1(w,g,m,f))}}}else a&&fZ(c).idx<=h&&c.pop()}return u}function t1(e,t,n,r){var i=MZ(n);i.push(e.name);var o=MZ(r);return o.push(1),{idx:t,def:e.definition,ruleStack:i,occurrenceStack:o}}var n1,r1=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();!function(e){e[e.OPTION=0]="OPTION",e[e.REPETITION=1]="REPETITION",e[e.REPETITION_MANDATORY=2]="REPETITION_MANDATORY",e[e.REPETITION_MANDATORY_WITH_SEPARATOR=3]="REPETITION_MANDATORY_WITH_SEPARATOR",e[e.REPETITION_WITH_SEPARATOR=4]="REPETITION_WITH_SEPARATOR",e[e.ALTERNATION=5]="ALTERNATION"}(n1||(n1={}));var i1=function(e){function t(t,n,r){var i=e.call(this)||this;return i.topProd=t,i.targetOccurrence=n,i.targetProdType=r,i}return r1(t,e),t.prototype.startWalking=function(){return this.walk(this.topProd),this.restDef},t.prototype.checkIsTarget=function(e,t,n,r){return e.idx===this.targetOccurrence&&this.targetProdType===t&&(this.restDef=n.concat(r),!0)},t.prototype.walkOption=function(t,n,r){this.checkIsTarget(t,n1.OPTION,n,r)||e.prototype.walkOption.call(this,t,n,r)},t.prototype.walkAtLeastOne=function(t,n,r){this.checkIsTarget(t,n1.REPETITION_MANDATORY,n,r)||e.prototype.walkOption.call(this,t,n,r)},t.prototype.walkAtLeastOneSep=function(t,n,r){this.checkIsTarget(t,n1.REPETITION_MANDATORY_WITH_SEPARATOR,n,r)||e.prototype.walkOption.call(this,t,n,r)},t.prototype.walkMany=function(t,n,r){this.checkIsTarget(t,n1.REPETITION,n,r)||e.prototype.walkOption.call(this,t,n,r)},t.prototype.walkManySep=function(t,n,r){this.checkIsTarget(t,n1.REPETITION_WITH_SEPARATOR,n,r)||e.prototype.walkOption.call(this,t,n,r)},t}(R0),o1=function(e){function t(t,n,r){var i=e.call(this)||this;return i.targetOccurrence=t,i.targetProdType=n,i.targetRef=r,i.result=[],i}return r1(t,e),t.prototype.checkIsTarget=function(e,t){e.idx!==this.targetOccurrence||this.targetProdType!==t||void 0!==this.targetRef&&e!==this.targetRef||(this.result=e.definition)},t.prototype.visitOption=function(e){this.checkIsTarget(e,n1.OPTION)},t.prototype.visitRepetition=function(e){this.checkIsTarget(e,n1.REPETITION)},t.prototype.visitRepetitionMandatory=function(e){this.checkIsTarget(e,n1.REPETITION_MANDATORY)},t.prototype.visitRepetitionMandatoryWithSeparator=function(e){this.checkIsTarget(e,n1.REPETITION_MANDATORY_WITH_SEPARATOR)},t.prototype.visitRepetitionWithSeparator=function(e){this.checkIsTarget(e,n1.REPETITION_WITH_SEPARATOR)},t.prototype.visitAlternation=function(e){this.checkIsTarget(e,n1.ALTERNATION)},t}(b0);function s1(e){for(var t=new Array(e),n=0;n<e;n++)t[n]=[];return t}function a1(e){for(var t=[""],n=0;n<e.length;n++){for(var r=e[n],i=[],o=0;o<t.length;o++){var s=t[o];i.push(s+"_"+r.tokenTypeIdx);for(var a=0;a<r.categoryMatches.length;a++){var l="_"+r.categoryMatches[a];i.push(s+l)}}t=i}return t}function l1(e,t,n){for(var r=0;r<e.length;r++)if(r!==n)for(var i=e[r],o=0;o<t.length;o++){if(!0===i[t[o]])return!1}return!0}function h1(e,t){for(var n=pZ(e,(function(e){return J0([e],1)})),r=s1(n.length),i=pZ(n,(function(e){var t={};return wZ(e,(function(e){wZ(a1(e.partialPath),(function(e){t[e]=!0}))})),t})),o=n,s=1;s<=t;s++){var a=o;o=s1(a.length);for(var l=function(e){for(var n=a[e],l=0;l<n.length;l++){var h=n[l].partialPath,u=n[l].suffixDef,c=a1(h);if(l1(i,c,e)||uZ(u)||h.length===t){var d=r[e];if(!1===d1(d,h)){d.push(h);for(var p=0;p<c.length;p++){var g=c[p];i[e][g]=!0}}}else{var m=J0(u,s+1,h);o[e]=o[e].concat(m),wZ(m,(function(t){wZ(a1(t.partialPath),(function(t){i[e][t]=!0}))}))}}},h=0;h<a.length;h++)l(h)}return r}function u1(e,t,n,r){var i=new o1(e,n1.ALTERNATION,r);return t.accept(i),h1(i.result,n)}function c1(e,t,n,r){var i=new o1(e,n);t.accept(i);var o=i.result,s=new i1(t,e,n).startWalking();return h1([new p0({definition:o}),new p0({definition:s})],r)}function d1(e,t){e:for(var n=0;n<e.length;n++){var r=e[n];if(r.length===t.length){for(var i=0;i<r.length;i++){var o=t[i],s=r[i];if(!1===(o===s||void 0!==s.categoryMatchesMap[o.tokenTypeIdx]))continue e}return!0}}return!1}function p1(e){return FZ(e,(function(e){return FZ(e,(function(e){return FZ(e,(function(e){return uZ(e.categoryMatches)}))}))}))}var g1=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();function m1(e,t,n,r,i,o){var s=pZ(e,(function(e){return function(e,t){var n=new y1;e.accept(n);var r=n.allProductions,i=pZ(dZ(TZ(jZ(r,f1),(function(e){return e.length>1}))),(function(n){var r=mZ(n),i=t.buildDuplicateFoundError(e,n),o=A0(r),s={message:i,type:S2.DUPLICATE_PRODUCTIONS,ruleName:e.name,dslName:o,occurrence:r.idx},a=w1(r);return a&&(s.parameter=a),s}));return i}(e,i)})),a=pZ(e,(function(e){return S1(e,e,i)})),l=[],h=[],u=[];FZ(a,uZ)&&(l=pZ(e,(function(e){return function(e,t){var n=new E1;e.accept(n);var r=xZ(n.alternations,(function(n,r){var i=pZ(RZ(r.definition),(function(n,i){return uZ(e1([n],[],null,1))?{message:t.buildEmptyAlternationError({topLevelRule:e,alternation:r,emptyChoiceIdx:i}),type:S2.NONE_LAST_EMPTY_ALT,ruleName:e.name,occurrence:r.idx,alternative:i+1}:null}));return n.concat(PZ(i))}),[]);return r}(e,i)})),h=pZ(e,(function(e){return function(e,t,n,r){var i=new E1;e.accept(i);var o=i.alternations,s=n[e.name];s&&(o=bZ(o,(function(e){return s[A0(e)+(0===e.idx?"":e.idx)]})));var a=xZ(o=bZ(o,(function(e){return!0===e.ignoreAmbiguities})),(function(n,i){var o=i.idx,s=i.maxLookahead||t,a=u1(o,e,s,i),l=function(e,t,n,r){var i=[],o=xZ(e,(function(n,r,o){return!0===t.definition[o].ignoreAmbiguities||wZ(r,(function(r){var s=[o];wZ(e,(function(e,n){o!==n&&d1(e,r)&&!0!==t.definition[n].ignoreAmbiguities&&s.push(n)})),s.length>1&&!d1(i,r)&&(i.push(r),n.push({alts:s,path:r}))})),n}),[]),s=pZ(o,(function(e){var i=pZ(e.alts,(function(e){return e+1}));return{message:r.buildAlternationAmbiguityError({topLevelRule:n,alternation:t,ambiguityIndices:i,prefixPath:e.path}),type:S2.AMBIGUOUS_ALTS,ruleName:n.name,occurrence:t.idx,alternatives:[e.alts]}}));return s}(a,i,e,r),h=function(e,t,n,r){var i=[],o=xZ(e,(function(e,t,n){var r=pZ(t,(function(e){return{idx:n,path:e}}));return e.concat(r)}),[]);return wZ(o,(function(e){if(!0!==t.definition[e.idx].ignoreAmbiguities){var s=e.idx,a=e.path,l=pZ(function(e,t){for(var n=[],r=0;r<e.length;r++){var i=e[r];t.call(null,i)&&n.push(i)}return n}(o,(function(e){return!0!==t.definition[e.idx].ignoreAmbiguities&&e.idx<s&&(n=e.path,r=a,n.length<r.length&&FZ(n,(function(e,t){var n=r[t];return e===n||n.categoryMatchesMap[e.tokenTypeIdx]})));var n,r})),(function(e){var i=[e.idx+1,s+1],o=0===t.idx?"":t.idx;return{message:r.buildAlternationPrefixAmbiguityError({topLevelRule:n,alternation:t,ambiguityIndices:i,prefixPath:e.path}),type:S2.AMBIGUOUS_PREFIX_ALTS,ruleName:n.name,occurrence:o,alternatives:i}}));i=i.concat(l)}})),i}(a,i,e,r);return n.concat(l,h)}),[]);return a}(e,t,r,i)})),u=function(e,t,n){var r=[];return wZ(e,(function(e){var i=new b1;e.accept(i),wZ(i.allProductions,(function(i){var o=function(e){if(e instanceof g0)return n1.OPTION;if(e instanceof w0)return n1.REPETITION;if(e instanceof m0)return n1.REPETITION_MANDATORY;if(e instanceof f0)return n1.REPETITION_MANDATORY_WITH_SEPARATOR;if(e instanceof y0)return n1.REPETITION_WITH_SEPARATOR;if(e instanceof v0)return n1.ALTERNATION;throw Error("non exhaustive match")}(i),s=i.maxLookahead||t;if(uZ(gZ(c1(i.idx,e,o,s)[0]))){var a=n.buildEmptyRepetitionError({topLevelRule:e,repetition:i});r.push({message:a,type:S2.NO_NON_EMPTY_LOOKAHEAD,ruleName:e.name})}}))})),r}(e,t,i));var c=function(e,t,n){var r=[],i=pZ(t,(function(e){return e.name}));return wZ(e,(function(e){var t=e.name;if(AZ(i,t)){var o=n.buildNamespaceConflictError(e);r.push({message:o,type:S2.CONFLICT_TOKENS_RULES_NAMESPACE,ruleName:t})}})),r}(e,n,i),d=pZ(n,(function(e){return function(e,t){var n=[];e.name.match(v1)||n.push({message:t.buildTokenNameError({tokenType:e,expectedPattern:v1}),type:S2.INVALID_TOKEN_NAME});return n}(e,i)})),p=function(e,t){var n=[];return wZ(e,(function(e){var r=new z0("");e.accept(r);var i=pZ(r.result,(function(e){return e.orgProd}));n.push(pZ(i,(function(n){return function(e,t,n){var r,i=[];t.name.match(C1)||(r=n.buildInvalidNestedRuleNameError(e,t),i.push({message:r,type:S2.INVALID_NESTED_RULE_NAME,ruleName:e.name}));return i}(e,n,t)})))})),gZ(n)}(e,i),g=function(e,t){var n=[];return wZ(e,(function(e){var r=new z0("");e.accept(r),wZ(dZ(TZ(jZ(r.result,(function(e){return e.name})),(function(e){return e.length>1}))),(function(r){var i=pZ(r,(function(e){return e.orgProd})),o=t.buildDuplicateNestedRuleNameError(e,i);n.push({message:o,type:S2.DUPLICATE_NESTED_NAME,ruleName:e.name})}))})),n}(e,i),m=pZ(e,(function(e){return function(e,t){var n=new E1;e.accept(n);var r=xZ(n.alternations,(function(n,r){return r.definition.length>255&&n.push({message:t.buildTooManyAlternativesError({topLevelRule:e,alternation:r}),type:S2.TOO_MANY_ALTS,ruleName:e.name,occurrence:r.idx}),n}),[]);return r}(e,i)})),f=pZ(e,(function(e){return function(e,t){var n=[],r=e.name;r.match(v1)||n.push({message:t.buildInvalidRuleNameError({topLevelRule:e,expectedPattern:v1}),type:S2.INVALID_RULE_NAME,ruleName:r});return n}(e,i)})),w=pZ(e,(function(t){return function(e,t,n,r){var i=[],o=xZ(t,(function(t,n){return n.name===e.name?t+1:t}),0);if(o>1){var s=r.buildDuplicateRuleNameError({topLevelRule:e,grammarName:n});i.push({message:s,type:S2.DUPLICATE_RULE_NAME,ruleName:e.name})}return i}(t,e,o,i)}));return gZ(s.concat(d,p,g,u,a,l,h,c,m,f,w))}function f1(e){return A0(e)+"_#_"+e.idx+"_#_"+w1(e)}function w1(e){return e instanceof C0?e.terminalType.name:e instanceof c0?e.nonTerminalName:""}var y1=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.allProductions=[],t}return g1(t,e),t.prototype.visitNonTerminal=function(e){this.allProductions.push(e)},t.prototype.visitOption=function(e){this.allProductions.push(e)},t.prototype.visitRepetitionWithSeparator=function(e){this.allProductions.push(e)},t.prototype.visitRepetitionMandatory=function(e){this.allProductions.push(e)},t.prototype.visitRepetitionMandatoryWithSeparator=function(e){this.allProductions.push(e)},t.prototype.visitRepetition=function(e){this.allProductions.push(e)},t.prototype.visitAlternation=function(e){this.allProductions.push(e)},t.prototype.visitTerminal=function(e){this.allProductions.push(e)},t}(b0),v1=/^[a-zA-Z_]\w*$/,C1=new RegExp(v1.source.replace("^","^\\$"));function S1(e,t,n,r){void 0===r&&(r=[]);var i=[],o=R1(t.definition);if(uZ(o))return[];var s=e.name;AZ(o,e)&&i.push({message:n.buildLeftRecursionError({topLevelRule:e,leftRecursionPath:r}),type:S2.LEFT_RECURSION,ruleName:s});var a=pZ(DZ(o,r.concat([e])),(function(t){var i=MZ(r);return i.push(t),S1(e,t,n,i)}));return i.concat(gZ(a))}function R1(e){var t=[];if(uZ(e))return t;var n=mZ(e);if(n instanceof c0)t.push(n.referencedRule);else if(n instanceof p0||n instanceof g0||n instanceof m0||n instanceof f0||n instanceof y0||n instanceof w0)t=t.concat(R1(n.definition));else if(n instanceof v0)t=gZ(pZ(n.definition,(function(e){return R1(e.definition)})));else if(!(n instanceof C0))throw Error("non exhaustive match");var r=N0(n),i=e.length>1;if(r&&i){var o=SZ(e);return t.concat(R1(o))}return t}var E1=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.alternations=[],t}return g1(t,e),t.prototype.visitAlternation=function(e){this.alternations.push(e)},t}(b0);var b1=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.allProductions=[],t}return g1(t,e),t.prototype.visitRepetitionWithSeparator=function(e){this.allProductions.push(e)},t.prototype.visitRepetitionMandatory=function(e){this.allProductions.push(e)},t.prototype.visitRepetitionMandatoryWithSeparator=function(e){this.allProductions.push(e)},t.prototype.visitRepetition=function(e){this.allProductions.push(e)},t}(b0);var T1={buildMismatchTokenMessage:function(e){var t=e.expected,n=e.actual;return e.previous,e.ruleName,"Expecting "+(XJ(t)?"--\x3e "+KJ(t)+" <--":"token of type --\x3e "+t.name+" <--")+" but found --\x3e '"+n.image+"' <--"},buildNotAllInputParsedMessage:function(e){var t=e.firstRedundant;return e.ruleName,"Redundant input, expecting EOF but found: "+t.image},buildNoViableAltMessage:function(e){var t=e.expectedPathsPerAlt,n=e.actual;e.previous;var r=e.customUserDescription;e.ruleName;var i="Expecting: ",o="\nbut found: '"+mZ(n).image+"'";if(r)return i+r+o;var s=pZ(xZ(t,(function(e,t){return e.concat(t)}),[]),(function(e){return"["+pZ(e,(function(e){return KJ(e)})).join(", ")+"]"}));return i+("one of these possible Token sequences:\n"+pZ(s,(function(e,t){return"  "+(t+1)+". "+e})).join("\n"))+o},buildEarlyExitMessage:function(e){var t=e.expectedIterationPaths,n=e.actual,r=e.customUserDescription;e.ruleName;var i="Expecting: ",o="\nbut found: '"+mZ(n).image+"'";return r?i+r+o:i+("expecting at least one iteration which starts with one of these possible Token sequences::\n  <"+pZ(t,(function(e){return"["+pZ(e,(function(e){return KJ(e)})).join(",")+"]"})).join(" ,")+">")+o}};Object.freeze(T1);var N1={buildRuleNotFoundError:function(e,t){return"Invalid grammar, reference to a rule which is not defined: ->"+t.nonTerminalName+"<-\ninside top level rule: ->"+e.name+"<-"}},A1={buildDuplicateFoundError:function(e,t){var n,r=e.name,i=mZ(t),o=i.idx,s=A0(i),a=(n=i)instanceof C0?n.terminalType.name:n instanceof c0?n.nonTerminalName:"",l="->"+s+(o>0?o:"")+"<- "+(a?"with argument: ->"+a+"<-":"")+"\n                  appears more than once ("+t.length+" times) in the top level rule: ->"+r+"<-.                  \n                  For further details see: https://sap.github.io/chevrotain/docs/FAQ.html#NUMERICAL_SUFFIXES \n                  ";return l=(l=l.replace(/[ \t]+/g," ")).replace(/\s\s+/g,"\n")},buildInvalidNestedRuleNameError:function(e,t){return"Invalid nested rule name: ->"+t.name+"<- inside rule: ->"+e.name+"<-\nit must match the pattern: ->"+C1.toString()+"<-.\nNote that this means a nested rule name must start with the '$'(dollar) sign."},buildDuplicateNestedRuleNameError:function(e,t){return"Duplicate nested rule name: ->"+mZ(t).name+"<- inside rule: ->"+e.name+"<-\nA nested name must be unique in the scope of a top level grammar rule."},buildNamespaceConflictError:function(e){return"Namespace conflict found in grammar.\nThe grammar has both a Terminal(Token) and a Non-Terminal(Rule) named: <"+e.name+">.\nTo resolve this make sure each Terminal and Non-Terminal names are unique\nThis is easy to accomplish by using the convention that Terminal names start with an uppercase letter\nand Non-Terminal names start with a lower case letter."},buildAlternationPrefixAmbiguityError:function(e){var t=pZ(e.prefixPath,(function(e){return KJ(e)})).join(", "),n=0===e.alternation.idx?"":e.alternation.idx;return"Ambiguous alternatives: <"+e.ambiguityIndices.join(" ,")+"> due to common lookahead prefix\nin <OR"+n+"> inside <"+e.topLevelRule.name+"> Rule,\n<"+t+"> may appears as a prefix path in all these alternatives.\nSee: https://sap.github.io/chevrotain/docs/guide/resolving_grammar_errors.html#COMMON_PREFIX\nFor Further details."},buildAlternationAmbiguityError:function(e){var t=pZ(e.prefixPath,(function(e){return KJ(e)})).join(", "),n=0===e.alternation.idx?"":e.alternation.idx,r="Ambiguous Alternatives Detected: <"+e.ambiguityIndices.join(" ,")+"> in <OR"+n+"> inside <"+e.topLevelRule.name+"> Rule,\n<"+t+"> may appears as a prefix path in all these alternatives.\n";return r+="See: https://sap.github.io/chevrotain/docs/guide/resolving_grammar_errors.html#AMBIGUOUS_ALTERNATIVES\nFor Further details."},buildEmptyRepetitionError:function(e){var t=A0(e.repetition);return 0!==e.repetition.idx&&(t+=e.repetition.idx),"The repetition <"+t+"> within Rule <"+e.topLevelRule.name+"> can never consume any tokens.\nThis could lead to an infinite loop."},buildTokenNameError:function(e){return"Invalid Grammar Token name: ->"+e.tokenType.name+"<- it must match the pattern: ->"+e.expectedPattern.toString()+"<-"},buildEmptyAlternationError:function(e){return"Ambiguous empty alternative: <"+(e.emptyChoiceIdx+1)+"> in <OR"+e.alternation.idx+"> inside <"+e.topLevelRule.name+"> Rule.\nOnly the last alternative may be an empty alternative."},buildTooManyAlternativesError:function(e){return"An Alternation cannot have more than 256 alternatives:\n<OR"+e.alternation.idx+"> inside <"+e.topLevelRule.name+"> Rule.\n has "+(e.alternation.definition.length+1)+" alternatives."},buildLeftRecursionError:function(e){var t=e.topLevelRule.name;return"Left Recursion found in grammar.\nrule: <"+t+"> can be invoked from itself (directly or indirectly)\nwithout consuming any Tokens. The grammar path that causes this is: \n "+(t+" --\x3e "+pZ(e.leftRecursionPath,(function(e){return e.name})).concat([t]).join(" --\x3e "))+"\n To fix this refactor your grammar to remove the left recursion.\nsee: https://en.wikipedia.org/wiki/LL_parser#Left_Factoring."},buildInvalidRuleNameError:function(e){return"Invalid grammar rule name: ->"+e.topLevelRule.name+"<- it must match the pattern: ->"+e.expectedPattern.toString()+"<-"},buildDuplicateRuleNameError:function(e){return"Duplicate definition, rule: ->"+(e.topLevelRule instanceof d0?e.topLevelRule.name:e.topLevelRule)+"<- is already defined in the grammar: ->"+e.grammarName+"<-"}},M1=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();var I1=function(e){function t(t,n){var r=e.call(this)||this;return r.nameToTopRule=t,r.errMsgProvider=n,r.errors=[],r}return M1(t,e),t.prototype.resolveRefs=function(){var e=this;wZ(dZ(this.nameToTopRule),(function(t){e.currTopLevel=t,t.accept(e)}))},t.prototype.visitNonTerminal=function(e){var t=this.nameToTopRule[e.nonTerminalName];if(t)e.referencedRule=t;else{var n=this.errMsgProvider.buildRuleNotFoundError(this.currTopLevel,e);this.errors.push({message:n,type:S2.UNRESOLVED_SUBRULE_REF,ruleName:this.currTopLevel.name,unresolvedRefName:e.nonTerminalName})}},t}(b0);function O1(e){e=WZ(e,{errMsgProvider:N1});var t,n,r,i={};return wZ(e.rules,(function(e){i[e.name]=e})),t=i,n=e.errMsgProvider,(r=new I1(t,n)).resolveRefs(),r.errors}var x1="MismatchedTokenException",P1="NoViableAltException",_1="EarlyExitException",L1="NotAllInputParsedException",H1=[x1,P1,_1,L1];function k1(e){return AZ(H1,e.name)}function F1(e,t,n){this.name=x1,this.message=e,this.token=t,this.previousToken=n,this.resyncedTokens=[]}function D1(e,t,n){this.name=P1,this.message=e,this.token=t,this.previousToken=n,this.resyncedTokens=[]}function V1(e,t){this.name=L1,this.message=e,this.token=t,this.resyncedTokens=[]}function U1(e,t,n){this.name=_1,this.message=e,this.token=t,this.previousToken=n,this.resyncedTokens=[]}Object.freeze(H1),F1.prototype=Error.prototype,D1.prototype=Error.prototype,V1.prototype=Error.prototype,U1.prototype=Error.prototype;var B1={},W1="InRuleRecoveryException";function j1(e){this.name=W1,this.message=e}j1.prototype=Error.prototype;var G1=function(){function e(){}return e.prototype.initRecoverable=function(e){this.firstAfterRepMap={},this.resyncFollows={},this.recoveryEnabled=NZ(e,"recoveryEnabled")?e.recoveryEnabled:R2.recoveryEnabled,this.recoveryEnabled&&(this.attemptInRepetitionRecovery=z1)},e.prototype.getTokenToInsert=function(e){var t=a0(e,"",NaN,NaN,NaN,NaN,NaN,NaN);return t.isInsertedInRecovery=!0,t},e.prototype.canTokenTypeBeInsertedInRecovery=function(e){return!0},e.prototype.tryInRepetitionRecovery=function(e,t,n,r){for(var i=this,o=this.findReSyncTokenType(),s=this.exportLexerState(),a=[],l=!1,h=this.LA(1),u=this.LA(1),c=function(){var e=i.LA(0),t=new F1(i.errorMessageProvider.buildMismatchTokenMessage({expected:r,actual:h,previous:e,ruleName:i.getCurrRuleFullName()}),h,i.LA(0));t.resyncedTokens=RZ(a),i.SAVE_ERROR(t)};!l;){if(this.tokenMatcher(u,r))return void c();if(n.call(this))return c(),void e.apply(this,t);this.tokenMatcher(u,o)?l=!0:(u=this.SKIP_TOKEN(),this.addToResyncTokens(u,a))}this.importLexerState(s)},e.prototype.shouldInRepetitionRecoveryBeTried=function(e,t,n){return!1!==n&&(void 0!==e&&void 0!==t&&(!this.tokenMatcher(this.LA(1),e)&&(!this.isBackTracking()&&!this.canPerformInRuleRecovery(e,this.getFollowsForInRuleRecovery(e,t)))))},e.prototype.getFollowsForInRuleRecovery=function(e,t){var n=this.getCurrentGrammarPath(e,t);return this.getNextPossibleTokenTypes(n)},e.prototype.tryInRuleRecovery=function(e,t){if(this.canRecoverWithSingleTokenInsertion(e,t))return this.getTokenToInsert(e);if(this.canRecoverWithSingleTokenDeletion(e)){var n=this.SKIP_TOKEN();return this.consumeToken(),n}throw new j1("sad sad panda")},e.prototype.canPerformInRuleRecovery=function(e,t){return this.canRecoverWithSingleTokenInsertion(e,t)||this.canRecoverWithSingleTokenDeletion(e)},e.prototype.canRecoverWithSingleTokenInsertion=function(e,t){var n=this;if(!this.canTokenTypeBeInsertedInRecovery(e))return!1;if(uZ(t))return!1;var r=this.LA(1);return void 0!==OZ(t,(function(e){return n.tokenMatcher(r,e)}))},e.prototype.canRecoverWithSingleTokenDeletion=function(e){return this.tokenMatcher(this.LA(2),e)},e.prototype.isInCurrentRuleReSyncSet=function(e){var t=this.getCurrFollowKey();return AZ(this.getFollowSetFromFollowKey(t),e)},e.prototype.findReSyncTokenType=function(){for(var e=this.flattenFollowSet(),t=this.LA(1),n=2;;){var r=t.tokenType;if(AZ(e,r))return r;t=this.LA(n),n++}},e.prototype.getCurrFollowKey=function(){if(1===this.RULE_STACK.length)return B1;var e=this.getLastExplicitRuleShortName(),t=this.getLastExplicitRuleOccurrenceIndex(),n=this.getPreviousExplicitRuleShortName();return{ruleName:this.shortRuleNameToFullName(e),idxInCallingRule:t,inRule:this.shortRuleNameToFullName(n)}},e.prototype.buildFullFollowKeyStack=function(){var e=this,t=this.RULE_STACK,n=this.RULE_OCCURRENCE_STACK;return uZ(this.LAST_EXPLICIT_RULE_STACK)||(t=pZ(this.LAST_EXPLICIT_RULE_STACK,(function(t){return e.RULE_STACK[t]})),n=pZ(this.LAST_EXPLICIT_RULE_STACK,(function(t){return e.RULE_OCCURRENCE_STACK[t]}))),pZ(t,(function(r,i){return 0===i?B1:{ruleName:e.shortRuleNameToFullName(r),idxInCallingRule:n[i],inRule:e.shortRuleNameToFullName(t[i-1])}}))},e.prototype.flattenFollowSet=function(){var e=this;return gZ(pZ(this.buildFullFollowKeyStack(),(function(t){return e.getFollowSetFromFollowKey(t)})))},e.prototype.getFollowSetFromFollowKey=function(e){if(e===B1)return[s0];var t=e.ruleName+e.idxInCallingRule+O0+e.inRule;return this.resyncFollows[t]},e.prototype.addToResyncTokens=function(e,t){return this.tokenMatcher(e,s0)||t.push(e),t},e.prototype.reSyncTo=function(e){for(var t=[],n=this.LA(1);!1===this.tokenMatcher(n,e);)n=this.SKIP_TOKEN(),this.addToResyncTokens(n,t);return RZ(t)},e.prototype.attemptInRepetitionRecovery=function(e,t,n,r,i,o,s){},e.prototype.getCurrentGrammarPath=function(e,t){return{ruleStack:this.getHumanReadableRuleStack(),occurrenceStack:MZ(this.RULE_OCCURRENCE_STACK),lastTok:e,lastTokOccurrence:t}},e.prototype.getHumanReadableRuleStack=function(){var e=this;return uZ(this.LAST_EXPLICIT_RULE_STACK)?pZ(this.RULE_STACK,(function(t){return e.shortRuleNameToFullName(t)})):pZ(this.LAST_EXPLICIT_RULE_STACK,(function(t){return e.shortRuleNameToFullName(e.RULE_STACK[t])}))},e}();function z1(e,t,n,r,i,o,s){var a=this.getKeyForAutomaticLookahead(r,i),l=this.firstAfterRepMap[a];if(void 0===l){var h=this.getCurrRuleFullName();l=new o(this.getGAstProductions()[h],i).startWalking(),this.firstAfterRepMap[a]=l}var u=l.token,c=l.occurrence,d=l.isEndOfRule;1===this.RULE_STACK.length&&d&&void 0===u&&(u=s0,c=1),this.shouldInRepetitionRecoveryBeTried(u,c,s)&&this.tryInRepetitionRecovery(e,t,n,u)}var $1=function(){function e(){}return e.prototype.initLooksAhead=function(e){this.dynamicTokensEnabled=NZ(e,"dynamicTokensEnabled")?e.dynamicTokensEnabled:R2.dynamicTokensEnabled,this.maxLookahead=NZ(e,"maxLookahead")?e.maxLookahead:R2.maxLookahead,this.lookAheadFuncsCache=XZ()?new Map:[],XZ()?(this.getLaFuncFromCache=this.getLaFuncFromMap,this.setLaFuncCache=this.setLaFuncCacheUsingMap):(this.getLaFuncFromCache=this.getLaFuncFromObj,this.setLaFuncCache=this.setLaFuncUsingObj)},e.prototype.preComputeLookaheadFunctions=function(e){var t=this;wZ(e,(function(e){t.TRACE_INIT(e.name+" Rule Lookahead",(function(){var n=function(e){M0.reset(),e.accept(M0);var t=M0.dslMethods;return M0.reset(),t}(e),r=n.alternation,i=n.repetition,o=n.option,s=n.repetitionMandatory,a=n.repetitionMandatoryWithSeparator,l=n.repetitionWithSeparator;wZ(r,(function(n){var r=0===n.idx?"":n.idx;t.TRACE_INIT(""+A0(n)+r,(function(){var r,i,o,s,a,l,h,u=(r=n.idx,i=e,o=n.maxLookahead||t.maxLookahead,s=n.hasPredicates,a=t.dynamicTokensEnabled,l=t.lookAheadBuilderForAlternatives,h=u1(r,i,o),l(h,s,p1(h)?FJ:kJ,a)),c=V0(t.fullRuleNameToShort[e.name],_0,n.idx);t.setLaFuncCache(c,u)}))})),wZ(i,(function(n){t.computeLookaheadFunc(e,n.idx,H0,n1.REPETITION,n.maxLookahead,A0(n))})),wZ(o,(function(n){t.computeLookaheadFunc(e,n.idx,L0,n1.OPTION,n.maxLookahead,A0(n))})),wZ(s,(function(n){t.computeLookaheadFunc(e,n.idx,k0,n1.REPETITION_MANDATORY,n.maxLookahead,A0(n))})),wZ(a,(function(n){t.computeLookaheadFunc(e,n.idx,D0,n1.REPETITION_MANDATORY_WITH_SEPARATOR,n.maxLookahead,A0(n))})),wZ(l,(function(n){t.computeLookaheadFunc(e,n.idx,F0,n1.REPETITION_WITH_SEPARATOR,n.maxLookahead,A0(n))}))}))}))},e.prototype.computeLookaheadFunc=function(e,t,n,r,i,o){var s=this;this.TRACE_INIT(""+o+(0===t?"":t),(function(){var o=function(e,t,n,r,i,o){var s=c1(e,t,i,n),a=p1(s)?FJ:kJ;return o(s[0],a,r)}(t,e,i||s.maxLookahead,s.dynamicTokensEnabled,r,s.lookAheadBuilderForOptional),a=V0(s.fullRuleNameToShort[e.name],n,t);s.setLaFuncCache(a,o)}))},e.prototype.lookAheadBuilderForOptional=function(e,t,n){return function(e,t,n){var r=FZ(e,(function(e){return 1===e.length})),i=e.length;if(r&&!n){var o=gZ(e);if(1===o.length&&uZ(o[0].categoryMatches)){var s=o[0].tokenTypeIdx;return function(){return this.LA(1).tokenTypeIdx===s}}var a=xZ(o,(function(e,t,n){return e[t.tokenTypeIdx]=!0,wZ(t.categoryMatches,(function(t){e[t]=!0})),e}),[]);return function(){var e=this.LA(1);return!0===a[e.tokenTypeIdx]}}return function(){e:for(var n=0;n<i;n++){for(var r=e[n],o=r.length,s=0;s<o;s++){var a=this.LA(s+1);if(!1===t(a,r[s]))continue e}return!0}return!1}}(e,t,n)},e.prototype.lookAheadBuilderForAlternatives=function(e,t,n,r){return function(e,t,n,r){var i=e.length,o=FZ(e,(function(e){return FZ(e,(function(e){return 1===e.length}))}));if(t)return function(t){for(var r=pZ(t,(function(e){return e.GATE})),o=0;o<i;o++){var s=e[o],a=s.length,l=r[o];if(void 0===l||!1!==l.call(this))e:for(var h=0;h<a;h++){for(var u=s[h],c=u.length,d=0;d<c;d++){var p=this.LA(d+1);if(!1===n(p,u[d]))continue e}return o}}};if(o&&!r){var s=xZ(pZ(e,(function(e){return gZ(e)})),(function(e,t,n){return wZ(t,(function(t){NZ(e,t.tokenTypeIdx)||(e[t.tokenTypeIdx]=n),wZ(t.categoryMatches,(function(t){NZ(e,t)||(e[t]=n)}))})),e}),[]);return function(){var e=this.LA(1);return s[e.tokenTypeIdx]}}return function(){for(var t=0;t<i;t++){var r=e[t],o=r.length;e:for(var s=0;s<o;s++){for(var a=r[s],l=a.length,h=0;h<l;h++){var u=this.LA(h+1);if(!1===n(u,a[h]))continue e}return t}}}}(e,t,n,r)},e.prototype.getKeyForAutomaticLookahead=function(e,t){return V0(this.getLastExplicitRuleShortName(),e,t)},e.prototype.getLaFuncFromCache=function(e){},e.prototype.getLaFuncFromMap=function(e){return this.lookAheadFuncsCache.get(e)},e.prototype.getLaFuncFromObj=function(e){return this.lookAheadFuncsCache[e]},e.prototype.setLaFuncCache=function(e,t){},e.prototype.setLaFuncCacheUsingMap=function(e,t){this.lookAheadFuncsCache.set(e,t)},e.prototype.setLaFuncUsingObj=function(e,t){this.lookAheadFuncsCache[e]=t},e}();var Y1,K1=/^\s*function\s*(\S*)\s*\(/,X1="name";function q1(e){var t=e.name;return t||e.toString().match(K1)[1]}function Q1(e,t){var n=Object.getOwnPropertyDescriptor(e,X1);return!(!vZ(n)&&!n.configurable)&&(Object.defineProperty(e,X1,{enumerable:!1,configurable:!0,writable:!1,value:t}),!0)}function Z1(e,t){for(var n=cZ(e),r=n.length,i=0;i<r;i++)for(var o=e[n[i]],s=o.length,a=0;a<s;a++){var l=o[a];void 0===l.tokenTypeIdx&&(void 0!==l.fullName?this[l.fullName](l.children,t):this[l.name](l.children,t))}}function J1(e,t){var n=function(){};Q1(n,e+"BaseSemantics");var r={visit:function(e,t){if(LZ(e)&&(e=e[0]),!vZ(e))return void 0!==e.fullName?this[e.fullName](e.children,t):this[e.name](e.children,t)},validateVisitor:function(){var e=function(e,t){var n=function(e,t){var n=pZ(t,(function(t){if(!CZ(e[t]))return{msg:"Missing visitor method: <"+t+"> on "+q1(e.constructor)+" CST Visitor.",type:Y1.MISSING_METHOD,methodName:t}}));return PZ(n)}(e,t),r=function(e,t){var n=[];for(var r in e)v1.test(r)&&CZ(e[r])&&!AZ(e2,r)&&!AZ(t,r)&&n.push({msg:"Redundant visitor method: <"+r+"> on "+q1(e.constructor)+" CST Visitor\nThere is no Grammar Rule corresponding to this method's name.\nFor utility methods on visitor classes use methods names that do not match /"+v1.source+"/.",type:Y1.REDUNDANT_METHOD,methodName:r});return n}(e,t);return n.concat(r)}(this,t);if(!uZ(e)){var n=pZ(e,(function(e){return e.msg}));throw Error("Errors Detected in CST Visitor <"+q1(this.constructor)+">:\n\t"+n.join("\n\n").replace(/\n/g,"\n\t"))}}};return(n.prototype=r).constructor=n,n._RULE_NAMES=t,n}!function(e){e[e.REDUNDANT_METHOD=0]="REDUNDANT_METHOD",e[e.MISSING_METHOD=1]="MISSING_METHOD"}(Y1||(Y1={}));var e2=["constructor","visit","validateVisitor"];var t2=function(){function e(){}return e.prototype.initTreeBuilder=function(e){if(this.LAST_EXPLICIT_RULE_STACK=[],this.CST_STACK=[],this.outputCst=NZ(e,"outputCst")?e.outputCst:R2.outputCst,this.nodeLocationTracking=NZ(e,"nodeLocationTracking")?e.nodeLocationTracking:R2.nodeLocationTracking,this.outputCst)if(/full/i.test(this.nodeLocationTracking))this.recoveryEnabled?(this.setNodeLocationFromToken=j0,this.setNodeLocationFromNode=j0,this.cstPostRule=zZ,this.setInitialNodeLocation=this.setInitialNodeLocationFullRecovery):(this.setNodeLocationFromToken=zZ,this.setNodeLocationFromNode=zZ,this.cstPostRule=this.cstPostRuleFull,this.setInitialNodeLocation=this.setInitialNodeLocationFullRegular);else if(/onlyOffset/i.test(this.nodeLocationTracking))this.recoveryEnabled?(this.setNodeLocationFromToken=W0,this.setNodeLocationFromNode=W0,this.cstPostRule=zZ,this.setInitialNodeLocation=this.setInitialNodeLocationOnlyOffsetRecovery):(this.setNodeLocationFromToken=zZ,this.setNodeLocationFromNode=zZ,this.cstPostRule=this.cstPostRuleOnlyOffset,this.setInitialNodeLocation=this.setInitialNodeLocationOnlyOffsetRegular);else{if(!/none/i.test(this.nodeLocationTracking))throw Error('Invalid <nodeLocationTracking> config option: "'+e.nodeLocationTracking+'"');this.setNodeLocationFromToken=zZ,this.setNodeLocationFromNode=zZ,this.cstPostRule=zZ,this.setInitialNodeLocation=zZ}else this.cstInvocationStateUpdate=zZ,this.cstFinallyStateUpdate=zZ,this.cstPostTerminal=zZ,this.cstPostNonTerminal=zZ,this.cstPostRule=zZ,this.getLastExplicitRuleShortName=this.getLastExplicitRuleShortNameNoCst,this.getPreviousExplicitRuleShortName=this.getPreviousExplicitRuleShortNameNoCst,this.getLastExplicitRuleOccurrenceIndex=this.getLastExplicitRuleOccurrenceIndexNoCst,this.manyInternal=this.manyInternalNoCst,this.orInternal=this.orInternalNoCst,this.optionInternal=this.optionInternalNoCst,this.atLeastOneInternal=this.atLeastOneInternalNoCst,this.manySepFirstInternal=this.manySepFirstInternalNoCst,this.atLeastOneSepFirstInternal=this.atLeastOneSepFirstInternalNoCst},e.prototype.setInitialNodeLocationOnlyOffsetRecovery=function(e){e.location={startOffset:NaN,endOffset:NaN}},e.prototype.setInitialNodeLocationOnlyOffsetRegular=function(e){e.location={startOffset:this.LA(1).startOffset,endOffset:NaN}},e.prototype.setInitialNodeLocationFullRecovery=function(e){e.location={startOffset:NaN,startLine:NaN,startColumn:NaN,endOffset:NaN,endLine:NaN,endColumn:NaN}},e.prototype.setInitialNodeLocationFullRegular=function(e){var t=this.LA(1);e.location={startOffset:t.startOffset,startLine:t.startLine,startColumn:t.startColumn,endOffset:NaN,endLine:NaN,endColumn:NaN}},e.prototype.cstNestedInvocationStateUpdate=function(e,t){var n={name:e,fullName:this.shortRuleNameToFull[this.getLastExplicitRuleShortName()]+e,children:{}};this.setInitialNodeLocation(n),this.CST_STACK.push(n)},e.prototype.cstInvocationStateUpdate=function(e,t){this.LAST_EXPLICIT_RULE_STACK.push(this.RULE_STACK.length-1);var n={name:e,children:{}};this.setInitialNodeLocation(n),this.CST_STACK.push(n)},e.prototype.cstFinallyStateUpdate=function(){this.LAST_EXPLICIT_RULE_STACK.pop(),this.CST_STACK.pop()},e.prototype.cstNestedFinallyStateUpdate=function(){var e=this.CST_STACK.pop();this.cstPostRule(e)},e.prototype.cstPostRuleFull=function(e){var t=this.LA(0),n=e.location;n.startOffset<=t.startOffset==!0?(n.endOffset=t.endOffset,n.endLine=t.endLine,n.endColumn=t.endColumn):(n.startOffset=NaN,n.startLine=NaN,n.startColumn=NaN)},e.prototype.cstPostRuleOnlyOffset=function(e){var t=this.LA(0),n=e.location;n.startOffset<=t.startOffset==!0?n.endOffset=t.endOffset:n.startOffset=NaN},e.prototype.cstPostTerminal=function(e,t){var n,r,i,o=this.CST_STACK[this.CST_STACK.length-1];r=t,i=e,void 0===(n=o).children[i]?n.children[i]=[r]:n.children[i].push(r),this.setNodeLocationFromToken(o.location,t)},e.prototype.cstPostNonTerminal=function(e,t){if(!0!==this.isBackTracking()){var n=this.CST_STACK[this.CST_STACK.length-1];G0(n,t,e),this.setNodeLocationFromNode(n.location,e.location)}},e.prototype.getBaseCstVisitorConstructor=function(){if(vZ(this.baseCstVisitorConstructor)){var e=J1(this.className,this.allRuleNames);return this.baseCstVisitorConstructor=e,e}return this.baseCstVisitorConstructor},e.prototype.getBaseCstVisitorConstructorWithDefaults=function(){if(vZ(this.baseCstVisitorWithDefaultsConstructor)){var e=function(e,t,n){var r=function(){};Q1(r,e+"BaseSemanticsWithDefaults");var i=Object.create(n.prototype);return wZ(t,(function(e){i[e]=Z1})),(r.prototype=i).constructor=r,r}(this.className,this.allRuleNames,this.getBaseCstVisitorConstructor());return this.baseCstVisitorWithDefaultsConstructor=e,e}return this.baseCstVisitorWithDefaultsConstructor},e.prototype.nestedRuleBeforeClause=function(e,t){var n;return void 0!==e.NAME?(n=e.NAME,this.nestedRuleInvocationStateUpdate(n,t),n):void 0},e.prototype.nestedAltBeforeClause=function(e,t,n,r){var i,o=U0(this.getLastExplicitRuleShortName(),n,t,r);return void 0!==e.NAME?(i=e.NAME,this.nestedRuleInvocationStateUpdate(i,o),{shortName:o,nestedName:i}):void 0},e.prototype.nestedRuleFinallyClause=function(e,t){var n=this.CST_STACK,r=n[n.length-1];this.nestedRuleFinallyStateUpdate();var i=n[n.length-1];G0(i,t,r),this.setNodeLocationFromNode(i.location,r.location)},e.prototype.getLastExplicitRuleShortName=function(){var e=this.LAST_EXPLICIT_RULE_STACK[this.LAST_EXPLICIT_RULE_STACK.length-1];return this.RULE_STACK[e]},e.prototype.getLastExplicitRuleShortNameNoCst=function(){var e=this.RULE_STACK;return e[e.length-1]},e.prototype.getPreviousExplicitRuleShortName=function(){var e=this.LAST_EXPLICIT_RULE_STACK[this.LAST_EXPLICIT_RULE_STACK.length-2];return this.RULE_STACK[e]},e.prototype.getPreviousExplicitRuleShortNameNoCst=function(){var e=this.RULE_STACK;return e[e.length-2]},e.prototype.getLastExplicitRuleOccurrenceIndex=function(){var e=this.LAST_EXPLICIT_RULE_STACK[this.LAST_EXPLICIT_RULE_STACK.length-1];return this.RULE_OCCURRENCE_STACK[e]},e.prototype.getLastExplicitRuleOccurrenceIndexNoCst=function(){var e=this.RULE_OCCURRENCE_STACK;return e[e.length-1]},e.prototype.nestedRuleInvocationStateUpdate=function(e,t){this.RULE_OCCURRENCE_STACK.push(1),this.RULE_STACK.push(t),this.cstNestedInvocationStateUpdate(e,t)},e.prototype.nestedRuleFinallyStateUpdate=function(){this.RULE_STACK.pop(),this.RULE_OCCURRENCE_STACK.pop(),this.cstNestedFinallyStateUpdate()},e}(),n2=function(){function e(){}return e.prototype.initLexerAdapter=function(){this.tokVector=[],this.tokVectorLength=0,this.currIdx=-1},Object.defineProperty(e.prototype,"input",{get:function(){return this.tokVector},set:function(e){if(!0!==this.selfAnalysisDone)throw Error("Missing <performSelfAnalysis> invocation at the end of the Parser's constructor.");this.reset(),this.tokVector=e,this.tokVectorLength=e.length},enumerable:!0,configurable:!0}),e.prototype.SKIP_TOKEN=function(){return this.currIdx<=this.tokVector.length-2?(this.consumeToken(),this.LA(1)):C2},e.prototype.LA=function(e){var t=this.currIdx+e;return t<0||this.tokVectorLength<=t?C2:this.tokVector[t]},e.prototype.consumeToken=function(){this.currIdx++},e.prototype.exportLexerState=function(){return this.currIdx},e.prototype.importLexerState=function(e){this.currIdx=e},e.prototype.resetLexerState=function(){this.currIdx=-1},e.prototype.moveToTerminatedState=function(){this.currIdx=this.tokVector.length-1},e.prototype.getLexerPosition=function(){return this.exportLexerState()},e}(),r2=function(){function e(){}return e.prototype.ACTION=function(e){return e.call(this)},e.prototype.consume=function(e,t,n){return this.consumeInternal(t,e,n)},e.prototype.subrule=function(e,t,n){return this.subruleInternal(t,e,n)},e.prototype.option=function(e,t){return this.optionInternal(t,e)},e.prototype.or=function(e,t){return this.orInternal(t,e)},e.prototype.many=function(e,t){return this.manyInternal(e,t)},e.prototype.atLeastOne=function(e,t){return this.atLeastOneInternal(e,t)},e.prototype.CONSUME=function(e,t){return this.consumeInternal(e,0,t)},e.prototype.CONSUME1=function(e,t){return this.consumeInternal(e,1,t)},e.prototype.CONSUME2=function(e,t){return this.consumeInternal(e,2,t)},e.prototype.CONSUME3=function(e,t){return this.consumeInternal(e,3,t)},e.prototype.CONSUME4=function(e,t){return this.consumeInternal(e,4,t)},e.prototype.CONSUME5=function(e,t){return this.consumeInternal(e,5,t)},e.prototype.CONSUME6=function(e,t){return this.consumeInternal(e,6,t)},e.prototype.CONSUME7=function(e,t){return this.consumeInternal(e,7,t)},e.prototype.CONSUME8=function(e,t){return this.consumeInternal(e,8,t)},e.prototype.CONSUME9=function(e,t){return this.consumeInternal(e,9,t)},e.prototype.SUBRULE=function(e,t){return this.subruleInternal(e,0,t)},e.prototype.SUBRULE1=function(e,t){return this.subruleInternal(e,1,t)},e.prototype.SUBRULE2=function(e,t){return this.subruleInternal(e,2,t)},e.prototype.SUBRULE3=function(e,t){return this.subruleInternal(e,3,t)},e.prototype.SUBRULE4=function(e,t){return this.subruleInternal(e,4,t)},e.prototype.SUBRULE5=function(e,t){return this.subruleInternal(e,5,t)},e.prototype.SUBRULE6=function(e,t){return this.subruleInternal(e,6,t)},e.prototype.SUBRULE7=function(e,t){return this.subruleInternal(e,7,t)},e.prototype.SUBRULE8=function(e,t){return this.subruleInternal(e,8,t)},e.prototype.SUBRULE9=function(e,t){return this.subruleInternal(e,9,t)},e.prototype.OPTION=function(e){return this.optionInternal(e,0)},e.prototype.OPTION1=function(e){return this.optionInternal(e,1)},e.prototype.OPTION2=function(e){return this.optionInternal(e,2)},e.prototype.OPTION3=function(e){return this.optionInternal(e,3)},e.prototype.OPTION4=function(e){return this.optionInternal(e,4)},e.prototype.OPTION5=function(e){return this.optionInternal(e,5)},e.prototype.OPTION6=function(e){return this.optionInternal(e,6)},e.prototype.OPTION7=function(e){return this.optionInternal(e,7)},e.prototype.OPTION8=function(e){return this.optionInternal(e,8)},e.prototype.OPTION9=function(e){return this.optionInternal(e,9)},e.prototype.OR=function(e){return this.orInternal(e,0)},e.prototype.OR1=function(e){return this.orInternal(e,1)},e.prototype.OR2=function(e){return this.orInternal(e,2)},e.prototype.OR3=function(e){return this.orInternal(e,3)},e.prototype.OR4=function(e){return this.orInternal(e,4)},e.prototype.OR5=function(e){return this.orInternal(e,5)},e.prototype.OR6=function(e){return this.orInternal(e,6)},e.prototype.OR7=function(e){return this.orInternal(e,7)},e.prototype.OR8=function(e){return this.orInternal(e,8)},e.prototype.OR9=function(e){return this.orInternal(e,9)},e.prototype.MANY=function(e){this.manyInternal(0,e)},e.prototype.MANY1=function(e){this.manyInternal(1,e)},e.prototype.MANY2=function(e){this.manyInternal(2,e)},e.prototype.MANY3=function(e){this.manyInternal(3,e)},e.prototype.MANY4=function(e){this.manyInternal(4,e)},e.prototype.MANY5=function(e){this.manyInternal(5,e)},e.prototype.MANY6=function(e){this.manyInternal(6,e)},e.prototype.MANY7=function(e){this.manyInternal(7,e)},e.prototype.MANY8=function(e){this.manyInternal(8,e)},e.prototype.MANY9=function(e){this.manyInternal(9,e)},e.prototype.MANY_SEP=function(e){this.manySepFirstInternal(0,e)},e.prototype.MANY_SEP1=function(e){this.manySepFirstInternal(1,e)},e.prototype.MANY_SEP2=function(e){this.manySepFirstInternal(2,e)},e.prototype.MANY_SEP3=function(e){this.manySepFirstInternal(3,e)},e.prototype.MANY_SEP4=function(e){this.manySepFirstInternal(4,e)},e.prototype.MANY_SEP5=function(e){this.manySepFirstInternal(5,e)},e.prototype.MANY_SEP6=function(e){this.manySepFirstInternal(6,e)},e.prototype.MANY_SEP7=function(e){this.manySepFirstInternal(7,e)},e.prototype.MANY_SEP8=function(e){this.manySepFirstInternal(8,e)},e.prototype.MANY_SEP9=function(e){this.manySepFirstInternal(9,e)},e.prototype.AT_LEAST_ONE=function(e){this.atLeastOneInternal(0,e)},e.prototype.AT_LEAST_ONE1=function(e){return this.atLeastOneInternal(1,e)},e.prototype.AT_LEAST_ONE2=function(e){this.atLeastOneInternal(2,e)},e.prototype.AT_LEAST_ONE3=function(e){this.atLeastOneInternal(3,e)},e.prototype.AT_LEAST_ONE4=function(e){this.atLeastOneInternal(4,e)},e.prototype.AT_LEAST_ONE5=function(e){this.atLeastOneInternal(5,e)},e.prototype.AT_LEAST_ONE6=function(e){this.atLeastOneInternal(6,e)},e.prototype.AT_LEAST_ONE7=function(e){this.atLeastOneInternal(7,e)},e.prototype.AT_LEAST_ONE8=function(e){this.atLeastOneInternal(8,e)},e.prototype.AT_LEAST_ONE9=function(e){this.atLeastOneInternal(9,e)},e.prototype.AT_LEAST_ONE_SEP=function(e){this.atLeastOneSepFirstInternal(0,e)},e.prototype.AT_LEAST_ONE_SEP1=function(e){this.atLeastOneSepFirstInternal(1,e)},e.prototype.AT_LEAST_ONE_SEP2=function(e){this.atLeastOneSepFirstInternal(2,e)},e.prototype.AT_LEAST_ONE_SEP3=function(e){this.atLeastOneSepFirstInternal(3,e)},e.prototype.AT_LEAST_ONE_SEP4=function(e){this.atLeastOneSepFirstInternal(4,e)},e.prototype.AT_LEAST_ONE_SEP5=function(e){this.atLeastOneSepFirstInternal(5,e)},e.prototype.AT_LEAST_ONE_SEP6=function(e){this.atLeastOneSepFirstInternal(6,e)},e.prototype.AT_LEAST_ONE_SEP7=function(e){this.atLeastOneSepFirstInternal(7,e)},e.prototype.AT_LEAST_ONE_SEP8=function(e){this.atLeastOneSepFirstInternal(8,e)},e.prototype.AT_LEAST_ONE_SEP9=function(e){this.atLeastOneSepFirstInternal(9,e)},e.prototype.RULE=function(e,t,n){if(void 0===n&&(n=E2),AZ(this.definedRulesNames,e)){var r={message:A1.buildDuplicateRuleNameError({topLevelRule:e,grammarName:this.className}),type:S2.DUPLICATE_RULE_NAME,ruleName:e};this.definitionErrors.push(r)}this.definedRulesNames.push(e);var i=this.defineRule(e,t,n);return this[e]=i,i},e.prototype.OVERRIDE_RULE=function(e,t,n){void 0===n&&(n=E2);var r,i,o,s,a,l=[];l=l.concat((r=e,i=this.definedRulesNames,o=this.className,a=[],AZ(i,r)||(s="Invalid rule override, rule: ->"+r+"<- cannot be overridden in the grammar: ->"+o+"<-as it is not defined in any of the super grammars ",a.push({message:s,type:S2.INVALID_RULE_OVERRIDE,ruleName:r})),a)),this.definitionErrors.push.apply(this.definitionErrors,l);var h=this.defineRule(e,t,n);return this[e]=h,h},e.prototype.BACKTRACK=function(e,t){return function(){this.isBackTrackingStack.push(1);var n=this.saveRecogState();try{return e.apply(this,t),!0}catch(r){if(k1(r))return!1;throw r}finally{this.reloadRecogState(n),this.isBackTrackingStack.pop()}}},e.prototype.getGAstProductions=function(){return this.gastProductionsCache},e.prototype.getSerializedGastProductions=function(){return pZ(dZ(this.gastProductionsCache),S0)},e}(),i2=function(){function e(){}return e.prototype.initRecognizerEngine=function(e,t){if(this.className=q1(this.constructor),this.shortRuleNameToFull={},this.fullRuleNameToShort={},this.ruleShortNameIdx=256,this.tokenMatcher=FJ,this.definedRulesNames=[],this.tokensMap={},this.allRuleNames=[],this.isBackTrackingStack=[],this.RULE_STACK=[],this.RULE_OCCURRENCE_STACK=[],this.gastProductionsCache={},NZ(t,"serializedGrammar"))throw Error("The Parser's configuration can no longer contain a <serializedGrammar> property.\n\tSee: https://sap.github.io/chevrotain/docs/changes/BREAKING_CHANGES.html#_6-0-0\n\tFor Further details.");if(LZ(e)){if(uZ(e))throw Error("A Token Vocabulary cannot be empty.\n\tNote that the first argument for the parser constructor\n\tis no longer a Token vector (since v4.0).");if("number"==typeof e[0].startOffset)throw Error("The Parser constructor no longer accepts a token vector as the first argument.\n\tSee: https://sap.github.io/chevrotain/docs/changes/BREAKING_CHANGES.html#_4-0-0\n\tFor Further details.")}if(LZ(e))this.tokensMap=xZ(e,(function(e,t){return e[t.name]=t,e}),{});else if(NZ(e,"modes")&&FZ(gZ(dZ(e.modes)),GJ)){var n=_Z(gZ(dZ(e.modes)));this.tokensMap=xZ(n,(function(e,t){return e[t.name]=t,e}),{})}else{if(!kZ(e))throw new Error("<tokensDictionary> argument must be An Array of Token constructors, A dictionary of Token constructors or an IMultiModeLexerDefinition");this.tokensMap=IZ(e)}this.tokensMap.EOF=s0;var r=FZ(dZ(e),(function(e){return uZ(e.categoryMatches)}));this.tokenMatcher=r?FJ:kJ,UJ(dZ(this.tokensMap))},e.prototype.defineRule=function(e,t,n){if(this.selfAnalysisDone)throw Error("Grammar rule <"+e+"> may not be defined after the 'performSelfAnalysis' method has been called'\nMake sure that all grammar rule definitions are done before 'performSelfAnalysis' is called.");var r,i=NZ(n,"resyncEnabled")?n.resyncEnabled:E2.resyncEnabled,o=NZ(n,"recoveryValueFunc")?n.recoveryValueFunc:E2.recoveryValueFunc,s=this.ruleShortNameIdx<<12;function a(e){try{if(!0===this.outputCst){t.apply(this,e);var n=this.CST_STACK[this.CST_STACK.length-1];return this.cstPostRule(n),n}return t.apply(this,e)}catch(r){return this.invokeRuleCatch(r,i,o)}finally{this.ruleFinallyStateUpdate()}}this.ruleShortNameIdx++,this.shortRuleNameToFull[s]=e,this.fullRuleNameToShort[e]=s;return(r=function(t,n){return void 0===t&&(t=0),this.ruleInvocationStateUpdate(s,e,t),a.call(this,n)}).ruleName=e,r.originalGrammarAction=t,r},e.prototype.invokeRuleCatch=function(e,t,n){var r=1===this.RULE_STACK.length,i=t&&!this.isBackTracking()&&this.recoveryEnabled;if(k1(e)){var o=e;if(i){var s,a=this.findReSyncTokenType();if(this.isInCurrentRuleReSyncSet(a))return o.resyncedTokens=this.reSyncTo(a),this.outputCst?((s=this.CST_STACK[this.CST_STACK.length-1]).recoveredNode=!0,s):n();throw this.outputCst&&((s=this.CST_STACK[this.CST_STACK.length-1]).recoveredNode=!0,o.partialCstResult=s),o}if(r)return this.moveToTerminatedState(),n();throw o}throw e},e.prototype.optionInternal=function(e,t){var n=this.getKeyForAutomaticLookahead(L0,t),r=this.nestedRuleBeforeClause(e,n);try{return this.optionInternalLogic(e,t,n)}finally{void 0!==r&&this.nestedRuleFinallyClause(n,r)}},e.prototype.optionInternalNoCst=function(e,t){var n=this.getKeyForAutomaticLookahead(L0,t);return this.optionInternalLogic(e,t,n)},e.prototype.optionInternalLogic=function(e,t,n){var r,i,o=this,s=this.getLaFuncFromCache(n);if(void 0!==e.DEF){if(r=e.DEF,void 0!==(i=e.GATE)){var a=s;s=function(){return i.call(o)&&a.call(o)}}}else r=e;if(!0===s.call(this))return r.call(this)},e.prototype.atLeastOneInternal=function(e,t){var n=this.getKeyForAutomaticLookahead(k0,e),r=this.nestedRuleBeforeClause(t,n);try{return this.atLeastOneInternalLogic(e,t,n)}finally{void 0!==r&&this.nestedRuleFinallyClause(n,r)}},e.prototype.atLeastOneInternalNoCst=function(e,t){var n=this.getKeyForAutomaticLookahead(k0,e);this.atLeastOneInternalLogic(e,t,n)},e.prototype.atLeastOneInternalLogic=function(e,t,n){var r,i,o=this,s=this.getLaFuncFromCache(n);if(void 0!==t.DEF){if(r=t.DEF,void 0!==(i=t.GATE)){var a=s;s=function(){return i.call(o)&&a.call(o)}}}else r=t;if(!0!==s.call(this))throw this.raiseEarlyExitException(e,n1.REPETITION_MANDATORY,t.ERR_MSG);for(var l=this.doSingleRepetition(r);!0===s.call(this)&&!0===l;)l=this.doSingleRepetition(r);this.attemptInRepetitionRecovery(this.atLeastOneInternal,[e,t],s,k0,e,Q0)},e.prototype.atLeastOneSepFirstInternal=function(e,t){var n=this.getKeyForAutomaticLookahead(D0,e),r=this.nestedRuleBeforeClause(t,n);try{this.atLeastOneSepFirstInternalLogic(e,t,n)}finally{void 0!==r&&this.nestedRuleFinallyClause(n,r)}},e.prototype.atLeastOneSepFirstInternalNoCst=function(e,t){var n=this.getKeyForAutomaticLookahead(D0,e);this.atLeastOneSepFirstInternalLogic(e,t,n)},e.prototype.atLeastOneSepFirstInternalLogic=function(e,t,n){var r=this,i=t.DEF,o=t.SEP;if(!0!==this.getLaFuncFromCache(n).call(this))throw this.raiseEarlyExitException(e,n1.REPETITION_MANDATORY_WITH_SEPARATOR,t.ERR_MSG);i.call(this);for(var s=function(){return r.tokenMatcher(r.LA(1),o)};!0===this.tokenMatcher(this.LA(1),o);)this.CONSUME(o),i.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,o,s,i,Z0],s,D0,e,Z0)},e.prototype.manyInternal=function(e,t){var n=this.getKeyForAutomaticLookahead(H0,e),r=this.nestedRuleBeforeClause(t,n);try{return this.manyInternalLogic(e,t,n)}finally{void 0!==r&&this.nestedRuleFinallyClause(n,r)}},e.prototype.manyInternalNoCst=function(e,t){var n=this.getKeyForAutomaticLookahead(H0,e);return this.manyInternalLogic(e,t,n)},e.prototype.manyInternalLogic=function(e,t,n){var r,i,o=this,s=this.getLaFuncFromCache(n);if(void 0!==t.DEF){if(r=t.DEF,void 0!==(i=t.GATE)){var a=s;s=function(){return i.call(o)&&a.call(o)}}}else r=t;for(var l=!0;!0===s.call(this)&&!0===l;)l=this.doSingleRepetition(r);this.attemptInRepetitionRecovery(this.manyInternal,[e,t],s,H0,e,X0,l)},e.prototype.manySepFirstInternal=function(e,t){var n=this.getKeyForAutomaticLookahead(F0,e),r=this.nestedRuleBeforeClause(t,n);try{this.manySepFirstInternalLogic(e,t,n)}finally{void 0!==r&&this.nestedRuleFinallyClause(n,r)}},e.prototype.manySepFirstInternalNoCst=function(e,t){var n=this.getKeyForAutomaticLookahead(F0,e);this.manySepFirstInternalLogic(e,t,n)},e.prototype.manySepFirstInternalLogic=function(e,t,n){var r=this,i=t.DEF,o=t.SEP;if(!0===this.getLaFuncFromCache(n).call(this)){i.call(this);for(var s=function(){return r.tokenMatcher(r.LA(1),o)};!0===this.tokenMatcher(this.LA(1),o);)this.CONSUME(o),i.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,o,s,i,q0],s,F0,e,q0)}},e.prototype.repetitionSepSecondInternal=function(e,t,n,r,i){for(;n();)this.CONSUME(t),r.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,t,n,r,i],n,D0,e,i)},e.prototype.doSingleRepetition=function(e){var t=this.getLexerPosition();return e.call(this),this.getLexerPosition()>t},e.prototype.orInternalNoCst=function(e,t){var n=LZ(e)?e:e.DEF,r=this.getKeyForAutomaticLookahead(_0,t),i=this.getLaFuncFromCache(r).call(this,n);if(void 0!==i)return n[i].ALT.call(this);this.raiseNoAltException(t,e.ERR_MSG)},e.prototype.orInternal=function(e,t){var n=this.getKeyForAutomaticLookahead(_0,t),r=this.nestedRuleBeforeClause(e,n);try{var i=LZ(e)?e:e.DEF,o=this.getLaFuncFromCache(n).call(this,i);if(void 0!==o){var s=i[o],a=this.nestedAltBeforeClause(s,t,_0,o);try{return s.ALT.call(this)}finally{void 0!==a&&this.nestedRuleFinallyClause(a.shortName,a.nestedName)}}this.raiseNoAltException(t,e.ERR_MSG)}finally{void 0!==r&&this.nestedRuleFinallyClause(n,r)}},e.prototype.ruleFinallyStateUpdate=function(){if(this.RULE_STACK.pop(),this.RULE_OCCURRENCE_STACK.pop(),this.cstFinallyStateUpdate(),0===this.RULE_STACK.length&&!1===this.isAtEndOfInput()){var e=this.LA(1),t=this.errorMessageProvider.buildNotAllInputParsedMessage({firstRedundant:e,ruleName:this.getCurrRuleFullName()});this.SAVE_ERROR(new V1(t,e))}},e.prototype.subruleInternal=function(e,t,n){var r;try{var i=void 0!==n?n.ARGS:void 0;return r=e.call(this,t,i),this.cstPostNonTerminal(r,void 0!==n&&void 0!==n.LABEL?n.LABEL:e.ruleName),r}catch(o){this.subruleInternalError(o,n,e.ruleName)}},e.prototype.subruleInternalError=function(e,t,n){throw k1(e)&&void 0!==e.partialCstResult&&(this.cstPostNonTerminal(e.partialCstResult,void 0!==t&&void 0!==t.LABEL?t.LABEL:n),delete e.partialCstResult),e},e.prototype.consumeInternal=function(e,t,n){var r;try{var i=this.LA(1);!0===this.tokenMatcher(i,e)?(this.consumeToken(),r=i):this.consumeInternalError(e,i,n)}catch(o){r=this.consumeInternalRecovery(e,t,o)}return this.cstPostTerminal(void 0!==n&&void 0!==n.LABEL?n.LABEL:e.name,r),r},e.prototype.consumeInternalError=function(e,t,n){var r,i=this.LA(0);throw r=void 0!==n&&n.ERR_MSG?n.ERR_MSG:this.errorMessageProvider.buildMismatchTokenMessage({expected:e,actual:t,previous:i,ruleName:this.getCurrRuleFullName()}),this.SAVE_ERROR(new F1(r,t,i))},e.prototype.consumeInternalRecovery=function(e,t,n){if(!this.recoveryEnabled||"MismatchedTokenException"!==n.name||this.isBackTracking())throw n;var r=this.getFollowsForInRuleRecovery(e,t);try{return this.tryInRuleRecovery(e,r)}catch(i){throw i.name===W1?n:i}},e.prototype.saveRecogState=function(){var e=this.errors,t=MZ(this.RULE_STACK);return{errors:e,lexerState:this.exportLexerState(),RULE_STACK:t,CST_STACK:this.CST_STACK,LAST_EXPLICIT_RULE_STACK:this.LAST_EXPLICIT_RULE_STACK}},e.prototype.reloadRecogState=function(e){this.errors=e.errors,this.importLexerState(e.lexerState),this.RULE_STACK=e.RULE_STACK},e.prototype.ruleInvocationStateUpdate=function(e,t,n){this.RULE_OCCURRENCE_STACK.push(n),this.RULE_STACK.push(e),this.cstInvocationStateUpdate(t,e)},e.prototype.isBackTracking=function(){return 0!==this.isBackTrackingStack.length},e.prototype.getCurrRuleFullName=function(){var e=this.getLastExplicitRuleShortName();return this.shortRuleNameToFull[e]},e.prototype.shortRuleNameToFullName=function(e){return this.shortRuleNameToFull[e]},e.prototype.isAtEndOfInput=function(){return this.tokenMatcher(this.LA(1),s0)},e.prototype.reset=function(){this.resetLexerState(),this.isBackTrackingStack=[],this.errors=[],this.RULE_STACK=[],this.LAST_EXPLICIT_RULE_STACK=[],this.CST_STACK=[],this.RULE_OCCURRENCE_STACK=[]},e}(),o2=function(){function e(){}return e.prototype.initErrorHandler=function(e){this._errors=[],this.errorMessageProvider=WZ(e.errorMessageProvider,R2.errorMessageProvider)},e.prototype.SAVE_ERROR=function(e){if(k1(e))return e.context={ruleStack:this.getHumanReadableRuleStack(),ruleOccurrenceStack:MZ(this.RULE_OCCURRENCE_STACK)},this._errors.push(e),e;throw Error("Trying to save an Error which is not a RecognitionException")},Object.defineProperty(e.prototype,"errors",{get:function(){return MZ(this._errors)},set:function(e){this._errors=e},enumerable:!0,configurable:!0}),e.prototype.raiseEarlyExitException=function(e,t,n){for(var r=this.getCurrRuleFullName(),i=c1(e,this.getGAstProductions()[r],t,this.maxLookahead)[0],o=[],s=1;s<=this.maxLookahead;s++)o.push(this.LA(s));var a=this.errorMessageProvider.buildEarlyExitMessage({expectedIterationPaths:i,actual:o,previous:this.LA(0),customUserDescription:n,ruleName:r});throw this.SAVE_ERROR(new U1(a,this.LA(1),this.LA(0)))},e.prototype.raiseNoAltException=function(e,t){for(var n=this.getCurrRuleFullName(),r=u1(e,this.getGAstProductions()[n],this.maxLookahead),i=[],o=1;o<=this.maxLookahead;o++)i.push(this.LA(o));var s=this.LA(0),a=this.errorMessageProvider.buildNoViableAltMessage({expectedPathsPerAlt:r,actual:i,previous:s,customUserDescription:t,ruleName:this.getCurrRuleFullName()});throw this.SAVE_ERROR(new D1(a,this.LA(1),s))},e}(),s2=function(){function e(){}return e.prototype.initContentAssist=function(){},e.prototype.computeContentAssist=function(e,t){var n=this.gastProductionsCache[e];if(vZ(n))throw Error("Rule ->"+e+"<- does not exist in this grammar.");return e1([n],t,this.tokenMatcher,this.maxLookahead)},e.prototype.getNextPossibleTokenTypes=function(e){var t=mZ(e.ruleStack),n=this.getGAstProductions()[t];return new Y0(n,e).startWalking()},e}(),a2={description:"This Object indicates the Parser is during Recording Phase"};Object.freeze(a2);var l2=!0,h2=Math.pow(2,8)-1,u2=o0({name:"RECORDING_PHASE_TOKEN",pattern:YJ.NA});UJ([u2]);var c2=a0(u2,"This IToken indicates the Parser is in Recording Phase\n\tSee: https://sap.github.io/chevrotain/docs/guide/internals.html#grammar-recording for details",-1,-1,-1,-1,-1,-1);Object.freeze(c2);var d2={name:"This CSTNode indicates the Parser is in Recording Phase\n\tSee: https://sap.github.io/chevrotain/docs/guide/internals.html#grammar-recording for details",children:{}},p2=function(){function e(){}return e.prototype.initGastRecorder=function(e){this.recordingProdStack=[],this.RECORDING_PHASE=!1},e.prototype.enableRecording=function(){var e=this;this.RECORDING_PHASE=!0,this.TRACE_INIT("Enable Recording",(function(){for(var t=function(t){var n=t>0?t:"";e["CONSUME"+n]=function(e,n){return this.consumeInternalRecord(e,t,n)},e["SUBRULE"+n]=function(e,n){return this.subruleInternalRecord(e,t,n)},e["OPTION"+n]=function(e){return this.optionInternalRecord(e,t)},e["OR"+n]=function(e){return this.orInternalRecord(e,t)},e["MANY"+n]=function(e){this.manyInternalRecord(t,e)},e["MANY_SEP"+n]=function(e){this.manySepFirstInternalRecord(t,e)},e["AT_LEAST_ONE"+n]=function(e){this.atLeastOneInternalRecord(t,e)},e["AT_LEAST_ONE_SEP"+n]=function(e){this.atLeastOneSepFirstInternalRecord(t,e)}},n=0;n<10;n++)t(n);e.consume=function(e,t,n){return this.consumeInternalRecord(t,e,n)},e.subrule=function(e,t,n){return this.subruleInternalRecord(t,e,n)},e.option=function(e,t){return this.optionInternalRecord(t,e)},e.or=function(e,t){return this.orInternalRecord(t,e)},e.many=function(e,t){this.manyInternalRecord(e,t)},e.atLeastOne=function(e,t){this.atLeastOneInternalRecord(e,t)},e.ACTION=e.ACTION_RECORD,e.BACKTRACK=e.BACKTRACK_RECORD,e.LA=e.LA_RECORD}))},e.prototype.disableRecording=function(){var e=this;this.RECORDING_PHASE=!1,this.TRACE_INIT("Deleting Recording methods",(function(){for(var t=0;t<10;t++){var n=t>0?t:"";delete e["CONSUME"+n],delete e["SUBRULE"+n],delete e["OPTION"+n],delete e["OR"+n],delete e["MANY"+n],delete e["MANY_SEP"+n],delete e["AT_LEAST_ONE"+n],delete e["AT_LEAST_ONE_SEP"+n]}delete e.consume,delete e.subrule,delete e.option,delete e.or,delete e.many,delete e.atLeastOne,delete e.ACTION,delete e.BACKTRACK,delete e.LA}))},e.prototype.ACTION_RECORD=function(e){},e.prototype.BACKTRACK_RECORD=function(e,t){return function(){return!0}},e.prototype.LA_RECORD=function(e){return C2},e.prototype.topLevelRuleRecord=function(e,t){try{var n=new d0({definition:[],name:e});return n.name=e,this.recordingProdStack.push(n),t.call(this),this.recordingProdStack.pop(),n}catch(r){if(!0!==r.KNOWN_RECORDER_ERROR)try{r.message=r.message+'\n\t This error was thrown during the "grammar recording phase" For more info see:\n\thttps://sap.github.io/chevrotain/docs/guide/internals.html#grammar-recording'}catch(i){throw r}throw r}},e.prototype.optionInternalRecord=function(e,t){return g2.call(this,g0,e,t)},e.prototype.atLeastOneInternalRecord=function(e,t){g2.call(this,m0,t,e)},e.prototype.atLeastOneSepFirstInternalRecord=function(e,t){g2.call(this,f0,t,e,l2)},e.prototype.manyInternalRecord=function(e,t){g2.call(this,w0,t,e)},e.prototype.manySepFirstInternalRecord=function(e,t){g2.call(this,y0,t,e,l2)},e.prototype.orInternalRecord=function(e,t){return m2.call(this,e,t)},e.prototype.subruleInternalRecord=function(e,t,n){if(w2(t),!e||!1===NZ(e,"ruleName")){var r=new Error("<SUBRULE"+f2(t)+"> argument is invalid expecting a Parser method reference but got: <"+JSON.stringify(e)+">\n inside top level rule: <"+this.recordingProdStack[0].name+">");throw r.KNOWN_RECORDER_ERROR=!0,r}var i=QZ(this.recordingProdStack),o=e.ruleName,s=new c0({idx:t,nonTerminalName:o,referencedRule:void 0});return i.definition.push(s),this.outputCst?d2:a2},e.prototype.consumeInternalRecord=function(e,t,n){if(w2(t),!WJ(e)){var r=new Error("<CONSUME"+f2(t)+"> argument is invalid expecting a TokenType reference but got: <"+JSON.stringify(e)+">\n inside top level rule: <"+this.recordingProdStack[0].name+">");throw r.KNOWN_RECORDER_ERROR=!0,r}var i=QZ(this.recordingProdStack),o=new C0({idx:t,terminalType:e});return i.definition.push(o),c2},e}();function g2(e,t,n,r){void 0===r&&(r=!1),w2(n);var i=QZ(this.recordingProdStack),o=CZ(t)?t:t.DEF,s=new e({definition:[],idx:n});return NZ(t,"NAME")&&(s.name=t.NAME),r&&(s.separator=t.SEP),NZ(t,"MAX_LOOKAHEAD")&&(s.maxLookahead=t.MAX_LOOKAHEAD),this.recordingProdStack.push(s),o.call(this),i.definition.push(s),this.recordingProdStack.pop(),a2}function m2(e,t){var n=this;w2(t);var r=QZ(this.recordingProdStack),i=!1===LZ(e),o=!1===i?e:e.DEF,s=new v0({definition:[],idx:t,ignoreAmbiguities:i&&!0===e.IGNORE_AMBIGUITIES});NZ(e,"NAME")&&(s.name=e.NAME),NZ(e,"MAX_LOOKAHEAD")&&(s.maxLookahead=e.MAX_LOOKAHEAD);var a=VZ(o,(function(e){return CZ(e.GATE)}));return s.hasPredicates=a,r.definition.push(s),wZ(o,(function(e){var t=new p0({definition:[]});s.definition.push(t),NZ(e,"NAME")&&(t.name=e.NAME),NZ(e,"IGNORE_AMBIGUITIES")?t.ignoreAmbiguities=e.IGNORE_AMBIGUITIES:NZ(e,"GATE")&&(t.ignoreAmbiguities=!0),n.recordingProdStack.push(t),e.ALT.call(n),n.recordingProdStack.pop()})),a2}function f2(e){return 0===e?"":""+e}function w2(e){if(e<0||e>h2){var t=new Error("Invalid DSL Method idx value: <"+e+">\n\tIdx value must be a none negative value smaller than "+(h2+1));throw t.KNOWN_RECORDER_ERROR=!0,t}}var y2=function(){function e(){}return e.prototype.initPerformanceTracer=function(e){if(NZ(e,"traceInitPerf")){var t=e.traceInitPerf,n="number"==typeof t;this.traceInitMaxIdent=n?t:1/0,this.traceInitPerf=n?t>0:t}else this.traceInitMaxIdent=0,this.traceInitPerf=R2.traceInitPerf;this.traceInitIndent=-1},e.prototype.TRACE_INIT=function(e,t){if(!0===this.traceInitPerf){this.traceInitIndent++;var n=new Array(this.traceInitIndent+1).join("\t");this.traceInitIndent<this.traceInitMaxIdent&&console.log(n+"--\x3e <"+e+">");var r=ZZ(t),i=r.time,o=r.value,s=i>10?console.warn:console.log;return this.traceInitIndent<this.traceInitMaxIdent&&s(n+"<-- <"+e+"> time: "+i+"ms"),this.traceInitIndent--,o}return t()},e}(),v2=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),C2=a0(s0,"",NaN,NaN,NaN,NaN,NaN,NaN);Object.freeze(C2);var S2,R2=Object.freeze({recoveryEnabled:!1,maxLookahead:4,ignoredIssues:{},dynamicTokensEnabled:!1,outputCst:!0,errorMessageProvider:T1,nodeLocationTracking:"none",traceInitPerf:!1,skipValidations:!1}),E2=Object.freeze({recoveryValueFunc:function(){},resyncEnabled:!0});!function(e){e[e.INVALID_RULE_NAME=0]="INVALID_RULE_NAME",e[e.DUPLICATE_RULE_NAME=1]="DUPLICATE_RULE_NAME",e[e.INVALID_RULE_OVERRIDE=2]="INVALID_RULE_OVERRIDE",e[e.DUPLICATE_PRODUCTIONS=3]="DUPLICATE_PRODUCTIONS",e[e.UNRESOLVED_SUBRULE_REF=4]="UNRESOLVED_SUBRULE_REF",e[e.LEFT_RECURSION=5]="LEFT_RECURSION",e[e.NONE_LAST_EMPTY_ALT=6]="NONE_LAST_EMPTY_ALT",e[e.AMBIGUOUS_ALTS=7]="AMBIGUOUS_ALTS",e[e.CONFLICT_TOKENS_RULES_NAMESPACE=8]="CONFLICT_TOKENS_RULES_NAMESPACE",e[e.INVALID_TOKEN_NAME=9]="INVALID_TOKEN_NAME",e[e.INVALID_NESTED_RULE_NAME=10]="INVALID_NESTED_RULE_NAME",e[e.DUPLICATE_NESTED_NAME=11]="DUPLICATE_NESTED_NAME",e[e.NO_NON_EMPTY_LOOKAHEAD=12]="NO_NON_EMPTY_LOOKAHEAD",e[e.AMBIGUOUS_PREFIX_ALTS=13]="AMBIGUOUS_PREFIX_ALTS",e[e.TOO_MANY_ALTS=14]="TOO_MANY_ALTS"}(S2||(S2={}));var b2,T2=function(){function e(e,t){void 0===t&&(t=R2),this.ignoredIssues=R2.ignoredIssues,this.definitionErrors=[],this.selfAnalysisDone=!1;var n=this;n.initErrorHandler(t),n.initLexerAdapter(),n.initLooksAhead(t),n.initRecognizerEngine(e,t),n.initRecoverable(t),n.initTreeBuilder(t),n.initContentAssist(),n.initGastRecorder(t),n.initPerformanceTracer(t),NZ(t,"ignoredIssues")&&t.ignoredIssues!==R2.ignoredIssues&&KZ("The <ignoredIssues> IParserConfig property is soft-deprecated and will be removed in future versions.\n\tPlease use the <IGNORE_AMBIGUITIES> flag on the relevant DSL method instead."),this.ignoredIssues=NZ(t,"ignoredIssues")?t.ignoredIssues:R2.ignoredIssues,this.skipValidations=NZ(t,"skipValidations")?t.skipValidations:R2.skipValidations}return e.performSelfAnalysis=function(e){e.performSelfAnalysis()},e.prototype.performSelfAnalysis=function(){var t=this;this.TRACE_INIT("performSelfAnalysis",(function(){var n;t.selfAnalysisDone=!0;var r=t.className;t.TRACE_INIT("toFastProps",(function(){qZ(t)})),t.TRACE_INIT("Grammar Recording",(function(){try{t.enableRecording(),wZ(t.definedRulesNames,(function(e){var n=t[e].originalGrammarAction,r=void 0;t.TRACE_INIT(e+" Rule",(function(){r=t.topLevelRuleRecord(e,n)})),t.gastProductionsCache[e]=r}))}finally{t.disableRecording()}}));var i=[];if(t.TRACE_INIT("Grammar Resolving",(function(){i=O1({rules:dZ(t.gastProductionsCache)}),t.definitionErrors.push.apply(t.definitionErrors,i)})),t.TRACE_INIT("Grammar Validations",(function(){if(uZ(i)&&!1===t.skipValidations){var e=m1((n=WZ(n={rules:dZ(t.gastProductionsCache),maxLookahead:t.maxLookahead,tokenTypes:dZ(t.tokensMap),ignoredIssues:t.ignoredIssues,errMsgProvider:A1,grammarName:r},{errMsgProvider:A1,ignoredIssues:{}})).rules,n.maxLookahead,n.tokenTypes,n.ignoredIssues,n.errMsgProvider,n.grammarName);t.definitionErrors.push.apply(t.definitionErrors,e)}var n})),uZ(t.definitionErrors)&&(t.recoveryEnabled&&t.TRACE_INIT("computeAllProdsFollows",(function(){var e,n,r=(e=dZ(t.gastProductionsCache),n={},wZ(e,(function(e){var t=new P0(e).startWalking();UZ(n,t)})),n);t.resyncFollows=r})),t.TRACE_INIT("ComputeLookaheadFunctions",(function(){t.preComputeLookaheadFunctions(dZ(t.gastProductionsCache))}))),t.TRACE_INIT("expandAllNestedRuleNames",(function(){var e,n,r,i=(e=dZ(t.gastProductionsCache),n=t.fullRuleNameToShort,r={allRuleNames:[]},wZ(e,(function(e){var t=n[e.name];r.allRuleNames.push(e.name);var i=new z0(t);e.accept(i),wZ(i.result,(function(t){t.def,t.key;var n=t.name;r.allRuleNames.push(e.name+n)}))})),r);t.allRuleNames=i.allRuleNames})),!e.DEFER_DEFINITION_ERRORS_HANDLING&&!uZ(t.definitionErrors))throw n=pZ(t.definitionErrors,(function(e){return e.message})),new Error("Parser Definition Errors detected:\n "+n.join("\n-------------------------------\n"))}))},e.DEFER_DEFINITION_ERRORS_HANDLING=!1,e}();b2=T2,[G1,$1,t2,n2,i2,r2,o2,s2,p2,y2].forEach((function(e){var t=e.prototype;Object.getOwnPropertyNames(t).forEach((function(n){if("constructor"!==n){var r=Object.getOwnPropertyDescriptor(t,n);r&&(r.get||r.set)?Object.defineProperty(b2.prototype,n,r):b2.prototype[n]=e.prototype[n]}}))})),function(e){function t(t,n){void 0===n&&(n=R2);var r=IZ(n);return r.outputCst=!0,e.call(this,t,r)||this}v2(t,e)}(T2);var N2=function(e){function t(t,n){void 0===n&&(n=R2);var r=IZ(n);return r.outputCst=!1,e.call(this,t,r)||this}return v2(t,e),t}(T2);
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */const A2=(e,t)=>({type:e,message:t});var M2,I2,O2;!function(e){e.LexingError="LexingError",e.ParserError="ParsingError",e.StaticOffsetError="StaticOffsetError",e.StaticOffsetOutOfRangeError="StaticOffsetOutOfRangeError",e.RangeOffsetNotAllowed="RangeOffsetNotAllowed",e.InvalidRangeSize="InvalidRangeSize"}(M2||(M2={})),function(e){e.EMPTY="EMPTY",e.NUMBER="NUMBER",e.STRING="STRING",e.MINUS_UNARY_OP="MINUS_UNARY_OP",e.PLUS_UNARY_OP="PLUS_UNARY_OP",e.PERCENT_OP="PERCENT_OP",e.CONCATENATE_OP="CONCATENATE_OP",e.EQUALS_OP="EQUALS_OP",e.NOT_EQUAL_OP="NOT_EQUAL_OP",e.GREATER_THAN_OP="GREATER_THAN_OP",e.LESS_THAN_OP="LESS_THAN_OP",e.GREATER_THAN_OR_EQUAL_OP="GREATER_THAN_OR_EQUAL_OP",e.LESS_THAN_OR_EQUAL_OP="LESS_THAN_OR_EQUAL_OP",e.PLUS_OP="PLUS_OP",e.MINUS_OP="MINUS_OP",e.TIMES_OP="TIMES_OP",e.DIV_OP="DIV_OP",e.POWER_OP="POWER_OP",e.FUNCTION_CALL="FUNCTION_CALL",e.NAMED_EXPRESSION="NAMED_EXPRESSION",e.PARENTHESIS="PARENTHESES",e.CELL_REFERENCE="CELL_REFERENCE",e.CELL_RANGE="CELL_RANGE",e.COLUMN_RANGE="COLUMN_RANGE",e.ROW_RANGE="ROW_RANGE",e.ERROR="ERROR",e.ERROR_WITH_RAW_INPUT="ERROR_WITH_RAW_INPUT",e.ARRAY="ARRAY"}(I2||(I2={})),function(e){e[e.RELATIVE=0]="RELATIVE",e[e.START_ABSOLUTE=1]="START_ABSOLUTE",e[e.BOTH_ABSOLUTE=2]="BOTH_ABSOLUTE"}(O2||(O2={}));const x2=(e,t)=>({type:I2.CELL_REFERENCE,reference:e,leadingWhitespace:null==t?void 0:t.image}),P2=(e,t,n,r)=>(F2(e,t,n),{type:I2.CELL_RANGE,start:e,end:t,sheetReferenceType:n,leadingWhitespace:r}),_2=(e,t,n)=>({type:I2.ARRAY,args:e,leadingWhitespace:null==t?void 0:t.image,internalWhitespace:null==n?void 0:n.image}),L2=(e,t)=>({type:I2.ERROR,error:e,leadingWhitespace:null==t?void 0:t.image}),H2=(e,t,n)=>({type:I2.ERROR_WITH_RAW_INPUT,error:t,rawInput:e,leadingWhitespace:null==n?void 0:n.image}),k2=()=>({type:I2.ERROR,error:g4.parsingError()});function F2(e,t,n){if(void 0!==e.sheet&&void 0===t.sheet||void 0===e.sheet&&void 0!==t.sheet)throw new Error("Start address inconsistent with end address");if(void 0===e.sheet&&n!==O2.RELATIVE||void 0!==e.sheet&&n===O2.RELATIVE)throw new Error("Sheet address inconsistent with sheet reference type")}function D2(e,t){return(null!=t?t:"")+e}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */const V2={[I2.PLUS_OP]:"+",[I2.MINUS_OP]:"-",[I2.TIMES_OP]:"*",[I2.DIV_OP]:"/",[I2.CONCATENATE_OP]:"&",[I2.POWER_OP]:"^",[I2.EQUALS_OP]:"=",[I2.NOT_EQUAL_OP]:"<>",[I2.GREATER_THAN_OP]:">",[I2.GREATER_THAN_OR_EQUAL_OP]:">=",[I2.LESS_THAN_OP]:"<",[I2.LESS_THAN_OR_EQUAL_OP]:"<="};
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class U2{constructor(e){this.functionRegistry=e,this.cache=new Map}set(e,t){const n=((e,t,n,r)=>({ast:e,relativeDependencies:t,hasVolatileFunction:n,hasStructuralChangeFunction:r}))(t,N3(t,this.functionRegistry),B2(t,this.functionRegistry.isFunctionVolatile),B2(t,this.functionRegistry.isFunctionDependentOnSheetStructureChange));return this.cache.set(e,n),n}get(e){return this.cache.get(e)}maybeSetAndThenGet(e,t){const n=this.cache.get(e);return void 0!==n?n.ast:(this.set(e,t),t)}}const B2=(e,t)=>{switch(e.type){case I2.EMPTY:case I2.NUMBER:case I2.STRING:case I2.ERROR:case I2.ERROR_WITH_RAW_INPUT:case I2.CELL_REFERENCE:case I2.CELL_RANGE:case I2.COLUMN_RANGE:case I2.ROW_RANGE:case I2.NAMED_EXPRESSION:return!1;case I2.PERCENT_OP:case I2.PLUS_UNARY_OP:case I2.MINUS_UNARY_OP:return B2(e.value,t);case I2.CONCATENATE_OP:case I2.EQUALS_OP:case I2.NOT_EQUAL_OP:case I2.LESS_THAN_OP:case I2.GREATER_THAN_OP:case I2.LESS_THAN_OR_EQUAL_OP:case I2.GREATER_THAN_OR_EQUAL_OP:case I2.MINUS_OP:case I2.PLUS_OP:case I2.TIMES_OP:case I2.DIV_OP:case I2.POWER_OP:return B2(e.left,t)||B2(e.right,t);case I2.PARENTHESIS:return B2(e.expression,t);case I2.FUNCTION_CALL:return!!t(e.procedureName)||e.args.some((e=>B2(e,t)));case I2.ARRAY:return e.args.some((e=>e.some((e=>B2(e,t)))))}};
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class W2{}W2.DistinctSigns="Distinct signs.",W2.WrongArgNumber="Wrong number of arguments.",W2.EmptyArg="Empty function argument.",W2.EmptyArray="Empty array not allowed.",W2.ArrayDimensions="Array dimensions are not compatible.",W2.NoSpaceForArrayResult="No space for array result.",W2.ValueSmall="Value too small.",W2.ValueLarge="Value too large.",W2.BadCriterion="Incorrect criterion.",W2.RangeManySheets="Range spans more than one sheet.",W2.CellRangeExpected="Cell range expected.",W2.WrongDimension="Wrong range dimension.",W2.ScalarExpected="Cell range not allowed.",W2.NumberCoercion="Value cannot be coerced to number.",W2.NumberExpected="Number argument expected.",W2.IntegerExpected="Value needs to be an integer.",W2.BadMode="Mode not recognized.",W2.DateBounds="Date outside of bounds.",W2.OutOfSheet="Resulting reference is out of the sheet.",W2.WrongType="Wrong type of argument.",W2.NaN="NaN or infinite value encountered.",W2.EqualLength="Ranges need to be of equal length.",W2.Negative="Value cannot be negative.",W2.NotBinary="String does not represent a binary number.",W2.NotOctal="String does not represent an octal number.",W2.NotHex="String does not represent a hexadecimal number.",W2.EndStartPeriod="End period needs to be at least start period.",W2.CellRefExpected="Cell reference expected.",W2.EmptyRange="Empty range not allowed.",W2.BadRef="Address is not correct.",W2.NumberRange="Number-only range expected.",W2.ValueNotFound="Value not found.",W2.ValueBaseLarge="Value in base too large.",W2.ValueBaseSmall="Value in base too small.",W2.ValueBaseLong="Value in base too long.",W2.NegativeLength="Length cannot be negative.",W2.PatternNotFound="Pattern not found.",W2.OneValue="Needs at least one value.",W2.TwoValues="Range needs to contain at least two elements.",W2.ThreeValues="Range needs to contain at least three elements.",W2.IndexBounds="Index out of bounds.",W2.IndexLarge="Index too large.",W2.Formula="Expected formula.",W2.NegativeCount="Count cannot be negative.",W2.ParseError="Parsing error.",W2.SheetRef="Sheet does not exist.",W2.PeriodLong="Period number cannot exceed life length.",W2.InvalidDate="Invalid date.",W2.BitshiftLong="Result of bitshift is too long.",W2.EmptyString="Empty-string argument not allowed.",W2.LengthBounds="Length out of bounds.",W2.NegativeTime="Time cannot be negative.",W2.NoDefault="No default option.",W2.NoConditionMet="None of the conditions were met.",W2.Selector="Selector cannot exceed the number of arguments.",W2.StartEndDate="Start date needs to be earlier than end date.",W2.IncorrectDateTime="String does not represent correct DateTime.",W2.CharacterCodeBounds="Character code out of bounds.",W2.NonZero="Argument cannot be 0.",W2.LessThanOne="Argument cannot be less than 1.",W2.WeekendString="Incorrect weekend bitmask string.",W2.InvalidRoman="Invalid roman numeral.",W2.WrongOrder="Wrong order of values.",W2.ComplexNumberExpected="Complex number expected.",W2.ShouldBeIorJ="Should be 'i' or 'j'.",W2.SizeMismatch="Array dimensions mismatched.",W2.FunctionName=e=>`Function name ${e} not recognized.`,W2.NamedExpressionName=e=>`Named expression ${e} not recognized.`,W2.LicenseKey=e=>`License key is ${e}.`
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */;
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
const j2=o0({name:"AdditionOp",pattern:YJ.NA}),G2=o0({name:"PlusOp",pattern:/\+/,categories:j2}),z2=o0({name:"MinusOp",pattern:/-/,categories:j2}),$2=o0({name:"MultiplicationOp",pattern:YJ.NA}),Y2=o0({name:"TimesOp",pattern:/\*/,categories:$2}),K2=o0({name:"DivOp",pattern:/\//,categories:$2}),X2=o0({name:"PowerOp",pattern:/\^/}),q2=o0({name:"PercentOp",pattern:/%/}),Q2=o0({name:"BooleanOp",pattern:YJ.NA}),Z2=o0({name:"EqualsOp",pattern:/=/,categories:Q2}),J2=o0({name:"NotEqualOp",pattern:/<>/,categories:Q2}),e3=o0({name:"GreaterThanOp",pattern:/>/,categories:Q2}),t3=o0({name:"LessThanOp",pattern:/</,categories:Q2}),n3=o0({name:"GreaterThanOrEqualOp",pattern:/>=/,categories:Q2}),r3=o0({name:"LessThanOrEqualOp",pattern:/<=/,categories:Q2}),i3=o0({name:"ConcatenateOp",pattern:/&/}),o3=o0({name:"LParen",pattern:/\(/}),s3=o0({name:"RParen",pattern:/\)/}),a3=o0({name:"ArrayLParen",pattern:/{/}),l3=o0({name:"ArrayRParen",pattern:/}/}),h3=o0({name:"StringLiteral",pattern:/"([^"\\]*(\\.[^"\\]*)*)"/}),u3=o0({name:"ErrorLiteral",pattern:/#[A-Za-z0-9\/]+[?!]?/}),c3=o0({name:"RangeSeparator",pattern:new RegExp(FQ)}),d3=o0({name:"ColumnRange",pattern:new RegExp(`${GQ}${FQ}${GQ}`)}),p3=o0({name:"RowRange",pattern:new RegExp(`${zQ}${FQ}${zQ}`)}),g3=o0({name:"ProcedureName",pattern:new RegExp(`([${VQ}][${UQ}]*)\\(`)}),m3=new class{constructor(){this.POSSIBLE_START_CHARACTERS=[...qQ,...XQ,DQ,"'","_"],this.cellReferenceRegexp=new RegExp(YQ,"y")}match(e,t){this.cellReferenceRegexp.lastIndex=t;const n=this.cellReferenceRegexp.exec(e+"@");return null==n||null==n[1]?null:(n[0]=n[1],n)}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */,f3=o0({name:"CellReference",pattern:m3.match.bind(m3),start_chars_hint:m3.POSSIBLE_START_CHARACTERS,line_breaks:!1}),w3=new class{constructor(){this.POSSIBLE_START_CHARACTERS=[...qQ,"_"],this.namedExpressionRegexp=new RegExp(KQ,"y"),this.r1c1CellRefRegexp=new RegExp(`^${$Q}$`)}match(e,t){this.namedExpressionRegexp.lastIndex=t;const n=this.namedExpressionRegexp.exec(e);return null==n||null==n[0]||this.r1c1CellRefRegexp.test(n[0])?null:n}},y3=o0({name:"NamedExpression",pattern:w3.match.bind(w3),start_chars_hint:w3.POSSIBLE_START_CHARACTERS,line_breaks:!1}),v3=e=>{const t=e.translationPackage.getFunctionTranslation("OFFSET"),n=e.errorMapping,r=e.translationPackage.buildFunctionMapping(),i=o0({name:"WhiteSpace",pattern:new RegExp("standard"===e.ignoreWhiteSpace?"[ \\t\\n\\r]+":"\\s+")}),o=o0({name:"ArrayRowSep",pattern:e.arrayRowSeparator}),s=o0({name:"ArrayColSep",pattern:e.arrayColumnSeparator}),a=o0({name:"NumberLiteral",pattern:new RegExp(`(([${e.decimalSeparator}]\\d+)|(\\d+([${e.decimalSeparator}]\\d*)?))(e[+-]?\\d+)?`)}),l=o0({name:"OffsetProcedureName",pattern:new RegExp(t,"i")});let h,u;e.functionArgSeparator===e.arrayColumnSeparator?(h=s,u=[]):e.functionArgSeparator===e.arrayRowSeparator?(h=o,u=[]):(h=o0({name:"ArgSeparator",pattern:e.functionArgSeparator}),u=[h]);return{ArgSeparator:h,NumberLiteral:a,OffsetProcedureName:l,ArrayRowSeparator:o,ArrayColSeparator:s,WhiteSpace:i,allTokens:[i,G2,z2,Y2,K2,X2,Z2,J2,q2,n3,r3,e3,t3,o3,s3,a3,l3,l,g3,c3,...u,d3,p3,a,h3,u3,i3,Q2,j2,$2,f3,y3,o,s],errorMapping:n,functionMapping:r,decimalSeparator:e.decimalSeparator,maxColumns:e.maxColumns,maxRows:e.maxRows}};
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
class C3 extends N2{constructor(e,t){super(e.allTokens,{outputCst:!1,maxLookahead:7}),this.booleanExpressionOrEmpty=this.RULE("booleanExpressionOrEmpty",(()=>{return this.OR([{ALT:()=>this.SUBRULE(this.booleanExpression)},{ALT:(e={type:I2.EMPTY,leadingWhitespace:null==t?void 0:t.image},void 0===e&&(e=void 0),function(){return e})}]);var e,t})),this.procedureExpression=this.RULE("procedureExpression",(()=>{var e;const t=this.CONSUME(g3),n=t.image.toUpperCase().slice(0,-1),r=null!==(e=this.lexerConfig.functionMapping[n])&&void 0!==e?e:n,i=[];let o=this.SUBRULE(this.booleanExpressionOrEmpty);this.MANY((()=>{var e;const t=this.CONSUME(this.lexerConfig.ArgSeparator);o.type===I2.EMPTY&&(o.leadingWhitespace=null===(e=t.leadingWhitespace)||void 0===e?void 0:e.image),i.push(o),o=this.SUBRULE2(this.booleanExpressionOrEmpty)})),i.push(o),1===i.length&&i[0].type===I2.EMPTY&&(i.length=0);const s=this.CONSUME(s3);return((e,t,n,r,i)=>({type:I2.FUNCTION_CALL,procedureName:e,args:t,leadingWhitespace:null==n?void 0:n.image,internalWhitespace:null==r?void 0:r.image,hyperlink:i}))(r,i,t.leadingWhitespace,s.leadingWhitespace)})),this.namedExpressionExpression=this.RULE("namedExpressionExpression",(()=>{const e=this.CONSUME(y3);return t=e.image,n=e.leadingWhitespace,{type:I2.NAMED_EXPRESSION,expressionName:t,leadingWhitespace:null==n?void 0:n.image};var t,n})),this.offsetProcedureExpression=this.RULE("offsetProcedureExpression",(()=>{const e=[];return this.CONSUME(this.lexerConfig.OffsetProcedureName),this.CONSUME(o3),this.MANY_SEP({SEP:this.lexerConfig.ArgSeparator,DEF:()=>{e.push(this.SUBRULE(this.booleanExpression))}}),this.CONSUME(s3),this.handleOffsetHeuristic(e)})),this.columnRangeExpression=this.RULE("columnRangeExpression",(()=>{const e=this.CONSUME(d3),[t,n]=e.image.split(":"),r=this.ACTION((()=>nZ(this.sheetMapping,t,this.formulaAddress))),i=this.ACTION((()=>nZ(this.sheetMapping,n,this.formulaAddress)));if(void 0===r||void 0===i)return L2(new g4(X9.REF));if(r.exceedsSheetSizeLimits(this.lexerConfig.maxColumns)||i.exceedsSheetSizeLimits(this.lexerConfig.maxColumns))return H2(e.image,new g4(X9.NAME),e.leadingWhitespace);if(void 0===r.sheet&&void 0!==i.sheet)return this.parsingError(M2.ParserError,"Malformed range expression");const{firstEnd:o,secondEnd:s,sheetRefType:a}=C3.fixSheetIdsForRangeEnds(r,i);return l=o,h=s,u=a,c=e.leadingWhitespace,F2(l,h,u),{type:I2.COLUMN_RANGE,start:l,end:h,sheetReferenceType:u,leadingWhitespace:null==c?void 0:c.image};var l,h,u,c})),this.rowRangeExpression=this.RULE("rowRangeExpression",(()=>{const e=this.CONSUME(p3),[t,n]=e.image.split(":"),r=this.ACTION((()=>rZ(this.sheetMapping,t,this.formulaAddress))),i=this.ACTION((()=>rZ(this.sheetMapping,n,this.formulaAddress)));if(void 0===r||void 0===i)return L2(new g4(X9.REF));if(r.exceedsSheetSizeLimits(this.lexerConfig.maxRows)||i.exceedsSheetSizeLimits(this.lexerConfig.maxRows))return H2(e.image,new g4(X9.NAME),e.leadingWhitespace);if(void 0===r.sheet&&void 0!==i.sheet)return this.parsingError(M2.ParserError,"Malformed range expression");const{firstEnd:o,secondEnd:s,sheetRefType:a}=C3.fixSheetIdsForRangeEnds(r,i);return l=o,h=s,u=a,c=e.leadingWhitespace,F2(l,h,u),{type:I2.ROW_RANGE,start:l,end:h,sheetReferenceType:u,leadingWhitespace:null==c?void 0:c.image};var l,h,u,c})),this.cellReference=this.RULE("cellReference",(()=>{const e=this.CONSUME(f3),t=this.ACTION((()=>tZ(this.sheetMapping,e.image,this.formulaAddress)));return void 0===t?H2(e.image,new g4(X9.REF),e.leadingWhitespace):t.exceedsSheetSizeLimits(this.lexerConfig.maxColumns,this.lexerConfig.maxRows)?H2(e.image,new g4(X9.NAME),e.leadingWhitespace):x2(t,e.leadingWhitespace)})),this.endRangeReference=this.RULE("endRangeReference",(e=>{var t;const n=this.CONSUME(f3),r=this.ACTION((()=>tZ(this.sheetMapping,e.image,this.formulaAddress))),i=this.ACTION((()=>tZ(this.sheetMapping,n.image,this.formulaAddress)));return void 0===r||void 0===i?this.ACTION((()=>H2(`${e.image}:${n.image}`,new g4(X9.REF),e.leadingWhitespace))):r.exceedsSheetSizeLimits(this.lexerConfig.maxColumns,this.lexerConfig.maxRows)||i.exceedsSheetSizeLimits(this.lexerConfig.maxColumns,this.lexerConfig.maxRows)?this.ACTION((()=>H2(`${e.image}:${n.image}`,new g4(X9.NAME),e.leadingWhitespace))):this.buildCellRange(r,i,null===(t=e.leadingWhitespace)||void 0===t?void 0:t.image)})),this.endOfRangeExpression=this.RULE("endOfRangeExpression",(e=>this.OR([{ALT:()=>this.SUBRULE(this.endRangeReference,{ARGS:[e]})},{ALT:()=>{var t;const n=this.SUBRULE(this.offsetProcedureExpression),r=this.ACTION((()=>tZ(this.sheetMapping,e.image,this.formulaAddress)));return void 0===r?L2(new g4(X9.REF)):n.type===I2.CELL_REFERENCE?this.buildCellRange(r,n.reference,null===(t=e.leadingWhitespace)||void 0===t?void 0:t.image):this.parsingError(M2.RangeOffsetNotAllowed,"Range offset not allowed here")}}]))),this.cellRangeExpression=this.RULE("cellRangeExpression",(()=>{const e=this.CONSUME(f3);return this.CONSUME2(c3),this.SUBRULE(this.endOfRangeExpression,{ARGS:[e]})})),this.endRangeWithOffsetStartReference=this.RULE("endRangeWithOffsetStartReference",(e=>{const t=this.CONSUME(f3),n=this.ACTION((()=>tZ(this.sheetMapping,t.image,this.formulaAddress)));return void 0===n?this.ACTION((()=>L2(new g4(X9.REF)))):this.buildCellRange(e.reference,n,e.leadingWhitespace)})),this.endOfRangeWithOffsetStartExpression=this.RULE("endOfRangeWithOffsetStartExpression",(e=>this.OR([{ALT:()=>this.SUBRULE(this.endRangeWithOffsetStartReference,{ARGS:[e]})},{ALT:()=>{const t=this.SUBRULE(this.offsetProcedureExpression);return t.type===I2.CELL_REFERENCE?this.buildCellRange(e.reference,t.reference,e.leadingWhitespace):this.parsingError(M2.RangeOffsetNotAllowed,"Range offset not allowed here")}}]))),this.offsetExpression=this.RULE("offsetExpression",(()=>{const e=this.SUBRULE(this.offsetProcedureExpression);let t;return this.OPTION((()=>{this.CONSUME(c3),t=e.type===I2.CELL_RANGE?this.parsingError(M2.RangeOffsetNotAllowed,"Range offset not allowed here"):this.SUBRULE(this.endOfRangeWithOffsetStartExpression,{ARGS:[e]})})),void 0!==t?t:e})),this.insideArrayExpression=this.RULE("insideArrayExpression",(()=>{const e=[[]];return e[e.length-1].push(this.SUBRULE(this.booleanExpression)),this.MANY((()=>{this.OR([{ALT:()=>{this.CONSUME(this.lexerConfig.ArrayColSeparator),e[e.length-1].push(this.SUBRULE2(this.booleanExpression))}},{ALT:()=>{this.CONSUME(this.lexerConfig.ArrayRowSeparator),e.push([]),e[e.length-1].push(this.SUBRULE3(this.booleanExpression))}}])})),_2(e)})),this.parenthesisExpression=this.RULE("parenthesisExpression",(()=>{const e=this.CONSUME(o3),t=this.SUBRULE(this.booleanExpression),n=this.CONSUME(s3);return((e,t,n)=>({type:I2.PARENTHESIS,expression:e,leadingWhitespace:null==t?void 0:t.image,internalWhitespace:null==n?void 0:n.image}))(t,e.leadingWhitespace,n.leadingWhitespace)})),this.arrayExpression=this.RULE("arrayExpression",(()=>this.OR([{ALT:()=>{const e=this.CONSUME(a3),t=this.SUBRULE(this.insideArrayExpression),n=this.CONSUME(l3);return _2(t.args,e.leadingWhitespace,n.leadingWhitespace)}},{ALT:()=>this.SUBRULE(this.parenthesisExpression)}]))),this.numericStringToNumber=e=>{const t=e.replace(this.lexerConfig.decimalSeparator,".");return Number(t)},this.positiveAtomicExpression=this.RULE("positiveAtomicExpression",(()=>{var e;return this.OR(null!==(e=this.atomicExpCache)&&void 0!==e?e:this.atomicExpCache=[{ALT:()=>this.SUBRULE(this.arrayExpression)},{ALT:()=>this.SUBRULE(this.cellRangeExpression)},{ALT:()=>this.SUBRULE(this.columnRangeExpression)},{ALT:()=>this.SUBRULE(this.rowRangeExpression)},{ALT:()=>this.SUBRULE(this.offsetExpression)},{ALT:()=>this.SUBRULE(this.cellReference)},{ALT:()=>this.SUBRULE(this.procedureExpression)},{ALT:()=>this.SUBRULE(this.namedExpressionExpression)},{ALT:()=>{const e=this.CONSUME(this.lexerConfig.NumberLiteral);return t=this.numericStringToNumber(e.image),n=e.leadingWhitespace,{type:I2.NUMBER,value:t,leadingWhitespace:null==n?void 0:n.image};var t,n}},{ALT:()=>(e=>{var t;return{type:I2.STRING,value:e.image.slice(1,-1),leadingWhitespace:null===(t=e.leadingWhitespace)||void 0===t?void 0:t.image}})(this.CONSUME(h3))},{ALT:()=>{const e=this.CONSUME(u3),t=e.image.toUpperCase(),n=this.lexerConfig.errorMapping[t];return n?L2(new g4(n),e.leadingWhitespace):this.parsingError(M2.ParserError,"Unknown error literal")}}])})),this.rightUnaryOpAtomicExpression=this.RULE("rightUnaryOpAtomicExpression",(()=>{const e=this.SUBRULE(this.positiveAtomicExpression),t=this.OPTION((()=>this.CONSUME(q2)));return t?(n=e,r=t.leadingWhitespace,{type:I2.PERCENT_OP,value:n,leadingWhitespace:null==r?void 0:r.image}):e;var n,r})),this.atomicExpression=this.RULE("atomicExpression",(()=>this.OR([{ALT:()=>{const e=this.CONSUME(j2),t=this.SUBRULE(this.atomicExpression);return l0(e,G2)?((e,t)=>({type:I2.PLUS_UNARY_OP,value:e,leadingWhitespace:null==t?void 0:t.image}))(t,e.leadingWhitespace):l0(e,z2)?((e,t)=>({type:I2.MINUS_UNARY_OP,value:e,leadingWhitespace:null==t?void 0:t.image}))(t,e.leadingWhitespace):(this.customParsingError=A2(M2.ParserError,"Mismatched token type"),this.customParsingError)}},{ALT:()=>this.SUBRULE2(this.rightUnaryOpAtomicExpression)}]))),this.powerExpression=this.RULE("powerExpression",(()=>{let e=this.SUBRULE(this.atomicExpression);return this.MANY((()=>{const t=this.CONSUME(X2),n=this.SUBRULE2(this.atomicExpression);l0(t,X2)?e=((e,t,n)=>({type:I2.POWER_OP,left:e,right:t,leadingWhitespace:null==n?void 0:n.image}))(e,n,t.leadingWhitespace):this.ACTION((()=>{throw Error("Operator not supported")}))})),e})),this.multiplicationExpression=this.RULE("multiplicationExpression",(()=>{let e=this.SUBRULE(this.powerExpression);return this.MANY((()=>{const t=this.CONSUME($2),n=this.SUBRULE2(this.powerExpression);l0(t,Y2)?e=((e,t,n)=>({type:I2.TIMES_OP,left:e,right:t,leadingWhitespace:null==n?void 0:n.image}))(e,n,t.leadingWhitespace):l0(t,K2)?e=((e,t,n)=>({type:I2.DIV_OP,left:e,right:t,leadingWhitespace:null==n?void 0:n.image}))(e,n,t.leadingWhitespace):this.ACTION((()=>{throw Error("Operator not supported")}))})),e})),this.additionExpression=this.RULE("additionExpression",(()=>{let e=this.SUBRULE(this.multiplicationExpression);return this.MANY((()=>{const t=this.CONSUME(j2),n=this.SUBRULE2(this.multiplicationExpression);l0(t,G2)?e=((e,t,n)=>({type:I2.PLUS_OP,left:e,right:t,leadingWhitespace:null==n?void 0:n.image}))(e,n,t.leadingWhitespace):l0(t,z2)?e=((e,t,n)=>({type:I2.MINUS_OP,left:e,right:t,leadingWhitespace:null==n?void 0:n.image}))(e,n,t.leadingWhitespace):this.ACTION((()=>{throw Error("Operator not supported")}))})),e})),this.concatenateExpression=this.RULE("concatenateExpression",(()=>{let e=this.SUBRULE(this.additionExpression);return this.MANY((()=>{const t=this.CONSUME(i3),n=this.SUBRULE2(this.additionExpression);e=((e,t,n)=>({type:I2.CONCATENATE_OP,left:e,right:t,leadingWhitespace:null==n?void 0:n.image}))(e,n,t.leadingWhitespace)})),e})),this.booleanExpression=this.RULE("booleanExpression",(()=>{let e=this.SUBRULE(this.concatenateExpression);return this.MANY((()=>{const t=this.CONSUME(Q2),n=this.SUBRULE2(this.concatenateExpression);l0(t,Z2)?e=((e,t,n)=>({type:I2.EQUALS_OP,left:e,right:t,leadingWhitespace:null==n?void 0:n.image}))(e,n,t.leadingWhitespace):l0(t,J2)?e=((e,t,n)=>({type:I2.NOT_EQUAL_OP,left:e,right:t,leadingWhitespace:null==n?void 0:n.image}))(e,n,t.leadingWhitespace):l0(t,e3)?e=((e,t,n)=>({type:I2.GREATER_THAN_OP,left:e,right:t,leadingWhitespace:null==n?void 0:n.image}))(e,n,t.leadingWhitespace):l0(t,t3)?e=((e,t,n)=>({type:I2.LESS_THAN_OP,left:e,right:t,leadingWhitespace:null==n?void 0:n.image}))(e,n,t.leadingWhitespace):l0(t,n3)?e=((e,t,n)=>({type:I2.GREATER_THAN_OR_EQUAL_OP,left:e,right:t,leadingWhitespace:null==n?void 0:n.image}))(e,n,t.leadingWhitespace):l0(t,r3)?e=((e,t,n)=>({type:I2.LESS_THAN_OR_EQUAL_OP,left:e,right:t,leadingWhitespace:null==n?void 0:n.image}))(e,n,t.leadingWhitespace):this.ACTION((()=>{throw Error("Operator not supported")}))})),e})),this.formula=this.RULE("formula",(()=>(this.CONSUME(Z2),this.SUBRULE(this.booleanExpression)))),this.lexerConfig=e,this.sheetMapping=t,this.formulaAddress=v4(0,0,0),this.performSelfAnalysis()}parseFromTokens(e,t){this.input=e;let n=this.formulaWithContext(t),r=[];return this.customParsingError&&r.push(this.customParsingError),r=r.concat(this.errors.map((e=>({type:M2.ParserError,message:e.message})))),r.length>0&&(n=k2()),{ast:n,errors:r}}reset(){super.reset(),this.customParsingError=void 0}formulaWithContext(e){return this.formulaAddress=e,this.formula()}buildCellRange(e,t,n){if(void 0===e.sheet&&void 0!==t.sheet)return this.parsingError(M2.ParserError,"Malformed range expression");const{firstEnd:r,secondEnd:i,sheetRefType:o}=C3.fixSheetIdsForRangeEnds(e,t);return P2(r,i,o,n)}static fixSheetIdsForRangeEnds(e,t){const n=C3.rangeSheetReferenceType(e.sheet,t.sheet);return{firstEnd:e,secondEnd:void 0!==e.sheet&&void 0===t.sheet?t.withSheet(e.sheet):t,sheetRefType:n}}handleOffsetHeuristic(e){const t=e[0];if(t.type!==I2.CELL_REFERENCE)return this.parsingError(M2.StaticOffsetError,"First argument to OFFSET is not a reference");const n=e[1];let r;if(n.type===I2.NUMBER&&Number.isInteger(n.value))r=n.value;else if(n.type===I2.PLUS_UNARY_OP&&n.value.type===I2.NUMBER&&Number.isInteger(n.value.value))r=n.value.value;else{if(n.type!==I2.MINUS_UNARY_OP||n.value.type!==I2.NUMBER||!Number.isInteger(n.value.value))return this.parsingError(M2.StaticOffsetError,"Second argument to OFFSET is not a static number");r=-n.value.value}const i=e[2];let o;if(i.type===I2.NUMBER&&Number.isInteger(i.value))o=i.value;else if(i.type===I2.PLUS_UNARY_OP&&i.value.type===I2.NUMBER&&Number.isInteger(i.value.value))o=i.value.value;else{if(i.type!==I2.MINUS_UNARY_OP||i.value.type!==I2.NUMBER||!Number.isInteger(i.value.value))return this.parsingError(M2.StaticOffsetError,"Third argument to OFFSET is not a static number");o=-i.value.value}const s=e[3];let a;if(void 0===s)a=1;else{if(s.type!==I2.NUMBER)return this.parsingError(M2.StaticOffsetError,"Fourth argument to OFFSET is not a static number");if(a=s.value,a<1)return this.parsingError(M2.StaticOffsetError,"Fourth argument to OFFSET is too small number");if(!Number.isInteger(a))return this.parsingError(M2.StaticOffsetError,"Fourth argument to OFFSET is not integer")}const l=e[4];let h;if(void 0===l)h=1;else{if(l.type!==I2.NUMBER)return this.parsingError(M2.StaticOffsetError,"Fifth argument to OFFSET is not a static number");if(h=l.value,h<1)return this.parsingError(M2.StaticOffsetError,"Fifth argument to OFFSET is too small number");if(!Number.isInteger(h))return this.parsingError(M2.StaticOffsetError,"Fifth argument to OFFSET is not integer")}const u=new kQ(t.reference.col+o,t.reference.row+r,t.reference.type);let c=u.col,d=u.row;if(t.reference.type!==_Q.CELL_REFERENCE_RELATIVE&&t.reference.type!==_Q.CELL_REFERENCE_ABSOLUTE_COL||(d+=this.formulaAddress.row),t.reference.type!==_Q.CELL_REFERENCE_RELATIVE&&t.reference.type!==_Q.CELL_REFERENCE_ABSOLUTE_ROW||(c+=this.formulaAddress.col),c<0||d<0)return L2(new g4(X9.REF,W2.OutOfSheet));if(1===h&&1===a)return x2(u);{const e=new kQ(u.col+h-1,u.row+a-1,u.type);return P2(u,e,O2.RELATIVE)}}parsingError(e,t){return this.customParsingError=A2(e,t),k2()}static rangeSheetReferenceType(e,t){return void 0===e?O2.RELATIVE:void 0===t?O2.START_ABSOLUTE:O2.BOTH_ABSOLUTE}}class S3{constructor(e){this.lexerConfig=e,this.lexer=new YJ(e.allTokens,{ensureOptimizations:!0})}tokenizeFormula(e){const t=this.lexer.tokenize(e);let n=t.tokens;return n=this.trimTrailingWhitespaces(n),n=this.skipWhitespacesInsideRanges(n),n=this.skipWhitespacesBeforeArgSeparators(n),t.tokens=n,t}skipWhitespacesInsideRanges(e){return S3.filterTokensByNeighbors(e,((e,t,n)=>(l0(e,f3)||l0(e,c3))&&l0(t,this.lexerConfig.WhiteSpace)&&(l0(n,f3)||l0(n,c3))))}skipWhitespacesBeforeArgSeparators(e){return S3.filterTokensByNeighbors(e,((e,t,n)=>!l0(e,this.lexerConfig.ArgSeparator)&&l0(t,this.lexerConfig.WhiteSpace)&&l0(n,this.lexerConfig.ArgSeparator)))}static filterTokensByNeighbors(e,t){if(e.length<3)return e;let n=0;const r=[e[n++]];for(;n<e.length-1;)t(e[n-1],e[n],e[n+1])||r.push(e[n]),++n;return r.push(e[n]),r}trimTrailingWhitespaces(e){return e.length>0&&l0(e[e.length-1],this.lexerConfig.WhiteSpace)&&e.pop(),e}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class R3{constructor(e,t,n,r){this.config=e,this.lexerConfig=t,this.sheetMappingFn=n,this.namedExpressions=r}unparse(e,t){return"="+this.unparseAst(e,t)}unparseAst(e,t){var n,r;switch(e.type){case I2.EMPTY:return D2("",e.leadingWhitespace);case I2.NUMBER:return D2(E3(e.value,this.config.decimalSeparator),e.leadingWhitespace);case I2.STRING:return D2('"'+e.value+'"',e.leadingWhitespace);case I2.FUNCTION_CALL:{const n=e.args.map((e=>void 0!==e?this.unparseAst(e,t):"")).join(this.config.functionArgSeparator),r=(this.config.translationPackage.isFunctionTranslated(e.procedureName)?this.config.translationPackage.getFunctionTranslation(e.procedureName):e.procedureName)+"("+n+D2(")",e.internalWhitespace);return D2(r,e.leadingWhitespace)}case I2.NAMED_EXPRESSION:return D2((null===(n=this.namedExpressions.nearestNamedExpression(e.expressionName,t.sheet))||void 0===n?void 0:n.displayName)||e.expressionName,e.leadingWhitespace);case I2.CELL_REFERENCE:{let n;return n=void 0!==e.reference.sheet?this.unparseSheetName(e.reference.sheet)+"!":"",n+=null!==(r=e.reference.unparse(t))&&void 0!==r?r:this.config.translationPackage.getErrorTranslation(X9.REF),D2(n,e.leadingWhitespace)}case I2.COLUMN_RANGE:case I2.ROW_RANGE:case I2.CELL_RANGE:return D2(this.formatRange(e,t),e.leadingWhitespace);case I2.PLUS_UNARY_OP:{const n=this.unparseAst(e.value,t);return D2("+",e.leadingWhitespace)+n}case I2.MINUS_UNARY_OP:{const n=this.unparseAst(e.value,t);return D2("-",e.leadingWhitespace)+n}case I2.PERCENT_OP:return this.unparseAst(e.value,t)+D2("%",e.leadingWhitespace);case I2.ERROR:return D2(this.config.translationPackage.getErrorTranslation(e.error?e.error.type:X9.ERROR),e.leadingWhitespace);case I2.ERROR_WITH_RAW_INPUT:return D2(e.rawInput,e.leadingWhitespace);case I2.PARENTHESIS:{const n="("+this.unparseAst(e.expression,t)+D2(")",e.internalWhitespace);return D2(n,e.leadingWhitespace)}case I2.ARRAY:{const n="{"+e.args.map((e=>e.map((e=>this.unparseAst(e,t))).join(this.config.arrayColumnSeparator))).join(this.config.arrayRowSeparator)+D2("}",e.internalWhitespace);return D2(n,e.leadingWhitespace)}default:{const n=this.unparseAst(e.left,t),r=this.unparseAst(e.right,t);return n+D2(V2[e.type],e.leadingWhitespace)+r}}}unparseSheetName(e){const t=lZ(e,this.sheetMappingFn);if(void 0===t)throw new Z3(e);return t}formatRange(e,t){let n="",r="";void 0!==e.start.sheet&&e.sheetReferenceType!==O2.RELATIVE&&(n=this.unparseSheetName(e.start.sheet)+"!"),void 0!==e.end.sheet&&e.sheetReferenceType===O2.BOTH_ABSOLUTE&&(r=this.unparseSheetName(e.end.sheet)+"!");const i=e.start.unparse(t),o=e.end.unparse(t);return void 0===i||void 0===o?this.config.translationPackage.getErrorTranslation(X9.REF):`${n}${i}:${r}${o}`}}function E3(e,t){return e.toString().replace(".",t)}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class b3{constructor(e,t,n){this.config=e,this.functionRegistry=t,this.sheetMapping=n,this.statsCacheUsed=0,this.lexerConfig=v3(e),this.lexer=new S3(this.lexerConfig),this.formulaParser=new C3(this.lexerConfig,this.sheetMapping),this.cache=new U2(this.functionRegistry)}parse(e,t){this.formulaAddress=t;const n=this.tokenizeFormula(e);if(n.errors.length>0){const e=n.errors.map((e=>({type:M2.LexingError,message:e.message})));return{ast:k2(),errors:e,hasVolatileFunction:!1,hasStructuralChangeFunction:!1,dependencies:[]}}const r=this.computeHashFromTokens(n.tokens,t);let i=this.cache.get(r);if(void 0!==i)++this.statsCacheUsed;else{const e=this.bindWhitespacesToTokens(n.tokens),o=this.formulaParser.parseFromTokens(e,t);if(o.errors.length>0)return Object.assign(Object.assign({},o),{hasVolatileFunction:!1,hasStructuralChangeFunction:!1,dependencies:[]});i=this.cache.set(r,o.ast)}const{ast:o,hasVolatileFunction:s,hasStructuralChangeFunction:a}=i,l=this.convertReversedRangesToRegularRanges(o);return{ast:l,errors:[],hasVolatileFunction:s,hasStructuralChangeFunction:a,dependencies:N3(l,this.functionRegistry)}}convertReversedRangesToRegularRanges(e){switch(e.type){case I2.EMPTY:case I2.NUMBER:case I2.STRING:case I2.ERROR:case I2.ERROR_WITH_RAW_INPUT:case I2.CELL_REFERENCE:case I2.NAMED_EXPRESSION:return e;case I2.CELL_RANGE:{const{start:t,end:n}=e,r=this.orderCellRangeEnds(t,n);return Object.assign(Object.assign({},e),{start:r.start,end:r.end})}case I2.COLUMN_RANGE:{const{start:t,end:n}=e,r=this.orderColumnRangeEnds(t,n);return Object.assign(Object.assign({},e),{start:r.start,end:r.end})}case I2.ROW_RANGE:{const{start:t,end:n}=e,r=this.orderRowRangeEnds(t,n);return Object.assign(Object.assign({},e),{start:r.start,end:r.end})}case I2.PERCENT_OP:case I2.PLUS_UNARY_OP:case I2.MINUS_UNARY_OP:{const t=this.convertReversedRangesToRegularRanges(e.value);return Object.assign(Object.assign({},e),{value:t})}case I2.CONCATENATE_OP:case I2.EQUALS_OP:case I2.NOT_EQUAL_OP:case I2.LESS_THAN_OP:case I2.GREATER_THAN_OP:case I2.LESS_THAN_OR_EQUAL_OP:case I2.GREATER_THAN_OR_EQUAL_OP:case I2.MINUS_OP:case I2.PLUS_OP:case I2.TIMES_OP:case I2.DIV_OP:case I2.POWER_OP:{const t=this.convertReversedRangesToRegularRanges(e.left),n=this.convertReversedRangesToRegularRanges(e.right);return Object.assign(Object.assign({},e),{left:t,right:n})}case I2.PARENTHESIS:{const t=this.convertReversedRangesToRegularRanges(e.expression);return Object.assign(Object.assign({},e),{expression:t})}case I2.FUNCTION_CALL:{const t=e.args.map((e=>this.convertReversedRangesToRegularRanges(e)));return Object.assign(Object.assign({},e),{args:t})}case I2.ARRAY:{const t=e.args.map((e=>e.map((e=>this.convertReversedRangesToRegularRanges(e)))));return Object.assign(Object.assign({},e),{args:t})}}}orderCellRangeEnds(e,t){const n=[e,t],[r,i]=n.map((e=>e.toColumnAddress())).sort(LQ.compareByAbsoluteAddress(this.formulaAddress)),[o,s]=n.map((e=>e.toRowAddress())).sort(HQ.compareByAbsoluteAddress(this.formulaAddress)),[a,l]=n.map((e=>e.sheet)).sort(b3.compareSheetIds.bind(this));return{start:kQ.fromColAndRow(r,o,a),end:kQ.fromColAndRow(i,s,l)}}orderColumnRangeEnds(e,t){const n=[e,t],[r,i]=n.sort(LQ.compareByAbsoluteAddress(this.formulaAddress)),[o,s]=n.map((e=>e.sheet)).sort(b3.compareSheetIds.bind(this));return{start:new LQ(r.type,r.col,o),end:new LQ(i.type,i.col,s)}}orderRowRangeEnds(e,t){const n=[e,t],[r,i]=n.sort(HQ.compareByAbsoluteAddress(this.formulaAddress)),[o,s]=n.map((e=>e.sheet)).sort(b3.compareSheetIds.bind(this));return{start:new HQ(r.type,r.row,o),end:new HQ(i.type,i.row,s)}}static compareSheetIds(e,t){return(e=null!=e?e:1/0)-(t=null!=t?t:1/0)}fetchCachedResultForAst(e){const t=this.computeHashFromAst(e);return this.fetchCachedResult(t)}fetchCachedResult(e){const t=this.cache.get(e);if(void 0===t)throw new Error("There is no AST with such key in the cache");{const{ast:e,hasVolatileFunction:n,hasStructuralChangeFunction:r,relativeDependencies:i}=t;return{ast:e,errors:[],hasVolatileFunction:n,hasStructuralChangeFunction:r,dependencies:i}}}computeHashFromTokens(e,t){var n;let r="",i=0;for(;i<e.length;){const o=e[i];if(l0(o,f3)){const e=tZ(this.sheetMapping,o.image,t);r=void 0===e?r.concat(o.image):r.concat(e.hash(!0))}else if(l0(o,g3)){const e=o.image.toUpperCase().slice(0,-1),t=null!==(n=this.lexerConfig.functionMapping[e])&&void 0!==n?n:e;r=r.concat(t,"(")}else if(l0(o,d3)){const[e,n]=o.image.split(":"),i=nZ(this.sheetMapping,e,t),s=nZ(this.sheetMapping,n,t);r=void 0===i||void 0===s?r.concat("!REF"):r.concat(i.hash(!0),":",s.hash(!0))}else if(l0(o,p3)){const[e,n]=o.image.split(":"),i=rZ(this.sheetMapping,e,t),s=rZ(this.sheetMapping,n,t);r=void 0===i||void 0===s?r.concat("!REF"):r.concat(i.hash(!0),":",s.hash(!0))}else r=r.concat(o.image);i++}return r}rememberNewAst(e){const t=this.computeHashFromAst(e);return this.cache.maybeSetAndThenGet(t,e)}computeHashFromAst(e){return"="+this.computeHashOfAstNode(e)}computeHashOfAstNode(e){switch(e.type){case I2.EMPTY:return e.leadingWhitespace||"";case I2.NUMBER:return D2(E3(e.value,this.config.decimalSeparator),e.leadingWhitespace);case I2.STRING:return D2('"'+e.value+'"',e.leadingWhitespace);case I2.NAMED_EXPRESSION:return D2(e.expressionName,e.leadingWhitespace);case I2.FUNCTION_CALL:{const t=e.args.map((e=>this.computeHashOfAstNode(e))).join(this.config.functionArgSeparator),n=e.procedureName+"("+t+D2(")",e.internalWhitespace);return D2(n,e.leadingWhitespace)}case I2.CELL_REFERENCE:return D2(e.reference.hash(!0),e.leadingWhitespace);case I2.COLUMN_RANGE:case I2.ROW_RANGE:case I2.CELL_RANGE:return D2(e.start.hash(e.sheetReferenceType!==O2.RELATIVE)+":"+e.end.hash(e.sheetReferenceType===O2.BOTH_ABSOLUTE),e.leadingWhitespace);case I2.MINUS_UNARY_OP:return D2("-"+this.computeHashOfAstNode(e.value),e.leadingWhitespace);case I2.PLUS_UNARY_OP:return D2("+"+this.computeHashOfAstNode(e.value),e.leadingWhitespace);case I2.PERCENT_OP:return this.computeHashOfAstNode(e.value)+D2("%",e.leadingWhitespace);case I2.ERROR:return D2(this.config.translationPackage.getErrorTranslation(e.error?e.error.type:X9.ERROR),e.leadingWhitespace);case I2.ERROR_WITH_RAW_INPUT:return D2(e.rawInput,e.leadingWhitespace);case I2.ARRAY:return D2("{"+e.args.map((e=>e.map((e=>this.computeHashOfAstNode(e))).join(","))).join(";")+D2("}",e.internalWhitespace),e.leadingWhitespace);case I2.PARENTHESIS:{const t="("+this.computeHashOfAstNode(e.expression)+D2(")",e.internalWhitespace);return D2(t,e.leadingWhitespace)}default:return this.computeHashOfAstNode(e.left)+D2(V2[e.type],e.leadingWhitespace)+this.computeHashOfAstNode(e.right)}}bindWhitespacesToTokens(e){const t=[],n=e[0];l0(n,this.lexerConfig.WhiteSpace)||t.push(n);for(let r=1;r<e.length;++r){const n=e[r];if(l0(n,this.lexerConfig.WhiteSpace))continue;const i=e[r-1];l0(i,this.lexerConfig.WhiteSpace)&&(n.leadingWhitespace=i),t.push(n)}return t}tokenizeFormula(e){return this.lexer.tokenizeFormula(e)}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */const T3=(e,t,n,r)=>{switch(e.type){case I2.EMPTY:case I2.NUMBER:case I2.STRING:case I2.ERROR:return;case I2.NAMED_EXPRESSION:return void(r&&n.push(new x3(e.expressionName)));case I2.CELL_REFERENCE:return void(r&&n.push(new A3(e.reference)));case I2.CELL_RANGE:return void(r&&e.start.sheet===e.end.sheet&&n.push(new M3(e.start,e.end)));case I2.COLUMN_RANGE:return void(r&&e.start.sheet===e.end.sheet&&n.push(new I3(e.start,e.end)));case I2.ROW_RANGE:return void(r&&e.start.sheet===e.end.sheet&&n.push(new O3(e.start,e.end)));case I2.PERCENT_OP:case I2.PLUS_UNARY_OP:case I2.MINUS_UNARY_OP:return void T3(e.value,t,n,!0);case I2.CONCATENATE_OP:case I2.EQUALS_OP:case I2.NOT_EQUAL_OP:case I2.LESS_THAN_OP:case I2.GREATER_THAN_OP:case I2.LESS_THAN_OR_EQUAL_OP:case I2.GREATER_THAN_OR_EQUAL_OP:case I2.MINUS_OP:case I2.PLUS_OP:case I2.TIMES_OP:case I2.DIV_OP:case I2.POWER_OP:return T3(e.left,t,n,!0),void T3(e.right,t,n,!0);case I2.PARENTHESIS:return void T3(e.expression,t,n,r);case I2.FUNCTION_CALL:{const r=!t.doesFunctionNeedArgumentToBeComputed(e.procedureName);return void e.args.forEach((e=>T3(e,t,n,r)))}}},N3=(e,t)=>{const n=new Array;return T3(e,t,n,!0),n};
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
class A3{constructor(e){this.dependency=e}absolutize(e){return this.dependency.toSimpleCellAddress(e)}}class M3{constructor(e,t){this.start=e,this.end=t}absolutize(e){return new M4(this.start.toSimpleCellAddress(e),this.end.toSimpleCellAddress(e))}}class I3{constructor(e,t){this.start=e,this.end=t}absolutize(e){const t=this.start.toSimpleColumnAddress(e),n=this.end.toSimpleColumnAddress(e);return new I4(t.sheet,t.col,n.col)}}class O3{constructor(e,t){this.start=e,this.end=t}absolutize(e){const t=this.start.toSimpleRowAddress(e),n=this.end.toSimpleRowAddress(e);return new O4(t.sheet,t.row,n.row)}}class x3{constructor(e){this.name=e}absolutize(e){return this}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */const P3=(e,t)=>e.map((e=>e.absolutize(t))),_3=Symbol("Empty value");function L3(e){return e instanceof H3?e.val:e}class H3{constructor(e,t){this.val=e,this.format=t}fromNumber(e){return new this.constructor(e)}}function k3(e,t){if("number"==typeof e)return t;{const n=e.fromNumber(t);return n.format=e.format,n}}class F3 extends H3{getDetailedType(){return j3.NUMBER_DATE}}class D3 extends H3{getDetailedType(){return j3.NUMBER_CURRENCY}}class V3 extends H3{getDetailedType(){return j3.NUMBER_TIME}}class U3 extends H3{getDetailedType(){return j3.NUMBER_DATETIME}}class B3 extends H3{getDetailedType(){return j3.NUMBER_PERCENT}}function W3(e){return"number"==typeof e||e instanceof H3}var j3,G3;function z3(e){return e instanceof H3?{type:e.getDetailedType(),format:e.format}:{type:j3.NUMBER_RAW}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */!function(e){e.NUMBER_RAW="NUMBER_RAW",e.NUMBER_DATE="NUMBER_DATE",e.NUMBER_TIME="NUMBER_TIME",e.NUMBER_DATETIME="NUMBER_DATETIME",e.NUMBER_CURRENCY="NUMBER_CURRENCY",e.NUMBER_PERCENT="NUMBER_PERCENT"}(j3||(j3={}));class $3{constructor(e,t,n,r){this._data=e,this.range=t,this.dependencyGraph=n,this._hasOnlyNumbers=r,this.size=void 0===e?new e5(t.effectiveWidth(n),t.effectiveHeight(n)):new e5(e[0].length,e.length)}get data(){return this.ensureThatComputed(),this._data}static fromRange(e,t,n){return new $3(e,t,n,!0)}static onlyNumbers(e){return new $3(e,void 0,void 0,!0)}static onlyValues(e){return new $3(e,void 0,void 0,void 0)}static onlyRange(e,t){return new $3(void 0,e,t,void 0)}static fromScalar(e){return new $3([[e]],void 0,void 0,void 0)}isAdHoc(){return void 0===this.range}width(){return this.size.width}height(){return this.size.height}valuesFromTopLeftCorner(){this.ensureThatComputed();const e=[];for(let t=0;t<this._data.length;t++)for(let n=0;n<this._data[0].length;n++)e.push(this._data[t][n]);return e}*effectiveAddressesFromData(e){for(let t=0;t<this.data.length;++t){const n=this.data[t];for(let r=0;r<n.length;++r)yield v4(e.sheet,e.col+r,e.row+t)}}*entriesFromTopLeftCorner(e){this.ensureThatComputed();for(let t=0;t<this.size.height;++t)for(let n=0;n<this.size.width;++n)yield[this._data[t][n],v4(e.sheet,e.col+n,e.row+t)]}*iterateValuesFromTopLeftCorner(){yield*this.valuesFromTopLeftCorner()}numberOfElements(){return this.size.width*this.size.height}hasOnlyNumbers(){if(void 0===this._hasOnlyNumbers){this._hasOnlyNumbers=!0;for(const e of this.data)for(const t of e)if("number"!=typeof t)return this._hasOnlyNumbers=!1,!1}return this._hasOnlyNumbers}rawNumbers(){return this._data}rawData(){var e;return this.ensureThatComputed(),null!==(e=this._data)&&void 0!==e?e:[]}sameDimensionsAs(e){return this.width()===e.width()&&this.height()===e.height()}ensureThatComputed(){void 0===this._data&&(this._hasOnlyNumbers=!0,this._data=this.range.addressesArrayMap(this.dependencyGraph,(e=>{const t=this.dependencyGraph.getCellValue(e);return t instanceof $3?(this._hasOnlyNumbers=!1,new g4(X9.VALUE,W2.ScalarExpected)):(W3(t)||(this._hasOnlyNumbers=!1),t)})))}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class Y3{constructor(){this.changes=new Map}static empty(){return new Y3}addAll(e){for(const t of e.changes.values())this.add(t.address,t);return this}addChange(e,t,n){this.addInterpreterValue(e,t,n)}exportChanges(e){let t=[];return this.changes.forEach((n=>{const r=e.exportChange(n);Array.isArray(r)?t=t.concat(r):t.push(r)})),t}getChanges(){return Array.from(this.changes.values())}isEmpty(){return 0===this.changes.size}add(e,t){const n=t.value;if(n instanceof $3)for(const r of n.effectiveAddressesFromData(e))this.changes.delete(R4(r));this.changes.set(R4(e),t)}addInterpreterValue(e,t,n){this.add(t,{address:t,value:e,oldValue:n})}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class K3{constructor(e,t,n){if(this.sheet=e,this.rowStart=t,this.rowEnd=n,t<0)throw Error("Starting row cant be less than 0");if(n<t)throw Error("Row span cant end before start")}get numberOfRows(){return this.rowEnd-this.rowStart+1}get start(){return this.rowStart}get end(){return this.rowEnd}static fromNumberOfRows(e,t,n){return new K3(e,t,t+n-1)}static fromRowStartAndEnd(e,t,n){return new K3(e,t,n)}*rows(){for(let e=this.rowStart;e<=this.rowEnd;++e)yield e}intersect(e){if(this.sheet!==e.sheet)throw Error("Can't intersect spans from different sheets");const t=Math.max(this.rowStart,e.rowStart),n=Math.min(this.rowEnd,e.rowEnd);return t>n?null:new K3(this.sheet,t,n)}firstRow(){return new K3(this.sheet,this.rowStart,this.rowStart)}}class X3{constructor(e,t,n){if(this.sheet=e,this.columnStart=t,this.columnEnd=n,t<0)throw Error("Starting column cant be less than 0");if(n<t)throw Error("Column span cant end before start")}get numberOfColumns(){return this.columnEnd-this.columnStart+1}get start(){return this.columnStart}get end(){return this.columnEnd}static fromNumberOfColumns(e,t,n){return new X3(e,t,t+n-1)}static fromColumnStartAndEnd(e,t,n){return new X3(e,t,n)}*columns(){for(let e=this.columnStart;e<=this.columnEnd;++e)yield e}intersect(e){if(this.sheet!==e.sheet)throw Error("Can't intersect spans from different sheets");const t=Math.max(this.columnStart,e.columnStart),n=Math.min(this.columnEnd,e.columnEnd);return t>n?null:new X3(this.sheet,t,n)}firstColumn(){return new X3(this.sheet,this.columnStart,this.columnStart)}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */!function(e){e.BUILD_ENGINE_TOTAL="BUILD_ENGINE_TOTAL",e.PARSER="PARSER",e.GRAPH_BUILD="GRAPH_BUILD",e.COLLECT_DEPENDENCIES="COLLECT_DEPENDENCIES",e.PROCESS_DEPENDENCIES="PROCESS_DEPENDENCIES",e.TOP_SORT="TOP_SORT",e.BUILD_COLUMN_INDEX="BUILD_COLUMN_INDEX",e.EVALUATION="EVALUATION",e.VLOOKUP="VLOOKUP",e.TRANSFORM_ASTS="TRANSFORM_ASTS",e.TRANSFORM_ASTS_POSTPONED="TRANSFORM_ASTS_POSTPONED",e.ADJUSTING_ADDRESS_MAPPING="ADJUSTING_ADDRESS_MAPPING",e.ADJUSTING_ARRAY_MAPPING="ADJUSTING_ARRAY_MAPPING",e.ADJUSTING_RANGES="ADJUSTING_RANGES",e.ADJUSTING_GRAPH="ADJUSTING_GRAPH",e.CRITERION_FUNCTION_FULL_CACHE_USED="CRITERION_FUNCTION_FULL_CACHE_USED",e.CRITERION_FUNCTION_PARTIAL_CACHE_USED="CRITERION_FUNCTION_PARTIAL_CACHE_USED"}(G3||(G3={}));
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
class q3{constructor(){this.stats=new Map([[G3.CRITERION_FUNCTION_FULL_CACHE_USED,0],[G3.CRITERION_FUNCTION_PARTIAL_CACHE_USED,0]]),this.startTimes=new Map}incrementCriterionFunctionFullCacheUsed(){var e;const t=(null!==(e=this.stats.get(G3.CRITERION_FUNCTION_FULL_CACHE_USED))&&void 0!==e?e:0)+1;this.stats.set(G3.CRITERION_FUNCTION_FULL_CACHE_USED,t)}incrementCriterionFunctionPartialCacheUsed(){var e;const t=(null!==(e=this.stats.get(G3.CRITERION_FUNCTION_PARTIAL_CACHE_USED))&&void 0!==e?e:0)+1;this.stats.set(G3.CRITERION_FUNCTION_PARTIAL_CACHE_USED,t)}reset(){this.stats.clear(),this.startTimes.clear(),this.stats.set(G3.CRITERION_FUNCTION_FULL_CACHE_USED,0),this.stats.set(G3.CRITERION_FUNCTION_PARTIAL_CACHE_USED,0)}start(e){if(this.startTimes.get(e))throw Error(`Statistics ${e} already started`);this.startTimes.set(e,Date.now())}end(e){var t;const n=Date.now(),r=this.startTimes.get(e);if(!r)throw Error(`Statistics ${e} not started`);{let i=null!==(t=this.stats.get(e))&&void 0!==t?t:0;i+=n-r,this.stats.set(e,i),this.startTimes.delete(e)}}measure(e,t){this.start(e);const n=t();return this.end(e),n}snapshot(){return new Map(this.stats)}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class Q3 extends q3{incrementCriterionFunctionFullCacheUsed(){}incrementCriterionFunctionPartialCacheUsed(){}start(e){}end(e){}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class Z3 extends Error{constructor(e){super(`There's no sheet with id = ${e}`)}}class J3 extends Error{constructor(e){super(`There's no sheet with name '${e}'`)}}class e9 extends Error{constructor(e){super(`Sheet with name ${e} already exists`)}}class t9 extends Error{constructor(){super("Sheet size limit exceeded")}}class n9 extends Error{constructor(){super("This is not a formula")}}class r9 extends Error{constructor(e){super(`Address (row = ${e.row}, col = ${e.col}) is invalid`)}}class i9 extends Error{constructor(e){super(`Invalid arguments, expected ${e}`)}}class o9 extends Error{constructor(e,t){super(`Sheets ${e} and ${t} are not equal.`)}}class s9 extends Error{constructor(e){super(`Name of Named Expression '${e}' is already present`)}}class a9 extends Error{constructor(e){super(`Name of Named Expression '${e}' is invalid`)}}class l9 extends Error{constructor(e){super(`Named Expression '${e}' does not exist`)}}class h9 extends Error{constructor(){super("There is no operation to undo")}}class u9 extends Error{constructor(){super("There is no operation to redo")}}class c9 extends Error{constructor(){super("There is nothing to paste")}}function d9(e,t){switch(typeof t){case"function":case"symbol":return t.toString();case"bigint":return"BigInt("+t.toString()+")";default:return t instanceof RegExp?"RegExp("+t.toString()+")":t}}class p9 extends Error{constructor(e){super(`Unable to parse value: ${JSON.stringify(e,d9,4)}`)}}class g9 extends Error{constructor(e,t){super(`Expected value of type: ${e} for config parameter: ${t}`)}}class m9 extends Error{constructor(e){super(`Config parameter ${e} cannot be empty.`)}}class f9 extends Error{constructor(e,t){super(`Config parameter ${e} should be at least ${t}`)}}class w9 extends Error{constructor(e,t){super(`Config parameter ${e} should be at most ${t}`)}}class y9 extends Error{constructor(e,t){super(`Expected one of ${e} for config parameter: ${t}`)}}class v9 extends Error{constructor(){super("Computations are suspended")}}class C9 extends Error{constructor(e){super(`Translation for ${e} is missing in the translation package you're using.`)}}class S9 extends Error{constructor(e){super(`Cannot register translation for function with id: ${e}`)}}class R9 extends Error{constructor(){super("Language not registered.")}}class E9 extends Error{constructor(){super("Language already registered.")}}class b9 extends Error{static functionNotDeclaredInPlugin(e,t){return new b9(`Function with id ${e} not declared in plugin ${t}`)}static functionMethodNotFound(e,t){return new b9(`Function method ${e} not found in plugin ${t}`)}}class T9 extends Error{static cannotRegisterFunctionWithId(e){return new T9(`Cannot register function with id ${e}`)}static cannotUnregisterFunctionWithId(e){return new T9(`Cannot unregister function with id ${e}`)}static cannotUnregisterProtectedPlugin(){return new T9("Cannot unregister protected plugin")}}class N9 extends Error{constructor(){super("Cannot perform this operation, source location has an array inside.")}}class A9 extends Error{constructor(){super("Cannot perform this operation, target location has an array inside.")}}class M9 extends Error{constructor(){super("Relative addresses not allowed in named expressions.")}}class I9 extends Error{constructor(e,t){super(`Alias id ${e} in plugin ${t} already defined as a function or alias.`)}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class O9{constructor(e){this.policy=e,this.mapping=new Map}getCell(e){const t=this.mapping.get(e.sheet);if(void 0===t)throw new Z3(e.sheet);return t.getCell(e)}fetchCell(e){const t=this.mapping.get(e.sheet);if(void 0===t)throw new Z3(e.sheet);const n=t.getCell(e);if(!n)throw Error("Vertex for address missing in AddressMapping");return n}strategyFor(e){const t=this.mapping.get(e);if(void 0===t)throw new Z3(e);return t}addSheet(e,t){if(this.mapping.has(e))throw Error("Sheet already added");this.mapping.set(e,t)}autoAddSheet(e,t){const{height:n,width:r,fill:i}=t,o=this.policy.call(i);this.addSheet(e,new o(r,n))}getCellValue(e){const t=this.getCell(e);return void 0===t?_3:t instanceof k9?t.getArrayCellValue(e):t.getCellValue()}getRawValue(e){const t=this.getCell(e);return t instanceof n4?t.getValues().rawValue:t instanceof k9?t.getArrayCellRawValue(e):null}setCell(e,t){const n=this.mapping.get(e.sheet);if(!n)throw Error("Sheet not initialized");n.setCell(e,t)}moveCell(e,t){const n=this.mapping.get(e.sheet);if(!n)throw Error("Sheet not initialized.");if(e.sheet!==t.sheet)throw Error("Cannot move cells between sheets.");if(n.has(t))throw new Error("Cannot move cell. Destination already occupied.");const r=n.getCell(e);if(void 0===r)throw new Error("Cannot move cell. No cell with such address.");this.setCell(t,r),this.removeCell(e)}removeCell(e){const t=this.mapping.get(e.sheet);if(!t)throw Error("Sheet not initialized");t.removeCell(e)}has(e){const t=this.mapping.get(e.sheet);return void 0!==t&&t.has(e)}getHeight(e){const t=this.mapping.get(e);if(void 0===t)throw new Z3(e);return t.getHeight()}getWidth(e){const t=this.mapping.get(e);if(!t)throw new Z3(e);return t.getWidth()}addRows(e,t,n){const r=this.mapping.get(e);if(void 0===r)throw new Z3(e);r.addRows(t,n)}removeRows(e){const t=this.mapping.get(e.sheet);if(void 0===t)throw new Z3(e.sheet);t.removeRows(e)}removeSheet(e){this.mapping.delete(e)}addColumns(e,t,n){const r=this.mapping.get(e);if(void 0===r)throw new Z3(e);r.addColumns(t,n)}removeColumns(e){const t=this.mapping.get(e.sheet);if(void 0===t)throw new Z3(e.sheet);t.removeColumns(e)}*verticesFromRowsSpan(e){yield*this.mapping.get(e.sheet).verticesFromRowsSpan(e)}*verticesFromColumnsSpan(e){yield*this.mapping.get(e.sheet).verticesFromColumnsSpan(e)}*entriesFromRowsSpan(e){yield*this.mapping.get(e.sheet).entriesFromRowsSpan(e)}*entriesFromColumnsSpan(e){yield*this.mapping.get(e.sheet).entriesFromColumnsSpan(e)}*entries(){for(const[e,t]of this.mapping.entries())yield*t.getEntries(e)}*sheetEntries(e){const t=this.mapping.get(e);if(void 0===t)throw new Z3(e);yield*t.getEntries(e)}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class x9{constructor(){this.arrayMapping=new Map}getArray(e){const t=this.getArrayByCorner(e.start);if(null==t?void 0:t.getRange().sameAs(e))return t}getArrayByCorner(e){return this.arrayMapping.get(R4(e))}setArray(e,t){this.arrayMapping.set(R4(e.start),t)}removeArray(e){"string"==typeof e?this.arrayMapping.delete(e):this.arrayMapping.delete(R4(e.start))}count(){return this.arrayMapping.size}*arraysInRows(e){for(const[t,n]of this.arrayMapping.entries())n.spansThroughSheetRows(e.sheet,e.rowStart,e.rowEnd)&&(yield[t,n])}*arraysInCols(e){for(const[t,n]of this.arrayMapping.entries())n.spansThroughSheetColumn(e.sheet,e.columnStart,e.columnEnd)&&(yield[t,n])}isFormulaArrayInRow(e,t){for(const n of this.arrayMapping.values())if(n.spansThroughSheetRows(e,t))return!0;return!1}isFormulaArrayInAllRows(e){let t=!0;for(const n of e.rows())this.isFormulaArrayInRow(e.sheet,n)||(t=!1);return t}isFormulaArrayInColumn(e,t){for(const n of this.arrayMapping.values())if(n.spansThroughSheetColumn(e,t))return!0;return!1}isFormulaArrayInAllColumns(e){let t=!0;for(const n of e.columns())this.isFormulaArrayInColumn(e.sheet,n)||(t=!1);return t}isFormulaArrayInRange(e){for(const t of this.arrayMapping.values())if(t.getRange().doesOverlap(e))return!0;return!1}isFormulaArrayAtAddress(e){for(const t of this.arrayMapping.values())if(t.getRange().addressInRange(e))return!0;return!1}moveArrayVerticesAfterRowByRows(e,t,n){this.updateArrayVerticesInSheet(e,((e,r)=>{const i=r.getRange();return t<=i.start.row?[i.shifted(0,n),r]:void 0}))}moveArrayVerticesAfterColumnByColumns(e,t,n){this.updateArrayVerticesInSheet(e,((e,r)=>{const i=r.getRange();return t<=i.start.col?[i.shifted(n,0),r]:void 0}))}updateArrayVerticesInSheet(e,t){const n=Array();for(const[r,i]of this.arrayMapping.entries()){if(i.sheet!==e)continue;const o=t(r,i);void 0!==o&&(this.removeArray(r),n.push(o))}n.forEach((([e,t])=>{this.setArray(e,t)}))}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class P9{constructor(e){this.size=e}width(){return this.size.width}height(){return this.size.height}get(e,t){throw Error("Array not computed yet.")}simpleRangeValue(){throw Error("Array not computed yet.")}}class _9{constructor(e){if(this.size=new e5(e.length>0?e[0].length:0,e.length),this.array=e,this.size.width<=0||this.size.height<=0)throw Error("Incorrect array size")}static fromInterpreterValue(e){return new _9(e instanceof $3?e.data:[[e]])}simpleRangeValue(){return $3.onlyValues(this.array)}addRows(e,t){this.array.splice(e,0,...this.nullArrays(t,this.width())),this.size.height+=t}addColumns(e,t){for(let n=0;n<this.height();n++)this.array[n].splice(e,0,...new Array(t).fill(_3));this.size.width+=t}removeRows(e,t){if(this.outOfBound(0,e)||this.outOfBound(0,t))throw Error("Array index out of bound");const n=t-e+1;this.array.splice(e,n),this.size.height-=n}removeColumns(e,t){if(this.outOfBound(e,0)||this.outOfBound(t,0))throw Error("Array index out of bound");const n=t-e+1;for(const r of this.array)r.splice(e,n);this.size.width-=n}nullArrays(e,t){const n=[];for(let r=0;r<e;++r)n.push(new Array(t).fill(_3));return n}get(e,t){if(this.outOfBound(e,t))throw Error("Array index out of bound");return this.array[t][e]}set(e,t,n){if(this.outOfBound(e,t))throw Error("Array index out of bound");this.array[t][e]=n}width(){return this.size.width}height(){return this.size.height}raw(){return this.array}resize(e){if(this.height()<e.height&&isFinite(e.height)&&this.addRows(this.height(),e.height-this.height()),this.height()>e.height)throw Error("Resizing to smaller array");if(this.width()<e.width&&isFinite(e.width)&&this.addColumns(this.width(),e.width-this.width()),this.width()>e.width)throw Error("Resizing to smaller array")}outOfBound(e,t){return e<0||t<0||t>this.size.height-1||e>this.size.width-1}}class L9{constructor(e,t){this.error=e,this.size=t}get(e,t){return this.error}width(){return this.size.width}height(){return this.size.height}simpleRangeValue(){return this.error}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class H9{constructor(e,t,n){this.formula=e,this.cellAddress=t,this.version=n}get width(){return 1}get height(){return 1}static fromAst(e,t,n,r){return n.isScalar()?new F9(e,t,r):new k9(e,t,n,r)}getFormula(e){return this.ensureRecentData(e),this.formula}ensureRecentData(e){if(this.version!=e.version()){const[t,n,r]=e.applyTransformations(this.formula,this.cellAddress,this.version);this.formula=t,this.cellAddress=n,this.version=r}}getAddress(e){return this.ensureRecentData(e),this.cellAddress}}class k9 extends H9{constructor(e,t,n,r=0){super(e,t,r),n.isRef?this.array=new L9(new g4(X9.REF,W2.NoSpaceForArrayResult),e5.error()):this.array=new P9(n)}get width(){return this.array.width()}get height(){return this.array.height()}get sheet(){return this.cellAddress.sheet}get leftCorner(){return this.cellAddress}setCellValue(e){if(e instanceof g4)return this.setErrorValue(e),e;const t=_9.fromInterpreterValue(e);return t.resize(this.array.size),this.array=t,e}getCellValue(){if(this.array instanceof P9)throw Error("Array not computed yet.");return this.array.simpleRangeValue()}valueOrUndef(){if(!(this.array instanceof P9))return this.array.simpleRangeValue()}getArrayCellValue(e){const t=e.col-this.cellAddress.col,n=e.row-this.cellAddress.row;try{return this.array.get(t,n)}catch(r){return new g4(X9.REF)}}getArrayCellRawValue(e){const t=this.getArrayCellValue(e);return t instanceof g4||t===_3?void 0:L3(t)}setArrayCellValue(e,t){const n=e.col-this.cellAddress.col,r=e.row-this.cellAddress.row;this.array instanceof _9&&this.array.set(n,r,t)}setNoSpace(){return this.array=new L9(new g4(X9.SPILL,W2.NoSpaceForArrayResult),e5.error()),this.getCellValue()}getRange(){return M4.spanFrom(this.cellAddress,this.width,this.height)}getRangeOrUndef(){return M4.spanFromOrUndef(this.cellAddress,this.width,this.height)}setAddress(e){this.cellAddress=e}setFormula(e){this.formula=e}spansThroughSheetRows(e,t,n=t){return this.cellAddress.sheet===e&&this.cellAddress.row<=n&&t<this.cellAddress.row+this.height}spansThroughSheetColumn(e,t,n=t){return this.cellAddress.sheet===e&&this.cellAddress.col<=n&&t<this.cellAddress.col+this.width}isComputed(){return!(this.array instanceof P9)}columnsFromArray(){return X3.fromNumberOfColumns(this.cellAddress.sheet,this.cellAddress.col,this.width)}rowsFromArray(){return K3.fromNumberOfRows(this.cellAddress.sheet,this.cellAddress.row,this.height)}ensureRecentData(e){}isLeftCorner(e){return T4(this.cellAddress,e)}setErrorValue(e){this.array=new L9(e,this.array.size)}}class F9 extends H9{constructor(e,t,n){super(e,t,n)}valueOrUndef(){return this.cachedCellValue}setCellValue(e){return this.cachedCellValue=e,this.cachedCellValue}getCellValue(){if(void 0!==this.cachedCellValue)return this.cachedCellValue;throw Error("Value of the formula cell is not computed.")}isComputed(){return void 0!==this.cachedCellValue}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class D9{constructor(e){this.range=e,this.functionCache=new Map,this.criterionFunctionCache=new Map,this.dependentCacheRanges=new Set,this.bruteForce=!1}get start(){return this.range.start}get end(){return this.range.end}get sheet(){return this.range.start.sheet}getFunctionValue(e){return this.functionCache.get(e)}setFunctionValue(e,t){this.functionCache.set(e,t)}getCriterionFunctionValue(e,t){var n;return null===(n=this.getCriterionFunctionValues(e).get(t))||void 0===n?void 0:n[0]}getCriterionFunctionValues(e){var t;return null!==(t=this.criterionFunctionCache.get(e))&&void 0!==t?t:new Map}setCriterionFunctionValues(e,t){this.criterionFunctionCache.set(e,t)}addDependentCacheRange(e){e!==this&&this.dependentCacheRanges.add(e)}clearCache(){this.functionCache.clear(),this.criterionFunctionCache.clear(),this.dependentCacheRanges.forEach((e=>e.criterionFunctionCache.clear())),this.dependentCacheRanges.clear()}getStart(){return this.start}getEnd(){return this.end}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */const V9=(e,t,n,r,i)=>{if(t instanceof D9){const e=t.range.intersectionWith(n);return void 0!==e?Array.from(e.addresses(i)):[]}let o,s;return t instanceof H9?(o=t.getFormula(r),s=t.getAddress(r),N3(o,e).filter((e=>e instanceof A3)).map((e=>e.dependency.toSimpleCellAddress(s))).filter((e=>n.addressInRange(e)))):[]};
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */var U9;!function(e){e[e.ON_STACK=0]="ON_STACK",e[e.PROCESSED=1]="PROCESSED",e[e.POPPED=2]="POPPED"}(U9||(U9={}));class B9{constructor(e=[],t=[]){this.nodesSparseArray=e,this.edgesSparseArray=t,this.entranceTime=[],this.low=[],this.parent=[],this.inSCC=[],this.nodeStatus=[],this.order=[],this.sccNonSingletons=[],this.timeCounter=0}getTopSortedWithSccSubgraphFrom(e,t,n){const r=e.reverse();return r.forEach((e=>this.runDFS(e))),this.postprocess(r,n,t)}getAdjacentNodeIds(e){return this.edgesSparseArray[e].filter((e=>void 0!==e&&this.nodesSparseArray[e]))}runDFS(e){if(void 0!==this.nodeStatus[e])return;this.nodeStatus[e]=U9.ON_STACK;const t=[e],n=[];for(;t.length>0;){const e=t[t.length-1];switch(this.nodeStatus[e]){case U9.ON_STACK:this.handleOnStack(e,n,t);break;case U9.PROCESSED:this.handleProcessed(e,n,t);break;case U9.POPPED:t.pop()}}}handleOnStack(e,t,n){this.entranceTime[e]=this.timeCounter,this.low[e]=this.timeCounter,this.timeCounter++,t.push(e),this.getAdjacentNodeIds(e).forEach((t=>{void 0===this.entranceTime[t]&&(n.push(t),this.parent[t]=e,this.nodeStatus[t]=U9.ON_STACK)})),this.nodeStatus[e]=U9.PROCESSED}handleProcessed(e,t,n){let r=this.entranceTime[e];if(this.getAdjacentNodeIds(e).forEach((t=>{this.inSCC[t]||(r=this.parent[t]===e?Math.min(r,this.low[t]):Math.min(r,this.entranceTime[t]))})),this.low[e]=r,r===this.entranceTime[e]){const n=[];do{n.push(t[t.length-1]),t.pop()}while(n[n.length-1]!==e);n.forEach((e=>{this.inSCC[e]=!0})),this.order.push(...n),n.length>1&&n.forEach((e=>{this.sccNonSingletons[e]=!0}))}n.pop(),this.nodeStatus[e]=U9.POPPED}postprocess(e,t,n){const r=[];e.forEach((e=>{r[e]=!0}));const i=[],o=[];return this.order.reverse(),this.order.forEach((e=>{const s=this.getAdjacentNodeIds(e);this.sccNonSingletons[e]||s.includes(e)?(o.push(this.nodesSparseArray[e]),t(this.nodesSparseArray[e]),s.forEach((e=>r[e]=!0))):(i.push(this.nodesSparseArray[e]),r[e]&&n(this.nodesSparseArray[e])&&s.forEach((e=>r[e]=!0)))})),{sorted:i,cycled:o}}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class W9{constructor(e,t){this.rawValue=e,this.processFn=t,this.processedValue=null}getProcessedValue(){return null===this.processedValue&&(this.processedValue=this.processFn(this.rawValue)),this.processedValue}markAsModified(){this.processedValue=null}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class j9{constructor(e){this.dependencyQuery=e,this.nodesSparseArray=[],this.edgesSparseArray=[],this.nodesIds=new Map,this.dirtyAndVolatileNodeIds=new W9({dirty:[],volatile:[]},(e=>this.processDirtyAndVolatileNodeIds(e))),this.infiniteRangeIds=new Set,this.changingWithStructureNodeIds=[],this.nextId=0}getNodes(){return this.nodesSparseArray.filter((e=>void 0!==e))}hasNode(e){return this.nodesIds.has(e)}existsEdge(e,t){const n=this.getNodeId(e),r=this.getNodeId(t);return void 0!==n&&void 0!==r&&this.edgesSparseArray[n].includes(r)}adjacentNodes(e){const t=this.getNodeId(e);if(void 0===t)throw this.missingNodeError(e);return new Set(this.edgesSparseArray[t].filter((e=>void 0!==e)).map((e=>this.nodesSparseArray[e])))}adjacentNodesCount(e){const t=this.getNodeId(e);if(void 0===t)throw this.missingNodeError(e);return this.fixEdgesArrayForNode(t).length}addNodeAndReturnId(e){const t=this.nodesIds.get(e);if(void 0!==t)return t;const n=this.nextId;return this.nextId++,this.nodesSparseArray[n]=e,this.edgesSparseArray[n]=[],this.nodesIds.set(e,n),n}addEdge(e,t){const n=this.getNodeIdIfNotNumber(e),r=this.getNodeIdIfNotNumber(t);if(void 0===n)throw this.missingNodeError(e);if(void 0===r)throw this.missingNodeError(t);this.edgesSparseArray[n].includes(r)||this.edgesSparseArray[n].push(r)}removeNode(e){const t=this.getNodeId(e);if(void 0===t)throw this.missingNodeError(e);this.edgesSparseArray[t].length>0&&(this.edgesSparseArray[t].forEach((e=>this.dirtyAndVolatileNodeIds.rawValue.dirty.push(e))),this.dirtyAndVolatileNodeIds.markAsModified());const n=this.removeDependencies(e);return delete this.nodesSparseArray[t],delete this.edgesSparseArray[t],this.infiniteRangeIds.delete(t),this.nodesIds.delete(e),n}removeEdge(e,t){const n=this.getNodeIdIfNotNumber(e),r=this.getNodeIdIfNotNumber(t);if(void 0===n)throw this.missingNodeError(e);if(void 0===r)throw this.missingNodeError(t);const i=this.edgesSparseArray[n].indexOf(r);if(-1===i)throw new Error("Edge does not exist");delete this.edgesSparseArray[n][i]}removeEdgeIfExists(e,t){const n=this.getNodeId(e),r=this.getNodeId(t);if(void 0===n)return;if(void 0===r)return;const i=this.edgesSparseArray[n].indexOf(r);-1!==i&&delete this.edgesSparseArray[n][i]}topSortWithScc(){return this.getTopSortedWithSccSubgraphFrom(this.getNodes(),(()=>!0),(()=>{}))}getTopSortedWithSccSubgraphFrom(e,t,n){const r=new B9(this.nodesSparseArray,this.edgesSparseArray),i=e.map((e=>this.getNodeId(e))).filter((e=>void 0!==e));return r.getTopSortedWithSccSubgraphFrom(i,t,n)}markNodeAsVolatile(e){const t=this.getNodeId(e);void 0!==t&&(this.dirtyAndVolatileNodeIds.rawValue.volatile.push(t),this.dirtyAndVolatileNodeIds.markAsModified())}markNodeAsDirty(e){const t=this.getNodeId(e);void 0!==t&&(this.dirtyAndVolatileNodeIds.rawValue.dirty.push(t),this.dirtyAndVolatileNodeIds.markAsModified())}getDirtyAndVolatileNodes(){return this.dirtyAndVolatileNodeIds.getProcessedValue()}clearDirtyNodes(){this.dirtyAndVolatileNodeIds.rawValue.dirty=[],this.dirtyAndVolatileNodeIds.markAsModified()}markNodeAsChangingWithStructure(e){const t=this.getNodeId(e);void 0!==t&&this.changingWithStructureNodeIds.push(t)}markChangingWithStructureNodesAsDirty(){this.changingWithStructureNodeIds.length<=0||(this.dirtyAndVolatileNodeIds.rawValue.dirty=[...this.dirtyAndVolatileNodeIds.rawValue.dirty,...this.changingWithStructureNodeIds],this.dirtyAndVolatileNodeIds.markAsModified())}markNodeAsInfiniteRange(e){const t=this.getNodeIdIfNotNumber(e);void 0!==t&&this.infiniteRangeIds.add(t)}getInfiniteRanges(){return[...this.infiniteRangeIds].map((e=>({node:this.nodesSparseArray[e],id:e})))}getNodeId(e){return this.nodesIds.get(e)}getNodeIdIfNotNumber(e){return"number"==typeof e?e:this.nodesIds.get(e)}fixEdgesArrayForNode(e){const t=this.edgesSparseArray[e];return this.edgesSparseArray[e]=t.filter((e=>void 0!==e&&this.nodesSparseArray[e])),this.edgesSparseArray[e]}removeDependencies(e){const t=this.dependencyQuery(e);return t.forEach((([t,n])=>{this.removeEdgeIfExists(n,e)})),t}processDirtyAndVolatileNodeIds({dirty:e,volatile:t}){return[...new Set([...e,...t])].map((e=>this.nodesSparseArray[e])).filter((e=>void 0!==e))}missingNodeError(e){return new Error(`Unknown node ${e}`)}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class G9{constructor(){this.rangeMapping=new Map}getMappingSize(e){var t,n;return null!==(n=null===(t=this.rangeMapping.get(e))||void 0===t?void 0:t.size)&&void 0!==n?n:0}setRange(e){let t=this.rangeMapping.get(e.getStart().sheet);void 0===t&&(t=new Map,this.rangeMapping.set(e.getStart().sheet,t));const n=z9(e.getStart(),e.getEnd());t.set(n,e)}removeRange(e){const t=e.getStart().sheet,n=this.rangeMapping.get(t);if(void 0===n)return;const r=z9(e.getStart(),e.getEnd());n.delete(r),0===n.size&&this.rangeMapping.delete(t)}getRange(e,t){const n=this.rangeMapping.get(e.sheet),r=z9(e,t);return null==n?void 0:n.get(r)}fetchRange(e,t){const n=this.getRange(e,t);if(!n)throw Error("Range does not exist");return n}truncateRanges(e,t){const n=Array(),r=Array(),i=Array(),o=e.sheet;for(const[l,h]of this.entriesFromSheet(e.sheet)){const s=h.range;e.start<=t(h.range.end)&&(s.removeSpan(e),s.shouldBeRemoved()?(this.removeByKey(o,l),n.push(h)):r.push([l,h]),i.push(h))}const s=[];r.sort(((e,n)=>$9(e[1],n[1],t)));for(const[l,h]of r){const e=z9((a=h.range).start,a.end);if(e===l)continue;const t=this.getByKey(o,e);this.removeByKey(o,l),void 0!==t&&h!=t?s.push([t,h]):this.setRange(h)}var a;return{verticesToRemove:n,verticesToMerge:s,verticesWithChangedSize:i}}moveAllRangesInSheetAfterRowByRows(e,t,n){return this.updateVerticesFromSheet(e,((e,r)=>t<=r.start.row?(r.range.shiftByRows(n),{changedSize:!1,vertex:r}):t>r.start.row&&t<=r.end.row?(r.range.expandByRows(n),{changedSize:!0,vertex:r}):void 0))}moveAllRangesInSheetAfterColumnByColumns(e,t,n){return this.updateVerticesFromSheet(e,((e,r)=>t<=r.start.col?(r.range.shiftByColumns(n),{changedSize:!1,vertex:r}):t>r.start.col&&t<=r.end.col?(r.range.expandByColumns(n),{changedSize:!0,vertex:r}):void 0))}moveRangesInsideSourceRange(e,t,n,r){this.updateVerticesFromSheet(e.sheet,((i,o)=>e.containsRange(o.range)?(o.range.shiftByColumns(t),o.range.shiftByRows(n),o.range.moveToSheet(r),{changedSize:!1,vertex:o}):void 0))}removeRangesInSheet(e){if(this.rangeMapping.has(e)){const t=this.rangeMapping.get(e).values();return this.rangeMapping.delete(e),t}return[][Symbol.iterator]()}*rangesInSheet(e){const t=this.rangeMapping.get(e);t&&(yield*t.values())}*rangeVerticesContainedInRange(e){for(const t of this.rangesInSheet(e.sheet))e.containsRange(t.range)&&(yield t)}findSmallerRange(e){if(e.height()>1&&Number.isFinite(e.height())){const t=v4(e.end.sheet,e.end.col,e.end.row-1),n=this.getRange(e.start,t);if(void 0!==n){return{smallerRangeVertex:n,restRange:M4.fromSimpleCellAddresses(v4(e.start.sheet,e.start.col,e.end.row),e.end)}}}return{restRange:e}}*entriesFromSheet(e){const t=this.rangeMapping.get(e);t&&(yield*t.entries())}removeByKey(e,t){this.rangeMapping.get(e).delete(t)}getByKey(e,t){var n;return null===(n=this.rangeMapping.get(e))||void 0===n?void 0:n.get(t)}updateVerticesFromSheet(e,t){const n=Array();for(const[r,i]of this.entriesFromSheet(e)){const o=t(r,i);void 0!==o&&(this.removeByKey(e,r),n.push(o))}return n.forEach((e=>{this.setRange(e.vertex)})),{verticesWithChangedSize:n.filter((e=>e.changedSize)).map((e=>e.vertex))}}}function z9(e,t){return`${e.col},${e.row},${t.col},${t.row}`}const $9=(e,t,n)=>{const r=n(e.range.start),i=n(e.range.start);if(r===i){return n(e.range.end)-n(t.range.end)}return r-i};
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class Y9{constructor(e,t,n){this.functions=e,this.errors=t,this.ui=n,this._protectedTranslations={VERSION:"VERSION"},this.checkUI(),this.checkErrors(),this.checkFunctionTranslations(this.functions),Object.assign(this.functions,this._protectedTranslations)}extendFunctions(e){this.checkFunctionTranslations(e),Object.assign(this.functions,e)}buildFunctionMapping(){return Object.keys(this.functions).reduce(((e,t)=>(e[this.functions[t]]=t,e)),{})}buildErrorMapping(){return Object.keys(this.errors).reduce(((e,t)=>(e[this.errors[t]]=t,e)),{})}isFunctionTranslated(e){return void 0!==this.functions[e]}getFunctionTranslations(e){const t=[];for(const n of e)this.isFunctionTranslated(n)&&t.push(this.functions[n]);return t}getFunctionTranslation(e){const t=this.functions[e];if(void 0===t)throw new C9(`functions.${e}`);return t}getMaybeFunctionTranslation(e){return this.functions[e]}getErrorTranslation(e){if(e===X9.LIC)return`#${X9.LIC}!`;const t=this.errors[e];if(void 0===t)throw new C9(`errors.${e}`);return t}getUITranslation(e){const t=this.ui[e];if(void 0===t)throw new C9(`ui.${e}`);return t}checkUI(){for(const e of Object.values(K9))if(!(e in this.ui))throw new C9(`ui.${e}`)}checkErrors(){for(const e of Object.values(X9))if(!(e in this.errors)&&e!==X9.LIC)throw new C9(`errors.${e}`)}checkFunctionTranslations(e){const t=new Set(Object.getOwnPropertyNames(e));for(const n of Object.getOwnPropertyNames(this._protectedTranslations))if(t.has(n))throw new S9(n)}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
var K9,X9,q9;
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
function Q9(e){return e.toLowerCase()}!function(e){e.NEW_SHEET_PREFIX="NEW_SHEET_PREFIX"}(K9||(K9={}));class Z9{constructor(e,t){this.id=e,this.displayName=t}get canonicalName(){return Q9(this.displayName)}}class J9{constructor(e){this.languages=e,this.mappingFromCanonicalName=new Map,this.mappingFromId=new Map,this.lastSheetId=-1,this.fetch=e=>{const t=this.mappingFromCanonicalName.get(Q9(e));if(void 0===t)throw new J3(e);return t.id},this.get=e=>{var t;return null===(t=this.mappingFromCanonicalName.get(Q9(e)))||void 0===t?void 0:t.id},this.fetchDisplayName=e=>this.fetchSheetById(e).displayName,this.sheetNamePrefix=e.getUITranslation(K9.NEW_SHEET_PREFIX)}addSheet(e=`${this.sheetNamePrefix}${this.lastSheetId+2}`){const t=Q9(e);if(this.mappingFromCanonicalName.has(t))throw new e9(e);this.lastSheetId++;const n=new Z9(this.lastSheetId,e);return this.store(n),n.id}removeSheet(e){const t=this.fetchSheetById(e);e==this.lastSheetId&&--this.lastSheetId,this.mappingFromCanonicalName.delete(t.canonicalName),this.mappingFromId.delete(t.id)}getDisplayName(e){var t;return null===(t=this.mappingFromId.get(e))||void 0===t?void 0:t.displayName}*displayNames(){for(const e of this.mappingFromCanonicalName.values())yield e.displayName}numberOfSheets(){return this.mappingFromCanonicalName.size}hasSheetWithId(e){return this.mappingFromId.has(e)}hasSheetWithName(e){return this.mappingFromCanonicalName.has(Q9(e))}renameSheet(e,t){const n=this.fetchSheetById(e),r=n.displayName;if(r===t)return;const i=this.mappingFromCanonicalName.get(Q9(t));if(void 0!==i&&i.id!==n.id)throw new e9(t);const o=n.canonicalName;return this.mappingFromCanonicalName.delete(o),n.displayName=t,this.store(n),r}sheetNames(){return Array.from(this.mappingFromId.values()).map((e=>e.displayName))}store(e){this.mappingFromId.set(e.id,e),this.mappingFromCanonicalName.set(e.canonicalName,e)}fetchSheetById(e){const t=this.mappingFromId.get(e);if(void 0===t)throw new Z3(e);return t}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class e4{constructor(e,t,n,r,i,o,s,a){this.addressMapping=e,this.rangeMapping=t,this.sheetMapping=n,this.arrayMapping=r,this.stats=i,this.lazilyTransformingAstService=o,this.functionRegistry=s,this.namedExpressions=a,this.changes=Y3.empty(),this.dependencyQueryAddresses=e=>{if(e instanceof D9)return this.rangeDependencyQuery(e).map((([e,t])=>e));{const t=this.formulaDependencyQuery(e);if(void 0!==t){const[e,n]=t;return n.map((t=>t instanceof x3?this.namedExpressions.namedExpressionOrPlaceholder(t.name,e.sheet).address:E4(t)?t:A4(t.start,t.end)))}return[]}},this.dependencyQueryVertices=e=>{if(e instanceof D9)return this.rangeDependencyQuery(e);{const t=this.formulaDependencyQuery(e);if(void 0!==t){const[e,n]=t;return n.map((t=>{if(t instanceof M4)return[t.start,this.rangeMapping.fetchRange(t.start,t.end)];if(t instanceof x3){const n=this.namedExpressions.namedExpressionOrPlaceholder(t.name,e.sheet);return[n.address,this.addressMapping.fetchCell(n.address)]}return[t,this.addressMapping.fetchCell(t)]}))}return[]}},this.rangeDependencyQuery=e=>{const t=[],{smallerRangeVertex:n,restRange:r}=this.rangeMapping.findSmallerRange(e.range);let i;void 0!==n&&this.graph.adjacentNodes(n).has(e)?(i=r,t.push([new M4(n.start,n.end),n])):i=e.range;for(const o of i.addresses(this)){const e=this.addressMapping.getCell(o);void 0!==e&&t.push([o,e])}return t},this.formulaDependencyQuery=e=>{let t,n;if(!(e instanceof H9))return;n=e.getAddress(this.lazilyTransformingAstService),t=e.getFormula(this.lazilyTransformingAstService);const r=N3(t,this.functionRegistry);return[n,P3(r,n)]},this.graph=new j9(this.dependencyQueryVertices)}static buildEmpty(e,t,n,r,i){return new e4(new O9(t.chooseAddressMappingPolicy),new G9,new J9(t.translationPackage),new x9,i,e,n,r)}setFormulaToCell(e,t,n,r,i,o){const s=H9.fromAst(t,e,r,this.lazilyTransformingAstService.version());return this.exchangeOrAddFormulaVertex(s),this.processCellDependencies(n,s),this.graph.markNodeAsDirty(s),i&&this.markAsVolatile(s),o&&this.markAsDependentOnStructureChange(s),this.correctInfiniteRangesDependency(e),this.getAndClearContentChanges()}setParsingErrorToCell(e,t){const n=this.shrinkPossibleArrayAndGetCell(e);return this.exchangeOrAddGraphNode(n,t),this.addressMapping.setCell(e,t),this.graph.markNodeAsDirty(t),this.correctInfiniteRangesDependency(e),this.getAndClearContentChanges()}setValueToCell(e,t){const n=this.shrinkPossibleArrayAndGetCell(e);if(n instanceof k9&&this.arrayMapping.removeArray(n.getRange()),n instanceof n4){n.getValues().rawValue!==t.rawValue&&(n.setValues(t),this.graph.markNodeAsDirty(n))}else{const r=new n4(t.parsedValue,t.rawValue);this.exchangeOrAddGraphNode(n,r),this.addressMapping.setCell(e,r),this.graph.markNodeAsDirty(r)}return this.correctInfiniteRangesDependency(e),this.getAndClearContentChanges()}setCellEmpty(e){const t=this.shrinkPossibleArrayAndGetCell(e);if(void 0===t)return Y3.empty();if(this.graph.adjacentNodes(t).size>0){const n=new t4;this.exchangeGraphNode(t,n),0===this.graph.adjacentNodesCount(n)?(this.removeVertex(n),this.addressMapping.removeCell(e)):(this.graph.markNodeAsDirty(n),this.addressMapping.setCell(e,n))}else this.removeVertex(t),this.addressMapping.removeCell(e);return this.getAndClearContentChanges()}clearDirtyVertices(){this.graph.clearDirtyNodes()}verticesToRecompute(){return this.graph.getDirtyAndVolatileNodes()}processCellDependencies(e,t){const n=this.graph.getNodeId(t);e.forEach((e=>{if(e instanceof M4){const t=e;let r=this.getRange(t.start,t.end);void 0===r&&(r=new D9(t),this.rangeMapping.setRange(r)),this.graph.addNodeAndReturnId(r);const i=this.graph.getNodeId(r);t.isFinite()||this.graph.markNodeAsInfiniteRange(i);const{smallerRangeVertex:o,restRange:s}=this.rangeMapping.findSmallerRange(t);if(void 0!==o){if(this.graph.addEdge(o,i),r.bruteForce){r.bruteForce=!1;for(const e of t.addresses(this))this.graph.removeEdge(this.fetchCell(e),i)}}else r.bruteForce=!0;const a=this.arrayMapping.getArray(s);if(void 0!==a)this.graph.addEdge(a,i);else for(const e of s.addresses(this)){const{vertex:t,id:n}=this.fetchCellOrCreateEmpty(e);this.graph.addEdge(null!=n?n:t,i)}this.graph.addEdge(i,n),t.isFinite()&&this.correctInfiniteRangesDependenciesByRangeVertex(r)}else if(e instanceof x3){const r=t.getAddress(this.lazilyTransformingAstService).sheet,{vertex:i,id:o}=this.fetchNamedExpressionVertex(e.name,r);this.graph.addEdge(null!=o?o:i,n)}else{const{vertex:t,id:r}=this.fetchCellOrCreateEmpty(e);this.graph.addEdge(null!=r?r:t,n)}}))}fetchNamedExpressionVertex(e,t){const n=this.namedExpressions.namedExpressionOrPlaceholder(e,t);return this.fetchCellOrCreateEmpty(n.address)}exchangeNode(e,t){const n=this.fetchCellOrCreateEmpty(e).vertex,r=this.fetchCellOrCreateEmpty(t).vertex;this.addressMapping.removeCell(e),this.exchangeGraphNode(n,r)}fetchCellOrCreateEmpty(e){const t=this.addressMapping.getCell(e);if(void 0!==t)return{vertex:t,id:void 0};const n=new t4,r=this.graph.addNodeAndReturnId(n);return this.addressMapping.setCell(e,n),{vertex:n,id:r}}removeRows(e){this.stats.measure(G3.ADJUSTING_GRAPH,(()=>{for(const[t,n]of this.addressMapping.entriesFromRowsSpan(e)){for(const e of this.graph.adjacentNodes(n))this.graph.markNodeAsDirty(e);if(n instanceof k9){if(!n.isLeftCorner(t))continue;this.shrinkArrayToCorner(n),this.arrayMapping.removeArray(n.getRange())}this.removeVertex(n)}})),this.stats.measure(G3.ADJUSTING_ADDRESS_MAPPING,(()=>{this.addressMapping.removeRows(e)}));const t=this.stats.measure(G3.ADJUSTING_RANGES,(()=>{const t=this.truncateRanges(e,(e=>e.row));return this.getArrayVerticesRelatedToRanges(t)}));return this.stats.measure(G3.ADJUSTING_ARRAY_MAPPING,(()=>{this.fixArraysAfterRemovingRows(e.sheet,e.rowStart,e.numberOfRows)})),this.addStructuralNodesToChangeSet(),{affectedArrays:t,contentChanges:this.getAndClearContentChanges()}}removeSheet(e){this.clearSheet(e);for(const[t,n]of this.addressMapping.sheetEntries(e)){for(const e of this.graph.adjacentNodes(n))this.graph.markNodeAsDirty(e);this.removeVertex(n),this.addressMapping.removeCell(t)}this.stats.measure(G3.ADJUSTING_RANGES,(()=>{const t=this.rangeMapping.removeRangesInSheet(e);for(const e of t)this.removeVertex(e);this.stats.measure(G3.ADJUSTING_ADDRESS_MAPPING,(()=>{this.addressMapping.removeSheet(e)}))}))}clearSheet(e){const t=new Set;for(const[n,r]of this.addressMapping.sheetEntries(e))r instanceof k9?t.add(r):this.setCellEmpty(n);for(const n of t.values())this.setArrayEmpty(n);this.addStructuralNodesToChangeSet()}removeColumns(e){this.stats.measure(G3.ADJUSTING_GRAPH,(()=>{for(const[t,n]of this.addressMapping.entriesFromColumnsSpan(e)){for(const e of this.graph.adjacentNodes(n))this.graph.markNodeAsDirty(e);if(n instanceof k9){if(!n.isLeftCorner(t))continue;this.shrinkArrayToCorner(n),this.arrayMapping.removeArray(n.getRange())}this.removeVertex(n)}})),this.stats.measure(G3.ADJUSTING_ADDRESS_MAPPING,(()=>{this.addressMapping.removeColumns(e)}));const t=this.stats.measure(G3.ADJUSTING_RANGES,(()=>{const t=this.truncateRanges(e,(e=>e.col));return this.getArrayVerticesRelatedToRanges(t)}));return this.stats.measure(G3.ADJUSTING_ARRAY_MAPPING,(()=>this.fixArraysAfterRemovingColumns(e.sheet,e.columnStart,e.numberOfColumns))),this.addStructuralNodesToChangeSet(),{affectedArrays:t,contentChanges:this.getAndClearContentChanges()}}addRows(e){this.stats.measure(G3.ADJUSTING_ADDRESS_MAPPING,(()=>{this.addressMapping.addRows(e.sheet,e.rowStart,e.numberOfRows)}));const t=this.stats.measure(G3.ADJUSTING_RANGES,(()=>{const t=this.rangeMapping.moveAllRangesInSheetAfterRowByRows(e.sheet,e.rowStart,e.numberOfRows);return this.fixRangesWhenAddingRows(e.sheet,e.rowStart,e.numberOfRows),this.getArrayVerticesRelatedToRanges(t.verticesWithChangedSize)}));this.stats.measure(G3.ADJUSTING_ARRAY_MAPPING,(()=>{this.fixArraysAfterAddingRow(e.sheet,e.rowStart,e.numberOfRows)}));for(const n of this.addressMapping.verticesFromRowsSpan(e))this.graph.markNodeAsDirty(n);return this.addStructuralNodesToChangeSet(),{affectedArrays:t}}addColumns(e){this.stats.measure(G3.ADJUSTING_ADDRESS_MAPPING,(()=>{this.addressMapping.addColumns(e.sheet,e.columnStart,e.numberOfColumns)}));const t=this.stats.measure(G3.ADJUSTING_RANGES,(()=>{const t=this.rangeMapping.moveAllRangesInSheetAfterColumnByColumns(e.sheet,e.columnStart,e.numberOfColumns);return this.fixRangesWhenAddingColumns(e.sheet,e.columnStart,e.numberOfColumns),this.getArrayVerticesRelatedToRanges(t.verticesWithChangedSize)}));this.stats.measure(G3.ADJUSTING_ARRAY_MAPPING,(()=>this.fixArraysAfterAddingColumn(e.sheet,e.columnStart,e.numberOfColumns)));for(const n of this.addressMapping.verticesFromColumnsSpan(e))this.graph.markNodeAsDirty(n);return this.addStructuralNodesToChangeSet(),{affectedArrays:t,contentChanges:this.getAndClearContentChanges()}}isThereSpaceForArray(e){const t=e.getRangeOrUndef();if(void 0===t)return!1;for(const n of t.addresses(this)){const t=this.addressMapping.getCell(n);if(void 0!==t&&!(t instanceof t4)&&t!==e)return!1}return!0}moveCells(e,t,n,r){for(const i of e.addressesWithDirection(t,n,this)){const o=v4(r,i.col+t,i.row+n);let s=this.addressMapping.getCell(i);const a=this.addressMapping.getCell(o);if(this.addressMapping.removeCell(i),void 0!==s){let t;this.graph.markNodeAsDirty(s),this.addressMapping.setCell(o,s);for(const n of this.graph.adjacentNodes(s))n instanceof D9&&!e.containsRange(n.range)&&(t=null!=t?t:this.fetchCellOrCreateEmpty(i).vertex,this.graph.addEdge(t,n),this.graph.removeEdge(s,n));t&&(this.graph.markNodeAsDirty(t),this.addressMapping.setCell(i,t))}if(void 0!==a){void 0===s&&this.addressMapping.removeCell(o);for(const e of this.graph.adjacentNodes(a))s=null!=s?s:this.fetchCellOrCreateEmpty(o).vertex,this.graph.addEdge(s,e),this.graph.markNodeAsDirty(s);this.removeVertex(a)}}for(const i of this.rangeMapping.rangeVerticesContainedInRange(e))for(const t of this.graph.adjacentNodes(i))if(t instanceof D9&&!e.containsRange(t.range)){this.graph.removeEdge(i,t);for(const e of i.range.addresses(this)){const{vertex:n,id:r}=this.fetchCellOrCreateEmpty(e);this.graph.addEdge(null!=r?r:n,t),this.addressMapping.setCell(e,n),this.graph.markNodeAsDirty(n)}}this.rangeMapping.moveRangesInsideSourceRange(e,t,n,r)}setArrayEmpty(e){const t=M4.spanFrom(e.getAddress(this.lazilyTransformingAstService),e.width,e.height),n=this.graph.adjacentNodes(e);for(const r of t.addresses(this))this.addressMapping.removeCell(r);for(const r of n.values()){const t=V9(this.functionRegistry,r,e.getRange(),this.lazilyTransformingAstService,this);for(const e of t){const{vertex:t,id:n}=this.fetchCellOrCreateEmpty(e);this.graph.addEdge(null!=n?n:t,r)}t.length>0&&this.graph.markNodeAsDirty(r)}this.removeVertex(e),this.arrayMapping.removeArray(e.getRange())}addVertex(e,t){this.graph.addNodeAndReturnId(t),this.addressMapping.setCell(e,t)}addArrayVertex(e,t){this.graph.addNodeAndReturnId(t),this.setAddressMappingForArrayVertex(t,e)}*arrayFormulaNodes(){for(const e of this.graph.getNodes())e instanceof k9&&(yield e)}*entriesFromRowsSpan(e){yield*this.addressMapping.entriesFromRowsSpan(e)}*entriesFromColumnsSpan(e){yield*this.addressMapping.entriesFromColumnsSpan(e)}fetchCell(e){return this.addressMapping.fetchCell(e)}getCell(e){return this.addressMapping.getCell(e)}getCellValue(e){return this.addressMapping.getCellValue(e)}getRawValue(e){return this.addressMapping.getRawValue(e)}getScalarValue(e){const t=this.addressMapping.getCellValue(e);return t instanceof $3?new g4(X9.VALUE,W2.ScalarExpected):t}existsEdge(e,t){return this.graph.existsEdge(e,t)}getSheetId(e){return this.sheetMapping.fetch(e)}getSheetHeight(e){return this.addressMapping.getHeight(e)}getSheetWidth(e){return this.addressMapping.getWidth(e)}getArray(e){return this.arrayMapping.getArray(e)}getRange(e,t){return this.rangeMapping.getRange(e,t)}topSortWithScc(){return this.graph.topSortWithScc()}markAsVolatile(e){this.graph.markNodeAsVolatile(e)}markAsDependentOnStructureChange(e){this.graph.markNodeAsChangingWithStructure(e)}forceApplyPostponedTransformations(){for(const e of this.graph.getNodes())e instanceof F9&&e.ensureRecentData(this.lazilyTransformingAstService)}*rawValuesFromRange(e){for(const t of e.addresses(this)){const e=this.getScalarValue(t);e!==_3&&(yield[L3(e),t])}}computeListOfValuesInRange(e){const t=[];for(const n of e.addresses(this)){const e=this.getScalarValue(n);t.push(e)}return t}shrinkArrayToCorner(e){this.cleanAddressMappingUnderArray(e);for(const t of this.adjacentArrayVertices(e)){let n;n=t instanceof H9?this.formulaDirectDependenciesToArray(t,e):this.rangeDirectDependenciesToArray(t,e);let r=!1;for(const[i,o]of n)e.isLeftCorner(i)&&(r=!0),this.graph.addEdge(o,t),this.graph.markNodeAsDirty(o);r||this.graph.removeEdge(e,t)}this.graph.markNodeAsDirty(e)}isArrayInternalCell(e){const t=this.getCell(e);return t instanceof k9&&!t.isLeftCorner(e)}getAndClearContentChanges(){const e=this.changes;return this.changes=Y3.empty(),e}getAdjacentNodesAddresses(e){const t=this.graph.adjacentNodes(e),n=[];return t.forEach((e=>{const t=e;t instanceof D9?n.push(A4(t.start,t.end)):n.push(t.getAddress(this.lazilyTransformingAstService))})),n}exchangeGraphNode(e,t){this.graph.addNodeAndReturnId(t);const n=this.graph.adjacentNodes(e);this.removeVertex(e),n.forEach((e=>{this.graph.hasNode(e)&&this.graph.addEdge(t,e)}))}setArray(e,t){this.arrayMapping.setArray(e,t)}correctInfiniteRangesDependency(e){const t=this.graph.getInfiniteRanges().filter((({node:t})=>t.range.addressInRange(e)));if(t.length<=0)return;const{vertex:n,id:r}=this.fetchCellOrCreateEmpty(e),i=null!=r?r:this.graph.getNodeId(n);t.forEach((({id:e})=>{this.graph.addEdge(i,e)}))}exchangeOrAddGraphNode(e,t){e?this.exchangeGraphNode(e,t):this.graph.addNodeAndReturnId(t)}getArrayVerticesRelatedToRanges(e){const t=new Set;return e.forEach((e=>{this.graph.hasNode(e)&&this.graph.adjacentNodes(e).forEach((e=>{e instanceof k9&&t.add(e)}))})),t}correctInfiniteRangesDependenciesByRangeVertex(e){this.graph.getInfiniteRanges().forEach((({id:t,node:n})=>{const r=e.range.intersectionWith(n.range);void 0!==r&&r.addresses(this).forEach((e=>{const{vertex:n,id:r}=this.fetchCellOrCreateEmpty(e);this.graph.addEdge(null!=r?r:n,t)}))}))}cleanAddressMappingUnderArray(e){const t=e.getRange();for(const n of t.addresses(this)){const t=e.getArrayCellValue(n);this.getCell(n)===e?e.isLeftCorner(n)?this.changes.addChange(new g4(X9.REF),n,t):(this.addressMapping.removeCell(n),this.changes.addChange(_3,n,t)):this.changes.addChange(_3,n,t)}}*formulaDirectDependenciesToArray(e,t){var n;const[,r]=null!==(n=this.formulaDependencyQuery(e))&&void 0!==n?n:[];if(void 0!==r)for(const i of r)if(!(i instanceof x3||i instanceof M4)&&t.getRange().addressInRange(i)){const e=this.fetchCellOrCreateEmpty(i).vertex;yield[i,e]}}*rangeDirectDependenciesToArray(e,t){const{restRange:n}=this.rangeMapping.findSmallerRange(e.range);for(const r of n.addresses(this))if(t.getRange().addressInRange(r)){const e=this.fetchCellOrCreateEmpty(r).vertex;yield[r,e]}}*adjacentArrayVertices(e){const t=this.graph.adjacentNodes(e);for(const n of t)(n instanceof H9||n instanceof D9)&&(yield n)}addStructuralNodesToChangeSet(){this.graph.markChangingWithStructureNodesAsDirty()}fixRangesWhenAddingRows(e,t,n){const r=Array.from(this.rangeMapping.rangesInSheet(e));for(const i of r)if(i.range.includesRow(t+n))if(i.bruteForce){const e=i.range.rangeWithSameWidth(t,n);for(const t of e.addresses(this)){const{vertex:e,id:n}=this.fetchCellOrCreateEmpty(t);this.graph.addEdge(null!=n?n:e,i)}}else{let e=i,t=this.rangeMapping.findSmallerRange(e.range);if(void 0!==t.smallerRangeVertex)continue;for(;void 0===t.smallerRangeVertex;){const n=new D9(M4.spanFrom(e.range.start,e.range.width(),e.range.height()-1));this.rangeMapping.setRange(n),this.graph.addNodeAndReturnId(n);const r=new M4(v4(e.range.start.sheet,e.range.start.col,e.range.end.row),e.range.end);this.addAllFromRange(r,e),this.graph.addEdge(n,e),e=n,t=this.rangeMapping.findSmallerRange(e.range)}this.graph.addEdge(t.smallerRangeVertex,e),this.addAllFromRange(t.restRange,e),this.graph.removeEdge(t.smallerRangeVertex,i)}}addAllFromRange(e,t){for(const n of e.addresses(this)){const{vertex:e,id:r}=this.fetchCellOrCreateEmpty(n);this.graph.addEdge(null!=r?r:e,t)}}fixRangesWhenAddingColumns(e,t,n){for(const r of this.rangeMapping.rangesInSheet(e))if(r.range.includesColumn(t+n)){let i;i=r.bruteForce?r.range.rangeWithSameHeight(t,n):M4.spanFrom(v4(e,t,r.range.end.row),n,1);for(const e of i.addresses(this)){const{vertex:t,id:n}=this.fetchCellOrCreateEmpty(e);this.graph.addEdge(null!=n?n:t,r)}}}exchangeOrAddFormulaVertex(e){const t=e.getAddress(this.lazilyTransformingAstService),n=M4.spanFrom(t,e.width,e.height),r=this.shrinkPossibleArrayAndGetCell(t);if(e instanceof k9&&this.setArray(n,e),this.exchangeOrAddGraphNode(r,e),this.addressMapping.setCell(t,e),e instanceof k9){if(!this.isThereSpaceForArray(e))return;for(const t of n.addresses(this)){if(e.isLeftCorner(t))continue;const n=this.getCell(t);this.exchangeOrAddGraphNode(n,e)}}for(const i of n.addresses(this))this.addressMapping.setCell(i,e)}setAddressMappingForArrayVertex(e,t){if(this.addressMapping.setCell(t,e),!(e instanceof k9))return;const n=M4.spanFromOrUndef(t,e.width,e.height);if(void 0!==n&&(this.setArray(n,e),this.isThereSpaceForArray(e)))for(const r of n.addresses(this))this.addressMapping.setCell(r,e)}truncateRanges(e,t){const{verticesToRemove:n,verticesToMerge:r,verticesWithChangedSize:i}=this.rangeMapping.truncateRanges(e,t);for(const[o,s]of r)this.mergeRangeVertices(o,s);for(const o of n)this.removeVertexAndCleanupDependencies(o);return i}fixArraysAfterAddingRow(e,t,n){if(this.arrayMapping.moveArrayVerticesAfterRowByRows(e,t,n),!(t<=0))for(const[,r]of this.arrayMapping.arraysInRows(K3.fromRowStartAndEnd(e,t-1,t-1))){const i=r.getRange();for(let o=i.start.col;o<=i.end.col;++o)for(let s=t;s<=i.end.row;++s){const t=v4(e,o,s),i=v4(e,o,s+n),a=r.getArrayCellValue(t);this.addressMapping.moveCell(i,t),this.changes.addChange(_3,i,a)}}}fixArraysAfterRemovingRows(e,t,n){if(this.arrayMapping.moveArrayVerticesAfterRowByRows(e,t,-n),!(t<=0))for(const[,r]of this.arrayMapping.arraysInRows(K3.fromRowStartAndEnd(e,t-1,t-1)))if(this.isThereSpaceForArray(r))for(const e of r.getRange().addresses(this))this.addressMapping.setCell(e,r);else this.setNoSpaceIfArray(r)}fixArraysAfterAddingColumn(e,t,n){if(this.arrayMapping.moveArrayVerticesAfterColumnByColumns(e,t,n),!(t<=0))for(const[,r]of this.arrayMapping.arraysInCols(X3.fromColumnStartAndEnd(e,t-1,t-1))){const i=r.getRange();for(let o=i.start.row;o<=i.end.row;++o)for(let s=t;s<=i.end.col;++s){const t=v4(e,s,o),i=v4(e,s+n,o),a=r.getArrayCellValue(t);this.addressMapping.moveCell(i,t),this.changes.addChange(_3,i,a)}}}fixArraysAfterRemovingColumns(e,t,n){if(this.arrayMapping.moveArrayVerticesAfterColumnByColumns(e,t,-n),!(t<=0))for(const[,r]of this.arrayMapping.arraysInCols(X3.fromColumnStartAndEnd(e,t-1,t-1)))if(this.isThereSpaceForArray(r))for(const e of r.getRange().addresses(this))this.addressMapping.setCell(e,r);else this.setNoSpaceIfArray(r)}shrinkPossibleArrayAndGetCell(e){const t=this.getCell(e);return t instanceof k9?(this.setNoSpaceIfArray(t),this.getCell(e)):t}setNoSpaceIfArray(e){e instanceof k9&&(this.shrinkArrayToCorner(e),e.setNoSpace())}removeVertex(e){this.removeVertexAndCleanupDependencies(e),e instanceof D9&&this.rangeMapping.removeRange(e)}mergeRangeVertices(e,t){const n=this.graph.adjacentNodes(t);this.removeVertexAndCleanupDependencies(t),this.graph.removeEdgeIfExists(e,t),n.forEach((t=>{this.graph.hasNode(t)&&this.graph.addEdge(e,t)}))}removeVertexAndCleanupDependencies(e){const t=new Set(this.graph.removeNode(e));for(;t.size>0;){const e=t.values().next().value;t.delete(e);const[n,r]=e;this.graph.hasNode(r)&&0===this.graph.adjacentNodesCount(r)&&((r instanceof D9||r instanceof t4)&&this.graph.removeNode(r).forEach((e=>t.add(e))),r instanceof D9?this.rangeMapping.removeRange(r):r instanceof t4&&this.addressMapping.removeCell(n))}}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class t4{constructor(){}getCellValue(){return _3}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class n4{constructor(e,t){this.parsedValue=e,this.rawValue=t}getValues(){return{parsedValue:this.parsedValue,rawValue:this.rawValue}}setValues(e){this.parsedValue=e.parsedValue,this.rawValue=e.rawValue}getCellValue(){return this.parsedValue}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class r4{constructor(e,t){this.errors=e,this.rawInput=t}getCellValue(){const e=this.errors.map((e=>e.message)).find((e=>e));return g4.parsingError(e)}getFormula(){return this.rawInput}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class i4{constructor(e,t){this.width=e,this.height=t,this.mapping=new Map}getCell(e){var t;return null===(t=this.mapping.get(e.col))||void 0===t?void 0:t.get(e.row)}setCell(e,t){this.width=Math.max(this.width,e.col+1),this.height=Math.max(this.height,e.row+1);let n=this.mapping.get(e.col);n||(n=new Map,this.mapping.set(e.col,n)),n.set(e.row,t)}has(e){var t;return!!(null===(t=this.mapping.get(e.col))||void 0===t?void 0:t.get(e.row))}getHeight(){return this.height}getWidth(){return this.width}removeCell(e){var t;null===(t=this.mapping.get(e.col))||void 0===t||t.delete(e.row)}addRows(e,t){this.mapping.forEach((n=>{const r=new Map;n.forEach(((i,o)=>{o>=e&&(r.set(o+t,i),n.delete(o))})),r.forEach(((e,t)=>{n.set(t,e)}))})),this.height+=t}addColumns(e,t){const n=new Map;this.mapping.forEach(((r,i)=>{i>=e&&(n.set(i+t,r),this.mapping.delete(i))})),n.forEach(((e,t)=>{this.mapping.set(t,e)})),this.width+=t}removeRows(e){this.mapping.forEach((t=>{const n=new Map;t.forEach(((r,i)=>{i>=e.rowStart&&(t.delete(i),i>e.rowEnd&&n.set(i-e.numberOfRows,r))})),n.forEach(((e,n)=>{t.set(n,e)}))}));const t=Math.min(this.height-1,e.rowEnd),n=Math.max(0,t-e.rowStart+1);this.height=Math.max(0,this.height-n)}removeColumns(e){const t=new Map;this.mapping.forEach(((n,r)=>{r>=e.columnStart&&(this.mapping.delete(r),r>e.columnEnd&&t.set(r-e.numberOfColumns,n))})),t.forEach(((e,t)=>{this.mapping.set(t,e)}));const n=Math.min(this.width-1,e.columnEnd),r=Math.max(0,n-e.columnStart+1);this.width=Math.max(0,this.width-r)}*getEntries(e){for(const[t,n]of this.mapping)for(const[r,i]of n)yield[v4(e,t,r),i]}*verticesFromColumn(e){const t=this.mapping.get(e);if(void 0!==t)for(const[n,r]of t)yield r}*verticesFromRow(e){for(const t of this.mapping.values()){const n=t.get(e);void 0!==n&&(yield n)}}*verticesFromColumnsSpan(e){for(const t of e.columns()){const e=this.mapping.get(t);if(void 0!==e)for(const[t,n]of e)yield n}}*verticesFromRowsSpan(e){for(const t of this.mapping.values())for(const n of e.rows()){const e=t.get(n);void 0!==e&&(yield e)}}*entriesFromRowsSpan(e){for(const[t,n]of this.mapping.entries())for(const r of e.rows()){const i=n.get(r);void 0!==i&&(yield[v4(e.sheet,t,r),i])}}*entriesFromColumnsSpan(e){for(const t of e.columns()){const n=this.mapping.get(t);if(void 0!==n)for(const[r,i]of n.entries())yield[v4(e.sheet,t,r),i]}}*vertices(){for(const[e,t]of this.mapping)for(const[n,r]of t)void 0!==r&&(yield r)}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class o4{constructor(e,t){this.width=e,this.height=t,this.mapping=new Array(t);for(let n=0;n<t;n++)this.mapping[n]=new Array(e)}getCell(e){return this.getCellVertex(e.col,e.row)}setCell(e,t){this.width=Math.max(this.width,e.col+1),this.height=Math.max(this.height,e.row+1);this.mapping[e.row]||(this.mapping[e.row]=new Array(this.width)),this.mapping[e.row][e.col]=t}has(e){const t=this.mapping[e.row];return!!t&&!!t[e.col]}getHeight(){return this.height}getWidth(){return this.width}removeCell(e){void 0!==this.mapping[e.row]&&delete this.mapping[e.row][e.col]}addRows(e,t){const n=[];for(let r=0;r<t;r++)n.push(new Array(this.width));this.mapping.splice(e,0,...n),this.height+=t}addColumns(e,t){for(let n=0;n<this.height;n++)void 0!==this.mapping[n]&&this.mapping[n].splice(e,0,...new Array(t));this.width+=t}removeRows(e){this.mapping.splice(e.rowStart,e.numberOfRows);const t=Math.min(this.height-1,e.rowEnd),n=Math.max(0,t-e.rowStart+1);this.height=Math.max(0,this.height-n)}removeColumns(e){for(let r=0;r<this.height;r++)void 0!==this.mapping[r]&&this.mapping[r].splice(e.columnStart,e.numberOfColumns);const t=Math.min(this.width-1,e.columnEnd),n=Math.max(0,t-e.columnStart+1);this.width=Math.max(0,this.width-n)}*getEntries(e){for(let t=0;t<this.height;++t)for(let n=0;n<this.width;++n){const r=this.getCellVertex(n,t);r&&(yield[v4(e,n,t),r])}}*verticesFromColumn(e){for(let t=0;t<this.height;++t){const n=this.getCellVertex(e,t);n&&(yield n)}}*verticesFromRow(e){for(let t=0;t<this.width;++t){const n=this.getCellVertex(t,e);n&&(yield n)}}*verticesFromColumnsSpan(e){for(let t=e.columnStart;t<=e.columnEnd;++t)for(let e=0;e<this.height;++e){const n=this.getCellVertex(t,e);n&&(yield n)}}*verticesFromRowsSpan(e){for(let t=0;t<this.width;++t)for(let n=e.rowStart;n<=e.rowEnd;++n){const e=this.getCellVertex(t,n);e&&(yield e)}}*entriesFromRowsSpan(e){for(let t=0;t<this.width;++t)for(let n=e.rowStart;n<=e.rowEnd;++n){const r=this.getCellVertex(t,n);r&&(yield[v4(e.sheet,t,n),r])}}*entriesFromColumnsSpan(e){for(let t=e.columnStart;t<=e.columnEnd;++t)for(let n=0;n<this.height;++n){const r=this.getCellVertex(t,n);r&&(yield[v4(e.sheet,t,n),r])}}*vertices(){for(let e=0;e<this.height;++e)for(let t=0;t<this.width;++t){const n=this.getCellVertex(t,e);n&&(yield n)}}getCellVertex(e,t){var n;return null===(n=this.mapping[t])||void 0===n?void 0:n[e]}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */!function(e){e.DIV_BY_ZERO="DIV_BY_ZERO",e.NAME="NAME",e.VALUE="VALUE",e.NUM="NUM",e.NA="NA",e.CYCLE="CYCLE",e.REF="REF",e.SPILL="SPILL",e.LIC="LIC",e.ERROR="ERROR"}(X9||(X9={})),function(e){e.FORMULA="FORMULA",e.VALUE="VALUE",e.ARRAY="ARRAY",e.EMPTY="EMPTY",e.ARRAYFORMULA="ARRAYFORMULA"}(q9||(q9={}));var s4,a4;!function(e){e.EMPTY="EMPTY",e.NUMBER="NUMBER",e.STRING="STRING",e.BOOLEAN="BOOLEAN",e.ERROR="ERROR"}(s4||(s4={})),function(e){e.NUMBER="NUMBER"}(a4||(a4={}));const l4=Object.assign(Object.assign({},s4),a4),h4=Object.assign(Object.assign({},s4),j3),u4=e=>{switch(e){case l4.EMPTY:return 0;case l4.NUMBER:return 1;case l4.STRING:return 2;case l4.BOOLEAN:return 3;case l4.ERROR:return 4}throw new Error("Cell value not computed")},c4=e=>{if(e===_3)return l4.EMPTY;if(e instanceof g4||e instanceof $3)return l4.ERROR;if("string"==typeof e)return l4.STRING;if(W3(e))return l4.NUMBER;if("boolean"==typeof e)return l4.BOOLEAN;throw new Error("Cell value not computed")},d4=e=>{return W3(e)?(t=e)instanceof H3?t.getDetailedType():j3.NUMBER_RAW:c4(e);var t},p4=e=>{return W3(e)&&(t=e)instanceof H3?t.format:void 0;var t};class g4{constructor(e,t,n){this.type=e,this.message=t,this.root=n}static parsingError(e){return new g4(X9.ERROR,`${W2.ParseError}${e?" "+e:""}`)}attachRootVertex(e){return void 0===this.root?new g4(this.type,this.message,e):this}}const m4=(e,t)=>({sheet:e,row:t}),f4=e=>e.row<0,w4=(e,t)=>({sheet:e,col:t}),y4=e=>e.col<0,v4=(e,t,n)=>({sheet:e,col:t,row:n}),C4=e=>e.col<0||e.row<0,S4=(e,t,n,r)=>v4(t,e.col+n,e.row+r),R4=e=>`${e.sheet},${e.row},${e.col}`;function E4(e){var t,n,r;return e&&("object"==typeof e||"function"==typeof e)&&"number"==typeof(null===(t=e)||void 0===t?void 0:t.sheet)&&"number"==typeof(null===(n=e)||void 0===n?void 0:n.col)&&"number"==typeof(null===(r=e)||void 0===r?void 0:r.row)}const b4=(e,t)=>{var n;return null!==(n=e.sheet)&&void 0!==n?n:t.sheet},T4=(e,t)=>e.sheet===t.sheet&&e.col===t.col&&e.row===t.row;function N4(e){return!(!e||"object"!=typeof e&&"function"!=typeof e)&&("start"in e&&E4(e.start)&&"end"in e&&E4(e.end))}const A4=(e,t)=>({start:e,end:t});class M4{constructor(e,t){if(e.sheet!==t.sheet)throw new o9(e.sheet,t.sheet);this.start=v4(e.sheet,e.col,e.row),this.end=v4(t.sheet,t.col,t.row)}get sheet(){return this.start.sheet}static fromSimpleCellAddresses(e,t){if(e.sheet!==t.sheet)throw new o9(e.sheet,t.sheet);const n=t.col-e.col,r=t.row-e.row;return Number.isFinite(r)&&Number.isFinite(n)?new M4(e,t):Number.isFinite(r)?new O4(e.sheet,e.row,t.row):new I4(e.sheet,e.col,t.col)}static fromAst(e,t){return e.type===I2.CELL_RANGE?M4.fromCellRange(e,t):e.type===I2.COLUMN_RANGE?I4.fromColumnRange(e,t):O4.fromRowRangeAst(e,t)}static fromAstOrUndef(e,t){try{return M4.fromAst(e,t)}catch(n){return}}static fromCellRange(e,t){return new M4(e.start.toSimpleCellAddress(t),e.end.toSimpleCellAddress(t))}static spanFrom(e,t,n){const r=M4.spanFromOrUndef(e,t,n);if(void 0===r)throw new Error("AbsoluteCellRange: Wrong range size");return r}static spanFromOrUndef(e,t,n){if(!Number.isFinite(t)&&Number.isFinite(n)){if(0!==e.col)return;return new O4(e.sheet,e.row,e.row+n-1)}if(!Number.isFinite(n)&&Number.isFinite(t)){if(0!==e.row)return;return new I4(e.sheet,e.col,e.col+t-1)}if(Number.isFinite(n)&&Number.isFinite(t))return new M4(e,v4(e.sheet,e.col+t-1,e.row+n-1))}static fromCoordinates(e,t,n,r,i){return new M4(v4(e,t,n),v4(e,r,i))}isFinite(){return Number.isFinite(this.size())}doesOverlap(e){return this.start.sheet==e.start.sheet&&(!(this.end.row<e.start.row||this.start.row>e.end.row)&&!(this.end.col<e.start.col||this.start.col>e.end.col))}addressInRange(e){return this.sheet===e.sheet&&(this.start.row<=e.row&&this.end.row>=e.row&&this.start.col<=e.col&&this.end.col>=e.col)}columnInRange(e){return this.sheet===e.sheet&&(this.start.col<=e.col&&this.end.col>=e.col)}rowInRange(e){return this.sheet===e.sheet&&(this.start.row<=e.row&&this.end.row>=e.row)}containsRange(e){return this.addressInRange(e.start)&&this.addressInRange(e.end)}intersectionWith(e){if(this.sheet!==e.start.sheet)return;const t=Math.max(this.start.row,e.start.row),n=Math.min(this.end.row,e.end.row),r=Math.max(this.start.col,e.start.col),i=Math.min(this.end.col,e.end.col);return t>n||r>i?void 0:new M4(v4(this.sheet,r,t),v4(this.sheet,i,n))}includesRow(e){return this.start.row<e&&this.end.row>=e}includesColumn(e){return this.start.col<e&&this.end.col>=e}shiftByRows(e){this.start.row+=e,this.end.row+=e}expandByRows(e){this.end.row+=e}shiftByColumns(e){this.start.col+=e,this.end.col+=e}shifted(e,t){return M4.spanFrom(v4(this.sheet,this.start.col+e,this.start.row+t),this.width(),this.height())}expandByColumns(e){this.end.col+=e}moveToSheet(e){this.start.sheet=e,this.end.sheet=e}removeSpan(e){e instanceof K3?this.removeRows(e.start,e.end):this.removeColumns(e.start,e.end)}shouldBeRemoved(){return this.width()<=0||this.height()<=0}rangeWithSameWidth(e,t){return M4.spanFrom(v4(this.sheet,this.start.col,e),this.width(),t)}rangeWithSameHeight(e,t){return M4.spanFrom(v4(this.sheet,e,this.start.row),t,this.height())}toString(){return`${this.start.sheet},${this.start.col},${this.start.row},${this.end.col},${this.end.row}`}width(){return this.end.col-this.start.col+1}height(){return this.end.row-this.start.row+1}size(){return this.height()*this.width()}arrayOfAddressesInRange(){const e=[];for(let t=0;t<this.height();++t){e[t]=[];for(let n=0;n<this.width();++n){const r=v4(this.sheet,this.start.col+n,this.start.row+t);e[t].push(r)}}return e}withStart(e){return new M4(e,this.end)}sameDimensionsAs(e){return this.width()===e.width()&&this.height()===e.height()}sameAs(e){return T4(this.start,e.start)&&T4(this.end,e.end)}addressesArrayMap(e,t){const n=[];let r=this.start.row;for(;r<=this.effectiveEndRow(e);){let i=this.start.col;const o=[];for(;i<=this.effectiveEndColumn(e);)o.push(t(v4(this.start.sheet,i,r))),i++;n.push(o),r++}return n}addresses(e){const t=[];let n=this.start.row;const r=this.effectiveEndRow(e),i=this.effectiveEndColumn(e);for(;n<=r;){let e=this.start.col;for(;e<=i;)t.push(v4(this.start.sheet,e,n)),e++;n++}return t}*addressesWithDirection(e,t,n){if(e>0)if(t>0){let e=this.effectiveEndRow(n);for(;e>=this.start.row;){let t=this.effectiveEndColumn(n);for(;t>=this.start.col;)yield v4(this.start.sheet,t,e),t-=1;e-=1}}else{let e=this.start.row;for(;e<=this.effectiveEndRow(n);){let t=this.effectiveEndColumn(n);for(;t>=this.start.col;)yield v4(this.start.sheet,t,e),t-=1;e+=1}}else if(t>0){let e=this.effectiveEndRow(n);for(;e>=this.start.row;){let t=this.start.col;for(;t<=this.effectiveEndColumn(n);)yield v4(this.start.sheet,t,e),t+=1;e-=1}}else{let e=this.start.row;for(;e<=this.effectiveEndRow(n);){let t=this.start.col;for(;t<=this.effectiveEndColumn(n);)yield v4(this.start.sheet,t,e),t+=1;e+=1}}}getAddress(e,t){if(e<0||t<0||t>this.height()-1||e>this.width()-1)throw Error("Index out of bound");return v4(this.start.sheet,this.start.col+e,this.start.row+t)}exceedsSheetSizeLimits(e,t){return this.end.col>=e||this.end.row>=t}effectiveEndColumn(e){return this.end.col}effectiveEndRow(e){return this.end.row}effectiveWidth(e){return this.width()}effectiveHeight(e){return this.height()}removeRows(e,t){if(!(e>this.end.row)){if(t<this.start.row){const n=t-e+1;return this.shiftByRows(-n)}e<=this.start.row&&(this.start.row=e),this.end.row-=Math.min(t,this.end.row)-e+1}}removeColumns(e,t){if(!(e>this.end.col)){if(t<this.start.col){const n=t-e+1;return this.shiftByColumns(-n)}e<=this.start.col&&(this.start.col=e),this.end.col-=Math.min(t,this.end.col)-e+1}}}class I4 extends M4{constructor(e,t,n){super(v4(e,t,0),v4(e,n,Number.POSITIVE_INFINITY))}static fromColumnRange(e,t){const n=e.start.toSimpleColumnAddress(t),r=e.end.toSimpleColumnAddress(t);if(n.sheet!==r.sheet)throw new o9(n.sheet,r.sheet);return new I4(n.sheet,n.col,r.col)}shouldBeRemoved(){return this.width()<=0}shiftByRows(e){}expandByRows(e){}shifted(e,t){return new I4(this.sheet,this.start.col+e,this.end.col+e)}rangeWithSameHeight(e,t){return new I4(this.sheet,e,e+t-1)}exceedsSheetSizeLimits(e,t){return this.end.col>=e}effectiveEndRow(e){return this.effectiveHeight(e)-1}effectiveHeight(e){return e.getSheetHeight(this.sheet)}removeRows(e,t){}}class O4 extends M4{constructor(e,t,n){super(v4(e,0,t),v4(e,Number.POSITIVE_INFINITY,n))}static fromRowRangeAst(e,t){const n=e.start.toSimpleRowAddress(t),r=e.end.toSimpleRowAddress(t);if(n.sheet!==r.sheet)throw new o9(n.sheet,r.sheet);return new O4(n.sheet,n.row,r.row)}shouldBeRemoved(){return this.height()<=0}shiftByColumns(e){}expandByColumns(e){}shifted(e,t){return new O4(this.sheet,this.start.row+t,this.end.row+t)}rangeWithSameWidth(e,t){return new O4(this.sheet,e,e+t-1)}exceedsSheetSizeLimits(e,t){return this.end.row>=t}effectiveEndColumn(e){return this.effectiveWidth(e)-1}effectiveWidth(e){return e.getSheetWidth(this.sheet)}removeColumns(e,t){}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class x4{constructor(e,t,n){this.formulaAddress=e,this.arraysFlag=t,this.formulaVertex=n}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
const P4=/^\s*([+-]?)\s*(([\d\.,]+(e[+-]?\d+)?)\s*([ij]?)|([ij]))\s*(([+-])\s*([+-]?)\s*(([\d\.,]+(e[+-]?\d+)?)\s*([ij]?)|([ij])))?$/;class _4{constructor(e,t,n){this.config=e,this.dateTimeHelper=t,this.numberLiteralsHelper=n,this.lt=(e,t)=>this.compare(e,t)<0,this.leq=(e,t)=>this.compare(e,t)<=0,this.gt=(e,t)=>this.compare(e,t)>0,this.geq=(e,t)=>this.compare(e,t)>=0,this.eq=(e,t)=>0===this.compare(e,t),this.neq=(e,t)=>0!==this.compare(e,t),this.pow=(e,t)=>Math.pow(L3(e),L3(t)),this.addWithEpsilonRaw=(e,t)=>{const n=e+t;return Math.abs(n)<this.actualEps*Math.abs(e)?0:n},this.addWithEpsilon=(e,t)=>{const n=Y4(e,t);return this.ExtendedNumberFactory(this.addWithEpsilonRaw(L3(e),L3(t)),n)},this.unaryMinus=e=>k3(e,-L3(e)),this.unaryPlus=e=>e,this.unaryPercent=e=>new B3(L3(e)/100),this.concat=(e,t)=>e.concat(t),this.nonstrictadd=(e,t)=>e instanceof g4?e:t instanceof g4?t:"number"==typeof e?"number"==typeof t?this.addWithEpsilonRaw(e,t):e:"number"==typeof t?t:0,this.subtract=(e,t)=>{const n=Y4(e,t),r=L3(e);let i=r-L3(t);return Math.abs(i)<this.actualEps*Math.abs(r)&&(i=0),this.ExtendedNumberFactory(i,n)},this.divide=(e,t)=>{const n=L3(e),r=L3(t);if(0===r)return new g4(X9.DIV_BY_ZERO);{const i=K4(e,t);return this.ExtendedNumberFactory(n/r,i)}},this.multiply=(e,t)=>{const n=K4(e,t);return this.ExtendedNumberFactory(L3(e)*L3(t),n)},this.manyToExactComplex=e=>{const t=[];for(const n of e){if(n instanceof g4)return n;if(W3(n)||"string"==typeof n){const e=this.coerceScalarToComplex(n);e instanceof g4||t.push(e)}}return t},this.coerceNumbersExactRanges=e=>this.manyToNumbers(e,this.manyToExactNumbers),this.coerceNumbersCoerceRangesDropNulls=e=>this.manyToNumbers(e,this.manyToCoercedNumbersDropNulls),this.manyToExactNumbers=e=>{const t=[];for(const n of e){if(n instanceof g4)return n;W3(n)&&t.push(L3(n))}return t},this.manyToOnlyNumbersDropNulls=e=>{const t=[];for(const n of e){if(n instanceof g4)return n;if(W3(n))t.push(L3(n));else if(n!==_3)return new g4(X9.VALUE,W2.NumberExpected)}return t},this.manyToCoercedNumbersDropNulls=e=>{const t=[];for(const n of e){if(n instanceof g4)return n;if(n===_3)continue;const e=this.coerceScalarToNumberOrError(n);W3(e)&&t.push(L3(e))}return t},this.collator=function(e){const t=e.caseSensitive?e.accentSensitive?"variant":"case":e.accentSensitive?"accent":"base",n=e.caseFirst,r=e.ignorePunctuation;return new Intl.Collator(e.localeLang,{sensitivity:t,caseFirst:n,ignorePunctuation:r})}(e),this.actualEps=e.smartRounding?e.precisionEpsilon:0}eqMatcherFunction(e){const t=this.buildRegex(e);return e=>"string"==typeof e&&t.test(this.normalizeString(e))}neqMatcherFunction(e){const t=this.buildRegex(e);return e=>!("string"==typeof e&&t.test(this.normalizeString(e)))}searchString(e,t){var n;const r=this.buildRegex(e,!1).exec(t);return null!==(n=null==r?void 0:r.index)&&void 0!==n?n:-1}requiresRegex(e){if(!this.config.useRegularExpressions&&!this.config.useWildcards)return!this.config.matchWholeCell;for(let t=0;t<e.length;t++){const n=e.charAt(t);if(G4(n)||this.config.useRegularExpressions&&$4(n))return!0}return!1}floatCmp(e,t){const n=L3(e),r=L3(t),i=1+this.actualEps;return r>=0&&n*i>=r&&n<=r*i||r<=0&&n*i<=r&&n>=r*i?0:n>r?1:-1}coerceScalarToNumberOrError(e){var t;return e instanceof g4?e:null!==(t=this.coerceToMaybeNumber(e))&&void 0!==t?t:new g4(X9.VALUE,W2.NumberCoercion)}coerceToMaybeNumber(e){var t;return null!==(t=this.coerceNonDateScalarToMaybeNumber(e))&&void 0!==t?t:"string"==typeof e?this.dateTimeHelper.dateStringToDateNumber(e):void 0}coerceNonDateScalarToMaybeNumber(e){if(e===_3)return 0;if("string"==typeof e){if(""===e)return 0;const t=this.coerceStringToMaybePercentNumber(e);if(void 0!==t)return t;const n=this.coerceStringToMaybeCurrencyNumber(e);return void 0!==n?n:this.numberLiteralsHelper.numericStringToMaybeNumber(e.trim())}return W3(e)?e:"boolean"==typeof e?Number(e):void 0}coerceStringToMaybePercentNumber(e){const t=e.trim();if(t.endsWith("%")){const e=t.slice(0,t.length-1).trim(),n=this.numberLiteralsHelper.numericStringToMaybeNumber(e);if(void 0!==n)return new B3(n/100)}}coerceStringToMaybeCurrencyNumber(e){const t=this.currencyMatcher(e.trim());if(void 0!==t){const[e,n]=t,r=this.numberLiteralsHelper.numericStringToMaybeNumber(n);if(void 0!==r)return new D3(r,e)}}currencyMatcher(e){for(const t of this.config.currencySymbol){if(e.startsWith(t))return[t,e.slice(t.length).trim()];if(e.endsWith(t))return[t,e.slice(0,e.length-t.length).trim()]}}coerceComplexExactRanges(e){const t=[];for(const r of e)if(r instanceof $3)t.push(r);else if(r!==_3){const e=this.coerceScalarToComplex(r);if(e instanceof g4)return e;t.push(e)}const n=[];for(const r of t)if(r instanceof $3){const e=this.manyToExactComplex(r.valuesFromTopLeftCorner());if(e instanceof g4)return e;n.push(...e)}else n.push(r);return n}coerceScalarToComplex(e){return e instanceof g4?e:e===_3?[0,0]:W3(e)?[L3(e),0]:"string"==typeof e?this.coerceStringToComplex(e):new g4(X9.NUM,W2.ComplexNumberExpected)}ExtendedNumberFactory(e,t){const{type:n,format:r}=t;switch(n){case j3.NUMBER_RAW:return e;case j3.NUMBER_CURRENCY:return new D3(e,null!=r?r:this.config.currencySymbol[0]);case j3.NUMBER_DATE:return new F3(e,r);case j3.NUMBER_DATETIME:return new U3(e,r);case j3.NUMBER_TIME:return new V3(e,r);case j3.NUMBER_PERCENT:return new B3(e,r)}}buildRegex(e,t=!0){let n;e=this.normalizeString(e);let r=this.config.useWildcards,i=this.config.useRegularExpressions;if(i)try{RegExp(e)}catch(o){i=!1,r=!1}return n=i?function(e,t){let n="";for(let r=0;r<e.length;r++){const i=e.charAt(r);G4(i)||$4(i)?n+=i:n+=t?i:i.toLowerCase()}return n}(e,this.config.caseSensitive):r?function(e,t){let n="";for(let r=0;r<e.length;r++){const i=e.charAt(r);if("~"===i){if(r==e.length-1){n+="~";continue}const t=e.charAt(r+1);G4(t)||$4(t)?(n+="\\"+t,r++):(n+=t,r++)}else G4(i)?n+="."+i:$4(i)?n+="\\"+i:n+=t?i:i.toLowerCase()}return n}(e,this.config.caseSensitive):function(e,t){let n="";for(let r=0;r<e.length;r++){const i=e.charAt(r);G4(i)||$4(i)?n+="\\"+i:n+=t?i:i.toLowerCase()}return n}(e,this.config.caseSensitive),this.config.matchWholeCell&&t?RegExp("^("+n+")$"):RegExp(n)}normalizeString(e){return this.config.caseSensitive||(e=e.toLowerCase()),this.config.accentSensitive||(e=Q4(e,"nfd").replace(/[\u0300-\u036f]/g,"")),e}compare(e,t){if("string"==typeof e||"string"==typeof t){const n="string"==typeof e?this.dateTimeHelper.dateStringToDateNumber(e):e,r="string"==typeof t?this.dateTimeHelper.dateStringToDateNumber(t):t;if(W3(n)&&W3(r))return this.floatCmp(n,r)}return e===_3?e=F4(t):t===_3&&(t=F4(e)),"string"==typeof e&&"string"==typeof t?this.stringCmp(e,t):"boolean"==typeof e&&"boolean"==typeof t?B4(k4(e),k4(t)):W3(e)&&W3(t)?this.floatCmp(e,t):e===_3&&t===_3?0:B4(u4(c4(e)),u4(c4(t)))}stringCmp(e,t){return this.collator.compare(e,t)}manyToNumbers(e,t){const n=[];for(const i of e)if(i instanceof $3)n.push(i);else{const e=L3(this.coerceScalarToNumberOrError(i));if(e instanceof g4)return e;n.push(e)}const r=[];for(const i of n)if(i instanceof $3){const e=t(i.valuesFromTopLeftCorner());if(e instanceof g4)return e;r.push(...e)}else r.push(i);return r}coerceStringToComplex(e){const t=P4.exec(e);if(null===t)return new g4(X9.NUM,W2.ComplexNumberExpected);let n,r;return n=void 0!==t[6]?"-"===t[1]?[0,-1]:[0,1]:this.parseComplexToken(t[1]+t[3],t[5]),n instanceof g4||void 0===t[8]?n:(r=void 0!==t[14]?"-"===t[9]?[0,-1]:[0,1]:this.parseComplexToken(t[9]+t[11],t[13]),r instanceof g4?r:""!==t[5]||""===t[13]?new g4(X9.NUM,W2.ComplexNumberExpected):"+"===t[8]?[n[0]+r[0],n[1]+r[1]]:[n[0]-r[0],n[1]-r[1]])}parseComplexToken(e,t){const n=L3(this.coerceNonDateScalarToMaybeNumber(e));return void 0===n?new g4(X9.NUM,W2.ComplexNumberExpected):""===t?[n,0]:[0,n]}}function L4([e,t],n){if(!isFinite(e)||!isFinite(t))return new g4(X9.NUM,W2.NaN);if(n=null!=n?n:"i",0===t)return`${e}`;const r=`${-1===t||1===t?"":Math.abs(t)}${n}`;return 0===e?`${t<0?"-":""}${r}`:`${e}${t<0?"-":"+"}${r}`}function H4(e){return e instanceof $3?e:$3.fromScalar(e)}function k4(e){return Number(e)}function F4(e){return"string"==typeof e?"":W3(e)?0:"boolean"!=typeof e&&_3}function D4(e){if(e instanceof g4||"boolean"==typeof e)return e;if(e===_3)return!1;if(W3(e))return 0!==L3(e);{const t=e.toUpperCase();return"TRUE"===t||"FALSE"!==t&&(""!==t&&void 0)}}function V4(e){return e instanceof g4||"string"==typeof e?e:e===_3?"":W3(e)?L3(e).toString():e?"TRUE":"FALSE"}function U4(e){return e===_3?0:e}function B4(e,t){const n=L3(e),r=L3(t);return n>r?1:n<r?-1:0}function W4(e){return isNaN(e)||e===1/0||e===-1/0}function j4(e){return 0===e?0:e}function G4(e){return["*","?"].includes(e)}const z4=["{","}","[","]","(",")","<",">","=",".","+","-",",","\\","$","^","!"];function $4(e){return z4.includes(e)}function Y4(e,t){const{type:n,format:r}=z3(e),{type:i,format:o}=z3(t);if(n===j3.NUMBER_RAW)return{type:i,format:o};if(i===j3.NUMBER_RAW)return{type:n,format:r};if(!(n!==j3.NUMBER_DATETIME&&n!==j3.NUMBER_DATE||i!==j3.NUMBER_DATETIME&&i!==j3.NUMBER_DATE))return{type:j3.NUMBER_RAW};if(n===j3.NUMBER_TIME){if(i===j3.NUMBER_DATE)return{type:j3.NUMBER_DATETIME,format:`${o} ${r}`};if(i===j3.NUMBER_DATETIME)return{type:j3.NUMBER_DATETIME,format:o}}if(i===j3.NUMBER_TIME){if(n===j3.NUMBER_DATE)return{type:j3.NUMBER_DATETIME,format:`${r} ${o}`};if(n===j3.NUMBER_DATETIME)return{type:j3.NUMBER_DATETIME,format:r}}return{type:n,format:r}}function K4(e,t){let{type:n,format:r}=z3(e),{type:i,format:o}=z3(t);return n===j3.NUMBER_PERCENT&&(n=j3.NUMBER_RAW,r=void 0),i===j3.NUMBER_PERCENT&&(i=j3.NUMBER_RAW,o=void 0),n===j3.NUMBER_RAW?{type:i,format:o}:i===j3.NUMBER_RAW?{type:n,format:r}:{type:j3.NUMBER_RAW}}function X4(e){return Q4(e.toLowerCase(),"nfd").replace(/[\u0300-\u036f]/g,"")}function q4(e,t){var n;if(e.isAdHoc())return null===(n=e.data[0])||void 0===n?void 0:n[0];const r=e.range;if(t.formulaAddress.sheet===r.sheet)if(1===r.width()){const n=t.formulaAddress.row-r.start.row;if(n>=0&&n<r.height())return e.data[n][0]}else if(1===r.height()){const n=t.formulaAddress.col-r.start.col;if(n>=0&&n<r.width())return e.data[0][n]}}function Q4(e,t){return e.normalize(t.toUpperCase())}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */var Z4;!function(e){e.STRING="STRING",e.NUMBER="NUMBER",e.BOOLEAN="BOOLEAN",e.SCALAR="SCALAR",e.NOERROR="NOERROR",e.RANGE="RANGE",e.INTEGER="INTEGER",e.COMPLEX="COMPLEX",e.ANY="ANY"}(Z4||(Z4={}));class J4{constructor(e){this.coerceScalarToNumberOrError=e=>this.arithmeticHelper.coerceScalarToNumberOrError(e),this.runFunction=(e,t,n,r)=>{const i=this.evaluateArguments(e,t,n),o=i.map((([e,t])=>e)),s=i.map((([e,t])=>t)),a=this.buildMetadataForEachArgumentValue(o.length,n),l=t.arraysFlag&&!n.vectorizationForbidden;if(!this.isNumberOfArgumentValuesValid(a,o.length))return new g4(X9.NA,W2.WrongArgNumber);const[h,u]=l?this.calculateSizeOfVectorizedResultArray(o,a):[1,1];if(1===h&&1===u){const e=this.vectorizeAndBroadcastArgumentsIfNecessary(l,o,a,0,0);return this.calculateSingleCellOfResultArray(t,e,a,s,r,n.returnNumberType)}const c=[...Array(h).keys()].map((e=>[...Array(u).keys()].map((i=>{const h=this.vectorizeAndBroadcastArgumentsIfNecessary(l,o,a,e,i),u=this.calculateSingleCellOfResultArray(t,h,a,s,r,n.returnNumberType);if(u instanceof $3)throw new Error("Function returning array cannot be vectorized.");return u}))));return $3.onlyValues(c)},this.runFunctionWithReferenceArgument=(e,t,n,r,i,o=()=>new g4(X9.NA,W2.CellRefExpected))=>{if(0===e.length)return this.returnNumberWrapper(r(),n.returnNumberType);if(e.length>1)return new g4(X9.NA,W2.WrongArgNumber);let s,a=e[0];for(;a.type===I2.PARENTHESIS;)a=a.expression;if(a.type===I2.CELL_REFERENCE)s=a.reference.toSimpleCellAddress(t.formulaAddress);else if(a.type===I2.CELL_RANGE||a.type===I2.COLUMN_RANGE||a.type===I2.ROW_RANGE)try{s=M4.fromAst(a,t.formulaAddress).start}catch(l){return new g4(X9.REF,W2.CellRefExpected)}return void 0!==s?this.returnNumberWrapper(i(s),n.returnNumberType):this.runFunction(e,t,n,o)},this.interpreter=e,this.dependencyGraph=e.dependencyGraph,this.columnSearch=e.columnSearch,this.config=e.config,this.serialization=e.serialization,this.arraySizePredictor=e.arraySizePredictor,this.dateTimeHelper=e.dateTimeHelper,this.arithmeticHelper=e.arithmeticHelper}evaluateAst(e,t){return this.interpreter.evaluateAst(e,t)}arraySizeForAst(e,t){return this.arraySizePredictor.checkArraySizeForAst(e,t)}listOfScalarValues(e,t){const n=[];for(const r of e){const e=this.evaluateAst(r,t);if(e instanceof $3)for(const t of e.valuesFromTopLeftCorner())n.push([t,!0]);else n.push([e,!1])}return n}coerceToType(e,t,n){let r;if(e instanceof $3)switch(t.argumentType){case Z4.RANGE:case Z4.ANY:r=e;break;default:{const t=q4(e,n);if(void 0===t)return;e=t}}if(!(e instanceof $3))switch(t.argumentType){case Z4.INTEGER:case Z4.NUMBER:const n=this.coerceScalarToNumberOrError(e);if(!W3(n)){r=n;break}const i=L3(n);if(void 0!==t.maxValue&&i>t.maxValue)return new g4(X9.NUM,W2.ValueLarge);if(void 0!==t.minValue&&i<t.minValue)return new g4(X9.NUM,W2.ValueSmall);if(void 0!==t.lessThan&&i>=t.lessThan)return new g4(X9.NUM,W2.ValueLarge);if(void 0!==t.greaterThan&&i<=t.greaterThan)return new g4(X9.NUM,W2.ValueSmall);if(t.argumentType===Z4.INTEGER&&!Number.isInteger(i))return new g4(X9.NUM,W2.IntegerExpected);r=n;break;case Z4.STRING:r=V4(e);break;case Z4.BOOLEAN:r=D4(e);break;case Z4.SCALAR:case Z4.NOERROR:case Z4.ANY:r=e;break;case Z4.RANGE:if(e instanceof g4)return e;r=H4(e);break;case Z4.COMPLEX:return this.arithmeticHelper.coerceScalarToComplex(L3(e))}return t.passSubtype||void 0===r?r:L3(r)}calculateSingleCellOfResultArray(e,t,n,r,i,o){const s=this.coerceArgumentsToRequiredTypes(e,t,n,r);if(s instanceof g4)return s;const a=i(...s);return this.returnNumberWrapper(a,o)}coerceArgumentsToRequiredTypes(e,t,n,r){const i=[];for(let o=0;o<n.length;o++){const s=n[o],a=void 0!==t[o]?t[o]:null==s?void 0:s.defaultValue;if(void 0===a){i.push(void 0);continue}const l=this.coerceToType(a,s,e);if(void 0===l&&!r[o])return new g4(X9.VALUE,W2.WrongType);if(l instanceof g4&&s.argumentType!==Z4.SCALAR)return l;i.push(l)}return i}vectorizeAndBroadcastArgumentsIfNecessary(e,t,n,r,i){return t.map(((t,o)=>e&&this.isRangePassedAsAScalarArgument(t,n[o])?this.vectorizeAndBroadcastRangeArgument(t,r,i):t))}vectorizeAndBroadcastRangeArgument(e,t,n){var r;const i=1===e.height()?0:t,o=1===e.width()?0:n;return null===(r=e.data[i])||void 0===r?void 0:r[o]}evaluateArguments(e,t,n){return n.expandRanges?this.listOfScalarValues(e,t):e.map((e=>[this.evaluateAst(e,t),!1]))}buildMetadataForEachArgumentValue(e,t){const n=t.parameters?[...t.parameters]:[];if(void 0!==t.repeatLastArgs&&Number.isInteger(t.repeatLastArgs)&&t.repeatLastArgs>0)for(;e>n.length;)n.push(...n.slice(n.length-t.repeatLastArgs));return n}isNumberOfArgumentValuesValid(e,t){if(t>e.length)return!1;if(t<e.length){return e.slice(t).every((e=>(null==e?void 0:e.optionalArg)||void 0!==(null==e?void 0:e.defaultValue)))}return!0}calculateSizeOfVectorizedResultArray(e,t){const n=e.filter(((e,n)=>this.isRangePassedAsAScalarArgument(e,t[n])));return[Math.max(1,...n.map((e=>e.height()))),Math.max(1,...n.map((e=>e.width())))]}isRangePassedAsAScalarArgument(e,t){return null!=e&&null!=t&&(e instanceof $3&&![Z4.RANGE,Z4.ANY].includes(t.argumentType))}metadata(e){const t=this.constructor.implementedFunctions[e];if(void 0!==t)return t;throw new Error(`No metadata for function ${e}.`)}returnNumberWrapper(e,t,n){return void 0!==t&&W3(e)?this.arithmeticHelper.ExtendedNumberFactory(L3(e),{type:t,format:n}):e}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class e5{constructor(e,t,n=!1){this.width=e,this.height=t,this.isRef=n}static error(){return new e5(1,1,!0)}static scalar(){return new e5(1,1,!1)}isScalar(){return 1===this.width&&1===this.height||this.isRef}}class t5{constructor(e,t){this.config=e,this.functionRegistry=t}checkArraySize(e,t){return this.checkArraySizeForAst(e,{formulaAddress:t,arraysFlag:this.config.useArrayArithmetic})}checkArraySizeForAst(e,t){switch(e.type){case I2.FUNCTION_CALL:return this.checkArraySizeForFunction(e,t);case I2.COLUMN_RANGE:case I2.ROW_RANGE:case I2.CELL_RANGE:{const n=M4.fromAstOrUndef(e,t.formulaAddress);return void 0===n?e5.error():new e5(n.width(),n.height(),!0)}case I2.ARRAY:{const n=[],r=[];for(const s of e.args){const e=s.map((e=>this.checkArraySizeForAst(e,t))),i=Math.min(...e.map((e=>e.height))),o=e.reduce(((e,t)=>e+t.width),0);n.push(i),r.push(o)}const i=n.reduce(((e,t)=>e+t),0),o=Math.min(...r);return new e5(o,i)}case I2.STRING:case I2.NUMBER:return e5.scalar();case I2.CELL_REFERENCE:return new e5(1,1,!0);case I2.DIV_OP:case I2.CONCATENATE_OP:case I2.EQUALS_OP:case I2.GREATER_THAN_OP:case I2.GREATER_THAN_OR_EQUAL_OP:case I2.LESS_THAN_OP:case I2.LESS_THAN_OR_EQUAL_OP:case I2.MINUS_OP:case I2.NOT_EQUAL_OP:case I2.PLUS_OP:case I2.POWER_OP:case I2.TIMES_OP:{const n=this.checkArraySizeForAst(e.left,t),o=this.checkArraySizeForAst(e.right,t);return!t.arraysFlag&&(n.height>1||n.width>1||o.height>1||o.width>1)?e5.error():(r=n,i=o,new e5(Math.max(r.width,i.width),Math.max(r.height,i.height)))}case I2.MINUS_UNARY_OP:case I2.PLUS_UNARY_OP:case I2.PERCENT_OP:{const r=this.checkArraySizeForAst(e.value,t);return!t.arraysFlag&&(r.height>1||r.width>1)?e5.error():new e5((n=r).width,n.height)}case I2.PARENTHESIS:return this.checkArraySizeForAst(e.expression,t);case I2.EMPTY:default:return e5.error()}var n,r,i}checkArraySizeForFunction(e,t){const n=this.functionRegistry.getArraySizeFunction(e.procedureName);if(void 0!==n)return n(e,t);const r=this.functionRegistry.getMetadata(e.procedureName);if(void 0===r||r.expandRanges||!t.arraysFlag||r.vectorizationForbidden||void 0===r.parameters)return new e5(1,1);const i=e.args.map((e=>{var n;return this.checkArraySizeForAst(e,new x4(t.formulaAddress,t.arraysFlag||null!==(n=null==r?void 0:r.arrayFunction)&&void 0!==n&&n))})),o=[...r.parameters];if(void 0!==r.repeatLastArgs&&o.length<i.length&&(i.length-o.length)%r.repeatLastArgs!=0)return e5.error();for(;o.length<i.length;){if(void 0===r.repeatLastArgs)return e5.error();o.push(...o.slice(o.length-r.repeatLastArgs))}let s=1,a=1;for(let l=0;l<i.length;l++)o[l].argumentType!==Z4.RANGE&&o[l].argumentType!==Z4.ANY&&(a=Math.max(a,i[l].height),s=Math.max(s,i[l].width));return new e5(s,a)}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class n5{constructor(e,t,n){var r;this.value=t,this.address=n,this.type=e.type,this.message=null!==(r=e.message)&&void 0!==r?r:""}toString(){return this.value}valueOf(){return this.value}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */function r5(e,t,n){if(void 0===e)return H8.defaultConfig[n];if("string"==typeof t){if(typeof e===t)return e;throw new g9(t,n)}if(t.includes(e))return e;throw new y9(t.map((e=>`'${e}'`)).join(" "),n)}function i5(e,t,n){if(e<n)throw new f9(t,n)}function o5(e,t,n,r){if(t(e))return e;if(void 0===e)return H8.defaultConfig[r];throw new g9(n,r)}function s5(...e){const t=new Map;e.forEach((e=>{const n=t.get(e.value)||[];n.push(e.name),t.set(e.value,n)}));const n=[];for(const r of t.values())r.length>1&&n.push(r);if(n.length>0){n.forEach((e=>e.sort()));const e=n.map((e=>`[${e}]`)).join("; ");throw new Error(`Config initialization failed. Parameters in conflict: ${e}`)}}function a5(e,t,n){if(typeof e!==t)throw new g9(t,n)}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */const l5=new RegExp("^ss(\\.(s+|0+))?$"),h5=new RegExp("^[0-9/.\\-: ]+[ap]?m?$"),u5=new RegExp("\\s+"),c5=new RegExp("[ /.-]"),d5=f5((function(e){const t=e.toLowerCase().trim(),n=(t.endsWith("am/pm")?t.substring(0,t.length-5):t.endsWith("a/p")?t.substring(0,e.length-3):t).trim().split(":");return{itemsCount:n.length,hourItem:n.indexOf("hh"),minuteItem:n.indexOf("mm"),secondItem:n.findIndex((e=>l5.test(e)))}})),p5=f5((function(e){const t=e.toLowerCase().trim().split(c5);return{itemsCount:t.length,dayItem:t.indexOf("dd"),monthItem:t.indexOf("mm"),shortYearItem:t.indexOf("yy"),longYearItem:t.indexOf("yyyy")}}));function g5(e,t){var n,r,i;if(void 0===t)return;const{itemsCount:o,hourItem:s,minuteItem:a,secondItem:l}=d5(t);let h;if("am"===e[e.length-1]||"a"===e[e.length-1]?(h=!1,e.pop()):"pm"!==e[e.length-1]&&"p"!==e[e.length-1]||(h=!0,e.pop()),e.length!==o)return;const u=Number(null!==(n=e[l])&&void 0!==n?n:"0");if(!Number.isFinite(u))return;const c=Math.round(1e3*u)/1e3,d=Number(null!==(r=e[a])&&void 0!==r?r:"0");if(!Number.isFinite(d)||!Number.isInteger(d))return;const p=Number(null!==(i=e[s])&&void 0!==i?i:"0");if(!Number.isFinite(p)||!Number.isInteger(p))return;if(void 0!==h&&(p<0||p>12))return;return{hours:void 0!==h?p%12+(h?12:0):p,minutes:d,seconds:c}}function m5(e,t){var n;if(void 0===t)return;const{itemsCount:r,dayItem:i,monthItem:o,shortYearItem:s,longYearItem:a}=p5(t);if(e.length!==r)return;const l=Number(e[i]);if(!Number.isFinite(l)||!Number.isInteger(l))return;const h=Number(e[o]);if(!Number.isFinite(h)||!Number.isInteger(h))return;if(e[a]&&e[s])return;const u=Number(null!==(n=e[a])&&void 0!==n?n:e[s]);return Number.isFinite(u)&&Number.isInteger(u)&&!(e[a]&&(u<1e3||u>9999)||e[s]&&(u<0||u>99))?{year:u,month:h,day:l}:void 0}function f5(e){const t={};return n=>{const r=t[n];if(void 0!==r)return r;const i=e(n);return t[n]=i,i}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */const w5=[31,28,31,30,31,30,31,31,30,31,30,31],y5=[0,31,59,90,120,151,181,212,243,273,304,334];function v5(e){return!(!e||"object"!=typeof e&&"function"!=typeof e)&&("year"in e&&"number"==typeof e.year&&"month"in e&&"number"==typeof e.month&&"day"in e&&"number"==typeof e.day)}function C5(e){return!(!e||"object"!=typeof e&&"function"!=typeof e)&&("hours"in e&&"number"==typeof e.hours&&"minutes"in e&&"number"==typeof e.minutes&&"seconds"in e&&"number"==typeof e.seconds)}const S5={year:9999,month:12,day:31};class R5{constructor(e){this.config=e,this.minDateAbsoluteValue=this.dateToNumberFromZero(e.nullDate),this.maxDateValue=this.dateToNumber(S5),this.leapYear1900=e.leapYear1900,!this.leapYear1900&&0<=this.dateToNumber({year:1900,month:2,day:28})?this.epochYearZero=this.numberToSimpleDate(2).year:this.epochYearZero=this.numberToSimpleDate(1).year,this.parseDateTime=e.parseDateTime}getWithinBounds(e){return e<=this.maxDateValue&&e>=0?e:void 0}dateStringToDateNumber(e){const{dateTime:t,dateFormat:n="",timeFormat:r=""}=this.parseDateTimeFromConfigFormats(e);if(void 0!==t)return C5(t)?v5(t)?new U3(N5(t)+this.dateToNumber(t),n+" "+r):new V3(N5(t),r):v5(t)?new F3(this.dateToNumber(t),n):0}parseDateTimeFromConfigFormats(e){return this.parseDateTimeFromFormats(e,this.config.dateFormats,this.config.timeFormats)}getNullYear(){return this.config.nullYear}getEpochYearZero(){return this.epochYearZero}isValidDate(e){return!(isNaN(e.year)||isNaN(e.month)||isNaN(e.day))&&(e.day===Math.round(e.day)&&e.month===Math.round(e.month)&&e.year===Math.round(e.year)&&(!(e.year<1582)&&(!(e.month<1||e.month>12)&&(!(e.day<1)&&(this.isLeapYear(e.year)&&2===e.month?e.day<=29:e.day<=w5[e.month-1])))))}dateToNumber(e){return this.dateToNumberFromZero(e)-this.minDateAbsoluteValue}relativeNumberToAbsoluteNumber(e){return e+this.minDateAbsoluteValue-(this.leapYear1900?1:0)}numberToSimpleDate(e){const t=Math.floor(e)+this.minDateAbsoluteValue;let n=Math.floor(t/365.2425);this.dateToNumberFromZero({year:n+1,month:1,day:1})<=t?n++:this.dateToNumberFromZero({year:n-1,month:1,day:1})>t&&n--;const r=t-this.dateToNumberFromZero({year:n,month:1,day:1}),i=function(e){let t=0;y5[t+6]<=e&&(t+=6);y5[t+3]<=e&&(t+=3);y5[t+2]<=e?t+=2:y5[t+1]<=e&&(t+=1);return t}(r-(this.isLeapYear(n)&&r>=59?1:0));return{year:n,month:i+1,day:r-y5[i]-(this.isLeapYear(n)&&i>1?1:0)+1}}numberToSimpleDateTime(e){const t=T5(e%1),n=Math.floor(t.hours/24);t.hours=t.hours%24;const r=this.numberToSimpleDate(Math.floor(e)+n);return Object.assign(Object.assign({},r),t)}leapYearsCount(e){return Math.floor(e/4)-Math.floor(e/100)+Math.floor(e/400)+(this.config.leapYear1900&&e>=1900?1:0)}daysInMonth(e,t){return this.isLeapYear(e)&&2===t?29:w5[t-1]}endOfMonth(e){return{year:e.year,month:e.month,day:this.daysInMonth(e.year,e.month)}}toBasisUS(e,t){return 31===e.day&&(e.day=30),30===e.day&&31===t.day&&(t.day=30),2===e.month&&e.day===this.daysInMonth(e.year,e.month)&&(e.day=30,2===t.month&&t.day===this.daysInMonth(t.year,t.month)&&(t.day=30)),[e,t]}yearLengthForBasis(e,t){return e.year!==t.year?e.year+1!==t.year||e.month<t.month||e.month===t.month&&e.day<t.day?(this.leapYearsCount(t.year)-this.leapYearsCount(e.year-1))/(t.year-e.year+1)+365:this.countLeapDays(t)!==this.countLeapDays({year:e.year,month:e.month,day:e.day-1})?366:365:this.isLeapYear(e.year)?366:365}parseSingleFormat(e,t,n){const r=this.parseDateTime(e,t,n);if(!v5(r)||(r.year>=0&&r.year<100&&(r.year<this.getNullYear()?r.year+=2e3:r.year+=1900),this.isValidDate(r)))return r}parseDateTimeFromFormats(e,t,n){const r=0===t.length?[void 0]:t,i=0===n.length?[void 0]:n;for(const o of r)for(const t of i){const n=this.parseSingleFormat(e,o,t);if(void 0!==n)return{dateTime:n,timeFormat:t,dateFormat:o}}return{}}countLeapDays(e){return e.month>2||2===e.month&&e.day>=29?this.leapYearsCount(e.year):this.leapYearsCount(e.year-1)}dateToNumberFromZero(e){return 365*e.year+y5[e.month-1]+e.day-1+(e.month<=2?this.leapYearsCount(e.year-1):this.leapYearsCount(e.year))}isLeapYear(e){return!(e%4)&&(!!(e%100)||(!(e%400)||1900===e&&this.config.leapYear1900))}}function E5(e,t){const n=12*e.year+e.month-1+t;return{year:Math.floor(n/12),month:n%12+1,day:e.day}}function b5(e){return Math.round(3600*e*24)/86400}function T5(e){const t=24*e*60*60,n=function(e,t=1){return Math.round(e*t)/t}(t%60,1e5)%60,r=(t-n)/60,i=Math.round(r%60)%60,o=(r-i)/60;return{hours:Math.round(o),minutes:i,seconds:n}}function N5(e){return((e.seconds/60+e.minutes)/60+e.hours)/24}function A5(e){return{year:e.year,month:e.month,day:Math.min(30,e.day)}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
const M5=/(\\.|dd|DD|d|D|mm|MM|m|M|YYYY|YY|yyyy|yy|HH|hh|H|h|ss(\.(0+|s+))?|s|AM\/PM|am\/pm|A\/P|a\/p|\[mm]|\[MM]|\[hh]|\[HH])/g,I5=/(\\.|[#0]+(\.[#0]*)?)/g;var O5,x5;function P5(e,t){return{type:e,value:t}}function _5(e,t){const n=[];let r=0;for(let o=0;o<e.length;++o){const i=e[o];if(i.index!==r){const e=t.substr(r,i.index-r);n.push(P5(O5.FREE_TEXT,e))}i[0].startsWith("\\")?n.push(P5(O5.FREE_TEXT,i[0])):n.push(P5(O5.FORMAT,i[0])),r=i.index+i[0].length}const i=e[e.length-1];if(i.index+i[0].length<t.length){const e=t.substr(i.index+i[0].length,t.length);n.push(P5(O5.FREE_TEXT,e))}return n}function L5(e){const t=function(e){M5.lastIndex=0;const t=[];let n;do{n=M5.exec(e),null!==n&&t.push(n)}while(n);return t}(e);return t.every((e=>k5(e)))?void 0:{type:x5.DATE,tokens:_5(t,e)}}function H5(e){const t=function(e){I5.lastIndex=0;const t=I5.exec(e);return null!==t?[t]:[]}(e);return t.every((e=>k5(e)))?void 0:{type:x5.NUMBER,tokens:_5(t,e)}}function k5(e){return e[0].startsWith("\\")}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */function F5(e,t,n,r){const i=n.stringifyDateTime(r.numberToSimpleDateTime(e),t);if(void 0!==i)return i;const o=n.stringifyDuration(T5(e),t);if(void 0!==o)return o;const s=H5(t);return void 0!==s?function(e,t){let n="";for(let r=0;r<e.length;++r){const i=e[r];if(i.type===O5.FREE_TEXT){n+=i.value;continue}const o=i.value.split("."),s=o[0],a=o[1]||"",l=o[1]?".":"",h=Number(t.toFixed(a.length)).toString().split(".");let u=h[0]||"",c=h[1]||"";if(s.length>u.length){u=D5(u,U5(s.substr(0,s.length-u.length),"0")+u.length)}c=V5(c,U5(a.substr(c.length,a.length-c.length),"0")+c.length),n+=u+l+c}return n}(s.tokens,e):t}function D5(e,t){let n=`${e}`;for(;n.length<t;)n="0"+n;return n}function V5(e,t){let n=`${e}`;for(;n.length<t;)n+="0";return n}function U5(e,t){return e.split(t).length-1}!function(e){e.FORMAT="FORMAT",e.FREE_TEXT="FREE_TEXT"}(O5||(O5={})),function(e){e.DATE="DATE",e.NUMBER="NUMBER",e.STRING="STRING"}(x5||(x5={}));
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
const B5="length",W5=e=>parseInt(e,16),j5=e=>parseInt(e,10),G5=e=>(e+"").replace(/\-/g,""),z5=(e,t,n)=>e.substr(t,n),$5=e=>e.codePointAt(0)-65;
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
const Y5={invalid:()=>"The license key for HyperFormula is invalid.",expired:({keyValidityDate:e})=>`The license key for HyperFormula expired on ${e}, and is not valid for the installed version.`,missing:()=>"The license key for HyperFormula is missing."};let K5=!1;function X5(e){const t={template:"missing",vars:{}};if("gpl-v3"===e||"internal-use-in-handsontable"===e)t.template="valid";else if("string"==typeof e&&function(e){if((e=(e+"").replace(/\-/g,""))[B5]!==$5("Z"))return!1;let t=0;return[[0,$5("G")+1],[$5("H"),$5("H")-1],[$5("G")+$5("H"),$5("G")]].reduce(((n,[r,i],o)=>(n|=(j5(`${j5(W5(z5(e,t+r-(0===o?0:2),i+(o?2:0)))+(W5(z5(e,t+r+i,2))+[]).padStart(2,"0"))}`)%97||2)>>1,t+=2,n)),$5("A"))===[]+1>>1}(e)){const[r,i,o]="14/01/2025".split("/"),s=Math.floor(new Date(`${i}/${r}/${o}`).getTime()/864e5),a=25===G5(n=e)[B5]?W5(z5(G5(n),W5("12"),$5("F")))/(W5(z5(G5(n),$5("C"),$5("Y")>>4))||1+(![][B5]<<3)):0;t.vars.keyValidityDate=function(e){const t=["January","February","March","April","May","June","July","August","September","October","November","December"][e.getMonth()],n=e.getDate(),r=e.getFullYear();return`${t} ${n}, ${r}`}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */(new Date(864e5*(a+1))),t.template=s>a?"expired":"valid"}else""!==e&&(t.template="invalid");var n;return K5||"valid"===t.template||(console.warn(Y5[t.template](t.vars)),K5=!0),t.template}var q5,Q5,Z5;!function(e){e.Number=class{constructor(e){this.value=e,this.value=k3(this.value,j4(L3(this.value)))}};e.String=class{constructor(e){this.value=e}};e.Boolean=class{constructor(e){this.value=e}};class t{static getSingletonInstance(){return t.instance||(t.instance=new t),t.instance}}e.Empty=t;e.Formula=class{constructor(e){this.formula=e}};e.Error=class{constructor(e,t){this.value=new g4(e,t)}}}(q5||(q5={}));class J5{constructor(e,t,n){this.config=e,this.dateHelper=t,this.numberLiteralsHelper=n}parse(e){if(null==e)return q5.Empty.getSingletonInstance();if("number"==typeof e)return W4(e)?new q5.Error(X9.NUM,W2.ValueLarge):new q5.Number(e);if("boolean"==typeof e)return new q5.Boolean(e);if(e instanceof Date){const t=this.dateHelper.dateToNumber({day:e.getDate(),month:e.getMonth()+1,year:e.getFullYear()})+N5({hours:e.getHours(),minutes:e.getMinutes(),seconds:e.getSeconds()+e.getMilliseconds()/1e3});return t<0?new q5.Error(X9.NUM,W2.DateBounds):t%1==0?new q5.Number(new F3(t,"Date()")):t<1?new q5.Number(new V3(t,"Date()")):new q5.Number(new U3(t,"Date()"))}if("string"==typeof e){if(function(e){const t=e.toLowerCase();return"true"===t||"false"===t}(e))return new q5.Boolean("true"===e.toLowerCase());if(function(e){return e.startsWith("=")}(e))return new q5.Formula(e);if(function(e,t){const n=e.toUpperCase();return/#[A-Za-z0-9\/]+[?!]?/.test(n)&&Object.prototype.hasOwnProperty.call(t,n)}(e,this.config.errorMapping))return new q5.Error(this.config.errorMapping[e.toUpperCase()]);{let t,n=e.trim(),r=0;if(n.endsWith("%"))r=1,n=n.slice(0,n.length-1);else{const e=this.currencyMatcher(n);void 0!==e&&(r=2,[t,n]=e)}const i=this.numberLiteralsHelper.numericStringToMaybeNumber(n);if(void 0!==i){let e;return e=1===r?new B3(i/100):2===r?new D3(i,t):i,new q5.Number(e)}const o=this.dateHelper.dateStringToDateNumber(n);return void 0!==o?new q5.Number(o):new q5.String(e.startsWith("'")?e.slice(1):e)}}throw new p9(e)}currencyMatcher(e){for(const t of this.config.currencySymbol){if(e.startsWith(t))return[t,e.slice(t.length)];if(e.endsWith(t))return[t,e.slice(0,e.length-t.length)]}}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */!function(e){e[e.COPY=0]="COPY",e[e.CUT=1]="CUT"}(Q5||(Q5={})),function(e){e[e.VALUE=0]="VALUE",e[e.EMPTY=1]="EMPTY",e[e.FORMULA=2]="FORMULA",e[e.PARSING_ERROR=3]="PARSING_ERROR"}(Z5||(Z5={}));class e6{constructor(e,t,n,r,i){this.sourceLeftCorner=e,this.width=t,this.height=n,this.type=r,this.content=i}*getContent(e){if(void 0!==this.content)for(let t=0;t<this.height;++t)for(let n=0;n<this.width;++n)yield[v4(e.sheet,e.col+n,e.row+t),this.content[t][n]]}}class t6{constructor(e,t,n){this.dependencyGraph=t,this.operations=n,this.maxRows=e.maxRows,this.maxColumns=e.maxColumns}cut(e,t,n){this.clipboard=new e6(e,t,n,Q5.CUT)}copy(e,t,n){const r=[];for(let i=0;i<n;++i){r[i]=[];for(let n=0;n<t;++n){const t=this.operations.getClipboardCell(v4(e.sheet,e.col+n,e.row+i));r[i].push(t)}}this.clipboard=new e6(e,t,n,Q5.COPY,r)}abortCut(){this.clipboard&&this.clipboard.type===Q5.CUT&&this.clear()}clear(){this.clipboard=void 0}ensureItIsPossibleToCopyPaste(e){if(void 0===this.clipboard)return;if(C4(e)||!this.dependencyGraph.sheetMapping.hasSheetWithId(e.sheet))throw new i9("a valid target address.");const t=M4.spanFrom(e,this.clipboard.width,this.clipboard.height);if(t.exceedsSheetSizeLimits(this.maxColumns,this.maxRows))throw new t9;if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(t))throw new Error("It is not possible to paste onto an array")}isCutClipboard(){return void 0!==this.clipboard&&this.clipboard.type===Q5.CUT}isCopyClipboard(){return void 0!==this.clipboard&&this.clipboard.type===Q5.COPY}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class n6{constructor(e,t,n,r){this.displayName=e,this.address=t,this.added=n,this.options=r}normalizeExpressionName(){return this.displayName.toLowerCase()}copy(){return new n6(this.displayName,this.address,this.added,this.options)}}class r6{constructor(){this.mapping=new Map}has(e){return this.mapping.has(this.normalizeExpressionName(e))}isNameAvailable(e){const t=this.normalizeExpressionName(e),n=this.mapping.get(t);return!(n&&n.added)}add(e){this.mapping.set(e.normalizeExpressionName(),e)}get(e){return this.mapping.get(this.normalizeExpressionName(e))}getExisting(e){const t=this.mapping.get(this.normalizeExpressionName(e));return t&&t.added?t:void 0}remove(e){const t=this.normalizeExpressionName(e),n=this.mapping.get(t);n&&(n.added=!1)}getAllNamedExpressions(){return Array.from(this.mapping.values()).filter((e=>e.added))}normalizeExpressionName(e){return e.toLowerCase()}}class i6{constructor(){this.mapping=new Map}add(e){this.mapping.set(this.normalizeExpressionName(e.displayName),e)}get(e){return this.mapping.get(this.normalizeExpressionName(e))}has(e){return this.mapping.has(this.normalizeExpressionName(e))}getAllNamedExpressions(){return Array.from(this.mapping.values()).filter((e=>e.added))}isNameAvailable(e){const t=this.normalizeExpressionName(e);return!this.mapping.has(t)}remove(e){const t=this.normalizeExpressionName(e);this.mapping.get(t)&&this.mapping.delete(t)}normalizeExpressionName(e){return e.toLowerCase()}}class o6{constructor(){this.nextNamedExpressionRow=0,this.workbookStore=new r6,this.worksheetStores=new Map,this.addressCache=new Map}isNameAvailable(e,t){var n,r;return void 0===t?this.workbookStore.isNameAvailable(e):null===(r=null===(n=this.worksheetStore(t))||void 0===n?void 0:n.isNameAvailable(e))||void 0===r||r}namedExpressionInAddress(e){const t=this.addressCache.get(e);return t&&t.added?t:void 0}namedExpressionForScope(e,t){var n;return void 0===t?this.workbookStore.getExisting(e):null===(n=this.worksheetStore(t))||void 0===n?void 0:n.get(e)}nearestNamedExpression(e,t){var n,r;return null!==(r=null===(n=this.worksheetStore(t))||void 0===n?void 0:n.get(e))&&void 0!==r?r:this.workbookStore.getExisting(e)}isExpressionInScope(e,t){var n,r;return null!==(r=null===(n=this.worksheetStore(t))||void 0===n?void 0:n.has(e))&&void 0!==r&&r}isNameValid(e){const t=new RegExp(`^${jQ}$`),n=new RegExp(`^${$Q}$`),r=new RegExp(`^${KQ}$`);return!t.test(e)&&!n.test(e)&&r.test(e)}addNamedExpression(e,t,n){const r=void 0===t?this.workbookStore:this.worksheetStoreOrCreate(t);let i=r.get(e);return void 0!==i?(i.added=!0,i.displayName=e,i.options=n):(i=new n6(e,this.nextAddress(),!0,n),r.add(i)),this.addressCache.set(i.address.row,i),i}restoreNamedExpression(e,t){const n=void 0===t?this.workbookStore:this.worksheetStoreOrCreate(t);return e.added=!0,n.add(e),this.addressCache.set(e.address.row,e),e}namedExpressionOrPlaceholder(e,t){var n;return null!==(n=this.worksheetStoreOrCreate(t).get(e))&&void 0!==n?n:this.workbookNamedExpressionOrPlaceholder(e)}workbookNamedExpressionOrPlaceholder(e){let t=this.workbookStore.get(e);return void 0===t&&(t=new n6(e,this.nextAddress(),!1),this.workbookStore.add(t)),t}remove(e,t){let n;n=void 0===t?this.workbookStore:this.worksheetStore(t);const r=null==n?void 0:n.get(e);if(void 0===n||void 0===r||!r.added)throw Error("Named expression does not exist");n.remove(e),n instanceof i6&&0===n.mapping.size&&this.worksheetStores.delete(t),this.addressCache.delete(r.address.row)}getAllNamedExpressionsNamesInScope(e){return this.getAllNamedExpressions().filter((({scope:t})=>t===e)).map((e=>e.expression.displayName))}getAllNamedExpressionsNames(){return this.getAllNamedExpressions().map((e=>e.expression.displayName))}getAllNamedExpressions(){const e=[];return this.workbookStore.getAllNamedExpressions().forEach((t=>{e.push({expression:t,scope:void 0})})),this.worksheetStores.forEach(((t,n)=>{t.getAllNamedExpressions().forEach((t=>{e.push({expression:t,scope:n})}))})),e}getAllNamedExpressionsForScope(e){var t,n;return void 0===e?this.workbookStore.getAllNamedExpressions():null!==(n=null===(t=this.worksheetStores.get(e))||void 0===t?void 0:t.getAllNamedExpressions())&&void 0!==n?n:[]}worksheetStoreOrCreate(e){let t=this.worksheetStores.get(e);return t||(t=new i6,this.worksheetStores.set(e,t)),t}worksheetStore(e){return this.worksheetStores.get(e)}nextAddress(){return v4(o6.SHEET_FOR_WORKBOOK_EXPRESSIONS,0,this.nextNamedExpressionRow++)}}o6.SHEET_FOR_WORKBOOK_EXPRESSIONS=-1;const s6=e=>{switch(e.type){case I2.EMPTY:case I2.NUMBER:case I2.STRING:case I2.ERROR:case I2.ERROR_WITH_RAW_INPUT:return!1;case I2.CELL_REFERENCE:return!e.reference.isAbsolute();case I2.CELL_RANGE:case I2.COLUMN_RANGE:case I2.ROW_RANGE:return!e.start.isAbsolute();case I2.NAMED_EXPRESSION:return!1;case I2.PERCENT_OP:case I2.PLUS_UNARY_OP:case I2.MINUS_UNARY_OP:return s6(e.value);case I2.CONCATENATE_OP:case I2.EQUALS_OP:case I2.NOT_EQUAL_OP:case I2.LESS_THAN_OP:case I2.GREATER_THAN_OP:case I2.LESS_THAN_OR_EQUAL_OP:case I2.GREATER_THAN_OR_EQUAL_OP:case I2.MINUS_OP:case I2.PLUS_OP:case I2.TIMES_OP:case I2.DIV_OP:case I2.POWER_OP:return s6(e.left)||s6(e.right);case I2.PARENTHESIS:return s6(e.expression);case I2.FUNCTION_CALL:return e.args.some((e=>s6(e)));case I2.ARRAY:return e.args.some((e=>e.some((e=>s6(e)))))}};
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class a6{performEagerTransformations(e,t){for(const n of e.arrayFormulaNodes()){const[r,i]=this.transformSingleAst(n.getFormula(e.lazilyTransformingAstService),n.getAddress(e.lazilyTransformingAstService)),o=t.rememberNewAst(r);n.setFormula(o),n.setAddress(i)}}transformSingleAst(e,t){return[this.transformAst(e,t),this.fixNodeAddress(t)]}transformAst(e,t){switch(e.type){case I2.CELL_REFERENCE:return this.transformCellReferenceAst(e,t);case I2.CELL_RANGE:return this.transformCellRangeAst(e,t);case I2.COLUMN_RANGE:return this.transformColumnRangeAst(e,t);case I2.ROW_RANGE:return this.transformRowRangeAst(e,t);case I2.EMPTY:case I2.ERROR:case I2.NUMBER:case I2.NAMED_EXPRESSION:case I2.ERROR_WITH_RAW_INPUT:case I2.STRING:return e;case I2.PERCENT_OP:case I2.MINUS_UNARY_OP:case I2.PLUS_UNARY_OP:return Object.assign(Object.assign({},e),{value:this.transformAst(e.value,t)});case I2.FUNCTION_CALL:return Object.assign(Object.assign({},e),{procedureName:e.procedureName,args:e.args.map((e=>this.transformAst(e,t)))});case I2.PARENTHESIS:return Object.assign(Object.assign({},e),{expression:this.transformAst(e.expression,t)});case I2.ARRAY:return Object.assign(Object.assign({},e),{args:e.args.map((e=>e.map((e=>this.transformAst(e,t)))))});default:return Object.assign(Object.assign({},e),{left:this.transformAst(e.left,t),right:this.transformAst(e.right,t)})}}transformCellReferenceAst(e,t){const n=this.transformCellAddress(e.reference,t);return n instanceof kQ?Object.assign(Object.assign({},e),{reference:n}):n===X9.REF?L2(new g4(X9.REF)):e}transformCellRangeAst(e,t){const n=this.transformCellRange(e.start,e.end,t);return Array.isArray(n)?Object.assign(Object.assign({},e),{start:n[0],end:n[1]}):n===X9.REF?L2(new g4(X9.REF)):e}transformColumnRangeAst(e,t){const n=this.transformColumnRange(e.start,e.end,t);return Array.isArray(n)?Object.assign(Object.assign({},e),{start:n[0],end:n[1]}):n===X9.REF?L2(new g4(X9.REF)):e}transformRowRangeAst(e,t){const n=this.transformRowRange(e.start,e.end,t);return Array.isArray(n)?Object.assign(Object.assign({},e),{start:n[0],end:n[1]}):n===X9.REF?L2(new g4(X9.REF)):e}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class l6 extends a6{constructor(e){super(),this.columnsSpan=e}get sheet(){return this.columnsSpan.sheet}isIrreversible(){return!1}transformRowRangeAst(e,t){return e}transformCellRange(e,t,n){return this.transformRange(e,t,n)}transformRowRange(e,t,n){throw Error("Not implemented")}transformColumnRange(e,t,n){return this.transformRange(e,t,n)}transformCellAddress(e,t){const n=b4(e,t);if(n!==this.columnsSpan.sheet&&t.sheet!==this.columnsSpan.sheet)return!1;const r=e.toSimpleColumnAddress(t);if(n===this.columnsSpan.sheet&&t.sheet!==this.columnsSpan.sheet)return this.columnsSpan.columnStart<=r.col&&e.shiftedByColumns(this.columnsSpan.numberOfColumns);if(t.sheet===this.columnsSpan.sheet&&n!==this.columnsSpan.sheet)return!e.isColumnAbsolute()&&(!(t.col<this.columnsSpan.columnStart)&&e.shiftedByColumns(-this.columnsSpan.numberOfColumns));if(e.isColumnAbsolute())return!(e.col<this.columnsSpan.columnStart)&&e.shiftedByColumns(this.columnsSpan.numberOfColumns);return e.toSimpleColumnAddress(t).col<this.columnsSpan.columnStart?!(t.col<this.columnsSpan.columnStart)&&e.shiftedByColumns(-this.columnsSpan.numberOfColumns):t.col<this.columnsSpan.columnStart&&e.shiftedByColumns(this.columnsSpan.numberOfColumns)}fixNodeAddress(e){return this.columnsSpan.sheet===e.sheet&&this.columnsSpan.columnStart<=e.col?Object.assign(Object.assign({},e),{col:e.col+this.columnsSpan.numberOfColumns}):e}transformRange(e,t,n){const r=this.transformCellAddress(e,n),i=this.transformCellAddress(t,n);return r===X9.REF||i===X9.REF?X9.REF:!(!r&&!i)&&[r||e,i||t]}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class h6 extends a6{constructor(e){super(),this.rowsSpan=e}get sheet(){return this.rowsSpan.sheet}isIrreversible(){return!1}transformColumnRangeAst(e,t){return e}transformCellRange(e,t,n){return this.transformRange(e,t,n)}transformRowRange(e,t,n){return this.transformRange(e,t,n)}transformColumnRange(e,t,n){throw Error("Not implemented")}transformCellAddress(e,t){const n=b4(e,t);if(n!==this.rowsSpan.sheet&&t.sheet!==this.rowsSpan.sheet)return!1;const r=e.toSimpleRowAddress(t);return n===this.rowsSpan.sheet&&t.sheet!==this.rowsSpan.sheet?this.rowsSpan.rowStart<=r.row&&e.shiftedByRows(this.rowsSpan.numberOfRows):t.sheet===this.rowsSpan.sheet&&n!==this.rowsSpan.sheet?!e.isRowAbsolute()&&(!(t.row<this.rowsSpan.rowStart)&&e.shiftedByRows(-this.rowsSpan.numberOfRows)):e.isRowAbsolute()?!(e.row<this.rowsSpan.rowStart)&&e.shiftedByRows(this.rowsSpan.numberOfRows):r.row<this.rowsSpan.rowStart?!(t.row<this.rowsSpan.rowStart)&&e.shiftedByRows(-this.rowsSpan.numberOfRows):t.row<this.rowsSpan.rowStart&&e.shiftedByRows(this.rowsSpan.numberOfRows)}fixNodeAddress(e){return this.rowsSpan.sheet===e.sheet&&this.rowsSpan.rowStart<=e.row?Object.assign(Object.assign({},e),{row:e.row+this.rowsSpan.numberOfRows}):e}transformRange(e,t,n){const r=this.transformCellAddress(e,n),i=this.transformCellAddress(t,n);return r===X9.REF||i===X9.REF?X9.REF:!(!r&&!i)&&[r||e,i||t]}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class u6 extends a6{constructor(e){super(),this.sheet=e}isIrreversible(){return!0}fixNodeAddress(e){return e}transformCellAddress(e,t){return!!e.isInvalid(t)&&X9.REF}transformCellRange(e,t,n){return!(!e.isInvalid(n)&&!t.isInvalid(n))&&X9.REF}transformColumnRange(e,t,n){return!(!e.isInvalid(n)&&!t.isInvalid(n))&&X9.REF}transformRowRange(e,t,n){return!(!e.isInvalid(n)&&!t.isInvalid(n))&&X9.REF}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class c6 extends a6{constructor(e,t,n,r){super(),this.sourceRange=e,this.toRight=t,this.toBottom=n,this.toSheet=r,this.dependentFormulaTransformer=new d6(e,t,n,r)}get sheet(){return this.sourceRange.sheet}isIrreversible(){return!0}transformSingleAst(e,t){if(this.sourceRange.addressInRange(t)){return[this.transformAst(e,t),this.fixNodeAddress(t)]}return this.dependentFormulaTransformer.transformSingleAst(e,t)}fixNodeAddress(e){return v4(this.toSheet,e.col+this.toRight,e.row+this.toBottom)}transformCellAddress(e,t){return this.transformAddress(e,t)}transformCellRange(e,t,n){return this.transformRange(e,t,n)}transformColumnRange(e,t,n){return this.transformRange(e,t,n)}transformRowRange(e,t,n){return this.transformRange(e,t,n)}transformAddress(e,t){const n=this.sourceRange;if(e instanceof kQ){const r=e.toSimpleCellAddress(t);if(n.addressInRange(r))return e.shiftAbsoluteDimensions(this.toRight,this.toBottom)}return e.shiftRelativeDimensions(-this.toRight,-this.toBottom)}transformRange(e,t,n){const r=this.sourceRange;if(e instanceof kQ&&t instanceof kQ){const i=e.toSimpleCellAddress(n),o=t.toSimpleCellAddress(n);if(r.addressInRange(i)&&r.addressInRange(o))return[e.shiftAbsoluteDimensions(this.toRight,this.toBottom),t.shiftAbsoluteDimensions(this.toRight,this.toBottom)]}return[e.shiftRelativeDimensions(-this.toRight,-this.toBottom),t.shiftRelativeDimensions(-this.toRight,-this.toBottom)]}}class d6 extends a6{constructor(e,t,n,r){super(),this.sourceRange=e,this.toRight=t,this.toBottom=n,this.toSheet=r}get sheet(){return this.sourceRange.sheet}isIrreversible(){return!0}fixNodeAddress(e){return e}transformCellAddress(e,t){return!!this.shouldMove(e,t)&&e.moved(this.toSheet,this.toRight,this.toBottom)}transformCellRange(e,t,n){return this.transformRange(e,t,n)}transformColumnRange(e,t,n){return this.transformRange(e,t,n)}transformRowRange(e,t,n){return this.transformRange(e,t,n)}shouldMove(e,t){return e instanceof kQ?this.sourceRange.addressInRange(e.toSimpleCellAddress(t)):e instanceof HQ?this.sourceRange.rowInRange(e.toSimpleRowAddress(t))&&!this.sourceRange.isFinite():this.sourceRange.columnInRange(e.toSimpleColumnAddress(t))&&!this.sourceRange.isFinite()}transformRange(e,t,n){const r=this.transformCellAddress(e,n),i=this.transformCellAddress(t,n);return!(!r||!i)&&[r,i]}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class p6 extends a6{constructor(e){super(),this.columnsSpan=e}get sheet(){return this.columnsSpan.sheet}isIrreversible(){return!0}transformRowRangeAst(e,t){return e}transformCellRange(e,t,n){return this.transformRange(e,t,n)}transformRowRange(e,t,n){throw Error("Not implemented")}transformColumnRange(e,t,n){return this.transformRange(e,t,n)}transformCellAddress(e,t){const n=b4(e,t);if(this.columnsSpan.sheet!==t.sheet&&this.columnsSpan.sheet!==n)return!1;if(this.columnsSpan.sheet!==t.sheet&&this.columnsSpan.sheet===n){const n=e.toSimpleColumnAddress(t);if(n.col<this.columnsSpan.columnStart)return!1;if(n.col>this.columnsSpan.columnEnd)return e.shiftedByColumns(-this.columnsSpan.numberOfColumns)}if(this.columnsSpan.sheet===t.sheet&&this.columnsSpan.sheet!==n){if(e.isColumnAbsolute())return!1;if(t.col<this.columnsSpan.columnStart)return!1;if(t.col>this.columnsSpan.columnEnd)return e.shiftedByColumns(this.columnsSpan.numberOfColumns)}if(this.columnsSpan.sheet===t.sheet&&this.columnsSpan.sheet===n)if(e.isColumnAbsolute()){if(e.col<this.columnsSpan.columnStart)return!1;if(e.col>this.columnsSpan.columnEnd)return e.shiftedByColumns(-this.columnsSpan.numberOfColumns)}else{const n=e.toSimpleColumnAddress(t);if(n.col<this.columnsSpan.columnStart){if(t.col<this.columnsSpan.columnStart)return!1;if(t.col>this.columnsSpan.columnEnd)return e.shiftedByColumns(this.columnsSpan.numberOfColumns)}else if(n.col>this.columnsSpan.columnEnd){if(t.col<this.columnsSpan.columnStart)return e.shiftedByColumns(-this.columnsSpan.numberOfColumns);if(t.col>this.columnsSpan.columnEnd)return!1}}return X9.REF}fixNodeAddress(e){return this.columnsSpan.sheet===e.sheet&&this.columnsSpan.columnStart<=e.col?Object.assign(Object.assign({},e),{col:e.col-this.columnsSpan.numberOfColumns}):e}transformRange(e,t,n){const r=b4(e,n);let i=e,o=t;if(this.columnsSpan.sheet===r){const r=e.toSimpleColumnAddress(n),s=t.toSimpleColumnAddress(n);if(this.columnsSpan.columnStart<=r.col&&this.columnsSpan.columnEnd>=s.col)return X9.REF;r.col>=this.columnsSpan.columnStart&&r.col<=this.columnsSpan.columnEnd&&(i=e.shiftedByColumns(this.columnsSpan.columnEnd-r.col+1)),s.col>=this.columnsSpan.columnStart&&s.col<=this.columnsSpan.columnEnd&&(o=t.shiftedByColumns(-(s.col-this.columnsSpan.columnStart+1)))}const s=this.transformCellAddress(i,n),a=this.transformCellAddress(o,n);if(!1===s&&!1===a)return[i,o];if(s===X9.REF||a===X9.REF)throw Error("Cannot happen");return[s||i,a||o]}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class g6 extends a6{constructor(e){super(),this.rowsSpan=e}get sheet(){return this.rowsSpan.sheet}isIrreversible(){return!0}transformColumnRangeAst(e,t){return e}transformCellAddress(e,t){const n=b4(e,t);if(this.rowsSpan.sheet!==t.sheet&&this.rowsSpan.sheet!==n)return!1;if(this.rowsSpan.sheet!==t.sheet&&this.rowsSpan.sheet===n){const n=e.toSimpleRowAddress(t);if(n.row<this.rowsSpan.rowStart)return!1;if(n.row>this.rowsSpan.rowEnd)return e.shiftedByRows(-this.rowsSpan.numberOfRows)}if(this.rowsSpan.sheet===t.sheet&&this.rowsSpan.sheet!==n){if(e.isRowAbsolute())return!1;if(t.row<this.rowsSpan.rowStart)return!1;if(t.row>this.rowsSpan.rowEnd)return e.shiftedByRows(this.rowsSpan.numberOfRows)}if(this.rowsSpan.sheet===t.sheet&&this.rowsSpan.sheet===n)if(e.isRowAbsolute()){if(e.row<this.rowsSpan.rowStart)return!1;if(e.row>this.rowsSpan.rowEnd)return e.shiftedByRows(-this.rowsSpan.numberOfRows)}else{const n=e.toSimpleRowAddress(t);if(n.row<this.rowsSpan.rowStart){if(t.row<this.rowsSpan.rowStart)return!1;if(t.row>this.rowsSpan.rowEnd)return e.shiftedByRows(this.rowsSpan.numberOfRows)}else if(n.row>this.rowsSpan.rowEnd){if(t.row<this.rowsSpan.rowStart)return e.shiftedByRows(-this.rowsSpan.numberOfRows);if(t.row>this.rowsSpan.rowEnd)return!1}}return X9.REF}transformCellRange(e,t,n){return this.transformRange(e,t,n)}transformRowRange(e,t,n){return this.transformRange(e,t,n)}transformColumnRange(e,t,n){throw Error("Not implemented")}fixNodeAddress(e){return this.rowsSpan.sheet===e.sheet&&this.rowsSpan.rowStart<=e.row?Object.assign(Object.assign({},e),{row:e.row-this.rowsSpan.numberOfRows}):e}transformRange(e,t,n){const r=b4(e,n);let i=e,o=t;if(this.rowsSpan.sheet===r){const r=e.toSimpleRowAddress(n),s=t.toSimpleRowAddress(n);if(this.rowsSpan.rowStart<=r.row&&this.rowsSpan.rowEnd>=s.row)return X9.REF;r.row>=this.rowsSpan.rowStart&&r.row<=this.rowsSpan.rowEnd&&(i=e.shiftedByRows(this.rowsSpan.rowEnd-r.row+1)),s.row>=this.rowsSpan.rowStart&&s.row<=this.rowsSpan.rowEnd&&(o=t.shiftedByRows(-(s.row-this.rowsSpan.rowStart+1)))}const s=this.transformCellAddress(i,n),a=this.transformCellAddress(o,n);return!1===s&&!1===a?[i,o]:s===X9.REF||a===X9.REF?X9.REF:[s||i,a||o]}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class m6 extends a6{constructor(e){super(),this.sheet=e}isIrreversible(){return!0}performEagerTransformations(e,t){for(const n of e.arrayFormulaNodes()){const[t]=this.transformSingleAst(n.getFormula(e.lazilyTransformingAstService),n.getAddress(e.lazilyTransformingAstService));n.setFormula(t)}}fixNodeAddress(e){return e}transformCellAddress(e,t){return this.transformAddress(e)}transformCellRange(e,t,n){return this.transformAddress(e)}transformColumnRange(e,t,n){return this.transformAddress(e)}transformRowRange(e,t,n){return this.transformAddress(e)}transformAddress(e){return e.sheet===this.sheet&&X9.REF}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */function f6(e){if(!Array.isArray(e))throw new i9("an array of arrays.");for(let t=0;t<e.length;t++)if(!Array.isArray(e[t]))throw new i9("an array of arrays.")}function w6(e){let t=0,n=0,r=0;for(let o=0;o<e.length;o++){let i=0;for(let t=0;t<e[o].length;t++){const n=e[o][t];null!=n&&(i=t+1,++r)}t=Math.max(t,i),i>0&&(n=o+1)}const i=t*n;return{height:n,width:t,fill:0===i?0:r/i}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class y6{constructor(e,t){this.sheet=e,this.indexes=t}normalizedIndexes(){return E6(this.indexes)}rowsSpans(){return this.normalizedIndexes().map((e=>K3.fromNumberOfRows(this.sheet,e[0],e[1])))}}class v6{constructor(e,t){this.sheet=e,this.indexes=t}normalizedIndexes(){return b6(this.indexes)}rowsSpans(){return this.normalizedIndexes().map((e=>K3.fromNumberOfRows(this.sheet,e[0],e[1])))}}class C6{constructor(e,t){this.sheet=e,this.indexes=t}normalizedIndexes(){return b6(this.indexes)}columnsSpans(){return this.normalizedIndexes().map((e=>X3.fromNumberOfColumns(this.sheet,e[0],e[1])))}}class S6{constructor(e,t){this.sheet=e,this.indexes=t}normalizedIndexes(){return E6(this.indexes)}columnsSpans(){return this.normalizedIndexes().map((e=>X3.fromNumberOfColumns(this.sheet,e[0],e[1])))}}class R6{constructor(e,t,n,r,i,o,s,a,l){this.dependencyGraph=t,this.columnSearch=n,this.cellContentParser=r,this.parser=i,this.stats=o,this.lazilyTransformingAstService=s,this.namedExpressions=a,this.arraySizePredictor=l,this.changes=Y3.empty(),this.allocateNamedExpressionAddressSpace(),this.maxColumns=e.maxColumns,this.maxRows=e.maxRows}get sheetMapping(){return this.dependencyGraph.sheetMapping}get addressMapping(){return this.dependencyGraph.addressMapping}removeRows(e){const t=[];for(const n of e.rowsSpans()){const e=this.doRemoveRows(n);e&&t.push(e)}return t}addRows(e){for(const t of e.rowsSpans())this.doAddRows(t)}addColumns(e){for(const t of e.columnsSpans())this.doAddColumns(t)}removeColumns(e){const t=[];for(const n of e.columnsSpans()){const e=this.doRemoveColumns(n);e&&t.push(e)}return t}removeSheet(e){this.dependencyGraph.removeSheet(e);let t=0;this.stats.measure(G3.TRANSFORM_ASTS,(()=>{const n=new m6(e);n.performEagerTransformations(this.dependencyGraph,this.parser),t=this.lazilyTransformingAstService.addTransformation(n)})),this.sheetMapping.removeSheet(e),this.columnSearch.removeSheet(e);const n=this.namedExpressions.getAllNamedExpressionsForScope(e).map((t=>this.removeNamedExpression(t.normalizeExpressionName(),e)));return{version:t,scopedNamedExpressions:n}}removeSheetByName(e){const t=this.sheetMapping.fetch(e);return this.removeSheet(t)}clearSheet(e){this.dependencyGraph.clearSheet(e),this.columnSearch.removeSheet(e)}addSheet(e){const t=this.sheetMapping.addSheet(e);return this.dependencyGraph.addressMapping.autoAddSheet(t,w6([])),this.sheetMapping.fetchDisplayName(t)}renameSheet(e,t){return this.sheetMapping.renameSheet(e,t)}moveRows(e,t,n,r){const i=K3.fromNumberOfRows(e,r,n);this.lazilyTransformingAstService.beginCombinedMode(e),this.doAddRows(i),r<t&&(t+=n);const o=v4(e,0,t),s=v4(e,0,r);this.moveCells(o,Number.POSITIVE_INFINITY,n,s);const a=K3.fromNumberOfRows(e,t,n);return this.doRemoveRows(a),this.lazilyTransformingAstService.commitCombinedMode()}moveColumns(e,t,n,r){const i=X3.fromNumberOfColumns(e,r,n);this.lazilyTransformingAstService.beginCombinedMode(e),this.doAddColumns(i),r<t&&(t+=n);const o=v4(e,t,0),s=v4(e,r,0);this.moveCells(o,n,Number.POSITIVE_INFINITY,s);const a=X3.fromNumberOfColumns(e,t,n);return this.doRemoveColumns(a),this.lazilyTransformingAstService.commitCombinedMode()}moveCells(e,t,n,r){this.ensureItIsPossibleToMoveCells(e,t,n,r);const i=M4.spanFrom(e,t,n),o=M4.spanFrom(r,t,n),s=r.col-e.col,a=r.row-e.row,l=r.sheet,h=this.getRangeClipboardCells(o),u=this.dependencyGraph.rawValuesFromRange(o);this.columnSearch.removeValues(u);const c=this.dependencyGraph.rawValuesFromRange(i);this.columnSearch.moveValues(c,s,a,l);let d=0;this.stats.measure(G3.TRANSFORM_ASTS,(()=>{const e=new c6(i,s,a,l);e.performEagerTransformations(this.dependencyGraph,this.parser),d=this.lazilyTransformingAstService.addTransformation(e)})),this.dependencyGraph.moveCells(i,s,a,l);const p=this.updateNamedExpressionsForMovedCells(e,t,n,r);return{version:d,overwrittenCellsData:h,addedGlobalNamedExpressions:p}}setRowOrder(e,t){const n=[];let r=[];for(const[i,o]of t)if(i!==o){const t=M4.spanFrom({sheet:e,col:0,row:i},1/0,1),s=this.getRangeClipboardCells(t);r=r.concat(s),n.push(s.map((([{sheet:e,col:t},n])=>[{sheet:e,col:t,row:o},n])))}return n.forEach((t=>this.restoreClipboardCells(e,t.values()))),r}setColumnOrder(e,t){const n=[];let r=[];for(const[i,o]of t)if(i!==o){const t=M4.spanFrom({sheet:e,col:i,row:0},1,1/0),s=this.getRangeClipboardCells(t);r=r.concat(s),n.push(s.map((([{sheet:e,col:t,row:n},r])=>[{sheet:e,col:o,row:n},r])))}return n.forEach((t=>this.restoreClipboardCells(e,t.values()))),r}addNamedExpression(e,t,n,r){const i=this.namedExpressions.addNamedExpression(e,n,r);this.storeNamedExpressionInCell(i.address,t),this.adjustNamedExpressionEdges(i,e,n)}restoreNamedExpression(e,t,n){const r=e.displayName;this.restoreCell(e.address,t);const i=this.namedExpressions.restoreNamedExpression(e,n);this.adjustNamedExpressionEdges(i,r,n)}changeNamedExpressionExpression(e,t,n,r){const i=this.namedExpressions.namedExpressionForScope(e,n);if(!i)throw new l9(e);const o=i.copy();i.options=r;const s=this.getClipboardCell(i.address);return this.storeNamedExpressionInCell(i.address,t),[o,s]}removeNamedExpression(e,t){const n=this.namedExpressions.namedExpressionForScope(e,t);if(!n)throw new l9(e);this.namedExpressions.remove(n.displayName,t);const r=this.getClipboardCell(n.address);if(void 0!==t){const t=this.namedExpressions.workbookNamedExpressionOrPlaceholder(e);this.dependencyGraph.exchangeNode(n.address,t.address)}else this.dependencyGraph.setCellEmpty(n.address);return[n,r]}ensureItIsPossibleToMoveCells(e,t,n,r){if(C4(e)||!(T6(t)&&T6(n)||function(e,t,n){return 0===e.row&&T6(t)&&n===Number.POSITIVE_INFINITY||0===e.col&&T6(n)&&t===Number.POSITIVE_INFINITY}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */(e,t,n))||C4(r)||!this.sheetMapping.hasSheetWithId(e.sheet)||!this.sheetMapping.hasSheetWithId(r.sheet))throw new i9("a valid range of cells to move.");const i=M4.spanFrom(e,t,n),o=M4.spanFrom(r,t,n);if(o.exceedsSheetSizeLimits(this.maxColumns,this.maxRows))throw new t9;if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(i))throw new N9;if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(o))throw new A9}restoreClipboardCells(e,t){const n=[];for(const[r,i]of t)if(this.restoreCell(r,i),i.type===Z5.FORMULA){const{dependencies:t}=this.parser.fetchCachedResult(i.hash);n.push(...this.updateNamedExpressionsForTargetAddress(e,r,t))}return n}restoreCell(e,t){switch(t.type){case Z5.VALUE:this.setValueToCell(t,e);break;case Z5.FORMULA:this.setFormulaToCellFromCache(t.hash,e);break;case Z5.EMPTY:this.setCellEmpty(e);break;case Z5.PARSING_ERROR:this.setParsingErrorToCell(t.rawInput,t.errors,e)}}getOldContent(e){const t=this.dependencyGraph.getCell(e);if(void 0===t||t instanceof t4)return[e,{type:Z5.EMPTY}];if(t instanceof n4)return[e,Object.assign({type:Z5.VALUE},t.getValues())];if(t instanceof H9)return[t.getAddress(this.lazilyTransformingAstService),{type:Z5.FORMULA,hash:this.parser.computeHashFromAst(t.getFormula(this.lazilyTransformingAstService))}];if(t instanceof r4)return[e,{type:Z5.PARSING_ERROR,rawInput:t.rawInput,errors:t.errors}];throw Error("Trying to copy unsupported type")}getClipboardCell(e){const t=this.dependencyGraph.getCell(e);if(void 0===t||t instanceof t4)return{type:Z5.EMPTY};if(t instanceof n4)return Object.assign({type:Z5.VALUE},t.getValues());if(t instanceof k9){const n=t.getArrayCellValue(e);return n===_3?{type:Z5.EMPTY}:{type:Z5.VALUE,parsedValue:n,rawValue:t.getArrayCellRawValue(e)}}if(t instanceof F9)return{type:Z5.FORMULA,hash:this.parser.computeHashFromAst(t.getFormula(this.lazilyTransformingAstService))};if(t instanceof r4)return{type:Z5.PARSING_ERROR,rawInput:t.rawInput,errors:t.errors};throw Error("Trying to copy unsupported type")}getSheetClipboardCells(e){const t=this.dependencyGraph.getSheetHeight(e),n=this.dependencyGraph.getSheetWidth(e),r=new Array(t);for(let i=0;i<t;i++){r[i]=new Array(n);for(let t=0;t<n;t++){const n=v4(e,t,i);r[i][t]=this.getClipboardCell(n)}}return r}getRangeClipboardCells(e){const t=[];for(const n of e.addresses(this.dependencyGraph))t.push([n,this.getClipboardCell(n)]);return t}setCellContent(e,t){const n=this.cellContentParser.parse(t),r=this.getOldContent(e);if(n instanceof q5.Formula){const t=this.parser.parse(n.formula,e),{ast:r,errors:i}=t;if(i.length>0)this.setParsingErrorToCell(n.formula,i,e);else try{const n=this.arraySizePredictor.checkArraySize(r,e);if(n.width<=0||n.height<=0)throw Error("Incorrect array size");this.setFormulaToCell(e,n,t)}catch(xm){if(!xm.message)throw xm;const r={type:M2.InvalidRangeSize,message:"Invalid range size."};this.setParsingErrorToCell(n.formula,[r],e)}}else n instanceof q5.Empty?this.setCellEmpty(e):this.setValueToCell({parsedValue:n.value,rawValue:t},e);return r}setSheetContent(e,t){this.clearSheet(e);for(let n=0;n<t.length;n++)for(let r=0;r<t[n].length;r++){const i=v4(e,r,n);this.setCellContent(i,t[n][r])}}setParsingErrorToCell(e,t,n){const r=this.dependencyGraph.getCellValue(n),i=new r4(t,e),o=this.dependencyGraph.setParsingErrorToCell(n,i);this.columnSearch.remove(L3(r),n),this.columnSearch.applyChanges(o.getChanges()),this.changes.addAll(o),this.changes.addChange(i.getCellValue(),n)}setFormulaToCell(e,t,{ast:n,hasVolatileFunction:r,hasStructuralChangeFunction:i,dependencies:o}){const s=this.dependencyGraph.getCellValue(e),a=this.dependencyGraph.setFormulaToCell(e,n,P3(o,e),t,r,i);this.columnSearch.remove(L3(s),e),this.columnSearch.applyChanges(a.getChanges()),this.changes.addAll(a)}setValueToCell(e,t){const n=this.dependencyGraph.getCellValue(t),r=this.dependencyGraph.setValueToCell(t,e);this.columnSearch.change(L3(n),L3(e.parsedValue),t),this.columnSearch.applyChanges(r.getChanges().filter((e=>!T4(e.address,t)))),this.changes.addAll(r),this.changes.addChange(e.parsedValue,t)}setCellEmpty(e){if(this.dependencyGraph.isArrayInternalCell(e))return;const t=this.dependencyGraph.getCellValue(e),n=this.dependencyGraph.setCellEmpty(e);this.columnSearch.remove(L3(t),e),this.columnSearch.applyChanges(n.getChanges()),this.changes.addAll(n),this.changes.addChange(_3,e)}setFormulaToCellFromCache(e,t){const{ast:n,hasVolatileFunction:r,hasStructuralChangeFunction:i,dependencies:o}=this.parser.fetchCachedResult(e),s=P3(o,t),[a]=new u6(t.sheet).transformSingleAst(n,t);this.parser.rememberNewAst(a);const l=s.filter((e=>e instanceof x3||(e instanceof M4?!(C4(e.start)||C4(e.end)):!C4(e))));const h=this.arraySizePredictor.checkArraySize(n,t);this.dependencyGraph.setFormulaToCell(t,a,l,h,r,i)}rowEffectivelyNotInSheet(e,t){return e>=this.dependencyGraph.addressMapping.getHeight(t)}getAndClearContentChanges(){const e=this.changes;return this.changes=Y3.empty(),e}forceApplyPostponedTransformations(){this.dependencyGraph.forceApplyPostponedTransformations()}doRemoveRows(e){if(this.rowEffectivelyNotInSheet(e.rowStart,e.sheet))return;const t=[];for(const[o]of this.dependencyGraph.entriesFromRowsSpan(e))t.push({address:o,cellType:this.getClipboardCell(o)});const{affectedArrays:n,contentChanges:r}=this.dependencyGraph.removeRows(e);this.columnSearch.applyChanges(r.getChanges());let i=0;return this.stats.measure(G3.TRANSFORM_ASTS,(()=>{const t=new g6(e);t.performEagerTransformations(this.dependencyGraph,this.parser),i=this.lazilyTransformingAstService.addTransformation(t)})),this.rewriteAffectedArrays(n),{version:i,removedCells:t,rowFrom:e.rowStart,rowCount:e.numberOfRows}}doRemoveColumns(e){if(this.columnEffectivelyNotInSheet(e.columnStart,e.sheet))return;const t=[];for(const[o]of this.dependencyGraph.entriesFromColumnsSpan(e))t.push({address:o,cellType:this.getClipboardCell(o)});const{affectedArrays:n,contentChanges:r}=this.dependencyGraph.removeColumns(e);this.columnSearch.applyChanges(r.getChanges()),this.columnSearch.removeColumns(e);let i=0;return this.stats.measure(G3.TRANSFORM_ASTS,(()=>{const t=new p6(e);t.performEagerTransformations(this.dependencyGraph,this.parser),i=this.lazilyTransformingAstService.addTransformation(t)})),this.rewriteAffectedArrays(n),{version:i,removedCells:t,columnFrom:e.columnStart,columnCount:e.numberOfColumns}}doAddRows(e){if(this.rowEffectivelyNotInSheet(e.rowStart,e.sheet))return;const{affectedArrays:t}=this.dependencyGraph.addRows(e);this.stats.measure(G3.TRANSFORM_ASTS,(()=>{const t=new h6(e);t.performEagerTransformations(this.dependencyGraph,this.parser),this.lazilyTransformingAstService.addTransformation(t)})),this.rewriteAffectedArrays(t)}rewriteAffectedArrays(e){for(const t of e.values()){if(t.array.size.isRef)continue;const e=t.getFormula(this.lazilyTransformingAstService),n=t.getAddress(this.lazilyTransformingAstService),r=this.parser.computeHashFromAst(e);this.setFormulaToCellFromCache(r,n)}}doAddColumns(e){if(this.columnEffectivelyNotInSheet(e.columnStart,e.sheet))return;const{affectedArrays:t,contentChanges:n}=this.dependencyGraph.addColumns(e);this.columnSearch.addColumns(e),this.columnSearch.applyChanges(n.getChanges()),this.stats.measure(G3.TRANSFORM_ASTS,(()=>{const t=new l6(e);t.performEagerTransformations(this.dependencyGraph,this.parser),this.lazilyTransformingAstService.addTransformation(t)})),this.rewriteAffectedArrays(t)}columnEffectivelyNotInSheet(e,t){return e>=this.dependencyGraph.addressMapping.getWidth(t)}adjustNamedExpressionEdges(e,t,n){if(void 0===n)return;const{vertex:r,id:i}=this.dependencyGraph.fetchCellOrCreateEmpty(e.address),o=null!=i?i:this.dependencyGraph.graph.getNodeId(r),s=this.namedExpressions.workbookNamedExpressionOrPlaceholder(t),{vertex:a,id:l}=this.dependencyGraph.fetchCellOrCreateEmpty(s.address),h=null!=l?l:this.dependencyGraph.graph.getNodeId(a);for(const u of this.dependencyGraph.graph.adjacentNodes(a))if(u instanceof F9&&u.getAddress(this.lazilyTransformingAstService).sheet===n){const t=u.getFormula(this.lazilyTransformingAstService),n=u.getAddress(this.lazilyTransformingAstService),{dependencies:r}=this.parser.fetchCachedResultForAst(t);for(const i of P3(r,n))i instanceof x3&&i.name.toLowerCase()===e.displayName.toLowerCase()&&(this.dependencyGraph.graph.removeEdge(h,u),this.dependencyGraph.graph.addEdge(o,u))}}storeNamedExpressionInCell(e,t){const n=this.cellContentParser.parse(t);if(n instanceof q5.Formula){const t=this.parser.parse(n.formula,v4(-1,0,0));if(s6(t.ast))throw new M9;const{ast:r,hasVolatileFunction:i,hasStructuralChangeFunction:o,dependencies:s}=t;this.dependencyGraph.setFormulaToCell(e,r,P3(s,e),e5.scalar(),i,o)}else n instanceof q5.Empty?this.setCellEmpty(e):this.setValueToCell({parsedValue:n.value,rawValue:t},e)}updateNamedExpressionsForMovedCells(e,t,n,r){if(e.sheet===r.sheet)return[];const i=[],o=M4.spanFrom(r,t,n);for(const s of o.addresses(this.dependencyGraph)){const t=this.addressMapping.fetchCell(s);if(t instanceof F9&&s.sheet!==e.sheet){const n=t.getFormula(this.lazilyTransformingAstService),{dependencies:r}=this.parser.fetchCachedResultForAst(n);i.push(...this.updateNamedExpressionsForTargetAddress(e.sheet,s,r))}}return i}updateNamedExpressionsForTargetAddress(e,t,n){if(e===t.sheet)return[];const r=[],i=this.addressMapping.fetchCell(t);for(const o of P3(n,t)){if(!(o instanceof x3))continue;const n=o.name,s=this.dependencyGraph.fetchNamedExpressionVertex(n,e).vertex,a=this.namedExpressions.isExpressionInScope(n,t.sheet)?this.dependencyGraph.fetchNamedExpressionVertex(n,t.sheet).vertex:this.copyOrFetchGlobalNamedExpressionVertex(n,s,r);a!==s&&(this.dependencyGraph.graph.removeEdgeIfExists(s,i),this.dependencyGraph.graph.addEdge(a,i))}return r}allocateNamedExpressionAddressSpace(){this.dependencyGraph.addressMapping.addSheet(o6.SHEET_FOR_WORKBOOK_EXPRESSIONS,new i4(0,0))}copyOrFetchGlobalNamedExpressionVertex(e,t,n){let r=this.namedExpressions.namedExpressionForScope(e);if(void 0===r)if(r=this.namedExpressions.addNamedExpression(e),n.push(r.normalizeExpressionName()),t instanceof F9){const e=this.parser.fetchCachedResultForAst(t.getFormula(this.lazilyTransformingAstService)),{ast:n,hasVolatileFunction:i,hasStructuralChangeFunction:o,dependencies:s}=e;this.dependencyGraph.setFormulaToCell(r.address,n,P3(s,r.address),e5.scalar(),i,o)}else t instanceof t4?this.setCellEmpty(r.address):t instanceof n4&&this.setValueToCell(t.getValues(),r.address);return this.dependencyGraph.fetchCellOrCreateEmpty(r.address).vertex}}function E6(e){if(e.length<=1)return e;const t=[...e].sort((([e],[t])=>e-t)),n=t.reduce(((e,[t,n])=>{const r=e[e.length-1],i=r[0]+r[1];return t<=i?r[1]+=Math.max(0,n-(i-t)):e.push([t,n]),e}),[t[0]]);let r=0;for(let i=0;i<n.length;++i)n[i][0]-=r,r+=n[i][1];return n}function b6(e){if(e.length<=1)return e;const t=[...e].sort((([e],[t])=>e-t)),n=t.reduce(((e,[t,n])=>{const r=e[e.length-1];return t===r[0]?r[1]=Math.max(r[1],n):e.push([t,n]),e}),[t[0]]);let r=0;for(let i=0;i<n.length;++i)n[i][0]+=r,r+=n[i][1];return n}function T6(e){return Number.isInteger(e)&&e>0}class N6{}class A6 extends N6{constructor(e,t){super(),this.command=e,this.rowsRemovals=t}doUndo(e){e.undoRemoveRows(this)}doRedo(e){e.redoRemoveRows(this)}}class M6 extends N6{constructor(e,t,n,r,i,o,s){super(),this.sourceLeftCorner=e,this.width=t,this.height=n,this.destinationLeftCorner=r,this.overwrittenCellsData=i,this.addedGlobalNamedExpressions=o,this.version=s}doUndo(e){e.undoMoveCells(this)}doRedo(e){e.redoMoveCells(this)}}class I6 extends N6{constructor(e){super(),this.command=e}doUndo(e){e.undoAddRows(this)}doRedo(e){e.redoAddRows(this)}}class O6 extends N6{constructor(e,t,n){super(),this.sheetId=e,this.rowMapping=t,this.oldContent=n}doUndo(e){e.undoSetRowOrder(this)}doRedo(e){e.redoSetRowOrder(this)}}class x6 extends N6{constructor(e,t,n){super(),this.sheetId=e,this.columnMapping=t,this.oldContent=n}doUndo(e){e.undoSetColumnOrder(this)}doRedo(e){e.redoSetColumnOrder(this)}}class P6 extends N6{constructor(e,t,n){super(),this.sheetId=e,this.oldSheetContent=t,this.newSheetContent=n}doUndo(e){e.undoSetSheetContent(this)}doRedo(e){e.redoSetSheetContent(this)}}class _6 extends N6{constructor(e,t,n,r,i){super(),this.sheet=e,this.startRow=t,this.numberOfRows=n,this.targetRow=r,this.version=i,this.undoStart=this.startRow<this.targetRow?this.targetRow-this.numberOfRows:this.targetRow,this.undoEnd=this.startRow>this.targetRow?this.startRow+this.numberOfRows:this.startRow}doUndo(e){e.undoMoveRows(this)}doRedo(e){e.redoMoveRows(this)}}class L6 extends N6{constructor(e,t,n,r,i){super(),this.sheet=e,this.startColumn=t,this.numberOfColumns=n,this.targetColumn=r,this.version=i,this.undoStart=this.startColumn<this.targetColumn?this.targetColumn-this.numberOfColumns:this.targetColumn,this.undoEnd=this.startColumn>this.targetColumn?this.startColumn+this.numberOfColumns:this.startColumn}doUndo(e){e.undoMoveColumns(this)}doRedo(e){e.redoMoveColumns(this)}}class H6 extends N6{constructor(e){super(),this.command=e}doUndo(e){e.undoAddColumns(this)}doRedo(e){e.redoAddColumns(this)}}class k6 extends N6{constructor(e,t){super(),this.command=e,this.columnsRemovals=t}doUndo(e){e.undoRemoveColumns(this)}doRedo(e){e.redoRemoveColumns(this)}}class F6 extends N6{constructor(e){super(),this.sheetName=e}doUndo(e){e.undoAddSheet(this)}doRedo(e){e.redoAddSheet(this)}}class D6 extends N6{constructor(e,t,n,r,i){super(),this.sheetName=e,this.sheetId=t,this.oldSheetContent=n,this.scopedNamedExpressions=r,this.version=i}doUndo(e){e.undoRemoveSheet(this)}doRedo(e){e.redoRemoveSheet(this)}}class V6 extends N6{constructor(e,t,n){super(),this.sheetId=e,this.oldName=t,this.newName=n}doUndo(e){e.undoRenameSheet(this)}doRedo(e){e.redoRenameSheet(this)}}class U6 extends N6{constructor(e,t){super(),this.sheetId=e,this.oldSheetContent=t}doUndo(e){e.undoClearSheet(this)}doRedo(e){e.redoClearSheet(this)}}class B6 extends N6{constructor(e){super(),this.cellContents=e}doUndo(e){e.undoSetCellContents(this)}doRedo(e){e.redoSetCellContents(this)}}class W6 extends N6{constructor(e,t,n,r){super(),this.targetLeftCorner=e,this.oldContent=t,this.newContent=n,this.addedGlobalNamedExpressions=r}doUndo(e){e.undoPaste(this)}doRedo(e){e.redoPaste(this)}}class j6 extends N6{constructor(e,t,n,r){super(),this.name=e,this.newContent=t,this.scope=n,this.options=r}doUndo(e){e.undoAddNamedExpression(this)}doRedo(e){e.redoAddNamedExpression(this)}}class G6 extends N6{constructor(e,t,n){super(),this.namedExpression=e,this.content=t,this.scope=n}doUndo(e){e.undoRemoveNamedExpression(this)}doRedo(e){e.redoRemoveNamedExpression(this)}}class z6 extends N6{constructor(e,t,n,r,i){super(),this.namedExpression=e,this.newContent=t,this.oldContent=n,this.scope=r,this.options=i}doUndo(e){e.undoChangeNamedExpression(this)}doRedo(e){e.redoChangeNamedExpression(this)}}class $6 extends N6{constructor(){super(...arguments),this.operations=[]}add(e){this.operations.push(e)}*reversedOperations(){for(let e=this.operations.length-1;e>=0;e--)yield this.operations[e]}doUndo(e){e.undoBatch(this)}doRedo(e){e.redoBatch(this)}}class Y6{constructor(e,t){this.operations=t,this.oldData=new Map,this.undoStack=[],this.redoStack=[],this.undoLimit=e.undoLimit}saveOperation(e){void 0!==this.batchUndoEntry?this.batchUndoEntry.add(e):this.addUndoEntry(e)}beginBatchMode(){this.batchUndoEntry=new $6}commitBatchMode(){if(void 0===this.batchUndoEntry)throw Error("Batch mode wasn't started");this.addUndoEntry(this.batchUndoEntry),this.batchUndoEntry=void 0}storeDataForVersion(e,t,n){this.oldData.has(e)||this.oldData.set(e,[]);this.oldData.get(e).push([t,n])}clearRedoStack(){this.redoStack=[]}clearUndoStack(){this.undoStack=[]}isUndoStackEmpty(){return 0===this.undoStack.length}isRedoStackEmpty(){return 0===this.redoStack.length}undo(){const e=this.undoStack.pop();if(!e)throw Error("Attempted to undo without operation on stack");this.undoEntry(e),this.redoStack.push(e)}undoBatch(e){for(const t of e.reversedOperations())this.undoEntry(t)}undoRemoveRows(e){this.operations.forceApplyPostponedTransformations();const{command:{sheet:t},rowsRemovals:n}=e;for(let r=n.length-1;r>=0;--r){const e=n[r];this.operations.addRows(new v6(t,[[e.rowFrom,e.rowCount]]));for(const{address:t,cellType:n}of e.removedCells)this.operations.restoreCell(t,n);this.restoreOldDataFromVersion(e.version-1)}}undoRemoveColumns(e){this.operations.forceApplyPostponedTransformations();const{command:{sheet:t},columnsRemovals:n}=e;for(let r=n.length-1;r>=0;--r){const e=n[r];this.operations.addColumns(new C6(t,[[e.columnFrom,e.columnCount]]));for(const{address:t,cellType:n}of e.removedCells)this.operations.restoreCell(t,n);this.restoreOldDataFromVersion(e.version-1)}}undoAddRows(e){const t=e.command.rowsSpans();for(let n=t.length-1;n>=0;--n){const r=t[n];this.operations.removeRows(new y6(e.command.sheet,[[r.rowStart,r.numberOfRows]]))}}undoAddColumns(e){const t=e.command.columnsSpans();for(let n=t.length-1;n>=0;--n){const r=t[n];this.operations.removeColumns(new S6(e.command.sheet,[[r.columnStart,r.numberOfColumns]]))}}undoSetCellContents(e){for(const t of e.cellContents){const e=t.address,[n,r]=t.oldContent;T4(e,n)||this.operations.setCellEmpty(e),this.operations.restoreCell(n,r)}}undoPaste(e){this.restoreOperationOldContent(e.oldContent);for(const t of e.addedGlobalNamedExpressions)this.operations.removeNamedExpression(t)}undoMoveRows(e){const{sheet:t}=e;this.operations.moveRows(t,e.undoStart,e.numberOfRows,e.undoEnd),this.restoreOldDataFromVersion(e.version-1)}undoMoveColumns(e){const{sheet:t}=e;this.operations.moveColumns(t,e.undoStart,e.numberOfColumns,e.undoEnd),this.restoreOldDataFromVersion(e.version-1)}undoMoveCells(e){this.operations.forceApplyPostponedTransformations(),this.operations.moveCells(e.destinationLeftCorner,e.width,e.height,e.sourceLeftCorner),this.restoreOperationOldContent(e.overwrittenCellsData),this.restoreOldDataFromVersion(e.version-1);for(const t of e.addedGlobalNamedExpressions)this.operations.removeNamedExpression(t)}undoAddSheet(e){const{sheetName:t}=e;this.operations.removeSheetByName(t)}undoRemoveSheet(e){this.operations.forceApplyPostponedTransformations();const{oldSheetContent:t,sheetId:n}=e;this.operations.addSheet(e.sheetName);for(let r=0;r<t.length;r++){const e=t[r];for(let t=0;t<e.length;t++){const i=e[t],o=v4(n,t,r);this.operations.restoreCell(o,i)}}for(const[r,i]of e.scopedNamedExpressions)this.operations.restoreNamedExpression(r,i,n);this.restoreOldDataFromVersion(e.version-1)}undoRenameSheet(e){this.operations.renameSheet(e.sheetId,e.oldName)}undoClearSheet(e){const{oldSheetContent:t,sheetId:n}=e;for(let r=0;r<t.length;r++){const e=t[r];for(let t=0;t<e.length;t++){const i=e[t],o=v4(n,t,r);this.operations.restoreCell(o,i)}}}undoSetSheetContent(e){const{oldSheetContent:t,sheetId:n}=e;this.operations.clearSheet(n);for(let r=0;r<t.length;r++){const e=t[r];for(let t=0;t<e.length;t++){const i=e[t],o=v4(n,t,r);this.operations.restoreCell(o,i)}}}undoAddNamedExpression(e){this.operations.removeNamedExpression(e.name,e.scope)}undoRemoveNamedExpression(e){this.operations.restoreNamedExpression(e.namedExpression,e.content,e.scope)}undoChangeNamedExpression(e){this.operations.restoreNamedExpression(e.namedExpression,e.oldContent,e.scope)}undoSetRowOrder(e){this.restoreOperationOldContent(e.oldContent)}undoSetColumnOrder(e){this.restoreOperationOldContent(e.oldContent)}redo(){const e=this.redoStack.pop();if(!e)throw Error("Attempted to redo without operation on stack");this.redoEntry(e),this.undoStack.push(e)}redoBatch(e){for(const t of e.operations)this.redoEntry(t)}redoRemoveRows(e){this.operations.removeRows(e.command)}redoMoveCells(e){this.operations.moveCells(e.sourceLeftCorner,e.width,e.height,e.destinationLeftCorner)}redoRemoveColumns(e){this.operations.removeColumns(e.command)}redoPaste(e){const{targetLeftCorner:t,newContent:n}=e,r=n.length,i=n[0].length;for(let o=0;o<r;++o)for(let e=0;e<i;++e){const r=v4(t.sheet,t.col+e,t.row+o);this.operations.restoreCell(r,n[o][e])}}redoSetCellContents(e){for(const t of e.cellContents)this.operations.setCellContent(t.address,t.newContent)}redoAddRows(e){this.operations.addRows(e.command)}redoAddColumns(e){this.operations.addColumns(e.command)}redoRemoveSheet(e){this.operations.removeSheetByName(e.sheetName)}redoAddSheet(e){this.operations.addSheet(e.sheetName)}redoRenameSheet(e){this.operations.renameSheet(e.sheetId,e.newName)}redoMoveRows(e){this.operations.moveRows(e.sheet,e.startRow,e.numberOfRows,e.targetRow)}redoMoveColumns(e){this.operations.moveColumns(e.sheet,e.startColumn,e.numberOfColumns,e.targetColumn)}redoClearSheet(e){this.operations.clearSheet(e.sheetId)}redoSetSheetContent(e){const{sheetId:t,newSheetContent:n}=e;this.operations.setSheetContent(t,n)}redoAddNamedExpression(e){this.operations.addNamedExpression(e.name,e.newContent,e.scope,e.options)}redoRemoveNamedExpression(e){this.operations.removeNamedExpression(e.namedExpression.displayName,e.scope)}redoChangeNamedExpression(e){this.operations.changeNamedExpressionExpression(e.namedExpression.displayName,e.newContent,e.scope,e.options)}redoSetRowOrder(e){this.operations.setRowOrder(e.sheetId,e.rowMapping)}redoSetColumnOrder(e){this.operations.setColumnOrder(e.sheetId,e.columnMapping)}addUndoEntry(e){this.undoStack.push(e),this.undoStack.splice(0,Math.max(0,this.undoStack.length-this.undoLimit))}undoEntry(e){e.doUndo(this)}restoreOperationOldContent(e){for(const[t,n]of e)this.operations.restoreCell(t,n)}redoEntry(e){e.doRedo(this)}restoreOldDataFromVersion(e){const t=this.oldData.get(e)||[];for(const n of t){const[e,t]=n;this.operations.setFormulaToCellFromCache(t,e)}}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class K6{constructor(e,t,n,r,i,o,s,a,l,h){this.operations=t,this.undoRedo=n,this.clipboardOperations=r,this.dependencyGraph=i,this.columnSearch=o,this.parser=s,this.cellContentParser=a,this.lazilyTransformingAstService=l,this.namedExpressions=h,this.maxRows=e.maxRows,this.maxColumns=e.maxColumns}get sheetMapping(){return this.dependencyGraph.sheetMapping}addRows(e,...t){const n=new v6(e,t);this.ensureItIsPossibleToAddRows(e,...t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.operations.addRows(n),this.undoRedo.saveOperation(new I6(n))}removeRows(e,...t){const n=new y6(e,t);this.ensureItIsPossibleToRemoveRows(e,...t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const r=this.operations.removeRows(n);this.undoRedo.saveOperation(new A6(n,r))}addColumns(e,...t){const n=new C6(e,t);this.ensureItIsPossibleToAddColumns(e,...t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.operations.addColumns(n),this.undoRedo.saveOperation(new H6(n))}removeColumns(e,...t){const n=new S6(e,t);this.ensureItIsPossibleToRemoveColumns(e,...t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const r=this.operations.removeColumns(n);this.undoRedo.saveOperation(new k6(n,r))}moveCells(e,t,n,r){this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const{version:i,overwrittenCellsData:o,addedGlobalNamedExpressions:s}=this.operations.moveCells(e,t,n,r);this.undoRedo.saveOperation(new M6(e,t,n,r,o,s,i))}moveRows(e,t,n,r){this.ensureItIsPossibleToMoveRows(e,t,n,r),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const i=this.operations.moveRows(e,t,n,r);this.undoRedo.saveOperation(new _6(e,t,n,r,i))}moveColumns(e,t,n,r){this.ensureItIsPossibleToMoveColumns(e,t,n,r),this.undoRedo.clearRedoStack();const i=this.operations.moveColumns(e,t,n,r);this.undoRedo.saveOperation(new L6(e,t,n,r,i))}cut(e,t,n){this.clipboardOperations.cut(e,t,n)}ensureItIsPossibleToCopy(e,t,n){if(!X6(t))throw new i9("width to be positive integer.");if(!X6(n))throw new i9("height to be positive integer.")}copy(e,t,n){this.ensureItIsPossibleToCopy(e,t,n),this.clipboardOperations.copy(e,t,n)}paste(e){const t=this.clipboardOperations.clipboard;if(void 0===t)throw new c9;if(this.clipboardOperations.isCutClipboard())this.moveCells(t.sourceLeftCorner,t.width,t.height,e);else if(this.clipboardOperations.isCopyClipboard()){this.clipboardOperations.ensureItIsPossibleToCopyPaste(e);const n=M4.spanFrom(e,t.width,t.height),r=this.operations.getRangeClipboardCells(n);this.undoRedo.clearRedoStack();const i=this.operations.restoreClipboardCells(t.sourceLeftCorner.sheet,t.getContent(e));this.undoRedo.saveOperation(new W6(e,r,t.content,i))}}beginUndoRedoBatchMode(){this.undoRedo.beginBatchMode()}commitUndoRedoBatchMode(){this.undoRedo.commitBatchMode()}isClipboardEmpty(){return void 0===this.clipboardOperations.clipboard}clearClipboard(){this.clipboardOperations.clear()}addSheet(e){void 0!==e&&this.ensureItIsPossibleToAddSheet(e),this.undoRedo.clearRedoStack();const t=this.operations.addSheet(e);return this.undoRedo.saveOperation(new F6(t)),t}removeSheet(e){this.ensureScopeIdIsValid(e),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const t=this.sheetMapping.fetchDisplayName(e),n=this.operations.getSheetClipboardCells(e),{version:r,scopedNamedExpressions:i}=this.operations.removeSheet(e);this.undoRedo.saveOperation(new D6(t,e,n,i,r))}renameSheet(e,t){this.ensureItIsPossibleToRenameSheet(e,t);const n=this.operations.renameSheet(e,t);return void 0!==n&&(this.undoRedo.clearRedoStack(),this.undoRedo.saveOperation(new V6(e,n,t))),n}clearSheet(e){this.ensureScopeIdIsValid(e),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const t=this.operations.getSheetClipboardCells(e);this.operations.clearSheet(e),this.undoRedo.saveOperation(new U6(e,t))}setCellContents(e,t){if(t instanceof Array){for(let r=0;r<t.length;r++)if(!(t[r]instanceof Array))throw new i9("an array of arrays or a raw cell value.")}else t=[[t]];this.ensureItIsPossibleToChangeCellContents(e,t),this.undoRedo.clearRedoStack();const n=[];for(let r=0;r<t.length;r++)for(let i=0;i<t[r].length;i++){const o={sheet:e.sheet,row:e.row+r,col:e.col+i},s=t[r][i];this.clipboardOperations.abortCut();const a=this.operations.setCellContent(o,s);n.push({address:o,newContent:s,oldContent:a})}this.undoRedo.saveOperation(new B6(n))}setSheetContent(e,t){this.ensureScopeIdIsValid(e),this.ensureItIsPossibleToChangeSheetContents(e,t),f6(t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const n=this.operations.getSheetClipboardCells(e);this.operations.setSheetContent(e,t),this.undoRedo.saveOperation(new P6(e,n,t))}setRowOrder(e,t){this.validateSwapRowIndexes(e,t),this.testRowOrderForArrays(e,t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const n=this.operations.setRowOrder(e,t);this.undoRedo.saveOperation(new O6(e,t,n))}validateSwapRowIndexes(e,t){if(!this.sheetMapping.hasSheetWithId(e))throw new Z3(e);this.validateRowOrColumnMapping(e,t,"row")}testColumnOrderForArrays(e,t){for(const[n,r]of t)if(n!==r){const t=M4.spanFrom({sheet:e,col:n,row:0},1,1/0);if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(t))throw new N9}}setColumnOrder(e,t){this.validateSwapColumnIndexes(e,t),this.testColumnOrderForArrays(e,t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const n=this.operations.setColumnOrder(e,t);this.undoRedo.saveOperation(new x6(e,t,n))}validateSwapColumnIndexes(e,t){if(!this.sheetMapping.hasSheetWithId(e))throw new Z3(e);this.validateRowOrColumnMapping(e,t,"column")}testRowOrderForArrays(e,t){for(const[n,r]of t)if(n!==r){const t=M4.spanFrom({sheet:e,col:0,row:n},1/0,1);if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(t))throw new N9}}mappingFromOrder(e,t,n){if(!this.sheetMapping.hasSheetWithId(e))throw new Z3(e);const r="row"===n?this.dependencyGraph.getSheetHeight(e):this.dependencyGraph.getSheetWidth(e);if(t.length!==r)throw new i9(`number of ${n}s provided to be sheet ${"row"===n?"height":"width"}.`);const i=[];for(let o=0;o<r;o++)t[o]!==o&&i.push([o,t[o]]);return i}undo(){if(this.undoRedo.isUndoStackEmpty())throw new h9;this.clipboardOperations.abortCut(),this.undoRedo.undo()}redo(){if(this.undoRedo.isRedoStackEmpty())throw new u9;this.clipboardOperations.abortCut(),this.undoRedo.redo()}addNamedExpression(e,t,n,r){this.ensureItIsPossibleToAddNamedExpression(e,t,n),this.operations.addNamedExpression(e,t,n,r),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.undoRedo.saveOperation(new j6(e,t,n,r))}changeNamedExpressionExpression(e,t,n,r){this.ensureItIsPossibleToChangeNamedExpression(e,n,t);const[i,o]=this.operations.changeNamedExpressionExpression(e,n,t,r);this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.undoRedo.saveOperation(new z6(i,n,o,t,r))}removeNamedExpression(e,t){this.ensureScopeIdIsValid(t);const[n,r]=this.operations.removeNamedExpression(e,t);return this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.undoRedo.saveOperation(new G6(n,r,t)),n}ensureItIsPossibleToAddNamedExpression(e,t,n){this.ensureScopeIdIsValid(n),this.ensureNamedExpressionNameIsValid(e,n),this.ensureNamedExpressionIsValid(t)}ensureItIsPossibleToChangeNamedExpression(e,t,n){if(this.ensureScopeIdIsValid(n),void 0===this.namedExpressions.namedExpressionForScope(e,n))throw new l9(e);this.ensureNamedExpressionIsValid(t)}isItPossibleToRemoveNamedExpression(e,t){if(this.ensureScopeIdIsValid(t),void 0===this.namedExpressions.namedExpressionForScope(e,t))throw new l9(e)}ensureItIsPossibleToAddRows(e,...t){if(!this.sheetMapping.hasSheetWithId(e))throw new Z3(e);const n=this.dependencyGraph.getSheetHeight(e),r=t.map((e=>e[1])).reduce(((e,t)=>e+t),0);if(n+r>this.maxRows)throw new t9;for(const[i,o]of t)if(!q6(i)||!X6(o))throw new i9("row number to be nonnegative and number of rows to add to be positive.")}ensureItIsPossibleToRemoveRows(e,...t){for(const[n,r]of t){const t=n+r-1;if(!q6(n)||!q6(t))throw new i9("starting and ending row to be nonnegative.");if(t<n)throw new i9("starting row to be smaller than the ending row.");if(!this.sheetMapping.hasSheetWithId(e))throw new Z3(e)}}ensureItIsPossibleToAddColumns(e,...t){if(!this.sheetMapping.hasSheetWithId(e))throw new Z3(e);const n=this.dependencyGraph.getSheetWidth(e),r=t.map((e=>e[1])).reduce(((e,t)=>e+t),0);if(n+r>this.maxColumns)throw new t9;for(const[i,o]of t)if(!q6(i)||!X6(o))throw new i9("column number to be nonnegative and number of columns to add to be positive.")}ensureItIsPossibleToRemoveColumns(e,...t){for(const[n,r]of t){const t=n+r-1;if(!q6(n)||!q6(t))throw new i9("starting and ending column to be nonnegative.");if(t<n)throw new i9("starting column to be smaller than the ending column.");if(!this.sheetMapping.hasSheetWithId(e))throw new Z3(e)}}ensureItIsPossibleToMoveRows(e,t,n,r){this.ensureItIsPossibleToAddRows(e,[r,n]);const i=v4(e,0,t),o=v4(e,0,r);if(!this.sheetMapping.hasSheetWithId(e)||C4(i)||C4(o)||!X6(n)||r<=t+n&&r>=t)throw new i9("a valid range of rows to move.");const s=this.dependencyGraph.getSheetWidth(e),a=M4.spanFrom(i,s,n);if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(a))throw new N9;if(r>0&&this.dependencyGraph.arrayMapping.isFormulaArrayInAllRows(K3.fromNumberOfRows(e,r-1,2)))throw new A9}ensureItIsPossibleToMoveColumns(e,t,n,r){this.ensureItIsPossibleToAddColumns(e,[r,n]);const i=v4(e,t,0),o=v4(e,r,0);if(!this.sheetMapping.hasSheetWithId(e)||C4(i)||C4(o)||!X6(n)||r<=t+n&&r>=t)throw new i9("a valid range of columns to move.");const s=this.dependencyGraph.getSheetHeight(e),a=M4.spanFrom(i,n,s);if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(a))throw new N9;if(r>0&&this.dependencyGraph.arrayMapping.isFormulaArrayInAllColumns(X3.fromNumberOfColumns(e,r-1,2)))throw new A9}ensureItIsPossibleToAddSheet(e){if(this.sheetMapping.hasSheetWithName(e))throw new e9(e)}ensureItIsPossibleToRenameSheet(e,t){if(!this.sheetMapping.hasSheetWithId(e))throw new Z3(e);const n=this.sheetMapping.get(t);if(void 0!==n&&n!==e)throw new e9(t)}ensureItIsPossibleToChangeContent(e){if(C4(e))throw new r9(e);if(!this.sheetMapping.hasSheetWithId(e.sheet))throw new Z3(e.sheet)}ensureItIsPossibleToChangeCellContents(e,t){const n=w6(t),r=M4.spanFrom(e,n.width,n.height);this.ensureRangeInSizeLimits(r);for(const i of r.addresses(this.dependencyGraph))this.ensureItIsPossibleToChangeContent(i)}ensureItIsPossibleToChangeSheetContents(e,t){const n=w6(t),r=M4.spanFrom(v4(e,0,0),n.width,n.height);this.ensureRangeInSizeLimits(r)}ensureRangeInSizeLimits(e){if(e.exceedsSheetSizeLimits(this.maxColumns,this.maxRows))throw new t9}isThereSomethingToUndo(){return!this.undoRedo.isUndoStackEmpty()}isThereSomethingToRedo(){return!this.undoRedo.isRedoStackEmpty()}getAndClearContentChanges(){return this.operations.getAndClearContentChanges()}ensureScopeIdIsValid(e){if(void 0!==e&&!this.sheetMapping.hasSheetWithId(e))throw new Z3(e)}validateRowOrColumnMapping(e,t,n){const r="row"===n?this.dependencyGraph.getSheetHeight(e):this.dependencyGraph.getSheetWidth(e),i=t.map((([e,t])=>e)).sort(((e,t)=>e-t)),o=t.map((([e,t])=>t)).sort(((e,t)=>e-t));for(let s=0;s<i.length;s++){if(!q6(i[s])||i[s]>=r)throw new i9(`${n} numbers to be nonnegative integers and less than sheet ${"row"===n?"height":"width"}.`);if(i[s]===i[s+1])throw new i9(`source ${n} numbers to be unique.`);if(i[s]!==o[s])throw new i9(`target ${n} numbers to be permutation of source ${n} numbers.`)}}ensureNamedExpressionNameIsValid(e,t){if(!this.namedExpressions.isNameValid(e))throw new a9(e);if(!this.namedExpressions.isNameAvailable(e,t))throw new s9(e)}ensureNamedExpressionIsValid(e){const t=this.cellContentParser.parse(e);if(t instanceof q5.Formula){const e=this.parser.parse(t.formula,v4(-1,0,0));if(s6(e.ast))throw new M9}}}function X6(e){return Number.isInteger(e)&&e>0}function q6(e){return Number.isInteger(e)&&e>=0}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class Q6{constructor(e,t,n,r,i,o){this.config=e,this.stats=t,this.interpreter=n,this.lazilyTransformingAstService=r,this.dependencyGraph=i,this.columnSearch=o}run(){this.stats.start(G3.TOP_SORT);const{sorted:e,cycled:t}=this.dependencyGraph.topSortWithScc();this.stats.end(G3.TOP_SORT),this.stats.measure(G3.EVALUATION,(()=>{this.recomputeFormulas(t,e)}))}partialRun(e){const t=Y3.empty();return this.stats.measure(G3.EVALUATION,(()=>{this.dependencyGraph.graph.getTopSortedWithSccSubgraphFrom(e,(e=>{if(e instanceof H9){const n=e.isComputed()?e.getCellValue():void 0,r=this.recomputeFormulaVertexValue(e);if(r!==n){const i=e.getAddress(this.lazilyTransformingAstService);return t.addChange(r,i),this.columnSearch.change(L3(n),L3(r),i),!0}return!1}return!(e instanceof D9)||(e.clearCache(),!0)}),(e=>{if(e instanceof D9)e.clearCache();else if(e instanceof H9){const n=e.getAddress(this.lazilyTransformingAstService);this.columnSearch.remove(L3(e.valueOrUndef()),n);const r=new g4(X9.CYCLE,void 0,e);e.setCellValue(r),t.addChange(r,n)}}))})),t}runAndForget(e,t,n){const r=[];for(const o of P3(n,t))if(o instanceof M4){const e=o;if(void 0===this.dependencyGraph.getRange(e.start,e.end)){const t=new D9(e);this.dependencyGraph.rangeMapping.setRange(t),r.push(t)}}const i=this.evaluateAstToCellValue(e,new x4(t,this.config.useArrayArithmetic));return r.forEach((e=>{this.dependencyGraph.rangeMapping.removeRange(e)})),i}recomputeFormulas(e,t){e.forEach((e=>{e instanceof H9&&e.setCellValue(new g4(X9.CYCLE,void 0,e))})),t.forEach((e=>{if(e instanceof H9){const t=this.recomputeFormulaVertexValue(e),n=e.getAddress(this.lazilyTransformingAstService);this.columnSearch.add(L3(t),n)}else e instanceof D9&&e.clearCache()}))}recomputeFormulaVertexValue(e){const t=e.getAddress(this.lazilyTransformingAstService);if(e instanceof k9&&(e.array.size.isRef||!this.dependencyGraph.isThereSpaceForArray(e)))return e.setNoSpace();{const n=e.getFormula(this.lazilyTransformingAstService),r=this.evaluateAstToCellValue(n,new x4(t,this.config.useArrayArithmetic,e));return e.setCellValue(r)}}evaluateAstToCellValue(e,t){const n=this.interpreter.evaluateAst(e,t);return n instanceof $3?n:n===_3&&this.config.evaluateNullToZero?0:n}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class Z6{constructor(e,t){this.address=e,this.newValue=t}get col(){return this.address.col}get row(){return this.address.row}get sheet(){return this.address.sheet}get value(){return this.newValue}}class J6{constructor(e,t){this.name=e,this.newValue=t}}class e8{constructor(e,t,n,r){this.config=e,this.namedExpressions=t,this.sheetIndexMapping=n,this.lazilyTransformingService=r}exportChange(e){const t=e.value,n=e.address;if(n.sheet===o6.SHEET_FOR_WORKBOOK_EXPRESSIONS){const e=this.namedExpressions.namedExpressionInAddress(n.row);if(!e)throw new Error("Missing named expression");return new J6(e.displayName,this.exportScalarOrRange(t))}if(t instanceof $3){const e=[];for(const[r,i]of t.entriesFromTopLeftCorner(n))e.push(new Z6(i,this.exportValue(r)));return e}return new Z6(n,this.exportValue(t))}exportValue(e){return e instanceof $3?this.detailedError(new g4(X9.VALUE,W2.ScalarExpected)):this.config.smartRounding&&W3(e)?this.cellValueRounding(L3(e)):e instanceof g4?this.detailedError(e):e===_3?null:L3(e)}exportScalarOrRange(e){return e instanceof $3?e.rawData().map((e=>e.map((e=>this.exportValue(e))))):this.exportValue(e)}detailedError(e){var t,n;let r;const i=null===(t=e.root)||void 0===t?void 0:t.getAddress(this.lazilyTransformingService);return void 0!==i&&(r=i.sheet===o6.SHEET_FOR_WORKBOOK_EXPRESSIONS?null===(n=this.namedExpressions.namedExpressionInAddress(i.row))||void 0===n?void 0:n.displayName:oZ(this.sheetIndexMapping,i,-1)),new n5(e,this.config.translationPackage.getErrorTranslation(e.type),r)}cellValueRounding(e){if(0===e)return e;const t=Math.floor(Math.log10(Math.abs(e))),n=Math.pow(10,this.config.precisionRounding-t);return e<0?-Math.round(-e*n)/n:Math.round(e*n)/n}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class t8{constructor(e,t,n,r,i,o){this.dependencyGraph=e,this.columnSearch=t,this.parser=n,this.cellContentParser=r,this.stats=i,this.arraySizePredictor=o,this.buildStrategy=new n8(e,t,n,i,r,o)}buildGraph(e,t){const n=t.measure(G3.COLLECT_DEPENDENCIES,(()=>this.buildStrategy.run(e)));this.dependencyGraph.getAndClearContentChanges(),t.measure(G3.PROCESS_DEPENDENCIES,(()=>this.processDependencies(n)))}processDependencies(e){e.forEach(((e,t)=>{this.dependencyGraph.processCellDependencies(e,t)}))}}class n8{constructor(e,t,n,r,i,o){this.dependencyGraph=e,this.columnIndex=t,this.parser=n,this.stats=r,this.cellContentParser=i,this.arraySizePredictor=o}run(e){const t=new Map;for(const n in e){const r=this.dependencyGraph.getSheetId(n),i=e[n];for(let e=0;e<i.length;++e){const n=i[e];for(let i=0;i<n.length;++i){const o=n[i],s=v4(r,i,e),a=this.cellContentParser.parse(o);if(a instanceof q5.Formula){const e=this.stats.measure(G3.PARSER,(()=>this.parser.parse(a.formula,s)));if(e.errors.length>0){this.shrinkArrayIfNeeded(s);const t=new r4(e.errors,a.formula);this.dependencyGraph.addVertex(s,t)}else{this.shrinkArrayIfNeeded(s);const n=this.arraySizePredictor.checkArraySize(e.ast,s);if(n.isScalar()){const n=new F9(e.ast,s,0);t.set(n,P3(e.dependencies,s)),this.dependencyGraph.addVertex(s,n),e.hasVolatileFunction&&this.dependencyGraph.markAsVolatile(n),e.hasStructuralChangeFunction&&this.dependencyGraph.markAsDependentOnStructureChange(n)}else{const r=new k9(e.ast,s,new e5(n.width,n.height));t.set(r,P3(e.dependencies,s)),this.dependencyGraph.addArrayVertex(s,r)}}}else if(a instanceof q5.Empty);else{this.shrinkArrayIfNeeded(s);const e=new n4(a.value,o);this.columnIndex.add(L3(a.value),s),this.dependencyGraph.addVertex(s,e)}}}}return t}shrinkArrayIfNeeded(e){const t=this.dependencyGraph.getCell(e);t instanceof k9&&this.dependencyGraph.shrinkArrayToCorner(t)}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */const r8=new Map([["gpl-v3",1],["missing",2],["invalid",3],["expired",4]]);class i8 extends J4{version(e,t){return this.runFunction(e.args,t,this.metadata("VERSION"),(()=>{const{licenseKeyValidityState:e,licenseKey:t}=this.config;let n;return r8.has(t)?n=r8.get(t):r8.has(e)?n=r8.get(e):"valid"===e&&(n=t.slice(-5)),`HyperFormula v${_8.version}, ${n}`}))}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
function o8(e,t){var n;let r=t.implementedFunctions[e];const i=null===(n=t.aliases)||void 0===n?void 0:n[e];if(void 0!==i){if(void 0!==r)throw new I9(e,t.name);r=t.implementedFunctions[i]}if(void 0===r)throw b9.functionNotDeclaredInPlugin(e,t.name);return r}i8.implementedFunctions={VERSION:{method:"version",parameters:[]}};class s8{constructor(e){if(this.config=e,this.functions=new Map,this.arraySizeFunctions=new Map,this.volatileFunctions=new Set,this.arrayFunctions=new Set,this.structuralChangeFunctions=new Set,this.functionsWhichDoesNotNeedArgumentsToBeComputed=new Set,this.functionsMetadata=new Map,this.doesFunctionNeedArgumentToBeComputed=e=>this.functionsWhichDoesNotNeedArgumentsToBeComputed.has(e),this.isFunctionVolatile=e=>this.volatileFunctions.has(e),this.isArrayFunction=e=>this.arrayFunctions.has(e),this.isFunctionDependentOnSheetStructureChange=e=>this.structuralChangeFunctions.has(e),e.functionPlugins.length>0){this.instancePlugins=new Map;for(const t of e.functionPlugins)s8.loadPluginFunctions(t,this.instancePlugins)}else this.instancePlugins=new Map(s8.plugins);for(const[t,n]of s8.protectedFunctions())s8.loadFunctionUnprotected(n,t,this.instancePlugins);for(const[t,n]of this.instancePlugins.entries())this.categorizeFunction(t,o8(t,n))}static registerFunctionPlugin(e,t){this.loadPluginFunctions(e,this.plugins),void 0!==t&&this.loadTranslations(t)}static registerFunction(e,t,n){this.loadPluginFunction(t,e,this.plugins),void 0!==n&&this.loadTranslations(n)}static unregisterFunction(e){if(this.functionIsProtected(e))throw T9.cannotUnregisterFunctionWithId(e);this.plugins.delete(e)}static unregisterFunctionPlugin(e){for(const t of this.protectedPlugins())if(t===e)throw T9.cannotUnregisterProtectedPlugin();for(const[t,n]of this.plugins.entries())n===e&&this.plugins.delete(t)}static unregisterAll(){this.plugins.clear()}static getRegisteredFunctionIds(){return[...Array.from(this.plugins.keys()),...Array.from(this._protectedPlugins.keys())]}static getPlugins(){return Array.from(new Set(this.plugins.values()).values())}static getFunctionPlugin(e){return this.functionIsProtected(e)?void 0:this.plugins.get(e)}static functionIsProtected(e){return this._protectedPlugins.has(e)}static loadTranslations(e){const t=new Set(_8.getRegisteredLanguagesCodes());Object.keys(e).forEach((n=>{t.has(n)&&_8.getLanguage(n).extendFunctions(e[n])}))}static loadPluginFunctions(e,t){Object.keys(e.implementedFunctions).forEach((n=>{this.loadPluginFunction(e,n,t)})),void 0!==e.aliases&&Object.keys(e.aliases).forEach((n=>{this.loadPluginFunction(e,n,t)}))}static loadPluginFunction(e,t,n){if(this.functionIsProtected(t))throw T9.cannotRegisterFunctionWithId(t);this.loadFunctionUnprotected(e,t,n)}static loadFunctionUnprotected(e,t,n){const r=o8(t,e).method;if(!Object.prototype.hasOwnProperty.call(e.prototype,r))throw b9.functionMethodNotFound(r,e.name);n.set(t,e)}static*protectedFunctions(){for(const[e,t]of this._protectedPlugins)void 0!==t&&(yield[e,t])}static*protectedPlugins(){for(const[,e]of this._protectedPlugins)void 0!==e&&(yield e)}initializePlugins(e){const t=[];for(const[n,r]of this.instancePlugins.entries()){let i=t.find((e=>e instanceof r));void 0===i&&(i=new r(e),t.push(i));const o=o8(n,r),s=o.method;this.functions.set(n,[s,i]);const a=o.arraySizeMethod;void 0!==a&&this.arraySizeFunctions.set(n,[a,i])}}getFunctionPlugin(e){if(!s8.functionIsProtected(e))return this.instancePlugins.get(e)}getFunction(e){const t=this.functions.get(e);if(void 0!==t&&this.config.translationPackage.isFunctionTranslated(e)){const[e,n]=t;return(t,r)=>n[e](t,r)}}getArraySizeFunction(e){const t=this.arraySizeFunctions.get(e);if(void 0!==t&&this.config.translationPackage.isFunctionTranslated(e)){const[e,n]=t;return(t,r)=>n[e](t,r)}}getMetadata(e){return this.functionsMetadata.get(e)}getPlugins(){const e=new Set;for(const[t,n]of this.instancePlugins)s8.functionIsProtected(t)||e.add(n);return Array.from(e)}getRegisteredFunctionIds(){return Array.from(this.functions.keys())}categorizeFunction(e,t){t.isVolatile&&this.volatileFunctions.add(e),t.arrayFunction&&this.arrayFunctions.add(e),t.doesNotNeedArgumentsToBeComputed&&this.functionsWhichDoesNotNeedArgumentsToBeComputed.add(e),t.isDependentOnSheetStructureChange&&this.structuralChangeFunctions.add(e),this.functionsMetadata.set(e,t)}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
var a8;s8.plugins=new Map,s8._protectedPlugins=new Map([["VERSION",i8],["OFFSET",void 0]]),function(e){e.GREATER_THAN="GREATER_THAN",e.GREATER_THAN_OR_EQUAL="GREATER_THAN_OR_EQUAL",e.LESS_THAN="LESS_THAN",e.LESS_THAN_OR_EQUAL="LESS_THAN_OR_EQUAL",e.NOT_EQUAL="NOT_EQUAL",e.EQUAL="EQUAL"}(a8||(a8={}));const l8=(e,t)=>({operator:e,value:t});class h8{constructor(e){var t,n,r,i;this.trueString=null!==(n=null===(t=e.translationPackage.getMaybeFunctionTranslation("TRUE"))||void 0===t?void 0:t.toLowerCase())&&void 0!==n?n:"true",this.falseString=null!==(i=null===(r=e.translationPackage.getMaybeFunctionTranslation("FALSE"))||void 0===r?void 0:r.toLowerCase())&&void 0!==i?i:"false"}fromCellValue(e,t){if("string"!=typeof e&&"boolean"!=typeof e&&"number"!=typeof e)return;const n=this.parseCriterion(e,t);return void 0!==n?{raw:e,lambda:c8(n,t)}:void 0}parseCriterion(e,t){if("number"==typeof e||"boolean"==typeof e)return l8(a8.EQUAL,e);if("string"==typeof e){const n=u8.exec(e);let r,i;n?(i=function(e){switch(e){case">":return a8.GREATER_THAN;case">=":return a8.GREATER_THAN_OR_EQUAL;case"<":return a8.LESS_THAN;case"<=":return a8.LESS_THAN_OR_EQUAL;case"<>":return a8.NOT_EQUAL;case"=":return a8.EQUAL;default:return}}(n[1]),r=n[2]):(i=a8.EQUAL,r=e);const o=t.coerceToMaybeNumber(r),s=r.toLowerCase()===this.trueString||r.toLowerCase()!==this.falseString&&void 0;if(void 0===i)return;if(""===r)return l8(i,null);if(void 0!==o)return l8(i,L3(o));if(i===a8.EQUAL||i===a8.NOT_EQUAL)return l8(i,null!=s?s:r)}}}const u8=/([<>=]+)(.*)/;const c8=(e,t)=>{switch(e.operator){case a8.GREATER_THAN:return"number"==typeof e.value?n=>"number"==typeof n&&t.floatCmp(n,e.value)>0:e=>!1;case a8.GREATER_THAN_OR_EQUAL:return"number"==typeof e.value?n=>"number"==typeof n&&t.floatCmp(n,e.value)>=0:e=>!1;case a8.LESS_THAN:return"number"==typeof e.value?n=>"number"==typeof n&&t.floatCmp(n,e.value)<0:e=>!1;case a8.LESS_THAN_OR_EQUAL:return"number"==typeof e.value?n=>"number"==typeof n&&t.floatCmp(n,e.value)<=0:e=>!1;case a8.EQUAL:return"number"==typeof e.value?n=>{if("number"==typeof n)return 0===t.floatCmp(n,e.value);if("string"==typeof n){if(""===n)return!1;const r=t.coerceToMaybeNumber(n);return void 0!==r&&0===t.floatCmp(r,e.value)}return!1}:"string"==typeof e.value?t.eqMatcherFunction(e.value):"boolean"==typeof e.value?t=>"boolean"==typeof t&&t===e.value:e=>e===_3;case a8.NOT_EQUAL:return"number"==typeof e.value?n=>{if("number"==typeof n)return 0!==t.floatCmp(n,e.value);if("string"==typeof n){if(""===n)return!0;const r=t.coerceToMaybeNumber(n);return void 0===r||0!==t.floatCmp(r,e.value)}return!0}:"string"==typeof e.value?t.neqMatcherFunction(e.value):"boolean"==typeof e.value?t=>"boolean"!=typeof t||t!==e.value:e=>e!==_3}};
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class d8{constructor(e,t,n,r,i,o,s,a,l,h){this.config=e,this.dependencyGraph=t,this.columnSearch=n,this.stats=r,this.arithmeticHelper=i,this.functionRegistry=o,this.namedExpressions=s,this.serialization=a,this.arraySizePredictor=l,this.dateTimeHelper=h,this.equalOp=(e,t)=>g8(this.arithmeticHelper.eq,e,t),this.notEqualOp=(e,t)=>g8(this.arithmeticHelper.neq,e,t),this.greaterThanOp=(e,t)=>g8(this.arithmeticHelper.gt,e,t),this.lessThanOp=(e,t)=>g8(this.arithmeticHelper.lt,e,t),this.greaterThanOrEqualOp=(e,t)=>g8(this.arithmeticHelper.geq,e,t),this.lessThanOrEqualOp=(e,t)=>g8(this.arithmeticHelper.leq,e,t),this.concatOp=(e,t)=>g8(this.arithmeticHelper.concat,V4(e),V4(t)),this.plusOp=(e,t)=>g8(this.arithmeticHelper.addWithEpsilon,this.arithmeticHelper.coerceScalarToNumberOrError(e),this.arithmeticHelper.coerceScalarToNumberOrError(t)),this.minusOp=(e,t)=>g8(this.arithmeticHelper.subtract,this.arithmeticHelper.coerceScalarToNumberOrError(e),this.arithmeticHelper.coerceScalarToNumberOrError(t)),this.timesOp=(e,t)=>g8(this.arithmeticHelper.multiply,this.arithmeticHelper.coerceScalarToNumberOrError(e),this.arithmeticHelper.coerceScalarToNumberOrError(t)),this.powerOp=(e,t)=>g8(this.arithmeticHelper.pow,this.arithmeticHelper.coerceScalarToNumberOrError(e),this.arithmeticHelper.coerceScalarToNumberOrError(t)),this.divOp=(e,t)=>g8(this.arithmeticHelper.divide,this.arithmeticHelper.coerceScalarToNumberOrError(e),this.arithmeticHelper.coerceScalarToNumberOrError(t)),this.unaryMinusOp=e=>p8(this.arithmeticHelper.unaryMinus,this.arithmeticHelper.coerceScalarToNumberOrError(e)),this.percentOp=e=>p8(this.arithmeticHelper.unaryPercent,this.arithmeticHelper.coerceScalarToNumberOrError(e)),this.unaryPlusOp=e=>this.arithmeticHelper.unaryPlus(e),this.functionRegistry.initializePlugins(this),this.criterionBuilder=new h8(e)}evaluateAst(e,t){let n=this.evaluateAstWithoutPostprocessing(e,t);if(W3(n)){if(W4(L3(n)))return new g4(X9.NUM,W2.NaN);n=k3(n,j4(L3(n)))}return n instanceof $3&&1===n.height()&&1===n.width()&&([[n]]=n.data),function(e,t){if(e instanceof g4&&void 0!==t)return e.attachRootVertex(t);return e}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */(n,t.formulaVertex)}evaluateAstWithoutPostprocessing(e,t){switch(e.type){case I2.EMPTY:return _3;case I2.CELL_REFERENCE:{const n=e.reference.toSimpleCellAddress(t.formulaAddress);return C4(n)?new g4(X9.REF,W2.BadRef):this.dependencyGraph.getCellValue(n)}case I2.NUMBER:case I2.STRING:return e.value;case I2.CONCATENATE_OP:{const n=this.evaluateAst(e.left,t),r=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.concatOp,n,r,t)}case I2.EQUALS_OP:{const n=this.evaluateAst(e.left,t),r=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.equalOp,n,r,t)}case I2.NOT_EQUAL_OP:{const n=this.evaluateAst(e.left,t),r=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.notEqualOp,n,r,t)}case I2.GREATER_THAN_OP:{const n=this.evaluateAst(e.left,t),r=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.greaterThanOp,n,r,t)}case I2.LESS_THAN_OP:{const n=this.evaluateAst(e.left,t),r=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.lessThanOp,n,r,t)}case I2.GREATER_THAN_OR_EQUAL_OP:{const n=this.evaluateAst(e.left,t),r=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.greaterThanOrEqualOp,n,r,t)}case I2.LESS_THAN_OR_EQUAL_OP:{const n=this.evaluateAst(e.left,t),r=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.lessThanOrEqualOp,n,r,t)}case I2.PLUS_OP:{const n=this.evaluateAst(e.left,t),r=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.plusOp,n,r,t)}case I2.MINUS_OP:{const n=this.evaluateAst(e.left,t),r=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.minusOp,n,r,t)}case I2.TIMES_OP:{const n=this.evaluateAst(e.left,t),r=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.timesOp,n,r,t)}case I2.POWER_OP:{const n=this.evaluateAst(e.left,t),r=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.powerOp,n,r,t)}case I2.DIV_OP:{const n=this.evaluateAst(e.left,t),r=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.divOp,n,r,t)}case I2.PLUS_UNARY_OP:{const n=this.evaluateAst(e.value,t);return this.unaryRangeWrapper(this.unaryPlusOp,n,t)}case I2.MINUS_UNARY_OP:{const n=this.evaluateAst(e.value,t);return this.unaryRangeWrapper(this.unaryMinusOp,n,t)}case I2.PERCENT_OP:{const n=this.evaluateAst(e.value,t);return this.unaryRangeWrapper(this.percentOp,n,t)}case I2.FUNCTION_CALL:{if("valid"!==this.config.licenseKeyValidityState&&!s8.functionIsProtected(e.procedureName))return new g4(X9.LIC,W2.LicenseKey(this.config.licenseKeyValidityState));const n=this.functionRegistry.getFunction(e.procedureName);return void 0!==n?n(e,new x4(t.formulaAddress,t.arraysFlag||this.functionRegistry.isArrayFunction(e.procedureName),t.formulaVertex)):new g4(X9.NAME,W2.FunctionName(e.procedureName))}case I2.NAMED_EXPRESSION:{const n=this.namedExpressions.nearestNamedExpression(e.expressionName,t.formulaAddress.sheet);return n?this.dependencyGraph.getCellValue(n.address):new g4(X9.NAME,W2.NamedExpressionName(e.expressionName))}case I2.CELL_RANGE:{if(!this.rangeSpansOneSheet(e))return new g4(X9.REF,W2.RangeManySheets);const n=M4.fromCellRange(e,t.formulaAddress),r=this.dependencyGraph.getArray(n);if(r){const e=r.array;if(e instanceof P9)throw new Error("Array should be already computed");if(e instanceof g4)return e;if(e instanceof _9)return $3.fromRange(e.raw(),n,this.dependencyGraph);throw new Error("Unknown array")}return $3.onlyRange(n,this.dependencyGraph)}case I2.COLUMN_RANGE:{if(!this.rangeSpansOneSheet(e))return new g4(X9.REF,W2.RangeManySheets);const n=I4.fromColumnRange(e,t.formulaAddress);return $3.onlyRange(n,this.dependencyGraph)}case I2.ROW_RANGE:{if(!this.rangeSpansOneSheet(e))return new g4(X9.REF,W2.RangeManySheets);const n=O4.fromRowRangeAst(e,t.formulaAddress);return $3.onlyRange(n,this.dependencyGraph)}case I2.PARENTHESIS:return this.evaluateAst(e.expression,t);case I2.ARRAY:{let n;const r=[];for(const i of e.args){let e;const o=[];for(const n of i){const r=H4(this.evaluateAst(n,t)),i=r.height();if(void 0===e)e=i,o.push(...r.data);else{if(e!==i)return new g4(X9.REF,W2.SizeMismatch);for(let e=0;e<i;e++)o[e].push(...r.data[e])}}const s=o[0].length;if(void 0===n)n=s,r.push(...o);else{if(n!==s)return new g4(X9.REF,W2.SizeMismatch);r.push(...o)}}return $3.onlyValues(r)}case I2.ERROR_WITH_RAW_INPUT:case I2.ERROR:return e.error}}rangeSpansOneSheet(e){return e.start.sheet===e.end.sheet}unaryRangeWrapper(e,t,n){var r;if(t instanceof $3&&!n.arraysFlag&&(t=null!==(r=q4(t,n))&&void 0!==r?r:new g4(X9.VALUE,W2.ScalarExpected)),t instanceof g4)return t;if(t instanceof $3){const n=t.data.map((t=>t.map(e)));return $3.onlyValues(n)}return e(t)}binaryRangeWrapper(e,t,n,r){var i,o;if(t instanceof $3&&!r.arraysFlag&&(t=null!==(i=q4(t,r))&&void 0!==i?i:new g4(X9.VALUE,W2.ScalarExpected)),t instanceof g4)return t;if(n instanceof $3&&!r.arraysFlag&&(n=null!==(o=q4(n,r))&&void 0!==o?o:new g4(X9.VALUE,W2.ScalarExpected)),n instanceof g4)return n;if(t instanceof $3||n instanceof $3){if(!(t instanceof $3)){if(n.isAdHoc()){const r=n.data;for(let n=0;n<r.length;n++)for(let i=0;i<r[0].length;i++)r[n][i]=e(t,r[n][i]);return $3.onlyValues(r)}t=$3.fromScalar(t)}if(!(n instanceof $3)){if(t.isAdHoc()){const r=t.data;for(let t=0;t<r.length;t++)for(let i=0;i<r[0].length;i++)r[t][i]=e(r[t][i],n);return $3.onlyValues(r)}n=$3.fromScalar(n)}if(t.width()===n.width()&&t.height()===n.height()){if(t.isAdHoc()){const r=t.data,i=n.data;for(let t=0;t<r.length;t++)for(let n=0;n<r[0].length;n++)r[t][n]=e(r[t][n],i[t][n]);return $3.onlyValues(r)}if(n.isAdHoc()){const r=t.data,i=n.data;for(let t=0;t<r.length;t++)for(let n=0;n<r[0].length;n++)i[t][n]=e(r[t][n],i[t][n]);return $3.onlyValues(i)}}const r=Math.max(t.width(),n.width()),i=Math.max(t.height(),n.height()),o=Array(i);for(let e=0;e<i;e++)o[e]=Array(r);for(let s=0;s<i;s++){const i=1!==t.height()?s:0,a=1!==n.height()?s:0;for(let l=0;l<r;l++){const r=1!==t.width()?l:0,h=1!==n.width()?l:0;i<t.height()&&a<n.height()&&r<t.width()&&h<n.width()?o[s][l]=e(t.data[i][r],n.data[a][h]):o[s][l]=new g4(X9.NA)}}return $3.onlyValues(o)}return e(t,n)}}function p8(e,t){return t instanceof g4?t:e(t)}function g8(e,t,n){return t instanceof g4?t:n instanceof g4?n:e(t,n)}class m8{constructor(e){this.sheet=e,this.transformations=[]}add(e){this.transformations.push(e)}performEagerTransformations(e,t){this.transformations.forEach((n=>n.performEagerTransformations(e,t)))}transformSingleAst(e,t){let[n,r]=[e,t];return this.transformations.forEach((e=>{[n,r]=e.transformSingleAst(n,r)})),[n,r]}isIrreversible(){return!0}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class f8{constructor(e){this.stats=e,this.transformations=[]}version(){return this.transformations.length}addTransformation(e){return void 0!==this.combinedTransformer?this.combinedTransformer.add(e):this.transformations.push(e),this.version()}beginCombinedMode(e){this.combinedTransformer=new m8(e)}commitCombinedMode(){if(void 0===this.combinedTransformer)throw Error("Combined mode wasn't started");return this.transformations.push(this.combinedTransformer),this.combinedTransformer=void 0,this.version()}applyTransformations(e,t,n){this.stats.start(G3.TRANSFORM_ASTS_POSTPONED);for(let i=n;i<this.transformations.length;i++){const n=this.transformations[i];n.isIrreversible()&&(this.undoRedo.storeDataForVersion(i,t,this.parser.computeHashFromAst(e)),this.parser.rememberNewAst(e));const[r,o]=n.transformSingleAst(e,t);e=r,t=o}const r=this.parser.rememberNewAst(e);return this.stats.end(G3.TRANSFORM_ASTS_POSTPONED),[r,t,this.transformations.length]}*getTransformationsFrom(e,t){for(let n=e;n<this.transformations.length;n++){const e=this.transformations[n];t&&!t(e)||(yield e)}}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */const w8=-1;function y8(e,t,{searchCoordinate:n,orderingDirection:r,ifNoMatch:i},o){const s=t.start[n],a="col"===n?t.effectiveEndColumn(o):t.effectiveEndRow(o),l="col"===n?e=>L3(o.getCellValue(v4(t.sheet,e,t.start.row))):e=>L3(o.getCellValue(v4(t.sheet,t.start.col,e))),h="asc"===r?(e,t)=>v8(e,t):(e,t)=>-v8(e,t),u=function(e,t,n){let r=t,i=n;for(;r<i;){const t=Math.ceil((r+i)/2);e(t)?r=t:i=t-1}if(r===i&&e(r))return r;return w8}((t=>h(e,l(t))>=0),s,a),c=l(u);if(c===e)return u-s;if("returnLowerBound"===i){if(u===w8)return"asc"===r?w8:0;if(typeof c!=typeof e)return w8;if("asc"===r)return u-s;const t=u+1;return t<=a?t-s:w8}if("returnUpperBound"===i){if(u===w8)return"asc"===r?0:w8;if(typeof c!=typeof e)return w8;if("desc"===r)return u-s;const t=u+1;return t<=a?t-s:w8}return w8}function v8(e,t){return typeof e==typeof t?e===_3?0:e<t?-1:e>t?1:0:e===_3?-1:t===_3?1:t instanceof g4||"number"==typeof e&&"string"==typeof t||"number"==typeof e&&"boolean"==typeof t?-1:"string"==typeof e&&"number"==typeof t?1:"string"==typeof e&&"boolean"==typeof t?-1:1}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class C8{constructor(e){this.dependencyGraph=e}advancedFind(e,t,{returnOccurrence:n}={returnOccurrence:"first"}){const r=t.range,i=void 0===r?t.valuesFromTopLeftCorner():this.dependencyGraph.computeListOfValuesInRange(r),o="first"===n?e=>e<i.length:e=>e>=0,s="first"===n?e=>e+1:e=>e-1;for(let a="first"===n?0:i.length-1;o(a);a=s(a))if(e(L3(i[a])))return a;return-1}basicFind(e,t,n,{ordering:r,ifNoMatch:i,returnOccurrence:o}){const s="string"==typeof e?X4(e):e,a=t.range;return void 0===a?this.findNormalizedValue(s,t.valuesFromTopLeftCorner(),i,o):"none"===r?this.findNormalizedValue(s,this.dependencyGraph.computeListOfValuesInRange(a),i,o):y8(s,a,{searchCoordinate:n,orderingDirection:r,ifNoMatch:i},this.dependencyGraph)}findNormalizedValue(e,t,n="returnNotFound",r="first"){const i=t.map(L3).map((e=>"string"==typeof e?X4(e):e));if("returnNotFound"===n)return"first"===r?i.indexOf(e):i.lastIndexOf(e);const o="returnLowerBound"===n?(e,t)=>v8(e,t):(e,t)=>-v8(e,t);let s="returnLowerBound"===n?-1/0:1/0,a=-1;const l="first"===r?e=>e<i.length:e=>e>=0,h="first"===r?e=>e+1:e=>e-1;for(let u="first"===r?0:i.length-1;l(u);u=h(u)){const t=i[u];if(t===e)return u;o(t,e)>0||o(s,t)<0&&(s=t,a=u)}return a}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class S8 extends C8{constructor(e){super(e),this.dependencyGraph=e}add(e,t){}remove(e,t){}change(e,t,n){}applyChanges(e){}addColumns(e){}removeColumns(e){}removeSheet(e){}moveValues(e,t,n,r){}removeValues(e){}find(e,t,n){return this.basicFind(e,t,"row",n)}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class R8{constructor(e,t,n){this.dependencyGraph=e,this.config=t,this.stats=n,this.index=new Map,this.transformingService=this.dependencyGraph.lazilyTransformingAstService,this.binarySearchStrategy=new S8(e)}add(e,t){if(!(e===_3||e instanceof g4))if(e instanceof $3)for(const[n,r]of e.entriesFromTopLeftCorner(t))this.addSingleCellValue(L3(n),r);else this.addSingleCellValue(e,t)}remove(e,t){if(void 0!==e)if(e instanceof $3)for(const[n,r]of e.entriesFromTopLeftCorner(t))this.removeSingleValue(L3(n),r);else this.removeSingleValue(e,t)}change(e,t,n){e!==t&&(this.remove(e,n),this.add(t,n))}applyChanges(e){for(const t of e)void 0!==t.oldValue&&this.change(L3(t.oldValue),L3(t.value),t.address)}moveValues(e,t,n,r){for(const[i,o]of e){const e=S4(o,r,t,n);this.remove(i,o),this.add(i,e)}}removeValues(e){for(const[t,n]of e)this.remove(t,n)}find(e,t,{ordering:n,ifNoMatch:r,returnOccurrence:i}){null==i&&(i="none"===n?"first":"last");const o=this.findUsingColumnIndex(e,t,i);return void 0!==o?o:this.binarySearchStrategy.find(e,t,{ordering:n,ifNoMatch:r,returnOccurrence:i})}findUsingColumnIndex(e,t,n){const r=t.range;if(void 0===r)return;this.ensureRecentData(r.sheet,r.start.col,e);const i=this.getColumnMap(r.sheet,r.start.col);if(!i)return-1;const o="string"==typeof e?X4(e):e,s=i.get(o);if(!s||!s.index||0===s.index.length)return;const a=R8.findRowBelongingToRange(s,r,n);return void 0!==a?a-r.start.row:void 0}static findRowBelongingToRange(e,t,n){const r=t.start.row,i=t.end.row,o="first"===n?E8(r,e.index,"upperBound"):E8(i,e.index,"lowerBound");if(-1===o)return;const s=e.index[o];return s>=r&&s<=i?s:void 0}advancedFind(e,t,n={returnOccurrence:"first"}){return this.binarySearchStrategy.advancedFind(e,t,n)}addColumns(e){const t=this.index.get(e.sheet);t&&t.splice(e.columnStart,0,...Array(e.numberOfColumns))}removeColumns(e){const t=this.index.get(e.sheet);t&&t.splice(e.columnStart,e.numberOfColumns)}removeSheet(e){this.index.delete(e)}getColumnMap(e,t){this.index.has(e)||this.index.set(e,[]);const n=this.index.get(e);let r=n[t];return r||(r=new Map,n[t]=r),r}getValueIndex(e,t,n){const r=this.getColumnMap(e,t);let i=this.getColumnMap(e,t).get(n);return i||(i={version:this.transformingService.version(),index:[]},r.set(n,i)),i}ensureRecentData(e,t,n){const r=this.getValueIndex(e,t,n),i=this.transformingService.version();if(r.version===i)return;const o=this.transformingService.getTransformationsFrom(r.version,(t=>t.sheet===e&&(t instanceof h6||t instanceof g6)));for(const s of o)s instanceof h6?this.addRows(t,s.rowsSpan,n):s instanceof g6&&this.removeRows(t,s.rowsSpan,n);r.version=i}addSingleCellValue(e,t){this.stats.measure(G3.BUILD_COLUMN_INDEX,(()=>{this.ensureRecentData(t.sheet,t.col,e),"string"==typeof e&&(e=X4(e));const n=this.getValueIndex(t.sheet,t.col,e);R8.addValue(n,t.row)}))}removeSingleValue(e,t){this.stats.measure(G3.BUILD_COLUMN_INDEX,(()=>{this.ensureRecentData(t.sheet,t.col,e);const n=this.getColumnMap(t.sheet,t.col);"string"==typeof e&&(e=X4(e));const r=n.get(e);if(!r)return;const i=E8(t.row,r.index);i>-1&&r.index.splice(i,1),0===r.index.length&&n.delete(e),0===n.size&&delete this.index.get(t.sheet)[t.col]}))}addRows(e,t,n){const r=this.getValueIndex(t.sheet,e,n);R8.shiftRows(r,t.rowStart,t.numberOfRows)}removeRows(e,t,n){const r=this.getValueIndex(t.sheet,e,n);R8.removeRowsFromValues(r,t),R8.shiftRows(r,t.rowEnd+1,-t.numberOfRows)}static addValue(e,t){const n=E8(t,e.index,"lowerBound");e.index[n]===t||e.index.splice(n+1,0,t)}static removeRowsFromValues(e,t){const n=E8(t.rowStart,e.index,"upperBound"),r=E8(t.rowEnd,e.index,"lowerBound");n>-1&&r>-1&&n<=r&&e.index[n]<=t.rowEnd&&e.index.splice(n,r-n+1)}static shiftRows(e,t,n){const r=E8(t,e.index,"upperBound");if(-1!==r)for(let i=r;i<e.index.length;++i)e.index[i]+=n}}function E8(e,t,n="upperBound"){let r=0,i=t.length-1;for(;r<=i;){const n=Math.floor((r+i)/2);if(e>t[n])r=n+1;else{if(!(e<t[n]))return n;i=n-1}}const o="lowerBound"===n?i:r;return o>=0&&o<=t.length?o:-1}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
class b8{constructor(e){this.config=e;const t="."===this.config.thousandSeparator?`\\${this.config.thousandSeparator}`:this.config.thousandSeparator,n="."===this.config.decimalSeparator?`\\${this.config.decimalSeparator}`:this.config.decimalSeparator;this.numberPattern=new RegExp(`^([+-]?((${n}\\d+)|(\\d+(${t}\\d{3,})*(${n}\\d*)?)))(e[+-]?\\d+)?$`),this.allThousandSeparatorsRegex=new RegExp(`${t}`,"g")}numericStringToMaybeNumber(e){if(this.numberPattern.test(e)){const t=this.numericStringToNumber(e);if(isNaN(t))return;return t}}numericStringToNumber(e){const t=e.replace(this.allThousandSeparatorsRegex,"").replace(this.config.decimalSeparator,".");return Number(t)}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class T8{constructor(e,t,n){this.dependencyGraph=e,this.unparser=t,this.exporter=n}getCellHyperlink(e){const t=this.dependencyGraph.getCell(e);if(t instanceof F9){const e=t.getFormula(this.dependencyGraph.lazilyTransformingAstService);if("HYPERLINK"===e.procedureName)return e.hyperlink}}getCellFormula(e,t){const n=this.dependencyGraph.getCell(e);if(n instanceof F9){const r=n.getFormula(this.dependencyGraph.lazilyTransformingAstService);return t=null!=t?t:e,this.unparser.unparse(r,t)}if(n instanceof k9){const r=n.getAddress(this.dependencyGraph.lazilyTransformingAstService);if(r.row!==e.row||r.col!==e.col||r.sheet!==e.sheet)return;t=null!=t?t:e;const i=n.getFormula(this.dependencyGraph.lazilyTransformingAstService);if(void 0!==i)return this.unparser.unparse(i,t)}else if(n instanceof r4)return n.getFormula()}getCellSerialized(e,t){var n;return null!==(n=this.getCellFormula(e,t))&&void 0!==n?n:this.getRawValue(e)}getCellValue(e){return this.exporter.exportValue(this.dependencyGraph.getScalarValue(e))}getRawValue(e){return this.dependencyGraph.getRawValue(e)}getSheetValues(e){return this.genericSheetGetter(e,(e=>this.getCellValue(e)))}getSheetFormulas(e){return this.genericSheetGetter(e,(e=>this.getCellFormula(e)))}genericSheetGetter(e,t){const n=this.dependencyGraph.getSheetHeight(e),r=this.dependencyGraph.getSheetWidth(e),i=new Array(n);for(let o=0;o<n;o++){i[o]=new Array(r);for(let n=0;n<r;n++){const r=v4(e,n,o);i[o][n]=t(r)}for(let e=r-1;e>=0&&(null===i[o][e]||void 0===i[o][e]);e--)i[o].pop()}for(let o=n-1;o>=0&&0===i[o].length;o--)i.pop();return i}genericAllSheetsGetter(e){const t={};for(const n of this.dependencyGraph.sheetMapping.displayNames()){const r=this.dependencyGraph.sheetMapping.fetch(n);t[n]=e(r)}return t}getSheetSerialized(e){return this.genericSheetGetter(e,(e=>this.getCellSerialized(e)))}getAllSheetsValues(){return this.genericAllSheetsGetter((e=>this.getSheetValues(e)))}getAllSheetsFormulas(){return this.genericAllSheetsGetter((e=>this.getSheetFormulas(e)))}getAllSheetsSerialized(){return this.genericAllSheetsGetter((e=>this.getSheetSerialized(e)))}getAllNamedExpressionsSerialized(){const e=[];let t=0;for(const n of this.dependencyGraph.sheetMapping.displayNames()){const r=this.dependencyGraph.sheetMapping.fetch(n);e[r]=t,t++}return this.dependencyGraph.namedExpressions.getAllNamedExpressions().map((t=>({name:t.expression.displayName,expression:this.getCellSerialized(t.expression.address),scope:void 0!==t.scope?e[t.scope]:void 0,options:t.expression.options})))}withNewConfig(e,t){const n=new R3(e,v3(e),this.dependencyGraph.sheetMapping.fetchDisplayName,t);return new T8(this.dependencyGraph,n,this.exporter)}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class N8{static buildFromSheets(e,t={},n=[]){const r=new H8(t);return this.buildEngine(r,e,n)}static buildFromSheet(e,t={},n=[]){const r=new H8(t),i=r.translationPackage.getUITranslation(K9.NEW_SHEET_PREFIX)+"1";return this.buildEngine(r,{[i]:e},n)}static buildEmpty(e={},t=[]){return this.buildEngine(new H8(e),{},t)}static rebuildWithConfig(e,t,n,r){return this.buildEngine(e,t,n,r)}static buildEngine(e,t={},n=[],r=(e.useStats?new q3:new Q3)){r.start(G3.BUILD_ENGINE_TOTAL);const i=new o6,o=new s8(e),s=new f8(r),a=e4.buildEmpty(s,e,o,i,r),l=function(e,t,n){return t.useColumnIndex?new R8(e,t,n):new S8(e)}(a,e,r),h=a.sheetMapping,u=a.addressMapping;for(const N in t)if(Object.prototype.hasOwnProperty.call(t,N)){const n=t[N];f6(n);const r=w6(n);if(r.height>e.maxRows||r.width>e.maxColumns)throw new t9;const i=h.addSheet(N);u.autoAddSheet(i,r)}const c=new b3(e,o,h.get);s.parser=c;const d=new R3(e,v3(e),h.fetchDisplayName,i),p=new R5(e),g=new b8(e),m=new _4(e,p,g),f=new J5(e,p,g),w=new t5(e,o),y=new R6(e,a,l,f,c,r,s,i,w),v=new Y6(e,y);s.undoRedo=v;const C=new t6(e,a,y),S=new K6(e,y,v,C,a,l,c,f,s,i);n.forEach((e=>{S.ensureItIsPossibleToAddNamedExpression(e.name,e.expression,e.scope),S.operations.addNamedExpression(e.name,e.expression,e.scope,e.options)}));const R=new e8(e,i,h.fetchDisplayName,s),E=new T8(a,d,R),b=new d8(e,a,l,r,m,o,i,E,w,p);r.measure(G3.GRAPH_BUILD,(()=>{new t8(a,l,c,f,r,w).buildGraph(t,r)}));const T=new Q6(e,r,b,s,a,l);return T.run(),r.end(G3.BUILD_ENGINE_TOTAL),{config:e,stats:r,dependencyGraph:a,columnSearch:l,parser:c,unparser:d,cellContentParser:f,evaluator:T,lazilyTransformingAstService:s,crudOperations:S,exporter:R,namedExpressions:i,serialization:E,functionRegistry:o}}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */function A8(e){return()=>{throw new Error(`The "${e}" method cannot be called because this HyperFormula instance has been destroyed`)}}var M8={exports:{}};function I8(){}I8.prototype={on:function(e,t,n){var r=this.e||(this.e={});return(r[e]||(r[e]=[])).push({fn:t,ctx:n}),this},once:function(e,t,n){var r=this;function i(){r.off(e,i),t.apply(n,arguments)}return i._=t,this.on(e,i,n)},emit:function(e){for(var t=[].slice.call(arguments,1),n=((this.e||(this.e={}))[e]||[]).slice(),r=0,i=n.length;r<i;r++)n[r].fn.apply(n[r].ctx,t);return this},off:function(e,t){var n=this.e||(this.e={}),r=n[e],i=[];if(r&&t)for(var o=0,s=r.length;o<s;o++)r[o].fn!==t&&r[o].fn._!==t&&i.push(r[o]);return i.length?n[e]=i:delete n[e],this}},M8.exports=I8;var O8,x8=M8.exports.TinyEmitter=I8;
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */!function(e){e.SheetAdded="sheetAdded",e.SheetRemoved="sheetRemoved",e.SheetRenamed="sheetRenamed",e.NamedExpressionAdded="namedExpressionAdded",e.NamedExpressionRemoved="namedExpressionRemoved",e.ValuesUpdated="valuesUpdated",e.EvaluationSuspended="evaluationSuspended",e.EvaluationResumed="evaluationResumed"}(O8||(O8={}));class P8 extends x8{emit(e,...t){return super.emit(e,...t),this}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class _8{constructor(e,t,n,r,i,o,s,a,l,h,u,c,d,p){this._config=e,this._stats=t,this._dependencyGraph=n,this._columnSearch=r,this._parser=i,this._unparser=o,this._cellContentParser=s,this._evaluator=a,this._lazilyTransformingAstService=l,this._crudOperations=h,this._exporter=u,this._namedExpressions=c,this._serialization=d,this._functionRegistry=p,this._emitter=new P8,this._evaluationSuspended=!1}static get defaultConfig(){return k8({})}get graph(){return this.dependencyGraph.graph}get rangeMapping(){return this.dependencyGraph.rangeMapping}get arrayMapping(){return this.dependencyGraph.arrayMapping}get sheetMapping(){return this.dependencyGraph.sheetMapping}get addressMapping(){return this.dependencyGraph.addressMapping}get dependencyGraph(){return this._dependencyGraph}get evaluator(){return this._evaluator}get columnSearch(){return this._columnSearch}get lazilyTransformingAstService(){return this._lazilyTransformingAstService}get licenseKeyValidityState(){return this._config.licenseKeyValidityState}static buildFromArray(e,t={},n=[]){return this.buildFromEngineState(N8.buildFromSheet(e,t,n))}static buildFromSheets(e,t={},n=[]){return this.buildFromEngineState(N8.buildFromSheets(e,t,n))}static buildEmpty(e={},t=[]){return this.buildFromEngineState(N8.buildEmpty(e,t))}static getLanguage(e){a5(e,"string","languageCode");const t=this.registeredLanguages.get(e);if(void 0===t)throw new R9;return t}static registerLanguage(e,t){if(a5(e,"string","languageCode"),this.registeredLanguages.has(e))throw new E9;var n;this.registeredLanguages.set(e,(n=t,new Y9(Object.assign({},n.functions),Object.assign({},n.errors),Object.assign({},n.ui))))}static unregisterLanguage(e){if(a5(e,"string","languageCode"),!this.registeredLanguages.has(e))throw new R9;this.registeredLanguages.delete(e)}static getRegisteredLanguagesCodes(){return Array.from(this.registeredLanguages.keys())}static registerFunctionPlugin(e,t){s8.registerFunctionPlugin(e,t)}static unregisterFunctionPlugin(e){s8.unregisterFunctionPlugin(e)}static registerFunction(e,t,n){a5(e,"string","functionId"),s8.registerFunction(e,t,n)}static unregisterFunction(e){a5(e,"string","functionId"),s8.unregisterFunction(e)}static unregisterAllFunctions(){s8.unregisterAll()}static getRegisteredFunctionNames(e){a5(e,"string","code");const t=s8.getRegisteredFunctionIds();return this.getLanguage(e).getFunctionTranslations(t)}static getFunctionPlugin(e){return a5(e,"string","functionId"),s8.getFunctionPlugin(e)}static getAllFunctionPlugins(){return s8.getPlugins()}static buildFromEngineState(e){return new _8(e.config,e.stats,e.dependencyGraph,e.columnSearch,e.parser,e.unparser,e.cellContentParser,e.evaluator,e.lazilyTransformingAstService,e.crudOperations,e.exporter,e.namedExpressions,e.serialization,e.functionRegistry)}getCellValue(e){if(!E4(e))throw new g9("SimpleCellAddress","cellAddress");return this.ensureEvaluationIsNotSuspended(),this._serialization.getCellValue(e)}getCellFormula(e){if(!E4(e))throw new g9("SimpleCellAddress","cellAddress");return this._serialization.getCellFormula(e)}getCellHyperlink(e){if(!E4(e))throw new g9("SimpleCellAddress","cellAddress");return this.ensureEvaluationIsNotSuspended(),this._serialization.getCellHyperlink(e)}getCellSerialized(e){if(!E4(e))throw new g9("SimpleCellAddress","cellAddress");return this.ensureEvaluationIsNotSuspended(),this._serialization.getCellSerialized(e)}getSheetValues(e){return a5(e,"number","sheetId"),this.ensureEvaluationIsNotSuspended(),this._serialization.getSheetValues(e)}getSheetFormulas(e){return a5(e,"number","sheetId"),this._serialization.getSheetFormulas(e)}getSheetSerialized(e){return a5(e,"number","sheetId"),this.ensureEvaluationIsNotSuspended(),this._serialization.getSheetSerialized(e)}getAllSheetsDimensions(){return this._serialization.genericAllSheetsGetter((e=>this.getSheetDimensions(e)))}getSheetDimensions(e){return a5(e,"number","sheetId"),{width:this.dependencyGraph.getSheetWidth(e),height:this.dependencyGraph.getSheetHeight(e)}}getAllSheetsValues(){return this.ensureEvaluationIsNotSuspended(),this._serialization.getAllSheetsValues()}getAllSheetsFormulas(){return this._serialization.getAllSheetsFormulas()}getAllSheetsSerialized(){return this.ensureEvaluationIsNotSuspended(),this._serialization.getAllSheetsSerialized()}updateConfig(e){Object.entries(e).every((([e,t])=>this._config[e]===t))||this.rebuildWithConfig(e)}getConfig(){return this._config.getConfig()}rebuildAndRecalculate(){this.rebuildWithConfig({})}getStats(){return this._stats.snapshot()}undo(){return this._crudOperations.undo(),this.recomputeIfDependencyGraphNeedsIt()}redo(){return this._crudOperations.redo(),this.recomputeIfDependencyGraphNeedsIt()}isThereSomethingToUndo(){return this._crudOperations.isThereSomethingToUndo()}isThereSomethingToRedo(){return this._crudOperations.isThereSomethingToRedo()}isItPossibleToSetCellContents(e){let t;if(E4(e))t=new M4(e,e);else{if(!N4(e))throw new g9("SimpleCellAddress | SimpleCellRange","address");t=new M4(e.start,e.end)}try{this._crudOperations.ensureRangeInSizeLimits(t);for(const e of t.addresses(this._dependencyGraph))this._crudOperations.ensureItIsPossibleToChangeContent(e)}catch(n){return!1}return!0}setCellContents(e,t){return this._crudOperations.setCellContents(e,t),this.recomputeIfDependencyGraphNeedsIt()}swapRowIndexes(e,t){return a5(e,"number","sheetId"),this._crudOperations.setRowOrder(e,t),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToSwapRowIndexes(e,t){a5(e,"number","sheetId");try{return this._crudOperations.validateSwapRowIndexes(e,t),this._crudOperations.testRowOrderForArrays(e,t),!0}catch(n){return!1}}setRowOrder(e,t){a5(e,"number","sheetId");const n=this._crudOperations.mappingFromOrder(e,t,"row");return this.swapRowIndexes(e,n)}isItPossibleToSetRowOrder(e,t){a5(e,"number","sheetId");try{const n=this._crudOperations.mappingFromOrder(e,t,"row");return this._crudOperations.validateSwapRowIndexes(e,n),this._crudOperations.testRowOrderForArrays(e,n),!0}catch(n){return!1}}swapColumnIndexes(e,t){return a5(e,"number","sheetId"),this._crudOperations.setColumnOrder(e,t),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToSwapColumnIndexes(e,t){a5(e,"number","sheetId");try{return this._crudOperations.validateSwapColumnIndexes(e,t),this._crudOperations.testColumnOrderForArrays(e,t),!0}catch(n){return!1}}setColumnOrder(e,t){a5(e,"number","sheetId");const n=this._crudOperations.mappingFromOrder(e,t,"column");return this.swapColumnIndexes(e,n)}isItPossibleToSetColumnOrder(e,t){a5(e,"number","sheetId");try{const n=this._crudOperations.mappingFromOrder(e,t,"column");return this._crudOperations.validateSwapColumnIndexes(e,n),this._crudOperations.testColumnOrderForArrays(e,n),!0}catch(n){return!1}}isItPossibleToAddRows(e,...t){a5(e,"number","sheetId");const n=b6(t);try{return this._crudOperations.ensureItIsPossibleToAddRows(e,...n),!0}catch(r){return!1}}addRows(e,...t){return a5(e,"number","sheetId"),this._crudOperations.addRows(e,...t),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToRemoveRows(e,...t){a5(e,"number","sheetId");const n=E6(t);try{return this._crudOperations.ensureItIsPossibleToRemoveRows(e,...n),!0}catch(r){return!1}}removeRows(e,...t){return a5(e,"number","sheetId"),this._crudOperations.removeRows(e,...t),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToAddColumns(e,...t){a5(e,"number","sheetId");const n=b6(t);try{return this._crudOperations.ensureItIsPossibleToAddColumns(e,...n),!0}catch(r){return!1}}addColumns(e,...t){return a5(e,"number","sheetId"),this._crudOperations.addColumns(e,...t),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToRemoveColumns(e,...t){a5(e,"number","sheetId");const n=E6(t);try{return this._crudOperations.ensureItIsPossibleToRemoveColumns(e,...n),!0}catch(r){return!1}}removeColumns(e,...t){return a5(e,"number","sheetId"),this._crudOperations.removeColumns(e,...t),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToMoveCells(e,t){if(!E4(t))throw new g9("SimpleCellAddress","destinationLeftCorner");if(!N4(e))throw new g9("SimpleCellRange","source");try{const n=new M4(e.start,e.end);return this._crudOperations.operations.ensureItIsPossibleToMoveCells(n.start,n.width(),n.height(),t),!0}catch(n){return!1}}moveCells(e,t){if(!E4(t))throw new g9("SimpleCellAddress","destinationLeftCorner");if(!N4(e))throw new g9("SimpleCellRange","source");const n=new M4(e.start,e.end);return this._crudOperations.moveCells(n.start,n.width(),n.height(),t),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToMoveRows(e,t,n,r){a5(e,"number","sheetId"),a5(t,"number","startRow"),a5(n,"number","numberOfRows"),a5(r,"number","targetRow");try{return this._crudOperations.ensureItIsPossibleToMoveRows(e,t,n,r),!0}catch(i){return!1}}moveRows(e,t,n,r){return a5(e,"number","sheetId"),a5(t,"number","startRow"),a5(n,"number","numberOfRows"),a5(r,"number","targetRow"),this._crudOperations.moveRows(e,t,n,r),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToMoveColumns(e,t,n,r){a5(e,"number","sheetId"),a5(t,"number","startColumn"),a5(n,"number","numberOfColumns"),a5(r,"number","targetColumn");try{return this._crudOperations.ensureItIsPossibleToMoveColumns(e,t,n,r),!0}catch(i){return!1}}moveColumns(e,t,n,r){return a5(e,"number","sheetId"),a5(t,"number","startColumn"),a5(n,"number","numberOfColumns"),a5(r,"number","targetColumn"),this._crudOperations.moveColumns(e,t,n,r),this.recomputeIfDependencyGraphNeedsIt()}copy(e){if(!N4(e))throw new g9("SimpleCellRange","source");const t=new M4(e.start,e.end);return this._crudOperations.copy(t.start,t.width(),t.height()),this.getRangeValues(e)}cut(e){if(!N4(e))throw new g9("SimpleCellRange","source");const t=new M4(e.start,e.end);return this._crudOperations.cut(t.start,t.width(),t.height()),this.getRangeValues(e)}paste(e){if(!E4(e))throw new g9("SimpleCellAddress","targetLeftCorner");return this.ensureEvaluationIsNotSuspended(),this._crudOperations.paste(e),this.recomputeIfDependencyGraphNeedsIt()}isClipboardEmpty(){return this._crudOperations.isClipboardEmpty()}clearClipboard(){this._crudOperations.clearClipboard()}clearRedoStack(){this._crudOperations.undoRedo.clearRedoStack()}clearUndoStack(){this._crudOperations.undoRedo.clearUndoStack()}getRangeValues(e){if(!N4(e))throw new g9("SimpleCellRange","source");return new M4(e.start,e.end).arrayOfAddressesInRange().map((e=>e.map((e=>this.getCellValue(e)))))}getRangeFormulas(e){if(!N4(e))throw new g9("SimpleCellRange","source");return new M4(e.start,e.end).arrayOfAddressesInRange().map((e=>e.map((e=>this.getCellFormula(e)))))}getRangeSerialized(e){if(!N4(e))throw new g9("SimpleCellRange","source");return new M4(e.start,e.end).arrayOfAddressesInRange().map((e=>e.map((e=>this.getCellSerialized(e)))))}getFillRangeData(e,t,n=!1){if(!N4(e))throw new g9("SimpleCellRange","source");if(!N4(t))throw new g9("SimpleCellRange","target");const r=new M4(e.start,e.end),i=new M4(t.start,t.end);return this.ensureEvaluationIsNotSuspended(),i.arrayOfAddressesInRange().map((i=>i.map((i=>{const o=((i.row-(n?t:e).start.row)%r.height()+r.height())%r.height()+e.start.row,s=((i.col-(n?t:e).start.col)%r.width()+r.width())%r.width()+e.start.col;return this._serialization.getCellSerialized({row:o,col:s,sheet:r.sheet},i)}))))}isItPossibleToAddSheet(e){a5(e,"string","sheetName");try{return this._crudOperations.ensureItIsPossibleToAddSheet(e),!0}catch(t){return!1}}addSheet(e){void 0!==e&&a5(e,"string","sheetName");const t=this._crudOperations.addSheet(e);return this._emitter.emit(O8.SheetAdded,t),t}isItPossibleToRemoveSheet(e){a5(e,"number","sheetId");try{return this._crudOperations.ensureScopeIdIsValid(e),!0}catch(t){return!1}}removeSheet(e){a5(e,"number","sheetId");const t=this.sheetMapping.getDisplayName(e);this._crudOperations.removeSheet(e);const n=this.recomputeIfDependencyGraphNeedsIt();return this._emitter.emit(O8.SheetRemoved,t,n),n}isItPossibleToClearSheet(e){a5(e,"number","sheetId");try{return this._crudOperations.ensureScopeIdIsValid(e),!0}catch(t){return!1}}clearSheet(e){return a5(e,"number","sheetId"),this._crudOperations.clearSheet(e),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToReplaceSheetContent(e,t){a5(e,"number","sheetId");try{return this._crudOperations.ensureScopeIdIsValid(e),this._crudOperations.ensureItIsPossibleToChangeSheetContents(e,t),!0}catch(n){return!1}}setSheetContent(e,t){return a5(e,"number","sheetId"),this._crudOperations.setSheetContent(e,t),this.recomputeIfDependencyGraphNeedsIt()}simpleCellAddressFromString(e,t){return a5(e,"string","cellAddress"),a5(t,"number","sheetId"),iZ(this.sheetMapping.get,e,t)}simpleCellRangeFromString(e,t){return a5(e,"string","cellRange"),a5(t,"number","sheetId"),((e,t,n)=>{const r=t.split(FQ);if(2!==r.length)return;const[i,o]=r,s=iZ(e,i,n);if(void 0===s)return;const a=iZ(e,o,s.sheet);return void 0!==a&&s.sheet===a.sheet?A4(s,a):void 0})(this.sheetMapping.get,e,t)}simpleCellAddressToString(e,t={}){if(!E4(e))throw new g9("SimpleCellAddress","cellAddress");const n="number"==typeof t?t:t.includeSheetName?e.sheet+1:e.sheet;return oZ(this.sheetMapping.fetchDisplayName,e,n)}simpleCellRangeToString(e,t={}){if(!N4(e))throw new g9("SimpleCellRange","cellRange");const n="number"==typeof t?t:t.includeSheetName?e.start.sheet+e.end.sheet+1:e.start.sheet;return((e,t,n)=>{const r=oZ(e,t.start,n),i=oZ(e,t.end,t.start.sheet);return void 0===r||void 0===i?void 0:`${r}${FQ}${i}`})(this.sheetMapping.fetchDisplayName,e,n)}getCellDependents(e){let t;if(E4(e))t=this._dependencyGraph.addressMapping.getCell(e);else{if(!N4(e))throw new g9("SimpleCellAddress | SimpleCellRange",e);t=this._dependencyGraph.rangeMapping.getRange(e.start,e.end)}return void 0===t?[]:this._dependencyGraph.getAdjacentNodesAddresses(t)}getCellPrecedents(e){let t;if(E4(e))t=this._dependencyGraph.addressMapping.getCell(e);else{if(!N4(e))throw new g9("SimpleCellAddress | SimpleCellRange",e);t=this._dependencyGraph.rangeMapping.getRange(e.start,e.end)}return void 0===t?[]:this._dependencyGraph.dependencyQueryAddresses(t)}getSheetName(e){return a5(e,"number","sheetId"),this.sheetMapping.getDisplayName(e)}getSheetNames(){return this.sheetMapping.sheetNames()}getSheetId(e){return a5(e,"string","sheetName"),this.sheetMapping.get(e)}doesSheetExist(e){return a5(e,"string","sheetName"),this.sheetMapping.hasSheetWithName(e)}getCellType(e){if(!E4(e))throw new g9("SimpleCellAddress","cellAddress");return((e,t)=>e instanceof k9?e.isLeftCorner(t)?q9.ARRAYFORMULA:q9.ARRAY:e instanceof F9||e instanceof r4?q9.FORMULA:e instanceof n4?q9.VALUE:q9.EMPTY)(this.dependencyGraph.getCell(e),e)}doesCellHaveSimpleValue(e){if(!E4(e))throw new g9("SimpleCellAddress","cellAddress");return this.getCellType(e)===q9.VALUE}doesCellHaveFormula(e){if(!E4(e))throw new g9("SimpleCellAddress","cellAddress");const t=this.getCellType(e);return t===q9.FORMULA||t===q9.ARRAYFORMULA}isCellEmpty(e){if(!E4(e))throw new g9("SimpleCellAddress","cellAddress");return this.getCellType(e)===q9.EMPTY}isCellPartOfArray(e){if(!E4(e))throw new g9("SimpleCellAddress","cellAddress");const t=this.getCellType(e);return t===q9.ARRAY||t===q9.ARRAYFORMULA}getCellValueType(e){if(!E4(e))throw new g9("SimpleCellAddress","cellAddress");this.ensureEvaluationIsNotSuspended();const t=this.dependencyGraph.getCellValue(e);return c4(t)}getCellValueDetailedType(e){if(!E4(e))throw new g9("SimpleCellAddress","cellAddress");this.ensureEvaluationIsNotSuspended();const t=this.dependencyGraph.getCellValue(e);return d4(t)}getCellValueFormat(e){if(!E4(e))throw new g9("SimpleCellAddress","cellAddress");this.ensureEvaluationIsNotSuspended();const t=this.dependencyGraph.getCellValue(e);return p4(t)}countSheets(){return this.sheetMapping.numberOfSheets()}isItPossibleToRenameSheet(e,t){a5(e,"number","sheetId"),a5(t,"string","newName");try{return this._crudOperations.ensureItIsPossibleToRenameSheet(e,t),!0}catch(n){return!1}}renameSheet(e,t){a5(e,"number","sheetId"),a5(t,"string","newName");const n=this._crudOperations.renameSheet(e,t);void 0!==n&&this._emitter.emit(O8.SheetRenamed,n,t)}batch(e){this.suspendEvaluation(),this._crudOperations.beginUndoRedoBatchMode();try{e()}catch(t){throw this._crudOperations.commitUndoRedoBatchMode(),this.resumeEvaluation(),t}return this._crudOperations.commitUndoRedoBatchMode(),this.resumeEvaluation()}suspendEvaluation(){this._evaluationSuspended=!0,this._emitter.emit(O8.EvaluationSuspended)}resumeEvaluation(){this._evaluationSuspended=!1;const e=this.recomputeIfDependencyGraphNeedsIt();return this._emitter.emit(O8.EvaluationResumed,e),e}isEvaluationSuspended(){return this._evaluationSuspended}isItPossibleToAddNamedExpression(e,t,n){a5(e,"string","expressionName"),void 0!==n&&a5(n,"number","scope");try{return this._crudOperations.ensureItIsPossibleToAddNamedExpression(e,t,n),!0}catch(r){return!1}}addNamedExpression(e,t,n,r){a5(e,"string","expressionName"),void 0!==n&&a5(n,"number","scope"),this._crudOperations.addNamedExpression(e,t,n,r);const i=this.recomputeIfDependencyGraphNeedsIt();return this._emitter.emit(O8.NamedExpressionAdded,e,i),i}getNamedExpressionValue(e,t){a5(e,"string","expressionName"),void 0!==t&&a5(t,"number","scope"),this.ensureEvaluationIsNotSuspended(),this._crudOperations.ensureScopeIdIsValid(t);const n=this._namedExpressions.namedExpressionForScope(e,t);return n?this._serialization.getCellValue(n.address):void 0}getNamedExpressionFormula(e,t){a5(e,"string","expressionName"),void 0!==t&&a5(t,"number","scope"),this._crudOperations.ensureScopeIdIsValid(t);const n=this._namedExpressions.namedExpressionForScope(e,t);return void 0===n?void 0:this._serialization.getCellFormula(n.address)}getNamedExpression(e,t){a5(e,"string","expressionName"),void 0!==t&&a5(t,"number","scope");const n=this._namedExpressions.namedExpressionForScope(e,t);if(void 0===n)return;return{name:e,scope:t,expression:this._serialization.getCellFormula(n.address),options:n.options}}isItPossibleToChangeNamedExpression(e,t,n){a5(e,"string","expressionName"),void 0!==n&&a5(n,"number","scope");try{return this._crudOperations.ensureItIsPossibleToChangeNamedExpression(e,t,n),!0}catch(r){return!1}}changeNamedExpression(e,t,n,r){return a5(e,"string","expressionName"),void 0!==n&&a5(n,"number","scope"),this._crudOperations.changeNamedExpressionExpression(e,n,t,r),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToRemoveNamedExpression(e,t){a5(e,"string","expressionName"),void 0!==t&&a5(t,"number","scope");try{return this._crudOperations.isItPossibleToRemoveNamedExpression(e,t),!0}catch(n){return!1}}removeNamedExpression(e,t){a5(e,"string","expressionName"),void 0!==t&&a5(t,"number","scope");const n=this._crudOperations.removeNamedExpression(e,t);if(n){const e=this.recomputeIfDependencyGraphNeedsIt();return this._emitter.emit(O8.NamedExpressionRemoved,n.displayName,e),e}return[]}listNamedExpressions(e){return void 0!==e&&a5(e,"number","scope"),this._crudOperations.ensureScopeIdIsValid(e),this._namedExpressions.getAllNamedExpressionsNamesInScope(e)}getAllNamedExpressionsSerialized(){return this._serialization.getAllNamedExpressionsSerialized()}normalizeFormula(e){a5(e,"string","formulaString");const{ast:t,address:n}=this.extractTemporaryFormula(e);if(void 0===t)throw new n9;return this._unparser.unparse(t,n)}calculateFormula(e,t){a5(e,"string","formulaString"),a5(t,"number","sheetId"),this._crudOperations.ensureScopeIdIsValid(t);const{ast:n,address:r,dependencies:i}=this.extractTemporaryFormula(e,t);if(void 0===n)throw new n9;const o=this.evaluator.runAndForget(n,r,i);return this._exporter.exportScalarOrRange(o)}getNamedExpressionsFromFormula(e){a5(e,"string","formulaString");const{ast:t,dependencies:n}=this.extractTemporaryFormula(e);if(void 0===t)throw new n9;const r=n.filter((e=>e instanceof x3)).map((e=>e.name));return[...new Set(r)]}validateFormula(e){a5(e,"string","formulaString");const{ast:t}=this.extractTemporaryFormula(e);return void 0!==t}getRegisteredFunctionNames(){return _8.getLanguage(this._config.language).getFunctionTranslations(this._functionRegistry.getRegisteredFunctionIds())}getFunctionPlugin(e){return a5(e,"string","functionId"),this._functionRegistry.getFunctionPlugin(e)}getAllFunctionPlugins(){return this._functionRegistry.getPlugins()}numberToDateTime(e){return a5(e,"number","val"),this._evaluator.interpreter.dateTimeHelper.numberToSimpleDateTime(e)}numberToDate(e){return a5(e,"number","val"),this._evaluator.interpreter.dateTimeHelper.numberToSimpleDate(e)}numberToTime(e){return a5(e,"number","val"),T5(e)}on(e,t){this._emitter.on(e,t)}once(e,t){this._emitter.once(e,t)}off(e,t){this._emitter.off(e,t)}destroy(){!function(e){for(const[t,n]of Object.entries(e))n instanceof Function?e[t]=A8(n):delete e[t]}(this)}ensureEvaluationIsNotSuspended(){if(this._evaluationSuspended)throw new v9}extractTemporaryFormula(e,t=1){const n=this._cellContentParser.parse(e),r={sheet:t,col:0,row:0};if(!(n instanceof q5.Formula))return{address:r,dependencies:[]};const{ast:i,errors:o,dependencies:s}=this._parser.parse(n.formula,r);return o.length>0?{address:r,dependencies:[]}:{ast:i,address:r,dependencies:s}}rebuildWithConfig(e){const t=this._config.mergeConfig(e),n=this._config.mergeConfig({language:e.language}),r=this._serialization.withNewConfig(n,this._namedExpressions).getAllSheetsSerialized(),i=this._serialization.getAllNamedExpressionsSerialized(),o=N8.rebuildWithConfig(t,r,i,this._stats);this._config=o.config,this._stats=o.stats,this._dependencyGraph=o.dependencyGraph,this._columnSearch=o.columnSearch,this._parser=o.parser,this._unparser=o.unparser,this._cellContentParser=o.cellContentParser,this._evaluator=o.evaluator,this._lazilyTransformingAstService=o.lazilyTransformingAstService,this._crudOperations=o.crudOperations,this._exporter=o.exporter,this._namedExpressions=o.namedExpressions,this._serialization=o.serialization,this._functionRegistry=o.functionRegistry}recomputeIfDependencyGraphNeedsIt(){if(this._evaluationSuspended)return[];{const e=this._crudOperations.getAndClearContentChanges(),t=this.dependencyGraph.verticesToRecompute();this.dependencyGraph.clearDirtyVertices(),t.length>0&&e.addAll(this.evaluator.partialRun(t));const n=e.exportChanges(this._exporter);return e.isEmpty()||this._emitter.emit(O8.ValuesUpdated,n),n}}}_8.version="3.0.0",_8.buildDate="14/01/2025 11:44:17",_8.releaseDate="14/01/2025",_8.languages={},_8.registeredLanguages=new Map;
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
const L8=new WeakMap;class H8{constructor(e={},t=!0){const{accentSensitive:n,caseSensitive:r,caseFirst:i,chooseAddressMappingPolicy:o,context:s,currencySymbol:a,dateFormats:l,decimalSeparator:h,evaluateNullToZero:u,functionArgSeparator:c,functionPlugins:d,ignorePunctuation:p,leapYear1900:g,localeLang:m,language:f,ignoreWhiteSpace:w,licenseKey:y,matchWholeCell:v,arrayColumnSeparator:C,arrayRowSeparator:S,maxRows:R,maxColumns:E,nullYear:b,nullDate:T,parseDateTime:N,precisionEpsilon:A,precisionRounding:M,stringifyDateTime:I,stringifyDuration:O,smartRounding:x,timeFormats:P,thousandSeparator:_,useArrayArithmetic:L,useStats:H,undoLimit:k,useColumnIndex:F,useRegularExpressions:D,useWildcards:V}=e;this.useArrayArithmetic=r5(L,"boolean","useArrayArithmetic"),this.accentSensitive=r5(n,"boolean","accentSensitive"),this.caseSensitive=r5(r,"boolean","caseSensitive"),this.caseFirst=r5(i,["upper","lower","false"],"caseFirst"),this.ignorePunctuation=r5(p,"boolean","ignorePunctuation"),this.chooseAddressMappingPolicy=null!=o?o:H8.defaultConfig.chooseAddressMappingPolicy,this.dateFormats=[...o5(l,Array.isArray,"array","dateFormats")],this.timeFormats=[...o5(P,Array.isArray,"array","timeFormats")],this.functionArgSeparator=r5(c,"string","functionArgSeparator"),this.decimalSeparator=r5(h,[".",","],"decimalSeparator"),this.language=r5(f,"string","language"),this.ignoreWhiteSpace=r5(w,["standard","any"],"ignoreWhiteSpace"),this.licenseKey=r5(y,"string","licenseKey"),this.thousandSeparator=r5(_,["",","," ","."],"thousandSeparator"),this.arrayColumnSeparator=r5(C,[",",";"],"arrayColumnSeparator"),this.arrayRowSeparator=r5(S,[";","|"],"arrayRowSeparator"),this.localeLang=r5(m,"string","localeLang"),this.functionPlugins=[...null!=d?d:H8.defaultConfig.functionPlugins],this.smartRounding=r5(x,"boolean","smartRounding"),this.evaluateNullToZero=r5(u,"boolean","evaluateNullToZero"),this.nullYear=r5(b,"number","nullYear"),i5(this.nullYear,"nullYear",0),function(e,t,n){if(e>n)throw new w9(t,n)}(this.nullYear,"nullYear",100),this.precisionRounding=r5(M,"number","precisionRounding"),i5(this.precisionRounding,"precisionRounding",0),this.precisionEpsilon=r5(A,"number","precisionEpsilon"),i5(this.precisionEpsilon,"precisionEpsilon",0),this.useColumnIndex=r5(F,"boolean","useColumnIndex"),this.useStats=r5(H,"boolean","useStats"),this.parseDateTime=r5(N,"function","parseDateTime"),this.stringifyDateTime=r5(I,"function","stringifyDateTime"),this.stringifyDuration=r5(O,"function","stringifyDuration"),this.translationPackage=_8.getLanguage(this.language),this.errorMapping=this.translationPackage.buildErrorMapping(),this.nullDate=o5(T,v5,"IDate","nullDate"),this.leapYear1900=r5(g,"boolean","leapYear1900"),this.undoLimit=r5(k,"number","undoLimit"),this.useRegularExpressions=r5(D,"boolean","useRegularExpressions"),this.useWildcards=r5(V,"boolean","useWildcards"),this.matchWholeCell=r5(v,"boolean","matchWholeCell"),i5(this.undoLimit,"undoLimit",0),this.maxRows=r5(R,"number","maxRows"),i5(this.maxRows,"maxRows",1),this.maxColumns=r5(E,"number","maxColumns"),this.currencySymbol=this.setupCurrencySymbol(a),i5(this.maxColumns,"maxColumns",1),this.context=s,L8.set(this,{licenseKeyValidityState:X5(this.licenseKey)}),s5({value:this.decimalSeparator,name:"decimalSeparator"},{value:this.functionArgSeparator,name:"functionArgSeparator"},{value:this.thousandSeparator,name:"thousandSeparator"}),s5({value:this.arrayRowSeparator,name:"arrayRowSeparator"},{value:this.arrayColumnSeparator,name:"arrayColumnSeparator"})}setupCurrencySymbol(e){const t=[...o5(e,Array.isArray,"array","currencySymbol")];return t.forEach((e=>{if("string"!=typeof e)throw new g9("string[]","currencySymbol");if(""===e)throw new m9("currencySymbol")})),t}get licenseKeyValidityState(){return L8.get(this).licenseKeyValidityState}getConfig(){return k8(this)}mergeConfig(e){const t=Object.assign({},this.getConfig(),e);return new H8(t,!1)}static warnDeprecatedOptions(e){}static warnDeprecatedIfUsed(e,t,n,r){void 0!==e&&(void 0===r?console.warn(`${t} option is deprecated since ${n}`):console.warn(`${t} option is deprecated since ${n}, please use ${r}`))}}function k8(e){var t;const n={};for(const r in H8.defaultConfig){const i=null!==(t=e[r])&&void 0!==t?t:H8.defaultConfig[r];Array.isArray(i)?n[r]=[...i]:n[r]=i}return n}H8.defaultConfig={accentSensitive:!1,currencySymbol:["$"],caseSensitive:!1,caseFirst:"lower",context:void 0,chooseAddressMappingPolicy:new class{call(){return o4}},dateFormats:["DD/MM/YYYY","DD/MM/YY"],decimalSeparator:".",evaluateNullToZero:!1,functionArgSeparator:",",functionPlugins:[],ignorePunctuation:!1,language:"enGB",ignoreWhiteSpace:"standard",licenseKey:"",leapYear1900:!1,localeLang:"en",matchWholeCell:!0,arrayColumnSeparator:",",arrayRowSeparator:";",maxRows:4e4,maxColumns:18278,nullYear:30,nullDate:{year:1899,month:12,day:30},parseDateTime:function(e,t,n){if(void 0===t&&void 0===n)return;let r=e.replace(u5," ").trim().toLowerCase();if(!function(e){return h5.test(e)}(r))return;let i=r.substring(r.length-2);"am"===i||"pm"===i?r=r.substring(0,r.length-2).trim():(i=r.substring(r.length-1),"a"===i||"p"===i?r=r.substring(0,r.length-1).trim():i=void 0);const o=r.split(c5);o.length>=2&&o[o.length-2].includes(":")&&(o[o.length-2]=o[o.length-2]+"."+o[o.length-1],o.pop());const s=o[o.length-1].split(":");if(void 0!==i&&s.push(i),1===o.length)return g5(s,n);if(1===s.length)return m5(o,t);const a=m5(o.slice(0,o.length-1),t),l=g5(s,n);return void 0===a||void 0===l?void 0:Object.assign(Object.assign({},a),l)},precisionEpsilon:1e-13,precisionRounding:10,smartRounding:!0,stringifyDateTime:function(e,t){const n=L5(t);if(void 0===n)return;const r=n.tokens;let i="",o=!1;const s=r.some((e=>e.type===O5.FORMAT&&("a/p"===e.value||"A/P"===e.value||"am/pm"===e.value||"AM/PM"===e.value)));for(let a=0;a<r.length;a++){const t=r[a];if(t.type!==O5.FREE_TEXT)switch(t.value.toLowerCase()){case"h":case"hh":o=!0,i+=D5(s?(e.hours+11)%12+1:e.hours,t.value.length);break;case"d":case"dd":i+=D5(e.day,t.value.length);break;case"s":case"ss":i+=D5(Math.floor(e.seconds),t.value.length);break;case"m":case"mm":a+1<r.length&&r[a+1].value.startsWith(":")&&(o=!0),i+=D5(o?e.minutes:e.month,t.value.length),o=!0;break;case"yy":i+=D5(e.year%100,t.value.length);break;case"yyyy":i+=e.year;break;case"am/pm":case"a/p":{const[n,r]=t.value.split("/");i+=e.hours<12?n:r;break}default:if(l5.test(t.value)){const n=t.value.length-3;i+=`${e.seconds<10?"0":""}${Math.floor(e.seconds*Math.pow(10,n))/Math.pow(10,n)}`;continue}return}else i+=t.value}return i},stringifyDuration:function(e,t){const n=L5(t);if(void 0===n)return;const r=n.tokens;let i="";for(const o of r)if(o.type!==O5.FREE_TEXT)switch(o.value.toLowerCase()){case"h":case"hh":i+=D5(e.hours,o.value.length),e.hours=0;break;case"[hh]":i+=D5(e.hours,o.value.length-2),e.hours=0;break;case"m":case"mm":i+=D5(e.minutes,o.value.length),e.minutes=0;break;case"[mm]":i+=D5(e.minutes+60*e.hours,o.value.length-2),e.minutes=0,e.hours=0;break;case"s":case"ss":i+=D5(Math.floor(e.seconds),o.value.length);break;default:if(l5.test(o.value)){const t=Math.max(o.value.length-3,0);i+=`${e.seconds<10?"0":""}${Math.floor(e.seconds*Math.pow(10,t))/Math.pow(10,t)}`;continue}return}else i+=o.value;return i},timeFormats:["hh:mm","hh:mm:ss.sss"],thousandSeparator:"",undoLimit:20,useRegularExpressions:!1,useWildcards:!0,useColumnIndex:!1,useStats:!1,useArrayArithmetic:!1};
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
const F8={errors:{CYCLE:"#CYCLE!",DIV_BY_ZERO:"#DIV/0!",ERROR:"#ERROR!",NA:"#N/A",NAME:"#NAME?",NUM:"#NUM!",REF:"#REF!",SPILL:"#SPILL!",VALUE:"#VALUE!"},functions:{FILTER:"FILTER",ADDRESS:"ADDRESS",ARRAY_CONSTRAIN:"ARRAY_CONSTRAIN",ARRAYFORMULA:"ARRAYFORMULA",ABS:"ABS",ACOS:"ACOS",ACOSH:"ACOSH",ACOT:"ACOT",ACOTH:"ACOTH",AND:"AND",ARABIC:"ARABIC",ASIN:"ASIN",ASINH:"ASINH",ATAN2:"ATAN2",ATAN:"ATAN",ATANH:"ATANH",AVERAGE:"AVERAGE",AVERAGEA:"AVERAGEA",AVERAGEIF:"AVERAGEIF",BASE:"BASE",BIN2DEC:"BIN2DEC",BIN2HEX:"BIN2HEX",BIN2OCT:"BIN2OCT",BITAND:"BITAND",BITLSHIFT:"BITLSHIFT",BITOR:"BITOR",BITRSHIFT:"BITRSHIFT",BITXOR:"BITXOR",CEILING:"CEILING",CHAR:"CHAR",CHOOSE:"CHOOSE",CLEAN:"CLEAN",CODE:"CODE",COLUMN:"COLUMN",COLUMNS:"COLUMNS",CONCATENATE:"CONCATENATE",CORREL:"CORREL",COS:"COS",COSH:"COSH",COT:"COT",COTH:"COTH",COUNT:"COUNT",COUNTA:"COUNTA",COUNTBLANK:"COUNTBLANK",COUNTIF:"COUNTIF",COUNTIFS:"COUNTIFS",COUNTUNIQUE:"COUNTUNIQUE",CSC:"CSC",CSCH:"CSCH",CUMIPMT:"CUMIPMT",CUMPRINC:"CUMPRINC",DATE:"DATE",DATEDIF:"DATEDIF",DATEVALUE:"DATEVALUE",DAY:"DAY",DAYS360:"DAYS360",DAYS:"DAYS",DB:"DB",DDB:"DDB",DEC2BIN:"DEC2BIN",DEC2HEX:"DEC2HEX",DEC2OCT:"DEC2OCT",DECIMAL:"DECIMAL",DEGREES:"DEGREES",DELTA:"DELTA",DOLLARDE:"DOLLARDE",DOLLARFR:"DOLLARFR",EDATE:"EDATE",EFFECT:"EFFECT",EOMONTH:"EOMONTH",ERF:"ERF",ERFC:"ERFC",EVEN:"EVEN",EXACT:"EXACT",EXP:"EXP",FALSE:"FALSE",FIND:"FIND",FORMULATEXT:"FORMULATEXT",FV:"FV",FVSCHEDULE:"FVSCHEDULE",HEX2BIN:"HEX2BIN",HEX2DEC:"HEX2DEC",HEX2OCT:"HEX2OCT",HLOOKUP:"HLOOKUP",HOUR:"HOUR",HYPERLINK:"HYPERLINK",IF:"IF",IFERROR:"IFERROR",IFNA:"IFNA",IFS:"IFS",INDEX:"INDEX",INT:"INT",INTERVAL:"INTERVAL",IPMT:"IPMT",ISBINARY:"ISBINARY",ISBLANK:"ISBLANK",ISERR:"ISERR",ISERROR:"ISERROR",ISEVEN:"ISEVEN",ISFORMULA:"ISFORMULA",ISLOGICAL:"ISLOGICAL",ISNA:"ISNA",ISNONTEXT:"ISNONTEXT",ISNUMBER:"ISNUMBER",ISODD:"ISODD",ISOWEEKNUM:"ISOWEEKNUM",ISPMT:"ISPMT",ISREF:"ISREF",ISTEXT:"ISTEXT",LEFT:"LEFT",LEN:"LEN",LN:"LN",LOG10:"LOG10",LOG:"LOG",LOWER:"LOWER",MATCH:"MATCH",MAX:"MAX",MAXA:"MAXA",MAXIFS:"MAXIFS",MAXPOOL:"MAXPOOL",MEDIAN:"MEDIAN",MEDIANPOOL:"MEDIANPOOL",MID:"MID",MIN:"MIN",MINA:"MINA",MINIFS:"MINIFS",MINUTE:"MINUTE",MIRR:"MIRR",MMULT:"MMULT",MOD:"MOD",MONTH:"MONTH",NA:"NA",NETWORKDAYS:"NETWORKDAYS","NETWORKDAYS.INTL":"NETWORKDAYS.INTL",NOMINAL:"NOMINAL",NOT:"NOT",NOW:"NOW",NPER:"NPER",NPV:"NPV",OCT2BIN:"OCT2BIN",OCT2DEC:"OCT2DEC",OCT2HEX:"OCT2HEX",ODD:"ODD",OFFSET:"OFFSET",OR:"OR",PI:"PI",PMT:"PMT",PDURATION:"PDURATION",PRODUCT:"PRODUCT",POWER:"POWER",PPMT:"PPMT",PROPER:"PROPER",PV:"PV",RADIANS:"RADIANS",RAND:"RAND",RATE:"RATE",REPLACE:"REPLACE",REPT:"REPT",RIGHT:"RIGHT",ROMAN:"ROMAN",ROUND:"ROUND",ROUNDDOWN:"ROUNDDOWN",ROUNDUP:"ROUNDUP",ROW:"ROW",ROWS:"ROWS",RRI:"RRI",SEARCH:"SEARCH",SEC:"SEC",SECH:"SECH",SECOND:"SECOND",SHEET:"SHEET",SHEETS:"SHEETS",SIN:"SIN",SINH:"SINH",SLN:"SLN",SPLIT:"SPLIT",SQRT:"SQRT",STDEVA:"STDEVA","STDEV.P":"STDEV.P",STDEVPA:"STDEVPA","STDEV.S":"STDEV.S",SUBSTITUTE:"SUBSTITUTE",SUBTOTAL:"SUBTOTAL",SUM:"SUM",SUMIF:"SUMIF",SUMIFS:"SUMIFS",SUMPRODUCT:"SUMPRODUCT",SUMSQ:"SUMSQ",SWITCH:"SWITCH",SYD:"SYD",T:"T",TAN:"TAN",TANH:"TANH",TBILLEQ:"TBILLEQ",TBILLPRICE:"TBILLPRICE",TBILLYIELD:"TBILLYIELD",TEXT:"TEXT",TIME:"TIME",TIMEVALUE:"TIMEVALUE",TODAY:"TODAY",TRANSPOSE:"TRANSPOSE",TRIM:"TRIM",TRUE:"TRUE",TRUNC:"TRUNC",UNICHAR:"UNICHAR",UNICODE:"UNICODE",UPPER:"UPPER",VARA:"VARA","VAR.P":"VAR.P",VARPA:"VARPA","VAR.S":"VAR.S",VLOOKUP:"VLOOKUP",WEEKDAY:"WEEKDAY",WEEKNUM:"WEEKNUM",WORKDAY:"WORKDAY","WORKDAY.INTL":"WORKDAY.INTL",XNPV:"XNPV",XOR:"XOR",XLOOKUP:"XLOOKUP",YEAR:"YEAR",YEARFRAC:"YEARFRAC","HF.ADD":"HF.ADD","HF.CONCAT":"HF.CONCAT","HF.DIVIDE":"HF.DIVIDE","HF.EQ":"HF.EQ","HF.GT":"HF.GT","HF.GTE":"HF.GTE","HF.LT":"HF.LT","HF.LTE":"HF.LTE","HF.MINUS":"HF.MINUS","HF.MULTIPLY":"HF.MULTIPLY","HF.NE":"HF.NE","HF.POW":"HF.POW","HF.UMINUS":"HF.UMINUS","HF.UNARY_PERCENT":"HF.UNARY_PERCENT","HF.UPLUS":"HF.UPLUS",VARP:"VARP",VAR:"VAR",STDEVP:"STDEVP",STDEV:"STDEV","EXPON.DIST":"EXPON.DIST",FISHER:"FISHER",FISHERINV:"FISHERINV",GAMMA:"GAMMA","GAMMA.DIST":"GAMMA.DIST",GAMMALN:"GAMMALN","GAMMALN.PRECISE":"GAMMALN.PRECISE","GAMMA.INV":"GAMMA.INV",GAUSS:"GAUSS",FACT:"FACT",FACTDOUBLE:"FACTDOUBLE",COMBIN:"COMBIN",COMBINA:"COMBINA",GCD:"GCD",LCM:"LCM",MROUND:"MROUND",MULTINOMIAL:"MULTINOMIAL",QUOTIENT:"QUOTIENT",RANDBETWEEN:"RANDBETWEEN",SERIESSUM:"SERIESSUM",SIGN:"SIGN",SQRTPI:"SQRTPI",SUMX2MY2:"SUMX2MY2",SUMX2PY2:"SUMX2PY2",SUMXMY2:"SUMXMY2",EXPONDIST:"EXPONDIST",GAMMADIST:"GAMMADIST",GAMMAINV:"GAMMAINV","BETA.DIST":"BETA.DIST",BETADIST:"BETADIST","BETA.INV":"BETA.INV",BETAINV:"BETAINV","BINOM.DIST":"BINOM.DIST",BINOMDIST:"BINOMDIST","BINOM.INV":"BINOM.INV",BESSELI:"BESSELI",BESSELJ:"BESSELJ",BESSELK:"BESSELK",BESSELY:"BESSELY","CHISQ.DIST":"CHISQ.DIST","CHISQ.DIST.RT":"CHISQ.DIST.RT","CHISQ.INV":"CHISQ.INV","CHISQ.INV.RT":"CHISQ.INV.RT",CHIDIST:"CHIDIST",CHIINV:"CHIINV","F.DIST":"F.DIST","F.DIST.RT":"F.DIST.RT","F.INV":"F.INV","F.INV.RT":"F.INV.RT",FDIST:"FDIST",FINV:"FINV",WEIBULL:"WEIBULL","WEIBULL.DIST":"WEIBULL.DIST",POISSON:"POISSON","POISSON.DIST":"POISSON.DIST","HYPGEOM.DIST":"HYPGEOM.DIST",HYPGEOMDIST:"HYPGEOMDIST","T.DIST":"T.DIST","T.DIST.2T":"T.DIST.2T","T.DIST.RT":"T.DIST.RT","T.INV":"T.INV","T.INV.2T":"T.INV.2T",TDIST:"TDIST",TINV:"TINV",LOGINV:"LOGINV","LOGNORM.DIST":"LOGNORM.DIST","LOGNORM.INV":"LOGNORM.INV",LOGNORMDIST:"LOGNORMDIST","NORM.DIST":"NORM.DIST","NORM.INV":"NORM.INV","NORM.S.DIST":"NORM.S.DIST","NORM.S.INV":"NORM.S.INV",NORMDIST:"NORMDIST",NORMINV:"NORMINV",NORMSDIST:"NORMSDIST",NORMSINV:"NORMSINV",PHI:"PHI","NEGBINOM.DIST":"NEGBINOM.DIST",NEGBINOMDIST:"NEGBINOMDIST",COMPLEX:"COMPLEX",IMABS:"IMABS",IMAGINARY:"IMAGINARY",IMARGUMENT:"IMARGUMENT",IMCONJUGATE:"IMCONJUGATE",IMCOS:"IMCOS",IMCOSH:"IMCOSH",IMCOT:"IMCOT",IMCSC:"IMCSC",IMCSCH:"IMCSCH",IMDIV:"IMDIV",IMEXP:"IMEXP",IMLN:"IMLN",IMLOG10:"IMLOG10",IMLOG2:"IMLOG2",IMPOWER:"IMPOWER",IMPRODUCT:"IMPRODUCT",IMREAL:"IMREAL",IMSEC:"IMSEC",IMSECH:"IMSECH",IMSIN:"IMSIN",IMSINH:"IMSINH",IMSQRT:"IMSQRT",IMSUB:"IMSUB",IMSUM:"IMSUM",IMTAN:"IMTAN",LARGE:"LARGE",SMALL:"SMALL",AVEDEV:"AVEDEV",CONFIDENCE:"CONFIDENCE","CONFIDENCE.NORM":"CONFIDENCE.NORM","CONFIDENCE.T":"CONFIDENCE.T",DEVSQ:"DEVSQ",GEOMEAN:"GEOMEAN",HARMEAN:"HARMEAN",CRITBINOM:"CRITBINOM","COVARIANCE.P":"COVARIANCE.P","COVARIANCE.S":"COVARIANCE.S",COVAR:"COVAR",PEARSON:"PEARSON",RSQ:"RSQ",STANDARDIZE:"STANDARDIZE","Z.TEST":"Z.TEST",ZTEST:"ZTEST","F.TEST":"F.TEST",FTEST:"FTEST",STEYX:"STEYX",SLOPE:"SLOPE","CHISQ.TEST":"CHISQ.TEST",CHITEST:"CHITEST","T.TEST":"T.TEST",TTEST:"TTEST",SKEW:"SKEW","SKEW.P":"SKEW.P",WEIBULLDIST:"WEIBULLDIST",VARS:"VARS",TINV2T:"TINV2T",TDISTRT:"TDISTRT",TDIST2T:"TDIST2T",STDEVS:"STDEVS",FINVRT:"FINVRT",FDISTRT:"FDISTRT",CHIDISTRT:"CHIDISTRT",CHIINVRT:"CHIINVRT",COVARIANCEP:"COVARIANCEP",COVARIANCES:"COVARIANCES",LOGNORMINV:"LOGNORMINV",POISSONDIST:"POISSONDIST",SKEWP:"SKEWP","CEILING.MATH":"CEILING.MATH",FLOOR:"FLOOR","FLOOR.MATH":"FLOOR.MATH","CEILING.PRECISE":"CEILING.PRECISE","FLOOR.PRECISE":"FLOOR.PRECISE","ISO.CEILING":"ISO.CEILING"},langCode:"enGB",ui:{NEW_SHEET_PREFIX:"Sheet"}};
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */var D8;!function(e){e[e.FullyAbsolute=1]="FullyAbsolute",e[e.RowAbsoluteColRelative=2]="RowAbsoluteColRelative",e[e.RowRelativeColAbsolute=3]="RowRelativeColAbsolute",e[e.FullyRelative=4]="FullyRelative"}(D8||(D8={}));class V8 extends J4{verifyAddressArguments(e,t,n,r){if(r){if(e<1||t<1)return new g4(X9.VALUE,W2.LessThanOne)}else if(D8.FullyAbsolute==n){if(e<1||t<1)return new g4(X9.VALUE,W2.LessThanOne)}else if(D8.RowAbsoluteColRelative==n){if(e<1)return new g4(X9.VALUE,W2.LessThanOne)}else if(D8.RowRelativeColAbsolute==n&&t<1)return new g4(X9.VALUE,W2.LessThanOne)}address(e,t){return this.runFunction(e.args,t,this.metadata("ADDRESS"),((e,t,n,r,i)=>{const o=this.verifyAddressArguments(e,t,n,r);if(void 0!==o)return o;const s=aZ(t-1);let a="";null!=i&&(a=`${i}!`);const l=0==t?"C":`C[${t}]`,h=0==e?"R":`R[${e}]`;return D8.FullyRelative==n?r?`${a}${s}${e}`:`${a}${h}${l}`:D8.RowRelativeColAbsolute==n?r?`${a}$${s}${e}`:`${a}${h}C${t}`:D8.RowAbsoluteColRelative==n?r?`${a}${s}$${e}`:`${a}R${e}${l}`:r?`${a}$${s}$${e}`:`${a}R${e}C${t}`}))}}V8.implementedFunctions={ADDRESS:{method:"address",parameters:[{argumentType:Z4.NUMBER},{argumentType:Z4.NUMBER},{argumentType:Z4.NUMBER,optionalArg:!0,defaultValue:1,minValue:1,maxValue:4},{argumentType:Z4.BOOLEAN,optionalArg:!0,defaultValue:!0},{argumentType:Z4.STRING,optionalArg:!0}]}};
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
class U8 extends J4{arrayformula(e,t){return this.runFunction(e.args,t,this.metadata("ARRAYFORMULA"),(e=>e))}arrayformulaArraySize(e,t){if(1!==e.args.length)return e5.error();const n=this.metadata("ARRAYFORMULA");return e.args.map((e=>{var r;return this.arraySizeForAst(e,new x4(t.formulaAddress,t.arraysFlag||null!==(r=null==n?void 0:n.arrayFunction)&&void 0!==r&&r))}))[0]}arrayconstrain(e,t){return this.runFunction(e.args,t,this.metadata("ARRAY_CONSTRAIN"),((e,t,n)=>{t=Math.min(t,e.height()),n=Math.min(n,e.width());const r=e.data,i=[];for(let o=0;o<t;o++)i.push(r[o].slice(0,n));return $3.onlyValues(i)}))}arrayconstrainArraySize(e,t){if(3!==e.args.length)return e5.error();const n=this.metadata("ARRAY_CONSTRAIN"),r=e.args.map((e=>{var r;return this.arraySizeForAst(e,new x4(t.formulaAddress,t.arraysFlag||null!==(r=null==n?void 0:n.arrayFunction)&&void 0!==r&&r))}));let{height:i,width:o}=r[0];return e.args[1].type===I2.NUMBER&&(i=Math.min(i,e.args[1].value)),e.args[2].type===I2.NUMBER&&(o=Math.min(o,e.args[2].value)),i<1||o<1||!Number.isInteger(i)||!Number.isInteger(o)?e5.error():new e5(o,i)}filter(e,t){return this.runFunction(e.args,t,this.metadata("FILTER"),((e,...t)=>{for(const i of t)if(e.width()!==i.width()||e.height()!==i.height())return new g4(X9.NA,W2.EqualLength);if(e.width()>1&&e.height()>1)return new g4(X9.NA,W2.WrongDimension);const n=e.data,r=[];for(let i=0;i<e.height();i++){const o=[];for(let r=0;r<e.width();r++){let e=!0;for(const n of t){if(!0!==D4(n.data[i][r])){e=!1;break}}e&&o.push(n[i][r])}o.length>0&&r.push(o)}return r.length>0?$3.onlyValues(r):new g4(X9.NA,W2.EmptyRange)}))}filterArraySize(e,t){if(e.args.length<=1)return e5.error();const n=this.metadata("FILTER"),r=e.args.map((e=>{var r;return this.arraySizeForAst(e,new x4(t.formulaAddress,t.arraysFlag||null!==(r=null==n?void 0:n.arrayFunction)&&void 0!==r&&r))})),i=Math.max(...r.map((e=>e.width))),o=Math.max(...r.map((e=>e.height)));return new e5(i,o)}}U8.implementedFunctions={ARRAYFORMULA:{method:"arrayformula",arraySizeMethod:"arrayformulaArraySize",arrayFunction:!0,parameters:[{argumentType:Z4.ANY}]},ARRAY_CONSTRAIN:{method:"arrayconstrain",arraySizeMethod:"arrayconstrainArraySize",parameters:[{argumentType:Z4.RANGE},{argumentType:Z4.INTEGER,minValue:1},{argumentType:Z4.INTEGER,minValue:1}],vectorizationForbidden:!0},FILTER:{method:"filter",arraySizeMethod:"filterArraySize",arrayFunction:!0,parameters:[{argumentType:Z4.RANGE},{argumentType:Z4.RANGE}],repeatLastArgs:1}};
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
class B8 extends J4{abs(e,t){return this.runFunction(e.args,t,this.metadata("ABS"),Math.abs)}}B8.implementedFunctions={ABS:{method:"abs",parameters:[{argumentType:Z4.NUMBER}]}};class W8 extends J4{bitlshift(e,t){return this.runFunction(e.args,t,this.metadata("BITLSHIFT"),j8)}bitrshift(e,t){return this.runFunction(e.args,t,this.metadata("BITRSHIFT"),G8)}}function j8(e,t){return t<0?G8(e,-t):z8(e*Math.pow(2,t))}function G8(e,t){return t<0?j8(e,-t):z8(Math.floor(e/Math.pow(2,t)))}function z8(e){return e>0xffffffffffff?new g4(X9.NUM,W2.BitshiftLong):e}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */W8.implementedFunctions={BITLSHIFT:{method:"bitlshift",parameters:[{argumentType:Z4.INTEGER,minValue:0},{argumentType:Z4.INTEGER,minValue:-53,maxValue:53}]},BITRSHIFT:{method:"bitrshift",parameters:[{argumentType:Z4.INTEGER,minValue:0},{argumentType:Z4.INTEGER,minValue:-53,maxValue:53}]}};class $8 extends J4{bitand(e,t){return this.runFunction(e.args,t,this.metadata("BITAND"),((e,t)=>e&t))}bitor(e,t){return this.runFunction(e.args,t,this.metadata("BITOR"),((e,t)=>e|t))}bitxor(e,t){return this.runFunction(e.args,t,this.metadata("BITXOR"),((e,t)=>e^t))}}$8.implementedFunctions={BITAND:{method:"bitand",parameters:[{argumentType:Z4.INTEGER,minValue:0},{argumentType:Z4.INTEGER,minValue:0}]},BITOR:{method:"bitor",parameters:[{argumentType:Z4.INTEGER,minValue:0},{argumentType:Z4.INTEGER,minValue:0}]},BITXOR:{method:"bitxor",parameters:[{argumentType:Z4.INTEGER,minValue:0},{argumentType:Z4.INTEGER,minValue:0}]}};
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
class Y8 extends J4{literalTrue(e,t){return this.runFunction(e.args,t,this.metadata("TRUE"),(()=>!0))}literalFalse(e,t){return this.runFunction(e.args,t,this.metadata("FALSE"),(()=>!1))}conditionalIf(e,t){return this.runFunction(e.args,t,this.metadata("IF"),((e,t,n)=>e?t:n))}ifs(e,t){return this.runFunction(e.args,t,this.metadata("IFS"),((...e)=>{for(let t=0;t<e.length;t+=2)if(e[t])return e[t+1];return new g4(X9.NA,W2.NoConditionMet)}))}and(e,t){return this.runFunction(e.args,t,this.metadata("AND"),((...e)=>e.filter((e=>void 0!==e)).every((e=>!!e))))}or(e,t){return this.runFunction(e.args,t,this.metadata("OR"),((...e)=>e.filter((e=>void 0!==e)).some((e=>e))))}not(e,t){return this.runFunction(e.args,t,this.metadata("NOT"),(e=>!e))}xor(e,t){return this.runFunction(e.args,t,this.metadata("XOR"),((...e)=>{let t=0;return e.filter((e=>void 0!==e)).forEach((e=>{e&&t++})),t%2==1}))}switch(e,t){return this.runFunction(e.args,t,this.metadata("SWITCH"),((e,...t)=>{const n=t.length;let r=0;for(;r+1<n;r+=2)if(!(t[r]instanceof g4)&&this.arithmeticHelper.eq(e,t[r]))return t[r+1];return r<n?t[r]:new g4(X9.NA,W2.NoDefault)}))}iferror(e,t){return this.runFunction(e.args,t,this.metadata("IFERROR"),((e,t)=>e instanceof g4?t:e))}ifna(e,t){return this.runFunction(e.args,t,this.metadata("IFNA"),((e,t)=>e instanceof g4&&e.type===X9.NA?t:e))}choose(e,t){return this.runFunction(e.args,t,this.metadata("CHOOSE"),((e,...t)=>e>t.length?new g4(X9.NUM,W2.Selector):t[e-1]))}}Y8.implementedFunctions={TRUE:{method:"literalTrue",parameters:[]},FALSE:{method:"literalFalse",parameters:[]},IF:{method:"conditionalIf",parameters:[{argumentType:Z4.BOOLEAN},{argumentType:Z4.SCALAR,passSubtype:!0},{argumentType:Z4.SCALAR,defaultValue:!1,passSubtype:!0}]},IFS:{method:"ifs",parameters:[{argumentType:Z4.BOOLEAN},{argumentType:Z4.SCALAR,passSubtype:!0}],repeatLastArgs:2},AND:{method:"and",parameters:[{argumentType:Z4.BOOLEAN}],repeatLastArgs:1,expandRanges:!0},OR:{method:"or",parameters:[{argumentType:Z4.BOOLEAN}],repeatLastArgs:1,expandRanges:!0},XOR:{method:"xor",parameters:[{argumentType:Z4.BOOLEAN}],repeatLastArgs:1,expandRanges:!0},NOT:{method:"not",parameters:[{argumentType:Z4.BOOLEAN}]},SWITCH:{method:"switch",parameters:[{argumentType:Z4.NOERROR},{argumentType:Z4.SCALAR,passSubtype:!0},{argumentType:Z4.SCALAR,passSubtype:!0}],repeatLastArgs:1},IFERROR:{method:"iferror",parameters:[{argumentType:Z4.SCALAR,passSubtype:!0},{argumentType:Z4.SCALAR,passSubtype:!0}]},IFNA:{method:"ifna",parameters:[{argumentType:Z4.SCALAR,passSubtype:!0},{argumentType:Z4.SCALAR,passSubtype:!0}]},CHOOSE:{method:"choose",parameters:[{argumentType:Z4.INTEGER,minValue:1},{argumentType:Z4.SCALAR,passSubtype:!0}],repeatLastArgs:1}};
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
class K8 extends J4{char(e,t){return this.runFunction(e.args,t,this.metadata("CHAR"),(e=>e<1||e>=256?new g4(X9.VALUE,W2.CharacterCodeBounds):String.fromCharCode(Math.trunc(e))))}unichar(e,t){return this.runFunction(e.args,t,this.metadata("CHAR"),(e=>e<1||e>=1114112?new g4(X9.VALUE,W2.CharacterCodeBounds):String.fromCodePoint(Math.trunc(e))))}}K8.implementedFunctions={CHAR:{method:"char",parameters:[{argumentType:Z4.NUMBER}]},UNICHAR:{method:"unichar",parameters:[{argumentType:Z4.NUMBER}]}};
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
class X8 extends J4{code(e,t){return this.runFunction(e.args,t,this.metadata("CODE"),(e=>0===e.length?new g4(X9.VALUE,W2.EmptyString):e.charCodeAt(0)))}unicode(e,t){return this.runFunction(e.args,t,this.metadata("UNICODE"),(e=>{var t;return null!==(t=e.codePointAt(0))&&void 0!==t?t:new g4(X9.VALUE,W2.EmptyString)}))}}X8.implementedFunctions={CODE:{method:"code",parameters:[{argumentType:Z4.STRING}]},UNICODE:{method:"unicode",parameters:[{argumentType:Z4.STRING}]}};
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
class q8 extends J4{countblank(e,t){return this.runFunction(e.args,t,this.metadata("COUNTBLANK"),((...e)=>{let t=0;return e.forEach((e=>{e===_3&&t++})),t}))}}q8.implementedFunctions={COUNTBLANK:{method:"countblank",parameters:[{argumentType:Z4.SCALAR}],repeatLastArgs:1,expandRanges:!0}};
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
class Q8 extends J4{countunique(e,t){return this.runFunction(e.args,t,this.metadata("COUNTUNIQUE"),((...e)=>{const t=new Set,n=new Set;for(const r of e)r instanceof g4?n.add(r.type):""!==r&&t.add(r);return t.size+n.size}))}}Q8.implementedFunctions={COUNTUNIQUE:{method:"countunique",parameters:[{argumentType:Z4.SCALAR}],repeatLastArgs:1,expandRanges:!0}};
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
class Z8 extends J4{constructor(){super(...arguments),this.isoweeknumCore=e=>{const t=Math.floor(this.dateTimeHelper.relativeNumberToAbsoluteNumber(e)),n=this.dateTimeHelper.numberToSimpleDate(e),r=this.dateTimeHelper.dateToNumber({year:n.year,month:1,day:1}),i=this.dateTimeHelper.relativeNumberToAbsoluteNumber(r),o=i+((4-i)%7+7)%7,s=Math.floor((t-1)/7)-Math.floor((o-1)/7)+1;return 0===s?this.isoweeknumCore(e-7)+1:s},this.days360Core=(e,t,n)=>{const r=this.dateTimeHelper.numberToSimpleDate(e),i=this.dateTimeHelper.numberToSimpleDate(t);let o,s;return n?(o=A5(r),s=A5(i)):[o,s]=this.dateTimeHelper.toBasisUS(r,i),360*(s.year-o.year)+30*(s.month-o.month)+s.day-o.day}}date(e,t){return this.runFunction(e.args,t,this.metadata("DATE"),((e,t,n)=>{const r=Math.trunc(n);let i=Math.trunc(t),o=Math.trunc(e);o<this.dateTimeHelper.getEpochYearZero()&&(o+=this.dateTimeHelper.getEpochYearZero());const s=Math.floor((i-1)/12);o+=s,i-=12*s;const a={year:o,month:i,day:1};if(this.dateTimeHelper.isValidDate(a)){let e=this.dateTimeHelper.dateToNumber(a)+(r-1);return e=this.dateTimeHelper.getWithinBounds(e),void 0===e?new g4(X9.NUM,W2.DateBounds):e}return new g4(X9.VALUE,W2.InvalidDate)}))}time(e,t){return this.runFunction(e.args,t,this.metadata("TIME"),((e,t,n)=>{const r=N5({hours:Math.trunc(e),minutes:Math.trunc(t),seconds:Math.trunc(n)});return r<0?new g4(X9.NUM,W2.NegativeTime):r%1}))}eomonth(e,t){return this.runFunction(e.args,t,this.metadata("EOMONTH"),((e,t)=>{const n=this.dateTimeHelper.numberToSimpleDate(e);let r=this.dateTimeHelper.dateToNumber(this.dateTimeHelper.endOfMonth(E5(n,t)));return r=this.dateTimeHelper.getWithinBounds(r),void 0===r?new g4(X9.NUM,W2.DateBounds):r}))}day(e,t){return this.runFunction(e.args,t,this.metadata("DAY"),(e=>this.dateTimeHelper.numberToSimpleDate(e).day))}days(e,t){return this.runFunction(e.args,t,this.metadata("DAYS"),((e,t)=>Math.trunc(e)-Math.trunc(t)))}month(e,t){return this.runFunction(e.args,t,this.metadata("MONTH"),(e=>this.dateTimeHelper.numberToSimpleDate(e).month))}year(e,t){return this.runFunction(e.args,t,this.metadata("YEAR"),(e=>this.dateTimeHelper.numberToSimpleDate(e).year))}hour(e,t){return this.runFunction(e.args,t,this.metadata("HOUR"),(e=>T5(b5(e)%1).hours))}minute(e,t){return this.runFunction(e.args,t,this.metadata("MINUTE"),(e=>T5(b5(e)%1).minutes))}second(e,t){return this.runFunction(e.args,t,this.metadata("SECOND"),(e=>T5(b5(e)%1).seconds))}text(e,t){return this.runFunction(e.args,t,this.metadata("TEXT"),((e,t)=>F5(e,t,this.config,this.dateTimeHelper)))}weekday(e,t){return this.runFunction(e.args,t,this.metadata("WEEKDAY"),((e,t)=>{const n=Math.floor(this.dateTimeHelper.relativeNumberToAbsoluteNumber(e));if(3===t)return(n-1)%7;const r=t7.get(t);return void 0===r?new g4(X9.NUM,W2.BadMode):(n-r)%7+1}))}weeknum(e,t){return this.runFunction(e.args,t,this.metadata("WEEKNUM"),((e,t)=>{const n=Math.floor(this.dateTimeHelper.relativeNumberToAbsoluteNumber(e)),r=this.dateTimeHelper.numberToSimpleDate(e),i=this.dateTimeHelper.dateToNumber({year:r.year,month:1,day:1}),o=this.dateTimeHelper.relativeNumberToAbsoluteNumber(i);if(21===t)return this.isoweeknumCore(e);const s=t7.get(t);return void 0===s?new g4(X9.NUM,W2.BadMode):Math.floor((n-s)/7)-Math.floor((o-s)/7)+1}))}isoweeknum(e,t){return this.runFunction(e.args,t,this.metadata("ISOWEEKNUM"),this.isoweeknumCore)}datevalue(e,t){return this.runFunction(e.args,t,this.metadata("DATEVALUE"),(e=>{const{dateTime:t}=this.dateTimeHelper.parseDateTimeFromConfigFormats(e);return void 0===t?new g4(X9.VALUE,W2.IncorrectDateTime):v5(t)?(C5(t)?Math.trunc(N5(t)):0)+this.dateTimeHelper.dateToNumber(t):0}))}timevalue(e,t){return this.runFunction(e.args,t,this.metadata("TIMEVALUE"),(e=>{const t=this.dateTimeHelper.dateStringToDateNumber(e);return void 0===t?new g4(X9.VALUE,W2.IncorrectDateTime):L3(t)%1}))}now(e,t){return this.runFunction(e.args,t,this.metadata("NOW"),(()=>{const e=new Date(Date.now());return N5({hours:e.getHours(),minutes:e.getMinutes(),seconds:e.getSeconds()})+this.dateTimeHelper.dateToNumber({year:e.getFullYear(),month:e.getMonth()+1,day:e.getDate()})}))}today(e,t){return this.runFunction(e.args,t,this.metadata("TODAY"),(()=>{const e=new Date(Date.now());return this.dateTimeHelper.dateToNumber({year:e.getFullYear(),month:e.getMonth()+1,day:e.getDate()})}))}edate(e,t){return this.runFunction(e.args,t,this.metadata("EDATE"),((e,t)=>{const n=function(e){return{year:e.year,month:e.month,day:Math.min(e.day,w5[e.month-1])}}(E5(this.dateTimeHelper.numberToSimpleDate(e),t));let r=this.dateTimeHelper.dateToNumber(n);return r=this.dateTimeHelper.getWithinBounds(r),void 0===r?new g4(X9.NUM,W2.DateBounds):r}))}datedif(e,t){return this.runFunction(e.args,t,this.metadata("DATEDIF"),((e,t,n)=>{if(e>t)return new g4(X9.NUM,W2.StartEndDate);if("D"===n)return Math.floor(t)-Math.floor(e);const r=this.dateTimeHelper.numberToSimpleDate(e),i=this.dateTimeHelper.numberToSimpleDate(t);switch(n){case"M":return 12*(i.year-r.year)+(i.month-r.month)-(i.day<r.day?1:0);case"YM":return(i.month-r.month+12-(i.day<r.day?1:0))%12;case"Y":return i.month>r.month||i.month===r.month&&i.day>=r.day?i.year-r.year:i.year-r.year-1;case"MD":if(i.day>=r.day)return i.day-r.day;{const e=1===i.month?12:i.month-1,t=1===i.month?i.year-1:i.year;return this.dateTimeHelper.daysInMonth(t,e)+i.day-r.day}case"YD":return i.month>r.month||i.month===r.month&&i.day>=r.day?Math.floor(t)-this.dateTimeHelper.dateToNumber({year:i.year,month:r.month,day:r.day}):Math.floor(t)-Math.floor(e)-365*(i.year-r.year-1)-this.dateTimeHelper.leapYearsCount(i.year-1)+this.dateTimeHelper.leapYearsCount(r.year);default:return new g4(X9.NUM,W2.BadMode)}}))}days360(e,t){return this.runFunction(e.args,t,this.metadata("DAYS360"),this.days360Core)}yearfrac(e,t){return this.runFunction(e.args,t,this.metadata("YEARFRAC"),((e,t,n)=>{switch((e=Math.trunc(e))>(t=Math.trunc(t))&&([e,t]=[t,e]),n){case 0:return this.days360Core(e,t,!1)/360;case 1:return(t-e)/this.dateTimeHelper.yearLengthForBasis(this.dateTimeHelper.numberToSimpleDate(e),this.dateTimeHelper.numberToSimpleDate(t));case 2:return(t-e)/360;case 3:return(t-e)/365;case 4:return this.days360Core(e,t,!0)/360}throw new Error("Should not be reachable.")}))}interval(e,t){return this.runFunction(e.args,t,this.metadata("INTERVAL"),(e=>{const t=(e=Math.trunc(e))%60,n=(e=Math.trunc(e/60))%60,r=(e=Math.trunc(e/60))%24,i=(e=Math.trunc(e/24))%30,o=(e=Math.trunc(e/30))%12,s=Math.trunc(e/12);return"P"+(s>0?`${s}Y`:"")+(o>0?`${o}M`:"")+(i>0?`${i}D`:"")+"T"+(r>0?`${r}H`:"")+(n>0?`${n}M`:"")+(t>0?`${t}S`:"")}))}networkdays(e,t){return this.runFunction(e.args,t,this.metadata("NETWORKDAYS"),((e,t,n)=>this.networkdayscore(e,t,1,n)))}networkdaysintl(e,t){return this.runFunction(e.args,t,this.metadata("NETWORKDAYS.INTL"),((e,t,n,r)=>this.networkdayscore(e,t,n,r)))}workday(e,t){return this.runFunction(e.args,t,this.metadata("WORKDAY"),((e,t,n)=>this.workdaycore(e,t,1,n)))}workdayintl(e,t){return this.runFunction(e.args,t,this.metadata("WORKDAY.INTL"),((e,t,n,r)=>this.workdaycore(e,t,n,r)))}networkdayscore(e,t,n,r){let i=1;(e=Math.trunc(e))>(t=Math.trunc(t))&&([e,t]=[t,e],i=-1);const o=e7(n);if(o instanceof g4)return o;const s=this.simpleRangeToFilteredHolidays(o,r);return s instanceof g4?s:i*this.countWorkdays(e,t,o,s)}workdaycore(e,t,n,r){e=Math.trunc(e),t=Math.trunc(t);const i=e7(n);if(i instanceof g4)return i;const o=this.simpleRangeToFilteredHolidays(i,r);if(o instanceof g4)return o;if(t>0){let n=1;for(;this.countWorkdays(e+1,e+n,i,o)<t;)n*=2;let r=1;for(;r+1<n;){const s=Math.trunc((r+n)/2);this.countWorkdays(e+1,e+s,i,o)<t?r=s:n=s}return e+n}if(t<0){t*=-1;let n=1;for(;this.countWorkdays(e-n,e-1,i,o)<t;)n*=2;let r=1;for(;r+1<n;){const s=Math.trunc((r+n)/2);this.countWorkdays(e-s,e-1,i,o)<t?r=s:n=s}return e-n}return e}countWorkdays(e,t,n,r){const i=Math.floor(this.dateTimeHelper.relativeNumberToAbsoluteNumber(t)),o=Math.floor(this.dateTimeHelper.relativeNumberToAbsoluteNumber(e));let s=0;for(let a=0;a<7;a++)"0"===n.charAt(a)&&(s+=Math.floor((i+6-a)/7),s-=Math.floor((o-1+6-a)/7));return s-=J8(t+1,r)-J8(e,r),s}simpleRangeToFilteredHolidays(e,t){var n;const r=null!==(n=null==t?void 0:t.valuesFromTopLeftCorner())&&void 0!==n?n:[];for(const o of r)if(o instanceof g4)return o;const i=[];for(const o of r)if(o!==_3){if(!W3(o))return new g4(X9.VALUE,W2.WrongType);i.push(Math.trunc(L3(o)))}return[...new Set(i)].sort(((e,t)=>e-t)).filter((t=>{const n=(this.dateTimeHelper.relativeNumberToAbsoluteNumber(t)-1)%7;return"0"===e.charAt(n)}))}}function J8(e,t){if(0===t.length)return 0;if(e<=t[0])return 0;if(t[t.length-1]<e)return t.length;let n=0,r=t.length-1;for(;n+1<r;){const i=Math.floor((r+n)/2);t[i]>=e?r=i:n=i}return r}function e7(e){var t;return"number"!=typeof e&&"string"!=typeof e?new g4(X9.VALUE,W2.WrongType):"string"==typeof e?7===e.length&&/^(0|1)*$/.test(e)&&"1111111"!==e?e:new g4(X9.NUM,W2.WeekendString):null!==(t=n7.get(e))&&void 0!==t?t:new g4(X9.NUM,W2.BadMode)}Z8.implementedFunctions={DATE:{method:"date",parameters:[{argumentType:Z4.NUMBER},{argumentType:Z4.NUMBER},{argumentType:Z4.NUMBER}],returnNumberType:j3.NUMBER_DATE},TIME:{method:"time",parameters:[{argumentType:Z4.NUMBER},{argumentType:Z4.NUMBER},{argumentType:Z4.NUMBER}],returnNumberType:j3.NUMBER_TIME},MONTH:{method:"month",parameters:[{argumentType:Z4.NUMBER,minValue:0}]},YEAR:{method:"year",parameters:[{argumentType:Z4.NUMBER,minValue:0}]},HOUR:{method:"hour",parameters:[{argumentType:Z4.NUMBER,minValue:0}]},MINUTE:{method:"minute",parameters:[{argumentType:Z4.NUMBER,minValue:0}]},SECOND:{method:"second",parameters:[{argumentType:Z4.NUMBER,minValue:0}]},TEXT:{method:"text",parameters:[{argumentType:Z4.NUMBER},{argumentType:Z4.STRING}]},EOMONTH:{method:"eomonth",parameters:[{argumentType:Z4.NUMBER,minValue:0},{argumentType:Z4.NUMBER}],returnNumberType:j3.NUMBER_DATE},DAY:{method:"day",parameters:[{argumentType:Z4.NUMBER,minValue:0}]},DAYS:{method:"days",parameters:[{argumentType:Z4.NUMBER,minValue:0},{argumentType:Z4.NUMBER,minValue:0}]},WEEKDAY:{method:"weekday",parameters:[{argumentType:Z4.NUMBER,minValue:0},{argumentType:Z4.NUMBER,defaultValue:1}]},WEEKNUM:{method:"weeknum",parameters:[{argumentType:Z4.NUMBER,minValue:0},{argumentType:Z4.NUMBER,defaultValue:1}]},ISOWEEKNUM:{method:"isoweeknum",parameters:[{argumentType:Z4.NUMBER,minValue:0}]},DATEVALUE:{method:"datevalue",parameters:[{argumentType:Z4.STRING}],returnNumberType:j3.NUMBER_DATE},TIMEVALUE:{method:"timevalue",parameters:[{argumentType:Z4.STRING}],returnNumberType:j3.NUMBER_TIME},NOW:{method:"now",parameters:[],isVolatile:!0,returnNumberType:j3.NUMBER_DATETIME},TODAY:{method:"today",parameters:[],isVolatile:!0,returnNumberType:j3.NUMBER_DATE},EDATE:{method:"edate",parameters:[{argumentType:Z4.NUMBER,minValue:0},{argumentType:Z4.NUMBER}],returnNumberType:j3.NUMBER_DATE},DAYS360:{method:"days360",parameters:[{argumentType:Z4.NUMBER,minValue:0},{argumentType:Z4.NUMBER,minValue:0},{argumentType:Z4.BOOLEAN,defaultValue:!1}]},DATEDIF:{method:"datedif",parameters:[{argumentType:Z4.NUMBER,minValue:0},{argumentType:Z4.NUMBER,minValue:0},{argumentType:Z4.STRING}]},YEARFRAC:{method:"yearfrac",parameters:[{argumentType:Z4.NUMBER,minValue:0},{argumentType:Z4.NUMBER,minValue:0},{argumentType:Z4.INTEGER,defaultValue:0,minValue:0,maxValue:4}]},INTERVAL:{method:"interval",parameters:[{argumentType:Z4.NUMBER,minValue:0}]},NETWORKDAYS:{method:"networkdays",parameters:[{argumentType:Z4.NUMBER,minValue:0},{argumentType:Z4.NUMBER,minValue:0},{argumentType:Z4.RANGE,optionalArg:!0}]},"NETWORKDAYS.INTL":{method:"networkdaysintl",parameters:[{argumentType:Z4.NUMBER,minValue:0},{argumentType:Z4.NUMBER,minValue:0},{argumentType:Z4.NOERROR,defaultValue:1},{argumentType:Z4.RANGE,optionalArg:!0}]},WORKDAY:{method:"workday",parameters:[{argumentType:Z4.NUMBER,minValue:0},{argumentType:Z4.NUMBER},{argumentType:Z4.RANGE,optionalArg:!0}]},"WORKDAY.INTL":{method:"workdayintl",parameters:[{argumentType:Z4.NUMBER,minValue:0},{argumentType:Z4.NUMBER},{argumentType:Z4.NOERROR,defaultValue:1},{argumentType:Z4.RANGE,optionalArg:!0}]}};const t7=new Map([[1,0],[2,1],[11,1],[12,2],[13,3],[14,4],[15,5],[16,6],[17,0]]),n7=new Map([[1,"0000011"],[2,"1000001"],[3,"1100000"],[4,"0110000"],[5,"0011000"],[6,"0001100"],[7,"0000110"],[11,"0000001"],[12,"1000000"],[13,"0100000"],[14,"0010000"],[15,"0001000"],[16,"0000100"],[17,"0000010"]]);
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
class r7 extends J4{degrees(e,t){return this.runFunction(e.args,t,this.metadata("DEGREES"),(e=>e*(180/Math.PI)))}}r7.implementedFunctions={DEGREES:{method:"degrees",parameters:[{argumentType:Z4.NUMBER}]}};
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
class i7 extends J4{delta(e,t){return this.runFunction(e.args,t,this.metadata("DELTA"),((e,t)=>e===t?1:0))}}i7.implementedFunctions={DELTA:{method:"delta",parameters:[{argumentType:Z4.NUMBER},{argumentType:Z4.NUMBER,defaultValue:0}]}};
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
class o7 extends J4{exp(e,t){return this.runFunction(e.args,t,this.metadata("EXP"),Math.exp)}}o7.implementedFunctions={EXP:{method:"exp",parameters:[{argumentType:Z4.NUMBER}]}};
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
class s7 extends J4{pmt(e,t){return this.runFunction(e.args,t,this.metadata("PMT"),a7)}ipmt(e,t){return this.runFunction(e.args,t,this.metadata("IPMT"),l7)}ppmt(e,t){return this.runFunction(e.args,t,this.metadata("PPMT"),u7)}fv(e,t){return this.runFunction(e.args,t,this.metadata("FV"),h7)}cumipmt(e,t){return this.runFunction(e.args,t,this.metadata("CUMIPMT"),((e,t,n,r,i,o)=>{if(r>i)return new g4(X9.NUM,W2.EndStartPeriod);let s=0;for(let a=r;a<=i;a++)s+=l7(e,a,t,n,0,o);return s}))}cumprinc(e,t){return this.runFunction(e.args,t,this.metadata("CUMPRINC"),((e,t,n,r,i,o)=>{if(r>i)return new g4(X9.NUM,W2.EndStartPeriod);let s=0;for(let a=r;a<=i;a++)s+=u7(e,a,t,n,0,o);return s}))}db(e,t){return this.runFunction(e.args,t,this.metadata("DB"),((e,t,n,r,i)=>{if(12===i&&r>n||r>n+1)return new g4(X9.NUM,W2.PeriodLong);if(t>=e)return 0;const o=Math.round(1e3*(1-Math.pow(t/e,1/n)))/1e3,s=e*o*i/12;if(1===r)return s;let a=s;for(let l=0;l<r-2;l++)a+=(e-a)*o;return r===n+1?(e-a)*o*(12-i)/12:(e-a)*o}))}ddb(e,t){return this.runFunction(e.args,t,this.metadata("DDB"),((e,t,n,r,i)=>{if(r>n)return new g4(X9.NUM);let o,s=i/n;s>=1?(s=1,o=1===r?e:0):o=e*Math.pow(1-s,r-1);const a=e*Math.pow(1-s,r);return Math.max(o-Math.max(t,a),0)}))}dollarde(e,t){return this.runFunction(e.args,t,this.metadata("DOLLARDE"),((e,t)=>{if(t<1)return new g4(X9.DIV_BY_ZERO);for(t=Math.trunc(t);t>10;)t/=10;return Math.trunc(e)+10*(e-Math.trunc(e))/t}))}dollarfr(e,t){return this.runFunction(e.args,t,this.metadata("DOLLARFR"),((e,t)=>{if(t<1)return new g4(X9.DIV_BY_ZERO);for(t=Math.trunc(t);t>10;)t/=10;return Math.trunc(e)+(e-Math.trunc(e))*t/10}))}effect(e,t){return this.runFunction(e.args,t,this.metadata("EFFECT"),((e,t)=>(t=Math.trunc(t),Math.pow(1+e/t,t)-1)))}ispmt(e,t){return this.runFunction(e.args,t,this.metadata("ISPMT"),((e,t,n,r)=>0===n?new g4(X9.DIV_BY_ZERO):r*e*(t/n-1)))}nominal(e,t){return this.runFunction(e.args,t,this.metadata("NOMINAL"),((e,t)=>(t=Math.trunc(t),(Math.pow(e+1,1/t)-1)*t)))}nper(e,t){return this.runFunction(e.args,t,this.metadata("NPER"),((e,t,n,r,i)=>0===e?0===t?new g4(X9.DIV_BY_ZERO):(-n-r)/t:(i&&(t*=1+e),Math.log((t-r*e)/(n*e+t))/Math.log(1+e))))}rate(e,t){return this.runFunction(e.args,t,this.metadata("RATE"),((e,t,n,r,i,o)=>{if(o<=-1)return new g4(X9.VALUE);const s=1e-7;let a=o;i=i?1:0;for(let l=0;l<50;l++){if(a<=-1)return new g4(X9.NUM);let o,l;if(Math.abs(a)<s)o=n*(1+e*a)+t*(1+a*i)*e+r;else{const s=Math.pow(1+a,e);o=n*s+t*(1/a+i)*(s-1)+r}if(Math.abs(o)<s)return a;if(Math.abs(a)<s)l=n*e+t*i*e;else{const r=Math.pow(1+a,e),o=e*Math.pow(1+a,e-1);l=n*o+t*(1/a+i)*o+t*(-1/(a*a))*(r-1)}a-=o/l}return new g4(X9.NUM)}))}pv(e,t){return this.runFunction(e.args,t,this.metadata("PV"),((e,t,n,r,i)=>(i=i?1:0,-1===e?new g4(0===t?X9.NUM:X9.DIV_BY_ZERO):0===e?-n*t-r:((1-Math.pow(1+e,t))*n*(1+e*i)/e-r)/Math.pow(1+e,t))))}rri(e,t){return this.runFunction(e.args,t,this.metadata("RRI"),((e,t,n)=>0===t||n<0&&t>0||n>0&&t<0?new g4(X9.NUM):Math.pow(n/t,1/e)-1))}sln(e,t){return this.runFunction(e.args,t,this.metadata("SLN"),((e,t,n)=>0===n?new g4(X9.DIV_BY_ZERO):(e-t)/n))}syd(e,t){return this.runFunction(e.args,t,this.metadata("SYD"),((e,t,n,r)=>r>n?new g4(X9.NUM):(e-t)*(n-r+1)*2/(n*(n+1))))}tbilleq(e,t){return this.runFunction(e.args,t,this.metadata("TBILLEQ"),((e,t,n)=>{if((e=Math.round(e))>=(t=Math.round(t)))return new g4(X9.NUM);const r=this.dateTimeHelper.numberToSimpleDate(e),i=this.dateTimeHelper.numberToSimpleDate(t);if(i.year>r.year+1||i.year===r.year+1&&(i.month>r.month||i.month===r.month&&i.day>r.day))return new g4(X9.NUM);const o=360-n*(t-e);return 0===o?0:o<0?new g4(X9.NUM):365*n/o}))}tbillprice(e,t){return this.runFunction(e.args,t,this.metadata("TBILLPRICE"),((e,t,n)=>{if((e=Math.round(e))>=(t=Math.round(t)))return new g4(X9.NUM);const r=this.dateTimeHelper.numberToSimpleDate(e),i=this.dateTimeHelper.numberToSimpleDate(t);if(i.year>r.year+1||i.year===r.year+1&&(i.month>r.month||i.month===r.month&&i.day>r.day))return new g4(X9.NUM);const o=360-n*(t-e);return 0===o?0:o<0?new g4(X9.NUM):100*(1-n*(t-e)/360)}))}tbillyield(e,t){return this.runFunction(e.args,t,this.metadata("TBILLYIELD"),((e,t,n)=>{if((e=Math.round(e))>=(t=Math.round(t)))return new g4(X9.NUM);const r=this.dateTimeHelper.numberToSimpleDate(e),i=this.dateTimeHelper.numberToSimpleDate(t);return i.year>r.year+1||i.year===r.year+1&&(i.month>r.month||i.month===r.month&&i.day>r.day)?new g4(X9.NUM):360*(100-n)/(n*(t-e))}))}fvschedule(e,t){return this.runFunction(e.args,t,this.metadata("FVSCHEDULE"),((e,t)=>{const n=t.valuesFromTopLeftCorner();for(const r of n)if(r instanceof g4)return r;for(const r of n)if(W3(r))e*=1+L3(r);else if(r!==_3)return new g4(X9.VALUE,W2.NumberExpected);return e}))}npv(e,t){return this.runFunction(e.args,t,this.metadata("NPV"),((e,...t)=>{const n=this.arithmeticHelper.coerceNumbersExactRanges(t);return n instanceof g4?n:c7(e,n)}))}mirr(e,t){return this.runFunction(e.args,t,this.metadata("MIRR"),((e,t,n)=>{const r=this.arithmeticHelper.manyToExactNumbers(e.valuesFromTopLeftCorner());if(r instanceof g4)return r;let i=!1,o=!1;const s=[],a=[];for(const c of r)c>0?(i=!0,s.push(c),a.push(0)):c<0?(o=!0,a.push(c),s.push(0)):(a.push(0),s.push(0));if(!i||!o)return new g4(X9.DIV_BY_ZERO);const l=r.length,h=c7(n,s);if(h instanceof g4)return h;const u=c7(t,a);return u instanceof g4?u:Math.pow(-h*Math.pow(1+n,l)/u/(1+t),1/(l-1))-1}))}pduration(e,t){return this.runFunction(e.args,t,this.metadata("PDURATION"),((e,t,n)=>(Math.log(n)-Math.log(t))/Math.log(1+e)))}xnpv(e,t){return this.runFunction(e.args,t,this.metadata("XNPV"),((e,t,n)=>{const r=t.valuesFromTopLeftCorner();for(const h of r)if("number"!=typeof h)return new g4(X9.VALUE,W2.NumberExpected);const i=r,o=n.valuesFromTopLeftCorner();for(const h of o)if("number"!=typeof h)return new g4(X9.VALUE,W2.NumberExpected);const s=o;if(s.length!==i.length)return new g4(X9.NUM,W2.EqualLength);const a=s.length;let l=0;if(s[0]<0)return new g4(X9.NUM,W2.ValueSmall);for(let h=0;h<a;h++){if(s[h]=Math.floor(s[h]),s[h]<s[0])return new g4(X9.NUM,W2.ValueSmall);l+=i[h]/Math.pow(1+e,(s[h]-s[0])/365)}return l}))}}function a7(e,t,n,r,i){if(0===e)return(-n-r)/t;{const o=Math.pow(1+e,t);return(r*e+n*e*o)*(i?1/(1+e):1)/(1-o)}}function l7(e,t,n,r,i,o){const s=a7(e,n,r,i,o);return 1===t?e*(o?0:-r):e*(o?h7(e,t-2,s,r,o)-s:h7(e,t-1,s,r,o))}function h7(e,t,n,r,i){if(0===e)return-r-n*t;{const o=Math.pow(1+e,t);return n*(i?1+e:1)*(1-o)/e-r*o}}function u7(e,t,n,r,i,o){return a7(e,n,r,i,o)-l7(e,t,n,r,i,o)}function c7(e,t){let n=0;for(let r=t.length-1;r>=0;r--){if(n+=t[r],-1===e){if(0===n)continue;return new g4(X9.DIV_BY_ZERO)}n/=1+e}return n}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */s7.implementedFunctions={PMT:{method:"pmt",parameters:[{argumentType:Z4.NUMBER},{argumentType:Z4.NUMBER},{argumentType:Z4.NUMBER},{argumentType:Z4.NUMBER,defaultValue:0},{argumentType:Z4.NUMBER,defaultValue:0}],returnNumberType:j3.NUMBER_CURRENCY},IPMT:{method:"ipmt",parameters:[{argumentType:Z4.NUMBER},{argumentType:Z4.NUMBER},{argumentType:Z4.NUMBER},{argumentType:Z4.NUMBER},{argumentType:Z4.NUMBER,defaultValue:0},{argumentType:Z4.NUMBER,defaultValue:0}],returnNumberType:j3.NUMBER_CURRENCY},PPMT:{method:"ppmt",parameters:[{argumentType:Z4.NUMBER},{argumentType:Z4.NUMBER},{argumentType:Z4.NUMBER},{argumentType:Z4.NUMBER},{argumentType:Z4.NUMBER,defaultValue:0},{argumentType:Z4.NUMBER,defaultValue:0}],returnNumberType:j3.NUMBER_CURRENCY},FV:{method:"fv",parameters:[{argumentType:Z4.NUMBER},{argumentType:Z4.NUMBER},{argumentType:Z4.NUMBER},{argumentType:Z4.NUMBER,defaultValue:0},{argumentType:Z4.NUMBER,defaultValue:0}],returnNumberType:j3.NUMBER_CURRENCY},CUMIPMT:{method:"cumipmt",parameters:[{argumentType:Z4.NUMBER,greaterThan:0},{argumentType:Z4.NUMBER,greaterThan:0},{argumentType:Z4.NUMBER,greaterThan:0},{argumentType:Z4.INTEGER,minValue:1},{argumentType:Z4.INTEGER,minValue:1},{argumentType:Z4.INTEGER,minValue:0,maxValue:1}],returnNumberType:j3.NUMBER_CURRENCY},CUMPRINC:{method:"cumprinc",parameters:[{argumentType:Z4.NUMBER,greaterThan:0},{argumentType:Z4.NUMBER,greaterThan:0},{argumentType:Z4.NUMBER,greaterThan:0},{argumentType:Z4.INTEGER,minValue:1},{argumentType:Z4.INTEGER,minValue:1},{argumentType:Z4.INTEGER,minValue:0,maxValue:1}],returnNumberType:j3.NUMBER_CURRENCY},DB:{method:"db",parameters:[{argumentType:Z4.NUMBER,minValue:0},{argumentType:Z4.NUMBER,minValue:0},{argumentType:Z4.INTEGER,minValue:0},{argumentType:Z4.INTEGER,minValue:0},{argumentType:Z4.INTEGER,minValue:1,maxValue:12,defaultValue:12}],returnNumberType:j3.NUMBER_CURRENCY},DDB:{method:"ddb",parameters:[{argumentType:Z4.NUMBER,minValue:0},{argumentType:Z4.NUMBER,minValue:0},{argumentType:Z4.INTEGER,minValue:0},{argumentType:Z4.NUMBER,minValue:0},{argumentType:Z4.NUMBER,greaterThan:0,defaultValue:2}],returnNumberType:j3.NUMBER_CURRENCY},DOLLARDE:{method:"dollarde",parameters:[{argumentType:Z4.NUMBER},{argumentType:Z4.NUMBER,minValue:0}]},DOLLARFR:{method:"dollarfr",parameters:[{argumentType:Z4.NUMBER},{argumentType:Z4.NUMBER,minValue:0}]},EFFECT:{method:"effect",parameters:[{argumentType:Z4.NUMBER,minValue:0},{argumentType:Z4.NUMBER,minValue:1}],returnNumberType:j3.NUMBER_PERCENT},ISPMT:{method:"ispmt",parameters:[{argumentType:Z4.NUMBER},{argumentType:Z4.NUMBER},{argumentType:Z4.NUMBER},{argumentType:Z4.NUMBER}]},NOMINAL:{method:"nominal",parameters:[{argumentType:Z4.NUMBER,minValue:0},{argumentType:Z4.NUMBER,minValue:1}],returnNumberType:j3.NUMBER_PERCENT},NPER:{method:"nper",parameters:[{argumentType:Z4.NUMBER},{argumentType:Z4.NUMBER},{argumentType:Z4.NUMBER},{argumentType:Z4.NUMBER,defaultValue:0},{argumentType:Z4.NUMBER,defaultValue:0}]},PV:{method:"pv",parameters:[{argumentType:Z4.NUMBER},{argumentType:Z4.NUMBER},{argumentType:Z4.NUMBER},{argumentType:Z4.NUMBER,defaultValue:0},{argumentType:Z4.NUMBER,defaultValue:0}],returnNumberType:j3.NUMBER_CURRENCY},RATE:{method:"rate",parameters:[{argumentType:Z4.NUMBER,greaterThan:0},{argumentType:Z4.NUMBER},{argumentType:Z4.NUMBER},{argumentType:Z4.NUMBER,defaultValue:0},{argumentType:Z4.NUMBER,defaultValue:0},{argumentType:Z4.NUMBER,defaultValue:.1}],returnNumberType:j3.NUMBER_PERCENT},RRI:{method:"rri",parameters:[{argumentType:Z4.NUMBER,greaterThan:0},{argumentType:Z4.NUMBER},{argumentType:Z4.NUMBER}],returnNumberType:j3.NUMBER_PERCENT},SLN:{method:"sln",parameters:[{argumentType:Z4.NUMBER},{argumentType:Z4.NUMBER},{argumentType:Z4.NUMBER}],returnNumberType:j3.NUMBER_CURRENCY},SYD:{method:"syd",parameters:[{argumentType:Z4.NUMBER},{argumentType:Z4.NUMBER},{argumentType:Z4.NUMBER,greaterThan:0},{argumentType:Z4.NUMBER,greaterThan:0}],returnNumberType:j3.NUMBER_CURRENCY},TBILLEQ:{method:"tbilleq",parameters:[{argumentType:Z4.NUMBER,minValue:0},{argumentType:Z4.NUMBER,minValue:0},{argumentType:Z4.NUMBER,greaterThan:0}],returnNumberType:j3.NUMBER_PERCENT},TBILLPRICE:{method:"tbillprice",parameters:[{argumentType:Z4.NUMBER,minValue:0},{argumentType:Z4.NUMBER,minValue:0},{argumentType:Z4.NUMBER,greaterThan:0}],returnNumberType:j3.NUMBER_CURRENCY},TBILLYIELD:{method:"tbillyield",parameters:[{argumentType:Z4.NUMBER,minValue:0},{argumentType:Z4.NUMBER,minValue:0},{argumentType:Z4.NUMBER,greaterThan:0}],returnNumberType:j3.NUMBER_PERCENT},FVSCHEDULE:{method:"fvschedule",parameters:[{argumentType:Z4.NUMBER},{argumentType:Z4.RANGE}],returnNumberType:j3.NUMBER_CURRENCY},NPV:{method:"npv",parameters:[{argumentType:Z4.NUMBER},{argumentType:Z4.ANY}],repeatLastArgs:1,returnNumberType:j3.NUMBER_CURRENCY},MIRR:{method:"mirr",parameters:[{argumentType:Z4.RANGE},{argumentType:Z4.NUMBER},{argumentType:Z4.NUMBER}],returnNumberType:j3.NUMBER_PERCENT},PDURATION:{method:"pduration",parameters:[{argumentType:Z4.NUMBER,greaterThan:0},{argumentType:Z4.NUMBER,greaterThan:0},{argumentType:Z4.NUMBER,greaterThan:0}]},XNPV:{method:"xnpv",parameters:[{argumentType:Z4.NUMBER,greaterThan:-1},{argumentType:Z4.RANGE},{argumentType:Z4.RANGE}]}};class d7 extends J4{formulatext(e,t){return this.runFunctionWithReferenceArgument(e.args,t,this.metadata("FORMULATEXT"),(()=>new g4(X9.NA,W2.WrongArgNumber)),(e=>{var t;return null!==(t=this.serialization.getCellFormula(e))&&void 0!==t?t:new g4(X9.NA,W2.Formula)}))}}d7.implementedFunctions={FORMULATEXT:{method:"formulatext",parameters:[{argumentType:Z4.NOERROR}],doesNotNeedArgumentsToBeComputed:!0,isDependentOnSheetStructureChange:!0,vectorizationForbidden:!0}};
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
class p7 extends J4{hyperlink(e,t){return this.runFunction(e.args,t,this.metadata("HYPERLINK"),((t,n)=>(e.hyperlink=t,null!=n?n:t)))}}p7.implementedFunctions={HYPERLINK:{method:"hyperlink",parameters:[{argumentType:Z4.STRING},{argumentType:Z4.STRING,optionalArg:!0}]}};
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
class g7 extends J4{isbinary(e,t){return this.runFunction(e.args,t,this.metadata("ISBINARY"),(e=>/^[01]{1,10}$/.test(e)))}iserr(e,t){return this.runFunction(e.args,t,this.metadata("ISERR"),(e=>e instanceof g4&&e.type!==X9.NA))}iserror(e,t){return this.runFunction(e.args,t,this.metadata("ISERROR"),(e=>e instanceof g4))}isformula(e,t){return this.runFunctionWithReferenceArgument(e.args,t,this.metadata("ISFORMULA"),(()=>new g4(X9.NA,W2.WrongArgNumber)),(e=>this.dependencyGraph.addressMapping.getCell(e)instanceof H9))}isblank(e,t){return this.runFunction(e.args,t,this.metadata("ISBLANK"),(e=>e===_3))}isna(e,t){return this.runFunction(e.args,t,this.metadata("ISNA"),(e=>e instanceof g4&&e.type==X9.NA))}isnumber(e,t){return this.runFunction(e.args,t,this.metadata("ISNUMBER"),W3)}islogical(e,t){return this.runFunction(e.args,t,this.metadata("ISLOGICAL"),(e=>"boolean"==typeof e))}isref(e,t){return this.runFunction(e.args,t,this.metadata("ISREF"),(e=>e instanceof g4&&(e.type==X9.REF||e.type==X9.CYCLE)))}istext(e,t){return this.runFunction(e.args,t,this.metadata("ISTEXT"),(e=>"string"==typeof e))}isnontext(e,t){return this.runFunction(e.args,t,this.metadata("ISNONTEXT"),(e=>!("string"==typeof e)))}column(e,t){return this.runFunctionWithReferenceArgument(e.args,t,this.metadata("COLUMN"),(()=>t.formulaAddress.col+1),(e=>e.col+1))}columns(e,t){if(1!==e.args.length)return new g4(X9.NA,W2.WrongArgNumber);if(e.args.some((e=>e.type===I2.EMPTY)))return new g4(X9.NUM,W2.EmptyArg);let n=e.args[0];for(;n.type===I2.PARENTHESIS;)n=n.expression;if(n.type===I2.CELL_RANGE||n.type===I2.COLUMN_RANGE)return n.end.col-n.start.col+1;if(n.type===I2.CELL_REFERENCE)return 1;if(n.type===I2.ROW_RANGE)return this.config.maxColumns;{const e=this.evaluateAst(n,t);return e instanceof $3?e.width():e instanceof g4?e:1}}row(e,t){return this.runFunctionWithReferenceArgument(e.args,t,this.metadata("ROW"),(()=>t.formulaAddress.row+1),(e=>e.row+1))}rows(e,t){if(1!==e.args.length)return new g4(X9.NA,W2.WrongArgNumber);if(e.args.some((e=>e.type===I2.EMPTY)))return new g4(X9.NUM,W2.EmptyArg);let n=e.args[0];for(;n.type===I2.PARENTHESIS;)n=n.expression;if(n.type===I2.CELL_RANGE||n.type===I2.ROW_RANGE)return n.end.row-n.start.row+1;if(n.type===I2.CELL_REFERENCE)return 1;if(n.type===I2.COLUMN_RANGE)return this.config.maxRows;{const e=this.evaluateAst(n,t);return e instanceof $3?e.height():e instanceof g4?e:1}}index(e,t){return this.runFunction(e.args,t,this.metadata("INDEX"),((e,t,n)=>{var r,i,o,s,a,l;return n<1||t<1?new g4(X9.VALUE,W2.LessThanOne):n>e.width()||t>e.height()?new g4(X9.NUM,W2.ValueLarge):null!==(l=null!==(o=null===(i=null===(r=null==e?void 0:e.data)||void 0===r?void 0:r[t-1])||void 0===i?void 0:i[n-1])&&void 0!==o?o:null===(a=null===(s=null==e?void 0:e.data)||void 0===s?void 0:s[0])||void 0===a?void 0:a[0])&&void 0!==l?l:new g4(X9.VALUE,W2.CellRangeExpected)}))}na(e,t){return new g4(X9.NA)}sheet(e,t){return this.runFunctionWithReferenceArgument(e.args,t,this.metadata("SHEET"),(()=>t.formulaAddress.sheet+1),(e=>e.sheet+1),(e=>{const t=this.dependencyGraph.sheetMapping.get(e);return void 0!==t?t+1:new g4(X9.NA,W2.SheetRef)}))}sheets(e,t){return this.runFunctionWithReferenceArgument(e.args,t,this.metadata("SHEETS"),(()=>this.dependencyGraph.sheetMapping.numberOfSheets()),(()=>1),(()=>new g4(X9.VALUE,W2.CellRefExpected)))}}g7.implementedFunctions={COLUMN:{method:"column",parameters:[{argumentType:Z4.NOERROR,optionalArg:!0}],isDependentOnSheetStructureChange:!0,doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},COLUMNS:{method:"columns",parameters:[{argumentType:Z4.RANGE}],isDependentOnSheetStructureChange:!0,doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},ISBINARY:{method:"isbinary",parameters:[{argumentType:Z4.STRING}]},ISERR:{method:"iserr",parameters:[{argumentType:Z4.SCALAR}]},ISFORMULA:{method:"isformula",parameters:[{argumentType:Z4.NOERROR}],doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},ISNA:{method:"isna",parameters:[{argumentType:Z4.SCALAR}]},ISREF:{method:"isref",parameters:[{argumentType:Z4.SCALAR}],vectorizationForbidden:!0},ISERROR:{method:"iserror",parameters:[{argumentType:Z4.SCALAR}]},ISBLANK:{method:"isblank",parameters:[{argumentType:Z4.SCALAR}]},ISNUMBER:{method:"isnumber",parameters:[{argumentType:Z4.SCALAR}]},ISLOGICAL:{method:"islogical",parameters:[{argumentType:Z4.SCALAR}]},ISTEXT:{method:"istext",parameters:[{argumentType:Z4.SCALAR}]},ISNONTEXT:{method:"isnontext",parameters:[{argumentType:Z4.SCALAR}]},INDEX:{method:"index",parameters:[{argumentType:Z4.RANGE},{argumentType:Z4.NUMBER},{argumentType:Z4.NUMBER,defaultValue:1}]},NA:{method:"na",parameters:[]},ROW:{method:"row",parameters:[{argumentType:Z4.NOERROR,optionalArg:!0}],isDependentOnSheetStructureChange:!0,doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},ROWS:{method:"rows",parameters:[{argumentType:Z4.RANGE}],isDependentOnSheetStructureChange:!0,doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},SHEET:{method:"sheet",parameters:[{argumentType:Z4.STRING}],doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},SHEETS:{method:"sheets",parameters:[{argumentType:Z4.STRING}],doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0}};
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
class m7 extends J4{iseven(e,t){return this.runFunction(e.args,t,this.metadata("ISEVEN"),(e=>e%2==0))}}m7.implementedFunctions={ISEVEN:{method:"iseven",parameters:[{argumentType:Z4.NUMBER}]}};
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
class f7 extends J4{isodd(e,t){return this.runFunction(e.args,t,this.metadata("ISODD"),(e=>e%2==1))}}f7.implementedFunctions={ISODD:{method:"isodd",parameters:[{argumentType:Z4.NUMBER}]}};
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
class w7 extends J4{log10(e,t){return this.runFunction(e.args,t,this.metadata("LOG10"),Math.log10)}log(e,t){return this.runFunction(e.args,t,this.metadata("LOG"),((e,t)=>Math.log(e)/Math.log(t)))}ln(e,t){return this.runFunction(e.args,t,this.metadata("LN"),Math.log)}}w7.implementedFunctions={LOG10:{method:"log10",parameters:[{argumentType:Z4.NUMBER}]},LOG:{method:"log",parameters:[{argumentType:Z4.NUMBER,greaterThan:0},{argumentType:Z4.NUMBER,defaultValue:10,greaterThan:0}]},LN:{method:"ln",parameters:[{argumentType:Z4.NUMBER}]}};
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
const y7=parseFloat(Math.PI.toFixed(14));class v7 extends J4{pi(e,t){return this.runFunction(e.args,t,this.metadata("PI"),(()=>y7))}sqrtpi(e,t){return this.runFunction(e.args,t,this.metadata("SQRTPI"),(e=>Math.sqrt(y7*e)))}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
function C7(e,t){return new e5(t.width,e.height)}function S7(e,t,n){return new e5(1+(e.width-t)/n,1+(e.height-t)/n)}v7.implementedFunctions={PI:{method:"pi",parameters:[]},SQRTPI:{method:"sqrtpi",parameters:[{argumentType:Z4.NUMBER,minValue:0}]}};class R7 extends J4{mmult(e,t){return this.runFunction(e.args,t,this.metadata("MMULT"),((e,t)=>{if(!e.hasOnlyNumbers()||!t.hasOnlyNumbers())return new g4(X9.VALUE,W2.NumberRange);if(t.height()!==e.width())return new g4(X9.VALUE,W2.ArrayDimensions);const n=C7(e.size,t.size),r=this.createKernel((function(e,t,n){let r=0;for(let i=0;i<n;++i)r+=e[this.thread.y][i]*t[i][this.thread.x];return r}),n)(e.rawNumbers(),t.rawNumbers(),e.width());return $3.onlyNumbers(r)}))}mmultArraySize(e,t){if(2!==e.args.length)return e5.error();const n=this.metadata("MMULT"),r=e.args.map((e=>{var r;return this.arraySizeForAst(e,new x4(t.formulaAddress,t.arraysFlag||null!==(r=null==n?void 0:n.arrayFunction)&&void 0!==r&&r))})),[i,o]=r;return C7(i,o)}maxpool(e,t){return this.runFunction(e.args,t,this.metadata("MAXPOOL"),((e,t,n=t)=>{if(!e.hasOnlyNumbers())return new g4(X9.VALUE,W2.NumberRange);const r=S7(e.size,t,n),i=this.createKernel((function(e,t,n){const r=this.thread.x*n,i=this.thread.y*n;let o=e[i][r];for(let s=0;s<t;s++)for(let n=0;n<t;n++)o=Math.max(o,e[i+s][r+n]);return o}),r)(e.rawNumbers(),t,n);return $3.onlyNumbers(i)}))}medianpool(e,t){return this.runFunction(e.args,t,this.metadata("MEDIANPOOL"),((e,t,n=t)=>{if(!e.hasOnlyNumbers())return new g4(X9.VALUE,W2.NumberRange);const r=S7(e.size,t,n),i=this.createKernel((function(e,t,n){const r=this.thread.x*n,i=this.thread.y*n;let o=e[i][r];for(let c=0;c<t;c++)for(let n=0;n<t;n++)o=Math.max(o,e[i+c][r+n]);let s=e[i][r];for(let c=0;c<t;c++)for(let n=0;n<t;n++)s=Math.min(s,e[i+c][r+n]);const a=t*t;let l=s,h=o,u=42;for(let c=0;c<32;c++){const n=(l+h)/2;let o=0;for(let s=0;s<t;s++)for(let a=0;a<t;a++)e[i+s][r+a]>n&&o++;if(t%2==0){if(o===a/2){u=n;break}o>a/2?l=n:h=n}else{if(o===(a-1)/2){u=n;break}o>(a-1)/2?l=n:h=n}}return u}),r)(e.rawNumbers(),t,n);return $3.onlyNumbers(i)}))}maxpoolArraySize(e,t){if(e.args.length<2||e.args.length>3)return e5.error();const n=this.metadata("MAXPOOL"),r=e.args.map((e=>{var r;return this.arraySizeForAst(e,new x4(t.formulaAddress,t.arraysFlag||null!==(r=null==n?void 0:n.arrayFunction)&&void 0!==r&&r))}))[0],i=e.args[1];let o;o=i.type===I2.NUMBER?i.value:1;let s=o;if(3===e.args.length){const t=e.args[2];s=t.type===I2.NUMBER?t.value:1}return o>r.width||o>r.height||s>o||(r.width-o)%s!=0||(r.height-o)%s!=0?e5.error():S7(r,o,s)}medianpoolArraySize(e,t){return this.maxpoolArraySize(e,t)}transpose(e,t){return this.runFunction(e.args,t,this.metadata("TRANSPOSE"),(e=>{const t=e.rawData(),n=e.size,r=[];for(let i=0;i<n.width;++i){r[i]=[];for(let e=0;e<n.height;++e)r[i][e]=t[e][i]}return $3.onlyValues(r)}))}transposeArraySize(e,t){if(1!==e.args.length)return e5.error();const n=this.metadata("TRANSPOSE"),r=e.args.map((e=>{var r;return this.arraySizeForAst(e,new x4(t.formulaAddress,t.arraysFlag||null!==(r=null==n?void 0:n.arrayFunction)&&void 0!==r&&r))})),[i]=r;return new e5(i.height,i.width)}createKernel(e,t){return function(...n){const r=[];for(let i=0;i<t.height;++i){r.push([]);for(let o=0;o<t.width;++o)r[i][o]=e.apply({thread:{x:o,y:i}},n)}return r}}}R7.implementedFunctions={MMULT:{method:"mmult",arraySizeMethod:"mmultArraySize",parameters:[{argumentType:Z4.RANGE},{argumentType:Z4.RANGE}],vectorizationForbidden:!0},TRANSPOSE:{method:"transpose",arraySizeMethod:"transposeArraySize",parameters:[{argumentType:Z4.RANGE}],vectorizationForbidden:!0},MAXPOOL:{method:"maxpool",arraySizeMethod:"maxpoolArraySize",parameters:[{argumentType:Z4.RANGE},{argumentType:Z4.NUMBER},{argumentType:Z4.NUMBER,optionalArg:!0}],vectorizationForbidden:!0},MEDIANPOOL:{method:"medianpool",arraySizeMethod:"medianpoolArraySize",parameters:[{argumentType:Z4.RANGE},{argumentType:Z4.NUMBER},{argumentType:Z4.NUMBER,optionalArg:!0}],vectorizationForbidden:!0}};
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
class E7 extends J4{median(e,t){return this.runFunction(e.args,t,this.metadata("MEDIAN"),((...e)=>{const t=this.arithmeticHelper.coerceNumbersExactRanges(e);return t instanceof g4?t:0===t.length?new g4(X9.NUM,W2.OneValue):(t.sort(((e,t)=>e-t)),t.length%2==0?(t[t.length/2-1]+t[t.length/2])/2:t[Math.floor(t.length/2)])}))}large(e,t){return this.runFunction(e.args,t,this.metadata("LARGE"),((e,t)=>{const n=this.arithmeticHelper.manyToExactNumbers(e.valuesFromTopLeftCorner());return n instanceof g4?n:(n.sort(((e,t)=>e-t)),(t=Math.trunc(t))>n.length?new g4(X9.NUM,W2.ValueLarge):n[n.length-t])}))}small(e,t){return this.runFunction(e.args,t,this.metadata("SMALL"),((e,t)=>{const n=this.arithmeticHelper.manyToExactNumbers(e.valuesFromTopLeftCorner());return n instanceof g4?n:(n.sort(((e,t)=>e-t)),(t=Math.trunc(t))>n.length?new g4(X9.NUM,W2.ValueLarge):n[t-1])}))}}E7.implementedFunctions={MEDIAN:{method:"median",parameters:[{argumentType:Z4.ANY}],repeatLastArgs:1},LARGE:{method:"large",parameters:[{argumentType:Z4.RANGE},{argumentType:Z4.NUMBER,minValue:1}]},SMALL:{method:"small",parameters:[{argumentType:Z4.RANGE},{argumentType:Z4.NUMBER,minValue:1}]}};
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
class b7 extends J4{mod(e,t){return this.runFunction(e.args,t,this.metadata("MOD"),((e,t)=>0===t?new g4(X9.DIV_BY_ZERO):e%t))}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
function T7(e){return W3(e)&&!Number.isFinite(L3(e))?0:e}b7.implementedFunctions={MOD:{method:"mod",parameters:[{argumentType:Z4.NUMBER},{argumentType:Z4.NUMBER}]}};class N7{constructor(e,t,n){this.sumsq=e,this.sum=t,this.count=n}static single(e){return new N7(e*e,e,1)}compose(e){return new N7(this.sumsq+e.sumsq,this.sum+e.sum,this.count+e.count)}averageValue(){return this.count>0?this.sum/this.count:void 0}varSValue(){return this.count>1?(this.sumsq-this.sum*this.sum/this.count)/(this.count-1):void 0}varPValue(){return this.count>0?(this.sumsq-this.sum*this.sum/this.count)/this.count:void 0}}N7.empty=new N7(0,0,0);class A7 extends J4{constructor(){super(...arguments),this.addWithEpsilonRaw=(e,t)=>this.arithmeticHelper.addWithEpsilonRaw(e,t)}sum(e,t){return this.doSum(e.args,t)}sumsq(e,t){return this.reduce(e.args,t,0,"SUMSQ",this.addWithEpsilonRaw,(e=>Math.pow(L3(e),2)),M7)}max(e,t){return this.doMax(e.args,t)}maxa(e,t){const n=this.reduce(e.args,t,Number.NEGATIVE_INFINITY,"MAXA",((e,t)=>Math.max(e,t)),L3,I7);return T7(n)}min(e,t){return this.doMin(e.args,t)}mina(e,t){const n=this.reduce(e.args,t,Number.POSITIVE_INFINITY,"MINA",((e,t)=>Math.min(e,t)),L3,I7);return T7(n)}count(e,t){return this.doCount(e.args,t)}counta(e,t){return this.doCounta(e.args,t)}average(e,t){return this.doAverage(e.args,t)}averagea(e,t){var n;const r=this.reduce(e.args,t,N7.empty,"_AGGREGATE_A",((e,t)=>e.compose(t)),(e=>N7.single(L3(e))),I7);return r instanceof g4?r:null!==(n=r.averageValue())&&void 0!==n?n:new g4(X9.DIV_BY_ZERO)}vars(e,t){return this.doVarS(e.args,t)}varp(e,t){return this.doVarP(e.args,t)}vara(e,t){var n;const r=this.reduceAggregateA(e.args,t);return r instanceof g4?r:null!==(n=r.varSValue())&&void 0!==n?n:new g4(X9.DIV_BY_ZERO)}varpa(e,t){var n;const r=this.reduceAggregateA(e.args,t);return r instanceof g4?r:null!==(n=r.varPValue())&&void 0!==n?n:new g4(X9.DIV_BY_ZERO)}stdevs(e,t){return this.doStdevS(e.args,t)}stdevp(e,t){return this.doStdevP(e.args,t)}stdeva(e,t){const n=this.reduceAggregateA(e.args,t);if(n instanceof g4)return n;{const e=n.varSValue();return void 0===e?new g4(X9.DIV_BY_ZERO):Math.sqrt(e)}}stdevpa(e,t){const n=this.reduceAggregateA(e.args,t);if(n instanceof g4)return n;{const e=n.varPValue();return void 0===e?new g4(X9.DIV_BY_ZERO):Math.sqrt(e)}}product(e,t){return this.doProduct(e.args,t)}subtotal(e,t){if(e.args.length<2)return new g4(X9.NA,W2.WrongArgNumber);const n=this.coerceToType(this.evaluateAst(e.args[0],t),{argumentType:Z4.NUMBER},t),r=e.args.slice(1);switch(n){case 1:case 101:return this.doAverage(r,t);case 2:case 102:return this.doCount(r,t);case 3:case 103:return this.doCounta(r,t);case 4:case 104:return this.doMax(r,t);case 5:case 105:return this.doMin(r,t);case 6:case 106:return this.doProduct(r,t);case 7:case 107:return this.doStdevS(r,t);case 8:case 108:return this.doStdevP(r,t);case 9:case 109:return this.doSum(r,t);case 10:case 110:return this.doVarS(r,t);case 11:case 111:return this.doVarP(r,t);default:return new g4(X9.VALUE,W2.BadMode)}}reduceAggregate(e,t){return this.reduce(e,t,N7.empty,"_AGGREGATE",((e,t)=>e.compose(t)),(e=>N7.single(L3(e))),M7)}reduceAggregateA(e,t){return this.reduce(e,t,N7.empty,"_AGGREGATE_A",((e,t)=>e.compose(t)),(e=>N7.single(L3(e))),I7)}doAverage(e,t){var n;const r=this.reduceAggregate(e,t);return r instanceof g4?r:null!==(n=r.averageValue())&&void 0!==n?n:new g4(X9.DIV_BY_ZERO)}doVarS(e,t){var n;const r=this.reduceAggregate(e,t);return r instanceof g4?r:null!==(n=r.varSValue())&&void 0!==n?n:new g4(X9.DIV_BY_ZERO)}doVarP(e,t){var n;const r=this.reduceAggregate(e,t);return r instanceof g4?r:null!==(n=r.varPValue())&&void 0!==n?n:new g4(X9.DIV_BY_ZERO)}doStdevS(e,t){const n=this.reduceAggregate(e,t);if(n instanceof g4)return n;{const e=n.varSValue();return void 0===e?new g4(X9.DIV_BY_ZERO):Math.sqrt(e)}}doStdevP(e,t){const n=this.reduceAggregate(e,t);if(n instanceof g4)return n;{const e=n.varPValue();return void 0===e?new g4(X9.DIV_BY_ZERO):Math.sqrt(e)}}doCount(e,t){return this.reduce(e,t,0,"COUNT",((e,t)=>e+t),L3,(e=>W3(e)?1:0))}doCounta(e,t){return this.reduce(e,t,0,"COUNTA",((e,t)=>e+t),L3,(e=>e===_3?0:1))}doMax(e,t){const n=this.reduce(e,t,Number.NEGATIVE_INFINITY,"MAX",((e,t)=>Math.max(e,t)),L3,M7);return T7(n)}doMin(e,t){const n=this.reduce(e,t,Number.POSITIVE_INFINITY,"MIN",((e,t)=>Math.min(e,t)),L3,M7);return T7(n)}doSum(e,t){return this.reduce(e,t,0,"SUM",this.addWithEpsilonRaw,L3,M7)}doProduct(e,t){return this.reduce(e,t,1,"PRODUCT",((e,t)=>e*t),L3,M7)}reduce(e,t,n,r,i,o,s){return e.length<1?new g4(X9.NA,W2.WrongArgNumber):e.reduce(((e,a)=>{if(e instanceof g4)return e;if(a.type===I2.CELL_RANGE||a.type===I2.COLUMN_RANGE||a.type===I2.ROW_RANGE){const l=this.evaluateRange(a,t,n,r,i,o,s);return l instanceof g4?l:i(l,e)}let l;if(l=this.evaluateAst(a,t),l instanceof $3){const t=Array.from(l.valuesFromTopLeftCorner()).map(s).filter((e=>void 0!==e));return t.map((e=>e instanceof g4?e:o(e))).reduce(((e,t)=>e instanceof g4?e:t instanceof g4?t:i(e,t)),e)}if(a.type===I2.CELL_REFERENCE){if(l=s(l),void 0===l)return e}else if(l=this.coerceScalarToNumberOrError(l),l=s(l),void 0===l)return e;return l instanceof g4?l:i(e,o(l))}),n)}evaluateRange(e,t,n,r,i,o,s){let a;try{a=M4.fromAst(e,t.formulaAddress)}catch(u){if(u instanceof o9)return new g4(X9.REF,W2.RangeManySheets);throw u}const l=this.dependencyGraph.getRange(a.start,a.end);if(void 0===l)throw new Error("Range does not exists in graph");let h=l.getFunctionValue(r);if(void 0===h){h=this.getRangeValues(r,a,l,o,s).reduce(((e,t)=>e instanceof g4?e:t instanceof g4?t:i(e,t)),n),l.setFunctionValue(r,h)}return h}getRangeValues(e,t,n,r,i){const o=[],{smallerRangeVertex:s,restRange:a}=this.dependencyGraph.rangeMapping.findSmallerRange(t);let l;if(void 0!==s&&this.dependencyGraph.existsEdge(s,n)){const t=s.getFunctionValue(e);if(void 0!==t)o.push(t);else for(const e of s.range.addresses(this.dependencyGraph)){const t=i(this.dependencyGraph.getScalarValue(e));t instanceof g4?o.push(t):void 0!==t&&o.push(r(t))}l=a}else l=t;for(const h of l.addresses(this.dependencyGraph)){const e=i(this.dependencyGraph.getScalarValue(h));e instanceof g4?o.push(e):void 0!==e&&o.push(r(e))}return o}}function M7(e){return W3(e)||e instanceof g4?e:void 0}function I7(e){return"boolean"==typeof e?k4(e):W3(e)||e instanceof g4?e:"string"==typeof e?0:void 0}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */A7.implementedFunctions={SUM:{method:"sum",parameters:[{argumentType:Z4.ANY}],repeatLastArgs:1},SUMSQ:{method:"sumsq",parameters:[{argumentType:Z4.ANY}],repeatLastArgs:1},MAX:{method:"max",parameters:[{argumentType:Z4.ANY}],repeatLastArgs:1},MIN:{method:"min",parameters:[{argumentType:Z4.ANY}],repeatLastArgs:1},MAXA:{method:"maxa",parameters:[{argumentType:Z4.ANY}],repeatLastArgs:1},MINA:{method:"mina",parameters:[{argumentType:Z4.ANY}],repeatLastArgs:1},COUNT:{method:"count",parameters:[{argumentType:Z4.ANY}],repeatLastArgs:1},COUNTA:{method:"counta",parameters:[{argumentType:Z4.ANY}],repeatLastArgs:1},AVERAGE:{method:"average",parameters:[{argumentType:Z4.ANY}],repeatLastArgs:1},AVERAGEA:{method:"averagea",parameters:[{argumentType:Z4.ANY}],repeatLastArgs:1},PRODUCT:{method:"product",parameters:[{argumentType:Z4.ANY}],repeatLastArgs:1},"VAR.S":{method:"vars",parameters:[{argumentType:Z4.ANY}],repeatLastArgs:1},"VAR.P":{method:"varp",parameters:[{argumentType:Z4.ANY}],repeatLastArgs:1},VARA:{method:"vara",parameters:[{argumentType:Z4.ANY}],repeatLastArgs:1},VARPA:{method:"varpa",parameters:[{argumentType:Z4.ANY}],repeatLastArgs:1},"STDEV.S":{method:"stdevs",parameters:[{argumentType:Z4.ANY}],repeatLastArgs:1},"STDEV.P":{method:"stdevp",parameters:[{argumentType:Z4.ANY}],repeatLastArgs:1},STDEVA:{method:"stdeva",parameters:[{argumentType:Z4.ANY}],repeatLastArgs:1},STDEVPA:{method:"stdevpa",parameters:[{argumentType:Z4.ANY}],repeatLastArgs:1},SUBTOTAL:{method:"subtotal",parameters:[{argumentType:Z4.NUMBER},{argumentType:Z4.ANY}],repeatLastArgs:1}},A7.aliases={VAR:"VAR.S",VARP:"VAR.P",STDEV:"STDEV.S",STDEVP:"STDEV.P",VARS:"VAR.S",STDEVS:"STDEV.S"};class O7 extends J4{power(e,t){return this.runFunction(e.args,t,this.metadata("POWER"),Math.pow)}}O7.implementedFunctions={POWER:{method:"power",parameters:[{argumentType:Z4.NUMBER},{argumentType:Z4.NUMBER}]}};
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
class x7 extends J4{radians(e,t){return this.runFunction(e.args,t,this.metadata("RADIANS"),(e=>e*(Math.PI/180)))}}x7.implementedFunctions={RADIANS:{method:"radians",parameters:[{argumentType:Z4.NUMBER}]}};
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
const P7=10;class _7 extends J4{dec2bin(e,t){return this.runFunction(e.args,t,this.metadata("DEC2BIN"),((e,t)=>H7(e,2,t)))}dec2oct(e,t){return this.runFunction(e.args,t,this.metadata("DEC2OCT"),((e,t)=>H7(e,8,t)))}dec2hex(e,t){return this.runFunction(e.args,t,this.metadata("DEC2HEX"),((e,t)=>H7(e,16,t)))}bin2dec(e,t){return this.runFunction(e.args,t,this.metadata("BIN2DEC"),(e=>{const t=L7(e,2,P7);return void 0===t?new g4(X9.NUM,W2.NotBinary):V7(t,2)}))}bin2oct(e,t){return this.runFunction(e.args,t,this.metadata("BIN2OCT"),((e,t)=>{const n=L7(e,2,P7);return void 0===n?new g4(X9.NUM,W2.NotBinary):H7(V7(n,2),8,t)}))}bin2hex(e,t){return this.runFunction(e.args,t,this.metadata("BIN2HEX"),((e,t)=>{const n=L7(e,2,P7);return void 0===n?new g4(X9.NUM,W2.NotBinary):H7(V7(n,2),16,t)}))}oct2dec(e,t){return this.runFunction(e.args,t,this.metadata("OCT2DEC"),(e=>{const t=L7(e,8,P7);return void 0===t?new g4(X9.NUM,W2.NotOctal):V7(t,8)}))}oct2bin(e,t){return this.runFunction(e.args,t,this.metadata("OCT2BIN"),((e,t)=>{const n=L7(e,8,P7);return void 0===n?new g4(X9.NUM,W2.NotOctal):H7(V7(n,8),2,t)}))}oct2hex(e,t){return this.runFunction(e.args,t,this.metadata("OCT2HEX"),((e,t)=>{const n=L7(e,8,P7);return void 0===n?new g4(X9.NUM,W2.NotOctal):H7(V7(n,8),16,t)}))}hex2dec(e,t){return this.runFunction(e.args,t,this.metadata("HEX2DEC"),(e=>{const t=L7(e,16,P7);return void 0===t?new g4(X9.NUM,W2.NotHex):V7(t,16)}))}hex2bin(e,t){return this.runFunction(e.args,t,this.metadata("HEX2BIN"),((e,t)=>{const n=L7(e,16,P7);return void 0===n?new g4(X9.NUM,W2.NotHex):H7(V7(n,16),2,t)}))}hex2oct(e,t){return this.runFunction(e.args,t,this.metadata("HEX2OCT"),((e,t)=>{const n=L7(e,16,P7);return void 0===n?new g4(X9.NUM,W2.NotHex):H7(V7(n,16),8,t)}))}base(e,t){return this.runFunction(e.args,t,this.metadata("BASE"),F7)}decimal(e,t){return this.runFunction(e.args,t,this.metadata("DECIMAL"),((e,t)=>{const n=L7(e,t,255);return void 0===n?new g4(X9.NUM,W2.NotHex):parseInt(n,t)}))}}function L7(e,t,n){const r="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ".substr(0,t),i=new RegExp(`^[${r}]+$`);if(!(e.length>n)&&i.test(e))return e}function H7(e,t,n){if(e>function(e){return-k7(e)-1}(t))return new g4(X9.NUM,W2.ValueBaseLarge);if(e<k7(t))return new g4(X9.NUM,W2.ValueBaseSmall);const r=D7(e,t);return void 0===n||e<0?r:r.length>n?new g4(X9.NUM,W2.ValueBaseLong):D5(r,n)}function k7(e){return-Math.pow(e,P7)/2}function F7(e,t,n){const r=D7(e,t);return void 0!==n&&n>r.length?D5(r,n):r}function D7(e,t){return(e+(e<0?Math.pow(t,P7):0)).toString(t).toUpperCase()}function V7(e,t){const n=parseInt(e,t),r=Math.pow(t,P7);return n>=r/2?n-r:n}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */_7.implementedFunctions={DEC2BIN:{method:"dec2bin",parameters:[{argumentType:Z4.NUMBER},{argumentType:Z4.NUMBER,optionalArg:!0,minValue:1,maxValue:10}]},DEC2OCT:{method:"dec2oct",parameters:[{argumentType:Z4.NUMBER},{argumentType:Z4.NUMBER,optionalArg:!0,minValue:1,maxValue:10}]},DEC2HEX:{method:"dec2hex",parameters:[{argumentType:Z4.NUMBER},{argumentType:Z4.NUMBER,optionalArg:!0,minValue:1,maxValue:10}]},BIN2DEC:{method:"bin2dec",parameters:[{argumentType:Z4.STRING}]},BIN2OCT:{method:"bin2oct",parameters:[{argumentType:Z4.STRING},{argumentType:Z4.NUMBER,optionalArg:!0,minValue:0,maxValue:P7}]},BIN2HEX:{method:"bin2hex",parameters:[{argumentType:Z4.STRING},{argumentType:Z4.NUMBER,optionalArg:!0,minValue:0,maxValue:P7}]},OCT2DEC:{method:"oct2dec",parameters:[{argumentType:Z4.STRING}]},OCT2BIN:{method:"oct2bin",parameters:[{argumentType:Z4.STRING},{argumentType:Z4.NUMBER,optionalArg:!0,minValue:0,maxValue:P7}]},OCT2HEX:{method:"oct2hex",parameters:[{argumentType:Z4.STRING},{argumentType:Z4.NUMBER,optionalArg:!0,minValue:0,maxValue:P7}]},HEX2DEC:{method:"hex2dec",parameters:[{argumentType:Z4.STRING}]},HEX2BIN:{method:"hex2bin",parameters:[{argumentType:Z4.STRING},{argumentType:Z4.NUMBER,optionalArg:!0,minValue:0,maxValue:P7}]},HEX2OCT:{method:"hex2oct",parameters:[{argumentType:Z4.STRING},{argumentType:Z4.NUMBER,optionalArg:!0,minValue:0,maxValue:P7}]},DECIMAL:{method:"decimal",parameters:[{argumentType:Z4.STRING},{argumentType:Z4.NUMBER,minValue:2,maxValue:36}]},BASE:{method:"base",parameters:[{argumentType:Z4.NUMBER,minValue:0},{argumentType:Z4.NUMBER,minValue:2,maxValue:36},{argumentType:Z4.NUMBER,optionalArg:!0,minValue:0,maxValue:255}]}};class U7 extends J4{rand(e,t){return this.runFunction(e.args,t,this.metadata("RAND"),Math.random)}randbetween(e,t){return this.runFunction(e.args,t,this.metadata("RANDBETWEEN"),((e,t)=>t<e?new g4(X9.NUM,W2.WrongOrder):((e=Math.ceil(e))===(t=Math.floor(t)+1)&&(t+=1),e+Math.floor(Math.random()*(t-e)))))}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
function B7(e){const t=Math.ceil(e);return t%2==1?t:t+1}function W7(e){const t=Math.ceil(e);return t%2==0?t:t+1}U7.implementedFunctions={RAND:{method:"rand",parameters:[],isVolatile:!0},RANDBETWEEN:{method:"randbetween",parameters:[{argumentType:Z4.NUMBER},{argumentType:Z4.NUMBER}],isVolatile:!0}};class j7 extends J4{roundup(e,t){return this.runFunction(e.args,t,this.metadata("ROUNDDOWN"),((e,t)=>{const n=Math.pow(10,t);return e<0?-Math.ceil(-e*n)/n:Math.ceil(e*n)/n}))}rounddown(e,t){return this.runFunction(e.args,t,this.metadata("ROUNDDOWN"),((e,t)=>{const n=Math.pow(10,t);return e<0?-Math.floor(-e*n)/n:Math.floor(e*n)/n}))}round(e,t){return this.runFunction(e.args,t,this.metadata("ROUND"),((e,t)=>{const n=Math.pow(10,t);return e<0?-Math.round(-e*n)/n:Math.round(e*n)/n}))}intFunc(e,t){return this.runFunction(e.args,t,this.metadata("INT"),(e=>e<0?-Math.floor(-e):Math.floor(e)))}even(e,t){return this.runFunction(e.args,t,this.metadata("EVEN"),(e=>e<0?-W7(-e):W7(e)))}odd(e,t){return this.runFunction(e.args,t,this.metadata("ODD"),(e=>e<0?-B7(-e):B7(e)))}ceilingmath(e,t){return this.runFunction(e.args,t,this.metadata("CEILING.MATH"),((e,t,n)=>0===t||0===e?0:(t=Math.abs(t),1===n&&e<0&&(t=-t),Math.ceil(e/t)*t)))}ceiling(e,t){return this.runFunction(e.args,t,this.metadata("CEILING"),((e,t)=>0===e?0:0===t?new g4(X9.DIV_BY_ZERO):e>0&&t<0?new g4(X9.NUM,W2.DistinctSigns):Math.ceil(e/t)*t))}ceilingprecise(e,t){return this.runFunction(e.args,t,this.metadata("CEILING.PRECISE"),((e,t)=>0===t||0===e?0:(t=Math.abs(t),Math.ceil(e/t)*t)))}floormath(e,t){return this.runFunction(e.args,t,this.metadata("FLOOR.MATH"),((e,t,n)=>0===t||0===e?0:(t=Math.abs(t),1===n&&e<0&&(t*=-1),Math.floor(e/t)*t)))}floor(e,t){return this.runFunction(e.args,t,this.metadata("FLOOR"),((e,t)=>0===e?0:0===t?new g4(X9.DIV_BY_ZERO):e>0&&t<0?new g4(X9.NUM,W2.DistinctSigns):Math.floor(e/t)*t))}floorprecise(e,t){return this.runFunction(e.args,t,this.metadata("FLOOR.PRECISE"),((e,t)=>0===t||0===e?0:(t=Math.abs(t),Math.floor(e/t)*t)))}}j7.implementedFunctions={ROUNDUP:{method:"roundup",parameters:[{argumentType:Z4.NUMBER},{argumentType:Z4.NUMBER,defaultValue:0}]},ROUNDDOWN:{method:"rounddown",parameters:[{argumentType:Z4.NUMBER},{argumentType:Z4.NUMBER,defaultValue:0}]},ROUND:{method:"round",parameters:[{argumentType:Z4.NUMBER},{argumentType:Z4.NUMBER,defaultValue:0}]},INT:{method:"intFunc",parameters:[{argumentType:Z4.NUMBER}]},EVEN:{method:"even",parameters:[{argumentType:Z4.NUMBER}]},ODD:{method:"odd",parameters:[{argumentType:Z4.NUMBER}]},"CEILING.MATH":{method:"ceilingmath",parameters:[{argumentType:Z4.NUMBER},{argumentType:Z4.NUMBER,defaultValue:1},{argumentType:Z4.NUMBER,defaultValue:0}]},CEILING:{method:"ceiling",parameters:[{argumentType:Z4.NUMBER},{argumentType:Z4.NUMBER}]},"CEILING.PRECISE":{method:"ceilingprecise",parameters:[{argumentType:Z4.NUMBER},{argumentType:Z4.NUMBER,defaultValue:1}]},"FLOOR.MATH":{method:"floormath",parameters:[{argumentType:Z4.NUMBER},{argumentType:Z4.NUMBER,defaultValue:1},{argumentType:Z4.NUMBER,defaultValue:0}]},FLOOR:{method:"floor",parameters:[{argumentType:Z4.NUMBER},{argumentType:Z4.NUMBER}]},"FLOOR.PRECISE":{method:"floorprecise",parameters:[{argumentType:Z4.NUMBER},{argumentType:Z4.NUMBER,defaultValue:1}]}},j7.aliases={"ISO.CEILING":"CEILING.PRECISE",TRUNC:"ROUNDDOWN"};
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
class G7 extends J4{sqrt(e,t){return this.runFunction(e.args,t,this.metadata("SQRT"),Math.sqrt)}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
function*z7(){}function $7(e){const t=e[Symbol.iterator](),{done:n,value:r}=t.next();return n?{rest:z7()}:{value:r,rest:t}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */G7.implementedFunctions={SQRT:{method:"sqrt",parameters:[{argumentType:Z4.NUMBER}]}};class Y7{constructor(e,t,n,r,i){this.interpreter=e,this.cacheKey=t,this.reduceInitialValue=n,this.composeFunction=r,this.mapFunction=i,this.dependencyGraph=this.interpreter.dependencyGraph}compute(e,t){for(const i of t)if(!i.conditionRange.sameDimensionsAs(e))return new g4(X9.VALUE,W2.EqualLength);const n=this.tryToGetRangeVertexForRangeValue(e),r=t.map((e=>this.tryToGetRangeVertexForRangeValue(e.conditionRange)));if(n&&r.every((e=>void 0!==e))){const i=t.map((e=>e.criterionPackage.raw)).join(","),o=this.findAlreadyComputedValueInCache(n,this.cacheKey(t),i);if(void 0!==o)return this.interpreter.stats.incrementCriterionFunctionFullCacheUsed(),o;const s=this.buildNewCriterionCache(this.cacheKey(t),t.map((e=>e.conditionRange.range)),e.range);return s.has(i)||s.set(i,[this.evaluateRangeValue(e,t),t.map((e=>e.criterionPackage.lambda))]),n.setCriterionFunctionValues(this.cacheKey(t),s),r.forEach((e=>{void 0!==e&&e.addDependentCacheRange(n)})),s.get(i)[0]}return this.evaluateRangeValue(e,t)}tryToGetRangeVertexForRangeValue(e){const t=e.range;return void 0===t?void 0:this.dependencyGraph.getRange(t.start,t.end)}reduceFunction(e){let t=this.reduceInitialValue;for(const n of e)t=this.composeFunction(t,n);return t}findAlreadyComputedValueInCache(e,t,n){return e.getCriterionFunctionValue(t,n)}evaluateRangeValue(e,t){const n=t.map((e=>e.criterionPackage.lambda)),r=Array.from(e.valuesFromTopLeftCorner()).map(this.mapFunction)[Symbol.iterator](),i=t.map((e=>e.conditionRange.iterateValuesFromTopLeftCorner())),o=q7(n,i,r);return this.reduceFunction(o)}buildNewCriterionCache(e,t,n){const r=this.dependencyGraph.getRange(n.start,n.end),{smallerRangeVertex:i,restConditionRanges:o,restValuesRange:s}=((e,t,n)=>{if(n.end.row>n.start.row){const r=v4(n.end.sheet,n.end.col,n.end.row-1),i=e.getRange(n.start,r);if(void 0!==i)return{smallerRangeVertex:i,restValuesRange:n.withStart(v4(n.start.sheet,n.start.col,n.end.row)),restConditionRanges:t.map((e=>e.withStart(v4(e.start.sheet,e.start.col,e.end.row))))}}return{restValuesRange:n,restConditionRanges:t}})(this.dependencyGraph,t,n);let a;a=void 0!==i&&this.dependencyGraph.existsEdge(i,r)?i.getCriterionFunctionValues(e):new Map;const l=new Map;return a.forEach((([e,t],n)=>{const r=q7(t,o.map((e=>X7(this.dependencyGraph,e))),Array.from(X7(this.dependencyGraph,s)).map(this.mapFunction)[Symbol.iterator]()),i=this.composeFunction(e,this.reduceFunction(r));this.interpreter.stats.incrementCriterionFunctionPartialCacheUsed(),l.set(n,[i,t])})),l}}class K7{constructor(e,t){this.conditionRange=e,this.criterionPackage=t}}function*X7(e,t){for(const n of t.addresses(e))yield L3(e.getScalarValue(n))}function*q7(e,t,n){for(const r of n){const n=t.map((e=>$7(e)));if(!n.every((e=>Object.prototype.hasOwnProperty.call(e,"value"))))return;Q7(n.map((e=>L3(e.value))),e).every((([e,t])=>t(e)))&&(yield r),t=n.map((e=>e.rest))}}function Q7(e,t){const n=[];for(let r=0;r<Math.min(e.length,t.length);r++)n.push([e[r],t[r]]);return n}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class Z7{constructor(e,t){this.sum=e,this.count=t}static single(e){return new Z7(e,1)}compose(e){return new Z7(this.sum+e.sum,this.count+e.count)}averageValue(){return this.count>0?this.sum/this.count:void 0}}function J7(e){return W3(e)&&!Number.isFinite(L3(e))?0:e}function eee(e){return e instanceof g4?e:W3(e)?L3(e):void 0}Z7.empty=new Z7(0,0);class tee extends J4{sumif(e,t){const n="SUMIF";return this.runFunction(e.args,t,this.metadata(n),((e,t,r)=>this.computeConditionalAggregationFunction(null!=r?r:e,[e,t],n,0,((e,t)=>this.arithmeticHelper.nonstrictadd(e,t)),eee)))}sumifs(e,t){const n="SUMIFS";return this.runFunction(e.args,t,this.metadata(n),((e,...t)=>this.computeConditionalAggregationFunction(e,t,n,0,((e,t)=>this.arithmeticHelper.nonstrictadd(e,t)),eee)))}averageif(e,t){const n="AVERAGEIF";return this.runFunction(e.args,t,this.metadata(n),((e,t,r)=>{const i=this.computeConditionalAggregationFunction(null!=r?r:e,[e,t],n,Z7.empty,((e,t)=>e.compose(t)),(e=>W3(e)?Z7.single(L3(e)):Z7.empty));return i instanceof g4?i:i.averageValue()||new g4(X9.DIV_BY_ZERO)}))}countif(e,t){const n="COUNTIF";return this.runFunction(e.args,t,this.metadata(n),((e,t)=>this.computeConditionalAggregationFunction(e,[e,t],n,0,((e,t)=>e+t),(()=>1))))}countifs(e,t){const n="COUNTIFS";return this.runFunction(e.args,t,this.metadata(n),((...e)=>this.computeConditionalAggregationFunction(e[0],e,n,0,((e,t)=>e+t),(()=>1))))}minifs(e,t){const n="MINIFS",r=(e,t)=>void 0===t||void 0===e?void 0===t?e:t:Math.min(e,t);return this.runFunction(e.args,t,this.metadata(n),((e,...t)=>J7(this.computeConditionalAggregationFunction(e,t,n,Number.POSITIVE_INFINITY,r,eee))))}maxifs(e,t){const n="MAXIFS",r=(e,t)=>void 0===t||void 0===e?void 0===t?e:t:Math.max(e,t);return this.runFunction(e.args,t,this.metadata(n),((e,...t)=>J7(this.computeConditionalAggregationFunction(e,t,n,Number.NEGATIVE_INFINITY,r,eee))))}computeConditionalAggregationFunction(e,t,n,r,i,o){const s=[];for(let a=0;a<t.length;a+=2){const e=t[a],n=this.interpreter.criterionBuilder.fromCellValue(t[a+1],this.arithmeticHelper);if(void 0===n)return new g4(X9.VALUE,W2.BadCriterion);s.push(new K7(e,n))}return new Y7(this.interpreter,function(e){return t=>{const n=t.map((e=>`${e.conditionRange.range.sheet},${e.conditionRange.range.start.col},${e.conditionRange.range.start.row}`));return[e,...n].join(",")}}(n),r,i,o).compute(e,s)}}tee.implementedFunctions={SUMIF:{method:"sumif",parameters:[{argumentType:Z4.RANGE},{argumentType:Z4.NOERROR},{argumentType:Z4.RANGE,optionalArg:!0}]},COUNTIF:{method:"countif",parameters:[{argumentType:Z4.RANGE},{argumentType:Z4.NOERROR}]},AVERAGEIF:{method:"averageif",parameters:[{argumentType:Z4.RANGE},{argumentType:Z4.NOERROR},{argumentType:Z4.RANGE,optionalArg:!0}]},SUMIFS:{method:"sumifs",parameters:[{argumentType:Z4.RANGE},{argumentType:Z4.RANGE},{argumentType:Z4.NOERROR}],repeatLastArgs:2},COUNTIFS:{method:"countifs",parameters:[{argumentType:Z4.RANGE},{argumentType:Z4.NOERROR}],repeatLastArgs:2},MINIFS:{method:"minifs",parameters:[{argumentType:Z4.RANGE},{argumentType:Z4.RANGE},{argumentType:Z4.NOERROR}],repeatLastArgs:2},MAXIFS:{method:"maxifs",parameters:[{argumentType:Z4.RANGE},{argumentType:Z4.RANGE},{argumentType:Z4.NOERROR}],repeatLastArgs:2}};
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
class nee extends J4{sumproduct(e,t){return this.runFunction(e.args,t,this.metadata("SUMPRODUCT"),((...e)=>{const t=e[0].width(),n=e[0].height();for(const o of e)if(o.width()!==t||o.height()!==n)return new g4(X9.VALUE,W2.EqualLength);let r=0;const i=e.map((e=>e.iterateValuesFromTopLeftCorner()));for(let o=0;o<t*n;o++){let e=1;for(const t of i){const n=t.next().value;if(n instanceof g4)return n;const r=this.coerceScalarToNumberOrError(n);W3(r)?e*=L3(r):e=0}r+=e}return r}))}}nee.implementedFunctions={SUMPRODUCT:{method:"sumproduct",parameters:[{argumentType:Z4.RANGE}],repeatLastArgs:1}};
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
class ree extends J4{concatenate(e,t){return this.runFunction(e.args,t,this.metadata("CONCATENATE"),((...e)=>"".concat(...e)))}split(e,t){return this.runFunction(e.args,t,this.metadata("SPLIT"),((e,t)=>{const n=e.split(" ");return t>=n.length||t<0?new g4(X9.VALUE,W2.IndexBounds):n[t]}))}len(e,t){return this.runFunction(e.args,t,this.metadata("LEN"),(e=>e.length))}lower(e,t){return this.runFunction(e.args,t,this.metadata("LOWER"),(e=>e.toLowerCase()))}trim(e,t){return this.runFunction(e.args,t,this.metadata("TRIM"),(e=>e.replace(/^ +| +$/g,"").replace(/ +/g," ")))}proper(e,t){return this.runFunction(e.args,t,this.metadata("PROPER"),(e=>e.replace(/\p{L}+/gu,(e=>e.charAt(0).toUpperCase()+e.substring(1).toLowerCase()))))}clean(e,t){return this.runFunction(e.args,t,this.metadata("CLEAN"),(e=>e.replace(/[\u0000-\u001F]/g,"")))}exact(e,t){return this.runFunction(e.args,t,this.metadata("EXACT"),((e,t)=>e===t))}rept(e,t){return this.runFunction(e.args,t,this.metadata("REPT"),((e,t)=>t<0?new g4(X9.VALUE,W2.NegativeCount):e.repeat(t)))}right(e,t){return this.runFunction(e.args,t,this.metadata("RIGHT"),((e,t)=>t<0?new g4(X9.VALUE,W2.NegativeLength):0===t?"":e.slice(-t)))}left(e,t){return this.runFunction(e.args,t,this.metadata("LEFT"),((e,t)=>t<0?new g4(X9.VALUE,W2.NegativeLength):e.slice(0,t)))}mid(e,t){return this.runFunction(e.args,t,this.metadata("MID"),((e,t,n)=>t<1?new g4(X9.VALUE,W2.LessThanOne):n<0?new g4(X9.VALUE,W2.NegativeLength):e.substring(t-1,t+n-1)))}replace(e,t){return this.runFunction(e.args,t,this.metadata("REPLACE"),((e,t,n,r)=>t<1?new g4(X9.VALUE,W2.LessThanOne):n<0?new g4(X9.VALUE,W2.NegativeLength):e.substring(0,t-1)+r+e.substring(t+n-1)))}search(e,t){return this.runFunction(e.args,t,this.metadata("SEARCH"),((e,t,n)=>{if(n<1||n>t.length)return new g4(X9.VALUE,W2.LengthBounds);const r=e.toLowerCase(),i=t.substring(n-1).toLowerCase(),o=this.arithmeticHelper.requiresRegex(r)?this.arithmeticHelper.searchString(r,i):i.indexOf(r);return o>-1?o+n:new g4(X9.VALUE,W2.PatternNotFound)}))}substitute(e,t){return this.runFunction(e.args,t,this.metadata("SUBSTITUTE"),((e,t,n,r)=>{const i=this.escapeRegExpSpecialCharacters(t),o=new RegExp(i,"g");if(void 0===r)return e.replace(o,n);if(r<1)return new g4(X9.VALUE,W2.LessThanOne);let s,a=0;for(;null!==(s=o.exec(e));)if(r===++a)return e.substring(0,s.index)+n+e.substring(o.lastIndex);return e}))}find(e,t){return this.runFunction(e.args,t,this.metadata("FIND"),((e,t,n)=>{if(n<1||n>t.length)return new g4(X9.VALUE,W2.IndexBounds);const r=t.substring(n-1).indexOf(e)+n;return r>0?r:new g4(X9.VALUE,W2.PatternNotFound)}))}t(e,t){return this.runFunction(e.args,t,this.metadata("T"),(e=>e instanceof g4||"string"==typeof e?e:""))}upper(e,t){return this.runFunction(e.args,t,this.metadata("UPPER"),(e=>e.toUpperCase()))}escapeRegExpSpecialCharacters(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}}ree.implementedFunctions={CONCATENATE:{method:"concatenate",parameters:[{argumentType:Z4.STRING}],repeatLastArgs:1,expandRanges:!0},EXACT:{method:"exact",parameters:[{argumentType:Z4.STRING},{argumentType:Z4.STRING}]},SPLIT:{method:"split",parameters:[{argumentType:Z4.STRING},{argumentType:Z4.NUMBER}]},LEN:{method:"len",parameters:[{argumentType:Z4.STRING}]},LOWER:{method:"lower",parameters:[{argumentType:Z4.STRING}]},MID:{method:"mid",parameters:[{argumentType:Z4.STRING},{argumentType:Z4.NUMBER},{argumentType:Z4.NUMBER}]},TRIM:{method:"trim",parameters:[{argumentType:Z4.STRING}]},T:{method:"t",parameters:[{argumentType:Z4.SCALAR}]},PROPER:{method:"proper",parameters:[{argumentType:Z4.STRING}]},CLEAN:{method:"clean",parameters:[{argumentType:Z4.STRING}]},REPT:{method:"rept",parameters:[{argumentType:Z4.STRING},{argumentType:Z4.NUMBER}]},RIGHT:{method:"right",parameters:[{argumentType:Z4.STRING},{argumentType:Z4.NUMBER,defaultValue:1}]},LEFT:{method:"left",parameters:[{argumentType:Z4.STRING},{argumentType:Z4.NUMBER,defaultValue:1}]},REPLACE:{method:"replace",parameters:[{argumentType:Z4.STRING},{argumentType:Z4.NUMBER},{argumentType:Z4.NUMBER},{argumentType:Z4.STRING}]},SEARCH:{method:"search",parameters:[{argumentType:Z4.STRING},{argumentType:Z4.STRING},{argumentType:Z4.NUMBER,defaultValue:1}]},SUBSTITUTE:{method:"substitute",parameters:[{argumentType:Z4.STRING},{argumentType:Z4.STRING},{argumentType:Z4.STRING},{argumentType:Z4.NUMBER,optionalArg:!0}]},FIND:{method:"find",parameters:[{argumentType:Z4.STRING},{argumentType:Z4.STRING},{argumentType:Z4.NUMBER,defaultValue:1}]},UPPER:{method:"upper",parameters:[{argumentType:Z4.STRING}]}};
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
class iee extends J4{acos(e,t){return this.runFunction(e.args,t,this.metadata("ACOS"),Math.acos)}asin(e,t){return this.runFunction(e.args,t,this.metadata("ASIN"),Math.asin)}cos(e,t){return this.runFunction(e.args,t,this.metadata("COS"),Math.cos)}sin(e,t){return this.runFunction(e.args,t,this.metadata("SIN"),Math.sin)}tan(e,t){return this.runFunction(e.args,t,this.metadata("TAN"),Math.tan)}atan(e,t){return this.runFunction(e.args,t,this.metadata("ATAN"),Math.atan)}atan2(e,t){return this.runFunction(e.args,t,this.metadata("ATAN2"),((e,t)=>0===e&&0===t?new g4(X9.DIV_BY_ZERO):Math.atan2(t,e)))}cot(e,t){return this.runFunction(e.args,t,this.metadata("COT"),(e=>0===e?new g4(X9.DIV_BY_ZERO):1/Math.tan(e)))}acot(e,t){return this.runFunction(e.args,t,this.metadata("ACOT"),(e=>0===e?y7/2:Math.atan(1/e)))}sec(e,t){return this.runFunction(e.args,t,this.metadata("SEC"),(e=>1/Math.cos(e)))}csc(e,t){return this.runFunction(e.args,t,this.metadata("CSC"),(e=>0===e?new g4(X9.DIV_BY_ZERO):1/Math.sin(e)))}sinh(e,t){return this.runFunction(e.args,t,this.metadata("SINH"),Math.sinh)}asinh(e,t){return this.runFunction(e.args,t,this.metadata("ASINH"),Math.asinh)}cosh(e,t){return this.runFunction(e.args,t,this.metadata("COSH"),Math.cosh)}acosh(e,t){return this.runFunction(e.args,t,this.metadata("ACOSH"),Math.acosh)}tanh(e,t){return this.runFunction(e.args,t,this.metadata("TANH"),Math.tanh)}atanh(e,t){return this.runFunction(e.args,t,this.metadata("ATANH"),Math.atanh)}coth(e,t){return this.runFunction(e.args,t,this.metadata("COTH"),(e=>0===e?new g4(X9.DIV_BY_ZERO):1/Math.tanh(e)))}acoth(e,t){return this.runFunction(e.args,t,this.metadata("ACOTH"),(e=>0===e?new g4(X9.NUM,W2.NonZero):Math.atanh(1/e)))}sech(e,t){return this.runFunction(e.args,t,this.metadata("SECH"),(e=>1/Math.cosh(e)))}csch(e,t){return this.runFunction(e.args,t,this.metadata("CSCH"),(e=>0===e?new g4(X9.DIV_BY_ZERO):1/Math.sinh(e)))}}iee.implementedFunctions={ACOS:{method:"acos",parameters:[{argumentType:Z4.NUMBER}]},ASIN:{method:"asin",parameters:[{argumentType:Z4.NUMBER}]},COS:{method:"cos",parameters:[{argumentType:Z4.NUMBER}]},SIN:{method:"sin",parameters:[{argumentType:Z4.NUMBER}]},TAN:{method:"tan",parameters:[{argumentType:Z4.NUMBER}]},ATAN:{method:"atan",parameters:[{argumentType:Z4.NUMBER}]},ATAN2:{method:"atan2",parameters:[{argumentType:Z4.NUMBER},{argumentType:Z4.NUMBER}]},COT:{method:"cot",parameters:[{argumentType:Z4.NUMBER}]},SEC:{method:"sec",parameters:[{argumentType:Z4.NUMBER}]},CSC:{method:"csc",parameters:[{argumentType:Z4.NUMBER}]},SINH:{method:"sinh",parameters:[{argumentType:Z4.NUMBER}]},COSH:{method:"cosh",parameters:[{argumentType:Z4.NUMBER}]},TANH:{method:"tanh",parameters:[{argumentType:Z4.NUMBER}]},COTH:{method:"coth",parameters:[{argumentType:Z4.NUMBER}]},SECH:{method:"sech",parameters:[{argumentType:Z4.NUMBER}]},CSCH:{method:"csch",parameters:[{argumentType:Z4.NUMBER}]},ACOT:{method:"acot",parameters:[{argumentType:Z4.NUMBER}]},ASINH:{method:"asinh",parameters:[{argumentType:Z4.NUMBER}]},ACOSH:{method:"acosh",parameters:[{argumentType:Z4.NUMBER}]},ATANH:{method:"atanh",parameters:[{argumentType:Z4.NUMBER}]},ACOTH:{method:"acoth",parameters:[{argumentType:Z4.NUMBER}]}};
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
class oee extends C8{constructor(e){super(e),this.dependencyGraph=e}find(e,t,n){return this.basicFind(e,t,"col",n)}}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class see extends J4{constructor(){super(...arguments),this.rowSearch=new oee(this.dependencyGraph)}vlookup(e,t){return this.runFunction(e.args,t,this.metadata("VLOOKUP"),((e,t,n,r)=>{const i=t.range;if(void 0===i)return new g4(X9.VALUE,W2.WrongType);if(n<1)return new g4(X9.VALUE,W2.LessThanOne);if(n>i.width())return new g4(X9.REF,W2.IndexLarge);const o={ordering:r?"asc":"none",ifNoMatch:r?"returnLowerBound":"returnNotFound"};return this.doVlookup(U4(e),t,n-1,o)}))}hlookup(e,t){return this.runFunction(e.args,t,this.metadata("HLOOKUP"),((e,t,n,r)=>{const i=t.range;if(void 0===i)return new g4(X9.VALUE,W2.WrongType);if(n<1)return new g4(X9.VALUE,W2.LessThanOne);if(n>i.height())return new g4(X9.REF,W2.IndexLarge);const o={ordering:r?"asc":"none",ifNoMatch:r?"returnLowerBound":"returnNotFound"};return this.doHlookup(U4(e),t,n-1,o)}))}xlookup(e,t){return this.runFunction(e.args,t,this.metadata("XLOOKUP"),((e,t,n,r,i,o)=>{if(![0,-1,1,2].includes(i))return new g4(X9.VALUE,W2.BadMode);if(![1,-1,2,-2].includes(o))return new g4(X9.VALUE,W2.BadMode);const s=t instanceof $3?t:$3.fromScalar(t),a=n instanceof $3?n:$3.fromScalar(n),l=2===i,h={ordering:2===o?"asc":-2===o?"desc":"none",returnOccurrence:-1===o?"last":"first",ifNoMatch:-1===i?"returnLowerBound":1===i?"returnUpperBound":"returnNotFound"};return this.doXlookup(U4(e),s,a,r,l,h)}))}xlookupArraySize(e){var t,n;const r=null===(t=null==e?void 0:e.args)||void 0===t?void 0:t[1],i=null===(n=null==e?void 0:e.args)||void 0===n?void 0:n[2];if(null==(null==r?void 0:r.start)||null==(null==r?void 0:r.end)||null==(null==i?void 0:i.start)||null==(null==i?void 0:i.end))return e5.error();const o=r.end.row-r.start.row+1,s=r.end.col-r.start.col+1,a=i.end.row-i.start.row+1,l=i.end.col-i.start.col+1,h=1===s&&a===o;return h||1===o&&l===s?h?new e5(l,1):new e5(1,a):e5.error()}match(e,t){return this.runFunction(e.args,t,this.metadata("MATCH"),((e,t,n)=>this.doMatch(U4(e),t,n)))}searchInRange(e,t,n,r,i){return n&&"string"==typeof e&&this.arithmeticHelper.requiresRegex(e)?i.advancedFind(this.arithmeticHelper.eqMatcherFunction(e),t,{returnOccurrence:r.returnOccurrence}):i.find(e,t,r)}doVlookup(e,t,n,r){this.dependencyGraph.stats.start(G3.VLOOKUP);const i=t.range;let o;o=void 0===i?$3.onlyValues(t.data.map((e=>[e[0]]))):$3.onlyRange(M4.spanFrom(i.start,1,i.height()),this.dependencyGraph);const s=this.searchInRange(e,o,"none"===r.ordering,r,this.columnSearch);if(this.dependencyGraph.stats.end(G3.VLOOKUP),-1===s)return new g4(X9.NA,W2.ValueNotFound);let a;if(void 0===i)a=t.data[s][n];else{const e=v4(i.sheet,i.start.col+n,i.start.row+s);a=this.dependencyGraph.getCellValue(e)}return a instanceof $3?new g4(X9.VALUE,W2.WrongType):a}doHlookup(e,t,n,r){const i=t.range;let o;o=void 0===i?$3.onlyValues([t.data[0]]):$3.onlyRange(M4.spanFrom(i.start,i.width(),1),this.dependencyGraph);const s=this.searchInRange(e,o,"none"===r.ordering,r,this.rowSearch);if(-1===s)return new g4(X9.NA,W2.ValueNotFound);let a;if(void 0===i)a=t.data[n][s];else{const e=v4(i.sheet,i.start.col+s,i.start.row+n);a=this.dependencyGraph.getCellValue(e)}return a instanceof $3?new g4(X9.VALUE,W2.WrongType):a}doXlookup(e,t,n,r,i,o){const s=1===t.width()&&n.height()===t.height(),a=1===t.height()&&n.width()===t.width();if(!s&&!a)return new g4(X9.VALUE,W2.WrongDimension);const l=s?this.columnSearch:this.rowSearch,h=this.searchInRange(e,t,i,o,l);if(-1===h)return r==X9.NA?new g4(X9.NA,W2.ValueNotFound):r;const u=s?[n.data[h]]:n.data.map((e=>[e[h]]));return $3.onlyValues(u)}doMatch(e,t,n){if(![-1,0,1].includes(n))return new g4(X9.VALUE,W2.BadMode);if(t.width()>1&&t.height()>1)return new g4(X9.NA);const r=0===n?{ordering:"none",ifNoMatch:"returnNotFound"}:{ordering:-1===n?"desc":"asc",ifNoMatch:-1===n?"returnUpperBound":"returnLowerBound"},i=(1===t.width()?this.columnSearch:this.rowSearch).find(e,t,r);return-1===i?new g4(X9.NA,W2.ValueNotFound):i+1}}see.implementedFunctions={VLOOKUP:{method:"vlookup",parameters:[{argumentType:Z4.NOERROR},{argumentType:Z4.RANGE},{argumentType:Z4.NUMBER},{argumentType:Z4.BOOLEAN,defaultValue:!0}]},HLOOKUP:{method:"hlookup",parameters:[{argumentType:Z4.NOERROR},{argumentType:Z4.RANGE},{argumentType:Z4.NUMBER},{argumentType:Z4.BOOLEAN,defaultValue:!0}]},XLOOKUP:{method:"xlookup",arraySizeMethod:"xlookupArraySize",parameters:[{argumentType:Z4.NOERROR},{argumentType:Z4.RANGE},{argumentType:Z4.RANGE},{argumentType:Z4.SCALAR,optionalArg:!0,defaultValue:X9.NA},{argumentType:Z4.NUMBER,optionalArg:!0,defaultValue:0},{argumentType:Z4.NUMBER,optionalArg:!0,defaultValue:1}]},MATCH:{method:"match",parameters:[{argumentType:Z4.NOERROR},{argumentType:Z4.RANGE},{argumentType:Z4.NUMBER,defaultValue:1}]}};
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
class aee extends J4{roman(e,t){return this.runFunction(e.args,t,this.metadata("ROMAN"),((e,t)=>(e=Math.trunc(e),!1===t?t=4:!0===t&&(t=0),(t=L3(this.coerceScalarToNumberOrError(t)))instanceof g4?t:(t=Math.trunc(t))<0?new g4(X9.VALUE,W2.ValueSmall):t>4?new g4(X9.VALUE,W2.ValueLarge):function(e,t){const n={val:e%1e3,acc:"M".repeat(Math.floor(e/1e3))};4===t&&(hee(n,"IM",999,1e3),hee(n,"ID",499,500));t>=3&&(hee(n,"VM",995,1e3),hee(n,"VD",495,500));t>=2&&(hee(n,"XM",990,1e3),hee(n,"XD",490,500));t>=1&&(hee(n,"LM",950,1e3),hee(n,"LD",450,500));hee(n,"CM",900,1e3),hee(n,"CD",400,500),hee(n,"D",500,900),n.acc+="C".repeat(Math.floor(n.val/100)),n.val%=100,t>=2&&(hee(n,"IC",99,100),hee(n,"IL",49,50));t>=1&&(hee(n,"VC",95,100),hee(n,"VL",45,50));return hee(n,"XC",90,100),hee(n,"XL",40,50),hee(n,"L",50,90),n.acc+="X".repeat(Math.floor(n.val/10)),n.val%=10,hee(n,"IX",9,10),hee(n,"IV",4,5),hee(n,"V",5,9),n.acc+="I".repeat(n.val),n.acc}(e,t))))}arabic(e,t){return this.runFunction(e.args,t,this.metadata("ARABIC"),(e=>{let t=!1;if((e=e.trim().toUpperCase()).startsWith("-")&&(t=!0,""===(e=e.slice(1))))return new g4(X9.VALUE,W2.InvalidRoman);const n={input:e,acc:0};return lee(n,{token:"MMM",val:3e3},{token:"MM",val:2e3},{token:"M",val:1e3}),lee(n,{token:"IM",val:999},{token:"VM",val:995},{token:"XM",val:990},{token:"LM",val:950},{token:"CM",val:900}),lee(n,{token:"D",val:500},{token:"ID",val:499},{token:"VD",val:495},{token:"XD",val:490},{token:"LD",val:450},{token:"CD",val:400}),lee(n,{token:"CCC",val:300},{token:"CC",val:200},{token:"C",val:100}),lee(n,{token:"IC",val:99},{token:"VC",val:95},{token:"XC",val:90}),lee(n,{token:"L",val:50},{token:"IL",val:49},{token:"VL",val:45},{token:"XL",val:40}),lee(n,{token:"XXX",val:30},{token:"XX",val:20},{token:"X",val:10}),lee(n,{token:"IX",val:9}),lee(n,{token:"V",val:5},{token:"IV",val:4}),lee(n,{token:"III",val:3},{token:"II",val:2},{token:"I",val:1}),""!==n.input?new g4(X9.VALUE,W2.InvalidRoman):t?-n.acc:n.acc}))}}function lee(e,...t){for(const n of t)if(e.input.startsWith(n.token)){e.input=e.input.slice(n.token.length),e.acc+=n.val;break}}function hee(e,t,n,r){e.val>=n&&e.val<r&&(e.val-=n,e.acc+=t)}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */aee.implementedFunctions={ROMAN:{method:"roman",parameters:[{argumentType:Z4.NUMBER,minValue:1,lessThan:4e3},{argumentType:Z4.NOERROR,optionalArg:!0,defaultValue:0}]},ARABIC:{method:"arabic",parameters:[{argumentType:Z4.STRING}]}};class uee extends J4{add(e,t){return this.runFunction(e.args,t,this.metadata("HF.ADD"),this.arithmeticHelper.addWithEpsilon)}concat(e,t){return this.runFunction(e.args,t,this.metadata("HF.CONCAT"),this.arithmeticHelper.concat)}divide(e,t){return this.runFunction(e.args,t,this.metadata("HF.DIVIDE"),this.arithmeticHelper.divide)}eq(e,t){return this.runFunction(e.args,t,this.metadata("HF.EQ"),this.arithmeticHelper.eq)}gt(e,t){return this.runFunction(e.args,t,this.metadata("HF.GT"),this.arithmeticHelper.gt)}gte(e,t){return this.runFunction(e.args,t,this.metadata("HF.GTE"),this.arithmeticHelper.geq)}lt(e,t){return this.runFunction(e.args,t,this.metadata("HF.LT"),this.arithmeticHelper.lt)}lte(e,t){return this.runFunction(e.args,t,this.metadata("HF.LTE"),this.arithmeticHelper.leq)}minus(e,t){return this.runFunction(e.args,t,this.metadata("HF.MINUS"),this.arithmeticHelper.subtract)}multiply(e,t){return this.runFunction(e.args,t,this.metadata("HF.MULTIPLY"),this.arithmeticHelper.multiply)}ne(e,t){return this.runFunction(e.args,t,this.metadata("HF.NE"),this.arithmeticHelper.neq)}pow(e,t){return this.runFunction(e.args,t,this.metadata("HF.POW"),this.arithmeticHelper.pow)}uminus(e,t){return this.runFunction(e.args,t,this.metadata("HF.UMINUS"),this.arithmeticHelper.unaryMinus)}upercent(e,t){return this.runFunction(e.args,t,this.metadata("HF.UNARY_PERCENT"),this.arithmeticHelper.unaryPercent)}uplus(e,t){return this.runFunction(e.args,t,this.metadata("HF.UPLUS"),this.arithmeticHelper.unaryPlus)}}uee.implementedFunctions={"HF.ADD":{method:"add",parameters:[{argumentType:Z4.NUMBER,passSubtype:!0},{argumentType:Z4.NUMBER,passSubtype:!0}]},"HF.CONCAT":{method:"concat",parameters:[{argumentType:Z4.STRING,passSubtype:!0},{argumentType:Z4.STRING,passSubtype:!0}]},"HF.DIVIDE":{method:"divide",parameters:[{argumentType:Z4.NUMBER,passSubtype:!0},{argumentType:Z4.NUMBER,passSubtype:!0}]},"HF.EQ":{method:"eq",parameters:[{argumentType:Z4.NOERROR,passSubtype:!0},{argumentType:Z4.NOERROR,passSubtype:!0}]},"HF.GT":{method:"gt",parameters:[{argumentType:Z4.NOERROR,passSubtype:!0},{argumentType:Z4.NOERROR,passSubtype:!0}]},"HF.GTE":{method:"gte",parameters:[{argumentType:Z4.NOERROR,passSubtype:!0},{argumentType:Z4.NOERROR,passSubtype:!0}]},"HF.LT":{method:"lt",parameters:[{argumentType:Z4.NOERROR,passSubtype:!0},{argumentType:Z4.NOERROR,passSubtype:!0}]},"HF.LTE":{method:"lte",parameters:[{argumentType:Z4.NOERROR,passSubtype:!0},{argumentType:Z4.NOERROR,passSubtype:!0}]},"HF.MINUS":{method:"minus",parameters:[{argumentType:Z4.NUMBER,passSubtype:!0},{argumentType:Z4.NUMBER,passSubtype:!0}]},"HF.MULTIPLY":{method:"multiply",parameters:[{argumentType:Z4.NUMBER,passSubtype:!0},{argumentType:Z4.NUMBER,passSubtype:!0}]},"HF.NE":{method:"ne",parameters:[{argumentType:Z4.NOERROR,passSubtype:!0},{argumentType:Z4.NOERROR,passSubtype:!0}]},"HF.POW":{method:"pow",parameters:[{argumentType:Z4.NUMBER,passSubtype:!0},{argumentType:Z4.NUMBER,passSubtype:!0}]},"HF.UMINUS":{method:"uminus",parameters:[{argumentType:Z4.NUMBER,passSubtype:!0}]},"HF.UNARY_PERCENT":{method:"upercent",parameters:[{argumentType:Z4.NUMBER,passSubtype:!0}]},"HF.UPLUS":{method:"uplus",parameters:[{argumentType:Z4.NUMBER,passSubtype:!0}]}};
/**
 * @license
 bessel.js (C) 2013-present SheetJS -- http://sheetjs.com

 Apache License
 Version 2.0, January 2004
 http://www.apache.org/licenses/

 TERMS AND CONDITIONS FOR USE, REPRODUCTION, AND DISTRIBUTION

 1. Definitions.

 "License" shall mean the terms and conditions for use, reproduction,
 and distribution as defined by Sections 1 through 9 of this document.

 "Licensor" shall mean the copyright owner or entity authorized by
 the copyright owner that is granting the License.

 "Legal Entity" shall mean the union of the acting entity and all
 other entities that control, are controlled by, or are under common
 control with that entity. For the purposes of this definition,
 "control" means (i) the power, direct or indirect, to cause the
 direction or management of such entity, whether by contract or
 otherwise, or (ii) ownership of fifty percent (50%) or more of the
 outstanding shares, or (iii) beneficial ownership of such entity.

 "You" (or "Your") shall mean an individual or Legal Entity
 exercising permissions granted by this License.

 "Source" form shall mean the preferred form for making modifications,
 including but not limited to software source code, documentation
 source, and configuration files.

 "Object" form shall mean any form resulting from mechanical
 transformation or translation of a Source form, including but
 not limited to compiled object code, generated documentation,
 and conversions to other media types.

 "Work" shall mean the work of authorship, whether in Source or
 Object form, made available under the License, as indicated by a
 copyright notice that is included in or attached to the work
 (an example is provided in the Appendix below).

 "Derivative Works" shall mean any work, whether in Source or Object
 form, that is based on (or derived from) the Work and for which the
 editorial revisions, annotations, elaborations, or other modifications
 represent, as a whole, an original work of authorship. For the purposes
 of this License, Derivative Works shall not include works that remain
 separable from, or merely link (or bind by name) to the interfaces of,
 the Work and Derivative Works thereof.

 "Contribution" shall mean any work of authorship, including
 the original version of the Work and any modifications or additions
 to that Work or Derivative Works thereof, that is intentionally
 submitted to Licensor for inclusion in the Work by the copyright owner
 or by an individual or Legal Entity authorized to submit on behalf of
 the copyright owner. For the purposes of this definition, "submitted"
 means any form of electronic, verbal, or written communication sent
 to the Licensor or its representatives, including but not limited to
 communication on electronic mailing lists, source code control systems,
 and issue tracking systems that are managed by, or on behalf of, the
 Licensor for the purpose of discussing and improving the Work, but
 excluding communication that is conspicuously marked or otherwise
 designated in writing by the copyright owner as "Not a Contribution."

 "Contributor" shall mean Licensor and any individual or Legal Entity
 on behalf of whom a Contribution has been received by Licensor and
 subsequently incorporated within the Work.

 2. Grant of Copyright License. Subject to the terms and conditions of
 this License, each Contributor hereby grants to You a perpetual,
 worldwide, non-exclusive, no-charge, royalty-free, irrevocable
 copyright license to reproduce, prepare Derivative Works of,
 publicly display, publicly perform, sublicense, and distribute the
 Work and such Derivative Works in Source or Object form.

 3. Grant of Patent License. Subject to the terms and conditions of
 this License, each Contributor hereby grants to You a perpetual,
 worldwide, non-exclusive, no-charge, royalty-free, irrevocable
 (except as stated in this section) patent license to make, have made,
 use, offer to sell, sell, import, and otherwise transfer the Work,
 where such license applies only to those patent claims licensable
 by such Contributor that are necessarily infringed by their
 Contribution(s) alone or by combination of their Contribution(s)
 with the Work to which such Contribution(s) was submitted. If You
 institute patent litigation against any entity (including a
 cross-claim or counterclaim in a lawsuit) alleging that the Work
 or a Contribution incorporated within the Work constitutes direct
 or contributory patent infringement, then any patent licenses
 granted to You under this License for that Work shall terminate
 as of the date such litigation is filed.

 4. Redistribution. You may reproduce and distribute copies of the
 Work or Derivative Works thereof in any medium, with or without
 modifications, and in Source or Object form, provided that You
 meet the following conditions:

 (a) You must give any other recipients of the Work or
 Derivative Works a copy of this License; and

 (b) You must cause any modified files to carry prominent notices
 stating that You changed the files; and

 (c) You must retain, in the Source form of any Derivative Works
 that You distribute, all copyright, patent, trademark, and
 attribution notices from the Source form of the Work,
 excluding those notices that do not pertain to any part of
 the Derivative Works; and

 (d) If the Work includes a "NOTICE" text file as part of its
 distribution, then any Derivative Works that You distribute must
 include a readable copy of the attribution notices contained
 within such NOTICE file, excluding those notices that do not
 pertain to any part of the Derivative Works, in at least one
 of the following places: within a NOTICE text file distributed
 as part of the Derivative Works; within the Source form or
 documentation, if provided along with the Derivative Works; or,
 within a display generated by the Derivative Works, if and
 wherever such third-party notices normally appear. The contents
 of the NOTICE file are for informational purposes only and
 do not modify the License. You may add Your own attribution
 notices within Derivative Works that You distribute, alongside
 or as an addendum to the NOTICE text from the Work, provided
 that such additional attribution notices cannot be construed
 as modifying the License.

 You may add Your own copyright statement to Your modifications and
 may provide additional or different license terms and conditions
 for use, reproduction, or distribution of Your modifications, or
 for any such Derivative Works as a whole, provided Your use,
 reproduction, and distribution of the Work otherwise complies with
 the conditions stated in this License.

 5. Submission of Contributions. Unless You explicitly state otherwise,
 any Contribution intentionally submitted for inclusion in the Work
 by You to the Licensor shall be under the terms and conditions of
 this License, without any additional terms or conditions.
 Notwithstanding the above, nothing herein shall supersede or modify
 the terms of any separate license agreement you may have executed
 with Licensor regarding such Contributions.

 6. Trademarks. This License does not grant permission to use the trade
 names, trademarks, service marks, or product names of the Licensor,
 except as required for reasonable and customary use in describing the
 origin of the Work and reproducing the content of the NOTICE file.

 7. Disclaimer of Warranty. Unless required by applicable law or
 agreed to in writing, Licensor provides the Work (and each
 Contributor provides its Contributions) on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or
 implied, including, without limitation, any warranties or conditions
 of TITLE, NON-INFRINGEMENT, MERCHANTABILITY, or FITNESS FOR A
 PARTICULAR PURPOSE. You are solely responsible for determining the
 appropriateness of using or redistributing the Work and assume any
 risks associated with Your exercise of permissions under this License.

 8. Limitation of Liability. In no event and under no legal theory,
 whether in tort (including negligence), contract, or otherwise,
 unless required by applicable law (such as deliberate and grossly
 negligent acts) or agreed to in writing, shall any Contributor be
 liable to You for damages, including any direct, indirect, special,
 incidental, or consequential damages of any character arising as a
 result of this License or out of the use or inability to use the
 Work (including but not limited to damages for loss of goodwill,
 work stoppage, computer failure or malfunction, or any and all
 other commercial damages or losses), even if such Contributor
 has been advised of the possibility of such damages.

 9. Accepting Warranty or Additional Liability. While redistributing
 the Work or Derivative Works thereof, You may choose to offer,
 and charge a fee for, acceptance of support, warranty, indemnity,
 or other liability obligations and/or rights consistent with this
 License. However, in accepting such obligations, You may act only
 on Your own behalf and on Your sole responsibility, not on behalf
 of any other Contributor, and only if You agree to indemnify,
 defend, and hold each Contributor harmless for any liability
 incurred by, or claims asserted against, such Contributor by reason
 of your accepting any such warranty or additional liability.

 END OF TERMS AND CONDITIONS

 APPENDIX: How to apply the Apache License to your work.

 To apply the Apache License to your work, attach the following
 boilerplate notice, with the fields enclosed by brackets "{}"
 replaced with your own identifying information. (Don't include
 the brackets!)  The text should be enclosed in the appropriate
 comment syntax for the file format. We also recommend that a
 file or class name and description of purpose be included on the
 same "printed page" as the copyright notice for easier
 identification within third-party archives.

 Copyright (C) 2013-present   SheetJS LLC

 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

 http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 */
var cee=Math;function dee(e,t){for(var n=0,r=0;n<e.length;++n)r=t*r+e[n];return r}function pee(e,t,n,r,i){if(0===t)return n;if(1===t)return r;for(var o=2/e,s=r,a=1;a<t;++a)s=r*a*o+i*n,n=r,r=s;return s}function gee(e,t,n,r,i){return function(n,o){if(r){if(0===n)return 1==r?-1/0:1/0;if(n<0)return NaN}return 0===o?e(n):1===o?t(n):o<0?NaN:pee(n,o|=0,e(n),t(n),i)}}var mee,fee,wee,yee,vee,Cee,See,Ree,Eee,bee,Tee,Nee,Aee,Mee=function(){var e=.636619772,t=[57568490574,-13362590354,651619640.7,-11214424.18,77392.33017,-184.9052456].reverse(),n=[57568490411,1029532985,9494680.718,59272.64853,267.8532712,1].reverse(),r=[1,-.001098628627,2734510407e-14,-2073370639e-15,2.093887211e-7].reverse(),i=[-.01562499995,.0001430488765,-6911147651e-15,7.621095161e-7,-9.34935152e-8].reverse();function o(o){var s=0,a=0,l=0,h=o*o;if(o<8)s=(a=dee(t,h))/(l=dee(n,h));else{var u=o-.785398164;a=dee(r,h=64/h),l=dee(i,h),s=cee.sqrt(e/o)*(cee.cos(u)*a-cee.sin(u)*l*8/o)}return s}var s=[72362614232,-7895059235,242396853.1,-2972611.439,15704.4826,-30.16036606].reverse(),a=[144725228442,2300535178,18583304.74,99447.43394,376.9991397,1].reverse(),l=[1,.00183105,-3516396496e-14,2457520174e-15,-2.40337019e-7].reverse(),h=[.04687499995,-.0002002690873,8449199096e-15,-8.8228987e-7,1.05787412e-7].reverse();function u(t){var n=0,r=0,i=0,o=t*t,u=cee.abs(t)-2.356194491;return Math.abs(t)<8?n=(r=t*dee(s,o))/(i=dee(a,o)):(r=dee(l,o=64/o),i=dee(h,o),n=cee.sqrt(e/cee.abs(t))*(cee.cos(u)*r-cee.sin(u)*i*8/cee.abs(t)),t<0&&(n=-n)),n}return function e(t,n){if(n=Math.round(n),!isFinite(t))return isNaN(t)?t:0;if(n<0)return(n%2?-1:1)*e(t,-n);if(t<0)return(n%2?-1:1)*e(-t,n);if(0===n)return o(t);if(1===n)return u(t);if(0===t)return 0;var r=0;if(t>n)r=pee(t,n,o(t),u(t),-1);else{for(var i=!1,s=0,a=0,l=1,h=0,c=2/t,d=2*cee.floor((n+cee.floor(cee.sqrt(40*n)))/2);d>0;d--)h=d*c*l-s,s=l,l=h,cee.abs(l)>1e10&&(l*=1e-10,s*=1e-10,r*=1e-10,a*=1e-10),i&&(a+=l),i=!i,d==n&&(r=s);r/=a=2*a-l}return r}}(),Iee=(mee=.636619772,fee=[-2957821389,7062834065,-512359803.6,10879881.29,-86327.92757,228.4622733].reverse(),wee=[40076544269,745249964.8,7189466.438,47447.2647,226.1030244,1].reverse(),yee=[1,-.001098628627,2734510407e-14,-2073370639e-15,2.093887211e-7].reverse(),vee=[-.01562499995,.0001430488765,-6911147651e-15,7.621095161e-7,-9.34945152e-8].reverse(),Cee=[-4900604943e3,127527439e4,-51534381390,734926455.1,-4237922.726,8511.937935].reverse(),See=[249958057e5,424441966400,3733650367,22459040.02,102042.605,354.9632885,1].reverse(),Ree=[1,.00183105,-3516396496e-14,2457520174e-15,-2.40337019e-7].reverse(),Eee=[.04687499995,-.0002002690873,8449199096e-15,-8.8228987e-7,1.05787412e-7].reverse(),gee((function(e){var t=0,n=0,r=0,i=e*e,o=e-.785398164;return e<8?t=(n=dee(fee,i))/(r=dee(wee,i))+mee*Mee(e,0)*cee.log(e):(n=dee(yee,i=64/i),r=dee(vee,i),t=cee.sqrt(mee/e)*(cee.sin(o)*n+cee.cos(o)*r*8/e)),t}),(function(e){var t=0,n=0,r=0,i=e*e,o=e-2.356194491;return e<8?t=(n=e*dee(Cee,i))/(r=dee(See,i))+mee*(Mee(e,1)*cee.log(e)-1/e):(n=dee(Ree,i=64/i),r=dee(Eee,i),t=cee.sqrt(mee/e)*(cee.sin(o)*n+cee.cos(o)*r*8/e)),t}),0,1,-1)),Oee=(bee=[1,3.5156229,3.0899424,1.2067492,.2659732,.0360768,.0045813].reverse(),Tee=[.39894228,.01328592,.00225319,-.00157565,.00916281,-.02057706,.02635537,-.01647633,.00392377].reverse(),Nee=[.5,.87890594,.51498869,.15084934,.02658733,.00301532,32411e-8].reverse(),Aee=[.39894228,-.03988024,-.00362018,.00163801,-.01031555,.02282967,-.02895312,.01787654,-.00420059].reverse(),function e(t,n){if(0===(n=Math.round(n)))return function(e){return e<=3.75?dee(bee,e*e/14.0625):cee.exp(cee.abs(e))/cee.sqrt(cee.abs(e))*dee(Tee,3.75/cee.abs(e))}(t);if(1===n)return function(e){return e<3.75?e*dee(Nee,e*e/14.0625):(e<0?-1:1)*cee.exp(cee.abs(e))/cee.sqrt(cee.abs(e))*dee(Aee,3.75/cee.abs(e))}(t);if(n<0)return NaN;if(0===cee.abs(t))return 0;if(t==1/0)return 1/0;var r,i=0,o=2/cee.abs(t),s=0,a=1,l=0;for(r=2*cee.round((n+cee.round(cee.sqrt(40*n)))/2);r>0;r--)l=r*o*a+s,s=a,a=l,cee.abs(a)>1e10&&(a*=1e-10,s*=1e-10,i*=1e-10),r==n&&(i=s);return i*=e(t,0)/a,t<0&&n%2?-i:i}),xee=function(){var e=[-.57721566,.4227842,.23069756,.0348859,.00262698,1075e-7,74e-7].reverse(),t=[1.25331414,-.07832358,.02189568,-.01062446,.00587872,-.0025154,53208e-8].reverse();var n=[1,.15443144,-.67278579,-.18156897,-.01919402,-.00110404,-4686e-8].reverse(),r=[1.25331414,.23498619,-.0365562,.01504268,-.00780353,.00325614,-68245e-8].reverse();return gee((function(n){return n<=2?-cee.log(n/2)*Oee(n,0)+dee(e,n*n/4):cee.exp(-n)/cee.sqrt(n)*dee(t,2/n)}),(function(e){return e<=2?cee.log(e/2)*Oee(e,1)+1/e*dee(n,e*e/4):cee.exp(-e)/cee.sqrt(e)*dee(r,2/e)}),0,2,1)}();
/**
 * @license
 Copyright (c) 2013 jStat

 Permission is hereby granted, free of charge, to any person obtaining a copy
 of this software and associated documentation files (the "Software"), to deal
 in the Software without restriction, including without limitation the rights
 to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 copies of the Software, and to permit persons to whom the Software is
 furnished to do so, subject to the following conditions:

 The above copyright notice and this permission notice shall be included in
 all copies or substantial portions of the Software.

 THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 THE SOFTWARE.
 */
function Pee(e){const t=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-.000946595344482036,.000366839497852761,42523324806907e-18,-20278578112534e-18,-1624290004647e-18,130365583558e-17,1.5626441722e-8,-8.5238095915e-8,6.529054439e-9,5.059343495e-9,-9.91364156e-10,-2.27365122e-10,96467911e-18,2394038e-18,-6886027e-18,894487e-18,313092e-18,-112708e-18,381e-18,7106e-18,-1523e-18,-94e-18,121e-18,-28e-18];let n,r,i,o,s=t.length-1,a=!1,l=0,h=0;if(0===e)return 0;for(e<0&&(e=-e,a=!0),n=2/(2+e),r=4*n-2;s>0;s--)i=l,l=r*l-h+t[s],h=i;return o=n*Math.exp(-e*e+.5*(t[0]+r*l)-h),a?o-1:1-o}function _ee(e){return 1-Pee(e)}function Lee(e){let t,n,r,i,o=0;if(e>=2)return-100;if(e<=0)return 100;for(i=e<1?e:2-e,r=Math.sqrt(-2*Math.log(i/2)),t=-.70711*((2.30753+.27061*r)/(1+r*(.99229+.04481*r))-r);o<2;o++)n=_ee(t)-i,t+=n/(1.1283791670955126*Math.exp(-t*t)-t*n);return e<1?t:-t}const Hee=(e,t)=>e<0?0:t*Math.exp(-t*e),kee=(e,t)=>e<0?0:1-Math.exp(-t*e);function Fee(e){const t=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],n=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535];let r,i,o,s,a=!1,l=0,h=0,u=0,c=e;if(e>171.6243769536076)return 1/0;if(c<=0){if(s=c%1,!s)return 1/0;a=(1&c?-1:1)*Math.PI/Math.sin(Math.PI*s),c=1-c}for(o=c,i=c<1?c++:(c-=l=(0|c)-1)-1,r=0;r<8;++r)u=(u+t[r])*i,h=h*i+n[r];if(s=u/h+1,o<c)s/=o;else if(o>c)for(r=0;r<l;++r)s*=c,c++;return a&&(s=a/s),s}const Dee=function(e,t,n){return e<0?0:0===e&&1===t?1/n:Math.exp((t-1)*Math.log(e)-e/n-Bee(t)-t*Math.log(n))},Vee=function(e,t,n){return e<0?0:Wee(t,e/n)},Uee=function(e,t,n){return jee(e,t)*n};function Bee(e){let t=0;const n=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18];let r,i,o,s=1.000000000190015;for(o=(i=r=e)+5.5,o-=(r+.5)*Math.log(o);t<6;t++)s+=n[t]/++i;return Math.log(2.5066282746310007*s/r)-o}function Wee(e,t){const n=Bee(e);let r=e,i=1/e,o=i,s=t+1-e,a=1/1e-30,l=1/s,h=l,u=1;const c=-~(8.5*Math.log(e>=1?e:1/e)+.4*e+17);let d;if(t<0||e<=0)return NaN;if(t<e+1){for(;u<=c;u++)i+=o*=t/++r;return i*Math.exp(-t+e*Math.log(t)-n)}for(;u<=c;u++)d=-u*(u-e),s+=2,l=d*l+s,a=s+d/a,l=1/l,h*=l*a;return 1-h*Math.exp(-t+e*Math.log(t)-n)}function jee(e,t){let n=0;const r=t-1,i=Bee(t);let o,s,a,l,h,u,c;if(e>=1)return Math.max(100,t+100*Math.sqrt(t));if(e<=0)return 0;for(t>1?(u=Math.log(r),c=Math.exp(r*(u-1)-i),h=e<.5?e:1-e,a=Math.sqrt(-2*Math.log(h)),o=(2.30753+.27061*a)/(1+a*(.99229+.04481*a))-a,e<.5&&(o=-o),o=Math.max(.001,t*Math.pow(1-1/(9*t)-o/(3*Math.sqrt(t)),3))):(a=1-t*(.253+.12*t),o=e<a?Math.pow(e/a,1/t):1-Math.log(1-(e-a)/(1-a)));n<12;n++){if(o<=0)return 0;if(s=Wee(t,o)-e,a=t>1?c*Math.exp(-(o-r)+r*(Math.log(o)-u)):Math.exp(-o+r*Math.log(o)-i),l=s/a,o-=a=l/(1-.5*Math.min(1,l*((t-1)/o-1))),o<=0&&(o=.5*(o+a)),Math.abs(a)<1e-8*o)break}return o}const Gee=function(e,t,n){return Math.exp(-.5*Math.log(2*Math.PI)-Math.log(n)-Math.pow(e-t,2)/(2*n*n))},zee=function(e,t,n){return.5*(1+Pee((e-t)/Math.sqrt(2*n*n)))},$ee=function(e,t,n){return-1.4142135623730951*n*Lee(2*e)+t},Yee=function(e,t,n){return e>1||e<0?0:1==t&&1==n?1:t<512&&n<512?Math.pow(e,t-1)*Math.pow(1-e,n-1)/qee(t,n):Math.exp((t-1)*Math.log(e)+(n-1)*Math.log(1-e)-Qee(t,n))},Kee=function(e,t,n){return e>1||e<0?+(e>1):Jee(e,t,n)},Xee=function(e,t,n){return Zee(e,t,n)};function qee(e,t){if(!(e<=0||t<=0))return e+t>170?Math.exp(Qee(e,t)):Fee(e)*Fee(t)/Fee(e+t)}function Qee(e,t){return Bee(e)+Bee(t)-Bee(e+t)}function Zee(e,t,n){var r,i,o,s,a,l,h,u,c,d,p=t-1,g=n-1,m=0;if(e<=0)return 0;if(e>=1)return 1;for(t>=1&&n>=1?(o=e<.5?e:1-e,l=(2.30753+.27061*(s=Math.sqrt(-2*Math.log(o))))/(1+s*(.99229+.04481*s))-s,e<.5&&(l=-l),h=(l*l-3)/6,u=2/(1/(2*t-1)+1/(2*n-1)),c=l*Math.sqrt(h+u)/u-(1/(2*n-1)-1/(2*t-1))*(h+5/6-2/(3*u)),l=t/(t+n*Math.exp(2*c))):(r=Math.log(t/(t+n)),i=Math.log(n/(t+n)),l=e<(s=Math.exp(t*r)/t)/(c=s+(a=Math.exp(n*i)/n))?Math.pow(t*c*e,1/t):1-Math.pow(n*c*(1-e),1/n)),d=-Bee(t)-Bee(n)+Bee(t+n);m<10;m++){if(0===l||1===l)return l;if((l-=s=(a=(Jee(l,t,n)-e)/(s=Math.exp(p*Math.log(l)+g*Math.log(1-l)+d)))/(1-.5*Math.min(1,a*(p/l-g/(1-l)))))<=0&&(l=.5*(l+s)),l>=1&&(l=.5*(l+s+1)),Math.abs(s)<1e-8*l&&m>0)break}return l}function Jee(e,t,n){var r=0===e||1===e?0:Math.exp(Bee(t+n)-Bee(t)-Bee(n)+t*Math.log(e)+n*Math.log(1-e));return!(e<0||e>1)&&(e<(t+1)/(t+n+2)?r*ete(e,t,n)/t:1-r*ete(1-e,n,t)/n)}function ete(e,t,n){var r,i,o,s,a=1e-30,l=1,h=t+n,u=t+1,c=t-1,d=1,p=1-h*e/u;for(Math.abs(p)<a&&(p=a),s=p=1/p;l<=100&&(p=1+(i=l*(n-l)*e/((c+(r=2*l))*(t+r)))*p,Math.abs(p)<a&&(p=a),d=1+i/d,Math.abs(d)<a&&(d=a),s*=(p=1/p)*d,p=1+(i=-(t+l)*(h+l)*e/((t+r)*(u+r)))*p,Math.abs(p)<a&&(p=a),d=1+i/d,Math.abs(d)<a&&(d=a),s*=o=(p=1/p)*d,!(Math.abs(o-1)<3e-7));l++);return s}const tte=function(e,t,n){return 0===n||1===n?t*n===e?1:0:ite(t,e)*Math.pow(n,e)*Math.pow(1-n,t-e)},nte=function(e,t,n){var r,i=1e-10;if(e<0)return 0;if(e>=t)return 1;if(n<0||n>1||t<=0)return NaN;var o=n,s=(e=Math.floor(e))+1,a=t-e,l=s+a,h=Math.exp(Bee(l)-Bee(a)-Bee(s)+s*Math.log(o)+a*Math.log(1-o));return r=o<(s+1)/(l+2)?h*rte(o,s,a,i):1-h*rte(1-o,a,s,i),Math.round(1/i*(1-r))/(1/i)};function rte(e,t,n,r){for(var i,o=0,s=1,a=1,l=1,h=0,u=0;Math.abs((a-u)/a)>r;)u=a,s=l+(i=-(t+h)*(t+n+h)*e/(t+2*h)/(t+2*h+1))*s,a=(o=a+i*o)+(i=(h+=1)*(n-h)*e/(t+2*h-1)/(t+2*h))*a,o/=l=s+i*l,s/=l,a/=l,l=1;return a/t}function ite(e,t){return e>170||t>170?Math.exp(function(e,t){return ote(e)-ote(t)-ote(e-t)}(e,t)):ste(e)/ste(t)/ste(e-t)}function ote(e){return e<0?NaN:Bee(e+1)}function ste(e){return e<0?NaN:Fee(e+1)}const ate=function(e,t){return e<0?0:0===e&&2===t?.5:Math.exp((t/2-1)*Math.log(e)-e/2-t/2*Math.log(2)-Bee(t/2))},lte=function(e,t){return e<0?0:Wee(t/2,e/2)},hte=function(e,t){return 2*jee(e,.5*t)},ute=function(e,t,n){return e<0?0:t<=2?0===e&&t<2?1/0:0===e&&2===t?1:1/qee(t/2,n/2)*Math.pow(t/n,t/2)*Math.pow(e,t/2-1)*Math.pow(1+t/n*e,-(t+n)/2):t*(n/(n+e*t))/2*tte((t-2)/2,(t+n-2)/2,t*e/(n+e*t))},cte=function(e,t,n){return e<0?0:Jee(t*e/(t*e+n),t/2,n/2)},dte=function(e,t,n){return n/(t*(1/Zee(e,t/2,n/2)-1))},pte=function(e,t,n){return e<0||t<0||n<0?0:n/t*Math.pow(e/t,n-1)*Math.exp(-Math.pow(e/t,n))},gte=function(e,t,n){return e<0?0:1-Math.exp(-Math.pow(e/t,n))},mte={pdf:function(e,t){return t<0||e%1!=0||e<0?0:Math.pow(t,e)*Math.exp(-t)/ste(e)},cdf:function(e,t){var n=0;if(e<0)return 0;for(var r=0;n<=e;n++)r+=mte.pdf(n,t);return r}},fte={pdf:function(e,t,n,r){if(e<0||e<n-(t-r))return 0;if(e>r||e>n)return 0;if(2*n>t)return 2*r>t?fte.pdf(t-n-r+e,t,t-n,t-r):fte.pdf(r-e,t,t-n,r);if(2*r>t)return fte.pdf(n-e,t,n,t-r);if(n<r)return fte.pdf(e,t,r,n);for(var i=1,o=0,s=0;s<e;s++){for(;i>1&&o<r;)i*=1-n/(t-o),o++;i*=(r-s)*(n-s)/((s+1)*(t-n-r+s+1))}for(;o<r;o++)i*=1-n/(t-o);return Math.min(1,Math.max(0,i))},cdf:function e(t,n,r,i){if(t<0||t<r-(n-i))return 0;if(t>=i||t>=r)return 1;if(2*r>n)return 2*i>n?e(n-r-i+t,n,n-r,n-i):1-fte.cdf(i-t-1,n,n-r,i);if(2*i>n)return 1-fte.cdf(r-t-1,n,r,n-i);if(r<i)return fte.cdf(t,n,i,r);for(var o=1,s=1,a=0,l=0;l<t;l++){for(;o>1&&a<i;){var h=1-r/(n-a);s*=h,o*=h,a++}o+=s*=(i-l)*(r-l)/((l+1)*(n-r-i+l+1))}for(;a<i;a++)o*=1-r/(n-a);return Math.min(1,Math.max(0,o))}},wte=function(e,t){return t=t>1e100?1e100:t,1/(Math.sqrt(t)*qee(.5,t/2))*Math.pow(1+e*e/t,-(t+1)/2)},yte=function(e,t){var n=t/2;return Jee((e+Math.sqrt(e*e+t))/(2*Math.sqrt(e*e+t)),n,n)},vte=function(e,t){var n=Zee(2*Math.min(e,1-e),.5*t,.5);return n=Math.sqrt(t*(1-n)/n),e>.5?n:-n},Cte=function(e,t,n){return e<=0?0:Math.exp(-Math.log(e)-.5*Math.log(2*Math.PI)-Math.log(n)-Math.pow(Math.log(e)-t,2)/(2*n*n))},Ste=function(e,t,n){return e<0?0:.5+.5*Pee((Math.log(e)-t)/Math.sqrt(2*n*n))},Rte=function(e,t,n){return Math.exp(-1.4142135623730951*n*Lee(2*e)+t)},Ete={pdf:function(e,t,n){return e===e>>>0&&(e<0?0:ite(e+t-1,t-1)*Math.pow(1-n,e)*Math.pow(n,t))},cdf:function(e,t,n){var r=0,i=0;if(e<0)return 0;for(;i<=e;i++)r+=Ete.pdf(i,t,n);return r}};function bte(e){for(var t=0,n=e.length;--n>=0;)t+=e[n];return t}function Tte(e){return bte(e)/e.length}function Nte(e){for(var t,n=Tte(e),r=0,i=e.length;--i>=0;)r+=(t=e[i]-n)*t;return r}function Ate(e,t){return Nte(e)/(e.length-(t?1:0))}function Mte(e,t){return Math.sqrt(Ate(e,t))}function Ite(e,t){var n,r=Tte(e),i=Tte(t),o=e.length,s=new Array(o);for(n=0;n<o;n++)s[n]=(e[n]-r)*(t[n]-i);return bte(s)/(o-1)}function Ote(e,t){return Ite(e,t)/Mte(e,1)/Mte(t,1)}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class xte extends J4{erf(e,t){return this.runFunction(e.args,t,this.metadata("ERF"),((e,t)=>void 0===t?Pee(e):Pee(t)-Pee(e)))}erfc(e,t){return this.runFunction(e.args,t,this.metadata("ERFC"),_ee)}expondist(e,t){return this.runFunction(e.args,t,this.metadata("EXPON.DIST"),((e,t,n)=>n?kee(e,t):Hee(e,t)))}fisher(e,t){return this.runFunction(e.args,t,this.metadata("FISHER"),(e=>Math.log((1+e)/(1-e))/2))}fisherinv(e,t){return this.runFunction(e.args,t,this.metadata("FISHERINV"),(e=>1-2/(Math.exp(2*e)+1)))}gamma(e,t){return this.runFunction(e.args,t,this.metadata("GAMMA"),Fee)}gammadist(e,t){return this.runFunction(e.args,t,this.metadata("GAMMA.DIST"),((e,t,n,r)=>r?Vee(e,t,n):Dee(e,t,n)))}gammaln(e,t){return this.runFunction(e.args,t,this.metadata("GAMMALN"),Bee)}gammainv(e,t){return this.runFunction(e.args,t,this.metadata("GAMMA.INV"),Uee)}gauss(e,t){return this.runFunction(e.args,t,this.metadata("GAUSS"),(e=>zee(e,0,1)-.5))}betadist(e,t){return this.runFunction(e.args,t,this.metadata("BETA.DIST"),((e,t,n,r,i,o)=>e<=i?new g4(X9.NUM,W2.ValueSmall):e>=o?new g4(X9.NUM,W2.ValueLarge):(e=(e-i)/(o-i),r?Kee(e,t,n):Yee(e,t,n))))}betainv(e,t){return this.runFunction(e.args,t,this.metadata("BETA.INV"),((e,t,n,r,i)=>r>=i?new g4(X9.NUM,W2.WrongOrder):Xee(e,t,n)*(i-r)+r))}binomialdist(e,t){return this.runFunction(e.args,t,this.metadata("BINOM.DIST"),((e,t,n,r)=>e>t?new g4(X9.NUM,W2.WrongOrder):(e=Math.trunc(e),t=Math.trunc(t),r?nte(e,t,n):tte(e,t,n))))}binomialinv(e,t){return this.runFunction(e.args,t,this.metadata("BINOM.INV"),((e,t,n)=>{let r=-1,i=e=Math.trunc(e);for(;i>r+1;){const o=Math.trunc((r+i)/2);nte(o,e,t)>=n?i=o:r=o}return i}))}besselifn(e,t){return this.runFunction(e.args,t,this.metadata("BESSELI"),((e,t)=>Oee(e,Math.trunc(t))))}besseljfn(e,t){return this.runFunction(e.args,t,this.metadata("BESSELJ"),((e,t)=>Mee(e,Math.trunc(t))))}besselkfn(e,t){return this.runFunction(e.args,t,this.metadata("BESSELK"),((e,t)=>xee(e,Math.trunc(t))))}besselyfn(e,t){return this.runFunction(e.args,t,this.metadata("BESSELY"),((e,t)=>Iee(e,Math.trunc(t))))}chisqdist(e,t){return this.runFunction(e.args,t,this.metadata("CHISQ.DIST"),((e,t,n)=>(t=Math.trunc(t),n?lte(e,t):ate(e,t))))}chisqdistrt(e,t){return this.runFunction(e.args,t,this.metadata("CHISQ.DIST.RT"),((e,t)=>1-lte(e,Math.trunc(t))))}chisqinv(e,t){return this.runFunction(e.args,t,this.metadata("CHISQ.INV"),((e,t)=>hte(e,Math.trunc(t))))}chisqinvrt(e,t){return this.runFunction(e.args,t,this.metadata("CHISQ.INV.RT"),((e,t)=>hte(1-e,Math.trunc(t))))}fdist(e,t){return this.runFunction(e.args,t,this.metadata("F.DIST"),((e,t,n,r)=>(t=Math.trunc(t),n=Math.trunc(n),r?cte(e,t,n):ute(e,t,n))))}fdistrt(e,t){return this.runFunction(e.args,t,this.metadata("F.DIST.RT"),((e,t,n)=>1-cte(e,Math.trunc(t),Math.trunc(n))))}finv(e,t){return this.runFunction(e.args,t,this.metadata("F.INV"),((e,t,n)=>dte(e,Math.trunc(t),Math.trunc(n))))}finvrt(e,t){return this.runFunction(e.args,t,this.metadata("F.INV.RT"),((e,t,n)=>dte(1-e,Math.trunc(t),Math.trunc(n))))}weibulldist(e,t){return this.runFunction(e.args,t,this.metadata("WEIBULL.DIST"),((e,t,n,r)=>r?gte(e,n,t):pte(e,n,t)))}poissondist(e,t){return this.runFunction(e.args,t,this.metadata("POISSON.DIST"),((e,t,n)=>(e=Math.trunc(e),n?mte.cdf(e,t):mte.pdf(e,t))))}hypgeomdist(e,t){return this.runFunction(e.args,t,this.metadata("HYPGEOM.DIST"),((e,t,n,r,i)=>e>t||e>n||t>r||n>r||e+r<n+t?new g4(X9.NUM,W2.ValueLarge):(e=Math.trunc(e),t=Math.trunc(t),n=Math.trunc(n),r=Math.trunc(r),i?fte.cdf(e,r,n,t):fte.pdf(e,r,n,t))))}tdist(e,t){return this.runFunction(e.args,t,this.metadata("T.DIST"),((e,t,n)=>(t=Math.trunc(t),n?yte(e,t):wte(e,t))))}tdist2t(e,t){return this.runFunction(e.args,t,this.metadata("T.DIST.2T"),((e,t)=>2*(1-yte(e,Math.trunc(t)))))}tdistrt(e,t){return this.runFunction(e.args,t,this.metadata("T.DIST.RT"),((e,t)=>1-yte(e,Math.trunc(t))))}tdistold(e,t){return this.runFunction(e.args,t,this.metadata("TDIST"),((e,t,n)=>n*(1-yte(e,Math.trunc(t)))))}tinv(e,t){return this.runFunction(e.args,t,this.metadata("T.INV"),((e,t)=>vte(e,Math.trunc(t))))}tinv2t(e,t){return this.runFunction(e.args,t,this.metadata("T.INV.2T"),((e,t)=>vte(1-e/2,Math.trunc(t))))}lognormdist(e,t){return this.runFunction(e.args,t,this.metadata("LOGNORM.DIST"),((e,t,n,r)=>r?Ste(e,t,n):Cte(e,t,n)))}lognorminv(e,t){return this.runFunction(e.args,t,this.metadata("LOGNORM.INV"),((e,t,n)=>Rte(e,t,n)))}normdist(e,t){return this.runFunction(e.args,t,this.metadata("NORM.DIST"),((e,t,n,r)=>r?zee(e,t,n):Gee(e,t,n)))}norminv(e,t){return this.runFunction(e.args,t,this.metadata("NORM.INV"),((e,t,n)=>$ee(e,t,n)))}normsdist(e,t){return this.runFunction(e.args,t,this.metadata("NORM.S.DIST"),((e,t)=>t?zee(e,0,1):Gee(e,0,1)))}normsinv(e,t){return this.runFunction(e.args,t,this.metadata("NORM.S.INV"),(e=>$ee(e,0,1)))}phi(e,t){return this.runFunction(e.args,t,this.metadata("PHI"),(e=>Gee(e,0,1)))}negbinomdist(e,t){return this.runFunction(e.args,t,this.metadata("NEGBINOM.DIST"),((e,t,n,r)=>(e=Math.trunc(e),t=Math.trunc(t),r?Ete.cdf(e,t,n):Ete.pdf(e,t,n))))}confidencenorm(e,t){return this.runFunction(e.args,t,this.metadata("CONFIDENCE.NORM"),((e,t,n)=>function(){var e,t=[].slice.call(arguments),n=new Array(2);return e=4===t.length?Math.abs($ee(t[1]/2,0,1)*t[2]/Math.sqrt(t[3])):Math.abs($ee(t[1]/2,0,1)*Mte(t[2])/Math.sqrt(t[2].length)),n[0]=t[0]-e,n[1]=t[0]+e,n}(1,e,t,Math.trunc(n))[1]-1))}confidencet(e,t){return this.runFunction(e.args,t,this.metadata("CONFIDENCE.T"),((e,t,n)=>1===(n=Math.trunc(n))?new g4(X9.DIV_BY_ZERO):function(){var e,t=[].slice.call(arguments),n=new Array(2);return e=4===t.length?Math.abs(vte(t[1]/2,t[3]-1)*t[2]/Math.sqrt(t[3])):Math.abs(vte(t[1]/2,t[2].length-1)*Mte(t[2],!0)/Math.sqrt(t[2].length)),n[0]=t[0]-e,n[1]=t[0]+e,n}(1,e,t,n)[1]-1))}standardize(e,t){return this.runFunction(e.args,t,this.metadata("STANDARDIZE"),((e,t,n)=>(e-t)/n))}}xte.implementedFunctions={ERF:{method:"erf",parameters:[{argumentType:Z4.NUMBER},{argumentType:Z4.NUMBER,optionalArg:!0}]},ERFC:{method:"erfc",parameters:[{argumentType:Z4.NUMBER}]},"EXPON.DIST":{method:"expondist",parameters:[{argumentType:Z4.NUMBER,minValue:0},{argumentType:Z4.NUMBER,greaterThan:0},{argumentType:Z4.BOOLEAN}]},FISHER:{method:"fisher",parameters:[{argumentType:Z4.NUMBER,greaterThan:-1,lessThan:1}]},FISHERINV:{method:"fisherinv",parameters:[{argumentType:Z4.NUMBER}]},GAMMA:{method:"gamma",parameters:[{argumentType:Z4.NUMBER}]},"GAMMA.DIST":{method:"gammadist",parameters:[{argumentType:Z4.NUMBER,minValue:0},{argumentType:Z4.NUMBER,greaterThan:0},{argumentType:Z4.NUMBER,greaterThan:0},{argumentType:Z4.BOOLEAN}]},GAMMALN:{method:"gammaln",parameters:[{argumentType:Z4.NUMBER,greaterThan:0}]},"GAMMA.INV":{method:"gammainv",parameters:[{argumentType:Z4.NUMBER,minValue:0,lessThan:1},{argumentType:Z4.NUMBER,greaterThan:0},{argumentType:Z4.NUMBER,greaterThan:0}]},GAUSS:{method:"gauss",parameters:[{argumentType:Z4.NUMBER}]},"BETA.DIST":{method:"betadist",parameters:[{argumentType:Z4.NUMBER},{argumentType:Z4.NUMBER,greaterThan:0},{argumentType:Z4.NUMBER,greaterThan:0},{argumentType:Z4.BOOLEAN},{argumentType:Z4.NUMBER,defaultValue:0},{argumentType:Z4.NUMBER,defaultValue:1}]},"BETA.INV":{method:"betainv",parameters:[{argumentType:Z4.NUMBER,greaterThan:0,maxValue:1},{argumentType:Z4.NUMBER,greaterThan:0},{argumentType:Z4.NUMBER,greaterThan:0},{argumentType:Z4.NUMBER,defaultValue:0},{argumentType:Z4.NUMBER,defaultValue:1}]},"BINOM.DIST":{method:"binomialdist",parameters:[{argumentType:Z4.NUMBER,minValue:0},{argumentType:Z4.NUMBER,minValue:0},{argumentType:Z4.NUMBER,minValue:0,maxValue:1},{argumentType:Z4.BOOLEAN}]},"BINOM.INV":{method:"binomialinv",parameters:[{argumentType:Z4.NUMBER,minValue:0},{argumentType:Z4.NUMBER,minValue:0,maxValue:1},{argumentType:Z4.NUMBER,greaterThan:0,lessThan:1}]},BESSELI:{method:"besselifn",parameters:[{argumentType:Z4.NUMBER},{argumentType:Z4.NUMBER,minValue:0}]},BESSELJ:{method:"besseljfn",parameters:[{argumentType:Z4.NUMBER},{argumentType:Z4.NUMBER,minValue:0}]},BESSELK:{method:"besselkfn",parameters:[{argumentType:Z4.NUMBER},{argumentType:Z4.NUMBER,minValue:0}]},BESSELY:{method:"besselyfn",parameters:[{argumentType:Z4.NUMBER},{argumentType:Z4.NUMBER,minValue:0}]},"CHISQ.DIST":{method:"chisqdist",parameters:[{argumentType:Z4.NUMBER},{argumentType:Z4.NUMBER,minValue:1,maxValue:1e10},{argumentType:Z4.BOOLEAN}]},"CHISQ.DIST.RT":{method:"chisqdistrt",parameters:[{argumentType:Z4.NUMBER},{argumentType:Z4.NUMBER,minValue:1,maxValue:1e10}]},"CHISQ.INV":{method:"chisqinv",parameters:[{argumentType:Z4.NUMBER,minValue:0,maxValue:1},{argumentType:Z4.NUMBER,minValue:1,maxValue:1e10}]},"CHISQ.INV.RT":{method:"chisqinvrt",parameters:[{argumentType:Z4.NUMBER,minValue:0,maxValue:1},{argumentType:Z4.NUMBER,minValue:1}]},"F.DIST":{method:"fdist",parameters:[{argumentType:Z4.NUMBER,minValue:0},{argumentType:Z4.NUMBER,minValue:1},{argumentType:Z4.NUMBER,minValue:1},{argumentType:Z4.BOOLEAN}]},"F.DIST.RT":{method:"fdistrt",parameters:[{argumentType:Z4.NUMBER,minValue:0},{argumentType:Z4.NUMBER,minValue:1},{argumentType:Z4.NUMBER,minValue:1}]},"F.INV":{method:"finv",parameters:[{argumentType:Z4.NUMBER,minValue:0,maxValue:1},{argumentType:Z4.NUMBER,minValue:1},{argumentType:Z4.NUMBER,minValue:1}]},"F.INV.RT":{method:"finvrt",parameters:[{argumentType:Z4.NUMBER,minValue:0,maxValue:1},{argumentType:Z4.NUMBER,minValue:1},{argumentType:Z4.NUMBER,minValue:1}]},"WEIBULL.DIST":{method:"weibulldist",parameters:[{argumentType:Z4.NUMBER,minValue:0},{argumentType:Z4.NUMBER,greaterThan:0},{argumentType:Z4.NUMBER,greaterThan:0},{argumentType:Z4.BOOLEAN}]},"POISSON.DIST":{method:"poissondist",parameters:[{argumentType:Z4.NUMBER,minValue:0},{argumentType:Z4.NUMBER,minValue:0},{argumentType:Z4.BOOLEAN}]},"HYPGEOM.DIST":{method:"hypgeomdist",parameters:[{argumentType:Z4.NUMBER,minValue:0},{argumentType:Z4.NUMBER,greaterThan:0},{argumentType:Z4.NUMBER,greaterThan:0},{argumentType:Z4.NUMBER,greaterThan:0},{argumentType:Z4.BOOLEAN}]},"T.DIST":{method:"tdist",parameters:[{argumentType:Z4.NUMBER},{argumentType:Z4.NUMBER,minValue:1},{argumentType:Z4.BOOLEAN}]},"T.DIST.2T":{method:"tdist2t",parameters:[{argumentType:Z4.NUMBER,minValue:0},{argumentType:Z4.NUMBER,minValue:1}]},"T.DIST.RT":{method:"tdistrt",parameters:[{argumentType:Z4.NUMBER},{argumentType:Z4.NUMBER,minValue:1}]},TDIST:{method:"tdistold",parameters:[{argumentType:Z4.NUMBER,minValue:0},{argumentType:Z4.NUMBER,minValue:1},{argumentType:Z4.INTEGER,minValue:1,maxValue:2}]},"T.INV":{method:"tinv",parameters:[{argumentType:Z4.NUMBER,greaterThan:0,lessThan:1},{argumentType:Z4.NUMBER,minValue:1}]},"T.INV.2T":{method:"tinv2t",parameters:[{argumentType:Z4.NUMBER,greaterThan:0,maxValue:1},{argumentType:Z4.NUMBER,minValue:1}]},"LOGNORM.DIST":{method:"lognormdist",parameters:[{argumentType:Z4.NUMBER,greaterThan:0},{argumentType:Z4.NUMBER},{argumentType:Z4.NUMBER,greaterThan:0},{argumentType:Z4.BOOLEAN}]},"LOGNORM.INV":{method:"lognorminv",parameters:[{argumentType:Z4.NUMBER,greaterThan:0,lessThan:1},{argumentType:Z4.NUMBER},{argumentType:Z4.NUMBER,greaterThan:0}]},"NORM.DIST":{method:"normdist",parameters:[{argumentType:Z4.NUMBER},{argumentType:Z4.NUMBER},{argumentType:Z4.NUMBER,greaterThan:0},{argumentType:Z4.BOOLEAN}]},"NORM.INV":{method:"norminv",parameters:[{argumentType:Z4.NUMBER,greaterThan:0,lessThan:1},{argumentType:Z4.NUMBER},{argumentType:Z4.NUMBER,greaterThan:0}]},"NORM.S.DIST":{method:"normsdist",parameters:[{argumentType:Z4.NUMBER},{argumentType:Z4.BOOLEAN}]},"NORM.S.INV":{method:"normsinv",parameters:[{argumentType:Z4.NUMBER,greaterThan:0,lessThan:1}]},PHI:{method:"phi",parameters:[{argumentType:Z4.NUMBER}]},"NEGBINOM.DIST":{method:"negbinomdist",parameters:[{argumentType:Z4.NUMBER,minValue:0},{argumentType:Z4.NUMBER,minValue:1},{argumentType:Z4.NUMBER,minValue:0,maxValue:1},{argumentType:Z4.BOOLEAN}]},"CONFIDENCE.NORM":{method:"confidencenorm",parameters:[{argumentType:Z4.NUMBER,greaterThan:0,lessThan:1},{argumentType:Z4.NUMBER,greaterThan:0},{argumentType:Z4.NUMBER,minValue:1}]},"CONFIDENCE.T":{method:"confidencet",parameters:[{argumentType:Z4.NUMBER,greaterThan:0,lessThan:1},{argumentType:Z4.NUMBER,greaterThan:0},{argumentType:Z4.NUMBER,minValue:1}]},STANDARDIZE:{method:"standardize",parameters:[{argumentType:Z4.NUMBER},{argumentType:Z4.NUMBER},{argumentType:Z4.NUMBER,greaterThan:0}]}},xte.aliases={NEGBINOMDIST:"NEGBINOM.DIST",EXPONDIST:"EXPON.DIST",BETADIST:"BETA.DIST",NORMDIST:"NORM.DIST",NORMINV:"NORM.INV",NORMSDIST:"NORM.S.DIST",NORMSINV:"NORM.S.INV",LOGNORMDIST:"LOGNORM.DIST",LOGINV:"LOGNORM.INV",TINV:"T.INV.2T",HYPGEOMDIST:"HYPGEOM.DIST",POISSON:"POISSON.DIST",WEIBULL:"WEIBULL.DIST",FINV:"F.INV.RT",FDIST:"F.DIST.RT",CHIDIST:"CHISQ.DIST.RT",CHIINV:"CHISQ.INV.RT",GAMMADIST:"GAMMA.DIST","GAMMALN.PRECISE":"GAMMALN",GAMMAINV:"GAMMA.INV",BETAINV:"BETA.INV",BINOMDIST:"BINOM.DIST",CONFIDENCE:"CONFIDENCE.NORM",CRITBINOM:"BINOM.INV",WEIBULLDIST:"WEIBULL.DIST",TINV2T:"T.INV.2T",TDISTRT:"T.DIST.RT",TDIST2T:"T.DIST.2T",FINVRT:"F.INV.RT",FDISTRT:"F.DIST.RT",CHIDISTRT:"CHISQ.DIST.RT",CHIINVRT:"CHISQ.INV.RT",LOGNORMINV:"LOGNORM.INV",POISSONDIST:"POISSON.DIST"};
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */
class Pte extends J4{fact(e,t){return this.runFunction(e.args,t,this.metadata("FACT"),(e=>{e=Math.trunc(e);let t=1;for(let n=1;n<=e;n++)t*=n;return t}))}factdouble(e,t){return this.runFunction(e.args,t,this.metadata("FACTDOUBLE"),(e=>{let t=1;for(let n=e=Math.trunc(e);n>=1;n-=2)t*=n;return t}))}combin(e,t){return this.runFunction(e.args,t,this.metadata("COMBIN"),((e,t)=>t>e?new g4(X9.NUM,W2.WrongOrder):_te(e=Math.trunc(e),t=Math.trunc(t))))}combina(e,t){return this.runFunction(e.args,t,this.metadata("COMBINA"),((e,t)=>(e=Math.trunc(e))+(t=Math.trunc(t))-1>=1030?new g4(X9.NUM,W2.ValueLarge):0===e&&0===t?1:_te(e+t-1,t)))}gcd(e,t){return this.runFunction(e.args,t,this.metadata("GCD"),((...e)=>{const t=this.arithmeticHelper.coerceNumbersCoerceRangesDropNulls(e);if(t instanceof g4)return t;let n=0;for(const r of t){if(r<0)return new g4(X9.NUM,W2.ValueSmall);n=Lte(n,Math.trunc(r))}return n>Number.MAX_SAFE_INTEGER?new g4(X9.NUM,W2.ValueLarge):n}))}lcm(e,t){return this.runFunction(e.args,t,this.metadata("LCM"),((...e)=>{const t=this.arithmeticHelper.coerceNumbersCoerceRangesDropNulls(e);if(t instanceof g4)return t;let n=1;for(const r of t){if(r<0)return new g4(X9.NUM,W2.ValueSmall);n=Hte(n,Math.trunc(r))}return n>Number.MAX_SAFE_INTEGER?new g4(X9.NUM,W2.ValueLarge):n}))}mround(e,t){return this.runFunction(e.args,t,this.metadata("MROUND"),((e,t)=>0===t?0:e>0&&t<0||e<0&&t>0?new g4(X9.NUM,W2.DistinctSigns):Math.round(e/t)*t))}multinomial(e,t){return this.runFunction(e.args,t,this.metadata("MULTINOMIAL"),((...e)=>{let t=0,n=1;for(let r of e){if(r<0)return new g4(X9.NUM,W2.ValueSmall);r=Math.trunc(r);for(let e=1;e<=r;e++)n*=(t+e)/e;t+=r}return Math.round(n)}))}quotient(e,t){return this.runFunction(e.args,t,this.metadata("QUOTIENT"),((e,t)=>0===t?new g4(X9.DIV_BY_ZERO):Math.trunc(e/t)))}seriessum(e,t){return this.runFunction(e.args,t,this.metadata("SERIESSUM"),((e,t,n,r)=>{const i=this.arithmeticHelper.manyToOnlyNumbersDropNulls(r.valuesFromTopLeftCorner());if(i instanceof g4)return i;let o=0;i.reverse();for(const s of i)o*=Math.pow(e,n),o+=s;return o*Math.pow(e,t)}))}sign(e,t){return this.runFunction(e.args,t,this.metadata("SIGN"),(e=>e>0?1:e<0?-1:0))}sumx2my2(e,t){return this.runFunction(e.args,t,this.metadata("SUMX2MY2"),((e,t)=>{const n=e.valuesFromTopLeftCorner(),r=t.valuesFromTopLeftCorner();if(n.length!==r.length)return new g4(X9.NA,W2.EqualLength);const i=n.length;let o=0;for(let s=0;s<i;s++){const e=n[s],t=r[s];if(e instanceof g4)return e;if(t instanceof g4)return t;"number"==typeof e&&"number"==typeof t&&(o+=Math.pow(e,2)-Math.pow(t,2))}return o}))}sumx2py2(e,t){return this.runFunction(e.args,t,this.metadata("SUMX2PY2"),((e,t)=>{const n=e.valuesFromTopLeftCorner(),r=t.valuesFromTopLeftCorner();if(n.length!==r.length)return new g4(X9.NA,W2.EqualLength);const i=n.length;let o=0;for(let s=0;s<i;s++){const e=n[s],t=r[s];if(e instanceof g4)return e;if(t instanceof g4)return t;"number"==typeof e&&"number"==typeof t&&(o+=Math.pow(e,2)+Math.pow(t,2))}return o}))}sumxmy2(e,t){return this.runFunction(e.args,t,this.metadata("SUMXMY2"),((e,t)=>{const n=e.valuesFromTopLeftCorner(),r=t.valuesFromTopLeftCorner();if(n.length!==r.length)return new g4(X9.NA,W2.EqualLength);const i=n.length;let o=0;for(let s=0;s<i;s++){const e=n[s],t=r[s];if(e instanceof g4)return e;if(t instanceof g4)return t;"number"==typeof e&&"number"==typeof t&&(o+=Math.pow(e-t,2))}return o}))}}function _te(e,t){2*t>e&&(t=e-t);let n=1;for(let r=1;r<=t;r++)n*=(e-t+r)/r;return Math.round(n)}function Lte(e,t){for(e<t&&([e,t]=[t,e]);t>0;)[e,t]=[t,e%t];return e}function Hte(e,t){return 0===e||0===t?0:e*(t/Lte(e,t))}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */Pte.implementedFunctions={FACT:{method:"fact",parameters:[{argumentType:Z4.NUMBER,minValue:0,maxValue:170}]},FACTDOUBLE:{method:"factdouble",parameters:[{argumentType:Z4.NUMBER,minValue:0,maxValue:288}]},COMBIN:{method:"combin",parameters:[{argumentType:Z4.NUMBER,minValue:0,lessThan:1030},{argumentType:Z4.NUMBER,minValue:0}]},COMBINA:{method:"combina",parameters:[{argumentType:Z4.NUMBER,minValue:0},{argumentType:Z4.NUMBER,minValue:0}]},GCD:{method:"gcd",parameters:[{argumentType:Z4.ANY}],repeatLastArgs:1},LCM:{method:"lcm",parameters:[{argumentType:Z4.ANY}],repeatLastArgs:1},MROUND:{method:"mround",parameters:[{argumentType:Z4.NUMBER},{argumentType:Z4.NUMBER}]},MULTINOMIAL:{method:"multinomial",parameters:[{argumentType:Z4.NUMBER}],repeatLastArgs:1,expandRanges:!0},QUOTIENT:{method:"quotient",parameters:[{argumentType:Z4.NUMBER},{argumentType:Z4.NUMBER}]},SERIESSUM:{method:"seriessum",parameters:[{argumentType:Z4.NUMBER},{argumentType:Z4.NUMBER},{argumentType:Z4.NUMBER},{argumentType:Z4.RANGE}]},SIGN:{method:"sign",parameters:[{argumentType:Z4.NUMBER}]},SUMX2MY2:{method:"sumx2my2",parameters:[{argumentType:Z4.RANGE},{argumentType:Z4.RANGE}]},SUMX2PY2:{method:"sumx2py2",parameters:[{argumentType:Z4.RANGE},{argumentType:Z4.RANGE}]},SUMXMY2:{method:"sumxmy2",parameters:[{argumentType:Z4.RANGE},{argumentType:Z4.RANGE}]}};class kte extends J4{complex(e,t){return this.runFunction(e.args,t,this.metadata("COMPLEX"),((e,t,n)=>"i"!==n&&"j"!==n?new g4(X9.VALUE,W2.ShouldBeIorJ):L4([e,t],n)))}imabs(e,t){return this.runFunction(e.args,t,this.metadata("IMABS"),zte)}imaginary(e,t){return this.runFunction(e.args,t,this.metadata("IMAGINARY"),(([e,t])=>t))}imreal(e,t){return this.runFunction(e.args,t,this.metadata("IMREAL"),(([e,t])=>e))}imargument(e,t){return this.runFunction(e.args,t,this.metadata("IMARGUMENT"),(([e,t])=>0===e&&0===t?new g4(X9.DIV_BY_ZERO):Math.atan2(t,e)))}imconjugate(e,t){return this.runFunction(e.args,t,this.metadata("IMCONJUGATE"),(([e,t])=>L4([e,-t])))}imcos(e,t){return this.runFunction(e.args,t,this.metadata("IMCOS"),(e=>L4(Ute(e))))}imcosh(e,t){return this.runFunction(e.args,t,this.metadata("IMCOSH"),(e=>L4(Bte(e))))}imcot(e,t){return this.runFunction(e.args,t,this.metadata("IMCOT"),(e=>L4(Vte(Ute(e),Wte(e)))))}imcsc(e,t){return this.runFunction(e.args,t,this.metadata("IMCSC"),(e=>L4(Vte([1,0],Wte(e)))))}imcsch(e,t){return this.runFunction(e.args,t,this.metadata("IMCSCH"),(e=>L4(Vte([1,0],jte(e)))))}imsec(e,t){return this.runFunction(e.args,t,this.metadata("IMSEC"),(e=>L4(Vte([1,0],Ute(e)))))}imsech(e,t){return this.runFunction(e.args,t,this.metadata("IMSECH"),(e=>L4(Vte([1,0],Bte(e)))))}imsin(e,t){return this.runFunction(e.args,t,this.metadata("IMSIN"),(e=>L4(Wte(e))))}imsinh(e,t){return this.runFunction(e.args,t,this.metadata("IMSINH"),(e=>L4(jte(e))))}imtan(e,t){return this.runFunction(e.args,t,this.metadata("IMTAN"),(e=>L4(Vte(Wte(e),Ute(e)))))}imdiv(e,t){return this.runFunction(e.args,t,this.metadata("IMDIV"),((e,t)=>L4(Vte(e,t))))}improduct(e,t){return this.runFunction(e.args,t,this.metadata("IMPRODUCT"),((...e)=>{const t=this.arithmeticHelper.coerceComplexExactRanges(e);if(t instanceof g4)return t;let n=[1,0];for(const r of t)n=Dte(n,r);return L4(n)}))}imsum(e,t){return this.runFunction(e.args,t,this.metadata("IMSUM"),((...e)=>{const t=this.arithmeticHelper.coerceComplexExactRanges(e);if(t instanceof g4)return t;let n=[0,0];for(const r of t)n=Fte(n,r);return L4(n)}))}imsub(e,t){return this.runFunction(e.args,t,this.metadata("IMSUB"),((e,t)=>L4(function([e,t],[n,r]){return[e-n,t-r]}(e,t))))}imexp(e,t){return this.runFunction(e.args,t,this.metadata("IMEXP"),(e=>L4(Gte(e))))}imln(e,t){return this.runFunction(e.args,t,this.metadata("IMLN"),(e=>L4($te(e))))}imlog10(e,t){return this.runFunction(e.args,t,this.metadata("IMLOG10"),(e=>{const[t,n]=$te(e),r=Math.log(10);return L4([t/r,n/r])}))}imlog2(e,t){return this.runFunction(e.args,t,this.metadata("IMLOG2"),(e=>{const[t,n]=$te(e),r=Math.log(2);return L4([t/r,n/r])}))}impower(e,t){return this.runFunction(e.args,t,this.metadata("IMPOWER"),((e,t)=>L4(Yte(e,t))))}imsqrt(e,t){return this.runFunction(e.args,t,this.metadata("IMSQRT"),(e=>L4(Yte(e,.5))))}}function Fte([e,t],[n,r]){return[e+n,t+r]}function Dte([e,t],[n,r]){return[e*n-t*r,e*r+n*t]}function Vte([e,t],[n,r]){const i=Math.pow(n,2)+Math.pow(r,2),[o,s]=Dte([e,t],[n,-r]);return[o/i,s/i]}function Ute([e,t]){return[Math.cos(e)*Math.cosh(t),-Math.sin(e)*Math.sinh(t)]}function Bte([e,t]){return[Math.cosh(e)*Math.cos(t),Math.sinh(e)*Math.sin(t)]}function Wte([e,t]){return[Math.sin(e)*Math.cosh(t),Math.cos(e)*Math.sinh(t)]}function jte([e,t]){return[Math.sinh(e)*Math.cos(t),Math.cosh(e)*Math.sin(t)]}function Gte([e,t]){return[Math.exp(e)*Math.cos(t),Math.exp(e)*Math.sin(t)]}function zte([e,t]){return Math.sqrt(e*e+t*t)}function $te([e,t]){return[Math.log(zte([e,t])),Math.atan2(t,e)]}function Yte(e,t){const[n,r]=$te(e);return Gte([t*n,t*r])}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */kte.implementedFunctions={COMPLEX:{method:"complex",parameters:[{argumentType:Z4.NUMBER},{argumentType:Z4.NUMBER},{argumentType:Z4.STRING,defaultValue:"i"}]},IMABS:{method:"imabs",parameters:[{argumentType:Z4.COMPLEX}]},IMAGINARY:{method:"imaginary",parameters:[{argumentType:Z4.COMPLEX}]},IMREAL:{method:"imreal",parameters:[{argumentType:Z4.COMPLEX}]},IMARGUMENT:{method:"imargument",parameters:[{argumentType:Z4.COMPLEX}]},IMCONJUGATE:{method:"imconjugate",parameters:[{argumentType:Z4.COMPLEX}]},IMCOS:{method:"imcos",parameters:[{argumentType:Z4.COMPLEX}]},IMCOSH:{method:"imcosh",parameters:[{argumentType:Z4.COMPLEX}]},IMCOT:{method:"imcot",parameters:[{argumentType:Z4.COMPLEX}]},IMCSC:{method:"imcsc",parameters:[{argumentType:Z4.COMPLEX}]},IMCSCH:{method:"imcsch",parameters:[{argumentType:Z4.COMPLEX}]},IMSEC:{method:"imsec",parameters:[{argumentType:Z4.COMPLEX}]},IMSECH:{method:"imsech",parameters:[{argumentType:Z4.COMPLEX}]},IMSIN:{method:"imsin",parameters:[{argumentType:Z4.COMPLEX}]},IMSINH:{method:"imsinh",parameters:[{argumentType:Z4.COMPLEX}]},IMTAN:{method:"imtan",parameters:[{argumentType:Z4.COMPLEX}]},IMDIV:{method:"imdiv",parameters:[{argumentType:Z4.COMPLEX},{argumentType:Z4.COMPLEX}]},IMPRODUCT:{method:"improduct",parameters:[{argumentType:Z4.ANY}],repeatLastArgs:1},IMSUM:{method:"imsum",parameters:[{argumentType:Z4.ANY}],repeatLastArgs:1},IMSUB:{method:"imsub",parameters:[{argumentType:Z4.COMPLEX},{argumentType:Z4.COMPLEX}]},IMEXP:{method:"imexp",parameters:[{argumentType:Z4.COMPLEX}]},IMLN:{method:"imln",parameters:[{argumentType:Z4.COMPLEX}]},IMLOG10:{method:"imlog10",parameters:[{argumentType:Z4.COMPLEX}]},IMLOG2:{method:"imlog2",parameters:[{argumentType:Z4.COMPLEX}]},IMPOWER:{method:"impower",parameters:[{argumentType:Z4.COMPLEX},{argumentType:Z4.NUMBER}]},IMSQRT:{method:"imsqrt",parameters:[{argumentType:Z4.COMPLEX}]}};class Kte extends J4{avedev(e,t){return this.runFunction(e.args,t,this.metadata("AVEDEV"),((...e)=>{const t=this.arithmeticHelper.coerceNumbersExactRanges(e);if(t instanceof g4)return t;if(0===t.length)return new g4(X9.DIV_BY_ZERO);const n=Tte(t);return t.reduce(((e,t)=>e+Math.abs(t-n)),0)/t.length}))}devsq(e,t){return this.runFunction(e.args,t,this.metadata("DEVSQ"),((...e)=>{const t=this.arithmeticHelper.coerceNumbersExactRanges(e);return t instanceof g4?t:0===t.length?0:Nte(t)}))}geomean(e,t){return this.runFunction(e.args,t,this.metadata("GEOMEAN"),((...e)=>{const t=this.arithmeticHelper.coerceNumbersExactRanges(e);if(t instanceof g4)return t;if(0===t.length)return new g4(X9.NUM,W2.OneValue);for(const r of t)if(r<=0)return new g4(X9.NUM,W2.ValueSmall);return n=t,Math.pow(function(e){for(var t=1,n=e.length;--n>=0;)t*=e[n];return t}(n),1/n.length);var n}))}harmean(e,t){return this.runFunction(e.args,t,this.metadata("HARMEAN"),((...e)=>{const t=this.arithmeticHelper.coerceNumbersExactRanges(e);if(t instanceof g4)return t;if(0===t.length)return new g4(X9.NUM,W2.OneValue);for(const n of t)if(n<=0)return new g4(X9.NUM,W2.ValueSmall);return t.length/t.reduce(((e,t)=>e+1/t),0)}))}correl(e,t){return this.runFunction(e.args,t,this.metadata("CORREL"),((e,t)=>{if(e.numberOfElements()!==t.numberOfElements())return new g4(X9.NA,W2.EqualLength);const n=Xte(e,t);if(n instanceof g4)return n;return n[0].length<=1?new g4(X9.DIV_BY_ZERO,W2.TwoValues):Ote(n[0],n[1])}))}rsq(e,t){return this.runFunction(e.args,t,this.metadata("RSQ"),((e,t)=>{if(e.numberOfElements()!==t.numberOfElements())return new g4(X9.NA,W2.EqualLength);const n=Xte(e,t);if(n instanceof g4)return n;return n[0].length<=1?new g4(X9.DIV_BY_ZERO,W2.TwoValues):Math.pow(Ote(n[0],n[1]),2)}))}covariancep(e,t){return this.runFunction(e.args,t,this.metadata("COVARIANCE.P"),((e,t)=>{if(e.numberOfElements()!==t.numberOfElements())return new g4(X9.NA,W2.EqualLength);const n=Xte(e,t);if(n instanceof g4)return n;const r=n[0].length;return r<1?new g4(X9.DIV_BY_ZERO,W2.OneValue):1===r?0:Ite(n[0],n[1])*(r-1)/r}))}covariances(e,t){return this.runFunction(e.args,t,this.metadata("COVARIANCE.S"),((e,t)=>{if(e.numberOfElements()!==t.numberOfElements())return new g4(X9.NA,W2.EqualLength);const n=Xte(e,t);if(n instanceof g4)return n;return n[0].length<=1?new g4(X9.DIV_BY_ZERO,W2.TwoValues):Ite(n[0],n[1])}))}ztest(e,t){return this.runFunction(e.args,t,this.metadata("Z.TEST"),((e,t,n)=>{const r=this.arithmeticHelper.manyToExactNumbers(e.valuesFromTopLeftCorner());if(r instanceof g4)return r;const i=r.length;if(void 0===n){if(i<2)return new g4(X9.DIV_BY_ZERO,W2.TwoValues);n=Mte(r,!0)}return i<1?new g4(X9.NA,W2.OneValue):0===n?new g4(X9.DIV_BY_ZERO):1-zee((Tte(r)-t)/(n/Math.sqrt(i)),0,1)}))}ftest(e,t){return this.runFunction(e.args,t,this.metadata("F.TEST"),((e,t)=>{const n=this.arithmeticHelper.manyToExactNumbers(e.valuesFromTopLeftCorner()),r=this.arithmeticHelper.manyToExactNumbers(t.valuesFromTopLeftCorner());if(n instanceof g4)return n;if(r instanceof g4)return r;if(n.length<=1||r.length<=1)return new g4(X9.DIV_BY_ZERO);const i=Ate(n,!0),o=Ate(r,!0);if(0===i||0===o)return new g4(X9.DIV_BY_ZERO);const s=cte(i/o,n.length-1,r.length-1);return 2*Math.min(s,1-s)}))}steyx(e,t){return this.runFunction(e.args,t,this.metadata("STEYX"),((e,t)=>{if(e.numberOfElements()!==t.numberOfElements())return new g4(X9.NA,W2.EqualLength);const n=Xte(e,t);if(n instanceof g4)return n;const r=n[0].length;return r<=2?new g4(X9.DIV_BY_ZERO,W2.ThreeValues):Math.sqrt((Nte(n[0])-Math.pow(Ite(n[0],n[1])*(r-1),2)/Nte(n[1]))/(r-2))}))}slope(e,t){return this.runFunction(e.args,t,this.metadata("SLOPE"),((e,t)=>{if(e.numberOfElements()!==t.numberOfElements())return new g4(X9.NA,W2.EqualLength);const n=Xte(e,t);if(n instanceof g4)return n;const r=n[0].length;return r<=1?new g4(X9.DIV_BY_ZERO,W2.TwoValues):Ite(n[0],n[1])*(r-1)/Nte(n[1])}))}chisqtest(e,t){return this.runFunction(e.args,t,this.metadata("CHISQ.TEST"),((e,t)=>{const n=e.height(),r=e.width();if(t.height()!==n||t.width()!==r)return new g4(X9.NA,W2.EqualLength);const i=Xte(e,t);if(i instanceof g4)return i;if(i[0].length<=1)return new g4(X9.DIV_BY_ZERO,W2.TwoValues);let o=0;for(let s=0;s<i[0].length;s++){if(0===i[1][s])return new g4(X9.DIV_BY_ZERO);o+=Math.pow(i[0][s]-i[1][s],2)/i[1][s]}return o<0?new g4(X9.NUM,W2.NaN):1-lte(o,n>1&&r>1?(n-1)*(r-1):n*r-1)}))}ttest(e,t){return this.runFunction(e.args,t,this.metadata("T.TEST"),((e,t,n,r)=>{const i=this.arithmeticHelper.manyToExactNumbers(e.valuesFromTopLeftCorner()),o=this.arithmeticHelper.manyToExactNumbers(t.valuesFromTopLeftCorner());if(i instanceof g4)return i;if(o instanceof g4)return o;const s=i.length,a=o.length;if(1===r){if(a!==s)return new g4(X9.NA,W2.EqualLength);if(s<=1)return new g4(X9.DIV_BY_ZERO,W2.TwoValues);const e=Array(s);for(let n=0;n<s;n++)e[n]=i[n]-o[n];const t=Mte(e,!0);if(0===t)return new g4(X9.DIV_BY_ZERO);const r=Math.abs(Math.sqrt(s)*Tte(e)/t);return n*(1-yte(r,s-1))}if(2===r){if(s<=1||a<=1)return new g4(X9.DIV_BY_ZERO,W2.TwoValues);const e=(Nte(i)+Nte(o))/(s+a-2);if(0===e)return new g4(X9.DIV_BY_ZERO);const t=Math.abs((Tte(i)-Tte(o))/Math.sqrt(e*(1/s+1/a)));return n*(1-yte(t,s+a-2))}{if(s<=1||a<=1)return new g4(X9.DIV_BY_ZERO,W2.TwoValues);const e=Ate(i,!0),t=Ate(o,!0);if(0===e&&0===t)return new g4(X9.DIV_BY_ZERO);const r=Math.abs((Tte(i)-Tte(o))/Math.sqrt(e/s+t/a)),l=Math.pow(e/s+t/a,2)/(Math.pow(e/s,2)/(s-1)+Math.pow(t/a,2)/(a-1));return n*(1-yte(r,l))}}))}skew(e,t){return this.runFunction(e.args,t,this.metadata("SKEW"),((...e)=>{const t=this.arithmeticHelper.coerceNumbersExactRanges(e);if(t instanceof g4)return t;const n=t.length;if(n<3)return new g4(X9.DIV_BY_ZERO,W2.ThreeValues);const r=Tte(t),i=Mte(t,!0);return 0===i?new g4(X9.DIV_BY_ZERO):t.reduce(((e,t)=>e+Math.pow((t-r)/i,3)),0)*n/(n-1)/(n-2)}))}skewp(e,t){return this.runFunction(e.args,t,this.metadata("SKEW.P"),((...e)=>{const t=this.arithmeticHelper.coerceNumbersExactRanges(e);if(t instanceof g4)return t;const n=t.length;if(n<3)return new g4(X9.DIV_BY_ZERO,W2.ThreeValues);const r=Tte(t),i=Mte(t,!1);return 0===i?new g4(X9.DIV_BY_ZERO):t.reduce(((e,t)=>e+Math.pow((t-r)/i,3)),0)/n}))}}function Xte(e,t){const n=e.iterateValuesFromTopLeftCorner(),r=t.iterateValuesFromTopLeftCorner();let i,o;const s=[],a=[];for(;i=n.next(),o=r.next(),!i.done&&!o.done;){const e=i.value,t=o.value;if(e instanceof g4)return e;if(t instanceof g4)return t;W3(e)&&W3(t)&&(s.push(L3(e)),a.push(L3(t)))}return[s,a]}
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */Kte.implementedFunctions={AVEDEV:{method:"avedev",parameters:[{argumentType:Z4.ANY}],repeatLastArgs:1},DEVSQ:{method:"devsq",parameters:[{argumentType:Z4.ANY}],repeatLastArgs:1},GEOMEAN:{method:"geomean",parameters:[{argumentType:Z4.ANY}],repeatLastArgs:1},HARMEAN:{method:"harmean",parameters:[{argumentType:Z4.ANY}],repeatLastArgs:1},CORREL:{method:"correl",parameters:[{argumentType:Z4.RANGE},{argumentType:Z4.RANGE}]},RSQ:{method:"rsq",parameters:[{argumentType:Z4.RANGE},{argumentType:Z4.RANGE}]},"COVARIANCE.P":{method:"covariancep",parameters:[{argumentType:Z4.RANGE},{argumentType:Z4.RANGE}]},"COVARIANCE.S":{method:"covariances",parameters:[{argumentType:Z4.RANGE},{argumentType:Z4.RANGE}]},"Z.TEST":{method:"ztest",parameters:[{argumentType:Z4.RANGE},{argumentType:Z4.NUMBER},{argumentType:Z4.NUMBER,optionalArg:!0}]},"F.TEST":{method:"ftest",parameters:[{argumentType:Z4.RANGE},{argumentType:Z4.RANGE}]},STEYX:{method:"steyx",parameters:[{argumentType:Z4.RANGE},{argumentType:Z4.RANGE}]},SLOPE:{method:"slope",parameters:[{argumentType:Z4.RANGE},{argumentType:Z4.RANGE}]},"CHISQ.TEST":{method:"chisqtest",parameters:[{argumentType:Z4.RANGE},{argumentType:Z4.RANGE}]},"T.TEST":{method:"ttest",parameters:[{argumentType:Z4.RANGE},{argumentType:Z4.RANGE},{argumentType:Z4.INTEGER,minValue:1,maxValue:2},{argumentType:Z4.INTEGER,minValue:1,maxValue:3}]},SKEW:{method:"skew",parameters:[{argumentType:Z4.ANY}],repeatLastArgs:1},"SKEW.P":{method:"skewp",parameters:[{argumentType:Z4.ANY}],repeatLastArgs:1}},Kte.aliases={COVAR:"COVARIANCE.P",FTEST:"F.TEST",PEARSON:"CORREL",ZTEST:"Z.TEST",CHITEST:"CHISQ.TEST",TTEST:"T.TEST",COVARIANCEP:"COVARIANCE.P",COVARIANCES:"COVARIANCE.S",SKEWP:"SKEW.P"};const qte=Object.freeze(Object.defineProperty({__proto__:null,AbsPlugin:B8,AddressPlugin:V8,ArrayPlugin:U8,BitShiftPlugin:W8,BitwiseLogicOperationsPlugin:$8,BooleanPlugin:Y8,CharPlugin:K8,CodePlugin:X8,ComplexPlugin:kte,ConditionalAggregationPlugin:tee,CountBlankPlugin:q8,CountUniquePlugin:Q8,DateTimePlugin:Z8,DegreesPlugin:r7,DeltaPlugin:i7,ExpPlugin:o7,FinancialPlugin:s7,FormulaTextPlugin:d7,HyperlinkPlugin:p7,InformationPlugin:g7,IsEvenPlugin:m7,IsOddPlugin:f7,LogarithmPlugin:w7,LookupPlugin:see,MathConstantsPlugin:v7,MathPlugin:Pte,MatrixPlugin:R7,MedianPlugin:E7,ModuloPlugin:b7,NumericAggregationPlugin:A7,PowerPlugin:O7,RadiansPlugin:x7,RadixConversionPlugin:_7,RandomPlugin:U7,RomanPlugin:aee,RoundingPlugin:j7,SimpleArithmerticPlugin:uee,SqrtPlugin:G7,StatisticalAggregationPlugin:Kte,StatisticalPlugin:xte,SumprodPlugin:nee,TextPlugin:ree,TrigonometryPlugin:iee},Symbol.toStringTag,{value:"Module"}));
/**
 * @license
 * Copyright (c) 2025 Handsoncode. All rights reserved.
 */class Qte extends _8{}Qte.HyperFormula=_8,Qte.ErrorType=X9,Qte.CellError=g4,Qte.CellType=q9,Qte.CellValueType=l4,Qte.CellValueDetailedType=h4,Qte.DetailedCellError=n5,Qte.ExportedCellChange=Z6,Qte.ExportedNamedExpressionChange=J6,Qte.ConfigValueTooBigError=w9,Qte.ConfigValueTooSmallError=f9,Qte.EvaluationSuspendedError=v9,Qte.ExpectedOneOfValuesError=y9,Qte.ExpectedValueOfTypeError=g9,Qte.ArraySize=e5,Qte.SimpleRangeValue=$3,Qte.EmptyValue=_3,Qte.FunctionPlugin=J4,Qte.FunctionArgumentType=Z4,Qte.FunctionPluginValidationError=b9,Qte.InvalidAddressError=r9,Qte.InvalidArgumentsError=i9,Qte.LanguageNotRegisteredError=R9,Qte.LanguageAlreadyRegisteredError=E9,Qte.MissingTranslationError=C9,Qte.NamedExpressionDoesNotExistError=l9,Qte.NamedExpressionNameIsAlreadyTakenError=s9,Qte.NamedExpressionNameIsInvalidError=a9,Qte.NoOperationToRedoError=u9,Qte.NoOperationToUndoError=h9,Qte.NoRelativeAddressesAllowedError=M9,Qte.NoSheetWithIdError=Z3,Qte.NoSheetWithNameError=J3,Qte.NotAFormulaError=n9,Qte.NothingToPasteError=c9,Qte.ProtectedFunctionTranslationError=S9,Qte.SheetNameAlreadyTakenError=e9,Qte.SheetSizeLimitExceededError=t9,Qte.SourceLocationHasArrayError=N9,Qte.TargetLocationHasArrayError=A9,Qte.UnableToParseError=p9;const Zte=H8.defaultConfig.language;_8.registerLanguage(Zte,F8),_8.languages[F8.langCode]=F8;for(const cne of Object.getOwnPropertyNames(qte))cne.startsWith("_")||_8.registerFunctionPlugin(qte[cne]);const Jte=e=>(C("data-v-3b82a8f2"),e=e(),S(),e),ene={class:"modal-form full-screen columns is-multiline"},tne={class:"column is-4"},nne=Jte((()=>c("div",{class:"column is-4"},null,-1))),rne={class:"column is-4 justify-right"},ine={class:"is-flex"},one=Jte((()=>c("i",{class:"lnir lnir-cloud-download","aria-hidden":"true"},null,-1))),sne=Jte((()=>c("i",{class:"lnir lnir-trash","aria-hidden":"true"},null,-1))),ane=Jte((()=>c("i",{class:"lnir lnir-close","aria-hidden":"true"},null,-1))),lne={class:"column is-12"},hne=n({__name:"ExcelFileEditor",props:{excelFileModal:{type:Boolean},fileId:{},objectId:{},getLeadsList:{type:Boolean},isTemplate:{type:Boolean}},emits:["update:modalHandler","update:OnSuccess"],setup(t,{emit:n}){const r=t;hy(dk);const s=a(null);_8.buildEmpty({licenseKey:"internal-use-in-handsontable"}),l();const C=A(),S=N(),R=a(!1);xQ(),a(!1);const M=a([[""]]),I=a({id:"",title:"Enter Title",data:Array.from({length:80},(()=>Array(50).fill("")))}),O=()=>{n("update:modalHandler",!1)},x=()=>{n("update:OnSuccess",null)},P=a({data:[],formulas:{engine:_8},plugins:{contextMenu:!0},fixedRowsBottom:2,stretchH:"all",autoWrapRow:!0,autoWrapCol:!0,licenseKey:"non-commercial-and-evaluation",colHeaders:!0,rowHeaders:!0,width:"100%",height:800,minRows:50,minCols:50,rowHeights:30,colWidths:120,manualColumnResize:!0,manualRowResize:!0,columnSorting:!0,filters:!0,dropdownMenu:!0,contextMenu:!0});a([]);const _=async()=>{try{if(R.value=!0,r.fileId||I.value.id){const e=await S.patch(`/api/excel-files/${r.fileId?r.fileId:I.value.id}/`,{is_template:!1,title:I.value.title,object:r.objectId??"",sheet_data:JSON.stringify(M.value)});I.value.id=e.data.id,C.success("Sheet updated successfully!")}else{const e=await S.post("/api/excel-files/",{title:I.value.title,object:r.objectId??"",sheet_data:JSON.stringify(M.value)});I.value.id=e.data.id,C.success("Sheet created successfully!")}x()}catch(xm){console.error(xm),C.error("Failed to save sheet.")}finally{R.value=!1}},L=()=>{r.fileId||I.value.id?_():H()},H=async()=>{try{const e=await S.post("/api/excel-files/create-template/",{is_template:!0,title:I.value.title,sheet_data:JSON.stringify(M.value)});I.value.id=e.data.id,x(),C.success("Template saved successfully!")}catch(xm){console.error(xm),C.error("Failed to save sheet.")}},k=a([]);h((()=>{u((()=>{s.value||console.error("hotTable is undefined")}))}));return h((async()=>{r.fileId&&await(async()=>{try{const e=await S.get(`/api/excel-files/${r.fileId}/`);let t=e.data.sheet_data,n="string"==typeof t?JSON.parse(t):t;console.log("Parsed Data:",n),Array.isArray(n)||(console.error("Invalid data format: Expected an array"),n=[]),n=n.map((e=>Array.isArray(e)?e.map((e=>null===e?"":e)):"object"==typeof e&&null!==e?Object.values(e).map((e=>null===e?"":e)):[e])),console.log("Fixed Data:",n),M.value=n,I.value.title=e.data.title,I.value.id=e.data.id,await u(),s.value?.hotInstance&&(s.value.hotInstance.loadData(M.value),s.value.hotInstance.render())}catch(xm){console.log("Error fetching sheet:",xm)}})(),(async()=>{try{const e=await S.get("/api/excel-files/templates/",{});k.value=e.data}catch(xm){console.error(xm),C.error("Failed to save sheet.")}})()})),(t,n)=>{const a=T,l=b,h=E,u=v,N=e;return i(),o("div",ene,[c("div",tne,[d(h,null,{default:p((()=>[d(l,null,{default:p((()=>[d(a,{modelValue:I.value.title,"onUpdate:modelValue":n[0]||(n[0]=e=>I.value.title=e),type:"text",placeholder:"title"},null,8,["modelValue"])])),_:1})])),_:1})]),nne,c("div",rne,[c("div",ine,[r.isTemplate?w("",!0):(i(),g(u,{key:0,loading:R.value,onClick:_,color:"primary",raised:"",class:"mr-2"},{default:p((()=>[m(f(r.fileId||I.value.id?"Update":"Save"),1)])),_:1},8,["loading"])),r.isTemplate?(i(),g(u,{key:1,loading:R.value,onClick:L,color:"success",raised:"",outlined:"",class:"mr-2",light:""},{default:p((()=>[m(f(I.value.id?"Update":"Create")+" Template",1)])),_:1},8,["loading"])):w("",!0),d(N,{bordered:"",onClick:n[1]||(n[1]=e=>(async()=>{try{const e=await S.get(`/api/excel-files/${r.fileId?r.fileId:I.value.id}/download/`,{responseType:"blob"}),t=new Blob([e.data],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),n=window.URL.createObjectURL(t),i=document.createElement("a");i.href=n,i.download=`${I.value.title}.xlsx`,document.body.appendChild(i),i.click(),document.body.removeChild(i),window.URL.revokeObjectURL(n),C.success("File downloaded successfully!")}catch(xm){console.error("Download Error:",xm),C.error("Failed to download the sheet.")}})()),loading:"",class:"cu-pointer",color:"info"},{default:p((()=>[one])),_:1}),d(N,{bordered:"",onClick:n[2]||(n[2]=e=>(async e=>{try{await S.delete(`/api/excel-files/${e}/`),C.success("Sheet deleted successfully!"),O()}catch(xm){console.error(xm),C.error("Failed to delete sheet.")}})(I.value.id)),class:"cu-pointer ml-2",color:"danger"},{default:p((()=>[sne])),_:1}),d(N,{onClick:n[3]||(n[3]=e=>O()),class:"cu-pointer ml-2",bordered:"",color:"warning"},{default:p((()=>[ane])),_:1})])]),c("div",lne,[d(y(BM),{ref_key:"hotTable",ref:s,settings:P.value,data:M.value,ContextMenu:!0},null,8,["settings","data"])])])}}}),une=R(hne,[["__scopeId","data-v-3b82a8f2"]]);export{une as _};
