import{_ as e}from"./VModal.vue_vue_type_style_index_0_lang-1861774f.js";import{_ as l}from"./VField.vue_vue_type_script_setup_true_lang-e2da83de.js";import{_ as a}from"./VInput.vue_vue_type_script_setup_true_lang-9a7e2cd6.js";import{_ as t}from"./VLabel.vue_vue_type_script_setup_true_lang-eaed6c2f.js";import{_ as s}from"./ExcelFileEditor-9ee5b342.js";import{_ as o}from"./VIconWrap.vue_vue_type_style_index_0_lang-8ead6be1.js";import{_ as i}from"./VControl-f34f1e3a.js";import{f as n,b as r,r as u,w as c,$ as d,o as p,C as m,O as _,D as v,E as f,F as y,G as g,K as h,L as x,X as k,V as b,W as C,m as w,N as j,U as I,J as T,P as V,al as A,Q as S,R as P,S as M,x as O,y as U,k as L,aS as E,A as F,I as $,H as D}from"./index-db92e92b.js";import{_ as H}from"./PlaceloadV4.vue_vue_type_style_index_0_lang-96e4067f.js";import{u as B}from"./useAPI-b96299b1.js";import{u as K}from"./useNotyf-0657d34f.js";import{f as R,a as N,d as W,i as z}from"./useSupportElement-98fc05de.js";import{c as Y,b as G}from"./CreateProposalTasksModal-29166d92.js";import{_ as J,c as Q}from"./VFlexTable.vue_vue_type_style_index_0_lang-12b6857f.js";import{_ as q,a as X,b as Z}from"./ProposalViewModal.vue_vue_type_style_index_0_lang-5a12e760.js";import{_ as ee}from"./SweetAlert.vue_vue_type_style_index_0_lang-d617e579.js";import{_ as le}from"./VFlexPagination.vue_vue_type_script_setup_true_lang-5c56b8df.js";import{_ as ae}from"./VPlaceholderPage.vue_vue_type_style_index_0_lang-c2cd0065.js";import{_ as te}from"./VDropdown.vue_vue_type_style_index_0_lang-b11bb0cb.js";import{_ as se}from"./VTag.vue_vue_type_style_index_0_lang-0bbd48d5.js";import{_ as oe}from"./PlaceloadV1.vue_vue_type_style_index_0_lang-afa14ae4.js";import{_ as ie,a as ne}from"./search-4-dark-2b5b440c.js";import{u as re}from"./viewWrapper-bb4c1db1.js";import"./useVFieldContext-4097fc94.js";import"./VIconBox.vue_vue_type_style_index_0_lang-0991834b.js";import"./moment-bad41465.js";import"./via-placeholder-24645670.js";import"./VPlaceloadText.vue_vue_type_style_index_0_lang-6cea5977.js";import"./VPlaceloadAvatar.vue_vue_type_style_index_0_lang-122a7f66.js";import"./notyf-933c54f3.js";import"./useThemeColors-a19855f3.js";import"./UnitAddUpdateModal.vue_vue_type_script_setup_true_lang-7abfda95.js";import"./VTextarea.vue_vue_type_script_setup_true_lang-72857f7d.js";import"./VCheckbox.vue_vue_type_style_index_0_lang-2ad0417f.js";import"./VOption.vue_vue_type_style_index_0_lang-92d05902.js";import"./costItems-3f395575.js";import"./VIconButton-bac9b6aa.js";import"./company-5c9aa98b.js";import"./VRadio.vue_vue_type_style_index_0_lang-71234493.js";import"./V-Snack.vue_vue_type_style_index_0_lang-7046c856.js";import"./VIcon.vue_vue_type_script_setup_true_lang-6c9fe809.js";import"./VAvatar.vue_vue_type_style_index_0_lang-efe5b2bd.js";import"./VFlex.vue_vue_type_style_index_0_lang-dcfc43e4.js";import"./useDropdown-0612459f.js";import"./VPlaceloadWrap-07816aa6.js";const ue={key:1,class:"columns is-multiline"},ce={class:"column is-12"},de={class:"columns is-multiline"},pe={class:"list-flex-toolbar is-reversed column is-12"},me={class:"card p-4 curved is-flex space-between"},_e={class:"subtitle is-5 m-0"},ve={class:"content"},fe={class:"is-flex"},ye={class:"modal-form columns is-multiline"},ge={class:"file has-name"},he={class:"file-label"},xe=(e=>(S("data-v-09397dde"),e=e(),P(),e))((()=>f("span",{class:"file-cta"},[f("span",{class:"file-icon"},[f("i",{class:"fas fa-cloud-upload-alt"})]),f("span",{class:"file-label"}," Choose a fileâ€¦ ")],-1))),ke={class:"file-name light-text"},be=M(n({__name:"CalculationsTemplates",props:{fetchAll:{},fetchTemplates:{},userId:{},objectId:{}},setup(n){const S=n,P=r(),M=B(),O=K(),U=u(!1),L=u([]),E=u([]),F=u(""),$=u(!1),D=u(""),W=u(!1),z=u(0),Y=u({file:"",title:"",user_id:P.user.id,object_id:S.objectId}),G=e=>{let l=e.target.files[0];Y.value.file=l,D.value=l.name,Y.value.title=l.name},J=u(""),Q=u([{value:"",name:""}]),q=async()=>{try{U.value=!0;const e=await M.get("/api/excel-files/");L.value=e.data}catch(e){console.error(e)}finally{U.value=!1}},X=async()=>{try{U.value=!0;const e=await M.get("/api/excel-files/templates/");E.value=e.data,Q.value=E.value.map((e=>({value:e.id,name:e.title})))}catch(e){console.error(e)}finally{U.value=!1}},Z=(e="")=>{z.value=e,W.value=!0},ee=u(!1),le=async()=>{try{ee.value=!0;const e=N(Y.value,[""]);await M.post("/api/excel-files/upload-excel/",e);q(),O.success("Sheet uploaded successfully")}catch(e){console.error(e)}finally{ee.value=!1,$.value=!1}};c((()=>J.value),(e=>{e&&(async e=>{try{ee.value=!0,await M.post(`/api/excel-files/create-from-template/${e}/`),O.success("Sheet create successfully"),q()}catch(l){console.error(l)}finally{ee.value=!1,$.value=!1}})(e)}));const ae=d((()=>{if(F.value){const e=new RegExp(F.value,"i");return E.value.filter((l=>l.title?.match(e)))}return E.value}));return p((async()=>{X()})),(n,r)=>{const u=H,c=V,d=A,p=i,S=o,P=s,L=t,E=a,B=l,K=e;return U.value?(m(),_(u,{key:0})):(m(),v("div",ue,[f("div",ce,[f("div",de,[f("div",pe,[y(d,null,{default:g((()=>[y(c,{icon:"fas fa-plus",color:"info",outlined:"",light:"",class:"ml-2",raised:"",onClick:r[0]||(r[0]=e=>Z())},{default:g((()=>[h("Template")])),_:1}),y(c,{icon:"fas fa-upload",raised:"",light:"",onClick:r[1]||(r[1]=e=>$.value=!$.value),outlined:"",color:"primary"},{default:g((()=>[h(" File ")])),_:1})])),_:1}),f("div",null,[y(p,{class:"mr-2 h-hidden-mobile",icon:"feather:search"},{default:g((()=>[x(f("input",{"onUpdate:modelValue":r[2]||(r[2]=e=>F.value=e),class:"input custom-text-filter",placeholder:"Search..."},null,512),[[k,F.value]])])),_:1})])]),(m(!0),v(b,null,C(w(ae),((e,l)=>(m(),v("div",{class:"column is-6",key:e.id},[f("div",me,[f("div",null,[f("h4",_e,I(e.title),1),f("div",ve,[f("p",null,I(w(R)(e.created_at)),1)])]),f("div",fe,[y(S,{icon:"lucide:pen",color:"info",class:"cu-pointer",onClick:l=>Z(e.id),"has-background":""},null,8,["onClick"]),y(S,{onClick:l=>(async e=>{try{await M.delete(`/api/excel-files/${e}/`),O.success("Sheet deleted successfully!"),X()}catch(l){console.error(l),O.error("Failed to delete sheet.")}})(e.id),icon:"lucide:trash",color:"danger","has-background":"",class:"cu-pointer ml-1"},null,8,["onClick"])])])])))),128))])]),W.value?(m(),_(P,{key:0,class:"fullscreen","excel-file-modal":W.value,fileId:z.value,isTemplate:!0,"onUpdate:modalHandler":r[3]||(r[3]=e=>{X(),W.value=!1})},null,8,["excel-file-modal","fileId"])):j("",!0),y(K,{is:"form",open:$.value,title:"Upload Task File",size:"medium",actions:"right",onClose:r[6]||(r[6]=e=>$.value=!1),onSubmit:T(le,["prevent"])},{content:g((()=>[f("div",ye,[y(B,{class:"column is-12"},{default:g((()=>[y(L,null,{default:g((()=>[h("File Title")])),_:1}),y(p,null,{default:g((()=>[y(E,{modelValue:Y.value.title,"onUpdate:modelValue":r[4]||(r[4]=e=>Y.value.title=e),type:"text"},null,8,["modelValue"])])),_:1})])),_:1}),y(B,{class:"column is-12",grouped:""},{default:g((()=>[y(p,null,{default:g((()=>[f("div",ge,[f("label",he,[f("input",{onChange:G,class:"file-input",type:"file",name:"file",required:""},null,32),xe,f("span",ke,I(D.value?D.value:"Upload any file"),1)])])])),_:1})])),_:1})])])),cancel:g((()=>[y(c,{onClick:r[5]||(r[5]=e=>$.value=!1),raised:""},{default:g((()=>[h("Close")])),_:1})])),action:g((()=>[y(c,{type:"submit",color:"primary",raised:""},{default:g((()=>[h("Upload")])),_:1})])),_:1},8,["open","onSubmit"])]))}}}),[["__scopeId","data-v-09397dde"]]),Ce={class:"is-flex",style:{"justify-content":"end"}},we={class:"item-name dark-inverted"},je={class:"light-text"},Ie={class:"light-text"},Te={class:"light-text"},Ve=n({__name:"CataLogList",setup(e){O(),U();const l=B();K();const a=u(""),t=u([]);u([]);const s=u(!1),o=u(""),n=u(0),r=u(""),c=u("catalog"),T=[{label:"Title",key:"title"},{label:"Unit",key:"unit"},{label:"Total Price",key:"total_price"},{label:"Cost Type",key:"cost_type"},{label:"Actions",key:"actions"}],A=async()=>{try{const e=await l.get("/api/cost/catalogs/");t.value=e.data}catch(e){console.error("Error fetching catalogs:",e)}},S=d((()=>t.value.filter((e=>e.title.toLowerCase().includes(a.value.toLowerCase())))));return p(A),(e,u)=>{const d=i,p=Q,P=V,M=J,O=Y;return m(),v(b,null,[f("div",Ce,[y(d,{icon:"feather:search"},{default:g((()=>[x(f("input",{"onUpdate:modelValue":u[0]||(u[0]=e=>L(a)?a.value=e:null),class:"input custom-text-filter",placeholder:"Search..."},null,512),[[k,w(a)]])])),_:1})]),w(S).length>0?(m(),_(M,{key:0,class:"mt-5",data:w(S),columns:T,rounded:""},{body:g((()=>[y(E,{name:"list",tag:"div",class:"flex-list-inner"},{default:g((()=>[(m(!0),v(b,null,C(w(S),(e=>(m(),v("div",{key:e.id,class:"flex-table-item"},[y(p,{column:{media:!0,grow:!1},class:"cu-pointer"},{default:g((()=>[f("div",null,[f("span",we,I(e.title),1)])])),_:2},1024),y(p,null,{default:g((()=>[f("span",je,I(e.unit),1)])),_:2},1024),y(p,null,{default:g((()=>[f("span",Ie,I(e.total_price),1)])),_:2},1024),y(p,null,{default:g((()=>[f("span",Te,I(e.cost_type),1)])),_:2},1024),y(p,null,{default:g((()=>[y(P,{color:"primary",size:"medium",light:"",onClick:l=>{return a=e,r.value=a.id,o.value=a.proposal,void(s.value=!s.value);var a},icon:"fas fa-pen"},{default:g((()=>[h("Edit")])),_:2},1032,["onClick"]),y(P,{class:"ml-2",color:"danger",size:"medium",light:"",onClick:a=>(async e=>{try{await l.delete(`/api/cost/${e}/`),t.value=t.value.filter((l=>l.id!==e))}catch(a){console.error("Error deleting catalog:",a)}})(e.id),icon:"fas fa-trash-alt"},{default:g((()=>[h("Delete")])),_:2},1032,["onClick"])])),_:2},1024)])))),128))])),_:1})])),_:1},8,["data"])):j("",!0),w(s)?(m(),_(O,{key:1,costItemModal:w(s),proposalId:w(o),costItemId:w(r),previousItemIndex:w(n),costMode:w(c),"onUpdate:modalHandler":u[1]||(u[1]=e=>{s.value=!1,r.value=""}),"onUpdate:OnSuccess":A},null,8,["costItemModal","proposalId","costItemId","previousItemIndex","costMode"])):j("",!0)],64)}}}),Ae={class:"flex-toolbar is-reversed is-flex space-between my-4"},Se={key:0},Pe={key:1,class:"flex-list-wrapper flex-list-v2"},Me={class:"item-name dark-inverted"},Oe={class:"item-meta"},Ue=["innerHTML"],Le={class:"light-text"},Ee={class:"item-name dark-inverted"},Fe={class:"light-text"},$e={class:"item-name dark-inverted"},De={class:"light-text"},He=["onClick"],Be=[f("div",{class:"icon"},[f("i",{"aria-hidden":"true",class:"lnil lnil-pencil"})],-1),f("div",{class:"meta"},[f("span",null,"Edit"),f("span",null,"Edit Proposal Details")],-1)],Ke=["onClick"],Re=[f("div",{class:"icon"},[f("i",{"aria-hidden":"true",class:"lnil lnil-eye"})],-1),f("div",{class:"meta"},[f("span",null,"Preview"),f("span",null,"Preview proposal detail")],-1)],Ne=f("hr",{class:"dropdown-divider"},null,-1),We=["onClick"],ze=[f("div",{class:"icon"},[f("i",{class:"lnir lnir-round-box-check","aria-hidden":"true"})],-1),f("div",{class:"meta"},[f("span",null,"Mark Approved"),f("span",null,"Mark Proposal As Approved")],-1)],Ye=["onClick"],Ge=[f("div",{class:"icon"},[f("i",{"aria-hidden":"true",class:"lnil lnil-trash-can-alt"})],-1),f("div",{class:"meta"},[f("span",null,"Delete"),f("span",null,"Delete from list")],-1)],Je=f("img",{class:"light-image",src:ie,alt:""},null,-1),Qe=f("img",{class:"dark-image",src:ne,alt:""},null,-1),qe=n({__name:"TemplatePropsalsList",props:{activeTab:{default:"active"},leadId:{default:""},allProposal:{type:Boolean,default:!1}},setup(e){const l=e,a=O();U();const t=B(),s=K(),o=u(!1),n=u([]),r=u(!1),c=u(""),T=u(!1),A=u(!1),S=u(""),P=u("");u(l.activeTab);const M=u({title:"",subtitle:"test",isSweetAlertOpen:!1,btntext:"text"}),F=u({title:"",subtitle:"",isSweetAlertOpen:!1,btntext:""}),$=async()=>{try{o.value=!0;await t.delete(`/api/lead-proposal/${P.value}/`);s.success("Proposal delete successfully"),ue()}catch(e){s.error(` ${e}, Proposal`),s.error("Something went wrong please try later")}finally{o.value=!1,M.value.isSweetAlertOpen=!1}},D={picture:{label:"Proposal",grow:!0,media:!0},deadline:"Cost Items",amount:{label:"Total Amount",media:!0},customer:"Created At",actions:{label:"Actions",align:"end"}},H=d((()=>{if(S.value){const e=new RegExp(S.value,"i");return n.value.filter((l=>l.title.match(e)||l.approval_deadline.match(e)))}return n.value})),R=u(!1),N=u(!1),ie=u(!1),ne=u(""),re=e=>{a.push(`/sidebar/dashboard/proposals/${e}`)},ue=()=>{(async()=>{try{o.value=!0;const e=await t.get("/api/lead-proposal/templates/");n.value=e.data}catch(e){s.error(` ${e}, Lead`)}finally{o.value=!1}})()};return p((()=>{ue()})),(e,a)=>{const u=i,d=V,p=oe,O=Q,U=se,B=te,K=J,ce=ae,de=le,pe=G,me=q,_e=X,ve=Y,fe=ee,ye=Z;return m(),v("div",null,[f("div",Ae,[y(u,{icon:"feather:search"},{default:g((()=>[x(f("input",{"onUpdate:modelValue":a[0]||(a[0]=e=>L(S)?S.value=e:null),class:"input custom-text-filter",placeholder:"Search..."},null,512),[[k,w(S)]])])),_:1}),f("div",null,[y(d,{color:"primary",onClick:a[1]||(a[1]=e=>r.value=!w(r)),icon:"fas fa-plus"},{default:g((()=>[h("Template ")])),_:1})])]),w(o)?(m(),v("div",Se,[y(p)])):(m(),v("div",Pe,[w(H).length>0&&w(n).length>0?(m(),_(K,{key:0,data:w(H),columns:D,rounded:""},{body:g((()=>[y(E,{name:"list",tag:"div",class:"flex-list-inner"},{default:g((()=>[(m(!0),v(b,null,C(w(H),(e=>(m(),v("div",{key:e.id,class:"flex-table-item"},[y(O,{column:{media:!0,grow:!0},class:"cu-pointer",onClick:l=>re(e.id)},{default:g((()=>[f("div",null,[f("span",Me,I(e.title),1),f("span",Oe,[f("span",{innerHTML:e.introductory_text},null,8,Ue)])])])),_:2},1032,["onClick"]),y(O,{class:"cu-pointer",onClick:l=>re(e.id)},{default:g((()=>[f("span",Le,I(),1),y(U,{rounded:"",color:"primary",label:e.cost_items},null,8,["label"])])),_:2},1032,["onClick"]),y(O,{class:"cu-pointer",onClick:l=>re(e.id),column:{media:!0}},{default:g((()=>[f("div",null,[f("span",Ee,"$"+I(e.proposalAmount),1),f("span",Fe,I(e.payment_status),1)])])),_:2},1032,["onClick"]),y(O,{column:{media:!0},class:"cu-pointer",onClick:l=>re(e.id)},{default:g((()=>[f("div",null,[f("span",$e,I(w(W)(e.created_at)),1),f("span",De,I(w(z)(e.created_at)),1)])])),_:2},1032,["onClick"]),y(O,{column:{align:"end"}},{default:g((()=>[y(B,{class:"is-pushed-mobile",icon:"feather:more-vertical",spaced:"",right:""},{content:g((()=>[f("a",{role:"menuitem",onClick:l=>{return a=e.id,c.value=a,void(r.value=!0);var a},class:"dropdown-item is-media"},Be,8,He),f("a",{disabled:"",role:"menuitem",onClick:l=>{return a=e.id,N.value=a,void(R.value=!R.value);var a},class:"dropdown-item is-media"},Re,8,Ke),Ne,f("a",{role:"menuitem",onClick:l=>(async(e,l)=>{try{await t.patch(`/api/lead-proposal/${l}/`,{status:e}),s.success(`You have ${e} this proposal.`),ue()}catch(a){console.log(a)}})("approved",e.id),class:"dropdown-item is-media"},ze,8,We),f("a",{role:"menuitem",onClick:l=>{return a=e.id,P.value=a,void(M.value={title:"Delete Proposal?",subtitle:"Are you sure to delete this proposal? After delete you will not be able to recover it again.",btntext:"Yes delete",isSweetAlertOpen:!0});var a},class:"dropdown-item is-media"},Ge,8,Ye)])),_:2},1024)])),_:2},1024)])))),128))])),_:1})])),_:1},8,["data"])):j("",!0),w(n).length<1&&0==w(H).length?(m(),_(ce,{key:1,title:"There is no proposal created on this lead!",subtitle:"Too bad. Looks like we couldn't created any proposal on this Lead, please create proposal and release to the client",larger:""},{image:g((()=>[Je,Qe])),_:1})):j("",!0),w(H).length>5?(m(),_(de,{key:2,"item-per-page":10,"total-items":873,"current-page":42,"max-links-displayed":7})):j("",!0)])),w(T)?(m(),_(pe,{key:2,createProposalTasksModal:w(T),proposalId:w(c),onCloseModalHandler:a[2]||(a[2]=e=>T.value=!1),"onUpdate:OnSuccess":ue},null,8,["createProposalTasksModal","proposalId"])):j("",!0),w(r)?(m(),_(me,{key:3,leadId:l.leadId,proposalId:w(c),createTemplate:!0,leadProposalModal:w(r),"onUpdate:modalHandler":a[3]||(a[3]=e=>{r.value=!1,ue()}),"onUpdate:OnSuccess":ue,onClearProposalId:a[4]||(a[4]=e=>c.value="")},null,8,["leadId","proposalId","leadProposalModal"])):j("",!0),w(R)?(m(),_(_e,{key:4,"preview-modal":w(R),proposalId:w(N),"onUpdate:modalHandler":a[5]||(a[5]=e=>R.value=!1)},null,8,["preview-modal","proposalId"])):j("",!0),w(ie)?(m(),_(ve,{key:5,costItemModal:w(ie),proposalId:w(ne),"onUpdate:modalHandler":a[6]||(a[6]=e=>ie.value=!1),"onUpdate:OnSuccess":ue},null,8,["costItemModal","proposalId"])):j("",!0),w(M).isSweetAlertOpen?(m(),_(fe,{key:6,isSweetAlertOpen:w(M).isSweetAlertOpen,title:w(M).title,subtitle:w(M).subtitle,btntext:w(M).btntext,onConfirm:$,onCancel:()=>w(M).isSweetAlertOpen=!1},null,8,["isSweetAlertOpen","title","subtitle","btntext","onCancel"])):j("",!0),w(F).isSweetAlertOpen?(m(),_(fe,{key:7,isSweetAlertOpen:w(F).isSweetAlertOpen,title:w(F).title,subtitle:w(F).subtitle,btntext:w(F).btntext,onConfirm:$,onCancel:()=>w(F).isSweetAlertOpen=!1},null,8,["isSweetAlertOpen","title","subtitle","btntext","onCancel"])):j("",!0),w(A)?(m(),_(ye,{key:8,leadProposalListModal:w(A),leadID:l.leadId,"group-proposal-modal":w(A),"onUpdate:modalHandler":a[7]||(a[7]=e=>A.value=!1)},null,8,["leadProposalListModal","leadID","group-proposal-modal"])):j("",!0)])}}}),Xe={class:"tabs-wrapper"},Ze={class:"tabs-inner"},el={class:"tabs"},ll=[f("span",null,"Proposal Templates",-1)],al=[f("span",null,"Cost Catalogs",-1)],tl=[f("span",null,"Calculations Template",-1)],sl={key:0,class:""},ol={key:1,class:""},il={key:2,class:""},nl=n({__name:"index",setup(e){const l=re(),a=u("proposalsTemplates");return l.setPageTitle("Templates & Catalogs"),F({title:"Templates & Catalogs - Ibex"}),(e,l)=>{const t=qe,s=Ve,o=be;return m(),v("div",null,[f("div",Xe,[f("div",Ze,[f("div",el,[f("ul",null,[f("li",{class:$(["proposalsTemplates"===w(a)?"is-active":"not-active"])},[f("a",{tabindex:"0",role:"button",onKeydown:l[0]||(l[0]=D(T((e=>a.value="proposalsTemplates"),["prevent"]),["space"])),onClick:l[1]||(l[1]=e=>a.value="proposalsTemplates")},ll,32)],2),f("li",{class:$(["catalog"===w(a)?"is-active":"not-active"])},[f("a",{tabindex:"0",role:"button",onKeydown:l[2]||(l[2]=D(T((e=>a.value="catalog"),["prevent"]),["space"])),onClick:l[3]||(l[3]=e=>a.value="catalog")},al,32)],2),f("li",{class:$(["calculations"===w(a)?"is-active":"not-active"])},[f("a",{tabindex:"0",role:"button",onKeydown:l[4]||(l[4]=D(T((e=>a.value="calculations"),["prevent"]),["space"])),onClick:l[5]||(l[5]=e=>a.value="calculations")},tl,32)],2)])])])]),"proposalsTemplates"===w(a)?(m(),v("div",sl,[y(t)])):j("",!0),"catalog"===w(a)?(m(),v("div",ol,[y(s)])):j("",!0),"calculations"===w(a)?(m(),v("div",il,[y(o)])):j("",!0)])}}});export{nl as default};
