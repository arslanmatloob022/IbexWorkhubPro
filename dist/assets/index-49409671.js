import{i as e,F as t}from"./index-f3193dbb.js";import{i as s}from"./index-1987827f.js";import{u as a}from"./userSession-a2fa2e58.js";import{u as o}from"./useNotyf-953388fb.js";import{u as r}from"./useAPI-bba6ff57.js";import{e as l,r as i,o as n,y as c,z as d,l as u,H as p,B as v,C as m,J as f,Q as _,R as h,P as g,L as b,A as y,af as j,ag as x,s as w,a9 as k,f as C,D as S,E as P,G as A,v as D}from"./index-879cc21e.js";import{u as I}from"./useThemeColors-9b3162c4.js";import{A as T}from"./vue3-apexcharts.common-e41d26dc.js";import{d as B}from"./apex-formatters-a02b3dab.js";import{_ as $}from"./VIcon.vue_vue_type_script_setup_true_lang-8eb8745d.js";import{_ as F}from"./VBlock.vue_vue_type_style_index_0_lang-83a39e8a.js";import{_ as L}from"./VIconBox.vue_vue_type_style_index_0_lang-665d47e6.js";import{u as O,a as z}from"./progressChart-52da3365.js";import{b as E}from"./useSupportElement-23fcf6e3.js";import{u as J}from"./viewWrapper-cd4cd6f9.js";import"./notyf-058d7186.js";import"./vue.runtime.esm-bundler-9944127c.js";import"./dayjs.min-4318f813.js";import"./billboard-95768f63.js";const M={style:{display:"flex","border-radius":"6px","flex-wrap":"wrap","align-items":"center","justify-content":"space-between"}},W={onClick:()=>{},style:{"font-weight":"500","margin-bottom":"0px","padding-left":"10px"}},N={class:"avatars"},V=["src"],Y={key:1,style:{width:"100%",height:"100%","background-color":"#292f3c",display:"flex","align-items":"center","justify-content":"center"}},G={class:"mb-0",style:{color:"white"}},H=b(l({__name:"ProjectsDashboardCalendar",setup(l){const b=r(),y=a(),j=o(),x=i(!1),w=i(!1),k=i("");i(!1),i("all"),i(""),i([]),i([]);const C=i([]),S=i({pending:"#8392ab",active:"#fbcf33",completed:"#82d616",canceled:"#344767"}),P=i({plugins:[e,s],schedulerLicenseKey:"0965592368-fcs-1694657447",initialView:"resourceTimelineMonth",height:"auto",resourceAreaWidth:"20%",selectable:!0,headerToolbar:{left:"today prev,next",center:"title",right:"resourceTimelineWeek,resourceTimelineMonth,resourceTimelineYear"},editable:!0,views:{resourceTimelineWeek:{slotDuration:{days:1,hours:1},slotLabelFormat:{weekday:"short",month:"numeric",day:"numeric",year:"numeric"}}},resourceAreaHeaderContent:"Projects",resources:[],eventClick:e=>{"manager"!==y.user.role||e.event.extendedProps.managers.some((e=>e.id===y.user.id))?(w.value=!0,k.value=e.event.id):j.success("You are not allowed to perform this action.")},eventDrop:e=>{let t=e.event.startStr,s=e.event.end.toISOString().substring(0,10);console.log("resource ids",e.event._def.resourceIds[0]),console.log(e.event.extendedProps.project),e.event.extendedProps.project===e.event._def.resourceIds[0]&&confirm(`Are you sure you want to update the project ${e.event.title} date from ${t} to ${s}?`)?D(e.event.id,t,s):e.revert()},eventResize:e=>{let t=e.event.startStr,s=e.event.end.toISOString().substring(0,10);console.log(e.event),confirm(`Are you sure you want to update the project ${e.event.title} date from ${t} to ${s}?`)?D(e.event.id,t,s):e.revert()}}),A=e=>{let t=new Date(e);return t.setDate(t.getDate()+1),t.toISOString().slice(0,10)},D=async(e,t,s)=>{try{let a=await b.patch(`/api/project/${e}/`,{startDate:t,endDate:s});console.log(a),j.success("Project updated successfully")}catch(a){j.error("Something went wrong"),console.log(a)}};return n((async()=>{await(async()=>{try{x.value=!0,console.log("inside all projects func");const e=await b.get("/api/project/",{});C.value=e.data,console.log("scratch projects",C.value),x.value=!1}catch(e){console.error(e),C.value=[],x.value=!1}})(),(()=>{console.log(C.value);const e=C.value.map((e=>({id:e.id,resourceId:e.id,project:e.id,start:e.startDate,end:A(e.endDate),title:e.title,description:e.description,total_tasks:e.total_tasks,managers:e.managers,borderColor:S[e.status]})));P.value.resources=C.value,P.value.events=e})(),console.log("projects",P.value)})),(e,s)=>(c(),d("div",null,[u(x)?g("",!0):(c(),p(u(t),{key:0,options:u(P)},{eventContent:v((e=>[m("div",M,[m("div",null,[m("span",W,f(e.event.title),1),m("span",null," -- tasks ("+f(e.event.extendedProps.total_tasks)+")",1)]),m("div",N,[(c(!0),d(_,null,h(e.event.extendedProps.managers,(e=>(c(),d("div",{class:"avatars__item",key:e.id},[e.avatar?(c(),d("img",{key:0,src:e.avatar,alt:""},null,8,V)):(c(),d("div",Y,[m("h6",G,f(e.username?e.username.slice(0,2):"AA"),1)]))])))),128))])])])),_:1},8,["options"]))]))}}),[["__scopeId","data-v-aa7f3ee8"]]),K={class:"s-card"},Q=l({__name:"ActiveProjectsChart",setup(e){const t=function(){const e=I(),t=w([]);return k((()=>{t.value=[{name:"Completion",data:[400,430,448,470,540,580,690,1100,1200,1380]}]})),C({type:"bar",height:280,series:t,options:{chart:{toolbar:{show:!1}},colors:[e.primary],plotOptions:{bar:{horizontal:!0}},title:{text:"Horizontal Bar",align:"left"},dataLabels:{enabled:!1},xaxis:{categories:["South Korea","Canada","United Kingdom","Netherlands","Italy","France","Japan","United States","China","Germany"]}}})}();return(e,s)=>(c(),d("div",K,[y(u(T),j(x(u(t))),null,16)]))}}),R={class:"s-card"},U=l({__name:"ProjectsCompletionChart",setup(e){const t=function(){const e=I(),t=w([]);return k((()=>{t.value=[{name:"Inflation",data:[2.3,3.1,4,10.1,4,3.6,3.2,2.3,1.4,.8,.5,.2]}]})),C({height:280,type:"bar",series:t,options:{chart:{toolbar:{show:!1}},plotOptions:{bar:{dataLabels:{position:"top"}}},dataLabels:{enabled:!0,formatter:B,offsetY:-20,style:{fontSize:"12px",colors:["#304758"]}},xaxis:{categories:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],position:"top",axisBorder:{show:!1},axisTicks:{show:!1},crosshairs:{fill:{type:"gradient",gradient:{colorFrom:"#D8E3F0",colorTo:"#BED1E6",stops:[0,100],opacityFrom:.4,opacityTo:.5}}},tooltip:{enabled:!0}},yaxis:{axisBorder:{show:!1},axisTicks:{show:!1},labels:{show:!1,formatter:B}},colors:[e.primary,e.secondary,e.orange],title:{text:"Bar Chart",align:"left"}}})}();return(e,s)=>(c(),d("div",R,[y(u(T),j(x(u(t))),null,16)]))}}),q={class:"personal-dashboard personal-dashboard-v3"},X={class:"columns is-multiline"},Z={class:"column is-12"},ee={class:"columns is-multiline is-flex-tablet-p"},te={class:"column is-12"},se={class:"stats-wrapper"},ae={class:"columns is-multiline is-flex-tablet-p"},oe={class:"column is-3"},re={class:"dashboard-card"},le=m("i",{class:"fas fa-cubes","aria-hidden":"true"},null,-1),ie={class:"column is-3"},ne={class:"dashboard-card"},ce=m("i",{class:"fas fa-boxes","aria-hidden":"true"},null,-1),de={class:"column is-3"},ue={class:"dashboard-card"},pe=m("i",{class:"fas fa-border-style","aria-hidden":"true"},null,-1),ve={class:"column is-3"},me={class:"dashboard-card"},fe=m("i",{class:"fas fa-dice-d6","aria-hidden":"true"},null,-1),_e={class:"column is-3"},he={class:"dashboard-card"},ge=m("i",{class:"fas fa-hospital-user","aria-hidden":"true"},null,-1),be={class:"column is-3"},ye={class:"dashboard-card"},je=m("i",{class:"fas fa-users","aria-hidden":"true"},null,-1),xe={class:"column is-3"},we={class:"dashboard-card"},ke=m("i",{class:"fas fa-user-tag","aria-hidden":"true"},null,-1),Ce={class:"column is-3"},Se={class:"dashboard-card"},Pe=m("i",{class:"fas fa-user-tie","aria-hidden":"true"},null,-1),Ae={class:"columns is-multiline"},De={class:"column is-6"},Ie={class:"column is-6"},Te={class:"column is-12"},Be=l({__name:"IbexDashboard",setup(e){O(),z();const t=r();I();const s=i(!1),a=i({all_project:0,active_projects:0,pending_projects:0,completed_projects:0,workers:0,managers:0,last_mail_sent:"",clients:0,contractors:0}),o=async()=>{try{s.value=!0;const e=await t.get("/api/project/dashboard/",{});a.value=e.data,s.value=!1}catch(e){console.log(e)}finally{s.value=!1}},l=()=>{try{s.value=!0;const e=t.post("/api/task/worker-mail/",{worker:"all"});console.log(e),o(),s.value=!1}catch(e){console.log(e)}};return n((()=>{o()})),(e,t)=>{const o=L,r=F,i=$,n=P,p=U,f=Q,_=H;return c(),d("div",q,[m("div",X,[m("div",Z,[m("div",ee,[m("div",te,[m("div",se,[m("div",ae,[m("div",oe,[m("div",re,[y(r,{title:a.value?.all_project?a.value.all_project:"0",subtitle:"All Projects",center:""},{icon:v((()=>[y(o,{color:"info",rounded:""},{default:v((()=>[le])),_:1})])),_:1},8,["title"])])]),m("div",ie,[m("div",ne,[y(r,{title:a.value?.active_projects?a.value?.active_projects:"0",subtitle:"Active Projects",center:""},{icon:v((()=>[y(o,{color:"blue",rounded:""},{default:v((()=>[ce])),_:1})])),_:1},8,["title"])])]),m("div",de,[m("div",ue,[y(r,{title:a.value?.pending_projects?a.value?.pending_projects:"0",subtitle:"Pre Construction",center:""},{icon:v((()=>[y(o,{color:"pink",rounded:""},{default:v((()=>[pe])),_:1})])),_:1},8,["title"])])]),m("div",ve,[m("div",me,[y(r,{title:a.value?.completed_projects?a.value?.completed_projects:"0",subtitle:"Completed",center:""},{icon:v((()=>[y(o,{color:"green",rounded:""},{default:v((()=>[fe])),_:1})])),_:1},8,["title"])])]),m("div",_e,[m("div",he,[y(r,{title:a.value?.managers?a.value?.managers:"0",subtitle:"Managers",center:""},{icon:v((()=>[y(o,{color:"yellow",rounded:""},{default:v((()=>[ge])),_:1})])),_:1},8,["title"])])]),m("div",be,[m("div",ye,[y(r,{title:a.value?.workers?a.value?.workers:"0",subtitle:"Workers",center:""},{icon:v((()=>[y(o,{color:"lime",rounded:""},{default:v((()=>[je])),_:1})])),_:1},8,["title"])])]),m("div",xe,[m("div",we,[y(r,{title:a.value?.contractors?a.value?.contractors:"0",subtitle:"Contractors",center:""},{icon:v((()=>[y(o,{color:"orange",rounded:""},{default:v((()=>[ke])),_:1})])),_:1},8,["title"])])]),m("div",Ce,[m("div",Se,[y(r,{title:a.value?.clients?a.value?.clients:"0",subtitle:"Clients",center:""},{icon:v((()=>[y(o,{color:"blue",rounded:""},{default:v((()=>[Pe])),_:1})])),_:1},8,["title"])])])]),y(r,{title:"Last Schedule Sent",subtitle:a.value.last_mail_sent?u(E)(a.value.last_mail_sent):"N/A"},{icon:v((()=>[y(o,{color:"success",rounded:""},{default:v((()=>[y(i,{icon:"lucide:clock"})])),_:1})])),action:v((()=>[y(n,{onClick:l,color:"warning",rounded:"",loading:s.value,elevated:""},{default:v((()=>[S(" Send Schedule ")])),_:1},8,["loading"])])),_:1},8,["subtitle"])])])])])]),m("div",Ae,[m("div",De,[y(p)]),m("div",Ie,[y(f)]),m("div",Te,[y(_)])])])}}}),$e={class:"page-content-inner"},Fe=l({__name:"index",setup(e){A();return J().setPageTitle("Ibex Builders Studios"),D((()=>({title:"Ibex Builders Studios"}))),(e,t)=>{const s=Be;return c(),d("div",$e,[y(s)])}}});export{Fe as default};
