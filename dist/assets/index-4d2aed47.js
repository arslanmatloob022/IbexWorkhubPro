import{_ as e}from"./VInput.vue_vue_type_script_setup_true_lang-71cbc574.js";import{e as a,r as l,o as s,M as t,y as n,z as o,C as i,A as r,B as c,l as p,J as d,S as u,T as m,D as f,E as v,v as y,H as _,ak as h}from"./index-f130b4cb.js";import{_ as b}from"./VTextarea.vue_vue_type_script_setup_true_lang-6fd1872b.js";import{_ as k}from"./VField.vue_vue_type_script_setup_true_lang-bdba4b30.js";import{_ as g}from"./VControl-276eb460.js";import{_ as x}from"./VAvatar.vue_vue_type_style_index_0_lang-1fd2fbec.js";import{u as C}from"./useAPI-3d533a16.js";import{u as V}from"./incomeHistoryChart-b5752140.js";import{u as w}from"./useNotyf-e1982812.js";import{u as j}from"./viewWrapper-eb67368a.js";import"./useVFieldContext-5af139a5.js";import"./VLabel.vue_vue_type_script_setup_true_lang-21b74bc7.js";import"./userSession-a5ab451b.js";import"./useThemeColors-5188c637.js";import"./notyf-3492d956.js";const P={class:"banking-dashboard banking-dashboard-v1"},A={class:"columns is-multiline"},T={class:"column is-12"},D={class:"columns is-multiline"},I={class:"column is-6"},S={class:"dashboard-card is-contacts"},B=i("div",{class:"title-wrap"},[i("h3",{class:"dark-inverted"},"Send money to")],-1),U=i("div",{class:"people-wrap"},[i("div",{class:"actions"},[i("span",null,"Clients")])],-1),E={class:"transfer-form"},M={class:"multiselect-single-label"},z={class:"select-label-text"},L={class:"select-label-text"},Y={class:"field"},q=i("label",null,"Amount",-1),F={class:"field has-addons"},Q={class:"field-addon-body"},X=i("div",{class:"control"},[i("span",{class:"select currency-select"},[i("select",null,[i("option",null,"$")])])],-1),H={class:"control is-expanded"},N={class:"field"},R=i("label",null,"Description",-1),G=i("p",{class:"context-text"}," Please enter amount you want your client to pay with small description. ",-1),J={class:"submit-wrap"},O={class:"column is-6"},W={class:"dashboard-card"},Z=i("div",{class:"title-wrap"},[i("h3",{class:"dark-inverted"},"Payment links")],-1),$={class:"context-text"},K=a({__name:"IbexPaymentModule",setup(a){const y=C(),_=w(),h=l({amount:0,description:"",client:""}),j=l(!1),K=l({payments:[],count:0});l(["default"]);const ee=l([]),ae=l(!1),le=l(!1),se=l({success:!0,msg:"payment link has been successfully created",resp:{id:"PAYID-M4BCCXQ345677503C442360B",intent:"sale",state:"created",payer:{payment_method:"paypal"},transactions:[{amount:{total:"10.00",currency:"USD"},description:"Desc",related_resources:[]}],create_time:"2024-10-06T05:34:22Z",links:[{href:"https://api.sandbox.paypal.com/v1/payments/payment/PAYID-M4BCCXQ345677503C442360B",rel:"self",method:"GET"},{href:"https://www.sandbox.paypal.com/cgi-bin/webscr?cmd=_express-checkout&token=EC-4812231612231625T",rel:"approval_url",method:"REDIRECT"},{href:"https://api.sandbox.paypal.com/v1/payments/payment/PAYID-M4BCCXQ345677503C442360B/execute",rel:"execute",method:"POST"}]}});V(),l(0);const te=e=>{e?navigator.clipboard.writeText(e).then((()=>{_.success("Link copied to clipboard!")})).catch((e=>{_.error("Failed to copy the link: ",e)})):_.error("No link to copy!")},ne=async()=>{try{le.value=!0;const e=await y.post("/api/paypal/create-link/",{amount:h.value.amount,description:h.value.description});se.value=e.data,_.success("link Created")}catch(e){_.success("Something went wrong")}finally{le.value=!1}};return s((()=>{(async()=>{try{ae.value=!0;const e=await y.get("/api/users/by-role/client/",{});ee.value=e.data.map((e=>({value:e.id,name:e.username,icon:e.avatar})))}catch(e){console.log(e)}finally{ae.value=!1}})(),(async()=>{try{j.value=!0;const e=await y.get("/api/paypal/payments/");K.value=e.data}catch(e){console.log(e)}finally{j.value=!1}})()})),(a,l)=>{const s=x,y=t("Multiselect"),_=g,C=k,V=b,w=v,j=e;return n(),o("div",P,[i("div",A,[i("div",T,[i("div",D,[i("div",I,[i("div",S,[B,U,i("div",E,[r(C,{class:"is-image-select has-curved-images"},{default:c((()=>[r(_,null,{default:c((()=>[r(y,{modelValue:p(h).client,"onUpdate:modelValue":l[0]||(l[0]=e=>p(h).client=e),placeholder:"Select a client",label:"name","max-height":145,options:p(ee)},{singlelabel:c((({value:e})=>[i("div",M,[r(s,{class:"select-option-icon",size:"xs",squared:"",picture:e.icon},null,8,["picture"]),i("span",z,d(e.name),1)])])),option:c((({option:e})=>[r(s,{class:"select-option-icon",size:"xs",squared:"",picture:e.icon},null,8,["picture"]),i("span",L,d(e.name),1)])),_:1},8,["modelValue","options"])])),_:1})])),_:1}),i("div",Y,[q,i("div",F,[i("div",Q,[X,i("div",H,[u(i("input",{"onUpdate:modelValue":l[1]||(l[1]=e=>p(h).amount=e),class:"input",type:"number",placeholder:"Amount of money"},null,512),[[m,p(h).amount]])])])])]),i("div",N,[R,r(C,null,{default:c((()=>[r(_,null,{default:c((()=>[r(V,{modelValue:p(h).description,"onUpdate:modelValue":l[2]||(l[2]=e=>p(h).description=e),class:"is-primary-focus",rows:"2",placeholder:"Description..."},null,8,["modelValue"])])),_:1})])),_:1})]),G,i("div",J,[r(w,{onClick:ne,color:"info",size:"big",fullwidth:"",loading:p(le),raised:"",bold:"",icon:"lnir lnir-paypal"},{default:c((()=>[f(" Create Payment link ")])),_:1},8,["loading"])])])])]),i("div",O,[i("div",W,[Z,r(C,{label:"Client link",addons:""},{default:c((()=>[r(_,{expanded:""},{default:c((()=>[r(j,{type:"text",modelValue:p(se).resp.links[1].href,"onUpdate:modelValue":l[3]||(l[3]=e=>p(se).resp.links[1].href=e),class:"input",placeholder:"Approved link..."},null,8,["modelValue"])])),_:1}),r(_,null,{default:c((()=>[r(w,{onClick:l[4]||(l[4]=e=>te(p(se).resp.links[1].href)),class:"cu-pointer",color:"primary",icon:"fas fa-envelope"},{default:c((()=>[f(" Send ")])),_:1})])),_:1})])),_:1}),r(C,{label:"Client link",addons:""},{default:c((()=>[r(_,{expanded:""},{default:c((()=>[r(j,{type:"text",modelValue:p(se).resp.links[1].href,"onUpdate:modelValue":l[5]||(l[5]=e=>p(se).resp.links[1].href=e),class:"input",placeholder:"Approved link..."},null,8,["modelValue"])])),_:1}),r(_,null,{default:c((()=>[r(w,{icon:"fas fa-copy",onClick:l[6]||(l[6]=e=>te(p(se).resp.links[1].href)),class:"cu-pointer",color:"primary"},{default:c((()=>[f(" Copy ")])),_:1})])),_:1})])),_:1}),r(C,{label:"Check Status Link",addons:""},{default:c((()=>[r(_,{expanded:""},{default:c((()=>[r(j,{type:"text",modelValue:p(se).resp.links[0].href,"onUpdate:modelValue":l[7]||(l[7]=e=>p(se).resp.links[0].href=e),class:"input",placeholder:"Approved link..."},null,8,["modelValue"])])),_:1}),r(_,null,{default:c((()=>[r(w,{icon:"fas fa-refresh",class:"cu-pointer",color:"primary"},{default:c((()=>[f(" Verify ")])),_:1})])),_:1})])),_:1}),i("p",$,d(p(se).msg?p(se).msg:"Link not generated yet"),1)])])])])])])}}}),ee={class:"page-content-inner"},ae=i("div",{class:"lifestyle-dashboard-bg has-top-nav"},null,-1),le=a({__name:"index",setup:e=>(j().setPageTitle("Ibex Payment"),y({title:"Ibex Payment"}),(e,a)=>{const l=K;return n(),o("div",ee,[(n(),_(h,{to:"[data-teleport-bg]"},[ae])),r(l,{class:"has-navbar-spacing"})])})});export{le as default};
